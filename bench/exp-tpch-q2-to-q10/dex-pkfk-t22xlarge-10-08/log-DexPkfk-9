19/10/08 22:58:23 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 10751ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Tue Oct 08 22:58:26 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Tue Oct 08 22:58:27 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Tue Oct 08 22:58:27 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Tue Oct 08 22:58:27 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Tue Oct 08 22:58:28 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Tue Oct 08 22:58:32 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Tue Oct 08 22:58:35 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Tue Oct 08 22:58:35 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



 Q2

q2a=
select r_comment from region where r_name = 'EUROPE'
postgres result size=1
Elapsed time: 189ms
19/10/08 22:58:37 WARN DexPlanner: dexPlan=DexPkFkPlan
19/10/08 22:58:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#404L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/08 22:58:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#404L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#406L AS rid_0#411L, val_region_r_name_prf#407 AS val_region_r_name_prf_0#412, val_region_r_comment_prf#408 AS val_region_r_comment_prf_0#413, r_name_prf#409 AS r_name_prf_0#414, r_comment_prf#410 AS r_comment_prf_0#415]
         :  +- Relation[rid#406L,val_region_r_name_prf#407,val_region_r_comment_prf#408,r_name_prf#409,r_comment_prf#410] JDBCRelation(region_prf) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, val_region_r_name_prf, 'val_region_r_name_prf_0, region_prf, 'rid_0
            +- Project [rid#416L AS rid_0#421L, val_region_r_name_prf#417 AS val_region_r_name_prf_0#422, val_region_r_comment_prf#418 AS val_region_r_comment_prf_0#423, r_name_prf#419 AS r_name_prf_0#424, r_comment_prf#420 AS r_comment_prf_0#425]
               +- Relation[rid#416L,val_region_r_name_prf#417,val_region_r_comment_prf#418,r_name_prf#419,r_comment_prf#420] JDBCRelation(region_prf) [numPartitions=1]

dex-class org.apache.spark.sql.dex.DexPkFk$ result size=1
Elapsed time: 145ms

q2b=
select n_name from region, nation where r_regionkey = n_regionkey
postgres result size=25
Elapsed time: 49ms
19/10/08 22:58:37 WARN DexPlanner: dexPlan=DexPkFkPlan
19/10/08 22:58:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#451L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/08 22:58:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#451L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#453L AS rid_0#458L, val_region_r_name_prf#454 AS val_region_r_name_prf_0#459, val_region_r_comment_prf#455 AS val_region_r_comment_prf_0#460, r_name_prf#456 AS r_name_prf_0#461, r_comment_prf#457 AS r_comment_prf_0#462]
         :  :  +- Relation[rid#453L,val_region_r_name_prf#454,val_region_r_comment_prf#455,r_name_prf#456,r_comment_prf#457] JDBCRelation(region_prf) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin region~nation, pfk_region_nation_prf, 'pfk_region_nation_prf_1, region_prf, 'rid_0, nation_prf, 'rid_1
         :     :- Project [rid#477L AS rid_0#482L, val_region_r_name_prf#478 AS val_region_r_name_prf_0#483, val_region_r_comment_prf#479 AS val_region_r_comment_prf_0#484, r_name_prf#480 AS r_name_prf_0#485, r_comment_prf#481 AS r_comment_prf_0#486]
         :     :  +- Relation[rid#477L,val_region_r_name_prf#478,val_region_r_comment_prf#479,r_name_prf#480,r_comment_prf#481] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Project [rid#487L AS rid_1#494L, pfk_region_nation_prf#488 AS pfk_region_nation_prf_1#495, fpk_nation_region_prf#489 AS fpk_nation_region_prf_1#496, val_nation_n_name_prf#490 AS val_nation_n_name_prf_1#497, val_nation_n_comment_prf#491 AS val_nation_n_comment_prf_1#498, n_name_prf#492 AS n_name_prf_1#499, n_comment_prf#493 AS n_comment_prf_1#500]
         :        +- Relation[rid#487L,pfk_region_nation_prf#488,fpk_nation_region_prf#489,val_nation_n_name_prf#490,val_nation_n_comment_prf#491,n_name_prf#492,n_comment_prf#493] JDBCRelation(nation_prf) [numPartitions=1]
         +- Project [rid#463L AS rid_1#470L, pfk_region_nation_prf#464 AS pfk_region_nation_prf_1#471, fpk_nation_region_prf#465 AS fpk_nation_region_prf_1#472, val_nation_n_name_prf#466 AS val_nation_n_name_prf_1#473, val_nation_n_comment_prf#467 AS val_nation_n_comment_prf_1#474, n_name_prf#468 AS n_name_prf_1#475, n_comment_prf#469 AS n_comment_prf_1#476]
            +- Relation[rid#463L,pfk_region_nation_prf#464,fpk_nation_region_prf#465,val_nation_n_name_prf#466,val_nation_n_comment_prf#467,n_name_prf#468,n_comment_prf#469] JDBCRelation(nation_prf) [numPartitions=1]

dex-class org.apache.spark.sql.dex.DexPkFk$ result size=25
Elapsed time: 148ms

q2c=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
      
postgres result size=3162
Elapsed time: 179ms
19/10/08 22:58:37 WARN DexPlanner: dexPlan=DexPkFkPlan
19/10/08 22:58:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#614L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (n_regionkey#110L = r_regionkey#116L)
         :- Project [n_regionkey#110L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :     :     :- Project [ps_suppkey#33L]
         :     :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Filter (isnotnull(s_suppkey#18L) && isnotnull(s_nationkey#21L))
         :     :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :        +- Filter (isnotnull(n_nationkey#108L) && isnotnull(n_regionkey#110L))
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [r_regionkey#116L]
            +- Filter ((isnotnull(r_name#117) && (r_name#117 = EUROPE)) && isnotnull(r_regionkey#116L))
               +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/08 22:58:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#614L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (cast(dexdecrypt(concat(nation~region, ~, 'rid_3), 'fpk_nation_region_prf_3) as bigint) = 'rid_4)
            :- 'Project [*]
            :  +- 'Join Inner, (cast(dexdecrypt(concat(supplier~nation, ~, 'rid_2), 'fpk_supplier_nation_prf_2) as bigint) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (cast(dexdecrypt(concat(partsupp~supplier, ~, 'rid_1), 'fpk_partsupp_supplier_prf_1) as bigint) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#616L AS rid_0#633L, val_part_p_name_prf#617 AS val_part_p_name_prf_0#634, val_part_p_mfgr_prf#618 AS val_part_p_mfgr_prf_0#635, val_part_p_type_prf#619 AS val_part_p_type_prf_0#636, val_part_p_size_prf#620 AS val_part_p_size_prf_0#637, val_part_p_container_prf#621 AS val_part_p_container_prf_0#638, val_part_p_retailprice_prf#622 AS val_part_p_retailprice_prf_0#639, val_part_p_comment_prf#623 AS val_part_p_comment_prf_0#640, val_part_p_brand_prf#624 AS val_part_p_brand_prf_0#641, p_name_prf#625 AS p_name_prf_0#642, p_mfgr_prf#626 AS p_mfgr_prf_0#643, p_type_prf#627 AS p_type_prf_0#644, p_size_prf#628 AS p_size_prf_0#645, p_container_prf#629 AS p_container_prf_0#646, p_retailprice_prf#630 AS p_retailprice_prf_0#647, p_comment_prf#631 AS p_comment_prf_0#648, p_brand_prf#632 AS p_brand_prf_0#649]
            :     :     :  :  :  :  +- Relation[rid#616L,val_part_p_name_prf#617,val_part_p_mfgr_prf#618,val_part_p_type_prf#619,val_part_p_size_prf#620,val_part_p_container_prf#621,val_part_p_retailprice_prf#622,val_part_p_comment_prf#623,val_part_p_brand_prf#624,p_name_prf#625,p_mfgr_prf#626,p_type_prf#627,p_size_prf#628,p_container_prf#629,p_retailprice_prf#630,p_comment_prf#631,p_brand_prf#632] JDBCRelation(part_prf) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, val_part_p_size_prf, 'val_part_p_size_prf_0, part_prf, 'rid_0
            :     :     :  :  :     +- Project [rid#650L AS rid_0#667L, val_part_p_name_prf#651 AS val_part_p_name_prf_0#668, val_part_p_mfgr_prf#652 AS val_part_p_mfgr_prf_0#669, val_part_p_type_prf#653 AS val_part_p_type_prf_0#670, val_part_p_size_prf#654 AS val_part_p_size_prf_0#671, val_part_p_container_prf#655 AS val_part_p_container_prf_0#672, val_part_p_retailprice_prf#656 AS val_part_p_retailprice_prf_0#673, val_part_p_comment_prf#657 AS val_part_p_comment_prf_0#674, val_part_p_brand_prf#658 AS val_part_p_brand_prf_0#675, p_name_prf#659 AS p_name_prf_0#676, p_mfgr_prf#660 AS p_mfgr_prf_0#677, p_type_prf#661 AS p_type_prf_0#678, p_size_prf#662 AS p_size_prf_0#679, p_container_prf#663 AS p_container_prf_0#680, p_retailprice_prf#664 AS p_retailprice_prf_0#681, p_comment_prf#665 AS p_comment_prf_0#682, p_brand_prf#666 AS p_brand_prf_0#683]
            :     :     :  :  :        +- Relation[rid#650L,val_part_p_name_prf#651,val_part_p_mfgr_prf#652,val_part_p_type_prf#653,val_part_p_size_prf#654,val_part_p_container_prf#655,val_part_p_retailprice_prf#656,val_part_p_comment_prf#657,val_part_p_brand_prf#658,p_name_prf#659,p_mfgr_prf#660,p_type_prf#661,p_size_prf#662,p_container_prf#663,p_retailprice_prf#664,p_comment_prf#665,p_brand_prf#666] JDBCRelation(part_prf) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, pfk_part_partsupp_prf, 'pfk_part_partsupp_prf_1, part_prf, 'rid_0, partsupp_prf, 'rid_1
            :     :     :  :     :- Project [rid#706L AS rid_0#723L, val_part_p_name_prf#707 AS val_part_p_name_prf_0#724, val_part_p_mfgr_prf#708 AS val_part_p_mfgr_prf_0#725, val_part_p_type_prf#709 AS val_part_p_type_prf_0#726, val_part_p_size_prf#710 AS val_part_p_size_prf_0#727, val_part_p_container_prf#711 AS val_part_p_container_prf_0#728, val_part_p_retailprice_prf#712 AS val_part_p_retailprice_prf_0#729, val_part_p_comment_prf#713 AS val_part_p_comment_prf_0#730, val_part_p_brand_prf#714 AS val_part_p_brand_prf_0#731, p_name_prf#715 AS p_name_prf_0#732, p_mfgr_prf#716 AS p_mfgr_prf_0#733, p_type_prf#717 AS p_type_prf_0#734, p_size_prf#718 AS p_size_prf_0#735, p_container_prf#719 AS p_container_prf_0#736, p_retailprice_prf#720 AS p_retailprice_prf_0#737, p_comment_prf#721 AS p_comment_prf_0#738, p_brand_prf#722 AS p_brand_prf_0#739]
            :     :     :  :     :  +- Relation[rid#706L,val_part_p_name_prf#707,val_part_p_mfgr_prf#708,val_part_p_type_prf#709,val_part_p_size_prf#710,val_part_p_container_prf#711,val_part_p_retailprice_prf#712,val_part_p_comment_prf#713,val_part_p_brand_prf#714,p_name_prf#715,p_mfgr_prf#716,p_type_prf#717,p_size_prf#718,p_container_prf#719,p_retailprice_prf#720,p_comment_prf#721,p_brand_prf#722] JDBCRelation(part_prf) [numPartitions=1]
            :     :     :  :     +- Project [rid#740L AS rid_1#751L, pfk_part_partsupp_prf#741 AS pfk_part_partsupp_prf_1#752, fpk_partsupp_part_prf#742 AS fpk_partsupp_part_prf_1#753, pfk_supplier_partsupp_prf#743 AS pfk_supplier_partsupp_prf_1#754, fpk_partsupp_supplier_prf#744 AS fpk_partsupp_supplier_prf_1#755, val_partsupp_ps_availqty_prf#745 AS val_partsupp_ps_availqty_prf_1#756, val_partsupp_ps_supplycost_prf#746 AS val_partsupp_ps_supplycost_prf_1#757, val_partsupp_ps_comment_prf#747 AS val_partsupp_ps_comment_prf_1#758, ps_availqty_prf#748 AS ps_availqty_prf_1#759, ps_supplycost_prf#749 AS ps_supplycost_prf_1#760, ps_comment_prf#750 AS ps_comment_prf_1#761]
            :     :     :  :        +- Relation[rid#740L,pfk_part_partsupp_prf#741,fpk_partsupp_part_prf#742,pfk_supplier_partsupp_prf#743,fpk_partsupp_supplier_prf#744,val_partsupp_ps_availqty_prf#745,val_partsupp_ps_supplycost_prf#746,val_partsupp_ps_comment_prf#747,ps_availqty_prf#748,ps_supplycost_prf#749,ps_comment_prf#750] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     :     :  +- Project [rid#684L AS rid_1#695L, pfk_part_partsupp_prf#685 AS pfk_part_partsupp_prf_1#696, fpk_partsupp_part_prf#686 AS fpk_partsupp_part_prf_1#697, pfk_supplier_partsupp_prf#687 AS pfk_supplier_partsupp_prf_1#698, fpk_partsupp_supplier_prf#688 AS fpk_partsupp_supplier_prf_1#699, val_partsupp_ps_availqty_prf#689 AS val_partsupp_ps_availqty_prf_1#700, val_partsupp_ps_supplycost_prf#690 AS val_partsupp_ps_supplycost_prf_1#701, val_partsupp_ps_comment_prf#691 AS val_partsupp_ps_comment_prf_1#702, ps_availqty_prf#692 AS ps_availqty_prf_1#703, ps_supplycost_prf#693 AS ps_supplycost_prf_1#704, ps_comment_prf#694 AS ps_comment_prf_1#705]
            :     :     :     +- Relation[rid#684L,pfk_part_partsupp_prf#685,fpk_partsupp_part_prf#686,pfk_supplier_partsupp_prf#687,fpk_partsupp_supplier_prf#688,val_partsupp_ps_availqty_prf#689,val_partsupp_ps_supplycost_prf#690,val_partsupp_ps_comment_prf#691,ps_availqty_prf#692,ps_supplycost_prf#693,ps_comment_prf#694] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     :     +- Project [rid#762L AS rid_2#775L, pfk_nation_supplier_prf#763 AS pfk_nation_supplier_prf_2#776, fpk_supplier_nation_prf#764 AS fpk_supplier_nation_prf_2#777, val_supplier_s_name_prf#765 AS val_supplier_s_name_prf_2#778, val_supplier_s_address_prf#766 AS val_supplier_s_address_prf_2#779, val_supplier_s_phone_prf#767 AS val_supplier_s_phone_prf_2#780, val_supplier_s_acctbal_prf#768 AS val_supplier_s_acctbal_prf_2#781, val_supplier_s_comment_prf#769 AS val_supplier_s_comment_prf_2#782, s_name_prf#770 AS s_name_prf_2#783, s_address_prf#771 AS s_address_prf_2#784, s_phone_prf#772 AS s_phone_prf_2#785, s_acctbal_prf#773 AS s_acctbal_prf_2#786, s_comment_prf#774 AS s_comment_prf_2#787]
            :     :        +- Relation[rid#762L,pfk_nation_supplier_prf#763,fpk_supplier_nation_prf#764,val_supplier_s_name_prf#765,val_supplier_s_address_prf#766,val_supplier_s_phone_prf#767,val_supplier_s_acctbal_prf#768,val_supplier_s_comment_prf#769,s_name_prf#770,s_address_prf#771,s_phone_prf#772,s_acctbal_prf#773,s_comment_prf#774] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Project [rid#788L AS rid_3#795L, pfk_region_nation_prf#789 AS pfk_region_nation_prf_3#796, fpk_nation_region_prf#790 AS fpk_nation_region_prf_3#797, val_nation_n_name_prf#791 AS val_nation_n_name_prf_3#798, val_nation_n_comment_prf#792 AS val_nation_n_comment_prf_3#799, n_name_prf#793 AS n_name_prf_3#800, n_comment_prf#794 AS n_comment_prf_3#801]
            :        +- Relation[rid#788L,pfk_region_nation_prf#789,fpk_nation_region_prf#790,val_nation_n_name_prf#791,val_nation_n_comment_prf#792,n_name_prf#793,n_comment_prf#794] JDBCRelation(nation_prf) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_4))
               :- Project [rid#802L AS rid_4#807L, val_region_r_name_prf#803 AS val_region_r_name_prf_4#808, val_region_r_comment_prf#804 AS val_region_r_comment_prf_4#809, r_name_prf#805 AS r_name_prf_4#810, r_comment_prf#806 AS r_comment_prf_4#811]
               :  +- Relation[rid#802L,val_region_r_name_prf#803,val_region_r_comment_prf#804,r_name_prf#805,r_comment_prf#806] JDBCRelation(region_prf) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, val_region_r_name_prf, 'val_region_r_name_prf_4, region_prf, 'rid_4
                  +- Project [rid#812L AS rid_4#817L, val_region_r_name_prf#813 AS val_region_r_name_prf_4#818, val_region_r_comment_prf#814 AS val_region_r_comment_prf_4#819, r_name_prf#815 AS r_name_prf_4#820, r_comment_prf#816 AS r_comment_prf_4#821]
                     +- Relation[rid#812L,val_region_r_name_prf#813,val_region_r_comment_prf#814,r_name_prf#815,r_comment_prf#816] JDBCRelation(region_prf) [numPartitions=1]

19/10/08 22:58:38 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
dex-class org.apache.spark.sql.dex.DexPkFk$ result size=3162
Elapsed time: 2847ms

q2c2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
      
postgres result size=3162
Elapsed time: 183ms
19/10/08 22:58:41 WARN DexPlanner: dexPlan=DexPkFkPlan
19/10/08 22:58:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#976L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (n_regionkey#110L = r_regionkey#116L)
         :- Project [n_regionkey#110L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :     :     :- Project [ps_suppkey#33L]
         :     :     :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     :     +- Project [p_partkey#360L]
         :     :     :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Filter (isnotnull(s_suppkey#18L) && isnotnull(s_nationkey#21L))
         :     :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :        +- Filter (isnotnull(n_nationkey#108L) && isnotnull(n_regionkey#110L))
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [r_regionkey#116L]
            +- Filter ((isnotnull(r_name#117) && (r_name#117 = EUROPE)) && isnotnull(r_regionkey#116L))
               +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/08 22:58:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#976L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (cast(dexdecrypt(concat(nation~region, ~, 'rid_3), 'fpk_nation_region_prf_3) as bigint) = 'rid_4)
            :- 'Project [*]
            :  +- 'Join Inner, (cast(dexdecrypt(concat(supplier~nation, ~, 'rid_2), 'fpk_supplier_nation_prf_2) as bigint) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (cast(dexdecrypt(concat(partsupp~supplier, ~, 'rid_0), 'fpk_partsupp_supplier_prf_0) as bigint) = 'rid_2)
            :     :     :- 'Project [*]
            :     :     :  +- 'Join Inner, (cast(dexdecrypt(concat(partsupp~part, ~, 'rid_0), 'fpk_partsupp_part_prf_0) as bigint) = 'rid_1)
            :     :     :     :- Project [rid#978L AS rid_0#989L, pfk_part_partsupp_prf#979 AS pfk_part_partsupp_prf_0#990, fpk_partsupp_part_prf#980 AS fpk_partsupp_part_prf_0#991, pfk_supplier_partsupp_prf#981 AS pfk_supplier_partsupp_prf_0#992, fpk_partsupp_supplier_prf#982 AS fpk_partsupp_supplier_prf_0#993, val_partsupp_ps_availqty_prf#983 AS val_partsupp_ps_availqty_prf_0#994, val_partsupp_ps_supplycost_prf#984 AS val_partsupp_ps_supplycost_prf_0#995, val_partsupp_ps_comment_prf#985 AS val_partsupp_ps_comment_prf_0#996, ps_availqty_prf#986 AS ps_availqty_prf_0#997, ps_supplycost_prf#987 AS ps_supplycost_prf_0#998, ps_comment_prf#988 AS ps_comment_prf_0#999]
            :     :     :     :  +- Relation[rid#978L,pfk_part_partsupp_prf#979,fpk_partsupp_part_prf#980,pfk_supplier_partsupp_prf#981,fpk_partsupp_supplier_prf#982,val_partsupp_ps_availqty_prf#983,val_partsupp_ps_supplycost_prf#984,val_partsupp_ps_comment_prf#985,ps_availqty_prf#986,ps_supplycost_prf#987,ps_comment_prf#988] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     :     :     +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :     :        :- Project [rid#1000L AS rid_1#1017L, val_part_p_name_prf#1001 AS val_part_p_name_prf_1#1018, val_part_p_mfgr_prf#1002 AS val_part_p_mfgr_prf_1#1019, val_part_p_type_prf#1003 AS val_part_p_type_prf_1#1020, val_part_p_size_prf#1004 AS val_part_p_size_prf_1#1021, val_part_p_container_prf#1005 AS val_part_p_container_prf_1#1022, val_part_p_retailprice_prf#1006 AS val_part_p_retailprice_prf_1#1023, val_part_p_comment_prf#1007 AS val_part_p_comment_prf_1#1024, val_part_p_brand_prf#1008 AS val_part_p_brand_prf_1#1025, p_name_prf#1009 AS p_name_prf_1#1026, p_mfgr_prf#1010 AS p_mfgr_prf_1#1027, p_type_prf#1011 AS p_type_prf_1#1028, p_size_prf#1012 AS p_size_prf_1#1029, p_container_prf#1013 AS p_container_prf_1#1030, p_retailprice_prf#1014 AS p_retailprice_prf_1#1031, p_comment_prf#1015 AS p_comment_prf_1#1032, p_brand_prf#1016 AS p_brand_prf_1#1033]
            :     :     :        :  +- Relation[rid#1000L,val_part_p_name_prf#1001,val_part_p_mfgr_prf#1002,val_part_p_type_prf#1003,val_part_p_size_prf#1004,val_part_p_container_prf#1005,val_part_p_retailprice_prf#1006,val_part_p_comment_prf#1007,val_part_p_brand_prf#1008,p_name_prf#1009,p_mfgr_prf#1010,p_type_prf#1011,p_size_prf#1012,p_container_prf#1013,p_retailprice_prf#1014,p_comment_prf#1015,p_brand_prf#1016] JDBCRelation(part_prf) [numPartitions=1]
            :     :     :        +- 'DexPseudoPrimaryKeyFilter part~p_size~15, val_part_p_size_prf, 'val_part_p_size_prf_1, part_prf, 'rid_1
            :     :     :           +- Project [rid#1034L AS rid_1#1051L, val_part_p_name_prf#1035 AS val_part_p_name_prf_1#1052, val_part_p_mfgr_prf#1036 AS val_part_p_mfgr_prf_1#1053, val_part_p_type_prf#1037 AS val_part_p_type_prf_1#1054, val_part_p_size_prf#1038 AS val_part_p_size_prf_1#1055, val_part_p_container_prf#1039 AS val_part_p_container_prf_1#1056, val_part_p_retailprice_prf#1040 AS val_part_p_retailprice_prf_1#1057, val_part_p_comment_prf#1041 AS val_part_p_comment_prf_1#1058, val_part_p_brand_prf#1042 AS val_part_p_brand_prf_1#1059, p_name_prf#1043 AS p_name_prf_1#1060, p_mfgr_prf#1044 AS p_mfgr_prf_1#1061, p_type_prf#1045 AS p_type_prf_1#1062, p_size_prf#1046 AS p_size_prf_1#1063, p_container_prf#1047 AS p_container_prf_1#1064, p_retailprice_prf#1048 AS p_retailprice_prf_1#1065, p_comment_prf#1049 AS p_comment_prf_1#1066, p_brand_prf#1050 AS p_brand_prf_1#1067]
            :     :     :              +- Relation[rid#1034L,val_part_p_name_prf#1035,val_part_p_mfgr_prf#1036,val_part_p_type_prf#1037,val_part_p_size_prf#1038,val_part_p_container_prf#1039,val_part_p_retailprice_prf#1040,val_part_p_comment_prf#1041,val_part_p_brand_prf#1042,p_name_prf#1043,p_mfgr_prf#1044,p_type_prf#1045,p_size_prf#1046,p_container_prf#1047,p_retailprice_prf#1048,p_comment_prf#1049,p_brand_prf#1050] JDBCRelation(part_prf) [numPartitions=1]
            :     :     +- Project [rid#1068L AS rid_2#1081L, pfk_nation_supplier_prf#1069 AS pfk_nation_supplier_prf_2#1082, fpk_supplier_nation_prf#1070 AS fpk_supplier_nation_prf_2#1083, val_supplier_s_name_prf#1071 AS val_supplier_s_name_prf_2#1084, val_supplier_s_address_prf#1072 AS val_supplier_s_address_prf_2#1085, val_supplier_s_phone_prf#1073 AS val_supplier_s_phone_prf_2#1086, val_supplier_s_acctbal_prf#1074 AS val_supplier_s_acctbal_prf_2#1087, val_supplier_s_comment_prf#1075 AS val_supplier_s_comment_prf_2#1088, s_name_prf#1076 AS s_name_prf_2#1089, s_address_prf#1077 AS s_address_prf_2#1090, s_phone_prf#1078 AS s_phone_prf_2#1091, s_acctbal_prf#1079 AS s_acctbal_prf_2#1092, s_comment_prf#1080 AS s_comment_prf_2#1093]
            :     :        +- Relation[rid#1068L,pfk_nation_supplier_prf#1069,fpk_supplier_nation_prf#1070,val_supplier_s_name_prf#1071,val_supplier_s_address_prf#1072,val_supplier_s_phone_prf#1073,val_supplier_s_acctbal_prf#1074,val_supplier_s_comment_prf#1075,s_name_prf#1076,s_address_prf#1077,s_phone_prf#1078,s_acctbal_prf#1079,s_comment_prf#1080] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Project [rid#1094L AS rid_3#1101L, pfk_region_nation_prf#1095 AS pfk_region_nation_prf_3#1102, fpk_nation_region_prf#1096 AS fpk_nation_region_prf_3#1103, val_nation_n_name_prf#1097 AS val_nation_n_name_prf_3#1104, val_nation_n_comment_prf#1098 AS val_nation_n_comment_prf_3#1105, n_name_prf#1099 AS n_name_prf_3#1106, n_comment_prf#1100 AS n_comment_prf_3#1107]
            :        +- Relation[rid#1094L,pfk_region_nation_prf#1095,fpk_nation_region_prf#1096,val_nation_n_name_prf#1097,val_nation_n_comment_prf#1098,n_name_prf#1099,n_comment_prf#1100] JDBCRelation(nation_prf) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_4))
               :- Project [rid#1108L AS rid_4#1113L, val_region_r_name_prf#1109 AS val_region_r_name_prf_4#1114, val_region_r_comment_prf#1110 AS val_region_r_comment_prf_4#1115, r_name_prf#1111 AS r_name_prf_4#1116, r_comment_prf#1112 AS r_comment_prf_4#1117]
               :  +- Relation[rid#1108L,val_region_r_name_prf#1109,val_region_r_comment_prf#1110,r_name_prf#1111,r_comment_prf#1112] JDBCRelation(region_prf) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, val_region_r_name_prf, 'val_region_r_name_prf_4, region_prf, 'rid_4
                  +- Project [rid#1118L AS rid_4#1123L, val_region_r_name_prf#1119 AS val_region_r_name_prf_4#1124, val_region_r_comment_prf#1120 AS val_region_r_comment_prf_4#1125, r_name_prf#1121 AS r_name_prf_4#1126, r_comment_prf#1122 AS r_comment_prf_4#1127]
                     +- Relation[rid#1118L,val_region_r_name_prf#1119,val_region_r_comment_prf#1120,r_name_prf#1121,r_comment_prf#1122] JDBCRelation(region_prf) [numPartitions=1]

dex-class org.apache.spark.sql.dex.DexPkFk$ result size=3162
Elapsed time: 4480ms

q2d=
select * from part where p_size = 15
postgres result size=3907
Elapsed time: 55ms
19/10/08 22:58:45 WARN DexPlanner: dexPlan=DexPkFkPlan
19/10/08 22:58:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1225L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/08 22:58:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1225L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#1227L AS rid_0#1244L, val_part_p_name_prf#1228 AS val_part_p_name_prf_0#1245, val_part_p_mfgr_prf#1229 AS val_part_p_mfgr_prf_0#1246, val_part_p_type_prf#1230 AS val_part_p_type_prf_0#1247, val_part_p_size_prf#1231 AS val_part_p_size_prf_0#1248, val_part_p_container_prf#1232 AS val_part_p_container_prf_0#1249, val_part_p_retailprice_prf#1233 AS val_part_p_retailprice_prf_0#1250, val_part_p_comment_prf#1234 AS val_part_p_comment_prf_0#1251, val_part_p_brand_prf#1235 AS val_part_p_brand_prf_0#1252, p_name_prf#1236 AS p_name_prf_0#1253, p_mfgr_prf#1237 AS p_mfgr_prf_0#1254, p_type_prf#1238 AS p_type_prf_0#1255, p_size_prf#1239 AS p_size_prf_0#1256, p_container_prf#1240 AS p_container_prf_0#1257, p_retailprice_prf#1241 AS p_retailprice_prf_0#1258, p_comment_prf#1242 AS p_comment_prf_0#1259, p_brand_prf#1243 AS p_brand_prf_0#1260]
         :  +- Relation[rid#1227L,val_part_p_name_prf#1228,val_part_p_mfgr_prf#1229,val_part_p_type_prf#1230,val_part_p_size_prf#1231,val_part_p_container_prf#1232,val_part_p_retailprice_prf#1233,val_part_p_comment_prf#1234,val_part_p_brand_prf#1235,p_name_prf#1236,p_mfgr_prf#1237,p_type_prf#1238,p_size_prf#1239,p_container_prf#1240,p_retailprice_prf#1241,p_comment_prf#1242,p_brand_prf#1243] JDBCRelation(part_prf) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyFilter part~p_size~15, val_part_p_size_prf, 'val_part_p_size_prf_0, part_prf, 'rid_0
            +- Project [rid#1261L AS rid_0#1278L, val_part_p_name_prf#1262 AS val_part_p_name_prf_0#1279, val_part_p_mfgr_prf#1263 AS val_part_p_mfgr_prf_0#1280, val_part_p_type_prf#1264 AS val_part_p_type_prf_0#1281, val_part_p_size_prf#1265 AS val_part_p_size_prf_0#1282, val_part_p_container_prf#1266 AS val_part_p_container_prf_0#1283, val_part_p_retailprice_prf#1267 AS val_part_p_retailprice_prf_0#1284, val_part_p_comment_prf#1268 AS val_part_p_comment_prf_0#1285, val_part_p_brand_prf#1269 AS val_part_p_brand_prf_0#1286, p_name_prf#1270 AS p_name_prf_0#1287, p_mfgr_prf#1271 AS p_mfgr_prf_0#1288, p_type_prf#1272 AS p_type_prf_0#1289, p_size_prf#1273 AS p_size_prf_0#1290, p_container_prf#1274 AS p_container_prf_0#1291, p_retailprice_prf#1275 AS p_retailprice_prf_0#1292, p_comment_prf#1276 AS p_comment_prf_0#1293, p_brand_prf#1277 AS p_brand_prf_0#1294]
               +- Relation[rid#1261L,val_part_p_name_prf#1262,val_part_p_mfgr_prf#1263,val_part_p_type_prf#1264,val_part_p_size_prf#1265,val_part_p_container_prf#1266,val_part_p_retailprice_prf#1267,val_part_p_comment_prf#1268,val_part_p_brand_prf#1269,p_name_prf#1270,p_mfgr_prf#1271,p_type_prf#1272,p_size_prf#1273,p_container_prf#1274,p_retailprice_prf#1275,p_comment_prf#1276,p_brand_prf#1277] JDBCRelation(part_prf) [numPartitions=1]

dex-class org.apache.spark.sql.dex.DexPkFk$ result size=3907
Elapsed time: 112ms

q2e=

select
  ps_supplycost
from
  part,
  partsupp
where
  p_partkey = ps_partkey
      
postgres result size=800000
Elapsed time: 565ms
19/10/08 22:58:46 WARN DexPlanner: dexPlan=DexPkFkPlan
19/10/08 22:58:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1339L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/08 22:58:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1339L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (cast(dexdecrypt(concat(partsupp~part, ~, 'rid_0), 'fpk_partsupp_part_prf_0) as bigint) = 'rid_1)
            :- Project [rid#1341L AS rid_0#1352L, pfk_part_partsupp_prf#1342 AS pfk_part_partsupp_prf_0#1353, fpk_partsupp_part_prf#1343 AS fpk_partsupp_part_prf_0#1354, pfk_supplier_partsupp_prf#1344 AS pfk_supplier_partsupp_prf_0#1355, fpk_partsupp_supplier_prf#1345 AS fpk_partsupp_supplier_prf_0#1356, val_partsupp_ps_availqty_prf#1346 AS val_partsupp_ps_availqty_prf_0#1357, val_partsupp_ps_supplycost_prf#1347 AS val_partsupp_ps_supplycost_prf_0#1358, val_partsupp_ps_comment_prf#1348 AS val_partsupp_ps_comment_prf_0#1359, ps_availqty_prf#1349 AS ps_availqty_prf_0#1360, ps_supplycost_prf#1350 AS ps_supplycost_prf_0#1361, ps_comment_prf#1351 AS ps_comment_prf_0#1362]
            :  +- Relation[rid#1341L,pfk_part_partsupp_prf#1342,fpk_partsupp_part_prf#1343,pfk_supplier_partsupp_prf#1344,fpk_partsupp_supplier_prf#1345,val_partsupp_ps_availqty_prf#1346,val_partsupp_ps_supplycost_prf#1347,val_partsupp_ps_comment_prf#1348,ps_availqty_prf#1349,ps_supplycost_prf#1350,ps_comment_prf#1351] JDBCRelation(partsupp_prf) [numPartitions=1]
            +- Project [rid#1363L AS rid_1#1380L, val_part_p_name_prf#1364 AS val_part_p_name_prf_1#1381, val_part_p_mfgr_prf#1365 AS val_part_p_mfgr_prf_1#1382, val_part_p_type_prf#1366 AS val_part_p_type_prf_1#1383, val_part_p_size_prf#1367 AS val_part_p_size_prf_1#1384, val_part_p_container_prf#1368 AS val_part_p_container_prf_1#1385, val_part_p_retailprice_prf#1369 AS val_part_p_retailprice_prf_1#1386, val_part_p_comment_prf#1370 AS val_part_p_comment_prf_1#1387, val_part_p_brand_prf#1371 AS val_part_p_brand_prf_1#1388, p_name_prf#1372 AS p_name_prf_1#1389, p_mfgr_prf#1373 AS p_mfgr_prf_1#1390, p_type_prf#1374 AS p_type_prf_1#1391, p_size_prf#1375 AS p_size_prf_1#1392, p_container_prf#1376 AS p_container_prf_1#1393, p_retailprice_prf#1377 AS p_retailprice_prf_1#1394, p_comment_prf#1378 AS p_comment_prf_1#1395, p_brand_prf#1379 AS p_brand_prf_1#1396]
               +- Relation[rid#1363L,val_part_p_name_prf#1364,val_part_p_mfgr_prf#1365,val_part_p_type_prf#1366,val_part_p_size_prf#1367,val_part_p_container_prf#1368,val_part_p_retailprice_prf#1369,val_part_p_comment_prf#1370,val_part_p_brand_prf#1371,p_name_prf#1372,p_mfgr_prf#1373,p_type_prf#1374,p_size_prf#1375,p_container_prf#1376,p_retailprice_prf#1377,p_comment_prf#1378,p_brand_prf#1379] JDBCRelation(part_prf) [numPartitions=1]

dex-class org.apache.spark.sql.dex.DexPkFk$ result size=800000
Elapsed time: 7947ms

q2e2=

select
  ps_supplycost
from
  part,
  partsupp
where
  p_partkey = ps_partkey
      
postgres result size=800000
Elapsed time: 557ms
19/10/08 22:58:54 WARN DexPlanner: dexPlan=DexPkFkPlan
19/10/08 22:58:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1452L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/08 22:58:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1452L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#1454L AS rid_0#1471L, val_part_p_name_prf#1455 AS val_part_p_name_prf_0#1472, val_part_p_mfgr_prf#1456 AS val_part_p_mfgr_prf_0#1473, val_part_p_type_prf#1457 AS val_part_p_type_prf_0#1474, val_part_p_size_prf#1458 AS val_part_p_size_prf_0#1475, val_part_p_container_prf#1459 AS val_part_p_container_prf_0#1476, val_part_p_retailprice_prf#1460 AS val_part_p_retailprice_prf_0#1477, val_part_p_comment_prf#1461 AS val_part_p_comment_prf_0#1478, val_part_p_brand_prf#1462 AS val_part_p_brand_prf_0#1479, p_name_prf#1463 AS p_name_prf_0#1480, p_mfgr_prf#1464 AS p_mfgr_prf_0#1481, p_type_prf#1465 AS p_type_prf_0#1482, p_size_prf#1466 AS p_size_prf_0#1483, p_container_prf#1467 AS p_container_prf_0#1484, p_retailprice_prf#1468 AS p_retailprice_prf_0#1485, p_comment_prf#1469 AS p_comment_prf_0#1486, p_brand_prf#1470 AS p_brand_prf_0#1487]
         :  :  +- Relation[rid#1454L,val_part_p_name_prf#1455,val_part_p_mfgr_prf#1456,val_part_p_type_prf#1457,val_part_p_size_prf#1458,val_part_p_container_prf#1459,val_part_p_retailprice_prf#1460,val_part_p_comment_prf#1461,val_part_p_brand_prf#1462,p_name_prf#1463,p_mfgr_prf#1464,p_type_prf#1465,p_size_prf#1466,p_container_prf#1467,p_retailprice_prf#1468,p_comment_prf#1469,p_brand_prf#1470] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, pfk_part_partsupp_prf, 'pfk_part_partsupp_prf_1, part_prf, 'rid_0, partsupp_prf, 'rid_1
         :     :- Project [rid#1510L AS rid_0#1527L, val_part_p_name_prf#1511 AS val_part_p_name_prf_0#1528, val_part_p_mfgr_prf#1512 AS val_part_p_mfgr_prf_0#1529, val_part_p_type_prf#1513 AS val_part_p_type_prf_0#1530, val_part_p_size_prf#1514 AS val_part_p_size_prf_0#1531, val_part_p_container_prf#1515 AS val_part_p_container_prf_0#1532, val_part_p_retailprice_prf#1516 AS val_part_p_retailprice_prf_0#1533, val_part_p_comment_prf#1517 AS val_part_p_comment_prf_0#1534, val_part_p_brand_prf#1518 AS val_part_p_brand_prf_0#1535, p_name_prf#1519 AS p_name_prf_0#1536, p_mfgr_prf#1520 AS p_mfgr_prf_0#1537, p_type_prf#1521 AS p_type_prf_0#1538, p_size_prf#1522 AS p_size_prf_0#1539, p_container_prf#1523 AS p_container_prf_0#1540, p_retailprice_prf#1524 AS p_retailprice_prf_0#1541, p_comment_prf#1525 AS p_comment_prf_0#1542, p_brand_prf#1526 AS p_brand_prf_0#1543]
         :     :  +- Relation[rid#1510L,val_part_p_name_prf#1511,val_part_p_mfgr_prf#1512,val_part_p_type_prf#1513,val_part_p_size_prf#1514,val_part_p_container_prf#1515,val_part_p_retailprice_prf#1516,val_part_p_comment_prf#1517,val_part_p_brand_prf#1518,p_name_prf#1519,p_mfgr_prf#1520,p_type_prf#1521,p_size_prf#1522,p_container_prf#1523,p_retailprice_prf#1524,p_comment_prf#1525,p_brand_prf#1526] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Project [rid#1544L AS rid_1#1555L, pfk_part_partsupp_prf#1545 AS pfk_part_partsupp_prf_1#1556, fpk_partsupp_part_prf#1546 AS fpk_partsupp_part_prf_1#1557, pfk_supplier_partsupp_prf#1547 AS pfk_supplier_partsupp_prf_1#1558, fpk_partsupp_supplier_prf#1548 AS fpk_partsupp_supplier_prf_1#1559, val_partsupp_ps_availqty_prf#1549 AS val_partsupp_ps_availqty_prf_1#1560, val_partsupp_ps_supplycost_prf#1550 AS val_partsupp_ps_supplycost_prf_1#1561, val_partsupp_ps_comment_prf#1551 AS val_partsupp_ps_comment_prf_1#1562, ps_availqty_prf#1552 AS ps_availqty_prf_1#1563, ps_supplycost_prf#1553 AS ps_supplycost_prf_1#1564, ps_comment_prf#1554 AS ps_comment_prf_1#1565]
         :        +- Relation[rid#1544L,pfk_part_partsupp_prf#1545,fpk_partsupp_part_prf#1546,pfk_supplier_partsupp_prf#1547,fpk_partsupp_supplier_prf#1548,val_partsupp_ps_availqty_prf#1549,val_partsupp_ps_supplycost_prf#1550,val_partsupp_ps_comment_prf#1551,ps_availqty_prf#1552,ps_supplycost_prf#1553,ps_comment_prf#1554] JDBCRelation(partsupp_prf) [numPartitions=1]
         +- Project [rid#1488L AS rid_1#1499L, pfk_part_partsupp_prf#1489 AS pfk_part_partsupp_prf_1#1500, fpk_partsupp_part_prf#1490 AS fpk_partsupp_part_prf_1#1501, pfk_supplier_partsupp_prf#1491 AS pfk_supplier_partsupp_prf_1#1502, fpk_partsupp_supplier_prf#1492 AS fpk_partsupp_supplier_prf_1#1503, val_partsupp_ps_availqty_prf#1493 AS val_partsupp_ps_availqty_prf_1#1504, val_partsupp_ps_supplycost_prf#1494 AS val_partsupp_ps_supplycost_prf_1#1505, val_partsupp_ps_comment_prf#1495 AS val_partsupp_ps_comment_prf_1#1506, ps_availqty_prf#1496 AS ps_availqty_prf_1#1507, ps_supplycost_prf#1497 AS ps_supplycost_prf_1#1508, ps_comment_prf#1498 AS ps_comment_prf_1#1509]
            +- Relation[rid#1488L,pfk_part_partsupp_prf#1489,fpk_partsupp_part_prf#1490,pfk_supplier_partsupp_prf#1491,fpk_partsupp_supplier_prf#1492,val_partsupp_ps_availqty_prf#1493,val_partsupp_ps_supplycost_prf#1494,val_partsupp_ps_comment_prf#1495,ps_availqty_prf#1496,ps_supplycost_prf#1497,ps_comment_prf#1498] JDBCRelation(partsupp_prf) [numPartitions=1]

dex-class org.apache.spark.sql.dex.DexPkFk$ result size=800000
Elapsed time: 3505ms

 Q5

q5a=

select
  n_name
from
  customer, supplier, nation, region
where
  r_name = 'ASIA'
  and r_regionkey = n_regionkey
  and n_nationkey = c_nationkey
  and n_nationkey = s_nationkey
      
postgres result size=12093991
Elapsed time: 3839ms
19/10/08 22:59:02 WARN DexPlanner: dexPlan=DexPkFkPlan
19/10/08 22:59:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1651L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter ((isnotnull(r_name#117) && (r_name#117 = ASIA)) && isnotnull(r_regionkey#116L))
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Filter (isnotnull(n_regionkey#110L) && isnotnull(n_nationkey#108L))
         :     :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [c_nationkey#293L]
         :        +- Filter isnotnull(c_nationkey#293L)
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/08 22:59:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1651L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_3))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#1653L AS rid_0#1658L, val_region_r_name_prf#1654 AS val_region_r_name_prf_0#1659, val_region_r_comment_prf#1655 AS val_region_r_comment_prf_0#1660, r_name_prf#1656 AS r_name_prf_0#1661, r_comment_prf#1657 AS r_comment_prf_0#1662]
         :  :  :  :  :  :  :  +- Relation[rid#1653L,val_region_r_name_prf#1654,val_region_r_comment_prf#1655,r_name_prf#1656,r_comment_prf#1657] JDBCRelation(region_prf) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, val_region_r_name_prf, 'val_region_r_name_prf_0, region_prf, 'rid_0
         :  :  :  :  :  :     +- Project [rid#1663L AS rid_0#1668L, val_region_r_name_prf#1664 AS val_region_r_name_prf_0#1669, val_region_r_comment_prf#1665 AS val_region_r_comment_prf_0#1670, r_name_prf#1666 AS r_name_prf_0#1671, r_comment_prf#1667 AS r_comment_prf_0#1672]
         :  :  :  :  :  :        +- Relation[rid#1663L,val_region_r_name_prf#1664,val_region_r_comment_prf#1665,r_name_prf#1666,r_comment_prf#1667] JDBCRelation(region_prf) [numPartitions=1]
         :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, pfk_region_nation_prf, 'pfk_region_nation_prf_1, region_prf, 'rid_0, nation_prf, 'rid_1
         :  :  :  :  :     :- Project [rid#1687L AS rid_0#1692L, val_region_r_name_prf#1688 AS val_region_r_name_prf_0#1693, val_region_r_comment_prf#1689 AS val_region_r_comment_prf_0#1694, r_name_prf#1690 AS r_name_prf_0#1695, r_comment_prf#1691 AS r_comment_prf_0#1696]
         :  :  :  :  :     :  +- Relation[rid#1687L,val_region_r_name_prf#1688,val_region_r_comment_prf#1689,r_name_prf#1690,r_comment_prf#1691] JDBCRelation(region_prf) [numPartitions=1]
         :  :  :  :  :     +- Project [rid#1697L AS rid_1#1704L, pfk_region_nation_prf#1698 AS pfk_region_nation_prf_1#1705, fpk_nation_region_prf#1699 AS fpk_nation_region_prf_1#1706, val_nation_n_name_prf#1700 AS val_nation_n_name_prf_1#1707, val_nation_n_comment_prf#1701 AS val_nation_n_comment_prf_1#1708, n_name_prf#1702 AS n_name_prf_1#1709, n_comment_prf#1703 AS n_comment_prf_1#1710]
         :  :  :  :  :        +- Relation[rid#1697L,pfk_region_nation_prf#1698,fpk_nation_region_prf#1699,val_nation_n_name_prf#1700,val_nation_n_comment_prf#1701,n_name_prf#1702,n_comment_prf#1703] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  :  +- Project [rid#1673L AS rid_1#1680L, pfk_region_nation_prf#1674 AS pfk_region_nation_prf_1#1681, fpk_nation_region_prf#1675 AS fpk_nation_region_prf_1#1682, val_nation_n_name_prf#1676 AS val_nation_n_name_prf_1#1683, val_nation_n_comment_prf#1677 AS val_nation_n_comment_prf_1#1684, n_name_prf#1678 AS n_name_prf_1#1685, n_comment_prf#1679 AS n_comment_prf_1#1686]
         :  :  :  :     +- Relation[rid#1673L,pfk_region_nation_prf#1674,fpk_nation_region_prf#1675,val_nation_n_name_prf#1676,val_nation_n_comment_prf#1677,n_name_prf#1678,n_comment_prf#1679] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, pfk_nation_customer_prf, 'pfk_nation_customer_prf_2, nation_prf, 'rid_1, customer_prf, 'rid_2
         :  :  :     :- Project [rid#1741L AS rid_1#1748L, pfk_region_nation_prf#1742 AS pfk_region_nation_prf_1#1749, fpk_nation_region_prf#1743 AS fpk_nation_region_prf_1#1750, val_nation_n_name_prf#1744 AS val_nation_n_name_prf_1#1751, val_nation_n_comment_prf#1745 AS val_nation_n_comment_prf_1#1752, n_name_prf#1746 AS n_name_prf_1#1753, n_comment_prf#1747 AS n_comment_prf_1#1754]
         :  :  :     :  +- Relation[rid#1741L,pfk_region_nation_prf#1742,fpk_nation_region_prf#1743,val_nation_n_name_prf#1744,val_nation_n_comment_prf#1745,n_name_prf#1746,n_comment_prf#1747] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     +- Project [rid#1755L AS rid_2#1770L, pfk_nation_customer_prf#1756 AS pfk_nation_customer_prf_2#1771, fpk_customer_nation_prf#1757 AS fpk_customer_nation_prf_2#1772, val_customer_c_name_prf#1758 AS val_customer_c_name_prf_2#1773, val_customer_c_address_prf#1759 AS val_customer_c_address_prf_2#1774, val_customer_c_phone_prf#1760 AS val_customer_c_phone_prf_2#1775, val_customer_c_acctbal_prf#1761 AS val_customer_c_acctbal_prf_2#1776, val_customer_c_comment_prf#1762 AS val_customer_c_comment_prf_2#1777, val_customer_c_mktsegment_prf#1763 AS val_customer_c_mktsegment_prf_2#1778, c_name_prf#1764 AS c_name_prf_2#1779, c_address_prf#1765 AS c_address_prf_2#1780, c_phone_prf#1766 AS c_phone_prf_2#1781, c_acctbal_prf#1767 AS c_acctbal_prf_2#1782, c_comment_prf#1768 AS c_comment_prf_2#1783, c_mktsegment_prf#1769 AS c_mktsegment_prf_2#1784]
         :  :  :        +- Relation[rid#1755L,pfk_nation_customer_prf#1756,fpk_customer_nation_prf#1757,val_customer_c_name_prf#1758,val_customer_c_address_prf#1759,val_customer_c_phone_prf#1760,val_customer_c_acctbal_prf#1761,val_customer_c_comment_prf#1762,val_customer_c_mktsegment_prf#1763,c_name_prf#1764,c_address_prf#1765,c_phone_prf#1766,c_acctbal_prf#1767,c_comment_prf#1768,c_mktsegment_prf#1769] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  +- Project [rid#1711L AS rid_2#1726L, pfk_nation_customer_prf#1712 AS pfk_nation_customer_prf_2#1727, fpk_customer_nation_prf#1713 AS fpk_customer_nation_prf_2#1728, val_customer_c_name_prf#1714 AS val_customer_c_name_prf_2#1729, val_customer_c_address_prf#1715 AS val_customer_c_address_prf_2#1730, val_customer_c_phone_prf#1716 AS val_customer_c_phone_prf_2#1731, val_customer_c_acctbal_prf#1717 AS val_customer_c_acctbal_prf_2#1732, val_customer_c_comment_prf#1718 AS val_customer_c_comment_prf_2#1733, val_customer_c_mktsegment_prf#1719 AS val_customer_c_mktsegment_prf_2#1734, c_name_prf#1720 AS c_name_prf_2#1735, c_address_prf#1721 AS c_address_prf_2#1736, c_phone_prf#1722 AS c_phone_prf_2#1737, c_acctbal_prf#1723 AS c_acctbal_prf_2#1738, c_comment_prf#1724 AS c_comment_prf_2#1739, c_mktsegment_prf#1725 AS c_mktsegment_prf_2#1740]
         :  :     +- Relation[rid#1711L,pfk_nation_customer_prf#1712,fpk_customer_nation_prf#1713,val_customer_c_name_prf#1714,val_customer_c_address_prf#1715,val_customer_c_phone_prf#1716,val_customer_c_acctbal_prf#1717,val_customer_c_comment_prf#1718,val_customer_c_mktsegment_prf#1719,c_name_prf#1720,c_address_prf#1721,c_phone_prf#1722,c_acctbal_prf#1723,c_comment_prf#1724,c_mktsegment_prf#1725] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, pfk_nation_supplier_prf, 'pfk_nation_supplier_prf_3, nation_prf, 'rid_1, supplier_prf, 'rid_3
         :     :- Project [rid#1811L AS rid_1#1818L, pfk_region_nation_prf#1812 AS pfk_region_nation_prf_1#1819, fpk_nation_region_prf#1813 AS fpk_nation_region_prf_1#1820, val_nation_n_name_prf#1814 AS val_nation_n_name_prf_1#1821, val_nation_n_comment_prf#1815 AS val_nation_n_comment_prf_1#1822, n_name_prf#1816 AS n_name_prf_1#1823, n_comment_prf#1817 AS n_comment_prf_1#1824]
         :     :  +- Relation[rid#1811L,pfk_region_nation_prf#1812,fpk_nation_region_prf#1813,val_nation_n_name_prf#1814,val_nation_n_comment_prf#1815,n_name_prf#1816,n_comment_prf#1817] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Project [rid#1825L AS rid_3#1838L, pfk_nation_supplier_prf#1826 AS pfk_nation_supplier_prf_3#1839, fpk_supplier_nation_prf#1827 AS fpk_supplier_nation_prf_3#1840, val_supplier_s_name_prf#1828 AS val_supplier_s_name_prf_3#1841, val_supplier_s_address_prf#1829 AS val_supplier_s_address_prf_3#1842, val_supplier_s_phone_prf#1830 AS val_supplier_s_phone_prf_3#1843, val_supplier_s_acctbal_prf#1831 AS val_supplier_s_acctbal_prf_3#1844, val_supplier_s_comment_prf#1832 AS val_supplier_s_comment_prf_3#1845, s_name_prf#1833 AS s_name_prf_3#1846, s_address_prf#1834 AS s_address_prf_3#1847, s_phone_prf#1835 AS s_phone_prf_3#1848, s_acctbal_prf#1836 AS s_acctbal_prf_3#1849, s_comment_prf#1837 AS s_comment_prf_3#1850]
         :        +- Relation[rid#1825L,pfk_nation_supplier_prf#1826,fpk_supplier_nation_prf#1827,val_supplier_s_name_prf#1828,val_supplier_s_address_prf#1829,val_supplier_s_phone_prf#1830,val_supplier_s_acctbal_prf#1831,val_supplier_s_comment_prf#1832,s_name_prf#1833,s_address_prf#1834,s_phone_prf#1835,s_acctbal_prf#1836,s_comment_prf#1837] JDBCRelation(supplier_prf) [numPartitions=1]
         +- Project [rid#1785L AS rid_3#1798L, pfk_nation_supplier_prf#1786 AS pfk_nation_supplier_prf_3#1799, fpk_supplier_nation_prf#1787 AS fpk_supplier_nation_prf_3#1800, val_supplier_s_name_prf#1788 AS val_supplier_s_name_prf_3#1801, val_supplier_s_address_prf#1789 AS val_supplier_s_address_prf_3#1802, val_supplier_s_phone_prf#1790 AS val_supplier_s_phone_prf_3#1803, val_supplier_s_acctbal_prf#1791 AS val_supplier_s_acctbal_prf_3#1804, val_supplier_s_comment_prf#1792 AS val_supplier_s_comment_prf_3#1805, s_name_prf#1793 AS s_name_prf_3#1806, s_address_prf#1794 AS s_address_prf_3#1807, s_phone_prf#1795 AS s_phone_prf_3#1808, s_acctbal_prf#1796 AS s_acctbal_prf_3#1809, s_comment_prf#1797 AS s_comment_prf_3#1810]
            +- Relation[rid#1785L,pfk_nation_supplier_prf#1786,fpk_supplier_nation_prf#1787,val_supplier_s_name_prf#1788,val_supplier_s_address_prf#1789,val_supplier_s_phone_prf#1790,val_supplier_s_acctbal_prf#1791,val_supplier_s_comment_prf#1792,s_name_prf#1793,s_address_prf#1794,s_phone_prf#1795,s_acctbal_prf#1796,s_comment_prf#1797] JDBCRelation(supplier_prf) [numPartitions=1]

dex-class org.apache.spark.sql.dex.DexPkFk$ result size=12093991
Elapsed time: 18241ms

q5a2=

select
  n_name
from
  customer, supplier, nation, region
where
  r_name = 'ASIA'
  and r_regionkey = n_regionkey
  and n_nationkey = c_nationkey
  and n_nationkey = s_nationkey
      
postgres result size=12093991
Elapsed time: 3788ms
19/10/08 22:59:24 WARN DexPlanner: dexPlan=DexPkFkPlan
19/10/08 22:59:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1953L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :- Project [s_nationkey#21L]
         :  +- Filter isnotnull(s_nationkey#21L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (n_regionkey#110L = r_regionkey#116L)
               :- Project [n_nationkey#108L, n_regionkey#110L]
               :  +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
               :     :- Project [c_nationkey#293L]
               :     :  +- Filter isnotnull(c_nationkey#293L)
               :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               :     +- Project [n_nationkey#108L, n_regionkey#110L]
               :        +- Filter (isnotnull(n_nationkey#108L) && isnotnull(n_regionkey#110L))
               :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [r_regionkey#116L]
                  +- Filter ((isnotnull(r_name#117) && (r_name#117 = ASIA)) && isnotnull(r_regionkey#116L))
                     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/08 22:59:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1953L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (cast(dexdecrypt(concat(supplier~nation, ~, 'rid_0), 'fpk_supplier_nation_prf_0) as bigint) = 'rid_2)
            :- Project [rid#1955L AS rid_0#1968L, pfk_nation_supplier_prf#1956 AS pfk_nation_supplier_prf_0#1969, fpk_supplier_nation_prf#1957 AS fpk_supplier_nation_prf_0#1970, val_supplier_s_name_prf#1958 AS val_supplier_s_name_prf_0#1971, val_supplier_s_address_prf#1959 AS val_supplier_s_address_prf_0#1972, val_supplier_s_phone_prf#1960 AS val_supplier_s_phone_prf_0#1973, val_supplier_s_acctbal_prf#1961 AS val_supplier_s_acctbal_prf_0#1974, val_supplier_s_comment_prf#1962 AS val_supplier_s_comment_prf_0#1975, s_name_prf#1963 AS s_name_prf_0#1976, s_address_prf#1964 AS s_address_prf_0#1977, s_phone_prf#1965 AS s_phone_prf_0#1978, s_acctbal_prf#1966 AS s_acctbal_prf_0#1979, s_comment_prf#1967 AS s_comment_prf_0#1980]
            :  +- Relation[rid#1955L,pfk_nation_supplier_prf#1956,fpk_supplier_nation_prf#1957,val_supplier_s_name_prf#1958,val_supplier_s_address_prf#1959,val_supplier_s_phone_prf#1960,val_supplier_s_acctbal_prf#1961,val_supplier_s_comment_prf#1962,s_name_prf#1963,s_address_prf#1964,s_phone_prf#1965,s_acctbal_prf#1966,s_comment_prf#1967] JDBCRelation(supplier_prf) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (cast(dexdecrypt(concat(nation~region, ~, 'rid_2), 'fpk_nation_region_prf_2) as bigint) = 'rid_3)
                  :- 'Project [*]
                  :  +- 'Join Inner, (cast(dexdecrypt(concat(customer~nation, ~, 'rid_1), 'fpk_customer_nation_prf_1) as bigint) = 'rid_2)
                  :     :- Project [rid#1981L AS rid_1#1996L, pfk_nation_customer_prf#1982 AS pfk_nation_customer_prf_1#1997, fpk_customer_nation_prf#1983 AS fpk_customer_nation_prf_1#1998, val_customer_c_name_prf#1984 AS val_customer_c_name_prf_1#1999, val_customer_c_address_prf#1985 AS val_customer_c_address_prf_1#2000, val_customer_c_phone_prf#1986 AS val_customer_c_phone_prf_1#2001, val_customer_c_acctbal_prf#1987 AS val_customer_c_acctbal_prf_1#2002, val_customer_c_comment_prf#1988 AS val_customer_c_comment_prf_1#2003, val_customer_c_mktsegment_prf#1989 AS val_customer_c_mktsegment_prf_1#2004, c_name_prf#1990 AS c_name_prf_1#2005, c_address_prf#1991 AS c_address_prf_1#2006, c_phone_prf#1992 AS c_phone_prf_1#2007, c_acctbal_prf#1993 AS c_acctbal_prf_1#2008, c_comment_prf#1994 AS c_comment_prf_1#2009, c_mktsegment_prf#1995 AS c_mktsegment_prf_1#2010]
                  :     :  +- Relation[rid#1981L,pfk_nation_customer_prf#1982,fpk_customer_nation_prf#1983,val_customer_c_name_prf#1984,val_customer_c_address_prf#1985,val_customer_c_phone_prf#1986,val_customer_c_acctbal_prf#1987,val_customer_c_comment_prf#1988,val_customer_c_mktsegment_prf#1989,c_name_prf#1990,c_address_prf#1991,c_phone_prf#1992,c_acctbal_prf#1993,c_comment_prf#1994,c_mktsegment_prf#1995] JDBCRelation(customer_prf) [numPartitions=1]
                  :     +- Project [rid#2011L AS rid_2#2018L, pfk_region_nation_prf#2012 AS pfk_region_nation_prf_2#2019, fpk_nation_region_prf#2013 AS fpk_nation_region_prf_2#2020, val_nation_n_name_prf#2014 AS val_nation_n_name_prf_2#2021, val_nation_n_comment_prf#2015 AS val_nation_n_comment_prf_2#2022, n_name_prf#2016 AS n_name_prf_2#2023, n_comment_prf#2017 AS n_comment_prf_2#2024]
                  :        +- Relation[rid#2011L,pfk_region_nation_prf#2012,fpk_nation_region_prf#2013,val_nation_n_name_prf#2014,val_nation_n_comment_prf#2015,n_name_prf#2016,n_comment_prf#2017] JDBCRelation(nation_prf) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_3))
                     :- Project [rid#2025L AS rid_3#2030L, val_region_r_name_prf#2026 AS val_region_r_name_prf_3#2031, val_region_r_comment_prf#2027 AS val_region_r_comment_prf_3#2032, r_name_prf#2028 AS r_name_prf_3#2033, r_comment_prf#2029 AS r_comment_prf_3#2034]
                     :  +- Relation[rid#2025L,val_region_r_name_prf#2026,val_region_r_comment_prf#2027,r_name_prf#2028,r_comment_prf#2029] JDBCRelation(region_prf) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, val_region_r_name_prf, 'val_region_r_name_prf_3, region_prf, 'rid_3
                        +- Project [rid#2035L AS rid_3#2040L, val_region_r_name_prf#2036 AS val_region_r_name_prf_3#2041, val_region_r_comment_prf#2037 AS val_region_r_comment_prf_3#2042, r_name_prf#2038 AS r_name_prf_3#2043, r_comment_prf#2039 AS r_comment_prf_3#2044]
                           +- Relation[rid#2035L,val_region_r_name_prf#2036,val_region_r_comment_prf#2037,r_name_prf#2038,r_comment_prf#2039] JDBCRelation(region_prf) [numPartitions=1]

dex-class org.apache.spark.sql.dex.DexPkFk$ result size=12093991
Elapsed time: 8109ms

q5b=

select
  n_name
from
  customer, supplier, nation, region
where
  r_regionkey = n_regionkey
  and n_nationkey = c_nationkey
  and n_nationkey = s_nationkey
      
postgres result size=60000414
Elapsed time: 51937ms
19/10/08 23:00:24 WARN DexPlanner: dexPlan=DexPkFkPlan
19/10/08 23:00:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2142L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter isnotnull(r_regionkey#116L)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Filter (isnotnull(n_regionkey#110L) && isnotnull(n_nationkey#108L))
         :     :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [c_nationkey#293L]
         :        +- Filter isnotnull(c_nationkey#293L)
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/08 23:00:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2142L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_3))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- Project [rid#2144L AS rid_0#2149L, val_region_r_name_prf#2145 AS val_region_r_name_prf_0#2150, val_region_r_comment_prf#2146 AS val_region_r_comment_prf_0#2151, r_name_prf#2147 AS r_name_prf_0#2152, r_comment_prf#2148 AS r_comment_prf_0#2153]
         :  :  :  :  :  :  +- Relation[rid#2144L,val_region_r_name_prf#2145,val_region_r_comment_prf#2146,r_name_prf#2147,r_comment_prf#2148] JDBCRelation(region_prf) [numPartitions=1]
         :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, pfk_region_nation_prf, 'pfk_region_nation_prf_1, region_prf, 'rid_0, nation_prf, 'rid_1
         :  :  :  :  :     :- Project [rid#2168L AS rid_0#2173L, val_region_r_name_prf#2169 AS val_region_r_name_prf_0#2174, val_region_r_comment_prf#2170 AS val_region_r_comment_prf_0#2175, r_name_prf#2171 AS r_name_prf_0#2176, r_comment_prf#2172 AS r_comment_prf_0#2177]
         :  :  :  :  :     :  +- Relation[rid#2168L,val_region_r_name_prf#2169,val_region_r_comment_prf#2170,r_name_prf#2171,r_comment_prf#2172] JDBCRelation(region_prf) [numPartitions=1]
         :  :  :  :  :     +- Project [rid#2178L AS rid_1#2185L, pfk_region_nation_prf#2179 AS pfk_region_nation_prf_1#2186, fpk_nation_region_prf#2180 AS fpk_nation_region_prf_1#2187, val_nation_n_name_prf#2181 AS val_nation_n_name_prf_1#2188, val_nation_n_comment_prf#2182 AS val_nation_n_comment_prf_1#2189, n_name_prf#2183 AS n_name_prf_1#2190, n_comment_prf#2184 AS n_comment_prf_1#2191]
         :  :  :  :  :        +- Relation[rid#2178L,pfk_region_nation_prf#2179,fpk_nation_region_prf#2180,val_nation_n_name_prf#2181,val_nation_n_comment_prf#2182,n_name_prf#2183,n_comment_prf#2184] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  :  +- Project [rid#2154L AS rid_1#2161L, pfk_region_nation_prf#2155 AS pfk_region_nation_prf_1#2162, fpk_nation_region_prf#2156 AS fpk_nation_region_prf_1#2163, val_nation_n_name_prf#2157 AS val_nation_n_name_prf_1#2164, val_nation_n_comment_prf#2158 AS val_nation_n_comment_prf_1#2165, n_name_prf#2159 AS n_name_prf_1#2166, n_comment_prf#2160 AS n_comment_prf_1#2167]
         :  :  :  :     +- Relation[rid#2154L,pfk_region_nation_prf#2155,fpk_nation_region_prf#2156,val_nation_n_name_prf#2157,val_nation_n_comment_prf#2158,n_name_prf#2159,n_comment_prf#2160] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, pfk_nation_customer_prf, 'pfk_nation_customer_prf_2, nation_prf, 'rid_1, customer_prf, 'rid_2
         :  :  :     :- Project [rid#2222L AS rid_1#2229L, pfk_region_nation_prf#2223 AS pfk_region_nation_prf_1#2230, fpk_nation_region_prf#2224 AS fpk_nation_region_prf_1#2231, val_nation_n_name_prf#2225 AS val_nation_n_name_prf_1#2232, val_nation_n_comment_prf#2226 AS val_nation_n_comment_prf_1#2233, n_name_prf#2227 AS n_name_prf_1#2234, n_comment_prf#2228 AS n_comment_prf_1#2235]
         :  :  :     :  +- Relation[rid#2222L,pfk_region_nation_prf#2223,fpk_nation_region_prf#2224,val_nation_n_name_prf#2225,val_nation_n_comment_prf#2226,n_name_prf#2227,n_comment_prf#2228] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     +- Project [rid#2236L AS rid_2#2251L, pfk_nation_customer_prf#2237 AS pfk_nation_customer_prf_2#2252, fpk_customer_nation_prf#2238 AS fpk_customer_nation_prf_2#2253, val_customer_c_name_prf#2239 AS val_customer_c_name_prf_2#2254, val_customer_c_address_prf#2240 AS val_customer_c_address_prf_2#2255, val_customer_c_phone_prf#2241 AS val_customer_c_phone_prf_2#2256, val_customer_c_acctbal_prf#2242 AS val_customer_c_acctbal_prf_2#2257, val_customer_c_comment_prf#2243 AS val_customer_c_comment_prf_2#2258, val_customer_c_mktsegment_prf#2244 AS val_customer_c_mktsegment_prf_2#2259, c_name_prf#2245 AS c_name_prf_2#2260, c_address_prf#2246 AS c_address_prf_2#2261, c_phone_prf#2247 AS c_phone_prf_2#2262, c_acctbal_prf#2248 AS c_acctbal_prf_2#2263, c_comment_prf#2249 AS c_comment_prf_2#2264, c_mktsegment_prf#2250 AS c_mktsegment_prf_2#2265]
         :  :  :        +- Relation[rid#2236L,pfk_nation_customer_prf#2237,fpk_customer_nation_prf#2238,val_customer_c_name_prf#2239,val_customer_c_address_prf#2240,val_customer_c_phone_prf#2241,val_customer_c_acctbal_prf#2242,val_customer_c_comment_prf#2243,val_customer_c_mktsegment_prf#2244,c_name_prf#2245,c_address_prf#2246,c_phone_prf#2247,c_acctbal_prf#2248,c_comment_prf#2249,c_mktsegment_prf#2250] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  +- Project [rid#2192L AS rid_2#2207L, pfk_nation_customer_prf#2193 AS pfk_nation_customer_prf_2#2208, fpk_customer_nation_prf#2194 AS fpk_customer_nation_prf_2#2209, val_customer_c_name_prf#2195 AS val_customer_c_name_prf_2#2210, val_customer_c_address_prf#2196 AS val_customer_c_address_prf_2#2211, val_customer_c_phone_prf#2197 AS val_customer_c_phone_prf_2#2212, val_customer_c_acctbal_prf#2198 AS val_customer_c_acctbal_prf_2#2213, val_customer_c_comment_prf#2199 AS val_customer_c_comment_prf_2#2214, val_customer_c_mktsegment_prf#2200 AS val_customer_c_mktsegment_prf_2#2215, c_name_prf#2201 AS c_name_prf_2#2216, c_address_prf#2202 AS c_address_prf_2#2217, c_phone_prf#2203 AS c_phone_prf_2#2218, c_acctbal_prf#2204 AS c_acctbal_prf_2#2219, c_comment_prf#2205 AS c_comment_prf_2#2220, c_mktsegment_prf#2206 AS c_mktsegment_prf_2#2221]
         :  :     +- Relation[rid#2192L,pfk_nation_customer_prf#2193,fpk_customer_nation_prf#2194,val_customer_c_name_prf#2195,val_customer_c_address_prf#2196,val_customer_c_phone_prf#2197,val_customer_c_acctbal_prf#2198,val_customer_c_comment_prf#2199,val_customer_c_mktsegment_prf#2200,c_name_prf#2201,c_address_prf#2202,c_phone_prf#2203,c_acctbal_prf#2204,c_comment_prf#2205,c_mktsegment_prf#2206] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, pfk_nation_supplier_prf, 'pfk_nation_supplier_prf_3, nation_prf, 'rid_1, supplier_prf, 'rid_3
         :     :- Project [rid#2292L AS rid_1#2299L, pfk_region_nation_prf#2293 AS pfk_region_nation_prf_1#2300, fpk_nation_region_prf#2294 AS fpk_nation_region_prf_1#2301, val_nation_n_name_prf#2295 AS val_nation_n_name_prf_1#2302, val_nation_n_comment_prf#2296 AS val_nation_n_comment_prf_1#2303, n_name_prf#2297 AS n_name_prf_1#2304, n_comment_prf#2298 AS n_comment_prf_1#2305]
         :     :  +- Relation[rid#2292L,pfk_region_nation_prf#2293,fpk_nation_region_prf#2294,val_nation_n_name_prf#2295,val_nation_n_comment_prf#2296,n_name_prf#2297,n_comment_prf#2298] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Project [rid#2306L AS rid_3#2319L, pfk_nation_supplier_prf#2307 AS pfk_nation_supplier_prf_3#2320, fpk_supplier_nation_prf#2308 AS fpk_supplier_nation_prf_3#2321, val_supplier_s_name_prf#2309 AS val_supplier_s_name_prf_3#2322, val_supplier_s_address_prf#2310 AS val_supplier_s_address_prf_3#2323, val_supplier_s_phone_prf#2311 AS val_supplier_s_phone_prf_3#2324, val_supplier_s_acctbal_prf#2312 AS val_supplier_s_acctbal_prf_3#2325, val_supplier_s_comment_prf#2313 AS val_supplier_s_comment_prf_3#2326, s_name_prf#2314 AS s_name_prf_3#2327, s_address_prf#2315 AS s_address_prf_3#2328, s_phone_prf#2316 AS s_phone_prf_3#2329, s_acctbal_prf#2317 AS s_acctbal_prf_3#2330, s_comment_prf#2318 AS s_comment_prf_3#2331]
         :        +- Relation[rid#2306L,pfk_nation_supplier_prf#2307,fpk_supplier_nation_prf#2308,val_supplier_s_name_prf#2309,val_supplier_s_address_prf#2310,val_supplier_s_phone_prf#2311,val_supplier_s_acctbal_prf#2312,val_supplier_s_comment_prf#2313,s_name_prf#2314,s_address_prf#2315,s_phone_prf#2316,s_acctbal_prf#2317,s_comment_prf#2318] JDBCRelation(supplier_prf) [numPartitions=1]
         +- Project [rid#2266L AS rid_3#2279L, pfk_nation_supplier_prf#2267 AS pfk_nation_supplier_prf_3#2280, fpk_supplier_nation_prf#2268 AS fpk_supplier_nation_prf_3#2281, val_supplier_s_name_prf#2269 AS val_supplier_s_name_prf_3#2282, val_supplier_s_address_prf#2270 AS val_supplier_s_address_prf_3#2283, val_supplier_s_phone_prf#2271 AS val_supplier_s_phone_prf_3#2284, val_supplier_s_acctbal_prf#2272 AS val_supplier_s_acctbal_prf_3#2285, val_supplier_s_comment_prf#2273 AS val_supplier_s_comment_prf_3#2286, s_name_prf#2274 AS s_name_prf_3#2287, s_address_prf#2275 AS s_address_prf_3#2288, s_phone_prf#2276 AS s_phone_prf_3#2289, s_acctbal_prf#2277 AS s_acctbal_prf_3#2290, s_comment_prf#2278 AS s_comment_prf_3#2291]
            +- Relation[rid#2266L,pfk_nation_supplier_prf#2267,fpk_supplier_nation_prf#2268,val_supplier_s_name_prf#2269,val_supplier_s_address_prf#2270,val_supplier_s_phone_prf#2271,val_supplier_s_acctbal_prf#2272,val_supplier_s_comment_prf#2273,s_name_prf#2274,s_address_prf#2275,s_phone_prf#2276,s_acctbal_prf#2277,s_comment_prf#2278] JDBCRelation(supplier_prf) [numPartitions=1]

dex-class org.apache.spark.sql.dex.DexPkFk$ result size=60000414
Elapsed time: 111666ms

q5b2=

select
  n_name
from
  customer, supplier, nation, region
where
  r_regionkey = n_regionkey
  and n_nationkey = c_nationkey
  and n_nationkey = s_nationkey
      
postgres result size=60000414
Elapsed time: 54134ms
19/10/08 23:03:09 WARN DexPlanner: dexPlan=DexPkFkPlan
19/10/08 23:03:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2438L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (n_regionkey#110L = r_regionkey#116L)
         :- Project [n_regionkey#110L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :        +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :           :- Project [c_nationkey#293L]
         :           :  +- Filter isnotnull(c_nationkey#293L)
         :           :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :           +- Project [n_nationkey#108L, n_regionkey#110L]
         :              +- Filter (isnotnull(n_nationkey#108L) && isnotnull(n_regionkey#110L))
         :                 +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [r_regionkey#116L]
            +- Filter isnotnull(r_regionkey#116L)
               +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/08 23:03:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2438L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (cast(dexdecrypt(concat(nation~region, ~, 'rid_2), 'fpk_nation_region_prf_2) as bigint) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (cast(dexdecrypt(concat(supplier~nation, ~, 'rid_0), 'fpk_supplier_nation_prf_0) as bigint) = 'rid_2)
            :     :- Project [rid#2440L AS rid_0#2453L, pfk_nation_supplier_prf#2441 AS pfk_nation_supplier_prf_0#2454, fpk_supplier_nation_prf#2442 AS fpk_supplier_nation_prf_0#2455, val_supplier_s_name_prf#2443 AS val_supplier_s_name_prf_0#2456, val_supplier_s_address_prf#2444 AS val_supplier_s_address_prf_0#2457, val_supplier_s_phone_prf#2445 AS val_supplier_s_phone_prf_0#2458, val_supplier_s_acctbal_prf#2446 AS val_supplier_s_acctbal_prf_0#2459, val_supplier_s_comment_prf#2447 AS val_supplier_s_comment_prf_0#2460, s_name_prf#2448 AS s_name_prf_0#2461, s_address_prf#2449 AS s_address_prf_0#2462, s_phone_prf#2450 AS s_phone_prf_0#2463, s_acctbal_prf#2451 AS s_acctbal_prf_0#2464, s_comment_prf#2452 AS s_comment_prf_0#2465]
            :     :  +- Relation[rid#2440L,pfk_nation_supplier_prf#2441,fpk_supplier_nation_prf#2442,val_supplier_s_name_prf#2443,val_supplier_s_address_prf#2444,val_supplier_s_phone_prf#2445,val_supplier_s_acctbal_prf#2446,val_supplier_s_comment_prf#2447,s_name_prf#2448,s_address_prf#2449,s_phone_prf#2450,s_acctbal_prf#2451,s_comment_prf#2452] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- 'Project [*]
            :        +- 'Join Inner, (cast(dexdecrypt(concat(customer~nation, ~, 'rid_1), 'fpk_customer_nation_prf_1) as bigint) = 'rid_2)
            :           :- Project [rid#2466L AS rid_1#2481L, pfk_nation_customer_prf#2467 AS pfk_nation_customer_prf_1#2482, fpk_customer_nation_prf#2468 AS fpk_customer_nation_prf_1#2483, val_customer_c_name_prf#2469 AS val_customer_c_name_prf_1#2484, val_customer_c_address_prf#2470 AS val_customer_c_address_prf_1#2485, val_customer_c_phone_prf#2471 AS val_customer_c_phone_prf_1#2486, val_customer_c_acctbal_prf#2472 AS val_customer_c_acctbal_prf_1#2487, val_customer_c_comment_prf#2473 AS val_customer_c_comment_prf_1#2488, val_customer_c_mktsegment_prf#2474 AS val_customer_c_mktsegment_prf_1#2489, c_name_prf#2475 AS c_name_prf_1#2490, c_address_prf#2476 AS c_address_prf_1#2491, c_phone_prf#2477 AS c_phone_prf_1#2492, c_acctbal_prf#2478 AS c_acctbal_prf_1#2493, c_comment_prf#2479 AS c_comment_prf_1#2494, c_mktsegment_prf#2480 AS c_mktsegment_prf_1#2495]
            :           :  +- Relation[rid#2466L,pfk_nation_customer_prf#2467,fpk_customer_nation_prf#2468,val_customer_c_name_prf#2469,val_customer_c_address_prf#2470,val_customer_c_phone_prf#2471,val_customer_c_acctbal_prf#2472,val_customer_c_comment_prf#2473,val_customer_c_mktsegment_prf#2474,c_name_prf#2475,c_address_prf#2476,c_phone_prf#2477,c_acctbal_prf#2478,c_comment_prf#2479,c_mktsegment_prf#2480] JDBCRelation(customer_prf) [numPartitions=1]
            :           +- Project [rid#2496L AS rid_2#2503L, pfk_region_nation_prf#2497 AS pfk_region_nation_prf_2#2504, fpk_nation_region_prf#2498 AS fpk_nation_region_prf_2#2505, val_nation_n_name_prf#2499 AS val_nation_n_name_prf_2#2506, val_nation_n_comment_prf#2500 AS val_nation_n_comment_prf_2#2507, n_name_prf#2501 AS n_name_prf_2#2508, n_comment_prf#2502 AS n_comment_prf_2#2509]
            :              +- Relation[rid#2496L,pfk_region_nation_prf#2497,fpk_nation_region_prf#2498,val_nation_n_name_prf#2499,val_nation_n_comment_prf#2500,n_name_prf#2501,n_comment_prf#2502] JDBCRelation(nation_prf) [numPartitions=1]
            +- Project [rid#2510L AS rid_3#2515L, val_region_r_name_prf#2511 AS val_region_r_name_prf_3#2516, val_region_r_comment_prf#2512 AS val_region_r_comment_prf_3#2517, r_name_prf#2513 AS r_name_prf_3#2518, r_comment_prf#2514 AS r_comment_prf_3#2519]
               +- Relation[rid#2510L,val_region_r_name_prf#2511,val_region_r_comment_prf#2512,r_name_prf#2513,r_comment_prf#2514] JDBCRelation(region_prf) [numPartitions=1]

dex-class org.apache.spark.sql.dex.DexPkFk$ result size=60000414
Elapsed time: 27817ms

Q7

q7a=

select
  n1.n_name as n1_name,
  n2.n_name as n2_name,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    (n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY')
  )
      
postgres result size=9735
Elapsed time: 375ms
19/10/08 23:03:38 WARN DexPlanner: dexPlan=DexPkFkPlan
19/10/08 23:03:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2777L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#2692L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L, c_nationkey#293L]
         :     :  +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_custkey#343L]
         :        +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :           :- Project [o_orderkey#342L, o_custkey#343L]
         :           :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :           +- Project [l_orderkey#306L]
         :              +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :                 :- Project [s_nationkey#21L, l_orderkey#306L]
         :                 :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :                 :     :- Project [s_suppkey#18L, s_nationkey#21L]
         :                 :     :  +- Filter (isnotnull(s_suppkey#18L) && isnotnull(s_nationkey#21L))
         :                 :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :                 :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :                 :        +- Filter (isnotnull(l_suppkey#308L) && isnotnull(l_orderkey#306L))
         :                 :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :                 +- Project [n_nationkey#108L]
         :                    +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :                       +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [n_nationkey#2692L]
            +- Filter ((isnotnull(n_name#2693) && (n_name#2693 = GERMANY)) && isnotnull(n_nationkey#2692L))
               +- Relation[n_nationkey#2692L,n_name#2693,n_regionkey#2694L,n_comment#2695] parquet

19/10/08 23:03:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2777L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (cast(dexdecrypt(concat(customer~nation, ~, 'rid_0), 'fpk_customer_nation_prf_0) as bigint) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :- Project [rid#2779L AS rid_0#2794L, pfk_nation_customer_prf#2780 AS pfk_nation_customer_prf_0#2795, fpk_customer_nation_prf#2781 AS fpk_customer_nation_prf_0#2796, val_customer_c_name_prf#2782 AS val_customer_c_name_prf_0#2797, val_customer_c_address_prf#2783 AS val_customer_c_address_prf_0#2798, val_customer_c_phone_prf#2784 AS val_customer_c_phone_prf_0#2799, val_customer_c_acctbal_prf#2785 AS val_customer_c_acctbal_prf_0#2800, val_customer_c_comment_prf#2786 AS val_customer_c_comment_prf_0#2801, val_customer_c_mktsegment_prf#2787 AS val_customer_c_mktsegment_prf_0#2802, c_name_prf#2788 AS c_name_prf_0#2803, c_address_prf#2789 AS c_address_prf_0#2804, c_phone_prf#2790 AS c_phone_prf_0#2805, c_acctbal_prf#2791 AS c_acctbal_prf_0#2806, c_comment_prf#2792 AS c_comment_prf_0#2807, c_mktsegment_prf#2793 AS c_mktsegment_prf_0#2808]
            :  :  :  +- Relation[rid#2779L,pfk_nation_customer_prf#2780,fpk_customer_nation_prf#2781,val_customer_c_name_prf#2782,val_customer_c_address_prf#2783,val_customer_c_phone_prf#2784,val_customer_c_acctbal_prf#2785,val_customer_c_comment_prf#2786,val_customer_c_mktsegment_prf#2787,c_name_prf#2788,c_address_prf#2789,c_phone_prf#2790,c_acctbal_prf#2791,c_comment_prf#2792,c_mktsegment_prf#2793] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, pfk_customer_orders_prf, 'pfk_customer_orders_prf_1, customer_prf, 'rid_0, orders_prf, 'rid_1
            :  :     :- Project [rid#3155L AS rid_0#3170L, pfk_nation_customer_prf#3156 AS pfk_nation_customer_prf_0#3171, fpk_customer_nation_prf#3157 AS fpk_customer_nation_prf_0#3172, val_customer_c_name_prf#3158 AS val_customer_c_name_prf_0#3173, val_customer_c_address_prf#3159 AS val_customer_c_address_prf_0#3174, val_customer_c_phone_prf#3160 AS val_customer_c_phone_prf_0#3175, val_customer_c_acctbal_prf#3161 AS val_customer_c_acctbal_prf_0#3176, val_customer_c_comment_prf#3162 AS val_customer_c_comment_prf_0#3177, val_customer_c_mktsegment_prf#3163 AS val_customer_c_mktsegment_prf_0#3178, c_name_prf#3164 AS c_name_prf_0#3179, c_address_prf#3165 AS c_address_prf_0#3180, c_phone_prf#3166 AS c_phone_prf_0#3181, c_acctbal_prf#3167 AS c_acctbal_prf_0#3182, c_comment_prf#3168 AS c_comment_prf_0#3183, c_mktsegment_prf#3169 AS c_mktsegment_prf_0#3184]
            :  :     :  +- Relation[rid#3155L,pfk_nation_customer_prf#3156,fpk_customer_nation_prf#3157,val_customer_c_name_prf#3158,val_customer_c_address_prf#3159,val_customer_c_phone_prf#3160,val_customer_c_acctbal_prf#3161,val_customer_c_comment_prf#3162,val_customer_c_mktsegment_prf#3163,c_name_prf#3164,c_address_prf#3165,c_phone_prf#3166,c_acctbal_prf#3167,c_comment_prf#3168,c_mktsegment_prf#3169] JDBCRelation(customer_prf) [numPartitions=1]
            :  :     +- Project [rid#3185L AS rid_1#3202L, pfk_customer_orders_prf#3186 AS pfk_customer_orders_prf_1#3203, fpk_orders_customer_prf#3187 AS fpk_orders_customer_prf_1#3204, val_orders_o_orderstatus_prf#3188 AS val_orders_o_orderstatus_prf_1#3205, val_orders_o_totalprice_prf#3189 AS val_orders_o_totalprice_prf_1#3206, val_orders_o_orderpriority_prf#3190 AS val_orders_o_orderpriority_prf_1#3207, val_orders_o_clerk_prf#3191 AS val_orders_o_clerk_prf_1#3208, val_orders_o_shippriority_prf#3192 AS val_orders_o_shippriority_prf_1#3209, val_orders_o_comment_prf#3193 AS val_orders_o_comment_prf_1#3210, val_orders_o_orderdate_prf#3194 AS val_orders_o_orderdate_prf_1#3211, o_orderstatus_prf#3195 AS o_orderstatus_prf_1#3212, o_totalprice_prf#3196 AS o_totalprice_prf_1#3213, o_orderpriority_prf#3197 AS o_orderpriority_prf_1#3214, o_clerk_prf#3198 AS o_clerk_prf_1#3215, o_shippriority_prf#3199 AS o_shippriority_prf_1#3216, o_comment_prf#3200 AS o_comment_prf_1#3217, o_orderdate_prf#3201 AS o_orderdate_prf_1#3218]
            :  :        +- Relation[rid#3185L,pfk_customer_orders_prf#3186,fpk_orders_customer_prf#3187,val_orders_o_orderstatus_prf#3188,val_orders_o_totalprice_prf#3189,val_orders_o_orderpriority_prf#3190,val_orders_o_clerk_prf#3191,val_orders_o_shippriority_prf#3192,val_orders_o_comment_prf#3193,val_orders_o_orderdate_prf#3194,o_orderstatus_prf#3195,o_totalprice_prf#3196,o_orderpriority_prf#3197,o_clerk_prf#3198,o_shippriority_prf#3199,o_comment_prf#3200,o_orderdate_prf#3201] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Join UsingJoin(Inner,List(rid_3))
            :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :  :- Project [rid#2809L AS rid_1#2826L, pfk_customer_orders_prf#2810 AS pfk_customer_orders_prf_1#2827, fpk_orders_customer_prf#2811 AS fpk_orders_customer_prf_1#2828, val_orders_o_orderstatus_prf#2812 AS val_orders_o_orderstatus_prf_1#2829, val_orders_o_totalprice_prf#2813 AS val_orders_o_totalprice_prf_1#2830, val_orders_o_orderpriority_prf#2814 AS val_orders_o_orderpriority_prf_1#2831, val_orders_o_clerk_prf#2815 AS val_orders_o_clerk_prf_1#2832, val_orders_o_shippriority_prf#2816 AS val_orders_o_shippriority_prf_1#2833, val_orders_o_comment_prf#2817 AS val_orders_o_comment_prf_1#2834, val_orders_o_orderdate_prf#2818 AS val_orders_o_orderdate_prf_1#2835, o_orderstatus_prf#2819 AS o_orderstatus_prf_1#2836, o_totalprice_prf#2820 AS o_totalprice_prf_1#2837, o_orderpriority_prf#2821 AS o_orderpriority_prf_1#2838, o_clerk_prf#2822 AS o_clerk_prf_1#2839, o_shippriority_prf#2823 AS o_shippriority_prf_1#2840, o_comment_prf#2824 AS o_comment_prf_1#2841, o_orderdate_prf#2825 AS o_orderdate_prf_1#2842]
            :     :  :  +- Relation[rid#2809L,pfk_customer_orders_prf#2810,fpk_orders_customer_prf#2811,val_orders_o_orderstatus_prf#2812,val_orders_o_totalprice_prf#2813,val_orders_o_orderpriority_prf#2814,val_orders_o_clerk_prf#2815,val_orders_o_shippriority_prf#2816,val_orders_o_comment_prf#2817,val_orders_o_orderdate_prf#2818,o_orderstatus_prf#2819,o_totalprice_prf#2820,o_orderpriority_prf#2821,o_clerk_prf#2822,o_shippriority_prf#2823,o_comment_prf#2824,o_orderdate_prf#2825] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, pfk_orders_lineitem_prf, 'pfk_orders_lineitem_prf_3, orders_prf, 'rid_1, lineitem_prf, 'rid_3
            :     :     :- Project [rid#3055L AS rid_1#3072L, pfk_customer_orders_prf#3056 AS pfk_customer_orders_prf_1#3073, fpk_orders_customer_prf#3057 AS fpk_orders_customer_prf_1#3074, val_orders_o_orderstatus_prf#3058 AS val_orders_o_orderstatus_prf_1#3075, val_orders_o_totalprice_prf#3059 AS val_orders_o_totalprice_prf_1#3076, val_orders_o_orderpriority_prf#3060 AS val_orders_o_orderpriority_prf_1#3077, val_orders_o_clerk_prf#3061 AS val_orders_o_clerk_prf_1#3078, val_orders_o_shippriority_prf#3062 AS val_orders_o_shippriority_prf_1#3079, val_orders_o_comment_prf#3063 AS val_orders_o_comment_prf_1#3080, val_orders_o_orderdate_prf#3064 AS val_orders_o_orderdate_prf_1#3081, o_orderstatus_prf#3065 AS o_orderstatus_prf_1#3082, o_totalprice_prf#3066 AS o_totalprice_prf_1#3083, o_orderpriority_prf#3067 AS o_orderpriority_prf_1#3084, o_clerk_prf#3068 AS o_clerk_prf_1#3085, o_shippriority_prf#3069 AS o_shippriority_prf_1#3086, o_comment_prf#3070 AS o_comment_prf_1#3087, o_orderdate_prf#3071 AS o_orderdate_prf_1#3088]
            :     :     :  +- Relation[rid#3055L,pfk_customer_orders_prf#3056,fpk_orders_customer_prf#3057,val_orders_o_orderstatus_prf#3058,val_orders_o_totalprice_prf#3059,val_orders_o_orderpriority_prf#3060,val_orders_o_clerk_prf#3061,val_orders_o_shippriority_prf#3062,val_orders_o_comment_prf#3063,val_orders_o_orderdate_prf#3064,o_orderstatus_prf#3065,o_totalprice_prf#3066,o_orderpriority_prf#3067,o_clerk_prf#3068,o_shippriority_prf#3069,o_comment_prf#3070,o_orderdate_prf#3071] JDBCRelation(orders_prf) [numPartitions=1]
            :     :     +- Project [rid#3089L AS rid_3#3122L, fpk_lineitem_orders_prf#3090 AS fpk_lineitem_orders_prf_3#3123, fpk_lineitem_part_prf#3091 AS fpk_lineitem_part_prf_3#3124, fpk_lineitem_partsupp_prf#3092 AS fpk_lineitem_partsupp_prf_3#3125, fpk_lineitem_supplier_prf#3093 AS fpk_lineitem_supplier_prf_3#3126, pfk_supplier_lineitem_prf#3094 AS pfk_supplier_lineitem_prf_3#3127, pfk_part_lineitem_prf#3095 AS pfk_part_lineitem_prf_3#3128, pfk_orders_lineitem_prf#3096 AS pfk_orders_lineitem_prf_3#3129, pfk_partsupp_lineitem_prf#3097 AS pfk_partsupp_lineitem_prf_3#3130, val_lineitem_l_quantity_prf#3098 AS val_lineitem_l_quantity_prf_3#3131, val_lineitem_l_extendedprice_prf#3099 AS val_lineitem_l_extendedprice_prf_3#3132, val_lineitem_l_discount_prf#3100 AS val_lineitem_l_discount_prf_3#3133, val_lineitem_l_tax_prf#3101 AS val_lineitem_l_tax_prf_3#3134, val_lineitem_l_returnflag_prf#3102 AS val_lineitem_l_returnflag_prf_3#3135, val_lineitem_l_linestatus_prf#3103 AS val_lineitem_l_linestatus_prf_3#3136, val_lineitem_l_commitdate_prf#3104 AS val_lineitem_l_commitdate_prf_3#3137, val_lineitem_l_receiptdate_prf#3105 AS val_lineitem_l_receiptdate_prf_3#3138, val_lineitem_l_shipinstruct_prf#3106 AS val_lineitem_l_shipinstruct_prf_3#3139, val_lineitem_l_shipmode_prf#3107 AS val_lineitem_l_shipmode_prf_3#3140, val_lineitem_l_comment_prf#3108 AS val_lineitem_l_comment_prf_3#3141, val_lineitem_l_shipdate_prf#3109 AS val_lineitem_l_shipdate_prf_3#3142, l_quantity_prf#3110 AS l_quantity_prf_3#3143, l_extendedprice_prf#3111 AS l_extendedprice_prf_3#3144, l_discount_prf#3112 AS l_discount_prf_3#3145, ... 9 more fields]
            :     :        +- Relation[rid#3089L,fpk_lineitem_orders_prf#3090,fpk_lineitem_part_prf#3091,fpk_lineitem_partsupp_prf#3092,fpk_lineitem_supplier_prf#3093,pfk_supplier_lineitem_prf#3094,pfk_part_lineitem_prf#3095,pfk_orders_lineitem_prf#3096,pfk_partsupp_lineitem_prf#3097,val_lineitem_l_quantity_prf#3098,val_lineitem_l_extendedprice_prf#3099,val_lineitem_l_discount_prf#3100,val_lineitem_l_tax_prf#3101,val_lineitem_l_returnflag_prf#3102,val_lineitem_l_linestatus_prf#3103,val_lineitem_l_commitdate_prf#3104,val_lineitem_l_receiptdate_prf#3105,val_lineitem_l_shipinstruct_prf#3106,val_lineitem_l_shipmode_prf#3107,val_lineitem_l_comment_prf#3108,val_lineitem_l_shipdate_prf#3109,l_quantity_prf#3110,l_extendedprice_prf#3111,l_discount_prf#3112,... 9 more fields] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- 'Project [*]
            :        +- 'Join Inner, (cast(dexdecrypt(concat(supplier~nation, ~, 'rid_2), 'fpk_supplier_nation_prf_2) as bigint) = 'rid_4)
            :           :- 'Join UsingJoin(Inner,List(rid_3))
            :           :  :- 'Join UsingJoin(Inner,List(rid_2))
            :           :  :  :- Project [rid#2843L AS rid_2#2856L, pfk_nation_supplier_prf#2844 AS pfk_nation_supplier_prf_2#2857, fpk_supplier_nation_prf#2845 AS fpk_supplier_nation_prf_2#2858, val_supplier_s_name_prf#2846 AS val_supplier_s_name_prf_2#2859, val_supplier_s_address_prf#2847 AS val_supplier_s_address_prf_2#2860, val_supplier_s_phone_prf#2848 AS val_supplier_s_phone_prf_2#2861, val_supplier_s_acctbal_prf#2849 AS val_supplier_s_acctbal_prf_2#2862, val_supplier_s_comment_prf#2850 AS val_supplier_s_comment_prf_2#2863, s_name_prf#2851 AS s_name_prf_2#2864, s_address_prf#2852 AS s_address_prf_2#2865, s_phone_prf#2853 AS s_phone_prf_2#2866, s_acctbal_prf#2854 AS s_acctbal_prf_2#2867, s_comment_prf#2855 AS s_comment_prf_2#2868]
            :           :  :  :  +- Relation[rid#2843L,pfk_nation_supplier_prf#2844,fpk_supplier_nation_prf#2845,val_supplier_s_name_prf#2846,val_supplier_s_address_prf#2847,val_supplier_s_phone_prf#2848,val_supplier_s_acctbal_prf#2849,val_supplier_s_comment_prf#2850,s_name_prf#2851,s_address_prf#2852,s_phone_prf#2853,s_acctbal_prf#2854,s_comment_prf#2855] JDBCRelation(supplier_prf) [numPartitions=1]
            :           :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, pfk_supplier_lineitem_prf, 'pfk_supplier_lineitem_prf_3, supplier_prf, 'rid_2, lineitem_prf, 'rid_3
            :           :  :     :- Project [rid#2935L AS rid_2#2948L, pfk_nation_supplier_prf#2936 AS pfk_nation_supplier_prf_2#2949, fpk_supplier_nation_prf#2937 AS fpk_supplier_nation_prf_2#2950, val_supplier_s_name_prf#2938 AS val_supplier_s_name_prf_2#2951, val_supplier_s_address_prf#2939 AS val_supplier_s_address_prf_2#2952, val_supplier_s_phone_prf#2940 AS val_supplier_s_phone_prf_2#2953, val_supplier_s_acctbal_prf#2941 AS val_supplier_s_acctbal_prf_2#2954, val_supplier_s_comment_prf#2942 AS val_supplier_s_comment_prf_2#2955, s_name_prf#2943 AS s_name_prf_2#2956, s_address_prf#2944 AS s_address_prf_2#2957, s_phone_prf#2945 AS s_phone_prf_2#2958, s_acctbal_prf#2946 AS s_acctbal_prf_2#2959, s_comment_prf#2947 AS s_comment_prf_2#2960]
            :           :  :     :  +- Relation[rid#2935L,pfk_nation_supplier_prf#2936,fpk_supplier_nation_prf#2937,val_supplier_s_name_prf#2938,val_supplier_s_address_prf#2939,val_supplier_s_phone_prf#2940,val_supplier_s_acctbal_prf#2941,val_supplier_s_comment_prf#2942,s_name_prf#2943,s_address_prf#2944,s_phone_prf#2945,s_acctbal_prf#2946,s_comment_prf#2947] JDBCRelation(supplier_prf) [numPartitions=1]
            :           :  :     +- Project [rid#2961L AS rid_3#2994L, fpk_lineitem_orders_prf#2962 AS fpk_lineitem_orders_prf_3#2995, fpk_lineitem_part_prf#2963 AS fpk_lineitem_part_prf_3#2996, fpk_lineitem_partsupp_prf#2964 AS fpk_lineitem_partsupp_prf_3#2997, fpk_lineitem_supplier_prf#2965 AS fpk_lineitem_supplier_prf_3#2998, pfk_supplier_lineitem_prf#2966 AS pfk_supplier_lineitem_prf_3#2999, pfk_part_lineitem_prf#2967 AS pfk_part_lineitem_prf_3#3000, pfk_orders_lineitem_prf#2968 AS pfk_orders_lineitem_prf_3#3001, pfk_partsupp_lineitem_prf#2969 AS pfk_partsupp_lineitem_prf_3#3002, val_lineitem_l_quantity_prf#2970 AS val_lineitem_l_quantity_prf_3#3003, val_lineitem_l_extendedprice_prf#2971 AS val_lineitem_l_extendedprice_prf_3#3004, val_lineitem_l_discount_prf#2972 AS val_lineitem_l_discount_prf_3#3005, val_lineitem_l_tax_prf#2973 AS val_lineitem_l_tax_prf_3#3006, val_lineitem_l_returnflag_prf#2974 AS val_lineitem_l_returnflag_prf_3#3007, val_lineitem_l_linestatus_prf#2975 AS val_lineitem_l_linestatus_prf_3#3008, val_lineitem_l_commitdate_prf#2976 AS val_lineitem_l_commitdate_prf_3#3009, val_lineitem_l_receiptdate_prf#2977 AS val_lineitem_l_receiptdate_prf_3#3010, val_lineitem_l_shipinstruct_prf#2978 AS val_lineitem_l_shipinstruct_prf_3#3011, val_lineitem_l_shipmode_prf#2979 AS val_lineitem_l_shipmode_prf_3#3012, val_lineitem_l_comment_prf#2980 AS val_lineitem_l_comment_prf_3#3013, val_lineitem_l_shipdate_prf#2981 AS val_lineitem_l_shipdate_prf_3#3014, l_quantity_prf#2982 AS l_quantity_prf_3#3015, l_extendedprice_prf#2983 AS l_extendedprice_prf_3#3016, l_discount_prf#2984 AS l_discount_prf_3#3017, ... 9 more fields]
            :           :  :        +- Relation[rid#2961L,fpk_lineitem_orders_prf#2962,fpk_lineitem_part_prf#2963,fpk_lineitem_partsupp_prf#2964,fpk_lineitem_supplier_prf#2965,pfk_supplier_lineitem_prf#2966,pfk_part_lineitem_prf#2967,pfk_orders_lineitem_prf#2968,pfk_partsupp_lineitem_prf#2969,val_lineitem_l_quantity_prf#2970,val_lineitem_l_extendedprice_prf#2971,val_lineitem_l_discount_prf#2972,val_lineitem_l_tax_prf#2973,val_lineitem_l_returnflag_prf#2974,val_lineitem_l_linestatus_prf#2975,val_lineitem_l_commitdate_prf#2976,val_lineitem_l_receiptdate_prf#2977,val_lineitem_l_shipinstruct_prf#2978,val_lineitem_l_shipmode_prf#2979,val_lineitem_l_comment_prf#2980,val_lineitem_l_shipdate_prf#2981,l_quantity_prf#2982,l_extendedprice_prf#2983,l_discount_prf#2984,... 9 more fields] JDBCRelation(lineitem_prf) [numPartitions=1]
            :           :  +- Project [rid#2869L AS rid_3#2902L, fpk_lineitem_orders_prf#2870 AS fpk_lineitem_orders_prf_3#2903, fpk_lineitem_part_prf#2871 AS fpk_lineitem_part_prf_3#2904, fpk_lineitem_partsupp_prf#2872 AS fpk_lineitem_partsupp_prf_3#2905, fpk_lineitem_supplier_prf#2873 AS fpk_lineitem_supplier_prf_3#2906, pfk_supplier_lineitem_prf#2874 AS pfk_supplier_lineitem_prf_3#2907, pfk_part_lineitem_prf#2875 AS pfk_part_lineitem_prf_3#2908, pfk_orders_lineitem_prf#2876 AS pfk_orders_lineitem_prf_3#2909, pfk_partsupp_lineitem_prf#2877 AS pfk_partsupp_lineitem_prf_3#2910, val_lineitem_l_quantity_prf#2878 AS val_lineitem_l_quantity_prf_3#2911, val_lineitem_l_extendedprice_prf#2879 AS val_lineitem_l_extendedprice_prf_3#2912, val_lineitem_l_discount_prf#2880 AS val_lineitem_l_discount_prf_3#2913, val_lineitem_l_tax_prf#2881 AS val_lineitem_l_tax_prf_3#2914, val_lineitem_l_returnflag_prf#2882 AS val_lineitem_l_returnflag_prf_3#2915, val_lineitem_l_linestatus_prf#2883 AS val_lineitem_l_linestatus_prf_3#2916, val_lineitem_l_commitdate_prf#2884 AS val_lineitem_l_commitdate_prf_3#2917, val_lineitem_l_receiptdate_prf#2885 AS val_lineitem_l_receiptdate_prf_3#2918, val_lineitem_l_shipinstruct_prf#2886 AS val_lineitem_l_shipinstruct_prf_3#2919, val_lineitem_l_shipmode_prf#2887 AS val_lineitem_l_shipmode_prf_3#2920, val_lineitem_l_comment_prf#2888 AS val_lineitem_l_comment_prf_3#2921, val_lineitem_l_shipdate_prf#2889 AS val_lineitem_l_shipdate_prf_3#2922, l_quantity_prf#2890 AS l_quantity_prf_3#2923, l_extendedprice_prf#2891 AS l_extendedprice_prf_3#2924, l_discount_prf#2892 AS l_discount_prf_3#2925, ... 9 more fields]
            :           :     +- Relation[rid#2869L,fpk_lineitem_orders_prf#2870,fpk_lineitem_part_prf#2871,fpk_lineitem_partsupp_prf#2872,fpk_lineitem_supplier_prf#2873,pfk_supplier_lineitem_prf#2874,pfk_part_lineitem_prf#2875,pfk_orders_lineitem_prf#2876,pfk_partsupp_lineitem_prf#2877,val_lineitem_l_quantity_prf#2878,val_lineitem_l_extendedprice_prf#2879,val_lineitem_l_discount_prf#2880,val_lineitem_l_tax_prf#2881,val_lineitem_l_returnflag_prf#2882,val_lineitem_l_linestatus_prf#2883,val_lineitem_l_commitdate_prf#2884,val_lineitem_l_receiptdate_prf#2885,val_lineitem_l_shipinstruct_prf#2886,val_lineitem_l_shipmode_prf#2887,val_lineitem_l_comment_prf#2888,val_lineitem_l_shipdate_prf#2889,l_quantity_prf#2890,l_extendedprice_prf#2891,l_discount_prf#2892,... 9 more fields] JDBCRelation(lineitem_prf) [numPartitions=1]
            :           +- 'Join UsingJoin(LeftSemi,List(rid_4))
            :              :- Project [rid#3027L AS rid_4#3034L, pfk_region_nation_prf#3028 AS pfk_region_nation_prf_4#3035, fpk_nation_region_prf#3029 AS fpk_nation_region_prf_4#3036, val_nation_n_name_prf#3030 AS val_nation_n_name_prf_4#3037, val_nation_n_comment_prf#3031 AS val_nation_n_comment_prf_4#3038, n_name_prf#3032 AS n_name_prf_4#3039, n_comment_prf#3033 AS n_comment_prf_4#3040]
            :              :  +- Relation[rid#3027L,pfk_region_nation_prf#3028,fpk_nation_region_prf#3029,val_nation_n_name_prf#3030,val_nation_n_comment_prf#3031,n_name_prf#3032,n_comment_prf#3033] JDBCRelation(nation_prf) [numPartitions=1]
            :              +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, val_nation_n_name_prf, 'val_nation_n_name_prf_4, nation_prf, 'rid_4
            :                 +- Project [rid#3041L AS rid_4#3048L, pfk_region_nation_prf#3042 AS pfk_region_nation_prf_4#3049, fpk_nation_region_prf#3043 AS fpk_nation_region_prf_4#3050, val_nation_n_name_prf#3044 AS val_nation_n_name_prf_4#3051, val_nation_n_comment_prf#3045 AS val_nation_n_comment_prf_4#3052, n_name_prf#3046 AS n_name_prf_4#3053, n_comment_prf#3047 AS n_comment_prf_4#3054]
            :                    +- Relation[rid#3041L,pfk_region_nation_prf#3042,fpk_nation_region_prf#3043,val_nation_n_name_prf#3044,val_nation_n_comment_prf#3045,n_name_prf#3046,n_comment_prf#3047] JDBCRelation(nation_prf) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_5))
               :- Project [rid#3219L AS rid_5#3226L, pfk_region_nation_prf#3220 AS pfk_region_nation_prf_5#3227, fpk_nation_region_prf#3221 AS fpk_nation_region_prf_5#3228, val_nation_n_name_prf#3222 AS val_nation_n_name_prf_5#3229, val_nation_n_comment_prf#3223 AS val_nation_n_comment_prf_5#3230, n_name_prf#3224 AS n_name_prf_5#3231, n_comment_prf#3225 AS n_comment_prf_5#3232]
               :  +- Relation[rid#3219L,pfk_region_nation_prf#3220,fpk_nation_region_prf#3221,val_nation_n_name_prf#3222,val_nation_n_comment_prf#3223,n_name_prf#3224,n_comment_prf#3225] JDBCRelation(nation_prf) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, val_nation_n_name_prf, 'val_nation_n_name_prf_5, nation_prf, 'rid_5
                  +- Project [rid#3233L AS rid_5#3240L, pfk_region_nation_prf#3234 AS pfk_region_nation_prf_5#3241, fpk_nation_region_prf#3235 AS fpk_nation_region_prf_5#3242, val_nation_n_name_prf#3236 AS val_nation_n_name_prf_5#3243, val_nation_n_comment_prf#3237 AS val_nation_n_comment_prf_5#3244, n_name_prf#3238 AS n_name_prf_5#3245, n_comment_prf#3239 AS n_comment_prf_5#3246]
                     +- Relation[rid#3233L,pfk_region_nation_prf#3234,fpk_nation_region_prf#3235,val_nation_n_name_prf#3236,val_nation_n_comment_prf#3237,n_name_prf#3238,n_comment_prf#3239] JDBCRelation(nation_prf) [numPartitions=1]

dex-class org.apache.spark.sql.dex.DexPkFk$ result size=9735
Elapsed time: 101366ms

q7b=

select
  n1.n_name as n1_name,
  n2.n_name as n2_name,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    (n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY')
  )
      
postgres result size=9735
Elapsed time: 380ms
19/10/08 23:05:19 WARN DexPlanner: dexPlan=DexPkFkPlan
19/10/08 23:05:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3544L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#3459L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Filter (isnotnull(s_nationkey#21L) && isnotnull(s_suppkey#18L))
         :     :     :     :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :        +- Filter (isnotnull(l_suppkey#308L) && isnotnull(l_orderkey#306L))
         :     :     :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#3459L]
            +- Filter ((isnotnull(n_name#3460) && (n_name#3460 = GERMANY)) && isnotnull(n_nationkey#3459L))
               +- Relation[n_nationkey#3459L,n_name#3460,n_regionkey#3461L,n_comment#3462] parquet

19/10/08 23:05:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3544L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (cast(dexdecrypt(concat(customer~nation, ~, 'rid_4), 'fpk_customer_nation_prf_4) as bigint) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (cast(dexdecrypt(concat(orders~customer, ~, 'rid_3), 'fpk_orders_customer_prf_3) as bigint) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (cast(dexdecrypt(concat(lineitem~orders, ~, 'rid_2), 'fpk_lineitem_orders_prf_2) as bigint) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :  :  :- Project [rid#3546L AS rid_0#3553L, pfk_region_nation_prf#3547 AS pfk_region_nation_prf_0#3554, fpk_nation_region_prf#3548 AS fpk_nation_region_prf_0#3555, val_nation_n_name_prf#3549 AS val_nation_n_name_prf_0#3556, val_nation_n_comment_prf#3550 AS val_nation_n_comment_prf_0#3557, n_name_prf#3551 AS n_name_prf_0#3558, n_comment_prf#3552 AS n_comment_prf_0#3559]
            :     :     :  :  :  :  :  :  +- Relation[rid#3546L,pfk_region_nation_prf#3547,fpk_nation_region_prf#3548,val_nation_n_name_prf#3549,val_nation_n_comment_prf#3550,n_name_prf#3551,n_comment_prf#3552] JDBCRelation(nation_prf) [numPartitions=1]
            :     :     :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, val_nation_n_name_prf, 'val_nation_n_name_prf_0, nation_prf, 'rid_0
            :     :     :  :  :  :  :     +- Project [rid#3560L AS rid_0#3567L, pfk_region_nation_prf#3561 AS pfk_region_nation_prf_0#3568, fpk_nation_region_prf#3562 AS fpk_nation_region_prf_0#3569, val_nation_n_name_prf#3563 AS val_nation_n_name_prf_0#3570, val_nation_n_comment_prf#3564 AS val_nation_n_comment_prf_0#3571, n_name_prf#3565 AS n_name_prf_0#3572, n_comment_prf#3566 AS n_comment_prf_0#3573]
            :     :     :  :  :  :  :        +- Relation[rid#3560L,pfk_region_nation_prf#3561,fpk_nation_region_prf#3562,val_nation_n_name_prf#3563,val_nation_n_comment_prf#3564,n_name_prf#3565,n_comment_prf#3566] JDBCRelation(nation_prf) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, pfk_nation_supplier_prf, 'pfk_nation_supplier_prf_1, nation_prf, 'rid_0, supplier_prf, 'rid_1
            :     :     :  :  :  :     :- Project [rid#3600L AS rid_0#3607L, pfk_region_nation_prf#3601 AS pfk_region_nation_prf_0#3608, fpk_nation_region_prf#3602 AS fpk_nation_region_prf_0#3609, val_nation_n_name_prf#3603 AS val_nation_n_name_prf_0#3610, val_nation_n_comment_prf#3604 AS val_nation_n_comment_prf_0#3611, n_name_prf#3605 AS n_name_prf_0#3612, n_comment_prf#3606 AS n_comment_prf_0#3613]
            :     :     :  :  :  :     :  +- Relation[rid#3600L,pfk_region_nation_prf#3601,fpk_nation_region_prf#3602,val_nation_n_name_prf#3603,val_nation_n_comment_prf#3604,n_name_prf#3605,n_comment_prf#3606] JDBCRelation(nation_prf) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#3614L AS rid_1#3627L, pfk_nation_supplier_prf#3615 AS pfk_nation_supplier_prf_1#3628, fpk_supplier_nation_prf#3616 AS fpk_supplier_nation_prf_1#3629, val_supplier_s_name_prf#3617 AS val_supplier_s_name_prf_1#3630, val_supplier_s_address_prf#3618 AS val_supplier_s_address_prf_1#3631, val_supplier_s_phone_prf#3619 AS val_supplier_s_phone_prf_1#3632, val_supplier_s_acctbal_prf#3620 AS val_supplier_s_acctbal_prf_1#3633, val_supplier_s_comment_prf#3621 AS val_supplier_s_comment_prf_1#3634, s_name_prf#3622 AS s_name_prf_1#3635, s_address_prf#3623 AS s_address_prf_1#3636, s_phone_prf#3624 AS s_phone_prf_1#3637, s_acctbal_prf#3625 AS s_acctbal_prf_1#3638, s_comment_prf#3626 AS s_comment_prf_1#3639]
            :     :     :  :  :  :        +- Relation[rid#3614L,pfk_nation_supplier_prf#3615,fpk_supplier_nation_prf#3616,val_supplier_s_name_prf#3617,val_supplier_s_address_prf#3618,val_supplier_s_phone_prf#3619,val_supplier_s_acctbal_prf#3620,val_supplier_s_comment_prf#3621,s_name_prf#3622,s_address_prf#3623,s_phone_prf#3624,s_acctbal_prf#3625,s_comment_prf#3626] JDBCRelation(supplier_prf) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#3574L AS rid_1#3587L, pfk_nation_supplier_prf#3575 AS pfk_nation_supplier_prf_1#3588, fpk_supplier_nation_prf#3576 AS fpk_supplier_nation_prf_1#3589, val_supplier_s_name_prf#3577 AS val_supplier_s_name_prf_1#3590, val_supplier_s_address_prf#3578 AS val_supplier_s_address_prf_1#3591, val_supplier_s_phone_prf#3579 AS val_supplier_s_phone_prf_1#3592, val_supplier_s_acctbal_prf#3580 AS val_supplier_s_acctbal_prf_1#3593, val_supplier_s_comment_prf#3581 AS val_supplier_s_comment_prf_1#3594, s_name_prf#3582 AS s_name_prf_1#3595, s_address_prf#3583 AS s_address_prf_1#3596, s_phone_prf#3584 AS s_phone_prf_1#3597, s_acctbal_prf#3585 AS s_acctbal_prf_1#3598, s_comment_prf#3586 AS s_comment_prf_1#3599]
            :     :     :  :  :     +- Relation[rid#3574L,pfk_nation_supplier_prf#3575,fpk_supplier_nation_prf#3576,val_supplier_s_name_prf#3577,val_supplier_s_address_prf#3578,val_supplier_s_phone_prf#3579,val_supplier_s_acctbal_prf#3580,val_supplier_s_comment_prf#3581,s_name_prf#3582,s_address_prf#3583,s_phone_prf#3584,s_acctbal_prf#3585,s_comment_prf#3586] JDBCRelation(supplier_prf) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, pfk_supplier_lineitem_prf, 'pfk_supplier_lineitem_prf_2, supplier_prf, 'rid_1, lineitem_prf, 'rid_2
            :     :     :  :     :- Project [rid#3706L AS rid_1#3719L, pfk_nation_supplier_prf#3707 AS pfk_nation_supplier_prf_1#3720, fpk_supplier_nation_prf#3708 AS fpk_supplier_nation_prf_1#3721, val_supplier_s_name_prf#3709 AS val_supplier_s_name_prf_1#3722, val_supplier_s_address_prf#3710 AS val_supplier_s_address_prf_1#3723, val_supplier_s_phone_prf#3711 AS val_supplier_s_phone_prf_1#3724, val_supplier_s_acctbal_prf#3712 AS val_supplier_s_acctbal_prf_1#3725, val_supplier_s_comment_prf#3713 AS val_supplier_s_comment_prf_1#3726, s_name_prf#3714 AS s_name_prf_1#3727, s_address_prf#3715 AS s_address_prf_1#3728, s_phone_prf#3716 AS s_phone_prf_1#3729, s_acctbal_prf#3717 AS s_acctbal_prf_1#3730, s_comment_prf#3718 AS s_comment_prf_1#3731]
            :     :     :  :     :  +- Relation[rid#3706L,pfk_nation_supplier_prf#3707,fpk_supplier_nation_prf#3708,val_supplier_s_name_prf#3709,val_supplier_s_address_prf#3710,val_supplier_s_phone_prf#3711,val_supplier_s_acctbal_prf#3712,val_supplier_s_comment_prf#3713,s_name_prf#3714,s_address_prf#3715,s_phone_prf#3716,s_acctbal_prf#3717,s_comment_prf#3718] JDBCRelation(supplier_prf) [numPartitions=1]
            :     :     :  :     +- Project [rid#3732L AS rid_2#3765L, fpk_lineitem_orders_prf#3733 AS fpk_lineitem_orders_prf_2#3766, fpk_lineitem_part_prf#3734 AS fpk_lineitem_part_prf_2#3767, fpk_lineitem_partsupp_prf#3735 AS fpk_lineitem_partsupp_prf_2#3768, fpk_lineitem_supplier_prf#3736 AS fpk_lineitem_supplier_prf_2#3769, pfk_supplier_lineitem_prf#3737 AS pfk_supplier_lineitem_prf_2#3770, pfk_part_lineitem_prf#3738 AS pfk_part_lineitem_prf_2#3771, pfk_orders_lineitem_prf#3739 AS pfk_orders_lineitem_prf_2#3772, pfk_partsupp_lineitem_prf#3740 AS pfk_partsupp_lineitem_prf_2#3773, val_lineitem_l_quantity_prf#3741 AS val_lineitem_l_quantity_prf_2#3774, val_lineitem_l_extendedprice_prf#3742 AS val_lineitem_l_extendedprice_prf_2#3775, val_lineitem_l_discount_prf#3743 AS val_lineitem_l_discount_prf_2#3776, val_lineitem_l_tax_prf#3744 AS val_lineitem_l_tax_prf_2#3777, val_lineitem_l_returnflag_prf#3745 AS val_lineitem_l_returnflag_prf_2#3778, val_lineitem_l_linestatus_prf#3746 AS val_lineitem_l_linestatus_prf_2#3779, val_lineitem_l_commitdate_prf#3747 AS val_lineitem_l_commitdate_prf_2#3780, val_lineitem_l_receiptdate_prf#3748 AS val_lineitem_l_receiptdate_prf_2#3781, val_lineitem_l_shipinstruct_prf#3749 AS val_lineitem_l_shipinstruct_prf_2#3782, val_lineitem_l_shipmode_prf#3750 AS val_lineitem_l_shipmode_prf_2#3783, val_lineitem_l_comment_prf#3751 AS val_lineitem_l_comment_prf_2#3784, val_lineitem_l_shipdate_prf#3752 AS val_lineitem_l_shipdate_prf_2#3785, l_quantity_prf#3753 AS l_quantity_prf_2#3786, l_extendedprice_prf#3754 AS l_extendedprice_prf_2#3787, l_discount_prf#3755 AS l_discount_prf_2#3788, ... 9 more fields]
            :     :     :  :        +- Relation[rid#3732L,fpk_lineitem_orders_prf#3733,fpk_lineitem_part_prf#3734,fpk_lineitem_partsupp_prf#3735,fpk_lineitem_supplier_prf#3736,pfk_supplier_lineitem_prf#3737,pfk_part_lineitem_prf#3738,pfk_orders_lineitem_prf#3739,pfk_partsupp_lineitem_prf#3740,val_lineitem_l_quantity_prf#3741,val_lineitem_l_extendedprice_prf#3742,val_lineitem_l_discount_prf#3743,val_lineitem_l_tax_prf#3744,val_lineitem_l_returnflag_prf#3745,val_lineitem_l_linestatus_prf#3746,val_lineitem_l_commitdate_prf#3747,val_lineitem_l_receiptdate_prf#3748,val_lineitem_l_shipinstruct_prf#3749,val_lineitem_l_shipmode_prf#3750,val_lineitem_l_comment_prf#3751,val_lineitem_l_shipdate_prf#3752,l_quantity_prf#3753,l_extendedprice_prf#3754,l_discount_prf#3755,... 9 more fields] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     :     :  +- Project [rid#3640L AS rid_2#3673L, fpk_lineitem_orders_prf#3641 AS fpk_lineitem_orders_prf_2#3674, fpk_lineitem_part_prf#3642 AS fpk_lineitem_part_prf_2#3675, fpk_lineitem_partsupp_prf#3643 AS fpk_lineitem_partsupp_prf_2#3676, fpk_lineitem_supplier_prf#3644 AS fpk_lineitem_supplier_prf_2#3677, pfk_supplier_lineitem_prf#3645 AS pfk_supplier_lineitem_prf_2#3678, pfk_part_lineitem_prf#3646 AS pfk_part_lineitem_prf_2#3679, pfk_orders_lineitem_prf#3647 AS pfk_orders_lineitem_prf_2#3680, pfk_partsupp_lineitem_prf#3648 AS pfk_partsupp_lineitem_prf_2#3681, val_lineitem_l_quantity_prf#3649 AS val_lineitem_l_quantity_prf_2#3682, val_lineitem_l_extendedprice_prf#3650 AS val_lineitem_l_extendedprice_prf_2#3683, val_lineitem_l_discount_prf#3651 AS val_lineitem_l_discount_prf_2#3684, val_lineitem_l_tax_prf#3652 AS val_lineitem_l_tax_prf_2#3685, val_lineitem_l_returnflag_prf#3653 AS val_lineitem_l_returnflag_prf_2#3686, val_lineitem_l_linestatus_prf#3654 AS val_lineitem_l_linestatus_prf_2#3687, val_lineitem_l_commitdate_prf#3655 AS val_lineitem_l_commitdate_prf_2#3688, val_lineitem_l_receiptdate_prf#3656 AS val_lineitem_l_receiptdate_prf_2#3689, val_lineitem_l_shipinstruct_prf#3657 AS val_lineitem_l_shipinstruct_prf_2#3690, val_lineitem_l_shipmode_prf#3658 AS val_lineitem_l_shipmode_prf_2#3691, val_lineitem_l_comment_prf#3659 AS val_lineitem_l_comment_prf_2#3692, val_lineitem_l_shipdate_prf#3660 AS val_lineitem_l_shipdate_prf_2#3693, l_quantity_prf#3661 AS l_quantity_prf_2#3694, l_extendedprice_prf#3662 AS l_extendedprice_prf_2#3695, l_discount_prf#3663 AS l_discount_prf_2#3696, ... 9 more fields]
            :     :     :     +- Relation[rid#3640L,fpk_lineitem_orders_prf#3641,fpk_lineitem_part_prf#3642,fpk_lineitem_partsupp_prf#3643,fpk_lineitem_supplier_prf#3644,pfk_supplier_lineitem_prf#3645,pfk_part_lineitem_prf#3646,pfk_orders_lineitem_prf#3647,pfk_partsupp_lineitem_prf#3648,val_lineitem_l_quantity_prf#3649,val_lineitem_l_extendedprice_prf#3650,val_lineitem_l_discount_prf#3651,val_lineitem_l_tax_prf#3652,val_lineitem_l_returnflag_prf#3653,val_lineitem_l_linestatus_prf#3654,val_lineitem_l_commitdate_prf#3655,val_lineitem_l_receiptdate_prf#3656,val_lineitem_l_shipinstruct_prf#3657,val_lineitem_l_shipmode_prf#3658,val_lineitem_l_comment_prf#3659,val_lineitem_l_shipdate_prf#3660,l_quantity_prf#3661,l_extendedprice_prf#3662,l_discount_prf#3663,... 9 more fields] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     :     +- Project [rid#3798L AS rid_3#3815L, pfk_customer_orders_prf#3799 AS pfk_customer_orders_prf_3#3816, fpk_orders_customer_prf#3800 AS fpk_orders_customer_prf_3#3817, val_orders_o_orderstatus_prf#3801 AS val_orders_o_orderstatus_prf_3#3818, val_orders_o_totalprice_prf#3802 AS val_orders_o_totalprice_prf_3#3819, val_orders_o_orderpriority_prf#3803 AS val_orders_o_orderpriority_prf_3#3820, val_orders_o_clerk_prf#3804 AS val_orders_o_clerk_prf_3#3821, val_orders_o_shippriority_prf#3805 AS val_orders_o_shippriority_prf_3#3822, val_orders_o_comment_prf#3806 AS val_orders_o_comment_prf_3#3823, val_orders_o_orderdate_prf#3807 AS val_orders_o_orderdate_prf_3#3824, o_orderstatus_prf#3808 AS o_orderstatus_prf_3#3825, o_totalprice_prf#3809 AS o_totalprice_prf_3#3826, o_orderpriority_prf#3810 AS o_orderpriority_prf_3#3827, o_clerk_prf#3811 AS o_clerk_prf_3#3828, o_shippriority_prf#3812 AS o_shippriority_prf_3#3829, o_comment_prf#3813 AS o_comment_prf_3#3830, o_orderdate_prf#3814 AS o_orderdate_prf_3#3831]
            :     :        +- Relation[rid#3798L,pfk_customer_orders_prf#3799,fpk_orders_customer_prf#3800,val_orders_o_orderstatus_prf#3801,val_orders_o_totalprice_prf#3802,val_orders_o_orderpriority_prf#3803,val_orders_o_clerk_prf#3804,val_orders_o_shippriority_prf#3805,val_orders_o_comment_prf#3806,val_orders_o_orderdate_prf#3807,o_orderstatus_prf#3808,o_totalprice_prf#3809,o_orderpriority_prf#3810,o_clerk_prf#3811,o_shippriority_prf#3812,o_comment_prf#3813,o_orderdate_prf#3814] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Project [rid#3832L AS rid_4#3847L, pfk_nation_customer_prf#3833 AS pfk_nation_customer_prf_4#3848, fpk_customer_nation_prf#3834 AS fpk_customer_nation_prf_4#3849, val_customer_c_name_prf#3835 AS val_customer_c_name_prf_4#3850, val_customer_c_address_prf#3836 AS val_customer_c_address_prf_4#3851, val_customer_c_phone_prf#3837 AS val_customer_c_phone_prf_4#3852, val_customer_c_acctbal_prf#3838 AS val_customer_c_acctbal_prf_4#3853, val_customer_c_comment_prf#3839 AS val_customer_c_comment_prf_4#3854, val_customer_c_mktsegment_prf#3840 AS val_customer_c_mktsegment_prf_4#3855, c_name_prf#3841 AS c_name_prf_4#3856, c_address_prf#3842 AS c_address_prf_4#3857, c_phone_prf#3843 AS c_phone_prf_4#3858, c_acctbal_prf#3844 AS c_acctbal_prf_4#3859, c_comment_prf#3845 AS c_comment_prf_4#3860, c_mktsegment_prf#3846 AS c_mktsegment_prf_4#3861]
            :        +- Relation[rid#3832L,pfk_nation_customer_prf#3833,fpk_customer_nation_prf#3834,val_customer_c_name_prf#3835,val_customer_c_address_prf#3836,val_customer_c_phone_prf#3837,val_customer_c_acctbal_prf#3838,val_customer_c_comment_prf#3839,val_customer_c_mktsegment_prf#3840,c_name_prf#3841,c_address_prf#3842,c_phone_prf#3843,c_acctbal_prf#3844,c_comment_prf#3845,c_mktsegment_prf#3846] JDBCRelation(customer_prf) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_5))
               :- Project [rid#3862L AS rid_5#3869L, pfk_region_nation_prf#3863 AS pfk_region_nation_prf_5#3870, fpk_nation_region_prf#3864 AS fpk_nation_region_prf_5#3871, val_nation_n_name_prf#3865 AS val_nation_n_name_prf_5#3872, val_nation_n_comment_prf#3866 AS val_nation_n_comment_prf_5#3873, n_name_prf#3867 AS n_name_prf_5#3874, n_comment_prf#3868 AS n_comment_prf_5#3875]
               :  +- Relation[rid#3862L,pfk_region_nation_prf#3863,fpk_nation_region_prf#3864,val_nation_n_name_prf#3865,val_nation_n_comment_prf#3866,n_name_prf#3867,n_comment_prf#3868] JDBCRelation(nation_prf) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, val_nation_n_name_prf, 'val_nation_n_name_prf_5, nation_prf, 'rid_5
                  +- Project [rid#3876L AS rid_5#3883L, pfk_region_nation_prf#3877 AS pfk_region_nation_prf_5#3884, fpk_nation_region_prf#3878 AS fpk_nation_region_prf_5#3885, val_nation_n_name_prf#3879 AS val_nation_n_name_prf_5#3886, val_nation_n_comment_prf#3880 AS val_nation_n_comment_prf_5#3887, n_name_prf#3881 AS n_name_prf_5#3888, n_comment_prf#3882 AS n_comment_prf_5#3889]
                     +- Relation[rid#3876L,pfk_region_nation_prf#3877,fpk_nation_region_prf#3878,val_nation_n_name_prf#3879,val_nation_n_comment_prf#3880,n_name_prf#3881,n_comment_prf#3882] JDBCRelation(nation_prf) [numPartitions=1]

dex-class org.apache.spark.sql.dex.DexPkFk$ result size=9735
Elapsed time: 173546ms

q7c=

select
  n1.n_name as n1_name,
  n2.n_name as n2_name,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    (n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY')
  )
      
postgres result size=9735
Elapsed time: 378ms
19/10/08 23:08:13 WARN DexPlanner: dexPlan=DexPkFkPlan
19/10/08 23:08:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4183L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_nationkey#21L = n_nationkey#4098L)
         :- Project [s_nationkey#21L]
         :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :- Project [l_suppkey#308L]
         :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :     :- Project [o_orderkey#342L]
         :     :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :     :- Project [c_custkey#290L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = GERMANY)) && isnotnull(n_nationkey#108L))
         :     :     :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :     :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :     :     :     :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :     :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :     :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :     :        +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_suppkey#308L))
         :     :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Filter (isnotnull(s_suppkey#18L) && isnotnull(s_nationkey#21L))
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [n_nationkey#4098L]
            +- Filter ((isnotnull(n_name#4099) && (n_name#4099 = FRANCE)) && isnotnull(n_nationkey#4098L))
               +- Relation[n_nationkey#4098L,n_name#4099,n_regionkey#4100L,n_comment#4101] parquet

19/10/08 23:08:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4183L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (cast(dexdecrypt(concat(supplier~nation, ~, 'rid_4), 'fpk_supplier_nation_prf_4) as bigint) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (cast(dexdecrypt(concat(lineitem~supplier, ~, 'rid_3), 'fpk_lineitem_supplier_prf_3) as bigint) = 'rid_4)
            :     :- 'Join UsingJoin(Inner,List(rid_3))
            :     :  :- 'Join UsingJoin(Inner,List(rid_2))
            :     :  :  :- 'Join UsingJoin(Inner,List(rid_2))
            :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :  :  :  :  :  :  :  :- Project [rid#4185L AS rid_0#4192L, pfk_region_nation_prf#4186 AS pfk_region_nation_prf_0#4193, fpk_nation_region_prf#4187 AS fpk_nation_region_prf_0#4194, val_nation_n_name_prf#4188 AS val_nation_n_name_prf_0#4195, val_nation_n_comment_prf#4189 AS val_nation_n_comment_prf_0#4196, n_name_prf#4190 AS n_name_prf_0#4197, n_comment_prf#4191 AS n_comment_prf_0#4198]
            :     :  :  :  :  :  :  :  :  +- Relation[rid#4185L,pfk_region_nation_prf#4186,fpk_nation_region_prf#4187,val_nation_n_name_prf#4188,val_nation_n_comment_prf#4189,n_name_prf#4190,n_comment_prf#4191] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, val_nation_n_name_prf, 'val_nation_n_name_prf_0, nation_prf, 'rid_0
            :     :  :  :  :  :  :  :     +- Project [rid#4199L AS rid_0#4206L, pfk_region_nation_prf#4200 AS pfk_region_nation_prf_0#4207, fpk_nation_region_prf#4201 AS fpk_nation_region_prf_0#4208, val_nation_n_name_prf#4202 AS val_nation_n_name_prf_0#4209, val_nation_n_comment_prf#4203 AS val_nation_n_comment_prf_0#4210, n_name_prf#4204 AS n_name_prf_0#4211, n_comment_prf#4205 AS n_comment_prf_0#4212]
            :     :  :  :  :  :  :  :        +- Relation[rid#4199L,pfk_region_nation_prf#4200,fpk_nation_region_prf#4201,val_nation_n_name_prf#4202,val_nation_n_comment_prf#4203,n_name_prf#4204,n_comment_prf#4205] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, pfk_nation_customer_prf, 'pfk_nation_customer_prf_1, nation_prf, 'rid_0, customer_prf, 'rid_1
            :     :  :  :  :  :  :     :- Project [rid#4243L AS rid_0#4250L, pfk_region_nation_prf#4244 AS pfk_region_nation_prf_0#4251, fpk_nation_region_prf#4245 AS fpk_nation_region_prf_0#4252, val_nation_n_name_prf#4246 AS val_nation_n_name_prf_0#4253, val_nation_n_comment_prf#4247 AS val_nation_n_comment_prf_0#4254, n_name_prf#4248 AS n_name_prf_0#4255, n_comment_prf#4249 AS n_comment_prf_0#4256]
            :     :  :  :  :  :  :     :  +- Relation[rid#4243L,pfk_region_nation_prf#4244,fpk_nation_region_prf#4245,val_nation_n_name_prf#4246,val_nation_n_comment_prf#4247,n_name_prf#4248,n_comment_prf#4249] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  :  :  :  :  :     +- Project [rid#4257L AS rid_1#4272L, pfk_nation_customer_prf#4258 AS pfk_nation_customer_prf_1#4273, fpk_customer_nation_prf#4259 AS fpk_customer_nation_prf_1#4274, val_customer_c_name_prf#4260 AS val_customer_c_name_prf_1#4275, val_customer_c_address_prf#4261 AS val_customer_c_address_prf_1#4276, val_customer_c_phone_prf#4262 AS val_customer_c_phone_prf_1#4277, val_customer_c_acctbal_prf#4263 AS val_customer_c_acctbal_prf_1#4278, val_customer_c_comment_prf#4264 AS val_customer_c_comment_prf_1#4279, val_customer_c_mktsegment_prf#4265 AS val_customer_c_mktsegment_prf_1#4280, c_name_prf#4266 AS c_name_prf_1#4281, c_address_prf#4267 AS c_address_prf_1#4282, c_phone_prf#4268 AS c_phone_prf_1#4283, c_acctbal_prf#4269 AS c_acctbal_prf_1#4284, c_comment_prf#4270 AS c_comment_prf_1#4285, c_mktsegment_prf#4271 AS c_mktsegment_prf_1#4286]
            :     :  :  :  :  :  :        +- Relation[rid#4257L,pfk_nation_customer_prf#4258,fpk_customer_nation_prf#4259,val_customer_c_name_prf#4260,val_customer_c_address_prf#4261,val_customer_c_phone_prf#4262,val_customer_c_acctbal_prf#4263,val_customer_c_comment_prf#4264,val_customer_c_mktsegment_prf#4265,c_name_prf#4266,c_address_prf#4267,c_phone_prf#4268,c_acctbal_prf#4269,c_comment_prf#4270,c_mktsegment_prf#4271] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  :  :  :  :  +- Project [rid#4213L AS rid_1#4228L, pfk_nation_customer_prf#4214 AS pfk_nation_customer_prf_1#4229, fpk_customer_nation_prf#4215 AS fpk_customer_nation_prf_1#4230, val_customer_c_name_prf#4216 AS val_customer_c_name_prf_1#4231, val_customer_c_address_prf#4217 AS val_customer_c_address_prf_1#4232, val_customer_c_phone_prf#4218 AS val_customer_c_phone_prf_1#4233, val_customer_c_acctbal_prf#4219 AS val_customer_c_acctbal_prf_1#4234, val_customer_c_comment_prf#4220 AS val_customer_c_comment_prf_1#4235, val_customer_c_mktsegment_prf#4221 AS val_customer_c_mktsegment_prf_1#4236, c_name_prf#4222 AS c_name_prf_1#4237, c_address_prf#4223 AS c_address_prf_1#4238, c_phone_prf#4224 AS c_phone_prf_1#4239, c_acctbal_prf#4225 AS c_acctbal_prf_1#4240, c_comment_prf#4226 AS c_comment_prf_1#4241, c_mktsegment_prf#4227 AS c_mktsegment_prf_1#4242]
            :     :  :  :  :  :     +- Relation[rid#4213L,pfk_nation_customer_prf#4214,fpk_customer_nation_prf#4215,val_customer_c_name_prf#4216,val_customer_c_address_prf#4217,val_customer_c_phone_prf#4218,val_customer_c_acctbal_prf#4219,val_customer_c_comment_prf#4220,val_customer_c_mktsegment_prf#4221,c_name_prf#4222,c_address_prf#4223,c_phone_prf#4224,c_acctbal_prf#4225,c_comment_prf#4226,c_mktsegment_prf#4227] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, pfk_customer_orders_prf, 'pfk_customer_orders_prf_2, customer_prf, 'rid_1, orders_prf, 'rid_2
            :     :  :  :  :     :- Project [rid#4321L AS rid_1#4336L, pfk_nation_customer_prf#4322 AS pfk_nation_customer_prf_1#4337, fpk_customer_nation_prf#4323 AS fpk_customer_nation_prf_1#4338, val_customer_c_name_prf#4324 AS val_customer_c_name_prf_1#4339, val_customer_c_address_prf#4325 AS val_customer_c_address_prf_1#4340, val_customer_c_phone_prf#4326 AS val_customer_c_phone_prf_1#4341, val_customer_c_acctbal_prf#4327 AS val_customer_c_acctbal_prf_1#4342, val_customer_c_comment_prf#4328 AS val_customer_c_comment_prf_1#4343, val_customer_c_mktsegment_prf#4329 AS val_customer_c_mktsegment_prf_1#4344, c_name_prf#4330 AS c_name_prf_1#4345, c_address_prf#4331 AS c_address_prf_1#4346, c_phone_prf#4332 AS c_phone_prf_1#4347, c_acctbal_prf#4333 AS c_acctbal_prf_1#4348, c_comment_prf#4334 AS c_comment_prf_1#4349, c_mktsegment_prf#4335 AS c_mktsegment_prf_1#4350]
            :     :  :  :  :     :  +- Relation[rid#4321L,pfk_nation_customer_prf#4322,fpk_customer_nation_prf#4323,val_customer_c_name_prf#4324,val_customer_c_address_prf#4325,val_customer_c_phone_prf#4326,val_customer_c_acctbal_prf#4327,val_customer_c_comment_prf#4328,val_customer_c_mktsegment_prf#4329,c_name_prf#4330,c_address_prf#4331,c_phone_prf#4332,c_acctbal_prf#4333,c_comment_prf#4334,c_mktsegment_prf#4335] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  :  :  :     +- Project [rid#4351L AS rid_2#4368L, pfk_customer_orders_prf#4352 AS pfk_customer_orders_prf_2#4369, fpk_orders_customer_prf#4353 AS fpk_orders_customer_prf_2#4370, val_orders_o_orderstatus_prf#4354 AS val_orders_o_orderstatus_prf_2#4371, val_orders_o_totalprice_prf#4355 AS val_orders_o_totalprice_prf_2#4372, val_orders_o_orderpriority_prf#4356 AS val_orders_o_orderpriority_prf_2#4373, val_orders_o_clerk_prf#4357 AS val_orders_o_clerk_prf_2#4374, val_orders_o_shippriority_prf#4358 AS val_orders_o_shippriority_prf_2#4375, val_orders_o_comment_prf#4359 AS val_orders_o_comment_prf_2#4376, val_orders_o_orderdate_prf#4360 AS val_orders_o_orderdate_prf_2#4377, o_orderstatus_prf#4361 AS o_orderstatus_prf_2#4378, o_totalprice_prf#4362 AS o_totalprice_prf_2#4379, o_orderpriority_prf#4363 AS o_orderpriority_prf_2#4380, o_clerk_prf#4364 AS o_clerk_prf_2#4381, o_shippriority_prf#4365 AS o_shippriority_prf_2#4382, o_comment_prf#4366 AS o_comment_prf_2#4383, o_orderdate_prf#4367 AS o_orderdate_prf_2#4384]
            :     :  :  :  :        +- Relation[rid#4351L,pfk_customer_orders_prf#4352,fpk_orders_customer_prf#4353,val_orders_o_orderstatus_prf#4354,val_orders_o_totalprice_prf#4355,val_orders_o_orderpriority_prf#4356,val_orders_o_clerk_prf#4357,val_orders_o_shippriority_prf#4358,val_orders_o_comment_prf#4359,val_orders_o_orderdate_prf#4360,o_orderstatus_prf#4361,o_totalprice_prf#4362,o_orderpriority_prf#4363,o_clerk_prf#4364,o_shippriority_prf#4365,o_comment_prf#4366,o_orderdate_prf#4367] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  :  :  +- Project [rid#4287L AS rid_2#4304L, pfk_customer_orders_prf#4288 AS pfk_customer_orders_prf_2#4305, fpk_orders_customer_prf#4289 AS fpk_orders_customer_prf_2#4306, val_orders_o_orderstatus_prf#4290 AS val_orders_o_orderstatus_prf_2#4307, val_orders_o_totalprice_prf#4291 AS val_orders_o_totalprice_prf_2#4308, val_orders_o_orderpriority_prf#4292 AS val_orders_o_orderpriority_prf_2#4309, val_orders_o_clerk_prf#4293 AS val_orders_o_clerk_prf_2#4310, val_orders_o_shippriority_prf#4294 AS val_orders_o_shippriority_prf_2#4311, val_orders_o_comment_prf#4295 AS val_orders_o_comment_prf_2#4312, val_orders_o_orderdate_prf#4296 AS val_orders_o_orderdate_prf_2#4313, o_orderstatus_prf#4297 AS o_orderstatus_prf_2#4314, o_totalprice_prf#4298 AS o_totalprice_prf_2#4315, o_orderpriority_prf#4299 AS o_orderpriority_prf_2#4316, o_clerk_prf#4300 AS o_clerk_prf_2#4317, o_shippriority_prf#4301 AS o_shippriority_prf_2#4318, o_comment_prf#4302 AS o_comment_prf_2#4319, o_orderdate_prf#4303 AS o_orderdate_prf_2#4320]
            :     :  :  :     +- Relation[rid#4287L,pfk_customer_orders_prf#4288,fpk_orders_customer_prf#4289,val_orders_o_orderstatus_prf#4290,val_orders_o_totalprice_prf#4291,val_orders_o_orderpriority_prf#4292,val_orders_o_clerk_prf#4293,val_orders_o_shippriority_prf#4294,val_orders_o_comment_prf#4295,val_orders_o_orderdate_prf#4296,o_orderstatus_prf#4297,o_totalprice_prf#4298,o_orderpriority_prf#4299,o_clerk_prf#4300,o_shippriority_prf#4301,o_comment_prf#4302,o_orderdate_prf#4303] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, pfk_orders_lineitem_prf, 'pfk_orders_lineitem_prf_3, orders_prf, 'rid_2, lineitem_prf, 'rid_3
            :     :  :     :- Project [rid#4451L AS rid_2#4468L, pfk_customer_orders_prf#4452 AS pfk_customer_orders_prf_2#4469, fpk_orders_customer_prf#4453 AS fpk_orders_customer_prf_2#4470, val_orders_o_orderstatus_prf#4454 AS val_orders_o_orderstatus_prf_2#4471, val_orders_o_totalprice_prf#4455 AS val_orders_o_totalprice_prf_2#4472, val_orders_o_orderpriority_prf#4456 AS val_orders_o_orderpriority_prf_2#4473, val_orders_o_clerk_prf#4457 AS val_orders_o_clerk_prf_2#4474, val_orders_o_shippriority_prf#4458 AS val_orders_o_shippriority_prf_2#4475, val_orders_o_comment_prf#4459 AS val_orders_o_comment_prf_2#4476, val_orders_o_orderdate_prf#4460 AS val_orders_o_orderdate_prf_2#4477, o_orderstatus_prf#4461 AS o_orderstatus_prf_2#4478, o_totalprice_prf#4462 AS o_totalprice_prf_2#4479, o_orderpriority_prf#4463 AS o_orderpriority_prf_2#4480, o_clerk_prf#4464 AS o_clerk_prf_2#4481, o_shippriority_prf#4465 AS o_shippriority_prf_2#4482, o_comment_prf#4466 AS o_comment_prf_2#4483, o_orderdate_prf#4467 AS o_orderdate_prf_2#4484]
            :     :  :     :  +- Relation[rid#4451L,pfk_customer_orders_prf#4452,fpk_orders_customer_prf#4453,val_orders_o_orderstatus_prf#4454,val_orders_o_totalprice_prf#4455,val_orders_o_orderpriority_prf#4456,val_orders_o_clerk_prf#4457,val_orders_o_shippriority_prf#4458,val_orders_o_comment_prf#4459,val_orders_o_orderdate_prf#4460,o_orderstatus_prf#4461,o_totalprice_prf#4462,o_orderpriority_prf#4463,o_clerk_prf#4464,o_shippriority_prf#4465,o_comment_prf#4466,o_orderdate_prf#4467] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  :     +- Project [rid#4485L AS rid_3#4518L, fpk_lineitem_orders_prf#4486 AS fpk_lineitem_orders_prf_3#4519, fpk_lineitem_part_prf#4487 AS fpk_lineitem_part_prf_3#4520, fpk_lineitem_partsupp_prf#4488 AS fpk_lineitem_partsupp_prf_3#4521, fpk_lineitem_supplier_prf#4489 AS fpk_lineitem_supplier_prf_3#4522, pfk_supplier_lineitem_prf#4490 AS pfk_supplier_lineitem_prf_3#4523, pfk_part_lineitem_prf#4491 AS pfk_part_lineitem_prf_3#4524, pfk_orders_lineitem_prf#4492 AS pfk_orders_lineitem_prf_3#4525, pfk_partsupp_lineitem_prf#4493 AS pfk_partsupp_lineitem_prf_3#4526, val_lineitem_l_quantity_prf#4494 AS val_lineitem_l_quantity_prf_3#4527, val_lineitem_l_extendedprice_prf#4495 AS val_lineitem_l_extendedprice_prf_3#4528, val_lineitem_l_discount_prf#4496 AS val_lineitem_l_discount_prf_3#4529, val_lineitem_l_tax_prf#4497 AS val_lineitem_l_tax_prf_3#4530, val_lineitem_l_returnflag_prf#4498 AS val_lineitem_l_returnflag_prf_3#4531, val_lineitem_l_linestatus_prf#4499 AS val_lineitem_l_linestatus_prf_3#4532, val_lineitem_l_commitdate_prf#4500 AS val_lineitem_l_commitdate_prf_3#4533, val_lineitem_l_receiptdate_prf#4501 AS val_lineitem_l_receiptdate_prf_3#4534, val_lineitem_l_shipinstruct_prf#4502 AS val_lineitem_l_shipinstruct_prf_3#4535, val_lineitem_l_shipmode_prf#4503 AS val_lineitem_l_shipmode_prf_3#4536, val_lineitem_l_comment_prf#4504 AS val_lineitem_l_comment_prf_3#4537, val_lineitem_l_shipdate_prf#4505 AS val_lineitem_l_shipdate_prf_3#4538, l_quantity_prf#4506 AS l_quantity_prf_3#4539, l_extendedprice_prf#4507 AS l_extendedprice_prf_3#4540, l_discount_prf#4508 AS l_discount_prf_3#4541, ... 9 more fields]
            :     :  :        +- Relation[rid#4485L,fpk_lineitem_orders_prf#4486,fpk_lineitem_part_prf#4487,fpk_lineitem_partsupp_prf#4488,fpk_lineitem_supplier_prf#4489,pfk_supplier_lineitem_prf#4490,pfk_part_lineitem_prf#4491,pfk_orders_lineitem_prf#4492,pfk_partsupp_lineitem_prf#4493,val_lineitem_l_quantity_prf#4494,val_lineitem_l_extendedprice_prf#4495,val_lineitem_l_discount_prf#4496,val_lineitem_l_tax_prf#4497,val_lineitem_l_returnflag_prf#4498,val_lineitem_l_linestatus_prf#4499,val_lineitem_l_commitdate_prf#4500,val_lineitem_l_receiptdate_prf#4501,val_lineitem_l_shipinstruct_prf#4502,val_lineitem_l_shipmode_prf#4503,val_lineitem_l_comment_prf#4504,val_lineitem_l_shipdate_prf#4505,l_quantity_prf#4506,l_extendedprice_prf#4507,l_discount_prf#4508,... 9 more fields] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     :  +- Project [rid#4385L AS rid_3#4418L, fpk_lineitem_orders_prf#4386 AS fpk_lineitem_orders_prf_3#4419, fpk_lineitem_part_prf#4387 AS fpk_lineitem_part_prf_3#4420, fpk_lineitem_partsupp_prf#4388 AS fpk_lineitem_partsupp_prf_3#4421, fpk_lineitem_supplier_prf#4389 AS fpk_lineitem_supplier_prf_3#4422, pfk_supplier_lineitem_prf#4390 AS pfk_supplier_lineitem_prf_3#4423, pfk_part_lineitem_prf#4391 AS pfk_part_lineitem_prf_3#4424, pfk_orders_lineitem_prf#4392 AS pfk_orders_lineitem_prf_3#4425, pfk_partsupp_lineitem_prf#4393 AS pfk_partsupp_lineitem_prf_3#4426, val_lineitem_l_quantity_prf#4394 AS val_lineitem_l_quantity_prf_3#4427, val_lineitem_l_extendedprice_prf#4395 AS val_lineitem_l_extendedprice_prf_3#4428, val_lineitem_l_discount_prf#4396 AS val_lineitem_l_discount_prf_3#4429, val_lineitem_l_tax_prf#4397 AS val_lineitem_l_tax_prf_3#4430, val_lineitem_l_returnflag_prf#4398 AS val_lineitem_l_returnflag_prf_3#4431, val_lineitem_l_linestatus_prf#4399 AS val_lineitem_l_linestatus_prf_3#4432, val_lineitem_l_commitdate_prf#4400 AS val_lineitem_l_commitdate_prf_3#4433, val_lineitem_l_receiptdate_prf#4401 AS val_lineitem_l_receiptdate_prf_3#4434, val_lineitem_l_shipinstruct_prf#4402 AS val_lineitem_l_shipinstruct_prf_3#4435, val_lineitem_l_shipmode_prf#4403 AS val_lineitem_l_shipmode_prf_3#4436, val_lineitem_l_comment_prf#4404 AS val_lineitem_l_comment_prf_3#4437, val_lineitem_l_shipdate_prf#4405 AS val_lineitem_l_shipdate_prf_3#4438, l_quantity_prf#4406 AS l_quantity_prf_3#4439, l_extendedprice_prf#4407 AS l_extendedprice_prf_3#4440, l_discount_prf#4408 AS l_discount_prf_3#4441, ... 9 more fields]
            :     :     +- Relation[rid#4385L,fpk_lineitem_orders_prf#4386,fpk_lineitem_part_prf#4387,fpk_lineitem_partsupp_prf#4388,fpk_lineitem_supplier_prf#4389,pfk_supplier_lineitem_prf#4390,pfk_part_lineitem_prf#4391,pfk_orders_lineitem_prf#4392,pfk_partsupp_lineitem_prf#4393,val_lineitem_l_quantity_prf#4394,val_lineitem_l_extendedprice_prf#4395,val_lineitem_l_discount_prf#4396,val_lineitem_l_tax_prf#4397,val_lineitem_l_returnflag_prf#4398,val_lineitem_l_linestatus_prf#4399,val_lineitem_l_commitdate_prf#4400,val_lineitem_l_receiptdate_prf#4401,val_lineitem_l_shipinstruct_prf#4402,val_lineitem_l_shipmode_prf#4403,val_lineitem_l_comment_prf#4404,val_lineitem_l_shipdate_prf#4405,l_quantity_prf#4406,l_extendedprice_prf#4407,l_discount_prf#4408,... 9 more fields] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Project [rid#4551L AS rid_4#4564L, pfk_nation_supplier_prf#4552 AS pfk_nation_supplier_prf_4#4565, fpk_supplier_nation_prf#4553 AS fpk_supplier_nation_prf_4#4566, val_supplier_s_name_prf#4554 AS val_supplier_s_name_prf_4#4567, val_supplier_s_address_prf#4555 AS val_supplier_s_address_prf_4#4568, val_supplier_s_phone_prf#4556 AS val_supplier_s_phone_prf_4#4569, val_supplier_s_acctbal_prf#4557 AS val_supplier_s_acctbal_prf_4#4570, val_supplier_s_comment_prf#4558 AS val_supplier_s_comment_prf_4#4571, s_name_prf#4559 AS s_name_prf_4#4572, s_address_prf#4560 AS s_address_prf_4#4573, s_phone_prf#4561 AS s_phone_prf_4#4574, s_acctbal_prf#4562 AS s_acctbal_prf_4#4575, s_comment_prf#4563 AS s_comment_prf_4#4576]
            :        +- Relation[rid#4551L,pfk_nation_supplier_prf#4552,fpk_supplier_nation_prf#4553,val_supplier_s_name_prf#4554,val_supplier_s_address_prf#4555,val_supplier_s_phone_prf#4556,val_supplier_s_acctbal_prf#4557,val_supplier_s_comment_prf#4558,s_name_prf#4559,s_address_prf#4560,s_phone_prf#4561,s_acctbal_prf#4562,s_comment_prf#4563] JDBCRelation(supplier_prf) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_5))
               :- Project [rid#4577L AS rid_5#4584L, pfk_region_nation_prf#4578 AS pfk_region_nation_prf_5#4585, fpk_nation_region_prf#4579 AS fpk_nation_region_prf_5#4586, val_nation_n_name_prf#4580 AS val_nation_n_name_prf_5#4587, val_nation_n_comment_prf#4581 AS val_nation_n_comment_prf_5#4588, n_name_prf#4582 AS n_name_prf_5#4589, n_comment_prf#4583 AS n_comment_prf_5#4590]
               :  +- Relation[rid#4577L,pfk_region_nation_prf#4578,fpk_nation_region_prf#4579,val_nation_n_name_prf#4580,val_nation_n_comment_prf#4581,n_name_prf#4582,n_comment_prf#4583] JDBCRelation(nation_prf) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, val_nation_n_name_prf, 'val_nation_n_name_prf_5, nation_prf, 'rid_5
                  +- Project [rid#4591L AS rid_5#4598L, pfk_region_nation_prf#4592 AS pfk_region_nation_prf_5#4599, fpk_nation_region_prf#4593 AS fpk_nation_region_prf_5#4600, val_nation_n_name_prf#4594 AS val_nation_n_name_prf_5#4601, val_nation_n_comment_prf#4595 AS val_nation_n_comment_prf_5#4602, n_name_prf#4596 AS n_name_prf_5#4603, n_comment_prf#4597 AS n_comment_prf_5#4604]
                     +- Relation[rid#4591L,pfk_region_nation_prf#4592,fpk_nation_region_prf#4593,val_nation_n_name_prf#4594,val_nation_n_comment_prf#4595,n_name_prf#4596,n_comment_prf#4597] JDBCRelation(nation_prf) [numPartitions=1]

dex-class org.apache.spark.sql.dex.DexPkFk$ result size=9735
Elapsed time: 43467ms

Q8

q8a=

select
  o_orderdate,
  l_extendedprice,
  l_discount,
  n2.n_name
from
  part,
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2,
  region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey
  and n1.n_regionkey = r_regionkey
  and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
      
postgres result size=8716
Elapsed time: 2441ms
19/10/08 23:08:59 WARN DexPlanner: dexPlan=DexPkFkPlan
19/10/08 23:08:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5041L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_nationkey#21L = n_nationkey#4951L)
         :- Project [s_nationkey#21L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L, s_nationkey#21L]
         :     :  +- Filter (isnotnull(s_suppkey#18L) && isnotnull(s_nationkey#21L))
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_suppkey#308L]
         :        +- Join Inner, (n_regionkey#110L = r_regionkey#116L)
         :           :- Project [l_suppkey#308L, n_regionkey#110L]
         :           :  +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :           :     :- Project [l_suppkey#308L, c_nationkey#293L]
         :           :     :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :           :     :     :- Project [l_suppkey#308L, o_custkey#343L]
         :           :     :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :           :     :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :           :     :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :           :     :     :     :     :- Project [p_partkey#360L]
         :           :     :     :     :     :  +- Filter ((isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL)) && isnotnull(p_partkey#360L))
         :           :     :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :           :     :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :           :     :     :     :        +- Filter ((isnotnull(l_partkey#307L) && isnotnull(l_orderkey#306L)) && isnotnull(l_suppkey#308L))
         :           :     :     :     :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :           :     :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :           :     :     :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           :     :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :           :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :           :     :        +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
         :           :     :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :           :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :           :        +- Filter (isnotnull(n_nationkey#108L) && isnotnull(n_regionkey#110L))
         :           :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :           +- Project [r_regionkey#116L]
         :              +- Filter ((isnotnull(r_name#117) && (r_name#117 = AMERICA)) && isnotnull(r_regionkey#116L))
         :                 +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_nationkey#4951L]
            +- Filter isnotnull(n_nationkey#4951L)
               +- Relation[n_nationkey#4951L,n_name#4952,n_regionkey#4953L,n_comment#4954] parquet

19/10/08 23:09:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5041L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (cast(dexdecrypt(concat(supplier~nation, ~, 'rid_0), 'fpk_supplier_nation_prf_0) as bigint) = 'rid_7)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :- Project [rid#5043L AS rid_0#5056L, pfk_nation_supplier_prf#5044 AS pfk_nation_supplier_prf_0#5057, fpk_supplier_nation_prf#5045 AS fpk_supplier_nation_prf_0#5058, val_supplier_s_name_prf#5046 AS val_supplier_s_name_prf_0#5059, val_supplier_s_address_prf#5047 AS val_supplier_s_address_prf_0#5060, val_supplier_s_phone_prf#5048 AS val_supplier_s_phone_prf_0#5061, val_supplier_s_acctbal_prf#5049 AS val_supplier_s_acctbal_prf_0#5062, val_supplier_s_comment_prf#5050 AS val_supplier_s_comment_prf_0#5063, s_name_prf#5051 AS s_name_prf_0#5064, s_address_prf#5052 AS s_address_prf_0#5065, s_phone_prf#5053 AS s_phone_prf_0#5066, s_acctbal_prf#5054 AS s_acctbal_prf_0#5067, s_comment_prf#5055 AS s_comment_prf_0#5068]
            :  :  :  +- Relation[rid#5043L,pfk_nation_supplier_prf#5044,fpk_supplier_nation_prf#5045,val_supplier_s_name_prf#5046,val_supplier_s_address_prf#5047,val_supplier_s_phone_prf#5048,val_supplier_s_acctbal_prf#5049,val_supplier_s_comment_prf#5050,s_name_prf#5051,s_address_prf#5052,s_phone_prf#5053,s_acctbal_prf#5054,s_comment_prf#5055] JDBCRelation(supplier_prf) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, pfk_supplier_lineitem_prf, 'pfk_supplier_lineitem_prf_2, supplier_prf, 'rid_0, lineitem_prf, 'rid_2
            :  :     :- Project [rid#5401L AS rid_0#5414L, pfk_nation_supplier_prf#5402 AS pfk_nation_supplier_prf_0#5415, fpk_supplier_nation_prf#5403 AS fpk_supplier_nation_prf_0#5416, val_supplier_s_name_prf#5404 AS val_supplier_s_name_prf_0#5417, val_supplier_s_address_prf#5405 AS val_supplier_s_address_prf_0#5418, val_supplier_s_phone_prf#5406 AS val_supplier_s_phone_prf_0#5419, val_supplier_s_acctbal_prf#5407 AS val_supplier_s_acctbal_prf_0#5420, val_supplier_s_comment_prf#5408 AS val_supplier_s_comment_prf_0#5421, s_name_prf#5409 AS s_name_prf_0#5422, s_address_prf#5410 AS s_address_prf_0#5423, s_phone_prf#5411 AS s_phone_prf_0#5424, s_acctbal_prf#5412 AS s_acctbal_prf_0#5425, s_comment_prf#5413 AS s_comment_prf_0#5426]
            :  :     :  +- Relation[rid#5401L,pfk_nation_supplier_prf#5402,fpk_supplier_nation_prf#5403,val_supplier_s_name_prf#5404,val_supplier_s_address_prf#5405,val_supplier_s_phone_prf#5406,val_supplier_s_acctbal_prf#5407,val_supplier_s_comment_prf#5408,s_name_prf#5409,s_address_prf#5410,s_phone_prf#5411,s_acctbal_prf#5412,s_comment_prf#5413] JDBCRelation(supplier_prf) [numPartitions=1]
            :  :     +- Project [rid#5427L AS rid_2#5460L, fpk_lineitem_orders_prf#5428 AS fpk_lineitem_orders_prf_2#5461, fpk_lineitem_part_prf#5429 AS fpk_lineitem_part_prf_2#5462, fpk_lineitem_partsupp_prf#5430 AS fpk_lineitem_partsupp_prf_2#5463, fpk_lineitem_supplier_prf#5431 AS fpk_lineitem_supplier_prf_2#5464, pfk_supplier_lineitem_prf#5432 AS pfk_supplier_lineitem_prf_2#5465, pfk_part_lineitem_prf#5433 AS pfk_part_lineitem_prf_2#5466, pfk_orders_lineitem_prf#5434 AS pfk_orders_lineitem_prf_2#5467, pfk_partsupp_lineitem_prf#5435 AS pfk_partsupp_lineitem_prf_2#5468, val_lineitem_l_quantity_prf#5436 AS val_lineitem_l_quantity_prf_2#5469, val_lineitem_l_extendedprice_prf#5437 AS val_lineitem_l_extendedprice_prf_2#5470, val_lineitem_l_discount_prf#5438 AS val_lineitem_l_discount_prf_2#5471, val_lineitem_l_tax_prf#5439 AS val_lineitem_l_tax_prf_2#5472, val_lineitem_l_returnflag_prf#5440 AS val_lineitem_l_returnflag_prf_2#5473, val_lineitem_l_linestatus_prf#5441 AS val_lineitem_l_linestatus_prf_2#5474, val_lineitem_l_commitdate_prf#5442 AS val_lineitem_l_commitdate_prf_2#5475, val_lineitem_l_receiptdate_prf#5443 AS val_lineitem_l_receiptdate_prf_2#5476, val_lineitem_l_shipinstruct_prf#5444 AS val_lineitem_l_shipinstruct_prf_2#5477, val_lineitem_l_shipmode_prf#5445 AS val_lineitem_l_shipmode_prf_2#5478, val_lineitem_l_comment_prf#5446 AS val_lineitem_l_comment_prf_2#5479, val_lineitem_l_shipdate_prf#5447 AS val_lineitem_l_shipdate_prf_2#5480, l_quantity_prf#5448 AS l_quantity_prf_2#5481, l_extendedprice_prf#5449 AS l_extendedprice_prf_2#5482, l_discount_prf#5450 AS l_discount_prf_2#5483, ... 9 more fields]
            :  :        +- Relation[rid#5427L,fpk_lineitem_orders_prf#5428,fpk_lineitem_part_prf#5429,fpk_lineitem_partsupp_prf#5430,fpk_lineitem_supplier_prf#5431,pfk_supplier_lineitem_prf#5432,pfk_part_lineitem_prf#5433,pfk_orders_lineitem_prf#5434,pfk_partsupp_lineitem_prf#5435,val_lineitem_l_quantity_prf#5436,val_lineitem_l_extendedprice_prf#5437,val_lineitem_l_discount_prf#5438,val_lineitem_l_tax_prf#5439,val_lineitem_l_returnflag_prf#5440,val_lineitem_l_linestatus_prf#5441,val_lineitem_l_commitdate_prf#5442,val_lineitem_l_receiptdate_prf#5443,val_lineitem_l_shipinstruct_prf#5444,val_lineitem_l_shipmode_prf#5445,val_lineitem_l_comment_prf#5446,val_lineitem_l_shipdate_prf#5447,l_quantity_prf#5448,l_extendedprice_prf#5449,l_discount_prf#5450,... 9 more fields] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [*]
            :     +- 'Join Inner, (cast(dexdecrypt(concat(nation~region, ~, 'rid_5), 'fpk_nation_region_prf_5) as bigint) = 'rid_6)
            :        :- 'Project [*]
            :        :  +- 'Join Inner, (cast(dexdecrypt(concat(customer~nation, ~, 'rid_4), 'fpk_customer_nation_prf_4) as bigint) = 'rid_5)
            :        :     :- 'Project [*]
            :        :     :  +- 'Join Inner, (cast(dexdecrypt(concat(orders~customer, ~, 'rid_3), 'fpk_orders_customer_prf_3) as bigint) = 'rid_4)
            :        :     :     :- 'Project [*]
            :        :     :     :  +- 'Join Inner, (cast(dexdecrypt(concat(lineitem~orders, ~, 'rid_2), 'fpk_lineitem_orders_prf_2) as bigint) = 'rid_3)
            :        :     :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :        :     :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :        :     :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :        :     :     :     :  :  :  :- Project [rid#5069L AS rid_1#5086L, val_part_p_name_prf#5070 AS val_part_p_name_prf_1#5087, val_part_p_mfgr_prf#5071 AS val_part_p_mfgr_prf_1#5088, val_part_p_type_prf#5072 AS val_part_p_type_prf_1#5089, val_part_p_size_prf#5073 AS val_part_p_size_prf_1#5090, val_part_p_container_prf#5074 AS val_part_p_container_prf_1#5091, val_part_p_retailprice_prf#5075 AS val_part_p_retailprice_prf_1#5092, val_part_p_comment_prf#5076 AS val_part_p_comment_prf_1#5093, val_part_p_brand_prf#5077 AS val_part_p_brand_prf_1#5094, p_name_prf#5078 AS p_name_prf_1#5095, p_mfgr_prf#5079 AS p_mfgr_prf_1#5096, p_type_prf#5080 AS p_type_prf_1#5097, p_size_prf#5081 AS p_size_prf_1#5098, p_container_prf#5082 AS p_container_prf_1#5099, p_retailprice_prf#5083 AS p_retailprice_prf_1#5100, p_comment_prf#5084 AS p_comment_prf_1#5101, p_brand_prf#5085 AS p_brand_prf_1#5102]
            :        :     :     :     :  :  :  :  +- Relation[rid#5069L,val_part_p_name_prf#5070,val_part_p_mfgr_prf#5071,val_part_p_type_prf#5072,val_part_p_size_prf#5073,val_part_p_container_prf#5074,val_part_p_retailprice_prf#5075,val_part_p_comment_prf#5076,val_part_p_brand_prf#5077,p_name_prf#5078,p_mfgr_prf#5079,p_type_prf#5080,p_size_prf#5081,p_container_prf#5082,p_retailprice_prf#5083,p_comment_prf#5084,p_brand_prf#5085] JDBCRelation(part_prf) [numPartitions=1]
            :        :     :     :     :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, val_part_p_type_prf, 'val_part_p_type_prf_1, part_prf, 'rid_1
            :        :     :     :     :  :  :     +- Project [rid#5103L AS rid_1#5120L, val_part_p_name_prf#5104 AS val_part_p_name_prf_1#5121, val_part_p_mfgr_prf#5105 AS val_part_p_mfgr_prf_1#5122, val_part_p_type_prf#5106 AS val_part_p_type_prf_1#5123, val_part_p_size_prf#5107 AS val_part_p_size_prf_1#5124, val_part_p_container_prf#5108 AS val_part_p_container_prf_1#5125, val_part_p_retailprice_prf#5109 AS val_part_p_retailprice_prf_1#5126, val_part_p_comment_prf#5110 AS val_part_p_comment_prf_1#5127, val_part_p_brand_prf#5111 AS val_part_p_brand_prf_1#5128, p_name_prf#5112 AS p_name_prf_1#5129, p_mfgr_prf#5113 AS p_mfgr_prf_1#5130, p_type_prf#5114 AS p_type_prf_1#5131, p_size_prf#5115 AS p_size_prf_1#5132, p_container_prf#5116 AS p_container_prf_1#5133, p_retailprice_prf#5117 AS p_retailprice_prf_1#5134, p_comment_prf#5118 AS p_comment_prf_1#5135, p_brand_prf#5119 AS p_brand_prf_1#5136]
            :        :     :     :     :  :  :        +- Relation[rid#5103L,val_part_p_name_prf#5104,val_part_p_mfgr_prf#5105,val_part_p_type_prf#5106,val_part_p_size_prf#5107,val_part_p_container_prf#5108,val_part_p_retailprice_prf#5109,val_part_p_comment_prf#5110,val_part_p_brand_prf#5111,p_name_prf#5112,p_mfgr_prf#5113,p_type_prf#5114,p_size_prf#5115,p_container_prf#5116,p_retailprice_prf#5117,p_comment_prf#5118,p_brand_prf#5119] JDBCRelation(part_prf) [numPartitions=1]
            :        :     :     :     :  :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, pfk_part_lineitem_prf, 'pfk_part_lineitem_prf_2, part_prf, 'rid_1, lineitem_prf, 'rid_2
            :        :     :     :     :  :     :- Project [rid#5203L AS rid_1#5220L, val_part_p_name_prf#5204 AS val_part_p_name_prf_1#5221, val_part_p_mfgr_prf#5205 AS val_part_p_mfgr_prf_1#5222, val_part_p_type_prf#5206 AS val_part_p_type_prf_1#5223, val_part_p_size_prf#5207 AS val_part_p_size_prf_1#5224, val_part_p_container_prf#5208 AS val_part_p_container_prf_1#5225, val_part_p_retailprice_prf#5209 AS val_part_p_retailprice_prf_1#5226, val_part_p_comment_prf#5210 AS val_part_p_comment_prf_1#5227, val_part_p_brand_prf#5211 AS val_part_p_brand_prf_1#5228, p_name_prf#5212 AS p_name_prf_1#5229, p_mfgr_prf#5213 AS p_mfgr_prf_1#5230, p_type_prf#5214 AS p_type_prf_1#5231, p_size_prf#5215 AS p_size_prf_1#5232, p_container_prf#5216 AS p_container_prf_1#5233, p_retailprice_prf#5217 AS p_retailprice_prf_1#5234, p_comment_prf#5218 AS p_comment_prf_1#5235, p_brand_prf#5219 AS p_brand_prf_1#5236]
            :        :     :     :     :  :     :  +- Relation[rid#5203L,val_part_p_name_prf#5204,val_part_p_mfgr_prf#5205,val_part_p_type_prf#5206,val_part_p_size_prf#5207,val_part_p_container_prf#5208,val_part_p_retailprice_prf#5209,val_part_p_comment_prf#5210,val_part_p_brand_prf#5211,p_name_prf#5212,p_mfgr_prf#5213,p_type_prf#5214,p_size_prf#5215,p_container_prf#5216,p_retailprice_prf#5217,p_comment_prf#5218,p_brand_prf#5219] JDBCRelation(part_prf) [numPartitions=1]
            :        :     :     :     :  :     +- Project [rid#5237L AS rid_2#5270L, fpk_lineitem_orders_prf#5238 AS fpk_lineitem_orders_prf_2#5271, fpk_lineitem_part_prf#5239 AS fpk_lineitem_part_prf_2#5272, fpk_lineitem_partsupp_prf#5240 AS fpk_lineitem_partsupp_prf_2#5273, fpk_lineitem_supplier_prf#5241 AS fpk_lineitem_supplier_prf_2#5274, pfk_supplier_lineitem_prf#5242 AS pfk_supplier_lineitem_prf_2#5275, pfk_part_lineitem_prf#5243 AS pfk_part_lineitem_prf_2#5276, pfk_orders_lineitem_prf#5244 AS pfk_orders_lineitem_prf_2#5277, pfk_partsupp_lineitem_prf#5245 AS pfk_partsupp_lineitem_prf_2#5278, val_lineitem_l_quantity_prf#5246 AS val_lineitem_l_quantity_prf_2#5279, val_lineitem_l_extendedprice_prf#5247 AS val_lineitem_l_extendedprice_prf_2#5280, val_lineitem_l_discount_prf#5248 AS val_lineitem_l_discount_prf_2#5281, val_lineitem_l_tax_prf#5249 AS val_lineitem_l_tax_prf_2#5282, val_lineitem_l_returnflag_prf#5250 AS val_lineitem_l_returnflag_prf_2#5283, val_lineitem_l_linestatus_prf#5251 AS val_lineitem_l_linestatus_prf_2#5284, val_lineitem_l_commitdate_prf#5252 AS val_lineitem_l_commitdate_prf_2#5285, val_lineitem_l_receiptdate_prf#5253 AS val_lineitem_l_receiptdate_prf_2#5286, val_lineitem_l_shipinstruct_prf#5254 AS val_lineitem_l_shipinstruct_prf_2#5287, val_lineitem_l_shipmode_prf#5255 AS val_lineitem_l_shipmode_prf_2#5288, val_lineitem_l_comment_prf#5256 AS val_lineitem_l_comment_prf_2#5289, val_lineitem_l_shipdate_prf#5257 AS val_lineitem_l_shipdate_prf_2#5290, l_quantity_prf#5258 AS l_quantity_prf_2#5291, l_extendedprice_prf#5259 AS l_extendedprice_prf_2#5292, l_discount_prf#5260 AS l_discount_prf_2#5293, ... 9 more fields]
            :        :     :     :     :  :        +- Relation[rid#5237L,fpk_lineitem_orders_prf#5238,fpk_lineitem_part_prf#5239,fpk_lineitem_partsupp_prf#5240,fpk_lineitem_supplier_prf#5241,pfk_supplier_lineitem_prf#5242,pfk_part_lineitem_prf#5243,pfk_orders_lineitem_prf#5244,pfk_partsupp_lineitem_prf#5245,val_lineitem_l_quantity_prf#5246,val_lineitem_l_extendedprice_prf#5247,val_lineitem_l_discount_prf#5248,val_lineitem_l_tax_prf#5249,val_lineitem_l_returnflag_prf#5250,val_lineitem_l_linestatus_prf#5251,val_lineitem_l_commitdate_prf#5252,val_lineitem_l_receiptdate_prf#5253,val_lineitem_l_shipinstruct_prf#5254,val_lineitem_l_shipmode_prf#5255,val_lineitem_l_comment_prf#5256,val_lineitem_l_shipdate_prf#5257,l_quantity_prf#5258,l_extendedprice_prf#5259,l_discount_prf#5260,... 9 more fields] JDBCRelation(lineitem_prf) [numPartitions=1]
            :        :     :     :     :  +- Project [rid#5137L AS rid_2#5170L, fpk_lineitem_orders_prf#5138 AS fpk_lineitem_orders_prf_2#5171, fpk_lineitem_part_prf#5139 AS fpk_lineitem_part_prf_2#5172, fpk_lineitem_partsupp_prf#5140 AS fpk_lineitem_partsupp_prf_2#5173, fpk_lineitem_supplier_prf#5141 AS fpk_lineitem_supplier_prf_2#5174, pfk_supplier_lineitem_prf#5142 AS pfk_supplier_lineitem_prf_2#5175, pfk_part_lineitem_prf#5143 AS pfk_part_lineitem_prf_2#5176, pfk_orders_lineitem_prf#5144 AS pfk_orders_lineitem_prf_2#5177, pfk_partsupp_lineitem_prf#5145 AS pfk_partsupp_lineitem_prf_2#5178, val_lineitem_l_quantity_prf#5146 AS val_lineitem_l_quantity_prf_2#5179, val_lineitem_l_extendedprice_prf#5147 AS val_lineitem_l_extendedprice_prf_2#5180, val_lineitem_l_discount_prf#5148 AS val_lineitem_l_discount_prf_2#5181, val_lineitem_l_tax_prf#5149 AS val_lineitem_l_tax_prf_2#5182, val_lineitem_l_returnflag_prf#5150 AS val_lineitem_l_returnflag_prf_2#5183, val_lineitem_l_linestatus_prf#5151 AS val_lineitem_l_linestatus_prf_2#5184, val_lineitem_l_commitdate_prf#5152 AS val_lineitem_l_commitdate_prf_2#5185, val_lineitem_l_receiptdate_prf#5153 AS val_lineitem_l_receiptdate_prf_2#5186, val_lineitem_l_shipinstruct_prf#5154 AS val_lineitem_l_shipinstruct_prf_2#5187, val_lineitem_l_shipmode_prf#5155 AS val_lineitem_l_shipmode_prf_2#5188, val_lineitem_l_comment_prf#5156 AS val_lineitem_l_comment_prf_2#5189, val_lineitem_l_shipdate_prf#5157 AS val_lineitem_l_shipdate_prf_2#5190, l_quantity_prf#5158 AS l_quantity_prf_2#5191, l_extendedprice_prf#5159 AS l_extendedprice_prf_2#5192, l_discount_prf#5160 AS l_discount_prf_2#5193, ... 9 more fields]
            :        :     :     :     :     +- Relation[rid#5137L,fpk_lineitem_orders_prf#5138,fpk_lineitem_part_prf#5139,fpk_lineitem_partsupp_prf#5140,fpk_lineitem_supplier_prf#5141,pfk_supplier_lineitem_prf#5142,pfk_part_lineitem_prf#5143,pfk_orders_lineitem_prf#5144,pfk_partsupp_lineitem_prf#5145,val_lineitem_l_quantity_prf#5146,val_lineitem_l_extendedprice_prf#5147,val_lineitem_l_discount_prf#5148,val_lineitem_l_tax_prf#5149,val_lineitem_l_returnflag_prf#5150,val_lineitem_l_linestatus_prf#5151,val_lineitem_l_commitdate_prf#5152,val_lineitem_l_receiptdate_prf#5153,val_lineitem_l_shipinstruct_prf#5154,val_lineitem_l_shipmode_prf#5155,val_lineitem_l_comment_prf#5156,val_lineitem_l_shipdate_prf#5157,l_quantity_prf#5158,l_extendedprice_prf#5159,l_discount_prf#5160,... 9 more fields] JDBCRelation(lineitem_prf) [numPartitions=1]
            :        :     :     :     +- Project [rid#5303L AS rid_3#5320L, pfk_customer_orders_prf#5304 AS pfk_customer_orders_prf_3#5321, fpk_orders_customer_prf#5305 AS fpk_orders_customer_prf_3#5322, val_orders_o_orderstatus_prf#5306 AS val_orders_o_orderstatus_prf_3#5323, val_orders_o_totalprice_prf#5307 AS val_orders_o_totalprice_prf_3#5324, val_orders_o_orderpriority_prf#5308 AS val_orders_o_orderpriority_prf_3#5325, val_orders_o_clerk_prf#5309 AS val_orders_o_clerk_prf_3#5326, val_orders_o_shippriority_prf#5310 AS val_orders_o_shippriority_prf_3#5327, val_orders_o_comment_prf#5311 AS val_orders_o_comment_prf_3#5328, val_orders_o_orderdate_prf#5312 AS val_orders_o_orderdate_prf_3#5329, o_orderstatus_prf#5313 AS o_orderstatus_prf_3#5330, o_totalprice_prf#5314 AS o_totalprice_prf_3#5331, o_orderpriority_prf#5315 AS o_orderpriority_prf_3#5332, o_clerk_prf#5316 AS o_clerk_prf_3#5333, o_shippriority_prf#5317 AS o_shippriority_prf_3#5334, o_comment_prf#5318 AS o_comment_prf_3#5335, o_orderdate_prf#5319 AS o_orderdate_prf_3#5336]
            :        :     :     :        +- Relation[rid#5303L,pfk_customer_orders_prf#5304,fpk_orders_customer_prf#5305,val_orders_o_orderstatus_prf#5306,val_orders_o_totalprice_prf#5307,val_orders_o_orderpriority_prf#5308,val_orders_o_clerk_prf#5309,val_orders_o_shippriority_prf#5310,val_orders_o_comment_prf#5311,val_orders_o_orderdate_prf#5312,o_orderstatus_prf#5313,o_totalprice_prf#5314,o_orderpriority_prf#5315,o_clerk_prf#5316,o_shippriority_prf#5317,o_comment_prf#5318,o_orderdate_prf#5319] JDBCRelation(orders_prf) [numPartitions=1]
            :        :     :     +- Project [rid#5337L AS rid_4#5352L, pfk_nation_customer_prf#5338 AS pfk_nation_customer_prf_4#5353, fpk_customer_nation_prf#5339 AS fpk_customer_nation_prf_4#5354, val_customer_c_name_prf#5340 AS val_customer_c_name_prf_4#5355, val_customer_c_address_prf#5341 AS val_customer_c_address_prf_4#5356, val_customer_c_phone_prf#5342 AS val_customer_c_phone_prf_4#5357, val_customer_c_acctbal_prf#5343 AS val_customer_c_acctbal_prf_4#5358, val_customer_c_comment_prf#5344 AS val_customer_c_comment_prf_4#5359, val_customer_c_mktsegment_prf#5345 AS val_customer_c_mktsegment_prf_4#5360, c_name_prf#5346 AS c_name_prf_4#5361, c_address_prf#5347 AS c_address_prf_4#5362, c_phone_prf#5348 AS c_phone_prf_4#5363, c_acctbal_prf#5349 AS c_acctbal_prf_4#5364, c_comment_prf#5350 AS c_comment_prf_4#5365, c_mktsegment_prf#5351 AS c_mktsegment_prf_4#5366]
            :        :     :        +- Relation[rid#5337L,pfk_nation_customer_prf#5338,fpk_customer_nation_prf#5339,val_customer_c_name_prf#5340,val_customer_c_address_prf#5341,val_customer_c_phone_prf#5342,val_customer_c_acctbal_prf#5343,val_customer_c_comment_prf#5344,val_customer_c_mktsegment_prf#5345,c_name_prf#5346,c_address_prf#5347,c_phone_prf#5348,c_acctbal_prf#5349,c_comment_prf#5350,c_mktsegment_prf#5351] JDBCRelation(customer_prf) [numPartitions=1]
            :        :     +- Project [rid#5367L AS rid_5#5374L, pfk_region_nation_prf#5368 AS pfk_region_nation_prf_5#5375, fpk_nation_region_prf#5369 AS fpk_nation_region_prf_5#5376, val_nation_n_name_prf#5370 AS val_nation_n_name_prf_5#5377, val_nation_n_comment_prf#5371 AS val_nation_n_comment_prf_5#5378, n_name_prf#5372 AS n_name_prf_5#5379, n_comment_prf#5373 AS n_comment_prf_5#5380]
            :        :        +- Relation[rid#5367L,pfk_region_nation_prf#5368,fpk_nation_region_prf#5369,val_nation_n_name_prf#5370,val_nation_n_comment_prf#5371,n_name_prf#5372,n_comment_prf#5373] JDBCRelation(nation_prf) [numPartitions=1]
            :        +- 'Join UsingJoin(LeftSemi,List(rid_6))
            :           :- Project [rid#5381L AS rid_6#5386L, val_region_r_name_prf#5382 AS val_region_r_name_prf_6#5387, val_region_r_comment_prf#5383 AS val_region_r_comment_prf_6#5388, r_name_prf#5384 AS r_name_prf_6#5389, r_comment_prf#5385 AS r_comment_prf_6#5390]
            :           :  +- Relation[rid#5381L,val_region_r_name_prf#5382,val_region_r_comment_prf#5383,r_name_prf#5384,r_comment_prf#5385] JDBCRelation(region_prf) [numPartitions=1]
            :           +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, val_region_r_name_prf, 'val_region_r_name_prf_6, region_prf, 'rid_6
            :              +- Project [rid#5391L AS rid_6#5396L, val_region_r_name_prf#5392 AS val_region_r_name_prf_6#5397, val_region_r_comment_prf#5393 AS val_region_r_comment_prf_6#5398, r_name_prf#5394 AS r_name_prf_6#5399, r_comment_prf#5395 AS r_comment_prf_6#5400]
            :                 +- Relation[rid#5391L,val_region_r_name_prf#5392,val_region_r_comment_prf#5393,r_name_prf#5394,r_comment_prf#5395] JDBCRelation(region_prf) [numPartitions=1]
            +- Project [rid#5493L AS rid_7#5500L, pfk_region_nation_prf#5494 AS pfk_region_nation_prf_7#5501, fpk_nation_region_prf#5495 AS fpk_nation_region_prf_7#5502, val_nation_n_name_prf#5496 AS val_nation_n_name_prf_7#5503, val_nation_n_comment_prf#5497 AS val_nation_n_comment_prf_7#5504, n_name_prf#5498 AS n_name_prf_7#5505, n_comment_prf#5499 AS n_comment_prf_7#5506]
               +- Relation[rid#5493L,pfk_region_nation_prf#5494,fpk_nation_region_prf#5495,val_nation_n_name_prf#5496,val_nation_n_comment_prf#5497,n_name_prf#5498,n_comment_prf#5499] JDBCRelation(nation_prf) [numPartitions=1]

dex-class org.apache.spark.sql.dex.DexPkFk$ result size=8716
Elapsed time: 60844ms

 Q9

q9a=

select
  n_name,
  o_orderdate,
  l_extendedprice,
  l_discount,
  ps_supplycost,
  l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey and s_nationkey = n_nationkey
      
postgres result size=6001215
Elapsed time: 38474ms
19/10/08 23:10:39 WARN DexPlanner: dexPlan=DexPkFkPlan
19/10/08 23:10:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5832L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_orderkey#306L, l_partkey#307L]
                  +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
                     :- Project [ps_partkey#32L, ps_suppkey#33L]
                     :  +- Filter (isnotnull(ps_suppkey#33L) && isnotnull(ps_partkey#32L))
                     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
                     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
                        +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
                           :- Project [s_nationkey#21L, l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
                           :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
                           :     :- Project [s_suppkey#18L, s_nationkey#21L]
                           :     :  +- Filter (isnotnull(s_suppkey#18L) && isnotnull(s_nationkey#21L))
                           :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
                           :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
                           :        +- Filter ((isnotnull(l_suppkey#308L) && isnotnull(l_partkey#307L)) && isnotnull(l_orderkey#306L))
                           :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
                           +- Project [n_nationkey#108L]
                              +- Filter isnotnull(n_nationkey#108L)
                                 +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/08 23:10:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5832L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#5834L AS rid_0#5851L, pfk_customer_orders_prf#5835 AS pfk_customer_orders_prf_0#5852, fpk_orders_customer_prf#5836 AS fpk_orders_customer_prf_0#5853, val_orders_o_orderstatus_prf#5837 AS val_orders_o_orderstatus_prf_0#5854, val_orders_o_totalprice_prf#5838 AS val_orders_o_totalprice_prf_0#5855, val_orders_o_orderpriority_prf#5839 AS val_orders_o_orderpriority_prf_0#5856, val_orders_o_clerk_prf#5840 AS val_orders_o_clerk_prf_0#5857, val_orders_o_shippriority_prf#5841 AS val_orders_o_shippriority_prf_0#5858, val_orders_o_comment_prf#5842 AS val_orders_o_comment_prf_0#5859, val_orders_o_orderdate_prf#5843 AS val_orders_o_orderdate_prf_0#5860, o_orderstatus_prf#5844 AS o_orderstatus_prf_0#5861, o_totalprice_prf#5845 AS o_totalprice_prf_0#5862, o_orderpriority_prf#5846 AS o_orderpriority_prf_0#5863, o_clerk_prf#5847 AS o_clerk_prf_0#5864, o_shippriority_prf#5848 AS o_shippriority_prf_0#5865, o_comment_prf#5849 AS o_comment_prf_0#5866, o_orderdate_prf#5850 AS o_orderdate_prf_0#5867]
         :  :  +- Relation[rid#5834L,pfk_customer_orders_prf#5835,fpk_orders_customer_prf#5836,val_orders_o_orderstatus_prf#5837,val_orders_o_totalprice_prf#5838,val_orders_o_orderpriority_prf#5839,val_orders_o_clerk_prf#5840,val_orders_o_shippriority_prf#5841,val_orders_o_comment_prf#5842,val_orders_o_orderdate_prf#5843,o_orderstatus_prf#5844,o_totalprice_prf#5845,o_orderpriority_prf#5846,o_clerk_prf#5847,o_shippriority_prf#5848,o_comment_prf#5849,o_orderdate_prf#5850] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, pfk_orders_lineitem_prf, 'pfk_orders_lineitem_prf_4, orders_prf, 'rid_0, lineitem_prf, 'rid_4
         :     :- Project [rid#6310L AS rid_0#6327L, pfk_customer_orders_prf#6311 AS pfk_customer_orders_prf_0#6328, fpk_orders_customer_prf#6312 AS fpk_orders_customer_prf_0#6329, val_orders_o_orderstatus_prf#6313 AS val_orders_o_orderstatus_prf_0#6330, val_orders_o_totalprice_prf#6314 AS val_orders_o_totalprice_prf_0#6331, val_orders_o_orderpriority_prf#6315 AS val_orders_o_orderpriority_prf_0#6332, val_orders_o_clerk_prf#6316 AS val_orders_o_clerk_prf_0#6333, val_orders_o_shippriority_prf#6317 AS val_orders_o_shippriority_prf_0#6334, val_orders_o_comment_prf#6318 AS val_orders_o_comment_prf_0#6335, val_orders_o_orderdate_prf#6319 AS val_orders_o_orderdate_prf_0#6336, o_orderstatus_prf#6320 AS o_orderstatus_prf_0#6337, o_totalprice_prf#6321 AS o_totalprice_prf_0#6338, o_orderpriority_prf#6322 AS o_orderpriority_prf_0#6339, o_clerk_prf#6323 AS o_clerk_prf_0#6340, o_shippriority_prf#6324 AS o_shippriority_prf_0#6341, o_comment_prf#6325 AS o_comment_prf_0#6342, o_orderdate_prf#6326 AS o_orderdate_prf_0#6343]
         :     :  +- Relation[rid#6310L,pfk_customer_orders_prf#6311,fpk_orders_customer_prf#6312,val_orders_o_orderstatus_prf#6313,val_orders_o_totalprice_prf#6314,val_orders_o_orderpriority_prf#6315,val_orders_o_clerk_prf#6316,val_orders_o_shippriority_prf#6317,val_orders_o_comment_prf#6318,val_orders_o_orderdate_prf#6319,o_orderstatus_prf#6320,o_totalprice_prf#6321,o_orderpriority_prf#6322,o_clerk_prf#6323,o_shippriority_prf#6324,o_comment_prf#6325,o_orderdate_prf#6326] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Project [rid#6344L AS rid_4#6377L, fpk_lineitem_orders_prf#6345 AS fpk_lineitem_orders_prf_4#6378, fpk_lineitem_part_prf#6346 AS fpk_lineitem_part_prf_4#6379, fpk_lineitem_partsupp_prf#6347 AS fpk_lineitem_partsupp_prf_4#6380, fpk_lineitem_supplier_prf#6348 AS fpk_lineitem_supplier_prf_4#6381, pfk_supplier_lineitem_prf#6349 AS pfk_supplier_lineitem_prf_4#6382, pfk_part_lineitem_prf#6350 AS pfk_part_lineitem_prf_4#6383, pfk_orders_lineitem_prf#6351 AS pfk_orders_lineitem_prf_4#6384, pfk_partsupp_lineitem_prf#6352 AS pfk_partsupp_lineitem_prf_4#6385, val_lineitem_l_quantity_prf#6353 AS val_lineitem_l_quantity_prf_4#6386, val_lineitem_l_extendedprice_prf#6354 AS val_lineitem_l_extendedprice_prf_4#6387, val_lineitem_l_discount_prf#6355 AS val_lineitem_l_discount_prf_4#6388, val_lineitem_l_tax_prf#6356 AS val_lineitem_l_tax_prf_4#6389, val_lineitem_l_returnflag_prf#6357 AS val_lineitem_l_returnflag_prf_4#6390, val_lineitem_l_linestatus_prf#6358 AS val_lineitem_l_linestatus_prf_4#6391, val_lineitem_l_commitdate_prf#6359 AS val_lineitem_l_commitdate_prf_4#6392, val_lineitem_l_receiptdate_prf#6360 AS val_lineitem_l_receiptdate_prf_4#6393, val_lineitem_l_shipinstruct_prf#6361 AS val_lineitem_l_shipinstruct_prf_4#6394, val_lineitem_l_shipmode_prf#6362 AS val_lineitem_l_shipmode_prf_4#6395, val_lineitem_l_comment_prf#6363 AS val_lineitem_l_comment_prf_4#6396, val_lineitem_l_shipdate_prf#6364 AS val_lineitem_l_shipdate_prf_4#6397, l_quantity_prf#6365 AS l_quantity_prf_4#6398, l_extendedprice_prf#6366 AS l_extendedprice_prf_4#6399, l_discount_prf#6367 AS l_discount_prf_4#6400, ... 9 more fields]
         :        +- Relation[rid#6344L,fpk_lineitem_orders_prf#6345,fpk_lineitem_part_prf#6346,fpk_lineitem_partsupp_prf#6347,fpk_lineitem_supplier_prf#6348,pfk_supplier_lineitem_prf#6349,pfk_part_lineitem_prf#6350,pfk_orders_lineitem_prf#6351,pfk_partsupp_lineitem_prf#6352,val_lineitem_l_quantity_prf#6353,val_lineitem_l_extendedprice_prf#6354,val_lineitem_l_discount_prf#6355,val_lineitem_l_tax_prf#6356,val_lineitem_l_returnflag_prf#6357,val_lineitem_l_linestatus_prf#6358,val_lineitem_l_commitdate_prf#6359,val_lineitem_l_receiptdate_prf#6360,val_lineitem_l_shipinstruct_prf#6361,val_lineitem_l_shipmode_prf#6362,val_lineitem_l_comment_prf#6363,val_lineitem_l_shipdate_prf#6364,l_quantity_prf#6365,l_extendedprice_prf#6366,l_discount_prf#6367,... 9 more fields] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [rid#5868L AS rid_1#5885L, val_part_p_name_prf#5869 AS val_part_p_name_prf_1#5886, val_part_p_mfgr_prf#5870 AS val_part_p_mfgr_prf_1#5887, val_part_p_type_prf#5871 AS val_part_p_type_prf_1#5888, val_part_p_size_prf#5872 AS val_part_p_size_prf_1#5889, val_part_p_container_prf#5873 AS val_part_p_container_prf_1#5890, val_part_p_retailprice_prf#5874 AS val_part_p_retailprice_prf_1#5891, val_part_p_comment_prf#5875 AS val_part_p_comment_prf_1#5892, val_part_p_brand_prf#5876 AS val_part_p_brand_prf_1#5893, p_name_prf#5877 AS p_name_prf_1#5894, p_mfgr_prf#5878 AS p_mfgr_prf_1#5895, p_type_prf#5879 AS p_type_prf_1#5896, p_size_prf#5880 AS p_size_prf_1#5897, p_container_prf#5881 AS p_container_prf_1#5898, p_retailprice_prf#5882 AS p_retailprice_prf_1#5899, p_comment_prf#5883 AS p_comment_prf_1#5900, p_brand_prf#5884 AS p_brand_prf_1#5901]
            :  :  +- Relation[rid#5868L,val_part_p_name_prf#5869,val_part_p_mfgr_prf#5870,val_part_p_type_prf#5871,val_part_p_size_prf#5872,val_part_p_container_prf#5873,val_part_p_retailprice_prf#5874,val_part_p_comment_prf#5875,val_part_p_brand_prf#5876,p_name_prf#5877,p_mfgr_prf#5878,p_type_prf#5879,p_size_prf#5880,p_container_prf#5881,p_retailprice_prf#5882,p_comment_prf#5883,p_brand_prf#5884] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, pfk_part_lineitem_prf, 'pfk_part_lineitem_prf_4, part_prf, 'rid_1, lineitem_prf, 'rid_4
            :     :- Project [rid#6210L AS rid_1#6227L, val_part_p_name_prf#6211 AS val_part_p_name_prf_1#6228, val_part_p_mfgr_prf#6212 AS val_part_p_mfgr_prf_1#6229, val_part_p_type_prf#6213 AS val_part_p_type_prf_1#6230, val_part_p_size_prf#6214 AS val_part_p_size_prf_1#6231, val_part_p_container_prf#6215 AS val_part_p_container_prf_1#6232, val_part_p_retailprice_prf#6216 AS val_part_p_retailprice_prf_1#6233, val_part_p_comment_prf#6217 AS val_part_p_comment_prf_1#6234, val_part_p_brand_prf#6218 AS val_part_p_brand_prf_1#6235, p_name_prf#6219 AS p_name_prf_1#6236, p_mfgr_prf#6220 AS p_mfgr_prf_1#6237, p_type_prf#6221 AS p_type_prf_1#6238, p_size_prf#6222 AS p_size_prf_1#6239, p_container_prf#6223 AS p_container_prf_1#6240, p_retailprice_prf#6224 AS p_retailprice_prf_1#6241, p_comment_prf#6225 AS p_comment_prf_1#6242, p_brand_prf#6226 AS p_brand_prf_1#6243]
            :     :  +- Relation[rid#6210L,val_part_p_name_prf#6211,val_part_p_mfgr_prf#6212,val_part_p_type_prf#6213,val_part_p_size_prf#6214,val_part_p_container_prf#6215,val_part_p_retailprice_prf#6216,val_part_p_comment_prf#6217,val_part_p_brand_prf#6218,p_name_prf#6219,p_mfgr_prf#6220,p_type_prf#6221,p_size_prf#6222,p_container_prf#6223,p_retailprice_prf#6224,p_comment_prf#6225,p_brand_prf#6226] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Project [rid#6244L AS rid_4#6277L, fpk_lineitem_orders_prf#6245 AS fpk_lineitem_orders_prf_4#6278, fpk_lineitem_part_prf#6246 AS fpk_lineitem_part_prf_4#6279, fpk_lineitem_partsupp_prf#6247 AS fpk_lineitem_partsupp_prf_4#6280, fpk_lineitem_supplier_prf#6248 AS fpk_lineitem_supplier_prf_4#6281, pfk_supplier_lineitem_prf#6249 AS pfk_supplier_lineitem_prf_4#6282, pfk_part_lineitem_prf#6250 AS pfk_part_lineitem_prf_4#6283, pfk_orders_lineitem_prf#6251 AS pfk_orders_lineitem_prf_4#6284, pfk_partsupp_lineitem_prf#6252 AS pfk_partsupp_lineitem_prf_4#6285, val_lineitem_l_quantity_prf#6253 AS val_lineitem_l_quantity_prf_4#6286, val_lineitem_l_extendedprice_prf#6254 AS val_lineitem_l_extendedprice_prf_4#6287, val_lineitem_l_discount_prf#6255 AS val_lineitem_l_discount_prf_4#6288, val_lineitem_l_tax_prf#6256 AS val_lineitem_l_tax_prf_4#6289, val_lineitem_l_returnflag_prf#6257 AS val_lineitem_l_returnflag_prf_4#6290, val_lineitem_l_linestatus_prf#6258 AS val_lineitem_l_linestatus_prf_4#6291, val_lineitem_l_commitdate_prf#6259 AS val_lineitem_l_commitdate_prf_4#6292, val_lineitem_l_receiptdate_prf#6260 AS val_lineitem_l_receiptdate_prf_4#6293, val_lineitem_l_shipinstruct_prf#6261 AS val_lineitem_l_shipinstruct_prf_4#6294, val_lineitem_l_shipmode_prf#6262 AS val_lineitem_l_shipmode_prf_4#6295, val_lineitem_l_comment_prf#6263 AS val_lineitem_l_comment_prf_4#6296, val_lineitem_l_shipdate_prf#6264 AS val_lineitem_l_shipdate_prf_4#6297, l_quantity_prf#6265 AS l_quantity_prf_4#6298, l_extendedprice_prf#6266 AS l_extendedprice_prf_4#6299, l_discount_prf#6267 AS l_discount_prf_4#6300, ... 9 more fields]
            :        +- Relation[rid#6244L,fpk_lineitem_orders_prf#6245,fpk_lineitem_part_prf#6246,fpk_lineitem_partsupp_prf#6247,fpk_lineitem_supplier_prf#6248,pfk_supplier_lineitem_prf#6249,pfk_part_lineitem_prf#6250,pfk_orders_lineitem_prf#6251,pfk_partsupp_lineitem_prf#6252,val_lineitem_l_quantity_prf#6253,val_lineitem_l_extendedprice_prf#6254,val_lineitem_l_discount_prf#6255,val_lineitem_l_tax_prf#6256,val_lineitem_l_returnflag_prf#6257,val_lineitem_l_linestatus_prf#6258,val_lineitem_l_commitdate_prf#6259,val_lineitem_l_receiptdate_prf#6260,val_lineitem_l_shipinstruct_prf#6261,val_lineitem_l_shipmode_prf#6262,val_lineitem_l_comment_prf#6263,val_lineitem_l_shipdate_prf#6264,l_quantity_prf#6265,l_extendedprice_prf#6266,l_discount_prf#6267,... 9 more fields] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_4))
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- Project [rid#5902L AS rid_2#5913L, pfk_part_partsupp_prf#5903 AS pfk_part_partsupp_prf_2#5914, fpk_partsupp_part_prf#5904 AS fpk_partsupp_part_prf_2#5915, pfk_supplier_partsupp_prf#5905 AS pfk_supplier_partsupp_prf_2#5916, fpk_partsupp_supplier_prf#5906 AS fpk_partsupp_supplier_prf_2#5917, val_partsupp_ps_availqty_prf#5907 AS val_partsupp_ps_availqty_prf_2#5918, val_partsupp_ps_supplycost_prf#5908 AS val_partsupp_ps_supplycost_prf_2#5919, val_partsupp_ps_comment_prf#5909 AS val_partsupp_ps_comment_prf_2#5920, ps_availqty_prf#5910 AS ps_availqty_prf_2#5921, ps_supplycost_prf#5911 AS ps_supplycost_prf_2#5922, ps_comment_prf#5912 AS ps_comment_prf_2#5923]
               :  :  +- Relation[rid#5902L,pfk_part_partsupp_prf#5903,fpk_partsupp_part_prf#5904,pfk_supplier_partsupp_prf#5905,fpk_partsupp_supplier_prf#5906,val_partsupp_ps_availqty_prf#5907,val_partsupp_ps_supplycost_prf#5908,val_partsupp_ps_comment_prf#5909,ps_availqty_prf#5910,ps_supplycost_prf#5911,ps_comment_prf#5912] JDBCRelation(partsupp_prf) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, pfk_partsupp_lineitem_prf, 'pfk_partsupp_lineitem_prf_4, partsupp_prf, 'rid_2, lineitem_prf, 'rid_4
               :     :- Project [rid#6122L AS rid_2#6133L, pfk_part_partsupp_prf#6123 AS pfk_part_partsupp_prf_2#6134, fpk_partsupp_part_prf#6124 AS fpk_partsupp_part_prf_2#6135, pfk_supplier_partsupp_prf#6125 AS pfk_supplier_partsupp_prf_2#6136, fpk_partsupp_supplier_prf#6126 AS fpk_partsupp_supplier_prf_2#6137, val_partsupp_ps_availqty_prf#6127 AS val_partsupp_ps_availqty_prf_2#6138, val_partsupp_ps_supplycost_prf#6128 AS val_partsupp_ps_supplycost_prf_2#6139, val_partsupp_ps_comment_prf#6129 AS val_partsupp_ps_comment_prf_2#6140, ps_availqty_prf#6130 AS ps_availqty_prf_2#6141, ps_supplycost_prf#6131 AS ps_supplycost_prf_2#6142, ps_comment_prf#6132 AS ps_comment_prf_2#6143]
               :     :  +- Relation[rid#6122L,pfk_part_partsupp_prf#6123,fpk_partsupp_part_prf#6124,pfk_supplier_partsupp_prf#6125,fpk_partsupp_supplier_prf#6126,val_partsupp_ps_availqty_prf#6127,val_partsupp_ps_supplycost_prf#6128,val_partsupp_ps_comment_prf#6129,ps_availqty_prf#6130,ps_supplycost_prf#6131,ps_comment_prf#6132] JDBCRelation(partsupp_prf) [numPartitions=1]
               :     +- Project [rid#6144L AS rid_4#6177L, fpk_lineitem_orders_prf#6145 AS fpk_lineitem_orders_prf_4#6178, fpk_lineitem_part_prf#6146 AS fpk_lineitem_part_prf_4#6179, fpk_lineitem_partsupp_prf#6147 AS fpk_lineitem_partsupp_prf_4#6180, fpk_lineitem_supplier_prf#6148 AS fpk_lineitem_supplier_prf_4#6181, pfk_supplier_lineitem_prf#6149 AS pfk_supplier_lineitem_prf_4#6182, pfk_part_lineitem_prf#6150 AS pfk_part_lineitem_prf_4#6183, pfk_orders_lineitem_prf#6151 AS pfk_orders_lineitem_prf_4#6184, pfk_partsupp_lineitem_prf#6152 AS pfk_partsupp_lineitem_prf_4#6185, val_lineitem_l_quantity_prf#6153 AS val_lineitem_l_quantity_prf_4#6186, val_lineitem_l_extendedprice_prf#6154 AS val_lineitem_l_extendedprice_prf_4#6187, val_lineitem_l_discount_prf#6155 AS val_lineitem_l_discount_prf_4#6188, val_lineitem_l_tax_prf#6156 AS val_lineitem_l_tax_prf_4#6189, val_lineitem_l_returnflag_prf#6157 AS val_lineitem_l_returnflag_prf_4#6190, val_lineitem_l_linestatus_prf#6158 AS val_lineitem_l_linestatus_prf_4#6191, val_lineitem_l_commitdate_prf#6159 AS val_lineitem_l_commitdate_prf_4#6192, val_lineitem_l_receiptdate_prf#6160 AS val_lineitem_l_receiptdate_prf_4#6193, val_lineitem_l_shipinstruct_prf#6161 AS val_lineitem_l_shipinstruct_prf_4#6194, val_lineitem_l_shipmode_prf#6162 AS val_lineitem_l_shipmode_prf_4#6195, val_lineitem_l_comment_prf#6163 AS val_lineitem_l_comment_prf_4#6196, val_lineitem_l_shipdate_prf#6164 AS val_lineitem_l_shipdate_prf_4#6197, l_quantity_prf#6165 AS l_quantity_prf_4#6198, l_extendedprice_prf#6166 AS l_extendedprice_prf_4#6199, l_discount_prf#6167 AS l_discount_prf_4#6200, ... 9 more fields]
               :        +- Relation[rid#6144L,fpk_lineitem_orders_prf#6145,fpk_lineitem_part_prf#6146,fpk_lineitem_partsupp_prf#6147,fpk_lineitem_supplier_prf#6148,pfk_supplier_lineitem_prf#6149,pfk_part_lineitem_prf#6150,pfk_orders_lineitem_prf#6151,pfk_partsupp_lineitem_prf#6152,val_lineitem_l_quantity_prf#6153,val_lineitem_l_extendedprice_prf#6154,val_lineitem_l_discount_prf#6155,val_lineitem_l_tax_prf#6156,val_lineitem_l_returnflag_prf#6157,val_lineitem_l_linestatus_prf#6158,val_lineitem_l_commitdate_prf#6159,val_lineitem_l_receiptdate_prf#6160,val_lineitem_l_shipinstruct_prf#6161,val_lineitem_l_shipmode_prf#6162,val_lineitem_l_comment_prf#6163,val_lineitem_l_shipdate_prf#6164,l_quantity_prf#6165,l_extendedprice_prf#6166,l_discount_prf#6167,... 9 more fields] JDBCRelation(lineitem_prf) [numPartitions=1]
               +- 'Project [*]
                  +- 'Join Inner, (cast(dexdecrypt(concat(supplier~nation, ~, 'rid_3), 'fpk_supplier_nation_prf_3) as bigint) = 'rid_5)
                     :- 'Join UsingJoin(Inner,List(rid_4))
                     :  :- 'Join UsingJoin(Inner,List(rid_3))
                     :  :  :- Project [rid#5924L AS rid_3#5937L, pfk_nation_supplier_prf#5925 AS pfk_nation_supplier_prf_3#5938, fpk_supplier_nation_prf#5926 AS fpk_supplier_nation_prf_3#5939, val_supplier_s_name_prf#5927 AS val_supplier_s_name_prf_3#5940, val_supplier_s_address_prf#5928 AS val_supplier_s_address_prf_3#5941, val_supplier_s_phone_prf#5929 AS val_supplier_s_phone_prf_3#5942, val_supplier_s_acctbal_prf#5930 AS val_supplier_s_acctbal_prf_3#5943, val_supplier_s_comment_prf#5931 AS val_supplier_s_comment_prf_3#5944, s_name_prf#5932 AS s_name_prf_3#5945, s_address_prf#5933 AS s_address_prf_3#5946, s_phone_prf#5934 AS s_phone_prf_3#5947, s_acctbal_prf#5935 AS s_acctbal_prf_3#5948, s_comment_prf#5936 AS s_comment_prf_3#5949]
                     :  :  :  +- Relation[rid#5924L,pfk_nation_supplier_prf#5925,fpk_supplier_nation_prf#5926,val_supplier_s_name_prf#5927,val_supplier_s_address_prf#5928,val_supplier_s_phone_prf#5929,val_supplier_s_acctbal_prf#5930,val_supplier_s_comment_prf#5931,s_name_prf#5932,s_address_prf#5933,s_phone_prf#5934,s_acctbal_prf#5935,s_comment_prf#5936] JDBCRelation(supplier_prf) [numPartitions=1]
                     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, pfk_supplier_lineitem_prf, 'pfk_supplier_lineitem_prf_4, supplier_prf, 'rid_3, lineitem_prf, 'rid_4
                     :  :     :- Project [rid#6016L AS rid_3#6029L, pfk_nation_supplier_prf#6017 AS pfk_nation_supplier_prf_3#6030, fpk_supplier_nation_prf#6018 AS fpk_supplier_nation_prf_3#6031, val_supplier_s_name_prf#6019 AS val_supplier_s_name_prf_3#6032, val_supplier_s_address_prf#6020 AS val_supplier_s_address_prf_3#6033, val_supplier_s_phone_prf#6021 AS val_supplier_s_phone_prf_3#6034, val_supplier_s_acctbal_prf#6022 AS val_supplier_s_acctbal_prf_3#6035, val_supplier_s_comment_prf#6023 AS val_supplier_s_comment_prf_3#6036, s_name_prf#6024 AS s_name_prf_3#6037, s_address_prf#6025 AS s_address_prf_3#6038, s_phone_prf#6026 AS s_phone_prf_3#6039, s_acctbal_prf#6027 AS s_acctbal_prf_3#6040, s_comment_prf#6028 AS s_comment_prf_3#6041]
                     :  :     :  +- Relation[rid#6016L,pfk_nation_supplier_prf#6017,fpk_supplier_nation_prf#6018,val_supplier_s_name_prf#6019,val_supplier_s_address_prf#6020,val_supplier_s_phone_prf#6021,val_supplier_s_acctbal_prf#6022,val_supplier_s_comment_prf#6023,s_name_prf#6024,s_address_prf#6025,s_phone_prf#6026,s_acctbal_prf#6027,s_comment_prf#6028] JDBCRelation(supplier_prf) [numPartitions=1]
                     :  :     +- Project [rid#6042L AS rid_4#6075L, fpk_lineitem_orders_prf#6043 AS fpk_lineitem_orders_prf_4#6076, fpk_lineitem_part_prf#6044 AS fpk_lineitem_part_prf_4#6077, fpk_lineitem_partsupp_prf#6045 AS fpk_lineitem_partsupp_prf_4#6078, fpk_lineitem_supplier_prf#6046 AS fpk_lineitem_supplier_prf_4#6079, pfk_supplier_lineitem_prf#6047 AS pfk_supplier_lineitem_prf_4#6080, pfk_part_lineitem_prf#6048 AS pfk_part_lineitem_prf_4#6081, pfk_orders_lineitem_prf#6049 AS pfk_orders_lineitem_prf_4#6082, pfk_partsupp_lineitem_prf#6050 AS pfk_partsupp_lineitem_prf_4#6083, val_lineitem_l_quantity_prf#6051 AS val_lineitem_l_quantity_prf_4#6084, val_lineitem_l_extendedprice_prf#6052 AS val_lineitem_l_extendedprice_prf_4#6085, val_lineitem_l_discount_prf#6053 AS val_lineitem_l_discount_prf_4#6086, val_lineitem_l_tax_prf#6054 AS val_lineitem_l_tax_prf_4#6087, val_lineitem_l_returnflag_prf#6055 AS val_lineitem_l_returnflag_prf_4#6088, val_lineitem_l_linestatus_prf#6056 AS val_lineitem_l_linestatus_prf_4#6089, val_lineitem_l_commitdate_prf#6057 AS val_lineitem_l_commitdate_prf_4#6090, val_lineitem_l_receiptdate_prf#6058 AS val_lineitem_l_receiptdate_prf_4#6091, val_lineitem_l_shipinstruct_prf#6059 AS val_lineitem_l_shipinstruct_prf_4#6092, val_lineitem_l_shipmode_prf#6060 AS val_lineitem_l_shipmode_prf_4#6093, val_lineitem_l_comment_prf#6061 AS val_lineitem_l_comment_prf_4#6094, val_lineitem_l_shipdate_prf#6062 AS val_lineitem_l_shipdate_prf_4#6095, l_quantity_prf#6063 AS l_quantity_prf_4#6096, l_extendedprice_prf#6064 AS l_extendedprice_prf_4#6097, l_discount_prf#6065 AS l_discount_prf_4#6098, ... 9 more fields]
                     :  :        +- Relation[rid#6042L,fpk_lineitem_orders_prf#6043,fpk_lineitem_part_prf#6044,fpk_lineitem_partsupp_prf#6045,fpk_lineitem_supplier_prf#6046,pfk_supplier_lineitem_prf#6047,pfk_part_lineitem_prf#6048,pfk_orders_lineitem_prf#6049,pfk_partsupp_lineitem_prf#6050,val_lineitem_l_quantity_prf#6051,val_lineitem_l_extendedprice_prf#6052,val_lineitem_l_discount_prf#6053,val_lineitem_l_tax_prf#6054,val_lineitem_l_returnflag_prf#6055,val_lineitem_l_linestatus_prf#6056,val_lineitem_l_commitdate_prf#6057,val_lineitem_l_receiptdate_prf#6058,val_lineitem_l_shipinstruct_prf#6059,val_lineitem_l_shipmode_prf#6060,val_lineitem_l_comment_prf#6061,val_lineitem_l_shipdate_prf#6062,l_quantity_prf#6063,l_extendedprice_prf#6064,l_discount_prf#6065,... 9 more fields] JDBCRelation(lineitem_prf) [numPartitions=1]
                     :  +- Project [rid#5950L AS rid_4#5983L, fpk_lineitem_orders_prf#5951 AS fpk_lineitem_orders_prf_4#5984, fpk_lineitem_part_prf#5952 AS fpk_lineitem_part_prf_4#5985, fpk_lineitem_partsupp_prf#5953 AS fpk_lineitem_partsupp_prf_4#5986, fpk_lineitem_supplier_prf#5954 AS fpk_lineitem_supplier_prf_4#5987, pfk_supplier_lineitem_prf#5955 AS pfk_supplier_lineitem_prf_4#5988, pfk_part_lineitem_prf#5956 AS pfk_part_lineitem_prf_4#5989, pfk_orders_lineitem_prf#5957 AS pfk_orders_lineitem_prf_4#5990, pfk_partsupp_lineitem_prf#5958 AS pfk_partsupp_lineitem_prf_4#5991, val_lineitem_l_quantity_prf#5959 AS val_lineitem_l_quantity_prf_4#5992, val_lineitem_l_extendedprice_prf#5960 AS val_lineitem_l_extendedprice_prf_4#5993, val_lineitem_l_discount_prf#5961 AS val_lineitem_l_discount_prf_4#5994, val_lineitem_l_tax_prf#5962 AS val_lineitem_l_tax_prf_4#5995, val_lineitem_l_returnflag_prf#5963 AS val_lineitem_l_returnflag_prf_4#5996, val_lineitem_l_linestatus_prf#5964 AS val_lineitem_l_linestatus_prf_4#5997, val_lineitem_l_commitdate_prf#5965 AS val_lineitem_l_commitdate_prf_4#5998, val_lineitem_l_receiptdate_prf#5966 AS val_lineitem_l_receiptdate_prf_4#5999, val_lineitem_l_shipinstruct_prf#5967 AS val_lineitem_l_shipinstruct_prf_4#6000, val_lineitem_l_shipmode_prf#5968 AS val_lineitem_l_shipmode_prf_4#6001, val_lineitem_l_comment_prf#5969 AS val_lineitem_l_comment_prf_4#6002, val_lineitem_l_shipdate_prf#5970 AS val_lineitem_l_shipdate_prf_4#6003, l_quantity_prf#5971 AS l_quantity_prf_4#6004, l_extendedprice_prf#5972 AS l_extendedprice_prf_4#6005, l_discount_prf#5973 AS l_discount_prf_4#6006, ... 9 more fields]
                     :     +- Relation[rid#5950L,fpk_lineitem_orders_prf#5951,fpk_lineitem_part_prf#5952,fpk_lineitem_partsupp_prf#5953,fpk_lineitem_supplier_prf#5954,pfk_supplier_lineitem_prf#5955,pfk_part_lineitem_prf#5956,pfk_orders_lineitem_prf#5957,pfk_partsupp_lineitem_prf#5958,val_lineitem_l_quantity_prf#5959,val_lineitem_l_extendedprice_prf#5960,val_lineitem_l_discount_prf#5961,val_lineitem_l_tax_prf#5962,val_lineitem_l_returnflag_prf#5963,val_lineitem_l_linestatus_prf#5964,val_lineitem_l_commitdate_prf#5965,val_lineitem_l_receiptdate_prf#5966,val_lineitem_l_shipinstruct_prf#5967,val_lineitem_l_shipmode_prf#5968,val_lineitem_l_comment_prf#5969,val_lineitem_l_shipdate_prf#5970,l_quantity_prf#5971,l_extendedprice_prf#5972,l_discount_prf#5973,... 9 more fields] JDBCRelation(lineitem_prf) [numPartitions=1]
                     +- Project [rid#6108L AS rid_5#6115L, pfk_region_nation_prf#6109 AS pfk_region_nation_prf_5#6116, fpk_nation_region_prf#6110 AS fpk_nation_region_prf_5#6117, val_nation_n_name_prf#6111 AS val_nation_n_name_prf_5#6118, val_nation_n_comment_prf#6112 AS val_nation_n_comment_prf_5#6119, n_name_prf#6113 AS n_name_prf_5#6120, n_comment_prf#6114 AS n_comment_prf_5#6121]
                        +- Relation[rid#6108L,pfk_region_nation_prf#6109,fpk_nation_region_prf#6110,val_nation_n_name_prf#6111,val_nation_n_comment_prf#6112,n_name_prf#6113,n_comment_prf#6114] JDBCRelation(nation_prf) [numPartitions=1]

dex-class org.apache.spark.sql.dex.DexPkFk$ result size=6001215
Elapsed time: 129502ms

q9b=

select
  n_name,
  o_orderdate,
  l_extendedprice,
  l_discount,
  ps_supplycost,
  l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey and s_nationkey = n_nationkey
      
postgres result size=6001215
Elapsed time: 39068ms
19/10/08 23:13:27 WARN DexPlanner: dexPlan=DexPkFkPlan
19/10/08 23:13:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6723L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L, s_nationkey#21L]
         :     :     :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :     :     :  +- Filter ((isnotnull(l_suppkey#308L) && isnotnull(l_partkey#307L)) && isnotnull(l_orderkey#306L))
         :     :     :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Filter (isnotnull(s_suppkey#18L) && isnotnull(s_nationkey#21L))
         :     :     :     :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [n_nationkey#108L]
         :     :     :        +- Filter isnotnull(n_nationkey#108L)
         :     :     :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Filter isnotnull(p_partkey#360L)
         :     :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/08 23:13:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6723L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (cast(dexdecrypt(concat(lineitem~orders, ~, 'rid_0), 'fpk_lineitem_orders_prf_0) as bigint) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (cast(dexdecrypt(concat(lineitem~partsupp, ~, 'rid_0), 'fpk_lineitem_partsupp_prf_0) as bigint) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (cast(dexdecrypt(concat(lineitem~part, ~, 'rid_0), 'fpk_lineitem_part_prf_0) as bigint) = 'rid_3)
            :     :     :- 'Project [*]
            :     :     :  +- 'Join Inner, (cast(dexdecrypt(concat(supplier~nation, ~, 'rid_1), 'fpk_supplier_nation_prf_1) as bigint) = 'rid_2)
            :     :     :     :- 'Project [*]
            :     :     :     :  +- 'Join Inner, (cast(dexdecrypt(concat(lineitem~supplier, ~, 'rid_0), 'fpk_lineitem_supplier_prf_0) as bigint) = 'rid_1)
            :     :     :     :     :- Project [rid#6725L AS rid_0#6758L, fpk_lineitem_orders_prf#6726 AS fpk_lineitem_orders_prf_0#6759, fpk_lineitem_part_prf#6727 AS fpk_lineitem_part_prf_0#6760, fpk_lineitem_partsupp_prf#6728 AS fpk_lineitem_partsupp_prf_0#6761, fpk_lineitem_supplier_prf#6729 AS fpk_lineitem_supplier_prf_0#6762, pfk_supplier_lineitem_prf#6730 AS pfk_supplier_lineitem_prf_0#6763, pfk_part_lineitem_prf#6731 AS pfk_part_lineitem_prf_0#6764, pfk_orders_lineitem_prf#6732 AS pfk_orders_lineitem_prf_0#6765, pfk_partsupp_lineitem_prf#6733 AS pfk_partsupp_lineitem_prf_0#6766, val_lineitem_l_quantity_prf#6734 AS val_lineitem_l_quantity_prf_0#6767, val_lineitem_l_extendedprice_prf#6735 AS val_lineitem_l_extendedprice_prf_0#6768, val_lineitem_l_discount_prf#6736 AS val_lineitem_l_discount_prf_0#6769, val_lineitem_l_tax_prf#6737 AS val_lineitem_l_tax_prf_0#6770, val_lineitem_l_returnflag_prf#6738 AS val_lineitem_l_returnflag_prf_0#6771, val_lineitem_l_linestatus_prf#6739 AS val_lineitem_l_linestatus_prf_0#6772, val_lineitem_l_commitdate_prf#6740 AS val_lineitem_l_commitdate_prf_0#6773, val_lineitem_l_receiptdate_prf#6741 AS val_lineitem_l_receiptdate_prf_0#6774, val_lineitem_l_shipinstruct_prf#6742 AS val_lineitem_l_shipinstruct_prf_0#6775, val_lineitem_l_shipmode_prf#6743 AS val_lineitem_l_shipmode_prf_0#6776, val_lineitem_l_comment_prf#6744 AS val_lineitem_l_comment_prf_0#6777, val_lineitem_l_shipdate_prf#6745 AS val_lineitem_l_shipdate_prf_0#6778, l_quantity_prf#6746 AS l_quantity_prf_0#6779, l_extendedprice_prf#6747 AS l_extendedprice_prf_0#6780, l_discount_prf#6748 AS l_discount_prf_0#6781, ... 9 more fields]
            :     :     :     :     :  +- Relation[rid#6725L,fpk_lineitem_orders_prf#6726,fpk_lineitem_part_prf#6727,fpk_lineitem_partsupp_prf#6728,fpk_lineitem_supplier_prf#6729,pfk_supplier_lineitem_prf#6730,pfk_part_lineitem_prf#6731,pfk_orders_lineitem_prf#6732,pfk_partsupp_lineitem_prf#6733,val_lineitem_l_quantity_prf#6734,val_lineitem_l_extendedprice_prf#6735,val_lineitem_l_discount_prf#6736,val_lineitem_l_tax_prf#6737,val_lineitem_l_returnflag_prf#6738,val_lineitem_l_linestatus_prf#6739,val_lineitem_l_commitdate_prf#6740,val_lineitem_l_receiptdate_prf#6741,val_lineitem_l_shipinstruct_prf#6742,val_lineitem_l_shipmode_prf#6743,val_lineitem_l_comment_prf#6744,val_lineitem_l_shipdate_prf#6745,l_quantity_prf#6746,l_extendedprice_prf#6747,l_discount_prf#6748,... 9 more fields] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     :     :     :     +- Project [rid#6791L AS rid_1#6804L, pfk_nation_supplier_prf#6792 AS pfk_nation_supplier_prf_1#6805, fpk_supplier_nation_prf#6793 AS fpk_supplier_nation_prf_1#6806, val_supplier_s_name_prf#6794 AS val_supplier_s_name_prf_1#6807, val_supplier_s_address_prf#6795 AS val_supplier_s_address_prf_1#6808, val_supplier_s_phone_prf#6796 AS val_supplier_s_phone_prf_1#6809, val_supplier_s_acctbal_prf#6797 AS val_supplier_s_acctbal_prf_1#6810, val_supplier_s_comment_prf#6798 AS val_supplier_s_comment_prf_1#6811, s_name_prf#6799 AS s_name_prf_1#6812, s_address_prf#6800 AS s_address_prf_1#6813, s_phone_prf#6801 AS s_phone_prf_1#6814, s_acctbal_prf#6802 AS s_acctbal_prf_1#6815, s_comment_prf#6803 AS s_comment_prf_1#6816]
            :     :     :     :        +- Relation[rid#6791L,pfk_nation_supplier_prf#6792,fpk_supplier_nation_prf#6793,val_supplier_s_name_prf#6794,val_supplier_s_address_prf#6795,val_supplier_s_phone_prf#6796,val_supplier_s_acctbal_prf#6797,val_supplier_s_comment_prf#6798,s_name_prf#6799,s_address_prf#6800,s_phone_prf#6801,s_acctbal_prf#6802,s_comment_prf#6803] JDBCRelation(supplier_prf) [numPartitions=1]
            :     :     :     +- Project [rid#6817L AS rid_2#6824L, pfk_region_nation_prf#6818 AS pfk_region_nation_prf_2#6825, fpk_nation_region_prf#6819 AS fpk_nation_region_prf_2#6826, val_nation_n_name_prf#6820 AS val_nation_n_name_prf_2#6827, val_nation_n_comment_prf#6821 AS val_nation_n_comment_prf_2#6828, n_name_prf#6822 AS n_name_prf_2#6829, n_comment_prf#6823 AS n_comment_prf_2#6830]
            :     :     :        +- Relation[rid#6817L,pfk_region_nation_prf#6818,fpk_nation_region_prf#6819,val_nation_n_name_prf#6820,val_nation_n_comment_prf#6821,n_name_prf#6822,n_comment_prf#6823] JDBCRelation(nation_prf) [numPartitions=1]
            :     :     +- Project [rid#6831L AS rid_3#6848L, val_part_p_name_prf#6832 AS val_part_p_name_prf_3#6849, val_part_p_mfgr_prf#6833 AS val_part_p_mfgr_prf_3#6850, val_part_p_type_prf#6834 AS val_part_p_type_prf_3#6851, val_part_p_size_prf#6835 AS val_part_p_size_prf_3#6852, val_part_p_container_prf#6836 AS val_part_p_container_prf_3#6853, val_part_p_retailprice_prf#6837 AS val_part_p_retailprice_prf_3#6854, val_part_p_comment_prf#6838 AS val_part_p_comment_prf_3#6855, val_part_p_brand_prf#6839 AS val_part_p_brand_prf_3#6856, p_name_prf#6840 AS p_name_prf_3#6857, p_mfgr_prf#6841 AS p_mfgr_prf_3#6858, p_type_prf#6842 AS p_type_prf_3#6859, p_size_prf#6843 AS p_size_prf_3#6860, p_container_prf#6844 AS p_container_prf_3#6861, p_retailprice_prf#6845 AS p_retailprice_prf_3#6862, p_comment_prf#6846 AS p_comment_prf_3#6863, p_brand_prf#6847 AS p_brand_prf_3#6864]
            :     :        +- Relation[rid#6831L,val_part_p_name_prf#6832,val_part_p_mfgr_prf#6833,val_part_p_type_prf#6834,val_part_p_size_prf#6835,val_part_p_container_prf#6836,val_part_p_retailprice_prf#6837,val_part_p_comment_prf#6838,val_part_p_brand_prf#6839,p_name_prf#6840,p_mfgr_prf#6841,p_type_prf#6842,p_size_prf#6843,p_container_prf#6844,p_retailprice_prf#6845,p_comment_prf#6846,p_brand_prf#6847] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Project [rid#6865L AS rid_4#6876L, pfk_part_partsupp_prf#6866 AS pfk_part_partsupp_prf_4#6877, fpk_partsupp_part_prf#6867 AS fpk_partsupp_part_prf_4#6878, pfk_supplier_partsupp_prf#6868 AS pfk_supplier_partsupp_prf_4#6879, fpk_partsupp_supplier_prf#6869 AS fpk_partsupp_supplier_prf_4#6880, val_partsupp_ps_availqty_prf#6870 AS val_partsupp_ps_availqty_prf_4#6881, val_partsupp_ps_supplycost_prf#6871 AS val_partsupp_ps_supplycost_prf_4#6882, val_partsupp_ps_comment_prf#6872 AS val_partsupp_ps_comment_prf_4#6883, ps_availqty_prf#6873 AS ps_availqty_prf_4#6884, ps_supplycost_prf#6874 AS ps_supplycost_prf_4#6885, ps_comment_prf#6875 AS ps_comment_prf_4#6886]
            :        +- Relation[rid#6865L,pfk_part_partsupp_prf#6866,fpk_partsupp_part_prf#6867,pfk_supplier_partsupp_prf#6868,fpk_partsupp_supplier_prf#6869,val_partsupp_ps_availqty_prf#6870,val_partsupp_ps_supplycost_prf#6871,val_partsupp_ps_comment_prf#6872,ps_availqty_prf#6873,ps_supplycost_prf#6874,ps_comment_prf#6875] JDBCRelation(partsupp_prf) [numPartitions=1]
            +- Project [rid#6887L AS rid_5#6904L, pfk_customer_orders_prf#6888 AS pfk_customer_orders_prf_5#6905, fpk_orders_customer_prf#6889 AS fpk_orders_customer_prf_5#6906, val_orders_o_orderstatus_prf#6890 AS val_orders_o_orderstatus_prf_5#6907, val_orders_o_totalprice_prf#6891 AS val_orders_o_totalprice_prf_5#6908, val_orders_o_orderpriority_prf#6892 AS val_orders_o_orderpriority_prf_5#6909, val_orders_o_clerk_prf#6893 AS val_orders_o_clerk_prf_5#6910, val_orders_o_shippriority_prf#6894 AS val_orders_o_shippriority_prf_5#6911, val_orders_o_comment_prf#6895 AS val_orders_o_comment_prf_5#6912, val_orders_o_orderdate_prf#6896 AS val_orders_o_orderdate_prf_5#6913, o_orderstatus_prf#6897 AS o_orderstatus_prf_5#6914, o_totalprice_prf#6898 AS o_totalprice_prf_5#6915, o_orderpriority_prf#6899 AS o_orderpriority_prf_5#6916, o_clerk_prf#6900 AS o_clerk_prf_5#6917, o_shippriority_prf#6901 AS o_shippriority_prf_5#6918, o_comment_prf#6902 AS o_comment_prf_5#6919, o_orderdate_prf#6903 AS o_orderdate_prf_5#6920]
               +- Relation[rid#6887L,pfk_customer_orders_prf#6888,fpk_orders_customer_prf#6889,val_orders_o_orderstatus_prf#6890,val_orders_o_totalprice_prf#6891,val_orders_o_orderpriority_prf#6892,val_orders_o_clerk_prf#6893,val_orders_o_shippriority_prf#6894,val_orders_o_comment_prf#6895,val_orders_o_orderdate_prf#6896,o_orderstatus_prf#6897,o_totalprice_prf#6898,o_orderpriority_prf#6899,o_clerk_prf#6900,o_shippriority_prf#6901,o_comment_prf#6902,o_orderdate_prf#6903] JDBCRelation(orders_prf) [numPartitions=1]

dex-class org.apache.spark.sql.dex.DexPkFk$ result size=6001215
Elapsed time: 240049ms

q9c=

select
  n_name,
  o_orderdate,
  l_extendedprice,
  l_discount,
  ps_supplycost,
  l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey and s_nationkey = n_nationkey
      
postgres result size=6001215
Elapsed time: 38755ms
19/10/08 23:18:06 WARN DexPlanner: dexPlan=DexPkFkPlan
19/10/08 23:18:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7247L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :- Project [s_nationkey#21L]
         :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :- Project [l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :     :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :     :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :     :     :  +- Filter ((isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L)) && isnotnull(l_suppkey#308L))
         :     :     :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     :     :     +- Project [o_orderkey#342L]
         :     :     :     :        +- Filter isnotnull(o_orderkey#342L)
         :     :     :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Filter isnotnull(p_partkey#360L)
         :     :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Filter (isnotnull(s_suppkey#18L) && isnotnull(s_nationkey#21L))
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [n_nationkey#108L]
            +- Filter isnotnull(n_nationkey#108L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/08 23:18:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7247L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (cast(dexdecrypt(concat(supplier~nation, ~, 'rid_4), 'fpk_supplier_nation_prf_4) as bigint) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (cast(dexdecrypt(concat(lineitem~supplier, ~, 'rid_0), 'fpk_lineitem_supplier_prf_0) as bigint) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (cast(dexdecrypt(concat(lineitem~part, ~, 'rid_0), 'fpk_lineitem_part_prf_0) as bigint) = 'rid_3)
            :     :     :- 'Project [*]
            :     :     :  +- 'Join Inner, (cast(dexdecrypt(concat(lineitem~partsupp, ~, 'rid_0), 'fpk_lineitem_partsupp_prf_0) as bigint) = 'rid_2)
            :     :     :     :- 'Project [*]
            :     :     :     :  +- 'Join Inner, (cast(dexdecrypt(concat(lineitem~orders, ~, 'rid_0), 'fpk_lineitem_orders_prf_0) as bigint) = 'rid_1)
            :     :     :     :     :- Project [rid#7249L AS rid_0#7282L, fpk_lineitem_orders_prf#7250 AS fpk_lineitem_orders_prf_0#7283, fpk_lineitem_part_prf#7251 AS fpk_lineitem_part_prf_0#7284, fpk_lineitem_partsupp_prf#7252 AS fpk_lineitem_partsupp_prf_0#7285, fpk_lineitem_supplier_prf#7253 AS fpk_lineitem_supplier_prf_0#7286, pfk_supplier_lineitem_prf#7254 AS pfk_supplier_lineitem_prf_0#7287, pfk_part_lineitem_prf#7255 AS pfk_part_lineitem_prf_0#7288, pfk_orders_lineitem_prf#7256 AS pfk_orders_lineitem_prf_0#7289, pfk_partsupp_lineitem_prf#7257 AS pfk_partsupp_lineitem_prf_0#7290, val_lineitem_l_quantity_prf#7258 AS val_lineitem_l_quantity_prf_0#7291, val_lineitem_l_extendedprice_prf#7259 AS val_lineitem_l_extendedprice_prf_0#7292, val_lineitem_l_discount_prf#7260 AS val_lineitem_l_discount_prf_0#7293, val_lineitem_l_tax_prf#7261 AS val_lineitem_l_tax_prf_0#7294, val_lineitem_l_returnflag_prf#7262 AS val_lineitem_l_returnflag_prf_0#7295, val_lineitem_l_linestatus_prf#7263 AS val_lineitem_l_linestatus_prf_0#7296, val_lineitem_l_commitdate_prf#7264 AS val_lineitem_l_commitdate_prf_0#7297, val_lineitem_l_receiptdate_prf#7265 AS val_lineitem_l_receiptdate_prf_0#7298, val_lineitem_l_shipinstruct_prf#7266 AS val_lineitem_l_shipinstruct_prf_0#7299, val_lineitem_l_shipmode_prf#7267 AS val_lineitem_l_shipmode_prf_0#7300, val_lineitem_l_comment_prf#7268 AS val_lineitem_l_comment_prf_0#7301, val_lineitem_l_shipdate_prf#7269 AS val_lineitem_l_shipdate_prf_0#7302, l_quantity_prf#7270 AS l_quantity_prf_0#7303, l_extendedprice_prf#7271 AS l_extendedprice_prf_0#7304, l_discount_prf#7272 AS l_discount_prf_0#7305, ... 9 more fields]
            :     :     :     :     :  +- Relation[rid#7249L,fpk_lineitem_orders_prf#7250,fpk_lineitem_part_prf#7251,fpk_lineitem_partsupp_prf#7252,fpk_lineitem_supplier_prf#7253,pfk_supplier_lineitem_prf#7254,pfk_part_lineitem_prf#7255,pfk_orders_lineitem_prf#7256,pfk_partsupp_lineitem_prf#7257,val_lineitem_l_quantity_prf#7258,val_lineitem_l_extendedprice_prf#7259,val_lineitem_l_discount_prf#7260,val_lineitem_l_tax_prf#7261,val_lineitem_l_returnflag_prf#7262,val_lineitem_l_linestatus_prf#7263,val_lineitem_l_commitdate_prf#7264,val_lineitem_l_receiptdate_prf#7265,val_lineitem_l_shipinstruct_prf#7266,val_lineitem_l_shipmode_prf#7267,val_lineitem_l_comment_prf#7268,val_lineitem_l_shipdate_prf#7269,l_quantity_prf#7270,l_extendedprice_prf#7271,l_discount_prf#7272,... 9 more fields] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     :     :     :     +- Project [rid#7315L AS rid_1#7332L, pfk_customer_orders_prf#7316 AS pfk_customer_orders_prf_1#7333, fpk_orders_customer_prf#7317 AS fpk_orders_customer_prf_1#7334, val_orders_o_orderstatus_prf#7318 AS val_orders_o_orderstatus_prf_1#7335, val_orders_o_totalprice_prf#7319 AS val_orders_o_totalprice_prf_1#7336, val_orders_o_orderpriority_prf#7320 AS val_orders_o_orderpriority_prf_1#7337, val_orders_o_clerk_prf#7321 AS val_orders_o_clerk_prf_1#7338, val_orders_o_shippriority_prf#7322 AS val_orders_o_shippriority_prf_1#7339, val_orders_o_comment_prf#7323 AS val_orders_o_comment_prf_1#7340, val_orders_o_orderdate_prf#7324 AS val_orders_o_orderdate_prf_1#7341, o_orderstatus_prf#7325 AS o_orderstatus_prf_1#7342, o_totalprice_prf#7326 AS o_totalprice_prf_1#7343, o_orderpriority_prf#7327 AS o_orderpriority_prf_1#7344, o_clerk_prf#7328 AS o_clerk_prf_1#7345, o_shippriority_prf#7329 AS o_shippriority_prf_1#7346, o_comment_prf#7330 AS o_comment_prf_1#7347, o_orderdate_prf#7331 AS o_orderdate_prf_1#7348]
            :     :     :     :        +- Relation[rid#7315L,pfk_customer_orders_prf#7316,fpk_orders_customer_prf#7317,val_orders_o_orderstatus_prf#7318,val_orders_o_totalprice_prf#7319,val_orders_o_orderpriority_prf#7320,val_orders_o_clerk_prf#7321,val_orders_o_shippriority_prf#7322,val_orders_o_comment_prf#7323,val_orders_o_orderdate_prf#7324,o_orderstatus_prf#7325,o_totalprice_prf#7326,o_orderpriority_prf#7327,o_clerk_prf#7328,o_shippriority_prf#7329,o_comment_prf#7330,o_orderdate_prf#7331] JDBCRelation(orders_prf) [numPartitions=1]
            :     :     :     +- Project [rid#7349L AS rid_2#7360L, pfk_part_partsupp_prf#7350 AS pfk_part_partsupp_prf_2#7361, fpk_partsupp_part_prf#7351 AS fpk_partsupp_part_prf_2#7362, pfk_supplier_partsupp_prf#7352 AS pfk_supplier_partsupp_prf_2#7363, fpk_partsupp_supplier_prf#7353 AS fpk_partsupp_supplier_prf_2#7364, val_partsupp_ps_availqty_prf#7354 AS val_partsupp_ps_availqty_prf_2#7365, val_partsupp_ps_supplycost_prf#7355 AS val_partsupp_ps_supplycost_prf_2#7366, val_partsupp_ps_comment_prf#7356 AS val_partsupp_ps_comment_prf_2#7367, ps_availqty_prf#7357 AS ps_availqty_prf_2#7368, ps_supplycost_prf#7358 AS ps_supplycost_prf_2#7369, ps_comment_prf#7359 AS ps_comment_prf_2#7370]
            :     :     :        +- Relation[rid#7349L,pfk_part_partsupp_prf#7350,fpk_partsupp_part_prf#7351,pfk_supplier_partsupp_prf#7352,fpk_partsupp_supplier_prf#7353,val_partsupp_ps_availqty_prf#7354,val_partsupp_ps_supplycost_prf#7355,val_partsupp_ps_comment_prf#7356,ps_availqty_prf#7357,ps_supplycost_prf#7358,ps_comment_prf#7359] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     :     +- Project [rid#7371L AS rid_3#7388L, val_part_p_name_prf#7372 AS val_part_p_name_prf_3#7389, val_part_p_mfgr_prf#7373 AS val_part_p_mfgr_prf_3#7390, val_part_p_type_prf#7374 AS val_part_p_type_prf_3#7391, val_part_p_size_prf#7375 AS val_part_p_size_prf_3#7392, val_part_p_container_prf#7376 AS val_part_p_container_prf_3#7393, val_part_p_retailprice_prf#7377 AS val_part_p_retailprice_prf_3#7394, val_part_p_comment_prf#7378 AS val_part_p_comment_prf_3#7395, val_part_p_brand_prf#7379 AS val_part_p_brand_prf_3#7396, p_name_prf#7380 AS p_name_prf_3#7397, p_mfgr_prf#7381 AS p_mfgr_prf_3#7398, p_type_prf#7382 AS p_type_prf_3#7399, p_size_prf#7383 AS p_size_prf_3#7400, p_container_prf#7384 AS p_container_prf_3#7401, p_retailprice_prf#7385 AS p_retailprice_prf_3#7402, p_comment_prf#7386 AS p_comment_prf_3#7403, p_brand_prf#7387 AS p_brand_prf_3#7404]
            :     :        +- Relation[rid#7371L,val_part_p_name_prf#7372,val_part_p_mfgr_prf#7373,val_part_p_type_prf#7374,val_part_p_size_prf#7375,val_part_p_container_prf#7376,val_part_p_retailprice_prf#7377,val_part_p_comment_prf#7378,val_part_p_brand_prf#7379,p_name_prf#7380,p_mfgr_prf#7381,p_type_prf#7382,p_size_prf#7383,p_container_prf#7384,p_retailprice_prf#7385,p_comment_prf#7386,p_brand_prf#7387] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Project [rid#7405L AS rid_4#7418L, pfk_nation_supplier_prf#7406 AS pfk_nation_supplier_prf_4#7419, fpk_supplier_nation_prf#7407 AS fpk_supplier_nation_prf_4#7420, val_supplier_s_name_prf#7408 AS val_supplier_s_name_prf_4#7421, val_supplier_s_address_prf#7409 AS val_supplier_s_address_prf_4#7422, val_supplier_s_phone_prf#7410 AS val_supplier_s_phone_prf_4#7423, val_supplier_s_acctbal_prf#7411 AS val_supplier_s_acctbal_prf_4#7424, val_supplier_s_comment_prf#7412 AS val_supplier_s_comment_prf_4#7425, s_name_prf#7413 AS s_name_prf_4#7426, s_address_prf#7414 AS s_address_prf_4#7427, s_phone_prf#7415 AS s_phone_prf_4#7428, s_acctbal_prf#7416 AS s_acctbal_prf_4#7429, s_comment_prf#7417 AS s_comment_prf_4#7430]
            :        +- Relation[rid#7405L,pfk_nation_supplier_prf#7406,fpk_supplier_nation_prf#7407,val_supplier_s_name_prf#7408,val_supplier_s_address_prf#7409,val_supplier_s_phone_prf#7410,val_supplier_s_acctbal_prf#7411,val_supplier_s_comment_prf#7412,s_name_prf#7413,s_address_prf#7414,s_phone_prf#7415,s_acctbal_prf#7416,s_comment_prf#7417] JDBCRelation(supplier_prf) [numPartitions=1]
            +- Project [rid#7431L AS rid_5#7438L, pfk_region_nation_prf#7432 AS pfk_region_nation_prf_5#7439, fpk_nation_region_prf#7433 AS fpk_nation_region_prf_5#7440, val_nation_n_name_prf#7434 AS val_nation_n_name_prf_5#7441, val_nation_n_comment_prf#7435 AS val_nation_n_comment_prf_5#7442, n_name_prf#7436 AS n_name_prf_5#7443, n_comment_prf#7437 AS n_comment_prf_5#7444]
               +- Relation[rid#7431L,pfk_region_nation_prf#7432,fpk_nation_region_prf#7433,val_nation_n_name_prf#7434,val_nation_n_comment_prf#7435,n_name_prf#7436,n_comment_prf#7437] JDBCRelation(nation_prf) [numPartitions=1]

dex-class org.apache.spark.sql.dex.DexPkFk$ result size=6001215
Elapsed time: 240210ms

 Q10

q10a=

select
  c_name,
  l_extendedprice,
  l_discount,
  c_acctbal,
  n_name,
  c_address,
  c_phone,
  c_comment
from
  customer,
  orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
      
postgres result size=1478870
Elapsed time: 2440ms
19/10/08 23:22:09 WARN DexPlanner: dexPlan=DexPkFkPlan
19/10/08 23:22:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7666L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
               :- Project [c_nationkey#293L, o_orderkey#342L]
               :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :     :- Project [c_custkey#290L, c_nationkey#293L]
               :     :  +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
               :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               :     +- Project [o_orderkey#342L, o_custkey#343L]
               :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/08 23:22:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7666L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (cast(dexdecrypt(concat(lineitem~orders, ~, 'rid_0), 'fpk_lineitem_orders_prf_0) as bigint) = 'rid_2)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#7668L AS rid_0#7701L, fpk_lineitem_orders_prf#7669 AS fpk_lineitem_orders_prf_0#7702, fpk_lineitem_part_prf#7670 AS fpk_lineitem_part_prf_0#7703, fpk_lineitem_partsupp_prf#7671 AS fpk_lineitem_partsupp_prf_0#7704, fpk_lineitem_supplier_prf#7672 AS fpk_lineitem_supplier_prf_0#7705, pfk_supplier_lineitem_prf#7673 AS pfk_supplier_lineitem_prf_0#7706, pfk_part_lineitem_prf#7674 AS pfk_part_lineitem_prf_0#7707, pfk_orders_lineitem_prf#7675 AS pfk_orders_lineitem_prf_0#7708, pfk_partsupp_lineitem_prf#7676 AS pfk_partsupp_lineitem_prf_0#7709, val_lineitem_l_quantity_prf#7677 AS val_lineitem_l_quantity_prf_0#7710, val_lineitem_l_extendedprice_prf#7678 AS val_lineitem_l_extendedprice_prf_0#7711, val_lineitem_l_discount_prf#7679 AS val_lineitem_l_discount_prf_0#7712, val_lineitem_l_tax_prf#7680 AS val_lineitem_l_tax_prf_0#7713, val_lineitem_l_returnflag_prf#7681 AS val_lineitem_l_returnflag_prf_0#7714, val_lineitem_l_linestatus_prf#7682 AS val_lineitem_l_linestatus_prf_0#7715, val_lineitem_l_commitdate_prf#7683 AS val_lineitem_l_commitdate_prf_0#7716, val_lineitem_l_receiptdate_prf#7684 AS val_lineitem_l_receiptdate_prf_0#7717, val_lineitem_l_shipinstruct_prf#7685 AS val_lineitem_l_shipinstruct_prf_0#7718, val_lineitem_l_shipmode_prf#7686 AS val_lineitem_l_shipmode_prf_0#7719, val_lineitem_l_comment_prf#7687 AS val_lineitem_l_comment_prf_0#7720, val_lineitem_l_shipdate_prf#7688 AS val_lineitem_l_shipdate_prf_0#7721, l_quantity_prf#7689 AS l_quantity_prf_0#7722, l_extendedprice_prf#7690 AS l_extendedprice_prf_0#7723, l_discount_prf#7691 AS l_discount_prf_0#7724, ... 9 more fields]
            :  :  +- Relation[rid#7668L,fpk_lineitem_orders_prf#7669,fpk_lineitem_part_prf#7670,fpk_lineitem_partsupp_prf#7671,fpk_lineitem_supplier_prf#7672,pfk_supplier_lineitem_prf#7673,pfk_part_lineitem_prf#7674,pfk_orders_lineitem_prf#7675,pfk_partsupp_lineitem_prf#7676,val_lineitem_l_quantity_prf#7677,val_lineitem_l_extendedprice_prf#7678,val_lineitem_l_discount_prf#7679,val_lineitem_l_tax_prf#7680,val_lineitem_l_returnflag_prf#7681,val_lineitem_l_linestatus_prf#7682,val_lineitem_l_commitdate_prf#7683,val_lineitem_l_receiptdate_prf#7684,val_lineitem_l_shipinstruct_prf#7685,val_lineitem_l_shipmode_prf#7686,val_lineitem_l_comment_prf#7687,val_lineitem_l_shipdate_prf#7688,l_quantity_prf#7689,l_extendedprice_prf#7690,l_discount_prf#7691,... 9 more fields] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, val_lineitem_l_returnflag_prf, 'val_lineitem_l_returnflag_prf_0, lineitem_prf, 'rid_0
            :     +- Project [rid#7734L AS rid_0#7767L, fpk_lineitem_orders_prf#7735 AS fpk_lineitem_orders_prf_0#7768, fpk_lineitem_part_prf#7736 AS fpk_lineitem_part_prf_0#7769, fpk_lineitem_partsupp_prf#7737 AS fpk_lineitem_partsupp_prf_0#7770, fpk_lineitem_supplier_prf#7738 AS fpk_lineitem_supplier_prf_0#7771, pfk_supplier_lineitem_prf#7739 AS pfk_supplier_lineitem_prf_0#7772, pfk_part_lineitem_prf#7740 AS pfk_part_lineitem_prf_0#7773, pfk_orders_lineitem_prf#7741 AS pfk_orders_lineitem_prf_0#7774, pfk_partsupp_lineitem_prf#7742 AS pfk_partsupp_lineitem_prf_0#7775, val_lineitem_l_quantity_prf#7743 AS val_lineitem_l_quantity_prf_0#7776, val_lineitem_l_extendedprice_prf#7744 AS val_lineitem_l_extendedprice_prf_0#7777, val_lineitem_l_discount_prf#7745 AS val_lineitem_l_discount_prf_0#7778, val_lineitem_l_tax_prf#7746 AS val_lineitem_l_tax_prf_0#7779, val_lineitem_l_returnflag_prf#7747 AS val_lineitem_l_returnflag_prf_0#7780, val_lineitem_l_linestatus_prf#7748 AS val_lineitem_l_linestatus_prf_0#7781, val_lineitem_l_commitdate_prf#7749 AS val_lineitem_l_commitdate_prf_0#7782, val_lineitem_l_receiptdate_prf#7750 AS val_lineitem_l_receiptdate_prf_0#7783, val_lineitem_l_shipinstruct_prf#7751 AS val_lineitem_l_shipinstruct_prf_0#7784, val_lineitem_l_shipmode_prf#7752 AS val_lineitem_l_shipmode_prf_0#7785, val_lineitem_l_comment_prf#7753 AS val_lineitem_l_comment_prf_0#7786, val_lineitem_l_shipdate_prf#7754 AS val_lineitem_l_shipdate_prf_0#7787, l_quantity_prf#7755 AS l_quantity_prf_0#7788, l_extendedprice_prf#7756 AS l_extendedprice_prf_0#7789, l_discount_prf#7757 AS l_discount_prf_0#7790, ... 9 more fields]
            :        +- Relation[rid#7734L,fpk_lineitem_orders_prf#7735,fpk_lineitem_part_prf#7736,fpk_lineitem_partsupp_prf#7737,fpk_lineitem_supplier_prf#7738,pfk_supplier_lineitem_prf#7739,pfk_part_lineitem_prf#7740,pfk_orders_lineitem_prf#7741,pfk_partsupp_lineitem_prf#7742,val_lineitem_l_quantity_prf#7743,val_lineitem_l_extendedprice_prf#7744,val_lineitem_l_discount_prf#7745,val_lineitem_l_tax_prf#7746,val_lineitem_l_returnflag_prf#7747,val_lineitem_l_linestatus_prf#7748,val_lineitem_l_commitdate_prf#7749,val_lineitem_l_receiptdate_prf#7750,val_lineitem_l_shipinstruct_prf#7751,val_lineitem_l_shipmode_prf#7752,val_lineitem_l_comment_prf#7753,val_lineitem_l_shipdate_prf#7754,l_quantity_prf#7755,l_extendedprice_prf#7756,l_discount_prf#7757,... 9 more fields] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (cast(dexdecrypt(concat(customer~nation, ~, 'rid_1), 'fpk_customer_nation_prf_1) as bigint) = 'rid_3)
                  :- 'Join UsingJoin(Inner,List(rid_2))
                  :  :- 'Join UsingJoin(Inner,List(rid_1))
                  :  :  :- Project [rid#7800L AS rid_1#7815L, pfk_nation_customer_prf#7801 AS pfk_nation_customer_prf_1#7816, fpk_customer_nation_prf#7802 AS fpk_customer_nation_prf_1#7817, val_customer_c_name_prf#7803 AS val_customer_c_name_prf_1#7818, val_customer_c_address_prf#7804 AS val_customer_c_address_prf_1#7819, val_customer_c_phone_prf#7805 AS val_customer_c_phone_prf_1#7820, val_customer_c_acctbal_prf#7806 AS val_customer_c_acctbal_prf_1#7821, val_customer_c_comment_prf#7807 AS val_customer_c_comment_prf_1#7822, val_customer_c_mktsegment_prf#7808 AS val_customer_c_mktsegment_prf_1#7823, c_name_prf#7809 AS c_name_prf_1#7824, c_address_prf#7810 AS c_address_prf_1#7825, c_phone_prf#7811 AS c_phone_prf_1#7826, c_acctbal_prf#7812 AS c_acctbal_prf_1#7827, c_comment_prf#7813 AS c_comment_prf_1#7828, c_mktsegment_prf#7814 AS c_mktsegment_prf_1#7829]
                  :  :  :  +- Relation[rid#7800L,pfk_nation_customer_prf#7801,fpk_customer_nation_prf#7802,val_customer_c_name_prf#7803,val_customer_c_address_prf#7804,val_customer_c_phone_prf#7805,val_customer_c_acctbal_prf#7806,val_customer_c_comment_prf#7807,val_customer_c_mktsegment_prf#7808,c_name_prf#7809,c_address_prf#7810,c_phone_prf#7811,c_acctbal_prf#7812,c_comment_prf#7813,c_mktsegment_prf#7814] JDBCRelation(customer_prf) [numPartitions=1]
                  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, pfk_customer_orders_prf, 'pfk_customer_orders_prf_2, customer_prf, 'rid_1, orders_prf, 'rid_2
                  :  :     :- Project [rid#7864L AS rid_1#7879L, pfk_nation_customer_prf#7865 AS pfk_nation_customer_prf_1#7880, fpk_customer_nation_prf#7866 AS fpk_customer_nation_prf_1#7881, val_customer_c_name_prf#7867 AS val_customer_c_name_prf_1#7882, val_customer_c_address_prf#7868 AS val_customer_c_address_prf_1#7883, val_customer_c_phone_prf#7869 AS val_customer_c_phone_prf_1#7884, val_customer_c_acctbal_prf#7870 AS val_customer_c_acctbal_prf_1#7885, val_customer_c_comment_prf#7871 AS val_customer_c_comment_prf_1#7886, val_customer_c_mktsegment_prf#7872 AS val_customer_c_mktsegment_prf_1#7887, c_name_prf#7873 AS c_name_prf_1#7888, c_address_prf#7874 AS c_address_prf_1#7889, c_phone_prf#7875 AS c_phone_prf_1#7890, c_acctbal_prf#7876 AS c_acctbal_prf_1#7891, c_comment_prf#7877 AS c_comment_prf_1#7892, c_mktsegment_prf#7878 AS c_mktsegment_prf_1#7893]
                  :  :     :  +- Relation[rid#7864L,pfk_nation_customer_prf#7865,fpk_customer_nation_prf#7866,val_customer_c_name_prf#7867,val_customer_c_address_prf#7868,val_customer_c_phone_prf#7869,val_customer_c_acctbal_prf#7870,val_customer_c_comment_prf#7871,val_customer_c_mktsegment_prf#7872,c_name_prf#7873,c_address_prf#7874,c_phone_prf#7875,c_acctbal_prf#7876,c_comment_prf#7877,c_mktsegment_prf#7878] JDBCRelation(customer_prf) [numPartitions=1]
                  :  :     +- Project [rid#7894L AS rid_2#7911L, pfk_customer_orders_prf#7895 AS pfk_customer_orders_prf_2#7912, fpk_orders_customer_prf#7896 AS fpk_orders_customer_prf_2#7913, val_orders_o_orderstatus_prf#7897 AS val_orders_o_orderstatus_prf_2#7914, val_orders_o_totalprice_prf#7898 AS val_orders_o_totalprice_prf_2#7915, val_orders_o_orderpriority_prf#7899 AS val_orders_o_orderpriority_prf_2#7916, val_orders_o_clerk_prf#7900 AS val_orders_o_clerk_prf_2#7917, val_orders_o_shippriority_prf#7901 AS val_orders_o_shippriority_prf_2#7918, val_orders_o_comment_prf#7902 AS val_orders_o_comment_prf_2#7919, val_orders_o_orderdate_prf#7903 AS val_orders_o_orderdate_prf_2#7920, o_orderstatus_prf#7904 AS o_orderstatus_prf_2#7921, o_totalprice_prf#7905 AS o_totalprice_prf_2#7922, o_orderpriority_prf#7906 AS o_orderpriority_prf_2#7923, o_clerk_prf#7907 AS o_clerk_prf_2#7924, o_shippriority_prf#7908 AS o_shippriority_prf_2#7925, o_comment_prf#7909 AS o_comment_prf_2#7926, o_orderdate_prf#7910 AS o_orderdate_prf_2#7927]
                  :  :        +- Relation[rid#7894L,pfk_customer_orders_prf#7895,fpk_orders_customer_prf#7896,val_orders_o_orderstatus_prf#7897,val_orders_o_totalprice_prf#7898,val_orders_o_orderpriority_prf#7899,val_orders_o_clerk_prf#7900,val_orders_o_shippriority_prf#7901,val_orders_o_comment_prf#7902,val_orders_o_orderdate_prf#7903,o_orderstatus_prf#7904,o_totalprice_prf#7905,o_orderpriority_prf#7906,o_clerk_prf#7907,o_shippriority_prf#7908,o_comment_prf#7909,o_orderdate_prf#7910] JDBCRelation(orders_prf) [numPartitions=1]
                  :  +- Project [rid#7830L AS rid_2#7847L, pfk_customer_orders_prf#7831 AS pfk_customer_orders_prf_2#7848, fpk_orders_customer_prf#7832 AS fpk_orders_customer_prf_2#7849, val_orders_o_orderstatus_prf#7833 AS val_orders_o_orderstatus_prf_2#7850, val_orders_o_totalprice_prf#7834 AS val_orders_o_totalprice_prf_2#7851, val_orders_o_orderpriority_prf#7835 AS val_orders_o_orderpriority_prf_2#7852, val_orders_o_clerk_prf#7836 AS val_orders_o_clerk_prf_2#7853, val_orders_o_shippriority_prf#7837 AS val_orders_o_shippriority_prf_2#7854, val_orders_o_comment_prf#7838 AS val_orders_o_comment_prf_2#7855, val_orders_o_orderdate_prf#7839 AS val_orders_o_orderdate_prf_2#7856, o_orderstatus_prf#7840 AS o_orderstatus_prf_2#7857, o_totalprice_prf#7841 AS o_totalprice_prf_2#7858, o_orderpriority_prf#7842 AS o_orderpriority_prf_2#7859, o_clerk_prf#7843 AS o_clerk_prf_2#7860, o_shippriority_prf#7844 AS o_shippriority_prf_2#7861, o_comment_prf#7845 AS o_comment_prf_2#7862, o_orderdate_prf#7846 AS o_orderdate_prf_2#7863]
                  :     +- Relation[rid#7830L,pfk_customer_orders_prf#7831,fpk_orders_customer_prf#7832,val_orders_o_orderstatus_prf#7833,val_orders_o_totalprice_prf#7834,val_orders_o_orderpriority_prf#7835,val_orders_o_clerk_prf#7836,val_orders_o_shippriority_prf#7837,val_orders_o_comment_prf#7838,val_orders_o_orderdate_prf#7839,o_orderstatus_prf#7840,o_totalprice_prf#7841,o_orderpriority_prf#7842,o_clerk_prf#7843,o_shippriority_prf#7844,o_comment_prf#7845,o_orderdate_prf#7846] JDBCRelation(orders_prf) [numPartitions=1]
                  +- Project [rid#7928L AS rid_3#7935L, pfk_region_nation_prf#7929 AS pfk_region_nation_prf_3#7936, fpk_nation_region_prf#7930 AS fpk_nation_region_prf_3#7937, val_nation_n_name_prf#7931 AS val_nation_n_name_prf_3#7938, val_nation_n_comment_prf#7932 AS val_nation_n_comment_prf_3#7939, n_name_prf#7933 AS n_name_prf_3#7940, n_comment_prf#7934 AS n_comment_prf_3#7941]
                     +- Relation[rid#7928L,pfk_region_nation_prf#7929,fpk_nation_region_prf#7930,val_nation_n_name_prf#7931,val_nation_n_comment_prf#7932,n_name_prf#7933,n_comment_prf#7934] JDBCRelation(nation_prf) [numPartitions=1]

dex-class org.apache.spark.sql.dex.DexPkFk$ result size=1478870
Elapsed time: 33317ms
