19/10/15 16:23:39 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable

 Q2
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7140ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Tue Oct 15 16:23:41 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Tue Oct 15 16:23:42 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Tue Oct 15 16:23:43 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Tue Oct 15 16:23:43 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Tue Oct 15 16:23:43 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Tue Oct 15 16:23:45 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Tue Oct 15 16:23:48 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Tue Oct 15 16:23:48 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q2a=
select r_comment from region where r_name = 'EUROPE'
19/10/15 16:23:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:23:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#396L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/15 16:23:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#396L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#398 AS r_regionkey_prf_0#402, r_name_prf#399 AS r_name_prf_0#403, r_comment_prf#400 AS r_comment_prf_0#404, rid#401 AS rid_0#405]
         :  +- Relation[r_regionkey_prf#398,r_name_prf#399,r_comment_prf#400,rid#401] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#408]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 224ms

q2b=
select n_name from region, nation where r_regionkey = n_regionkey
19/10/15 16:23:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:23:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#425L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/15 16:23:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#425L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#436) AS rid_1#437]
         :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#434: string
         :     :- Project [r_regionkey_prf#427 AS r_regionkey_prf_0#431, r_name_prf#428 AS r_name_prf_0#432, r_comment_prf#429 AS r_comment_prf_0#433, rid#430 AS rid_0#434]
         :     :  +- Relation[r_regionkey_prf#427,r_name_prf#428,r_comment_prf#429,rid#430] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#438 AS rid_1#443, n_regionkey_prf#439 AS n_regionkey_prf_1#444, n_nationkey_prf#440 AS n_nationkey_prf_1#445, n_name_prf#441 AS n_name_prf_1#446, n_comment_prf#442 AS n_comment_prf_1#447]
            +- Relation[rid#438,n_regionkey_prf#439,n_nationkey_prf#440,n_name_prf#441,n_comment_prf#442] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=25
Elapsed time: 119ms

q2c=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
      
19/10/15 16:23:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:23:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#550L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_regionkey#110L = r_regionkey#116L)
         :- Project [n_regionkey#110L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :     :     :- Project [ps_suppkey#33L]
         :     :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Filter (isnotnull(s_suppkey#18L) && isnotnull(s_nationkey#21L))
         :     :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :        +- Filter (isnotnull(n_nationkey#108L) && isnotnull(n_regionkey#110L))
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [r_regionkey#116L]
            +- Filter ((isnotnull(r_name#117) && (r_name#117 = EUROPE)) && isnotnull(r_regionkey#116L))
               +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/15 16:23:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#550L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_3))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#436) AS rid_1#573]
         :  :  :  :  :  :  :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#564: string
         :  :  :  :  :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :     :  :- Project [p_comment_prf#552 AS p_comment_prf_0#562, p_name_prf#553 AS p_name_prf_0#563, rid#554 AS rid_0#564, p_type_prf#555 AS p_type_prf_0#565, p_retailprice_prf#556 AS p_retailprice_prf_0#566, p_mfgr_prf#557 AS p_mfgr_prf_0#567, p_container_prf#558 AS p_container_prf_0#568, p_brand_prf#559 AS p_brand_prf_0#569, p_size_prf#560 AS p_size_prf_0#570, p_partkey_prf#561 AS p_partkey_prf_0#571]
         :  :  :  :  :  :  :     :  :  +- Relation[p_comment_prf#552,p_name_prf#553,rid#554,p_type_prf#555,p_retailprice_prf#556,p_mfgr_prf#557,p_container_prf#558,p_brand_prf#559,p_size_prf#560,p_partkey_prf#561] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  :  :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#572]
         :  :  :  :  :  :  :     :     +- DexRidFilter part~p_size~15
         :  :  :  :  :  :  :     :        +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :  :  :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  +- Project [ps_partkey_and_ps_suppkey_prf#574 AS ps_partkey_and_ps_suppkey_prf_1#581, rid#575 AS rid_1#582, ps_availqty_prf#576 AS ps_availqty_prf_1#583, ps_comment_prf#577 AS ps_comment_prf_1#584, ps_partkey_prf#578 AS ps_partkey_prf_1#585, ps_supplycost_prf#579 AS ps_supplycost_prf_1#586, ps_suppkey_prf#580 AS ps_suppkey_prf_1#587]
         :  :  :  :  :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#574,rid#575,ps_availqty_prf#576,ps_comment_prf#577,ps_partkey_prf#578,ps_supplycost_prf#579,ps_suppkey_prf#580] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#436) AS rid_2#596]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :  :  :  :  :        :- 'Project ['rid AS rid_1#595]
         :  :  :  :  :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#588,rid#589,ps_availqty_prf#590,ps_comment_prf#591,ps_partkey_prf#592,ps_supplycost_prf#593,ps_suppkey_prf#594] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [s_phone_prf#597 AS s_phone_prf_2#605, rid#598 AS rid_2#606, s_address_prf#599 AS s_address_prf_2#607, s_nationkey_prf#600 AS s_nationkey_prf_2#608, s_suppkey_prf#601 AS s_suppkey_prf_2#609, s_name_prf#602 AS s_name_prf_2#610, s_acctbal_prf#603 AS s_acctbal_prf_2#611, s_comment_prf#604 AS s_comment_prf_2#612]
         :  :  :  :     +- Relation[s_phone_prf#597,rid#598,s_address_prf#599,s_nationkey_prf#600,s_suppkey_prf#601,s_name_prf#602,s_acctbal_prf#603,s_comment_prf#604] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#436) AS rid_3#622]
         :  :  :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_2
         :  :  :        :- 'Project ['rid AS rid_2#621]
         :  :  :        :  +- Relation[s_phone_prf#613,rid#614,s_address_prf#615,s_nationkey_prf#616,s_suppkey_prf#617,s_name_prf#618,s_acctbal_prf#619,s_comment_prf#620] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [rid#623 AS rid_3#628, n_regionkey_prf#624 AS n_regionkey_prf_3#629, n_nationkey_prf#625 AS n_nationkey_prf_3#630, n_name_prf#626 AS n_name_prf_3#631, n_comment_prf#627 AS n_comment_prf_3#632]
         :  :     +- Relation[rid#623,n_regionkey_prf#624,n_nationkey_prf#625,n_name_prf#626,n_comment_prf#627] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project ['rid_3, dexdecrypt('value_dec_key, value#436) AS rid_4#639]
         :     +- 'DexRidCorrelatedJoin nation~n_regionkey~region~r_regionkey, 'rid_3
         :        :- 'Project ['rid AS rid_3#638]
         :        :  +- Relation[rid#633,n_regionkey_prf#634,n_nationkey_prf#635,n_name_prf#636,n_comment_prf#637] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_4))
            :- Project [r_regionkey_prf#640 AS r_regionkey_prf_4#644, r_name_prf#641 AS r_name_prf_4#645, r_comment_prf#642 AS r_comment_prf_4#646, rid#643 AS rid_4#647]
            :  +- Relation[r_regionkey_prf#640,r_name_prf#641,r_comment_prf#642,rid#643] JDBCRelation(region_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_4#648]
               +- DexRidFilter region~r_name~EUROPE
                  +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]

19/10/15 16:23:49 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=3162
Elapsed time: 46299ms

q2c2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
      
19/10/15 16:24:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:24:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#776L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_regionkey#110L = r_regionkey#116L)
         :- Project [n_regionkey#110L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :     :     :- Project [ps_suppkey#33L]
         :     :     :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     :     +- Project [p_partkey#360L]
         :     :     :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Filter (isnotnull(s_suppkey#18L) && isnotnull(s_nationkey#21L))
         :     :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :        +- Filter (isnotnull(n_nationkey#108L) && isnotnull(n_regionkey#110L))
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [r_regionkey#116L]
            +- Filter ((isnotnull(r_name#117) && (r_name#117 = EUROPE)) && isnotnull(r_regionkey#116L))
               +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/15 16:24:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#776L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_3))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#436) AS rid_1#792]
         :  :  :  :  :  :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#786: string
         :  :  :  :  :  :  :     :- Project [ps_partkey_and_ps_suppkey_prf#778 AS ps_partkey_and_ps_suppkey_prf_0#785, rid#779 AS rid_0#786, ps_availqty_prf#780 AS ps_availqty_prf_0#787, ps_comment_prf#781 AS ps_comment_prf_0#788, ps_partkey_prf#782 AS ps_partkey_prf_0#789, ps_supplycost_prf#783 AS ps_supplycost_prf_0#790, ps_suppkey_prf#784 AS ps_suppkey_prf_0#791]
         :  :  :  :  :  :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#778,rid#779,ps_availqty_prf#780,ps_comment_prf#781,ps_partkey_prf#782,ps_supplycost_prf#783,ps_suppkey_prf#784] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :  :  :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :  :  :  :  :     :- Project [p_comment_prf#793 AS p_comment_prf_1#803, p_name_prf#794 AS p_name_prf_1#804, rid#795 AS rid_1#805, p_type_prf#796 AS p_type_prf_1#806, p_retailprice_prf#797 AS p_retailprice_prf_1#807, p_mfgr_prf#798 AS p_mfgr_prf_1#808, p_container_prf#799 AS p_container_prf_1#809, p_brand_prf#800 AS p_brand_prf_1#810, p_size_prf#801 AS p_size_prf_1#811, p_partkey_prf#802 AS p_partkey_prf_1#812]
         :  :  :  :  :  :     :  +- Relation[p_comment_prf#793,p_name_prf#794,rid#795,p_type_prf#796,p_retailprice_prf#797,p_mfgr_prf#798,p_container_prf#799,p_brand_prf#800,p_size_prf#801,p_partkey_prf#802] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  :  :  :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#813]
         :  :  :  :  :  :        +- DexRidFilter part~p_size~15
         :  :  :  :  :  :           +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#436) AS rid_2#822]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :  :  :  :  :        :- 'Project ['rid AS rid_0#821]
         :  :  :  :  :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#814,rid#815,ps_availqty_prf#816,ps_comment_prf#817,ps_partkey_prf#818,ps_supplycost_prf#819,ps_suppkey_prf#820] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [s_phone_prf#823 AS s_phone_prf_2#831, rid#824 AS rid_2#832, s_address_prf#825 AS s_address_prf_2#833, s_nationkey_prf#826 AS s_nationkey_prf_2#834, s_suppkey_prf#827 AS s_suppkey_prf_2#835, s_name_prf#828 AS s_name_prf_2#836, s_acctbal_prf#829 AS s_acctbal_prf_2#837, s_comment_prf#830 AS s_comment_prf_2#838]
         :  :  :  :     +- Relation[s_phone_prf#823,rid#824,s_address_prf#825,s_nationkey_prf#826,s_suppkey_prf#827,s_name_prf#828,s_acctbal_prf#829,s_comment_prf#830] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#436) AS rid_3#848]
         :  :  :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_2
         :  :  :        :- 'Project ['rid AS rid_2#847]
         :  :  :        :  +- Relation[s_phone_prf#839,rid#840,s_address_prf#841,s_nationkey_prf#842,s_suppkey_prf#843,s_name_prf#844,s_acctbal_prf#845,s_comment_prf#846] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [rid#849 AS rid_3#854, n_regionkey_prf#850 AS n_regionkey_prf_3#855, n_nationkey_prf#851 AS n_nationkey_prf_3#856, n_name_prf#852 AS n_name_prf_3#857, n_comment_prf#853 AS n_comment_prf_3#858]
         :  :     +- Relation[rid#849,n_regionkey_prf#850,n_nationkey_prf#851,n_name_prf#852,n_comment_prf#853] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project ['rid_3, dexdecrypt('value_dec_key, value#436) AS rid_4#865]
         :     +- 'DexRidCorrelatedJoin nation~n_regionkey~region~r_regionkey, 'rid_3
         :        :- 'Project ['rid AS rid_3#864]
         :        :  +- Relation[rid#859,n_regionkey_prf#860,n_nationkey_prf#861,n_name_prf#862,n_comment_prf#863] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_4))
            :- Project [r_regionkey_prf#866 AS r_regionkey_prf_4#870, r_name_prf#867 AS r_name_prf_4#871, r_comment_prf#868 AS r_comment_prf_4#872, rid#869 AS rid_4#873]
            :  +- Relation[r_regionkey_prf#866,r_name_prf#867,r_comment_prf#868,rid#869] JDBCRelation(region_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_4#874]
               +- DexRidFilter region~r_name~EUROPE
                  +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3162
Elapsed time: 120774ms

q2c3=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
      
19/10/15 16:26:36 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:26:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#982L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Join Inner, (r_regionkey#116L = n_nationkey#108L)
         :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :  +- Filter ((isnotnull(r_name#117) && (r_name#117 = EUROPE)) && isnotnull(r_regionkey#116L))
         :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     +- Project [n_nationkey#108L]
         :     :     :        +- Filter isnotnull(n_nationkey#108L)
         :     :     :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Filter (isnotnull(s_nationkey#21L) && isnotnull(s_suppkey#18L))
         :     :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_suppkey#33L) && isnotnull(ps_partkey#32L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 16:26:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#982L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_3))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#436) AS rid_1#993]
         :  :  :  :  :  :  :  +- 'DexRidCorrelatedJoin region~r_regionkey~nation~n_nationkey, rid_0#991: string
         :  :  :  :  :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :     :  :- Project [r_regionkey_prf#984 AS r_regionkey_prf_0#988, r_name_prf#985 AS r_name_prf_0#989, r_comment_prf#986 AS r_comment_prf_0#990, rid#987 AS rid_0#991]
         :  :  :  :  :  :  :     :  :  +- Relation[r_regionkey_prf#984,r_name_prf#985,r_comment_prf#986,rid#987] JDBCRelation(region_prf) [numPartitions=1]
         :  :  :  :  :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#992]
         :  :  :  :  :  :  :     :     +- DexRidFilter region~r_name~EUROPE
         :  :  :  :  :  :  :     :        +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :  :  :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  +- Project [rid#994 AS rid_1#999, n_regionkey_prf#995 AS n_regionkey_prf_1#1000, n_nationkey_prf#996 AS n_nationkey_prf_1#1001, n_name_prf#997 AS n_name_prf_1#1002, n_comment_prf#998 AS n_comment_prf_1#1003]
         :  :  :  :  :  :     +- Relation[rid#994,n_regionkey_prf#995,n_nationkey_prf#996,n_name_prf#997,n_comment_prf#998] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#436) AS rid_2#1010]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_1
         :  :  :  :  :        :- 'Project ['rid AS rid_1#1009]
         :  :  :  :  :        :  +- Relation[rid#1004,n_regionkey_prf#1005,n_nationkey_prf#1006,n_name_prf#1007,n_comment_prf#1008] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [s_phone_prf#1011 AS s_phone_prf_2#1019, rid#1012 AS rid_2#1020, s_address_prf#1013 AS s_address_prf_2#1021, s_nationkey_prf#1014 AS s_nationkey_prf_2#1022, s_suppkey_prf#1015 AS s_suppkey_prf_2#1023, s_name_prf#1016 AS s_name_prf_2#1024, s_acctbal_prf#1017 AS s_acctbal_prf_2#1025, s_comment_prf#1018 AS s_comment_prf_2#1026]
         :  :  :  :     +- Relation[s_phone_prf#1011,rid#1012,s_address_prf#1013,s_nationkey_prf#1014,s_suppkey_prf#1015,s_name_prf#1016,s_acctbal_prf#1017,s_comment_prf#1018] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#436) AS rid_3#1036]
         :  :  :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_2
         :  :  :        :- 'Project ['rid AS rid_2#1035]
         :  :  :        :  +- Relation[s_phone_prf#1027,rid#1028,s_address_prf#1029,s_nationkey_prf#1030,s_suppkey_prf#1031,s_name_prf#1032,s_acctbal_prf#1033,s_comment_prf#1034] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#1037 AS ps_partkey_and_ps_suppkey_prf_3#1044, rid#1038 AS rid_3#1045, ps_availqty_prf#1039 AS ps_availqty_prf_3#1046, ps_comment_prf#1040 AS ps_comment_prf_3#1047, ps_partkey_prf#1041 AS ps_partkey_prf_3#1048, ps_supplycost_prf#1042 AS ps_supplycost_prf_3#1049, ps_suppkey_prf#1043 AS ps_suppkey_prf_3#1050]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#1037,rid#1038,ps_availqty_prf#1039,ps_comment_prf#1040,ps_partkey_prf#1041,ps_supplycost_prf#1042,ps_suppkey_prf#1043] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project ['rid_3, dexdecrypt('value_dec_key, value#436) AS rid_4#1059]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, 'rid_3
         :        :- 'Project ['rid AS rid_3#1058]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#1051,rid#1052,ps_availqty_prf#1053,ps_comment_prf#1054,ps_partkey_prf#1055,ps_supplycost_prf#1056,ps_suppkey_prf#1057] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_4))
            :- Project [p_comment_prf#1060 AS p_comment_prf_4#1070, p_name_prf#1061 AS p_name_prf_4#1071, rid#1062 AS rid_4#1072, p_type_prf#1063 AS p_type_prf_4#1073, p_retailprice_prf#1064 AS p_retailprice_prf_4#1074, p_mfgr_prf#1065 AS p_mfgr_prf_4#1075, p_container_prf#1066 AS p_container_prf_4#1076, p_brand_prf#1067 AS p_brand_prf_4#1077, p_size_prf#1068 AS p_size_prf_4#1078, p_partkey_prf#1069 AS p_partkey_prf_4#1079]
            :  +- Relation[p_comment_prf#1060,p_name_prf#1061,rid#1062,p_type_prf#1063,p_retailprice_prf#1064,p_mfgr_prf#1065,p_container_prf#1066,p_brand_prf#1067,p_size_prf#1068,p_partkey_prf#1069] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_4#1080]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=0
Elapsed time: 266ms

q2c4=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
      
19/10/15 16:26:36 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:26:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1183L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_nationkey#108L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter ((isnotnull(r_name#117) && (r_name#117 = EUROPE)) && isnotnull(r_regionkey#116L))
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L]
         :     :        +- Filter isnotnull(n_nationkey#108L)
         :     :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Filter (isnotnull(s_nationkey#21L) && isnotnull(s_suppkey#18L))
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/15 16:26:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1183L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#436) AS rid_1#1194]
         :  :  :  :  :  +- 'DexRidCorrelatedJoin region~r_regionkey~nation~n_nationkey, rid_0#1192: string
         :  :  :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :     :  :- Project [r_regionkey_prf#1185 AS r_regionkey_prf_0#1189, r_name_prf#1186 AS r_name_prf_0#1190, r_comment_prf#1187 AS r_comment_prf_0#1191, rid#1188 AS rid_0#1192]
         :  :  :  :  :     :  :  +- Relation[r_regionkey_prf#1185,r_name_prf#1186,r_comment_prf#1187,rid#1188] JDBCRelation(region_prf) [numPartitions=1]
         :  :  :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1193]
         :  :  :  :  :     :     +- DexRidFilter region~r_name~EUROPE
         :  :  :  :  :     :        +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [rid#1195 AS rid_1#1200, n_regionkey_prf#1196 AS n_regionkey_prf_1#1201, n_nationkey_prf#1197 AS n_nationkey_prf_1#1202, n_name_prf#1198 AS n_name_prf_1#1203, n_comment_prf#1199 AS n_comment_prf_1#1204]
         :  :  :  :     +- Relation[rid#1195,n_regionkey_prf#1196,n_nationkey_prf#1197,n_name_prf#1198,n_comment_prf#1199] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#436) AS rid_2#1211]
         :  :  :     +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_1
         :  :  :        :- 'Project ['rid AS rid_1#1210]
         :  :  :        :  +- Relation[rid#1205,n_regionkey_prf#1206,n_nationkey_prf#1207,n_name_prf#1208,n_comment_prf#1209] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#1212 AS s_phone_prf_2#1220, rid#1213 AS rid_2#1221, s_address_prf#1214 AS s_address_prf_2#1222, s_nationkey_prf#1215 AS s_nationkey_prf_2#1223, s_suppkey_prf#1216 AS s_suppkey_prf_2#1224, s_name_prf#1217 AS s_name_prf_2#1225, s_acctbal_prf#1218 AS s_acctbal_prf_2#1226, s_comment_prf#1219 AS s_comment_prf_2#1227]
         :  :     +- Relation[s_phone_prf#1212,rid#1213,s_address_prf#1214,s_nationkey_prf#1215,s_suppkey_prf#1216,s_name_prf#1217,s_acctbal_prf#1218,s_comment_prf#1219] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#436) AS rid_4#1237]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#1236]
         :        :  +- Relation[s_phone_prf#1228,rid#1229,s_address_prf#1230,s_nationkey_prf#1231,s_suppkey_prf#1232,s_name_prf#1233,s_acctbal_prf#1234,s_comment_prf#1235] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_3, 'p_name_prf_3, 'rid_3, 'p_type_prf_3, 'p_retailprice_prf_3, 'p_mfgr_prf_3, 'p_container_prf_3, 'p_brand_prf_3, 'p_size_prf_3, 'p_partkey_prf_3, dexdecrypt('value_dec_key, value#436) AS rid_4#1259]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_3#1250: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :     :  :- Project [p_comment_prf#1238 AS p_comment_prf_3#1248, p_name_prf#1239 AS p_name_prf_3#1249, rid#1240 AS rid_3#1250, p_type_prf#1241 AS p_type_prf_3#1251, p_retailprice_prf#1242 AS p_retailprice_prf_3#1252, p_mfgr_prf#1243 AS p_mfgr_prf_3#1253, p_container_prf#1244 AS p_container_prf_3#1254, p_brand_prf#1245 AS p_brand_prf_3#1255, p_size_prf#1246 AS p_size_prf_3#1256, p_partkey_prf#1247 AS p_partkey_prf_3#1257]
            :     :  :  +- Relation[p_comment_prf#1238,p_name_prf#1239,rid#1240,p_type_prf#1241,p_retailprice_prf#1242,p_mfgr_prf#1243,p_container_prf#1244,p_brand_prf#1245,p_size_prf#1246,p_partkey_prf#1247] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#1258]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#1260 AS ps_partkey_and_ps_suppkey_prf_4#1267, rid#1261 AS rid_4#1268, ps_availqty_prf#1262 AS ps_availqty_prf_4#1269, ps_comment_prf#1263 AS ps_comment_prf_4#1270, ps_partkey_prf#1264 AS ps_partkey_prf_4#1271, ps_supplycost_prf#1265 AS ps_supplycost_prf_4#1272, ps_suppkey_prf#1266 AS ps_suppkey_prf_4#1273]
               +- Relation[ps_partkey_and_ps_suppkey_prf#1260,rid#1261,ps_availqty_prf#1262,ps_comment_prf#1263,ps_partkey_prf#1264,ps_supplycost_prf#1265,ps_suppkey_prf#1266] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=0
Elapsed time: 503ms

q2d=
select * from part where p_size = 15
19/10/15 16:26:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:26:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1320L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 16:26:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1320L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#1322 AS p_comment_prf_0#1332, p_name_prf#1323 AS p_name_prf_0#1333, rid#1324 AS rid_0#1334, p_type_prf#1325 AS p_type_prf_0#1335, p_retailprice_prf#1326 AS p_retailprice_prf_0#1336, p_mfgr_prf#1327 AS p_mfgr_prf_0#1337, p_container_prf#1328 AS p_container_prf_0#1338, p_brand_prf#1329 AS p_brand_prf_0#1339, p_size_prf#1330 AS p_size_prf_0#1340, p_partkey_prf#1331 AS p_partkey_prf_0#1341]
         :  +- Relation[p_comment_prf#1322,p_name_prf#1323,rid#1324,p_type_prf#1325,p_retailprice_prf#1326,p_mfgr_prf#1327,p_container_prf#1328,p_brand_prf#1329,p_size_prf#1330,p_partkey_prf#1331] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1342]
            +- DexRidFilter part~p_size~15
               +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3907
Elapsed time: 131ms

q2e=

select
  ps_supplycost
from
  part,
  partsupp
where
  p_partkey = ps_partkey
      
19/10/15 16:26:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:26:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1372L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 16:26:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1372L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#436) AS rid_1#1388]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#1382: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#1374 AS ps_partkey_and_ps_suppkey_prf_0#1381, rid#1375 AS rid_0#1382, ps_availqty_prf#1376 AS ps_availqty_prf_0#1383, ps_comment_prf#1377 AS ps_comment_prf_0#1384, ps_partkey_prf#1378 AS ps_partkey_prf_0#1385, ps_supplycost_prf#1379 AS ps_supplycost_prf_0#1386, ps_suppkey_prf#1380 AS ps_suppkey_prf_0#1387]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#1374,rid#1375,ps_availqty_prf#1376,ps_comment_prf#1377,ps_partkey_prf#1378,ps_supplycost_prf#1379,ps_suppkey_prf#1380] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#1389 AS p_comment_prf_1#1399, p_name_prf#1390 AS p_name_prf_1#1400, rid#1391 AS rid_1#1401, p_type_prf#1392 AS p_type_prf_1#1402, p_retailprice_prf#1393 AS p_retailprice_prf_1#1403, p_mfgr_prf#1394 AS p_mfgr_prf_1#1404, p_container_prf#1395 AS p_container_prf_1#1405, p_brand_prf#1396 AS p_brand_prf_1#1406, p_size_prf#1397 AS p_size_prf_1#1407, p_partkey_prf#1398 AS p_partkey_prf_1#1408]
            +- Relation[p_comment_prf#1389,p_name_prf#1390,rid#1391,p_type_prf#1392,p_retailprice_prf#1393,p_mfgr_prf#1394,p_container_prf#1395,p_brand_prf#1396,p_size_prf#1397,p_partkey_prf#1398] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 52625ms

q2e2=

select
  ps_supplycost
from
  part,
  partsupp
where
  p_partkey = ps_partkey
      
19/10/15 16:27:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:27:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1445L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/15 16:27:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1445L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#436) AS rid_1#1467]
         :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#1459: string
         :     :- Project [p_comment_prf#1447 AS p_comment_prf_0#1457, p_name_prf#1448 AS p_name_prf_0#1458, rid#1449 AS rid_0#1459, p_type_prf#1450 AS p_type_prf_0#1460, p_retailprice_prf#1451 AS p_retailprice_prf_0#1461, p_mfgr_prf#1452 AS p_mfgr_prf_0#1462, p_container_prf#1453 AS p_container_prf_0#1463, p_brand_prf#1454 AS p_brand_prf_0#1464, p_size_prf#1455 AS p_size_prf_0#1465, p_partkey_prf#1456 AS p_partkey_prf_0#1466]
         :     :  +- Relation[p_comment_prf#1447,p_name_prf#1448,rid#1449,p_type_prf#1450,p_retailprice_prf#1451,p_mfgr_prf#1452,p_container_prf#1453,p_brand_prf#1454,p_size_prf#1455,p_partkey_prf#1456] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#1468 AS ps_partkey_and_ps_suppkey_prf_1#1475, rid#1469 AS rid_1#1476, ps_availqty_prf#1470 AS ps_availqty_prf_1#1477, ps_comment_prf#1471 AS ps_comment_prf_1#1478, ps_partkey_prf#1472 AS ps_partkey_prf_1#1479, ps_supplycost_prf#1473 AS ps_supplycost_prf_1#1480, ps_suppkey_prf#1474 AS ps_suppkey_prf_1#1481]
            +- Relation[ps_partkey_and_ps_suppkey_prf#1468,rid#1469,ps_availqty_prf#1470,ps_comment_prf#1471,ps_partkey_prf#1472,ps_supplycost_prf#1473,ps_suppkey_prf#1474] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 31823ms

 Q5

q5a=

select
  n_name
from
  customer, supplier, nation, region
where
  r_name = 'ASIA'
  and r_regionkey = n_regionkey
  and n_nationkey = c_nationkey
  and n_nationkey = s_nationkey
      
19/10/15 16:28:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:28:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1548L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter ((isnotnull(r_name#117) && (r_name#117 = ASIA)) && isnotnull(r_regionkey#116L))
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Filter (isnotnull(n_regionkey#110L) && isnotnull(n_nationkey#108L))
         :     :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [c_nationkey#293L]
         :        +- Filter isnotnull(c_nationkey#293L)
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 16:28:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1548L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#436) AS rid_1#1559]
         :  :  :  :  :  +- 'DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#1557: string
         :  :  :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :     :  :- Project [r_regionkey_prf#1550 AS r_regionkey_prf_0#1554, r_name_prf#1551 AS r_name_prf_0#1555, r_comment_prf#1552 AS r_comment_prf_0#1556, rid#1553 AS rid_0#1557]
         :  :  :  :  :     :  :  +- Relation[r_regionkey_prf#1550,r_name_prf#1551,r_comment_prf#1552,rid#1553] JDBCRelation(region_prf) [numPartitions=1]
         :  :  :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1558]
         :  :  :  :  :     :     +- DexRidFilter region~r_name~ASIA
         :  :  :  :  :     :        +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [rid#1560 AS rid_1#1565, n_regionkey_prf#1561 AS n_regionkey_prf_1#1566, n_nationkey_prf#1562 AS n_nationkey_prf_1#1567, n_name_prf#1563 AS n_name_prf_1#1568, n_comment_prf#1564 AS n_comment_prf_1#1569]
         :  :  :  :     +- Relation[rid#1560,n_regionkey_prf#1561,n_nationkey_prf#1562,n_name_prf#1563,n_comment_prf#1564] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#436) AS rid_2#1576]
         :  :  :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :  :  :        :- 'Project ['rid AS rid_1#1575]
         :  :  :        :  +- Relation[rid#1570,n_regionkey_prf#1571,n_nationkey_prf#1572,n_name_prf#1573,n_comment_prf#1574] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#1577 AS c_acctbal_prf_2#1586, rid#1578 AS rid_2#1587, c_name_prf#1579 AS c_name_prf_2#1588, c_nationkey_prf#1580 AS c_nationkey_prf_2#1589, c_custkey_prf#1581 AS c_custkey_prf_2#1590, c_comment_prf#1582 AS c_comment_prf_2#1591, c_address_prf#1583 AS c_address_prf_2#1592, c_mktsegment_prf#1584 AS c_mktsegment_prf_2#1593, c_phone_prf#1585 AS c_phone_prf_2#1594]
         :  :     +- Relation[c_acctbal_prf#1577,rid#1578,c_name_prf#1579,c_nationkey_prf#1580,c_custkey_prf#1581,c_comment_prf#1582,c_address_prf#1583,c_mktsegment_prf#1584,c_phone_prf#1585] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#436) AS rid_3#1601]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#1600]
         :        :  +- Relation[rid#1595,n_regionkey_prf#1596,n_nationkey_prf#1597,n_name_prf#1598,n_comment_prf#1599] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#1602 AS s_phone_prf_3#1610, rid#1603 AS rid_3#1611, s_address_prf#1604 AS s_address_prf_3#1612, s_nationkey_prf#1605 AS s_nationkey_prf_3#1613, s_suppkey_prf#1606 AS s_suppkey_prf_3#1614, s_name_prf#1607 AS s_name_prf_3#1615, s_acctbal_prf#1608 AS s_acctbal_prf_3#1616, s_comment_prf#1609 AS s_comment_prf_3#1617]
            +- Relation[s_phone_prf#1602,rid#1603,s_address_prf#1604,s_nationkey_prf#1605,s_suppkey_prf#1606,s_name_prf#1607,s_acctbal_prf#1608,s_comment_prf#1609] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=12093991
Elapsed time: 5072ms

q5a2=

select
  n_name
from
  customer, supplier, nation, region
where
  r_name = 'ASIA'
  and r_regionkey = n_regionkey
  and n_nationkey = c_nationkey
  and n_nationkey = s_nationkey
      
19/10/15 16:28:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:28:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1698L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :- Project [s_nationkey#21L]
         :  +- Filter isnotnull(s_nationkey#21L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (n_regionkey#110L = r_regionkey#116L)
               :- Project [n_nationkey#108L, n_regionkey#110L]
               :  +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
               :     :- Project [c_nationkey#293L]
               :     :  +- Filter isnotnull(c_nationkey#293L)
               :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               :     +- Project [n_nationkey#108L, n_regionkey#110L]
               :        +- Filter (isnotnull(n_nationkey#108L) && isnotnull(n_regionkey#110L))
               :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [r_regionkey#116L]
                  +- Filter ((isnotnull(r_name#117) && (r_name#117 = ASIA)) && isnotnull(r_regionkey#116L))
                     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/15 16:28:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1698L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#436) AS rid_2#1716]
         :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#1709: string
         :     :- Project [s_phone_prf#1700 AS s_phone_prf_0#1708, rid#1701 AS rid_0#1709, s_address_prf#1702 AS s_address_prf_0#1710, s_nationkey_prf#1703 AS s_nationkey_prf_0#1711, s_suppkey_prf#1704 AS s_suppkey_prf_0#1712, s_name_prf#1705 AS s_name_prf_0#1713, s_acctbal_prf#1706 AS s_acctbal_prf_0#1714, s_comment_prf#1707 AS s_comment_prf_0#1715]
         :     :  +- Relation[s_phone_prf#1700,rid#1701,s_address_prf#1702,s_nationkey_prf#1703,s_suppkey_prf#1704,s_name_prf#1705,s_acctbal_prf#1706,s_comment_prf#1707] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join NaturalJoin(Inner)
            :  :  :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#436) AS rid_2#1735]
            :  :  :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_1#1727: string
            :  :  :     :- Project [c_acctbal_prf#1717 AS c_acctbal_prf_1#1726, rid#1718 AS rid_1#1727, c_name_prf#1719 AS c_name_prf_1#1728, c_nationkey_prf#1720 AS c_nationkey_prf_1#1729, c_custkey_prf#1721 AS c_custkey_prf_1#1730, c_comment_prf#1722 AS c_comment_prf_1#1731, c_address_prf#1723 AS c_address_prf_1#1732, c_mktsegment_prf#1724 AS c_mktsegment_prf_1#1733, c_phone_prf#1725 AS c_phone_prf_1#1734]
            :  :  :     :  +- Relation[c_acctbal_prf#1717,rid#1718,c_name_prf#1719,c_nationkey_prf#1720,c_custkey_prf#1721,c_comment_prf#1722,c_address_prf#1723,c_mktsegment_prf#1724,c_phone_prf#1725] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
            :  :  +- Project [rid#1736 AS rid_2#1741, n_regionkey_prf#1737 AS n_regionkey_prf_2#1742, n_nationkey_prf#1738 AS n_nationkey_prf_2#1743, n_name_prf#1739 AS n_name_prf_2#1744, n_comment_prf#1740 AS n_comment_prf_2#1745]
            :  :     +- Relation[rid#1736,n_regionkey_prf#1737,n_nationkey_prf#1738,n_name_prf#1739,n_comment_prf#1740] JDBCRelation(nation_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#436) AS rid_3#1752]
            :     +- 'DexRidCorrelatedJoin nation~n_regionkey~region~r_regionkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#1751]
            :        :  +- Relation[rid#1746,n_regionkey_prf#1747,n_nationkey_prf#1748,n_name_prf#1749,n_comment_prf#1750] JDBCRelation(nation_prf) [numPartitions=1]
            :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_3))
               :- Project [r_regionkey_prf#1753 AS r_regionkey_prf_3#1757, r_name_prf#1754 AS r_name_prf_3#1758, r_comment_prf#1755 AS r_comment_prf_3#1759, rid#1756 AS rid_3#1760]
               :  +- Relation[r_regionkey_prf#1753,r_name_prf#1754,r_comment_prf#1755,rid#1756] JDBCRelation(region_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#1761]
                  +- DexRidFilter region~r_name~ASIA
                     +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=12093991
Elapsed time: 27515ms

q5b=

select
  n_name
from
  customer, supplier, nation, region
where
  r_regionkey = n_regionkey
  and c_nationkey = s_nationkey
  and n_nationkey = c_nationkey
  and n_nationkey = s_nationkey
      
19/10/15 16:28:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:28:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1837L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter isnotnull(r_regionkey#116L)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Filter (isnotnull(n_regionkey#110L) && isnotnull(n_nationkey#108L))
         :     :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [c_nationkey#293L]
         :        +- Filter isnotnull(c_nationkey#293L)
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 16:28:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1837L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#436) AS rid_1#1847]
         :  :  :  :  :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#1846: string
         :  :  :  :  :     :- Project [r_regionkey_prf#1839 AS r_regionkey_prf_0#1843, r_name_prf#1840 AS r_name_prf_0#1844, r_comment_prf#1841 AS r_comment_prf_0#1845, rid#1842 AS rid_0#1846]
         :  :  :  :  :     :  +- Relation[r_regionkey_prf#1839,r_name_prf#1840,r_comment_prf#1841,rid#1842] JDBCRelation(region_prf) [numPartitions=1]
         :  :  :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [rid#1848 AS rid_1#1853, n_regionkey_prf#1849 AS n_regionkey_prf_1#1854, n_nationkey_prf#1850 AS n_nationkey_prf_1#1855, n_name_prf#1851 AS n_name_prf_1#1856, n_comment_prf#1852 AS n_comment_prf_1#1857]
         :  :  :  :     +- Relation[rid#1848,n_regionkey_prf#1849,n_nationkey_prf#1850,n_name_prf#1851,n_comment_prf#1852] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#436) AS rid_2#1864]
         :  :  :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :  :  :        :- 'Project ['rid AS rid_1#1863]
         :  :  :        :  +- Relation[rid#1858,n_regionkey_prf#1859,n_nationkey_prf#1860,n_name_prf#1861,n_comment_prf#1862] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#1865 AS c_acctbal_prf_2#1874, rid#1866 AS rid_2#1875, c_name_prf#1867 AS c_name_prf_2#1876, c_nationkey_prf#1868 AS c_nationkey_prf_2#1877, c_custkey_prf#1869 AS c_custkey_prf_2#1878, c_comment_prf#1870 AS c_comment_prf_2#1879, c_address_prf#1871 AS c_address_prf_2#1880, c_mktsegment_prf#1872 AS c_mktsegment_prf_2#1881, c_phone_prf#1873 AS c_phone_prf_2#1882]
         :  :     +- Relation[c_acctbal_prf#1865,rid#1866,c_name_prf#1867,c_nationkey_prf#1868,c_custkey_prf#1869,c_comment_prf#1870,c_address_prf#1871,c_mktsegment_prf#1872,c_phone_prf#1873] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#436) AS rid_3#1889]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#1888]
         :        :  +- Relation[rid#1883,n_regionkey_prf#1884,n_nationkey_prf#1885,n_name_prf#1886,n_comment_prf#1887] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#1890 AS s_phone_prf_3#1898, rid#1891 AS rid_3#1899, s_address_prf#1892 AS s_address_prf_3#1900, s_nationkey_prf#1893 AS s_nationkey_prf_3#1901, s_suppkey_prf#1894 AS s_suppkey_prf_3#1902, s_name_prf#1895 AS s_name_prf_3#1903, s_acctbal_prf#1896 AS s_acctbal_prf_3#1904, s_comment_prf#1897 AS s_comment_prf_3#1905]
            +- Relation[s_phone_prf#1890,rid#1891,s_address_prf#1892,s_nationkey_prf#1893,s_suppkey_prf#1894,s_name_prf#1895,s_acctbal_prf#1896,s_comment_prf#1897] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 34969ms

q5b2=

select
  n_name
from
  customer, supplier, nation, region
where
  r_regionkey = n_regionkey
  and c_nationkey = s_nationkey
  and n_nationkey = c_nationkey
  and n_nationkey = s_nationkey
      
19/10/15 16:29:09 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:29:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1986L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :- Project [s_nationkey#21L]
         :  +- Filter isnotnull(s_nationkey#21L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (n_regionkey#110L = r_regionkey#116L)
               :- Project [n_nationkey#108L, n_regionkey#110L]
               :  +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
               :     :- Project [c_nationkey#293L]
               :     :  +- Filter isnotnull(c_nationkey#293L)
               :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               :     +- Project [n_nationkey#108L, n_regionkey#110L]
               :        +- Filter (isnotnull(n_nationkey#108L) && isnotnull(n_regionkey#110L))
               :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [r_regionkey#116L]
                  +- Filter isnotnull(r_regionkey#116L)
                     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/15 16:29:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1986L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#436) AS rid_2#2004]
         :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#1997: string
         :     :- Project [s_phone_prf#1988 AS s_phone_prf_0#1996, rid#1989 AS rid_0#1997, s_address_prf#1990 AS s_address_prf_0#1998, s_nationkey_prf#1991 AS s_nationkey_prf_0#1999, s_suppkey_prf#1992 AS s_suppkey_prf_0#2000, s_name_prf#1993 AS s_name_prf_0#2001, s_acctbal_prf#1994 AS s_acctbal_prf_0#2002, s_comment_prf#1995 AS s_comment_prf_0#2003]
         :     :  +- Relation[s_phone_prf#1988,rid#1989,s_address_prf#1990,s_nationkey_prf#1991,s_suppkey_prf#1992,s_name_prf#1993,s_acctbal_prf#1994,s_comment_prf#1995] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join NaturalJoin(Inner)
            :  :  :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#436) AS rid_2#2023]
            :  :  :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_1#2015: string
            :  :  :     :- Project [c_acctbal_prf#2005 AS c_acctbal_prf_1#2014, rid#2006 AS rid_1#2015, c_name_prf#2007 AS c_name_prf_1#2016, c_nationkey_prf#2008 AS c_nationkey_prf_1#2017, c_custkey_prf#2009 AS c_custkey_prf_1#2018, c_comment_prf#2010 AS c_comment_prf_1#2019, c_address_prf#2011 AS c_address_prf_1#2020, c_mktsegment_prf#2012 AS c_mktsegment_prf_1#2021, c_phone_prf#2013 AS c_phone_prf_1#2022]
            :  :  :     :  +- Relation[c_acctbal_prf#2005,rid#2006,c_name_prf#2007,c_nationkey_prf#2008,c_custkey_prf#2009,c_comment_prf#2010,c_address_prf#2011,c_mktsegment_prf#2012,c_phone_prf#2013] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
            :  :  +- Project [rid#2024 AS rid_2#2029, n_regionkey_prf#2025 AS n_regionkey_prf_2#2030, n_nationkey_prf#2026 AS n_nationkey_prf_2#2031, n_name_prf#2027 AS n_name_prf_2#2032, n_comment_prf#2028 AS n_comment_prf_2#2033]
            :  :     +- Relation[rid#2024,n_regionkey_prf#2025,n_nationkey_prf#2026,n_name_prf#2027,n_comment_prf#2028] JDBCRelation(nation_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#436) AS rid_3#2040]
            :     +- 'DexRidCorrelatedJoin nation~n_regionkey~region~r_regionkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#2039]
            :        :  +- Relation[rid#2034,n_regionkey_prf#2035,n_nationkey_prf#2036,n_name_prf#2037,n_comment_prf#2038] JDBCRelation(nation_prf) [numPartitions=1]
            :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [r_regionkey_prf#2041 AS r_regionkey_prf_3#2045, r_name_prf#2042 AS r_name_prf_3#2046, r_comment_prf#2043 AS r_comment_prf_3#2047, rid#2044 AS rid_3#2048]
               +- Relation[r_regionkey_prf#2041,r_name_prf#2042,r_comment_prf#2043,rid#2044] JDBCRelation(region_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 56071ms

Q7

q7a=

select
  n1.n_name as n1_name,
  n2.n_name as n2_name,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    (n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY')
  )
      
19/10/15 16:30:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:30:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2272L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#2207L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L, c_nationkey#293L]
         :     :  +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_custkey#343L]
         :        +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :           :- Project [o_orderkey#342L, o_custkey#343L]
         :           :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :           +- Project [l_orderkey#306L]
         :              +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :                 :- Project [s_nationkey#21L, l_orderkey#306L]
         :                 :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :                 :     :- Project [s_suppkey#18L, s_nationkey#21L]
         :                 :     :  +- Filter (isnotnull(s_suppkey#18L) && isnotnull(s_nationkey#21L))
         :                 :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :                 :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :                 :        +- Filter (isnotnull(l_suppkey#308L) && isnotnull(l_orderkey#306L))
         :                 :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :                 +- Project [n_nationkey#108L]
         :                    +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :                       +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [n_nationkey#2207L]
            +- Filter ((isnotnull(n_name#2208) && (n_name#2208 = GERMANY)) && isnotnull(n_nationkey#2207L))
               +- Relation[n_nationkey#2207L,n_name#2208,n_regionkey#2209L,n_comment#2210] parquet

19/10/15 16:30:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2272L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#436) AS rid_1#2292]
         :  :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2284: string
         :  :  :     :- Project [c_acctbal_prf#2274 AS c_acctbal_prf_0#2283, rid#2275 AS rid_0#2284, c_name_prf#2276 AS c_name_prf_0#2285, c_nationkey_prf#2277 AS c_nationkey_prf_0#2286, c_custkey_prf#2278 AS c_custkey_prf_0#2287, c_comment_prf#2279 AS c_comment_prf_0#2288, c_address_prf#2280 AS c_address_prf_0#2289, c_mktsegment_prf#2281 AS c_mktsegment_prf_0#2290, c_phone_prf#2282 AS c_phone_prf_0#2291]
         :  :  :     :  +- Relation[c_acctbal_prf#2274,rid#2275,c_name_prf#2276,c_nationkey_prf#2277,c_custkey_prf#2278,c_comment_prf#2279,c_address_prf#2280,c_mktsegment_prf#2281,c_phone_prf#2282] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- 'Join NaturalJoin(Inner)
         :  :     :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#436) AS rid_3#2313]
         :  :     :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#2304: string
         :  :     :     :- Project [o_shippriority_prf#2293 AS o_shippriority_prf_1#2303, rid#2294 AS rid_1#2304, o_orderdate_prf#2295 AS o_orderdate_prf_1#2305, o_custkey_prf#2296 AS o_custkey_prf_1#2306, o_orderpriority_prf#2297 AS o_orderpriority_prf_1#2307, o_clerk_prf#2298 AS o_clerk_prf_1#2308, o_orderstatus_prf#2299 AS o_orderstatus_prf_1#2309, o_totalprice_prf#2300 AS o_totalprice_prf_1#2310, o_orderkey_prf#2301 AS o_orderkey_prf_1#2311, o_comment_prf#2302 AS o_comment_prf_1#2312]
         :  :     :     :  +- Relation[o_shippriority_prf#2293,rid#2294,o_orderdate_prf#2295,o_custkey_prf#2296,o_orderpriority_prf#2297,o_clerk_prf#2298,o_orderstatus_prf#2299,o_totalprice_prf#2300,o_orderkey_prf#2301,o_comment_prf#2302] JDBCRelation(orders_prf) [numPartitions=1]
         :  :     :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :     +- 'Join NaturalJoin(Inner)
         :  :        :- 'Join UsingJoin(Inner,List(rid_2))
         :  :        :  :- 'Join NaturalJoin(Inner)
         :  :        :  :  :- 'Project ['s_phone_prf_2, 'rid_2, 's_address_prf_2, 's_nationkey_prf_2, 's_suppkey_prf_2, 's_name_prf_2, 's_acctbal_prf_2, 's_comment_prf_2, dexdecrypt('value_dec_key, value#436) AS rid_3#2330]
         :  :        :  :  :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_2#2323: string
         :  :        :  :  :     :- Project [s_phone_prf#2314 AS s_phone_prf_2#2322, rid#2315 AS rid_2#2323, s_address_prf#2316 AS s_address_prf_2#2324, s_nationkey_prf#2317 AS s_nationkey_prf_2#2325, s_suppkey_prf#2318 AS s_suppkey_prf_2#2326, s_name_prf#2319 AS s_name_prf_2#2327, s_acctbal_prf#2320 AS s_acctbal_prf_2#2328, s_comment_prf#2321 AS s_comment_prf_2#2329]
         :  :        :  :  :     :  +- Relation[s_phone_prf#2314,rid#2315,s_address_prf#2316,s_nationkey_prf#2317,s_suppkey_prf#2318,s_name_prf#2319,s_acctbal_prf#2320,s_comment_prf#2321] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :        :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :        :  :  +- Project [l_returnflag_prf#2331 AS l_returnflag_prf_3#2350, l_orderkey_and_l_linenumber_prf#2332 AS l_orderkey_and_l_linenumber_prf_3#2351, l_comment_prf#2333 AS l_comment_prf_3#2352, l_linestatus_prf#2334 AS l_linestatus_prf_3#2353, rid#2335 AS rid_3#2354, l_shipmode_prf#2336 AS l_shipmode_prf_3#2355, l_shipinstruct_prf#2337 AS l_shipinstruct_prf_3#2356, l_quantity_prf#2338 AS l_quantity_prf_3#2357, l_receiptdate_prf#2339 AS l_receiptdate_prf_3#2358, l_linenumber_prf#2340 AS l_linenumber_prf_3#2359, l_tax_prf#2341 AS l_tax_prf_3#2360, l_shipdate_prf#2342 AS l_shipdate_prf_3#2361, l_extendedprice_prf#2343 AS l_extendedprice_prf_3#2362, l_partkey_prf#2344 AS l_partkey_prf_3#2363, l_discount_prf#2345 AS l_discount_prf_3#2364, l_partkey_and_l_suppkey_prf#2346 AS l_partkey_and_l_suppkey_prf_3#2365, l_commitdate_prf#2347 AS l_commitdate_prf_3#2366, l_suppkey_prf#2348 AS l_suppkey_prf_3#2367, l_orderkey_prf#2349 AS l_orderkey_prf_3#2368]
         :  :        :  :     +- Relation[l_returnflag_prf#2331,l_orderkey_and_l_linenumber_prf#2332,l_comment_prf#2333,l_linestatus_prf#2334,rid#2335,l_shipmode_prf#2336,l_shipinstruct_prf#2337,l_quantity_prf#2338,l_receiptdate_prf#2339,l_linenumber_prf#2340,l_tax_prf#2341,l_shipdate_prf#2342,l_extendedprice_prf#2343,l_partkey_prf#2344,l_discount_prf#2345,l_partkey_and_l_suppkey_prf#2346,l_commitdate_prf#2347,l_suppkey_prf#2348,l_orderkey_prf#2349] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :        :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#436) AS rid_4#2378]
         :  :        :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_2
         :  :        :        :- 'Project ['rid AS rid_2#2377]
         :  :        :        :  +- Relation[s_phone_prf#2369,rid#2370,s_address_prf#2371,s_nationkey_prf#2372,s_suppkey_prf#2373,s_name_prf#2374,s_acctbal_prf#2375,s_comment_prf#2376] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :        :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :        +- 'Join UsingJoin(LeftSemi,List(rid_4))
         :  :           :- Project [rid#2379 AS rid_4#2384, n_regionkey_prf#2380 AS n_regionkey_prf_4#2385, n_nationkey_prf#2381 AS n_nationkey_prf_4#2386, n_name_prf#2382 AS n_name_prf_4#2387, n_comment_prf#2383 AS n_comment_prf_4#2388]
         :  :           :  +- Relation[rid#2379,n_regionkey_prf#2380,n_nationkey_prf#2381,n_name_prf#2382,n_comment_prf#2383] JDBCRelation(nation_prf) [numPartitions=1]
         :  :           +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_4#2389]
         :  :              +- DexRidFilter nation~n_name~FRANCE
         :  :                 +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#436) AS rid_5#2400]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2399]
         :        :  +- Relation[c_acctbal_prf#2390,rid#2391,c_name_prf#2392,c_nationkey_prf#2393,c_custkey_prf#2394,c_comment_prf#2395,c_address_prf#2396,c_mktsegment_prf#2397,c_phone_prf#2398] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_5))
            :- Project [rid#2401 AS rid_5#2406, n_regionkey_prf#2402 AS n_regionkey_prf_5#2407, n_nationkey_prf#2403 AS n_nationkey_prf_5#2408, n_name_prf#2404 AS n_name_prf_5#2409, n_comment_prf#2405 AS n_comment_prf_5#2410]
            :  +- Relation[rid#2401,n_regionkey_prf#2402,n_nationkey_prf#2403,n_name_prf#2404,n_comment_prf#2405] JDBCRelation(nation_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_5#2411]
               +- DexRidFilter nation~n_name~GERMANY
                  +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=9735
Elapsed time: 332896ms

q7b=

select
  n1.n_name as n1_name,
  n2.n_name as n2_name,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    (n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY')
  )
      
19/10/15 16:35:38 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:35:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2653L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#2588L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Filter (isnotnull(s_nationkey#21L) && isnotnull(s_suppkey#18L))
         :     :     :     :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :        +- Filter (isnotnull(l_suppkey#308L) && isnotnull(l_orderkey#306L))
         :     :     :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#2588L]
            +- Filter ((isnotnull(n_name#2589) && (n_name#2589 = GERMANY)) && isnotnull(n_nationkey#2588L))
               +- Relation[n_nationkey#2588L,n_name#2589,n_regionkey#2590L,n_comment#2591] parquet

19/10/15 16:35:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2653L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_4))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :  :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#436) AS rid_1#2666]
         :  :  :  :  :  :  :  :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#2660: string
         :  :  :  :  :  :  :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :  :  :     :  :- Project [rid#2655 AS rid_0#2660, n_regionkey_prf#2656 AS n_regionkey_prf_0#2661, n_nationkey_prf#2657 AS n_nationkey_prf_0#2662, n_name_prf#2658 AS n_name_prf_0#2663, n_comment_prf#2659 AS n_comment_prf_0#2664]
         :  :  :  :  :  :  :  :  :     :  :  +- Relation[rid#2655,n_regionkey_prf#2656,n_nationkey_prf#2657,n_name_prf#2658,n_comment_prf#2659] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  :  :  :  :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2665]
         :  :  :  :  :  :  :  :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :  :  :  :  :  :  :  :  :     :        +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :  :  :  :  :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  :  :  +- Project [s_phone_prf#2667 AS s_phone_prf_1#2675, rid#2668 AS rid_1#2676, s_address_prf#2669 AS s_address_prf_1#2677, s_nationkey_prf#2670 AS s_nationkey_prf_1#2678, s_suppkey_prf#2671 AS s_suppkey_prf_1#2679, s_name_prf#2672 AS s_name_prf_1#2680, s_acctbal_prf#2673 AS s_acctbal_prf_1#2681, s_comment_prf#2674 AS s_comment_prf_1#2682]
         :  :  :  :  :  :  :  :     +- Relation[s_phone_prf#2667,rid#2668,s_address_prf#2669,s_nationkey_prf#2670,s_suppkey_prf#2671,s_name_prf#2672,s_acctbal_prf#2673,s_comment_prf#2674] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  :  :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#436) AS rid_2#2692]
         :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_1
         :  :  :  :  :  :  :        :- 'Project ['rid AS rid_1#2691]
         :  :  :  :  :  :  :        :  +- Relation[s_phone_prf#2683,rid#2684,s_address_prf#2685,s_nationkey_prf#2686,s_suppkey_prf#2687,s_name_prf#2688,s_acctbal_prf#2689,s_comment_prf#2690] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  :  :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  +- Project [l_returnflag_prf#2693 AS l_returnflag_prf_2#2712, l_orderkey_and_l_linenumber_prf#2694 AS l_orderkey_and_l_linenumber_prf_2#2713, l_comment_prf#2695 AS l_comment_prf_2#2714, l_linestatus_prf#2696 AS l_linestatus_prf_2#2715, rid#2697 AS rid_2#2716, l_shipmode_prf#2698 AS l_shipmode_prf_2#2717, l_shipinstruct_prf#2699 AS l_shipinstruct_prf_2#2718, l_quantity_prf#2700 AS l_quantity_prf_2#2719, l_receiptdate_prf#2701 AS l_receiptdate_prf_2#2720, l_linenumber_prf#2702 AS l_linenumber_prf_2#2721, l_tax_prf#2703 AS l_tax_prf_2#2722, l_shipdate_prf#2704 AS l_shipdate_prf_2#2723, l_extendedprice_prf#2705 AS l_extendedprice_prf_2#2724, l_partkey_prf#2706 AS l_partkey_prf_2#2725, l_discount_prf#2707 AS l_discount_prf_2#2726, l_partkey_and_l_suppkey_prf#2708 AS l_partkey_and_l_suppkey_prf_2#2727, l_commitdate_prf#2709 AS l_commitdate_prf_2#2728, l_suppkey_prf#2710 AS l_suppkey_prf_2#2729, l_orderkey_prf#2711 AS l_orderkey_prf_2#2730]
         :  :  :  :  :  :     +- Relation[l_returnflag_prf#2693,l_orderkey_and_l_linenumber_prf#2694,l_comment_prf#2695,l_linestatus_prf#2696,rid#2697,l_shipmode_prf#2698,l_shipinstruct_prf#2699,l_quantity_prf#2700,l_receiptdate_prf#2701,l_linenumber_prf#2702,l_tax_prf#2703,l_shipdate_prf#2704,l_extendedprice_prf#2705,l_partkey_prf#2706,l_discount_prf#2707,l_partkey_and_l_suppkey_prf#2708,l_commitdate_prf#2709,l_suppkey_prf#2710,l_orderkey_prf#2711] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#436) AS rid_3#2751]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_2
         :  :  :  :  :        :- 'Project ['rid AS rid_2#2750]
         :  :  :  :  :        :  +- Relation[l_returnflag_prf#2731,l_orderkey_and_l_linenumber_prf#2732,l_comment_prf#2733,l_linestatus_prf#2734,rid#2735,l_shipmode_prf#2736,l_shipinstruct_prf#2737,l_quantity_prf#2738,l_receiptdate_prf#2739,l_linenumber_prf#2740,l_tax_prf#2741,l_shipdate_prf#2742,l_extendedprice_prf#2743,l_partkey_prf#2744,l_discount_prf#2745,l_partkey_and_l_suppkey_prf#2746,l_commitdate_prf#2747,l_suppkey_prf#2748,l_orderkey_prf#2749] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [o_shippriority_prf#2752 AS o_shippriority_prf_3#2762, rid#2753 AS rid_3#2763, o_orderdate_prf#2754 AS o_orderdate_prf_3#2764, o_custkey_prf#2755 AS o_custkey_prf_3#2765, o_orderpriority_prf#2756 AS o_orderpriority_prf_3#2766, o_clerk_prf#2757 AS o_clerk_prf_3#2767, o_orderstatus_prf#2758 AS o_orderstatus_prf_3#2768, o_totalprice_prf#2759 AS o_totalprice_prf_3#2769, o_orderkey_prf#2760 AS o_orderkey_prf_3#2770, o_comment_prf#2761 AS o_comment_prf_3#2771]
         :  :  :  :     +- Relation[o_shippriority_prf#2752,rid#2753,o_orderdate_prf#2754,o_custkey_prf#2755,o_orderpriority_prf#2756,o_clerk_prf#2757,o_orderstatus_prf#2758,o_totalprice_prf#2759,o_orderkey_prf#2760,o_comment_prf#2761] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_3, dexdecrypt('value_dec_key, value#436) AS rid_4#2783]
         :  :  :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_3
         :  :  :        :- 'Project ['rid AS rid_3#2782]
         :  :  :        :  +- Relation[o_shippriority_prf#2772,rid#2773,o_orderdate_prf#2774,o_custkey_prf#2775,o_orderpriority_prf#2776,o_clerk_prf#2777,o_orderstatus_prf#2778,o_totalprice_prf#2779,o_orderkey_prf#2780,o_comment_prf#2781] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#2784 AS c_acctbal_prf_4#2793, rid#2785 AS rid_4#2794, c_name_prf#2786 AS c_name_prf_4#2795, c_nationkey_prf#2787 AS c_nationkey_prf_4#2796, c_custkey_prf#2788 AS c_custkey_prf_4#2797, c_comment_prf#2789 AS c_comment_prf_4#2798, c_address_prf#2790 AS c_address_prf_4#2799, c_mktsegment_prf#2791 AS c_mktsegment_prf_4#2800, c_phone_prf#2792 AS c_phone_prf_4#2801]
         :  :     +- Relation[c_acctbal_prf#2784,rid#2785,c_name_prf#2786,c_nationkey_prf#2787,c_custkey_prf#2788,c_comment_prf#2789,c_address_prf#2790,c_mktsegment_prf#2791,c_phone_prf#2792] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_4, dexdecrypt('value_dec_key, value#436) AS rid_5#2812]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_4
         :        :- 'Project ['rid AS rid_4#2811]
         :        :  +- Relation[c_acctbal_prf#2802,rid#2803,c_name_prf#2804,c_nationkey_prf#2805,c_custkey_prf#2806,c_comment_prf#2807,c_address_prf#2808,c_mktsegment_prf#2809,c_phone_prf#2810] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_5))
            :- Project [rid#2813 AS rid_5#2818, n_regionkey_prf#2814 AS n_regionkey_prf_5#2819, n_nationkey_prf#2815 AS n_nationkey_prf_5#2820, n_name_prf#2816 AS n_name_prf_5#2821, n_comment_prf#2817 AS n_comment_prf_5#2822]
            :  +- Relation[rid#2813,n_regionkey_prf#2814,n_nationkey_prf#2815,n_name_prf#2816,n_comment_prf#2817] JDBCRelation(nation_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_5#2823]
               +- DexRidFilter nation~n_name~GERMANY
                  +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=9735
Elapsed time: 155536ms

q7c=

select
  n1.n_name as n1_name,
  n2.n_name as n2_name,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    (n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY')
  )
      
19/10/15 16:38:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:38:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3061L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_nationkey#21L = n_nationkey#2996L)
         :- Project [s_nationkey#21L]
         :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :- Project [l_suppkey#308L]
         :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :     :- Project [o_orderkey#342L]
         :     :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :     :- Project [c_custkey#290L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = GERMANY)) && isnotnull(n_nationkey#108L))
         :     :     :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :     :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :     :     :     :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :     :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :     :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :     :        +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_suppkey#308L))
         :     :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Filter (isnotnull(s_suppkey#18L) && isnotnull(s_nationkey#21L))
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [n_nationkey#2996L]
            +- Filter ((isnotnull(n_name#2997) && (n_name#2997 = FRANCE)) && isnotnull(n_nationkey#2996L))
               +- Relation[n_nationkey#2996L,n_name#2997,n_regionkey#2998L,n_comment#2999] parquet

19/10/15 16:38:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3061L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_4))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :  :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#436) AS rid_1#3074]
         :  :  :  :  :  :  :  :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#3068: string
         :  :  :  :  :  :  :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :  :  :     :  :- Project [rid#3063 AS rid_0#3068, n_regionkey_prf#3064 AS n_regionkey_prf_0#3069, n_nationkey_prf#3065 AS n_nationkey_prf_0#3070, n_name_prf#3066 AS n_name_prf_0#3071, n_comment_prf#3067 AS n_comment_prf_0#3072]
         :  :  :  :  :  :  :  :  :     :  :  +- Relation[rid#3063,n_regionkey_prf#3064,n_nationkey_prf#3065,n_name_prf#3066,n_comment_prf#3067] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  :  :  :  :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3073]
         :  :  :  :  :  :  :  :  :     :     +- DexRidFilter nation~n_name~GERMANY
         :  :  :  :  :  :  :  :  :     :        +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :  :  :  :  :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  :  :  +- Project [c_acctbal_prf#3075 AS c_acctbal_prf_1#3084, rid#3076 AS rid_1#3085, c_name_prf#3077 AS c_name_prf_1#3086, c_nationkey_prf#3078 AS c_nationkey_prf_1#3087, c_custkey_prf#3079 AS c_custkey_prf_1#3088, c_comment_prf#3080 AS c_comment_prf_1#3089, c_address_prf#3081 AS c_address_prf_1#3090, c_mktsegment_prf#3082 AS c_mktsegment_prf_1#3091, c_phone_prf#3083 AS c_phone_prf_1#3092]
         :  :  :  :  :  :  :  :     +- Relation[c_acctbal_prf#3075,rid#3076,c_name_prf#3077,c_nationkey_prf#3078,c_custkey_prf#3079,c_comment_prf#3080,c_address_prf#3081,c_mktsegment_prf#3082,c_phone_prf#3083] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  :  :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#436) AS rid_2#3103]
         :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :  :  :  :  :  :  :        :- 'Project ['rid AS rid_1#3102]
         :  :  :  :  :  :  :        :  +- Relation[c_acctbal_prf#3093,rid#3094,c_name_prf#3095,c_nationkey_prf#3096,c_custkey_prf#3097,c_comment_prf#3098,c_address_prf#3099,c_mktsegment_prf#3100,c_phone_prf#3101] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  :  :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  +- Project [o_shippriority_prf#3104 AS o_shippriority_prf_2#3114, rid#3105 AS rid_2#3115, o_orderdate_prf#3106 AS o_orderdate_prf_2#3116, o_custkey_prf#3107 AS o_custkey_prf_2#3117, o_orderpriority_prf#3108 AS o_orderpriority_prf_2#3118, o_clerk_prf#3109 AS o_clerk_prf_2#3119, o_orderstatus_prf#3110 AS o_orderstatus_prf_2#3120, o_totalprice_prf#3111 AS o_totalprice_prf_2#3121, o_orderkey_prf#3112 AS o_orderkey_prf_2#3122, o_comment_prf#3113 AS o_comment_prf_2#3123]
         :  :  :  :  :  :     +- Relation[o_shippriority_prf#3104,rid#3105,o_orderdate_prf#3106,o_custkey_prf#3107,o_orderpriority_prf#3108,o_clerk_prf#3109,o_orderstatus_prf#3110,o_totalprice_prf#3111,o_orderkey_prf#3112,o_comment_prf#3113] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#436) AS rid_3#3135]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
         :  :  :  :  :        :- 'Project ['rid AS rid_2#3134]
         :  :  :  :  :        :  +- Relation[o_shippriority_prf#3124,rid#3125,o_orderdate_prf#3126,o_custkey_prf#3127,o_orderpriority_prf#3128,o_clerk_prf#3129,o_orderstatus_prf#3130,o_totalprice_prf#3131,o_orderkey_prf#3132,o_comment_prf#3133] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [l_returnflag_prf#3136 AS l_returnflag_prf_3#3155, l_orderkey_and_l_linenumber_prf#3137 AS l_orderkey_and_l_linenumber_prf_3#3156, l_comment_prf#3138 AS l_comment_prf_3#3157, l_linestatus_prf#3139 AS l_linestatus_prf_3#3158, rid#3140 AS rid_3#3159, l_shipmode_prf#3141 AS l_shipmode_prf_3#3160, l_shipinstruct_prf#3142 AS l_shipinstruct_prf_3#3161, l_quantity_prf#3143 AS l_quantity_prf_3#3162, l_receiptdate_prf#3144 AS l_receiptdate_prf_3#3163, l_linenumber_prf#3145 AS l_linenumber_prf_3#3164, l_tax_prf#3146 AS l_tax_prf_3#3165, l_shipdate_prf#3147 AS l_shipdate_prf_3#3166, l_extendedprice_prf#3148 AS l_extendedprice_prf_3#3167, l_partkey_prf#3149 AS l_partkey_prf_3#3168, l_discount_prf#3150 AS l_discount_prf_3#3169, l_partkey_and_l_suppkey_prf#3151 AS l_partkey_and_l_suppkey_prf_3#3170, l_commitdate_prf#3152 AS l_commitdate_prf_3#3171, l_suppkey_prf#3153 AS l_suppkey_prf_3#3172, l_orderkey_prf#3154 AS l_orderkey_prf_3#3173]
         :  :  :  :     +- Relation[l_returnflag_prf#3136,l_orderkey_and_l_linenumber_prf#3137,l_comment_prf#3138,l_linestatus_prf#3139,rid#3140,l_shipmode_prf#3141,l_shipinstruct_prf#3142,l_quantity_prf#3143,l_receiptdate_prf#3144,l_linenumber_prf#3145,l_tax_prf#3146,l_shipdate_prf#3147,l_extendedprice_prf#3148,l_partkey_prf#3149,l_discount_prf#3150,l_partkey_and_l_suppkey_prf#3151,l_commitdate_prf#3152,l_suppkey_prf#3153,l_orderkey_prf#3154] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_3, dexdecrypt('value_dec_key, value#436) AS rid_4#3194]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_3
         :  :  :        :- 'Project ['rid AS rid_3#3193]
         :  :  :        :  +- Relation[l_returnflag_prf#3174,l_orderkey_and_l_linenumber_prf#3175,l_comment_prf#3176,l_linestatus_prf#3177,rid#3178,l_shipmode_prf#3179,l_shipinstruct_prf#3180,l_quantity_prf#3181,l_receiptdate_prf#3182,l_linenumber_prf#3183,l_tax_prf#3184,l_shipdate_prf#3185,l_extendedprice_prf#3186,l_partkey_prf#3187,l_discount_prf#3188,l_partkey_and_l_suppkey_prf#3189,l_commitdate_prf#3190,l_suppkey_prf#3191,l_orderkey_prf#3192] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#3195 AS s_phone_prf_4#3203, rid#3196 AS rid_4#3204, s_address_prf#3197 AS s_address_prf_4#3205, s_nationkey_prf#3198 AS s_nationkey_prf_4#3206, s_suppkey_prf#3199 AS s_suppkey_prf_4#3207, s_name_prf#3200 AS s_name_prf_4#3208, s_acctbal_prf#3201 AS s_acctbal_prf_4#3209, s_comment_prf#3202 AS s_comment_prf_4#3210]
         :  :     +- Relation[s_phone_prf#3195,rid#3196,s_address_prf#3197,s_nationkey_prf#3198,s_suppkey_prf#3199,s_name_prf#3200,s_acctbal_prf#3201,s_comment_prf#3202] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_4, dexdecrypt('value_dec_key, value#436) AS rid_5#3220]
         :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_4
         :        :- 'Project ['rid AS rid_4#3219]
         :        :  +- Relation[s_phone_prf#3211,rid#3212,s_address_prf#3213,s_nationkey_prf#3214,s_suppkey_prf#3215,s_name_prf#3216,s_acctbal_prf#3217,s_comment_prf#3218] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_5))
            :- Project [rid#3221 AS rid_5#3226, n_regionkey_prf#3222 AS n_regionkey_prf_5#3227, n_nationkey_prf#3223 AS n_nationkey_prf_5#3228, n_name_prf#3224 AS n_name_prf_5#3229, n_comment_prf#3225 AS n_comment_prf_5#3230]
            :  +- Relation[rid#3221,n_regionkey_prf#3222,n_nationkey_prf#3223,n_name_prf#3224,n_comment_prf#3225] JDBCRelation(nation_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_5#3231]
               +- DexRidFilter nation~n_name~FRANCE
                  +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=9735
Elapsed time: 275208ms

Q8

q8a=

select
  o_orderdate,
  l_extendedprice,
  l_discount,
  n2.n_name
from
  part,
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2,
  region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey
  and n1.n_regionkey = r_regionkey
  and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
      
19/10/15 16:42:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:42:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3615L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_nationkey#21L = n_nationkey#3542L)
         :- Project [s_nationkey#21L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L, s_nationkey#21L]
         :     :  +- Filter (isnotnull(s_suppkey#18L) && isnotnull(s_nationkey#21L))
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_suppkey#308L]
         :        +- Join Inner, (n_regionkey#110L = r_regionkey#116L)
         :           :- Project [l_suppkey#308L, n_regionkey#110L]
         :           :  +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :           :     :- Project [l_suppkey#308L, c_nationkey#293L]
         :           :     :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :           :     :     :- Project [l_suppkey#308L, o_custkey#343L]
         :           :     :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :           :     :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :           :     :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :           :     :     :     :     :- Project [p_partkey#360L]
         :           :     :     :     :     :  +- Filter ((isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL)) && isnotnull(p_partkey#360L))
         :           :     :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :           :     :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :           :     :     :     :        +- Filter ((isnotnull(l_partkey#307L) && isnotnull(l_orderkey#306L)) && isnotnull(l_suppkey#308L))
         :           :     :     :     :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :           :     :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :           :     :     :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           :     :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :           :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :           :     :        +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
         :           :     :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :           :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :           :        +- Filter (isnotnull(n_nationkey#108L) && isnotnull(n_regionkey#110L))
         :           :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :           +- Project [r_regionkey#116L]
         :              +- Filter ((isnotnull(r_name#117) && (r_name#117 = AMERICA)) && isnotnull(r_regionkey#116L))
         :                 +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_nationkey#3542L]
            +- Filter isnotnull(n_nationkey#3542L)
               +- Relation[n_nationkey#3542L,n_name#3543,n_regionkey#3544L,n_comment#3545] parquet

19/10/15 16:42:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3615L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#436) AS rid_2#3633]
         :  :  :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#3626: string
         :  :  :     :- Project [s_phone_prf#3617 AS s_phone_prf_0#3625, rid#3618 AS rid_0#3626, s_address_prf#3619 AS s_address_prf_0#3627, s_nationkey_prf#3620 AS s_nationkey_prf_0#3628, s_suppkey_prf#3621 AS s_suppkey_prf_0#3629, s_name_prf#3622 AS s_name_prf_0#3630, s_acctbal_prf#3623 AS s_acctbal_prf_0#3631, s_comment_prf#3624 AS s_comment_prf_0#3632]
         :  :  :     :  +- Relation[s_phone_prf#3617,rid#3618,s_address_prf#3619,s_nationkey_prf#3620,s_suppkey_prf#3621,s_name_prf#3622,s_acctbal_prf#3623,s_comment_prf#3624] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- 'Join NaturalJoin(Inner)
         :  :     :- 'Join UsingJoin(Inner,List(rid_5))
         :  :     :  :- 'Join NaturalJoin(Inner)
         :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_4))
         :  :     :  :  :  :- 'Join NaturalJoin(Inner)
         :  :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :  :     :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :     :  :  :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :     :  :  :  :  :  :  :  :  :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#436) AS rid_2#3655]
         :  :     :  :  :  :  :  :  :  :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#3646: string
         :  :     :  :  :  :  :  :  :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :     :  :  :  :  :  :  :  :  :     :  :- Project [p_comment_prf#3634 AS p_comment_prf_1#3644, p_name_prf#3635 AS p_name_prf_1#3645, rid#3636 AS rid_1#3646, p_type_prf#3637 AS p_type_prf_1#3647, p_retailprice_prf#3638 AS p_retailprice_prf_1#3648, p_mfgr_prf#3639 AS p_mfgr_prf_1#3649, p_container_prf#3640 AS p_container_prf_1#3650, p_brand_prf#3641 AS p_brand_prf_1#3651, p_size_prf#3642 AS p_size_prf_1#3652, p_partkey_prf#3643 AS p_partkey_prf_1#3653]
         :  :     :  :  :  :  :  :  :  :  :     :  :  +- Relation[p_comment_prf#3634,p_name_prf#3635,rid#3636,p_type_prf#3637,p_retailprice_prf#3638,p_mfgr_prf#3639,p_container_prf#3640,p_brand_prf#3641,p_size_prf#3642,p_partkey_prf#3643] JDBCRelation(part_prf) [numPartitions=1]
         :  :     :  :  :  :  :  :  :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3654]
         :  :     :  :  :  :  :  :  :  :  :     :     +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
         :  :     :  :  :  :  :  :  :  :  :     :        +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]
         :  :     :  :  :  :  :  :  :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :     :  :  :  :  :  :  :  :  +- Project [l_returnflag_prf#3656 AS l_returnflag_prf_2#3675, l_orderkey_and_l_linenumber_prf#3657 AS l_orderkey_and_l_linenumber_prf_2#3676, l_comment_prf#3658 AS l_comment_prf_2#3677, l_linestatus_prf#3659 AS l_linestatus_prf_2#3678, rid#3660 AS rid_2#3679, l_shipmode_prf#3661 AS l_shipmode_prf_2#3680, l_shipinstruct_prf#3662 AS l_shipinstruct_prf_2#3681, l_quantity_prf#3663 AS l_quantity_prf_2#3682, l_receiptdate_prf#3664 AS l_receiptdate_prf_2#3683, l_linenumber_prf#3665 AS l_linenumber_prf_2#3684, l_tax_prf#3666 AS l_tax_prf_2#3685, l_shipdate_prf#3667 AS l_shipdate_prf_2#3686, l_extendedprice_prf#3668 AS l_extendedprice_prf_2#3687, l_partkey_prf#3669 AS l_partkey_prf_2#3688, l_discount_prf#3670 AS l_discount_prf_2#3689, l_partkey_and_l_suppkey_prf#3671 AS l_partkey_and_l_suppkey_prf_2#3690, l_commitdate_prf#3672 AS l_commitdate_prf_2#3691, l_suppkey_prf#3673 AS l_suppkey_prf_2#3692, l_orderkey_prf#3674 AS l_orderkey_prf_2#3693]
         :  :     :  :  :  :  :  :  :  :     +- Relation[l_returnflag_prf#3656,l_orderkey_and_l_linenumber_prf#3657,l_comment_prf#3658,l_linestatus_prf#3659,rid#3660,l_shipmode_prf#3661,l_shipinstruct_prf#3662,l_quantity_prf#3663,l_receiptdate_prf#3664,l_linenumber_prf#3665,l_tax_prf#3666,l_shipdate_prf#3667,l_extendedprice_prf#3668,l_partkey_prf#3669,l_discount_prf#3670,l_partkey_and_l_suppkey_prf#3671,l_commitdate_prf#3672,l_suppkey_prf#3673,l_orderkey_prf#3674] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :     :  :  :  :  :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#436) AS rid_3#3714]
         :  :     :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_2
         :  :     :  :  :  :  :  :  :        :- 'Project ['rid AS rid_2#3713]
         :  :     :  :  :  :  :  :  :        :  +- Relation[l_returnflag_prf#3694,l_orderkey_and_l_linenumber_prf#3695,l_comment_prf#3696,l_linestatus_prf#3697,rid#3698,l_shipmode_prf#3699,l_shipinstruct_prf#3700,l_quantity_prf#3701,l_receiptdate_prf#3702,l_linenumber_prf#3703,l_tax_prf#3704,l_shipdate_prf#3705,l_extendedprice_prf#3706,l_partkey_prf#3707,l_discount_prf#3708,l_partkey_and_l_suppkey_prf#3709,l_commitdate_prf#3710,l_suppkey_prf#3711,l_orderkey_prf#3712] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :     :  :  :  :  :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :     :  :  :  :  :  :  +- Project [o_shippriority_prf#3715 AS o_shippriority_prf_3#3725, rid#3716 AS rid_3#3726, o_orderdate_prf#3717 AS o_orderdate_prf_3#3727, o_custkey_prf#3718 AS o_custkey_prf_3#3728, o_orderpriority_prf#3719 AS o_orderpriority_prf_3#3729, o_clerk_prf#3720 AS o_clerk_prf_3#3730, o_orderstatus_prf#3721 AS o_orderstatus_prf_3#3731, o_totalprice_prf#3722 AS o_totalprice_prf_3#3732, o_orderkey_prf#3723 AS o_orderkey_prf_3#3733, o_comment_prf#3724 AS o_comment_prf_3#3734]
         :  :     :  :  :  :  :  :     +- Relation[o_shippriority_prf#3715,rid#3716,o_orderdate_prf#3717,o_custkey_prf#3718,o_orderpriority_prf#3719,o_clerk_prf#3720,o_orderstatus_prf#3721,o_totalprice_prf#3722,o_orderkey_prf#3723,o_comment_prf#3724] JDBCRelation(orders_prf) [numPartitions=1]
         :  :     :  :  :  :  :  +- 'Project ['rid_3, dexdecrypt('value_dec_key, value#436) AS rid_4#3746]
         :  :     :  :  :  :  :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_3
         :  :     :  :  :  :  :        :- 'Project ['rid AS rid_3#3745]
         :  :     :  :  :  :  :        :  +- Relation[o_shippriority_prf#3735,rid#3736,o_orderdate_prf#3737,o_custkey_prf#3738,o_orderpriority_prf#3739,o_clerk_prf#3740,o_orderstatus_prf#3741,o_totalprice_prf#3742,o_orderkey_prf#3743,o_comment_prf#3744] JDBCRelation(orders_prf) [numPartitions=1]
         :  :     :  :  :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :     :  :  :  :  +- Project [c_acctbal_prf#3747 AS c_acctbal_prf_4#3756, rid#3748 AS rid_4#3757, c_name_prf#3749 AS c_name_prf_4#3758, c_nationkey_prf#3750 AS c_nationkey_prf_4#3759, c_custkey_prf#3751 AS c_custkey_prf_4#3760, c_comment_prf#3752 AS c_comment_prf_4#3761, c_address_prf#3753 AS c_address_prf_4#3762, c_mktsegment_prf#3754 AS c_mktsegment_prf_4#3763, c_phone_prf#3755 AS c_phone_prf_4#3764]
         :  :     :  :  :  :     +- Relation[c_acctbal_prf#3747,rid#3748,c_name_prf#3749,c_nationkey_prf#3750,c_custkey_prf#3751,c_comment_prf#3752,c_address_prf#3753,c_mktsegment_prf#3754,c_phone_prf#3755] JDBCRelation(customer_prf) [numPartitions=1]
         :  :     :  :  :  +- 'Project ['rid_4, dexdecrypt('value_dec_key, value#436) AS rid_5#3775]
         :  :     :  :  :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_4
         :  :     :  :  :        :- 'Project ['rid AS rid_4#3774]
         :  :     :  :  :        :  +- Relation[c_acctbal_prf#3765,rid#3766,c_name_prf#3767,c_nationkey_prf#3768,c_custkey_prf#3769,c_comment_prf#3770,c_address_prf#3771,c_mktsegment_prf#3772,c_phone_prf#3773] JDBCRelation(customer_prf) [numPartitions=1]
         :  :     :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :     :  :  +- Project [rid#3776 AS rid_5#3781, n_regionkey_prf#3777 AS n_regionkey_prf_5#3782, n_nationkey_prf#3778 AS n_nationkey_prf_5#3783, n_name_prf#3779 AS n_name_prf_5#3784, n_comment_prf#3780 AS n_comment_prf_5#3785]
         :  :     :  :     +- Relation[rid#3776,n_regionkey_prf#3777,n_nationkey_prf#3778,n_name_prf#3779,n_comment_prf#3780] JDBCRelation(nation_prf) [numPartitions=1]
         :  :     :  +- 'Project ['rid_5, dexdecrypt('value_dec_key, value#436) AS rid_6#3792]
         :  :     :     +- 'DexRidCorrelatedJoin nation~n_regionkey~region~r_regionkey, 'rid_5
         :  :     :        :- 'Project ['rid AS rid_5#3791]
         :  :     :        :  +- Relation[rid#3786,n_regionkey_prf#3787,n_nationkey_prf#3788,n_name_prf#3789,n_comment_prf#3790] JDBCRelation(nation_prf) [numPartitions=1]
         :  :     :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :     +- 'Join UsingJoin(LeftSemi,List(rid_6))
         :  :        :- Project [r_regionkey_prf#3793 AS r_regionkey_prf_6#3797, r_name_prf#3794 AS r_name_prf_6#3798, r_comment_prf#3795 AS r_comment_prf_6#3799, rid#3796 AS rid_6#3800]
         :  :        :  +- Relation[r_regionkey_prf#3793,r_name_prf#3794,r_comment_prf#3795,rid#3796] JDBCRelation(region_prf) [numPartitions=1]
         :  :        +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_6#3801]
         :  :           +- DexRidFilter region~r_name~AMERICA
         :  :              +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#436) AS rid_7#3811]
         :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3810]
         :        :  +- Relation[s_phone_prf#3802,rid#3803,s_address_prf#3804,s_nationkey_prf#3805,s_suppkey_prf#3806,s_name_prf#3807,s_acctbal_prf#3808,s_comment_prf#3809] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#3812 AS rid_7#3817, n_regionkey_prf#3813 AS n_regionkey_prf_7#3818, n_nationkey_prf#3814 AS n_nationkey_prf_7#3819, n_name_prf#3815 AS n_name_prf_7#3820, n_comment_prf#3816 AS n_comment_prf_7#3821]
            +- Relation[rid#3812,n_regionkey_prf#3813,n_nationkey_prf#3814,n_name_prf#3815,n_comment_prf#3816] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=8716
Elapsed time: 167540ms

q8a2=

select
  o_orderdate,
  l_extendedprice,
  l_discount,
  n2.n_name
from
  part,
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2,
  region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey
  and n1.n_regionkey = r_regionkey
  and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
      
19/10/15 16:45:36 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:45:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4143L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_nationkey#21L = n_nationkey#4070L)
         :- Project [s_nationkey#21L]
         :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :- Project [l_suppkey#308L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter ((isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL)) && isnotnull(p_partkey#360L))
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Filter ((isnotnull(l_partkey#307L) && isnotnull(l_orderkey#306L)) && isnotnull(l_suppkey#308L))
         :     :     :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L]
         :     :        +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :           :- Project [c_custkey#290L]
         :     :           :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :           :     :- Project [n_nationkey#108L]
         :     :           :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :           :     :     :- Project [r_regionkey#116L]
         :     :           :     :     :  +- Filter ((isnotnull(r_name#117) && (r_name#117 = AMERICA)) && isnotnull(r_regionkey#116L))
         :     :           :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :           :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :           :     :        +- Filter (isnotnull(n_regionkey#110L) && isnotnull(n_nationkey#108L))
         :     :           :     :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :           :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :           :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :     :           :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :           +- Project [o_orderkey#342L, o_custkey#343L]
         :     :              +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :     :                 +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Filter (isnotnull(s_suppkey#18L) && isnotnull(s_nationkey#21L))
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [n_nationkey#4070L]
            +- Filter isnotnull(n_nationkey#4070L)
               +- Relation[n_nationkey#4070L,n_name#4071,n_regionkey#4072L,n_comment#4073] parquet

19/10/15 16:45:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4143L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_6))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#436) AS rid_1#4166]
         :  :  :  :  :  :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#4157: string
         :  :  :  :  :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :     :  :- Project [p_comment_prf#4145 AS p_comment_prf_0#4155, p_name_prf#4146 AS p_name_prf_0#4156, rid#4147 AS rid_0#4157, p_type_prf#4148 AS p_type_prf_0#4158, p_retailprice_prf#4149 AS p_retailprice_prf_0#4159, p_mfgr_prf#4150 AS p_mfgr_prf_0#4160, p_container_prf#4151 AS p_container_prf_0#4161, p_brand_prf#4152 AS p_brand_prf_0#4162, p_size_prf#4153 AS p_size_prf_0#4163, p_partkey_prf#4154 AS p_partkey_prf_0#4164]
         :  :  :  :  :  :  :     :  :  +- Relation[p_comment_prf#4145,p_name_prf#4146,rid#4147,p_type_prf#4148,p_retailprice_prf#4149,p_mfgr_prf#4150,p_container_prf#4151,p_brand_prf#4152,p_size_prf#4153,p_partkey_prf#4154] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  :  :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4165]
         :  :  :  :  :  :  :     :     +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
         :  :  :  :  :  :  :     :        +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :  :  :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  +- Project [l_returnflag_prf#4167 AS l_returnflag_prf_1#4186, l_orderkey_and_l_linenumber_prf#4168 AS l_orderkey_and_l_linenumber_prf_1#4187, l_comment_prf#4169 AS l_comment_prf_1#4188, l_linestatus_prf#4170 AS l_linestatus_prf_1#4189, rid#4171 AS rid_1#4190, l_shipmode_prf#4172 AS l_shipmode_prf_1#4191, l_shipinstruct_prf#4173 AS l_shipinstruct_prf_1#4192, l_quantity_prf#4174 AS l_quantity_prf_1#4193, l_receiptdate_prf#4175 AS l_receiptdate_prf_1#4194, l_linenumber_prf#4176 AS l_linenumber_prf_1#4195, l_tax_prf#4177 AS l_tax_prf_1#4196, l_shipdate_prf#4178 AS l_shipdate_prf_1#4197, l_extendedprice_prf#4179 AS l_extendedprice_prf_1#4198, l_partkey_prf#4180 AS l_partkey_prf_1#4199, l_discount_prf#4181 AS l_discount_prf_1#4200, l_partkey_and_l_suppkey_prf#4182 AS l_partkey_and_l_suppkey_prf_1#4201, l_commitdate_prf#4183 AS l_commitdate_prf_1#4202, l_suppkey_prf#4184 AS l_suppkey_prf_1#4203, l_orderkey_prf#4185 AS l_orderkey_prf_1#4204]
         :  :  :  :  :  :     +- Relation[l_returnflag_prf#4167,l_orderkey_and_l_linenumber_prf#4168,l_comment_prf#4169,l_linestatus_prf#4170,rid#4171,l_shipmode_prf#4172,l_shipinstruct_prf#4173,l_quantity_prf#4174,l_receiptdate_prf#4175,l_linenumber_prf#4176,l_tax_prf#4177,l_shipdate_prf#4178,l_extendedprice_prf#4179,l_partkey_prf#4180,l_discount_prf#4181,l_partkey_and_l_suppkey_prf#4182,l_commitdate_prf#4183,l_suppkey_prf#4184,l_orderkey_prf#4185] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#436) AS rid_5#4225]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
         :  :  :  :  :        :- 'Project ['rid AS rid_1#4224]
         :  :  :  :  :        :  +- Relation[l_returnflag_prf#4205,l_orderkey_and_l_linenumber_prf#4206,l_comment_prf#4207,l_linestatus_prf#4208,rid#4209,l_shipmode_prf#4210,l_shipinstruct_prf#4211,l_quantity_prf#4212,l_receiptdate_prf#4213,l_linenumber_prf#4214,l_tax_prf#4215,l_shipdate_prf#4216,l_extendedprice_prf#4217,l_partkey_prf#4218,l_discount_prf#4219,l_partkey_and_l_suppkey_prf#4220,l_commitdate_prf#4221,l_suppkey_prf#4222,l_orderkey_prf#4223] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- 'Join NaturalJoin(Inner)
         :  :  :  :     :- 'Join UsingJoin(Inner,List(rid_4))
         :  :  :  :     :  :- 'Join NaturalJoin(Inner)
         :  :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :  :  :  :     :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :     :  :  :  :  :- 'Project ['r_regionkey_prf_2, 'r_name_prf_2, 'r_comment_prf_2, 'rid_2, dexdecrypt('value_dec_key, value#436) AS rid_3#4235]
         :  :  :  :     :  :  :  :  :  +- 'DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_2#4233: string
         :  :  :  :     :  :  :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
         :  :  :  :     :  :  :  :  :     :  :- Project [r_regionkey_prf#4226 AS r_regionkey_prf_2#4230, r_name_prf#4227 AS r_name_prf_2#4231, r_comment_prf#4228 AS r_comment_prf_2#4232, rid#4229 AS rid_2#4233]
         :  :  :  :     :  :  :  :  :     :  :  +- Relation[r_regionkey_prf#4226,r_name_prf#4227,r_comment_prf#4228,rid#4229] JDBCRelation(region_prf) [numPartitions=1]
         :  :  :  :     :  :  :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#4234]
         :  :  :  :     :  :  :  :  :     :     +- DexRidFilter region~r_name~AMERICA
         :  :  :  :     :  :  :  :  :     :        +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :  :     :  :  :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :     :  :  :  :  +- Project [rid#4236 AS rid_3#4241, n_regionkey_prf#4237 AS n_regionkey_prf_3#4242, n_nationkey_prf#4238 AS n_nationkey_prf_3#4243, n_name_prf#4239 AS n_name_prf_3#4244, n_comment_prf#4240 AS n_comment_prf_3#4245]
         :  :  :  :     :  :  :  :     +- Relation[rid#4236,n_regionkey_prf#4237,n_nationkey_prf#4238,n_name_prf#4239,n_comment_prf#4240] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  :     :  :  :  +- 'Project ['rid_3, dexdecrypt('value_dec_key, value#436) AS rid_4#4252]
         :  :  :  :     :  :  :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_3
         :  :  :  :     :  :  :        :- 'Project ['rid AS rid_3#4251]
         :  :  :  :     :  :  :        :  +- Relation[rid#4246,n_regionkey_prf#4247,n_nationkey_prf#4248,n_name_prf#4249,n_comment_prf#4250] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  :     :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :     :  :  +- Project [c_acctbal_prf#4253 AS c_acctbal_prf_4#4262, rid#4254 AS rid_4#4263, c_name_prf#4255 AS c_name_prf_4#4264, c_nationkey_prf#4256 AS c_nationkey_prf_4#4265, c_custkey_prf#4257 AS c_custkey_prf_4#4266, c_comment_prf#4258 AS c_comment_prf_4#4267, c_address_prf#4259 AS c_address_prf_4#4268, c_mktsegment_prf#4260 AS c_mktsegment_prf_4#4269, c_phone_prf#4261 AS c_phone_prf_4#4270]
         :  :  :  :     :  :     +- Relation[c_acctbal_prf#4253,rid#4254,c_name_prf#4255,c_nationkey_prf#4256,c_custkey_prf#4257,c_comment_prf#4258,c_address_prf#4259,c_mktsegment_prf#4260,c_phone_prf#4261] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  :     :  +- 'Project ['rid_4, dexdecrypt('value_dec_key, value#436) AS rid_5#4281]
         :  :  :  :     :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_4
         :  :  :  :     :        :- 'Project ['rid AS rid_4#4280]
         :  :  :  :     :        :  +- Relation[c_acctbal_prf#4271,rid#4272,c_name_prf#4273,c_nationkey_prf#4274,c_custkey_prf#4275,c_comment_prf#4276,c_address_prf#4277,c_mktsegment_prf#4278,c_phone_prf#4279] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  :     :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :     +- Project [o_shippriority_prf#4282 AS o_shippriority_prf_5#4292, rid#4283 AS rid_5#4293, o_orderdate_prf#4284 AS o_orderdate_prf_5#4294, o_custkey_prf#4285 AS o_custkey_prf_5#4295, o_orderpriority_prf#4286 AS o_orderpriority_prf_5#4296, o_clerk_prf#4287 AS o_clerk_prf_5#4297, o_orderstatus_prf#4288 AS o_orderstatus_prf_5#4298, o_totalprice_prf#4289 AS o_totalprice_prf_5#4299, o_orderkey_prf#4290 AS o_orderkey_prf_5#4300, o_comment_prf#4291 AS o_comment_prf_5#4301]
         :  :  :  :        +- Relation[o_shippriority_prf#4282,rid#4283,o_orderdate_prf#4284,o_custkey_prf#4285,o_orderpriority_prf#4286,o_clerk_prf#4287,o_orderstatus_prf#4288,o_totalprice_prf#4289,o_orderkey_prf#4290,o_comment_prf#4291] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#436) AS rid_6#4322]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :  :  :        :- 'Project ['rid AS rid_1#4321]
         :  :  :        :  +- Relation[l_returnflag_prf#4302,l_orderkey_and_l_linenumber_prf#4303,l_comment_prf#4304,l_linestatus_prf#4305,rid#4306,l_shipmode_prf#4307,l_shipinstruct_prf#4308,l_quantity_prf#4309,l_receiptdate_prf#4310,l_linenumber_prf#4311,l_tax_prf#4312,l_shipdate_prf#4313,l_extendedprice_prf#4314,l_partkey_prf#4315,l_discount_prf#4316,l_partkey_and_l_suppkey_prf#4317,l_commitdate_prf#4318,l_suppkey_prf#4319,l_orderkey_prf#4320] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#4323 AS s_phone_prf_6#4331, rid#4324 AS rid_6#4332, s_address_prf#4325 AS s_address_prf_6#4333, s_nationkey_prf#4326 AS s_nationkey_prf_6#4334, s_suppkey_prf#4327 AS s_suppkey_prf_6#4335, s_name_prf#4328 AS s_name_prf_6#4336, s_acctbal_prf#4329 AS s_acctbal_prf_6#4337, s_comment_prf#4330 AS s_comment_prf_6#4338]
         :  :     +- Relation[s_phone_prf#4323,rid#4324,s_address_prf#4325,s_nationkey_prf#4326,s_suppkey_prf#4327,s_name_prf#4328,s_acctbal_prf#4329,s_comment_prf#4330] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_6, dexdecrypt('value_dec_key, value#436) AS rid_7#4348]
         :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_6
         :        :- 'Project ['rid AS rid_6#4347]
         :        :  +- Relation[s_phone_prf#4339,rid#4340,s_address_prf#4341,s_nationkey_prf#4342,s_suppkey_prf#4343,s_name_prf#4344,s_acctbal_prf#4345,s_comment_prf#4346] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#4349 AS rid_7#4354, n_regionkey_prf#4350 AS n_regionkey_prf_7#4355, n_nationkey_prf#4351 AS n_nationkey_prf_7#4356, n_name_prf#4352 AS n_name_prf_7#4357, n_comment_prf#4353 AS n_comment_prf_7#4358]
            +- Relation[rid#4349,n_regionkey_prf#4350,n_nationkey_prf#4351,n_name_prf#4352,n_comment_prf#4353] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=8716
Elapsed time: 121709ms

q8a3=

select
  o_orderdate,
  l_extendedprice,
  l_discount,
  n2.n_name
from
  part,
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2,
  region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey
  and n1.n_regionkey = r_regionkey
  and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
      
19/10/15 16:47:38 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:47:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4680L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_nationkey#21L = n_nationkey#4607L)
         :- Project [s_nationkey#21L]
         :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :- Project [l_suppkey#308L]
         :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :     :- Project [o_orderkey#342L]
         :     :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :     :- Project [c_custkey#290L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :     :  +- Filter ((isnotnull(r_name#117) && (r_name#117 = AMERICA)) && isnotnull(r_regionkey#116L))
         :     :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :     :        +- Filter (isnotnull(n_regionkey#110L) && isnotnull(n_nationkey#108L))
         :     :     :     :     :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :     :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :     :     :     :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :     :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :     :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :     :        +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :           :- Project [p_partkey#360L]
         :     :           :  +- Filter ((isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL)) && isnotnull(p_partkey#360L))
         :     :           :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :           +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :              +- Filter ((isnotnull(l_partkey#307L) && isnotnull(l_orderkey#306L)) && isnotnull(l_suppkey#308L))
         :     :                 +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Filter (isnotnull(s_suppkey#18L) && isnotnull(s_nationkey#21L))
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [n_nationkey#4607L]
            +- Filter isnotnull(n_nationkey#4607L)
               +- Relation[n_nationkey#4607L,n_name#4608,n_regionkey#4609L,n_comment#4610] parquet

19/10/15 16:47:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4680L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_6))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_5))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :  :  :  :  :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#436) AS rid_1#4691]
         :  :  :  :  :  :  :  :  :  :  :  +- 'DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#4689: string
         :  :  :  :  :  :  :  :  :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :  :  :  :  :     :  :- Project [r_regionkey_prf#4682 AS r_regionkey_prf_0#4686, r_name_prf#4683 AS r_name_prf_0#4687, r_comment_prf#4684 AS r_comment_prf_0#4688, rid#4685 AS rid_0#4689]
         :  :  :  :  :  :  :  :  :  :  :     :  :  +- Relation[r_regionkey_prf#4682,r_name_prf#4683,r_comment_prf#4684,rid#4685] JDBCRelation(region_prf) [numPartitions=1]
         :  :  :  :  :  :  :  :  :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4690]
         :  :  :  :  :  :  :  :  :  :  :     :     +- DexRidFilter region~r_name~AMERICA
         :  :  :  :  :  :  :  :  :  :  :     :        +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :  :  :  :  :  :  :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  :  :  :  :  +- Project [rid#4692 AS rid_1#4697, n_regionkey_prf#4693 AS n_regionkey_prf_1#4698, n_nationkey_prf#4694 AS n_nationkey_prf_1#4699, n_name_prf#4695 AS n_name_prf_1#4700, n_comment_prf#4696 AS n_comment_prf_1#4701]
         :  :  :  :  :  :  :  :  :  :     +- Relation[rid#4692,n_regionkey_prf#4693,n_nationkey_prf#4694,n_name_prf#4695,n_comment_prf#4696] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  :  :  :  :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#436) AS rid_2#4708]
         :  :  :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :  :  :  :  :  :  :  :  :        :- 'Project ['rid AS rid_1#4707]
         :  :  :  :  :  :  :  :  :        :  +- Relation[rid#4702,n_regionkey_prf#4703,n_nationkey_prf#4704,n_name_prf#4705,n_comment_prf#4706] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  :  :  :  :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  :  :  +- Project [c_acctbal_prf#4709 AS c_acctbal_prf_2#4718, rid#4710 AS rid_2#4719, c_name_prf#4711 AS c_name_prf_2#4720, c_nationkey_prf#4712 AS c_nationkey_prf_2#4721, c_custkey_prf#4713 AS c_custkey_prf_2#4722, c_comment_prf#4714 AS c_comment_prf_2#4723, c_address_prf#4715 AS c_address_prf_2#4724, c_mktsegment_prf#4716 AS c_mktsegment_prf_2#4725, c_phone_prf#4717 AS c_phone_prf_2#4726]
         :  :  :  :  :  :  :  :     +- Relation[c_acctbal_prf#4709,rid#4710,c_name_prf#4711,c_nationkey_prf#4712,c_custkey_prf#4713,c_comment_prf#4714,c_address_prf#4715,c_mktsegment_prf#4716,c_phone_prf#4717] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  :  :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#436) AS rid_3#4737]
         :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_2
         :  :  :  :  :  :  :        :- 'Project ['rid AS rid_2#4736]
         :  :  :  :  :  :  :        :  +- Relation[c_acctbal_prf#4727,rid#4728,c_name_prf#4729,c_nationkey_prf#4730,c_custkey_prf#4731,c_comment_prf#4732,c_address_prf#4733,c_mktsegment_prf#4734,c_phone_prf#4735] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  :  :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  +- Project [o_shippriority_prf#4738 AS o_shippriority_prf_3#4748, rid#4739 AS rid_3#4749, o_orderdate_prf#4740 AS o_orderdate_prf_3#4750, o_custkey_prf#4741 AS o_custkey_prf_3#4751, o_orderpriority_prf#4742 AS o_orderpriority_prf_3#4752, o_clerk_prf#4743 AS o_clerk_prf_3#4753, o_orderstatus_prf#4744 AS o_orderstatus_prf_3#4754, o_totalprice_prf#4745 AS o_totalprice_prf_3#4755, o_orderkey_prf#4746 AS o_orderkey_prf_3#4756, o_comment_prf#4747 AS o_comment_prf_3#4757]
         :  :  :  :  :  :     +- Relation[o_shippriority_prf#4738,rid#4739,o_orderdate_prf#4740,o_custkey_prf#4741,o_orderpriority_prf#4742,o_clerk_prf#4743,o_orderstatus_prf#4744,o_totalprice_prf#4745,o_orderkey_prf#4746,o_comment_prf#4747] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_3, dexdecrypt('value_dec_key, value#436) AS rid_5#4769]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_3
         :  :  :  :  :        :- 'Project ['rid AS rid_3#4768]
         :  :  :  :  :        :  +- Relation[o_shippriority_prf#4758,rid#4759,o_orderdate_prf#4760,o_custkey_prf#4761,o_orderpriority_prf#4762,o_clerk_prf#4763,o_orderstatus_prf#4764,o_totalprice_prf#4765,o_orderkey_prf#4766,o_comment_prf#4767] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- 'Join NaturalJoin(Inner)
         :  :  :  :     :- 'Project ['p_comment_prf_4, 'p_name_prf_4, 'rid_4, 'p_type_prf_4, 'p_retailprice_prf_4, 'p_mfgr_prf_4, 'p_container_prf_4, 'p_brand_prf_4, 'p_size_prf_4, 'p_partkey_prf_4, dexdecrypt('value_dec_key, value#436) AS rid_5#4791]
         :  :  :  :     :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_4#4782: string
         :  :  :  :     :     :- 'Join UsingJoin(LeftSemi,List(rid_4))
         :  :  :  :     :     :  :- Project [p_comment_prf#4770 AS p_comment_prf_4#4780, p_name_prf#4771 AS p_name_prf_4#4781, rid#4772 AS rid_4#4782, p_type_prf#4773 AS p_type_prf_4#4783, p_retailprice_prf#4774 AS p_retailprice_prf_4#4784, p_mfgr_prf#4775 AS p_mfgr_prf_4#4785, p_container_prf#4776 AS p_container_prf_4#4786, p_brand_prf#4777 AS p_brand_prf_4#4787, p_size_prf#4778 AS p_size_prf_4#4788, p_partkey_prf#4779 AS p_partkey_prf_4#4789]
         :  :  :  :     :     :  :  +- Relation[p_comment_prf#4770,p_name_prf#4771,rid#4772,p_type_prf#4773,p_retailprice_prf#4774,p_mfgr_prf#4775,p_container_prf#4776,p_brand_prf#4777,p_size_prf#4778,p_partkey_prf#4779] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  :     :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_4#4790]
         :  :  :  :     :     :     +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
         :  :  :  :     :     :        +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :  :     :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :     +- Project [l_returnflag_prf#4792 AS l_returnflag_prf_5#4811, l_orderkey_and_l_linenumber_prf#4793 AS l_orderkey_and_l_linenumber_prf_5#4812, l_comment_prf#4794 AS l_comment_prf_5#4813, l_linestatus_prf#4795 AS l_linestatus_prf_5#4814, rid#4796 AS rid_5#4815, l_shipmode_prf#4797 AS l_shipmode_prf_5#4816, l_shipinstruct_prf#4798 AS l_shipinstruct_prf_5#4817, l_quantity_prf#4799 AS l_quantity_prf_5#4818, l_receiptdate_prf#4800 AS l_receiptdate_prf_5#4819, l_linenumber_prf#4801 AS l_linenumber_prf_5#4820, l_tax_prf#4802 AS l_tax_prf_5#4821, l_shipdate_prf#4803 AS l_shipdate_prf_5#4822, l_extendedprice_prf#4804 AS l_extendedprice_prf_5#4823, l_partkey_prf#4805 AS l_partkey_prf_5#4824, l_discount_prf#4806 AS l_discount_prf_5#4825, l_partkey_and_l_suppkey_prf#4807 AS l_partkey_and_l_suppkey_prf_5#4826, l_commitdate_prf#4808 AS l_commitdate_prf_5#4827, l_suppkey_prf#4809 AS l_suppkey_prf_5#4828, l_orderkey_prf#4810 AS l_orderkey_prf_5#4829]
         :  :  :  :        +- Relation[l_returnflag_prf#4792,l_orderkey_and_l_linenumber_prf#4793,l_comment_prf#4794,l_linestatus_prf#4795,rid#4796,l_shipmode_prf#4797,l_shipinstruct_prf#4798,l_quantity_prf#4799,l_receiptdate_prf#4800,l_linenumber_prf#4801,l_tax_prf#4802,l_shipdate_prf#4803,l_extendedprice_prf#4804,l_partkey_prf#4805,l_discount_prf#4806,l_partkey_and_l_suppkey_prf#4807,l_commitdate_prf#4808,l_suppkey_prf#4809,l_orderkey_prf#4810] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_5, dexdecrypt('value_dec_key, value#436) AS rid_6#4850]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_5
         :  :  :        :- 'Project ['rid AS rid_5#4849]
         :  :  :        :  +- Relation[l_returnflag_prf#4830,l_orderkey_and_l_linenumber_prf#4831,l_comment_prf#4832,l_linestatus_prf#4833,rid#4834,l_shipmode_prf#4835,l_shipinstruct_prf#4836,l_quantity_prf#4837,l_receiptdate_prf#4838,l_linenumber_prf#4839,l_tax_prf#4840,l_shipdate_prf#4841,l_extendedprice_prf#4842,l_partkey_prf#4843,l_discount_prf#4844,l_partkey_and_l_suppkey_prf#4845,l_commitdate_prf#4846,l_suppkey_prf#4847,l_orderkey_prf#4848] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#4851 AS s_phone_prf_6#4859, rid#4852 AS rid_6#4860, s_address_prf#4853 AS s_address_prf_6#4861, s_nationkey_prf#4854 AS s_nationkey_prf_6#4862, s_suppkey_prf#4855 AS s_suppkey_prf_6#4863, s_name_prf#4856 AS s_name_prf_6#4864, s_acctbal_prf#4857 AS s_acctbal_prf_6#4865, s_comment_prf#4858 AS s_comment_prf_6#4866]
         :  :     +- Relation[s_phone_prf#4851,rid#4852,s_address_prf#4853,s_nationkey_prf#4854,s_suppkey_prf#4855,s_name_prf#4856,s_acctbal_prf#4857,s_comment_prf#4858] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_6, dexdecrypt('value_dec_key, value#436) AS rid_7#4876]
         :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_6
         :        :- 'Project ['rid AS rid_6#4875]
         :        :  +- Relation[s_phone_prf#4867,rid#4868,s_address_prf#4869,s_nationkey_prf#4870,s_suppkey_prf#4871,s_name_prf#4872,s_acctbal_prf#4873,s_comment_prf#4874] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#4877 AS rid_7#4882, n_regionkey_prf#4878 AS n_regionkey_prf_7#4883, n_nationkey_prf#4879 AS n_nationkey_prf_7#4884, n_name_prf#4880 AS n_name_prf_7#4885, n_comment_prf#4881 AS n_comment_prf_7#4886]
            +- Relation[rid#4877,n_regionkey_prf#4878,n_nationkey_prf#4879,n_name_prf#4880,n_comment_prf#4881] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=8716
Elapsed time: 217926ms

 Q9

q9a=

select
  n_name,
  o_orderdate,
  l_extendedprice,
  l_discount,
  ps_supplycost,
  l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey and s_nationkey = n_nationkey
      
19/10/15 16:51:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:51:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5145L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_orderkey#306L, l_partkey#307L]
                  +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
                     :- Project [ps_partkey#32L, ps_suppkey#33L]
                     :  +- Filter (isnotnull(ps_suppkey#33L) && isnotnull(ps_partkey#32L))
                     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
                     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
                        +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
                           :- Project [s_nationkey#21L, l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
                           :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
                           :     :- Project [s_suppkey#18L, s_nationkey#21L]
                           :     :  +- Filter (isnotnull(s_suppkey#18L) && isnotnull(s_nationkey#21L))
                           :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
                           :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
                           :        +- Filter ((isnotnull(l_suppkey#308L) && isnotnull(l_partkey#307L)) && isnotnull(l_orderkey#306L))
                           :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
                           +- Project [n_nationkey#108L]
                              +- Filter isnotnull(n_nationkey#108L)
                                 +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/15 16:51:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5145L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#436) AS rid_4#5167]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#5158: string
         :     :- Project [o_shippriority_prf#5147 AS o_shippriority_prf_0#5157, rid#5148 AS rid_0#5158, o_orderdate_prf#5149 AS o_orderdate_prf_0#5159, o_custkey_prf#5150 AS o_custkey_prf_0#5160, o_orderpriority_prf#5151 AS o_orderpriority_prf_0#5161, o_clerk_prf#5152 AS o_clerk_prf_0#5162, o_orderstatus_prf#5153 AS o_orderstatus_prf_0#5163, o_totalprice_prf#5154 AS o_totalprice_prf_0#5164, o_orderkey_prf#5155 AS o_orderkey_prf_0#5165, o_comment_prf#5156 AS o_comment_prf_0#5166]
         :     :  +- Relation[o_shippriority_prf#5147,rid#5148,o_orderdate_prf#5149,o_custkey_prf#5150,o_orderpriority_prf#5151,o_clerk_prf#5152,o_orderstatus_prf#5153,o_totalprice_prf#5154,o_orderkey_prf#5155,o_comment_prf#5156] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#436) AS rid_4#5188]
            :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#5180: string
            :     :- Project [p_comment_prf#5168 AS p_comment_prf_1#5178, p_name_prf#5169 AS p_name_prf_1#5179, rid#5170 AS rid_1#5180, p_type_prf#5171 AS p_type_prf_1#5181, p_retailprice_prf#5172 AS p_retailprice_prf_1#5182, p_mfgr_prf#5173 AS p_mfgr_prf_1#5183, p_container_prf#5174 AS p_container_prf_1#5184, p_brand_prf#5175 AS p_brand_prf_1#5185, p_size_prf#5176 AS p_size_prf_1#5186, p_partkey_prf#5177 AS p_partkey_prf_1#5187]
            :     :  +- Relation[p_comment_prf#5168,p_name_prf#5169,rid#5170,p_type_prf#5171,p_retailprice_prf#5172,p_mfgr_prf#5173,p_container_prf#5174,p_brand_prf#5175,p_size_prf#5176,p_partkey_prf#5177] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join NaturalJoin(Inner)
               :- 'Project ['ps_partkey_and_ps_suppkey_prf_2, 'rid_2, 'ps_availqty_prf_2, 'ps_comment_prf_2, 'ps_partkey_prf_2, 'ps_supplycost_prf_2, 'ps_suppkey_prf_2, dexdecrypt('value_dec_key, value#436) AS rid_4#5203]
               :  +- DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, rid_2#5197: string
               :     :- Project [ps_partkey_and_ps_suppkey_prf#5189 AS ps_partkey_and_ps_suppkey_prf_2#5196, rid#5190 AS rid_2#5197, ps_availqty_prf#5191 AS ps_availqty_prf_2#5198, ps_comment_prf#5192 AS ps_comment_prf_2#5199, ps_partkey_prf#5193 AS ps_partkey_prf_2#5200, ps_supplycost_prf#5194 AS ps_supplycost_prf_2#5201, ps_suppkey_prf#5195 AS ps_suppkey_prf_2#5202]
               :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#5189,rid#5190,ps_availqty_prf#5191,ps_comment_prf#5192,ps_partkey_prf#5193,ps_supplycost_prf#5194,ps_suppkey_prf#5195] JDBCRelation(partsupp_prf) [numPartitions=1]
               :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
               +- 'Join NaturalJoin(Inner)
                  :- 'Join UsingJoin(Inner,List(rid_3))
                  :  :- 'Join NaturalJoin(Inner)
                  :  :  :- 'Project ['s_phone_prf_3, 'rid_3, 's_address_prf_3, 's_nationkey_prf_3, 's_suppkey_prf_3, 's_name_prf_3, 's_acctbal_prf_3, 's_comment_prf_3, dexdecrypt('value_dec_key, value#436) AS rid_4#5220]
                  :  :  :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_3#5213: string
                  :  :  :     :- Project [s_phone_prf#5204 AS s_phone_prf_3#5212, rid#5205 AS rid_3#5213, s_address_prf#5206 AS s_address_prf_3#5214, s_nationkey_prf#5207 AS s_nationkey_prf_3#5215, s_suppkey_prf#5208 AS s_suppkey_prf_3#5216, s_name_prf#5209 AS s_name_prf_3#5217, s_acctbal_prf#5210 AS s_acctbal_prf_3#5218, s_comment_prf#5211 AS s_comment_prf_3#5219]
                  :  :  :     :  +- Relation[s_phone_prf#5204,rid#5205,s_address_prf#5206,s_nationkey_prf#5207,s_suppkey_prf#5208,s_name_prf#5209,s_acctbal_prf#5210,s_comment_prf#5211] JDBCRelation(supplier_prf) [numPartitions=1]
                  :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
                  :  :  +- Project [l_returnflag_prf#5221 AS l_returnflag_prf_4#5240, l_orderkey_and_l_linenumber_prf#5222 AS l_orderkey_and_l_linenumber_prf_4#5241, l_comment_prf#5223 AS l_comment_prf_4#5242, l_linestatus_prf#5224 AS l_linestatus_prf_4#5243, rid#5225 AS rid_4#5244, l_shipmode_prf#5226 AS l_shipmode_prf_4#5245, l_shipinstruct_prf#5227 AS l_shipinstruct_prf_4#5246, l_quantity_prf#5228 AS l_quantity_prf_4#5247, l_receiptdate_prf#5229 AS l_receiptdate_prf_4#5248, l_linenumber_prf#5230 AS l_linenumber_prf_4#5249, l_tax_prf#5231 AS l_tax_prf_4#5250, l_shipdate_prf#5232 AS l_shipdate_prf_4#5251, l_extendedprice_prf#5233 AS l_extendedprice_prf_4#5252, l_partkey_prf#5234 AS l_partkey_prf_4#5253, l_discount_prf#5235 AS l_discount_prf_4#5254, l_partkey_and_l_suppkey_prf#5236 AS l_partkey_and_l_suppkey_prf_4#5255, l_commitdate_prf#5237 AS l_commitdate_prf_4#5256, l_suppkey_prf#5238 AS l_suppkey_prf_4#5257, l_orderkey_prf#5239 AS l_orderkey_prf_4#5258]
                  :  :     +- Relation[l_returnflag_prf#5221,l_orderkey_and_l_linenumber_prf#5222,l_comment_prf#5223,l_linestatus_prf#5224,rid#5225,l_shipmode_prf#5226,l_shipinstruct_prf#5227,l_quantity_prf#5228,l_receiptdate_prf#5229,l_linenumber_prf#5230,l_tax_prf#5231,l_shipdate_prf#5232,l_extendedprice_prf#5233,l_partkey_prf#5234,l_discount_prf#5235,l_partkey_and_l_suppkey_prf#5236,l_commitdate_prf#5237,l_suppkey_prf#5238,l_orderkey_prf#5239] JDBCRelation(lineitem_prf) [numPartitions=1]
                  :  +- 'Project ['rid_3, dexdecrypt('value_dec_key, value#436) AS rid_5#5268]
                  :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_3
                  :        :- 'Project ['rid AS rid_3#5267]
                  :        :  +- Relation[s_phone_prf#5259,rid#5260,s_address_prf#5261,s_nationkey_prf#5262,s_suppkey_prf#5263,s_name_prf#5264,s_acctbal_prf#5265,s_comment_prf#5266] JDBCRelation(supplier_prf) [numPartitions=1]
                  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
                  +- Project [rid#5269 AS rid_5#5274, n_regionkey_prf#5270 AS n_regionkey_prf_5#5275, n_nationkey_prf#5271 AS n_nationkey_prf_5#5276, n_name_prf#5272 AS n_name_prf_5#5277, n_comment_prf#5273 AS n_comment_prf_5#5278]
                     +- Relation[rid#5269,n_regionkey_prf#5270,n_nationkey_prf#5271,n_name_prf#5272,n_comment_prf#5273] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 441215ms

q9b=

select
  n_name,
  o_orderdate,
  l_extendedprice,
  l_discount,
  ps_supplycost,
  l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey and s_nationkey = n_nationkey
      
19/10/15 16:58:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 16:58:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5530L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L, s_nationkey#21L]
         :     :     :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :     :     :  +- Filter ((isnotnull(l_suppkey#308L) && isnotnull(l_partkey#307L)) && isnotnull(l_orderkey#306L))
         :     :     :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Filter (isnotnull(s_suppkey#18L) && isnotnull(s_nationkey#21L))
         :     :     :     :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [n_nationkey#108L]
         :     :     :        +- Filter isnotnull(n_nationkey#108L)
         :     :     :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Filter isnotnull(p_partkey#360L)
         :     :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 16:58:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5530L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#436) AS rid_1#5570]
         :  :  :  :  :  :  :  :  :  +- DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, rid_0#5555: string
         :  :  :  :  :  :  :  :  :     :- Project [l_returnflag_prf#5532 AS l_returnflag_prf_0#5551, l_orderkey_and_l_linenumber_prf#5533 AS l_orderkey_and_l_linenumber_prf_0#5552, l_comment_prf#5534 AS l_comment_prf_0#5553, l_linestatus_prf#5535 AS l_linestatus_prf_0#5554, rid#5536 AS rid_0#5555, l_shipmode_prf#5537 AS l_shipmode_prf_0#5556, l_shipinstruct_prf#5538 AS l_shipinstruct_prf_0#5557, l_quantity_prf#5539 AS l_quantity_prf_0#5558, l_receiptdate_prf#5540 AS l_receiptdate_prf_0#5559, l_linenumber_prf#5541 AS l_linenumber_prf_0#5560, l_tax_prf#5542 AS l_tax_prf_0#5561, l_shipdate_prf#5543 AS l_shipdate_prf_0#5562, l_extendedprice_prf#5544 AS l_extendedprice_prf_0#5563, l_partkey_prf#5545 AS l_partkey_prf_0#5564, l_discount_prf#5546 AS l_discount_prf_0#5565, l_partkey_and_l_suppkey_prf#5547 AS l_partkey_and_l_suppkey_prf_0#5566, l_commitdate_prf#5548 AS l_commitdate_prf_0#5567, l_suppkey_prf#5549 AS l_suppkey_prf_0#5568, l_orderkey_prf#5550 AS l_orderkey_prf_0#5569]
         :  :  :  :  :  :  :  :  :     :  +- Relation[l_returnflag_prf#5532,l_orderkey_and_l_linenumber_prf#5533,l_comment_prf#5534,l_linestatus_prf#5535,rid#5536,l_shipmode_prf#5537,l_shipinstruct_prf#5538,l_quantity_prf#5539,l_receiptdate_prf#5540,l_linenumber_prf#5541,l_tax_prf#5542,l_shipdate_prf#5543,l_extendedprice_prf#5544,l_partkey_prf#5545,l_discount_prf#5546,l_partkey_and_l_suppkey_prf#5547,l_commitdate_prf#5548,l_suppkey_prf#5549,l_orderkey_prf#5550] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :  :  :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  :  :  +- Project [s_phone_prf#5571 AS s_phone_prf_1#5579, rid#5572 AS rid_1#5580, s_address_prf#5573 AS s_address_prf_1#5581, s_nationkey_prf#5574 AS s_nationkey_prf_1#5582, s_suppkey_prf#5575 AS s_suppkey_prf_1#5583, s_name_prf#5576 AS s_name_prf_1#5584, s_acctbal_prf#5577 AS s_acctbal_prf_1#5585, s_comment_prf#5578 AS s_comment_prf_1#5586]
         :  :  :  :  :  :  :  :     +- Relation[s_phone_prf#5571,rid#5572,s_address_prf#5573,s_nationkey_prf#5574,s_suppkey_prf#5575,s_name_prf#5576,s_acctbal_prf#5577,s_comment_prf#5578] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  :  :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#436) AS rid_2#5596]
         :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_1
         :  :  :  :  :  :  :        :- 'Project ['rid AS rid_1#5595]
         :  :  :  :  :  :  :        :  +- Relation[s_phone_prf#5587,rid#5588,s_address_prf#5589,s_nationkey_prf#5590,s_suppkey_prf#5591,s_name_prf#5592,s_acctbal_prf#5593,s_comment_prf#5594] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  :  :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  +- Project [rid#5597 AS rid_2#5602, n_regionkey_prf#5598 AS n_regionkey_prf_2#5603, n_nationkey_prf#5599 AS n_nationkey_prf_2#5604, n_name_prf#5600 AS n_name_prf_2#5605, n_comment_prf#5601 AS n_comment_prf_2#5606]
         :  :  :  :  :  :     +- Relation[rid#5597,n_regionkey_prf#5598,n_nationkey_prf#5599,n_name_prf#5600,n_comment_prf#5601] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#436) AS rid_3#5627]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_0
         :  :  :  :  :        :- 'Project ['rid AS rid_0#5626]
         :  :  :  :  :        :  +- Relation[l_returnflag_prf#5607,l_orderkey_and_l_linenumber_prf#5608,l_comment_prf#5609,l_linestatus_prf#5610,rid#5611,l_shipmode_prf#5612,l_shipinstruct_prf#5613,l_quantity_prf#5614,l_receiptdate_prf#5615,l_linenumber_prf#5616,l_tax_prf#5617,l_shipdate_prf#5618,l_extendedprice_prf#5619,l_partkey_prf#5620,l_discount_prf#5621,l_partkey_and_l_suppkey_prf#5622,l_commitdate_prf#5623,l_suppkey_prf#5624,l_orderkey_prf#5625] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [p_comment_prf#5628 AS p_comment_prf_3#5638, p_name_prf#5629 AS p_name_prf_3#5639, rid#5630 AS rid_3#5640, p_type_prf#5631 AS p_type_prf_3#5641, p_retailprice_prf#5632 AS p_retailprice_prf_3#5642, p_mfgr_prf#5633 AS p_mfgr_prf_3#5643, p_container_prf#5634 AS p_container_prf_3#5644, p_brand_prf#5635 AS p_brand_prf_3#5645, p_size_prf#5636 AS p_size_prf_3#5646, p_partkey_prf#5637 AS p_partkey_prf_3#5647]
         :  :  :  :     +- Relation[p_comment_prf#5628,p_name_prf#5629,rid#5630,p_type_prf#5631,p_retailprice_prf#5632,p_mfgr_prf#5633,p_container_prf#5634,p_brand_prf#5635,p_size_prf#5636,p_partkey_prf#5637] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#436) AS rid_4#5668]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey_and_l_suppkey~partsupp~ps_partkey_and_ps_suppkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#5667]
         :  :  :        :  +- Relation[l_returnflag_prf#5648,l_orderkey_and_l_linenumber_prf#5649,l_comment_prf#5650,l_linestatus_prf#5651,rid#5652,l_shipmode_prf#5653,l_shipinstruct_prf#5654,l_quantity_prf#5655,l_receiptdate_prf#5656,l_linenumber_prf#5657,l_tax_prf#5658,l_shipdate_prf#5659,l_extendedprice_prf#5660,l_partkey_prf#5661,l_discount_prf#5662,l_partkey_and_l_suppkey_prf#5663,l_commitdate_prf#5664,l_suppkey_prf#5665,l_orderkey_prf#5666] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#5669 AS ps_partkey_and_ps_suppkey_prf_4#5676, rid#5670 AS rid_4#5677, ps_availqty_prf#5671 AS ps_availqty_prf_4#5678, ps_comment_prf#5672 AS ps_comment_prf_4#5679, ps_partkey_prf#5673 AS ps_partkey_prf_4#5680, ps_supplycost_prf#5674 AS ps_supplycost_prf_4#5681, ps_suppkey_prf#5675 AS ps_suppkey_prf_4#5682]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#5669,rid#5670,ps_availqty_prf#5671,ps_comment_prf#5672,ps_partkey_prf#5673,ps_supplycost_prf#5674,ps_suppkey_prf#5675] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#436) AS rid_5#5703]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5702]
         :        :  +- Relation[l_returnflag_prf#5683,l_orderkey_and_l_linenumber_prf#5684,l_comment_prf#5685,l_linestatus_prf#5686,rid#5687,l_shipmode_prf#5688,l_shipinstruct_prf#5689,l_quantity_prf#5690,l_receiptdate_prf#5691,l_linenumber_prf#5692,l_tax_prf#5693,l_shipdate_prf#5694,l_extendedprice_prf#5695,l_partkey_prf#5696,l_discount_prf#5697,l_partkey_and_l_suppkey_prf#5698,l_commitdate_prf#5699,l_suppkey_prf#5700,l_orderkey_prf#5701] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#5704 AS o_shippriority_prf_5#5714, rid#5705 AS rid_5#5715, o_orderdate_prf#5706 AS o_orderdate_prf_5#5716, o_custkey_prf#5707 AS o_custkey_prf_5#5717, o_orderpriority_prf#5708 AS o_orderpriority_prf_5#5718, o_clerk_prf#5709 AS o_clerk_prf_5#5719, o_orderstatus_prf#5710 AS o_orderstatus_prf_5#5720, o_totalprice_prf#5711 AS o_totalprice_prf_5#5721, o_orderkey_prf#5712 AS o_orderkey_prf_5#5722, o_comment_prf#5713 AS o_comment_prf_5#5723]
            +- Relation[o_shippriority_prf#5704,rid#5705,o_orderdate_prf#5706,o_custkey_prf#5707,o_orderpriority_prf#5708,o_clerk_prf#5709,o_orderstatus_prf#5710,o_totalprice_prf#5711,o_orderkey_prf#5712,o_comment_prf#5713] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 422615ms

q9c=

select
  n_name,
  o_orderdate,
  l_extendedprice,
  l_discount,
  ps_supplycost,
  l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey and s_nationkey = n_nationkey
      
19/10/15 17:05:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 17:05:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5988L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :- Project [s_nationkey#21L]
         :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :- Project [l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :     :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :     :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :     :     :  +- Filter ((isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L)) && isnotnull(l_suppkey#308L))
         :     :     :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     :     :     +- Project [o_orderkey#342L]
         :     :     :     :        +- Filter isnotnull(o_orderkey#342L)
         :     :     :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Filter isnotnull(p_partkey#360L)
         :     :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Filter (isnotnull(s_suppkey#18L) && isnotnull(s_nationkey#21L))
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [n_nationkey#108L]
            +- Filter isnotnull(n_nationkey#108L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/15 17:05:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5988L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_4))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#436) AS rid_1#6028]
         :  :  :  :  :  :  :  :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#6013: string
         :  :  :  :  :  :  :  :  :     :- Project [l_returnflag_prf#5990 AS l_returnflag_prf_0#6009, l_orderkey_and_l_linenumber_prf#5991 AS l_orderkey_and_l_linenumber_prf_0#6010, l_comment_prf#5992 AS l_comment_prf_0#6011, l_linestatus_prf#5993 AS l_linestatus_prf_0#6012, rid#5994 AS rid_0#6013, l_shipmode_prf#5995 AS l_shipmode_prf_0#6014, l_shipinstruct_prf#5996 AS l_shipinstruct_prf_0#6015, l_quantity_prf#5997 AS l_quantity_prf_0#6016, l_receiptdate_prf#5998 AS l_receiptdate_prf_0#6017, l_linenumber_prf#5999 AS l_linenumber_prf_0#6018, l_tax_prf#6000 AS l_tax_prf_0#6019, l_shipdate_prf#6001 AS l_shipdate_prf_0#6020, l_extendedprice_prf#6002 AS l_extendedprice_prf_0#6021, l_partkey_prf#6003 AS l_partkey_prf_0#6022, l_discount_prf#6004 AS l_discount_prf_0#6023, l_partkey_and_l_suppkey_prf#6005 AS l_partkey_and_l_suppkey_prf_0#6024, l_commitdate_prf#6006 AS l_commitdate_prf_0#6025, l_suppkey_prf#6007 AS l_suppkey_prf_0#6026, l_orderkey_prf#6008 AS l_orderkey_prf_0#6027]
         :  :  :  :  :  :  :  :  :     :  +- Relation[l_returnflag_prf#5990,l_orderkey_and_l_linenumber_prf#5991,l_comment_prf#5992,l_linestatus_prf#5993,rid#5994,l_shipmode_prf#5995,l_shipinstruct_prf#5996,l_quantity_prf#5997,l_receiptdate_prf#5998,l_linenumber_prf#5999,l_tax_prf#6000,l_shipdate_prf#6001,l_extendedprice_prf#6002,l_partkey_prf#6003,l_discount_prf#6004,l_partkey_and_l_suppkey_prf#6005,l_commitdate_prf#6006,l_suppkey_prf#6007,l_orderkey_prf#6008] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :  :  :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  :  :  +- Project [o_shippriority_prf#6029 AS o_shippriority_prf_1#6039, rid#6030 AS rid_1#6040, o_orderdate_prf#6031 AS o_orderdate_prf_1#6041, o_custkey_prf#6032 AS o_custkey_prf_1#6042, o_orderpriority_prf#6033 AS o_orderpriority_prf_1#6043, o_clerk_prf#6034 AS o_clerk_prf_1#6044, o_orderstatus_prf#6035 AS o_orderstatus_prf_1#6045, o_totalprice_prf#6036 AS o_totalprice_prf_1#6046, o_orderkey_prf#6037 AS o_orderkey_prf_1#6047, o_comment_prf#6038 AS o_comment_prf_1#6048]
         :  :  :  :  :  :  :  :     +- Relation[o_shippriority_prf#6029,rid#6030,o_orderdate_prf#6031,o_custkey_prf#6032,o_orderpriority_prf#6033,o_clerk_prf#6034,o_orderstatus_prf#6035,o_totalprice_prf#6036,o_orderkey_prf#6037,o_comment_prf#6038] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#436) AS rid_2#6069]
         :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey_and_l_suppkey~partsupp~ps_partkey_and_ps_suppkey, 'rid_0
         :  :  :  :  :  :  :        :- 'Project ['rid AS rid_0#6068]
         :  :  :  :  :  :  :        :  +- Relation[l_returnflag_prf#6049,l_orderkey_and_l_linenumber_prf#6050,l_comment_prf#6051,l_linestatus_prf#6052,rid#6053,l_shipmode_prf#6054,l_shipinstruct_prf#6055,l_quantity_prf#6056,l_receiptdate_prf#6057,l_linenumber_prf#6058,l_tax_prf#6059,l_shipdate_prf#6060,l_extendedprice_prf#6061,l_partkey_prf#6062,l_discount_prf#6063,l_partkey_and_l_suppkey_prf#6064,l_commitdate_prf#6065,l_suppkey_prf#6066,l_orderkey_prf#6067] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  +- Project [ps_partkey_and_ps_suppkey_prf#6070 AS ps_partkey_and_ps_suppkey_prf_2#6077, rid#6071 AS rid_2#6078, ps_availqty_prf#6072 AS ps_availqty_prf_2#6079, ps_comment_prf#6073 AS ps_comment_prf_2#6080, ps_partkey_prf#6074 AS ps_partkey_prf_2#6081, ps_supplycost_prf#6075 AS ps_supplycost_prf_2#6082, ps_suppkey_prf#6076 AS ps_suppkey_prf_2#6083]
         :  :  :  :  :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#6070,rid#6071,ps_availqty_prf#6072,ps_comment_prf#6073,ps_partkey_prf#6074,ps_supplycost_prf#6075,ps_suppkey_prf#6076] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#436) AS rid_3#6104]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_0
         :  :  :  :  :        :- 'Project ['rid AS rid_0#6103]
         :  :  :  :  :        :  +- Relation[l_returnflag_prf#6084,l_orderkey_and_l_linenumber_prf#6085,l_comment_prf#6086,l_linestatus_prf#6087,rid#6088,l_shipmode_prf#6089,l_shipinstruct_prf#6090,l_quantity_prf#6091,l_receiptdate_prf#6092,l_linenumber_prf#6093,l_tax_prf#6094,l_shipdate_prf#6095,l_extendedprice_prf#6096,l_partkey_prf#6097,l_discount_prf#6098,l_partkey_and_l_suppkey_prf#6099,l_commitdate_prf#6100,l_suppkey_prf#6101,l_orderkey_prf#6102] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [p_comment_prf#6105 AS p_comment_prf_3#6115, p_name_prf#6106 AS p_name_prf_3#6116, rid#6107 AS rid_3#6117, p_type_prf#6108 AS p_type_prf_3#6118, p_retailprice_prf#6109 AS p_retailprice_prf_3#6119, p_mfgr_prf#6110 AS p_mfgr_prf_3#6120, p_container_prf#6111 AS p_container_prf_3#6121, p_brand_prf#6112 AS p_brand_prf_3#6122, p_size_prf#6113 AS p_size_prf_3#6123, p_partkey_prf#6114 AS p_partkey_prf_3#6124]
         :  :  :  :     +- Relation[p_comment_prf#6105,p_name_prf#6106,rid#6107,p_type_prf#6108,p_retailprice_prf#6109,p_mfgr_prf#6110,p_container_prf#6111,p_brand_prf#6112,p_size_prf#6113,p_partkey_prf#6114] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#436) AS rid_4#6145]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#6144]
         :  :  :        :  +- Relation[l_returnflag_prf#6125,l_orderkey_and_l_linenumber_prf#6126,l_comment_prf#6127,l_linestatus_prf#6128,rid#6129,l_shipmode_prf#6130,l_shipinstruct_prf#6131,l_quantity_prf#6132,l_receiptdate_prf#6133,l_linenumber_prf#6134,l_tax_prf#6135,l_shipdate_prf#6136,l_extendedprice_prf#6137,l_partkey_prf#6138,l_discount_prf#6139,l_partkey_and_l_suppkey_prf#6140,l_commitdate_prf#6141,l_suppkey_prf#6142,l_orderkey_prf#6143] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#6146 AS s_phone_prf_4#6154, rid#6147 AS rid_4#6155, s_address_prf#6148 AS s_address_prf_4#6156, s_nationkey_prf#6149 AS s_nationkey_prf_4#6157, s_suppkey_prf#6150 AS s_suppkey_prf_4#6158, s_name_prf#6151 AS s_name_prf_4#6159, s_acctbal_prf#6152 AS s_acctbal_prf_4#6160, s_comment_prf#6153 AS s_comment_prf_4#6161]
         :  :     +- Relation[s_phone_prf#6146,rid#6147,s_address_prf#6148,s_nationkey_prf#6149,s_suppkey_prf#6150,s_name_prf#6151,s_acctbal_prf#6152,s_comment_prf#6153] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_4, dexdecrypt('value_dec_key, value#436) AS rid_5#6171]
         :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_4
         :        :- 'Project ['rid AS rid_4#6170]
         :        :  +- Relation[s_phone_prf#6162,rid#6163,s_address_prf#6164,s_nationkey_prf#6165,s_suppkey_prf#6166,s_name_prf#6167,s_acctbal_prf#6168,s_comment_prf#6169] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#6172 AS rid_5#6177, n_regionkey_prf#6173 AS n_regionkey_prf_5#6178, n_nationkey_prf#6174 AS n_nationkey_prf_5#6179, n_name_prf#6175 AS n_name_prf_5#6180, n_comment_prf#6176 AS n_comment_prf_5#6181]
            +- Relation[rid#6172,n_regionkey_prf#6173,n_nationkey_prf#6174,n_name_prf#6175,n_comment_prf#6176] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 445909ms

 Q10

q10a=

select
  c_name,
  l_extendedprice,
  l_discount,
  c_acctbal,
  n_name,
  c_address,
  c_phone,
  c_comment
from
  customer,
  orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
      
19/10/15 17:13:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 17:13:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6335L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
               :- Project [c_nationkey#293L, o_orderkey#342L]
               :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :     :- Project [c_custkey#290L, c_nationkey#293L]
               :     :  +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
               :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               :     +- Project [o_orderkey#342L, o_custkey#343L]
               :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/15 17:13:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6335L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#436) AS rid_2#6376]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#6360: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#6337 AS l_returnflag_prf_0#6356, l_orderkey_and_l_linenumber_prf#6338 AS l_orderkey_and_l_linenumber_prf_0#6357, l_comment_prf#6339 AS l_comment_prf_0#6358, l_linestatus_prf#6340 AS l_linestatus_prf_0#6359, rid#6341 AS rid_0#6360, l_shipmode_prf#6342 AS l_shipmode_prf_0#6361, l_shipinstruct_prf#6343 AS l_shipinstruct_prf_0#6362, l_quantity_prf#6344 AS l_quantity_prf_0#6363, l_receiptdate_prf#6345 AS l_receiptdate_prf_0#6364, l_linenumber_prf#6346 AS l_linenumber_prf_0#6365, l_tax_prf#6347 AS l_tax_prf_0#6366, l_shipdate_prf#6348 AS l_shipdate_prf_0#6367, l_extendedprice_prf#6349 AS l_extendedprice_prf_0#6368, l_partkey_prf#6350 AS l_partkey_prf_0#6369, l_discount_prf#6351 AS l_discount_prf_0#6370, l_partkey_and_l_suppkey_prf#6352 AS l_partkey_and_l_suppkey_prf_0#6371, l_commitdate_prf#6353 AS l_commitdate_prf_0#6372, l_suppkey_prf#6354 AS l_suppkey_prf_0#6373, l_orderkey_prf#6355 AS l_orderkey_prf_0#6374]
         :     :  :  +- Relation[l_returnflag_prf#6337,l_orderkey_and_l_linenumber_prf#6338,l_comment_prf#6339,l_linestatus_prf#6340,rid#6341,l_shipmode_prf#6342,l_shipinstruct_prf#6343,l_quantity_prf#6344,l_receiptdate_prf#6345,l_linenumber_prf#6346,l_tax_prf#6347,l_shipdate_prf#6348,l_extendedprice_prf#6349,l_partkey_prf#6350,l_discount_prf#6351,l_partkey_and_l_suppkey_prf#6352,l_commitdate_prf#6353,l_suppkey_prf#6354,l_orderkey_prf#6355] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#6375]
         :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :        +- Relation[label#406,value#407] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'Join NaturalJoin(Inner)
            :  :  :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#436) AS rid_2#6395]
            :  :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#6387: string
            :  :  :     :- Project [c_acctbal_prf#6377 AS c_acctbal_prf_1#6386, rid#6378 AS rid_1#6387, c_name_prf#6379 AS c_name_prf_1#6388, c_nationkey_prf#6380 AS c_nationkey_prf_1#6389, c_custkey_prf#6381 AS c_custkey_prf_1#6390, c_comment_prf#6382 AS c_comment_prf_1#6391, c_address_prf#6383 AS c_address_prf_1#6392, c_mktsegment_prf#6384 AS c_mktsegment_prf_1#6393, c_phone_prf#6385 AS c_phone_prf_1#6394]
            :  :  :     :  +- Relation[c_acctbal_prf#6377,rid#6378,c_name_prf#6379,c_nationkey_prf#6380,c_custkey_prf#6381,c_comment_prf#6382,c_address_prf#6383,c_mktsegment_prf#6384,c_phone_prf#6385] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :     +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
            :  :  +- Project [o_shippriority_prf#6396 AS o_shippriority_prf_2#6406, rid#6397 AS rid_2#6407, o_orderdate_prf#6398 AS o_orderdate_prf_2#6408, o_custkey_prf#6399 AS o_custkey_prf_2#6409, o_orderpriority_prf#6400 AS o_orderpriority_prf_2#6410, o_clerk_prf#6401 AS o_clerk_prf_2#6411, o_orderstatus_prf#6402 AS o_orderstatus_prf_2#6412, o_totalprice_prf#6403 AS o_totalprice_prf_2#6413, o_orderkey_prf#6404 AS o_orderkey_prf_2#6414, o_comment_prf#6405 AS o_comment_prf_2#6415]
            :  :     +- Relation[o_shippriority_prf#6396,rid#6397,o_orderdate_prf#6398,o_custkey_prf#6399,o_orderpriority_prf#6400,o_clerk_prf#6401,o_orderstatus_prf#6402,o_totalprice_prf#6403,o_orderkey_prf#6404,o_comment_prf#6405] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#436) AS rid_3#6426]
            :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#6425]
            :        :  +- Relation[c_acctbal_prf#6416,rid#6417,c_name_prf#6418,c_nationkey_prf#6419,c_custkey_prf#6420,c_comment_prf#6421,c_address_prf#6422,c_mktsegment_prf#6423,c_phone_prf#6424] JDBCRelation(customer_prf) [numPartitions=1]
            :        +- Relation[label#435,value#436] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [rid#6427 AS rid_3#6432, n_regionkey_prf#6428 AS n_regionkey_prf_3#6433, n_nationkey_prf#6429 AS n_nationkey_prf_3#6434, n_name_prf#6430 AS n_name_prf_3#6435, n_comment_prf#6431 AS n_comment_prf_3#6436]
               +- Relation[rid#6427,n_regionkey_prf#6428,n_nationkey_prf#6429,n_name_prf#6430,n_comment_prf#6431] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 117946ms
