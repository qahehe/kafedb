19/10/17 03:15:51 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7153ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Thu Oct 17 03:15:54 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Thu Oct 17 03:15:55 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Thu Oct 17 03:15:55 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Thu Oct 17 03:15:55 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Thu Oct 17 03:15:55 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Thu Oct 17 03:15:58 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Thu Oct 17 03:16:00 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Thu Oct 17 03:16:00 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



fr1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey and c_mktsegment = 'BUILDING'
19/10/17 03:16:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:16:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2093L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 03:16:01 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:16:01 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:16:01 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:16:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2093L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [l_returnflag_prf#2095 AS l_returnflag_prf_0#2114, l_orderkey_and_l_linenumber_prf#2096 AS l_orderkey_and_l_linenumber_prf_0#2115, l_comment_prf#2097 AS l_comment_prf_0#2116, l_linestatus_prf#2098 AS l_linestatus_prf_0#2117, rid#2099 AS rid_0#2118, l_shipmode_prf#2100 AS l_shipmode_prf_0#2119, l_shipinstruct_prf#2101 AS l_shipinstruct_prf_0#2120, l_quantity_prf#2102 AS l_quantity_prf_0#2121, l_receiptdate_prf#2103 AS l_receiptdate_prf_0#2122, l_linenumber_prf#2104 AS l_linenumber_prf_0#2123, l_tax_prf#2105 AS l_tax_prf_0#2124, l_shipdate_prf#2106 AS l_shipdate_prf_0#2125, l_extendedprice_prf#2107 AS l_extendedprice_prf_0#2126, l_partkey_prf#2108 AS l_partkey_prf_0#2127, l_discount_prf#2109 AS l_discount_prf_0#2128, l_partkey_and_l_suppkey_prf#2110 AS l_partkey_and_l_suppkey_prf_0#2129, l_commitdate_prf#2111 AS l_commitdate_prf_0#2130, l_suppkey_prf#2112 AS l_suppkey_prf_0#2131, l_orderkey_prf#2113 AS l_orderkey_prf_0#2132]
         :  :  :  :  +- Relation[l_returnflag_prf#2095,l_orderkey_and_l_linenumber_prf#2096,l_comment_prf#2097,l_linestatus_prf#2098,rid#2099,l_shipmode_prf#2100,l_shipinstruct_prf#2101,l_quantity_prf#2102,l_receiptdate_prf#2103,l_linenumber_prf#2104,l_tax_prf#2105,l_shipdate_prf#2106,l_extendedprice_prf#2107,l_partkey_prf#2108,l_discount_prf#2109,l_partkey_and_l_suppkey_prf#2110,l_commitdate_prf#2111,l_suppkey_prf#2112,l_orderkey_prf#2113] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#2155]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#2152]
         :  :  :        :  +- Relation[l_returnflag_prf#2133,l_orderkey_and_l_linenumber_prf#2134,l_comment_prf#2135,l_linestatus_prf#2136,rid#2137,l_shipmode_prf#2138,l_shipinstruct_prf#2139,l_quantity_prf#2140,l_receiptdate_prf#2141,l_linenumber_prf#2142,l_tax_prf#2143,l_shipdate_prf#2144,l_extendedprice_prf#2145,l_partkey_prf#2146,l_discount_prf#2147,l_partkey_and_l_suppkey_prf#2148,l_commitdate_prf#2149,l_suppkey_prf#2150,l_orderkey_prf#2151] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#2156 AS o_shippriority_prf_1#2166, rid#2157 AS rid_1#2167, o_orderdate_prf#2158 AS o_orderdate_prf_1#2168, o_custkey_prf#2159 AS o_custkey_prf_1#2169, o_orderpriority_prf#2160 AS o_orderpriority_prf_1#2170, o_clerk_prf#2161 AS o_clerk_prf_1#2171, o_orderstatus_prf#2162 AS o_orderstatus_prf_1#2172, o_totalprice_prf#2163 AS o_totalprice_prf_1#2173, o_orderkey_prf#2164 AS o_orderkey_prf_1#2174, o_comment_prf#2165 AS o_comment_prf_1#2175]
         :  :     +- Relation[o_shippriority_prf#2156,rid#2157,o_orderdate_prf#2158,o_custkey_prf#2159,o_orderpriority_prf#2160,o_clerk_prf#2161,o_orderstatus_prf#2162,o_totalprice_prf#2163,o_orderkey_prf#2164,o_comment_prf#2165] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#2187]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2186]
         :        :  +- Relation[o_shippriority_prf#2176,rid#2177,o_orderdate_prf#2178,o_custkey_prf#2179,o_orderpriority_prf#2180,o_clerk_prf#2181,o_orderstatus_prf#2182,o_totalprice_prf#2183,o_orderkey_prf#2184,o_comment_prf#2185] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_2))
            :- Project [c_acctbal_prf#2188 AS c_acctbal_prf_2#2197, rid#2189 AS rid_2#2198, c_name_prf#2190 AS c_name_prf_2#2199, c_nationkey_prf#2191 AS c_nationkey_prf_2#2200, c_custkey_prf#2192 AS c_custkey_prf_2#2201, c_comment_prf#2193 AS c_comment_prf_2#2202, c_address_prf#2194 AS c_address_prf_2#2203, c_mktsegment_prf#2195 AS c_mktsegment_prf_2#2204, c_phone_prf#2196 AS c_phone_prf_2#2205]
            :  +- Relation[c_acctbal_prf#2188,rid#2189,c_name_prf#2190,c_nationkey_prf#2191,c_custkey_prf#2192,c_comment_prf#2193,c_address_prf#2194,c_mktsegment_prf#2195,c_phone_prf#2196] JDBCRelation(customer_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#2208]
               +- DexRidFilter customer~c_mktsegment~BUILDING
                  +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]

19/10/17 03:16:01 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=1214743
Elapsed time: 121388ms

fr1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and (c_mktsegment = 'BUILDING' and l_orderkey = o_orderkey)
19/10/17 03:18:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:18:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2283L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 03:18:03 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:18:03 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:18:03 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:18:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2283L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#2285 AS l_returnflag_prf_0#2304, l_orderkey_and_l_linenumber_prf#2286 AS l_orderkey_and_l_linenumber_prf_0#2305, l_comment_prf#2287 AS l_comment_prf_0#2306, l_linestatus_prf#2288 AS l_linestatus_prf_0#2307, rid#2289 AS rid_0#2308, l_shipmode_prf#2290 AS l_shipmode_prf_0#2309, l_shipinstruct_prf#2291 AS l_shipinstruct_prf_0#2310, l_quantity_prf#2292 AS l_quantity_prf_0#2311, l_receiptdate_prf#2293 AS l_receiptdate_prf_0#2312, l_linenumber_prf#2294 AS l_linenumber_prf_0#2313, l_tax_prf#2295 AS l_tax_prf_0#2314, l_shipdate_prf#2296 AS l_shipdate_prf_0#2315, l_extendedprice_prf#2297 AS l_extendedprice_prf_0#2316, l_partkey_prf#2298 AS l_partkey_prf_0#2317, l_discount_prf#2299 AS l_discount_prf_0#2318, l_partkey_and_l_suppkey_prf#2300 AS l_partkey_and_l_suppkey_prf_0#2319, l_commitdate_prf#2301 AS l_commitdate_prf_0#2320, l_suppkey_prf#2302 AS l_suppkey_prf_0#2321, l_orderkey_prf#2303 AS l_orderkey_prf_0#2322]
         :  :  +- Relation[l_returnflag_prf#2285,l_orderkey_and_l_linenumber_prf#2286,l_comment_prf#2287,l_linestatus_prf#2288,rid#2289,l_shipmode_prf#2290,l_shipinstruct_prf#2291,l_quantity_prf#2292,l_receiptdate_prf#2293,l_linenumber_prf#2294,l_tax_prf#2295,l_shipdate_prf#2296,l_extendedprice_prf#2297,l_partkey_prf#2298,l_discount_prf#2299,l_partkey_and_l_suppkey_prf#2300,l_commitdate_prf#2301,l_suppkey_prf#2302,l_orderkey_prf#2303] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_2#2343]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2342]
         :        :  +- Relation[l_returnflag_prf#2323,l_orderkey_and_l_linenumber_prf#2324,l_comment_prf#2325,l_linestatus_prf#2326,rid#2327,l_shipmode_prf#2328,l_shipinstruct_prf#2329,l_quantity_prf#2330,l_receiptdate_prf#2331,l_linenumber_prf#2332,l_tax_prf#2333,l_shipdate_prf#2334,l_extendedprice_prf#2335,l_partkey_prf#2336,l_discount_prf#2337,l_partkey_and_l_suppkey_prf#2338,l_commitdate_prf#2339,l_suppkey_prf#2340,l_orderkey_prf#2341] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#2363]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#2354: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [c_acctbal_prf#2344 AS c_acctbal_prf_1#2353, rid#2345 AS rid_1#2354, c_name_prf#2346 AS c_name_prf_1#2355, c_nationkey_prf#2347 AS c_nationkey_prf_1#2356, c_custkey_prf#2348 AS c_custkey_prf_1#2357, c_comment_prf#2349 AS c_comment_prf_1#2358, c_address_prf#2350 AS c_address_prf_1#2359, c_mktsegment_prf#2351 AS c_mktsegment_prf_1#2360, c_phone_prf#2352 AS c_phone_prf_1#2361]
            :     :  :  +- Relation[c_acctbal_prf#2344,rid#2345,c_name_prf#2346,c_nationkey_prf#2347,c_custkey_prf#2348,c_comment_prf#2349,c_address_prf#2350,c_mktsegment_prf#2351,c_phone_prf#2352] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2362]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2364 AS o_shippriority_prf_2#2374, rid#2365 AS rid_2#2375, o_orderdate_prf#2366 AS o_orderdate_prf_2#2376, o_custkey_prf#2367 AS o_custkey_prf_2#2377, o_orderpriority_prf#2368 AS o_orderpriority_prf_2#2378, o_clerk_prf#2369 AS o_clerk_prf_2#2379, o_orderstatus_prf#2370 AS o_orderstatus_prf_2#2380, o_totalprice_prf#2371 AS o_totalprice_prf_2#2381, o_orderkey_prf#2372 AS o_orderkey_prf_2#2382, o_comment_prf#2373 AS o_comment_prf_2#2383]
               +- Relation[o_shippriority_prf#2364,rid#2365,o_orderdate_prf#2366,o_custkey_prf#2367,o_orderpriority_prf#2368,o_clerk_prf#2369,o_orderstatus_prf#2370,o_totalprice_prf#2371,o_orderkey_prf#2372,o_comment_prf#2373] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 82976ms

ft1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_name = 'FRANCE' and n_nationkey = c_nationkey
19/10/17 03:19:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:19:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2444L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 03:19:26 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:19:26 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:19:26 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:19:26 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:19:26 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:19:26 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:19:26 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:19:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2444L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#2483]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [s_phone_prf#2446 AS s_phone_prf_0#2454, rid#2447 AS rid_0#2455, s_address_prf#2448 AS s_address_prf_0#2456, s_nationkey_prf#2449 AS s_nationkey_prf_0#2457, s_suppkey_prf#2450 AS s_suppkey_prf_0#2458, s_name_prf#2451 AS s_name_prf_0#2459, s_acctbal_prf#2452 AS s_acctbal_prf_0#2460, s_comment_prf#2453 AS s_comment_prf_0#2461]
         :     :  :  :  +- Relation[s_phone_prf#2446,rid#2447,s_address_prf#2448,s_nationkey_prf#2449,s_suppkey_prf#2450,s_name_prf#2451,s_acctbal_prf#2452,s_comment_prf#2453] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#2471]
         :     :  :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#2470]
         :     :  :        :  +- Relation[s_phone_prf#2462,rid#2463,s_address_prf#2464,s_nationkey_prf#2465,s_suppkey_prf#2466,s_name_prf#2467,s_acctbal_prf#2468,s_comment_prf#2469] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [rid#2472 AS rid_1#2477, n_regionkey_prf#2473 AS n_regionkey_prf_1#2478, n_nationkey_prf#2474 AS n_nationkey_prf_1#2479, n_name_prf#2475 AS n_name_prf_1#2480, n_comment_prf#2476 AS n_comment_prf_1#2481]
         :     :     :  +- Relation[rid#2472,n_regionkey_prf#2473,n_nationkey_prf#2474,n_name_prf#2475,n_comment_prf#2476] JDBCRelation(nation_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2482]
         :     :        +- DexRidFilter nation~n_name~FRANCE
         :     :           +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2484 AS c_acctbal_prf_2#2493, rid#2485 AS rid_2#2494, c_name_prf#2486 AS c_name_prf_2#2495, c_nationkey_prf#2487 AS c_nationkey_prf_2#2496, c_custkey_prf#2488 AS c_custkey_prf_2#2497, c_comment_prf#2489 AS c_comment_prf_2#2498, c_address_prf#2490 AS c_address_prf_2#2499, c_mktsegment_prf#2491 AS c_mktsegment_prf_2#2500, c_phone_prf#2492 AS c_phone_prf_2#2501]
            +- Relation[c_acctbal_prf#2484,rid#2485,c_name_prf#2486,c_nationkey_prf#2487,c_custkey_prf#2488,c_comment_prf#2489,c_address_prf#2490,c_mktsegment_prf#2491,c_phone_prf#2492] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 47972ms

ft1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/17 03:20:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:20:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2546L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/17 03:20:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:20:14 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:20:14 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:20:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:20:14 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:20:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:20:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:20:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2546L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#2548 AS c_acctbal_prf_0#2557, rid#2549 AS rid_0#2558, c_name_prf#2550 AS c_name_prf_0#2559, c_nationkey_prf#2551 AS c_nationkey_prf_0#2560, c_custkey_prf#2552 AS c_custkey_prf_0#2561, c_comment_prf#2553 AS c_comment_prf_0#2562, c_address_prf#2554 AS c_address_prf_0#2563, c_mktsegment_prf#2555 AS c_mktsegment_prf_0#2564, c_phone_prf#2556 AS c_phone_prf_0#2565]
         :  :  +- Relation[c_acctbal_prf#2548,rid#2549,c_name_prf#2550,c_nationkey_prf#2551,c_custkey_prf#2552,c_comment_prf#2553,c_address_prf#2554,c_mktsegment_prf#2555,c_phone_prf#2556] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_2#2576]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2575]
         :        :  +- Relation[c_acctbal_prf#2566,rid#2567,c_name_prf#2568,c_nationkey_prf#2569,c_custkey_prf#2570,c_comment_prf#2571,c_address_prf#2572,c_mktsegment_prf#2573,c_phone_prf#2574] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [s_phone_prf#2577 AS s_phone_prf_1#2585, rid#2578 AS rid_1#2586, s_address_prf#2579 AS s_address_prf_1#2587, s_nationkey_prf#2580 AS s_nationkey_prf_1#2588, s_suppkey_prf#2581 AS s_suppkey_prf_1#2589, s_name_prf#2582 AS s_name_prf_1#2590, s_acctbal_prf#2583 AS s_acctbal_prf_1#2591, s_comment_prf#2584 AS s_comment_prf_1#2592]
            :  :  +- Relation[s_phone_prf#2577,rid#2578,s_address_prf#2579,s_nationkey_prf#2580,s_suppkey_prf#2581,s_name_prf#2582,s_acctbal_prf#2583,s_comment_prf#2584] JDBCRelation(supplier_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#2602]
            :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#2601]
            :        :  +- Relation[s_phone_prf#2593,rid#2594,s_address_prf#2595,s_nationkey_prf#2596,s_suppkey_prf#2597,s_name_prf#2598,s_acctbal_prf#2599,s_comment_prf#2600] JDBCRelation(supplier_prf) [numPartitions=1]
            :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [rid#2603 AS rid_2#2608, n_regionkey_prf#2604 AS n_regionkey_prf_2#2609, n_nationkey_prf#2605 AS n_nationkey_prf_2#2610, n_name_prf#2606 AS n_name_prf_2#2611, n_comment_prf#2607 AS n_comment_prf_2#2612]
               :  +- Relation[rid#2603,n_regionkey_prf#2604,n_nationkey_prf#2605,n_name_prf#2606,n_comment_prf#2607] JDBCRelation(nation_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#2613]
                  +- DexRidFilter nation~n_name~FRANCE
                     +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 33069ms

fq1b=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 03:20:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:20:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2676L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 03:20:47 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:20:47 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:20:47 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:20:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2676L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#2708]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#2689]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#2683: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#2678 AS rid_0#2683, n_regionkey_prf#2679 AS n_regionkey_prf_0#2684, n_nationkey_prf#2680 AS n_nationkey_prf_0#2685, n_name_prf#2681 AS n_name_prf_0#2686, n_comment_prf#2682 AS n_comment_prf_0#2687]
         :     :  :     :  :  +- Relation[rid#2678,n_regionkey_prf#2679,n_nationkey_prf#2680,n_name_prf#2681,n_comment_prf#2682] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2688]
         :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :        +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#2690 AS c_acctbal_prf_1#2699, rid#2691 AS rid_1#2700, c_name_prf#2692 AS c_name_prf_1#2701, c_nationkey_prf#2693 AS c_nationkey_prf_1#2702, c_custkey_prf#2694 AS c_custkey_prf_1#2703, c_comment_prf#2695 AS c_comment_prf_1#2704, c_address_prf#2696 AS c_address_prf_1#2705, c_mktsegment_prf#2697 AS c_mktsegment_prf_1#2706, c_phone_prf#2698 AS c_phone_prf_1#2707]
         :     :     +- Relation[c_acctbal_prf#2690,rid#2691,c_name_prf#2692,c_nationkey_prf#2693,c_custkey_prf#2694,c_comment_prf#2695,c_address_prf#2696,c_mktsegment_prf#2697,c_phone_prf#2698] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- Project [o_shippriority_prf#2709 AS o_shippriority_prf_2#2719, rid#2710 AS rid_2#2720, o_orderdate_prf#2711 AS o_orderdate_prf_2#2721, o_custkey_prf#2712 AS o_custkey_prf_2#2722, o_orderpriority_prf#2713 AS o_orderpriority_prf_2#2723, o_clerk_prf#2714 AS o_clerk_prf_2#2724, o_orderstatus_prf#2715 AS o_orderstatus_prf_2#2725, o_totalprice_prf#2716 AS o_totalprice_prf_2#2726, o_orderkey_prf#2717 AS o_orderkey_prf_2#2727, o_comment_prf#2718 AS o_comment_prf_2#2728]
            :  :  +- Relation[o_shippriority_prf#2709,rid#2710,o_orderdate_prf#2711,o_custkey_prf#2712,o_orderpriority_prf#2713,o_clerk_prf#2714,o_orderstatus_prf#2715,o_totalprice_prf#2716,o_orderkey_prf#2717,o_comment_prf#2718] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2154) AS rid_3#2740]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#2739]
            :        :  +- Relation[o_shippriority_prf#2729,rid#2730,o_orderdate_prf#2731,o_custkey_prf#2732,o_orderpriority_prf#2733,o_clerk_prf#2734,o_orderstatus_prf#2735,o_totalprice_prf#2736,o_orderkey_prf#2737,o_comment_prf#2738] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2741 AS l_returnflag_prf_3#2760, l_orderkey_and_l_linenumber_prf#2742 AS l_orderkey_and_l_linenumber_prf_3#2761, l_comment_prf#2743 AS l_comment_prf_3#2762, l_linestatus_prf#2744 AS l_linestatus_prf_3#2763, rid#2745 AS rid_3#2764, l_shipmode_prf#2746 AS l_shipmode_prf_3#2765, l_shipinstruct_prf#2747 AS l_shipinstruct_prf_3#2766, l_quantity_prf#2748 AS l_quantity_prf_3#2767, l_receiptdate_prf#2749 AS l_receiptdate_prf_3#2768, l_linenumber_prf#2750 AS l_linenumber_prf_3#2769, l_tax_prf#2751 AS l_tax_prf_3#2770, l_shipdate_prf#2752 AS l_shipdate_prf_3#2771, l_extendedprice_prf#2753 AS l_extendedprice_prf_3#2772, l_partkey_prf#2754 AS l_partkey_prf_3#2773, l_discount_prf#2755 AS l_discount_prf_3#2774, l_partkey_and_l_suppkey_prf#2756 AS l_partkey_and_l_suppkey_prf_3#2775, l_commitdate_prf#2757 AS l_commitdate_prf_3#2776, l_suppkey_prf#2758 AS l_suppkey_prf_3#2777, l_orderkey_prf#2759 AS l_orderkey_prf_3#2778]
               +- Relation[l_returnflag_prf#2741,l_orderkey_and_l_linenumber_prf#2742,l_comment_prf#2743,l_linestatus_prf#2744,rid#2745,l_shipmode_prf#2746,l_shipinstruct_prf#2747,l_quantity_prf#2748,l_receiptdate_prf#2749,l_linenumber_prf#2750,l_tax_prf#2751,l_shipdate_prf#2752,l_extendedprice_prf#2753,l_partkey_prf#2754,l_discount_prf#2755,l_partkey_and_l_suppkey_prf#2756,l_commitdate_prf#2757,l_suppkey_prf#2758,l_orderkey_prf#2759] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 140142ms

fq1a=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 03:23:07 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:23:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2862L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :     :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 03:23:07 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:23:07 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:23:07 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:23:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2862L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, 'rid_2, 'o_shippriority_prf_2, 'o_orderdate_prf_2, 'o_custkey_prf_2, 'o_orderpriority_prf_2, 'o_clerk_prf_2, 'o_orderstatus_prf_2, 'o_totalprice_prf_2, 'o_orderkey_prf_2, 'o_comment_prf_2, dexdecrypt('value_dec_key, value#2154) AS rid_3#2915]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#2894]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#2875]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#2869: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [rid#2864 AS rid_0#2869, n_regionkey_prf#2865 AS n_regionkey_prf_0#2870, n_nationkey_prf#2866 AS n_nationkey_prf_0#2871, n_name_prf#2867 AS n_name_prf_0#2872, n_comment_prf#2868 AS n_comment_prf_0#2873]
         :     :  :     :  :     :  :  +- Relation[rid#2864,n_regionkey_prf#2865,n_nationkey_prf#2866,n_name_prf#2867,n_comment_prf#2868] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2874]
         :     :  :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :  :     :        +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [c_acctbal_prf#2876 AS c_acctbal_prf_1#2885, rid#2877 AS rid_1#2886, c_name_prf#2878 AS c_name_prf_1#2887, c_nationkey_prf#2879 AS c_nationkey_prf_1#2888, c_custkey_prf#2880 AS c_custkey_prf_1#2889, c_comment_prf#2881 AS c_comment_prf_1#2890, c_address_prf#2882 AS c_address_prf_1#2891, c_mktsegment_prf#2883 AS c_mktsegment_prf_1#2892, c_phone_prf#2884 AS c_phone_prf_1#2893]
         :     :  :     :     +- Relation[c_acctbal_prf#2876,rid#2877,c_name_prf#2878,c_nationkey_prf#2879,c_custkey_prf#2880,c_comment_prf#2881,c_address_prf#2882,c_mktsegment_prf#2883,c_phone_prf#2884] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#2895 AS o_shippriority_prf_2#2905, rid#2896 AS rid_2#2906, o_orderdate_prf#2897 AS o_orderdate_prf_2#2907, o_custkey_prf#2898 AS o_custkey_prf_2#2908, o_orderpriority_prf#2899 AS o_orderpriority_prf_2#2909, o_clerk_prf#2900 AS o_clerk_prf_2#2910, o_orderstatus_prf#2901 AS o_orderstatus_prf_2#2911, o_totalprice_prf#2902 AS o_totalprice_prf_2#2912, o_orderkey_prf#2903 AS o_orderkey_prf_2#2913, o_comment_prf#2904 AS o_comment_prf_2#2914]
         :     :     +- Relation[o_shippriority_prf#2895,rid#2896,o_orderdate_prf#2897,o_custkey_prf#2898,o_orderpriority_prf#2899,o_clerk_prf#2900,o_orderstatus_prf#2901,o_totalprice_prf#2902,o_orderkey_prf#2903,o_comment_prf#2904] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2916 AS l_returnflag_prf_3#2935, l_orderkey_and_l_linenumber_prf#2917 AS l_orderkey_and_l_linenumber_prf_3#2936, l_comment_prf#2918 AS l_comment_prf_3#2937, l_linestatus_prf#2919 AS l_linestatus_prf_3#2938, rid#2920 AS rid_3#2939, l_shipmode_prf#2921 AS l_shipmode_prf_3#2940, l_shipinstruct_prf#2922 AS l_shipinstruct_prf_3#2941, l_quantity_prf#2923 AS l_quantity_prf_3#2942, l_receiptdate_prf#2924 AS l_receiptdate_prf_3#2943, l_linenumber_prf#2925 AS l_linenumber_prf_3#2944, l_tax_prf#2926 AS l_tax_prf_3#2945, l_shipdate_prf#2927 AS l_shipdate_prf_3#2946, l_extendedprice_prf#2928 AS l_extendedprice_prf_3#2947, l_partkey_prf#2929 AS l_partkey_prf_3#2948, l_discount_prf#2930 AS l_discount_prf_3#2949, l_partkey_and_l_suppkey_prf#2931 AS l_partkey_and_l_suppkey_prf_3#2950, l_commitdate_prf#2932 AS l_commitdate_prf_3#2951, l_suppkey_prf#2933 AS l_suppkey_prf_3#2952, l_orderkey_prf#2934 AS l_orderkey_prf_3#2953]
            +- Relation[l_returnflag_prf#2916,l_orderkey_and_l_linenumber_prf#2917,l_comment_prf#2918,l_linestatus_prf#2919,rid#2920,l_shipmode_prf#2921,l_shipinstruct_prf#2922,l_quantity_prf#2923,l_receiptdate_prf#2924,l_linenumber_prf#2925,l_tax_prf#2926,l_shipdate_prf#2927,l_extendedprice_prf#2928,l_partkey_prf#2929,l_discount_prf#2930,l_partkey_and_l_suppkey_prf#2931,l_commitdate_prf#2932,l_suppkey_prf#2933,l_orderkey_prf#2934] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 30879ms

ft3b=
select * from part, lineitem, supplier where p_size = 15 and p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/17 03:23:38 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:23:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3032L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 03:23:38 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:23:38 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:23:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3032L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#3055]
         :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3046: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [p_comment_prf#3034 AS p_comment_prf_0#3044, p_name_prf#3035 AS p_name_prf_0#3045, rid#3036 AS rid_0#3046, p_type_prf#3037 AS p_type_prf_0#3047, p_retailprice_prf#3038 AS p_retailprice_prf_0#3048, p_mfgr_prf#3039 AS p_mfgr_prf_0#3049, p_container_prf#3040 AS p_container_prf_0#3050, p_brand_prf#3041 AS p_brand_prf_0#3051, p_size_prf#3042 AS p_size_prf_0#3052, p_partkey_prf#3043 AS p_partkey_prf_0#3053]
         :     :  :     :  :  +- Relation[p_comment_prf#3034,p_name_prf#3035,rid#3036,p_type_prf#3037,p_retailprice_prf#3038,p_mfgr_prf#3039,p_container_prf#3040,p_brand_prf#3041,p_size_prf#3042,p_partkey_prf#3043] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3054]
         :     :  :     :     +- DexRidFilter part~p_size~15
         :     :  :     :        +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#3056 AS l_returnflag_prf_1#3075, l_orderkey_and_l_linenumber_prf#3057 AS l_orderkey_and_l_linenumber_prf_1#3076, l_comment_prf#3058 AS l_comment_prf_1#3077, l_linestatus_prf#3059 AS l_linestatus_prf_1#3078, rid#3060 AS rid_1#3079, l_shipmode_prf#3061 AS l_shipmode_prf_1#3080, l_shipinstruct_prf#3062 AS l_shipinstruct_prf_1#3081, l_quantity_prf#3063 AS l_quantity_prf_1#3082, l_receiptdate_prf#3064 AS l_receiptdate_prf_1#3083, l_linenumber_prf#3065 AS l_linenumber_prf_1#3084, l_tax_prf#3066 AS l_tax_prf_1#3085, l_shipdate_prf#3067 AS l_shipdate_prf_1#3086, l_extendedprice_prf#3068 AS l_extendedprice_prf_1#3087, l_partkey_prf#3069 AS l_partkey_prf_1#3088, l_discount_prf#3070 AS l_discount_prf_1#3089, l_partkey_and_l_suppkey_prf#3071 AS l_partkey_and_l_suppkey_prf_1#3090, l_commitdate_prf#3072 AS l_commitdate_prf_1#3091, l_suppkey_prf#3073 AS l_suppkey_prf_1#3092, l_orderkey_prf#3074 AS l_orderkey_prf_1#3093]
         :     :     +- Relation[l_returnflag_prf#3056,l_orderkey_and_l_linenumber_prf#3057,l_comment_prf#3058,l_linestatus_prf#3059,rid#3060,l_shipmode_prf#3061,l_shipinstruct_prf#3062,l_quantity_prf#3063,l_receiptdate_prf#3064,l_linenumber_prf#3065,l_tax_prf#3066,l_shipdate_prf#3067,l_extendedprice_prf#3068,l_partkey_prf#3069,l_discount_prf#3070,l_partkey_and_l_suppkey_prf#3071,l_commitdate_prf#3072,l_suppkey_prf#3073,l_orderkey_prf#3074] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3095 AS s_phone_prf_2#3103, rid#3096 AS rid_2#3104, s_address_prf#3097 AS s_address_prf_2#3105, s_nationkey_prf#3098 AS s_nationkey_prf_2#3106, s_suppkey_prf#3099 AS s_suppkey_prf_2#3107, s_name_prf#3100 AS s_name_prf_2#3108, s_acctbal_prf#3101 AS s_acctbal_prf_2#3109, s_comment_prf#3102 AS s_comment_prf_2#3110]
            +- Relation[s_phone_prf#3095,rid#3096,s_address_prf#3097,s_nationkey_prf#3098,s_suppkey_prf#3099,s_name_prf#3100,s_acctbal_prf#3101,s_comment_prf#3102] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 6158ms

ft2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and (p_size = 15 and s_suppkey = ps_suppkey)
19/10/17 03:23:44 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:23:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3172L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/17 03:23:44 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:23:44 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:23:44 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 03:23:44 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:23:44 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 03:23:44 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 03:23:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3172L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#3174 AS s_phone_prf_0#3182, rid#3175 AS rid_0#3183, s_address_prf#3176 AS s_address_prf_0#3184, s_nationkey_prf#3177 AS s_nationkey_prf_0#3185, s_suppkey_prf#3178 AS s_suppkey_prf_0#3186, s_name_prf#3179 AS s_name_prf_0#3187, s_acctbal_prf#3180 AS s_acctbal_prf_0#3188, s_comment_prf#3181 AS s_comment_prf_0#3189]
         :  :  +- Relation[s_phone_prf#3174,rid#3175,s_address_prf#3176,s_nationkey_prf#3177,s_suppkey_prf#3178,s_name_prf#3179,s_acctbal_prf#3180,s_comment_prf#3181] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_2#3199]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3198]
         :        :  +- Relation[s_phone_prf#3190,rid#3191,s_address_prf#3192,s_nationkey_prf#3193,s_suppkey_prf#3194,s_name_prf#3195,s_acctbal_prf#3196,s_comment_prf#3197] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#3221]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#3212: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#3200 AS p_comment_prf_1#3210, p_name_prf#3201 AS p_name_prf_1#3211, rid#3202 AS rid_1#3212, p_type_prf#3203 AS p_type_prf_1#3213, p_retailprice_prf#3204 AS p_retailprice_prf_1#3214, p_mfgr_prf#3205 AS p_mfgr_prf_1#3215, p_container_prf#3206 AS p_container_prf_1#3216, p_brand_prf#3207 AS p_brand_prf_1#3217, p_size_prf#3208 AS p_size_prf_1#3218, p_partkey_prf#3209 AS p_partkey_prf_1#3219]
            :     :  :  +- Relation[p_comment_prf#3200,p_name_prf#3201,rid#3202,p_type_prf#3203,p_retailprice_prf#3204,p_mfgr_prf#3205,p_container_prf#3206,p_brand_prf#3207,p_size_prf#3208,p_partkey_prf#3209] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3220]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#3222 AS ps_partkey_and_ps_suppkey_prf_2#3229, rid#3223 AS rid_2#3230, ps_availqty_prf#3224 AS ps_availqty_prf_2#3231, ps_comment_prf#3225 AS ps_comment_prf_2#3232, ps_partkey_prf#3226 AS ps_partkey_prf_2#3233, ps_supplycost_prf#3227 AS ps_supplycost_prf_2#3234, ps_suppkey_prf#3228 AS ps_suppkey_prf_2#3235]
               +- Relation[ps_partkey_and_ps_suppkey_prf#3222,rid#3223,ps_availqty_prf#3224,ps_comment_prf#3225,ps_partkey_prf#3226,ps_supplycost_prf#3227,ps_suppkey_prf#3228] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 7017ms

fr2f=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/17 03:23:51 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:23:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3297L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_orderkey#342L, o_custkey#343L]
         :     :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L]
         :        +- Filter isnotnull(c_custkey#290L)
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 03:23:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3297L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#3339]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#3320]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_0#3310: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [o_shippriority_prf#3299 AS o_shippriority_prf_0#3309, rid#3300 AS rid_0#3310, o_orderdate_prf#3301 AS o_orderdate_prf_0#3311, o_custkey_prf#3302 AS o_custkey_prf_0#3312, o_orderpriority_prf#3303 AS o_orderpriority_prf_0#3313, o_clerk_prf#3304 AS o_clerk_prf_0#3314, o_orderstatus_prf#3305 AS o_orderstatus_prf_0#3315, o_totalprice_prf#3306 AS o_totalprice_prf_0#3316, o_orderkey_prf#3307 AS o_orderkey_prf_0#3317, o_comment_prf#3308 AS o_comment_prf_0#3318]
         :     :  :     :  :  +- Relation[o_shippriority_prf#3299,rid#3300,o_orderdate_prf#3301,o_custkey_prf#3302,o_orderpriority_prf#3303,o_clerk_prf#3304,o_orderstatus_prf#3305,o_totalprice_prf#3306,o_orderkey_prf#3307,o_comment_prf#3308] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3319]
         :     :  :     :     +- DexRidFilter orders~o_orderstatus~F
         :     :  :     :        +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#3321 AS c_acctbal_prf_1#3330, rid#3322 AS rid_1#3331, c_name_prf#3323 AS c_name_prf_1#3332, c_nationkey_prf#3324 AS c_nationkey_prf_1#3333, c_custkey_prf#3325 AS c_custkey_prf_1#3334, c_comment_prf#3326 AS c_comment_prf_1#3335, c_address_prf#3327 AS c_address_prf_1#3336, c_mktsegment_prf#3328 AS c_mktsegment_prf_1#3337, c_phone_prf#3329 AS c_phone_prf_1#3338]
         :     :     +- Relation[c_acctbal_prf#3321,rid#3322,c_name_prf#3323,c_nationkey_prf#3324,c_custkey_prf#3325,c_comment_prf#3326,c_address_prf#3327,c_mktsegment_prf#3328,c_phone_prf#3329] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3340 AS l_returnflag_prf_2#3359, l_orderkey_and_l_linenumber_prf#3341 AS l_orderkey_and_l_linenumber_prf_2#3360, l_comment_prf#3342 AS l_comment_prf_2#3361, l_linestatus_prf#3343 AS l_linestatus_prf_2#3362, rid#3344 AS rid_2#3363, l_shipmode_prf#3345 AS l_shipmode_prf_2#3364, l_shipinstruct_prf#3346 AS l_shipinstruct_prf_2#3365, l_quantity_prf#3347 AS l_quantity_prf_2#3366, l_receiptdate_prf#3348 AS l_receiptdate_prf_2#3367, l_linenumber_prf#3349 AS l_linenumber_prf_2#3368, l_tax_prf#3350 AS l_tax_prf_2#3369, l_shipdate_prf#3351 AS l_shipdate_prf_2#3370, l_extendedprice_prf#3352 AS l_extendedprice_prf_2#3371, l_partkey_prf#3353 AS l_partkey_prf_2#3372, l_discount_prf#3354 AS l_discount_prf_2#3373, l_partkey_and_l_suppkey_prf#3355 AS l_partkey_and_l_suppkey_prf_2#3374, l_commitdate_prf#3356 AS l_commitdate_prf_2#3375, l_suppkey_prf#3357 AS l_suppkey_prf_2#3376, l_orderkey_prf#3358 AS l_orderkey_prf_2#3377]
            +- Relation[l_returnflag_prf#3340,l_orderkey_and_l_linenumber_prf#3341,l_comment_prf#3342,l_linestatus_prf#3343,rid#3344,l_shipmode_prf#3345,l_shipinstruct_prf#3346,l_quantity_prf#3347,l_receiptdate_prf#3348,l_linenumber_prf#3349,l_tax_prf#3350,l_shipdate_prf#3351,l_extendedprice_prf#3352,l_partkey_prf#3353,l_discount_prf#3354,l_partkey_and_l_suppkey_prf#3355,l_commitdate_prf#3356,l_suppkey_prf#3357,l_orderkey_prf#3358] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 83175ms

fs1c=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/17 03:25:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:25:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3461L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_orderkey#306L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 03:25:14 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:25:14 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:25:14 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:25:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3461L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [p_comment_prf#3463 AS p_comment_prf_0#3473, p_name_prf#3464 AS p_name_prf_0#3474, rid#3465 AS rid_0#3475, p_type_prf#3466 AS p_type_prf_0#3476, p_retailprice_prf#3467 AS p_retailprice_prf_0#3477, p_mfgr_prf#3468 AS p_mfgr_prf_0#3478, p_container_prf#3469 AS p_container_prf_0#3479, p_brand_prf#3470 AS p_brand_prf_0#3480, p_size_prf#3471 AS p_size_prf_0#3481, p_partkey_prf#3472 AS p_partkey_prf_0#3482]
         :  :  :  :  +- Relation[p_comment_prf#3463,p_name_prf#3464,rid#3465,p_type_prf#3466,p_retailprice_prf#3467,p_mfgr_prf#3468,p_container_prf#3469,p_brand_prf#3470,p_size_prf#3471,p_partkey_prf#3472] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#3494]
         :  :  :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#3493]
         :  :  :        :  +- Relation[p_comment_prf#3483,p_name_prf#3484,rid#3485,p_type_prf#3486,p_retailprice_prf#3487,p_mfgr_prf#3488,p_container_prf#3489,p_brand_prf#3490,p_size_prf#3491,p_partkey_prf#3492] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#3495 AS l_returnflag_prf_1#3514, l_orderkey_and_l_linenumber_prf#3496 AS l_orderkey_and_l_linenumber_prf_1#3515, l_comment_prf#3497 AS l_comment_prf_1#3516, l_linestatus_prf#3498 AS l_linestatus_prf_1#3517, rid#3499 AS rid_1#3518, l_shipmode_prf#3500 AS l_shipmode_prf_1#3519, l_shipinstruct_prf#3501 AS l_shipinstruct_prf_1#3520, l_quantity_prf#3502 AS l_quantity_prf_1#3521, l_receiptdate_prf#3503 AS l_receiptdate_prf_1#3522, l_linenumber_prf#3504 AS l_linenumber_prf_1#3523, l_tax_prf#3505 AS l_tax_prf_1#3524, l_shipdate_prf#3506 AS l_shipdate_prf_1#3525, l_extendedprice_prf#3507 AS l_extendedprice_prf_1#3526, l_partkey_prf#3508 AS l_partkey_prf_1#3527, l_discount_prf#3509 AS l_discount_prf_1#3528, l_partkey_and_l_suppkey_prf#3510 AS l_partkey_and_l_suppkey_prf_1#3529, l_commitdate_prf#3511 AS l_commitdate_prf_1#3530, l_suppkey_prf#3512 AS l_suppkey_prf_1#3531, l_orderkey_prf#3513 AS l_orderkey_prf_1#3532]
         :  :     +- Relation[l_returnflag_prf#3495,l_orderkey_and_l_linenumber_prf#3496,l_comment_prf#3497,l_linestatus_prf#3498,rid#3499,l_shipmode_prf#3500,l_shipinstruct_prf#3501,l_quantity_prf#3502,l_receiptdate_prf#3503,l_linenumber_prf#3504,l_tax_prf#3505,l_shipdate_prf#3506,l_extendedprice_prf#3507,l_partkey_prf#3508,l_discount_prf#3509,l_partkey_and_l_suppkey_prf#3510,l_commitdate_prf#3511,l_suppkey_prf#3512,l_orderkey_prf#3513] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2154) AS rid_3#3553]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3552]
         :        :  +- Relation[l_returnflag_prf#3533,l_orderkey_and_l_linenumber_prf#3534,l_comment_prf#3535,l_linestatus_prf#3536,rid#3537,l_shipmode_prf#3538,l_shipinstruct_prf#3539,l_quantity_prf#3540,l_receiptdate_prf#3541,l_linenumber_prf#3542,l_tax_prf#3543,l_shipdate_prf#3544,l_extendedprice_prf#3545,l_partkey_prf#3546,l_discount_prf#3547,l_partkey_and_l_suppkey_prf#3548,l_commitdate_prf#3549,l_suppkey_prf#3550,l_orderkey_prf#3551] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_2, 'rid_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2154) AS rid_3#3573]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_2#3564: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [c_acctbal_prf#3554 AS c_acctbal_prf_2#3563, rid#3555 AS rid_2#3564, c_name_prf#3556 AS c_name_prf_2#3565, c_nationkey_prf#3557 AS c_nationkey_prf_2#3566, c_custkey_prf#3558 AS c_custkey_prf_2#3567, c_comment_prf#3559 AS c_comment_prf_2#3568, c_address_prf#3560 AS c_address_prf_2#3569, c_mktsegment_prf#3561 AS c_mktsegment_prf_2#3570, c_phone_prf#3562 AS c_phone_prf_2#3571]
            :     :  :  +- Relation[c_acctbal_prf#3554,rid#3555,c_name_prf#3556,c_nationkey_prf#3557,c_custkey_prf#3558,c_comment_prf#3559,c_address_prf#3560,c_mktsegment_prf#3561,c_phone_prf#3562] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#3572]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3574 AS o_shippriority_prf_3#3584, rid#3575 AS rid_3#3585, o_orderdate_prf#3576 AS o_orderdate_prf_3#3586, o_custkey_prf#3577 AS o_custkey_prf_3#3587, o_orderpriority_prf#3578 AS o_orderpriority_prf_3#3588, o_clerk_prf#3579 AS o_clerk_prf_3#3589, o_orderstatus_prf#3580 AS o_orderstatus_prf_3#3590, o_totalprice_prf#3581 AS o_totalprice_prf_3#3591, o_orderkey_prf#3582 AS o_orderkey_prf_3#3592, o_comment_prf#3583 AS o_comment_prf_3#3593]
               +- Relation[o_shippriority_prf#3574,rid#3575,o_orderdate_prf#3576,o_custkey_prf#3577,o_orderpriority_prf#3578,o_clerk_prf#3579,o_orderstatus_prf#3580,o_totalprice_prf#3581,o_orderkey_prf#3582,o_comment_prf#3583] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 173085ms

ft2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and p_size = 15 and ps_suppkey = s_suppkey
19/10/17 03:28:07 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:28:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3666L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 03:28:07 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 03:28:07 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 03:28:07 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 03:28:07 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 03:28:07 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:28:07 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:28:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3666L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#3712]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, rid_0#3676: string
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [ps_partkey_and_ps_suppkey_prf#3668 AS ps_partkey_and_ps_suppkey_prf_0#3675, rid#3669 AS rid_0#3676, ps_availqty_prf#3670 AS ps_availqty_prf_0#3677, ps_comment_prf#3671 AS ps_comment_prf_0#3678, ps_partkey_prf#3672 AS ps_partkey_prf_0#3679, ps_supplycost_prf#3673 AS ps_supplycost_prf_0#3680, ps_suppkey_prf#3674 AS ps_suppkey_prf_0#3681]
         :     :  :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#3668,rid#3669,ps_availqty_prf#3670,ps_comment_prf#3671,ps_partkey_prf#3672,ps_supplycost_prf#3673,ps_suppkey_prf#3674] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#3690]
         :     :  :     +- 'DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#3689]
         :     :  :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#3682,rid#3683,ps_availqty_prf#3684,ps_comment_prf#3685,ps_partkey_prf#3686,ps_supplycost_prf#3687,ps_suppkey_prf#3688] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [p_comment_prf#3691 AS p_comment_prf_1#3701, p_name_prf#3692 AS p_name_prf_1#3702, rid#3693 AS rid_1#3703, p_type_prf#3694 AS p_type_prf_1#3704, p_retailprice_prf#3695 AS p_retailprice_prf_1#3705, p_mfgr_prf#3696 AS p_mfgr_prf_1#3706, p_container_prf#3697 AS p_container_prf_1#3707, p_brand_prf#3698 AS p_brand_prf_1#3708, p_size_prf#3699 AS p_size_prf_1#3709, p_partkey_prf#3700 AS p_partkey_prf_1#3710]
         :     :     :  +- Relation[p_comment_prf#3691,p_name_prf#3692,rid#3693,p_type_prf#3694,p_retailprice_prf#3695,p_mfgr_prf#3696,p_container_prf#3697,p_brand_prf#3698,p_size_prf#3699,p_partkey_prf#3700] JDBCRelation(part_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3711]
         :     :        +- DexRidFilter part~p_size~15
         :     :           +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3713 AS s_phone_prf_2#3721, rid#3714 AS rid_2#3722, s_address_prf#3715 AS s_address_prf_2#3723, s_nationkey_prf#3716 AS s_nationkey_prf_2#3724, s_suppkey_prf#3717 AS s_suppkey_prf_2#3725, s_name_prf#3718 AS s_name_prf_2#3726, s_acctbal_prf#3719 AS s_acctbal_prf_2#3727, s_comment_prf#3720 AS s_comment_prf_2#3728]
            +- Relation[s_phone_prf#3713,rid#3714,s_address_prf#3715,s_nationkey_prf#3716,s_suppkey_prf#3717,s_name_prf#3718,s_acctbal_prf#3719,s_comment_prf#3720] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 49337ms

ft3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and (p_size = 15 and s_suppkey = l_suppkey)
19/10/17 03:28:56 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:28:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3789L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 03:28:56 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:28:56 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:28:56 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:28:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3789L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#3791 AS s_phone_prf_0#3799, rid#3792 AS rid_0#3800, s_address_prf#3793 AS s_address_prf_0#3801, s_nationkey_prf#3794 AS s_nationkey_prf_0#3802, s_suppkey_prf#3795 AS s_suppkey_prf_0#3803, s_name_prf#3796 AS s_name_prf_0#3804, s_acctbal_prf#3797 AS s_acctbal_prf_0#3805, s_comment_prf#3798 AS s_comment_prf_0#3806]
         :  :  +- Relation[s_phone_prf#3791,rid#3792,s_address_prf#3793,s_nationkey_prf#3794,s_suppkey_prf#3795,s_name_prf#3796,s_acctbal_prf#3797,s_comment_prf#3798] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_2#3816]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3815]
         :        :  +- Relation[s_phone_prf#3807,rid#3808,s_address_prf#3809,s_nationkey_prf#3810,s_suppkey_prf#3811,s_name_prf#3812,s_acctbal_prf#3813,s_comment_prf#3814] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#3838]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#3829: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#3817 AS p_comment_prf_1#3827, p_name_prf#3818 AS p_name_prf_1#3828, rid#3819 AS rid_1#3829, p_type_prf#3820 AS p_type_prf_1#3830, p_retailprice_prf#3821 AS p_retailprice_prf_1#3831, p_mfgr_prf#3822 AS p_mfgr_prf_1#3832, p_container_prf#3823 AS p_container_prf_1#3833, p_brand_prf#3824 AS p_brand_prf_1#3834, p_size_prf#3825 AS p_size_prf_1#3835, p_partkey_prf#3826 AS p_partkey_prf_1#3836]
            :     :  :  +- Relation[p_comment_prf#3817,p_name_prf#3818,rid#3819,p_type_prf#3820,p_retailprice_prf#3821,p_mfgr_prf#3822,p_container_prf#3823,p_brand_prf#3824,p_size_prf#3825,p_partkey_prf#3826] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3837]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3839 AS l_returnflag_prf_2#3858, l_orderkey_and_l_linenumber_prf#3840 AS l_orderkey_and_l_linenumber_prf_2#3859, l_comment_prf#3841 AS l_comment_prf_2#3860, l_linestatus_prf#3842 AS l_linestatus_prf_2#3861, rid#3843 AS rid_2#3862, l_shipmode_prf#3844 AS l_shipmode_prf_2#3863, l_shipinstruct_prf#3845 AS l_shipinstruct_prf_2#3864, l_quantity_prf#3846 AS l_quantity_prf_2#3865, l_receiptdate_prf#3847 AS l_receiptdate_prf_2#3866, l_linenumber_prf#3848 AS l_linenumber_prf_2#3867, l_tax_prf#3849 AS l_tax_prf_2#3868, l_shipdate_prf#3850 AS l_shipdate_prf_2#3869, l_extendedprice_prf#3851 AS l_extendedprice_prf_2#3870, l_partkey_prf#3852 AS l_partkey_prf_2#3871, l_discount_prf#3853 AS l_discount_prf_2#3872, l_partkey_and_l_suppkey_prf#3854 AS l_partkey_and_l_suppkey_prf_2#3873, l_commitdate_prf#3855 AS l_commitdate_prf_2#3874, l_suppkey_prf#3856 AS l_suppkey_prf_2#3875, l_orderkey_prf#3857 AS l_orderkey_prf_2#3876]
               +- Relation[l_returnflag_prf#3839,l_orderkey_and_l_linenumber_prf#3840,l_comment_prf#3841,l_linestatus_prf#3842,rid#3843,l_shipmode_prf#3844,l_shipinstruct_prf#3845,l_quantity_prf#3846,l_receiptdate_prf#3847,l_linenumber_prf#3848,l_tax_prf#3849,l_shipdate_prf#3850,l_extendedprice_prf#3851,l_partkey_prf#3852,l_discount_prf#3853,l_partkey_and_l_suppkey_prf#3854,l_commitdate_prf#3855,l_suppkey_prf#3856,l_orderkey_prf#3857] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 55731ms

ft1b=
select * from nation, supplier, customer where n_name = 'FRANCE' and n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/17 03:29:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:29:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3936L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 03:29:52 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:29:52 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:29:52 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:29:52 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:29:52 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:29:52 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:29:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3936L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#3966]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#3949]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#3943: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#3938 AS rid_0#3943, n_regionkey_prf#3939 AS n_regionkey_prf_0#3944, n_nationkey_prf#3940 AS n_nationkey_prf_0#3945, n_name_prf#3941 AS n_name_prf_0#3946, n_comment_prf#3942 AS n_comment_prf_0#3947]
         :     :  :     :  :  +- Relation[rid#3938,n_regionkey_prf#3939,n_nationkey_prf#3940,n_name_prf#3941,n_comment_prf#3942] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3948]
         :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :        +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#3950 AS s_phone_prf_1#3958, rid#3951 AS rid_1#3959, s_address_prf#3952 AS s_address_prf_1#3960, s_nationkey_prf#3953 AS s_nationkey_prf_1#3961, s_suppkey_prf#3954 AS s_suppkey_prf_1#3962, s_name_prf#3955 AS s_name_prf_1#3963, s_acctbal_prf#3956 AS s_acctbal_prf_1#3964, s_comment_prf#3957 AS s_comment_prf_1#3965]
         :     :     +- Relation[s_phone_prf#3950,rid#3951,s_address_prf#3952,s_nationkey_prf#3953,s_suppkey_prf#3954,s_name_prf#3955,s_acctbal_prf#3956,s_comment_prf#3957] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3967 AS c_acctbal_prf_2#3976, rid#3968 AS rid_2#3977, c_name_prf#3969 AS c_name_prf_2#3978, c_nationkey_prf#3970 AS c_nationkey_prf_2#3979, c_custkey_prf#3971 AS c_custkey_prf_2#3980, c_comment_prf#3972 AS c_comment_prf_2#3981, c_address_prf#3973 AS c_address_prf_2#3982, c_mktsegment_prf#3974 AS c_mktsegment_prf_2#3983, c_phone_prf#3975 AS c_phone_prf_2#3984]
            +- Relation[c_acctbal_prf#3967,rid#3968,c_name_prf#3969,c_nationkey_prf#3970,c_custkey_prf#3971,c_comment_prf#3972,c_address_prf#3973,c_mktsegment_prf#3974,c_phone_prf#3975] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 30048ms

fr1d=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/17 03:30:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:30:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4043L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 03:30:22 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:30:22 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:30:22 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:30:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4043L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#4085]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#4064]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4055: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [c_acctbal_prf#4045 AS c_acctbal_prf_0#4054, rid#4046 AS rid_0#4055, c_name_prf#4047 AS c_name_prf_0#4056, c_nationkey_prf#4048 AS c_nationkey_prf_0#4057, c_custkey_prf#4049 AS c_custkey_prf_0#4058, c_comment_prf#4050 AS c_comment_prf_0#4059, c_address_prf#4051 AS c_address_prf_0#4060, c_mktsegment_prf#4052 AS c_mktsegment_prf_0#4061, c_phone_prf#4053 AS c_phone_prf_0#4062]
         :     :  :     :  :  +- Relation[c_acctbal_prf#4045,rid#4046,c_name_prf#4047,c_nationkey_prf#4048,c_custkey_prf#4049,c_comment_prf#4050,c_address_prf#4051,c_mktsegment_prf#4052,c_phone_prf#4053] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4063]
         :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :        +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#4065 AS o_shippriority_prf_1#4075, rid#4066 AS rid_1#4076, o_orderdate_prf#4067 AS o_orderdate_prf_1#4077, o_custkey_prf#4068 AS o_custkey_prf_1#4078, o_orderpriority_prf#4069 AS o_orderpriority_prf_1#4079, o_clerk_prf#4070 AS o_clerk_prf_1#4080, o_orderstatus_prf#4071 AS o_orderstatus_prf_1#4081, o_totalprice_prf#4072 AS o_totalprice_prf_1#4082, o_orderkey_prf#4073 AS o_orderkey_prf_1#4083, o_comment_prf#4074 AS o_comment_prf_1#4084]
         :     :     +- Relation[o_shippriority_prf#4065,rid#4066,o_orderdate_prf#4067,o_custkey_prf#4068,o_orderpriority_prf#4069,o_clerk_prf#4070,o_orderstatus_prf#4071,o_totalprice_prf#4072,o_orderkey_prf#4073,o_comment_prf#4074] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4086 AS l_returnflag_prf_2#4105, l_orderkey_and_l_linenumber_prf#4087 AS l_orderkey_and_l_linenumber_prf_2#4106, l_comment_prf#4088 AS l_comment_prf_2#4107, l_linestatus_prf#4089 AS l_linestatus_prf_2#4108, rid#4090 AS rid_2#4109, l_shipmode_prf#4091 AS l_shipmode_prf_2#4110, l_shipinstruct_prf#4092 AS l_shipinstruct_prf_2#4111, l_quantity_prf#4093 AS l_quantity_prf_2#4112, l_receiptdate_prf#4094 AS l_receiptdate_prf_2#4113, l_linenumber_prf#4095 AS l_linenumber_prf_2#4114, l_tax_prf#4096 AS l_tax_prf_2#4115, l_shipdate_prf#4097 AS l_shipdate_prf_2#4116, l_extendedprice_prf#4098 AS l_extendedprice_prf_2#4117, l_partkey_prf#4099 AS l_partkey_prf_2#4118, l_discount_prf#4100 AS l_discount_prf_2#4119, l_partkey_and_l_suppkey_prf#4101 AS l_partkey_and_l_suppkey_prf_2#4120, l_commitdate_prf#4102 AS l_commitdate_prf_2#4121, l_suppkey_prf#4103 AS l_suppkey_prf_2#4122, l_orderkey_prf#4104 AS l_orderkey_prf_2#4123]
            +- Relation[l_returnflag_prf#4086,l_orderkey_and_l_linenumber_prf#4087,l_comment_prf#4088,l_linestatus_prf#4089,rid#4090,l_shipmode_prf#4091,l_shipinstruct_prf#4092,l_quantity_prf#4093,l_receiptdate_prf#4094,l_linenumber_prf#4095,l_tax_prf#4096,l_shipdate_prf#4097,l_extendedprice_prf#4098,l_partkey_prf#4099,l_discount_prf#4100,l_partkey_and_l_suppkey_prf#4101,l_commitdate_prf#4102,l_suppkey_prf#4103,l_orderkey_prf#4104] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 32880ms

ft3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and p_size = 15 and l_suppkey = s_suppkey
19/10/17 03:30:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:30:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4197L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 03:30:55 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:30:55 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:30:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4197L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, rid_0#4222: string
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [l_returnflag_prf#4199 AS l_returnflag_prf_0#4218, l_orderkey_and_l_linenumber_prf#4200 AS l_orderkey_and_l_linenumber_prf_0#4219, l_comment_prf#4201 AS l_comment_prf_0#4220, l_linestatus_prf#4202 AS l_linestatus_prf_0#4221, rid#4203 AS rid_0#4222, l_shipmode_prf#4204 AS l_shipmode_prf_0#4223, l_shipinstruct_prf#4205 AS l_shipinstruct_prf_0#4224, l_quantity_prf#4206 AS l_quantity_prf_0#4225, l_receiptdate_prf#4207 AS l_receiptdate_prf_0#4226, l_linenumber_prf#4208 AS l_linenumber_prf_0#4227, l_tax_prf#4209 AS l_tax_prf_0#4228, l_shipdate_prf#4210 AS l_shipdate_prf_0#4229, l_extendedprice_prf#4211 AS l_extendedprice_prf_0#4230, l_partkey_prf#4212 AS l_partkey_prf_0#4231, l_discount_prf#4213 AS l_discount_prf_0#4232, l_partkey_and_l_suppkey_prf#4214 AS l_partkey_and_l_suppkey_prf_0#4233, l_commitdate_prf#4215 AS l_commitdate_prf_0#4234, l_suppkey_prf#4216 AS l_suppkey_prf_0#4235, l_orderkey_prf#4217 AS l_orderkey_prf_0#4236]
         :     :  :  :  +- Relation[l_returnflag_prf#4199,l_orderkey_and_l_linenumber_prf#4200,l_comment_prf#4201,l_linestatus_prf#4202,rid#4203,l_shipmode_prf#4204,l_shipinstruct_prf#4205,l_quantity_prf#4206,l_receiptdate_prf#4207,l_linenumber_prf#4208,l_tax_prf#4209,l_shipdate_prf#4210,l_extendedprice_prf#4211,l_partkey_prf#4212,l_discount_prf#4213,l_partkey_and_l_suppkey_prf#4214,l_commitdate_prf#4215,l_suppkey_prf#4216,l_orderkey_prf#4217] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#4257]
         :     :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#4256]
         :     :  :        :  +- Relation[l_returnflag_prf#4237,l_orderkey_and_l_linenumber_prf#4238,l_comment_prf#4239,l_linestatus_prf#4240,rid#4241,l_shipmode_prf#4242,l_shipinstruct_prf#4243,l_quantity_prf#4244,l_receiptdate_prf#4245,l_linenumber_prf#4246,l_tax_prf#4247,l_shipdate_prf#4248,l_extendedprice_prf#4249,l_partkey_prf#4250,l_discount_prf#4251,l_partkey_and_l_suppkey_prf#4252,l_commitdate_prf#4253,l_suppkey_prf#4254,l_orderkey_prf#4255] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [p_comment_prf#4258 AS p_comment_prf_1#4268, p_name_prf#4259 AS p_name_prf_1#4269, rid#4260 AS rid_1#4270, p_type_prf#4261 AS p_type_prf_1#4271, p_retailprice_prf#4262 AS p_retailprice_prf_1#4272, p_mfgr_prf#4263 AS p_mfgr_prf_1#4273, p_container_prf#4264 AS p_container_prf_1#4274, p_brand_prf#4265 AS p_brand_prf_1#4275, p_size_prf#4266 AS p_size_prf_1#4276, p_partkey_prf#4267 AS p_partkey_prf_1#4277]
         :     :     :  +- Relation[p_comment_prf#4258,p_name_prf#4259,rid#4260,p_type_prf#4261,p_retailprice_prf#4262,p_mfgr_prf#4263,p_container_prf#4264,p_brand_prf#4265,p_size_prf#4266,p_partkey_prf#4267] JDBCRelation(part_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4278]
         :     :        +- DexRidFilter part~p_size~15
         :     :           +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4280 AS s_phone_prf_2#4288, rid#4281 AS rid_2#4289, s_address_prf#4282 AS s_address_prf_2#4290, s_nationkey_prf#4283 AS s_nationkey_prf_2#4291, s_suppkey_prf#4284 AS s_suppkey_prf_2#4292, s_name_prf#4285 AS s_name_prf_2#4293, s_acctbal_prf#4286 AS s_acctbal_prf_2#4294, s_comment_prf#4287 AS s_comment_prf_2#4295]
            +- Relation[s_phone_prf#4280,rid#4281,s_address_prf#4282,s_nationkey_prf#4283,s_suppkey_prf#4284,s_name_prf#4285,s_acctbal_prf#4286,s_comment_prf#4287] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 96638ms

fq1d=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 03:32:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:32:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4373L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :     :- Project [n_nationkey#108L]
               :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
               :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 03:32:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:32:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:32:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:32:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4373L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#4375 AS l_returnflag_prf_0#4394, l_orderkey_and_l_linenumber_prf#4376 AS l_orderkey_and_l_linenumber_prf_0#4395, l_comment_prf#4377 AS l_comment_prf_0#4396, l_linestatus_prf#4378 AS l_linestatus_prf_0#4397, rid#4379 AS rid_0#4398, l_shipmode_prf#4380 AS l_shipmode_prf_0#4399, l_shipinstruct_prf#4381 AS l_shipinstruct_prf_0#4400, l_quantity_prf#4382 AS l_quantity_prf_0#4401, l_receiptdate_prf#4383 AS l_receiptdate_prf_0#4402, l_linenumber_prf#4384 AS l_linenumber_prf_0#4403, l_tax_prf#4385 AS l_tax_prf_0#4404, l_shipdate_prf#4386 AS l_shipdate_prf_0#4405, l_extendedprice_prf#4387 AS l_extendedprice_prf_0#4406, l_partkey_prf#4388 AS l_partkey_prf_0#4407, l_discount_prf#4389 AS l_discount_prf_0#4408, l_partkey_and_l_suppkey_prf#4390 AS l_partkey_and_l_suppkey_prf_0#4409, l_commitdate_prf#4391 AS l_commitdate_prf_0#4410, l_suppkey_prf#4392 AS l_suppkey_prf_0#4411, l_orderkey_prf#4393 AS l_orderkey_prf_0#4412]
         :  :  +- Relation[l_returnflag_prf#4375,l_orderkey_and_l_linenumber_prf#4376,l_comment_prf#4377,l_linestatus_prf#4378,rid#4379,l_shipmode_prf#4380,l_shipinstruct_prf#4381,l_quantity_prf#4382,l_receiptdate_prf#4383,l_linenumber_prf#4384,l_tax_prf#4385,l_shipdate_prf#4386,l_extendedprice_prf#4387,l_partkey_prf#4388,l_discount_prf#4389,l_partkey_and_l_suppkey_prf#4390,l_commitdate_prf#4391,l_suppkey_prf#4392,l_orderkey_prf#4393] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_3#4433]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4432]
         :        :  +- Relation[l_returnflag_prf#4413,l_orderkey_and_l_linenumber_prf#4414,l_comment_prf#4415,l_linestatus_prf#4416,rid#4417,l_shipmode_prf#4418,l_shipinstruct_prf#4419,l_quantity_prf#4420,l_receiptdate_prf#4421,l_linenumber_prf#4422,l_tax_prf#4423,l_shipdate_prf#4424,l_extendedprice_prf#4425,l_partkey_prf#4426,l_discount_prf#4427,l_partkey_and_l_suppkey_prf#4428,l_commitdate_prf#4429,l_suppkey_prf#4430,l_orderkey_prf#4431] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, 'rid_2, 'c_acctbal_prf_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2154) AS rid_3#4464]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_2
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#4445]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_1#4439: string
            :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :     :  :- Project [rid#4434 AS rid_1#4439, n_regionkey_prf#4435 AS n_regionkey_prf_1#4440, n_nationkey_prf#4436 AS n_nationkey_prf_1#4441, n_name_prf#4437 AS n_name_prf_1#4442, n_comment_prf#4438 AS n_comment_prf_1#4443]
            :     :  :     :  :  +- Relation[rid#4434,n_regionkey_prf#4435,n_nationkey_prf#4436,n_name_prf#4437,n_comment_prf#4438] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4444]
            :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :  :     :        +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [c_acctbal_prf#4446 AS c_acctbal_prf_2#4455, rid#4447 AS rid_2#4456, c_name_prf#4448 AS c_name_prf_2#4457, c_nationkey_prf#4449 AS c_nationkey_prf_2#4458, c_custkey_prf#4450 AS c_custkey_prf_2#4459, c_comment_prf#4451 AS c_comment_prf_2#4460, c_address_prf#4452 AS c_address_prf_2#4461, c_mktsegment_prf#4453 AS c_mktsegment_prf_2#4462, c_phone_prf#4454 AS c_phone_prf_2#4463]
            :     :     +- Relation[c_acctbal_prf#4446,rid#4447,c_name_prf#4448,c_nationkey_prf#4449,c_custkey_prf#4450,c_comment_prf#4451,c_address_prf#4452,c_mktsegment_prf#4453,c_phone_prf#4454] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4465 AS o_shippriority_prf_3#4475, rid#4466 AS rid_3#4476, o_orderdate_prf#4467 AS o_orderdate_prf_3#4477, o_custkey_prf#4468 AS o_custkey_prf_3#4478, o_orderpriority_prf#4469 AS o_orderpriority_prf_3#4479, o_clerk_prf#4470 AS o_clerk_prf_3#4480, o_orderstatus_prf#4471 AS o_orderstatus_prf_3#4481, o_totalprice_prf#4472 AS o_totalprice_prf_3#4482, o_orderkey_prf#4473 AS o_orderkey_prf_3#4483, o_comment_prf#4474 AS o_comment_prf_3#4484]
               +- Relation[o_shippriority_prf#4465,rid#4466,o_orderdate_prf#4467,o_custkey_prf#4468,o_orderpriority_prf#4469,o_clerk_prf#4470,o_orderstatus_prf#4471,o_totalprice_prf#4472,o_orderkey_prf#4473,o_comment_prf#4474] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 74384ms

fr2b=
select * from lineitem, orders, customer where o_custkey = c_custkey and o_orderstatus = 'F' and l_orderkey = o_orderkey
19/10/17 03:33:46 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:33:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4564L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 03:33:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4564L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#4566 AS l_returnflag_prf_0#4585, l_orderkey_and_l_linenumber_prf#4567 AS l_orderkey_and_l_linenumber_prf_0#4586, l_comment_prf#4568 AS l_comment_prf_0#4587, l_linestatus_prf#4569 AS l_linestatus_prf_0#4588, rid#4570 AS rid_0#4589, l_shipmode_prf#4571 AS l_shipmode_prf_0#4590, l_shipinstruct_prf#4572 AS l_shipinstruct_prf_0#4591, l_quantity_prf#4573 AS l_quantity_prf_0#4592, l_receiptdate_prf#4574 AS l_receiptdate_prf_0#4593, l_linenumber_prf#4575 AS l_linenumber_prf_0#4594, l_tax_prf#4576 AS l_tax_prf_0#4595, l_shipdate_prf#4577 AS l_shipdate_prf_0#4596, l_extendedprice_prf#4578 AS l_extendedprice_prf_0#4597, l_partkey_prf#4579 AS l_partkey_prf_0#4598, l_discount_prf#4580 AS l_discount_prf_0#4599, l_partkey_and_l_suppkey_prf#4581 AS l_partkey_and_l_suppkey_prf_0#4600, l_commitdate_prf#4582 AS l_commitdate_prf_0#4601, l_suppkey_prf#4583 AS l_suppkey_prf_0#4602, l_orderkey_prf#4584 AS l_orderkey_prf_0#4603]
         :  :  +- Relation[l_returnflag_prf#4566,l_orderkey_and_l_linenumber_prf#4567,l_comment_prf#4568,l_linestatus_prf#4569,rid#4570,l_shipmode_prf#4571,l_shipinstruct_prf#4572,l_quantity_prf#4573,l_receiptdate_prf#4574,l_linenumber_prf#4575,l_tax_prf#4576,l_shipdate_prf#4577,l_extendedprice_prf#4578,l_partkey_prf#4579,l_discount_prf#4580,l_partkey_and_l_suppkey_prf#4581,l_commitdate_prf#4582,l_suppkey_prf#4583,l_orderkey_prf#4584] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#4624]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4623]
         :        :  +- Relation[l_returnflag_prf#4604,l_orderkey_and_l_linenumber_prf#4605,l_comment_prf#4606,l_linestatus_prf#4607,rid#4608,l_shipmode_prf#4609,l_shipinstruct_prf#4610,l_quantity_prf#4611,l_receiptdate_prf#4612,l_linenumber_prf#4613,l_tax_prf#4614,l_shipdate_prf#4615,l_extendedprice_prf#4616,l_partkey_prf#4617,l_discount_prf#4618,l_partkey_and_l_suppkey_prf#4619,l_commitdate_prf#4620,l_suppkey_prf#4621,l_orderkey_prf#4622] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#4646]
            :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#4636: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#4625 AS o_shippriority_prf_1#4635, rid#4626 AS rid_1#4636, o_orderdate_prf#4627 AS o_orderdate_prf_1#4637, o_custkey_prf#4628 AS o_custkey_prf_1#4638, o_orderpriority_prf#4629 AS o_orderpriority_prf_1#4639, o_clerk_prf#4630 AS o_clerk_prf_1#4640, o_orderstatus_prf#4631 AS o_orderstatus_prf_1#4641, o_totalprice_prf#4632 AS o_totalprice_prf_1#4642, o_orderkey_prf#4633 AS o_orderkey_prf_1#4643, o_comment_prf#4634 AS o_comment_prf_1#4644]
            :     :  :  +- Relation[o_shippriority_prf#4625,rid#4626,o_orderdate_prf#4627,o_custkey_prf#4628,o_orderpriority_prf#4629,o_clerk_prf#4630,o_orderstatus_prf#4631,o_totalprice_prf#4632,o_orderkey_prf#4633,o_comment_prf#4634] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4645]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4647 AS c_acctbal_prf_2#4656, rid#4648 AS rid_2#4657, c_name_prf#4649 AS c_name_prf_2#4658, c_nationkey_prf#4650 AS c_nationkey_prf_2#4659, c_custkey_prf#4651 AS c_custkey_prf_2#4660, c_comment_prf#4652 AS c_comment_prf_2#4661, c_address_prf#4653 AS c_address_prf_2#4662, c_mktsegment_prf#4654 AS c_mktsegment_prf_2#4663, c_phone_prf#4655 AS c_phone_prf_2#4664]
               +- Relation[c_acctbal_prf#4647,rid#4648,c_name_prf#4649,c_nationkey_prf#4650,c_custkey_prf#4651,c_comment_prf#4652,c_address_prf#4653,c_mktsegment_prf#4654,c_phone_prf#4655] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 106006ms

fr2e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/17 03:35:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:35:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4739L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 03:35:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4739L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#4741 AS c_acctbal_prf_0#4750, rid#4742 AS rid_0#4751, c_name_prf#4743 AS c_name_prf_0#4752, c_nationkey_prf#4744 AS c_nationkey_prf_0#4753, c_custkey_prf#4745 AS c_custkey_prf_0#4754, c_comment_prf#4746 AS c_comment_prf_0#4755, c_address_prf#4747 AS c_address_prf_0#4756, c_mktsegment_prf#4748 AS c_mktsegment_prf_0#4757, c_phone_prf#4749 AS c_phone_prf_0#4758]
         :  :  +- Relation[c_acctbal_prf#4741,rid#4742,c_name_prf#4743,c_nationkey_prf#4744,c_custkey_prf#4745,c_comment_prf#4746,c_address_prf#4747,c_mktsegment_prf#4748,c_phone_prf#4749] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#4769]
         :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4768]
         :        :  +- Relation[c_acctbal_prf#4759,rid#4760,c_name_prf#4761,c_nationkey_prf#4762,c_custkey_prf#4763,c_comment_prf#4764,c_address_prf#4765,c_mktsegment_prf#4766,c_phone_prf#4767] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#4791]
            :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#4781: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#4770 AS o_shippriority_prf_1#4780, rid#4771 AS rid_1#4781, o_orderdate_prf#4772 AS o_orderdate_prf_1#4782, o_custkey_prf#4773 AS o_custkey_prf_1#4783, o_orderpriority_prf#4774 AS o_orderpriority_prf_1#4784, o_clerk_prf#4775 AS o_clerk_prf_1#4785, o_orderstatus_prf#4776 AS o_orderstatus_prf_1#4786, o_totalprice_prf#4777 AS o_totalprice_prf_1#4787, o_orderkey_prf#4778 AS o_orderkey_prf_1#4788, o_comment_prf#4779 AS o_comment_prf_1#4789]
            :     :  :  +- Relation[o_shippriority_prf#4770,rid#4771,o_orderdate_prf#4772,o_custkey_prf#4773,o_orderpriority_prf#4774,o_clerk_prf#4775,o_orderstatus_prf#4776,o_totalprice_prf#4777,o_orderkey_prf#4778,o_comment_prf#4779] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4790]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4792 AS l_returnflag_prf_2#4811, l_orderkey_and_l_linenumber_prf#4793 AS l_orderkey_and_l_linenumber_prf_2#4812, l_comment_prf#4794 AS l_comment_prf_2#4813, l_linestatus_prf#4795 AS l_linestatus_prf_2#4814, rid#4796 AS rid_2#4815, l_shipmode_prf#4797 AS l_shipmode_prf_2#4816, l_shipinstruct_prf#4798 AS l_shipinstruct_prf_2#4817, l_quantity_prf#4799 AS l_quantity_prf_2#4818, l_receiptdate_prf#4800 AS l_receiptdate_prf_2#4819, l_linenumber_prf#4801 AS l_linenumber_prf_2#4820, l_tax_prf#4802 AS l_tax_prf_2#4821, l_shipdate_prf#4803 AS l_shipdate_prf_2#4822, l_extendedprice_prf#4804 AS l_extendedprice_prf_2#4823, l_partkey_prf#4805 AS l_partkey_prf_2#4824, l_discount_prf#4806 AS l_discount_prf_2#4825, l_partkey_and_l_suppkey_prf#4807 AS l_partkey_and_l_suppkey_prf_2#4826, l_commitdate_prf#4808 AS l_commitdate_prf_2#4827, l_suppkey_prf#4809 AS l_suppkey_prf_2#4828, l_orderkey_prf#4810 AS l_orderkey_prf_2#4829]
               +- Relation[l_returnflag_prf#4792,l_orderkey_and_l_linenumber_prf#4793,l_comment_prf#4794,l_linestatus_prf#4795,rid#4796,l_shipmode_prf#4797,l_shipinstruct_prf#4798,l_quantity_prf#4799,l_receiptdate_prf#4800,l_linenumber_prf#4801,l_tax_prf#4802,l_shipdate_prf#4803,l_extendedprice_prf#4804,l_partkey_prf#4805,l_discount_prf#4806,l_partkey_and_l_suppkey_prf#4807,l_commitdate_prf#4808,l_suppkey_prf#4809,l_orderkey_prf#4810] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 96075ms

fq1f=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 03:37:08 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:37:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4908L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/17 03:37:08 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:37:08 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:37:08 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:37:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4908L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- Project [l_returnflag_prf#4910 AS l_returnflag_prf_0#4929, l_orderkey_and_l_linenumber_prf#4911 AS l_orderkey_and_l_linenumber_prf_0#4930, l_comment_prf#4912 AS l_comment_prf_0#4931, l_linestatus_prf#4913 AS l_linestatus_prf_0#4932, rid#4914 AS rid_0#4933, l_shipmode_prf#4915 AS l_shipmode_prf_0#4934, l_shipinstruct_prf#4916 AS l_shipinstruct_prf_0#4935, l_quantity_prf#4917 AS l_quantity_prf_0#4936, l_receiptdate_prf#4918 AS l_receiptdate_prf_0#4937, l_linenumber_prf#4919 AS l_linenumber_prf_0#4938, l_tax_prf#4920 AS l_tax_prf_0#4939, l_shipdate_prf#4921 AS l_shipdate_prf_0#4940, l_extendedprice_prf#4922 AS l_extendedprice_prf_0#4941, l_partkey_prf#4923 AS l_partkey_prf_0#4942, l_discount_prf#4924 AS l_discount_prf_0#4943, l_partkey_and_l_suppkey_prf#4925 AS l_partkey_and_l_suppkey_prf_0#4944, l_commitdate_prf#4926 AS l_commitdate_prf_0#4945, l_suppkey_prf#4927 AS l_suppkey_prf_0#4946, l_orderkey_prf#4928 AS l_orderkey_prf_0#4947]
         :  :  :  :  :  :  +- Relation[l_returnflag_prf#4910,l_orderkey_and_l_linenumber_prf#4911,l_comment_prf#4912,l_linestatus_prf#4913,rid#4914,l_shipmode_prf#4915,l_shipinstruct_prf#4916,l_quantity_prf#4917,l_receiptdate_prf#4918,l_linenumber_prf#4919,l_tax_prf#4920,l_shipdate_prf#4921,l_extendedprice_prf#4922,l_partkey_prf#4923,l_discount_prf#4924,l_partkey_and_l_suppkey_prf#4925,l_commitdate_prf#4926,l_suppkey_prf#4927,l_orderkey_prf#4928] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#4968]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :  :  :        :- 'Project ['rid AS rid_0#4967]
         :  :  :  :  :        :  +- Relation[l_returnflag_prf#4948,l_orderkey_and_l_linenumber_prf#4949,l_comment_prf#4950,l_linestatus_prf#4951,rid#4952,l_shipmode_prf#4953,l_shipinstruct_prf#4954,l_quantity_prf#4955,l_receiptdate_prf#4956,l_linenumber_prf#4957,l_tax_prf#4958,l_shipdate_prf#4959,l_extendedprice_prf#4960,l_partkey_prf#4961,l_discount_prf#4962,l_partkey_and_l_suppkey_prf#4963,l_commitdate_prf#4964,l_suppkey_prf#4965,l_orderkey_prf#4966] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [o_shippriority_prf#4969 AS o_shippriority_prf_1#4979, rid#4970 AS rid_1#4980, o_orderdate_prf#4971 AS o_orderdate_prf_1#4981, o_custkey_prf#4972 AS o_custkey_prf_1#4982, o_orderpriority_prf#4973 AS o_orderpriority_prf_1#4983, o_clerk_prf#4974 AS o_clerk_prf_1#4984, o_orderstatus_prf#4975 AS o_orderstatus_prf_1#4985, o_totalprice_prf#4976 AS o_totalprice_prf_1#4986, o_orderkey_prf#4977 AS o_orderkey_prf_1#4987, o_comment_prf#4978 AS o_comment_prf_1#4988]
         :  :  :  :     +- Relation[o_shippriority_prf#4969,rid#4970,o_orderdate_prf#4971,o_custkey_prf#4972,o_orderpriority_prf#4973,o_clerk_prf#4974,o_orderstatus_prf#4975,o_totalprice_prf#4976,o_orderkey_prf#4977,o_comment_prf#4978] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#5000]
         :  :  :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :  :  :        :- 'Project ['rid AS rid_1#4999]
         :  :  :        :  +- Relation[o_shippriority_prf#4989,rid#4990,o_orderdate_prf#4991,o_custkey_prf#4992,o_orderpriority_prf#4993,o_clerk_prf#4994,o_orderstatus_prf#4995,o_totalprice_prf#4996,o_orderkey_prf#4997,o_comment_prf#4998] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#5001 AS c_acctbal_prf_2#5010, rid#5002 AS rid_2#5011, c_name_prf#5003 AS c_name_prf_2#5012, c_nationkey_prf#5004 AS c_nationkey_prf_2#5013, c_custkey_prf#5005 AS c_custkey_prf_2#5014, c_comment_prf#5006 AS c_comment_prf_2#5015, c_address_prf#5007 AS c_address_prf_2#5016, c_mktsegment_prf#5008 AS c_mktsegment_prf_2#5017, c_phone_prf#5009 AS c_phone_prf_2#5018]
         :  :     +- Relation[c_acctbal_prf#5001,rid#5002,c_name_prf#5003,c_nationkey_prf#5004,c_custkey_prf#5005,c_comment_prf#5006,c_address_prf#5007,c_mktsegment_prf#5008,c_phone_prf#5009] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2154) AS rid_3#5029]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#5028]
         :        :  +- Relation[c_acctbal_prf#5019,rid#5020,c_name_prf#5021,c_nationkey_prf#5022,c_custkey_prf#5023,c_comment_prf#5024,c_address_prf#5025,c_mktsegment_prf#5026,c_phone_prf#5027] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_3))
            :- Project [rid#5030 AS rid_3#5035, n_regionkey_prf#5031 AS n_regionkey_prf_3#5036, n_nationkey_prf#5032 AS n_nationkey_prf_3#5037, n_name_prf#5033 AS n_name_prf_3#5038, n_comment_prf#5034 AS n_comment_prf_3#5039]
            :  +- Relation[rid#5030,n_regionkey_prf#5031,n_nationkey_prf#5032,n_name_prf#5033,n_comment_prf#5034] JDBCRelation(nation_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#5040]
               +- DexRidFilter nation~n_name~FRANCE
                  +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 168605ms

fs1b=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/17 03:39:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:39:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5129L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L, l_partkey#307L]
               :  +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L]
                  +- Join Inner, (c_custkey#290L = o_custkey#343L)
                     :- Project [c_custkey#290L]
                     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
                     +- Project [o_orderkey#342L, o_custkey#343L]
                        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 03:39:57 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:39:57 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:39:57 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:39:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5129L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [p_comment_prf#5131 AS p_comment_prf_0#5141, p_name_prf#5132 AS p_name_prf_0#5142, rid#5133 AS rid_0#5143, p_type_prf#5134 AS p_type_prf_0#5144, p_retailprice_prf#5135 AS p_retailprice_prf_0#5145, p_mfgr_prf#5136 AS p_mfgr_prf_0#5146, p_container_prf#5137 AS p_container_prf_0#5147, p_brand_prf#5138 AS p_brand_prf_0#5148, p_size_prf#5139 AS p_size_prf_0#5149, p_partkey_prf#5140 AS p_partkey_prf_0#5150]
         :  :  +- Relation[p_comment_prf#5131,p_name_prf#5132,rid#5133,p_type_prf#5134,p_retailprice_prf#5135,p_mfgr_prf#5136,p_container_prf#5137,p_brand_prf#5138,p_size_prf#5139,p_partkey_prf#5140] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#5162]
         :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5161]
         :        :  +- Relation[p_comment_prf#5151,p_name_prf#5152,rid#5153,p_type_prf#5154,p_retailprice_prf#5155,p_mfgr_prf#5156,p_container_prf#5157,p_brand_prf#5158,p_size_prf#5159,p_partkey_prf#5160] JDBCRelation(part_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [l_returnflag_prf#5163 AS l_returnflag_prf_1#5182, l_orderkey_and_l_linenumber_prf#5164 AS l_orderkey_and_l_linenumber_prf_1#5183, l_comment_prf#5165 AS l_comment_prf_1#5184, l_linestatus_prf#5166 AS l_linestatus_prf_1#5185, rid#5167 AS rid_1#5186, l_shipmode_prf#5168 AS l_shipmode_prf_1#5187, l_shipinstruct_prf#5169 AS l_shipinstruct_prf_1#5188, l_quantity_prf#5170 AS l_quantity_prf_1#5189, l_receiptdate_prf#5171 AS l_receiptdate_prf_1#5190, l_linenumber_prf#5172 AS l_linenumber_prf_1#5191, l_tax_prf#5173 AS l_tax_prf_1#5192, l_shipdate_prf#5174 AS l_shipdate_prf_1#5193, l_extendedprice_prf#5175 AS l_extendedprice_prf_1#5194, l_partkey_prf#5176 AS l_partkey_prf_1#5195, l_discount_prf#5177 AS l_discount_prf_1#5196, l_partkey_and_l_suppkey_prf#5178 AS l_partkey_and_l_suppkey_prf_1#5197, l_commitdate_prf#5179 AS l_commitdate_prf_1#5198, l_suppkey_prf#5180 AS l_suppkey_prf_1#5199, l_orderkey_prf#5181 AS l_orderkey_prf_1#5200]
            :  :  +- Relation[l_returnflag_prf#5163,l_orderkey_and_l_linenumber_prf#5164,l_comment_prf#5165,l_linestatus_prf#5166,rid#5167,l_shipmode_prf#5168,l_shipinstruct_prf#5169,l_quantity_prf#5170,l_receiptdate_prf#5171,l_linenumber_prf#5172,l_tax_prf#5173,l_shipdate_prf#5174,l_extendedprice_prf#5175,l_partkey_prf#5176,l_discount_prf#5177,l_partkey_and_l_suppkey_prf#5178,l_commitdate_prf#5179,l_suppkey_prf#5180,l_orderkey_prf#5181] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2154) AS rid_3#5221]
            :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#5220]
            :        :  +- Relation[l_returnflag_prf#5201,l_orderkey_and_l_linenumber_prf#5202,l_comment_prf#5203,l_linestatus_prf#5204,rid#5205,l_shipmode_prf#5206,l_shipinstruct_prf#5207,l_quantity_prf#5208,l_receiptdate_prf#5209,l_linenumber_prf#5210,l_tax_prf#5211,l_shipdate_prf#5212,l_extendedprice_prf#5213,l_partkey_prf#5214,l_discount_prf#5215,l_partkey_and_l_suppkey_prf#5216,l_commitdate_prf#5217,l_suppkey_prf#5218,l_orderkey_prf#5219] JDBCRelation(lineitem_prf) [numPartitions=1]
            :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join NaturalJoin(Inner)
               :- 'Project ['c_acctbal_prf_2, 'rid_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2154) AS rid_3#5241]
               :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_2#5232: string
               :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :     :  :- Project [c_acctbal_prf#5222 AS c_acctbal_prf_2#5231, rid#5223 AS rid_2#5232, c_name_prf#5224 AS c_name_prf_2#5233, c_nationkey_prf#5225 AS c_nationkey_prf_2#5234, c_custkey_prf#5226 AS c_custkey_prf_2#5235, c_comment_prf#5227 AS c_comment_prf_2#5236, c_address_prf#5228 AS c_address_prf_2#5237, c_mktsegment_prf#5229 AS c_mktsegment_prf_2#5238, c_phone_prf#5230 AS c_phone_prf_2#5239]
               :     :  :  +- Relation[c_acctbal_prf#5222,rid#5223,c_name_prf#5224,c_nationkey_prf#5225,c_custkey_prf#5226,c_comment_prf#5227,c_address_prf#5228,c_mktsegment_prf#5229,c_phone_prf#5230] JDBCRelation(customer_prf) [numPartitions=1]
               :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#5240]
               :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
               :     :        +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
               :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
               +- Project [o_shippriority_prf#5242 AS o_shippriority_prf_3#5252, rid#5243 AS rid_3#5253, o_orderdate_prf#5244 AS o_orderdate_prf_3#5254, o_custkey_prf#5245 AS o_custkey_prf_3#5255, o_orderpriority_prf#5246 AS o_orderpriority_prf_3#5256, o_clerk_prf#5247 AS o_clerk_prf_3#5257, o_orderstatus_prf#5248 AS o_orderstatus_prf_3#5258, o_totalprice_prf#5249 AS o_totalprice_prf_3#5259, o_orderkey_prf#5250 AS o_orderkey_prf_3#5260, o_comment_prf#5251 AS o_comment_prf_3#5261]
                  +- Relation[o_shippriority_prf#5242,rid#5243,o_orderdate_prf#5244,o_custkey_prf#5245,o_orderpriority_prf#5246,o_clerk_prf#5247,o_orderstatus_prf#5248,o_totalprice_prf#5249,o_orderkey_prf#5250,o_comment_prf#5251] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 172737ms

fr1e=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and (o_orderkey = l_orderkey and c_custkey = o_custkey)
19/10/17 03:42:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:42:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5346L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 03:42:49 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:42:49 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:42:49 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:42:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5346L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#5367]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#5358: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [c_acctbal_prf#5348 AS c_acctbal_prf_0#5357, rid#5349 AS rid_0#5358, c_name_prf#5350 AS c_name_prf_0#5359, c_nationkey_prf#5351 AS c_nationkey_prf_0#5360, c_custkey_prf#5352 AS c_custkey_prf_0#5361, c_comment_prf#5353 AS c_comment_prf_0#5362, c_address_prf#5354 AS c_address_prf_0#5363, c_mktsegment_prf#5355 AS c_mktsegment_prf_0#5364, c_phone_prf#5356 AS c_phone_prf_0#5365]
         :     :  :  +- Relation[c_acctbal_prf#5348,rid#5349,c_name_prf#5350,c_nationkey_prf#5351,c_custkey_prf#5352,c_comment_prf#5353,c_address_prf#5354,c_mktsegment_prf#5355,c_phone_prf#5356] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5366]
         :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :        +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [o_shippriority_prf#5368 AS o_shippriority_prf_1#5378, rid#5369 AS rid_1#5379, o_orderdate_prf#5370 AS o_orderdate_prf_1#5380, o_custkey_prf#5371 AS o_custkey_prf_1#5381, o_orderpriority_prf#5372 AS o_orderpriority_prf_1#5382, o_clerk_prf#5373 AS o_clerk_prf_1#5383, o_orderstatus_prf#5374 AS o_orderstatus_prf_1#5384, o_totalprice_prf#5375 AS o_totalprice_prf_1#5385, o_orderkey_prf#5376 AS o_orderkey_prf_1#5386, o_comment_prf#5377 AS o_comment_prf_1#5387]
            :  :  +- Relation[o_shippriority_prf#5368,rid#5369,o_orderdate_prf#5370,o_custkey_prf#5371,o_orderpriority_prf#5372,o_clerk_prf#5373,o_orderstatus_prf#5374,o_totalprice_prf#5375,o_orderkey_prf#5376,o_comment_prf#5377] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#5399]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#5398]
            :        :  +- Relation[o_shippriority_prf#5388,rid#5389,o_orderdate_prf#5390,o_custkey_prf#5391,o_orderpriority_prf#5392,o_clerk_prf#5393,o_orderstatus_prf#5394,o_totalprice_prf#5395,o_orderkey_prf#5396,o_comment_prf#5397] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#5400 AS l_returnflag_prf_2#5419, l_orderkey_and_l_linenumber_prf#5401 AS l_orderkey_and_l_linenumber_prf_2#5420, l_comment_prf#5402 AS l_comment_prf_2#5421, l_linestatus_prf#5403 AS l_linestatus_prf_2#5422, rid#5404 AS rid_2#5423, l_shipmode_prf#5405 AS l_shipmode_prf_2#5424, l_shipinstruct_prf#5406 AS l_shipinstruct_prf_2#5425, l_quantity_prf#5407 AS l_quantity_prf_2#5426, l_receiptdate_prf#5408 AS l_receiptdate_prf_2#5427, l_linenumber_prf#5409 AS l_linenumber_prf_2#5428, l_tax_prf#5410 AS l_tax_prf_2#5429, l_shipdate_prf#5411 AS l_shipdate_prf_2#5430, l_extendedprice_prf#5412 AS l_extendedprice_prf_2#5431, l_partkey_prf#5413 AS l_partkey_prf_2#5432, l_discount_prf#5414 AS l_discount_prf_2#5433, l_partkey_and_l_suppkey_prf#5415 AS l_partkey_and_l_suppkey_prf_2#5434, l_commitdate_prf#5416 AS l_commitdate_prf_2#5435, l_suppkey_prf#5417 AS l_suppkey_prf_2#5436, l_orderkey_prf#5418 AS l_orderkey_prf_2#5437]
               +- Relation[l_returnflag_prf#5400,l_orderkey_and_l_linenumber_prf#5401,l_comment_prf#5402,l_linestatus_prf#5403,rid#5404,l_shipmode_prf#5405,l_shipinstruct_prf#5406,l_quantity_prf#5407,l_receiptdate_prf#5408,l_linenumber_prf#5409,l_tax_prf#5410,l_shipdate_prf#5411,l_extendedprice_prf#5412,l_partkey_prf#5413,l_discount_prf#5414,l_partkey_and_l_suppkey_prf#5415,l_commitdate_prf#5416,l_suppkey_prf#5417,l_orderkey_prf#5418] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 152942ms

fq1e=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 03:45:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:45:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5516L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [c_custkey#290L, c_nationkey#293L]
                  +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 03:45:22 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:45:22 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:45:22 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:45:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5516L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [l_returnflag_prf#5518 AS l_returnflag_prf_0#5537, l_orderkey_and_l_linenumber_prf#5519 AS l_orderkey_and_l_linenumber_prf_0#5538, l_comment_prf#5520 AS l_comment_prf_0#5539, l_linestatus_prf#5521 AS l_linestatus_prf_0#5540, rid#5522 AS rid_0#5541, l_shipmode_prf#5523 AS l_shipmode_prf_0#5542, l_shipinstruct_prf#5524 AS l_shipinstruct_prf_0#5543, l_quantity_prf#5525 AS l_quantity_prf_0#5544, l_receiptdate_prf#5526 AS l_receiptdate_prf_0#5545, l_linenumber_prf#5527 AS l_linenumber_prf_0#5546, l_tax_prf#5528 AS l_tax_prf_0#5547, l_shipdate_prf#5529 AS l_shipdate_prf_0#5548, l_extendedprice_prf#5530 AS l_extendedprice_prf_0#5549, l_partkey_prf#5531 AS l_partkey_prf_0#5550, l_discount_prf#5532 AS l_discount_prf_0#5551, l_partkey_and_l_suppkey_prf#5533 AS l_partkey_and_l_suppkey_prf_0#5552, l_commitdate_prf#5534 AS l_commitdate_prf_0#5553, l_suppkey_prf#5535 AS l_suppkey_prf_0#5554, l_orderkey_prf#5536 AS l_orderkey_prf_0#5555]
         :  :  :  :  +- Relation[l_returnflag_prf#5518,l_orderkey_and_l_linenumber_prf#5519,l_comment_prf#5520,l_linestatus_prf#5521,rid#5522,l_shipmode_prf#5523,l_shipinstruct_prf#5524,l_quantity_prf#5525,l_receiptdate_prf#5526,l_linenumber_prf#5527,l_tax_prf#5528,l_shipdate_prf#5529,l_extendedprice_prf#5530,l_partkey_prf#5531,l_discount_prf#5532,l_partkey_and_l_suppkey_prf#5533,l_commitdate_prf#5534,l_suppkey_prf#5535,l_orderkey_prf#5536] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#5576]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#5575]
         :  :  :        :  +- Relation[l_returnflag_prf#5556,l_orderkey_and_l_linenumber_prf#5557,l_comment_prf#5558,l_linestatus_prf#5559,rid#5560,l_shipmode_prf#5561,l_shipinstruct_prf#5562,l_quantity_prf#5563,l_receiptdate_prf#5564,l_linenumber_prf#5565,l_tax_prf#5566,l_shipdate_prf#5567,l_extendedprice_prf#5568,l_partkey_prf#5569,l_discount_prf#5570,l_partkey_and_l_suppkey_prf#5571,l_commitdate_prf#5572,l_suppkey_prf#5573,l_orderkey_prf#5574] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#5577 AS o_shippriority_prf_1#5587, rid#5578 AS rid_1#5588, o_orderdate_prf#5579 AS o_orderdate_prf_1#5589, o_custkey_prf#5580 AS o_custkey_prf_1#5590, o_orderpriority_prf#5581 AS o_orderpriority_prf_1#5591, o_clerk_prf#5582 AS o_clerk_prf_1#5592, o_orderstatus_prf#5583 AS o_orderstatus_prf_1#5593, o_totalprice_prf#5584 AS o_totalprice_prf_1#5594, o_orderkey_prf#5585 AS o_orderkey_prf_1#5595, o_comment_prf#5586 AS o_comment_prf_1#5596]
         :  :     +- Relation[o_shippriority_prf#5577,rid#5578,o_orderdate_prf#5579,o_custkey_prf#5580,o_orderpriority_prf#5581,o_clerk_prf#5582,o_orderstatus_prf#5583,o_totalprice_prf#5584,o_orderkey_prf#5585,o_comment_prf#5586] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2154) AS rid_3#5608]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5607]
         :        :  +- Relation[o_shippriority_prf#5597,rid#5598,o_orderdate_prf#5599,o_custkey_prf#5600,o_orderpriority_prf#5601,o_clerk_prf#5602,o_orderstatus_prf#5603,o_totalprice_prf#5604,o_orderkey_prf#5605,o_comment_prf#5606] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_2, 'n_regionkey_prf_2, 'n_nationkey_prf_2, 'n_name_prf_2, 'n_comment_prf_2, dexdecrypt('value_dec_key, value#2154) AS rid_3#5620]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_2#5614: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [rid#5609 AS rid_2#5614, n_regionkey_prf#5610 AS n_regionkey_prf_2#5615, n_nationkey_prf#5611 AS n_nationkey_prf_2#5616, n_name_prf#5612 AS n_name_prf_2#5617, n_comment_prf#5613 AS n_comment_prf_2#5618]
            :     :  :  +- Relation[rid#5609,n_regionkey_prf#5610,n_nationkey_prf#5611,n_name_prf#5612,n_comment_prf#5613] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#5619]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#5621 AS c_acctbal_prf_3#5630, rid#5622 AS rid_3#5631, c_name_prf#5623 AS c_name_prf_3#5632, c_nationkey_prf#5624 AS c_nationkey_prf_3#5633, c_custkey_prf#5625 AS c_custkey_prf_3#5634, c_comment_prf#5626 AS c_comment_prf_3#5635, c_address_prf#5627 AS c_address_prf_3#5636, c_mktsegment_prf#5628 AS c_mktsegment_prf_3#5637, c_phone_prf#5629 AS c_phone_prf_3#5638]
               +- Relation[c_acctbal_prf#5621,rid#5622,c_name_prf#5623,c_nationkey_prf#5624,c_custkey_prf#5625,c_comment_prf#5626,c_address_prf#5627,c_mktsegment_prf#5628,c_phone_prf#5629] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 164875ms

fr2a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_orderstatus = 'F' and o_custkey = c_custkey
19/10/17 03:48:07 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:48:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5718L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 03:48:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5718L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [l_returnflag_prf#5720 AS l_returnflag_prf_0#5739, l_orderkey_and_l_linenumber_prf#5721 AS l_orderkey_and_l_linenumber_prf_0#5740, l_comment_prf#5722 AS l_comment_prf_0#5741, l_linestatus_prf#5723 AS l_linestatus_prf_0#5742, rid#5724 AS rid_0#5743, l_shipmode_prf#5725 AS l_shipmode_prf_0#5744, l_shipinstruct_prf#5726 AS l_shipinstruct_prf_0#5745, l_quantity_prf#5727 AS l_quantity_prf_0#5746, l_receiptdate_prf#5728 AS l_receiptdate_prf_0#5747, l_linenumber_prf#5729 AS l_linenumber_prf_0#5748, l_tax_prf#5730 AS l_tax_prf_0#5749, l_shipdate_prf#5731 AS l_shipdate_prf_0#5750, l_extendedprice_prf#5732 AS l_extendedprice_prf_0#5751, l_partkey_prf#5733 AS l_partkey_prf_0#5752, l_discount_prf#5734 AS l_discount_prf_0#5753, l_partkey_and_l_suppkey_prf#5735 AS l_partkey_and_l_suppkey_prf_0#5754, l_commitdate_prf#5736 AS l_commitdate_prf_0#5755, l_suppkey_prf#5737 AS l_suppkey_prf_0#5756, l_orderkey_prf#5738 AS l_orderkey_prf_0#5757]
         :     :  :  :  +- Relation[l_returnflag_prf#5720,l_orderkey_and_l_linenumber_prf#5721,l_comment_prf#5722,l_linestatus_prf#5723,rid#5724,l_shipmode_prf#5725,l_shipinstruct_prf#5726,l_quantity_prf#5727,l_receiptdate_prf#5728,l_linenumber_prf#5729,l_tax_prf#5730,l_shipdate_prf#5731,l_extendedprice_prf#5732,l_partkey_prf#5733,l_discount_prf#5734,l_partkey_and_l_suppkey_prf#5735,l_commitdate_prf#5736,l_suppkey_prf#5737,l_orderkey_prf#5738] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#5778]
         :     :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#5777]
         :     :  :        :  +- Relation[l_returnflag_prf#5758,l_orderkey_and_l_linenumber_prf#5759,l_comment_prf#5760,l_linestatus_prf#5761,rid#5762,l_shipmode_prf#5763,l_shipinstruct_prf#5764,l_quantity_prf#5765,l_receiptdate_prf#5766,l_linenumber_prf#5767,l_tax_prf#5768,l_shipdate_prf#5769,l_extendedprice_prf#5770,l_partkey_prf#5771,l_discount_prf#5772,l_partkey_and_l_suppkey_prf#5773,l_commitdate_prf#5774,l_suppkey_prf#5775,l_orderkey_prf#5776] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [o_shippriority_prf#5779 AS o_shippriority_prf_1#5789, rid#5780 AS rid_1#5790, o_orderdate_prf#5781 AS o_orderdate_prf_1#5791, o_custkey_prf#5782 AS o_custkey_prf_1#5792, o_orderpriority_prf#5783 AS o_orderpriority_prf_1#5793, o_clerk_prf#5784 AS o_clerk_prf_1#5794, o_orderstatus_prf#5785 AS o_orderstatus_prf_1#5795, o_totalprice_prf#5786 AS o_totalprice_prf_1#5796, o_orderkey_prf#5787 AS o_orderkey_prf_1#5797, o_comment_prf#5788 AS o_comment_prf_1#5798]
         :     :     :  +- Relation[o_shippriority_prf#5779,rid#5780,o_orderdate_prf#5781,o_custkey_prf#5782,o_orderpriority_prf#5783,o_clerk_prf#5784,o_orderstatus_prf#5785,o_totalprice_prf#5786,o_orderkey_prf#5787,o_comment_prf#5788] JDBCRelation(orders_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5799]
         :     :        +- DexRidFilter orders~o_orderstatus~F
         :     :           +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#5801 AS c_acctbal_prf_2#5810, rid#5802 AS rid_2#5811, c_name_prf#5803 AS c_name_prf_2#5812, c_nationkey_prf#5804 AS c_nationkey_prf_2#5813, c_custkey_prf#5805 AS c_custkey_prf_2#5814, c_comment_prf#5806 AS c_comment_prf_2#5815, c_address_prf#5807 AS c_address_prf_2#5816, c_mktsegment_prf#5808 AS c_mktsegment_prf_2#5817, c_phone_prf#5809 AS c_phone_prf_2#5818]
            +- Relation[c_acctbal_prf#5801,rid#5802,c_name_prf#5803,c_nationkey_prf#5804,c_custkey_prf#5805,c_comment_prf#5806,c_address_prf#5807,c_mktsegment_prf#5808,c_phone_prf#5809] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 193618ms

ft2b=
select * from part, partsupp, supplier where p_size = 15 and p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/17 03:51:21 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:51:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5881L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 03:51:21 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 03:51:21 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 03:51:21 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 03:51:21 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:51:21 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:51:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5881L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#5919]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#5904]
         :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#5895: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [p_comment_prf#5883 AS p_comment_prf_0#5893, p_name_prf#5884 AS p_name_prf_0#5894, rid#5885 AS rid_0#5895, p_type_prf#5886 AS p_type_prf_0#5896, p_retailprice_prf#5887 AS p_retailprice_prf_0#5897, p_mfgr_prf#5888 AS p_mfgr_prf_0#5898, p_container_prf#5889 AS p_container_prf_0#5899, p_brand_prf#5890 AS p_brand_prf_0#5900, p_size_prf#5891 AS p_size_prf_0#5901, p_partkey_prf#5892 AS p_partkey_prf_0#5902]
         :     :  :     :  :  +- Relation[p_comment_prf#5883,p_name_prf#5884,rid#5885,p_type_prf#5886,p_retailprice_prf#5887,p_mfgr_prf#5888,p_container_prf#5889,p_brand_prf#5890,p_size_prf#5891,p_partkey_prf#5892] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5903]
         :     :  :     :     +- DexRidFilter part~p_size~15
         :     :  :     :        +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#5905 AS ps_partkey_and_ps_suppkey_prf_1#5912, rid#5906 AS rid_1#5913, ps_availqty_prf#5907 AS ps_availqty_prf_1#5914, ps_comment_prf#5908 AS ps_comment_prf_1#5915, ps_partkey_prf#5909 AS ps_partkey_prf_1#5916, ps_supplycost_prf#5910 AS ps_supplycost_prf_1#5917, ps_suppkey_prf#5911 AS ps_suppkey_prf_1#5918]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#5905,rid#5906,ps_availqty_prf#5907,ps_comment_prf#5908,ps_partkey_prf#5909,ps_supplycost_prf#5910,ps_suppkey_prf#5911] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5920 AS s_phone_prf_2#5928, rid#5921 AS rid_2#5929, s_address_prf#5922 AS s_address_prf_2#5930, s_nationkey_prf#5923 AS s_nationkey_prf_2#5931, s_suppkey_prf#5924 AS s_suppkey_prf_2#5932, s_name_prf#5925 AS s_name_prf_2#5933, s_acctbal_prf#5926 AS s_acctbal_prf_2#5934, s_comment_prf#5927 AS s_comment_prf_2#5935]
            +- Relation[s_phone_prf#5920,rid#5921,s_address_prf#5922,s_nationkey_prf#5923,s_suppkey_prf#5924,s_name_prf#5925,s_acctbal_prf#5926,s_comment_prf#5927] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 909ms

ft1d=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/17 03:51:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:51:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5983L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_nationkey#21L]
                  +- Filter isnotnull(s_nationkey#21L)
                     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 03:51:22 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:51:22 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:51:22 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:51:22 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:51:22 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:51:22 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:51:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5983L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#5985 AS c_acctbal_prf_0#5994, rid#5986 AS rid_0#5995, c_name_prf#5987 AS c_name_prf_0#5996, c_nationkey_prf#5988 AS c_nationkey_prf_0#5997, c_custkey_prf#5989 AS c_custkey_prf_0#5998, c_comment_prf#5990 AS c_comment_prf_0#5999, c_address_prf#5991 AS c_address_prf_0#6000, c_mktsegment_prf#5992 AS c_mktsegment_prf_0#6001, c_phone_prf#5993 AS c_phone_prf_0#6002]
         :  :  +- Relation[c_acctbal_prf#5985,rid#5986,c_name_prf#5987,c_nationkey_prf#5988,c_custkey_prf#5989,c_comment_prf#5990,c_address_prf#5991,c_mktsegment_prf#5992,c_phone_prf#5993] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#6013]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#6012]
         :        :  +- Relation[c_acctbal_prf#6003,rid#6004,c_name_prf#6005,c_nationkey_prf#6006,c_custkey_prf#6007,c_comment_prf#6008,c_address_prf#6009,c_mktsegment_prf#6010,c_phone_prf#6011] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#6025]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_1#6019: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [rid#6014 AS rid_1#6019, n_regionkey_prf#6015 AS n_regionkey_prf_1#6020, n_nationkey_prf#6016 AS n_nationkey_prf_1#6021, n_name_prf#6017 AS n_name_prf_1#6022, n_comment_prf#6018 AS n_comment_prf_1#6023]
            :     :  :  +- Relation[rid#6014,n_regionkey_prf#6015,n_nationkey_prf#6016,n_name_prf#6017,n_comment_prf#6018] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6024]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [s_phone_prf#6026 AS s_phone_prf_2#6034, rid#6027 AS rid_2#6035, s_address_prf#6028 AS s_address_prf_2#6036, s_nationkey_prf#6029 AS s_nationkey_prf_2#6037, s_suppkey_prf#6030 AS s_suppkey_prf_2#6038, s_name_prf#6031 AS s_name_prf_2#6039, s_acctbal_prf#6032 AS s_acctbal_prf_2#6040, s_comment_prf#6033 AS s_comment_prf_2#6041]
               +- Relation[s_phone_prf#6026,rid#6027,s_address_prf#6028,s_nationkey_prf#6029,s_suppkey_prf#6030,s_name_prf#6031,s_acctbal_prf#6032,s_comment_prf#6033] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 24292ms

fs1a=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/17 03:51:46 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:51:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6109L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [c_custkey#290L]
         :     :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L]
         :        +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/17 03:51:46 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:51:46 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:51:46 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:51:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6109L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, 'rid_2, 'l_returnflag_prf_2, 'l_orderkey_and_l_linenumber_prf_2, 'l_comment_prf_2, 'l_linestatus_prf_2, ... 15 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#6151]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#6130]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#6121: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [c_acctbal_prf#6111 AS c_acctbal_prf_0#6120, rid#6112 AS rid_0#6121, c_name_prf#6113 AS c_name_prf_0#6122, c_nationkey_prf#6114 AS c_nationkey_prf_0#6123, c_custkey_prf#6115 AS c_custkey_prf_0#6124, c_comment_prf#6116 AS c_comment_prf_0#6125, c_address_prf#6117 AS c_address_prf_0#6126, c_mktsegment_prf#6118 AS c_mktsegment_prf_0#6127, c_phone_prf#6119 AS c_phone_prf_0#6128]
         :     :  :     :  :     :  :  +- Relation[c_acctbal_prf#6111,rid#6112,c_name_prf#6113,c_nationkey_prf#6114,c_custkey_prf#6115,c_comment_prf#6116,c_address_prf#6117,c_mktsegment_prf#6118,c_phone_prf#6119] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#6129]
         :     :  :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :  :     :        +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [o_shippriority_prf#6131 AS o_shippriority_prf_1#6141, rid#6132 AS rid_1#6142, o_orderdate_prf#6133 AS o_orderdate_prf_1#6143, o_custkey_prf#6134 AS o_custkey_prf_1#6144, o_orderpriority_prf#6135 AS o_orderpriority_prf_1#6145, o_clerk_prf#6136 AS o_clerk_prf_1#6146, o_orderstatus_prf#6137 AS o_orderstatus_prf_1#6147, o_totalprice_prf#6138 AS o_totalprice_prf_1#6148, o_orderkey_prf#6139 AS o_orderkey_prf_1#6149, o_comment_prf#6140 AS o_comment_prf_1#6150]
         :     :  :     :     +- Relation[o_shippriority_prf#6131,rid#6132,o_orderdate_prf#6133,o_custkey_prf#6134,o_orderpriority_prf#6135,o_clerk_prf#6136,o_orderstatus_prf#6137,o_totalprice_prf#6138,o_orderkey_prf#6139,o_comment_prf#6140] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#6152 AS l_returnflag_prf_2#6171, l_orderkey_and_l_linenumber_prf#6153 AS l_orderkey_and_l_linenumber_prf_2#6172, l_comment_prf#6154 AS l_comment_prf_2#6173, l_linestatus_prf#6155 AS l_linestatus_prf_2#6174, rid#6156 AS rid_2#6175, l_shipmode_prf#6157 AS l_shipmode_prf_2#6176, l_shipinstruct_prf#6158 AS l_shipinstruct_prf_2#6177, l_quantity_prf#6159 AS l_quantity_prf_2#6178, l_receiptdate_prf#6160 AS l_receiptdate_prf_2#6179, l_linenumber_prf#6161 AS l_linenumber_prf_2#6180, l_tax_prf#6162 AS l_tax_prf_2#6181, l_shipdate_prf#6163 AS l_shipdate_prf_2#6182, l_extendedprice_prf#6164 AS l_extendedprice_prf_2#6183, l_partkey_prf#6165 AS l_partkey_prf_2#6184, l_discount_prf#6166 AS l_discount_prf_2#6185, l_partkey_and_l_suppkey_prf#6167 AS l_partkey_and_l_suppkey_prf_2#6186, l_commitdate_prf#6168 AS l_commitdate_prf_2#6187, l_suppkey_prf#6169 AS l_suppkey_prf_2#6188, l_orderkey_prf#6170 AS l_orderkey_prf_2#6189]
         :     :     +- Relation[l_returnflag_prf#6152,l_orderkey_and_l_linenumber_prf#6153,l_comment_prf#6154,l_linestatus_prf#6155,rid#6156,l_shipmode_prf#6157,l_shipinstruct_prf#6158,l_quantity_prf#6159,l_receiptdate_prf#6160,l_linenumber_prf#6161,l_tax_prf#6162,l_shipdate_prf#6163,l_extendedprice_prf#6164,l_partkey_prf#6165,l_discount_prf#6166,l_partkey_and_l_suppkey_prf#6167,l_commitdate_prf#6168,l_suppkey_prf#6169,l_orderkey_prf#6170] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#6191 AS p_comment_prf_3#6201, p_name_prf#6192 AS p_name_prf_3#6202, rid#6193 AS rid_3#6203, p_type_prf#6194 AS p_type_prf_3#6204, p_retailprice_prf#6195 AS p_retailprice_prf_3#6205, p_mfgr_prf#6196 AS p_mfgr_prf_3#6206, p_container_prf#6197 AS p_container_prf_3#6207, p_brand_prf#6198 AS p_brand_prf_3#6208, p_size_prf#6199 AS p_size_prf_3#6209, p_partkey_prf#6200 AS p_partkey_prf_3#6210]
            +- Relation[p_comment_prf#6191,p_name_prf#6192,rid#6193,p_type_prf#6194,p_retailprice_prf#6195,p_mfgr_prf#6196,p_container_prf#6197,p_brand_prf#6198,p_size_prf#6199,p_partkey_prf#6200] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 108149ms

fq1c=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 03:53:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:53:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6299L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [c_nationkey#293L, o_orderkey#342L]
               :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :     :- Project [c_custkey#290L, c_nationkey#293L]
               :     :  +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
               :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               :     +- Project [o_orderkey#342L, o_custkey#343L]
               :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 03:53:34 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:53:34 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:53:34 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:53:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6299L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#6312]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#6306: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [rid#6301 AS rid_0#6306, n_regionkey_prf#6302 AS n_regionkey_prf_0#6307, n_nationkey_prf#6303 AS n_nationkey_prf_0#6308, n_name_prf#6304 AS n_name_prf_0#6309, n_comment_prf#6305 AS n_comment_prf_0#6310]
         :     :  :  +- Relation[rid#6301,n_regionkey_prf#6302,n_nationkey_prf#6303,n_name_prf#6304,n_comment_prf#6305] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#6311]
         :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :        +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join NaturalJoin(Inner)
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- Project [c_acctbal_prf#6313 AS c_acctbal_prf_1#6322, rid#6314 AS rid_1#6323, c_name_prf#6315 AS c_name_prf_1#6324, c_nationkey_prf#6316 AS c_nationkey_prf_1#6325, c_custkey_prf#6317 AS c_custkey_prf_1#6326, c_comment_prf#6318 AS c_comment_prf_1#6327, c_address_prf#6319 AS c_address_prf_1#6328, c_mktsegment_prf#6320 AS c_mktsegment_prf_1#6329, c_phone_prf#6321 AS c_phone_prf_1#6330]
            :  :  :  :  +- Relation[c_acctbal_prf#6313,rid#6314,c_name_prf#6315,c_nationkey_prf#6316,c_custkey_prf#6317,c_comment_prf#6318,c_address_prf#6319,c_mktsegment_prf#6320,c_phone_prf#6321] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#6341]
            :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
            :  :  :        :- 'Project ['rid AS rid_1#6340]
            :  :  :        :  +- Relation[c_acctbal_prf#6331,rid#6332,c_name_prf#6333,c_nationkey_prf#6334,c_custkey_prf#6335,c_comment_prf#6336,c_address_prf#6337,c_mktsegment_prf#6338,c_phone_prf#6339] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            :  :  +- Project [o_shippriority_prf#6342 AS o_shippriority_prf_2#6352, rid#6343 AS rid_2#6353, o_orderdate_prf#6344 AS o_orderdate_prf_2#6354, o_custkey_prf#6345 AS o_custkey_prf_2#6355, o_orderpriority_prf#6346 AS o_orderpriority_prf_2#6356, o_clerk_prf#6347 AS o_clerk_prf_2#6357, o_orderstatus_prf#6348 AS o_orderstatus_prf_2#6358, o_totalprice_prf#6349 AS o_totalprice_prf_2#6359, o_orderkey_prf#6350 AS o_orderkey_prf_2#6360, o_comment_prf#6351 AS o_comment_prf_2#6361]
            :  :     +- Relation[o_shippriority_prf#6342,rid#6343,o_orderdate_prf#6344,o_custkey_prf#6345,o_orderpriority_prf#6346,o_clerk_prf#6347,o_orderstatus_prf#6348,o_totalprice_prf#6349,o_orderkey_prf#6350,o_comment_prf#6351] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2154) AS rid_3#6373]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#6372]
            :        :  +- Relation[o_shippriority_prf#6362,rid#6363,o_orderdate_prf#6364,o_custkey_prf#6365,o_orderpriority_prf#6366,o_clerk_prf#6367,o_orderstatus_prf#6368,o_totalprice_prf#6369,o_orderkey_prf#6370,o_comment_prf#6371] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#6374 AS l_returnflag_prf_3#6393, l_orderkey_and_l_linenumber_prf#6375 AS l_orderkey_and_l_linenumber_prf_3#6394, l_comment_prf#6376 AS l_comment_prf_3#6395, l_linestatus_prf#6377 AS l_linestatus_prf_3#6396, rid#6378 AS rid_3#6397, l_shipmode_prf#6379 AS l_shipmode_prf_3#6398, l_shipinstruct_prf#6380 AS l_shipinstruct_prf_3#6399, l_quantity_prf#6381 AS l_quantity_prf_3#6400, l_receiptdate_prf#6382 AS l_receiptdate_prf_3#6401, l_linenumber_prf#6383 AS l_linenumber_prf_3#6402, l_tax_prf#6384 AS l_tax_prf_3#6403, l_shipdate_prf#6385 AS l_shipdate_prf_3#6404, l_extendedprice_prf#6386 AS l_extendedprice_prf_3#6405, l_partkey_prf#6387 AS l_partkey_prf_3#6406, l_discount_prf#6388 AS l_discount_prf_3#6407, l_partkey_and_l_suppkey_prf#6389 AS l_partkey_and_l_suppkey_prf_3#6408, l_commitdate_prf#6390 AS l_commitdate_prf_3#6409, l_suppkey_prf#6391 AS l_suppkey_prf_3#6410, l_orderkey_prf#6392 AS l_orderkey_prf_3#6411]
               +- Relation[l_returnflag_prf#6374,l_orderkey_and_l_linenumber_prf#6375,l_comment_prf#6376,l_linestatus_prf#6377,rid#6378,l_shipmode_prf#6379,l_shipinstruct_prf#6380,l_quantity_prf#6381,l_receiptdate_prf#6382,l_linenumber_prf#6383,l_tax_prf#6384,l_shipdate_prf#6385,l_extendedprice_prf#6386,l_partkey_prf#6387,l_discount_prf#6388,l_partkey_and_l_suppkey_prf#6389,l_commitdate_prf#6390,l_suppkey_prf#6391,l_orderkey_prf#6392] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 164126ms

fr1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and (l_orderkey = o_orderkey and c_mktsegment = 'BUILDING')
19/10/17 03:56:18 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:56:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6491L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 03:56:18 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:56:18 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:56:18 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:56:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6491L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#6493 AS l_returnflag_prf_0#6512, l_orderkey_and_l_linenumber_prf#6494 AS l_orderkey_and_l_linenumber_prf_0#6513, l_comment_prf#6495 AS l_comment_prf_0#6514, l_linestatus_prf#6496 AS l_linestatus_prf_0#6515, rid#6497 AS rid_0#6516, l_shipmode_prf#6498 AS l_shipmode_prf_0#6517, l_shipinstruct_prf#6499 AS l_shipinstruct_prf_0#6518, l_quantity_prf#6500 AS l_quantity_prf_0#6519, l_receiptdate_prf#6501 AS l_receiptdate_prf_0#6520, l_linenumber_prf#6502 AS l_linenumber_prf_0#6521, l_tax_prf#6503 AS l_tax_prf_0#6522, l_shipdate_prf#6504 AS l_shipdate_prf_0#6523, l_extendedprice_prf#6505 AS l_extendedprice_prf_0#6524, l_partkey_prf#6506 AS l_partkey_prf_0#6525, l_discount_prf#6507 AS l_discount_prf_0#6526, l_partkey_and_l_suppkey_prf#6508 AS l_partkey_and_l_suppkey_prf_0#6527, l_commitdate_prf#6509 AS l_commitdate_prf_0#6528, l_suppkey_prf#6510 AS l_suppkey_prf_0#6529, l_orderkey_prf#6511 AS l_orderkey_prf_0#6530]
         :  :  +- Relation[l_returnflag_prf#6493,l_orderkey_and_l_linenumber_prf#6494,l_comment_prf#6495,l_linestatus_prf#6496,rid#6497,l_shipmode_prf#6498,l_shipinstruct_prf#6499,l_quantity_prf#6500,l_receiptdate_prf#6501,l_linenumber_prf#6502,l_tax_prf#6503,l_shipdate_prf#6504,l_extendedprice_prf#6505,l_partkey_prf#6506,l_discount_prf#6507,l_partkey_and_l_suppkey_prf#6508,l_commitdate_prf#6509,l_suppkey_prf#6510,l_orderkey_prf#6511] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#6551]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#6550]
         :        :  +- Relation[l_returnflag_prf#6531,l_orderkey_and_l_linenumber_prf#6532,l_comment_prf#6533,l_linestatus_prf#6534,rid#6535,l_shipmode_prf#6536,l_shipinstruct_prf#6537,l_quantity_prf#6538,l_receiptdate_prf#6539,l_linenumber_prf#6540,l_tax_prf#6541,l_shipdate_prf#6542,l_extendedprice_prf#6543,l_partkey_prf#6544,l_discount_prf#6545,l_partkey_and_l_suppkey_prf#6546,l_commitdate_prf#6547,l_suppkey_prf#6548,l_orderkey_prf#6549] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [o_shippriority_prf#6552 AS o_shippriority_prf_1#6562, rid#6553 AS rid_1#6563, o_orderdate_prf#6554 AS o_orderdate_prf_1#6564, o_custkey_prf#6555 AS o_custkey_prf_1#6565, o_orderpriority_prf#6556 AS o_orderpriority_prf_1#6566, o_clerk_prf#6557 AS o_clerk_prf_1#6567, o_orderstatus_prf#6558 AS o_orderstatus_prf_1#6568, o_totalprice_prf#6559 AS o_totalprice_prf_1#6569, o_orderkey_prf#6560 AS o_orderkey_prf_1#6570, o_comment_prf#6561 AS o_comment_prf_1#6571]
            :  :  +- Relation[o_shippriority_prf#6552,rid#6553,o_orderdate_prf#6554,o_custkey_prf#6555,o_orderpriority_prf#6556,o_clerk_prf#6557,o_orderstatus_prf#6558,o_totalprice_prf#6559,o_orderkey_prf#6560,o_comment_prf#6561] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#6583]
            :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#6582]
            :        :  +- Relation[o_shippriority_prf#6572,rid#6573,o_orderdate_prf#6574,o_custkey_prf#6575,o_orderpriority_prf#6576,o_clerk_prf#6577,o_orderstatus_prf#6578,o_totalprice_prf#6579,o_orderkey_prf#6580,o_comment_prf#6581] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [c_acctbal_prf#6584 AS c_acctbal_prf_2#6593, rid#6585 AS rid_2#6594, c_name_prf#6586 AS c_name_prf_2#6595, c_nationkey_prf#6587 AS c_nationkey_prf_2#6596, c_custkey_prf#6588 AS c_custkey_prf_2#6597, c_comment_prf#6589 AS c_comment_prf_2#6598, c_address_prf#6590 AS c_address_prf_2#6599, c_mktsegment_prf#6591 AS c_mktsegment_prf_2#6600, c_phone_prf#6592 AS c_phone_prf_2#6601]
               :  +- Relation[c_acctbal_prf#6584,rid#6585,c_name_prf#6586,c_nationkey_prf#6587,c_custkey_prf#6588,c_comment_prf#6589,c_address_prf#6590,c_mktsegment_prf#6591,c_phone_prf#6592] JDBCRelation(customer_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#6602]
                  +- DexRidFilter customer~c_mktsegment~BUILDING
                     +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 121040ms

fr2d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderstatus = 'F' and o_orderkey = l_orderkey
19/10/17 03:58:19 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:58:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6677L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 03:58:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6677L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#6729]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [c_acctbal_prf#6679 AS c_acctbal_prf_0#6688, rid#6680 AS rid_0#6689, c_name_prf#6681 AS c_name_prf_0#6690, c_nationkey_prf#6682 AS c_nationkey_prf_0#6691, c_custkey_prf#6683 AS c_custkey_prf_0#6692, c_comment_prf#6684 AS c_comment_prf_0#6693, c_address_prf#6685 AS c_address_prf_0#6694, c_mktsegment_prf#6686 AS c_mktsegment_prf_0#6695, c_phone_prf#6687 AS c_phone_prf_0#6696]
         :     :  :  :  +- Relation[c_acctbal_prf#6679,rid#6680,c_name_prf#6681,c_nationkey_prf#6682,c_custkey_prf#6683,c_comment_prf#6684,c_address_prf#6685,c_mktsegment_prf#6686,c_phone_prf#6687] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#6707]
         :     :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#6706]
         :     :  :        :  +- Relation[c_acctbal_prf#6697,rid#6698,c_name_prf#6699,c_nationkey_prf#6700,c_custkey_prf#6701,c_comment_prf#6702,c_address_prf#6703,c_mktsegment_prf#6704,c_phone_prf#6705] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [o_shippriority_prf#6708 AS o_shippriority_prf_1#6718, rid#6709 AS rid_1#6719, o_orderdate_prf#6710 AS o_orderdate_prf_1#6720, o_custkey_prf#6711 AS o_custkey_prf_1#6721, o_orderpriority_prf#6712 AS o_orderpriority_prf_1#6722, o_clerk_prf#6713 AS o_clerk_prf_1#6723, o_orderstatus_prf#6714 AS o_orderstatus_prf_1#6724, o_totalprice_prf#6715 AS o_totalprice_prf_1#6725, o_orderkey_prf#6716 AS o_orderkey_prf_1#6726, o_comment_prf#6717 AS o_comment_prf_1#6727]
         :     :     :  +- Relation[o_shippriority_prf#6708,rid#6709,o_orderdate_prf#6710,o_custkey_prf#6711,o_orderpriority_prf#6712,o_clerk_prf#6713,o_orderstatus_prf#6714,o_totalprice_prf#6715,o_orderkey_prf#6716,o_comment_prf#6717] JDBCRelation(orders_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6728]
         :     :        +- DexRidFilter orders~o_orderstatus~F
         :     :           +- Relation[label#2206,value#2207] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#6730 AS l_returnflag_prf_2#6749, l_orderkey_and_l_linenumber_prf#6731 AS l_orderkey_and_l_linenumber_prf_2#6750, l_comment_prf#6732 AS l_comment_prf_2#6751, l_linestatus_prf#6733 AS l_linestatus_prf_2#6752, rid#6734 AS rid_2#6753, l_shipmode_prf#6735 AS l_shipmode_prf_2#6754, l_shipinstruct_prf#6736 AS l_shipinstruct_prf_2#6755, l_quantity_prf#6737 AS l_quantity_prf_2#6756, l_receiptdate_prf#6738 AS l_receiptdate_prf_2#6757, l_linenumber_prf#6739 AS l_linenumber_prf_2#6758, l_tax_prf#6740 AS l_tax_prf_2#6759, l_shipdate_prf#6741 AS l_shipdate_prf_2#6760, l_extendedprice_prf#6742 AS l_extendedprice_prf_2#6761, l_partkey_prf#6743 AS l_partkey_prf_2#6762, l_discount_prf#6744 AS l_discount_prf_2#6763, l_partkey_and_l_suppkey_prf#6745 AS l_partkey_and_l_suppkey_prf_2#6764, l_commitdate_prf#6746 AS l_commitdate_prf_2#6765, l_suppkey_prf#6747 AS l_suppkey_prf_2#6766, l_orderkey_prf#6748 AS l_orderkey_prf_2#6767]
            +- Relation[l_returnflag_prf#6730,l_orderkey_and_l_linenumber_prf#6731,l_comment_prf#6732,l_linestatus_prf#6733,rid#6734,l_shipmode_prf#6735,l_shipinstruct_prf#6736,l_quantity_prf#6737,l_receiptdate_prf#6738,l_linenumber_prf#6739,l_tax_prf#6740,l_shipdate_prf#6741,l_extendedprice_prf#6742,l_partkey_prf#6743,l_discount_prf#6744,l_partkey_and_l_suppkey_prf#6745,l_commitdate_prf#6746,l_suppkey_prf#6747,l_orderkey_prf#6748] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 108008ms
query=fq1a, count=246415, duration=30879
query=fq1b, count=246415, duration=140142
query=fq1c, count=246415, duration=164126
query=fq1d, count=246415, duration=74384
query=fq1e, count=246415, duration=164875
query=fq1f, count=246415, duration=168605
query=fr1a, count=1214743, duration=121388
query=fr1b, count=1214743, duration=121040
query=fr1c, count=1214743, duration=82976
query=fr1d, count=1214743, duration=32880
query=fr1e, count=1214743, duration=152942
query=fr2a, count=2901744, duration=193618
query=fr2b, count=2901744, duration=106006
query=fr2d, count=2901744, duration=108008
query=fr2e, count=2901744, duration=96075
query=fr2f, count=2901744, duration=83175
query=fs1a, count=1214743, duration=108149
query=fs1b, count=1214743, duration=172737
query=fs1c, count=1214743, duration=173085
query=ft1a, count=2452200, duration=47972
query=ft1b, count=2452200, duration=30048
query=ft1c, count=2452200, duration=33069
query=ft1d, count=2452200, duration=24292
query=ft2a, count=15628, duration=49337
query=ft2b, count=15628, duration=909
query=ft2c, count=15628, duration=7017
query=ft3a, count=117754, duration=96638
query=ft3b, count=117754, duration=6158
query=ft3c, count=117754, duration=55731
