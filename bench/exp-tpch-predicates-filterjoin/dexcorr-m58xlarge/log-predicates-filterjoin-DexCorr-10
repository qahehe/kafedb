19/10/16 13:17:43 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7163ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Wed Oct 16 13:17:45 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Wed Oct 16 13:17:46 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Wed Oct 16 13:17:46 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Wed Oct 16 13:17:46 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Wed Oct 16 13:17:46 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Wed Oct 16 13:17:49 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Wed Oct 16 13:17:51 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Wed Oct 16 13:17:51 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



fr2b=
select * from lineitem, orders, customer where o_custkey = c_custkey and o_orderstatus = 'F' and l_orderkey = o_orderkey
19/10/16 13:17:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 13:17:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1795L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 13:17:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1795L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_1#1837]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#1820: string
         :     :- Project [l_returnflag_prf#1797 AS l_returnflag_prf_0#1816, l_orderkey_and_l_linenumber_prf#1798 AS l_orderkey_and_l_linenumber_prf_0#1817, l_comment_prf#1799 AS l_comment_prf_0#1818, l_linestatus_prf#1800 AS l_linestatus_prf_0#1819, rid#1801 AS rid_0#1820, l_shipmode_prf#1802 AS l_shipmode_prf_0#1821, l_shipinstruct_prf#1803 AS l_shipinstruct_prf_0#1822, l_quantity_prf#1804 AS l_quantity_prf_0#1823, l_receiptdate_prf#1805 AS l_receiptdate_prf_0#1824, l_linenumber_prf#1806 AS l_linenumber_prf_0#1825, l_tax_prf#1807 AS l_tax_prf_0#1826, l_shipdate_prf#1808 AS l_shipdate_prf_0#1827, l_extendedprice_prf#1809 AS l_extendedprice_prf_0#1828, l_partkey_prf#1810 AS l_partkey_prf_0#1829, l_discount_prf#1811 AS l_discount_prf_0#1830, l_partkey_and_l_suppkey_prf#1812 AS l_partkey_and_l_suppkey_prf_0#1831, l_commitdate_prf#1813 AS l_commitdate_prf_0#1832, l_suppkey_prf#1814 AS l_suppkey_prf_0#1833, l_orderkey_prf#1815 AS l_orderkey_prf_0#1834]
         :     :  +- Relation[l_returnflag_prf#1797,l_orderkey_and_l_linenumber_prf#1798,l_comment_prf#1799,l_linestatus_prf#1800,rid#1801,l_shipmode_prf#1802,l_shipinstruct_prf#1803,l_quantity_prf#1804,l_receiptdate_prf#1805,l_linenumber_prf#1806,l_tax_prf#1807,l_shipdate_prf#1808,l_extendedprice_prf#1809,l_partkey_prf#1810,l_discount_prf#1811,l_partkey_and_l_suppkey_prf#1812,l_commitdate_prf#1813,l_suppkey_prf#1814,l_orderkey_prf#1815] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1836) AS rid_2#1861]
            :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#1849: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#1838 AS o_shippriority_prf_1#1848, rid#1839 AS rid_1#1849, o_orderdate_prf#1840 AS o_orderdate_prf_1#1850, o_custkey_prf#1841 AS o_custkey_prf_1#1851, o_orderpriority_prf#1842 AS o_orderpriority_prf_1#1852, o_clerk_prf#1843 AS o_clerk_prf_1#1853, o_orderstatus_prf#1844 AS o_orderstatus_prf_1#1854, o_totalprice_prf#1845 AS o_totalprice_prf_1#1855, o_orderkey_prf#1846 AS o_orderkey_prf_1#1856, o_comment_prf#1847 AS o_comment_prf_1#1857]
            :     :  :  +- Relation[o_shippriority_prf#1838,rid#1839,o_orderdate_prf#1840,o_custkey_prf#1841,o_orderpriority_prf#1842,o_clerk_prf#1843,o_orderstatus_prf#1844,o_totalprice_prf#1845,o_orderkey_prf#1846,o_comment_prf#1847] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#1860]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#1862 AS c_acctbal_prf_2#1871, rid#1863 AS rid_2#1872, c_name_prf#1864 AS c_name_prf_2#1873, c_nationkey_prf#1865 AS c_nationkey_prf_2#1874, c_custkey_prf#1866 AS c_custkey_prf_2#1875, c_comment_prf#1867 AS c_comment_prf_2#1876, c_address_prf#1868 AS c_address_prf_2#1877, c_mktsegment_prf#1869 AS c_mktsegment_prf_2#1878, c_phone_prf#1870 AS c_phone_prf_2#1879]
               +- Relation[c_acctbal_prf#1862,rid#1863,c_name_prf#1864,c_nationkey_prf#1865,c_custkey_prf#1866,c_comment_prf#1867,c_address_prf#1868,c_mktsegment_prf#1869,c_phone_prf#1870] JDBCRelation(customer_prf) [numPartitions=1]

19/10/16 13:17:52 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=2901744
Elapsed time: 121498ms

fr2e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/16 13:19:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 13:19:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1954L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 13:19:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1954L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_1#1974]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#1966: string
         :     :- Project [c_acctbal_prf#1956 AS c_acctbal_prf_0#1965, rid#1957 AS rid_0#1966, c_name_prf#1958 AS c_name_prf_0#1967, c_nationkey_prf#1959 AS c_nationkey_prf_0#1968, c_custkey_prf#1960 AS c_custkey_prf_0#1969, c_comment_prf#1961 AS c_comment_prf_0#1970, c_address_prf#1962 AS c_address_prf_0#1971, c_mktsegment_prf#1963 AS c_mktsegment_prf_0#1972, c_phone_prf#1964 AS c_phone_prf_0#1973]
         :     :  +- Relation[c_acctbal_prf#1956,rid#1957,c_name_prf#1958,c_nationkey_prf#1959,c_custkey_prf#1960,c_comment_prf#1961,c_address_prf#1962,c_mktsegment_prf#1963,c_phone_prf#1964] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1836) AS rid_2#1996]
            :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#1986: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#1975 AS o_shippriority_prf_1#1985, rid#1976 AS rid_1#1986, o_orderdate_prf#1977 AS o_orderdate_prf_1#1987, o_custkey_prf#1978 AS o_custkey_prf_1#1988, o_orderpriority_prf#1979 AS o_orderpriority_prf_1#1989, o_clerk_prf#1980 AS o_clerk_prf_1#1990, o_orderstatus_prf#1981 AS o_orderstatus_prf_1#1991, o_totalprice_prf#1982 AS o_totalprice_prf_1#1992, o_orderkey_prf#1983 AS o_orderkey_prf_1#1993, o_comment_prf#1984 AS o_comment_prf_1#1994]
            :     :  :  +- Relation[o_shippriority_prf#1975,rid#1976,o_orderdate_prf#1977,o_custkey_prf#1978,o_orderpriority_prf#1979,o_clerk_prf#1980,o_orderstatus_prf#1981,o_totalprice_prf#1982,o_orderkey_prf#1983,o_comment_prf#1984] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#1995]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#1997 AS l_returnflag_prf_2#2016, l_orderkey_and_l_linenumber_prf#1998 AS l_orderkey_and_l_linenumber_prf_2#2017, l_comment_prf#1999 AS l_comment_prf_2#2018, l_linestatus_prf#2000 AS l_linestatus_prf_2#2019, rid#2001 AS rid_2#2020, l_shipmode_prf#2002 AS l_shipmode_prf_2#2021, l_shipinstruct_prf#2003 AS l_shipinstruct_prf_2#2022, l_quantity_prf#2004 AS l_quantity_prf_2#2023, l_receiptdate_prf#2005 AS l_receiptdate_prf_2#2024, l_linenumber_prf#2006 AS l_linenumber_prf_2#2025, l_tax_prf#2007 AS l_tax_prf_2#2026, l_shipdate_prf#2008 AS l_shipdate_prf_2#2027, l_extendedprice_prf#2009 AS l_extendedprice_prf_2#2028, l_partkey_prf#2010 AS l_partkey_prf_2#2029, l_discount_prf#2011 AS l_discount_prf_2#2030, l_partkey_and_l_suppkey_prf#2012 AS l_partkey_and_l_suppkey_prf_2#2031, l_commitdate_prf#2013 AS l_commitdate_prf_2#2032, l_suppkey_prf#2014 AS l_suppkey_prf_2#2033, l_orderkey_prf#2015 AS l_orderkey_prf_2#2034]
               +- Relation[l_returnflag_prf#1997,l_orderkey_and_l_linenumber_prf#1998,l_comment_prf#1999,l_linestatus_prf#2000,rid#2001,l_shipmode_prf#2002,l_shipinstruct_prf#2003,l_quantity_prf#2004,l_receiptdate_prf#2005,l_linenumber_prf#2006,l_tax_prf#2007,l_shipdate_prf#2008,l_extendedprice_prf#2009,l_partkey_prf#2010,l_discount_prf#2011,l_partkey_and_l_suppkey_prf#2012,l_commitdate_prf#2013,l_suppkey_prf#2014,l_orderkey_prf#2015] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 98739ms

fr2a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_orderstatus = 'F' and o_custkey = c_custkey
19/10/16 13:21:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 13:21:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2109L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 13:21:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2109L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_1#2149]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2134: string
         :  :  :     :- Project [l_returnflag_prf#2111 AS l_returnflag_prf_0#2130, l_orderkey_and_l_linenumber_prf#2112 AS l_orderkey_and_l_linenumber_prf_0#2131, l_comment_prf#2113 AS l_comment_prf_0#2132, l_linestatus_prf#2114 AS l_linestatus_prf_0#2133, rid#2115 AS rid_0#2134, l_shipmode_prf#2116 AS l_shipmode_prf_0#2135, l_shipinstruct_prf#2117 AS l_shipinstruct_prf_0#2136, l_quantity_prf#2118 AS l_quantity_prf_0#2137, l_receiptdate_prf#2119 AS l_receiptdate_prf_0#2138, l_linenumber_prf#2120 AS l_linenumber_prf_0#2139, l_tax_prf#2121 AS l_tax_prf_0#2140, l_shipdate_prf#2122 AS l_shipdate_prf_0#2141, l_extendedprice_prf#2123 AS l_extendedprice_prf_0#2142, l_partkey_prf#2124 AS l_partkey_prf_0#2143, l_discount_prf#2125 AS l_discount_prf_0#2144, l_partkey_and_l_suppkey_prf#2126 AS l_partkey_and_l_suppkey_prf_0#2145, l_commitdate_prf#2127 AS l_commitdate_prf_0#2146, l_suppkey_prf#2128 AS l_suppkey_prf_0#2147, l_orderkey_prf#2129 AS l_orderkey_prf_0#2148]
         :  :  :     :  +- Relation[l_returnflag_prf#2111,l_orderkey_and_l_linenumber_prf#2112,l_comment_prf#2113,l_linestatus_prf#2114,rid#2115,l_shipmode_prf#2116,l_shipinstruct_prf#2117,l_quantity_prf#2118,l_receiptdate_prf#2119,l_linenumber_prf#2120,l_tax_prf#2121,l_shipdate_prf#2122,l_extendedprice_prf#2123,l_partkey_prf#2124,l_discount_prf#2125,l_partkey_and_l_suppkey_prf#2126,l_commitdate_prf#2127,l_suppkey_prf#2128,l_orderkey_prf#2129] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :     :- Project [o_shippriority_prf#2150 AS o_shippriority_prf_1#2160, rid#2151 AS rid_1#2161, o_orderdate_prf#2152 AS o_orderdate_prf_1#2162, o_custkey_prf#2153 AS o_custkey_prf_1#2163, o_orderpriority_prf#2154 AS o_orderpriority_prf_1#2164, o_clerk_prf#2155 AS o_clerk_prf_1#2165, o_orderstatus_prf#2156 AS o_orderstatus_prf_1#2166, o_totalprice_prf#2157 AS o_totalprice_prf_1#2167, o_orderkey_prf#2158 AS o_orderkey_prf_1#2168, o_comment_prf#2159 AS o_comment_prf_1#2169]
         :  :     :  +- Relation[o_shippriority_prf#2150,rid#2151,o_orderdate_prf#2152,o_custkey_prf#2153,o_orderpriority_prf#2154,o_clerk_prf#2155,o_orderstatus_prf#2156,o_totalprice_prf#2157,o_orderkey_prf#2158,o_comment_prf#2159] JDBCRelation(orders_prf) [numPartitions=1]
         :  :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2170]
         :  :        +- DexRidFilter orders~o_orderstatus~F
         :  :           +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1836) AS rid_2#2182]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2181]
         :        :  +- Relation[o_shippriority_prf#2171,rid#2172,o_orderdate_prf#2173,o_custkey_prf#2174,o_orderpriority_prf#2175,o_clerk_prf#2176,o_orderstatus_prf#2177,o_totalprice_prf#2178,o_orderkey_prf#2179,o_comment_prf#2180] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2183 AS c_acctbal_prf_2#2192, rid#2184 AS rid_2#2193, c_name_prf#2185 AS c_name_prf_2#2194, c_nationkey_prf#2186 AS c_nationkey_prf_2#2195, c_custkey_prf#2187 AS c_custkey_prf_2#2196, c_comment_prf#2188 AS c_comment_prf_2#2197, c_address_prf#2189 AS c_address_prf_2#2198, c_mktsegment_prf#2190 AS c_mktsegment_prf_2#2199, c_phone_prf#2191 AS c_phone_prf_2#2200]
            +- Relation[c_acctbal_prf#2183,rid#2184,c_name_prf#2185,c_nationkey_prf#2186,c_custkey_prf#2187,c_comment_prf#2188,c_address_prf#2189,c_mktsegment_prf#2190,c_phone_prf#2191] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 174678ms

ft1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/16 13:24:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 13:24:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2261L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/16 13:24:27 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 13:24:27 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 13:24:27 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 13:24:27 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 13:24:27 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 13:24:27 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 13:24:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2261L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_2#2281]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#2273: string
         :     :- Project [c_acctbal_prf#2263 AS c_acctbal_prf_0#2272, rid#2264 AS rid_0#2273, c_name_prf#2265 AS c_name_prf_0#2274, c_nationkey_prf#2266 AS c_nationkey_prf_0#2275, c_custkey_prf#2267 AS c_custkey_prf_0#2276, c_comment_prf#2268 AS c_comment_prf_0#2277, c_address_prf#2269 AS c_address_prf_0#2278, c_mktsegment_prf#2270 AS c_mktsegment_prf_0#2279, c_phone_prf#2271 AS c_phone_prf_0#2280]
         :     :  +- Relation[c_acctbal_prf#2263,rid#2264,c_name_prf#2265,c_nationkey_prf#2266,c_custkey_prf#2267,c_comment_prf#2268,c_address_prf#2269,c_mktsegment_prf#2270,c_phone_prf#2271] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1836) AS rid_2#2298]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#2291: string
            :     :- Project [s_phone_prf#2282 AS s_phone_prf_1#2290, rid#2283 AS rid_1#2291, s_address_prf#2284 AS s_address_prf_1#2292, s_nationkey_prf#2285 AS s_nationkey_prf_1#2293, s_suppkey_prf#2286 AS s_suppkey_prf_1#2294, s_name_prf#2287 AS s_name_prf_1#2295, s_acctbal_prf#2288 AS s_acctbal_prf_1#2296, s_comment_prf#2289 AS s_comment_prf_1#2297]
            :     :  +- Relation[s_phone_prf#2282,rid#2283,s_address_prf#2284,s_nationkey_prf#2285,s_suppkey_prf#2286,s_name_prf#2287,s_acctbal_prf#2288,s_comment_prf#2289] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [rid#2299 AS rid_2#2304, n_regionkey_prf#2300 AS n_regionkey_prf_2#2305, n_nationkey_prf#2301 AS n_nationkey_prf_2#2306, n_name_prf#2302 AS n_name_prf_2#2307, n_comment_prf#2303 AS n_comment_prf_2#2308]
               :  +- Relation[rid#2299,n_regionkey_prf#2300,n_nationkey_prf#2301,n_name_prf#2302,n_comment_prf#2303] JDBCRelation(nation_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#2309]
                  +- DexRidFilter nation~n_name~FRANCE
                     +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 33632ms

ft2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and p_size = 15 and ps_suppkey = s_suppkey
19/10/16 13:25:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 13:25:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2356L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 13:25:01 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 13:25:01 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 13:25:01 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 13:25:01 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 13:25:01 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 13:25:01 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 13:25:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2356L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_1#2372]
         :  :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#2366: string
         :  :  :     :- Project [ps_partkey_and_ps_suppkey_prf#2358 AS ps_partkey_and_ps_suppkey_prf_0#2365, rid#2359 AS rid_0#2366, ps_availqty_prf#2360 AS ps_availqty_prf_0#2367, ps_comment_prf#2361 AS ps_comment_prf_0#2368, ps_partkey_prf#2362 AS ps_partkey_prf_0#2369, ps_supplycost_prf#2363 AS ps_supplycost_prf_0#2370, ps_suppkey_prf#2364 AS ps_suppkey_prf_0#2371]
         :  :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2358,rid#2359,ps_availqty_prf#2360,ps_comment_prf#2361,ps_partkey_prf#2362,ps_supplycost_prf#2363,ps_suppkey_prf#2364] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :     :- Project [p_comment_prf#2373 AS p_comment_prf_1#2383, p_name_prf#2374 AS p_name_prf_1#2384, rid#2375 AS rid_1#2385, p_type_prf#2376 AS p_type_prf_1#2386, p_retailprice_prf#2377 AS p_retailprice_prf_1#2387, p_mfgr_prf#2378 AS p_mfgr_prf_1#2388, p_container_prf#2379 AS p_container_prf_1#2389, p_brand_prf#2380 AS p_brand_prf_1#2390, p_size_prf#2381 AS p_size_prf_1#2391, p_partkey_prf#2382 AS p_partkey_prf_1#2392]
         :  :     :  +- Relation[p_comment_prf#2373,p_name_prf#2374,rid#2375,p_type_prf#2376,p_retailprice_prf#2377,p_mfgr_prf#2378,p_container_prf#2379,p_brand_prf#2380,p_size_prf#2381,p_partkey_prf#2382] JDBCRelation(part_prf) [numPartitions=1]
         :  :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2393]
         :  :        +- DexRidFilter part~p_size~15
         :  :           +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1836) AS rid_2#2402]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2401]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#2394,rid#2395,ps_availqty_prf#2396,ps_comment_prf#2397,ps_partkey_prf#2398,ps_supplycost_prf#2399,ps_suppkey_prf#2400] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2403 AS s_phone_prf_2#2411, rid#2404 AS rid_2#2412, s_address_prf#2405 AS s_address_prf_2#2413, s_nationkey_prf#2406 AS s_nationkey_prf_2#2414, s_suppkey_prf#2407 AS s_suppkey_prf_2#2415, s_name_prf#2408 AS s_name_prf_2#2416, s_acctbal_prf#2409 AS s_acctbal_prf_2#2417, s_comment_prf#2410 AS s_comment_prf_2#2418]
            +- Relation[s_phone_prf#2403,rid#2404,s_address_prf#2405,s_nationkey_prf#2406,s_suppkey_prf#2407,s_name_prf#2408,s_acctbal_prf#2409,s_comment_prf#2410] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 101333ms

ft3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and p_size = 15 and l_suppkey = s_suppkey
19/10/16 13:26:42 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 13:26:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2479L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 13:26:42 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 13:26:42 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 13:26:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2479L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_1#2519]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#2504: string
         :  :  :     :- Project [l_returnflag_prf#2481 AS l_returnflag_prf_0#2500, l_orderkey_and_l_linenumber_prf#2482 AS l_orderkey_and_l_linenumber_prf_0#2501, l_comment_prf#2483 AS l_comment_prf_0#2502, l_linestatus_prf#2484 AS l_linestatus_prf_0#2503, rid#2485 AS rid_0#2504, l_shipmode_prf#2486 AS l_shipmode_prf_0#2505, l_shipinstruct_prf#2487 AS l_shipinstruct_prf_0#2506, l_quantity_prf#2488 AS l_quantity_prf_0#2507, l_receiptdate_prf#2489 AS l_receiptdate_prf_0#2508, l_linenumber_prf#2490 AS l_linenumber_prf_0#2509, l_tax_prf#2491 AS l_tax_prf_0#2510, l_shipdate_prf#2492 AS l_shipdate_prf_0#2511, l_extendedprice_prf#2493 AS l_extendedprice_prf_0#2512, l_partkey_prf#2494 AS l_partkey_prf_0#2513, l_discount_prf#2495 AS l_discount_prf_0#2514, l_partkey_and_l_suppkey_prf#2496 AS l_partkey_and_l_suppkey_prf_0#2515, l_commitdate_prf#2497 AS l_commitdate_prf_0#2516, l_suppkey_prf#2498 AS l_suppkey_prf_0#2517, l_orderkey_prf#2499 AS l_orderkey_prf_0#2518]
         :  :  :     :  +- Relation[l_returnflag_prf#2481,l_orderkey_and_l_linenumber_prf#2482,l_comment_prf#2483,l_linestatus_prf#2484,rid#2485,l_shipmode_prf#2486,l_shipinstruct_prf#2487,l_quantity_prf#2488,l_receiptdate_prf#2489,l_linenumber_prf#2490,l_tax_prf#2491,l_shipdate_prf#2492,l_extendedprice_prf#2493,l_partkey_prf#2494,l_discount_prf#2495,l_partkey_and_l_suppkey_prf#2496,l_commitdate_prf#2497,l_suppkey_prf#2498,l_orderkey_prf#2499] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#2520 AS p_comment_prf_1#2530, p_name_prf#2521 AS p_name_prf_1#2531, rid#2522 AS rid_1#2532, p_type_prf#2523 AS p_type_prf_1#2533, p_retailprice_prf#2524 AS p_retailprice_prf_1#2534, p_mfgr_prf#2525 AS p_mfgr_prf_1#2535, p_container_prf#2526 AS p_container_prf_1#2536, p_brand_prf#2527 AS p_brand_prf_1#2537, p_size_prf#2528 AS p_size_prf_1#2538, p_partkey_prf#2529 AS p_partkey_prf_1#2539]
         :  :     +- Relation[p_comment_prf#2520,p_name_prf#2521,rid#2522,p_type_prf#2523,p_retailprice_prf#2524,p_mfgr_prf#2525,p_container_prf#2526,p_brand_prf#2527,p_size_prf#2528,p_partkey_prf#2529] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1836) AS rid_2#2560]
         :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2559]
         :        :  +- Relation[l_returnflag_prf#2540,l_orderkey_and_l_linenumber_prf#2541,l_comment_prf#2542,l_linestatus_prf#2543,rid#2544,l_shipmode_prf#2545,l_shipinstruct_prf#2546,l_quantity_prf#2547,l_receiptdate_prf#2548,l_linenumber_prf#2549,l_tax_prf#2550,l_shipdate_prf#2551,l_extendedprice_prf#2552,l_partkey_prf#2553,l_discount_prf#2554,l_partkey_and_l_suppkey_prf#2555,l_commitdate_prf#2556,l_suppkey_prf#2557,l_orderkey_prf#2558] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2561 AS s_phone_prf_2#2569, rid#2562 AS rid_2#2570, s_address_prf#2563 AS s_address_prf_2#2571, s_nationkey_prf#2564 AS s_nationkey_prf_2#2572, s_suppkey_prf#2565 AS s_suppkey_prf_2#2573, s_name_prf#2566 AS s_name_prf_2#2574, s_acctbal_prf#2567 AS s_acctbal_prf_2#2575, s_comment_prf#2568 AS s_comment_prf_2#2576]
            +- Relation[s_phone_prf#2561,rid#2562,s_address_prf#2563,s_nationkey_prf#2564,s_suppkey_prf#2565,s_name_prf#2566,s_acctbal_prf#2567,s_comment_prf#2568] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 221425ms

fq1a=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 13:30:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 13:30:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2654L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :     :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 13:30:23 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 13:30:23 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 13:30:23 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 13:30:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2654L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_1#2667]
         :  :  :  :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#2661: string
         :  :  :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :     :  :- Project [rid#2656 AS rid_0#2661, n_regionkey_prf#2657 AS n_regionkey_prf_0#2662, n_nationkey_prf#2658 AS n_nationkey_prf_0#2663, n_name_prf#2659 AS n_name_prf_0#2664, n_comment_prf#2660 AS n_comment_prf_0#2665]
         :  :  :  :  :     :  :  +- Relation[rid#2656,n_regionkey_prf#2657,n_nationkey_prf#2658,n_name_prf#2659,n_comment_prf#2660] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2666]
         :  :  :  :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :  :  :  :  :     :        +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :  :  :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [c_acctbal_prf#2668 AS c_acctbal_prf_1#2677, rid#2669 AS rid_1#2678, c_name_prf#2670 AS c_name_prf_1#2679, c_nationkey_prf#2671 AS c_nationkey_prf_1#2680, c_custkey_prf#2672 AS c_custkey_prf_1#2681, c_comment_prf#2673 AS c_comment_prf_1#2682, c_address_prf#2674 AS c_address_prf_1#2683, c_mktsegment_prf#2675 AS c_mktsegment_prf_1#2684, c_phone_prf#2676 AS c_phone_prf_1#2685]
         :  :  :  :     +- Relation[c_acctbal_prf#2668,rid#2669,c_name_prf#2670,c_nationkey_prf#2671,c_custkey_prf#2672,c_comment_prf#2673,c_address_prf#2674,c_mktsegment_prf#2675,c_phone_prf#2676] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1836) AS rid_2#2696]
         :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :  :  :        :- 'Project ['rid AS rid_1#2695]
         :  :  :        :  +- Relation[c_acctbal_prf#2686,rid#2687,c_name_prf#2688,c_nationkey_prf#2689,c_custkey_prf#2690,c_comment_prf#2691,c_address_prf#2692,c_mktsegment_prf#2693,c_phone_prf#2694] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :        +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#2697 AS o_shippriority_prf_2#2707, rid#2698 AS rid_2#2708, o_orderdate_prf#2699 AS o_orderdate_prf_2#2709, o_custkey_prf#2700 AS o_custkey_prf_2#2710, o_orderpriority_prf#2701 AS o_orderpriority_prf_2#2711, o_clerk_prf#2702 AS o_clerk_prf_2#2712, o_orderstatus_prf#2703 AS o_orderstatus_prf_2#2713, o_totalprice_prf#2704 AS o_totalprice_prf_2#2714, o_orderkey_prf#2705 AS o_orderkey_prf_2#2715, o_comment_prf#2706 AS o_comment_prf_2#2716]
         :  :     +- Relation[o_shippriority_prf#2697,rid#2698,o_orderdate_prf#2699,o_custkey_prf#2700,o_orderpriority_prf#2701,o_clerk_prf#2702,o_orderstatus_prf#2703,o_totalprice_prf#2704,o_orderkey_prf#2705,o_comment_prf#2706] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1836) AS rid_3#2728]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#2727]
         :        :  +- Relation[o_shippriority_prf#2717,rid#2718,o_orderdate_prf#2719,o_custkey_prf#2720,o_orderpriority_prf#2721,o_clerk_prf#2722,o_orderstatus_prf#2723,o_totalprice_prf#2724,o_orderkey_prf#2725,o_comment_prf#2726] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2729 AS l_returnflag_prf_3#2748, l_orderkey_and_l_linenumber_prf#2730 AS l_orderkey_and_l_linenumber_prf_3#2749, l_comment_prf#2731 AS l_comment_prf_3#2750, l_linestatus_prf#2732 AS l_linestatus_prf_3#2751, rid#2733 AS rid_3#2752, l_shipmode_prf#2734 AS l_shipmode_prf_3#2753, l_shipinstruct_prf#2735 AS l_shipinstruct_prf_3#2754, l_quantity_prf#2736 AS l_quantity_prf_3#2755, l_receiptdate_prf#2737 AS l_receiptdate_prf_3#2756, l_linenumber_prf#2738 AS l_linenumber_prf_3#2757, l_tax_prf#2739 AS l_tax_prf_3#2758, l_shipdate_prf#2740 AS l_shipdate_prf_3#2759, l_extendedprice_prf#2741 AS l_extendedprice_prf_3#2760, l_partkey_prf#2742 AS l_partkey_prf_3#2761, l_discount_prf#2743 AS l_discount_prf_3#2762, l_partkey_and_l_suppkey_prf#2744 AS l_partkey_and_l_suppkey_prf_3#2763, l_commitdate_prf#2745 AS l_commitdate_prf_3#2764, l_suppkey_prf#2746 AS l_suppkey_prf_3#2765, l_orderkey_prf#2747 AS l_orderkey_prf_3#2766]
            +- Relation[l_returnflag_prf#2729,l_orderkey_and_l_linenumber_prf#2730,l_comment_prf#2731,l_linestatus_prf#2732,rid#2733,l_shipmode_prf#2734,l_shipinstruct_prf#2735,l_quantity_prf#2736,l_receiptdate_prf#2737,l_linenumber_prf#2738,l_tax_prf#2739,l_shipdate_prf#2740,l_extendedprice_prf#2741,l_partkey_prf#2742,l_discount_prf#2743,l_partkey_and_l_suppkey_prf#2744,l_commitdate_prf#2745,l_suppkey_prf#2746,l_orderkey_prf#2747] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 165272ms

ft3b=
select * from part, lineitem, supplier where p_size = 15 and p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/16 13:33:09 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 13:33:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2845L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 13:33:09 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 13:33:09 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 13:33:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2845L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_1#2868]
         :  :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2859: string
         :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :     :  :- Project [p_comment_prf#2847 AS p_comment_prf_0#2857, p_name_prf#2848 AS p_name_prf_0#2858, rid#2849 AS rid_0#2859, p_type_prf#2850 AS p_type_prf_0#2860, p_retailprice_prf#2851 AS p_retailprice_prf_0#2861, p_mfgr_prf#2852 AS p_mfgr_prf_0#2862, p_container_prf#2853 AS p_container_prf_0#2863, p_brand_prf#2854 AS p_brand_prf_0#2864, p_size_prf#2855 AS p_size_prf_0#2865, p_partkey_prf#2856 AS p_partkey_prf_0#2866]
         :  :  :     :  :  +- Relation[p_comment_prf#2847,p_name_prf#2848,rid#2849,p_type_prf#2850,p_retailprice_prf#2851,p_mfgr_prf#2852,p_container_prf#2853,p_brand_prf#2854,p_size_prf#2855,p_partkey_prf#2856] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2867]
         :  :  :     :     +- DexRidFilter part~p_size~15
         :  :  :     :        +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#2869 AS l_returnflag_prf_1#2888, l_orderkey_and_l_linenumber_prf#2870 AS l_orderkey_and_l_linenumber_prf_1#2889, l_comment_prf#2871 AS l_comment_prf_1#2890, l_linestatus_prf#2872 AS l_linestatus_prf_1#2891, rid#2873 AS rid_1#2892, l_shipmode_prf#2874 AS l_shipmode_prf_1#2893, l_shipinstruct_prf#2875 AS l_shipinstruct_prf_1#2894, l_quantity_prf#2876 AS l_quantity_prf_1#2895, l_receiptdate_prf#2877 AS l_receiptdate_prf_1#2896, l_linenumber_prf#2878 AS l_linenumber_prf_1#2897, l_tax_prf#2879 AS l_tax_prf_1#2898, l_shipdate_prf#2880 AS l_shipdate_prf_1#2899, l_extendedprice_prf#2881 AS l_extendedprice_prf_1#2900, l_partkey_prf#2882 AS l_partkey_prf_1#2901, l_discount_prf#2883 AS l_discount_prf_1#2902, l_partkey_and_l_suppkey_prf#2884 AS l_partkey_and_l_suppkey_prf_1#2903, l_commitdate_prf#2885 AS l_commitdate_prf_1#2904, l_suppkey_prf#2886 AS l_suppkey_prf_1#2905, l_orderkey_prf#2887 AS l_orderkey_prf_1#2906]
         :  :     +- Relation[l_returnflag_prf#2869,l_orderkey_and_l_linenumber_prf#2870,l_comment_prf#2871,l_linestatus_prf#2872,rid#2873,l_shipmode_prf#2874,l_shipinstruct_prf#2875,l_quantity_prf#2876,l_receiptdate_prf#2877,l_linenumber_prf#2878,l_tax_prf#2879,l_shipdate_prf#2880,l_extendedprice_prf#2881,l_partkey_prf#2882,l_discount_prf#2883,l_partkey_and_l_suppkey_prf#2884,l_commitdate_prf#2885,l_suppkey_prf#2886,l_orderkey_prf#2887] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1836) AS rid_2#2927]
         :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2926]
         :        :  +- Relation[l_returnflag_prf#2907,l_orderkey_and_l_linenumber_prf#2908,l_comment_prf#2909,l_linestatus_prf#2910,rid#2911,l_shipmode_prf#2912,l_shipinstruct_prf#2913,l_quantity_prf#2914,l_receiptdate_prf#2915,l_linenumber_prf#2916,l_tax_prf#2917,l_shipdate_prf#2918,l_extendedprice_prf#2919,l_partkey_prf#2920,l_discount_prf#2921,l_partkey_and_l_suppkey_prf#2922,l_commitdate_prf#2923,l_suppkey_prf#2924,l_orderkey_prf#2925] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2928 AS s_phone_prf_2#2936, rid#2929 AS rid_2#2937, s_address_prf#2930 AS s_address_prf_2#2938, s_nationkey_prf#2931 AS s_nationkey_prf_2#2939, s_suppkey_prf#2932 AS s_suppkey_prf_2#2940, s_name_prf#2933 AS s_name_prf_2#2941, s_acctbal_prf#2934 AS s_acctbal_prf_2#2942, s_comment_prf#2935 AS s_comment_prf_2#2943]
            +- Relation[s_phone_prf#2928,rid#2929,s_address_prf#2930,s_nationkey_prf#2931,s_suppkey_prf#2932,s_name_prf#2933,s_acctbal_prf#2934,s_comment_prf#2935] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 52865ms

fq1f=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 13:34:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 13:34:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3021L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/16 13:34:02 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 13:34:02 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 13:34:02 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 13:34:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3021L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_1#3061]
         :  :  :  :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3046: string
         :  :  :  :  :     :- Project [l_returnflag_prf#3023 AS l_returnflag_prf_0#3042, l_orderkey_and_l_linenumber_prf#3024 AS l_orderkey_and_l_linenumber_prf_0#3043, l_comment_prf#3025 AS l_comment_prf_0#3044, l_linestatus_prf#3026 AS l_linestatus_prf_0#3045, rid#3027 AS rid_0#3046, l_shipmode_prf#3028 AS l_shipmode_prf_0#3047, l_shipinstruct_prf#3029 AS l_shipinstruct_prf_0#3048, l_quantity_prf#3030 AS l_quantity_prf_0#3049, l_receiptdate_prf#3031 AS l_receiptdate_prf_0#3050, l_linenumber_prf#3032 AS l_linenumber_prf_0#3051, l_tax_prf#3033 AS l_tax_prf_0#3052, l_shipdate_prf#3034 AS l_shipdate_prf_0#3053, l_extendedprice_prf#3035 AS l_extendedprice_prf_0#3054, l_partkey_prf#3036 AS l_partkey_prf_0#3055, l_discount_prf#3037 AS l_discount_prf_0#3056, l_partkey_and_l_suppkey_prf#3038 AS l_partkey_and_l_suppkey_prf_0#3057, l_commitdate_prf#3039 AS l_commitdate_prf_0#3058, l_suppkey_prf#3040 AS l_suppkey_prf_0#3059, l_orderkey_prf#3041 AS l_orderkey_prf_0#3060]
         :  :  :  :  :     :  +- Relation[l_returnflag_prf#3023,l_orderkey_and_l_linenumber_prf#3024,l_comment_prf#3025,l_linestatus_prf#3026,rid#3027,l_shipmode_prf#3028,l_shipinstruct_prf#3029,l_quantity_prf#3030,l_receiptdate_prf#3031,l_linenumber_prf#3032,l_tax_prf#3033,l_shipdate_prf#3034,l_extendedprice_prf#3035,l_partkey_prf#3036,l_discount_prf#3037,l_partkey_and_l_suppkey_prf#3038,l_commitdate_prf#3039,l_suppkey_prf#3040,l_orderkey_prf#3041] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [o_shippriority_prf#3062 AS o_shippriority_prf_1#3072, rid#3063 AS rid_1#3073, o_orderdate_prf#3064 AS o_orderdate_prf_1#3074, o_custkey_prf#3065 AS o_custkey_prf_1#3075, o_orderpriority_prf#3066 AS o_orderpriority_prf_1#3076, o_clerk_prf#3067 AS o_clerk_prf_1#3077, o_orderstatus_prf#3068 AS o_orderstatus_prf_1#3078, o_totalprice_prf#3069 AS o_totalprice_prf_1#3079, o_orderkey_prf#3070 AS o_orderkey_prf_1#3080, o_comment_prf#3071 AS o_comment_prf_1#3081]
         :  :  :  :     +- Relation[o_shippriority_prf#3062,rid#3063,o_orderdate_prf#3064,o_custkey_prf#3065,o_orderpriority_prf#3066,o_clerk_prf#3067,o_orderstatus_prf#3068,o_totalprice_prf#3069,o_orderkey_prf#3070,o_comment_prf#3071] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1836) AS rid_2#3093]
         :  :  :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :  :  :        :- 'Project ['rid AS rid_1#3092]
         :  :  :        :  +- Relation[o_shippriority_prf#3082,rid#3083,o_orderdate_prf#3084,o_custkey_prf#3085,o_orderpriority_prf#3086,o_clerk_prf#3087,o_orderstatus_prf#3088,o_totalprice_prf#3089,o_orderkey_prf#3090,o_comment_prf#3091] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :        +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#3094 AS c_acctbal_prf_2#3103, rid#3095 AS rid_2#3104, c_name_prf#3096 AS c_name_prf_2#3105, c_nationkey_prf#3097 AS c_nationkey_prf_2#3106, c_custkey_prf#3098 AS c_custkey_prf_2#3107, c_comment_prf#3099 AS c_comment_prf_2#3108, c_address_prf#3100 AS c_address_prf_2#3109, c_mktsegment_prf#3101 AS c_mktsegment_prf_2#3110, c_phone_prf#3102 AS c_phone_prf_2#3111]
         :  :     +- Relation[c_acctbal_prf#3094,rid#3095,c_name_prf#3096,c_nationkey_prf#3097,c_custkey_prf#3098,c_comment_prf#3099,c_address_prf#3100,c_mktsegment_prf#3101,c_phone_prf#3102] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1836) AS rid_3#3122]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#3121]
         :        :  +- Relation[c_acctbal_prf#3112,rid#3113,c_name_prf#3114,c_nationkey_prf#3115,c_custkey_prf#3116,c_comment_prf#3117,c_address_prf#3118,c_mktsegment_prf#3119,c_phone_prf#3120] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_3))
            :- Project [rid#3123 AS rid_3#3128, n_regionkey_prf#3124 AS n_regionkey_prf_3#3129, n_nationkey_prf#3125 AS n_nationkey_prf_3#3130, n_name_prf#3126 AS n_name_prf_3#3131, n_comment_prf#3127 AS n_comment_prf_3#3132]
            :  +- Relation[rid#3123,n_regionkey_prf#3124,n_nationkey_prf#3125,n_name_prf#3126,n_comment_prf#3127] JDBCRelation(nation_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#3133]
               +- DexRidFilter nation~n_name~FRANCE
                  +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 183502ms

fr2f=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/16 13:37:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 13:37:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3213L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_orderkey#342L, o_custkey#343L]
         :     :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L]
         :        +- Filter isnotnull(c_custkey#290L)
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 13:37:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3213L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_1#3236]
         :  :  :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_0#3226: string
         :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :     :  :- Project [o_shippriority_prf#3215 AS o_shippriority_prf_0#3225, rid#3216 AS rid_0#3226, o_orderdate_prf#3217 AS o_orderdate_prf_0#3227, o_custkey_prf#3218 AS o_custkey_prf_0#3228, o_orderpriority_prf#3219 AS o_orderpriority_prf_0#3229, o_clerk_prf#3220 AS o_clerk_prf_0#3230, o_orderstatus_prf#3221 AS o_orderstatus_prf_0#3231, o_totalprice_prf#3222 AS o_totalprice_prf_0#3232, o_orderkey_prf#3223 AS o_orderkey_prf_0#3233, o_comment_prf#3224 AS o_comment_prf_0#3234]
         :  :  :     :  :  +- Relation[o_shippriority_prf#3215,rid#3216,o_orderdate_prf#3217,o_custkey_prf#3218,o_orderpriority_prf#3219,o_clerk_prf#3220,o_orderstatus_prf#3221,o_totalprice_prf#3222,o_orderkey_prf#3223,o_comment_prf#3224] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3235]
         :  :  :     :     +- DexRidFilter orders~o_orderstatus~F
         :  :  :     :        +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#3237 AS c_acctbal_prf_1#3246, rid#3238 AS rid_1#3247, c_name_prf#3239 AS c_name_prf_1#3248, c_nationkey_prf#3240 AS c_nationkey_prf_1#3249, c_custkey_prf#3241 AS c_custkey_prf_1#3250, c_comment_prf#3242 AS c_comment_prf_1#3251, c_address_prf#3243 AS c_address_prf_1#3252, c_mktsegment_prf#3244 AS c_mktsegment_prf_1#3253, c_phone_prf#3245 AS c_phone_prf_1#3254]
         :  :     +- Relation[c_acctbal_prf#3237,rid#3238,c_name_prf#3239,c_nationkey_prf#3240,c_custkey_prf#3241,c_comment_prf#3242,c_address_prf#3243,c_mktsegment_prf#3244,c_phone_prf#3245] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1836) AS rid_2#3266]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3265]
         :        :  +- Relation[o_shippriority_prf#3255,rid#3256,o_orderdate_prf#3257,o_custkey_prf#3258,o_orderpriority_prf#3259,o_clerk_prf#3260,o_orderstatus_prf#3261,o_totalprice_prf#3262,o_orderkey_prf#3263,o_comment_prf#3264] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3267 AS l_returnflag_prf_2#3286, l_orderkey_and_l_linenumber_prf#3268 AS l_orderkey_and_l_linenumber_prf_2#3287, l_comment_prf#3269 AS l_comment_prf_2#3288, l_linestatus_prf#3270 AS l_linestatus_prf_2#3289, rid#3271 AS rid_2#3290, l_shipmode_prf#3272 AS l_shipmode_prf_2#3291, l_shipinstruct_prf#3273 AS l_shipinstruct_prf_2#3292, l_quantity_prf#3274 AS l_quantity_prf_2#3293, l_receiptdate_prf#3275 AS l_receiptdate_prf_2#3294, l_linenumber_prf#3276 AS l_linenumber_prf_2#3295, l_tax_prf#3277 AS l_tax_prf_2#3296, l_shipdate_prf#3278 AS l_shipdate_prf_2#3297, l_extendedprice_prf#3279 AS l_extendedprice_prf_2#3298, l_partkey_prf#3280 AS l_partkey_prf_2#3299, l_discount_prf#3281 AS l_discount_prf_2#3300, l_partkey_and_l_suppkey_prf#3282 AS l_partkey_and_l_suppkey_prf_2#3301, l_commitdate_prf#3283 AS l_commitdate_prf_2#3302, l_suppkey_prf#3284 AS l_suppkey_prf_2#3303, l_orderkey_prf#3285 AS l_orderkey_prf_2#3304]
            +- Relation[l_returnflag_prf#3267,l_orderkey_and_l_linenumber_prf#3268,l_comment_prf#3269,l_linestatus_prf#3270,rid#3271,l_shipmode_prf#3272,l_shipinstruct_prf#3273,l_quantity_prf#3274,l_receiptdate_prf#3275,l_linenumber_prf#3276,l_tax_prf#3277,l_shipdate_prf#3278,l_extendedprice_prf#3279,l_partkey_prf#3280,l_discount_prf#3281,l_partkey_and_l_suppkey_prf#3282,l_commitdate_prf#3283,l_suppkey_prf#3284,l_orderkey_prf#3285] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 216894ms

fr1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and (c_mktsegment = 'BUILDING' and l_orderkey = o_orderkey)
19/10/16 13:40:42 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 13:40:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3379L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 13:40:42 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 13:40:42 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 13:40:42 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 13:40:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3379L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_2#3419]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3404: string
         :     :- Project [l_returnflag_prf#3381 AS l_returnflag_prf_0#3400, l_orderkey_and_l_linenumber_prf#3382 AS l_orderkey_and_l_linenumber_prf_0#3401, l_comment_prf#3383 AS l_comment_prf_0#3402, l_linestatus_prf#3384 AS l_linestatus_prf_0#3403, rid#3385 AS rid_0#3404, l_shipmode_prf#3386 AS l_shipmode_prf_0#3405, l_shipinstruct_prf#3387 AS l_shipinstruct_prf_0#3406, l_quantity_prf#3388 AS l_quantity_prf_0#3407, l_receiptdate_prf#3389 AS l_receiptdate_prf_0#3408, l_linenumber_prf#3390 AS l_linenumber_prf_0#3409, l_tax_prf#3391 AS l_tax_prf_0#3410, l_shipdate_prf#3392 AS l_shipdate_prf_0#3411, l_extendedprice_prf#3393 AS l_extendedprice_prf_0#3412, l_partkey_prf#3394 AS l_partkey_prf_0#3413, l_discount_prf#3395 AS l_discount_prf_0#3414, l_partkey_and_l_suppkey_prf#3396 AS l_partkey_and_l_suppkey_prf_0#3415, l_commitdate_prf#3397 AS l_commitdate_prf_0#3416, l_suppkey_prf#3398 AS l_suppkey_prf_0#3417, l_orderkey_prf#3399 AS l_orderkey_prf_0#3418]
         :     :  +- Relation[l_returnflag_prf#3381,l_orderkey_and_l_linenumber_prf#3382,l_comment_prf#3383,l_linestatus_prf#3384,rid#3385,l_shipmode_prf#3386,l_shipinstruct_prf#3387,l_quantity_prf#3388,l_receiptdate_prf#3389,l_linenumber_prf#3390,l_tax_prf#3391,l_shipdate_prf#3392,l_extendedprice_prf#3393,l_partkey_prf#3394,l_discount_prf#3395,l_partkey_and_l_suppkey_prf#3396,l_commitdate_prf#3397,l_suppkey_prf#3398,l_orderkey_prf#3399] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1836) AS rid_2#3439]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#3430: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [c_acctbal_prf#3420 AS c_acctbal_prf_1#3429, rid#3421 AS rid_1#3430, c_name_prf#3422 AS c_name_prf_1#3431, c_nationkey_prf#3423 AS c_nationkey_prf_1#3432, c_custkey_prf#3424 AS c_custkey_prf_1#3433, c_comment_prf#3425 AS c_comment_prf_1#3434, c_address_prf#3426 AS c_address_prf_1#3435, c_mktsegment_prf#3427 AS c_mktsegment_prf_1#3436, c_phone_prf#3428 AS c_phone_prf_1#3437]
            :     :  :  +- Relation[c_acctbal_prf#3420,rid#3421,c_name_prf#3422,c_nationkey_prf#3423,c_custkey_prf#3424,c_comment_prf#3425,c_address_prf#3426,c_mktsegment_prf#3427,c_phone_prf#3428] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3438]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3440 AS o_shippriority_prf_2#3450, rid#3441 AS rid_2#3451, o_orderdate_prf#3442 AS o_orderdate_prf_2#3452, o_custkey_prf#3443 AS o_custkey_prf_2#3453, o_orderpriority_prf#3444 AS o_orderpriority_prf_2#3454, o_clerk_prf#3445 AS o_clerk_prf_2#3455, o_orderstatus_prf#3446 AS o_orderstatus_prf_2#3456, o_totalprice_prf#3447 AS o_totalprice_prf_2#3457, o_orderkey_prf#3448 AS o_orderkey_prf_2#3458, o_comment_prf#3449 AS o_comment_prf_2#3459]
               +- Relation[o_shippriority_prf#3440,rid#3441,o_orderdate_prf#3442,o_custkey_prf#3443,o_orderpriority_prf#3444,o_clerk_prf#3445,o_orderstatus_prf#3446,o_totalprice_prf#3447,o_orderkey_prf#3448,o_comment_prf#3449] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 98828ms

fr1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey and c_mktsegment = 'BUILDING'
19/10/16 13:42:21 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 13:42:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3534L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 13:42:21 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 13:42:21 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 13:42:21 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 13:42:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3534L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_1#3574]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3559: string
         :  :  :     :- Project [l_returnflag_prf#3536 AS l_returnflag_prf_0#3555, l_orderkey_and_l_linenumber_prf#3537 AS l_orderkey_and_l_linenumber_prf_0#3556, l_comment_prf#3538 AS l_comment_prf_0#3557, l_linestatus_prf#3539 AS l_linestatus_prf_0#3558, rid#3540 AS rid_0#3559, l_shipmode_prf#3541 AS l_shipmode_prf_0#3560, l_shipinstruct_prf#3542 AS l_shipinstruct_prf_0#3561, l_quantity_prf#3543 AS l_quantity_prf_0#3562, l_receiptdate_prf#3544 AS l_receiptdate_prf_0#3563, l_linenumber_prf#3545 AS l_linenumber_prf_0#3564, l_tax_prf#3546 AS l_tax_prf_0#3565, l_shipdate_prf#3547 AS l_shipdate_prf_0#3566, l_extendedprice_prf#3548 AS l_extendedprice_prf_0#3567, l_partkey_prf#3549 AS l_partkey_prf_0#3568, l_discount_prf#3550 AS l_discount_prf_0#3569, l_partkey_and_l_suppkey_prf#3551 AS l_partkey_and_l_suppkey_prf_0#3570, l_commitdate_prf#3552 AS l_commitdate_prf_0#3571, l_suppkey_prf#3553 AS l_suppkey_prf_0#3572, l_orderkey_prf#3554 AS l_orderkey_prf_0#3573]
         :  :  :     :  +- Relation[l_returnflag_prf#3536,l_orderkey_and_l_linenumber_prf#3537,l_comment_prf#3538,l_linestatus_prf#3539,rid#3540,l_shipmode_prf#3541,l_shipinstruct_prf#3542,l_quantity_prf#3543,l_receiptdate_prf#3544,l_linenumber_prf#3545,l_tax_prf#3546,l_shipdate_prf#3547,l_extendedprice_prf#3548,l_partkey_prf#3549,l_discount_prf#3550,l_partkey_and_l_suppkey_prf#3551,l_commitdate_prf#3552,l_suppkey_prf#3553,l_orderkey_prf#3554] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#3575 AS o_shippriority_prf_1#3585, rid#3576 AS rid_1#3586, o_orderdate_prf#3577 AS o_orderdate_prf_1#3587, o_custkey_prf#3578 AS o_custkey_prf_1#3588, o_orderpriority_prf#3579 AS o_orderpriority_prf_1#3589, o_clerk_prf#3580 AS o_clerk_prf_1#3590, o_orderstatus_prf#3581 AS o_orderstatus_prf_1#3591, o_totalprice_prf#3582 AS o_totalprice_prf_1#3592, o_orderkey_prf#3583 AS o_orderkey_prf_1#3593, o_comment_prf#3584 AS o_comment_prf_1#3594]
         :  :     +- Relation[o_shippriority_prf#3575,rid#3576,o_orderdate_prf#3577,o_custkey_prf#3578,o_orderpriority_prf#3579,o_clerk_prf#3580,o_orderstatus_prf#3581,o_totalprice_prf#3582,o_orderkey_prf#3583,o_comment_prf#3584] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1836) AS rid_2#3606]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3605]
         :        :  +- Relation[o_shippriority_prf#3595,rid#3596,o_orderdate_prf#3597,o_custkey_prf#3598,o_orderpriority_prf#3599,o_clerk_prf#3600,o_orderstatus_prf#3601,o_totalprice_prf#3602,o_orderkey_prf#3603,o_comment_prf#3604] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_2))
            :- Project [c_acctbal_prf#3607 AS c_acctbal_prf_2#3616, rid#3608 AS rid_2#3617, c_name_prf#3609 AS c_name_prf_2#3618, c_nationkey_prf#3610 AS c_nationkey_prf_2#3619, c_custkey_prf#3611 AS c_custkey_prf_2#3620, c_comment_prf#3612 AS c_comment_prf_2#3621, c_address_prf#3613 AS c_address_prf_2#3622, c_mktsegment_prf#3614 AS c_mktsegment_prf_2#3623, c_phone_prf#3615 AS c_phone_prf_2#3624]
            :  +- Relation[c_acctbal_prf#3607,rid#3608,c_name_prf#3609,c_nationkey_prf#3610,c_custkey_prf#3611,c_comment_prf#3612,c_address_prf#3613,c_mktsegment_prf#3614,c_phone_prf#3615] JDBCRelation(customer_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#3625]
               +- DexRidFilter customer~c_mktsegment~BUILDING
                  +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 139622ms

fr2d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderstatus = 'F' and o_orderkey = l_orderkey
19/10/16 13:44:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 13:44:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3700L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 13:44:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3700L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_1#3720]
         :  :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3712: string
         :  :  :     :- Project [c_acctbal_prf#3702 AS c_acctbal_prf_0#3711, rid#3703 AS rid_0#3712, c_name_prf#3704 AS c_name_prf_0#3713, c_nationkey_prf#3705 AS c_nationkey_prf_0#3714, c_custkey_prf#3706 AS c_custkey_prf_0#3715, c_comment_prf#3707 AS c_comment_prf_0#3716, c_address_prf#3708 AS c_address_prf_0#3717, c_mktsegment_prf#3709 AS c_mktsegment_prf_0#3718, c_phone_prf#3710 AS c_phone_prf_0#3719]
         :  :  :     :  +- Relation[c_acctbal_prf#3702,rid#3703,c_name_prf#3704,c_nationkey_prf#3705,c_custkey_prf#3706,c_comment_prf#3707,c_address_prf#3708,c_mktsegment_prf#3709,c_phone_prf#3710] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :     :- Project [o_shippriority_prf#3721 AS o_shippriority_prf_1#3731, rid#3722 AS rid_1#3732, o_orderdate_prf#3723 AS o_orderdate_prf_1#3733, o_custkey_prf#3724 AS o_custkey_prf_1#3734, o_orderpriority_prf#3725 AS o_orderpriority_prf_1#3735, o_clerk_prf#3726 AS o_clerk_prf_1#3736, o_orderstatus_prf#3727 AS o_orderstatus_prf_1#3737, o_totalprice_prf#3728 AS o_totalprice_prf_1#3738, o_orderkey_prf#3729 AS o_orderkey_prf_1#3739, o_comment_prf#3730 AS o_comment_prf_1#3740]
         :  :     :  +- Relation[o_shippriority_prf#3721,rid#3722,o_orderdate_prf#3723,o_custkey_prf#3724,o_orderpriority_prf#3725,o_clerk_prf#3726,o_orderstatus_prf#3727,o_totalprice_prf#3728,o_orderkey_prf#3729,o_comment_prf#3730] JDBCRelation(orders_prf) [numPartitions=1]
         :  :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3741]
         :  :        +- DexRidFilter orders~o_orderstatus~F
         :  :           +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1836) AS rid_2#3753]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3752]
         :        :  +- Relation[o_shippriority_prf#3742,rid#3743,o_orderdate_prf#3744,o_custkey_prf#3745,o_orderpriority_prf#3746,o_clerk_prf#3747,o_orderstatus_prf#3748,o_totalprice_prf#3749,o_orderkey_prf#3750,o_comment_prf#3751] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3754 AS l_returnflag_prf_2#3773, l_orderkey_and_l_linenumber_prf#3755 AS l_orderkey_and_l_linenumber_prf_2#3774, l_comment_prf#3756 AS l_comment_prf_2#3775, l_linestatus_prf#3757 AS l_linestatus_prf_2#3776, rid#3758 AS rid_2#3777, l_shipmode_prf#3759 AS l_shipmode_prf_2#3778, l_shipinstruct_prf#3760 AS l_shipinstruct_prf_2#3779, l_quantity_prf#3761 AS l_quantity_prf_2#3780, l_receiptdate_prf#3762 AS l_receiptdate_prf_2#3781, l_linenumber_prf#3763 AS l_linenumber_prf_2#3782, l_tax_prf#3764 AS l_tax_prf_2#3783, l_shipdate_prf#3765 AS l_shipdate_prf_2#3784, l_extendedprice_prf#3766 AS l_extendedprice_prf_2#3785, l_partkey_prf#3767 AS l_partkey_prf_2#3786, l_discount_prf#3768 AS l_discount_prf_2#3787, l_partkey_and_l_suppkey_prf#3769 AS l_partkey_and_l_suppkey_prf_2#3788, l_commitdate_prf#3770 AS l_commitdate_prf_2#3789, l_suppkey_prf#3771 AS l_suppkey_prf_2#3790, l_orderkey_prf#3772 AS l_orderkey_prf_2#3791]
            +- Relation[l_returnflag_prf#3754,l_orderkey_and_l_linenumber_prf#3755,l_comment_prf#3756,l_linestatus_prf#3757,rid#3758,l_shipmode_prf#3759,l_shipinstruct_prf#3760,l_quantity_prf#3761,l_receiptdate_prf#3762,l_linenumber_prf#3763,l_tax_prf#3764,l_shipdate_prf#3765,l_extendedprice_prf#3766,l_partkey_prf#3767,l_discount_prf#3768,l_partkey_and_l_suppkey_prf#3769,l_commitdate_prf#3770,l_suppkey_prf#3771,l_orderkey_prf#3772] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 207343ms

fq1d=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 13:48:08 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 13:48:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3870L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_orderkey#342L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :     :- Project [n_nationkey#108L]
               :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
               :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L]
                  +- Filter isnotnull(o_orderkey#342L)
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 13:48:08 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 13:48:08 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 13:48:08 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 13:48:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3870L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_3#3910]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3895: string
         :     :- Project [l_returnflag_prf#3872 AS l_returnflag_prf_0#3891, l_orderkey_and_l_linenumber_prf#3873 AS l_orderkey_and_l_linenumber_prf_0#3892, l_comment_prf#3874 AS l_comment_prf_0#3893, l_linestatus_prf#3875 AS l_linestatus_prf_0#3894, rid#3876 AS rid_0#3895, l_shipmode_prf#3877 AS l_shipmode_prf_0#3896, l_shipinstruct_prf#3878 AS l_shipinstruct_prf_0#3897, l_quantity_prf#3879 AS l_quantity_prf_0#3898, l_receiptdate_prf#3880 AS l_receiptdate_prf_0#3899, l_linenumber_prf#3881 AS l_linenumber_prf_0#3900, l_tax_prf#3882 AS l_tax_prf_0#3901, l_shipdate_prf#3883 AS l_shipdate_prf_0#3902, l_extendedprice_prf#3884 AS l_extendedprice_prf_0#3903, l_partkey_prf#3885 AS l_partkey_prf_0#3904, l_discount_prf#3886 AS l_discount_prf_0#3905, l_partkey_and_l_suppkey_prf#3887 AS l_partkey_and_l_suppkey_prf_0#3906, l_commitdate_prf#3888 AS l_commitdate_prf_0#3907, l_suppkey_prf#3889 AS l_suppkey_prf_0#3908, l_orderkey_prf#3890 AS l_orderkey_prf_0#3909]
         :     :  +- Relation[l_returnflag_prf#3872,l_orderkey_and_l_linenumber_prf#3873,l_comment_prf#3874,l_linestatus_prf#3875,rid#3876,l_shipmode_prf#3877,l_shipinstruct_prf#3878,l_quantity_prf#3879,l_receiptdate_prf#3880,l_linenumber_prf#3881,l_tax_prf#3882,l_shipdate_prf#3883,l_extendedprice_prf#3884,l_partkey_prf#3885,l_discount_prf#3886,l_partkey_and_l_suppkey_prf#3887,l_commitdate_prf#3888,l_suppkey_prf#3889,l_orderkey_prf#3890] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join NaturalJoin(Inner)
            :  :  :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#1836) AS rid_2#3922]
            :  :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_1#3916: string
            :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :  :     :  :- Project [rid#3911 AS rid_1#3916, n_regionkey_prf#3912 AS n_regionkey_prf_1#3917, n_nationkey_prf#3913 AS n_nationkey_prf_1#3918, n_name_prf#3914 AS n_name_prf_1#3919, n_comment_prf#3915 AS n_comment_prf_1#3920]
            :  :  :     :  :  +- Relation[rid#3911,n_regionkey_prf#3912,n_nationkey_prf#3913,n_name_prf#3914,n_comment_prf#3915] JDBCRelation(nation_prf) [numPartitions=1]
            :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3921]
            :  :  :     :     +- DexRidFilter nation~n_name~FRANCE
            :  :  :     :        +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
            :  :  :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
            :  :  +- Project [c_acctbal_prf#3923 AS c_acctbal_prf_2#3932, rid#3924 AS rid_2#3933, c_name_prf#3925 AS c_name_prf_2#3934, c_nationkey_prf#3926 AS c_nationkey_prf_2#3935, c_custkey_prf#3927 AS c_custkey_prf_2#3936, c_comment_prf#3928 AS c_comment_prf_2#3937, c_address_prf#3929 AS c_address_prf_2#3938, c_mktsegment_prf#3930 AS c_mktsegment_prf_2#3939, c_phone_prf#3931 AS c_phone_prf_2#3940]
            :  :     +- Relation[c_acctbal_prf#3923,rid#3924,c_name_prf#3925,c_nationkey_prf#3926,c_custkey_prf#3927,c_comment_prf#3928,c_address_prf#3929,c_mktsegment_prf#3930,c_phone_prf#3931] JDBCRelation(customer_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1836) AS rid_3#3951]
            :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#3950]
            :        :  +- Relation[c_acctbal_prf#3941,rid#3942,c_name_prf#3943,c_nationkey_prf#3944,c_custkey_prf#3945,c_comment_prf#3946,c_address_prf#3947,c_mktsegment_prf#3948,c_phone_prf#3949] JDBCRelation(customer_prf) [numPartitions=1]
            :        +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3952 AS o_shippriority_prf_3#3962, rid#3953 AS rid_3#3963, o_orderdate_prf#3954 AS o_orderdate_prf_3#3964, o_custkey_prf#3955 AS o_custkey_prf_3#3965, o_orderpriority_prf#3956 AS o_orderpriority_prf_3#3966, o_clerk_prf#3957 AS o_clerk_prf_3#3967, o_orderstatus_prf#3958 AS o_orderstatus_prf_3#3968, o_totalprice_prf#3959 AS o_totalprice_prf_3#3969, o_orderkey_prf#3960 AS o_orderkey_prf_3#3970, o_comment_prf#3961 AS o_comment_prf_3#3971]
               +- Relation[o_shippriority_prf#3952,rid#3953,o_orderdate_prf#3954,o_custkey_prf#3955,o_orderpriority_prf#3956,o_clerk_prf#3957,o_orderstatus_prf#3958,o_totalprice_prf#3959,o_orderkey_prf#3960,o_comment_prf#3961] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=0
Elapsed time: 1038ms

fr1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and (l_orderkey = o_orderkey and c_mktsegment = 'BUILDING')
19/10/16 13:48:09 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 13:48:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4051L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 13:48:09 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 13:48:09 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 13:48:09 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 13:48:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4051L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_1#4091]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4076: string
         :     :- Project [l_returnflag_prf#4053 AS l_returnflag_prf_0#4072, l_orderkey_and_l_linenumber_prf#4054 AS l_orderkey_and_l_linenumber_prf_0#4073, l_comment_prf#4055 AS l_comment_prf_0#4074, l_linestatus_prf#4056 AS l_linestatus_prf_0#4075, rid#4057 AS rid_0#4076, l_shipmode_prf#4058 AS l_shipmode_prf_0#4077, l_shipinstruct_prf#4059 AS l_shipinstruct_prf_0#4078, l_quantity_prf#4060 AS l_quantity_prf_0#4079, l_receiptdate_prf#4061 AS l_receiptdate_prf_0#4080, l_linenumber_prf#4062 AS l_linenumber_prf_0#4081, l_tax_prf#4063 AS l_tax_prf_0#4082, l_shipdate_prf#4064 AS l_shipdate_prf_0#4083, l_extendedprice_prf#4065 AS l_extendedprice_prf_0#4084, l_partkey_prf#4066 AS l_partkey_prf_0#4085, l_discount_prf#4067 AS l_discount_prf_0#4086, l_partkey_and_l_suppkey_prf#4068 AS l_partkey_and_l_suppkey_prf_0#4087, l_commitdate_prf#4069 AS l_commitdate_prf_0#4088, l_suppkey_prf#4070 AS l_suppkey_prf_0#4089, l_orderkey_prf#4071 AS l_orderkey_prf_0#4090]
         :     :  +- Relation[l_returnflag_prf#4053,l_orderkey_and_l_linenumber_prf#4054,l_comment_prf#4055,l_linestatus_prf#4056,rid#4057,l_shipmode_prf#4058,l_shipinstruct_prf#4059,l_quantity_prf#4060,l_receiptdate_prf#4061,l_linenumber_prf#4062,l_tax_prf#4063,l_shipdate_prf#4064,l_extendedprice_prf#4065,l_partkey_prf#4066,l_discount_prf#4067,l_partkey_and_l_suppkey_prf#4068,l_commitdate_prf#4069,l_suppkey_prf#4070,l_orderkey_prf#4071] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1836) AS rid_2#4112]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#4103: string
            :     :- Project [o_shippriority_prf#4092 AS o_shippriority_prf_1#4102, rid#4093 AS rid_1#4103, o_orderdate_prf#4094 AS o_orderdate_prf_1#4104, o_custkey_prf#4095 AS o_custkey_prf_1#4105, o_orderpriority_prf#4096 AS o_orderpriority_prf_1#4106, o_clerk_prf#4097 AS o_clerk_prf_1#4107, o_orderstatus_prf#4098 AS o_orderstatus_prf_1#4108, o_totalprice_prf#4099 AS o_totalprice_prf_1#4109, o_orderkey_prf#4100 AS o_orderkey_prf_1#4110, o_comment_prf#4101 AS o_comment_prf_1#4111]
            :     :  +- Relation[o_shippriority_prf#4092,rid#4093,o_orderdate_prf#4094,o_custkey_prf#4095,o_orderpriority_prf#4096,o_clerk_prf#4097,o_orderstatus_prf#4098,o_totalprice_prf#4099,o_orderkey_prf#4100,o_comment_prf#4101] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [c_acctbal_prf#4113 AS c_acctbal_prf_2#4122, rid#4114 AS rid_2#4123, c_name_prf#4115 AS c_name_prf_2#4124, c_nationkey_prf#4116 AS c_nationkey_prf_2#4125, c_custkey_prf#4117 AS c_custkey_prf_2#4126, c_comment_prf#4118 AS c_comment_prf_2#4127, c_address_prf#4119 AS c_address_prf_2#4128, c_mktsegment_prf#4120 AS c_mktsegment_prf_2#4129, c_phone_prf#4121 AS c_phone_prf_2#4130]
               :  +- Relation[c_acctbal_prf#4113,rid#4114,c_name_prf#4115,c_nationkey_prf#4116,c_custkey_prf#4117,c_comment_prf#4118,c_address_prf#4119,c_mktsegment_prf#4120,c_phone_prf#4121] JDBCRelation(customer_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#4131]
                  +- DexRidFilter customer~c_mktsegment~BUILDING
                     +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 142728ms

ft3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and (p_size = 15 and s_suppkey = l_suppkey)
19/10/16 13:50:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 13:50:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4205L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 13:50:32 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 13:50:32 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 13:50:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4205L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_2#4223]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#4216: string
         :     :- Project [s_phone_prf#4207 AS s_phone_prf_0#4215, rid#4208 AS rid_0#4216, s_address_prf#4209 AS s_address_prf_0#4217, s_nationkey_prf#4210 AS s_nationkey_prf_0#4218, s_suppkey_prf#4211 AS s_suppkey_prf_0#4219, s_name_prf#4212 AS s_name_prf_0#4220, s_acctbal_prf#4213 AS s_acctbal_prf_0#4221, s_comment_prf#4214 AS s_comment_prf_0#4222]
         :     :  +- Relation[s_phone_prf#4207,rid#4208,s_address_prf#4209,s_nationkey_prf#4210,s_suppkey_prf#4211,s_name_prf#4212,s_acctbal_prf#4213,s_comment_prf#4214] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1836) AS rid_2#4245]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#4236: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#4224 AS p_comment_prf_1#4234, p_name_prf#4225 AS p_name_prf_1#4235, rid#4226 AS rid_1#4236, p_type_prf#4227 AS p_type_prf_1#4237, p_retailprice_prf#4228 AS p_retailprice_prf_1#4238, p_mfgr_prf#4229 AS p_mfgr_prf_1#4239, p_container_prf#4230 AS p_container_prf_1#4240, p_brand_prf#4231 AS p_brand_prf_1#4241, p_size_prf#4232 AS p_size_prf_1#4242, p_partkey_prf#4233 AS p_partkey_prf_1#4243]
            :     :  :  +- Relation[p_comment_prf#4224,p_name_prf#4225,rid#4226,p_type_prf#4227,p_retailprice_prf#4228,p_mfgr_prf#4229,p_container_prf#4230,p_brand_prf#4231,p_size_prf#4232,p_partkey_prf#4233] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4244]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4246 AS l_returnflag_prf_2#4265, l_orderkey_and_l_linenumber_prf#4247 AS l_orderkey_and_l_linenumber_prf_2#4266, l_comment_prf#4248 AS l_comment_prf_2#4267, l_linestatus_prf#4249 AS l_linestatus_prf_2#4268, rid#4250 AS rid_2#4269, l_shipmode_prf#4251 AS l_shipmode_prf_2#4270, l_shipinstruct_prf#4252 AS l_shipinstruct_prf_2#4271, l_quantity_prf#4253 AS l_quantity_prf_2#4272, l_receiptdate_prf#4254 AS l_receiptdate_prf_2#4273, l_linenumber_prf#4255 AS l_linenumber_prf_2#4274, l_tax_prf#4256 AS l_tax_prf_2#4275, l_shipdate_prf#4257 AS l_shipdate_prf_2#4276, l_extendedprice_prf#4258 AS l_extendedprice_prf_2#4277, l_partkey_prf#4259 AS l_partkey_prf_2#4278, l_discount_prf#4260 AS l_discount_prf_2#4279, l_partkey_and_l_suppkey_prf#4261 AS l_partkey_and_l_suppkey_prf_2#4280, l_commitdate_prf#4262 AS l_commitdate_prf_2#4281, l_suppkey_prf#4263 AS l_suppkey_prf_2#4282, l_orderkey_prf#4264 AS l_orderkey_prf_2#4283]
               +- Relation[l_returnflag_prf#4246,l_orderkey_and_l_linenumber_prf#4247,l_comment_prf#4248,l_linestatus_prf#4249,rid#4250,l_shipmode_prf#4251,l_shipinstruct_prf#4252,l_quantity_prf#4253,l_receiptdate_prf#4254,l_linenumber_prf#4255,l_tax_prf#4256,l_shipdate_prf#4257,l_extendedprice_prf#4258,l_partkey_prf#4259,l_discount_prf#4260,l_partkey_and_l_suppkey_prf#4261,l_commitdate_prf#4262,l_suppkey_prf#4263,l_orderkey_prf#4264] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 59793ms

fq1b=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 13:51:31 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 13:51:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4361L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 13:51:31 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 13:51:31 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 13:51:31 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 13:51:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4361L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_1#4374]
         :  :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#4368: string
         :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :     :  :- Project [rid#4363 AS rid_0#4368, n_regionkey_prf#4364 AS n_regionkey_prf_0#4369, n_nationkey_prf#4365 AS n_nationkey_prf_0#4370, n_name_prf#4366 AS n_name_prf_0#4371, n_comment_prf#4367 AS n_comment_prf_0#4372]
         :  :  :     :  :  +- Relation[rid#4363,n_regionkey_prf#4364,n_nationkey_prf#4365,n_name_prf#4366,n_comment_prf#4367] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4373]
         :  :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :  :  :     :        +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#4375 AS c_acctbal_prf_1#4384, rid#4376 AS rid_1#4385, c_name_prf#4377 AS c_name_prf_1#4386, c_nationkey_prf#4378 AS c_nationkey_prf_1#4387, c_custkey_prf#4379 AS c_custkey_prf_1#4388, c_comment_prf#4380 AS c_comment_prf_1#4389, c_address_prf#4381 AS c_address_prf_1#4390, c_mktsegment_prf#4382 AS c_mktsegment_prf_1#4391, c_phone_prf#4383 AS c_phone_prf_1#4392]
         :  :     +- Relation[c_acctbal_prf#4375,rid#4376,c_name_prf#4377,c_nationkey_prf#4378,c_custkey_prf#4379,c_comment_prf#4380,c_address_prf#4381,c_mktsegment_prf#4382,c_phone_prf#4383] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1836) AS rid_2#4403]
         :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4402]
         :        :  +- Relation[c_acctbal_prf#4393,rid#4394,c_name_prf#4395,c_nationkey_prf#4396,c_custkey_prf#4397,c_comment_prf#4398,c_address_prf#4399,c_mktsegment_prf#4400,c_phone_prf#4401] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_2, 'rid_2, 'o_orderdate_prf_2, 'o_custkey_prf_2, 'o_orderpriority_prf_2, 'o_clerk_prf_2, 'o_orderstatus_prf_2, 'o_totalprice_prf_2, 'o_orderkey_prf_2, 'o_comment_prf_2, dexdecrypt('value_dec_key, value#1836) AS rid_3#4424]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_2#4415: string
            :     :- Project [o_shippriority_prf#4404 AS o_shippriority_prf_2#4414, rid#4405 AS rid_2#4415, o_orderdate_prf#4406 AS o_orderdate_prf_2#4416, o_custkey_prf#4407 AS o_custkey_prf_2#4417, o_orderpriority_prf#4408 AS o_orderpriority_prf_2#4418, o_clerk_prf#4409 AS o_clerk_prf_2#4419, o_orderstatus_prf#4410 AS o_orderstatus_prf_2#4420, o_totalprice_prf#4411 AS o_totalprice_prf_2#4421, o_orderkey_prf#4412 AS o_orderkey_prf_2#4422, o_comment_prf#4413 AS o_comment_prf_2#4423]
            :     :  +- Relation[o_shippriority_prf#4404,rid#4405,o_orderdate_prf#4406,o_custkey_prf#4407,o_orderpriority_prf#4408,o_clerk_prf#4409,o_orderstatus_prf#4410,o_totalprice_prf#4411,o_orderkey_prf#4412,o_comment_prf#4413] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4425 AS l_returnflag_prf_3#4444, l_orderkey_and_l_linenumber_prf#4426 AS l_orderkey_and_l_linenumber_prf_3#4445, l_comment_prf#4427 AS l_comment_prf_3#4446, l_linestatus_prf#4428 AS l_linestatus_prf_3#4447, rid#4429 AS rid_3#4448, l_shipmode_prf#4430 AS l_shipmode_prf_3#4449, l_shipinstruct_prf#4431 AS l_shipinstruct_prf_3#4450, l_quantity_prf#4432 AS l_quantity_prf_3#4451, l_receiptdate_prf#4433 AS l_receiptdate_prf_3#4452, l_linenumber_prf#4434 AS l_linenumber_prf_3#4453, l_tax_prf#4435 AS l_tax_prf_3#4454, l_shipdate_prf#4436 AS l_shipdate_prf_3#4455, l_extendedprice_prf#4437 AS l_extendedprice_prf_3#4456, l_partkey_prf#4438 AS l_partkey_prf_3#4457, l_discount_prf#4439 AS l_discount_prf_3#4458, l_partkey_and_l_suppkey_prf#4440 AS l_partkey_and_l_suppkey_prf_3#4459, l_commitdate_prf#4441 AS l_commitdate_prf_3#4460, l_suppkey_prf#4442 AS l_suppkey_prf_3#4461, l_orderkey_prf#4443 AS l_orderkey_prf_3#4462]
               +- Relation[l_returnflag_prf#4425,l_orderkey_and_l_linenumber_prf#4426,l_comment_prf#4427,l_linestatus_prf#4428,rid#4429,l_shipmode_prf#4430,l_shipinstruct_prf#4431,l_quantity_prf#4432,l_receiptdate_prf#4433,l_linenumber_prf#4434,l_tax_prf#4435,l_shipdate_prf#4436,l_extendedprice_prf#4437,l_partkey_prf#4438,l_discount_prf#4439,l_partkey_and_l_suppkey_prf#4440,l_commitdate_prf#4441,l_suppkey_prf#4442,l_orderkey_prf#4443] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 225917ms

fq1e=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 13:55:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 13:55:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4546L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [c_custkey#290L, c_nationkey#293L]
                  +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 13:55:17 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 13:55:17 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 13:55:17 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 13:55:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4546L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_1#4586]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4571: string
         :  :  :     :- Project [l_returnflag_prf#4548 AS l_returnflag_prf_0#4567, l_orderkey_and_l_linenumber_prf#4549 AS l_orderkey_and_l_linenumber_prf_0#4568, l_comment_prf#4550 AS l_comment_prf_0#4569, l_linestatus_prf#4551 AS l_linestatus_prf_0#4570, rid#4552 AS rid_0#4571, l_shipmode_prf#4553 AS l_shipmode_prf_0#4572, l_shipinstruct_prf#4554 AS l_shipinstruct_prf_0#4573, l_quantity_prf#4555 AS l_quantity_prf_0#4574, l_receiptdate_prf#4556 AS l_receiptdate_prf_0#4575, l_linenumber_prf#4557 AS l_linenumber_prf_0#4576, l_tax_prf#4558 AS l_tax_prf_0#4577, l_shipdate_prf#4559 AS l_shipdate_prf_0#4578, l_extendedprice_prf#4560 AS l_extendedprice_prf_0#4579, l_partkey_prf#4561 AS l_partkey_prf_0#4580, l_discount_prf#4562 AS l_discount_prf_0#4581, l_partkey_and_l_suppkey_prf#4563 AS l_partkey_and_l_suppkey_prf_0#4582, l_commitdate_prf#4564 AS l_commitdate_prf_0#4583, l_suppkey_prf#4565 AS l_suppkey_prf_0#4584, l_orderkey_prf#4566 AS l_orderkey_prf_0#4585]
         :  :  :     :  +- Relation[l_returnflag_prf#4548,l_orderkey_and_l_linenumber_prf#4549,l_comment_prf#4550,l_linestatus_prf#4551,rid#4552,l_shipmode_prf#4553,l_shipinstruct_prf#4554,l_quantity_prf#4555,l_receiptdate_prf#4556,l_linenumber_prf#4557,l_tax_prf#4558,l_shipdate_prf#4559,l_extendedprice_prf#4560,l_partkey_prf#4561,l_discount_prf#4562,l_partkey_and_l_suppkey_prf#4563,l_commitdate_prf#4564,l_suppkey_prf#4565,l_orderkey_prf#4566] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#4587 AS o_shippriority_prf_1#4597, rid#4588 AS rid_1#4598, o_orderdate_prf#4589 AS o_orderdate_prf_1#4599, o_custkey_prf#4590 AS o_custkey_prf_1#4600, o_orderpriority_prf#4591 AS o_orderpriority_prf_1#4601, o_clerk_prf#4592 AS o_clerk_prf_1#4602, o_orderstatus_prf#4593 AS o_orderstatus_prf_1#4603, o_totalprice_prf#4594 AS o_totalprice_prf_1#4604, o_orderkey_prf#4595 AS o_orderkey_prf_1#4605, o_comment_prf#4596 AS o_comment_prf_1#4606]
         :  :     +- Relation[o_shippriority_prf#4587,rid#4588,o_orderdate_prf#4589,o_custkey_prf#4590,o_orderpriority_prf#4591,o_clerk_prf#4592,o_orderstatus_prf#4593,o_totalprice_prf#4594,o_orderkey_prf#4595,o_comment_prf#4596] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1836) AS rid_3#4618]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4617]
         :        :  +- Relation[o_shippriority_prf#4607,rid#4608,o_orderdate_prf#4609,o_custkey_prf#4610,o_orderpriority_prf#4611,o_clerk_prf#4612,o_orderstatus_prf#4613,o_totalprice_prf#4614,o_orderkey_prf#4615,o_comment_prf#4616] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_2, 'n_regionkey_prf_2, 'n_nationkey_prf_2, 'n_name_prf_2, 'n_comment_prf_2, dexdecrypt('value_dec_key, value#1836) AS rid_3#4630]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_2#4624: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [rid#4619 AS rid_2#4624, n_regionkey_prf#4620 AS n_regionkey_prf_2#4625, n_nationkey_prf#4621 AS n_nationkey_prf_2#4626, n_name_prf#4622 AS n_name_prf_2#4627, n_comment_prf#4623 AS n_comment_prf_2#4628]
            :     :  :  +- Relation[rid#4619,n_regionkey_prf#4620,n_nationkey_prf#4621,n_name_prf#4622,n_comment_prf#4623] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#4629]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4631 AS c_acctbal_prf_3#4640, rid#4632 AS rid_3#4641, c_name_prf#4633 AS c_name_prf_3#4642, c_nationkey_prf#4634 AS c_nationkey_prf_3#4643, c_custkey_prf#4635 AS c_custkey_prf_3#4644, c_comment_prf#4636 AS c_comment_prf_3#4645, c_address_prf#4637 AS c_address_prf_3#4646, c_mktsegment_prf#4638 AS c_mktsegment_prf_3#4647, c_phone_prf#4639 AS c_phone_prf_3#4648]
               +- Relation[c_acctbal_prf#4631,rid#4632,c_name_prf#4633,c_nationkey_prf#4634,c_custkey_prf#4635,c_comment_prf#4636,c_address_prf#4637,c_mktsegment_prf#4638,c_phone_prf#4639] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 182411ms

fr1e=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and (o_orderkey = l_orderkey and c_custkey = o_custkey)
19/10/16 13:58:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 13:58:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4728L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 13:58:20 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 13:58:20 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 13:58:20 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 13:58:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4728L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_1#4749]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4740: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [c_acctbal_prf#4730 AS c_acctbal_prf_0#4739, rid#4731 AS rid_0#4740, c_name_prf#4732 AS c_name_prf_0#4741, c_nationkey_prf#4733 AS c_nationkey_prf_0#4742, c_custkey_prf#4734 AS c_custkey_prf_0#4743, c_comment_prf#4735 AS c_comment_prf_0#4744, c_address_prf#4736 AS c_address_prf_0#4745, c_mktsegment_prf#4737 AS c_mktsegment_prf_0#4746, c_phone_prf#4738 AS c_phone_prf_0#4747]
         :     :  :  +- Relation[c_acctbal_prf#4730,rid#4731,c_name_prf#4732,c_nationkey_prf#4733,c_custkey_prf#4734,c_comment_prf#4735,c_address_prf#4736,c_mktsegment_prf#4737,c_phone_prf#4738] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4748]
         :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :        +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1836) AS rid_2#4770]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#4761: string
            :     :- Project [o_shippriority_prf#4750 AS o_shippriority_prf_1#4760, rid#4751 AS rid_1#4761, o_orderdate_prf#4752 AS o_orderdate_prf_1#4762, o_custkey_prf#4753 AS o_custkey_prf_1#4763, o_orderpriority_prf#4754 AS o_orderpriority_prf_1#4764, o_clerk_prf#4755 AS o_clerk_prf_1#4765, o_orderstatus_prf#4756 AS o_orderstatus_prf_1#4766, o_totalprice_prf#4757 AS o_totalprice_prf_1#4767, o_orderkey_prf#4758 AS o_orderkey_prf_1#4768, o_comment_prf#4759 AS o_comment_prf_1#4769]
            :     :  +- Relation[o_shippriority_prf#4750,rid#4751,o_orderdate_prf#4752,o_custkey_prf#4753,o_orderpriority_prf#4754,o_clerk_prf#4755,o_orderstatus_prf#4756,o_totalprice_prf#4757,o_orderkey_prf#4758,o_comment_prf#4759] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4771 AS l_returnflag_prf_2#4790, l_orderkey_and_l_linenumber_prf#4772 AS l_orderkey_and_l_linenumber_prf_2#4791, l_comment_prf#4773 AS l_comment_prf_2#4792, l_linestatus_prf#4774 AS l_linestatus_prf_2#4793, rid#4775 AS rid_2#4794, l_shipmode_prf#4776 AS l_shipmode_prf_2#4795, l_shipinstruct_prf#4777 AS l_shipinstruct_prf_2#4796, l_quantity_prf#4778 AS l_quantity_prf_2#4797, l_receiptdate_prf#4779 AS l_receiptdate_prf_2#4798, l_linenumber_prf#4780 AS l_linenumber_prf_2#4799, l_tax_prf#4781 AS l_tax_prf_2#4800, l_shipdate_prf#4782 AS l_shipdate_prf_2#4801, l_extendedprice_prf#4783 AS l_extendedprice_prf_2#4802, l_partkey_prf#4784 AS l_partkey_prf_2#4803, l_discount_prf#4785 AS l_discount_prf_2#4804, l_partkey_and_l_suppkey_prf#4786 AS l_partkey_and_l_suppkey_prf_2#4805, l_commitdate_prf#4787 AS l_commitdate_prf_2#4806, l_suppkey_prf#4788 AS l_suppkey_prf_2#4807, l_orderkey_prf#4789 AS l_orderkey_prf_2#4808]
               +- Relation[l_returnflag_prf#4771,l_orderkey_and_l_linenumber_prf#4772,l_comment_prf#4773,l_linestatus_prf#4774,rid#4775,l_shipmode_prf#4776,l_shipinstruct_prf#4777,l_quantity_prf#4778,l_receiptdate_prf#4779,l_linenumber_prf#4780,l_tax_prf#4781,l_shipdate_prf#4782,l_extendedprice_prf#4783,l_partkey_prf#4784,l_discount_prf#4785,l_partkey_and_l_suppkey_prf#4786,l_commitdate_prf#4787,l_suppkey_prf#4788,l_orderkey_prf#4789] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 203662ms

ft2b=
select * from part, partsupp, supplier where p_size = 15 and p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/16 14:01:43 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 14:01:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4871L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 14:01:43 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 14:01:43 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 14:01:43 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 14:01:43 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 14:01:43 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 14:01:43 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 14:01:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4871L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_1#4894]
         :  :  :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4885: string
         :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :     :  :- Project [p_comment_prf#4873 AS p_comment_prf_0#4883, p_name_prf#4874 AS p_name_prf_0#4884, rid#4875 AS rid_0#4885, p_type_prf#4876 AS p_type_prf_0#4886, p_retailprice_prf#4877 AS p_retailprice_prf_0#4887, p_mfgr_prf#4878 AS p_mfgr_prf_0#4888, p_container_prf#4879 AS p_container_prf_0#4889, p_brand_prf#4880 AS p_brand_prf_0#4890, p_size_prf#4881 AS p_size_prf_0#4891, p_partkey_prf#4882 AS p_partkey_prf_0#4892]
         :  :  :     :  :  +- Relation[p_comment_prf#4873,p_name_prf#4874,rid#4875,p_type_prf#4876,p_retailprice_prf#4877,p_mfgr_prf#4878,p_container_prf#4879,p_brand_prf#4880,p_size_prf#4881,p_partkey_prf#4882] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4893]
         :  :  :     :     +- DexRidFilter part~p_size~15
         :  :  :     :        +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#4895 AS ps_partkey_and_ps_suppkey_prf_1#4902, rid#4896 AS rid_1#4903, ps_availqty_prf#4897 AS ps_availqty_prf_1#4904, ps_comment_prf#4898 AS ps_comment_prf_1#4905, ps_partkey_prf#4899 AS ps_partkey_prf_1#4906, ps_supplycost_prf#4900 AS ps_supplycost_prf_1#4907, ps_suppkey_prf#4901 AS ps_suppkey_prf_1#4908]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#4895,rid#4896,ps_availqty_prf#4897,ps_comment_prf#4898,ps_partkey_prf#4899,ps_supplycost_prf#4900,ps_suppkey_prf#4901] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1836) AS rid_2#4917]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4916]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#4909,rid#4910,ps_availqty_prf#4911,ps_comment_prf#4912,ps_partkey_prf#4913,ps_supplycost_prf#4914,ps_suppkey_prf#4915] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4918 AS s_phone_prf_2#4926, rid#4919 AS rid_2#4927, s_address_prf#4920 AS s_address_prf_2#4928, s_nationkey_prf#4921 AS s_nationkey_prf_2#4929, s_suppkey_prf#4922 AS s_suppkey_prf_2#4930, s_name_prf#4923 AS s_name_prf_2#4931, s_acctbal_prf#4924 AS s_acctbal_prf_2#4932, s_comment_prf#4925 AS s_comment_prf_2#4933]
            +- Relation[s_phone_prf#4918,rid#4919,s_address_prf#4920,s_nationkey_prf#4921,s_suppkey_prf#4922,s_name_prf#4923,s_acctbal_prf#4924,s_comment_prf#4925] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 46295ms

ft1b=
select * from nation, supplier, customer where n_name = 'FRANCE' and n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/16 14:02:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 14:02:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4981L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 14:02:30 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 14:02:30 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 14:02:30 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 14:02:30 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 14:02:30 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 14:02:30 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 14:02:30 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 14:02:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4981L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_1#4994]
         :  :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#4988: string
         :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :     :  :- Project [rid#4983 AS rid_0#4988, n_regionkey_prf#4984 AS n_regionkey_prf_0#4989, n_nationkey_prf#4985 AS n_nationkey_prf_0#4990, n_name_prf#4986 AS n_name_prf_0#4991, n_comment_prf#4987 AS n_comment_prf_0#4992]
         :  :  :     :  :  +- Relation[rid#4983,n_regionkey_prf#4984,n_nationkey_prf#4985,n_name_prf#4986,n_comment_prf#4987] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4993]
         :  :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :  :  :     :        +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#4995 AS s_phone_prf_1#5003, rid#4996 AS rid_1#5004, s_address_prf#4997 AS s_address_prf_1#5005, s_nationkey_prf#4998 AS s_nationkey_prf_1#5006, s_suppkey_prf#4999 AS s_suppkey_prf_1#5007, s_name_prf#5000 AS s_name_prf_1#5008, s_acctbal_prf#5001 AS s_acctbal_prf_1#5009, s_comment_prf#5002 AS s_comment_prf_1#5010]
         :  :     +- Relation[s_phone_prf#4995,rid#4996,s_address_prf#4997,s_nationkey_prf#4998,s_suppkey_prf#4999,s_name_prf#5000,s_acctbal_prf#5001,s_comment_prf#5002] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1836) AS rid_2#5017]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5016]
         :        :  +- Relation[rid#5011,n_regionkey_prf#5012,n_nationkey_prf#5013,n_name_prf#5014,n_comment_prf#5015] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#5018 AS c_acctbal_prf_2#5027, rid#5019 AS rid_2#5028, c_name_prf#5020 AS c_name_prf_2#5029, c_nationkey_prf#5021 AS c_nationkey_prf_2#5030, c_custkey_prf#5022 AS c_custkey_prf_2#5031, c_comment_prf#5023 AS c_comment_prf_2#5032, c_address_prf#5024 AS c_address_prf_2#5033, c_mktsegment_prf#5025 AS c_mktsegment_prf_2#5034, c_phone_prf#5026 AS c_phone_prf_2#5035]
            +- Relation[c_acctbal_prf#5018,rid#5019,c_name_prf#5020,c_nationkey_prf#5021,c_custkey_prf#5022,c_comment_prf#5023,c_address_prf#5024,c_mktsegment_prf#5025,c_phone_prf#5026] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 2612ms

fr1d=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/16 14:02:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 14:02:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5094L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 14:02:32 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 14:02:32 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 14:02:32 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 14:02:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5094L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_1#5115]
         :  :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#5106: string
         :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :     :  :- Project [c_acctbal_prf#5096 AS c_acctbal_prf_0#5105, rid#5097 AS rid_0#5106, c_name_prf#5098 AS c_name_prf_0#5107, c_nationkey_prf#5099 AS c_nationkey_prf_0#5108, c_custkey_prf#5100 AS c_custkey_prf_0#5109, c_comment_prf#5101 AS c_comment_prf_0#5110, c_address_prf#5102 AS c_address_prf_0#5111, c_mktsegment_prf#5103 AS c_mktsegment_prf_0#5112, c_phone_prf#5104 AS c_phone_prf_0#5113]
         :  :  :     :  :  +- Relation[c_acctbal_prf#5096,rid#5097,c_name_prf#5098,c_nationkey_prf#5099,c_custkey_prf#5100,c_comment_prf#5101,c_address_prf#5102,c_mktsegment_prf#5103,c_phone_prf#5104] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5114]
         :  :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :  :  :     :        +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#5116 AS o_shippriority_prf_1#5126, rid#5117 AS rid_1#5127, o_orderdate_prf#5118 AS o_orderdate_prf_1#5128, o_custkey_prf#5119 AS o_custkey_prf_1#5129, o_orderpriority_prf#5120 AS o_orderpriority_prf_1#5130, o_clerk_prf#5121 AS o_clerk_prf_1#5131, o_orderstatus_prf#5122 AS o_orderstatus_prf_1#5132, o_totalprice_prf#5123 AS o_totalprice_prf_1#5133, o_orderkey_prf#5124 AS o_orderkey_prf_1#5134, o_comment_prf#5125 AS o_comment_prf_1#5135]
         :  :     +- Relation[o_shippriority_prf#5116,rid#5117,o_orderdate_prf#5118,o_custkey_prf#5119,o_orderpriority_prf#5120,o_clerk_prf#5121,o_orderstatus_prf#5122,o_totalprice_prf#5123,o_orderkey_prf#5124,o_comment_prf#5125] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1836) AS rid_2#5147]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5146]
         :        :  +- Relation[o_shippriority_prf#5136,rid#5137,o_orderdate_prf#5138,o_custkey_prf#5139,o_orderpriority_prf#5140,o_clerk_prf#5141,o_orderstatus_prf#5142,o_totalprice_prf#5143,o_orderkey_prf#5144,o_comment_prf#5145] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5148 AS l_returnflag_prf_2#5167, l_orderkey_and_l_linenumber_prf#5149 AS l_orderkey_and_l_linenumber_prf_2#5168, l_comment_prf#5150 AS l_comment_prf_2#5169, l_linestatus_prf#5151 AS l_linestatus_prf_2#5170, rid#5152 AS rid_2#5171, l_shipmode_prf#5153 AS l_shipmode_prf_2#5172, l_shipinstruct_prf#5154 AS l_shipinstruct_prf_2#5173, l_quantity_prf#5155 AS l_quantity_prf_2#5174, l_receiptdate_prf#5156 AS l_receiptdate_prf_2#5175, l_linenumber_prf#5157 AS l_linenumber_prf_2#5176, l_tax_prf#5158 AS l_tax_prf_2#5177, l_shipdate_prf#5159 AS l_shipdate_prf_2#5178, l_extendedprice_prf#5160 AS l_extendedprice_prf_2#5179, l_partkey_prf#5161 AS l_partkey_prf_2#5180, l_discount_prf#5162 AS l_discount_prf_2#5181, l_partkey_and_l_suppkey_prf#5163 AS l_partkey_and_l_suppkey_prf_2#5182, l_commitdate_prf#5164 AS l_commitdate_prf_2#5183, l_suppkey_prf#5165 AS l_suppkey_prf_2#5184, l_orderkey_prf#5166 AS l_orderkey_prf_2#5185]
            +- Relation[l_returnflag_prf#5148,l_orderkey_and_l_linenumber_prf#5149,l_comment_prf#5150,l_linestatus_prf#5151,rid#5152,l_shipmode_prf#5153,l_shipinstruct_prf#5154,l_quantity_prf#5155,l_receiptdate_prf#5156,l_linenumber_prf#5157,l_tax_prf#5158,l_shipdate_prf#5159,l_extendedprice_prf#5160,l_partkey_prf#5161,l_discount_prf#5162,l_partkey_and_l_suppkey_prf#5163,l_commitdate_prf#5164,l_suppkey_prf#5165,l_orderkey_prf#5166] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 151564ms

ft2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and (p_size = 15 and s_suppkey = ps_suppkey)
19/10/16 14:05:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 14:05:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5248L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/16 14:05:04 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 14:05:04 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 14:05:04 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 14:05:04 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 14:05:04 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 14:05:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5248L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_2#5266]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#5259: string
         :     :- Project [s_phone_prf#5250 AS s_phone_prf_0#5258, rid#5251 AS rid_0#5259, s_address_prf#5252 AS s_address_prf_0#5260, s_nationkey_prf#5253 AS s_nationkey_prf_0#5261, s_suppkey_prf#5254 AS s_suppkey_prf_0#5262, s_name_prf#5255 AS s_name_prf_0#5263, s_acctbal_prf#5256 AS s_acctbal_prf_0#5264, s_comment_prf#5257 AS s_comment_prf_0#5265]
         :     :  +- Relation[s_phone_prf#5250,rid#5251,s_address_prf#5252,s_nationkey_prf#5253,s_suppkey_prf#5254,s_name_prf#5255,s_acctbal_prf#5256,s_comment_prf#5257] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1836) AS rid_2#5288]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#5279: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#5267 AS p_comment_prf_1#5277, p_name_prf#5268 AS p_name_prf_1#5278, rid#5269 AS rid_1#5279, p_type_prf#5270 AS p_type_prf_1#5280, p_retailprice_prf#5271 AS p_retailprice_prf_1#5281, p_mfgr_prf#5272 AS p_mfgr_prf_1#5282, p_container_prf#5273 AS p_container_prf_1#5283, p_brand_prf#5274 AS p_brand_prf_1#5284, p_size_prf#5275 AS p_size_prf_1#5285, p_partkey_prf#5276 AS p_partkey_prf_1#5286]
            :     :  :  +- Relation[p_comment_prf#5267,p_name_prf#5268,rid#5269,p_type_prf#5270,p_retailprice_prf#5271,p_mfgr_prf#5272,p_container_prf#5273,p_brand_prf#5274,p_size_prf#5275,p_partkey_prf#5276] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5287]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#5289 AS ps_partkey_and_ps_suppkey_prf_2#5296, rid#5290 AS rid_2#5297, ps_availqty_prf#5291 AS ps_availqty_prf_2#5298, ps_comment_prf#5292 AS ps_comment_prf_2#5299, ps_partkey_prf#5293 AS ps_partkey_prf_2#5300, ps_supplycost_prf#5294 AS ps_supplycost_prf_2#5301, ps_suppkey_prf#5295 AS ps_suppkey_prf_2#5302]
               +- Relation[ps_partkey_and_ps_suppkey_prf#5289,rid#5290,ps_availqty_prf#5291,ps_comment_prf#5292,ps_partkey_prf#5293,ps_supplycost_prf#5294,ps_suppkey_prf#5295] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 7639ms

fq1c=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 14:05:11 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 14:05:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5368L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [c_nationkey#293L, o_orderkey#342L]
               :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :     :- Project [c_custkey#290L, c_nationkey#293L]
               :     :  +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
               :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               :     +- Project [o_orderkey#342L, o_custkey#343L]
               :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 14:05:11 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 14:05:11 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 14:05:11 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 14:05:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5368L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_1#5381]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#5375: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [rid#5370 AS rid_0#5375, n_regionkey_prf#5371 AS n_regionkey_prf_0#5376, n_nationkey_prf#5372 AS n_nationkey_prf_0#5377, n_name_prf#5373 AS n_name_prf_0#5378, n_comment_prf#5374 AS n_comment_prf_0#5379]
         :     :  :  +- Relation[rid#5370,n_regionkey_prf#5371,n_nationkey_prf#5372,n_name_prf#5373,n_comment_prf#5374] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5380]
         :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :        +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join NaturalJoin(Inner)
            :  :  :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1836) AS rid_2#5400]
            :  :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#5392: string
            :  :  :     :- Project [c_acctbal_prf#5382 AS c_acctbal_prf_1#5391, rid#5383 AS rid_1#5392, c_name_prf#5384 AS c_name_prf_1#5393, c_nationkey_prf#5385 AS c_nationkey_prf_1#5394, c_custkey_prf#5386 AS c_custkey_prf_1#5395, c_comment_prf#5387 AS c_comment_prf_1#5396, c_address_prf#5388 AS c_address_prf_1#5397, c_mktsegment_prf#5389 AS c_mktsegment_prf_1#5398, c_phone_prf#5390 AS c_phone_prf_1#5399]
            :  :  :     :  +- Relation[c_acctbal_prf#5382,rid#5383,c_name_prf#5384,c_nationkey_prf#5385,c_custkey_prf#5386,c_comment_prf#5387,c_address_prf#5388,c_mktsegment_prf#5389,c_phone_prf#5390] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
            :  :  +- Project [o_shippriority_prf#5401 AS o_shippriority_prf_2#5411, rid#5402 AS rid_2#5412, o_orderdate_prf#5403 AS o_orderdate_prf_2#5413, o_custkey_prf#5404 AS o_custkey_prf_2#5414, o_orderpriority_prf#5405 AS o_orderpriority_prf_2#5415, o_clerk_prf#5406 AS o_clerk_prf_2#5416, o_orderstatus_prf#5407 AS o_orderstatus_prf_2#5417, o_totalprice_prf#5408 AS o_totalprice_prf_2#5418, o_orderkey_prf#5409 AS o_orderkey_prf_2#5419, o_comment_prf#5410 AS o_comment_prf_2#5420]
            :  :     +- Relation[o_shippriority_prf#5401,rid#5402,o_orderdate_prf#5403,o_custkey_prf#5404,o_orderpriority_prf#5405,o_clerk_prf#5406,o_orderstatus_prf#5407,o_totalprice_prf#5408,o_orderkey_prf#5409,o_comment_prf#5410] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1836) AS rid_3#5432]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#5431]
            :        :  +- Relation[o_shippriority_prf#5421,rid#5422,o_orderdate_prf#5423,o_custkey_prf#5424,o_orderpriority_prf#5425,o_clerk_prf#5426,o_orderstatus_prf#5427,o_totalprice_prf#5428,o_orderkey_prf#5429,o_comment_prf#5430] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#5433 AS l_returnflag_prf_3#5452, l_orderkey_and_l_linenumber_prf#5434 AS l_orderkey_and_l_linenumber_prf_3#5453, l_comment_prf#5435 AS l_comment_prf_3#5454, l_linestatus_prf#5436 AS l_linestatus_prf_3#5455, rid#5437 AS rid_3#5456, l_shipmode_prf#5438 AS l_shipmode_prf_3#5457, l_shipinstruct_prf#5439 AS l_shipinstruct_prf_3#5458, l_quantity_prf#5440 AS l_quantity_prf_3#5459, l_receiptdate_prf#5441 AS l_receiptdate_prf_3#5460, l_linenumber_prf#5442 AS l_linenumber_prf_3#5461, l_tax_prf#5443 AS l_tax_prf_3#5462, l_shipdate_prf#5444 AS l_shipdate_prf_3#5463, l_extendedprice_prf#5445 AS l_extendedprice_prf_3#5464, l_partkey_prf#5446 AS l_partkey_prf_3#5465, l_discount_prf#5447 AS l_discount_prf_3#5466, l_partkey_and_l_suppkey_prf#5448 AS l_partkey_and_l_suppkey_prf_3#5467, l_commitdate_prf#5449 AS l_commitdate_prf_3#5468, l_suppkey_prf#5450 AS l_suppkey_prf_3#5469, l_orderkey_prf#5451 AS l_orderkey_prf_3#5470]
               +- Relation[l_returnflag_prf#5433,l_orderkey_and_l_linenumber_prf#5434,l_comment_prf#5435,l_linestatus_prf#5436,rid#5437,l_shipmode_prf#5438,l_shipinstruct_prf#5439,l_quantity_prf#5440,l_receiptdate_prf#5441,l_linenumber_prf#5442,l_tax_prf#5443,l_shipdate_prf#5444,l_extendedprice_prf#5445,l_partkey_prf#5446,l_discount_prf#5447,l_partkey_and_l_suppkey_prf#5448,l_commitdate_prf#5449,l_suppkey_prf#5450,l_orderkey_prf#5451] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 228618ms

ft1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_name = 'FRANCE' and n_nationkey = c_nationkey
19/10/16 14:09:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 14:09:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5536L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 14:09:00 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 14:09:00 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 14:09:00 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 14:09:00 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 14:09:00 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 14:09:00 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 14:09:00 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 14:09:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5536L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1836) AS rid_1#5554]
         :  :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#5547: string
         :  :  :     :- Project [s_phone_prf#5538 AS s_phone_prf_0#5546, rid#5539 AS rid_0#5547, s_address_prf#5540 AS s_address_prf_0#5548, s_nationkey_prf#5541 AS s_nationkey_prf_0#5549, s_suppkey_prf#5542 AS s_suppkey_prf_0#5550, s_name_prf#5543 AS s_name_prf_0#5551, s_acctbal_prf#5544 AS s_acctbal_prf_0#5552, s_comment_prf#5545 AS s_comment_prf_0#5553]
         :  :  :     :  +- Relation[s_phone_prf#5538,rid#5539,s_address_prf#5540,s_nationkey_prf#5541,s_suppkey_prf#5542,s_name_prf#5543,s_acctbal_prf#5544,s_comment_prf#5545] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :     :- Project [rid#5555 AS rid_1#5560, n_regionkey_prf#5556 AS n_regionkey_prf_1#5561, n_nationkey_prf#5557 AS n_nationkey_prf_1#5562, n_name_prf#5558 AS n_name_prf_1#5563, n_comment_prf#5559 AS n_comment_prf_1#5564]
         :  :     :  +- Relation[rid#5555,n_regionkey_prf#5556,n_nationkey_prf#5557,n_name_prf#5558,n_comment_prf#5559] JDBCRelation(nation_prf) [numPartitions=1]
         :  :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5565]
         :  :        +- DexRidFilter nation~n_name~FRANCE
         :  :           +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1836) AS rid_2#5572]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5571]
         :        :  +- Relation[rid#5566,n_regionkey_prf#5567,n_nationkey_prf#5568,n_name_prf#5569,n_comment_prf#5570] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#1835,value#1836] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#5573 AS c_acctbal_prf_2#5582, rid#5574 AS rid_2#5583, c_name_prf#5575 AS c_name_prf_2#5584, c_nationkey_prf#5576 AS c_nationkey_prf_2#5585, c_custkey_prf#5577 AS c_custkey_prf_2#5586, c_comment_prf#5578 AS c_comment_prf_2#5587, c_address_prf#5579 AS c_address_prf_2#5588, c_mktsegment_prf#5580 AS c_mktsegment_prf_2#5589, c_phone_prf#5581 AS c_phone_prf_2#5590]
            +- Relation[c_acctbal_prf#5573,rid#5574,c_name_prf#5575,c_nationkey_prf#5576,c_custkey_prf#5577,c_comment_prf#5578,c_address_prf#5579,c_mktsegment_prf#5580,c_phone_prf#5581] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 1471ms
query=fq1a, count=246415, duration=165272
query=fq1b, count=246415, duration=225917
query=fq1c, count=246415, duration=228618
query=fq1d, count=0, duration=1038
query=fq1e, count=246415, duration=182411
query=fq1f, count=246415, duration=183502
query=fr1a, count=1214743, duration=139622
query=fr1b, count=1214743, duration=142728
query=fr1c, count=1214743, duration=98828
query=fr1d, count=1214743, duration=151564
query=fr1e, count=1214743, duration=203662
query=fr2a, count=2901744, duration=174678
query=fr2b, count=2901744, duration=121498
query=fr2d, count=2901744, duration=207343
query=fr2e, count=2901744, duration=98739
query=fr2f, count=2901744, duration=216894
query=ft1a, count=2452200, duration=1471
query=ft1b, count=2452200, duration=2612
query=ft1c, count=2452200, duration=33632
query=ft2a, count=15628, duration=101333
query=ft2b, count=15628, duration=46295
query=ft2c, count=15628, duration=7639
query=ft3a, count=6001215, duration=221425
query=ft3b, count=117754, duration=52865
query=ft3c, count=117754, duration=59793
