19/10/17 02:31:36 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7163ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Thu Oct 17 02:31:38 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Thu Oct 17 02:31:39 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Thu Oct 17 02:31:39 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Thu Oct 17 02:31:39 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Thu Oct 17 02:31:39 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Thu Oct 17 02:31:42 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Thu Oct 17 02:31:44 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Thu Oct 17 02:31:44 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



fq1b=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 02:31:46 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:31:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2097L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 02:31:46 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:31:46 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:31:46 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:31:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2097L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#2133]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#2114]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#2104: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#2099 AS rid_0#2104, n_regionkey_prf#2100 AS n_regionkey_prf_0#2105, n_nationkey_prf#2101 AS n_nationkey_prf_0#2106, n_name_prf#2102 AS n_name_prf_0#2107, n_comment_prf#2103 AS n_comment_prf_0#2108]
         :     :  :     :  :  +- Relation[rid#2099,n_regionkey_prf#2100,n_nationkey_prf#2101,n_name_prf#2102,n_comment_prf#2103] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2111]
         :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :        +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#2115 AS c_acctbal_prf_1#2124, rid#2116 AS rid_1#2125, c_name_prf#2117 AS c_name_prf_1#2126, c_nationkey_prf#2118 AS c_nationkey_prf_1#2127, c_custkey_prf#2119 AS c_custkey_prf_1#2128, c_comment_prf#2120 AS c_comment_prf_1#2129, c_address_prf#2121 AS c_address_prf_1#2130, c_mktsegment_prf#2122 AS c_mktsegment_prf_1#2131, c_phone_prf#2123 AS c_phone_prf_1#2132]
         :     :     +- Relation[c_acctbal_prf#2115,rid#2116,c_name_prf#2117,c_nationkey_prf#2118,c_custkey_prf#2119,c_comment_prf#2120,c_address_prf#2121,c_mktsegment_prf#2122,c_phone_prf#2123] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- Project [o_shippriority_prf#2134 AS o_shippriority_prf_2#2144, rid#2135 AS rid_2#2145, o_orderdate_prf#2136 AS o_orderdate_prf_2#2146, o_custkey_prf#2137 AS o_custkey_prf_2#2147, o_orderpriority_prf#2138 AS o_orderpriority_prf_2#2148, o_clerk_prf#2139 AS o_clerk_prf_2#2149, o_orderstatus_prf#2140 AS o_orderstatus_prf_2#2150, o_totalprice_prf#2141 AS o_totalprice_prf_2#2151, o_orderkey_prf#2142 AS o_orderkey_prf_2#2152, o_comment_prf#2143 AS o_comment_prf_2#2153]
            :  :  +- Relation[o_shippriority_prf#2134,rid#2135,o_orderdate_prf#2136,o_custkey_prf#2137,o_orderpriority_prf#2138,o_clerk_prf#2139,o_orderstatus_prf#2140,o_totalprice_prf#2141,o_orderkey_prf#2142,o_comment_prf#2143] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2113) AS rid_3#2165]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#2164]
            :        :  +- Relation[o_shippriority_prf#2154,rid#2155,o_orderdate_prf#2156,o_custkey_prf#2157,o_orderpriority_prf#2158,o_clerk_prf#2159,o_orderstatus_prf#2160,o_totalprice_prf#2161,o_orderkey_prf#2162,o_comment_prf#2163] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2166 AS l_returnflag_prf_3#2185, l_orderkey_and_l_linenumber_prf#2167 AS l_orderkey_and_l_linenumber_prf_3#2186, l_comment_prf#2168 AS l_comment_prf_3#2187, l_linestatus_prf#2169 AS l_linestatus_prf_3#2188, rid#2170 AS rid_3#2189, l_shipmode_prf#2171 AS l_shipmode_prf_3#2190, l_shipinstruct_prf#2172 AS l_shipinstruct_prf_3#2191, l_quantity_prf#2173 AS l_quantity_prf_3#2192, l_receiptdate_prf#2174 AS l_receiptdate_prf_3#2193, l_linenumber_prf#2175 AS l_linenumber_prf_3#2194, l_tax_prf#2176 AS l_tax_prf_3#2195, l_shipdate_prf#2177 AS l_shipdate_prf_3#2196, l_extendedprice_prf#2178 AS l_extendedprice_prf_3#2197, l_partkey_prf#2179 AS l_partkey_prf_3#2198, l_discount_prf#2180 AS l_discount_prf_3#2199, l_partkey_and_l_suppkey_prf#2181 AS l_partkey_and_l_suppkey_prf_3#2200, l_commitdate_prf#2182 AS l_commitdate_prf_3#2201, l_suppkey_prf#2183 AS l_suppkey_prf_3#2202, l_orderkey_prf#2184 AS l_orderkey_prf_3#2203]
               +- Relation[l_returnflag_prf#2166,l_orderkey_and_l_linenumber_prf#2167,l_comment_prf#2168,l_linestatus_prf#2169,rid#2170,l_shipmode_prf#2171,l_shipinstruct_prf#2172,l_quantity_prf#2173,l_receiptdate_prf#2174,l_linenumber_prf#2175,l_tax_prf#2176,l_shipdate_prf#2177,l_extendedprice_prf#2178,l_partkey_prf#2179,l_discount_prf#2180,l_partkey_and_l_suppkey_prf#2181,l_commitdate_prf#2182,l_suppkey_prf#2183,l_orderkey_prf#2184] JDBCRelation(lineitem_prf) [numPartitions=1]

19/10/17 02:31:46 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=246415
Elapsed time: 140384ms

ft1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/17 02:34:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:34:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2269L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/17 02:34:06 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:34:06 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:34:06 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:34:06 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:34:06 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:34:06 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:34:06 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:34:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2269L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#2271 AS c_acctbal_prf_0#2280, rid#2272 AS rid_0#2281, c_name_prf#2273 AS c_name_prf_0#2282, c_nationkey_prf#2274 AS c_nationkey_prf_0#2283, c_custkey_prf#2275 AS c_custkey_prf_0#2284, c_comment_prf#2276 AS c_comment_prf_0#2285, c_address_prf#2277 AS c_address_prf_0#2286, c_mktsegment_prf#2278 AS c_mktsegment_prf_0#2287, c_phone_prf#2279 AS c_phone_prf_0#2288]
         :  :  +- Relation[c_acctbal_prf#2271,rid#2272,c_name_prf#2273,c_nationkey_prf#2274,c_custkey_prf#2275,c_comment_prf#2276,c_address_prf#2277,c_mktsegment_prf#2278,c_phone_prf#2279] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2113) AS rid_2#2299]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2298]
         :        :  +- Relation[c_acctbal_prf#2289,rid#2290,c_name_prf#2291,c_nationkey_prf#2292,c_custkey_prf#2293,c_comment_prf#2294,c_address_prf#2295,c_mktsegment_prf#2296,c_phone_prf#2297] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [s_phone_prf#2300 AS s_phone_prf_1#2308, rid#2301 AS rid_1#2309, s_address_prf#2302 AS s_address_prf_1#2310, s_nationkey_prf#2303 AS s_nationkey_prf_1#2311, s_suppkey_prf#2304 AS s_suppkey_prf_1#2312, s_name_prf#2305 AS s_name_prf_1#2313, s_acctbal_prf#2306 AS s_acctbal_prf_1#2314, s_comment_prf#2307 AS s_comment_prf_1#2315]
            :  :  +- Relation[s_phone_prf#2300,rid#2301,s_address_prf#2302,s_nationkey_prf#2303,s_suppkey_prf#2304,s_name_prf#2305,s_acctbal_prf#2306,s_comment_prf#2307] JDBCRelation(supplier_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#2325]
            :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#2324]
            :        :  +- Relation[s_phone_prf#2316,rid#2317,s_address_prf#2318,s_nationkey_prf#2319,s_suppkey_prf#2320,s_name_prf#2321,s_acctbal_prf#2322,s_comment_prf#2323] JDBCRelation(supplier_prf) [numPartitions=1]
            :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [rid#2326 AS rid_2#2331, n_regionkey_prf#2327 AS n_regionkey_prf_2#2332, n_nationkey_prf#2328 AS n_nationkey_prf_2#2333, n_name_prf#2329 AS n_name_prf_2#2334, n_comment_prf#2330 AS n_comment_prf_2#2335]
               :  +- Relation[rid#2326,n_regionkey_prf#2327,n_nationkey_prf#2328,n_name_prf#2329,n_comment_prf#2330] JDBCRelation(nation_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#2336]
                  +- DexRidFilter nation~n_name~FRANCE
                     +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 33060ms

ft2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and p_size = 15 and ps_suppkey = s_suppkey
19/10/17 02:34:39 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:34:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2383L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 02:34:39 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 02:34:39 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 02:34:39 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 02:34:39 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 02:34:39 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:34:39 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:34:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2383L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#2429]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, rid_0#2393: string
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [ps_partkey_and_ps_suppkey_prf#2385 AS ps_partkey_and_ps_suppkey_prf_0#2392, rid#2386 AS rid_0#2393, ps_availqty_prf#2387 AS ps_availqty_prf_0#2394, ps_comment_prf#2388 AS ps_comment_prf_0#2395, ps_partkey_prf#2389 AS ps_partkey_prf_0#2396, ps_supplycost_prf#2390 AS ps_supplycost_prf_0#2397, ps_suppkey_prf#2391 AS ps_suppkey_prf_0#2398]
         :     :  :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#2385,rid#2386,ps_availqty_prf#2387,ps_comment_prf#2388,ps_partkey_prf#2389,ps_supplycost_prf#2390,ps_suppkey_prf#2391] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#2407]
         :     :  :     +- 'DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#2406]
         :     :  :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#2399,rid#2400,ps_availqty_prf#2401,ps_comment_prf#2402,ps_partkey_prf#2403,ps_supplycost_prf#2404,ps_suppkey_prf#2405] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [p_comment_prf#2408 AS p_comment_prf_1#2418, p_name_prf#2409 AS p_name_prf_1#2419, rid#2410 AS rid_1#2420, p_type_prf#2411 AS p_type_prf_1#2421, p_retailprice_prf#2412 AS p_retailprice_prf_1#2422, p_mfgr_prf#2413 AS p_mfgr_prf_1#2423, p_container_prf#2414 AS p_container_prf_1#2424, p_brand_prf#2415 AS p_brand_prf_1#2425, p_size_prf#2416 AS p_size_prf_1#2426, p_partkey_prf#2417 AS p_partkey_prf_1#2427]
         :     :     :  +- Relation[p_comment_prf#2408,p_name_prf#2409,rid#2410,p_type_prf#2411,p_retailprice_prf#2412,p_mfgr_prf#2413,p_container_prf#2414,p_brand_prf#2415,p_size_prf#2416,p_partkey_prf#2417] JDBCRelation(part_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2428]
         :     :        +- DexRidFilter part~p_size~15
         :     :           +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2430 AS s_phone_prf_2#2438, rid#2431 AS rid_2#2439, s_address_prf#2432 AS s_address_prf_2#2440, s_nationkey_prf#2433 AS s_nationkey_prf_2#2441, s_suppkey_prf#2434 AS s_suppkey_prf_2#2442, s_name_prf#2435 AS s_name_prf_2#2443, s_acctbal_prf#2436 AS s_acctbal_prf_2#2444, s_comment_prf#2437 AS s_comment_prf_2#2445]
            +- Relation[s_phone_prf#2430,rid#2431,s_address_prf#2432,s_nationkey_prf#2433,s_suppkey_prf#2434,s_name_prf#2435,s_acctbal_prf#2436,s_comment_prf#2437] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 49473ms

fr1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey and c_mktsegment = 'BUILDING'
19/10/17 02:35:28 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:35:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2507L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 02:35:28 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:35:28 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:35:28 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:35:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2507L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [l_returnflag_prf#2509 AS l_returnflag_prf_0#2528, l_orderkey_and_l_linenumber_prf#2510 AS l_orderkey_and_l_linenumber_prf_0#2529, l_comment_prf#2511 AS l_comment_prf_0#2530, l_linestatus_prf#2512 AS l_linestatus_prf_0#2531, rid#2513 AS rid_0#2532, l_shipmode_prf#2514 AS l_shipmode_prf_0#2533, l_shipinstruct_prf#2515 AS l_shipinstruct_prf_0#2534, l_quantity_prf#2516 AS l_quantity_prf_0#2535, l_receiptdate_prf#2517 AS l_receiptdate_prf_0#2536, l_linenumber_prf#2518 AS l_linenumber_prf_0#2537, l_tax_prf#2519 AS l_tax_prf_0#2538, l_shipdate_prf#2520 AS l_shipdate_prf_0#2539, l_extendedprice_prf#2521 AS l_extendedprice_prf_0#2540, l_partkey_prf#2522 AS l_partkey_prf_0#2541, l_discount_prf#2523 AS l_discount_prf_0#2542, l_partkey_and_l_suppkey_prf#2524 AS l_partkey_and_l_suppkey_prf_0#2543, l_commitdate_prf#2525 AS l_commitdate_prf_0#2544, l_suppkey_prf#2526 AS l_suppkey_prf_0#2545, l_orderkey_prf#2527 AS l_orderkey_prf_0#2546]
         :  :  :  :  +- Relation[l_returnflag_prf#2509,l_orderkey_and_l_linenumber_prf#2510,l_comment_prf#2511,l_linestatus_prf#2512,rid#2513,l_shipmode_prf#2514,l_shipinstruct_prf#2515,l_quantity_prf#2516,l_receiptdate_prf#2517,l_linenumber_prf#2518,l_tax_prf#2519,l_shipdate_prf#2520,l_extendedprice_prf#2521,l_partkey_prf#2522,l_discount_prf#2523,l_partkey_and_l_suppkey_prf#2524,l_commitdate_prf#2525,l_suppkey_prf#2526,l_orderkey_prf#2527] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#2567]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#2566]
         :  :  :        :  +- Relation[l_returnflag_prf#2547,l_orderkey_and_l_linenumber_prf#2548,l_comment_prf#2549,l_linestatus_prf#2550,rid#2551,l_shipmode_prf#2552,l_shipinstruct_prf#2553,l_quantity_prf#2554,l_receiptdate_prf#2555,l_linenumber_prf#2556,l_tax_prf#2557,l_shipdate_prf#2558,l_extendedprice_prf#2559,l_partkey_prf#2560,l_discount_prf#2561,l_partkey_and_l_suppkey_prf#2562,l_commitdate_prf#2563,l_suppkey_prf#2564,l_orderkey_prf#2565] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#2568 AS o_shippriority_prf_1#2578, rid#2569 AS rid_1#2579, o_orderdate_prf#2570 AS o_orderdate_prf_1#2580, o_custkey_prf#2571 AS o_custkey_prf_1#2581, o_orderpriority_prf#2572 AS o_orderpriority_prf_1#2582, o_clerk_prf#2573 AS o_clerk_prf_1#2583, o_orderstatus_prf#2574 AS o_orderstatus_prf_1#2584, o_totalprice_prf#2575 AS o_totalprice_prf_1#2585, o_orderkey_prf#2576 AS o_orderkey_prf_1#2586, o_comment_prf#2577 AS o_comment_prf_1#2587]
         :  :     +- Relation[o_shippriority_prf#2568,rid#2569,o_orderdate_prf#2570,o_custkey_prf#2571,o_orderpriority_prf#2572,o_clerk_prf#2573,o_orderstatus_prf#2574,o_totalprice_prf#2575,o_orderkey_prf#2576,o_comment_prf#2577] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#2599]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2598]
         :        :  +- Relation[o_shippriority_prf#2588,rid#2589,o_orderdate_prf#2590,o_custkey_prf#2591,o_orderpriority_prf#2592,o_clerk_prf#2593,o_orderstatus_prf#2594,o_totalprice_prf#2595,o_orderkey_prf#2596,o_comment_prf#2597] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_2))
            :- Project [c_acctbal_prf#2600 AS c_acctbal_prf_2#2609, rid#2601 AS rid_2#2610, c_name_prf#2602 AS c_name_prf_2#2611, c_nationkey_prf#2603 AS c_nationkey_prf_2#2612, c_custkey_prf#2604 AS c_custkey_prf_2#2613, c_comment_prf#2605 AS c_comment_prf_2#2614, c_address_prf#2606 AS c_address_prf_2#2615, c_mktsegment_prf#2607 AS c_mktsegment_prf_2#2616, c_phone_prf#2608 AS c_phone_prf_2#2617]
            :  +- Relation[c_acctbal_prf#2600,rid#2601,c_name_prf#2602,c_nationkey_prf#2603,c_custkey_prf#2604,c_comment_prf#2605,c_address_prf#2606,c_mktsegment_prf#2607,c_phone_prf#2608] JDBCRelation(customer_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#2618]
               +- DexRidFilter customer~c_mktsegment~BUILDING
                  +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 120733ms

fr1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and (l_orderkey = o_orderkey and c_mktsegment = 'BUILDING')
19/10/17 02:37:29 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:37:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2693L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 02:37:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:37:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:37:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:37:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2693L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#2695 AS l_returnflag_prf_0#2714, l_orderkey_and_l_linenumber_prf#2696 AS l_orderkey_and_l_linenumber_prf_0#2715, l_comment_prf#2697 AS l_comment_prf_0#2716, l_linestatus_prf#2698 AS l_linestatus_prf_0#2717, rid#2699 AS rid_0#2718, l_shipmode_prf#2700 AS l_shipmode_prf_0#2719, l_shipinstruct_prf#2701 AS l_shipinstruct_prf_0#2720, l_quantity_prf#2702 AS l_quantity_prf_0#2721, l_receiptdate_prf#2703 AS l_receiptdate_prf_0#2722, l_linenumber_prf#2704 AS l_linenumber_prf_0#2723, l_tax_prf#2705 AS l_tax_prf_0#2724, l_shipdate_prf#2706 AS l_shipdate_prf_0#2725, l_extendedprice_prf#2707 AS l_extendedprice_prf_0#2726, l_partkey_prf#2708 AS l_partkey_prf_0#2727, l_discount_prf#2709 AS l_discount_prf_0#2728, l_partkey_and_l_suppkey_prf#2710 AS l_partkey_and_l_suppkey_prf_0#2729, l_commitdate_prf#2711 AS l_commitdate_prf_0#2730, l_suppkey_prf#2712 AS l_suppkey_prf_0#2731, l_orderkey_prf#2713 AS l_orderkey_prf_0#2732]
         :  :  +- Relation[l_returnflag_prf#2695,l_orderkey_and_l_linenumber_prf#2696,l_comment_prf#2697,l_linestatus_prf#2698,rid#2699,l_shipmode_prf#2700,l_shipinstruct_prf#2701,l_quantity_prf#2702,l_receiptdate_prf#2703,l_linenumber_prf#2704,l_tax_prf#2705,l_shipdate_prf#2706,l_extendedprice_prf#2707,l_partkey_prf#2708,l_discount_prf#2709,l_partkey_and_l_suppkey_prf#2710,l_commitdate_prf#2711,l_suppkey_prf#2712,l_orderkey_prf#2713] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#2753]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2752]
         :        :  +- Relation[l_returnflag_prf#2733,l_orderkey_and_l_linenumber_prf#2734,l_comment_prf#2735,l_linestatus_prf#2736,rid#2737,l_shipmode_prf#2738,l_shipinstruct_prf#2739,l_quantity_prf#2740,l_receiptdate_prf#2741,l_linenumber_prf#2742,l_tax_prf#2743,l_shipdate_prf#2744,l_extendedprice_prf#2745,l_partkey_prf#2746,l_discount_prf#2747,l_partkey_and_l_suppkey_prf#2748,l_commitdate_prf#2749,l_suppkey_prf#2750,l_orderkey_prf#2751] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [o_shippriority_prf#2754 AS o_shippriority_prf_1#2764, rid#2755 AS rid_1#2765, o_orderdate_prf#2756 AS o_orderdate_prf_1#2766, o_custkey_prf#2757 AS o_custkey_prf_1#2767, o_orderpriority_prf#2758 AS o_orderpriority_prf_1#2768, o_clerk_prf#2759 AS o_clerk_prf_1#2769, o_orderstatus_prf#2760 AS o_orderstatus_prf_1#2770, o_totalprice_prf#2761 AS o_totalprice_prf_1#2771, o_orderkey_prf#2762 AS o_orderkey_prf_1#2772, o_comment_prf#2763 AS o_comment_prf_1#2773]
            :  :  +- Relation[o_shippriority_prf#2754,rid#2755,o_orderdate_prf#2756,o_custkey_prf#2757,o_orderpriority_prf#2758,o_clerk_prf#2759,o_orderstatus_prf#2760,o_totalprice_prf#2761,o_orderkey_prf#2762,o_comment_prf#2763] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#2785]
            :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#2784]
            :        :  +- Relation[o_shippriority_prf#2774,rid#2775,o_orderdate_prf#2776,o_custkey_prf#2777,o_orderpriority_prf#2778,o_clerk_prf#2779,o_orderstatus_prf#2780,o_totalprice_prf#2781,o_orderkey_prf#2782,o_comment_prf#2783] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [c_acctbal_prf#2786 AS c_acctbal_prf_2#2795, rid#2787 AS rid_2#2796, c_name_prf#2788 AS c_name_prf_2#2797, c_nationkey_prf#2789 AS c_nationkey_prf_2#2798, c_custkey_prf#2790 AS c_custkey_prf_2#2799, c_comment_prf#2791 AS c_comment_prf_2#2800, c_address_prf#2792 AS c_address_prf_2#2801, c_mktsegment_prf#2793 AS c_mktsegment_prf_2#2802, c_phone_prf#2794 AS c_phone_prf_2#2803]
               :  +- Relation[c_acctbal_prf#2786,rid#2787,c_name_prf#2788,c_nationkey_prf#2789,c_custkey_prf#2790,c_comment_prf#2791,c_address_prf#2792,c_mktsegment_prf#2793,c_phone_prf#2794] JDBCRelation(customer_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#2804]
                  +- DexRidFilter customer~c_mktsegment~BUILDING
                     +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 121152ms

fs1a=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/17 02:39:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:39:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2888L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [c_custkey#290L]
         :     :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L]
         :        +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/17 02:39:30 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:39:30 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:39:30 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:39:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2888L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, 'rid_2, 'l_returnflag_prf_2, 'l_orderkey_and_l_linenumber_prf_2, 'l_comment_prf_2, 'l_linestatus_prf_2, ... 15 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#2930]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#2909]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2900: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [c_acctbal_prf#2890 AS c_acctbal_prf_0#2899, rid#2891 AS rid_0#2900, c_name_prf#2892 AS c_name_prf_0#2901, c_nationkey_prf#2893 AS c_nationkey_prf_0#2902, c_custkey_prf#2894 AS c_custkey_prf_0#2903, c_comment_prf#2895 AS c_comment_prf_0#2904, c_address_prf#2896 AS c_address_prf_0#2905, c_mktsegment_prf#2897 AS c_mktsegment_prf_0#2906, c_phone_prf#2898 AS c_phone_prf_0#2907]
         :     :  :     :  :     :  :  +- Relation[c_acctbal_prf#2890,rid#2891,c_name_prf#2892,c_nationkey_prf#2893,c_custkey_prf#2894,c_comment_prf#2895,c_address_prf#2896,c_mktsegment_prf#2897,c_phone_prf#2898] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2908]
         :     :  :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :  :     :        +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [o_shippriority_prf#2910 AS o_shippriority_prf_1#2920, rid#2911 AS rid_1#2921, o_orderdate_prf#2912 AS o_orderdate_prf_1#2922, o_custkey_prf#2913 AS o_custkey_prf_1#2923, o_orderpriority_prf#2914 AS o_orderpriority_prf_1#2924, o_clerk_prf#2915 AS o_clerk_prf_1#2925, o_orderstatus_prf#2916 AS o_orderstatus_prf_1#2926, o_totalprice_prf#2917 AS o_totalprice_prf_1#2927, o_orderkey_prf#2918 AS o_orderkey_prf_1#2928, o_comment_prf#2919 AS o_comment_prf_1#2929]
         :     :  :     :     +- Relation[o_shippriority_prf#2910,rid#2911,o_orderdate_prf#2912,o_custkey_prf#2913,o_orderpriority_prf#2914,o_clerk_prf#2915,o_orderstatus_prf#2916,o_totalprice_prf#2917,o_orderkey_prf#2918,o_comment_prf#2919] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#2931 AS l_returnflag_prf_2#2950, l_orderkey_and_l_linenumber_prf#2932 AS l_orderkey_and_l_linenumber_prf_2#2951, l_comment_prf#2933 AS l_comment_prf_2#2952, l_linestatus_prf#2934 AS l_linestatus_prf_2#2953, rid#2935 AS rid_2#2954, l_shipmode_prf#2936 AS l_shipmode_prf_2#2955, l_shipinstruct_prf#2937 AS l_shipinstruct_prf_2#2956, l_quantity_prf#2938 AS l_quantity_prf_2#2957, l_receiptdate_prf#2939 AS l_receiptdate_prf_2#2958, l_linenumber_prf#2940 AS l_linenumber_prf_2#2959, l_tax_prf#2941 AS l_tax_prf_2#2960, l_shipdate_prf#2942 AS l_shipdate_prf_2#2961, l_extendedprice_prf#2943 AS l_extendedprice_prf_2#2962, l_partkey_prf#2944 AS l_partkey_prf_2#2963, l_discount_prf#2945 AS l_discount_prf_2#2964, l_partkey_and_l_suppkey_prf#2946 AS l_partkey_and_l_suppkey_prf_2#2965, l_commitdate_prf#2947 AS l_commitdate_prf_2#2966, l_suppkey_prf#2948 AS l_suppkey_prf_2#2967, l_orderkey_prf#2949 AS l_orderkey_prf_2#2968]
         :     :     +- Relation[l_returnflag_prf#2931,l_orderkey_and_l_linenumber_prf#2932,l_comment_prf#2933,l_linestatus_prf#2934,rid#2935,l_shipmode_prf#2936,l_shipinstruct_prf#2937,l_quantity_prf#2938,l_receiptdate_prf#2939,l_linenumber_prf#2940,l_tax_prf#2941,l_shipdate_prf#2942,l_extendedprice_prf#2943,l_partkey_prf#2944,l_discount_prf#2945,l_partkey_and_l_suppkey_prf#2946,l_commitdate_prf#2947,l_suppkey_prf#2948,l_orderkey_prf#2949] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#2970 AS p_comment_prf_3#2980, p_name_prf#2971 AS p_name_prf_3#2981, rid#2972 AS rid_3#2982, p_type_prf#2973 AS p_type_prf_3#2983, p_retailprice_prf#2974 AS p_retailprice_prf_3#2984, p_mfgr_prf#2975 AS p_mfgr_prf_3#2985, p_container_prf#2976 AS p_container_prf_3#2986, p_brand_prf#2977 AS p_brand_prf_3#2987, p_size_prf#2978 AS p_size_prf_3#2988, p_partkey_prf#2979 AS p_partkey_prf_3#2989]
            +- Relation[p_comment_prf#2970,p_name_prf#2971,rid#2972,p_type_prf#2973,p_retailprice_prf#2974,p_mfgr_prf#2975,p_container_prf#2976,p_brand_prf#2977,p_size_prf#2978,p_partkey_prf#2979] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 108264ms

fq1e=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 02:41:19 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:41:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3078L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [c_custkey#290L, c_nationkey#293L]
                  +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 02:41:19 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:41:19 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:41:19 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:41:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3078L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [l_returnflag_prf#3080 AS l_returnflag_prf_0#3099, l_orderkey_and_l_linenumber_prf#3081 AS l_orderkey_and_l_linenumber_prf_0#3100, l_comment_prf#3082 AS l_comment_prf_0#3101, l_linestatus_prf#3083 AS l_linestatus_prf_0#3102, rid#3084 AS rid_0#3103, l_shipmode_prf#3085 AS l_shipmode_prf_0#3104, l_shipinstruct_prf#3086 AS l_shipinstruct_prf_0#3105, l_quantity_prf#3087 AS l_quantity_prf_0#3106, l_receiptdate_prf#3088 AS l_receiptdate_prf_0#3107, l_linenumber_prf#3089 AS l_linenumber_prf_0#3108, l_tax_prf#3090 AS l_tax_prf_0#3109, l_shipdate_prf#3091 AS l_shipdate_prf_0#3110, l_extendedprice_prf#3092 AS l_extendedprice_prf_0#3111, l_partkey_prf#3093 AS l_partkey_prf_0#3112, l_discount_prf#3094 AS l_discount_prf_0#3113, l_partkey_and_l_suppkey_prf#3095 AS l_partkey_and_l_suppkey_prf_0#3114, l_commitdate_prf#3096 AS l_commitdate_prf_0#3115, l_suppkey_prf#3097 AS l_suppkey_prf_0#3116, l_orderkey_prf#3098 AS l_orderkey_prf_0#3117]
         :  :  :  :  +- Relation[l_returnflag_prf#3080,l_orderkey_and_l_linenumber_prf#3081,l_comment_prf#3082,l_linestatus_prf#3083,rid#3084,l_shipmode_prf#3085,l_shipinstruct_prf#3086,l_quantity_prf#3087,l_receiptdate_prf#3088,l_linenumber_prf#3089,l_tax_prf#3090,l_shipdate_prf#3091,l_extendedprice_prf#3092,l_partkey_prf#3093,l_discount_prf#3094,l_partkey_and_l_suppkey_prf#3095,l_commitdate_prf#3096,l_suppkey_prf#3097,l_orderkey_prf#3098] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#3138]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#3137]
         :  :  :        :  +- Relation[l_returnflag_prf#3118,l_orderkey_and_l_linenumber_prf#3119,l_comment_prf#3120,l_linestatus_prf#3121,rid#3122,l_shipmode_prf#3123,l_shipinstruct_prf#3124,l_quantity_prf#3125,l_receiptdate_prf#3126,l_linenumber_prf#3127,l_tax_prf#3128,l_shipdate_prf#3129,l_extendedprice_prf#3130,l_partkey_prf#3131,l_discount_prf#3132,l_partkey_and_l_suppkey_prf#3133,l_commitdate_prf#3134,l_suppkey_prf#3135,l_orderkey_prf#3136] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#3139 AS o_shippriority_prf_1#3149, rid#3140 AS rid_1#3150, o_orderdate_prf#3141 AS o_orderdate_prf_1#3151, o_custkey_prf#3142 AS o_custkey_prf_1#3152, o_orderpriority_prf#3143 AS o_orderpriority_prf_1#3153, o_clerk_prf#3144 AS o_clerk_prf_1#3154, o_orderstatus_prf#3145 AS o_orderstatus_prf_1#3155, o_totalprice_prf#3146 AS o_totalprice_prf_1#3156, o_orderkey_prf#3147 AS o_orderkey_prf_1#3157, o_comment_prf#3148 AS o_comment_prf_1#3158]
         :  :     +- Relation[o_shippriority_prf#3139,rid#3140,o_orderdate_prf#3141,o_custkey_prf#3142,o_orderpriority_prf#3143,o_clerk_prf#3144,o_orderstatus_prf#3145,o_totalprice_prf#3146,o_orderkey_prf#3147,o_comment_prf#3148] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2113) AS rid_3#3170]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3169]
         :        :  +- Relation[o_shippriority_prf#3159,rid#3160,o_orderdate_prf#3161,o_custkey_prf#3162,o_orderpriority_prf#3163,o_clerk_prf#3164,o_orderstatus_prf#3165,o_totalprice_prf#3166,o_orderkey_prf#3167,o_comment_prf#3168] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_2, 'n_regionkey_prf_2, 'n_nationkey_prf_2, 'n_name_prf_2, 'n_comment_prf_2, dexdecrypt('value_dec_key, value#2113) AS rid_3#3182]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_2#3176: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [rid#3171 AS rid_2#3176, n_regionkey_prf#3172 AS n_regionkey_prf_2#3177, n_nationkey_prf#3173 AS n_nationkey_prf_2#3178, n_name_prf#3174 AS n_name_prf_2#3179, n_comment_prf#3175 AS n_comment_prf_2#3180]
            :     :  :  +- Relation[rid#3171,n_regionkey_prf#3172,n_nationkey_prf#3173,n_name_prf#3174,n_comment_prf#3175] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#3181]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#3183 AS c_acctbal_prf_3#3192, rid#3184 AS rid_3#3193, c_name_prf#3185 AS c_name_prf_3#3194, c_nationkey_prf#3186 AS c_nationkey_prf_3#3195, c_custkey_prf#3187 AS c_custkey_prf_3#3196, c_comment_prf#3188 AS c_comment_prf_3#3197, c_address_prf#3189 AS c_address_prf_3#3198, c_mktsegment_prf#3190 AS c_mktsegment_prf_3#3199, c_phone_prf#3191 AS c_phone_prf_3#3200]
               +- Relation[c_acctbal_prf#3183,rid#3184,c_name_prf#3185,c_nationkey_prf#3186,c_custkey_prf#3187,c_comment_prf#3188,c_address_prf#3189,c_mktsegment_prf#3190,c_phone_prf#3191] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 165381ms

fs1c=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/17 02:44:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:44:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3289L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_orderkey#306L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 02:44:04 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:44:04 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:44:04 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:44:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3289L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [p_comment_prf#3291 AS p_comment_prf_0#3301, p_name_prf#3292 AS p_name_prf_0#3302, rid#3293 AS rid_0#3303, p_type_prf#3294 AS p_type_prf_0#3304, p_retailprice_prf#3295 AS p_retailprice_prf_0#3305, p_mfgr_prf#3296 AS p_mfgr_prf_0#3306, p_container_prf#3297 AS p_container_prf_0#3307, p_brand_prf#3298 AS p_brand_prf_0#3308, p_size_prf#3299 AS p_size_prf_0#3309, p_partkey_prf#3300 AS p_partkey_prf_0#3310]
         :  :  :  :  +- Relation[p_comment_prf#3291,p_name_prf#3292,rid#3293,p_type_prf#3294,p_retailprice_prf#3295,p_mfgr_prf#3296,p_container_prf#3297,p_brand_prf#3298,p_size_prf#3299,p_partkey_prf#3300] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#3322]
         :  :  :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#3321]
         :  :  :        :  +- Relation[p_comment_prf#3311,p_name_prf#3312,rid#3313,p_type_prf#3314,p_retailprice_prf#3315,p_mfgr_prf#3316,p_container_prf#3317,p_brand_prf#3318,p_size_prf#3319,p_partkey_prf#3320] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#3323 AS l_returnflag_prf_1#3342, l_orderkey_and_l_linenumber_prf#3324 AS l_orderkey_and_l_linenumber_prf_1#3343, l_comment_prf#3325 AS l_comment_prf_1#3344, l_linestatus_prf#3326 AS l_linestatus_prf_1#3345, rid#3327 AS rid_1#3346, l_shipmode_prf#3328 AS l_shipmode_prf_1#3347, l_shipinstruct_prf#3329 AS l_shipinstruct_prf_1#3348, l_quantity_prf#3330 AS l_quantity_prf_1#3349, l_receiptdate_prf#3331 AS l_receiptdate_prf_1#3350, l_linenumber_prf#3332 AS l_linenumber_prf_1#3351, l_tax_prf#3333 AS l_tax_prf_1#3352, l_shipdate_prf#3334 AS l_shipdate_prf_1#3353, l_extendedprice_prf#3335 AS l_extendedprice_prf_1#3354, l_partkey_prf#3336 AS l_partkey_prf_1#3355, l_discount_prf#3337 AS l_discount_prf_1#3356, l_partkey_and_l_suppkey_prf#3338 AS l_partkey_and_l_suppkey_prf_1#3357, l_commitdate_prf#3339 AS l_commitdate_prf_1#3358, l_suppkey_prf#3340 AS l_suppkey_prf_1#3359, l_orderkey_prf#3341 AS l_orderkey_prf_1#3360]
         :  :     +- Relation[l_returnflag_prf#3323,l_orderkey_and_l_linenumber_prf#3324,l_comment_prf#3325,l_linestatus_prf#3326,rid#3327,l_shipmode_prf#3328,l_shipinstruct_prf#3329,l_quantity_prf#3330,l_receiptdate_prf#3331,l_linenumber_prf#3332,l_tax_prf#3333,l_shipdate_prf#3334,l_extendedprice_prf#3335,l_partkey_prf#3336,l_discount_prf#3337,l_partkey_and_l_suppkey_prf#3338,l_commitdate_prf#3339,l_suppkey_prf#3340,l_orderkey_prf#3341] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2113) AS rid_3#3381]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3380]
         :        :  +- Relation[l_returnflag_prf#3361,l_orderkey_and_l_linenumber_prf#3362,l_comment_prf#3363,l_linestatus_prf#3364,rid#3365,l_shipmode_prf#3366,l_shipinstruct_prf#3367,l_quantity_prf#3368,l_receiptdate_prf#3369,l_linenumber_prf#3370,l_tax_prf#3371,l_shipdate_prf#3372,l_extendedprice_prf#3373,l_partkey_prf#3374,l_discount_prf#3375,l_partkey_and_l_suppkey_prf#3376,l_commitdate_prf#3377,l_suppkey_prf#3378,l_orderkey_prf#3379] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_2, 'rid_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2113) AS rid_3#3401]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_2#3392: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [c_acctbal_prf#3382 AS c_acctbal_prf_2#3391, rid#3383 AS rid_2#3392, c_name_prf#3384 AS c_name_prf_2#3393, c_nationkey_prf#3385 AS c_nationkey_prf_2#3394, c_custkey_prf#3386 AS c_custkey_prf_2#3395, c_comment_prf#3387 AS c_comment_prf_2#3396, c_address_prf#3388 AS c_address_prf_2#3397, c_mktsegment_prf#3389 AS c_mktsegment_prf_2#3398, c_phone_prf#3390 AS c_phone_prf_2#3399]
            :     :  :  +- Relation[c_acctbal_prf#3382,rid#3383,c_name_prf#3384,c_nationkey_prf#3385,c_custkey_prf#3386,c_comment_prf#3387,c_address_prf#3388,c_mktsegment_prf#3389,c_phone_prf#3390] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#3400]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3402 AS o_shippriority_prf_3#3412, rid#3403 AS rid_3#3413, o_orderdate_prf#3404 AS o_orderdate_prf_3#3414, o_custkey_prf#3405 AS o_custkey_prf_3#3415, o_orderpriority_prf#3406 AS o_orderpriority_prf_3#3416, o_clerk_prf#3407 AS o_clerk_prf_3#3417, o_orderstatus_prf#3408 AS o_orderstatus_prf_3#3418, o_totalprice_prf#3409 AS o_totalprice_prf_3#3419, o_orderkey_prf#3410 AS o_orderkey_prf_3#3420, o_comment_prf#3411 AS o_comment_prf_3#3421]
               +- Relation[o_shippriority_prf#3402,rid#3403,o_orderdate_prf#3404,o_custkey_prf#3405,o_orderpriority_prf#3406,o_clerk_prf#3407,o_orderstatus_prf#3408,o_totalprice_prf#3409,o_orderkey_prf#3410,o_comment_prf#3411] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 173066ms

fq1c=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 02:46:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:46:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3510L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [c_nationkey#293L, o_orderkey#342L]
               :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :     :- Project [c_custkey#290L, c_nationkey#293L]
               :     :  +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
               :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               :     +- Project [o_orderkey#342L, o_custkey#343L]
               :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 02:46:57 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:46:57 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:46:57 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:46:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3510L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#3523]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#3517: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [rid#3512 AS rid_0#3517, n_regionkey_prf#3513 AS n_regionkey_prf_0#3518, n_nationkey_prf#3514 AS n_nationkey_prf_0#3519, n_name_prf#3515 AS n_name_prf_0#3520, n_comment_prf#3516 AS n_comment_prf_0#3521]
         :     :  :  +- Relation[rid#3512,n_regionkey_prf#3513,n_nationkey_prf#3514,n_name_prf#3515,n_comment_prf#3516] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3522]
         :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :        +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join NaturalJoin(Inner)
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- Project [c_acctbal_prf#3524 AS c_acctbal_prf_1#3533, rid#3525 AS rid_1#3534, c_name_prf#3526 AS c_name_prf_1#3535, c_nationkey_prf#3527 AS c_nationkey_prf_1#3536, c_custkey_prf#3528 AS c_custkey_prf_1#3537, c_comment_prf#3529 AS c_comment_prf_1#3538, c_address_prf#3530 AS c_address_prf_1#3539, c_mktsegment_prf#3531 AS c_mktsegment_prf_1#3540, c_phone_prf#3532 AS c_phone_prf_1#3541]
            :  :  :  :  +- Relation[c_acctbal_prf#3524,rid#3525,c_name_prf#3526,c_nationkey_prf#3527,c_custkey_prf#3528,c_comment_prf#3529,c_address_prf#3530,c_mktsegment_prf#3531,c_phone_prf#3532] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#3552]
            :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
            :  :  :        :- 'Project ['rid AS rid_1#3551]
            :  :  :        :  +- Relation[c_acctbal_prf#3542,rid#3543,c_name_prf#3544,c_nationkey_prf#3545,c_custkey_prf#3546,c_comment_prf#3547,c_address_prf#3548,c_mktsegment_prf#3549,c_phone_prf#3550] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
            :  :  +- Project [o_shippriority_prf#3553 AS o_shippriority_prf_2#3563, rid#3554 AS rid_2#3564, o_orderdate_prf#3555 AS o_orderdate_prf_2#3565, o_custkey_prf#3556 AS o_custkey_prf_2#3566, o_orderpriority_prf#3557 AS o_orderpriority_prf_2#3567, o_clerk_prf#3558 AS o_clerk_prf_2#3568, o_orderstatus_prf#3559 AS o_orderstatus_prf_2#3569, o_totalprice_prf#3560 AS o_totalprice_prf_2#3570, o_orderkey_prf#3561 AS o_orderkey_prf_2#3571, o_comment_prf#3562 AS o_comment_prf_2#3572]
            :  :     +- Relation[o_shippriority_prf#3553,rid#3554,o_orderdate_prf#3555,o_custkey_prf#3556,o_orderpriority_prf#3557,o_clerk_prf#3558,o_orderstatus_prf#3559,o_totalprice_prf#3560,o_orderkey_prf#3561,o_comment_prf#3562] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2113) AS rid_3#3584]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#3583]
            :        :  +- Relation[o_shippriority_prf#3573,rid#3574,o_orderdate_prf#3575,o_custkey_prf#3576,o_orderpriority_prf#3577,o_clerk_prf#3578,o_orderstatus_prf#3579,o_totalprice_prf#3580,o_orderkey_prf#3581,o_comment_prf#3582] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3585 AS l_returnflag_prf_3#3604, l_orderkey_and_l_linenumber_prf#3586 AS l_orderkey_and_l_linenumber_prf_3#3605, l_comment_prf#3587 AS l_comment_prf_3#3606, l_linestatus_prf#3588 AS l_linestatus_prf_3#3607, rid#3589 AS rid_3#3608, l_shipmode_prf#3590 AS l_shipmode_prf_3#3609, l_shipinstruct_prf#3591 AS l_shipinstruct_prf_3#3610, l_quantity_prf#3592 AS l_quantity_prf_3#3611, l_receiptdate_prf#3593 AS l_receiptdate_prf_3#3612, l_linenumber_prf#3594 AS l_linenumber_prf_3#3613, l_tax_prf#3595 AS l_tax_prf_3#3614, l_shipdate_prf#3596 AS l_shipdate_prf_3#3615, l_extendedprice_prf#3597 AS l_extendedprice_prf_3#3616, l_partkey_prf#3598 AS l_partkey_prf_3#3617, l_discount_prf#3599 AS l_discount_prf_3#3618, l_partkey_and_l_suppkey_prf#3600 AS l_partkey_and_l_suppkey_prf_3#3619, l_commitdate_prf#3601 AS l_commitdate_prf_3#3620, l_suppkey_prf#3602 AS l_suppkey_prf_3#3621, l_orderkey_prf#3603 AS l_orderkey_prf_3#3622]
               +- Relation[l_returnflag_prf#3585,l_orderkey_and_l_linenumber_prf#3586,l_comment_prf#3587,l_linestatus_prf#3588,rid#3589,l_shipmode_prf#3590,l_shipinstruct_prf#3591,l_quantity_prf#3592,l_receiptdate_prf#3593,l_linenumber_prf#3594,l_tax_prf#3595,l_shipdate_prf#3596,l_extendedprice_prf#3597,l_partkey_prf#3598,l_discount_prf#3599,l_partkey_and_l_suppkey_prf#3600,l_commitdate_prf#3601,l_suppkey_prf#3602,l_orderkey_prf#3603] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 163572ms

fs1b=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/17 02:49:41 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:49:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3711L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L, l_partkey#307L]
               :  +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L]
                  +- Join Inner, (c_custkey#290L = o_custkey#343L)
                     :- Project [c_custkey#290L]
                     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
                     +- Project [o_orderkey#342L, o_custkey#343L]
                        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 02:49:41 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:49:41 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:49:41 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:49:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3711L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [p_comment_prf#3713 AS p_comment_prf_0#3723, p_name_prf#3714 AS p_name_prf_0#3724, rid#3715 AS rid_0#3725, p_type_prf#3716 AS p_type_prf_0#3726, p_retailprice_prf#3717 AS p_retailprice_prf_0#3727, p_mfgr_prf#3718 AS p_mfgr_prf_0#3728, p_container_prf#3719 AS p_container_prf_0#3729, p_brand_prf#3720 AS p_brand_prf_0#3730, p_size_prf#3721 AS p_size_prf_0#3731, p_partkey_prf#3722 AS p_partkey_prf_0#3732]
         :  :  +- Relation[p_comment_prf#3713,p_name_prf#3714,rid#3715,p_type_prf#3716,p_retailprice_prf#3717,p_mfgr_prf#3718,p_container_prf#3719,p_brand_prf#3720,p_size_prf#3721,p_partkey_prf#3722] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#3744]
         :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3743]
         :        :  +- Relation[p_comment_prf#3733,p_name_prf#3734,rid#3735,p_type_prf#3736,p_retailprice_prf#3737,p_mfgr_prf#3738,p_container_prf#3739,p_brand_prf#3740,p_size_prf#3741,p_partkey_prf#3742] JDBCRelation(part_prf) [numPartitions=1]
         :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [l_returnflag_prf#3745 AS l_returnflag_prf_1#3764, l_orderkey_and_l_linenumber_prf#3746 AS l_orderkey_and_l_linenumber_prf_1#3765, l_comment_prf#3747 AS l_comment_prf_1#3766, l_linestatus_prf#3748 AS l_linestatus_prf_1#3767, rid#3749 AS rid_1#3768, l_shipmode_prf#3750 AS l_shipmode_prf_1#3769, l_shipinstruct_prf#3751 AS l_shipinstruct_prf_1#3770, l_quantity_prf#3752 AS l_quantity_prf_1#3771, l_receiptdate_prf#3753 AS l_receiptdate_prf_1#3772, l_linenumber_prf#3754 AS l_linenumber_prf_1#3773, l_tax_prf#3755 AS l_tax_prf_1#3774, l_shipdate_prf#3756 AS l_shipdate_prf_1#3775, l_extendedprice_prf#3757 AS l_extendedprice_prf_1#3776, l_partkey_prf#3758 AS l_partkey_prf_1#3777, l_discount_prf#3759 AS l_discount_prf_1#3778, l_partkey_and_l_suppkey_prf#3760 AS l_partkey_and_l_suppkey_prf_1#3779, l_commitdate_prf#3761 AS l_commitdate_prf_1#3780, l_suppkey_prf#3762 AS l_suppkey_prf_1#3781, l_orderkey_prf#3763 AS l_orderkey_prf_1#3782]
            :  :  +- Relation[l_returnflag_prf#3745,l_orderkey_and_l_linenumber_prf#3746,l_comment_prf#3747,l_linestatus_prf#3748,rid#3749,l_shipmode_prf#3750,l_shipinstruct_prf#3751,l_quantity_prf#3752,l_receiptdate_prf#3753,l_linenumber_prf#3754,l_tax_prf#3755,l_shipdate_prf#3756,l_extendedprice_prf#3757,l_partkey_prf#3758,l_discount_prf#3759,l_partkey_and_l_suppkey_prf#3760,l_commitdate_prf#3761,l_suppkey_prf#3762,l_orderkey_prf#3763] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2113) AS rid_3#3803]
            :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#3802]
            :        :  +- Relation[l_returnflag_prf#3783,l_orderkey_and_l_linenumber_prf#3784,l_comment_prf#3785,l_linestatus_prf#3786,rid#3787,l_shipmode_prf#3788,l_shipinstruct_prf#3789,l_quantity_prf#3790,l_receiptdate_prf#3791,l_linenumber_prf#3792,l_tax_prf#3793,l_shipdate_prf#3794,l_extendedprice_prf#3795,l_partkey_prf#3796,l_discount_prf#3797,l_partkey_and_l_suppkey_prf#3798,l_commitdate_prf#3799,l_suppkey_prf#3800,l_orderkey_prf#3801] JDBCRelation(lineitem_prf) [numPartitions=1]
            :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join NaturalJoin(Inner)
               :- 'Project ['c_acctbal_prf_2, 'rid_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2113) AS rid_3#3823]
               :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_2#3814: string
               :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :     :  :- Project [c_acctbal_prf#3804 AS c_acctbal_prf_2#3813, rid#3805 AS rid_2#3814, c_name_prf#3806 AS c_name_prf_2#3815, c_nationkey_prf#3807 AS c_nationkey_prf_2#3816, c_custkey_prf#3808 AS c_custkey_prf_2#3817, c_comment_prf#3809 AS c_comment_prf_2#3818, c_address_prf#3810 AS c_address_prf_2#3819, c_mktsegment_prf#3811 AS c_mktsegment_prf_2#3820, c_phone_prf#3812 AS c_phone_prf_2#3821]
               :     :  :  +- Relation[c_acctbal_prf#3804,rid#3805,c_name_prf#3806,c_nationkey_prf#3807,c_custkey_prf#3808,c_comment_prf#3809,c_address_prf#3810,c_mktsegment_prf#3811,c_phone_prf#3812] JDBCRelation(customer_prf) [numPartitions=1]
               :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#3822]
               :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
               :     :        +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
               :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
               +- Project [o_shippriority_prf#3824 AS o_shippriority_prf_3#3834, rid#3825 AS rid_3#3835, o_orderdate_prf#3826 AS o_orderdate_prf_3#3836, o_custkey_prf#3827 AS o_custkey_prf_3#3837, o_orderpriority_prf#3828 AS o_orderpriority_prf_3#3838, o_clerk_prf#3829 AS o_clerk_prf_3#3839, o_orderstatus_prf#3830 AS o_orderstatus_prf_3#3840, o_totalprice_prf#3831 AS o_totalprice_prf_3#3841, o_orderkey_prf#3832 AS o_orderkey_prf_3#3842, o_comment_prf#3833 AS o_comment_prf_3#3843]
                  +- Relation[o_shippriority_prf#3824,rid#3825,o_orderdate_prf#3826,o_custkey_prf#3827,o_orderpriority_prf#3828,o_clerk_prf#3829,o_orderstatus_prf#3830,o_totalprice_prf#3831,o_orderkey_prf#3832,o_comment_prf#3833] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 172813ms

ft1b=
select * from nation, supplier, customer where n_name = 'FRANCE' and n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/17 02:52:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:52:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3914L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 02:52:33 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:52:33 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:52:33 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:52:33 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:52:33 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:52:33 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:52:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3914L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#3944]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#3927]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#3921: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#3916 AS rid_0#3921, n_regionkey_prf#3917 AS n_regionkey_prf_0#3922, n_nationkey_prf#3918 AS n_nationkey_prf_0#3923, n_name_prf#3919 AS n_name_prf_0#3924, n_comment_prf#3920 AS n_comment_prf_0#3925]
         :     :  :     :  :  +- Relation[rid#3916,n_regionkey_prf#3917,n_nationkey_prf#3918,n_name_prf#3919,n_comment_prf#3920] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3926]
         :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :        +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#3928 AS s_phone_prf_1#3936, rid#3929 AS rid_1#3937, s_address_prf#3930 AS s_address_prf_1#3938, s_nationkey_prf#3931 AS s_nationkey_prf_1#3939, s_suppkey_prf#3932 AS s_suppkey_prf_1#3940, s_name_prf#3933 AS s_name_prf_1#3941, s_acctbal_prf#3934 AS s_acctbal_prf_1#3942, s_comment_prf#3935 AS s_comment_prf_1#3943]
         :     :     +- Relation[s_phone_prf#3928,rid#3929,s_address_prf#3930,s_nationkey_prf#3931,s_suppkey_prf#3932,s_name_prf#3933,s_acctbal_prf#3934,s_comment_prf#3935] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3945 AS c_acctbal_prf_2#3954, rid#3946 AS rid_2#3955, c_name_prf#3947 AS c_name_prf_2#3956, c_nationkey_prf#3948 AS c_nationkey_prf_2#3957, c_custkey_prf#3949 AS c_custkey_prf_2#3958, c_comment_prf#3950 AS c_comment_prf_2#3959, c_address_prf#3951 AS c_address_prf_2#3960, c_mktsegment_prf#3952 AS c_mktsegment_prf_2#3961, c_phone_prf#3953 AS c_phone_prf_2#3962]
            +- Relation[c_acctbal_prf#3945,rid#3946,c_name_prf#3947,c_nationkey_prf#3948,c_custkey_prf#3949,c_comment_prf#3950,c_address_prf#3951,c_mktsegment_prf#3952,c_phone_prf#3953] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 29993ms

ft2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and (p_size = 15 and s_suppkey = ps_suppkey)
19/10/17 02:53:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:53:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4009L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/17 02:53:03 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:53:03 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:53:03 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 02:53:03 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:53:03 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 02:53:03 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 02:53:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4009L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#4011 AS s_phone_prf_0#4019, rid#4012 AS rid_0#4020, s_address_prf#4013 AS s_address_prf_0#4021, s_nationkey_prf#4014 AS s_nationkey_prf_0#4022, s_suppkey_prf#4015 AS s_suppkey_prf_0#4023, s_name_prf#4016 AS s_name_prf_0#4024, s_acctbal_prf#4017 AS s_acctbal_prf_0#4025, s_comment_prf#4018 AS s_comment_prf_0#4026]
         :  :  +- Relation[s_phone_prf#4011,rid#4012,s_address_prf#4013,s_nationkey_prf#4014,s_suppkey_prf#4015,s_name_prf#4016,s_acctbal_prf#4017,s_comment_prf#4018] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2113) AS rid_2#4036]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4035]
         :        :  +- Relation[s_phone_prf#4027,rid#4028,s_address_prf#4029,s_nationkey_prf#4030,s_suppkey_prf#4031,s_name_prf#4032,s_acctbal_prf#4033,s_comment_prf#4034] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#4058]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#4049: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#4037 AS p_comment_prf_1#4047, p_name_prf#4038 AS p_name_prf_1#4048, rid#4039 AS rid_1#4049, p_type_prf#4040 AS p_type_prf_1#4050, p_retailprice_prf#4041 AS p_retailprice_prf_1#4051, p_mfgr_prf#4042 AS p_mfgr_prf_1#4052, p_container_prf#4043 AS p_container_prf_1#4053, p_brand_prf#4044 AS p_brand_prf_1#4054, p_size_prf#4045 AS p_size_prf_1#4055, p_partkey_prf#4046 AS p_partkey_prf_1#4056]
            :     :  :  +- Relation[p_comment_prf#4037,p_name_prf#4038,rid#4039,p_type_prf#4040,p_retailprice_prf#4041,p_mfgr_prf#4042,p_container_prf#4043,p_brand_prf#4044,p_size_prf#4045,p_partkey_prf#4046] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4057]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#4059 AS ps_partkey_and_ps_suppkey_prf_2#4066, rid#4060 AS rid_2#4067, ps_availqty_prf#4061 AS ps_availqty_prf_2#4068, ps_comment_prf#4062 AS ps_comment_prf_2#4069, ps_partkey_prf#4063 AS ps_partkey_prf_2#4070, ps_supplycost_prf#4064 AS ps_supplycost_prf_2#4071, ps_suppkey_prf#4065 AS ps_suppkey_prf_2#4072]
               +- Relation[ps_partkey_and_ps_suppkey_prf#4059,rid#4060,ps_availqty_prf#4061,ps_comment_prf#4062,ps_partkey_prf#4063,ps_supplycost_prf#4064,ps_suppkey_prf#4065] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 7098ms

ft3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and (p_size = 15 and s_suppkey = l_suppkey)
19/10/17 02:53:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:53:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4133L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 02:53:10 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:53:10 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:53:10 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:53:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4133L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#4135 AS s_phone_prf_0#4143, rid#4136 AS rid_0#4144, s_address_prf#4137 AS s_address_prf_0#4145, s_nationkey_prf#4138 AS s_nationkey_prf_0#4146, s_suppkey_prf#4139 AS s_suppkey_prf_0#4147, s_name_prf#4140 AS s_name_prf_0#4148, s_acctbal_prf#4141 AS s_acctbal_prf_0#4149, s_comment_prf#4142 AS s_comment_prf_0#4150]
         :  :  +- Relation[s_phone_prf#4135,rid#4136,s_address_prf#4137,s_nationkey_prf#4138,s_suppkey_prf#4139,s_name_prf#4140,s_acctbal_prf#4141,s_comment_prf#4142] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2113) AS rid_2#4160]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4159]
         :        :  +- Relation[s_phone_prf#4151,rid#4152,s_address_prf#4153,s_nationkey_prf#4154,s_suppkey_prf#4155,s_name_prf#4156,s_acctbal_prf#4157,s_comment_prf#4158] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#4182]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#4173: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#4161 AS p_comment_prf_1#4171, p_name_prf#4162 AS p_name_prf_1#4172, rid#4163 AS rid_1#4173, p_type_prf#4164 AS p_type_prf_1#4174, p_retailprice_prf#4165 AS p_retailprice_prf_1#4175, p_mfgr_prf#4166 AS p_mfgr_prf_1#4176, p_container_prf#4167 AS p_container_prf_1#4177, p_brand_prf#4168 AS p_brand_prf_1#4178, p_size_prf#4169 AS p_size_prf_1#4179, p_partkey_prf#4170 AS p_partkey_prf_1#4180]
            :     :  :  +- Relation[p_comment_prf#4161,p_name_prf#4162,rid#4163,p_type_prf#4164,p_retailprice_prf#4165,p_mfgr_prf#4166,p_container_prf#4167,p_brand_prf#4168,p_size_prf#4169,p_partkey_prf#4170] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4181]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4183 AS l_returnflag_prf_2#4202, l_orderkey_and_l_linenumber_prf#4184 AS l_orderkey_and_l_linenumber_prf_2#4203, l_comment_prf#4185 AS l_comment_prf_2#4204, l_linestatus_prf#4186 AS l_linestatus_prf_2#4205, rid#4187 AS rid_2#4206, l_shipmode_prf#4188 AS l_shipmode_prf_2#4207, l_shipinstruct_prf#4189 AS l_shipinstruct_prf_2#4208, l_quantity_prf#4190 AS l_quantity_prf_2#4209, l_receiptdate_prf#4191 AS l_receiptdate_prf_2#4210, l_linenumber_prf#4192 AS l_linenumber_prf_2#4211, l_tax_prf#4193 AS l_tax_prf_2#4212, l_shipdate_prf#4194 AS l_shipdate_prf_2#4213, l_extendedprice_prf#4195 AS l_extendedprice_prf_2#4214, l_partkey_prf#4196 AS l_partkey_prf_2#4215, l_discount_prf#4197 AS l_discount_prf_2#4216, l_partkey_and_l_suppkey_prf#4198 AS l_partkey_and_l_suppkey_prf_2#4217, l_commitdate_prf#4199 AS l_commitdate_prf_2#4218, l_suppkey_prf#4200 AS l_suppkey_prf_2#4219, l_orderkey_prf#4201 AS l_orderkey_prf_2#4220]
               +- Relation[l_returnflag_prf#4183,l_orderkey_and_l_linenumber_prf#4184,l_comment_prf#4185,l_linestatus_prf#4186,rid#4187,l_shipmode_prf#4188,l_shipinstruct_prf#4189,l_quantity_prf#4190,l_receiptdate_prf#4191,l_linenumber_prf#4192,l_tax_prf#4193,l_shipdate_prf#4194,l_extendedprice_prf#4195,l_partkey_prf#4196,l_discount_prf#4197,l_partkey_and_l_suppkey_prf#4198,l_commitdate_prf#4199,l_suppkey_prf#4200,l_orderkey_prf#4201] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 55717ms

fr1d=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/17 02:54:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:54:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4294L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 02:54:06 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:54:06 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:54:06 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:54:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4294L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#4336]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#4315]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4306: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [c_acctbal_prf#4296 AS c_acctbal_prf_0#4305, rid#4297 AS rid_0#4306, c_name_prf#4298 AS c_name_prf_0#4307, c_nationkey_prf#4299 AS c_nationkey_prf_0#4308, c_custkey_prf#4300 AS c_custkey_prf_0#4309, c_comment_prf#4301 AS c_comment_prf_0#4310, c_address_prf#4302 AS c_address_prf_0#4311, c_mktsegment_prf#4303 AS c_mktsegment_prf_0#4312, c_phone_prf#4304 AS c_phone_prf_0#4313]
         :     :  :     :  :  +- Relation[c_acctbal_prf#4296,rid#4297,c_name_prf#4298,c_nationkey_prf#4299,c_custkey_prf#4300,c_comment_prf#4301,c_address_prf#4302,c_mktsegment_prf#4303,c_phone_prf#4304] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4314]
         :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :        +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#4316 AS o_shippriority_prf_1#4326, rid#4317 AS rid_1#4327, o_orderdate_prf#4318 AS o_orderdate_prf_1#4328, o_custkey_prf#4319 AS o_custkey_prf_1#4329, o_orderpriority_prf#4320 AS o_orderpriority_prf_1#4330, o_clerk_prf#4321 AS o_clerk_prf_1#4331, o_orderstatus_prf#4322 AS o_orderstatus_prf_1#4332, o_totalprice_prf#4323 AS o_totalprice_prf_1#4333, o_orderkey_prf#4324 AS o_orderkey_prf_1#4334, o_comment_prf#4325 AS o_comment_prf_1#4335]
         :     :     +- Relation[o_shippriority_prf#4316,rid#4317,o_orderdate_prf#4318,o_custkey_prf#4319,o_orderpriority_prf#4320,o_clerk_prf#4321,o_orderstatus_prf#4322,o_totalprice_prf#4323,o_orderkey_prf#4324,o_comment_prf#4325] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4337 AS l_returnflag_prf_2#4356, l_orderkey_and_l_linenumber_prf#4338 AS l_orderkey_and_l_linenumber_prf_2#4357, l_comment_prf#4339 AS l_comment_prf_2#4358, l_linestatus_prf#4340 AS l_linestatus_prf_2#4359, rid#4341 AS rid_2#4360, l_shipmode_prf#4342 AS l_shipmode_prf_2#4361, l_shipinstruct_prf#4343 AS l_shipinstruct_prf_2#4362, l_quantity_prf#4344 AS l_quantity_prf_2#4363, l_receiptdate_prf#4345 AS l_receiptdate_prf_2#4364, l_linenumber_prf#4346 AS l_linenumber_prf_2#4365, l_tax_prf#4347 AS l_tax_prf_2#4366, l_shipdate_prf#4348 AS l_shipdate_prf_2#4367, l_extendedprice_prf#4349 AS l_extendedprice_prf_2#4368, l_partkey_prf#4350 AS l_partkey_prf_2#4369, l_discount_prf#4351 AS l_discount_prf_2#4370, l_partkey_and_l_suppkey_prf#4352 AS l_partkey_and_l_suppkey_prf_2#4371, l_commitdate_prf#4353 AS l_commitdate_prf_2#4372, l_suppkey_prf#4354 AS l_suppkey_prf_2#4373, l_orderkey_prf#4355 AS l_orderkey_prf_2#4374]
            +- Relation[l_returnflag_prf#4337,l_orderkey_and_l_linenumber_prf#4338,l_comment_prf#4339,l_linestatus_prf#4340,rid#4341,l_shipmode_prf#4342,l_shipinstruct_prf#4343,l_quantity_prf#4344,l_receiptdate_prf#4345,l_linenumber_prf#4346,l_tax_prf#4347,l_shipdate_prf#4348,l_extendedprice_prf#4349,l_partkey_prf#4350,l_discount_prf#4351,l_partkey_and_l_suppkey_prf#4352,l_commitdate_prf#4353,l_suppkey_prf#4354,l_orderkey_prf#4355] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 32853ms

fr2e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/17 02:54:39 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:54:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4449L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 02:54:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4449L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#4451 AS c_acctbal_prf_0#4460, rid#4452 AS rid_0#4461, c_name_prf#4453 AS c_name_prf_0#4462, c_nationkey_prf#4454 AS c_nationkey_prf_0#4463, c_custkey_prf#4455 AS c_custkey_prf_0#4464, c_comment_prf#4456 AS c_comment_prf_0#4465, c_address_prf#4457 AS c_address_prf_0#4466, c_mktsegment_prf#4458 AS c_mktsegment_prf_0#4467, c_phone_prf#4459 AS c_phone_prf_0#4468]
         :  :  +- Relation[c_acctbal_prf#4451,rid#4452,c_name_prf#4453,c_nationkey_prf#4454,c_custkey_prf#4455,c_comment_prf#4456,c_address_prf#4457,c_mktsegment_prf#4458,c_phone_prf#4459] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#4479]
         :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4478]
         :        :  +- Relation[c_acctbal_prf#4469,rid#4470,c_name_prf#4471,c_nationkey_prf#4472,c_custkey_prf#4473,c_comment_prf#4474,c_address_prf#4475,c_mktsegment_prf#4476,c_phone_prf#4477] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#4501]
            :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#4491: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#4480 AS o_shippriority_prf_1#4490, rid#4481 AS rid_1#4491, o_orderdate_prf#4482 AS o_orderdate_prf_1#4492, o_custkey_prf#4483 AS o_custkey_prf_1#4493, o_orderpriority_prf#4484 AS o_orderpriority_prf_1#4494, o_clerk_prf#4485 AS o_clerk_prf_1#4495, o_orderstatus_prf#4486 AS o_orderstatus_prf_1#4496, o_totalprice_prf#4487 AS o_totalprice_prf_1#4497, o_orderkey_prf#4488 AS o_orderkey_prf_1#4498, o_comment_prf#4489 AS o_comment_prf_1#4499]
            :     :  :  +- Relation[o_shippriority_prf#4480,rid#4481,o_orderdate_prf#4482,o_custkey_prf#4483,o_orderpriority_prf#4484,o_clerk_prf#4485,o_orderstatus_prf#4486,o_totalprice_prf#4487,o_orderkey_prf#4488,o_comment_prf#4489] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4500]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4502 AS l_returnflag_prf_2#4521, l_orderkey_and_l_linenumber_prf#4503 AS l_orderkey_and_l_linenumber_prf_2#4522, l_comment_prf#4504 AS l_comment_prf_2#4523, l_linestatus_prf#4505 AS l_linestatus_prf_2#4524, rid#4506 AS rid_2#4525, l_shipmode_prf#4507 AS l_shipmode_prf_2#4526, l_shipinstruct_prf#4508 AS l_shipinstruct_prf_2#4527, l_quantity_prf#4509 AS l_quantity_prf_2#4528, l_receiptdate_prf#4510 AS l_receiptdate_prf_2#4529, l_linenumber_prf#4511 AS l_linenumber_prf_2#4530, l_tax_prf#4512 AS l_tax_prf_2#4531, l_shipdate_prf#4513 AS l_shipdate_prf_2#4532, l_extendedprice_prf#4514 AS l_extendedprice_prf_2#4533, l_partkey_prf#4515 AS l_partkey_prf_2#4534, l_discount_prf#4516 AS l_discount_prf_2#4535, l_partkey_and_l_suppkey_prf#4517 AS l_partkey_and_l_suppkey_prf_2#4536, l_commitdate_prf#4518 AS l_commitdate_prf_2#4537, l_suppkey_prf#4519 AS l_suppkey_prf_2#4538, l_orderkey_prf#4520 AS l_orderkey_prf_2#4539]
               +- Relation[l_returnflag_prf#4502,l_orderkey_and_l_linenumber_prf#4503,l_comment_prf#4504,l_linestatus_prf#4505,rid#4506,l_shipmode_prf#4507,l_shipinstruct_prf#4508,l_quantity_prf#4509,l_receiptdate_prf#4510,l_linenumber_prf#4511,l_tax_prf#4512,l_shipdate_prf#4513,l_extendedprice_prf#4514,l_partkey_prf#4515,l_discount_prf#4516,l_partkey_and_l_suppkey_prf#4517,l_commitdate_prf#4518,l_suppkey_prf#4519,l_orderkey_prf#4520] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 96304ms

ft1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_name = 'FRANCE' and n_nationkey = c_nationkey
19/10/17 02:56:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:56:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4600L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 02:56:15 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:56:15 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:56:15 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:56:15 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:56:15 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:56:15 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:56:15 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:56:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4600L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#4639]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [s_phone_prf#4602 AS s_phone_prf_0#4610, rid#4603 AS rid_0#4611, s_address_prf#4604 AS s_address_prf_0#4612, s_nationkey_prf#4605 AS s_nationkey_prf_0#4613, s_suppkey_prf#4606 AS s_suppkey_prf_0#4614, s_name_prf#4607 AS s_name_prf_0#4615, s_acctbal_prf#4608 AS s_acctbal_prf_0#4616, s_comment_prf#4609 AS s_comment_prf_0#4617]
         :     :  :  :  +- Relation[s_phone_prf#4602,rid#4603,s_address_prf#4604,s_nationkey_prf#4605,s_suppkey_prf#4606,s_name_prf#4607,s_acctbal_prf#4608,s_comment_prf#4609] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#4627]
         :     :  :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#4626]
         :     :  :        :  +- Relation[s_phone_prf#4618,rid#4619,s_address_prf#4620,s_nationkey_prf#4621,s_suppkey_prf#4622,s_name_prf#4623,s_acctbal_prf#4624,s_comment_prf#4625] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [rid#4628 AS rid_1#4633, n_regionkey_prf#4629 AS n_regionkey_prf_1#4634, n_nationkey_prf#4630 AS n_nationkey_prf_1#4635, n_name_prf#4631 AS n_name_prf_1#4636, n_comment_prf#4632 AS n_comment_prf_1#4637]
         :     :     :  +- Relation[rid#4628,n_regionkey_prf#4629,n_nationkey_prf#4630,n_name_prf#4631,n_comment_prf#4632] JDBCRelation(nation_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4638]
         :     :        +- DexRidFilter nation~n_name~FRANCE
         :     :           +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4640 AS c_acctbal_prf_2#4649, rid#4641 AS rid_2#4650, c_name_prf#4642 AS c_name_prf_2#4651, c_nationkey_prf#4643 AS c_nationkey_prf_2#4652, c_custkey_prf#4644 AS c_custkey_prf_2#4653, c_comment_prf#4645 AS c_comment_prf_2#4654, c_address_prf#4646 AS c_address_prf_2#4655, c_mktsegment_prf#4647 AS c_mktsegment_prf_2#4656, c_phone_prf#4648 AS c_phone_prf_2#4657]
            +- Relation[c_acctbal_prf#4640,rid#4641,c_name_prf#4642,c_nationkey_prf#4643,c_custkey_prf#4644,c_comment_prf#4645,c_address_prf#4646,c_mktsegment_prf#4647,c_phone_prf#4648] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 47793ms

fr2b=
select * from lineitem, orders, customer where o_custkey = c_custkey and o_orderstatus = 'F' and l_orderkey = o_orderkey
19/10/17 02:57:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:57:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4716L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 02:57:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4716L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#4718 AS l_returnflag_prf_0#4737, l_orderkey_and_l_linenumber_prf#4719 AS l_orderkey_and_l_linenumber_prf_0#4738, l_comment_prf#4720 AS l_comment_prf_0#4739, l_linestatus_prf#4721 AS l_linestatus_prf_0#4740, rid#4722 AS rid_0#4741, l_shipmode_prf#4723 AS l_shipmode_prf_0#4742, l_shipinstruct_prf#4724 AS l_shipinstruct_prf_0#4743, l_quantity_prf#4725 AS l_quantity_prf_0#4744, l_receiptdate_prf#4726 AS l_receiptdate_prf_0#4745, l_linenumber_prf#4727 AS l_linenumber_prf_0#4746, l_tax_prf#4728 AS l_tax_prf_0#4747, l_shipdate_prf#4729 AS l_shipdate_prf_0#4748, l_extendedprice_prf#4730 AS l_extendedprice_prf_0#4749, l_partkey_prf#4731 AS l_partkey_prf_0#4750, l_discount_prf#4732 AS l_discount_prf_0#4751, l_partkey_and_l_suppkey_prf#4733 AS l_partkey_and_l_suppkey_prf_0#4752, l_commitdate_prf#4734 AS l_commitdate_prf_0#4753, l_suppkey_prf#4735 AS l_suppkey_prf_0#4754, l_orderkey_prf#4736 AS l_orderkey_prf_0#4755]
         :  :  +- Relation[l_returnflag_prf#4718,l_orderkey_and_l_linenumber_prf#4719,l_comment_prf#4720,l_linestatus_prf#4721,rid#4722,l_shipmode_prf#4723,l_shipinstruct_prf#4724,l_quantity_prf#4725,l_receiptdate_prf#4726,l_linenumber_prf#4727,l_tax_prf#4728,l_shipdate_prf#4729,l_extendedprice_prf#4730,l_partkey_prf#4731,l_discount_prf#4732,l_partkey_and_l_suppkey_prf#4733,l_commitdate_prf#4734,l_suppkey_prf#4735,l_orderkey_prf#4736] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#4776]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4775]
         :        :  +- Relation[l_returnflag_prf#4756,l_orderkey_and_l_linenumber_prf#4757,l_comment_prf#4758,l_linestatus_prf#4759,rid#4760,l_shipmode_prf#4761,l_shipinstruct_prf#4762,l_quantity_prf#4763,l_receiptdate_prf#4764,l_linenumber_prf#4765,l_tax_prf#4766,l_shipdate_prf#4767,l_extendedprice_prf#4768,l_partkey_prf#4769,l_discount_prf#4770,l_partkey_and_l_suppkey_prf#4771,l_commitdate_prf#4772,l_suppkey_prf#4773,l_orderkey_prf#4774] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#4798]
            :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#4788: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#4777 AS o_shippriority_prf_1#4787, rid#4778 AS rid_1#4788, o_orderdate_prf#4779 AS o_orderdate_prf_1#4789, o_custkey_prf#4780 AS o_custkey_prf_1#4790, o_orderpriority_prf#4781 AS o_orderpriority_prf_1#4791, o_clerk_prf#4782 AS o_clerk_prf_1#4792, o_orderstatus_prf#4783 AS o_orderstatus_prf_1#4793, o_totalprice_prf#4784 AS o_totalprice_prf_1#4794, o_orderkey_prf#4785 AS o_orderkey_prf_1#4795, o_comment_prf#4786 AS o_comment_prf_1#4796]
            :     :  :  +- Relation[o_shippriority_prf#4777,rid#4778,o_orderdate_prf#4779,o_custkey_prf#4780,o_orderpriority_prf#4781,o_clerk_prf#4782,o_orderstatus_prf#4783,o_totalprice_prf#4784,o_orderkey_prf#4785,o_comment_prf#4786] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4797]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4799 AS c_acctbal_prf_2#4808, rid#4800 AS rid_2#4809, c_name_prf#4801 AS c_name_prf_2#4810, c_nationkey_prf#4802 AS c_nationkey_prf_2#4811, c_custkey_prf#4803 AS c_custkey_prf_2#4812, c_comment_prf#4804 AS c_comment_prf_2#4813, c_address_prf#4805 AS c_address_prf_2#4814, c_mktsegment_prf#4806 AS c_mktsegment_prf_2#4815, c_phone_prf#4807 AS c_phone_prf_2#4816]
               +- Relation[c_acctbal_prf#4799,rid#4800,c_name_prf#4801,c_nationkey_prf#4802,c_custkey_prf#4803,c_comment_prf#4804,c_address_prf#4805,c_mktsegment_prf#4806,c_phone_prf#4807] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 105775ms

fq1f=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 02:58:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:58:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4895L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/17 02:58:49 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:58:49 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:58:49 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:58:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4895L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- Project [l_returnflag_prf#4897 AS l_returnflag_prf_0#4916, l_orderkey_and_l_linenumber_prf#4898 AS l_orderkey_and_l_linenumber_prf_0#4917, l_comment_prf#4899 AS l_comment_prf_0#4918, l_linestatus_prf#4900 AS l_linestatus_prf_0#4919, rid#4901 AS rid_0#4920, l_shipmode_prf#4902 AS l_shipmode_prf_0#4921, l_shipinstruct_prf#4903 AS l_shipinstruct_prf_0#4922, l_quantity_prf#4904 AS l_quantity_prf_0#4923, l_receiptdate_prf#4905 AS l_receiptdate_prf_0#4924, l_linenumber_prf#4906 AS l_linenumber_prf_0#4925, l_tax_prf#4907 AS l_tax_prf_0#4926, l_shipdate_prf#4908 AS l_shipdate_prf_0#4927, l_extendedprice_prf#4909 AS l_extendedprice_prf_0#4928, l_partkey_prf#4910 AS l_partkey_prf_0#4929, l_discount_prf#4911 AS l_discount_prf_0#4930, l_partkey_and_l_suppkey_prf#4912 AS l_partkey_and_l_suppkey_prf_0#4931, l_commitdate_prf#4913 AS l_commitdate_prf_0#4932, l_suppkey_prf#4914 AS l_suppkey_prf_0#4933, l_orderkey_prf#4915 AS l_orderkey_prf_0#4934]
         :  :  :  :  :  :  +- Relation[l_returnflag_prf#4897,l_orderkey_and_l_linenumber_prf#4898,l_comment_prf#4899,l_linestatus_prf#4900,rid#4901,l_shipmode_prf#4902,l_shipinstruct_prf#4903,l_quantity_prf#4904,l_receiptdate_prf#4905,l_linenumber_prf#4906,l_tax_prf#4907,l_shipdate_prf#4908,l_extendedprice_prf#4909,l_partkey_prf#4910,l_discount_prf#4911,l_partkey_and_l_suppkey_prf#4912,l_commitdate_prf#4913,l_suppkey_prf#4914,l_orderkey_prf#4915] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#4955]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :  :  :        :- 'Project ['rid AS rid_0#4954]
         :  :  :  :  :        :  +- Relation[l_returnflag_prf#4935,l_orderkey_and_l_linenumber_prf#4936,l_comment_prf#4937,l_linestatus_prf#4938,rid#4939,l_shipmode_prf#4940,l_shipinstruct_prf#4941,l_quantity_prf#4942,l_receiptdate_prf#4943,l_linenumber_prf#4944,l_tax_prf#4945,l_shipdate_prf#4946,l_extendedprice_prf#4947,l_partkey_prf#4948,l_discount_prf#4949,l_partkey_and_l_suppkey_prf#4950,l_commitdate_prf#4951,l_suppkey_prf#4952,l_orderkey_prf#4953] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [o_shippriority_prf#4956 AS o_shippriority_prf_1#4966, rid#4957 AS rid_1#4967, o_orderdate_prf#4958 AS o_orderdate_prf_1#4968, o_custkey_prf#4959 AS o_custkey_prf_1#4969, o_orderpriority_prf#4960 AS o_orderpriority_prf_1#4970, o_clerk_prf#4961 AS o_clerk_prf_1#4971, o_orderstatus_prf#4962 AS o_orderstatus_prf_1#4972, o_totalprice_prf#4963 AS o_totalprice_prf_1#4973, o_orderkey_prf#4964 AS o_orderkey_prf_1#4974, o_comment_prf#4965 AS o_comment_prf_1#4975]
         :  :  :  :     +- Relation[o_shippriority_prf#4956,rid#4957,o_orderdate_prf#4958,o_custkey_prf#4959,o_orderpriority_prf#4960,o_clerk_prf#4961,o_orderstatus_prf#4962,o_totalprice_prf#4963,o_orderkey_prf#4964,o_comment_prf#4965] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#4987]
         :  :  :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :  :  :        :- 'Project ['rid AS rid_1#4986]
         :  :  :        :  +- Relation[o_shippriority_prf#4976,rid#4977,o_orderdate_prf#4978,o_custkey_prf#4979,o_orderpriority_prf#4980,o_clerk_prf#4981,o_orderstatus_prf#4982,o_totalprice_prf#4983,o_orderkey_prf#4984,o_comment_prf#4985] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#4988 AS c_acctbal_prf_2#4997, rid#4989 AS rid_2#4998, c_name_prf#4990 AS c_name_prf_2#4999, c_nationkey_prf#4991 AS c_nationkey_prf_2#5000, c_custkey_prf#4992 AS c_custkey_prf_2#5001, c_comment_prf#4993 AS c_comment_prf_2#5002, c_address_prf#4994 AS c_address_prf_2#5003, c_mktsegment_prf#4995 AS c_mktsegment_prf_2#5004, c_phone_prf#4996 AS c_phone_prf_2#5005]
         :  :     +- Relation[c_acctbal_prf#4988,rid#4989,c_name_prf#4990,c_nationkey_prf#4991,c_custkey_prf#4992,c_comment_prf#4993,c_address_prf#4994,c_mktsegment_prf#4995,c_phone_prf#4996] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2113) AS rid_3#5016]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#5015]
         :        :  +- Relation[c_acctbal_prf#5006,rid#5007,c_name_prf#5008,c_nationkey_prf#5009,c_custkey_prf#5010,c_comment_prf#5011,c_address_prf#5012,c_mktsegment_prf#5013,c_phone_prf#5014] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_3))
            :- Project [rid#5017 AS rid_3#5022, n_regionkey_prf#5018 AS n_regionkey_prf_3#5023, n_nationkey_prf#5019 AS n_nationkey_prf_3#5024, n_name_prf#5020 AS n_name_prf_3#5025, n_comment_prf#5021 AS n_comment_prf_3#5026]
            :  +- Relation[rid#5017,n_regionkey_prf#5018,n_nationkey_prf#5019,n_name_prf#5020,n_comment_prf#5021] JDBCRelation(nation_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#5027]
               +- DexRidFilter nation~n_name~FRANCE
                  +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 168591ms

ft1d=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/17 03:01:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:01:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5093L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_nationkey#21L]
                  +- Filter isnotnull(s_nationkey#21L)
                     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 03:01:37 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:01:37 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:01:37 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:01:37 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:01:37 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:01:37 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:01:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5093L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#5095 AS c_acctbal_prf_0#5104, rid#5096 AS rid_0#5105, c_name_prf#5097 AS c_name_prf_0#5106, c_nationkey_prf#5098 AS c_nationkey_prf_0#5107, c_custkey_prf#5099 AS c_custkey_prf_0#5108, c_comment_prf#5100 AS c_comment_prf_0#5109, c_address_prf#5101 AS c_address_prf_0#5110, c_mktsegment_prf#5102 AS c_mktsegment_prf_0#5111, c_phone_prf#5103 AS c_phone_prf_0#5112]
         :  :  +- Relation[c_acctbal_prf#5095,rid#5096,c_name_prf#5097,c_nationkey_prf#5098,c_custkey_prf#5099,c_comment_prf#5100,c_address_prf#5101,c_mktsegment_prf#5102,c_phone_prf#5103] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#5123]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5122]
         :        :  +- Relation[c_acctbal_prf#5113,rid#5114,c_name_prf#5115,c_nationkey_prf#5116,c_custkey_prf#5117,c_comment_prf#5118,c_address_prf#5119,c_mktsegment_prf#5120,c_phone_prf#5121] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#5135]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_1#5129: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [rid#5124 AS rid_1#5129, n_regionkey_prf#5125 AS n_regionkey_prf_1#5130, n_nationkey_prf#5126 AS n_nationkey_prf_1#5131, n_name_prf#5127 AS n_name_prf_1#5132, n_comment_prf#5128 AS n_comment_prf_1#5133]
            :     :  :  +- Relation[rid#5124,n_regionkey_prf#5125,n_nationkey_prf#5126,n_name_prf#5127,n_comment_prf#5128] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5134]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [s_phone_prf#5136 AS s_phone_prf_2#5144, rid#5137 AS rid_2#5145, s_address_prf#5138 AS s_address_prf_2#5146, s_nationkey_prf#5139 AS s_nationkey_prf_2#5147, s_suppkey_prf#5140 AS s_suppkey_prf_2#5148, s_name_prf#5141 AS s_name_prf_2#5149, s_acctbal_prf#5142 AS s_acctbal_prf_2#5150, s_comment_prf#5143 AS s_comment_prf_2#5151]
               +- Relation[s_phone_prf#5136,rid#5137,s_address_prf#5138,s_nationkey_prf#5139,s_suppkey_prf#5140,s_name_prf#5141,s_acctbal_prf#5142,s_comment_prf#5143] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 24198ms

fr2f=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/17 03:02:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:02:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5210L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_orderkey#342L, o_custkey#343L]
         :     :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L]
         :        +- Filter isnotnull(c_custkey#290L)
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 03:02:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5210L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#5252]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#5233]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_0#5223: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [o_shippriority_prf#5212 AS o_shippriority_prf_0#5222, rid#5213 AS rid_0#5223, o_orderdate_prf#5214 AS o_orderdate_prf_0#5224, o_custkey_prf#5215 AS o_custkey_prf_0#5225, o_orderpriority_prf#5216 AS o_orderpriority_prf_0#5226, o_clerk_prf#5217 AS o_clerk_prf_0#5227, o_orderstatus_prf#5218 AS o_orderstatus_prf_0#5228, o_totalprice_prf#5219 AS o_totalprice_prf_0#5229, o_orderkey_prf#5220 AS o_orderkey_prf_0#5230, o_comment_prf#5221 AS o_comment_prf_0#5231]
         :     :  :     :  :  +- Relation[o_shippriority_prf#5212,rid#5213,o_orderdate_prf#5214,o_custkey_prf#5215,o_orderpriority_prf#5216,o_clerk_prf#5217,o_orderstatus_prf#5218,o_totalprice_prf#5219,o_orderkey_prf#5220,o_comment_prf#5221] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5232]
         :     :  :     :     +- DexRidFilter orders~o_orderstatus~F
         :     :  :     :        +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#5234 AS c_acctbal_prf_1#5243, rid#5235 AS rid_1#5244, c_name_prf#5236 AS c_name_prf_1#5245, c_nationkey_prf#5237 AS c_nationkey_prf_1#5246, c_custkey_prf#5238 AS c_custkey_prf_1#5247, c_comment_prf#5239 AS c_comment_prf_1#5248, c_address_prf#5240 AS c_address_prf_1#5249, c_mktsegment_prf#5241 AS c_mktsegment_prf_1#5250, c_phone_prf#5242 AS c_phone_prf_1#5251]
         :     :     +- Relation[c_acctbal_prf#5234,rid#5235,c_name_prf#5236,c_nationkey_prf#5237,c_custkey_prf#5238,c_comment_prf#5239,c_address_prf#5240,c_mktsegment_prf#5241,c_phone_prf#5242] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5253 AS l_returnflag_prf_2#5272, l_orderkey_and_l_linenumber_prf#5254 AS l_orderkey_and_l_linenumber_prf_2#5273, l_comment_prf#5255 AS l_comment_prf_2#5274, l_linestatus_prf#5256 AS l_linestatus_prf_2#5275, rid#5257 AS rid_2#5276, l_shipmode_prf#5258 AS l_shipmode_prf_2#5277, l_shipinstruct_prf#5259 AS l_shipinstruct_prf_2#5278, l_quantity_prf#5260 AS l_quantity_prf_2#5279, l_receiptdate_prf#5261 AS l_receiptdate_prf_2#5280, l_linenumber_prf#5262 AS l_linenumber_prf_2#5281, l_tax_prf#5263 AS l_tax_prf_2#5282, l_shipdate_prf#5264 AS l_shipdate_prf_2#5283, l_extendedprice_prf#5265 AS l_extendedprice_prf_2#5284, l_partkey_prf#5266 AS l_partkey_prf_2#5285, l_discount_prf#5267 AS l_discount_prf_2#5286, l_partkey_and_l_suppkey_prf#5268 AS l_partkey_and_l_suppkey_prf_2#5287, l_commitdate_prf#5269 AS l_commitdate_prf_2#5288, l_suppkey_prf#5270 AS l_suppkey_prf_2#5289, l_orderkey_prf#5271 AS l_orderkey_prf_2#5290]
            +- Relation[l_returnflag_prf#5253,l_orderkey_and_l_linenumber_prf#5254,l_comment_prf#5255,l_linestatus_prf#5256,rid#5257,l_shipmode_prf#5258,l_shipinstruct_prf#5259,l_quantity_prf#5260,l_receiptdate_prf#5261,l_linenumber_prf#5262,l_tax_prf#5263,l_shipdate_prf#5264,l_extendedprice_prf#5265,l_partkey_prf#5266,l_discount_prf#5267,l_partkey_and_l_suppkey_prf#5268,l_commitdate_prf#5269,l_suppkey_prf#5270,l_orderkey_prf#5271] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 83182ms

ft2b=
select * from part, partsupp, supplier where p_size = 15 and p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/17 03:03:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:03:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5353L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 03:03:25 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 03:03:25 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 03:03:25 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 03:03:25 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:03:25 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:03:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5353L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#5391]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#5376]
         :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#5367: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [p_comment_prf#5355 AS p_comment_prf_0#5365, p_name_prf#5356 AS p_name_prf_0#5366, rid#5357 AS rid_0#5367, p_type_prf#5358 AS p_type_prf_0#5368, p_retailprice_prf#5359 AS p_retailprice_prf_0#5369, p_mfgr_prf#5360 AS p_mfgr_prf_0#5370, p_container_prf#5361 AS p_container_prf_0#5371, p_brand_prf#5362 AS p_brand_prf_0#5372, p_size_prf#5363 AS p_size_prf_0#5373, p_partkey_prf#5364 AS p_partkey_prf_0#5374]
         :     :  :     :  :  +- Relation[p_comment_prf#5355,p_name_prf#5356,rid#5357,p_type_prf#5358,p_retailprice_prf#5359,p_mfgr_prf#5360,p_container_prf#5361,p_brand_prf#5362,p_size_prf#5363,p_partkey_prf#5364] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5375]
         :     :  :     :     +- DexRidFilter part~p_size~15
         :     :  :     :        +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#5377 AS ps_partkey_and_ps_suppkey_prf_1#5384, rid#5378 AS rid_1#5385, ps_availqty_prf#5379 AS ps_availqty_prf_1#5386, ps_comment_prf#5380 AS ps_comment_prf_1#5387, ps_partkey_prf#5381 AS ps_partkey_prf_1#5388, ps_supplycost_prf#5382 AS ps_supplycost_prf_1#5389, ps_suppkey_prf#5383 AS ps_suppkey_prf_1#5390]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#5377,rid#5378,ps_availqty_prf#5379,ps_comment_prf#5380,ps_partkey_prf#5381,ps_supplycost_prf#5382,ps_suppkey_prf#5383] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5392 AS s_phone_prf_2#5400, rid#5393 AS rid_2#5401, s_address_prf#5394 AS s_address_prf_2#5402, s_nationkey_prf#5395 AS s_nationkey_prf_2#5403, s_suppkey_prf#5396 AS s_suppkey_prf_2#5404, s_name_prf#5397 AS s_name_prf_2#5405, s_acctbal_prf#5398 AS s_acctbal_prf_2#5406, s_comment_prf#5399 AS s_comment_prf_2#5407]
            +- Relation[s_phone_prf#5392,rid#5393,s_address_prf#5394,s_nationkey_prf#5395,s_suppkey_prf#5396,s_name_prf#5397,s_acctbal_prf#5398,s_comment_prf#5399] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 910ms

fq1a=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 03:03:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:03:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5473L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :     :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 03:03:26 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:03:26 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:03:26 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:03:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5473L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, 'rid_2, 'o_shippriority_prf_2, 'o_orderdate_prf_2, 'o_custkey_prf_2, 'o_orderpriority_prf_2, 'o_clerk_prf_2, 'o_orderstatus_prf_2, 'o_totalprice_prf_2, 'o_orderkey_prf_2, 'o_comment_prf_2, dexdecrypt('value_dec_key, value#2113) AS rid_3#5526]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#5505]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#5486]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#5480: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [rid#5475 AS rid_0#5480, n_regionkey_prf#5476 AS n_regionkey_prf_0#5481, n_nationkey_prf#5477 AS n_nationkey_prf_0#5482, n_name_prf#5478 AS n_name_prf_0#5483, n_comment_prf#5479 AS n_comment_prf_0#5484]
         :     :  :     :  :     :  :  +- Relation[rid#5475,n_regionkey_prf#5476,n_nationkey_prf#5477,n_name_prf#5478,n_comment_prf#5479] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5485]
         :     :  :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :  :     :        +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [c_acctbal_prf#5487 AS c_acctbal_prf_1#5496, rid#5488 AS rid_1#5497, c_name_prf#5489 AS c_name_prf_1#5498, c_nationkey_prf#5490 AS c_nationkey_prf_1#5499, c_custkey_prf#5491 AS c_custkey_prf_1#5500, c_comment_prf#5492 AS c_comment_prf_1#5501, c_address_prf#5493 AS c_address_prf_1#5502, c_mktsegment_prf#5494 AS c_mktsegment_prf_1#5503, c_phone_prf#5495 AS c_phone_prf_1#5504]
         :     :  :     :     +- Relation[c_acctbal_prf#5487,rid#5488,c_name_prf#5489,c_nationkey_prf#5490,c_custkey_prf#5491,c_comment_prf#5492,c_address_prf#5493,c_mktsegment_prf#5494,c_phone_prf#5495] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#5506 AS o_shippriority_prf_2#5516, rid#5507 AS rid_2#5517, o_orderdate_prf#5508 AS o_orderdate_prf_2#5518, o_custkey_prf#5509 AS o_custkey_prf_2#5519, o_orderpriority_prf#5510 AS o_orderpriority_prf_2#5520, o_clerk_prf#5511 AS o_clerk_prf_2#5521, o_orderstatus_prf#5512 AS o_orderstatus_prf_2#5522, o_totalprice_prf#5513 AS o_totalprice_prf_2#5523, o_orderkey_prf#5514 AS o_orderkey_prf_2#5524, o_comment_prf#5515 AS o_comment_prf_2#5525]
         :     :     +- Relation[o_shippriority_prf#5506,rid#5507,o_orderdate_prf#5508,o_custkey_prf#5509,o_orderpriority_prf#5510,o_clerk_prf#5511,o_orderstatus_prf#5512,o_totalprice_prf#5513,o_orderkey_prf#5514,o_comment_prf#5515] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5527 AS l_returnflag_prf_3#5546, l_orderkey_and_l_linenumber_prf#5528 AS l_orderkey_and_l_linenumber_prf_3#5547, l_comment_prf#5529 AS l_comment_prf_3#5548, l_linestatus_prf#5530 AS l_linestatus_prf_3#5549, rid#5531 AS rid_3#5550, l_shipmode_prf#5532 AS l_shipmode_prf_3#5551, l_shipinstruct_prf#5533 AS l_shipinstruct_prf_3#5552, l_quantity_prf#5534 AS l_quantity_prf_3#5553, l_receiptdate_prf#5535 AS l_receiptdate_prf_3#5554, l_linenumber_prf#5536 AS l_linenumber_prf_3#5555, l_tax_prf#5537 AS l_tax_prf_3#5556, l_shipdate_prf#5538 AS l_shipdate_prf_3#5557, l_extendedprice_prf#5539 AS l_extendedprice_prf_3#5558, l_partkey_prf#5540 AS l_partkey_prf_3#5559, l_discount_prf#5541 AS l_discount_prf_3#5560, l_partkey_and_l_suppkey_prf#5542 AS l_partkey_and_l_suppkey_prf_3#5561, l_commitdate_prf#5543 AS l_commitdate_prf_3#5562, l_suppkey_prf#5544 AS l_suppkey_prf_3#5563, l_orderkey_prf#5545 AS l_orderkey_prf_3#5564]
            +- Relation[l_returnflag_prf#5527,l_orderkey_and_l_linenumber_prf#5528,l_comment_prf#5529,l_linestatus_prf#5530,rid#5531,l_shipmode_prf#5532,l_shipinstruct_prf#5533,l_quantity_prf#5534,l_receiptdate_prf#5535,l_linenumber_prf#5536,l_tax_prf#5537,l_shipdate_prf#5538,l_extendedprice_prf#5539,l_partkey_prf#5540,l_discount_prf#5541,l_partkey_and_l_suppkey_prf#5542,l_commitdate_prf#5543,l_suppkey_prf#5544,l_orderkey_prf#5545] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 31050ms

fr2d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderstatus = 'F' and o_orderkey = l_orderkey
19/10/17 03:03:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:03:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5644L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 03:03:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5644L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#5696]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [c_acctbal_prf#5646 AS c_acctbal_prf_0#5655, rid#5647 AS rid_0#5656, c_name_prf#5648 AS c_name_prf_0#5657, c_nationkey_prf#5649 AS c_nationkey_prf_0#5658, c_custkey_prf#5650 AS c_custkey_prf_0#5659, c_comment_prf#5651 AS c_comment_prf_0#5660, c_address_prf#5652 AS c_address_prf_0#5661, c_mktsegment_prf#5653 AS c_mktsegment_prf_0#5662, c_phone_prf#5654 AS c_phone_prf_0#5663]
         :     :  :  :  +- Relation[c_acctbal_prf#5646,rid#5647,c_name_prf#5648,c_nationkey_prf#5649,c_custkey_prf#5650,c_comment_prf#5651,c_address_prf#5652,c_mktsegment_prf#5653,c_phone_prf#5654] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#5674]
         :     :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#5673]
         :     :  :        :  +- Relation[c_acctbal_prf#5664,rid#5665,c_name_prf#5666,c_nationkey_prf#5667,c_custkey_prf#5668,c_comment_prf#5669,c_address_prf#5670,c_mktsegment_prf#5671,c_phone_prf#5672] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [o_shippriority_prf#5675 AS o_shippriority_prf_1#5685, rid#5676 AS rid_1#5686, o_orderdate_prf#5677 AS o_orderdate_prf_1#5687, o_custkey_prf#5678 AS o_custkey_prf_1#5688, o_orderpriority_prf#5679 AS o_orderpriority_prf_1#5689, o_clerk_prf#5680 AS o_clerk_prf_1#5690, o_orderstatus_prf#5681 AS o_orderstatus_prf_1#5691, o_totalprice_prf#5682 AS o_totalprice_prf_1#5692, o_orderkey_prf#5683 AS o_orderkey_prf_1#5693, o_comment_prf#5684 AS o_comment_prf_1#5694]
         :     :     :  +- Relation[o_shippriority_prf#5675,rid#5676,o_orderdate_prf#5677,o_custkey_prf#5678,o_orderpriority_prf#5679,o_clerk_prf#5680,o_orderstatus_prf#5681,o_totalprice_prf#5682,o_orderkey_prf#5683,o_comment_prf#5684] JDBCRelation(orders_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5695]
         :     :        +- DexRidFilter orders~o_orderstatus~F
         :     :           +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5697 AS l_returnflag_prf_2#5716, l_orderkey_and_l_linenumber_prf#5698 AS l_orderkey_and_l_linenumber_prf_2#5717, l_comment_prf#5699 AS l_comment_prf_2#5718, l_linestatus_prf#5700 AS l_linestatus_prf_2#5719, rid#5701 AS rid_2#5720, l_shipmode_prf#5702 AS l_shipmode_prf_2#5721, l_shipinstruct_prf#5703 AS l_shipinstruct_prf_2#5722, l_quantity_prf#5704 AS l_quantity_prf_2#5723, l_receiptdate_prf#5705 AS l_receiptdate_prf_2#5724, l_linenumber_prf#5706 AS l_linenumber_prf_2#5725, l_tax_prf#5707 AS l_tax_prf_2#5726, l_shipdate_prf#5708 AS l_shipdate_prf_2#5727, l_extendedprice_prf#5709 AS l_extendedprice_prf_2#5728, l_partkey_prf#5710 AS l_partkey_prf_2#5729, l_discount_prf#5711 AS l_discount_prf_2#5730, l_partkey_and_l_suppkey_prf#5712 AS l_partkey_and_l_suppkey_prf_2#5731, l_commitdate_prf#5713 AS l_commitdate_prf_2#5732, l_suppkey_prf#5714 AS l_suppkey_prf_2#5733, l_orderkey_prf#5715 AS l_orderkey_prf_2#5734]
            +- Relation[l_returnflag_prf#5697,l_orderkey_and_l_linenumber_prf#5698,l_comment_prf#5699,l_linestatus_prf#5700,rid#5701,l_shipmode_prf#5702,l_shipinstruct_prf#5703,l_quantity_prf#5704,l_receiptdate_prf#5705,l_linenumber_prf#5706,l_tax_prf#5707,l_shipdate_prf#5708,l_extendedprice_prf#5709,l_partkey_prf#5710,l_discount_prf#5711,l_partkey_and_l_suppkey_prf#5712,l_commitdate_prf#5713,l_suppkey_prf#5714,l_orderkey_prf#5715] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 107422ms

fr2a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_orderstatus = 'F' and o_custkey = c_custkey
19/10/17 03:05:44 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:05:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5809L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 03:05:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5809L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [l_returnflag_prf#5811 AS l_returnflag_prf_0#5830, l_orderkey_and_l_linenumber_prf#5812 AS l_orderkey_and_l_linenumber_prf_0#5831, l_comment_prf#5813 AS l_comment_prf_0#5832, l_linestatus_prf#5814 AS l_linestatus_prf_0#5833, rid#5815 AS rid_0#5834, l_shipmode_prf#5816 AS l_shipmode_prf_0#5835, l_shipinstruct_prf#5817 AS l_shipinstruct_prf_0#5836, l_quantity_prf#5818 AS l_quantity_prf_0#5837, l_receiptdate_prf#5819 AS l_receiptdate_prf_0#5838, l_linenumber_prf#5820 AS l_linenumber_prf_0#5839, l_tax_prf#5821 AS l_tax_prf_0#5840, l_shipdate_prf#5822 AS l_shipdate_prf_0#5841, l_extendedprice_prf#5823 AS l_extendedprice_prf_0#5842, l_partkey_prf#5824 AS l_partkey_prf_0#5843, l_discount_prf#5825 AS l_discount_prf_0#5844, l_partkey_and_l_suppkey_prf#5826 AS l_partkey_and_l_suppkey_prf_0#5845, l_commitdate_prf#5827 AS l_commitdate_prf_0#5846, l_suppkey_prf#5828 AS l_suppkey_prf_0#5847, l_orderkey_prf#5829 AS l_orderkey_prf_0#5848]
         :     :  :  :  +- Relation[l_returnflag_prf#5811,l_orderkey_and_l_linenumber_prf#5812,l_comment_prf#5813,l_linestatus_prf#5814,rid#5815,l_shipmode_prf#5816,l_shipinstruct_prf#5817,l_quantity_prf#5818,l_receiptdate_prf#5819,l_linenumber_prf#5820,l_tax_prf#5821,l_shipdate_prf#5822,l_extendedprice_prf#5823,l_partkey_prf#5824,l_discount_prf#5825,l_partkey_and_l_suppkey_prf#5826,l_commitdate_prf#5827,l_suppkey_prf#5828,l_orderkey_prf#5829] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#5869]
         :     :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#5868]
         :     :  :        :  +- Relation[l_returnflag_prf#5849,l_orderkey_and_l_linenumber_prf#5850,l_comment_prf#5851,l_linestatus_prf#5852,rid#5853,l_shipmode_prf#5854,l_shipinstruct_prf#5855,l_quantity_prf#5856,l_receiptdate_prf#5857,l_linenumber_prf#5858,l_tax_prf#5859,l_shipdate_prf#5860,l_extendedprice_prf#5861,l_partkey_prf#5862,l_discount_prf#5863,l_partkey_and_l_suppkey_prf#5864,l_commitdate_prf#5865,l_suppkey_prf#5866,l_orderkey_prf#5867] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [o_shippriority_prf#5870 AS o_shippriority_prf_1#5880, rid#5871 AS rid_1#5881, o_orderdate_prf#5872 AS o_orderdate_prf_1#5882, o_custkey_prf#5873 AS o_custkey_prf_1#5883, o_orderpriority_prf#5874 AS o_orderpriority_prf_1#5884, o_clerk_prf#5875 AS o_clerk_prf_1#5885, o_orderstatus_prf#5876 AS o_orderstatus_prf_1#5886, o_totalprice_prf#5877 AS o_totalprice_prf_1#5887, o_orderkey_prf#5878 AS o_orderkey_prf_1#5888, o_comment_prf#5879 AS o_comment_prf_1#5889]
         :     :     :  +- Relation[o_shippriority_prf#5870,rid#5871,o_orderdate_prf#5872,o_custkey_prf#5873,o_orderpriority_prf#5874,o_clerk_prf#5875,o_orderstatus_prf#5876,o_totalprice_prf#5877,o_orderkey_prf#5878,o_comment_prf#5879] JDBCRelation(orders_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5890]
         :     :        +- DexRidFilter orders~o_orderstatus~F
         :     :           +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#5892 AS c_acctbal_prf_2#5901, rid#5893 AS rid_2#5902, c_name_prf#5894 AS c_name_prf_2#5903, c_nationkey_prf#5895 AS c_nationkey_prf_2#5904, c_custkey_prf#5896 AS c_custkey_prf_2#5905, c_comment_prf#5897 AS c_comment_prf_2#5906, c_address_prf#5898 AS c_address_prf_2#5907, c_mktsegment_prf#5899 AS c_mktsegment_prf_2#5908, c_phone_prf#5900 AS c_phone_prf_2#5909]
            +- Relation[c_acctbal_prf#5892,rid#5893,c_name_prf#5894,c_nationkey_prf#5895,c_custkey_prf#5896,c_comment_prf#5897,c_address_prf#5898,c_mktsegment_prf#5899,c_phone_prf#5900] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 193676ms

fr1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and (c_mktsegment = 'BUILDING' and l_orderkey = o_orderkey)
19/10/17 03:08:58 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:08:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5984L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 03:08:58 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:08:58 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:08:58 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:08:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5984L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#5986 AS l_returnflag_prf_0#6005, l_orderkey_and_l_linenumber_prf#5987 AS l_orderkey_and_l_linenumber_prf_0#6006, l_comment_prf#5988 AS l_comment_prf_0#6007, l_linestatus_prf#5989 AS l_linestatus_prf_0#6008, rid#5990 AS rid_0#6009, l_shipmode_prf#5991 AS l_shipmode_prf_0#6010, l_shipinstruct_prf#5992 AS l_shipinstruct_prf_0#6011, l_quantity_prf#5993 AS l_quantity_prf_0#6012, l_receiptdate_prf#5994 AS l_receiptdate_prf_0#6013, l_linenumber_prf#5995 AS l_linenumber_prf_0#6014, l_tax_prf#5996 AS l_tax_prf_0#6015, l_shipdate_prf#5997 AS l_shipdate_prf_0#6016, l_extendedprice_prf#5998 AS l_extendedprice_prf_0#6017, l_partkey_prf#5999 AS l_partkey_prf_0#6018, l_discount_prf#6000 AS l_discount_prf_0#6019, l_partkey_and_l_suppkey_prf#6001 AS l_partkey_and_l_suppkey_prf_0#6020, l_commitdate_prf#6002 AS l_commitdate_prf_0#6021, l_suppkey_prf#6003 AS l_suppkey_prf_0#6022, l_orderkey_prf#6004 AS l_orderkey_prf_0#6023]
         :  :  +- Relation[l_returnflag_prf#5986,l_orderkey_and_l_linenumber_prf#5987,l_comment_prf#5988,l_linestatus_prf#5989,rid#5990,l_shipmode_prf#5991,l_shipinstruct_prf#5992,l_quantity_prf#5993,l_receiptdate_prf#5994,l_linenumber_prf#5995,l_tax_prf#5996,l_shipdate_prf#5997,l_extendedprice_prf#5998,l_partkey_prf#5999,l_discount_prf#6000,l_partkey_and_l_suppkey_prf#6001,l_commitdate_prf#6002,l_suppkey_prf#6003,l_orderkey_prf#6004] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2113) AS rid_2#6044]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#6043]
         :        :  +- Relation[l_returnflag_prf#6024,l_orderkey_and_l_linenumber_prf#6025,l_comment_prf#6026,l_linestatus_prf#6027,rid#6028,l_shipmode_prf#6029,l_shipinstruct_prf#6030,l_quantity_prf#6031,l_receiptdate_prf#6032,l_linenumber_prf#6033,l_tax_prf#6034,l_shipdate_prf#6035,l_extendedprice_prf#6036,l_partkey_prf#6037,l_discount_prf#6038,l_partkey_and_l_suppkey_prf#6039,l_commitdate_prf#6040,l_suppkey_prf#6041,l_orderkey_prf#6042] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#6064]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#6055: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [c_acctbal_prf#6045 AS c_acctbal_prf_1#6054, rid#6046 AS rid_1#6055, c_name_prf#6047 AS c_name_prf_1#6056, c_nationkey_prf#6048 AS c_nationkey_prf_1#6057, c_custkey_prf#6049 AS c_custkey_prf_1#6058, c_comment_prf#6050 AS c_comment_prf_1#6059, c_address_prf#6051 AS c_address_prf_1#6060, c_mktsegment_prf#6052 AS c_mktsegment_prf_1#6061, c_phone_prf#6053 AS c_phone_prf_1#6062]
            :     :  :  +- Relation[c_acctbal_prf#6045,rid#6046,c_name_prf#6047,c_nationkey_prf#6048,c_custkey_prf#6049,c_comment_prf#6050,c_address_prf#6051,c_mktsegment_prf#6052,c_phone_prf#6053] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6063]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#6065 AS o_shippriority_prf_2#6075, rid#6066 AS rid_2#6076, o_orderdate_prf#6067 AS o_orderdate_prf_2#6077, o_custkey_prf#6068 AS o_custkey_prf_2#6078, o_orderpriority_prf#6069 AS o_orderpriority_prf_2#6079, o_clerk_prf#6070 AS o_clerk_prf_2#6080, o_orderstatus_prf#6071 AS o_orderstatus_prf_2#6081, o_totalprice_prf#6072 AS o_totalprice_prf_2#6082, o_orderkey_prf#6073 AS o_orderkey_prf_2#6083, o_comment_prf#6074 AS o_comment_prf_2#6084]
               +- Relation[o_shippriority_prf#6065,rid#6066,o_orderdate_prf#6067,o_custkey_prf#6068,o_orderpriority_prf#6069,o_clerk_prf#6070,o_orderstatus_prf#6071,o_totalprice_prf#6072,o_orderkey_prf#6073,o_comment_prf#6074] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 82981ms

fr1e=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and (o_orderkey = l_orderkey and c_custkey = o_custkey)
19/10/17 03:10:21 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:10:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6159L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 03:10:21 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:10:21 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:10:21 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 03:10:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6159L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#6180]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#6171: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [c_acctbal_prf#6161 AS c_acctbal_prf_0#6170, rid#6162 AS rid_0#6171, c_name_prf#6163 AS c_name_prf_0#6172, c_nationkey_prf#6164 AS c_nationkey_prf_0#6173, c_custkey_prf#6165 AS c_custkey_prf_0#6174, c_comment_prf#6166 AS c_comment_prf_0#6175, c_address_prf#6167 AS c_address_prf_0#6176, c_mktsegment_prf#6168 AS c_mktsegment_prf_0#6177, c_phone_prf#6169 AS c_phone_prf_0#6178]
         :     :  :  +- Relation[c_acctbal_prf#6161,rid#6162,c_name_prf#6163,c_nationkey_prf#6164,c_custkey_prf#6165,c_comment_prf#6166,c_address_prf#6167,c_mktsegment_prf#6168,c_phone_prf#6169] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#6179]
         :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :        +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [o_shippriority_prf#6181 AS o_shippriority_prf_1#6191, rid#6182 AS rid_1#6192, o_orderdate_prf#6183 AS o_orderdate_prf_1#6193, o_custkey_prf#6184 AS o_custkey_prf_1#6194, o_orderpriority_prf#6185 AS o_orderpriority_prf_1#6195, o_clerk_prf#6186 AS o_clerk_prf_1#6196, o_orderstatus_prf#6187 AS o_orderstatus_prf_1#6197, o_totalprice_prf#6188 AS o_totalprice_prf_1#6198, o_orderkey_prf#6189 AS o_orderkey_prf_1#6199, o_comment_prf#6190 AS o_comment_prf_1#6200]
            :  :  +- Relation[o_shippriority_prf#6181,rid#6182,o_orderdate_prf#6183,o_custkey_prf#6184,o_orderpriority_prf#6185,o_clerk_prf#6186,o_orderstatus_prf#6187,o_totalprice_prf#6188,o_orderkey_prf#6189,o_comment_prf#6190] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#6212]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#6211]
            :        :  +- Relation[o_shippriority_prf#6201,rid#6202,o_orderdate_prf#6203,o_custkey_prf#6204,o_orderpriority_prf#6205,o_clerk_prf#6206,o_orderstatus_prf#6207,o_totalprice_prf#6208,o_orderkey_prf#6209,o_comment_prf#6210] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#6213 AS l_returnflag_prf_2#6232, l_orderkey_and_l_linenumber_prf#6214 AS l_orderkey_and_l_linenumber_prf_2#6233, l_comment_prf#6215 AS l_comment_prf_2#6234, l_linestatus_prf#6216 AS l_linestatus_prf_2#6235, rid#6217 AS rid_2#6236, l_shipmode_prf#6218 AS l_shipmode_prf_2#6237, l_shipinstruct_prf#6219 AS l_shipinstruct_prf_2#6238, l_quantity_prf#6220 AS l_quantity_prf_2#6239, l_receiptdate_prf#6221 AS l_receiptdate_prf_2#6240, l_linenumber_prf#6222 AS l_linenumber_prf_2#6241, l_tax_prf#6223 AS l_tax_prf_2#6242, l_shipdate_prf#6224 AS l_shipdate_prf_2#6243, l_extendedprice_prf#6225 AS l_extendedprice_prf_2#6244, l_partkey_prf#6226 AS l_partkey_prf_2#6245, l_discount_prf#6227 AS l_discount_prf_2#6246, l_partkey_and_l_suppkey_prf#6228 AS l_partkey_and_l_suppkey_prf_2#6247, l_commitdate_prf#6229 AS l_commitdate_prf_2#6248, l_suppkey_prf#6230 AS l_suppkey_prf_2#6249, l_orderkey_prf#6231 AS l_orderkey_prf_2#6250]
               +- Relation[l_returnflag_prf#6213,l_orderkey_and_l_linenumber_prf#6214,l_comment_prf#6215,l_linestatus_prf#6216,rid#6217,l_shipmode_prf#6218,l_shipinstruct_prf#6219,l_quantity_prf#6220,l_receiptdate_prf#6221,l_linenumber_prf#6222,l_tax_prf#6223,l_shipdate_prf#6224,l_extendedprice_prf#6225,l_partkey_prf#6226,l_discount_prf#6227,l_partkey_and_l_suppkey_prf#6228,l_commitdate_prf#6229,l_suppkey_prf#6230,l_orderkey_prf#6231] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 152980ms

fq1d=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 03:12:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:12:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6329L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :     :- Project [n_nationkey#108L]
               :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
               :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 03:12:54 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:12:54 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:12:54 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 03:12:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6329L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#6331 AS l_returnflag_prf_0#6350, l_orderkey_and_l_linenumber_prf#6332 AS l_orderkey_and_l_linenumber_prf_0#6351, l_comment_prf#6333 AS l_comment_prf_0#6352, l_linestatus_prf#6334 AS l_linestatus_prf_0#6353, rid#6335 AS rid_0#6354, l_shipmode_prf#6336 AS l_shipmode_prf_0#6355, l_shipinstruct_prf#6337 AS l_shipinstruct_prf_0#6356, l_quantity_prf#6338 AS l_quantity_prf_0#6357, l_receiptdate_prf#6339 AS l_receiptdate_prf_0#6358, l_linenumber_prf#6340 AS l_linenumber_prf_0#6359, l_tax_prf#6341 AS l_tax_prf_0#6360, l_shipdate_prf#6342 AS l_shipdate_prf_0#6361, l_extendedprice_prf#6343 AS l_extendedprice_prf_0#6362, l_partkey_prf#6344 AS l_partkey_prf_0#6363, l_discount_prf#6345 AS l_discount_prf_0#6364, l_partkey_and_l_suppkey_prf#6346 AS l_partkey_and_l_suppkey_prf_0#6365, l_commitdate_prf#6347 AS l_commitdate_prf_0#6366, l_suppkey_prf#6348 AS l_suppkey_prf_0#6367, l_orderkey_prf#6349 AS l_orderkey_prf_0#6368]
         :  :  +- Relation[l_returnflag_prf#6331,l_orderkey_and_l_linenumber_prf#6332,l_comment_prf#6333,l_linestatus_prf#6334,rid#6335,l_shipmode_prf#6336,l_shipinstruct_prf#6337,l_quantity_prf#6338,l_receiptdate_prf#6339,l_linenumber_prf#6340,l_tax_prf#6341,l_shipdate_prf#6342,l_extendedprice_prf#6343,l_partkey_prf#6344,l_discount_prf#6345,l_partkey_and_l_suppkey_prf#6346,l_commitdate_prf#6347,l_suppkey_prf#6348,l_orderkey_prf#6349] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2113) AS rid_3#6389]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#6388]
         :        :  +- Relation[l_returnflag_prf#6369,l_orderkey_and_l_linenumber_prf#6370,l_comment_prf#6371,l_linestatus_prf#6372,rid#6373,l_shipmode_prf#6374,l_shipinstruct_prf#6375,l_quantity_prf#6376,l_receiptdate_prf#6377,l_linenumber_prf#6378,l_tax_prf#6379,l_shipdate_prf#6380,l_extendedprice_prf#6381,l_partkey_prf#6382,l_discount_prf#6383,l_partkey_and_l_suppkey_prf#6384,l_commitdate_prf#6385,l_suppkey_prf#6386,l_orderkey_prf#6387] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, 'rid_2, 'c_acctbal_prf_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2113) AS rid_3#6420]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_2
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2113) AS rid_2#6401]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_1#6395: string
            :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :     :  :- Project [rid#6390 AS rid_1#6395, n_regionkey_prf#6391 AS n_regionkey_prf_1#6396, n_nationkey_prf#6392 AS n_nationkey_prf_1#6397, n_name_prf#6393 AS n_name_prf_1#6398, n_comment_prf#6394 AS n_comment_prf_1#6399]
            :     :  :     :  :  +- Relation[rid#6390,n_regionkey_prf#6391,n_nationkey_prf#6392,n_name_prf#6393,n_comment_prf#6394] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6400]
            :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :  :     :        +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [c_acctbal_prf#6402 AS c_acctbal_prf_2#6411, rid#6403 AS rid_2#6412, c_name_prf#6404 AS c_name_prf_2#6413, c_nationkey_prf#6405 AS c_nationkey_prf_2#6414, c_custkey_prf#6406 AS c_custkey_prf_2#6415, c_comment_prf#6407 AS c_comment_prf_2#6416, c_address_prf#6408 AS c_address_prf_2#6417, c_mktsegment_prf#6409 AS c_mktsegment_prf_2#6418, c_phone_prf#6410 AS c_phone_prf_2#6419]
            :     :     +- Relation[c_acctbal_prf#6402,rid#6403,c_name_prf#6404,c_nationkey_prf#6405,c_custkey_prf#6406,c_comment_prf#6407,c_address_prf#6408,c_mktsegment_prf#6409,c_phone_prf#6410] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#6421 AS o_shippriority_prf_3#6431, rid#6422 AS rid_3#6432, o_orderdate_prf#6423 AS o_orderdate_prf_3#6433, o_custkey_prf#6424 AS o_custkey_prf_3#6434, o_orderpriority_prf#6425 AS o_orderpriority_prf_3#6435, o_clerk_prf#6426 AS o_clerk_prf_3#6436, o_orderstatus_prf#6427 AS o_orderstatus_prf_3#6437, o_totalprice_prf#6428 AS o_totalprice_prf_3#6438, o_orderkey_prf#6429 AS o_orderkey_prf_3#6439, o_comment_prf#6430 AS o_comment_prf_3#6440]
               +- Relation[o_shippriority_prf#6421,rid#6422,o_orderdate_prf#6423,o_custkey_prf#6424,o_orderpriority_prf#6425,o_clerk_prf#6426,o_orderstatus_prf#6427,o_totalprice_prf#6428,o_orderkey_prf#6429,o_comment_prf#6430] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 74332ms

ft3b=
select * from part, lineitem, supplier where p_size = 15 and p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/17 03:14:08 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:14:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6519L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 03:14:08 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:14:08 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:14:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6519L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#6542]
         :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#6533: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [p_comment_prf#6521 AS p_comment_prf_0#6531, p_name_prf#6522 AS p_name_prf_0#6532, rid#6523 AS rid_0#6533, p_type_prf#6524 AS p_type_prf_0#6534, p_retailprice_prf#6525 AS p_retailprice_prf_0#6535, p_mfgr_prf#6526 AS p_mfgr_prf_0#6536, p_container_prf#6527 AS p_container_prf_0#6537, p_brand_prf#6528 AS p_brand_prf_0#6538, p_size_prf#6529 AS p_size_prf_0#6539, p_partkey_prf#6530 AS p_partkey_prf_0#6540]
         :     :  :     :  :  +- Relation[p_comment_prf#6521,p_name_prf#6522,rid#6523,p_type_prf#6524,p_retailprice_prf#6525,p_mfgr_prf#6526,p_container_prf#6527,p_brand_prf#6528,p_size_prf#6529,p_partkey_prf#6530] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#6541]
         :     :  :     :     +- DexRidFilter part~p_size~15
         :     :  :     :        +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#6543 AS l_returnflag_prf_1#6562, l_orderkey_and_l_linenumber_prf#6544 AS l_orderkey_and_l_linenumber_prf_1#6563, l_comment_prf#6545 AS l_comment_prf_1#6564, l_linestatus_prf#6546 AS l_linestatus_prf_1#6565, rid#6547 AS rid_1#6566, l_shipmode_prf#6548 AS l_shipmode_prf_1#6567, l_shipinstruct_prf#6549 AS l_shipinstruct_prf_1#6568, l_quantity_prf#6550 AS l_quantity_prf_1#6569, l_receiptdate_prf#6551 AS l_receiptdate_prf_1#6570, l_linenumber_prf#6552 AS l_linenumber_prf_1#6571, l_tax_prf#6553 AS l_tax_prf_1#6572, l_shipdate_prf#6554 AS l_shipdate_prf_1#6573, l_extendedprice_prf#6555 AS l_extendedprice_prf_1#6574, l_partkey_prf#6556 AS l_partkey_prf_1#6575, l_discount_prf#6557 AS l_discount_prf_1#6576, l_partkey_and_l_suppkey_prf#6558 AS l_partkey_and_l_suppkey_prf_1#6577, l_commitdate_prf#6559 AS l_commitdate_prf_1#6578, l_suppkey_prf#6560 AS l_suppkey_prf_1#6579, l_orderkey_prf#6561 AS l_orderkey_prf_1#6580]
         :     :     +- Relation[l_returnflag_prf#6543,l_orderkey_and_l_linenumber_prf#6544,l_comment_prf#6545,l_linestatus_prf#6546,rid#6547,l_shipmode_prf#6548,l_shipinstruct_prf#6549,l_quantity_prf#6550,l_receiptdate_prf#6551,l_linenumber_prf#6552,l_tax_prf#6553,l_shipdate_prf#6554,l_extendedprice_prf#6555,l_partkey_prf#6556,l_discount_prf#6557,l_partkey_and_l_suppkey_prf#6558,l_commitdate_prf#6559,l_suppkey_prf#6560,l_orderkey_prf#6561] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#6582 AS s_phone_prf_2#6590, rid#6583 AS rid_2#6591, s_address_prf#6584 AS s_address_prf_2#6592, s_nationkey_prf#6585 AS s_nationkey_prf_2#6593, s_suppkey_prf#6586 AS s_suppkey_prf_2#6594, s_name_prf#6587 AS s_name_prf_2#6595, s_acctbal_prf#6588 AS s_acctbal_prf_2#6596, s_comment_prf#6589 AS s_comment_prf_2#6597]
            +- Relation[s_phone_prf#6582,rid#6583,s_address_prf#6584,s_nationkey_prf#6585,s_suppkey_prf#6586,s_name_prf#6587,s_acctbal_prf#6588,s_comment_prf#6589] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 6174ms

ft3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and p_size = 15 and l_suppkey = s_suppkey
19/10/17 03:14:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 03:14:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6670L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 03:14:14 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:14:14 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 03:14:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6670L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, rid_0#6695: string
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [l_returnflag_prf#6672 AS l_returnflag_prf_0#6691, l_orderkey_and_l_linenumber_prf#6673 AS l_orderkey_and_l_linenumber_prf_0#6692, l_comment_prf#6674 AS l_comment_prf_0#6693, l_linestatus_prf#6675 AS l_linestatus_prf_0#6694, rid#6676 AS rid_0#6695, l_shipmode_prf#6677 AS l_shipmode_prf_0#6696, l_shipinstruct_prf#6678 AS l_shipinstruct_prf_0#6697, l_quantity_prf#6679 AS l_quantity_prf_0#6698, l_receiptdate_prf#6680 AS l_receiptdate_prf_0#6699, l_linenumber_prf#6681 AS l_linenumber_prf_0#6700, l_tax_prf#6682 AS l_tax_prf_0#6701, l_shipdate_prf#6683 AS l_shipdate_prf_0#6702, l_extendedprice_prf#6684 AS l_extendedprice_prf_0#6703, l_partkey_prf#6685 AS l_partkey_prf_0#6704, l_discount_prf#6686 AS l_discount_prf_0#6705, l_partkey_and_l_suppkey_prf#6687 AS l_partkey_and_l_suppkey_prf_0#6706, l_commitdate_prf#6688 AS l_commitdate_prf_0#6707, l_suppkey_prf#6689 AS l_suppkey_prf_0#6708, l_orderkey_prf#6690 AS l_orderkey_prf_0#6709]
         :     :  :  :  +- Relation[l_returnflag_prf#6672,l_orderkey_and_l_linenumber_prf#6673,l_comment_prf#6674,l_linestatus_prf#6675,rid#6676,l_shipmode_prf#6677,l_shipinstruct_prf#6678,l_quantity_prf#6679,l_receiptdate_prf#6680,l_linenumber_prf#6681,l_tax_prf#6682,l_shipdate_prf#6683,l_extendedprice_prf#6684,l_partkey_prf#6685,l_discount_prf#6686,l_partkey_and_l_suppkey_prf#6687,l_commitdate_prf#6688,l_suppkey_prf#6689,l_orderkey_prf#6690] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2113) AS rid_1#6730]
         :     :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#6729]
         :     :  :        :  +- Relation[l_returnflag_prf#6710,l_orderkey_and_l_linenumber_prf#6711,l_comment_prf#6712,l_linestatus_prf#6713,rid#6714,l_shipmode_prf#6715,l_shipinstruct_prf#6716,l_quantity_prf#6717,l_receiptdate_prf#6718,l_linenumber_prf#6719,l_tax_prf#6720,l_shipdate_prf#6721,l_extendedprice_prf#6722,l_partkey_prf#6723,l_discount_prf#6724,l_partkey_and_l_suppkey_prf#6725,l_commitdate_prf#6726,l_suppkey_prf#6727,l_orderkey_prf#6728] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [p_comment_prf#6731 AS p_comment_prf_1#6741, p_name_prf#6732 AS p_name_prf_1#6742, rid#6733 AS rid_1#6743, p_type_prf#6734 AS p_type_prf_1#6744, p_retailprice_prf#6735 AS p_retailprice_prf_1#6745, p_mfgr_prf#6736 AS p_mfgr_prf_1#6746, p_container_prf#6737 AS p_container_prf_1#6747, p_brand_prf#6738 AS p_brand_prf_1#6748, p_size_prf#6739 AS p_size_prf_1#6749, p_partkey_prf#6740 AS p_partkey_prf_1#6750]
         :     :     :  +- Relation[p_comment_prf#6731,p_name_prf#6732,rid#6733,p_type_prf#6734,p_retailprice_prf#6735,p_mfgr_prf#6736,p_container_prf#6737,p_brand_prf#6738,p_size_prf#6739,p_partkey_prf#6740] JDBCRelation(part_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6751]
         :     :        +- DexRidFilter part~p_size~15
         :     :           +- Relation[label#2109,value#2110] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2112,value#2113] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#6753 AS s_phone_prf_2#6761, rid#6754 AS rid_2#6762, s_address_prf#6755 AS s_address_prf_2#6763, s_nationkey_prf#6756 AS s_nationkey_prf_2#6764, s_suppkey_prf#6757 AS s_suppkey_prf_2#6765, s_name_prf#6758 AS s_name_prf_2#6766, s_acctbal_prf#6759 AS s_acctbal_prf_2#6767, s_comment_prf#6760 AS s_comment_prf_2#6768]
            +- Relation[s_phone_prf#6753,rid#6754,s_address_prf#6755,s_nationkey_prf#6756,s_suppkey_prf#6757,s_name_prf#6758,s_acctbal_prf#6759,s_comment_prf#6760] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 96149ms
query=fq1a, count=246415, duration=31050
query=fq1b, count=246415, duration=140384
query=fq1c, count=246415, duration=163572
query=fq1d, count=246415, duration=74332
query=fq1e, count=246415, duration=165381
query=fq1f, count=246415, duration=168591
query=fr1a, count=1214743, duration=120733
query=fr1b, count=1214743, duration=121152
query=fr1c, count=1214743, duration=82981
query=fr1d, count=1214743, duration=32853
query=fr1e, count=1214743, duration=152980
query=fr2a, count=2901744, duration=193676
query=fr2b, count=2901744, duration=105775
query=fr2d, count=2901744, duration=107422
query=fr2e, count=2901744, duration=96304
query=fr2f, count=2901744, duration=83182
query=fs1a, count=1214743, duration=108264
query=fs1b, count=1214743, duration=172813
query=fs1c, count=1214743, duration=173066
query=ft1a, count=2452200, duration=47793
query=ft1b, count=2452200, duration=29993
query=ft1c, count=2452200, duration=33060
query=ft1d, count=2452200, duration=24198
query=ft2a, count=15628, duration=49473
query=ft2b, count=15628, duration=910
query=ft2c, count=15628, duration=7098
query=ft3a, count=117754, duration=96149
query=ft3b, count=117754, duration=6174
query=ft3c, count=117754, duration=55717
