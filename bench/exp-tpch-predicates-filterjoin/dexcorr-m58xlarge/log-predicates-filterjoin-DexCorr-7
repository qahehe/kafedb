19/10/17 01:03:03 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7051ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Thu Oct 17 01:03:05 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Thu Oct 17 01:03:06 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Thu Oct 17 01:03:06 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Thu Oct 17 01:03:06 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Thu Oct 17 01:03:06 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Thu Oct 17 01:03:09 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Thu Oct 17 01:03:11 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Thu Oct 17 01:03:11 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



ft1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/17 01:03:12 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:03:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2079L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/17 01:03:12 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:03:12 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:03:12 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:03:12 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:03:12 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:03:12 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:03:12 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:03:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2079L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#2081 AS c_acctbal_prf_0#2090, rid#2082 AS rid_0#2091, c_name_prf#2083 AS c_name_prf_0#2092, c_nationkey_prf#2084 AS c_nationkey_prf_0#2093, c_custkey_prf#2085 AS c_custkey_prf_0#2094, c_comment_prf#2086 AS c_comment_prf_0#2095, c_address_prf#2087 AS c_address_prf_0#2096, c_mktsegment_prf#2088 AS c_mktsegment_prf_0#2097, c_phone_prf#2089 AS c_phone_prf_0#2098]
         :  :  +- Relation[c_acctbal_prf#2081,rid#2082,c_name_prf#2083,c_nationkey_prf#2084,c_custkey_prf#2085,c_comment_prf#2086,c_address_prf#2087,c_mktsegment_prf#2088,c_phone_prf#2089] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_2#2111]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2108]
         :        :  +- Relation[c_acctbal_prf#2099,rid#2100,c_name_prf#2101,c_nationkey_prf#2102,c_custkey_prf#2103,c_comment_prf#2104,c_address_prf#2105,c_mktsegment_prf#2106,c_phone_prf#2107] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [s_phone_prf#2112 AS s_phone_prf_1#2120, rid#2113 AS rid_1#2121, s_address_prf#2114 AS s_address_prf_1#2122, s_nationkey_prf#2115 AS s_nationkey_prf_1#2123, s_suppkey_prf#2116 AS s_suppkey_prf_1#2124, s_name_prf#2117 AS s_name_prf_1#2125, s_acctbal_prf#2118 AS s_acctbal_prf_1#2126, s_comment_prf#2119 AS s_comment_prf_1#2127]
            :  :  +- Relation[s_phone_prf#2112,rid#2113,s_address_prf#2114,s_nationkey_prf#2115,s_suppkey_prf#2116,s_name_prf#2117,s_acctbal_prf#2118,s_comment_prf#2119] JDBCRelation(supplier_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#2137]
            :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#2136]
            :        :  +- Relation[s_phone_prf#2128,rid#2129,s_address_prf#2130,s_nationkey_prf#2131,s_suppkey_prf#2132,s_name_prf#2133,s_acctbal_prf#2134,s_comment_prf#2135] JDBCRelation(supplier_prf) [numPartitions=1]
            :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [rid#2138 AS rid_2#2143, n_regionkey_prf#2139 AS n_regionkey_prf_2#2144, n_nationkey_prf#2140 AS n_nationkey_prf_2#2145, n_name_prf#2141 AS n_name_prf_2#2146, n_comment_prf#2142 AS n_comment_prf_2#2147]
               :  +- Relation[rid#2138,n_regionkey_prf#2139,n_nationkey_prf#2140,n_name_prf#2141,n_comment_prf#2142] JDBCRelation(nation_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#2150]
                  +- DexRidFilter nation~n_name~FRANCE
                     +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 33595ms

ft1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_name = 'FRANCE' and n_nationkey = c_nationkey
19/10/17 01:03:46 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:03:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2195L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 01:03:46 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:03:46 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:03:46 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:03:46 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:03:46 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:03:46 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:03:46 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:03:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2195L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#2234]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [s_phone_prf#2197 AS s_phone_prf_0#2205, rid#2198 AS rid_0#2206, s_address_prf#2199 AS s_address_prf_0#2207, s_nationkey_prf#2200 AS s_nationkey_prf_0#2208, s_suppkey_prf#2201 AS s_suppkey_prf_0#2209, s_name_prf#2202 AS s_name_prf_0#2210, s_acctbal_prf#2203 AS s_acctbal_prf_0#2211, s_comment_prf#2204 AS s_comment_prf_0#2212]
         :     :  :  :  +- Relation[s_phone_prf#2197,rid#2198,s_address_prf#2199,s_nationkey_prf#2200,s_suppkey_prf#2201,s_name_prf#2202,s_acctbal_prf#2203,s_comment_prf#2204] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#2222]
         :     :  :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#2221]
         :     :  :        :  +- Relation[s_phone_prf#2213,rid#2214,s_address_prf#2215,s_nationkey_prf#2216,s_suppkey_prf#2217,s_name_prf#2218,s_acctbal_prf#2219,s_comment_prf#2220] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [rid#2223 AS rid_1#2228, n_regionkey_prf#2224 AS n_regionkey_prf_1#2229, n_nationkey_prf#2225 AS n_nationkey_prf_1#2230, n_name_prf#2226 AS n_name_prf_1#2231, n_comment_prf#2227 AS n_comment_prf_1#2232]
         :     :     :  +- Relation[rid#2223,n_regionkey_prf#2224,n_nationkey_prf#2225,n_name_prf#2226,n_comment_prf#2227] JDBCRelation(nation_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2233]
         :     :        +- DexRidFilter nation~n_name~FRANCE
         :     :           +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2235 AS c_acctbal_prf_2#2244, rid#2236 AS rid_2#2245, c_name_prf#2237 AS c_name_prf_2#2246, c_nationkey_prf#2238 AS c_nationkey_prf_2#2247, c_custkey_prf#2239 AS c_custkey_prf_2#2248, c_comment_prf#2240 AS c_comment_prf_2#2249, c_address_prf#2241 AS c_address_prf_2#2250, c_mktsegment_prf#2242 AS c_mktsegment_prf_2#2251, c_phone_prf#2243 AS c_phone_prf_2#2252]
            +- Relation[c_acctbal_prf#2235,rid#2236,c_name_prf#2237,c_nationkey_prf#2238,c_custkey_prf#2239,c_comment_prf#2240,c_address_prf#2241,c_mktsegment_prf#2242,c_phone_prf#2243] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 48209ms

ft3b=
select * from part, lineitem, supplier where p_size = 15 and p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/17 01:04:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:04:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2310L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 01:04:34 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:04:34 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:04:34 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
19/10/17 01:04:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2310L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#2333]
         :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2324: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [p_comment_prf#2312 AS p_comment_prf_0#2322, p_name_prf#2313 AS p_name_prf_0#2323, rid#2314 AS rid_0#2324, p_type_prf#2315 AS p_type_prf_0#2325, p_retailprice_prf#2316 AS p_retailprice_prf_0#2326, p_mfgr_prf#2317 AS p_mfgr_prf_0#2327, p_container_prf#2318 AS p_container_prf_0#2328, p_brand_prf#2319 AS p_brand_prf_0#2329, p_size_prf#2320 AS p_size_prf_0#2330, p_partkey_prf#2321 AS p_partkey_prf_0#2331]
         :     :  :     :  :  +- Relation[p_comment_prf#2312,p_name_prf#2313,rid#2314,p_type_prf#2315,p_retailprice_prf#2316,p_mfgr_prf#2317,p_container_prf#2318,p_brand_prf#2319,p_size_prf#2320,p_partkey_prf#2321] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2332]
         :     :  :     :     +- DexRidFilter part~p_size~15
         :     :  :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#2334 AS l_returnflag_prf_1#2353, l_orderkey_and_l_linenumber_prf#2335 AS l_orderkey_and_l_linenumber_prf_1#2354, l_comment_prf#2336 AS l_comment_prf_1#2355, l_linestatus_prf#2337 AS l_linestatus_prf_1#2356, rid#2338 AS rid_1#2357, l_shipmode_prf#2339 AS l_shipmode_prf_1#2358, l_shipinstruct_prf#2340 AS l_shipinstruct_prf_1#2359, l_quantity_prf#2341 AS l_quantity_prf_1#2360, l_receiptdate_prf#2342 AS l_receiptdate_prf_1#2361, l_linenumber_prf#2343 AS l_linenumber_prf_1#2362, l_tax_prf#2344 AS l_tax_prf_1#2363, l_shipdate_prf#2345 AS l_shipdate_prf_1#2364, l_extendedprice_prf#2346 AS l_extendedprice_prf_1#2365, l_partkey_prf#2347 AS l_partkey_prf_1#2366, l_discount_prf#2348 AS l_discount_prf_1#2367, l_partkey_and_l_suppkey_prf#2349 AS l_partkey_and_l_suppkey_prf_1#2368, l_commitdate_prf#2350 AS l_commitdate_prf_1#2369, l_suppkey_prf#2351 AS l_suppkey_prf_1#2370, l_orderkey_prf#2352 AS l_orderkey_prf_1#2371]
         :     :     +- Relation[l_returnflag_prf#2334,l_orderkey_and_l_linenumber_prf#2335,l_comment_prf#2336,l_linestatus_prf#2337,rid#2338,l_shipmode_prf#2339,l_shipinstruct_prf#2340,l_quantity_prf#2341,l_receiptdate_prf#2342,l_linenumber_prf#2343,l_tax_prf#2344,l_shipdate_prf#2345,l_extendedprice_prf#2346,l_partkey_prf#2347,l_discount_prf#2348,l_partkey_and_l_suppkey_prf#2349,l_commitdate_prf#2350,l_suppkey_prf#2351,l_orderkey_prf#2352] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2373 AS s_phone_prf_2#2381, rid#2374 AS rid_2#2382, s_address_prf#2375 AS s_address_prf_2#2383, s_nationkey_prf#2376 AS s_nationkey_prf_2#2384, s_suppkey_prf#2377 AS s_suppkey_prf_2#2385, s_name_prf#2378 AS s_name_prf_2#2386, s_acctbal_prf#2379 AS s_acctbal_prf_2#2387, s_comment_prf#2380 AS s_comment_prf_2#2388]
            +- Relation[s_phone_prf#2373,rid#2374,s_address_prf#2375,s_nationkey_prf#2376,s_suppkey_prf#2377,s_name_prf#2378,s_acctbal_prf#2379,s_comment_prf#2380] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 6183ms

fr2e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/17 01:04:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:04:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2462L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 01:04:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2462L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#2464 AS c_acctbal_prf_0#2473, rid#2465 AS rid_0#2474, c_name_prf#2466 AS c_name_prf_0#2475, c_nationkey_prf#2467 AS c_nationkey_prf_0#2476, c_custkey_prf#2468 AS c_custkey_prf_0#2477, c_comment_prf#2469 AS c_comment_prf_0#2478, c_address_prf#2470 AS c_address_prf_0#2479, c_mktsegment_prf#2471 AS c_mktsegment_prf_0#2480, c_phone_prf#2472 AS c_phone_prf_0#2481]
         :  :  +- Relation[c_acctbal_prf#2464,rid#2465,c_name_prf#2466,c_nationkey_prf#2467,c_custkey_prf#2468,c_comment_prf#2469,c_address_prf#2470,c_mktsegment_prf#2471,c_phone_prf#2472] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#2492]
         :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2491]
         :        :  +- Relation[c_acctbal_prf#2482,rid#2483,c_name_prf#2484,c_nationkey_prf#2485,c_custkey_prf#2486,c_comment_prf#2487,c_address_prf#2488,c_mktsegment_prf#2489,c_phone_prf#2490] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#2514]
            :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#2504: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#2493 AS o_shippriority_prf_1#2503, rid#2494 AS rid_1#2504, o_orderdate_prf#2495 AS o_orderdate_prf_1#2505, o_custkey_prf#2496 AS o_custkey_prf_1#2506, o_orderpriority_prf#2497 AS o_orderpriority_prf_1#2507, o_clerk_prf#2498 AS o_clerk_prf_1#2508, o_orderstatus_prf#2499 AS o_orderstatus_prf_1#2509, o_totalprice_prf#2500 AS o_totalprice_prf_1#2510, o_orderkey_prf#2501 AS o_orderkey_prf_1#2511, o_comment_prf#2502 AS o_comment_prf_1#2512]
            :     :  :  +- Relation[o_shippriority_prf#2493,rid#2494,o_orderdate_prf#2495,o_custkey_prf#2496,o_orderpriority_prf#2497,o_clerk_prf#2498,o_orderstatus_prf#2499,o_totalprice_prf#2500,o_orderkey_prf#2501,o_comment_prf#2502] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2513]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2515 AS l_returnflag_prf_2#2534, l_orderkey_and_l_linenumber_prf#2516 AS l_orderkey_and_l_linenumber_prf_2#2535, l_comment_prf#2517 AS l_comment_prf_2#2536, l_linestatus_prf#2518 AS l_linestatus_prf_2#2537, rid#2519 AS rid_2#2538, l_shipmode_prf#2520 AS l_shipmode_prf_2#2539, l_shipinstruct_prf#2521 AS l_shipinstruct_prf_2#2540, l_quantity_prf#2522 AS l_quantity_prf_2#2541, l_receiptdate_prf#2523 AS l_receiptdate_prf_2#2542, l_linenumber_prf#2524 AS l_linenumber_prf_2#2543, l_tax_prf#2525 AS l_tax_prf_2#2544, l_shipdate_prf#2526 AS l_shipdate_prf_2#2545, l_extendedprice_prf#2527 AS l_extendedprice_prf_2#2546, l_partkey_prf#2528 AS l_partkey_prf_2#2547, l_discount_prf#2529 AS l_discount_prf_2#2548, l_partkey_and_l_suppkey_prf#2530 AS l_partkey_and_l_suppkey_prf_2#2549, l_commitdate_prf#2531 AS l_commitdate_prf_2#2550, l_suppkey_prf#2532 AS l_suppkey_prf_2#2551, l_orderkey_prf#2533 AS l_orderkey_prf_2#2552]
               +- Relation[l_returnflag_prf#2515,l_orderkey_and_l_linenumber_prf#2516,l_comment_prf#2517,l_linestatus_prf#2518,rid#2519,l_shipmode_prf#2520,l_shipinstruct_prf#2521,l_quantity_prf#2522,l_receiptdate_prf#2523,l_linenumber_prf#2524,l_tax_prf#2525,l_shipdate_prf#2526,l_extendedprice_prf#2527,l_partkey_prf#2528,l_discount_prf#2529,l_partkey_and_l_suppkey_prf#2530,l_commitdate_prf#2531,l_suppkey_prf#2532,l_orderkey_prf#2533] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 96251ms

ft1b=
select * from nation, supplier, customer where n_name = 'FRANCE' and n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/17 01:06:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:06:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2613L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 01:06:16 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:06:16 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:06:16 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:06:16 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:06:16 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:06:16 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:06:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2613L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#2643]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#2626]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#2620: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#2615 AS rid_0#2620, n_regionkey_prf#2616 AS n_regionkey_prf_0#2621, n_nationkey_prf#2617 AS n_nationkey_prf_0#2622, n_name_prf#2618 AS n_name_prf_0#2623, n_comment_prf#2619 AS n_comment_prf_0#2624]
         :     :  :     :  :  +- Relation[rid#2615,n_regionkey_prf#2616,n_nationkey_prf#2617,n_name_prf#2618,n_comment_prf#2619] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2625]
         :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#2627 AS s_phone_prf_1#2635, rid#2628 AS rid_1#2636, s_address_prf#2629 AS s_address_prf_1#2637, s_nationkey_prf#2630 AS s_nationkey_prf_1#2638, s_suppkey_prf#2631 AS s_suppkey_prf_1#2639, s_name_prf#2632 AS s_name_prf_1#2640, s_acctbal_prf#2633 AS s_acctbal_prf_1#2641, s_comment_prf#2634 AS s_comment_prf_1#2642]
         :     :     +- Relation[s_phone_prf#2627,rid#2628,s_address_prf#2629,s_nationkey_prf#2630,s_suppkey_prf#2631,s_name_prf#2632,s_acctbal_prf#2633,s_comment_prf#2634] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2644 AS c_acctbal_prf_2#2653, rid#2645 AS rid_2#2654, c_name_prf#2646 AS c_name_prf_2#2655, c_nationkey_prf#2647 AS c_nationkey_prf_2#2656, c_custkey_prf#2648 AS c_custkey_prf_2#2657, c_comment_prf#2649 AS c_comment_prf_2#2658, c_address_prf#2650 AS c_address_prf_2#2659, c_mktsegment_prf#2651 AS c_mktsegment_prf_2#2660, c_phone_prf#2652 AS c_phone_prf_2#2661]
            +- Relation[c_acctbal_prf#2644,rid#2645,c_name_prf#2646,c_nationkey_prf#2647,c_custkey_prf#2648,c_comment_prf#2649,c_address_prf#2650,c_mktsegment_prf#2651,c_phone_prf#2652] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 30225ms

ft3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and p_size = 15 and l_suppkey = s_suppkey
19/10/17 01:06:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:06:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2719L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 01:06:47 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:06:47 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:06:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2719L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, rid_0#2744: string
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [l_returnflag_prf#2721 AS l_returnflag_prf_0#2740, l_orderkey_and_l_linenumber_prf#2722 AS l_orderkey_and_l_linenumber_prf_0#2741, l_comment_prf#2723 AS l_comment_prf_0#2742, l_linestatus_prf#2724 AS l_linestatus_prf_0#2743, rid#2725 AS rid_0#2744, l_shipmode_prf#2726 AS l_shipmode_prf_0#2745, l_shipinstruct_prf#2727 AS l_shipinstruct_prf_0#2746, l_quantity_prf#2728 AS l_quantity_prf_0#2747, l_receiptdate_prf#2729 AS l_receiptdate_prf_0#2748, l_linenumber_prf#2730 AS l_linenumber_prf_0#2749, l_tax_prf#2731 AS l_tax_prf_0#2750, l_shipdate_prf#2732 AS l_shipdate_prf_0#2751, l_extendedprice_prf#2733 AS l_extendedprice_prf_0#2752, l_partkey_prf#2734 AS l_partkey_prf_0#2753, l_discount_prf#2735 AS l_discount_prf_0#2754, l_partkey_and_l_suppkey_prf#2736 AS l_partkey_and_l_suppkey_prf_0#2755, l_commitdate_prf#2737 AS l_commitdate_prf_0#2756, l_suppkey_prf#2738 AS l_suppkey_prf_0#2757, l_orderkey_prf#2739 AS l_orderkey_prf_0#2758]
         :     :  :  :  +- Relation[l_returnflag_prf#2721,l_orderkey_and_l_linenumber_prf#2722,l_comment_prf#2723,l_linestatus_prf#2724,rid#2725,l_shipmode_prf#2726,l_shipinstruct_prf#2727,l_quantity_prf#2728,l_receiptdate_prf#2729,l_linenumber_prf#2730,l_tax_prf#2731,l_shipdate_prf#2732,l_extendedprice_prf#2733,l_partkey_prf#2734,l_discount_prf#2735,l_partkey_and_l_suppkey_prf#2736,l_commitdate_prf#2737,l_suppkey_prf#2738,l_orderkey_prf#2739] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#2779]
         :     :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#2778]
         :     :  :        :  +- Relation[l_returnflag_prf#2759,l_orderkey_and_l_linenumber_prf#2760,l_comment_prf#2761,l_linestatus_prf#2762,rid#2763,l_shipmode_prf#2764,l_shipinstruct_prf#2765,l_quantity_prf#2766,l_receiptdate_prf#2767,l_linenumber_prf#2768,l_tax_prf#2769,l_shipdate_prf#2770,l_extendedprice_prf#2771,l_partkey_prf#2772,l_discount_prf#2773,l_partkey_and_l_suppkey_prf#2774,l_commitdate_prf#2775,l_suppkey_prf#2776,l_orderkey_prf#2777] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [p_comment_prf#2780 AS p_comment_prf_1#2790, p_name_prf#2781 AS p_name_prf_1#2791, rid#2782 AS rid_1#2792, p_type_prf#2783 AS p_type_prf_1#2793, p_retailprice_prf#2784 AS p_retailprice_prf_1#2794, p_mfgr_prf#2785 AS p_mfgr_prf_1#2795, p_container_prf#2786 AS p_container_prf_1#2796, p_brand_prf#2787 AS p_brand_prf_1#2797, p_size_prf#2788 AS p_size_prf_1#2798, p_partkey_prf#2789 AS p_partkey_prf_1#2799]
         :     :     :  +- Relation[p_comment_prf#2780,p_name_prf#2781,rid#2782,p_type_prf#2783,p_retailprice_prf#2784,p_mfgr_prf#2785,p_container_prf#2786,p_brand_prf#2787,p_size_prf#2788,p_partkey_prf#2789] JDBCRelation(part_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2800]
         :     :        +- DexRidFilter part~p_size~15
         :     :           +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2802 AS s_phone_prf_2#2810, rid#2803 AS rid_2#2811, s_address_prf#2804 AS s_address_prf_2#2812, s_nationkey_prf#2805 AS s_nationkey_prf_2#2813, s_suppkey_prf#2806 AS s_suppkey_prf_2#2814, s_name_prf#2807 AS s_name_prf_2#2815, s_acctbal_prf#2808 AS s_acctbal_prf_2#2816, s_comment_prf#2809 AS s_comment_prf_2#2817]
            +- Relation[s_phone_prf#2802,rid#2803,s_address_prf#2804,s_nationkey_prf#2805,s_suppkey_prf#2806,s_name_prf#2807,s_acctbal_prf#2808,s_comment_prf#2809] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 96485ms

fr1d=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/17 01:08:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:08:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2891L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 01:08:23 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:08:23 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:08:23 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:08:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2891L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#2933]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#2912]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2903: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [c_acctbal_prf#2893 AS c_acctbal_prf_0#2902, rid#2894 AS rid_0#2903, c_name_prf#2895 AS c_name_prf_0#2904, c_nationkey_prf#2896 AS c_nationkey_prf_0#2905, c_custkey_prf#2897 AS c_custkey_prf_0#2906, c_comment_prf#2898 AS c_comment_prf_0#2907, c_address_prf#2899 AS c_address_prf_0#2908, c_mktsegment_prf#2900 AS c_mktsegment_prf_0#2909, c_phone_prf#2901 AS c_phone_prf_0#2910]
         :     :  :     :  :  +- Relation[c_acctbal_prf#2893,rid#2894,c_name_prf#2895,c_nationkey_prf#2896,c_custkey_prf#2897,c_comment_prf#2898,c_address_prf#2899,c_mktsegment_prf#2900,c_phone_prf#2901] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2911]
         :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#2913 AS o_shippriority_prf_1#2923, rid#2914 AS rid_1#2924, o_orderdate_prf#2915 AS o_orderdate_prf_1#2925, o_custkey_prf#2916 AS o_custkey_prf_1#2926, o_orderpriority_prf#2917 AS o_orderpriority_prf_1#2927, o_clerk_prf#2918 AS o_clerk_prf_1#2928, o_orderstatus_prf#2919 AS o_orderstatus_prf_1#2929, o_totalprice_prf#2920 AS o_totalprice_prf_1#2930, o_orderkey_prf#2921 AS o_orderkey_prf_1#2931, o_comment_prf#2922 AS o_comment_prf_1#2932]
         :     :     +- Relation[o_shippriority_prf#2913,rid#2914,o_orderdate_prf#2915,o_custkey_prf#2916,o_orderpriority_prf#2917,o_clerk_prf#2918,o_orderstatus_prf#2919,o_totalprice_prf#2920,o_orderkey_prf#2921,o_comment_prf#2922] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2934 AS l_returnflag_prf_2#2953, l_orderkey_and_l_linenumber_prf#2935 AS l_orderkey_and_l_linenumber_prf_2#2954, l_comment_prf#2936 AS l_comment_prf_2#2955, l_linestatus_prf#2937 AS l_linestatus_prf_2#2956, rid#2938 AS rid_2#2957, l_shipmode_prf#2939 AS l_shipmode_prf_2#2958, l_shipinstruct_prf#2940 AS l_shipinstruct_prf_2#2959, l_quantity_prf#2941 AS l_quantity_prf_2#2960, l_receiptdate_prf#2942 AS l_receiptdate_prf_2#2961, l_linenumber_prf#2943 AS l_linenumber_prf_2#2962, l_tax_prf#2944 AS l_tax_prf_2#2963, l_shipdate_prf#2945 AS l_shipdate_prf_2#2964, l_extendedprice_prf#2946 AS l_extendedprice_prf_2#2965, l_partkey_prf#2947 AS l_partkey_prf_2#2966, l_discount_prf#2948 AS l_discount_prf_2#2967, l_partkey_and_l_suppkey_prf#2949 AS l_partkey_and_l_suppkey_prf_2#2968, l_commitdate_prf#2950 AS l_commitdate_prf_2#2969, l_suppkey_prf#2951 AS l_suppkey_prf_2#2970, l_orderkey_prf#2952 AS l_orderkey_prf_2#2971]
            +- Relation[l_returnflag_prf#2934,l_orderkey_and_l_linenumber_prf#2935,l_comment_prf#2936,l_linestatus_prf#2937,rid#2938,l_shipmode_prf#2939,l_shipinstruct_prf#2940,l_quantity_prf#2941,l_receiptdate_prf#2942,l_linenumber_prf#2943,l_tax_prf#2944,l_shipdate_prf#2945,l_extendedprice_prf#2946,l_partkey_prf#2947,l_discount_prf#2948,l_partkey_and_l_suppkey_prf#2949,l_commitdate_prf#2950,l_suppkey_prf#2951,l_orderkey_prf#2952] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 32917ms

fs1a=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/17 01:08:56 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:08:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3055L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [c_custkey#290L]
         :     :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L]
         :        +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/17 01:08:56 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:08:56 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:08:56 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:08:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3055L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, 'rid_2, 'l_returnflag_prf_2, 'l_orderkey_and_l_linenumber_prf_2, 'l_comment_prf_2, 'l_linestatus_prf_2, ... 15 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#3097]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#3076]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3067: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [c_acctbal_prf#3057 AS c_acctbal_prf_0#3066, rid#3058 AS rid_0#3067, c_name_prf#3059 AS c_name_prf_0#3068, c_nationkey_prf#3060 AS c_nationkey_prf_0#3069, c_custkey_prf#3061 AS c_custkey_prf_0#3070, c_comment_prf#3062 AS c_comment_prf_0#3071, c_address_prf#3063 AS c_address_prf_0#3072, c_mktsegment_prf#3064 AS c_mktsegment_prf_0#3073, c_phone_prf#3065 AS c_phone_prf_0#3074]
         :     :  :     :  :     :  :  +- Relation[c_acctbal_prf#3057,rid#3058,c_name_prf#3059,c_nationkey_prf#3060,c_custkey_prf#3061,c_comment_prf#3062,c_address_prf#3063,c_mktsegment_prf#3064,c_phone_prf#3065] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3075]
         :     :  :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :  :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [o_shippriority_prf#3077 AS o_shippriority_prf_1#3087, rid#3078 AS rid_1#3088, o_orderdate_prf#3079 AS o_orderdate_prf_1#3089, o_custkey_prf#3080 AS o_custkey_prf_1#3090, o_orderpriority_prf#3081 AS o_orderpriority_prf_1#3091, o_clerk_prf#3082 AS o_clerk_prf_1#3092, o_orderstatus_prf#3083 AS o_orderstatus_prf_1#3093, o_totalprice_prf#3084 AS o_totalprice_prf_1#3094, o_orderkey_prf#3085 AS o_orderkey_prf_1#3095, o_comment_prf#3086 AS o_comment_prf_1#3096]
         :     :  :     :     +- Relation[o_shippriority_prf#3077,rid#3078,o_orderdate_prf#3079,o_custkey_prf#3080,o_orderpriority_prf#3081,o_clerk_prf#3082,o_orderstatus_prf#3083,o_totalprice_prf#3084,o_orderkey_prf#3085,o_comment_prf#3086] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#3098 AS l_returnflag_prf_2#3117, l_orderkey_and_l_linenumber_prf#3099 AS l_orderkey_and_l_linenumber_prf_2#3118, l_comment_prf#3100 AS l_comment_prf_2#3119, l_linestatus_prf#3101 AS l_linestatus_prf_2#3120, rid#3102 AS rid_2#3121, l_shipmode_prf#3103 AS l_shipmode_prf_2#3122, l_shipinstruct_prf#3104 AS l_shipinstruct_prf_2#3123, l_quantity_prf#3105 AS l_quantity_prf_2#3124, l_receiptdate_prf#3106 AS l_receiptdate_prf_2#3125, l_linenumber_prf#3107 AS l_linenumber_prf_2#3126, l_tax_prf#3108 AS l_tax_prf_2#3127, l_shipdate_prf#3109 AS l_shipdate_prf_2#3128, l_extendedprice_prf#3110 AS l_extendedprice_prf_2#3129, l_partkey_prf#3111 AS l_partkey_prf_2#3130, l_discount_prf#3112 AS l_discount_prf_2#3131, l_partkey_and_l_suppkey_prf#3113 AS l_partkey_and_l_suppkey_prf_2#3132, l_commitdate_prf#3114 AS l_commitdate_prf_2#3133, l_suppkey_prf#3115 AS l_suppkey_prf_2#3134, l_orderkey_prf#3116 AS l_orderkey_prf_2#3135]
         :     :     +- Relation[l_returnflag_prf#3098,l_orderkey_and_l_linenumber_prf#3099,l_comment_prf#3100,l_linestatus_prf#3101,rid#3102,l_shipmode_prf#3103,l_shipinstruct_prf#3104,l_quantity_prf#3105,l_receiptdate_prf#3106,l_linenumber_prf#3107,l_tax_prf#3108,l_shipdate_prf#3109,l_extendedprice_prf#3110,l_partkey_prf#3111,l_discount_prf#3112,l_partkey_and_l_suppkey_prf#3113,l_commitdate_prf#3114,l_suppkey_prf#3115,l_orderkey_prf#3116] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#3137 AS p_comment_prf_3#3147, p_name_prf#3138 AS p_name_prf_3#3148, rid#3139 AS rid_3#3149, p_type_prf#3140 AS p_type_prf_3#3150, p_retailprice_prf#3141 AS p_retailprice_prf_3#3151, p_mfgr_prf#3142 AS p_mfgr_prf_3#3152, p_container_prf#3143 AS p_container_prf_3#3153, p_brand_prf#3144 AS p_brand_prf_3#3154, p_size_prf#3145 AS p_size_prf_3#3155, p_partkey_prf#3146 AS p_partkey_prf_3#3156]
            +- Relation[p_comment_prf#3137,p_name_prf#3138,rid#3139,p_type_prf#3140,p_retailprice_prf#3141,p_mfgr_prf#3142,p_container_prf#3143,p_brand_prf#3144,p_size_prf#3145,p_partkey_prf#3146] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 108404ms

fr2f=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/17 01:10:44 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:10:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3241L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_orderkey#342L, o_custkey#343L]
         :     :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L]
         :        +- Filter isnotnull(c_custkey#290L)
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 01:10:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3241L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#3283]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#3264]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_0#3254: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [o_shippriority_prf#3243 AS o_shippriority_prf_0#3253, rid#3244 AS rid_0#3254, o_orderdate_prf#3245 AS o_orderdate_prf_0#3255, o_custkey_prf#3246 AS o_custkey_prf_0#3256, o_orderpriority_prf#3247 AS o_orderpriority_prf_0#3257, o_clerk_prf#3248 AS o_clerk_prf_0#3258, o_orderstatus_prf#3249 AS o_orderstatus_prf_0#3259, o_totalprice_prf#3250 AS o_totalprice_prf_0#3260, o_orderkey_prf#3251 AS o_orderkey_prf_0#3261, o_comment_prf#3252 AS o_comment_prf_0#3262]
         :     :  :     :  :  +- Relation[o_shippriority_prf#3243,rid#3244,o_orderdate_prf#3245,o_custkey_prf#3246,o_orderpriority_prf#3247,o_clerk_prf#3248,o_orderstatus_prf#3249,o_totalprice_prf#3250,o_orderkey_prf#3251,o_comment_prf#3252] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3263]
         :     :  :     :     +- DexRidFilter orders~o_orderstatus~F
         :     :  :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#3265 AS c_acctbal_prf_1#3274, rid#3266 AS rid_1#3275, c_name_prf#3267 AS c_name_prf_1#3276, c_nationkey_prf#3268 AS c_nationkey_prf_1#3277, c_custkey_prf#3269 AS c_custkey_prf_1#3278, c_comment_prf#3270 AS c_comment_prf_1#3279, c_address_prf#3271 AS c_address_prf_1#3280, c_mktsegment_prf#3272 AS c_mktsegment_prf_1#3281, c_phone_prf#3273 AS c_phone_prf_1#3282]
         :     :     +- Relation[c_acctbal_prf#3265,rid#3266,c_name_prf#3267,c_nationkey_prf#3268,c_custkey_prf#3269,c_comment_prf#3270,c_address_prf#3271,c_mktsegment_prf#3272,c_phone_prf#3273] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3284 AS l_returnflag_prf_2#3303, l_orderkey_and_l_linenumber_prf#3285 AS l_orderkey_and_l_linenumber_prf_2#3304, l_comment_prf#3286 AS l_comment_prf_2#3305, l_linestatus_prf#3287 AS l_linestatus_prf_2#3306, rid#3288 AS rid_2#3307, l_shipmode_prf#3289 AS l_shipmode_prf_2#3308, l_shipinstruct_prf#3290 AS l_shipinstruct_prf_2#3309, l_quantity_prf#3291 AS l_quantity_prf_2#3310, l_receiptdate_prf#3292 AS l_receiptdate_prf_2#3311, l_linenumber_prf#3293 AS l_linenumber_prf_2#3312, l_tax_prf#3294 AS l_tax_prf_2#3313, l_shipdate_prf#3295 AS l_shipdate_prf_2#3314, l_extendedprice_prf#3296 AS l_extendedprice_prf_2#3315, l_partkey_prf#3297 AS l_partkey_prf_2#3316, l_discount_prf#3298 AS l_discount_prf_2#3317, l_partkey_and_l_suppkey_prf#3299 AS l_partkey_and_l_suppkey_prf_2#3318, l_commitdate_prf#3300 AS l_commitdate_prf_2#3319, l_suppkey_prf#3301 AS l_suppkey_prf_2#3320, l_orderkey_prf#3302 AS l_orderkey_prf_2#3321]
            +- Relation[l_returnflag_prf#3284,l_orderkey_and_l_linenumber_prf#3285,l_comment_prf#3286,l_linestatus_prf#3287,rid#3288,l_shipmode_prf#3289,l_shipinstruct_prf#3290,l_quantity_prf#3291,l_receiptdate_prf#3292,l_linenumber_prf#3293,l_tax_prf#3294,l_shipdate_prf#3295,l_extendedprice_prf#3296,l_partkey_prf#3297,l_discount_prf#3298,l_partkey_and_l_suppkey_prf#3299,l_commitdate_prf#3300,l_suppkey_prf#3301,l_orderkey_prf#3302] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 83411ms

fr2a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_orderstatus = 'F' and o_custkey = c_custkey
19/10/17 01:12:08 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:12:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3396L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 01:12:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3396L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [l_returnflag_prf#3398 AS l_returnflag_prf_0#3417, l_orderkey_and_l_linenumber_prf#3399 AS l_orderkey_and_l_linenumber_prf_0#3418, l_comment_prf#3400 AS l_comment_prf_0#3419, l_linestatus_prf#3401 AS l_linestatus_prf_0#3420, rid#3402 AS rid_0#3421, l_shipmode_prf#3403 AS l_shipmode_prf_0#3422, l_shipinstruct_prf#3404 AS l_shipinstruct_prf_0#3423, l_quantity_prf#3405 AS l_quantity_prf_0#3424, l_receiptdate_prf#3406 AS l_receiptdate_prf_0#3425, l_linenumber_prf#3407 AS l_linenumber_prf_0#3426, l_tax_prf#3408 AS l_tax_prf_0#3427, l_shipdate_prf#3409 AS l_shipdate_prf_0#3428, l_extendedprice_prf#3410 AS l_extendedprice_prf_0#3429, l_partkey_prf#3411 AS l_partkey_prf_0#3430, l_discount_prf#3412 AS l_discount_prf_0#3431, l_partkey_and_l_suppkey_prf#3413 AS l_partkey_and_l_suppkey_prf_0#3432, l_commitdate_prf#3414 AS l_commitdate_prf_0#3433, l_suppkey_prf#3415 AS l_suppkey_prf_0#3434, l_orderkey_prf#3416 AS l_orderkey_prf_0#3435]
         :     :  :  :  +- Relation[l_returnflag_prf#3398,l_orderkey_and_l_linenumber_prf#3399,l_comment_prf#3400,l_linestatus_prf#3401,rid#3402,l_shipmode_prf#3403,l_shipinstruct_prf#3404,l_quantity_prf#3405,l_receiptdate_prf#3406,l_linenumber_prf#3407,l_tax_prf#3408,l_shipdate_prf#3409,l_extendedprice_prf#3410,l_partkey_prf#3411,l_discount_prf#3412,l_partkey_and_l_suppkey_prf#3413,l_commitdate_prf#3414,l_suppkey_prf#3415,l_orderkey_prf#3416] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#3456]
         :     :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#3455]
         :     :  :        :  +- Relation[l_returnflag_prf#3436,l_orderkey_and_l_linenumber_prf#3437,l_comment_prf#3438,l_linestatus_prf#3439,rid#3440,l_shipmode_prf#3441,l_shipinstruct_prf#3442,l_quantity_prf#3443,l_receiptdate_prf#3444,l_linenumber_prf#3445,l_tax_prf#3446,l_shipdate_prf#3447,l_extendedprice_prf#3448,l_partkey_prf#3449,l_discount_prf#3450,l_partkey_and_l_suppkey_prf#3451,l_commitdate_prf#3452,l_suppkey_prf#3453,l_orderkey_prf#3454] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [o_shippriority_prf#3457 AS o_shippriority_prf_1#3467, rid#3458 AS rid_1#3468, o_orderdate_prf#3459 AS o_orderdate_prf_1#3469, o_custkey_prf#3460 AS o_custkey_prf_1#3470, o_orderpriority_prf#3461 AS o_orderpriority_prf_1#3471, o_clerk_prf#3462 AS o_clerk_prf_1#3472, o_orderstatus_prf#3463 AS o_orderstatus_prf_1#3473, o_totalprice_prf#3464 AS o_totalprice_prf_1#3474, o_orderkey_prf#3465 AS o_orderkey_prf_1#3475, o_comment_prf#3466 AS o_comment_prf_1#3476]
         :     :     :  +- Relation[o_shippriority_prf#3457,rid#3458,o_orderdate_prf#3459,o_custkey_prf#3460,o_orderpriority_prf#3461,o_clerk_prf#3462,o_orderstatus_prf#3463,o_totalprice_prf#3464,o_orderkey_prf#3465,o_comment_prf#3466] JDBCRelation(orders_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3477]
         :     :        +- DexRidFilter orders~o_orderstatus~F
         :     :           +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3479 AS c_acctbal_prf_2#3488, rid#3480 AS rid_2#3489, c_name_prf#3481 AS c_name_prf_2#3490, c_nationkey_prf#3482 AS c_nationkey_prf_2#3491, c_custkey_prf#3483 AS c_custkey_prf_2#3492, c_comment_prf#3484 AS c_comment_prf_2#3493, c_address_prf#3485 AS c_address_prf_2#3494, c_mktsegment_prf#3486 AS c_mktsegment_prf_2#3495, c_phone_prf#3487 AS c_phone_prf_2#3496]
            +- Relation[c_acctbal_prf#3479,rid#3480,c_name_prf#3481,c_nationkey_prf#3482,c_custkey_prf#3483,c_comment_prf#3484,c_address_prf#3485,c_mktsegment_prf#3486,c_phone_prf#3487] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 193766ms

fq1f=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 01:15:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:15:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3575L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/17 01:15:22 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:15:22 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:15:22 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:15:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3575L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- Project [l_returnflag_prf#3577 AS l_returnflag_prf_0#3596, l_orderkey_and_l_linenumber_prf#3578 AS l_orderkey_and_l_linenumber_prf_0#3597, l_comment_prf#3579 AS l_comment_prf_0#3598, l_linestatus_prf#3580 AS l_linestatus_prf_0#3599, rid#3581 AS rid_0#3600, l_shipmode_prf#3582 AS l_shipmode_prf_0#3601, l_shipinstruct_prf#3583 AS l_shipinstruct_prf_0#3602, l_quantity_prf#3584 AS l_quantity_prf_0#3603, l_receiptdate_prf#3585 AS l_receiptdate_prf_0#3604, l_linenumber_prf#3586 AS l_linenumber_prf_0#3605, l_tax_prf#3587 AS l_tax_prf_0#3606, l_shipdate_prf#3588 AS l_shipdate_prf_0#3607, l_extendedprice_prf#3589 AS l_extendedprice_prf_0#3608, l_partkey_prf#3590 AS l_partkey_prf_0#3609, l_discount_prf#3591 AS l_discount_prf_0#3610, l_partkey_and_l_suppkey_prf#3592 AS l_partkey_and_l_suppkey_prf_0#3611, l_commitdate_prf#3593 AS l_commitdate_prf_0#3612, l_suppkey_prf#3594 AS l_suppkey_prf_0#3613, l_orderkey_prf#3595 AS l_orderkey_prf_0#3614]
         :  :  :  :  :  :  +- Relation[l_returnflag_prf#3577,l_orderkey_and_l_linenumber_prf#3578,l_comment_prf#3579,l_linestatus_prf#3580,rid#3581,l_shipmode_prf#3582,l_shipinstruct_prf#3583,l_quantity_prf#3584,l_receiptdate_prf#3585,l_linenumber_prf#3586,l_tax_prf#3587,l_shipdate_prf#3588,l_extendedprice_prf#3589,l_partkey_prf#3590,l_discount_prf#3591,l_partkey_and_l_suppkey_prf#3592,l_commitdate_prf#3593,l_suppkey_prf#3594,l_orderkey_prf#3595] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#3635]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :  :  :        :- 'Project ['rid AS rid_0#3634]
         :  :  :  :  :        :  +- Relation[l_returnflag_prf#3615,l_orderkey_and_l_linenumber_prf#3616,l_comment_prf#3617,l_linestatus_prf#3618,rid#3619,l_shipmode_prf#3620,l_shipinstruct_prf#3621,l_quantity_prf#3622,l_receiptdate_prf#3623,l_linenumber_prf#3624,l_tax_prf#3625,l_shipdate_prf#3626,l_extendedprice_prf#3627,l_partkey_prf#3628,l_discount_prf#3629,l_partkey_and_l_suppkey_prf#3630,l_commitdate_prf#3631,l_suppkey_prf#3632,l_orderkey_prf#3633] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [o_shippriority_prf#3636 AS o_shippriority_prf_1#3646, rid#3637 AS rid_1#3647, o_orderdate_prf#3638 AS o_orderdate_prf_1#3648, o_custkey_prf#3639 AS o_custkey_prf_1#3649, o_orderpriority_prf#3640 AS o_orderpriority_prf_1#3650, o_clerk_prf#3641 AS o_clerk_prf_1#3651, o_orderstatus_prf#3642 AS o_orderstatus_prf_1#3652, o_totalprice_prf#3643 AS o_totalprice_prf_1#3653, o_orderkey_prf#3644 AS o_orderkey_prf_1#3654, o_comment_prf#3645 AS o_comment_prf_1#3655]
         :  :  :  :     +- Relation[o_shippriority_prf#3636,rid#3637,o_orderdate_prf#3638,o_custkey_prf#3639,o_orderpriority_prf#3640,o_clerk_prf#3641,o_orderstatus_prf#3642,o_totalprice_prf#3643,o_orderkey_prf#3644,o_comment_prf#3645] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#3667]
         :  :  :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :  :  :        :- 'Project ['rid AS rid_1#3666]
         :  :  :        :  +- Relation[o_shippriority_prf#3656,rid#3657,o_orderdate_prf#3658,o_custkey_prf#3659,o_orderpriority_prf#3660,o_clerk_prf#3661,o_orderstatus_prf#3662,o_totalprice_prf#3663,o_orderkey_prf#3664,o_comment_prf#3665] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#3668 AS c_acctbal_prf_2#3677, rid#3669 AS rid_2#3678, c_name_prf#3670 AS c_name_prf_2#3679, c_nationkey_prf#3671 AS c_nationkey_prf_2#3680, c_custkey_prf#3672 AS c_custkey_prf_2#3681, c_comment_prf#3673 AS c_comment_prf_2#3682, c_address_prf#3674 AS c_address_prf_2#3683, c_mktsegment_prf#3675 AS c_mktsegment_prf_2#3684, c_phone_prf#3676 AS c_phone_prf_2#3685]
         :  :     +- Relation[c_acctbal_prf#3668,rid#3669,c_name_prf#3670,c_nationkey_prf#3671,c_custkey_prf#3672,c_comment_prf#3673,c_address_prf#3674,c_mktsegment_prf#3675,c_phone_prf#3676] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2110) AS rid_3#3696]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#3695]
         :        :  +- Relation[c_acctbal_prf#3686,rid#3687,c_name_prf#3688,c_nationkey_prf#3689,c_custkey_prf#3690,c_comment_prf#3691,c_address_prf#3692,c_mktsegment_prf#3693,c_phone_prf#3694] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_3))
            :- Project [rid#3697 AS rid_3#3702, n_regionkey_prf#3698 AS n_regionkey_prf_3#3703, n_nationkey_prf#3699 AS n_nationkey_prf_3#3704, n_name_prf#3700 AS n_name_prf_3#3705, n_comment_prf#3701 AS n_comment_prf_3#3706]
            :  +- Relation[rid#3697,n_regionkey_prf#3698,n_nationkey_prf#3699,n_name_prf#3700,n_comment_prf#3701] JDBCRelation(nation_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#3707]
               +- DexRidFilter nation~n_name~FRANCE
                  +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 168388ms

fq1b=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 01:18:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:18:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3791L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 01:18:10 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:18:10 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:18:10 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:18:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3791L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#3823]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#3804]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#3798: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#3793 AS rid_0#3798, n_regionkey_prf#3794 AS n_regionkey_prf_0#3799, n_nationkey_prf#3795 AS n_nationkey_prf_0#3800, n_name_prf#3796 AS n_name_prf_0#3801, n_comment_prf#3797 AS n_comment_prf_0#3802]
         :     :  :     :  :  +- Relation[rid#3793,n_regionkey_prf#3794,n_nationkey_prf#3795,n_name_prf#3796,n_comment_prf#3797] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3803]
         :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#3805 AS c_acctbal_prf_1#3814, rid#3806 AS rid_1#3815, c_name_prf#3807 AS c_name_prf_1#3816, c_nationkey_prf#3808 AS c_nationkey_prf_1#3817, c_custkey_prf#3809 AS c_custkey_prf_1#3818, c_comment_prf#3810 AS c_comment_prf_1#3819, c_address_prf#3811 AS c_address_prf_1#3820, c_mktsegment_prf#3812 AS c_mktsegment_prf_1#3821, c_phone_prf#3813 AS c_phone_prf_1#3822]
         :     :     +- Relation[c_acctbal_prf#3805,rid#3806,c_name_prf#3807,c_nationkey_prf#3808,c_custkey_prf#3809,c_comment_prf#3810,c_address_prf#3811,c_mktsegment_prf#3812,c_phone_prf#3813] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- Project [o_shippriority_prf#3824 AS o_shippriority_prf_2#3834, rid#3825 AS rid_2#3835, o_orderdate_prf#3826 AS o_orderdate_prf_2#3836, o_custkey_prf#3827 AS o_custkey_prf_2#3837, o_orderpriority_prf#3828 AS o_orderpriority_prf_2#3838, o_clerk_prf#3829 AS o_clerk_prf_2#3839, o_orderstatus_prf#3830 AS o_orderstatus_prf_2#3840, o_totalprice_prf#3831 AS o_totalprice_prf_2#3841, o_orderkey_prf#3832 AS o_orderkey_prf_2#3842, o_comment_prf#3833 AS o_comment_prf_2#3843]
            :  :  +- Relation[o_shippriority_prf#3824,rid#3825,o_orderdate_prf#3826,o_custkey_prf#3827,o_orderpriority_prf#3828,o_clerk_prf#3829,o_orderstatus_prf#3830,o_totalprice_prf#3831,o_orderkey_prf#3832,o_comment_prf#3833] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2110) AS rid_3#3855]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#3854]
            :        :  +- Relation[o_shippriority_prf#3844,rid#3845,o_orderdate_prf#3846,o_custkey_prf#3847,o_orderpriority_prf#3848,o_clerk_prf#3849,o_orderstatus_prf#3850,o_totalprice_prf#3851,o_orderkey_prf#3852,o_comment_prf#3853] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3856 AS l_returnflag_prf_3#3875, l_orderkey_and_l_linenumber_prf#3857 AS l_orderkey_and_l_linenumber_prf_3#3876, l_comment_prf#3858 AS l_comment_prf_3#3877, l_linestatus_prf#3859 AS l_linestatus_prf_3#3878, rid#3860 AS rid_3#3879, l_shipmode_prf#3861 AS l_shipmode_prf_3#3880, l_shipinstruct_prf#3862 AS l_shipinstruct_prf_3#3881, l_quantity_prf#3863 AS l_quantity_prf_3#3882, l_receiptdate_prf#3864 AS l_receiptdate_prf_3#3883, l_linenumber_prf#3865 AS l_linenumber_prf_3#3884, l_tax_prf#3866 AS l_tax_prf_3#3885, l_shipdate_prf#3867 AS l_shipdate_prf_3#3886, l_extendedprice_prf#3868 AS l_extendedprice_prf_3#3887, l_partkey_prf#3869 AS l_partkey_prf_3#3888, l_discount_prf#3870 AS l_discount_prf_3#3889, l_partkey_and_l_suppkey_prf#3871 AS l_partkey_and_l_suppkey_prf_3#3890, l_commitdate_prf#3872 AS l_commitdate_prf_3#3891, l_suppkey_prf#3873 AS l_suppkey_prf_3#3892, l_orderkey_prf#3874 AS l_orderkey_prf_3#3893]
               +- Relation[l_returnflag_prf#3856,l_orderkey_and_l_linenumber_prf#3857,l_comment_prf#3858,l_linestatus_prf#3859,rid#3860,l_shipmode_prf#3861,l_shipinstruct_prf#3862,l_quantity_prf#3863,l_receiptdate_prf#3864,l_linenumber_prf#3865,l_tax_prf#3866,l_shipdate_prf#3867,l_extendedprice_prf#3868,l_partkey_prf#3869,l_discount_prf#3870,l_partkey_and_l_suppkey_prf#3871,l_commitdate_prf#3872,l_suppkey_prf#3873,l_orderkey_prf#3874] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 140041ms

fs1c=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/17 01:20:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:20:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3982L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_orderkey#306L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 01:20:30 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:20:30 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:20:30 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:20:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3982L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [p_comment_prf#3984 AS p_comment_prf_0#3994, p_name_prf#3985 AS p_name_prf_0#3995, rid#3986 AS rid_0#3996, p_type_prf#3987 AS p_type_prf_0#3997, p_retailprice_prf#3988 AS p_retailprice_prf_0#3998, p_mfgr_prf#3989 AS p_mfgr_prf_0#3999, p_container_prf#3990 AS p_container_prf_0#4000, p_brand_prf#3991 AS p_brand_prf_0#4001, p_size_prf#3992 AS p_size_prf_0#4002, p_partkey_prf#3993 AS p_partkey_prf_0#4003]
         :  :  :  :  +- Relation[p_comment_prf#3984,p_name_prf#3985,rid#3986,p_type_prf#3987,p_retailprice_prf#3988,p_mfgr_prf#3989,p_container_prf#3990,p_brand_prf#3991,p_size_prf#3992,p_partkey_prf#3993] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#4015]
         :  :  :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#4014]
         :  :  :        :  +- Relation[p_comment_prf#4004,p_name_prf#4005,rid#4006,p_type_prf#4007,p_retailprice_prf#4008,p_mfgr_prf#4009,p_container_prf#4010,p_brand_prf#4011,p_size_prf#4012,p_partkey_prf#4013] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#4016 AS l_returnflag_prf_1#4035, l_orderkey_and_l_linenumber_prf#4017 AS l_orderkey_and_l_linenumber_prf_1#4036, l_comment_prf#4018 AS l_comment_prf_1#4037, l_linestatus_prf#4019 AS l_linestatus_prf_1#4038, rid#4020 AS rid_1#4039, l_shipmode_prf#4021 AS l_shipmode_prf_1#4040, l_shipinstruct_prf#4022 AS l_shipinstruct_prf_1#4041, l_quantity_prf#4023 AS l_quantity_prf_1#4042, l_receiptdate_prf#4024 AS l_receiptdate_prf_1#4043, l_linenumber_prf#4025 AS l_linenumber_prf_1#4044, l_tax_prf#4026 AS l_tax_prf_1#4045, l_shipdate_prf#4027 AS l_shipdate_prf_1#4046, l_extendedprice_prf#4028 AS l_extendedprice_prf_1#4047, l_partkey_prf#4029 AS l_partkey_prf_1#4048, l_discount_prf#4030 AS l_discount_prf_1#4049, l_partkey_and_l_suppkey_prf#4031 AS l_partkey_and_l_suppkey_prf_1#4050, l_commitdate_prf#4032 AS l_commitdate_prf_1#4051, l_suppkey_prf#4033 AS l_suppkey_prf_1#4052, l_orderkey_prf#4034 AS l_orderkey_prf_1#4053]
         :  :     +- Relation[l_returnflag_prf#4016,l_orderkey_and_l_linenumber_prf#4017,l_comment_prf#4018,l_linestatus_prf#4019,rid#4020,l_shipmode_prf#4021,l_shipinstruct_prf#4022,l_quantity_prf#4023,l_receiptdate_prf#4024,l_linenumber_prf#4025,l_tax_prf#4026,l_shipdate_prf#4027,l_extendedprice_prf#4028,l_partkey_prf#4029,l_discount_prf#4030,l_partkey_and_l_suppkey_prf#4031,l_commitdate_prf#4032,l_suppkey_prf#4033,l_orderkey_prf#4034] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2110) AS rid_3#4074]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4073]
         :        :  +- Relation[l_returnflag_prf#4054,l_orderkey_and_l_linenumber_prf#4055,l_comment_prf#4056,l_linestatus_prf#4057,rid#4058,l_shipmode_prf#4059,l_shipinstruct_prf#4060,l_quantity_prf#4061,l_receiptdate_prf#4062,l_linenumber_prf#4063,l_tax_prf#4064,l_shipdate_prf#4065,l_extendedprice_prf#4066,l_partkey_prf#4067,l_discount_prf#4068,l_partkey_and_l_suppkey_prf#4069,l_commitdate_prf#4070,l_suppkey_prf#4071,l_orderkey_prf#4072] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_2, 'rid_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2110) AS rid_3#4094]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_2#4085: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [c_acctbal_prf#4075 AS c_acctbal_prf_2#4084, rid#4076 AS rid_2#4085, c_name_prf#4077 AS c_name_prf_2#4086, c_nationkey_prf#4078 AS c_nationkey_prf_2#4087, c_custkey_prf#4079 AS c_custkey_prf_2#4088, c_comment_prf#4080 AS c_comment_prf_2#4089, c_address_prf#4081 AS c_address_prf_2#4090, c_mktsegment_prf#4082 AS c_mktsegment_prf_2#4091, c_phone_prf#4083 AS c_phone_prf_2#4092]
            :     :  :  +- Relation[c_acctbal_prf#4075,rid#4076,c_name_prf#4077,c_nationkey_prf#4078,c_custkey_prf#4079,c_comment_prf#4080,c_address_prf#4081,c_mktsegment_prf#4082,c_phone_prf#4083] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#4093]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4095 AS o_shippriority_prf_3#4105, rid#4096 AS rid_3#4106, o_orderdate_prf#4097 AS o_orderdate_prf_3#4107, o_custkey_prf#4098 AS o_custkey_prf_3#4108, o_orderpriority_prf#4099 AS o_orderpriority_prf_3#4109, o_clerk_prf#4100 AS o_clerk_prf_3#4110, o_orderstatus_prf#4101 AS o_orderstatus_prf_3#4111, o_totalprice_prf#4102 AS o_totalprice_prf_3#4112, o_orderkey_prf#4103 AS o_orderkey_prf_3#4113, o_comment_prf#4104 AS o_comment_prf_3#4114]
               +- Relation[o_shippriority_prf#4095,rid#4096,o_orderdate_prf#4097,o_custkey_prf#4098,o_orderpriority_prf#4099,o_clerk_prf#4100,o_orderstatus_prf#4101,o_totalprice_prf#4102,o_orderkey_prf#4103,o_comment_prf#4104] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 172143ms

ft2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and (p_size = 15 and s_suppkey = ps_suppkey)
19/10/17 01:23:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:23:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4187L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/17 01:23:22 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:23:22 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:23:22 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 01:23:22 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:23:22 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 01:23:22 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 01:23:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4187L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#4189 AS s_phone_prf_0#4197, rid#4190 AS rid_0#4198, s_address_prf#4191 AS s_address_prf_0#4199, s_nationkey_prf#4192 AS s_nationkey_prf_0#4200, s_suppkey_prf#4193 AS s_suppkey_prf_0#4201, s_name_prf#4194 AS s_name_prf_0#4202, s_acctbal_prf#4195 AS s_acctbal_prf_0#4203, s_comment_prf#4196 AS s_comment_prf_0#4204]
         :  :  +- Relation[s_phone_prf#4189,rid#4190,s_address_prf#4191,s_nationkey_prf#4192,s_suppkey_prf#4193,s_name_prf#4194,s_acctbal_prf#4195,s_comment_prf#4196] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_2#4214]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4213]
         :        :  +- Relation[s_phone_prf#4205,rid#4206,s_address_prf#4207,s_nationkey_prf#4208,s_suppkey_prf#4209,s_name_prf#4210,s_acctbal_prf#4211,s_comment_prf#4212] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#4236]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#4227: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#4215 AS p_comment_prf_1#4225, p_name_prf#4216 AS p_name_prf_1#4226, rid#4217 AS rid_1#4227, p_type_prf#4218 AS p_type_prf_1#4228, p_retailprice_prf#4219 AS p_retailprice_prf_1#4229, p_mfgr_prf#4220 AS p_mfgr_prf_1#4230, p_container_prf#4221 AS p_container_prf_1#4231, p_brand_prf#4222 AS p_brand_prf_1#4232, p_size_prf#4223 AS p_size_prf_1#4233, p_partkey_prf#4224 AS p_partkey_prf_1#4234]
            :     :  :  +- Relation[p_comment_prf#4215,p_name_prf#4216,rid#4217,p_type_prf#4218,p_retailprice_prf#4219,p_mfgr_prf#4220,p_container_prf#4221,p_brand_prf#4222,p_size_prf#4223,p_partkey_prf#4224] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4235]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#4237 AS ps_partkey_and_ps_suppkey_prf_2#4244, rid#4238 AS rid_2#4245, ps_availqty_prf#4239 AS ps_availqty_prf_2#4246, ps_comment_prf#4240 AS ps_comment_prf_2#4247, ps_partkey_prf#4241 AS ps_partkey_prf_2#4248, ps_supplycost_prf#4242 AS ps_supplycost_prf_2#4249, ps_suppkey_prf#4243 AS ps_suppkey_prf_2#4250]
               +- Relation[ps_partkey_and_ps_suppkey_prf#4237,rid#4238,ps_availqty_prf#4239,ps_comment_prf#4240,ps_partkey_prf#4241,ps_supplycost_prf#4242,ps_suppkey_prf#4243] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 6975ms

fr1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and (l_orderkey = o_orderkey and c_mktsegment = 'BUILDING')
19/10/17 01:23:29 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:23:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4312L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 01:23:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:23:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:23:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:23:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4312L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#4314 AS l_returnflag_prf_0#4333, l_orderkey_and_l_linenumber_prf#4315 AS l_orderkey_and_l_linenumber_prf_0#4334, l_comment_prf#4316 AS l_comment_prf_0#4335, l_linestatus_prf#4317 AS l_linestatus_prf_0#4336, rid#4318 AS rid_0#4337, l_shipmode_prf#4319 AS l_shipmode_prf_0#4338, l_shipinstruct_prf#4320 AS l_shipinstruct_prf_0#4339, l_quantity_prf#4321 AS l_quantity_prf_0#4340, l_receiptdate_prf#4322 AS l_receiptdate_prf_0#4341, l_linenumber_prf#4323 AS l_linenumber_prf_0#4342, l_tax_prf#4324 AS l_tax_prf_0#4343, l_shipdate_prf#4325 AS l_shipdate_prf_0#4344, l_extendedprice_prf#4326 AS l_extendedprice_prf_0#4345, l_partkey_prf#4327 AS l_partkey_prf_0#4346, l_discount_prf#4328 AS l_discount_prf_0#4347, l_partkey_and_l_suppkey_prf#4329 AS l_partkey_and_l_suppkey_prf_0#4348, l_commitdate_prf#4330 AS l_commitdate_prf_0#4349, l_suppkey_prf#4331 AS l_suppkey_prf_0#4350, l_orderkey_prf#4332 AS l_orderkey_prf_0#4351]
         :  :  +- Relation[l_returnflag_prf#4314,l_orderkey_and_l_linenumber_prf#4315,l_comment_prf#4316,l_linestatus_prf#4317,rid#4318,l_shipmode_prf#4319,l_shipinstruct_prf#4320,l_quantity_prf#4321,l_receiptdate_prf#4322,l_linenumber_prf#4323,l_tax_prf#4324,l_shipdate_prf#4325,l_extendedprice_prf#4326,l_partkey_prf#4327,l_discount_prf#4328,l_partkey_and_l_suppkey_prf#4329,l_commitdate_prf#4330,l_suppkey_prf#4331,l_orderkey_prf#4332] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#4372]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4371]
         :        :  +- Relation[l_returnflag_prf#4352,l_orderkey_and_l_linenumber_prf#4353,l_comment_prf#4354,l_linestatus_prf#4355,rid#4356,l_shipmode_prf#4357,l_shipinstruct_prf#4358,l_quantity_prf#4359,l_receiptdate_prf#4360,l_linenumber_prf#4361,l_tax_prf#4362,l_shipdate_prf#4363,l_extendedprice_prf#4364,l_partkey_prf#4365,l_discount_prf#4366,l_partkey_and_l_suppkey_prf#4367,l_commitdate_prf#4368,l_suppkey_prf#4369,l_orderkey_prf#4370] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [o_shippriority_prf#4373 AS o_shippriority_prf_1#4383, rid#4374 AS rid_1#4384, o_orderdate_prf#4375 AS o_orderdate_prf_1#4385, o_custkey_prf#4376 AS o_custkey_prf_1#4386, o_orderpriority_prf#4377 AS o_orderpriority_prf_1#4387, o_clerk_prf#4378 AS o_clerk_prf_1#4388, o_orderstatus_prf#4379 AS o_orderstatus_prf_1#4389, o_totalprice_prf#4380 AS o_totalprice_prf_1#4390, o_orderkey_prf#4381 AS o_orderkey_prf_1#4391, o_comment_prf#4382 AS o_comment_prf_1#4392]
            :  :  +- Relation[o_shippriority_prf#4373,rid#4374,o_orderdate_prf#4375,o_custkey_prf#4376,o_orderpriority_prf#4377,o_clerk_prf#4378,o_orderstatus_prf#4379,o_totalprice_prf#4380,o_orderkey_prf#4381,o_comment_prf#4382] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#4404]
            :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#4403]
            :        :  +- Relation[o_shippriority_prf#4393,rid#4394,o_orderdate_prf#4395,o_custkey_prf#4396,o_orderpriority_prf#4397,o_clerk_prf#4398,o_orderstatus_prf#4399,o_totalprice_prf#4400,o_orderkey_prf#4401,o_comment_prf#4402] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [c_acctbal_prf#4405 AS c_acctbal_prf_2#4414, rid#4406 AS rid_2#4415, c_name_prf#4407 AS c_name_prf_2#4416, c_nationkey_prf#4408 AS c_nationkey_prf_2#4417, c_custkey_prf#4409 AS c_custkey_prf_2#4418, c_comment_prf#4410 AS c_comment_prf_2#4419, c_address_prf#4411 AS c_address_prf_2#4420, c_mktsegment_prf#4412 AS c_mktsegment_prf_2#4421, c_phone_prf#4413 AS c_phone_prf_2#4422]
               :  +- Relation[c_acctbal_prf#4405,rid#4406,c_name_prf#4407,c_nationkey_prf#4408,c_custkey_prf#4409,c_comment_prf#4410,c_address_prf#4411,c_mktsegment_prf#4412,c_phone_prf#4413] JDBCRelation(customer_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#4423]
                  +- DexRidFilter customer~c_mktsegment~BUILDING
                     +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 120592ms

fq1c=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 01:25:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:25:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4502L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [c_nationkey#293L, o_orderkey#342L]
               :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :     :- Project [c_custkey#290L, c_nationkey#293L]
               :     :  +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
               :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               :     +- Project [o_orderkey#342L, o_custkey#343L]
               :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 01:25:30 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:25:30 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:25:30 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:25:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4502L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#4515]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#4509: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [rid#4504 AS rid_0#4509, n_regionkey_prf#4505 AS n_regionkey_prf_0#4510, n_nationkey_prf#4506 AS n_nationkey_prf_0#4511, n_name_prf#4507 AS n_name_prf_0#4512, n_comment_prf#4508 AS n_comment_prf_0#4513]
         :     :  :  +- Relation[rid#4504,n_regionkey_prf#4505,n_nationkey_prf#4506,n_name_prf#4507,n_comment_prf#4508] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4514]
         :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join NaturalJoin(Inner)
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- Project [c_acctbal_prf#4516 AS c_acctbal_prf_1#4525, rid#4517 AS rid_1#4526, c_name_prf#4518 AS c_name_prf_1#4527, c_nationkey_prf#4519 AS c_nationkey_prf_1#4528, c_custkey_prf#4520 AS c_custkey_prf_1#4529, c_comment_prf#4521 AS c_comment_prf_1#4530, c_address_prf#4522 AS c_address_prf_1#4531, c_mktsegment_prf#4523 AS c_mktsegment_prf_1#4532, c_phone_prf#4524 AS c_phone_prf_1#4533]
            :  :  :  :  +- Relation[c_acctbal_prf#4516,rid#4517,c_name_prf#4518,c_nationkey_prf#4519,c_custkey_prf#4520,c_comment_prf#4521,c_address_prf#4522,c_mktsegment_prf#4523,c_phone_prf#4524] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#4544]
            :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
            :  :  :        :- 'Project ['rid AS rid_1#4543]
            :  :  :        :  +- Relation[c_acctbal_prf#4534,rid#4535,c_name_prf#4536,c_nationkey_prf#4537,c_custkey_prf#4538,c_comment_prf#4539,c_address_prf#4540,c_mktsegment_prf#4541,c_phone_prf#4542] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            :  :  +- Project [o_shippriority_prf#4545 AS o_shippriority_prf_2#4555, rid#4546 AS rid_2#4556, o_orderdate_prf#4547 AS o_orderdate_prf_2#4557, o_custkey_prf#4548 AS o_custkey_prf_2#4558, o_orderpriority_prf#4549 AS o_orderpriority_prf_2#4559, o_clerk_prf#4550 AS o_clerk_prf_2#4560, o_orderstatus_prf#4551 AS o_orderstatus_prf_2#4561, o_totalprice_prf#4552 AS o_totalprice_prf_2#4562, o_orderkey_prf#4553 AS o_orderkey_prf_2#4563, o_comment_prf#4554 AS o_comment_prf_2#4564]
            :  :     +- Relation[o_shippriority_prf#4545,rid#4546,o_orderdate_prf#4547,o_custkey_prf#4548,o_orderpriority_prf#4549,o_clerk_prf#4550,o_orderstatus_prf#4551,o_totalprice_prf#4552,o_orderkey_prf#4553,o_comment_prf#4554] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2110) AS rid_3#4576]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#4575]
            :        :  +- Relation[o_shippriority_prf#4565,rid#4566,o_orderdate_prf#4567,o_custkey_prf#4568,o_orderpriority_prf#4569,o_clerk_prf#4570,o_orderstatus_prf#4571,o_totalprice_prf#4572,o_orderkey_prf#4573,o_comment_prf#4574] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4577 AS l_returnflag_prf_3#4596, l_orderkey_and_l_linenumber_prf#4578 AS l_orderkey_and_l_linenumber_prf_3#4597, l_comment_prf#4579 AS l_comment_prf_3#4598, l_linestatus_prf#4580 AS l_linestatus_prf_3#4599, rid#4581 AS rid_3#4600, l_shipmode_prf#4582 AS l_shipmode_prf_3#4601, l_shipinstruct_prf#4583 AS l_shipinstruct_prf_3#4602, l_quantity_prf#4584 AS l_quantity_prf_3#4603, l_receiptdate_prf#4585 AS l_receiptdate_prf_3#4604, l_linenumber_prf#4586 AS l_linenumber_prf_3#4605, l_tax_prf#4587 AS l_tax_prf_3#4606, l_shipdate_prf#4588 AS l_shipdate_prf_3#4607, l_extendedprice_prf#4589 AS l_extendedprice_prf_3#4608, l_partkey_prf#4590 AS l_partkey_prf_3#4609, l_discount_prf#4591 AS l_discount_prf_3#4610, l_partkey_and_l_suppkey_prf#4592 AS l_partkey_and_l_suppkey_prf_3#4611, l_commitdate_prf#4593 AS l_commitdate_prf_3#4612, l_suppkey_prf#4594 AS l_suppkey_prf_3#4613, l_orderkey_prf#4595 AS l_orderkey_prf_3#4614]
               +- Relation[l_returnflag_prf#4577,l_orderkey_and_l_linenumber_prf#4578,l_comment_prf#4579,l_linestatus_prf#4580,rid#4581,l_shipmode_prf#4582,l_shipinstruct_prf#4583,l_quantity_prf#4584,l_receiptdate_prf#4585,l_linenumber_prf#4586,l_tax_prf#4587,l_shipdate_prf#4588,l_extendedprice_prf#4589,l_partkey_prf#4590,l_discount_prf#4591,l_partkey_and_l_suppkey_prf#4592,l_commitdate_prf#4593,l_suppkey_prf#4594,l_orderkey_prf#4595] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 164028ms

fq1d=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 01:28:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:28:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4698L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :     :- Project [n_nationkey#108L]
               :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
               :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 01:28:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:28:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:28:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:28:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4698L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#4700 AS l_returnflag_prf_0#4719, l_orderkey_and_l_linenumber_prf#4701 AS l_orderkey_and_l_linenumber_prf_0#4720, l_comment_prf#4702 AS l_comment_prf_0#4721, l_linestatus_prf#4703 AS l_linestatus_prf_0#4722, rid#4704 AS rid_0#4723, l_shipmode_prf#4705 AS l_shipmode_prf_0#4724, l_shipinstruct_prf#4706 AS l_shipinstruct_prf_0#4725, l_quantity_prf#4707 AS l_quantity_prf_0#4726, l_receiptdate_prf#4708 AS l_receiptdate_prf_0#4727, l_linenumber_prf#4709 AS l_linenumber_prf_0#4728, l_tax_prf#4710 AS l_tax_prf_0#4729, l_shipdate_prf#4711 AS l_shipdate_prf_0#4730, l_extendedprice_prf#4712 AS l_extendedprice_prf_0#4731, l_partkey_prf#4713 AS l_partkey_prf_0#4732, l_discount_prf#4714 AS l_discount_prf_0#4733, l_partkey_and_l_suppkey_prf#4715 AS l_partkey_and_l_suppkey_prf_0#4734, l_commitdate_prf#4716 AS l_commitdate_prf_0#4735, l_suppkey_prf#4717 AS l_suppkey_prf_0#4736, l_orderkey_prf#4718 AS l_orderkey_prf_0#4737]
         :  :  +- Relation[l_returnflag_prf#4700,l_orderkey_and_l_linenumber_prf#4701,l_comment_prf#4702,l_linestatus_prf#4703,rid#4704,l_shipmode_prf#4705,l_shipinstruct_prf#4706,l_quantity_prf#4707,l_receiptdate_prf#4708,l_linenumber_prf#4709,l_tax_prf#4710,l_shipdate_prf#4711,l_extendedprice_prf#4712,l_partkey_prf#4713,l_discount_prf#4714,l_partkey_and_l_suppkey_prf#4715,l_commitdate_prf#4716,l_suppkey_prf#4717,l_orderkey_prf#4718] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_3#4758]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4757]
         :        :  +- Relation[l_returnflag_prf#4738,l_orderkey_and_l_linenumber_prf#4739,l_comment_prf#4740,l_linestatus_prf#4741,rid#4742,l_shipmode_prf#4743,l_shipinstruct_prf#4744,l_quantity_prf#4745,l_receiptdate_prf#4746,l_linenumber_prf#4747,l_tax_prf#4748,l_shipdate_prf#4749,l_extendedprice_prf#4750,l_partkey_prf#4751,l_discount_prf#4752,l_partkey_and_l_suppkey_prf#4753,l_commitdate_prf#4754,l_suppkey_prf#4755,l_orderkey_prf#4756] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, 'rid_2, 'c_acctbal_prf_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2110) AS rid_3#4789]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_2
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#4770]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_1#4764: string
            :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :     :  :- Project [rid#4759 AS rid_1#4764, n_regionkey_prf#4760 AS n_regionkey_prf_1#4765, n_nationkey_prf#4761 AS n_nationkey_prf_1#4766, n_name_prf#4762 AS n_name_prf_1#4767, n_comment_prf#4763 AS n_comment_prf_1#4768]
            :     :  :     :  :  +- Relation[rid#4759,n_regionkey_prf#4760,n_nationkey_prf#4761,n_name_prf#4762,n_comment_prf#4763] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4769]
            :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :  :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [c_acctbal_prf#4771 AS c_acctbal_prf_2#4780, rid#4772 AS rid_2#4781, c_name_prf#4773 AS c_name_prf_2#4782, c_nationkey_prf#4774 AS c_nationkey_prf_2#4783, c_custkey_prf#4775 AS c_custkey_prf_2#4784, c_comment_prf#4776 AS c_comment_prf_2#4785, c_address_prf#4777 AS c_address_prf_2#4786, c_mktsegment_prf#4778 AS c_mktsegment_prf_2#4787, c_phone_prf#4779 AS c_phone_prf_2#4788]
            :     :     +- Relation[c_acctbal_prf#4771,rid#4772,c_name_prf#4773,c_nationkey_prf#4774,c_custkey_prf#4775,c_comment_prf#4776,c_address_prf#4777,c_mktsegment_prf#4778,c_phone_prf#4779] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4790 AS o_shippriority_prf_3#4800, rid#4791 AS rid_3#4801, o_orderdate_prf#4792 AS o_orderdate_prf_3#4802, o_custkey_prf#4793 AS o_custkey_prf_3#4803, o_orderpriority_prf#4794 AS o_orderpriority_prf_3#4804, o_clerk_prf#4795 AS o_clerk_prf_3#4805, o_orderstatus_prf#4796 AS o_orderstatus_prf_3#4806, o_totalprice_prf#4797 AS o_totalprice_prf_3#4807, o_orderkey_prf#4798 AS o_orderkey_prf_3#4808, o_comment_prf#4799 AS o_comment_prf_3#4809]
               +- Relation[o_shippriority_prf#4790,rid#4791,o_orderdate_prf#4792,o_custkey_prf#4793,o_orderpriority_prf#4794,o_clerk_prf#4795,o_orderstatus_prf#4796,o_totalprice_prf#4797,o_orderkey_prf#4798,o_comment_prf#4799] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 74464ms

ft1d=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/17 01:29:28 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:29:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4875L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_nationkey#21L]
                  +- Filter isnotnull(s_nationkey#21L)
                     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 01:29:28 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:29:28 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:29:28 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:29:28 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:29:28 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:29:28 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:29:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4875L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#4877 AS c_acctbal_prf_0#4886, rid#4878 AS rid_0#4887, c_name_prf#4879 AS c_name_prf_0#4888, c_nationkey_prf#4880 AS c_nationkey_prf_0#4889, c_custkey_prf#4881 AS c_custkey_prf_0#4890, c_comment_prf#4882 AS c_comment_prf_0#4891, c_address_prf#4883 AS c_address_prf_0#4892, c_mktsegment_prf#4884 AS c_mktsegment_prf_0#4893, c_phone_prf#4885 AS c_phone_prf_0#4894]
         :  :  +- Relation[c_acctbal_prf#4877,rid#4878,c_name_prf#4879,c_nationkey_prf#4880,c_custkey_prf#4881,c_comment_prf#4882,c_address_prf#4883,c_mktsegment_prf#4884,c_phone_prf#4885] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#4905]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4904]
         :        :  +- Relation[c_acctbal_prf#4895,rid#4896,c_name_prf#4897,c_nationkey_prf#4898,c_custkey_prf#4899,c_comment_prf#4900,c_address_prf#4901,c_mktsegment_prf#4902,c_phone_prf#4903] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#4917]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_1#4911: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [rid#4906 AS rid_1#4911, n_regionkey_prf#4907 AS n_regionkey_prf_1#4912, n_nationkey_prf#4908 AS n_nationkey_prf_1#4913, n_name_prf#4909 AS n_name_prf_1#4914, n_comment_prf#4910 AS n_comment_prf_1#4915]
            :     :  :  +- Relation[rid#4906,n_regionkey_prf#4907,n_nationkey_prf#4908,n_name_prf#4909,n_comment_prf#4910] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4916]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [s_phone_prf#4918 AS s_phone_prf_2#4926, rid#4919 AS rid_2#4927, s_address_prf#4920 AS s_address_prf_2#4928, s_nationkey_prf#4921 AS s_nationkey_prf_2#4929, s_suppkey_prf#4922 AS s_suppkey_prf_2#4930, s_name_prf#4923 AS s_name_prf_2#4931, s_acctbal_prf#4924 AS s_acctbal_prf_2#4932, s_comment_prf#4925 AS s_comment_prf_2#4933]
               +- Relation[s_phone_prf#4918,rid#4919,s_address_prf#4920,s_nationkey_prf#4921,s_suppkey_prf#4922,s_name_prf#4923,s_acctbal_prf#4924,s_comment_prf#4925] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 24355ms

fr1e=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and (o_orderkey = l_orderkey and c_custkey = o_custkey)
19/10/17 01:29:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:29:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4992L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 01:29:53 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:29:53 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:29:53 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:29:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4992L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#5013]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#5004: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [c_acctbal_prf#4994 AS c_acctbal_prf_0#5003, rid#4995 AS rid_0#5004, c_name_prf#4996 AS c_name_prf_0#5005, c_nationkey_prf#4997 AS c_nationkey_prf_0#5006, c_custkey_prf#4998 AS c_custkey_prf_0#5007, c_comment_prf#4999 AS c_comment_prf_0#5008, c_address_prf#5000 AS c_address_prf_0#5009, c_mktsegment_prf#5001 AS c_mktsegment_prf_0#5010, c_phone_prf#5002 AS c_phone_prf_0#5011]
         :     :  :  +- Relation[c_acctbal_prf#4994,rid#4995,c_name_prf#4996,c_nationkey_prf#4997,c_custkey_prf#4998,c_comment_prf#4999,c_address_prf#5000,c_mktsegment_prf#5001,c_phone_prf#5002] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5012]
         :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [o_shippriority_prf#5014 AS o_shippriority_prf_1#5024, rid#5015 AS rid_1#5025, o_orderdate_prf#5016 AS o_orderdate_prf_1#5026, o_custkey_prf#5017 AS o_custkey_prf_1#5027, o_orderpriority_prf#5018 AS o_orderpriority_prf_1#5028, o_clerk_prf#5019 AS o_clerk_prf_1#5029, o_orderstatus_prf#5020 AS o_orderstatus_prf_1#5030, o_totalprice_prf#5021 AS o_totalprice_prf_1#5031, o_orderkey_prf#5022 AS o_orderkey_prf_1#5032, o_comment_prf#5023 AS o_comment_prf_1#5033]
            :  :  +- Relation[o_shippriority_prf#5014,rid#5015,o_orderdate_prf#5016,o_custkey_prf#5017,o_orderpriority_prf#5018,o_clerk_prf#5019,o_orderstatus_prf#5020,o_totalprice_prf#5021,o_orderkey_prf#5022,o_comment_prf#5023] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#5045]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#5044]
            :        :  +- Relation[o_shippriority_prf#5034,rid#5035,o_orderdate_prf#5036,o_custkey_prf#5037,o_orderpriority_prf#5038,o_clerk_prf#5039,o_orderstatus_prf#5040,o_totalprice_prf#5041,o_orderkey_prf#5042,o_comment_prf#5043] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#5046 AS l_returnflag_prf_2#5065, l_orderkey_and_l_linenumber_prf#5047 AS l_orderkey_and_l_linenumber_prf_2#5066, l_comment_prf#5048 AS l_comment_prf_2#5067, l_linestatus_prf#5049 AS l_linestatus_prf_2#5068, rid#5050 AS rid_2#5069, l_shipmode_prf#5051 AS l_shipmode_prf_2#5070, l_shipinstruct_prf#5052 AS l_shipinstruct_prf_2#5071, l_quantity_prf#5053 AS l_quantity_prf_2#5072, l_receiptdate_prf#5054 AS l_receiptdate_prf_2#5073, l_linenumber_prf#5055 AS l_linenumber_prf_2#5074, l_tax_prf#5056 AS l_tax_prf_2#5075, l_shipdate_prf#5057 AS l_shipdate_prf_2#5076, l_extendedprice_prf#5058 AS l_extendedprice_prf_2#5077, l_partkey_prf#5059 AS l_partkey_prf_2#5078, l_discount_prf#5060 AS l_discount_prf_2#5079, l_partkey_and_l_suppkey_prf#5061 AS l_partkey_and_l_suppkey_prf_2#5080, l_commitdate_prf#5062 AS l_commitdate_prf_2#5081, l_suppkey_prf#5063 AS l_suppkey_prf_2#5082, l_orderkey_prf#5064 AS l_orderkey_prf_2#5083]
               +- Relation[l_returnflag_prf#5046,l_orderkey_and_l_linenumber_prf#5047,l_comment_prf#5048,l_linestatus_prf#5049,rid#5050,l_shipmode_prf#5051,l_shipinstruct_prf#5052,l_quantity_prf#5053,l_receiptdate_prf#5054,l_linenumber_prf#5055,l_tax_prf#5056,l_shipdate_prf#5057,l_extendedprice_prf#5058,l_partkey_prf#5059,l_discount_prf#5060,l_partkey_and_l_suppkey_prf#5061,l_commitdate_prf#5062,l_suppkey_prf#5063,l_orderkey_prf#5064] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 152684ms

fq1e=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 01:32:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:32:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5162L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [c_custkey#290L, c_nationkey#293L]
                  +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 01:32:25 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:32:25 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:32:25 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:32:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5162L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [l_returnflag_prf#5164 AS l_returnflag_prf_0#5183, l_orderkey_and_l_linenumber_prf#5165 AS l_orderkey_and_l_linenumber_prf_0#5184, l_comment_prf#5166 AS l_comment_prf_0#5185, l_linestatus_prf#5167 AS l_linestatus_prf_0#5186, rid#5168 AS rid_0#5187, l_shipmode_prf#5169 AS l_shipmode_prf_0#5188, l_shipinstruct_prf#5170 AS l_shipinstruct_prf_0#5189, l_quantity_prf#5171 AS l_quantity_prf_0#5190, l_receiptdate_prf#5172 AS l_receiptdate_prf_0#5191, l_linenumber_prf#5173 AS l_linenumber_prf_0#5192, l_tax_prf#5174 AS l_tax_prf_0#5193, l_shipdate_prf#5175 AS l_shipdate_prf_0#5194, l_extendedprice_prf#5176 AS l_extendedprice_prf_0#5195, l_partkey_prf#5177 AS l_partkey_prf_0#5196, l_discount_prf#5178 AS l_discount_prf_0#5197, l_partkey_and_l_suppkey_prf#5179 AS l_partkey_and_l_suppkey_prf_0#5198, l_commitdate_prf#5180 AS l_commitdate_prf_0#5199, l_suppkey_prf#5181 AS l_suppkey_prf_0#5200, l_orderkey_prf#5182 AS l_orderkey_prf_0#5201]
         :  :  :  :  +- Relation[l_returnflag_prf#5164,l_orderkey_and_l_linenumber_prf#5165,l_comment_prf#5166,l_linestatus_prf#5167,rid#5168,l_shipmode_prf#5169,l_shipinstruct_prf#5170,l_quantity_prf#5171,l_receiptdate_prf#5172,l_linenumber_prf#5173,l_tax_prf#5174,l_shipdate_prf#5175,l_extendedprice_prf#5176,l_partkey_prf#5177,l_discount_prf#5178,l_partkey_and_l_suppkey_prf#5179,l_commitdate_prf#5180,l_suppkey_prf#5181,l_orderkey_prf#5182] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#5222]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#5221]
         :  :  :        :  +- Relation[l_returnflag_prf#5202,l_orderkey_and_l_linenumber_prf#5203,l_comment_prf#5204,l_linestatus_prf#5205,rid#5206,l_shipmode_prf#5207,l_shipinstruct_prf#5208,l_quantity_prf#5209,l_receiptdate_prf#5210,l_linenumber_prf#5211,l_tax_prf#5212,l_shipdate_prf#5213,l_extendedprice_prf#5214,l_partkey_prf#5215,l_discount_prf#5216,l_partkey_and_l_suppkey_prf#5217,l_commitdate_prf#5218,l_suppkey_prf#5219,l_orderkey_prf#5220] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#5223 AS o_shippriority_prf_1#5233, rid#5224 AS rid_1#5234, o_orderdate_prf#5225 AS o_orderdate_prf_1#5235, o_custkey_prf#5226 AS o_custkey_prf_1#5236, o_orderpriority_prf#5227 AS o_orderpriority_prf_1#5237, o_clerk_prf#5228 AS o_clerk_prf_1#5238, o_orderstatus_prf#5229 AS o_orderstatus_prf_1#5239, o_totalprice_prf#5230 AS o_totalprice_prf_1#5240, o_orderkey_prf#5231 AS o_orderkey_prf_1#5241, o_comment_prf#5232 AS o_comment_prf_1#5242]
         :  :     +- Relation[o_shippriority_prf#5223,rid#5224,o_orderdate_prf#5225,o_custkey_prf#5226,o_orderpriority_prf#5227,o_clerk_prf#5228,o_orderstatus_prf#5229,o_totalprice_prf#5230,o_orderkey_prf#5231,o_comment_prf#5232] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2110) AS rid_3#5254]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5253]
         :        :  +- Relation[o_shippriority_prf#5243,rid#5244,o_orderdate_prf#5245,o_custkey_prf#5246,o_orderpriority_prf#5247,o_clerk_prf#5248,o_orderstatus_prf#5249,o_totalprice_prf#5250,o_orderkey_prf#5251,o_comment_prf#5252] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_2, 'n_regionkey_prf_2, 'n_nationkey_prf_2, 'n_name_prf_2, 'n_comment_prf_2, dexdecrypt('value_dec_key, value#2110) AS rid_3#5266]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_2#5260: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [rid#5255 AS rid_2#5260, n_regionkey_prf#5256 AS n_regionkey_prf_2#5261, n_nationkey_prf#5257 AS n_nationkey_prf_2#5262, n_name_prf#5258 AS n_name_prf_2#5263, n_comment_prf#5259 AS n_comment_prf_2#5264]
            :     :  :  +- Relation[rid#5255,n_regionkey_prf#5256,n_nationkey_prf#5257,n_name_prf#5258,n_comment_prf#5259] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#5265]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#5267 AS c_acctbal_prf_3#5276, rid#5268 AS rid_3#5277, c_name_prf#5269 AS c_name_prf_3#5278, c_nationkey_prf#5270 AS c_nationkey_prf_3#5279, c_custkey_prf#5271 AS c_custkey_prf_3#5280, c_comment_prf#5272 AS c_comment_prf_3#5281, c_address_prf#5273 AS c_address_prf_3#5282, c_mktsegment_prf#5274 AS c_mktsegment_prf_3#5283, c_phone_prf#5275 AS c_phone_prf_3#5284]
               +- Relation[c_acctbal_prf#5267,rid#5268,c_name_prf#5269,c_nationkey_prf#5270,c_custkey_prf#5271,c_comment_prf#5272,c_address_prf#5273,c_mktsegment_prf#5274,c_phone_prf#5275] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 164911ms

ft2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and p_size = 15 and ps_suppkey = s_suppkey
19/10/17 01:35:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:35:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5352L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 01:35:10 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 01:35:10 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 01:35:10 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 01:35:10 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 01:35:10 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:35:10 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:35:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5352L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#5398]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, rid_0#5362: string
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [ps_partkey_and_ps_suppkey_prf#5354 AS ps_partkey_and_ps_suppkey_prf_0#5361, rid#5355 AS rid_0#5362, ps_availqty_prf#5356 AS ps_availqty_prf_0#5363, ps_comment_prf#5357 AS ps_comment_prf_0#5364, ps_partkey_prf#5358 AS ps_partkey_prf_0#5365, ps_supplycost_prf#5359 AS ps_supplycost_prf_0#5366, ps_suppkey_prf#5360 AS ps_suppkey_prf_0#5367]
         :     :  :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#5354,rid#5355,ps_availqty_prf#5356,ps_comment_prf#5357,ps_partkey_prf#5358,ps_supplycost_prf#5359,ps_suppkey_prf#5360] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#5376]
         :     :  :     +- 'DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#5375]
         :     :  :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#5368,rid#5369,ps_availqty_prf#5370,ps_comment_prf#5371,ps_partkey_prf#5372,ps_supplycost_prf#5373,ps_suppkey_prf#5374] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [p_comment_prf#5377 AS p_comment_prf_1#5387, p_name_prf#5378 AS p_name_prf_1#5388, rid#5379 AS rid_1#5389, p_type_prf#5380 AS p_type_prf_1#5390, p_retailprice_prf#5381 AS p_retailprice_prf_1#5391, p_mfgr_prf#5382 AS p_mfgr_prf_1#5392, p_container_prf#5383 AS p_container_prf_1#5393, p_brand_prf#5384 AS p_brand_prf_1#5394, p_size_prf#5385 AS p_size_prf_1#5395, p_partkey_prf#5386 AS p_partkey_prf_1#5396]
         :     :     :  +- Relation[p_comment_prf#5377,p_name_prf#5378,rid#5379,p_type_prf#5380,p_retailprice_prf#5381,p_mfgr_prf#5382,p_container_prf#5383,p_brand_prf#5384,p_size_prf#5385,p_partkey_prf#5386] JDBCRelation(part_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5397]
         :     :        +- DexRidFilter part~p_size~15
         :     :           +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5399 AS s_phone_prf_2#5407, rid#5400 AS rid_2#5408, s_address_prf#5401 AS s_address_prf_2#5409, s_nationkey_prf#5402 AS s_nationkey_prf_2#5410, s_suppkey_prf#5403 AS s_suppkey_prf_2#5411, s_name_prf#5404 AS s_name_prf_2#5412, s_acctbal_prf#5405 AS s_acctbal_prf_2#5413, s_comment_prf#5406 AS s_comment_prf_2#5414]
            +- Relation[s_phone_prf#5399,rid#5400,s_address_prf#5401,s_nationkey_prf#5402,s_suppkey_prf#5403,s_name_prf#5404,s_acctbal_prf#5405,s_comment_prf#5406] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 49395ms

fq1a=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 01:36:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:36:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5480L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :     :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 01:36:00 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:36:00 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:36:00 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:36:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5480L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, 'rid_2, 'o_shippriority_prf_2, 'o_orderdate_prf_2, 'o_custkey_prf_2, 'o_orderpriority_prf_2, 'o_clerk_prf_2, 'o_orderstatus_prf_2, 'o_totalprice_prf_2, 'o_orderkey_prf_2, 'o_comment_prf_2, dexdecrypt('value_dec_key, value#2110) AS rid_3#5533]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#5512]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#5493]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#5487: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [rid#5482 AS rid_0#5487, n_regionkey_prf#5483 AS n_regionkey_prf_0#5488, n_nationkey_prf#5484 AS n_nationkey_prf_0#5489, n_name_prf#5485 AS n_name_prf_0#5490, n_comment_prf#5486 AS n_comment_prf_0#5491]
         :     :  :     :  :     :  :  +- Relation[rid#5482,n_regionkey_prf#5483,n_nationkey_prf#5484,n_name_prf#5485,n_comment_prf#5486] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5492]
         :     :  :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :  :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [c_acctbal_prf#5494 AS c_acctbal_prf_1#5503, rid#5495 AS rid_1#5504, c_name_prf#5496 AS c_name_prf_1#5505, c_nationkey_prf#5497 AS c_nationkey_prf_1#5506, c_custkey_prf#5498 AS c_custkey_prf_1#5507, c_comment_prf#5499 AS c_comment_prf_1#5508, c_address_prf#5500 AS c_address_prf_1#5509, c_mktsegment_prf#5501 AS c_mktsegment_prf_1#5510, c_phone_prf#5502 AS c_phone_prf_1#5511]
         :     :  :     :     +- Relation[c_acctbal_prf#5494,rid#5495,c_name_prf#5496,c_nationkey_prf#5497,c_custkey_prf#5498,c_comment_prf#5499,c_address_prf#5500,c_mktsegment_prf#5501,c_phone_prf#5502] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#5513 AS o_shippriority_prf_2#5523, rid#5514 AS rid_2#5524, o_orderdate_prf#5515 AS o_orderdate_prf_2#5525, o_custkey_prf#5516 AS o_custkey_prf_2#5526, o_orderpriority_prf#5517 AS o_orderpriority_prf_2#5527, o_clerk_prf#5518 AS o_clerk_prf_2#5528, o_orderstatus_prf#5519 AS o_orderstatus_prf_2#5529, o_totalprice_prf#5520 AS o_totalprice_prf_2#5530, o_orderkey_prf#5521 AS o_orderkey_prf_2#5531, o_comment_prf#5522 AS o_comment_prf_2#5532]
         :     :     +- Relation[o_shippriority_prf#5513,rid#5514,o_orderdate_prf#5515,o_custkey_prf#5516,o_orderpriority_prf#5517,o_clerk_prf#5518,o_orderstatus_prf#5519,o_totalprice_prf#5520,o_orderkey_prf#5521,o_comment_prf#5522] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5534 AS l_returnflag_prf_3#5553, l_orderkey_and_l_linenumber_prf#5535 AS l_orderkey_and_l_linenumber_prf_3#5554, l_comment_prf#5536 AS l_comment_prf_3#5555, l_linestatus_prf#5537 AS l_linestatus_prf_3#5556, rid#5538 AS rid_3#5557, l_shipmode_prf#5539 AS l_shipmode_prf_3#5558, l_shipinstruct_prf#5540 AS l_shipinstruct_prf_3#5559, l_quantity_prf#5541 AS l_quantity_prf_3#5560, l_receiptdate_prf#5542 AS l_receiptdate_prf_3#5561, l_linenumber_prf#5543 AS l_linenumber_prf_3#5562, l_tax_prf#5544 AS l_tax_prf_3#5563, l_shipdate_prf#5545 AS l_shipdate_prf_3#5564, l_extendedprice_prf#5546 AS l_extendedprice_prf_3#5565, l_partkey_prf#5547 AS l_partkey_prf_3#5566, l_discount_prf#5548 AS l_discount_prf_3#5567, l_partkey_and_l_suppkey_prf#5549 AS l_partkey_and_l_suppkey_prf_3#5568, l_commitdate_prf#5550 AS l_commitdate_prf_3#5569, l_suppkey_prf#5551 AS l_suppkey_prf_3#5570, l_orderkey_prf#5552 AS l_orderkey_prf_3#5571]
            +- Relation[l_returnflag_prf#5534,l_orderkey_and_l_linenumber_prf#5535,l_comment_prf#5536,l_linestatus_prf#5537,rid#5538,l_shipmode_prf#5539,l_shipinstruct_prf#5540,l_quantity_prf#5541,l_receiptdate_prf#5542,l_linenumber_prf#5543,l_tax_prf#5544,l_shipdate_prf#5545,l_extendedprice_prf#5546,l_partkey_prf#5547,l_discount_prf#5548,l_partkey_and_l_suppkey_prf#5549,l_commitdate_prf#5550,l_suppkey_prf#5551,l_orderkey_prf#5552] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 30826ms

fr2b=
select * from lineitem, orders, customer where o_custkey = c_custkey and o_orderstatus = 'F' and l_orderkey = o_orderkey
19/10/17 01:36:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:36:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5651L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 01:36:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5651L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#5653 AS l_returnflag_prf_0#5672, l_orderkey_and_l_linenumber_prf#5654 AS l_orderkey_and_l_linenumber_prf_0#5673, l_comment_prf#5655 AS l_comment_prf_0#5674, l_linestatus_prf#5656 AS l_linestatus_prf_0#5675, rid#5657 AS rid_0#5676, l_shipmode_prf#5658 AS l_shipmode_prf_0#5677, l_shipinstruct_prf#5659 AS l_shipinstruct_prf_0#5678, l_quantity_prf#5660 AS l_quantity_prf_0#5679, l_receiptdate_prf#5661 AS l_receiptdate_prf_0#5680, l_linenumber_prf#5662 AS l_linenumber_prf_0#5681, l_tax_prf#5663 AS l_tax_prf_0#5682, l_shipdate_prf#5664 AS l_shipdate_prf_0#5683, l_extendedprice_prf#5665 AS l_extendedprice_prf_0#5684, l_partkey_prf#5666 AS l_partkey_prf_0#5685, l_discount_prf#5667 AS l_discount_prf_0#5686, l_partkey_and_l_suppkey_prf#5668 AS l_partkey_and_l_suppkey_prf_0#5687, l_commitdate_prf#5669 AS l_commitdate_prf_0#5688, l_suppkey_prf#5670 AS l_suppkey_prf_0#5689, l_orderkey_prf#5671 AS l_orderkey_prf_0#5690]
         :  :  +- Relation[l_returnflag_prf#5653,l_orderkey_and_l_linenumber_prf#5654,l_comment_prf#5655,l_linestatus_prf#5656,rid#5657,l_shipmode_prf#5658,l_shipinstruct_prf#5659,l_quantity_prf#5660,l_receiptdate_prf#5661,l_linenumber_prf#5662,l_tax_prf#5663,l_shipdate_prf#5664,l_extendedprice_prf#5665,l_partkey_prf#5666,l_discount_prf#5667,l_partkey_and_l_suppkey_prf#5668,l_commitdate_prf#5669,l_suppkey_prf#5670,l_orderkey_prf#5671] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#5711]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5710]
         :        :  +- Relation[l_returnflag_prf#5691,l_orderkey_and_l_linenumber_prf#5692,l_comment_prf#5693,l_linestatus_prf#5694,rid#5695,l_shipmode_prf#5696,l_shipinstruct_prf#5697,l_quantity_prf#5698,l_receiptdate_prf#5699,l_linenumber_prf#5700,l_tax_prf#5701,l_shipdate_prf#5702,l_extendedprice_prf#5703,l_partkey_prf#5704,l_discount_prf#5705,l_partkey_and_l_suppkey_prf#5706,l_commitdate_prf#5707,l_suppkey_prf#5708,l_orderkey_prf#5709] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#5733]
            :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#5723: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#5712 AS o_shippriority_prf_1#5722, rid#5713 AS rid_1#5723, o_orderdate_prf#5714 AS o_orderdate_prf_1#5724, o_custkey_prf#5715 AS o_custkey_prf_1#5725, o_orderpriority_prf#5716 AS o_orderpriority_prf_1#5726, o_clerk_prf#5717 AS o_clerk_prf_1#5727, o_orderstatus_prf#5718 AS o_orderstatus_prf_1#5728, o_totalprice_prf#5719 AS o_totalprice_prf_1#5729, o_orderkey_prf#5720 AS o_orderkey_prf_1#5730, o_comment_prf#5721 AS o_comment_prf_1#5731]
            :     :  :  +- Relation[o_shippriority_prf#5712,rid#5713,o_orderdate_prf#5714,o_custkey_prf#5715,o_orderpriority_prf#5716,o_clerk_prf#5717,o_orderstatus_prf#5718,o_totalprice_prf#5719,o_orderkey_prf#5720,o_comment_prf#5721] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5732]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#5734 AS c_acctbal_prf_2#5743, rid#5735 AS rid_2#5744, c_name_prf#5736 AS c_name_prf_2#5745, c_nationkey_prf#5737 AS c_nationkey_prf_2#5746, c_custkey_prf#5738 AS c_custkey_prf_2#5747, c_comment_prf#5739 AS c_comment_prf_2#5748, c_address_prf#5740 AS c_address_prf_2#5749, c_mktsegment_prf#5741 AS c_mktsegment_prf_2#5750, c_phone_prf#5742 AS c_phone_prf_2#5751]
               +- Relation[c_acctbal_prf#5734,rid#5735,c_name_prf#5736,c_nationkey_prf#5737,c_custkey_prf#5738,c_comment_prf#5739,c_address_prf#5740,c_mktsegment_prf#5741,c_phone_prf#5742] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 105859ms

fr1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey and c_mktsegment = 'BUILDING'
19/10/17 01:38:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:38:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5826L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 01:38:16 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:38:16 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:38:16 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:38:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5826L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [l_returnflag_prf#5828 AS l_returnflag_prf_0#5847, l_orderkey_and_l_linenumber_prf#5829 AS l_orderkey_and_l_linenumber_prf_0#5848, l_comment_prf#5830 AS l_comment_prf_0#5849, l_linestatus_prf#5831 AS l_linestatus_prf_0#5850, rid#5832 AS rid_0#5851, l_shipmode_prf#5833 AS l_shipmode_prf_0#5852, l_shipinstruct_prf#5834 AS l_shipinstruct_prf_0#5853, l_quantity_prf#5835 AS l_quantity_prf_0#5854, l_receiptdate_prf#5836 AS l_receiptdate_prf_0#5855, l_linenumber_prf#5837 AS l_linenumber_prf_0#5856, l_tax_prf#5838 AS l_tax_prf_0#5857, l_shipdate_prf#5839 AS l_shipdate_prf_0#5858, l_extendedprice_prf#5840 AS l_extendedprice_prf_0#5859, l_partkey_prf#5841 AS l_partkey_prf_0#5860, l_discount_prf#5842 AS l_discount_prf_0#5861, l_partkey_and_l_suppkey_prf#5843 AS l_partkey_and_l_suppkey_prf_0#5862, l_commitdate_prf#5844 AS l_commitdate_prf_0#5863, l_suppkey_prf#5845 AS l_suppkey_prf_0#5864, l_orderkey_prf#5846 AS l_orderkey_prf_0#5865]
         :  :  :  :  +- Relation[l_returnflag_prf#5828,l_orderkey_and_l_linenumber_prf#5829,l_comment_prf#5830,l_linestatus_prf#5831,rid#5832,l_shipmode_prf#5833,l_shipinstruct_prf#5834,l_quantity_prf#5835,l_receiptdate_prf#5836,l_linenumber_prf#5837,l_tax_prf#5838,l_shipdate_prf#5839,l_extendedprice_prf#5840,l_partkey_prf#5841,l_discount_prf#5842,l_partkey_and_l_suppkey_prf#5843,l_commitdate_prf#5844,l_suppkey_prf#5845,l_orderkey_prf#5846] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#5886]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#5885]
         :  :  :        :  +- Relation[l_returnflag_prf#5866,l_orderkey_and_l_linenumber_prf#5867,l_comment_prf#5868,l_linestatus_prf#5869,rid#5870,l_shipmode_prf#5871,l_shipinstruct_prf#5872,l_quantity_prf#5873,l_receiptdate_prf#5874,l_linenumber_prf#5875,l_tax_prf#5876,l_shipdate_prf#5877,l_extendedprice_prf#5878,l_partkey_prf#5879,l_discount_prf#5880,l_partkey_and_l_suppkey_prf#5881,l_commitdate_prf#5882,l_suppkey_prf#5883,l_orderkey_prf#5884] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#5887 AS o_shippriority_prf_1#5897, rid#5888 AS rid_1#5898, o_orderdate_prf#5889 AS o_orderdate_prf_1#5899, o_custkey_prf#5890 AS o_custkey_prf_1#5900, o_orderpriority_prf#5891 AS o_orderpriority_prf_1#5901, o_clerk_prf#5892 AS o_clerk_prf_1#5902, o_orderstatus_prf#5893 AS o_orderstatus_prf_1#5903, o_totalprice_prf#5894 AS o_totalprice_prf_1#5904, o_orderkey_prf#5895 AS o_orderkey_prf_1#5905, o_comment_prf#5896 AS o_comment_prf_1#5906]
         :  :     +- Relation[o_shippriority_prf#5887,rid#5888,o_orderdate_prf#5889,o_custkey_prf#5890,o_orderpriority_prf#5891,o_clerk_prf#5892,o_orderstatus_prf#5893,o_totalprice_prf#5894,o_orderkey_prf#5895,o_comment_prf#5896] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#5918]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5917]
         :        :  +- Relation[o_shippriority_prf#5907,rid#5908,o_orderdate_prf#5909,o_custkey_prf#5910,o_orderpriority_prf#5911,o_clerk_prf#5912,o_orderstatus_prf#5913,o_totalprice_prf#5914,o_orderkey_prf#5915,o_comment_prf#5916] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_2))
            :- Project [c_acctbal_prf#5919 AS c_acctbal_prf_2#5928, rid#5920 AS rid_2#5929, c_name_prf#5921 AS c_name_prf_2#5930, c_nationkey_prf#5922 AS c_nationkey_prf_2#5931, c_custkey_prf#5923 AS c_custkey_prf_2#5932, c_comment_prf#5924 AS c_comment_prf_2#5933, c_address_prf#5925 AS c_address_prf_2#5934, c_mktsegment_prf#5926 AS c_mktsegment_prf_2#5935, c_phone_prf#5927 AS c_phone_prf_2#5936]
            :  +- Relation[c_acctbal_prf#5919,rid#5920,c_name_prf#5921,c_nationkey_prf#5922,c_custkey_prf#5923,c_comment_prf#5924,c_address_prf#5925,c_mktsegment_prf#5926,c_phone_prf#5927] JDBCRelation(customer_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#5937]
               +- DexRidFilter customer~c_mktsegment~BUILDING
                  +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 121759ms

fs1b=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/17 01:40:18 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:40:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6021L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L, l_partkey#307L]
               :  +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L]
                  +- Join Inner, (c_custkey#290L = o_custkey#343L)
                     :- Project [c_custkey#290L]
                     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
                     +- Project [o_orderkey#342L, o_custkey#343L]
                        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 01:40:18 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:40:18 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:40:18 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:40:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6021L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [p_comment_prf#6023 AS p_comment_prf_0#6033, p_name_prf#6024 AS p_name_prf_0#6034, rid#6025 AS rid_0#6035, p_type_prf#6026 AS p_type_prf_0#6036, p_retailprice_prf#6027 AS p_retailprice_prf_0#6037, p_mfgr_prf#6028 AS p_mfgr_prf_0#6038, p_container_prf#6029 AS p_container_prf_0#6039, p_brand_prf#6030 AS p_brand_prf_0#6040, p_size_prf#6031 AS p_size_prf_0#6041, p_partkey_prf#6032 AS p_partkey_prf_0#6042]
         :  :  +- Relation[p_comment_prf#6023,p_name_prf#6024,rid#6025,p_type_prf#6026,p_retailprice_prf#6027,p_mfgr_prf#6028,p_container_prf#6029,p_brand_prf#6030,p_size_prf#6031,p_partkey_prf#6032] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#6054]
         :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#6053]
         :        :  +- Relation[p_comment_prf#6043,p_name_prf#6044,rid#6045,p_type_prf#6046,p_retailprice_prf#6047,p_mfgr_prf#6048,p_container_prf#6049,p_brand_prf#6050,p_size_prf#6051,p_partkey_prf#6052] JDBCRelation(part_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [l_returnflag_prf#6055 AS l_returnflag_prf_1#6074, l_orderkey_and_l_linenumber_prf#6056 AS l_orderkey_and_l_linenumber_prf_1#6075, l_comment_prf#6057 AS l_comment_prf_1#6076, l_linestatus_prf#6058 AS l_linestatus_prf_1#6077, rid#6059 AS rid_1#6078, l_shipmode_prf#6060 AS l_shipmode_prf_1#6079, l_shipinstruct_prf#6061 AS l_shipinstruct_prf_1#6080, l_quantity_prf#6062 AS l_quantity_prf_1#6081, l_receiptdate_prf#6063 AS l_receiptdate_prf_1#6082, l_linenumber_prf#6064 AS l_linenumber_prf_1#6083, l_tax_prf#6065 AS l_tax_prf_1#6084, l_shipdate_prf#6066 AS l_shipdate_prf_1#6085, l_extendedprice_prf#6067 AS l_extendedprice_prf_1#6086, l_partkey_prf#6068 AS l_partkey_prf_1#6087, l_discount_prf#6069 AS l_discount_prf_1#6088, l_partkey_and_l_suppkey_prf#6070 AS l_partkey_and_l_suppkey_prf_1#6089, l_commitdate_prf#6071 AS l_commitdate_prf_1#6090, l_suppkey_prf#6072 AS l_suppkey_prf_1#6091, l_orderkey_prf#6073 AS l_orderkey_prf_1#6092]
            :  :  +- Relation[l_returnflag_prf#6055,l_orderkey_and_l_linenumber_prf#6056,l_comment_prf#6057,l_linestatus_prf#6058,rid#6059,l_shipmode_prf#6060,l_shipinstruct_prf#6061,l_quantity_prf#6062,l_receiptdate_prf#6063,l_linenumber_prf#6064,l_tax_prf#6065,l_shipdate_prf#6066,l_extendedprice_prf#6067,l_partkey_prf#6068,l_discount_prf#6069,l_partkey_and_l_suppkey_prf#6070,l_commitdate_prf#6071,l_suppkey_prf#6072,l_orderkey_prf#6073] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2110) AS rid_3#6113]
            :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#6112]
            :        :  +- Relation[l_returnflag_prf#6093,l_orderkey_and_l_linenumber_prf#6094,l_comment_prf#6095,l_linestatus_prf#6096,rid#6097,l_shipmode_prf#6098,l_shipinstruct_prf#6099,l_quantity_prf#6100,l_receiptdate_prf#6101,l_linenumber_prf#6102,l_tax_prf#6103,l_shipdate_prf#6104,l_extendedprice_prf#6105,l_partkey_prf#6106,l_discount_prf#6107,l_partkey_and_l_suppkey_prf#6108,l_commitdate_prf#6109,l_suppkey_prf#6110,l_orderkey_prf#6111] JDBCRelation(lineitem_prf) [numPartitions=1]
            :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join NaturalJoin(Inner)
               :- 'Project ['c_acctbal_prf_2, 'rid_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2110) AS rid_3#6133]
               :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_2#6124: string
               :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :     :  :- Project [c_acctbal_prf#6114 AS c_acctbal_prf_2#6123, rid#6115 AS rid_2#6124, c_name_prf#6116 AS c_name_prf_2#6125, c_nationkey_prf#6117 AS c_nationkey_prf_2#6126, c_custkey_prf#6118 AS c_custkey_prf_2#6127, c_comment_prf#6119 AS c_comment_prf_2#6128, c_address_prf#6120 AS c_address_prf_2#6129, c_mktsegment_prf#6121 AS c_mktsegment_prf_2#6130, c_phone_prf#6122 AS c_phone_prf_2#6131]
               :     :  :  +- Relation[c_acctbal_prf#6114,rid#6115,c_name_prf#6116,c_nationkey_prf#6117,c_custkey_prf#6118,c_comment_prf#6119,c_address_prf#6120,c_mktsegment_prf#6121,c_phone_prf#6122] JDBCRelation(customer_prf) [numPartitions=1]
               :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#6132]
               :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
               :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
               :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
               +- Project [o_shippriority_prf#6134 AS o_shippriority_prf_3#6144, rid#6135 AS rid_3#6145, o_orderdate_prf#6136 AS o_orderdate_prf_3#6146, o_custkey_prf#6137 AS o_custkey_prf_3#6147, o_orderpriority_prf#6138 AS o_orderpriority_prf_3#6148, o_clerk_prf#6139 AS o_clerk_prf_3#6149, o_orderstatus_prf#6140 AS o_orderstatus_prf_3#6150, o_totalprice_prf#6141 AS o_totalprice_prf_3#6151, o_orderkey_prf#6142 AS o_orderkey_prf_3#6152, o_comment_prf#6143 AS o_comment_prf_3#6153]
                  +- Relation[o_shippriority_prf#6134,rid#6135,o_orderdate_prf#6136,o_custkey_prf#6137,o_orderpriority_prf#6138,o_clerk_prf#6139,o_orderstatus_prf#6140,o_totalprice_prf#6141,o_orderkey_prf#6142,o_comment_prf#6143] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 172886ms

ft2b=
select * from part, partsupp, supplier where p_size = 15 and p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/17 01:43:11 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:43:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6226L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 01:43:11 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 01:43:11 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 01:43:11 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 01:43:11 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:43:11 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:43:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6226L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#6264]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#6249]
         :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#6240: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [p_comment_prf#6228 AS p_comment_prf_0#6238, p_name_prf#6229 AS p_name_prf_0#6239, rid#6230 AS rid_0#6240, p_type_prf#6231 AS p_type_prf_0#6241, p_retailprice_prf#6232 AS p_retailprice_prf_0#6242, p_mfgr_prf#6233 AS p_mfgr_prf_0#6243, p_container_prf#6234 AS p_container_prf_0#6244, p_brand_prf#6235 AS p_brand_prf_0#6245, p_size_prf#6236 AS p_size_prf_0#6246, p_partkey_prf#6237 AS p_partkey_prf_0#6247]
         :     :  :     :  :  +- Relation[p_comment_prf#6228,p_name_prf#6229,rid#6230,p_type_prf#6231,p_retailprice_prf#6232,p_mfgr_prf#6233,p_container_prf#6234,p_brand_prf#6235,p_size_prf#6236,p_partkey_prf#6237] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#6248]
         :     :  :     :     +- DexRidFilter part~p_size~15
         :     :  :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#6250 AS ps_partkey_and_ps_suppkey_prf_1#6257, rid#6251 AS rid_1#6258, ps_availqty_prf#6252 AS ps_availqty_prf_1#6259, ps_comment_prf#6253 AS ps_comment_prf_1#6260, ps_partkey_prf#6254 AS ps_partkey_prf_1#6261, ps_supplycost_prf#6255 AS ps_supplycost_prf_1#6262, ps_suppkey_prf#6256 AS ps_suppkey_prf_1#6263]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#6250,rid#6251,ps_availqty_prf#6252,ps_comment_prf#6253,ps_partkey_prf#6254,ps_supplycost_prf#6255,ps_suppkey_prf#6256] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#6265 AS s_phone_prf_2#6273, rid#6266 AS rid_2#6274, s_address_prf#6267 AS s_address_prf_2#6275, s_nationkey_prf#6268 AS s_nationkey_prf_2#6276, s_suppkey_prf#6269 AS s_suppkey_prf_2#6277, s_name_prf#6270 AS s_name_prf_2#6278, s_acctbal_prf#6271 AS s_acctbal_prf_2#6279, s_comment_prf#6272 AS s_comment_prf_2#6280]
            +- Relation[s_phone_prf#6265,rid#6266,s_address_prf#6267,s_nationkey_prf#6268,s_suppkey_prf#6269,s_name_prf#6270,s_acctbal_prf#6271,s_comment_prf#6272] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 906ms

ft3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and (p_size = 15 and s_suppkey = l_suppkey)
19/10/17 01:43:12 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:43:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6341L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 01:43:12 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:43:12 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:43:12 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:43:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6341L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#6343 AS s_phone_prf_0#6351, rid#6344 AS rid_0#6352, s_address_prf#6345 AS s_address_prf_0#6353, s_nationkey_prf#6346 AS s_nationkey_prf_0#6354, s_suppkey_prf#6347 AS s_suppkey_prf_0#6355, s_name_prf#6348 AS s_name_prf_0#6356, s_acctbal_prf#6349 AS s_acctbal_prf_0#6357, s_comment_prf#6350 AS s_comment_prf_0#6358]
         :  :  +- Relation[s_phone_prf#6343,rid#6344,s_address_prf#6345,s_nationkey_prf#6346,s_suppkey_prf#6347,s_name_prf#6348,s_acctbal_prf#6349,s_comment_prf#6350] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_2#6368]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#6367]
         :        :  +- Relation[s_phone_prf#6359,rid#6360,s_address_prf#6361,s_nationkey_prf#6362,s_suppkey_prf#6363,s_name_prf#6364,s_acctbal_prf#6365,s_comment_prf#6366] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#6390]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#6381: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#6369 AS p_comment_prf_1#6379, p_name_prf#6370 AS p_name_prf_1#6380, rid#6371 AS rid_1#6381, p_type_prf#6372 AS p_type_prf_1#6382, p_retailprice_prf#6373 AS p_retailprice_prf_1#6383, p_mfgr_prf#6374 AS p_mfgr_prf_1#6384, p_container_prf#6375 AS p_container_prf_1#6385, p_brand_prf#6376 AS p_brand_prf_1#6386, p_size_prf#6377 AS p_size_prf_1#6387, p_partkey_prf#6378 AS p_partkey_prf_1#6388]
            :     :  :  +- Relation[p_comment_prf#6369,p_name_prf#6370,rid#6371,p_type_prf#6372,p_retailprice_prf#6373,p_mfgr_prf#6374,p_container_prf#6375,p_brand_prf#6376,p_size_prf#6377,p_partkey_prf#6378] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6389]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#6391 AS l_returnflag_prf_2#6410, l_orderkey_and_l_linenumber_prf#6392 AS l_orderkey_and_l_linenumber_prf_2#6411, l_comment_prf#6393 AS l_comment_prf_2#6412, l_linestatus_prf#6394 AS l_linestatus_prf_2#6413, rid#6395 AS rid_2#6414, l_shipmode_prf#6396 AS l_shipmode_prf_2#6415, l_shipinstruct_prf#6397 AS l_shipinstruct_prf_2#6416, l_quantity_prf#6398 AS l_quantity_prf_2#6417, l_receiptdate_prf#6399 AS l_receiptdate_prf_2#6418, l_linenumber_prf#6400 AS l_linenumber_prf_2#6419, l_tax_prf#6401 AS l_tax_prf_2#6420, l_shipdate_prf#6402 AS l_shipdate_prf_2#6421, l_extendedprice_prf#6403 AS l_extendedprice_prf_2#6422, l_partkey_prf#6404 AS l_partkey_prf_2#6423, l_discount_prf#6405 AS l_discount_prf_2#6424, l_partkey_and_l_suppkey_prf#6406 AS l_partkey_and_l_suppkey_prf_2#6425, l_commitdate_prf#6407 AS l_commitdate_prf_2#6426, l_suppkey_prf#6408 AS l_suppkey_prf_2#6427, l_orderkey_prf#6409 AS l_orderkey_prf_2#6428]
               +- Relation[l_returnflag_prf#6391,l_orderkey_and_l_linenumber_prf#6392,l_comment_prf#6393,l_linestatus_prf#6394,rid#6395,l_shipmode_prf#6396,l_shipinstruct_prf#6397,l_quantity_prf#6398,l_receiptdate_prf#6399,l_linenumber_prf#6400,l_tax_prf#6401,l_shipdate_prf#6402,l_extendedprice_prf#6403,l_partkey_prf#6404,l_discount_prf#6405,l_partkey_and_l_suppkey_prf#6406,l_commitdate_prf#6407,l_suppkey_prf#6408,l_orderkey_prf#6409] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 55867ms

fr1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and (c_mktsegment = 'BUILDING' and l_orderkey = o_orderkey)
19/10/17 01:44:08 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:44:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6502L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 01:44:08 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:44:08 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:44:08 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:44:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6502L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#6504 AS l_returnflag_prf_0#6523, l_orderkey_and_l_linenumber_prf#6505 AS l_orderkey_and_l_linenumber_prf_0#6524, l_comment_prf#6506 AS l_comment_prf_0#6525, l_linestatus_prf#6507 AS l_linestatus_prf_0#6526, rid#6508 AS rid_0#6527, l_shipmode_prf#6509 AS l_shipmode_prf_0#6528, l_shipinstruct_prf#6510 AS l_shipinstruct_prf_0#6529, l_quantity_prf#6511 AS l_quantity_prf_0#6530, l_receiptdate_prf#6512 AS l_receiptdate_prf_0#6531, l_linenumber_prf#6513 AS l_linenumber_prf_0#6532, l_tax_prf#6514 AS l_tax_prf_0#6533, l_shipdate_prf#6515 AS l_shipdate_prf_0#6534, l_extendedprice_prf#6516 AS l_extendedprice_prf_0#6535, l_partkey_prf#6517 AS l_partkey_prf_0#6536, l_discount_prf#6518 AS l_discount_prf_0#6537, l_partkey_and_l_suppkey_prf#6519 AS l_partkey_and_l_suppkey_prf_0#6538, l_commitdate_prf#6520 AS l_commitdate_prf_0#6539, l_suppkey_prf#6521 AS l_suppkey_prf_0#6540, l_orderkey_prf#6522 AS l_orderkey_prf_0#6541]
         :  :  +- Relation[l_returnflag_prf#6504,l_orderkey_and_l_linenumber_prf#6505,l_comment_prf#6506,l_linestatus_prf#6507,rid#6508,l_shipmode_prf#6509,l_shipinstruct_prf#6510,l_quantity_prf#6511,l_receiptdate_prf#6512,l_linenumber_prf#6513,l_tax_prf#6514,l_shipdate_prf#6515,l_extendedprice_prf#6516,l_partkey_prf#6517,l_discount_prf#6518,l_partkey_and_l_suppkey_prf#6519,l_commitdate_prf#6520,l_suppkey_prf#6521,l_orderkey_prf#6522] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_2#6562]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#6561]
         :        :  +- Relation[l_returnflag_prf#6542,l_orderkey_and_l_linenumber_prf#6543,l_comment_prf#6544,l_linestatus_prf#6545,rid#6546,l_shipmode_prf#6547,l_shipinstruct_prf#6548,l_quantity_prf#6549,l_receiptdate_prf#6550,l_linenumber_prf#6551,l_tax_prf#6552,l_shipdate_prf#6553,l_extendedprice_prf#6554,l_partkey_prf#6555,l_discount_prf#6556,l_partkey_and_l_suppkey_prf#6557,l_commitdate_prf#6558,l_suppkey_prf#6559,l_orderkey_prf#6560] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#6582]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#6573: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [c_acctbal_prf#6563 AS c_acctbal_prf_1#6572, rid#6564 AS rid_1#6573, c_name_prf#6565 AS c_name_prf_1#6574, c_nationkey_prf#6566 AS c_nationkey_prf_1#6575, c_custkey_prf#6567 AS c_custkey_prf_1#6576, c_comment_prf#6568 AS c_comment_prf_1#6577, c_address_prf#6569 AS c_address_prf_1#6578, c_mktsegment_prf#6570 AS c_mktsegment_prf_1#6579, c_phone_prf#6571 AS c_phone_prf_1#6580]
            :     :  :  +- Relation[c_acctbal_prf#6563,rid#6564,c_name_prf#6565,c_nationkey_prf#6566,c_custkey_prf#6567,c_comment_prf#6568,c_address_prf#6569,c_mktsegment_prf#6570,c_phone_prf#6571] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6581]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#6583 AS o_shippriority_prf_2#6593, rid#6584 AS rid_2#6594, o_orderdate_prf#6585 AS o_orderdate_prf_2#6595, o_custkey_prf#6586 AS o_custkey_prf_2#6596, o_orderpriority_prf#6587 AS o_orderpriority_prf_2#6597, o_clerk_prf#6588 AS o_clerk_prf_2#6598, o_orderstatus_prf#6589 AS o_orderstatus_prf_2#6599, o_totalprice_prf#6590 AS o_totalprice_prf_2#6600, o_orderkey_prf#6591 AS o_orderkey_prf_2#6601, o_comment_prf#6592 AS o_comment_prf_2#6602]
               +- Relation[o_shippriority_prf#6583,rid#6584,o_orderdate_prf#6585,o_custkey_prf#6586,o_orderpriority_prf#6587,o_clerk_prf#6588,o_orderstatus_prf#6589,o_totalprice_prf#6590,o_orderkey_prf#6591,o_comment_prf#6592] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 83203ms

fr2d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderstatus = 'F' and o_orderkey = l_orderkey
19/10/17 01:45:31 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:45:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6677L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 01:45:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6677L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#6729]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [c_acctbal_prf#6679 AS c_acctbal_prf_0#6688, rid#6680 AS rid_0#6689, c_name_prf#6681 AS c_name_prf_0#6690, c_nationkey_prf#6682 AS c_nationkey_prf_0#6691, c_custkey_prf#6683 AS c_custkey_prf_0#6692, c_comment_prf#6684 AS c_comment_prf_0#6693, c_address_prf#6685 AS c_address_prf_0#6694, c_mktsegment_prf#6686 AS c_mktsegment_prf_0#6695, c_phone_prf#6687 AS c_phone_prf_0#6696]
         :     :  :  :  +- Relation[c_acctbal_prf#6679,rid#6680,c_name_prf#6681,c_nationkey_prf#6682,c_custkey_prf#6683,c_comment_prf#6684,c_address_prf#6685,c_mktsegment_prf#6686,c_phone_prf#6687] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#6707]
         :     :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#6706]
         :     :  :        :  +- Relation[c_acctbal_prf#6697,rid#6698,c_name_prf#6699,c_nationkey_prf#6700,c_custkey_prf#6701,c_comment_prf#6702,c_address_prf#6703,c_mktsegment_prf#6704,c_phone_prf#6705] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [o_shippriority_prf#6708 AS o_shippriority_prf_1#6718, rid#6709 AS rid_1#6719, o_orderdate_prf#6710 AS o_orderdate_prf_1#6720, o_custkey_prf#6711 AS o_custkey_prf_1#6721, o_orderpriority_prf#6712 AS o_orderpriority_prf_1#6722, o_clerk_prf#6713 AS o_clerk_prf_1#6723, o_orderstatus_prf#6714 AS o_orderstatus_prf_1#6724, o_totalprice_prf#6715 AS o_totalprice_prf_1#6725, o_orderkey_prf#6716 AS o_orderkey_prf_1#6726, o_comment_prf#6717 AS o_comment_prf_1#6727]
         :     :     :  +- Relation[o_shippriority_prf#6708,rid#6709,o_orderdate_prf#6710,o_custkey_prf#6711,o_orderpriority_prf#6712,o_clerk_prf#6713,o_orderstatus_prf#6714,o_totalprice_prf#6715,o_orderkey_prf#6716,o_comment_prf#6717] JDBCRelation(orders_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6728]
         :     :        +- DexRidFilter orders~o_orderstatus~F
         :     :           +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#6730 AS l_returnflag_prf_2#6749, l_orderkey_and_l_linenumber_prf#6731 AS l_orderkey_and_l_linenumber_prf_2#6750, l_comment_prf#6732 AS l_comment_prf_2#6751, l_linestatus_prf#6733 AS l_linestatus_prf_2#6752, rid#6734 AS rid_2#6753, l_shipmode_prf#6735 AS l_shipmode_prf_2#6754, l_shipinstruct_prf#6736 AS l_shipinstruct_prf_2#6755, l_quantity_prf#6737 AS l_quantity_prf_2#6756, l_receiptdate_prf#6738 AS l_receiptdate_prf_2#6757, l_linenumber_prf#6739 AS l_linenumber_prf_2#6758, l_tax_prf#6740 AS l_tax_prf_2#6759, l_shipdate_prf#6741 AS l_shipdate_prf_2#6760, l_extendedprice_prf#6742 AS l_extendedprice_prf_2#6761, l_partkey_prf#6743 AS l_partkey_prf_2#6762, l_discount_prf#6744 AS l_discount_prf_2#6763, l_partkey_and_l_suppkey_prf#6745 AS l_partkey_and_l_suppkey_prf_2#6764, l_commitdate_prf#6746 AS l_commitdate_prf_2#6765, l_suppkey_prf#6747 AS l_suppkey_prf_2#6766, l_orderkey_prf#6748 AS l_orderkey_prf_2#6767]
            +- Relation[l_returnflag_prf#6730,l_orderkey_and_l_linenumber_prf#6731,l_comment_prf#6732,l_linestatus_prf#6733,rid#6734,l_shipmode_prf#6735,l_shipinstruct_prf#6736,l_quantity_prf#6737,l_receiptdate_prf#6738,l_linenumber_prf#6739,l_tax_prf#6740,l_shipdate_prf#6741,l_extendedprice_prf#6742,l_partkey_prf#6743,l_discount_prf#6744,l_partkey_and_l_suppkey_prf#6745,l_commitdate_prf#6746,l_suppkey_prf#6747,l_orderkey_prf#6748] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 108098ms
query=fq1a, count=246415, duration=30826
query=fq1b, count=246415, duration=140041
query=fq1c, count=246415, duration=164028
query=fq1d, count=246415, duration=74464
query=fq1e, count=246415, duration=164911
query=fq1f, count=246415, duration=168388
query=fr1a, count=1214743, duration=121759
query=fr1b, count=1214743, duration=120592
query=fr1c, count=1214743, duration=83203
query=fr1d, count=1214743, duration=32917
query=fr1e, count=1214743, duration=152684
query=fr2a, count=2901744, duration=193766
query=fr2b, count=2901744, duration=105859
query=fr2d, count=2901744, duration=108098
query=fr2e, count=2901744, duration=96251
query=fr2f, count=2901744, duration=83411
query=fs1a, count=1214743, duration=108404
query=fs1b, count=1214743, duration=172886
query=fs1c, count=1214743, duration=172143
query=ft1a, count=2452200, duration=48209
query=ft1b, count=2452200, duration=30225
query=ft1c, count=2452200, duration=33595
query=ft1d, count=2452200, duration=24355
query=ft2a, count=15628, duration=49395
query=ft2b, count=15628, duration=906
query=ft2c, count=15628, duration=6975
query=ft3a, count=117754, duration=96485
query=ft3b, count=117754, duration=6183
query=ft3c, count=117754, duration=55867
