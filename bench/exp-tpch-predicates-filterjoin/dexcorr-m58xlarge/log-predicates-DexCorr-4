19/10/14 22:23:43 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7096ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Mon Oct 14 22:23:46 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Mon Oct 14 22:23:47 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Mon Oct 14 22:23:47 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Mon Oct 14 22:23:47 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Mon Oct 14 22:23:47 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Mon Oct 14 22:23:49 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Mon Oct 14 22:23:52 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Mon Oct 14 22:23:52 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/14 22:23:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:23:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1492L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 22:23:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1492L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#1510]
         :  :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#1502: string
         :  :  :     :- Project [ps_partkey_and_ps_suppkey_prf#1494 AS ps_partkey_and_ps_suppkey_prf_0#1501, rid#1495 AS rid_0#1502, ps_availqty_prf#1496 AS ps_availqty_prf_0#1503, ps_comment_prf#1497 AS ps_comment_prf_0#1504, ps_partkey_prf#1498 AS ps_partkey_prf_0#1505, ps_supplycost_prf#1499 AS ps_supplycost_prf_0#1506, ps_suppkey_prf#1500 AS ps_suppkey_prf_0#1507]
         :  :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#1494,rid#1495,ps_availqty_prf#1496,ps_comment_prf#1497,ps_partkey_prf#1498,ps_supplycost_prf#1499,ps_suppkey_prf#1500] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#1511 AS p_comment_prf_1#1521, p_name_prf#1512 AS p_name_prf_1#1522, rid#1513 AS rid_1#1523, p_type_prf#1514 AS p_type_prf_1#1524, p_retailprice_prf#1515 AS p_retailprice_prf_1#1525, p_mfgr_prf#1516 AS p_mfgr_prf_1#1526, p_container_prf#1517 AS p_container_prf_1#1527, p_brand_prf#1518 AS p_brand_prf_1#1528, p_size_prf#1519 AS p_size_prf_1#1529, p_partkey_prf#1520 AS p_partkey_prf_1#1530]
         :  :     +- Relation[p_comment_prf#1511,p_name_prf#1512,rid#1513,p_type_prf#1514,p_retailprice_prf#1515,p_mfgr_prf#1516,p_container_prf#1517,p_brand_prf#1518,p_size_prf#1519,p_partkey_prf#1520] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1509) AS rid_2#1539]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#1538]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#1531,rid#1532,ps_availqty_prf#1533,ps_comment_prf#1534,ps_partkey_prf#1535,ps_supplycost_prf#1536,ps_suppkey_prf#1537] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#1540 AS s_phone_prf_2#1548, rid#1541 AS rid_2#1549, s_address_prf#1542 AS s_address_prf_2#1550, s_nationkey_prf#1543 AS s_nationkey_prf_2#1551, s_suppkey_prf#1544 AS s_suppkey_prf_2#1552, s_name_prf#1545 AS s_name_prf_2#1553, s_acctbal_prf#1546 AS s_acctbal_prf_2#1554, s_comment_prf#1547 AS s_comment_prf_2#1555]
            +- Relation[s_phone_prf#1540,rid#1541,s_address_prf#1542,s_nationkey_prf#1543,s_suppkey_prf#1544,s_name_prf#1545,s_acctbal_prf#1546,s_comment_prf#1547] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 105332ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/14 22:25:38 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:25:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1598L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 22:25:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1598L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#1614]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#1608: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#1600 AS ps_partkey_and_ps_suppkey_prf_0#1607, rid#1601 AS rid_0#1608, ps_availqty_prf#1602 AS ps_availqty_prf_0#1609, ps_comment_prf#1603 AS ps_comment_prf_0#1610, ps_partkey_prf#1604 AS ps_partkey_prf_0#1611, ps_supplycost_prf#1605 AS ps_supplycost_prf_0#1612, ps_suppkey_prf#1606 AS ps_suppkey_prf_0#1613]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#1600,rid#1601,ps_availqty_prf#1602,ps_comment_prf#1603,ps_partkey_prf#1604,ps_supplycost_prf#1605,ps_suppkey_prf#1606] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#1615 AS p_comment_prf_1#1625, p_name_prf#1616 AS p_name_prf_1#1626, rid#1617 AS rid_1#1627, p_type_prf#1618 AS p_type_prf_1#1628, p_retailprice_prf#1619 AS p_retailprice_prf_1#1629, p_mfgr_prf#1620 AS p_mfgr_prf_1#1630, p_container_prf#1621 AS p_container_prf_1#1631, p_brand_prf#1622 AS p_brand_prf_1#1632, p_size_prf#1623 AS p_size_prf_1#1633, p_partkey_prf#1624 AS p_partkey_prf_1#1634]
            :  +- Relation[p_comment_prf#1615,p_name_prf#1616,rid#1617,p_type_prf#1618,p_retailprice_prf#1619,p_mfgr_prf#1620,p_container_prf#1621,p_brand_prf#1622,p_size_prf#1623,p_partkey_prf#1624] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#1637]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1635,value#1636] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 49517ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/14 22:26:28 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:26:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1681L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 22:26:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1681L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#1699]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#1692: string
         :     :- Project [s_phone_prf#1683 AS s_phone_prf_0#1691, rid#1684 AS rid_0#1692, s_address_prf#1685 AS s_address_prf_0#1693, s_nationkey_prf#1686 AS s_nationkey_prf_0#1694, s_suppkey_prf#1687 AS s_suppkey_prf_0#1695, s_name_prf#1688 AS s_name_prf_0#1696, s_acctbal_prf#1689 AS s_acctbal_prf_0#1697, s_comment_prf#1690 AS s_comment_prf_0#1698]
         :     :  +- Relation[s_phone_prf#1683,rid#1684,s_address_prf#1685,s_nationkey_prf#1686,s_suppkey_prf#1687,s_name_prf#1688,s_acctbal_prf#1689,s_comment_prf#1690] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1700 AS l_returnflag_prf_1#1719, l_orderkey_and_l_linenumber_prf#1701 AS l_orderkey_and_l_linenumber_prf_1#1720, l_comment_prf#1702 AS l_comment_prf_1#1721, l_linestatus_prf#1703 AS l_linestatus_prf_1#1722, rid#1704 AS rid_1#1723, l_shipmode_prf#1705 AS l_shipmode_prf_1#1724, l_shipinstruct_prf#1706 AS l_shipinstruct_prf_1#1725, l_quantity_prf#1707 AS l_quantity_prf_1#1726, l_receiptdate_prf#1708 AS l_receiptdate_prf_1#1727, l_linenumber_prf#1709 AS l_linenumber_prf_1#1728, l_tax_prf#1710 AS l_tax_prf_1#1729, l_shipdate_prf#1711 AS l_shipdate_prf_1#1730, l_extendedprice_prf#1712 AS l_extendedprice_prf_1#1731, l_partkey_prf#1713 AS l_partkey_prf_1#1732, l_discount_prf#1714 AS l_discount_prf_1#1733, l_partkey_and_l_suppkey_prf#1715 AS l_partkey_and_l_suppkey_prf_1#1734, l_commitdate_prf#1716 AS l_commitdate_prf_1#1735, l_suppkey_prf#1717 AS l_suppkey_prf_1#1736, l_orderkey_prf#1718 AS l_orderkey_prf_1#1737]
            +- Relation[l_returnflag_prf#1700,l_orderkey_and_l_linenumber_prf#1701,l_comment_prf#1702,l_linestatus_prf#1703,rid#1704,l_shipmode_prf#1705,l_shipinstruct_prf#1706,l_quantity_prf#1707,l_receiptdate_prf#1708,l_linenumber_prf#1709,l_tax_prf#1710,l_shipdate_prf#1711,l_extendedprice_prf#1712,l_partkey_prf#1713,l_discount_prf#1714,l_partkey_and_l_suppkey_prf#1715,l_commitdate_prf#1716,l_suppkey_prf#1717,l_orderkey_prf#1718] JDBCRelation(lineitem_prf) [numPartitions=1]

19/10/14 22:26:28 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=6001215
Elapsed time: 86561ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/14 22:27:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:27:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1775L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 22:27:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1775L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#1785]
         :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#1784: string
         :     :- Project [r_regionkey_prf#1777 AS r_regionkey_prf_0#1781, r_name_prf#1778 AS r_name_prf_0#1782, r_comment_prf#1779 AS r_comment_prf_0#1783, rid#1780 AS rid_0#1784]
         :     :  +- Relation[r_regionkey_prf#1777,r_name_prf#1778,r_comment_prf#1779,rid#1780] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#1786 AS rid_1#1791, n_regionkey_prf#1787 AS n_regionkey_prf_1#1792, n_nationkey_prf#1788 AS n_nationkey_prf_1#1793, n_name_prf#1789 AS n_name_prf_1#1794, n_comment_prf#1790 AS n_comment_prf_1#1795]
            +- Relation[rid#1786,n_regionkey_prf#1787,n_nationkey_prf#1788,n_name_prf#1789,n_comment_prf#1790] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=25
Elapsed time: 74ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/14 22:27:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:27:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1812L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 22:27:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1812L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#1814 AS rid_0#1819, n_regionkey_prf#1815 AS n_regionkey_prf_0#1820, n_nationkey_prf#1816 AS n_nationkey_prf_0#1821, n_name_prf#1817 AS n_name_prf_0#1822, n_comment_prf#1818 AS n_comment_prf_0#1823]
         :  +- Relation[rid#1814,n_regionkey_prf#1815,n_nationkey_prf#1816,n_name_prf#1817,n_comment_prf#1818] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1824]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1635,value#1636] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 53ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/14 22:27:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:27:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1849L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 22:27:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1849L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#1851 AS l_returnflag_prf_0#1870, l_orderkey_and_l_linenumber_prf#1852 AS l_orderkey_and_l_linenumber_prf_0#1871, l_comment_prf#1853 AS l_comment_prf_0#1872, l_linestatus_prf#1854 AS l_linestatus_prf_0#1873, rid#1855 AS rid_0#1874, l_shipmode_prf#1856 AS l_shipmode_prf_0#1875, l_shipinstruct_prf#1857 AS l_shipinstruct_prf_0#1876, l_quantity_prf#1858 AS l_quantity_prf_0#1877, l_receiptdate_prf#1859 AS l_receiptdate_prf_0#1878, l_linenumber_prf#1860 AS l_linenumber_prf_0#1879, l_tax_prf#1861 AS l_tax_prf_0#1880, l_shipdate_prf#1862 AS l_shipdate_prf_0#1881, l_extendedprice_prf#1863 AS l_extendedprice_prf_0#1882, l_partkey_prf#1864 AS l_partkey_prf_0#1883, l_discount_prf#1865 AS l_discount_prf_0#1884, l_partkey_and_l_suppkey_prf#1866 AS l_partkey_and_l_suppkey_prf_0#1885, l_commitdate_prf#1867 AS l_commitdate_prf_0#1886, l_suppkey_prf#1868 AS l_suppkey_prf_0#1887, l_orderkey_prf#1869 AS l_orderkey_prf_0#1888]
         :  +- Relation[l_returnflag_prf#1851,l_orderkey_and_l_linenumber_prf#1852,l_comment_prf#1853,l_linestatus_prf#1854,rid#1855,l_shipmode_prf#1856,l_shipinstruct_prf#1857,l_quantity_prf#1858,l_receiptdate_prf#1859,l_linenumber_prf#1860,l_tax_prf#1861,l_shipdate_prf#1862,l_extendedprice_prf#1863,l_partkey_prf#1864,l_discount_prf#1865,l_partkey_and_l_suppkey_prf#1866,l_commitdate_prf#1867,l_suppkey_prf#1868,l_orderkey_prf#1869] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1889]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1635,value#1636] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 23579ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/14 22:28:18 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:28:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1944L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 22:28:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1944L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#1962]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#1955: string
         :     :- Project [s_phone_prf#1946 AS s_phone_prf_0#1954, rid#1947 AS rid_0#1955, s_address_prf#1948 AS s_address_prf_0#1956, s_nationkey_prf#1949 AS s_nationkey_prf_0#1957, s_suppkey_prf#1950 AS s_suppkey_prf_0#1958, s_name_prf#1951 AS s_name_prf_0#1959, s_acctbal_prf#1952 AS s_acctbal_prf_0#1960, s_comment_prf#1953 AS s_comment_prf_0#1961]
         :     :  +- Relation[s_phone_prf#1946,rid#1947,s_address_prf#1948,s_nationkey_prf#1949,s_suppkey_prf#1950,s_name_prf#1951,s_acctbal_prf#1952,s_comment_prf#1953] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#2001]
            :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_1#1986: string
            :     :- Project [l_returnflag_prf#1963 AS l_returnflag_prf_1#1982, l_orderkey_and_l_linenumber_prf#1964 AS l_orderkey_and_l_linenumber_prf_1#1983, l_comment_prf#1965 AS l_comment_prf_1#1984, l_linestatus_prf#1966 AS l_linestatus_prf_1#1985, rid#1967 AS rid_1#1986, l_shipmode_prf#1968 AS l_shipmode_prf_1#1987, l_shipinstruct_prf#1969 AS l_shipinstruct_prf_1#1988, l_quantity_prf#1970 AS l_quantity_prf_1#1989, l_receiptdate_prf#1971 AS l_receiptdate_prf_1#1990, l_linenumber_prf#1972 AS l_linenumber_prf_1#1991, l_tax_prf#1973 AS l_tax_prf_1#1992, l_shipdate_prf#1974 AS l_shipdate_prf_1#1993, l_extendedprice_prf#1975 AS l_extendedprice_prf_1#1994, l_partkey_prf#1976 AS l_partkey_prf_1#1995, l_discount_prf#1977 AS l_discount_prf_1#1996, l_partkey_and_l_suppkey_prf#1978 AS l_partkey_and_l_suppkey_prf_1#1997, l_commitdate_prf#1979 AS l_commitdate_prf_1#1998, l_suppkey_prf#1980 AS l_suppkey_prf_1#1999, l_orderkey_prf#1981 AS l_orderkey_prf_1#2000]
            :     :  +- Relation[l_returnflag_prf#1963,l_orderkey_and_l_linenumber_prf#1964,l_comment_prf#1965,l_linestatus_prf#1966,rid#1967,l_shipmode_prf#1968,l_shipinstruct_prf#1969,l_quantity_prf#1970,l_receiptdate_prf#1971,l_linenumber_prf#1972,l_tax_prf#1973,l_shipdate_prf#1974,l_extendedprice_prf#1975,l_partkey_prf#1976,l_discount_prf#1977,l_partkey_and_l_suppkey_prf#1978,l_commitdate_prf#1979,l_suppkey_prf#1980,l_orderkey_prf#1981] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#2002 AS p_comment_prf_2#2012, p_name_prf#2003 AS p_name_prf_2#2013, rid#2004 AS rid_2#2014, p_type_prf#2005 AS p_type_prf_2#2015, p_retailprice_prf#2006 AS p_retailprice_prf_2#2016, p_mfgr_prf#2007 AS p_mfgr_prf_2#2017, p_container_prf#2008 AS p_container_prf_2#2018, p_brand_prf#2009 AS p_brand_prf_2#2019, p_size_prf#2010 AS p_size_prf_2#2020, p_partkey_prf#2011 AS p_partkey_prf_2#2021]
               +- Relation[p_comment_prf#2002,p_name_prf#2003,rid#2004,p_type_prf#2005,p_retailprice_prf#2006,p_mfgr_prf#2007,p_container_prf#2008,p_brand_prf#2009,p_size_prf#2010,p_partkey_prf#2011] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 186729ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/14 22:31:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:31:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2081L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 22:31:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2081L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_2#2101]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#2093: string
         :     :- Project [c_acctbal_prf#2083 AS c_acctbal_prf_0#2092, rid#2084 AS rid_0#2093, c_name_prf#2085 AS c_name_prf_0#2094, c_nationkey_prf#2086 AS c_nationkey_prf_0#2095, c_custkey_prf#2087 AS c_custkey_prf_0#2096, c_comment_prf#2088 AS c_comment_prf_0#2097, c_address_prf#2089 AS c_address_prf_0#2098, c_mktsegment_prf#2090 AS c_mktsegment_prf_0#2099, c_phone_prf#2091 AS c_phone_prf_0#2100]
         :     :  +- Relation[c_acctbal_prf#2083,rid#2084,c_name_prf#2085,c_nationkey_prf#2086,c_custkey_prf#2087,c_comment_prf#2088,c_address_prf#2089,c_mktsegment_prf#2090,c_phone_prf#2091] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#2118]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#2111: string
            :     :- Project [s_phone_prf#2102 AS s_phone_prf_1#2110, rid#2103 AS rid_1#2111, s_address_prf#2104 AS s_address_prf_1#2112, s_nationkey_prf#2105 AS s_nationkey_prf_1#2113, s_suppkey_prf#2106 AS s_suppkey_prf_1#2114, s_name_prf#2107 AS s_name_prf_1#2115, s_acctbal_prf#2108 AS s_acctbal_prf_1#2116, s_comment_prf#2109 AS s_comment_prf_1#2117]
            :     :  +- Relation[s_phone_prf#2102,rid#2103,s_address_prf#2104,s_nationkey_prf#2105,s_suppkey_prf#2106,s_name_prf#2107,s_acctbal_prf#2108,s_comment_prf#2109] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [rid#2119 AS rid_2#2124, n_regionkey_prf#2120 AS n_regionkey_prf_2#2125, n_nationkey_prf#2121 AS n_nationkey_prf_2#2126, n_name_prf#2122 AS n_name_prf_2#2127, n_comment_prf#2123 AS n_comment_prf_2#2128]
               +- Relation[rid#2119,n_regionkey_prf#2120,n_nationkey_prf#2121,n_name_prf#2122,n_comment_prf#2123] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 89031ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/14 22:32:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:32:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2173L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 22:32:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2173L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#2185]
         :  :  :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#2180: string
         :  :  :     :- Project [rid#2175 AS rid_0#2180, n_regionkey_prf#2176 AS n_regionkey_prf_0#2181, n_nationkey_prf#2177 AS n_nationkey_prf_0#2182, n_name_prf#2178 AS n_name_prf_0#2183, n_comment_prf#2179 AS n_comment_prf_0#2184]
         :  :  :     :  +- Relation[rid#2175,n_regionkey_prf#2176,n_nationkey_prf#2177,n_name_prf#2178,n_comment_prf#2179] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#2186 AS s_phone_prf_1#2194, rid#2187 AS rid_1#2195, s_address_prf#2188 AS s_address_prf_1#2196, s_nationkey_prf#2189 AS s_nationkey_prf_1#2197, s_suppkey_prf#2190 AS s_suppkey_prf_1#2198, s_name_prf#2191 AS s_name_prf_1#2199, s_acctbal_prf#2192 AS s_acctbal_prf_1#2200, s_comment_prf#2193 AS s_comment_prf_1#2201]
         :  :     +- Relation[s_phone_prf#2186,rid#2187,s_address_prf#2188,s_nationkey_prf#2189,s_suppkey_prf#2190,s_name_prf#2191,s_acctbal_prf#2192,s_comment_prf#2193] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1509) AS rid_2#2208]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2207]
         :        :  +- Relation[rid#2202,n_regionkey_prf#2203,n_nationkey_prf#2204,n_name_prf#2205,n_comment_prf#2206] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2209 AS c_acctbal_prf_2#2218, rid#2210 AS rid_2#2219, c_name_prf#2211 AS c_name_prf_2#2220, c_nationkey_prf#2212 AS c_nationkey_prf_2#2221, c_custkey_prf#2213 AS c_custkey_prf_2#2222, c_comment_prf#2214 AS c_comment_prf_2#2223, c_address_prf#2215 AS c_address_prf_2#2224, c_mktsegment_prf#2216 AS c_mktsegment_prf_2#2225, c_phone_prf#2217 AS c_phone_prf_2#2226]
            +- Relation[c_acctbal_prf#2209,rid#2210,c_name_prf#2211,c_nationkey_prf#2212,c_custkey_prf#2213,c_comment_prf#2214,c_address_prf#2215,c_mktsegment_prf#2216,c_phone_prf#2217] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 25622ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/14 22:33:19 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:33:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2285L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 22:33:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2285L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_2#2325]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2310: string
         :     :- Project [l_returnflag_prf#2287 AS l_returnflag_prf_0#2306, l_orderkey_and_l_linenumber_prf#2288 AS l_orderkey_and_l_linenumber_prf_0#2307, l_comment_prf#2289 AS l_comment_prf_0#2308, l_linestatus_prf#2290 AS l_linestatus_prf_0#2309, rid#2291 AS rid_0#2310, l_shipmode_prf#2292 AS l_shipmode_prf_0#2311, l_shipinstruct_prf#2293 AS l_shipinstruct_prf_0#2312, l_quantity_prf#2294 AS l_quantity_prf_0#2313, l_receiptdate_prf#2295 AS l_receiptdate_prf_0#2314, l_linenumber_prf#2296 AS l_linenumber_prf_0#2315, l_tax_prf#2297 AS l_tax_prf_0#2316, l_shipdate_prf#2298 AS l_shipdate_prf_0#2317, l_extendedprice_prf#2299 AS l_extendedprice_prf_0#2318, l_partkey_prf#2300 AS l_partkey_prf_0#2319, l_discount_prf#2301 AS l_discount_prf_0#2320, l_partkey_and_l_suppkey_prf#2302 AS l_partkey_and_l_suppkey_prf_0#2321, l_commitdate_prf#2303 AS l_commitdate_prf_0#2322, l_suppkey_prf#2304 AS l_suppkey_prf_0#2323, l_orderkey_prf#2305 AS l_orderkey_prf_0#2324]
         :     :  +- Relation[l_returnflag_prf#2287,l_orderkey_and_l_linenumber_prf#2288,l_comment_prf#2289,l_linestatus_prf#2290,rid#2291,l_shipmode_prf#2292,l_shipinstruct_prf#2293,l_quantity_prf#2294,l_receiptdate_prf#2295,l_linenumber_prf#2296,l_tax_prf#2297,l_shipdate_prf#2298,l_extendedprice_prf#2299,l_partkey_prf#2300,l_discount_prf#2301,l_partkey_and_l_suppkey_prf#2302,l_commitdate_prf#2303,l_suppkey_prf#2304,l_orderkey_prf#2305] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#2344]
            :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#2336: string
            :     :- Project [c_acctbal_prf#2326 AS c_acctbal_prf_1#2335, rid#2327 AS rid_1#2336, c_name_prf#2328 AS c_name_prf_1#2337, c_nationkey_prf#2329 AS c_nationkey_prf_1#2338, c_custkey_prf#2330 AS c_custkey_prf_1#2339, c_comment_prf#2331 AS c_comment_prf_1#2340, c_address_prf#2332 AS c_address_prf_1#2341, c_mktsegment_prf#2333 AS c_mktsegment_prf_1#2342, c_phone_prf#2334 AS c_phone_prf_1#2343]
            :     :  +- Relation[c_acctbal_prf#2326,rid#2327,c_name_prf#2328,c_nationkey_prf#2329,c_custkey_prf#2330,c_comment_prf#2331,c_address_prf#2332,c_mktsegment_prf#2333,c_phone_prf#2334] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2345 AS o_shippriority_prf_2#2355, rid#2346 AS rid_2#2356, o_orderdate_prf#2347 AS o_orderdate_prf_2#2357, o_custkey_prf#2348 AS o_custkey_prf_2#2358, o_orderpriority_prf#2349 AS o_orderpriority_prf_2#2359, o_clerk_prf#2350 AS o_clerk_prf_2#2360, o_orderstatus_prf#2351 AS o_orderstatus_prf_2#2361, o_totalprice_prf#2352 AS o_totalprice_prf_2#2362, o_orderkey_prf#2353 AS o_orderkey_prf_2#2363, o_comment_prf#2354 AS o_comment_prf_2#2364]
               +- Relation[o_shippriority_prf#2345,rid#2346,o_orderdate_prf#2347,o_custkey_prf#2348,o_orderpriority_prf#2349,o_clerk_prf#2350,o_orderstatus_prf#2351,o_totalprice_prf#2352,o_orderkey_prf#2353,o_comment_prf#2354] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 157930ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/14 22:35:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:35:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2427L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 22:35:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2427L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#2445]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#2438: string
         :     :- Project [s_phone_prf#2429 AS s_phone_prf_0#2437, rid#2430 AS rid_0#2438, s_address_prf#2431 AS s_address_prf_0#2439, s_nationkey_prf#2432 AS s_nationkey_prf_0#2440, s_suppkey_prf#2433 AS s_suppkey_prf_0#2441, s_name_prf#2434 AS s_name_prf_0#2442, s_acctbal_prf#2435 AS s_acctbal_prf_0#2443, s_comment_prf#2436 AS s_comment_prf_0#2444]
         :     :  +- Relation[s_phone_prf#2429,rid#2430,s_address_prf#2431,s_nationkey_prf#2432,s_suppkey_prf#2433,s_name_prf#2434,s_acctbal_prf#2435,s_comment_prf#2436] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#2460]
            :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_1#2454: string
            :     :- Project [ps_partkey_and_ps_suppkey_prf#2446 AS ps_partkey_and_ps_suppkey_prf_1#2453, rid#2447 AS rid_1#2454, ps_availqty_prf#2448 AS ps_availqty_prf_1#2455, ps_comment_prf#2449 AS ps_comment_prf_1#2456, ps_partkey_prf#2450 AS ps_partkey_prf_1#2457, ps_supplycost_prf#2451 AS ps_supplycost_prf_1#2458, ps_suppkey_prf#2452 AS ps_suppkey_prf_1#2459]
            :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2446,rid#2447,ps_availqty_prf#2448,ps_comment_prf#2449,ps_partkey_prf#2450,ps_supplycost_prf#2451,ps_suppkey_prf#2452] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#2461 AS p_comment_prf_2#2471, p_name_prf#2462 AS p_name_prf_2#2472, rid#2463 AS rid_2#2473, p_type_prf#2464 AS p_type_prf_2#2474, p_retailprice_prf#2465 AS p_retailprice_prf_2#2475, p_mfgr_prf#2466 AS p_mfgr_prf_2#2476, p_container_prf#2467 AS p_container_prf_2#2477, p_brand_prf#2468 AS p_brand_prf_2#2478, p_size_prf#2469 AS p_size_prf_2#2479, p_partkey_prf#2470 AS p_partkey_prf_2#2480]
               +- Relation[p_comment_prf#2461,p_name_prf#2462,rid#2463,p_type_prf#2464,p_retailprice_prf#2465,p_mfgr_prf#2466,p_container_prf#2467,p_brand_prf#2468,p_size_prf#2469,p_partkey_prf#2470] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 61585ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/14 22:36:59 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:36:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2523L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 22:36:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2523L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#2545]
         :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2537: string
         :     :- Project [p_comment_prf#2525 AS p_comment_prf_0#2535, p_name_prf#2526 AS p_name_prf_0#2536, rid#2527 AS rid_0#2537, p_type_prf#2528 AS p_type_prf_0#2538, p_retailprice_prf#2529 AS p_retailprice_prf_0#2539, p_mfgr_prf#2530 AS p_mfgr_prf_0#2540, p_container_prf#2531 AS p_container_prf_0#2541, p_brand_prf#2532 AS p_brand_prf_0#2542, p_size_prf#2533 AS p_size_prf_0#2543, p_partkey_prf#2534 AS p_partkey_prf_0#2544]
         :     :  +- Relation[p_comment_prf#2525,p_name_prf#2526,rid#2527,p_type_prf#2528,p_retailprice_prf#2529,p_mfgr_prf#2530,p_container_prf#2531,p_brand_prf#2532,p_size_prf#2533,p_partkey_prf#2534] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2546 AS ps_partkey_and_ps_suppkey_prf_1#2553, rid#2547 AS rid_1#2554, ps_availqty_prf#2548 AS ps_availqty_prf_1#2555, ps_comment_prf#2549 AS ps_comment_prf_1#2556, ps_partkey_prf#2550 AS ps_partkey_prf_1#2557, ps_supplycost_prf#2551 AS ps_supplycost_prf_1#2558, ps_suppkey_prf#2552 AS ps_suppkey_prf_1#2559]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2546,rid#2547,ps_availqty_prf#2548,ps_comment_prf#2549,ps_partkey_prf#2550,ps_supplycost_prf#2551,ps_suppkey_prf#2552] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 31625ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/14 22:37:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:37:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2612L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 22:37:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2612L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_2#2630]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#2623: string
         :     :- Project [s_phone_prf#2614 AS s_phone_prf_0#2622, rid#2615 AS rid_0#2623, s_address_prf#2616 AS s_address_prf_0#2624, s_nationkey_prf#2617 AS s_nationkey_prf_0#2625, s_suppkey_prf#2618 AS s_suppkey_prf_0#2626, s_name_prf#2619 AS s_name_prf_0#2627, s_acctbal_prf#2620 AS s_acctbal_prf_0#2628, s_comment_prf#2621 AS s_comment_prf_0#2629]
         :     :  +- Relation[s_phone_prf#2614,rid#2615,s_address_prf#2616,s_nationkey_prf#2617,s_suppkey_prf#2618,s_name_prf#2619,s_acctbal_prf#2620,s_comment_prf#2621] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#2651]
            :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#2643: string
            :     :- Project [p_comment_prf#2631 AS p_comment_prf_1#2641, p_name_prf#2632 AS p_name_prf_1#2642, rid#2633 AS rid_1#2643, p_type_prf#2634 AS p_type_prf_1#2644, p_retailprice_prf#2635 AS p_retailprice_prf_1#2645, p_mfgr_prf#2636 AS p_mfgr_prf_1#2646, p_container_prf#2637 AS p_container_prf_1#2647, p_brand_prf#2638 AS p_brand_prf_1#2648, p_size_prf#2639 AS p_size_prf_1#2649, p_partkey_prf#2640 AS p_partkey_prf_1#2650]
            :     :  +- Relation[p_comment_prf#2631,p_name_prf#2632,rid#2633,p_type_prf#2634,p_retailprice_prf#2635,p_mfgr_prf#2636,p_container_prf#2637,p_brand_prf#2638,p_size_prf#2639,p_partkey_prf#2640] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2652 AS l_returnflag_prf_2#2671, l_orderkey_and_l_linenumber_prf#2653 AS l_orderkey_and_l_linenumber_prf_2#2672, l_comment_prf#2654 AS l_comment_prf_2#2673, l_linestatus_prf#2655 AS l_linestatus_prf_2#2674, rid#2656 AS rid_2#2675, l_shipmode_prf#2657 AS l_shipmode_prf_2#2676, l_shipinstruct_prf#2658 AS l_shipinstruct_prf_2#2677, l_quantity_prf#2659 AS l_quantity_prf_2#2678, l_receiptdate_prf#2660 AS l_receiptdate_prf_2#2679, l_linenumber_prf#2661 AS l_linenumber_prf_2#2680, l_tax_prf#2662 AS l_tax_prf_2#2681, l_shipdate_prf#2663 AS l_shipdate_prf_2#2682, l_extendedprice_prf#2664 AS l_extendedprice_prf_2#2683, l_partkey_prf#2665 AS l_partkey_prf_2#2684, l_discount_prf#2666 AS l_discount_prf_2#2685, l_partkey_and_l_suppkey_prf#2667 AS l_partkey_and_l_suppkey_prf_2#2686, l_commitdate_prf#2668 AS l_commitdate_prf_2#2687, l_suppkey_prf#2669 AS l_suppkey_prf_2#2688, l_orderkey_prf#2670 AS l_orderkey_prf_2#2689]
               +- Relation[l_returnflag_prf#2652,l_orderkey_and_l_linenumber_prf#2653,l_comment_prf#2654,l_linestatus_prf#2655,rid#2656,l_shipmode_prf#2657,l_shipinstruct_prf#2658,l_quantity_prf#2659,l_receiptdate_prf#2660,l_linenumber_prf#2661,l_tax_prf#2662,l_shipdate_prf#2663,l_extendedprice_prf#2664,l_partkey_prf#2665,l_discount_prf#2666,l_partkey_and_l_suppkey_prf#2667,l_commitdate_prf#2668,l_suppkey_prf#2669,l_orderkey_prf#2670] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 193016ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/14 22:40:43 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:40:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2763L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 22:40:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2763L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#2803]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2788: string
         :  :  :     :- Project [l_returnflag_prf#2765 AS l_returnflag_prf_0#2784, l_orderkey_and_l_linenumber_prf#2766 AS l_orderkey_and_l_linenumber_prf_0#2785, l_comment_prf#2767 AS l_comment_prf_0#2786, l_linestatus_prf#2768 AS l_linestatus_prf_0#2787, rid#2769 AS rid_0#2788, l_shipmode_prf#2770 AS l_shipmode_prf_0#2789, l_shipinstruct_prf#2771 AS l_shipinstruct_prf_0#2790, l_quantity_prf#2772 AS l_quantity_prf_0#2791, l_receiptdate_prf#2773 AS l_receiptdate_prf_0#2792, l_linenumber_prf#2774 AS l_linenumber_prf_0#2793, l_tax_prf#2775 AS l_tax_prf_0#2794, l_shipdate_prf#2776 AS l_shipdate_prf_0#2795, l_extendedprice_prf#2777 AS l_extendedprice_prf_0#2796, l_partkey_prf#2778 AS l_partkey_prf_0#2797, l_discount_prf#2779 AS l_discount_prf_0#2798, l_partkey_and_l_suppkey_prf#2780 AS l_partkey_and_l_suppkey_prf_0#2799, l_commitdate_prf#2781 AS l_commitdate_prf_0#2800, l_suppkey_prf#2782 AS l_suppkey_prf_0#2801, l_orderkey_prf#2783 AS l_orderkey_prf_0#2802]
         :  :  :     :  +- Relation[l_returnflag_prf#2765,l_orderkey_and_l_linenumber_prf#2766,l_comment_prf#2767,l_linestatus_prf#2768,rid#2769,l_shipmode_prf#2770,l_shipinstruct_prf#2771,l_quantity_prf#2772,l_receiptdate_prf#2773,l_linenumber_prf#2774,l_tax_prf#2775,l_shipdate_prf#2776,l_extendedprice_prf#2777,l_partkey_prf#2778,l_discount_prf#2779,l_partkey_and_l_suppkey_prf#2780,l_commitdate_prf#2781,l_suppkey_prf#2782,l_orderkey_prf#2783] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#2804 AS o_shippriority_prf_1#2814, rid#2805 AS rid_1#2815, o_orderdate_prf#2806 AS o_orderdate_prf_1#2816, o_custkey_prf#2807 AS o_custkey_prf_1#2817, o_orderpriority_prf#2808 AS o_orderpriority_prf_1#2818, o_clerk_prf#2809 AS o_clerk_prf_1#2819, o_orderstatus_prf#2810 AS o_orderstatus_prf_1#2820, o_totalprice_prf#2811 AS o_totalprice_prf_1#2821, o_orderkey_prf#2812 AS o_orderkey_prf_1#2822, o_comment_prf#2813 AS o_comment_prf_1#2823]
         :  :     +- Relation[o_shippriority_prf#2804,rid#2805,o_orderdate_prf#2806,o_custkey_prf#2807,o_orderpriority_prf#2808,o_clerk_prf#2809,o_orderstatus_prf#2810,o_totalprice_prf#2811,o_orderkey_prf#2812,o_comment_prf#2813] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#2835]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2834]
         :        :  +- Relation[o_shippriority_prf#2824,rid#2825,o_orderdate_prf#2826,o_custkey_prf#2827,o_orderpriority_prf#2828,o_clerk_prf#2829,o_orderstatus_prf#2830,o_totalprice_prf#2831,o_orderkey_prf#2832,o_comment_prf#2833] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2836 AS c_acctbal_prf_2#2845, rid#2837 AS rid_2#2846, c_name_prf#2838 AS c_name_prf_2#2847, c_nationkey_prf#2839 AS c_nationkey_prf_2#2848, c_custkey_prf#2840 AS c_custkey_prf_2#2849, c_comment_prf#2841 AS c_comment_prf_2#2850, c_address_prf#2842 AS c_address_prf_2#2851, c_mktsegment_prf#2843 AS c_mktsegment_prf_2#2852, c_phone_prf#2844 AS c_phone_prf_2#2853]
            +- Relation[c_acctbal_prf#2836,rid#2837,c_name_prf#2838,c_nationkey_prf#2839,c_custkey_prf#2840,c_comment_prf#2841,c_address_prf#2842,c_mktsegment_prf#2843,c_phone_prf#2844] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 169726ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/14 22:43:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:43:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2927L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 22:43:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2927L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#2967]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#2952: string
         :  :  :     :- Project [l_returnflag_prf#2929 AS l_returnflag_prf_0#2948, l_orderkey_and_l_linenumber_prf#2930 AS l_orderkey_and_l_linenumber_prf_0#2949, l_comment_prf#2931 AS l_comment_prf_0#2950, l_linestatus_prf#2932 AS l_linestatus_prf_0#2951, rid#2933 AS rid_0#2952, l_shipmode_prf#2934 AS l_shipmode_prf_0#2953, l_shipinstruct_prf#2935 AS l_shipinstruct_prf_0#2954, l_quantity_prf#2936 AS l_quantity_prf_0#2955, l_receiptdate_prf#2937 AS l_receiptdate_prf_0#2956, l_linenumber_prf#2938 AS l_linenumber_prf_0#2957, l_tax_prf#2939 AS l_tax_prf_0#2958, l_shipdate_prf#2940 AS l_shipdate_prf_0#2959, l_extendedprice_prf#2941 AS l_extendedprice_prf_0#2960, l_partkey_prf#2942 AS l_partkey_prf_0#2961, l_discount_prf#2943 AS l_discount_prf_0#2962, l_partkey_and_l_suppkey_prf#2944 AS l_partkey_and_l_suppkey_prf_0#2963, l_commitdate_prf#2945 AS l_commitdate_prf_0#2964, l_suppkey_prf#2946 AS l_suppkey_prf_0#2965, l_orderkey_prf#2947 AS l_orderkey_prf_0#2966]
         :  :  :     :  +- Relation[l_returnflag_prf#2929,l_orderkey_and_l_linenumber_prf#2930,l_comment_prf#2931,l_linestatus_prf#2932,rid#2933,l_shipmode_prf#2934,l_shipinstruct_prf#2935,l_quantity_prf#2936,l_receiptdate_prf#2937,l_linenumber_prf#2938,l_tax_prf#2939,l_shipdate_prf#2940,l_extendedprice_prf#2941,l_partkey_prf#2942,l_discount_prf#2943,l_partkey_and_l_suppkey_prf#2944,l_commitdate_prf#2945,l_suppkey_prf#2946,l_orderkey_prf#2947] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#2968 AS p_comment_prf_1#2978, p_name_prf#2969 AS p_name_prf_1#2979, rid#2970 AS rid_1#2980, p_type_prf#2971 AS p_type_prf_1#2981, p_retailprice_prf#2972 AS p_retailprice_prf_1#2982, p_mfgr_prf#2973 AS p_mfgr_prf_1#2983, p_container_prf#2974 AS p_container_prf_1#2984, p_brand_prf#2975 AS p_brand_prf_1#2985, p_size_prf#2976 AS p_size_prf_1#2986, p_partkey_prf#2977 AS p_partkey_prf_1#2987]
         :  :     +- Relation[p_comment_prf#2968,p_name_prf#2969,rid#2970,p_type_prf#2971,p_retailprice_prf#2972,p_mfgr_prf#2973,p_container_prf#2974,p_brand_prf#2975,p_size_prf#2976,p_partkey_prf#2977] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1509) AS rid_2#3008]
         :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3007]
         :        :  +- Relation[l_returnflag_prf#2988,l_orderkey_and_l_linenumber_prf#2989,l_comment_prf#2990,l_linestatus_prf#2991,rid#2992,l_shipmode_prf#2993,l_shipinstruct_prf#2994,l_quantity_prf#2995,l_receiptdate_prf#2996,l_linenumber_prf#2997,l_tax_prf#2998,l_shipdate_prf#2999,l_extendedprice_prf#3000,l_partkey_prf#3001,l_discount_prf#3002,l_partkey_and_l_suppkey_prf#3003,l_commitdate_prf#3004,l_suppkey_prf#3005,l_orderkey_prf#3006] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3009 AS s_phone_prf_2#3017, rid#3010 AS rid_2#3018, s_address_prf#3011 AS s_address_prf_2#3019, s_nationkey_prf#3012 AS s_nationkey_prf_2#3020, s_suppkey_prf#3013 AS s_suppkey_prf_2#3021, s_name_prf#3014 AS s_name_prf_2#3022, s_acctbal_prf#3015 AS s_acctbal_prf_2#3023, s_comment_prf#3016 AS s_comment_prf_2#3024]
            +- Relation[s_phone_prf#3009,rid#3010,s_address_prf#3011,s_nationkey_prf#3012,s_suppkey_prf#3013,s_name_prf#3014,s_acctbal_prf#3015,s_comment_prf#3016] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 222584ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/14 22:47:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:47:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3090L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 22:47:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3090L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#3131]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3115: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#3092 AS l_returnflag_prf_0#3111, l_orderkey_and_l_linenumber_prf#3093 AS l_orderkey_and_l_linenumber_prf_0#3112, l_comment_prf#3094 AS l_comment_prf_0#3113, l_linestatus_prf#3095 AS l_linestatus_prf_0#3114, rid#3096 AS rid_0#3115, l_shipmode_prf#3097 AS l_shipmode_prf_0#3116, l_shipinstruct_prf#3098 AS l_shipinstruct_prf_0#3117, l_quantity_prf#3099 AS l_quantity_prf_0#3118, l_receiptdate_prf#3100 AS l_receiptdate_prf_0#3119, l_linenumber_prf#3101 AS l_linenumber_prf_0#3120, l_tax_prf#3102 AS l_tax_prf_0#3121, l_shipdate_prf#3103 AS l_shipdate_prf_0#3122, l_extendedprice_prf#3104 AS l_extendedprice_prf_0#3123, l_partkey_prf#3105 AS l_partkey_prf_0#3124, l_discount_prf#3106 AS l_discount_prf_0#3125, l_partkey_and_l_suppkey_prf#3107 AS l_partkey_and_l_suppkey_prf_0#3126, l_commitdate_prf#3108 AS l_commitdate_prf_0#3127, l_suppkey_prf#3109 AS l_suppkey_prf_0#3128, l_orderkey_prf#3110 AS l_orderkey_prf_0#3129]
         :     :  :  +- Relation[l_returnflag_prf#3092,l_orderkey_and_l_linenumber_prf#3093,l_comment_prf#3094,l_linestatus_prf#3095,rid#3096,l_shipmode_prf#3097,l_shipinstruct_prf#3098,l_quantity_prf#3099,l_receiptdate_prf#3100,l_linenumber_prf#3101,l_tax_prf#3102,l_shipdate_prf#3103,l_extendedprice_prf#3104,l_partkey_prf#3105,l_discount_prf#3106,l_partkey_and_l_suppkey_prf#3107,l_commitdate_prf#3108,l_suppkey_prf#3109,l_orderkey_prf#3110] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3130]
         :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :        +- Relation[label#1635,value#1636] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3132 AS o_shippriority_prf_1#3142, rid#3133 AS rid_1#3143, o_orderdate_prf#3134 AS o_orderdate_prf_1#3144, o_custkey_prf#3135 AS o_custkey_prf_1#3145, o_orderpriority_prf#3136 AS o_orderpriority_prf_1#3146, o_clerk_prf#3137 AS o_clerk_prf_1#3147, o_orderstatus_prf#3138 AS o_orderstatus_prf_1#3148, o_totalprice_prf#3139 AS o_totalprice_prf_1#3149, o_orderkey_prf#3140 AS o_orderkey_prf_1#3150, o_comment_prf#3141 AS o_comment_prf_1#3151]
            +- Relation[o_shippriority_prf#3132,rid#3133,o_orderdate_prf#3134,o_custkey_prf#3135,o_orderpriority_prf#3136,o_clerk_prf#3137,o_orderstatus_prf#3138,o_totalprice_prf#3139,o_orderkey_prf#3140,o_comment_prf#3141] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 54278ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/14 22:48:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:48:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3209L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 22:48:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3209L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#3231]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#3222: string
         :     :- Project [o_shippriority_prf#3211 AS o_shippriority_prf_0#3221, rid#3212 AS rid_0#3222, o_orderdate_prf#3213 AS o_orderdate_prf_0#3223, o_custkey_prf#3214 AS o_custkey_prf_0#3224, o_orderpriority_prf#3215 AS o_orderpriority_prf_0#3225, o_clerk_prf#3216 AS o_clerk_prf_0#3226, o_orderstatus_prf#3217 AS o_orderstatus_prf_0#3227, o_totalprice_prf#3218 AS o_totalprice_prf_0#3228, o_orderkey_prf#3219 AS o_orderkey_prf_0#3229, o_comment_prf#3220 AS o_comment_prf_0#3230]
         :     :  +- Relation[o_shippriority_prf#3211,rid#3212,o_orderdate_prf#3213,o_custkey_prf#3214,o_orderpriority_prf#3215,o_clerk_prf#3216,o_orderstatus_prf#3217,o_totalprice_prf#3218,o_orderkey_prf#3219,o_comment_prf#3220] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3232 AS l_returnflag_prf_1#3251, l_orderkey_and_l_linenumber_prf#3233 AS l_orderkey_and_l_linenumber_prf_1#3252, l_comment_prf#3234 AS l_comment_prf_1#3253, l_linestatus_prf#3235 AS l_linestatus_prf_1#3254, rid#3236 AS rid_1#3255, l_shipmode_prf#3237 AS l_shipmode_prf_1#3256, l_shipinstruct_prf#3238 AS l_shipinstruct_prf_1#3257, l_quantity_prf#3239 AS l_quantity_prf_1#3258, l_receiptdate_prf#3240 AS l_receiptdate_prf_1#3259, l_linenumber_prf#3241 AS l_linenumber_prf_1#3260, l_tax_prf#3242 AS l_tax_prf_1#3261, l_shipdate_prf#3243 AS l_shipdate_prf_1#3262, l_extendedprice_prf#3244 AS l_extendedprice_prf_1#3263, l_partkey_prf#3245 AS l_partkey_prf_1#3264, l_discount_prf#3246 AS l_discount_prf_1#3265, l_partkey_and_l_suppkey_prf#3247 AS l_partkey_and_l_suppkey_prf_1#3266, l_commitdate_prf#3248 AS l_commitdate_prf_1#3267, l_suppkey_prf#3249 AS l_suppkey_prf_1#3268, l_orderkey_prf#3250 AS l_orderkey_prf_1#3269]
            +- Relation[l_returnflag_prf#3232,l_orderkey_and_l_linenumber_prf#3233,l_comment_prf#3234,l_linestatus_prf#3235,rid#3236,l_shipmode_prf#3237,l_shipinstruct_prf#3238,l_quantity_prf#3239,l_receiptdate_prf#3240,l_linenumber_prf#3241,l_tax_prf#3242,l_shipdate_prf#3243,l_extendedprice_prf#3244,l_partkey_prf#3245,l_discount_prf#3246,l_partkey_and_l_suppkey_prf#3247,l_commitdate_prf#3248,l_suppkey_prf#3249,l_orderkey_prf#3250] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 195084ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/14 22:51:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:51:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3335L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 22:51:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3335L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#3375]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3360: string
         :     :- Project [l_returnflag_prf#3337 AS l_returnflag_prf_0#3356, l_orderkey_and_l_linenumber_prf#3338 AS l_orderkey_and_l_linenumber_prf_0#3357, l_comment_prf#3339 AS l_comment_prf_0#3358, l_linestatus_prf#3340 AS l_linestatus_prf_0#3359, rid#3341 AS rid_0#3360, l_shipmode_prf#3342 AS l_shipmode_prf_0#3361, l_shipinstruct_prf#3343 AS l_shipinstruct_prf_0#3362, l_quantity_prf#3344 AS l_quantity_prf_0#3363, l_receiptdate_prf#3345 AS l_receiptdate_prf_0#3364, l_linenumber_prf#3346 AS l_linenumber_prf_0#3365, l_tax_prf#3347 AS l_tax_prf_0#3366, l_shipdate_prf#3348 AS l_shipdate_prf_0#3367, l_extendedprice_prf#3349 AS l_extendedprice_prf_0#3368, l_partkey_prf#3350 AS l_partkey_prf_0#3369, l_discount_prf#3351 AS l_discount_prf_0#3370, l_partkey_and_l_suppkey_prf#3352 AS l_partkey_and_l_suppkey_prf_0#3371, l_commitdate_prf#3353 AS l_commitdate_prf_0#3372, l_suppkey_prf#3354 AS l_suppkey_prf_0#3373, l_orderkey_prf#3355 AS l_orderkey_prf_0#3374]
         :     :  +- Relation[l_returnflag_prf#3337,l_orderkey_and_l_linenumber_prf#3338,l_comment_prf#3339,l_linestatus_prf#3340,rid#3341,l_shipmode_prf#3342,l_shipinstruct_prf#3343,l_quantity_prf#3344,l_receiptdate_prf#3345,l_linenumber_prf#3346,l_tax_prf#3347,l_shipdate_prf#3348,l_extendedprice_prf#3349,l_partkey_prf#3350,l_discount_prf#3351,l_partkey_and_l_suppkey_prf#3352,l_commitdate_prf#3353,l_suppkey_prf#3354,l_orderkey_prf#3355] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#3396]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#3387: string
            :     :- Project [o_shippriority_prf#3376 AS o_shippriority_prf_1#3386, rid#3377 AS rid_1#3387, o_orderdate_prf#3378 AS o_orderdate_prf_1#3388, o_custkey_prf#3379 AS o_custkey_prf_1#3389, o_orderpriority_prf#3380 AS o_orderpriority_prf_1#3390, o_clerk_prf#3381 AS o_clerk_prf_1#3391, o_orderstatus_prf#3382 AS o_orderstatus_prf_1#3392, o_totalprice_prf#3383 AS o_totalprice_prf_1#3393, o_orderkey_prf#3384 AS o_orderkey_prf_1#3394, o_comment_prf#3385 AS o_comment_prf_1#3395]
            :     :  +- Relation[o_shippriority_prf#3376,rid#3377,o_orderdate_prf#3378,o_custkey_prf#3379,o_orderpriority_prf#3380,o_clerk_prf#3381,o_orderstatus_prf#3382,o_totalprice_prf#3383,o_orderkey_prf#3384,o_comment_prf#3385] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#3397 AS c_acctbal_prf_2#3406, rid#3398 AS rid_2#3407, c_name_prf#3399 AS c_name_prf_2#3408, c_nationkey_prf#3400 AS c_nationkey_prf_2#3409, c_custkey_prf#3401 AS c_custkey_prf_2#3410, c_comment_prf#3402 AS c_comment_prf_2#3411, c_address_prf#3403 AS c_address_prf_2#3412, c_mktsegment_prf#3404 AS c_mktsegment_prf_2#3413, c_phone_prf#3405 AS c_phone_prf_2#3414]
               +- Relation[c_acctbal_prf#3397,rid#3398,c_name_prf#3399,c_nationkey_prf#3400,c_custkey_prf#3401,c_comment_prf#3402,c_address_prf#3403,c_mktsegment_prf#3404,c_phone_prf#3405] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 148131ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/14 22:53:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:53:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3473L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 22:53:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3473L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#3493]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3485: string
         :     :- Project [c_acctbal_prf#3475 AS c_acctbal_prf_0#3484, rid#3476 AS rid_0#3485, c_name_prf#3477 AS c_name_prf_0#3486, c_nationkey_prf#3478 AS c_nationkey_prf_0#3487, c_custkey_prf#3479 AS c_custkey_prf_0#3488, c_comment_prf#3480 AS c_comment_prf_0#3489, c_address_prf#3481 AS c_address_prf_0#3490, c_mktsegment_prf#3482 AS c_mktsegment_prf_0#3491, c_phone_prf#3483 AS c_phone_prf_0#3492]
         :     :  +- Relation[c_acctbal_prf#3475,rid#3476,c_name_prf#3477,c_nationkey_prf#3478,c_custkey_prf#3479,c_comment_prf#3480,c_address_prf#3481,c_mktsegment_prf#3482,c_phone_prf#3483] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3494 AS o_shippriority_prf_1#3504, rid#3495 AS rid_1#3505, o_orderdate_prf#3496 AS o_orderdate_prf_1#3506, o_custkey_prf#3497 AS o_custkey_prf_1#3507, o_orderpriority_prf#3498 AS o_orderpriority_prf_1#3508, o_clerk_prf#3499 AS o_clerk_prf_1#3509, o_orderstatus_prf#3500 AS o_orderstatus_prf_1#3510, o_totalprice_prf#3501 AS o_totalprice_prf_1#3511, o_orderkey_prf#3502 AS o_orderkey_prf_1#3512, o_comment_prf#3503 AS o_comment_prf_1#3513]
            +- Relation[o_shippriority_prf#3494,rid#3495,o_orderdate_prf#3496,o_custkey_prf#3497,o_orderpriority_prf#3498,o_clerk_prf#3499,o_orderstatus_prf#3500,o_totalprice_prf#3501,o_orderkey_prf#3502,o_comment_prf#3503] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1500000
Elapsed time: 40183ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/14 22:54:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:54:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3557L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 22:54:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3557L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_2#3575]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#3568: string
         :     :- Project [s_phone_prf#3559 AS s_phone_prf_0#3567, rid#3560 AS rid_0#3568, s_address_prf#3561 AS s_address_prf_0#3569, s_nationkey_prf#3562 AS s_nationkey_prf_0#3570, s_suppkey_prf#3563 AS s_suppkey_prf_0#3571, s_name_prf#3564 AS s_name_prf_0#3572, s_acctbal_prf#3565 AS s_acctbal_prf_0#3573, s_comment_prf#3566 AS s_comment_prf_0#3574]
         :     :  +- Relation[s_phone_prf#3559,rid#3560,s_address_prf#3561,s_nationkey_prf#3562,s_suppkey_prf#3563,s_name_prf#3564,s_acctbal_prf#3565,s_comment_prf#3566] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#3596]
            :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#3588: string
            :     :- Project [p_comment_prf#3576 AS p_comment_prf_1#3586, p_name_prf#3577 AS p_name_prf_1#3587, rid#3578 AS rid_1#3588, p_type_prf#3579 AS p_type_prf_1#3589, p_retailprice_prf#3580 AS p_retailprice_prf_1#3590, p_mfgr_prf#3581 AS p_mfgr_prf_1#3591, p_container_prf#3582 AS p_container_prf_1#3592, p_brand_prf#3583 AS p_brand_prf_1#3593, p_size_prf#3584 AS p_size_prf_1#3594, p_partkey_prf#3585 AS p_partkey_prf_1#3595]
            :     :  +- Relation[p_comment_prf#3576,p_name_prf#3577,rid#3578,p_type_prf#3579,p_retailprice_prf#3580,p_mfgr_prf#3581,p_container_prf#3582,p_brand_prf#3583,p_size_prf#3584,p_partkey_prf#3585] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#3597 AS ps_partkey_and_ps_suppkey_prf_2#3604, rid#3598 AS rid_2#3605, ps_availqty_prf#3599 AS ps_availqty_prf_2#3606, ps_comment_prf#3600 AS ps_comment_prf_2#3607, ps_partkey_prf#3601 AS ps_partkey_prf_2#3608, ps_supplycost_prf#3602 AS ps_supplycost_prf_2#3609, ps_suppkey_prf#3603 AS ps_suppkey_prf_2#3610]
               +- Relation[ps_partkey_and_ps_suppkey_prf#3597,rid#3598,ps_availqty_prf#3599,ps_comment_prf#3600,ps_partkey_prf#3601,ps_supplycost_prf#3602,ps_suppkey_prf#3603] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 42794ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/14 22:55:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:55:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3672L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 22:55:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3672L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_2#3692]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3684: string
         :     :- Project [c_acctbal_prf#3674 AS c_acctbal_prf_0#3683, rid#3675 AS rid_0#3684, c_name_prf#3676 AS c_name_prf_0#3685, c_nationkey_prf#3677 AS c_nationkey_prf_0#3686, c_custkey_prf#3678 AS c_custkey_prf_0#3687, c_comment_prf#3679 AS c_comment_prf_0#3688, c_address_prf#3680 AS c_address_prf_0#3689, c_mktsegment_prf#3681 AS c_mktsegment_prf_0#3690, c_phone_prf#3682 AS c_phone_prf_0#3691]
         :     :  +- Relation[c_acctbal_prf#3674,rid#3675,c_name_prf#3676,c_nationkey_prf#3677,c_custkey_prf#3678,c_comment_prf#3679,c_address_prf#3680,c_mktsegment_prf#3681,c_phone_prf#3682] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#3731]
            :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_1#3716: string
            :     :- Project [l_returnflag_prf#3693 AS l_returnflag_prf_1#3712, l_orderkey_and_l_linenumber_prf#3694 AS l_orderkey_and_l_linenumber_prf_1#3713, l_comment_prf#3695 AS l_comment_prf_1#3714, l_linestatus_prf#3696 AS l_linestatus_prf_1#3715, rid#3697 AS rid_1#3716, l_shipmode_prf#3698 AS l_shipmode_prf_1#3717, l_shipinstruct_prf#3699 AS l_shipinstruct_prf_1#3718, l_quantity_prf#3700 AS l_quantity_prf_1#3719, l_receiptdate_prf#3701 AS l_receiptdate_prf_1#3720, l_linenumber_prf#3702 AS l_linenumber_prf_1#3721, l_tax_prf#3703 AS l_tax_prf_1#3722, l_shipdate_prf#3704 AS l_shipdate_prf_1#3723, l_extendedprice_prf#3705 AS l_extendedprice_prf_1#3724, l_partkey_prf#3706 AS l_partkey_prf_1#3725, l_discount_prf#3707 AS l_discount_prf_1#3726, l_partkey_and_l_suppkey_prf#3708 AS l_partkey_and_l_suppkey_prf_1#3727, l_commitdate_prf#3709 AS l_commitdate_prf_1#3728, l_suppkey_prf#3710 AS l_suppkey_prf_1#3729, l_orderkey_prf#3711 AS l_orderkey_prf_1#3730]
            :     :  +- Relation[l_returnflag_prf#3693,l_orderkey_and_l_linenumber_prf#3694,l_comment_prf#3695,l_linestatus_prf#3696,rid#3697,l_shipmode_prf#3698,l_shipinstruct_prf#3699,l_quantity_prf#3700,l_receiptdate_prf#3701,l_linenumber_prf#3702,l_tax_prf#3703,l_shipdate_prf#3704,l_extendedprice_prf#3705,l_partkey_prf#3706,l_discount_prf#3707,l_partkey_and_l_suppkey_prf#3708,l_commitdate_prf#3709,l_suppkey_prf#3710,l_orderkey_prf#3711] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3732 AS o_shippriority_prf_2#3742, rid#3733 AS rid_2#3743, o_orderdate_prf#3734 AS o_orderdate_prf_2#3744, o_custkey_prf#3735 AS o_custkey_prf_2#3745, o_orderpriority_prf#3736 AS o_orderpriority_prf_2#3746, o_clerk_prf#3737 AS o_clerk_prf_2#3747, o_orderstatus_prf#3738 AS o_orderstatus_prf_2#3748, o_totalprice_prf#3739 AS o_totalprice_prf_2#3749, o_orderkey_prf#3740 AS o_orderkey_prf_2#3750, o_comment_prf#3741 AS o_comment_prf_2#3751]
               +- Relation[o_shippriority_prf#3732,rid#3733,o_orderdate_prf#3734,o_custkey_prf#3735,o_orderpriority_prf#3736,o_clerk_prf#3737,o_orderstatus_prf#3738,o_totalprice_prf#3739,o_orderkey_prf#3740,o_comment_prf#3741] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 157264ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/14 22:57:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:57:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3826L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 22:57:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3826L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#3846]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3838: string
         :     :- Project [c_acctbal_prf#3828 AS c_acctbal_prf_0#3837, rid#3829 AS rid_0#3838, c_name_prf#3830 AS c_name_prf_0#3839, c_nationkey_prf#3831 AS c_nationkey_prf_0#3840, c_custkey_prf#3832 AS c_custkey_prf_0#3841, c_comment_prf#3833 AS c_comment_prf_0#3842, c_address_prf#3834 AS c_address_prf_0#3843, c_mktsegment_prf#3835 AS c_mktsegment_prf_0#3844, c_phone_prf#3836 AS c_phone_prf_0#3845]
         :     :  +- Relation[c_acctbal_prf#3828,rid#3829,c_name_prf#3830,c_nationkey_prf#3831,c_custkey_prf#3832,c_comment_prf#3833,c_address_prf#3834,c_mktsegment_prf#3835,c_phone_prf#3836] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#3867]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#3858: string
            :     :- Project [o_shippriority_prf#3847 AS o_shippriority_prf_1#3857, rid#3848 AS rid_1#3858, o_orderdate_prf#3849 AS o_orderdate_prf_1#3859, o_custkey_prf#3850 AS o_custkey_prf_1#3860, o_orderpriority_prf#3851 AS o_orderpriority_prf_1#3861, o_clerk_prf#3852 AS o_clerk_prf_1#3862, o_orderstatus_prf#3853 AS o_orderstatus_prf_1#3863, o_totalprice_prf#3854 AS o_totalprice_prf_1#3864, o_orderkey_prf#3855 AS o_orderkey_prf_1#3865, o_comment_prf#3856 AS o_comment_prf_1#3866]
            :     :  +- Relation[o_shippriority_prf#3847,rid#3848,o_orderdate_prf#3849,o_custkey_prf#3850,o_orderpriority_prf#3851,o_clerk_prf#3852,o_orderstatus_prf#3853,o_totalprice_prf#3854,o_orderkey_prf#3855,o_comment_prf#3856] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3868 AS l_returnflag_prf_2#3887, l_orderkey_and_l_linenumber_prf#3869 AS l_orderkey_and_l_linenumber_prf_2#3888, l_comment_prf#3870 AS l_comment_prf_2#3889, l_linestatus_prf#3871 AS l_linestatus_prf_2#3890, rid#3872 AS rid_2#3891, l_shipmode_prf#3873 AS l_shipmode_prf_2#3892, l_shipinstruct_prf#3874 AS l_shipinstruct_prf_2#3893, l_quantity_prf#3875 AS l_quantity_prf_2#3894, l_receiptdate_prf#3876 AS l_receiptdate_prf_2#3895, l_linenumber_prf#3877 AS l_linenumber_prf_2#3896, l_tax_prf#3878 AS l_tax_prf_2#3897, l_shipdate_prf#3879 AS l_shipdate_prf_2#3898, l_extendedprice_prf#3880 AS l_extendedprice_prf_2#3899, l_partkey_prf#3881 AS l_partkey_prf_2#3900, l_discount_prf#3882 AS l_discount_prf_2#3901, l_partkey_and_l_suppkey_prf#3883 AS l_partkey_and_l_suppkey_prf_2#3902, l_commitdate_prf#3884 AS l_commitdate_prf_2#3903, l_suppkey_prf#3885 AS l_suppkey_prf_2#3904, l_orderkey_prf#3886 AS l_orderkey_prf_2#3905]
               +- Relation[l_returnflag_prf#3868,l_orderkey_and_l_linenumber_prf#3869,l_comment_prf#3870,l_linestatus_prf#3871,rid#3872,l_shipmode_prf#3873,l_shipinstruct_prf#3874,l_quantity_prf#3875,l_receiptdate_prf#3876,l_linenumber_prf#3877,l_tax_prf#3878,l_shipdate_prf#3879,l_extendedprice_prf#3880,l_partkey_prf#3881,l_discount_prf#3882,l_partkey_and_l_suppkey_prf#3883,l_commitdate_prf#3884,l_suppkey_prf#3885,l_orderkey_prf#3886] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 234343ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/14 23:01:48 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 23:01:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3972L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 23:01:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3972L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#3994]
         :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3986: string
         :     :- Project [p_comment_prf#3974 AS p_comment_prf_0#3984, p_name_prf#3975 AS p_name_prf_0#3985, rid#3976 AS rid_0#3986, p_type_prf#3977 AS p_type_prf_0#3987, p_retailprice_prf#3978 AS p_retailprice_prf_0#3988, p_mfgr_prf#3979 AS p_mfgr_prf_0#3989, p_container_prf#3980 AS p_container_prf_0#3990, p_brand_prf#3981 AS p_brand_prf_0#3991, p_size_prf#3982 AS p_size_prf_0#3992, p_partkey_prf#3983 AS p_partkey_prf_0#3993]
         :     :  +- Relation[p_comment_prf#3974,p_name_prf#3975,rid#3976,p_type_prf#3977,p_retailprice_prf#3978,p_mfgr_prf#3979,p_container_prf#3980,p_brand_prf#3981,p_size_prf#3982,p_partkey_prf#3983] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3995 AS l_returnflag_prf_1#4014, l_orderkey_and_l_linenumber_prf#3996 AS l_orderkey_and_l_linenumber_prf_1#4015, l_comment_prf#3997 AS l_comment_prf_1#4016, l_linestatus_prf#3998 AS l_linestatus_prf_1#4017, rid#3999 AS rid_1#4018, l_shipmode_prf#4000 AS l_shipmode_prf_1#4019, l_shipinstruct_prf#4001 AS l_shipinstruct_prf_1#4020, l_quantity_prf#4002 AS l_quantity_prf_1#4021, l_receiptdate_prf#4003 AS l_receiptdate_prf_1#4022, l_linenumber_prf#4004 AS l_linenumber_prf_1#4023, l_tax_prf#4005 AS l_tax_prf_1#4024, l_shipdate_prf#4006 AS l_shipdate_prf_1#4025, l_extendedprice_prf#4007 AS l_extendedprice_prf_1#4026, l_partkey_prf#4008 AS l_partkey_prf_1#4027, l_discount_prf#4009 AS l_discount_prf_1#4028, l_partkey_and_l_suppkey_prf#4010 AS l_partkey_and_l_suppkey_prf_1#4029, l_commitdate_prf#4011 AS l_commitdate_prf_1#4030, l_suppkey_prf#4012 AS l_suppkey_prf_1#4031, l_orderkey_prf#4013 AS l_orderkey_prf_1#4032]
            +- Relation[l_returnflag_prf#3995,l_orderkey_and_l_linenumber_prf#3996,l_comment_prf#3997,l_linestatus_prf#3998,rid#3999,l_shipmode_prf#4000,l_shipinstruct_prf#4001,l_quantity_prf#4002,l_receiptdate_prf#4003,l_linenumber_prf#4004,l_tax_prf#4005,l_shipdate_prf#4006,l_extendedprice_prf#4007,l_partkey_prf#4008,l_discount_prf#4009,l_partkey_and_l_suppkey_prf#4010,l_commitdate_prf#4011,l_suppkey_prf#4012,l_orderkey_prf#4013] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 94535ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/14 23:03:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 23:03:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4076L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 23:03:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4076L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#4088]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#4083: string
         :     :- Project [rid#4078 AS rid_0#4083, n_regionkey_prf#4079 AS n_regionkey_prf_0#4084, n_nationkey_prf#4080 AS n_nationkey_prf_0#4085, n_name_prf#4081 AS n_name_prf_0#4086, n_comment_prf#4082 AS n_comment_prf_0#4087]
         :     :  +- Relation[rid#4078,n_regionkey_prf#4079,n_nationkey_prf#4080,n_name_prf#4081,n_comment_prf#4082] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4089 AS s_phone_prf_1#4097, rid#4090 AS rid_1#4098, s_address_prf#4091 AS s_address_prf_1#4099, s_nationkey_prf#4092 AS s_nationkey_prf_1#4100, s_suppkey_prf#4093 AS s_suppkey_prf_1#4101, s_name_prf#4094 AS s_name_prf_1#4102, s_acctbal_prf#4095 AS s_acctbal_prf_1#4103, s_comment_prf#4096 AS s_comment_prf_1#4104]
            +- Relation[s_phone_prf#4089,rid#4090,s_address_prf#4091,s_nationkey_prf#4092,s_suppkey_prf#4093,s_name_prf#4094,s_acctbal_prf#4095,s_comment_prf#4096] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=10000
Elapsed time: 189ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/14 23:03:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 23:03:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4140L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 23:03:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4140L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#4158]
         :  :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#4151: string
         :  :  :     :- Project [s_phone_prf#4142 AS s_phone_prf_0#4150, rid#4143 AS rid_0#4151, s_address_prf#4144 AS s_address_prf_0#4152, s_nationkey_prf#4145 AS s_nationkey_prf_0#4153, s_suppkey_prf#4146 AS s_suppkey_prf_0#4154, s_name_prf#4147 AS s_name_prf_0#4155, s_acctbal_prf#4148 AS s_acctbal_prf_0#4156, s_comment_prf#4149 AS s_comment_prf_0#4157]
         :  :  :     :  +- Relation[s_phone_prf#4142,rid#4143,s_address_prf#4144,s_nationkey_prf#4145,s_suppkey_prf#4146,s_name_prf#4147,s_acctbal_prf#4148,s_comment_prf#4149] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [rid#4159 AS rid_1#4164, n_regionkey_prf#4160 AS n_regionkey_prf_1#4165, n_nationkey_prf#4161 AS n_nationkey_prf_1#4166, n_name_prf#4162 AS n_name_prf_1#4167, n_comment_prf#4163 AS n_comment_prf_1#4168]
         :  :     +- Relation[rid#4159,n_regionkey_prf#4160,n_nationkey_prf#4161,n_name_prf#4162,n_comment_prf#4163] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#4175]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4174]
         :        :  +- Relation[rid#4169,n_regionkey_prf#4170,n_nationkey_prf#4171,n_name_prf#4172,n_comment_prf#4173] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4176 AS c_acctbal_prf_2#4185, rid#4177 AS rid_2#4186, c_name_prf#4178 AS c_name_prf_2#4187, c_nationkey_prf#4179 AS c_nationkey_prf_2#4188, c_custkey_prf#4180 AS c_custkey_prf_2#4189, c_comment_prf#4181 AS c_comment_prf_2#4190, c_address_prf#4182 AS c_address_prf_2#4191, c_mktsegment_prf#4183 AS c_mktsegment_prf_2#4192, c_phone_prf#4184 AS c_phone_prf_2#4193]
            +- Relation[c_acctbal_prf#4176,rid#4177,c_name_prf#4178,c_nationkey_prf#4179,c_custkey_prf#4180,c_comment_prf#4181,c_address_prf#4182,c_mktsegment_prf#4183,c_phone_prf#4184] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 20572ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/14 23:03:43 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 23:03:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4252L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 23:03:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4252L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#4272]
         :  :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4264: string
         :  :  :     :- Project [c_acctbal_prf#4254 AS c_acctbal_prf_0#4263, rid#4255 AS rid_0#4264, c_name_prf#4256 AS c_name_prf_0#4265, c_nationkey_prf#4257 AS c_nationkey_prf_0#4266, c_custkey_prf#4258 AS c_custkey_prf_0#4267, c_comment_prf#4259 AS c_comment_prf_0#4268, c_address_prf#4260 AS c_address_prf_0#4269, c_mktsegment_prf#4261 AS c_mktsegment_prf_0#4270, c_phone_prf#4262 AS c_phone_prf_0#4271]
         :  :  :     :  +- Relation[c_acctbal_prf#4254,rid#4255,c_name_prf#4256,c_nationkey_prf#4257,c_custkey_prf#4258,c_comment_prf#4259,c_address_prf#4260,c_mktsegment_prf#4261,c_phone_prf#4262] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#4273 AS o_shippriority_prf_1#4283, rid#4274 AS rid_1#4284, o_orderdate_prf#4275 AS o_orderdate_prf_1#4285, o_custkey_prf#4276 AS o_custkey_prf_1#4286, o_orderpriority_prf#4277 AS o_orderpriority_prf_1#4287, o_clerk_prf#4278 AS o_clerk_prf_1#4288, o_orderstatus_prf#4279 AS o_orderstatus_prf_1#4289, o_totalprice_prf#4280 AS o_totalprice_prf_1#4290, o_orderkey_prf#4281 AS o_orderkey_prf_1#4291, o_comment_prf#4282 AS o_comment_prf_1#4292]
         :  :     +- Relation[o_shippriority_prf#4273,rid#4274,o_orderdate_prf#4275,o_custkey_prf#4276,o_orderpriority_prf#4277,o_clerk_prf#4278,o_orderstatus_prf#4279,o_totalprice_prf#4280,o_orderkey_prf#4281,o_comment_prf#4282] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#4304]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4303]
         :        :  +- Relation[o_shippriority_prf#4293,rid#4294,o_orderdate_prf#4295,o_custkey_prf#4296,o_orderpriority_prf#4297,o_clerk_prf#4298,o_orderstatus_prf#4299,o_totalprice_prf#4300,o_orderkey_prf#4301,o_comment_prf#4302] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4305 AS l_returnflag_prf_2#4324, l_orderkey_and_l_linenumber_prf#4306 AS l_orderkey_and_l_linenumber_prf_2#4325, l_comment_prf#4307 AS l_comment_prf_2#4326, l_linestatus_prf#4308 AS l_linestatus_prf_2#4327, rid#4309 AS rid_2#4328, l_shipmode_prf#4310 AS l_shipmode_prf_2#4329, l_shipinstruct_prf#4311 AS l_shipinstruct_prf_2#4330, l_quantity_prf#4312 AS l_quantity_prf_2#4331, l_receiptdate_prf#4313 AS l_receiptdate_prf_2#4332, l_linenumber_prf#4314 AS l_linenumber_prf_2#4333, l_tax_prf#4315 AS l_tax_prf_2#4334, l_shipdate_prf#4316 AS l_shipdate_prf_2#4335, l_extendedprice_prf#4317 AS l_extendedprice_prf_2#4336, l_partkey_prf#4318 AS l_partkey_prf_2#4337, l_discount_prf#4319 AS l_discount_prf_2#4338, l_partkey_and_l_suppkey_prf#4320 AS l_partkey_and_l_suppkey_prf_2#4339, l_commitdate_prf#4321 AS l_commitdate_prf_2#4340, l_suppkey_prf#4322 AS l_suppkey_prf_2#4341, l_orderkey_prf#4323 AS l_orderkey_prf_2#4342]
            +- Relation[l_returnflag_prf#4305,l_orderkey_and_l_linenumber_prf#4306,l_comment_prf#4307,l_linestatus_prf#4308,rid#4309,l_shipmode_prf#4310,l_shipinstruct_prf#4311,l_quantity_prf#4312,l_receiptdate_prf#4313,l_linenumber_prf#4314,l_tax_prf#4315,l_shipdate_prf#4316,l_extendedprice_prf#4317,l_partkey_prf#4318,l_discount_prf#4319,l_partkey_and_l_suppkey_prf#4320,l_commitdate_prf#4321,l_suppkey_prf#4322,l_orderkey_prf#4323] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 233200ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/14 23:07:36 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 23:07:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4409L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 23:07:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4409L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#4449]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4434: string
         :     :- Project [l_returnflag_prf#4411 AS l_returnflag_prf_0#4430, l_orderkey_and_l_linenumber_prf#4412 AS l_orderkey_and_l_linenumber_prf_0#4431, l_comment_prf#4413 AS l_comment_prf_0#4432, l_linestatus_prf#4414 AS l_linestatus_prf_0#4433, rid#4415 AS rid_0#4434, l_shipmode_prf#4416 AS l_shipmode_prf_0#4435, l_shipinstruct_prf#4417 AS l_shipinstruct_prf_0#4436, l_quantity_prf#4418 AS l_quantity_prf_0#4437, l_receiptdate_prf#4419 AS l_receiptdate_prf_0#4438, l_linenumber_prf#4420 AS l_linenumber_prf_0#4439, l_tax_prf#4421 AS l_tax_prf_0#4440, l_shipdate_prf#4422 AS l_shipdate_prf_0#4441, l_extendedprice_prf#4423 AS l_extendedprice_prf_0#4442, l_partkey_prf#4424 AS l_partkey_prf_0#4443, l_discount_prf#4425 AS l_discount_prf_0#4444, l_partkey_and_l_suppkey_prf#4426 AS l_partkey_and_l_suppkey_prf_0#4445, l_commitdate_prf#4427 AS l_commitdate_prf_0#4446, l_suppkey_prf#4428 AS l_suppkey_prf_0#4447, l_orderkey_prf#4429 AS l_orderkey_prf_0#4448]
         :     :  +- Relation[l_returnflag_prf#4411,l_orderkey_and_l_linenumber_prf#4412,l_comment_prf#4413,l_linestatus_prf#4414,rid#4415,l_shipmode_prf#4416,l_shipinstruct_prf#4417,l_quantity_prf#4418,l_receiptdate_prf#4419,l_linenumber_prf#4420,l_tax_prf#4421,l_shipdate_prf#4422,l_extendedprice_prf#4423,l_partkey_prf#4424,l_discount_prf#4425,l_partkey_and_l_suppkey_prf#4426,l_commitdate_prf#4427,l_suppkey_prf#4428,l_orderkey_prf#4429] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4450 AS o_shippriority_prf_1#4460, rid#4451 AS rid_1#4461, o_orderdate_prf#4452 AS o_orderdate_prf_1#4462, o_custkey_prf#4453 AS o_custkey_prf_1#4463, o_orderpriority_prf#4454 AS o_orderpriority_prf_1#4464, o_clerk_prf#4455 AS o_clerk_prf_1#4465, o_orderstatus_prf#4456 AS o_orderstatus_prf_1#4466, o_totalprice_prf#4457 AS o_totalprice_prf_1#4467, o_orderkey_prf#4458 AS o_orderkey_prf_1#4468, o_comment_prf#4459 AS o_comment_prf_1#4469]
            +- Relation[o_shippriority_prf#4450,rid#4451,o_orderdate_prf#4452,o_custkey_prf#4453,o_orderpriority_prf#4454,o_clerk_prf#4455,o_orderstatus_prf#4456,o_totalprice_prf#4457,o_orderkey_prf#4458,o_comment_prf#4459] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 114331ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/14 23:09:31 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 23:09:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4523L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 23:09:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4523L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#4539]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, rid_0#4533: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#4525 AS ps_partkey_and_ps_suppkey_prf_0#4532, rid#4526 AS rid_0#4533, ps_availqty_prf#4527 AS ps_availqty_prf_0#4534, ps_comment_prf#4528 AS ps_comment_prf_0#4535, ps_partkey_prf#4529 AS ps_partkey_prf_0#4536, ps_supplycost_prf#4530 AS ps_supplycost_prf_0#4537, ps_suppkey_prf#4531 AS ps_suppkey_prf_0#4538]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#4525,rid#4526,ps_availqty_prf#4527,ps_comment_prf#4528,ps_partkey_prf#4529,ps_supplycost_prf#4530,ps_suppkey_prf#4531] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4540 AS l_returnflag_prf_1#4559, l_orderkey_and_l_linenumber_prf#4541 AS l_orderkey_and_l_linenumber_prf_1#4560, l_comment_prf#4542 AS l_comment_prf_1#4561, l_linestatus_prf#4543 AS l_linestatus_prf_1#4562, rid#4544 AS rid_1#4563, l_shipmode_prf#4545 AS l_shipmode_prf_1#4564, l_shipinstruct_prf#4546 AS l_shipinstruct_prf_1#4565, l_quantity_prf#4547 AS l_quantity_prf_1#4566, l_receiptdate_prf#4548 AS l_receiptdate_prf_1#4567, l_linenumber_prf#4549 AS l_linenumber_prf_1#4568, l_tax_prf#4550 AS l_tax_prf_1#4569, l_shipdate_prf#4551 AS l_shipdate_prf_1#4570, l_extendedprice_prf#4552 AS l_extendedprice_prf_1#4571, l_partkey_prf#4553 AS l_partkey_prf_1#4572, l_discount_prf#4554 AS l_discount_prf_1#4573, l_partkey_and_l_suppkey_prf#4555 AS l_partkey_and_l_suppkey_prf_1#4574, l_commitdate_prf#4556 AS l_commitdate_prf_1#4575, l_suppkey_prf#4557 AS l_suppkey_prf_1#4576, l_orderkey_prf#4558 AS l_orderkey_prf_1#4577]
            +- Relation[l_returnflag_prf#4540,l_orderkey_and_l_linenumber_prf#4541,l_comment_prf#4542,l_linestatus_prf#4543,rid#4544,l_shipmode_prf#4545,l_shipinstruct_prf#4546,l_quantity_prf#4547,l_receiptdate_prf#4548,l_linenumber_prf#4549,l_tax_prf#4550,l_shipdate_prf#4551,l_extendedprice_prf#4552,l_partkey_prf#4553,l_discount_prf#4554,l_partkey_and_l_suppkey_prf#4555,l_commitdate_prf#4556,l_suppkey_prf#4557,l_orderkey_prf#4558] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 116061ms

f2=
select * from part where p_size = 15
19/10/14 23:11:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 23:11:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4616L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 23:11:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4616L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#4618 AS p_comment_prf_0#4628, p_name_prf#4619 AS p_name_prf_0#4629, rid#4620 AS rid_0#4630, p_type_prf#4621 AS p_type_prf_0#4631, p_retailprice_prf#4622 AS p_retailprice_prf_0#4632, p_mfgr_prf#4623 AS p_mfgr_prf_0#4633, p_container_prf#4624 AS p_container_prf_0#4634, p_brand_prf#4625 AS p_brand_prf_0#4635, p_size_prf#4626 AS p_size_prf_0#4636, p_partkey_prf#4627 AS p_partkey_prf_0#4637]
         :  +- Relation[p_comment_prf#4618,p_name_prf#4619,rid#4620,p_type_prf#4621,p_retailprice_prf#4622,p_mfgr_prf#4623,p_container_prf#4624,p_brand_prf#4625,p_size_prf#4626,p_partkey_prf#4627] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4638]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1635,value#1636] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3907
Elapsed time: 129ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/14 23:11:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 23:11:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4673L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 23:11:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4673L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#4695]
         :  :  :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4687: string
         :  :  :     :- Project [p_comment_prf#4675 AS p_comment_prf_0#4685, p_name_prf#4676 AS p_name_prf_0#4686, rid#4677 AS rid_0#4687, p_type_prf#4678 AS p_type_prf_0#4688, p_retailprice_prf#4679 AS p_retailprice_prf_0#4689, p_mfgr_prf#4680 AS p_mfgr_prf_0#4690, p_container_prf#4681 AS p_container_prf_0#4691, p_brand_prf#4682 AS p_brand_prf_0#4692, p_size_prf#4683 AS p_size_prf_0#4693, p_partkey_prf#4684 AS p_partkey_prf_0#4694]
         :  :  :     :  +- Relation[p_comment_prf#4675,p_name_prf#4676,rid#4677,p_type_prf#4678,p_retailprice_prf#4679,p_mfgr_prf#4680,p_container_prf#4681,p_brand_prf#4682,p_size_prf#4683,p_partkey_prf#4684] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#4696 AS ps_partkey_and_ps_suppkey_prf_1#4703, rid#4697 AS rid_1#4704, ps_availqty_prf#4698 AS ps_availqty_prf_1#4705, ps_comment_prf#4699 AS ps_comment_prf_1#4706, ps_partkey_prf#4700 AS ps_partkey_prf_1#4707, ps_supplycost_prf#4701 AS ps_supplycost_prf_1#4708, ps_suppkey_prf#4702 AS ps_suppkey_prf_1#4709]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#4696,rid#4697,ps_availqty_prf#4698,ps_comment_prf#4699,ps_partkey_prf#4700,ps_supplycost_prf#4701,ps_suppkey_prf#4702] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#4718]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4717]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#4710,rid#4711,ps_availqty_prf#4712,ps_comment_prf#4713,ps_partkey_prf#4714,ps_supplycost_prf#4715,ps_suppkey_prf#4716] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4719 AS s_phone_prf_2#4727, rid#4720 AS rid_2#4728, s_address_prf#4721 AS s_address_prf_2#4729, s_nationkey_prf#4722 AS s_nationkey_prf_2#4730, s_suppkey_prf#4723 AS s_suppkey_prf_2#4731, s_name_prf#4724 AS s_name_prf_2#4732, s_acctbal_prf#4725 AS s_acctbal_prf_2#4733, s_comment_prf#4726 AS s_comment_prf_2#4734]
            +- Relation[s_phone_prf#4719,rid#4720,s_address_prf#4721,s_nationkey_prf#4722,s_suppkey_prf#4723,s_name_prf#4724,s_acctbal_prf#4725,s_comment_prf#4726] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 84396ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/14 23:12:51 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 23:12:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4777L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 23:12:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4777L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#4800]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4791: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#4779 AS p_comment_prf_0#4789, p_name_prf#4780 AS p_name_prf_0#4790, rid#4781 AS rid_0#4791, p_type_prf#4782 AS p_type_prf_0#4792, p_retailprice_prf#4783 AS p_retailprice_prf_0#4793, p_mfgr_prf#4784 AS p_mfgr_prf_0#4794, p_container_prf#4785 AS p_container_prf_0#4795, p_brand_prf#4786 AS p_brand_prf_0#4796, p_size_prf#4787 AS p_size_prf_0#4797, p_partkey_prf#4788 AS p_partkey_prf_0#4798]
         :     :  :  +- Relation[p_comment_prf#4779,p_name_prf#4780,rid#4781,p_type_prf#4782,p_retailprice_prf#4783,p_mfgr_prf#4784,p_container_prf#4785,p_brand_prf#4786,p_size_prf#4787,p_partkey_prf#4788] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4799]
         :     :     +- DexRidFilter part~p_size~15
         :     :        +- Relation[label#1635,value#1636] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4801 AS ps_partkey_and_ps_suppkey_prf_1#4808, rid#4802 AS rid_1#4809, ps_availqty_prf#4803 AS ps_availqty_prf_1#4810, ps_comment_prf#4804 AS ps_comment_prf_1#4811, ps_partkey_prf#4805 AS ps_partkey_prf_1#4812, ps_supplycost_prf#4806 AS ps_supplycost_prf_1#4813, ps_suppkey_prf#4807 AS ps_suppkey_prf_1#4814]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4801,rid#4802,ps_availqty_prf#4803,ps_comment_prf#4804,ps_partkey_prf#4805,ps_supplycost_prf#4806,ps_suppkey_prf#4807] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 397ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/14 23:12:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 23:12:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4851L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 23:12:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4851L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#4853 AS l_returnflag_prf_0#4872, l_orderkey_and_l_linenumber_prf#4854 AS l_orderkey_and_l_linenumber_prf_0#4873, l_comment_prf#4855 AS l_comment_prf_0#4874, l_linestatus_prf#4856 AS l_linestatus_prf_0#4875, rid#4857 AS rid_0#4876, l_shipmode_prf#4858 AS l_shipmode_prf_0#4877, l_shipinstruct_prf#4859 AS l_shipinstruct_prf_0#4878, l_quantity_prf#4860 AS l_quantity_prf_0#4879, l_receiptdate_prf#4861 AS l_receiptdate_prf_0#4880, l_linenumber_prf#4862 AS l_linenumber_prf_0#4881, l_tax_prf#4863 AS l_tax_prf_0#4882, l_shipdate_prf#4864 AS l_shipdate_prf_0#4883, l_extendedprice_prf#4865 AS l_extendedprice_prf_0#4884, l_partkey_prf#4866 AS l_partkey_prf_0#4885, l_discount_prf#4867 AS l_discount_prf_0#4886, l_partkey_and_l_suppkey_prf#4868 AS l_partkey_and_l_suppkey_prf_0#4887, l_commitdate_prf#4869 AS l_commitdate_prf_0#4888, l_suppkey_prf#4870 AS l_suppkey_prf_0#4889, l_orderkey_prf#4871 AS l_orderkey_prf_0#4890]
         :  +- Relation[l_returnflag_prf#4853,l_orderkey_and_l_linenumber_prf#4854,l_comment_prf#4855,l_linestatus_prf#4856,rid#4857,l_shipmode_prf#4858,l_shipinstruct_prf#4859,l_quantity_prf#4860,l_receiptdate_prf#4861,l_linenumber_prf#4862,l_tax_prf#4863,l_shipdate_prf#4864,l_extendedprice_prf#4865,l_partkey_prf#4866,l_discount_prf#4867,l_partkey_and_l_suppkey_prf#4868,l_commitdate_prf#4869,l_suppkey_prf#4870,l_orderkey_prf#4871] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4891]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1635,value#1636] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 13694ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/14 23:13:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 23:13:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4939L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 23:13:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4939L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#4961]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#4952: string
         :     :- Project [o_shippriority_prf#4941 AS o_shippriority_prf_0#4951, rid#4942 AS rid_0#4952, o_orderdate_prf#4943 AS o_orderdate_prf_0#4953, o_custkey_prf#4944 AS o_custkey_prf_0#4954, o_orderpriority_prf#4945 AS o_orderpriority_prf_0#4955, o_clerk_prf#4946 AS o_clerk_prf_0#4956, o_orderstatus_prf#4947 AS o_orderstatus_prf_0#4957, o_totalprice_prf#4948 AS o_totalprice_prf_0#4958, o_orderkey_prf#4949 AS o_orderkey_prf_0#4959, o_comment_prf#4950 AS o_comment_prf_0#4960]
         :     :  +- Relation[o_shippriority_prf#4941,rid#4942,o_orderdate_prf#4943,o_custkey_prf#4944,o_orderpriority_prf#4945,o_clerk_prf#4946,o_orderstatus_prf#4947,o_totalprice_prf#4948,o_orderkey_prf#4949,o_comment_prf#4950] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#4962 AS l_returnflag_prf_1#4981, l_orderkey_and_l_linenumber_prf#4963 AS l_orderkey_and_l_linenumber_prf_1#4982, l_comment_prf#4964 AS l_comment_prf_1#4983, l_linestatus_prf#4965 AS l_linestatus_prf_1#4984, rid#4966 AS rid_1#4985, l_shipmode_prf#4967 AS l_shipmode_prf_1#4986, l_shipinstruct_prf#4968 AS l_shipinstruct_prf_1#4987, l_quantity_prf#4969 AS l_quantity_prf_1#4988, l_receiptdate_prf#4970 AS l_receiptdate_prf_1#4989, l_linenumber_prf#4971 AS l_linenumber_prf_1#4990, l_tax_prf#4972 AS l_tax_prf_1#4991, l_shipdate_prf#4973 AS l_shipdate_prf_1#4992, l_extendedprice_prf#4974 AS l_extendedprice_prf_1#4993, l_partkey_prf#4975 AS l_partkey_prf_1#4994, l_discount_prf#4976 AS l_discount_prf_1#4995, l_partkey_and_l_suppkey_prf#4977 AS l_partkey_and_l_suppkey_prf_1#4996, l_commitdate_prf#4978 AS l_commitdate_prf_1#4997, l_suppkey_prf#4979 AS l_suppkey_prf_1#4998, l_orderkey_prf#4980 AS l_orderkey_prf_1#4999]
            :  +- Relation[l_returnflag_prf#4962,l_orderkey_and_l_linenumber_prf#4963,l_comment_prf#4964,l_linestatus_prf#4965,rid#4966,l_shipmode_prf#4967,l_shipinstruct_prf#4968,l_quantity_prf#4969,l_receiptdate_prf#4970,l_linenumber_prf#4971,l_tax_prf#4972,l_shipdate_prf#4973,l_extendedprice_prf#4974,l_partkey_prf#4975,l_discount_prf#4976,l_partkey_and_l_suppkey_prf#4977,l_commitdate_prf#4978,l_suppkey_prf#4979,l_orderkey_prf#4980] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5000]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1635,value#1636] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 196926ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/14 23:16:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 23:16:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5065L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 23:16:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5065L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#5087]
         :  :  :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#5079: string
         :  :  :     :- Project [p_comment_prf#5067 AS p_comment_prf_0#5077, p_name_prf#5068 AS p_name_prf_0#5078, rid#5069 AS rid_0#5079, p_type_prf#5070 AS p_type_prf_0#5080, p_retailprice_prf#5071 AS p_retailprice_prf_0#5081, p_mfgr_prf#5072 AS p_mfgr_prf_0#5082, p_container_prf#5073 AS p_container_prf_0#5083, p_brand_prf#5074 AS p_brand_prf_0#5084, p_size_prf#5075 AS p_size_prf_0#5085, p_partkey_prf#5076 AS p_partkey_prf_0#5086]
         :  :  :     :  +- Relation[p_comment_prf#5067,p_name_prf#5068,rid#5069,p_type_prf#5070,p_retailprice_prf#5071,p_mfgr_prf#5072,p_container_prf#5073,p_brand_prf#5074,p_size_prf#5075,p_partkey_prf#5076] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#5088 AS l_returnflag_prf_1#5107, l_orderkey_and_l_linenumber_prf#5089 AS l_orderkey_and_l_linenumber_prf_1#5108, l_comment_prf#5090 AS l_comment_prf_1#5109, l_linestatus_prf#5091 AS l_linestatus_prf_1#5110, rid#5092 AS rid_1#5111, l_shipmode_prf#5093 AS l_shipmode_prf_1#5112, l_shipinstruct_prf#5094 AS l_shipinstruct_prf_1#5113, l_quantity_prf#5095 AS l_quantity_prf_1#5114, l_receiptdate_prf#5096 AS l_receiptdate_prf_1#5115, l_linenumber_prf#5097 AS l_linenumber_prf_1#5116, l_tax_prf#5098 AS l_tax_prf_1#5117, l_shipdate_prf#5099 AS l_shipdate_prf_1#5118, l_extendedprice_prf#5100 AS l_extendedprice_prf_1#5119, l_partkey_prf#5101 AS l_partkey_prf_1#5120, l_discount_prf#5102 AS l_discount_prf_1#5121, l_partkey_and_l_suppkey_prf#5103 AS l_partkey_and_l_suppkey_prf_1#5122, l_commitdate_prf#5104 AS l_commitdate_prf_1#5123, l_suppkey_prf#5105 AS l_suppkey_prf_1#5124, l_orderkey_prf#5106 AS l_orderkey_prf_1#5125]
         :  :     +- Relation[l_returnflag_prf#5088,l_orderkey_and_l_linenumber_prf#5089,l_comment_prf#5090,l_linestatus_prf#5091,rid#5092,l_shipmode_prf#5093,l_shipinstruct_prf#5094,l_quantity_prf#5095,l_receiptdate_prf#5096,l_linenumber_prf#5097,l_tax_prf#5098,l_shipdate_prf#5099,l_extendedprice_prf#5100,l_partkey_prf#5101,l_discount_prf#5102,l_partkey_and_l_suppkey_prf#5103,l_commitdate_prf#5104,l_suppkey_prf#5105,l_orderkey_prf#5106] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#5146]
         :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5145]
         :        :  +- Relation[l_returnflag_prf#5126,l_orderkey_and_l_linenumber_prf#5127,l_comment_prf#5128,l_linestatus_prf#5129,rid#5130,l_shipmode_prf#5131,l_shipinstruct_prf#5132,l_quantity_prf#5133,l_receiptdate_prf#5134,l_linenumber_prf#5135,l_tax_prf#5136,l_shipdate_prf#5137,l_extendedprice_prf#5138,l_partkey_prf#5139,l_discount_prf#5140,l_partkey_and_l_suppkey_prf#5141,l_commitdate_prf#5142,l_suppkey_prf#5143,l_orderkey_prf#5144] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5147 AS s_phone_prf_2#5155, rid#5148 AS rid_2#5156, s_address_prf#5149 AS s_address_prf_2#5157, s_nationkey_prf#5150 AS s_nationkey_prf_2#5158, s_suppkey_prf#5151 AS s_suppkey_prf_2#5159, s_name_prf#5152 AS s_name_prf_2#5160, s_acctbal_prf#5153 AS s_acctbal_prf_2#5161, s_comment_prf#5154 AS s_comment_prf_2#5162]
            +- Relation[s_phone_prf#5147,rid#5148,s_address_prf#5149,s_nationkey_prf#5150,s_suppkey_prf#5151,s_name_prf#5152,s_acctbal_prf#5153,s_comment_prf#5154] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 196010ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/14 23:19:38 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 23:19:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5215L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 23:19:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5215L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#5233]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#5226: string
         :     :- Project [s_phone_prf#5217 AS s_phone_prf_0#5225, rid#5218 AS rid_0#5226, s_address_prf#5219 AS s_address_prf_0#5227, s_nationkey_prf#5220 AS s_nationkey_prf_0#5228, s_suppkey_prf#5221 AS s_suppkey_prf_0#5229, s_name_prf#5222 AS s_name_prf_0#5230, s_acctbal_prf#5223 AS s_acctbal_prf_0#5231, s_comment_prf#5224 AS s_comment_prf_0#5232]
         :     :  +- Relation[s_phone_prf#5217,rid#5218,s_address_prf#5219,s_nationkey_prf#5220,s_suppkey_prf#5221,s_name_prf#5222,s_acctbal_prf#5223,s_comment_prf#5224] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#5234 AS ps_partkey_and_ps_suppkey_prf_1#5241, rid#5235 AS rid_1#5242, ps_availqty_prf#5236 AS ps_availqty_prf_1#5243, ps_comment_prf#5237 AS ps_comment_prf_1#5244, ps_partkey_prf#5238 AS ps_partkey_prf_1#5245, ps_supplycost_prf#5239 AS ps_supplycost_prf_1#5246, ps_suppkey_prf#5240 AS ps_suppkey_prf_1#5247]
            +- Relation[ps_partkey_and_ps_suppkey_prf#5234,rid#5235,ps_availqty_prf#5236,ps_comment_prf#5237,ps_partkey_prf#5238,ps_supplycost_prf#5239,ps_suppkey_prf#5240] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 10969ms

f1=
select * from region where r_name = 'EUROPE'
19/10/14 23:19:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 23:19:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5269L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/14 23:19:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5269L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#5271 AS r_regionkey_prf_0#5275, r_name_prf#5272 AS r_name_prf_0#5276, r_comment_prf#5273 AS r_comment_prf_0#5277, rid#5274 AS rid_0#5278]
         :  +- Relation[r_regionkey_prf#5271,r_name_prf#5272,r_comment_prf#5273,rid#5274] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5279]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1635,value#1636] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 51ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/14 23:19:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 23:19:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5299L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 23:19:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5299L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#5311]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#5306: string
         :     :- Project [rid#5301 AS rid_0#5306, n_regionkey_prf#5302 AS n_regionkey_prf_0#5307, n_nationkey_prf#5303 AS n_nationkey_prf_0#5308, n_name_prf#5304 AS n_name_prf_0#5309, n_comment_prf#5305 AS n_comment_prf_0#5310]
         :     :  +- Relation[rid#5301,n_regionkey_prf#5302,n_nationkey_prf#5303,n_name_prf#5304,n_comment_prf#5305] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#5312 AS c_acctbal_prf_1#5321, rid#5313 AS rid_1#5322, c_name_prf#5314 AS c_name_prf_1#5323, c_nationkey_prf#5315 AS c_nationkey_prf_1#5324, c_custkey_prf#5316 AS c_custkey_prf_1#5325, c_comment_prf#5317 AS c_comment_prf_1#5326, c_address_prf#5318 AS c_address_prf_1#5327, c_mktsegment_prf#5319 AS c_mktsegment_prf_1#5328, c_phone_prf#5320 AS c_phone_prf_1#5329]
            +- Relation[c_acctbal_prf#5312,rid#5313,c_name_prf#5314,c_nationkey_prf#5315,c_custkey_prf#5316,c_comment_prf#5317,c_address_prf#5318,c_mktsegment_prf#5319,c_phone_prf#5320] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=150000
Elapsed time: 1927ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/14 23:19:51 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 23:19:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5356L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 23:19:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5356L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#5358 AS p_comment_prf_0#5368, p_name_prf#5359 AS p_name_prf_0#5369, rid#5360 AS rid_0#5370, p_type_prf#5361 AS p_type_prf_0#5371, p_retailprice_prf#5362 AS p_retailprice_prf_0#5372, p_mfgr_prf#5363 AS p_mfgr_prf_0#5373, p_container_prf#5364 AS p_container_prf_0#5374, p_brand_prf#5365 AS p_brand_prf_0#5375, p_size_prf#5366 AS p_size_prf_0#5376, p_partkey_prf#5367 AS p_partkey_prf_0#5377]
         :  +- Relation[p_comment_prf#5358,p_name_prf#5359,rid#5360,p_type_prf#5361,p_retailprice_prf#5362,p_mfgr_prf#5363,p_container_prf#5364,p_brand_prf#5365,p_size_prf#5366,p_partkey_prf#5367] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5378]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1635,value#1636] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1451
Elapsed time: 81ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/14 23:19:51 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 23:19:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5417L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 23:19:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5417L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#5457]
         :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#5442: string
         :     :- Project [l_returnflag_prf#5419 AS l_returnflag_prf_0#5438, l_orderkey_and_l_linenumber_prf#5420 AS l_orderkey_and_l_linenumber_prf_0#5439, l_comment_prf#5421 AS l_comment_prf_0#5440, l_linestatus_prf#5422 AS l_linestatus_prf_0#5441, rid#5423 AS rid_0#5442, l_shipmode_prf#5424 AS l_shipmode_prf_0#5443, l_shipinstruct_prf#5425 AS l_shipinstruct_prf_0#5444, l_quantity_prf#5426 AS l_quantity_prf_0#5445, l_receiptdate_prf#5427 AS l_receiptdate_prf_0#5446, l_linenumber_prf#5428 AS l_linenumber_prf_0#5447, l_tax_prf#5429 AS l_tax_prf_0#5448, l_shipdate_prf#5430 AS l_shipdate_prf_0#5449, l_extendedprice_prf#5431 AS l_extendedprice_prf_0#5450, l_partkey_prf#5432 AS l_partkey_prf_0#5451, l_discount_prf#5433 AS l_discount_prf_0#5452, l_partkey_and_l_suppkey_prf#5434 AS l_partkey_and_l_suppkey_prf_0#5453, l_commitdate_prf#5435 AS l_commitdate_prf_0#5454, l_suppkey_prf#5436 AS l_suppkey_prf_0#5455, l_orderkey_prf#5437 AS l_orderkey_prf_0#5456]
         :     :  +- Relation[l_returnflag_prf#5419,l_orderkey_and_l_linenumber_prf#5420,l_comment_prf#5421,l_linestatus_prf#5422,rid#5423,l_shipmode_prf#5424,l_shipinstruct_prf#5425,l_quantity_prf#5426,l_receiptdate_prf#5427,l_linenumber_prf#5428,l_tax_prf#5429,l_shipdate_prf#5430,l_extendedprice_prf#5431,l_partkey_prf#5432,l_discount_prf#5433,l_partkey_and_l_suppkey_prf#5434,l_commitdate_prf#5435,l_suppkey_prf#5436,l_orderkey_prf#5437] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#5458 AS p_comment_prf_1#5468, p_name_prf#5459 AS p_name_prf_1#5469, rid#5460 AS rid_1#5470, p_type_prf#5461 AS p_type_prf_1#5471, p_retailprice_prf#5462 AS p_retailprice_prf_1#5472, p_mfgr_prf#5463 AS p_mfgr_prf_1#5473, p_container_prf#5464 AS p_container_prf_1#5474, p_brand_prf#5465 AS p_brand_prf_1#5475, p_size_prf#5466 AS p_size_prf_1#5476, p_partkey_prf#5467 AS p_partkey_prf_1#5477]
            +- Relation[p_comment_prf#5458,p_name_prf#5459,rid#5460,p_type_prf#5461,p_retailprice_prf#5462,p_mfgr_prf#5463,p_container_prf#5464,p_brand_prf#5465,p_size_prf#5466,p_partkey_prf#5467] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 117335ms
query=b1a, count=15628, duration=397
query=b1b, count=15628, duration=49517
query=b2a, count=1478870, duration=196926
query=b2b, count=1478870, duration=54278
query=f1, count=1, duration=51
query=f2, count=3907, duration=129
query=f3, count=1451, duration=81
query=f4, count=1, duration=53
query=f5, count=1478870, duration=23579
query=f6, count=857401, duration=13694
query=j1, count=800000, duration=31625
query=j10, count=6001215, duration=86561
query=j2, count=800000, duration=10969
query=j3, count=25, duration=74
query=j4, count=150000, duration=1927
query=j5, count=10000, duration=189
query=j6, count=6001215, duration=116061
query=j7, count=1500000, duration=40183
query=j8, count=6001215, duration=195084
query=j8b, count=6001215, duration=114331
query=j9, count=6001215, duration=94535
query=j9b, count=6001215, duration=117335
query=r1a, count=6001215, duration=169726
query=r1b, count=6001215, duration=148131
query=r1c, count=6001215, duration=157930
query=r1d, count=6001215, duration=233200
query=r1e, count=6001215, duration=234343
query=r1f, count=6001215, duration=157264
query=t1a, count=60000414, duration=20572
query=t1b, count=60000414, duration=25622
query=t1c, count=60000414, duration=89031
query=t2a, count=800000, duration=105332
query=t2b, count=800000, duration=84396
query=t2c, count=800000, duration=42794
query=t2d, count=800000, duration=61585
query=t3a, count=6001215, duration=222584
query=t3b, count=6001215, duration=196010
query=t3c, count=6001215, duration=193016
query=t3d, count=6001215, duration=186729
