19/10/17 01:47:20 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7197ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Thu Oct 17 01:47:22 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Thu Oct 17 01:47:23 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Thu Oct 17 01:47:23 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Thu Oct 17 01:47:23 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Thu Oct 17 01:47:23 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Thu Oct 17 01:47:26 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Thu Oct 17 01:47:28 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Thu Oct 17 01:47:28 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



ft2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and (p_size = 15 and s_suppkey = ps_suppkey)
19/10/17 01:47:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:47:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2081L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/17 01:47:30 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:47:30 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:47:30 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 01:47:30 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:47:30 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 01:47:30 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 01:47:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2081L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#2083 AS s_phone_prf_0#2091, rid#2084 AS rid_0#2092, s_address_prf#2085 AS s_address_prf_0#2093, s_nationkey_prf#2086 AS s_nationkey_prf_0#2094, s_suppkey_prf#2087 AS s_suppkey_prf_0#2095, s_name_prf#2088 AS s_name_prf_0#2096, s_acctbal_prf#2089 AS s_acctbal_prf_0#2097, s_comment_prf#2090 AS s_comment_prf_0#2098]
         :  :  +- Relation[s_phone_prf#2083,rid#2084,s_address_prf#2085,s_nationkey_prf#2086,s_suppkey_prf#2087,s_name_prf#2088,s_acctbal_prf#2089,s_comment_prf#2090] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2109) AS rid_2#2110]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2107]
         :        :  +- Relation[s_phone_prf#2099,rid#2100,s_address_prf#2101,s_nationkey_prf#2102,s_suppkey_prf#2103,s_name_prf#2104,s_acctbal_prf#2105,s_comment_prf#2106] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#2134]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#2123: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#2111 AS p_comment_prf_1#2121, p_name_prf#2112 AS p_name_prf_1#2122, rid#2113 AS rid_1#2123, p_type_prf#2114 AS p_type_prf_1#2124, p_retailprice_prf#2115 AS p_retailprice_prf_1#2125, p_mfgr_prf#2116 AS p_mfgr_prf_1#2126, p_container_prf#2117 AS p_container_prf_1#2127, p_brand_prf#2118 AS p_brand_prf_1#2128, p_size_prf#2119 AS p_size_prf_1#2129, p_partkey_prf#2120 AS p_partkey_prf_1#2130]
            :     :  :  +- Relation[p_comment_prf#2111,p_name_prf#2112,rid#2113,p_type_prf#2114,p_retailprice_prf#2115,p_mfgr_prf#2116,p_container_prf#2117,p_brand_prf#2118,p_size_prf#2119,p_partkey_prf#2120] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2133]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#2135 AS ps_partkey_and_ps_suppkey_prf_2#2142, rid#2136 AS rid_2#2143, ps_availqty_prf#2137 AS ps_availqty_prf_2#2144, ps_comment_prf#2138 AS ps_comment_prf_2#2145, ps_partkey_prf#2139 AS ps_partkey_prf_2#2146, ps_supplycost_prf#2140 AS ps_supplycost_prf_2#2147, ps_suppkey_prf#2141 AS ps_suppkey_prf_2#2148]
               +- Relation[ps_partkey_and_ps_suppkey_prf#2135,rid#2136,ps_availqty_prf#2137,ps_comment_prf#2138,ps_partkey_prf#2139,ps_supplycost_prf#2140,ps_suppkey_prf#2141] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 7219ms

fs1b=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/17 01:47:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:47:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2219L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L, l_partkey#307L]
               :  +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L]
                  +- Join Inner, (c_custkey#290L = o_custkey#343L)
                     :- Project [c_custkey#290L]
                     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
                     +- Project [o_orderkey#342L, o_custkey#343L]
                        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 01:47:37 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:47:37 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:47:37 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:47:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2219L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [p_comment_prf#2221 AS p_comment_prf_0#2231, p_name_prf#2222 AS p_name_prf_0#2232, rid#2223 AS rid_0#2233, p_type_prf#2224 AS p_type_prf_0#2234, p_retailprice_prf#2225 AS p_retailprice_prf_0#2235, p_mfgr_prf#2226 AS p_mfgr_prf_0#2236, p_container_prf#2227 AS p_container_prf_0#2237, p_brand_prf#2228 AS p_brand_prf_0#2238, p_size_prf#2229 AS p_size_prf_0#2239, p_partkey_prf#2230 AS p_partkey_prf_0#2240]
         :  :  +- Relation[p_comment_prf#2221,p_name_prf#2222,rid#2223,p_type_prf#2224,p_retailprice_prf#2225,p_mfgr_prf#2226,p_container_prf#2227,p_brand_prf#2228,p_size_prf#2229,p_partkey_prf#2230] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#2252]
         :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2251]
         :        :  +- Relation[p_comment_prf#2241,p_name_prf#2242,rid#2243,p_type_prf#2244,p_retailprice_prf#2245,p_mfgr_prf#2246,p_container_prf#2247,p_brand_prf#2248,p_size_prf#2249,p_partkey_prf#2250] JDBCRelation(part_prf) [numPartitions=1]
         :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [l_returnflag_prf#2253 AS l_returnflag_prf_1#2272, l_orderkey_and_l_linenumber_prf#2254 AS l_orderkey_and_l_linenumber_prf_1#2273, l_comment_prf#2255 AS l_comment_prf_1#2274, l_linestatus_prf#2256 AS l_linestatus_prf_1#2275, rid#2257 AS rid_1#2276, l_shipmode_prf#2258 AS l_shipmode_prf_1#2277, l_shipinstruct_prf#2259 AS l_shipinstruct_prf_1#2278, l_quantity_prf#2260 AS l_quantity_prf_1#2279, l_receiptdate_prf#2261 AS l_receiptdate_prf_1#2280, l_linenumber_prf#2262 AS l_linenumber_prf_1#2281, l_tax_prf#2263 AS l_tax_prf_1#2282, l_shipdate_prf#2264 AS l_shipdate_prf_1#2283, l_extendedprice_prf#2265 AS l_extendedprice_prf_1#2284, l_partkey_prf#2266 AS l_partkey_prf_1#2285, l_discount_prf#2267 AS l_discount_prf_1#2286, l_partkey_and_l_suppkey_prf#2268 AS l_partkey_and_l_suppkey_prf_1#2287, l_commitdate_prf#2269 AS l_commitdate_prf_1#2288, l_suppkey_prf#2270 AS l_suppkey_prf_1#2289, l_orderkey_prf#2271 AS l_orderkey_prf_1#2290]
            :  :  +- Relation[l_returnflag_prf#2253,l_orderkey_and_l_linenumber_prf#2254,l_comment_prf#2255,l_linestatus_prf#2256,rid#2257,l_shipmode_prf#2258,l_shipinstruct_prf#2259,l_quantity_prf#2260,l_receiptdate_prf#2261,l_linenumber_prf#2262,l_tax_prf#2263,l_shipdate_prf#2264,l_extendedprice_prf#2265,l_partkey_prf#2266,l_discount_prf#2267,l_partkey_and_l_suppkey_prf#2268,l_commitdate_prf#2269,l_suppkey_prf#2270,l_orderkey_prf#2271] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2109) AS rid_3#2311]
            :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#2310]
            :        :  +- Relation[l_returnflag_prf#2291,l_orderkey_and_l_linenumber_prf#2292,l_comment_prf#2293,l_linestatus_prf#2294,rid#2295,l_shipmode_prf#2296,l_shipinstruct_prf#2297,l_quantity_prf#2298,l_receiptdate_prf#2299,l_linenumber_prf#2300,l_tax_prf#2301,l_shipdate_prf#2302,l_extendedprice_prf#2303,l_partkey_prf#2304,l_discount_prf#2305,l_partkey_and_l_suppkey_prf#2306,l_commitdate_prf#2307,l_suppkey_prf#2308,l_orderkey_prf#2309] JDBCRelation(lineitem_prf) [numPartitions=1]
            :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join NaturalJoin(Inner)
               :- 'Project ['c_acctbal_prf_2, 'rid_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2109) AS rid_3#2331]
               :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_2#2322: string
               :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :     :  :- Project [c_acctbal_prf#2312 AS c_acctbal_prf_2#2321, rid#2313 AS rid_2#2322, c_name_prf#2314 AS c_name_prf_2#2323, c_nationkey_prf#2315 AS c_nationkey_prf_2#2324, c_custkey_prf#2316 AS c_custkey_prf_2#2325, c_comment_prf#2317 AS c_comment_prf_2#2326, c_address_prf#2318 AS c_address_prf_2#2327, c_mktsegment_prf#2319 AS c_mktsegment_prf_2#2328, c_phone_prf#2320 AS c_phone_prf_2#2329]
               :     :  :  +- Relation[c_acctbal_prf#2312,rid#2313,c_name_prf#2314,c_nationkey_prf#2315,c_custkey_prf#2316,c_comment_prf#2317,c_address_prf#2318,c_mktsegment_prf#2319,c_phone_prf#2320] JDBCRelation(customer_prf) [numPartitions=1]
               :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#2330]
               :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
               :     :        +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
               :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
               +- Project [o_shippriority_prf#2332 AS o_shippriority_prf_3#2342, rid#2333 AS rid_3#2343, o_orderdate_prf#2334 AS o_orderdate_prf_3#2344, o_custkey_prf#2335 AS o_custkey_prf_3#2345, o_orderpriority_prf#2336 AS o_orderpriority_prf_3#2346, o_clerk_prf#2337 AS o_clerk_prf_3#2347, o_orderstatus_prf#2338 AS o_orderstatus_prf_3#2348, o_totalprice_prf#2339 AS o_totalprice_prf_3#2349, o_orderkey_prf#2340 AS o_orderkey_prf_3#2350, o_comment_prf#2341 AS o_comment_prf_3#2351]
                  +- Relation[o_shippriority_prf#2332,rid#2333,o_orderdate_prf#2334,o_custkey_prf#2335,o_orderpriority_prf#2336,o_clerk_prf#2337,o_orderstatus_prf#2338,o_totalprice_prf#2339,o_orderkey_prf#2340,o_comment_prf#2341] JDBCRelation(orders_prf) [numPartitions=1]

19/10/17 01:47:37 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=1214743
Elapsed time: 172655ms

ft1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/17 01:50:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:50:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2422L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/17 01:50:30 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:50:30 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:50:30 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:50:30 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:50:30 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:50:30 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:50:30 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:50:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2422L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#2424 AS c_acctbal_prf_0#2433, rid#2425 AS rid_0#2434, c_name_prf#2426 AS c_name_prf_0#2435, c_nationkey_prf#2427 AS c_nationkey_prf_0#2436, c_custkey_prf#2428 AS c_custkey_prf_0#2437, c_comment_prf#2429 AS c_comment_prf_0#2438, c_address_prf#2430 AS c_address_prf_0#2439, c_mktsegment_prf#2431 AS c_mktsegment_prf_0#2440, c_phone_prf#2432 AS c_phone_prf_0#2441]
         :  :  +- Relation[c_acctbal_prf#2424,rid#2425,c_name_prf#2426,c_nationkey_prf#2427,c_custkey_prf#2428,c_comment_prf#2429,c_address_prf#2430,c_mktsegment_prf#2431,c_phone_prf#2432] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2109) AS rid_2#2452]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2451]
         :        :  +- Relation[c_acctbal_prf#2442,rid#2443,c_name_prf#2444,c_nationkey_prf#2445,c_custkey_prf#2446,c_comment_prf#2447,c_address_prf#2448,c_mktsegment_prf#2449,c_phone_prf#2450] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [s_phone_prf#2453 AS s_phone_prf_1#2461, rid#2454 AS rid_1#2462, s_address_prf#2455 AS s_address_prf_1#2463, s_nationkey_prf#2456 AS s_nationkey_prf_1#2464, s_suppkey_prf#2457 AS s_suppkey_prf_1#2465, s_name_prf#2458 AS s_name_prf_1#2466, s_acctbal_prf#2459 AS s_acctbal_prf_1#2467, s_comment_prf#2460 AS s_comment_prf_1#2468]
            :  :  +- Relation[s_phone_prf#2453,rid#2454,s_address_prf#2455,s_nationkey_prf#2456,s_suppkey_prf#2457,s_name_prf#2458,s_acctbal_prf#2459,s_comment_prf#2460] JDBCRelation(supplier_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#2478]
            :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#2477]
            :        :  +- Relation[s_phone_prf#2469,rid#2470,s_address_prf#2471,s_nationkey_prf#2472,s_suppkey_prf#2473,s_name_prf#2474,s_acctbal_prf#2475,s_comment_prf#2476] JDBCRelation(supplier_prf) [numPartitions=1]
            :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [rid#2479 AS rid_2#2484, n_regionkey_prf#2480 AS n_regionkey_prf_2#2485, n_nationkey_prf#2481 AS n_nationkey_prf_2#2486, n_name_prf#2482 AS n_name_prf_2#2487, n_comment_prf#2483 AS n_comment_prf_2#2488]
               :  +- Relation[rid#2479,n_regionkey_prf#2480,n_nationkey_prf#2481,n_name_prf#2482,n_comment_prf#2483] JDBCRelation(nation_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#2489]
                  +- DexRidFilter nation~n_name~FRANCE
                     +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 33166ms

fq1f=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 01:51:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:51:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2552L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/17 01:51:03 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:51:03 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:51:03 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 01:51:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2552L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- Project [l_returnflag_prf#2554 AS l_returnflag_prf_0#2573, l_orderkey_and_l_linenumber_prf#2555 AS l_orderkey_and_l_linenumber_prf_0#2574, l_comment_prf#2556 AS l_comment_prf_0#2575, l_linestatus_prf#2557 AS l_linestatus_prf_0#2576, rid#2558 AS rid_0#2577, l_shipmode_prf#2559 AS l_shipmode_prf_0#2578, l_shipinstruct_prf#2560 AS l_shipinstruct_prf_0#2579, l_quantity_prf#2561 AS l_quantity_prf_0#2580, l_receiptdate_prf#2562 AS l_receiptdate_prf_0#2581, l_linenumber_prf#2563 AS l_linenumber_prf_0#2582, l_tax_prf#2564 AS l_tax_prf_0#2583, l_shipdate_prf#2565 AS l_shipdate_prf_0#2584, l_extendedprice_prf#2566 AS l_extendedprice_prf_0#2585, l_partkey_prf#2567 AS l_partkey_prf_0#2586, l_discount_prf#2568 AS l_discount_prf_0#2587, l_partkey_and_l_suppkey_prf#2569 AS l_partkey_and_l_suppkey_prf_0#2588, l_commitdate_prf#2570 AS l_commitdate_prf_0#2589, l_suppkey_prf#2571 AS l_suppkey_prf_0#2590, l_orderkey_prf#2572 AS l_orderkey_prf_0#2591]
         :  :  :  :  :  :  +- Relation[l_returnflag_prf#2554,l_orderkey_and_l_linenumber_prf#2555,l_comment_prf#2556,l_linestatus_prf#2557,rid#2558,l_shipmode_prf#2559,l_shipinstruct_prf#2560,l_quantity_prf#2561,l_receiptdate_prf#2562,l_linenumber_prf#2563,l_tax_prf#2564,l_shipdate_prf#2565,l_extendedprice_prf#2566,l_partkey_prf#2567,l_discount_prf#2568,l_partkey_and_l_suppkey_prf#2569,l_commitdate_prf#2570,l_suppkey_prf#2571,l_orderkey_prf#2572] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#2612]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :  :  :        :- 'Project ['rid AS rid_0#2611]
         :  :  :  :  :        :  +- Relation[l_returnflag_prf#2592,l_orderkey_and_l_linenumber_prf#2593,l_comment_prf#2594,l_linestatus_prf#2595,rid#2596,l_shipmode_prf#2597,l_shipinstruct_prf#2598,l_quantity_prf#2599,l_receiptdate_prf#2600,l_linenumber_prf#2601,l_tax_prf#2602,l_shipdate_prf#2603,l_extendedprice_prf#2604,l_partkey_prf#2605,l_discount_prf#2606,l_partkey_and_l_suppkey_prf#2607,l_commitdate_prf#2608,l_suppkey_prf#2609,l_orderkey_prf#2610] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [o_shippriority_prf#2613 AS o_shippriority_prf_1#2623, rid#2614 AS rid_1#2624, o_orderdate_prf#2615 AS o_orderdate_prf_1#2625, o_custkey_prf#2616 AS o_custkey_prf_1#2626, o_orderpriority_prf#2617 AS o_orderpriority_prf_1#2627, o_clerk_prf#2618 AS o_clerk_prf_1#2628, o_orderstatus_prf#2619 AS o_orderstatus_prf_1#2629, o_totalprice_prf#2620 AS o_totalprice_prf_1#2630, o_orderkey_prf#2621 AS o_orderkey_prf_1#2631, o_comment_prf#2622 AS o_comment_prf_1#2632]
         :  :  :  :     +- Relation[o_shippriority_prf#2613,rid#2614,o_orderdate_prf#2615,o_custkey_prf#2616,o_orderpriority_prf#2617,o_clerk_prf#2618,o_orderstatus_prf#2619,o_totalprice_prf#2620,o_orderkey_prf#2621,o_comment_prf#2622] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#2644]
         :  :  :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :  :  :        :- 'Project ['rid AS rid_1#2643]
         :  :  :        :  +- Relation[o_shippriority_prf#2633,rid#2634,o_orderdate_prf#2635,o_custkey_prf#2636,o_orderpriority_prf#2637,o_clerk_prf#2638,o_orderstatus_prf#2639,o_totalprice_prf#2640,o_orderkey_prf#2641,o_comment_prf#2642] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#2645 AS c_acctbal_prf_2#2654, rid#2646 AS rid_2#2655, c_name_prf#2647 AS c_name_prf_2#2656, c_nationkey_prf#2648 AS c_nationkey_prf_2#2657, c_custkey_prf#2649 AS c_custkey_prf_2#2658, c_comment_prf#2650 AS c_comment_prf_2#2659, c_address_prf#2651 AS c_address_prf_2#2660, c_mktsegment_prf#2652 AS c_mktsegment_prf_2#2661, c_phone_prf#2653 AS c_phone_prf_2#2662]
         :  :     +- Relation[c_acctbal_prf#2645,rid#2646,c_name_prf#2647,c_nationkey_prf#2648,c_custkey_prf#2649,c_comment_prf#2650,c_address_prf#2651,c_mktsegment_prf#2652,c_phone_prf#2653] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2109) AS rid_3#2673]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#2672]
         :        :  +- Relation[c_acctbal_prf#2663,rid#2664,c_name_prf#2665,c_nationkey_prf#2666,c_custkey_prf#2667,c_comment_prf#2668,c_address_prf#2669,c_mktsegment_prf#2670,c_phone_prf#2671] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_3))
            :- Project [rid#2674 AS rid_3#2679, n_regionkey_prf#2675 AS n_regionkey_prf_3#2680, n_nationkey_prf#2676 AS n_nationkey_prf_3#2681, n_name_prf#2677 AS n_name_prf_3#2682, n_comment_prf#2678 AS n_comment_prf_3#2683]
            :  +- Relation[rid#2674,n_regionkey_prf#2675,n_nationkey_prf#2676,n_name_prf#2677,n_comment_prf#2678] JDBCRelation(nation_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#2684]
               +- DexRidFilter nation~n_name~FRANCE
                  +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 167989ms

fr2e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/17 01:53:51 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:53:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2764L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 01:53:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2764L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#2766 AS c_acctbal_prf_0#2775, rid#2767 AS rid_0#2776, c_name_prf#2768 AS c_name_prf_0#2777, c_nationkey_prf#2769 AS c_nationkey_prf_0#2778, c_custkey_prf#2770 AS c_custkey_prf_0#2779, c_comment_prf#2771 AS c_comment_prf_0#2780, c_address_prf#2772 AS c_address_prf_0#2781, c_mktsegment_prf#2773 AS c_mktsegment_prf_0#2782, c_phone_prf#2774 AS c_phone_prf_0#2783]
         :  :  +- Relation[c_acctbal_prf#2766,rid#2767,c_name_prf#2768,c_nationkey_prf#2769,c_custkey_prf#2770,c_comment_prf#2771,c_address_prf#2772,c_mktsegment_prf#2773,c_phone_prf#2774] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#2794]
         :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2793]
         :        :  +- Relation[c_acctbal_prf#2784,rid#2785,c_name_prf#2786,c_nationkey_prf#2787,c_custkey_prf#2788,c_comment_prf#2789,c_address_prf#2790,c_mktsegment_prf#2791,c_phone_prf#2792] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#2816]
            :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#2806: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#2795 AS o_shippriority_prf_1#2805, rid#2796 AS rid_1#2806, o_orderdate_prf#2797 AS o_orderdate_prf_1#2807, o_custkey_prf#2798 AS o_custkey_prf_1#2808, o_orderpriority_prf#2799 AS o_orderpriority_prf_1#2809, o_clerk_prf#2800 AS o_clerk_prf_1#2810, o_orderstatus_prf#2801 AS o_orderstatus_prf_1#2811, o_totalprice_prf#2802 AS o_totalprice_prf_1#2812, o_orderkey_prf#2803 AS o_orderkey_prf_1#2813, o_comment_prf#2804 AS o_comment_prf_1#2814]
            :     :  :  +- Relation[o_shippriority_prf#2795,rid#2796,o_orderdate_prf#2797,o_custkey_prf#2798,o_orderpriority_prf#2799,o_clerk_prf#2800,o_orderstatus_prf#2801,o_totalprice_prf#2802,o_orderkey_prf#2803,o_comment_prf#2804] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2815]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2817 AS l_returnflag_prf_2#2836, l_orderkey_and_l_linenumber_prf#2818 AS l_orderkey_and_l_linenumber_prf_2#2837, l_comment_prf#2819 AS l_comment_prf_2#2838, l_linestatus_prf#2820 AS l_linestatus_prf_2#2839, rid#2821 AS rid_2#2840, l_shipmode_prf#2822 AS l_shipmode_prf_2#2841, l_shipinstruct_prf#2823 AS l_shipinstruct_prf_2#2842, l_quantity_prf#2824 AS l_quantity_prf_2#2843, l_receiptdate_prf#2825 AS l_receiptdate_prf_2#2844, l_linenumber_prf#2826 AS l_linenumber_prf_2#2845, l_tax_prf#2827 AS l_tax_prf_2#2846, l_shipdate_prf#2828 AS l_shipdate_prf_2#2847, l_extendedprice_prf#2829 AS l_extendedprice_prf_2#2848, l_partkey_prf#2830 AS l_partkey_prf_2#2849, l_discount_prf#2831 AS l_discount_prf_2#2850, l_partkey_and_l_suppkey_prf#2832 AS l_partkey_and_l_suppkey_prf_2#2851, l_commitdate_prf#2833 AS l_commitdate_prf_2#2852, l_suppkey_prf#2834 AS l_suppkey_prf_2#2853, l_orderkey_prf#2835 AS l_orderkey_prf_2#2854]
               +- Relation[l_returnflag_prf#2817,l_orderkey_and_l_linenumber_prf#2818,l_comment_prf#2819,l_linestatus_prf#2820,rid#2821,l_shipmode_prf#2822,l_shipinstruct_prf#2823,l_quantity_prf#2824,l_receiptdate_prf#2825,l_linenumber_prf#2826,l_tax_prf#2827,l_shipdate_prf#2828,l_extendedprice_prf#2829,l_partkey_prf#2830,l_discount_prf#2831,l_partkey_and_l_suppkey_prf#2832,l_commitdate_prf#2833,l_suppkey_prf#2834,l_orderkey_prf#2835] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 96765ms

ft3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and (p_size = 15 and s_suppkey = l_suppkey)
19/10/17 01:55:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:55:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2928L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 01:55:27 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:55:27 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:55:27 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 01:55:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2928L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#2930 AS s_phone_prf_0#2938, rid#2931 AS rid_0#2939, s_address_prf#2932 AS s_address_prf_0#2940, s_nationkey_prf#2933 AS s_nationkey_prf_0#2941, s_suppkey_prf#2934 AS s_suppkey_prf_0#2942, s_name_prf#2935 AS s_name_prf_0#2943, s_acctbal_prf#2936 AS s_acctbal_prf_0#2944, s_comment_prf#2937 AS s_comment_prf_0#2945]
         :  :  +- Relation[s_phone_prf#2930,rid#2931,s_address_prf#2932,s_nationkey_prf#2933,s_suppkey_prf#2934,s_name_prf#2935,s_acctbal_prf#2936,s_comment_prf#2937] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2109) AS rid_2#2955]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2954]
         :        :  +- Relation[s_phone_prf#2946,rid#2947,s_address_prf#2948,s_nationkey_prf#2949,s_suppkey_prf#2950,s_name_prf#2951,s_acctbal_prf#2952,s_comment_prf#2953] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#2977]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#2968: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#2956 AS p_comment_prf_1#2966, p_name_prf#2957 AS p_name_prf_1#2967, rid#2958 AS rid_1#2968, p_type_prf#2959 AS p_type_prf_1#2969, p_retailprice_prf#2960 AS p_retailprice_prf_1#2970, p_mfgr_prf#2961 AS p_mfgr_prf_1#2971, p_container_prf#2962 AS p_container_prf_1#2972, p_brand_prf#2963 AS p_brand_prf_1#2973, p_size_prf#2964 AS p_size_prf_1#2974, p_partkey_prf#2965 AS p_partkey_prf_1#2975]
            :     :  :  +- Relation[p_comment_prf#2956,p_name_prf#2957,rid#2958,p_type_prf#2959,p_retailprice_prf#2960,p_mfgr_prf#2961,p_container_prf#2962,p_brand_prf#2963,p_size_prf#2964,p_partkey_prf#2965] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2976]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2978 AS l_returnflag_prf_2#2997, l_orderkey_and_l_linenumber_prf#2979 AS l_orderkey_and_l_linenumber_prf_2#2998, l_comment_prf#2980 AS l_comment_prf_2#2999, l_linestatus_prf#2981 AS l_linestatus_prf_2#3000, rid#2982 AS rid_2#3001, l_shipmode_prf#2983 AS l_shipmode_prf_2#3002, l_shipinstruct_prf#2984 AS l_shipinstruct_prf_2#3003, l_quantity_prf#2985 AS l_quantity_prf_2#3004, l_receiptdate_prf#2986 AS l_receiptdate_prf_2#3005, l_linenumber_prf#2987 AS l_linenumber_prf_2#3006, l_tax_prf#2988 AS l_tax_prf_2#3007, l_shipdate_prf#2989 AS l_shipdate_prf_2#3008, l_extendedprice_prf#2990 AS l_extendedprice_prf_2#3009, l_partkey_prf#2991 AS l_partkey_prf_2#3010, l_discount_prf#2992 AS l_discount_prf_2#3011, l_partkey_and_l_suppkey_prf#2993 AS l_partkey_and_l_suppkey_prf_2#3012, l_commitdate_prf#2994 AS l_commitdate_prf_2#3013, l_suppkey_prf#2995 AS l_suppkey_prf_2#3014, l_orderkey_prf#2996 AS l_orderkey_prf_2#3015]
               +- Relation[l_returnflag_prf#2978,l_orderkey_and_l_linenumber_prf#2979,l_comment_prf#2980,l_linestatus_prf#2981,rid#2982,l_shipmode_prf#2983,l_shipinstruct_prf#2984,l_quantity_prf#2985,l_receiptdate_prf#2986,l_linenumber_prf#2987,l_tax_prf#2988,l_shipdate_prf#2989,l_extendedprice_prf#2990,l_partkey_prf#2991,l_discount_prf#2992,l_partkey_and_l_suppkey_prf#2993,l_commitdate_prf#2994,l_suppkey_prf#2995,l_orderkey_prf#2996] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 55778ms

fr1e=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and (o_orderkey = l_orderkey and c_custkey = o_custkey)
19/10/17 01:56:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:56:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3089L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 01:56:23 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:56:23 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:56:23 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:56:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3089L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#3110]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3101: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [c_acctbal_prf#3091 AS c_acctbal_prf_0#3100, rid#3092 AS rid_0#3101, c_name_prf#3093 AS c_name_prf_0#3102, c_nationkey_prf#3094 AS c_nationkey_prf_0#3103, c_custkey_prf#3095 AS c_custkey_prf_0#3104, c_comment_prf#3096 AS c_comment_prf_0#3105, c_address_prf#3097 AS c_address_prf_0#3106, c_mktsegment_prf#3098 AS c_mktsegment_prf_0#3107, c_phone_prf#3099 AS c_phone_prf_0#3108]
         :     :  :  +- Relation[c_acctbal_prf#3091,rid#3092,c_name_prf#3093,c_nationkey_prf#3094,c_custkey_prf#3095,c_comment_prf#3096,c_address_prf#3097,c_mktsegment_prf#3098,c_phone_prf#3099] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3109]
         :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :        +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [o_shippriority_prf#3111 AS o_shippriority_prf_1#3121, rid#3112 AS rid_1#3122, o_orderdate_prf#3113 AS o_orderdate_prf_1#3123, o_custkey_prf#3114 AS o_custkey_prf_1#3124, o_orderpriority_prf#3115 AS o_orderpriority_prf_1#3125, o_clerk_prf#3116 AS o_clerk_prf_1#3126, o_orderstatus_prf#3117 AS o_orderstatus_prf_1#3127, o_totalprice_prf#3118 AS o_totalprice_prf_1#3128, o_orderkey_prf#3119 AS o_orderkey_prf_1#3129, o_comment_prf#3120 AS o_comment_prf_1#3130]
            :  :  +- Relation[o_shippriority_prf#3111,rid#3112,o_orderdate_prf#3113,o_custkey_prf#3114,o_orderpriority_prf#3115,o_clerk_prf#3116,o_orderstatus_prf#3117,o_totalprice_prf#3118,o_orderkey_prf#3119,o_comment_prf#3120] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#3142]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#3141]
            :        :  +- Relation[o_shippriority_prf#3131,rid#3132,o_orderdate_prf#3133,o_custkey_prf#3134,o_orderpriority_prf#3135,o_clerk_prf#3136,o_orderstatus_prf#3137,o_totalprice_prf#3138,o_orderkey_prf#3139,o_comment_prf#3140] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3143 AS l_returnflag_prf_2#3162, l_orderkey_and_l_linenumber_prf#3144 AS l_orderkey_and_l_linenumber_prf_2#3163, l_comment_prf#3145 AS l_comment_prf_2#3164, l_linestatus_prf#3146 AS l_linestatus_prf_2#3165, rid#3147 AS rid_2#3166, l_shipmode_prf#3148 AS l_shipmode_prf_2#3167, l_shipinstruct_prf#3149 AS l_shipinstruct_prf_2#3168, l_quantity_prf#3150 AS l_quantity_prf_2#3169, l_receiptdate_prf#3151 AS l_receiptdate_prf_2#3170, l_linenumber_prf#3152 AS l_linenumber_prf_2#3171, l_tax_prf#3153 AS l_tax_prf_2#3172, l_shipdate_prf#3154 AS l_shipdate_prf_2#3173, l_extendedprice_prf#3155 AS l_extendedprice_prf_2#3174, l_partkey_prf#3156 AS l_partkey_prf_2#3175, l_discount_prf#3157 AS l_discount_prf_2#3176, l_partkey_and_l_suppkey_prf#3158 AS l_partkey_and_l_suppkey_prf_2#3177, l_commitdate_prf#3159 AS l_commitdate_prf_2#3178, l_suppkey_prf#3160 AS l_suppkey_prf_2#3179, l_orderkey_prf#3161 AS l_orderkey_prf_2#3180]
               +- Relation[l_returnflag_prf#3143,l_orderkey_and_l_linenumber_prf#3144,l_comment_prf#3145,l_linestatus_prf#3146,rid#3147,l_shipmode_prf#3148,l_shipinstruct_prf#3149,l_quantity_prf#3150,l_receiptdate_prf#3151,l_linenumber_prf#3152,l_tax_prf#3153,l_shipdate_prf#3154,l_extendedprice_prf#3155,l_partkey_prf#3156,l_discount_prf#3157,l_partkey_and_l_suppkey_prf#3158,l_commitdate_prf#3159,l_suppkey_prf#3160,l_orderkey_prf#3161] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 152869ms

fs1c=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/17 01:58:56 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:58:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3264L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_orderkey#306L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 01:58:56 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:58:56 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:58:56 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:58:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3264L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [p_comment_prf#3266 AS p_comment_prf_0#3276, p_name_prf#3267 AS p_name_prf_0#3277, rid#3268 AS rid_0#3278, p_type_prf#3269 AS p_type_prf_0#3279, p_retailprice_prf#3270 AS p_retailprice_prf_0#3280, p_mfgr_prf#3271 AS p_mfgr_prf_0#3281, p_container_prf#3272 AS p_container_prf_0#3282, p_brand_prf#3273 AS p_brand_prf_0#3283, p_size_prf#3274 AS p_size_prf_0#3284, p_partkey_prf#3275 AS p_partkey_prf_0#3285]
         :  :  :  :  +- Relation[p_comment_prf#3266,p_name_prf#3267,rid#3268,p_type_prf#3269,p_retailprice_prf#3270,p_mfgr_prf#3271,p_container_prf#3272,p_brand_prf#3273,p_size_prf#3274,p_partkey_prf#3275] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#3297]
         :  :  :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#3296]
         :  :  :        :  +- Relation[p_comment_prf#3286,p_name_prf#3287,rid#3288,p_type_prf#3289,p_retailprice_prf#3290,p_mfgr_prf#3291,p_container_prf#3292,p_brand_prf#3293,p_size_prf#3294,p_partkey_prf#3295] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#3298 AS l_returnflag_prf_1#3317, l_orderkey_and_l_linenumber_prf#3299 AS l_orderkey_and_l_linenumber_prf_1#3318, l_comment_prf#3300 AS l_comment_prf_1#3319, l_linestatus_prf#3301 AS l_linestatus_prf_1#3320, rid#3302 AS rid_1#3321, l_shipmode_prf#3303 AS l_shipmode_prf_1#3322, l_shipinstruct_prf#3304 AS l_shipinstruct_prf_1#3323, l_quantity_prf#3305 AS l_quantity_prf_1#3324, l_receiptdate_prf#3306 AS l_receiptdate_prf_1#3325, l_linenumber_prf#3307 AS l_linenumber_prf_1#3326, l_tax_prf#3308 AS l_tax_prf_1#3327, l_shipdate_prf#3309 AS l_shipdate_prf_1#3328, l_extendedprice_prf#3310 AS l_extendedprice_prf_1#3329, l_partkey_prf#3311 AS l_partkey_prf_1#3330, l_discount_prf#3312 AS l_discount_prf_1#3331, l_partkey_and_l_suppkey_prf#3313 AS l_partkey_and_l_suppkey_prf_1#3332, l_commitdate_prf#3314 AS l_commitdate_prf_1#3333, l_suppkey_prf#3315 AS l_suppkey_prf_1#3334, l_orderkey_prf#3316 AS l_orderkey_prf_1#3335]
         :  :     +- Relation[l_returnflag_prf#3298,l_orderkey_and_l_linenumber_prf#3299,l_comment_prf#3300,l_linestatus_prf#3301,rid#3302,l_shipmode_prf#3303,l_shipinstruct_prf#3304,l_quantity_prf#3305,l_receiptdate_prf#3306,l_linenumber_prf#3307,l_tax_prf#3308,l_shipdate_prf#3309,l_extendedprice_prf#3310,l_partkey_prf#3311,l_discount_prf#3312,l_partkey_and_l_suppkey_prf#3313,l_commitdate_prf#3314,l_suppkey_prf#3315,l_orderkey_prf#3316] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2109) AS rid_3#3356]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3355]
         :        :  +- Relation[l_returnflag_prf#3336,l_orderkey_and_l_linenumber_prf#3337,l_comment_prf#3338,l_linestatus_prf#3339,rid#3340,l_shipmode_prf#3341,l_shipinstruct_prf#3342,l_quantity_prf#3343,l_receiptdate_prf#3344,l_linenumber_prf#3345,l_tax_prf#3346,l_shipdate_prf#3347,l_extendedprice_prf#3348,l_partkey_prf#3349,l_discount_prf#3350,l_partkey_and_l_suppkey_prf#3351,l_commitdate_prf#3352,l_suppkey_prf#3353,l_orderkey_prf#3354] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_2, 'rid_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2109) AS rid_3#3376]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_2#3367: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [c_acctbal_prf#3357 AS c_acctbal_prf_2#3366, rid#3358 AS rid_2#3367, c_name_prf#3359 AS c_name_prf_2#3368, c_nationkey_prf#3360 AS c_nationkey_prf_2#3369, c_custkey_prf#3361 AS c_custkey_prf_2#3370, c_comment_prf#3362 AS c_comment_prf_2#3371, c_address_prf#3363 AS c_address_prf_2#3372, c_mktsegment_prf#3364 AS c_mktsegment_prf_2#3373, c_phone_prf#3365 AS c_phone_prf_2#3374]
            :     :  :  +- Relation[c_acctbal_prf#3357,rid#3358,c_name_prf#3359,c_nationkey_prf#3360,c_custkey_prf#3361,c_comment_prf#3362,c_address_prf#3363,c_mktsegment_prf#3364,c_phone_prf#3365] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#3375]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3377 AS o_shippriority_prf_3#3387, rid#3378 AS rid_3#3388, o_orderdate_prf#3379 AS o_orderdate_prf_3#3389, o_custkey_prf#3380 AS o_custkey_prf_3#3390, o_orderpriority_prf#3381 AS o_orderpriority_prf_3#3391, o_clerk_prf#3382 AS o_clerk_prf_3#3392, o_orderstatus_prf#3383 AS o_orderstatus_prf_3#3393, o_totalprice_prf#3384 AS o_totalprice_prf_3#3394, o_orderkey_prf#3385 AS o_orderkey_prf_3#3395, o_comment_prf#3386 AS o_comment_prf_3#3396]
               +- Relation[o_shippriority_prf#3377,rid#3378,o_orderdate_prf#3379,o_custkey_prf#3380,o_orderpriority_prf#3381,o_clerk_prf#3382,o_orderstatus_prf#3383,o_totalprice_prf#3384,o_orderkey_prf#3385,o_comment_prf#3386] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 172625ms

fq1a=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 02:01:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:01:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3485L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :     :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 02:01:49 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:01:49 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:01:49 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:01:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3485L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, 'rid_2, 'o_shippriority_prf_2, 'o_orderdate_prf_2, 'o_custkey_prf_2, 'o_orderpriority_prf_2, 'o_clerk_prf_2, 'o_orderstatus_prf_2, 'o_totalprice_prf_2, 'o_orderkey_prf_2, 'o_comment_prf_2, dexdecrypt('value_dec_key, value#2109) AS rid_3#3538]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#3517]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#3498]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#3492: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [rid#3487 AS rid_0#3492, n_regionkey_prf#3488 AS n_regionkey_prf_0#3493, n_nationkey_prf#3489 AS n_nationkey_prf_0#3494, n_name_prf#3490 AS n_name_prf_0#3495, n_comment_prf#3491 AS n_comment_prf_0#3496]
         :     :  :     :  :     :  :  +- Relation[rid#3487,n_regionkey_prf#3488,n_nationkey_prf#3489,n_name_prf#3490,n_comment_prf#3491] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3497]
         :     :  :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :  :     :        +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [c_acctbal_prf#3499 AS c_acctbal_prf_1#3508, rid#3500 AS rid_1#3509, c_name_prf#3501 AS c_name_prf_1#3510, c_nationkey_prf#3502 AS c_nationkey_prf_1#3511, c_custkey_prf#3503 AS c_custkey_prf_1#3512, c_comment_prf#3504 AS c_comment_prf_1#3513, c_address_prf#3505 AS c_address_prf_1#3514, c_mktsegment_prf#3506 AS c_mktsegment_prf_1#3515, c_phone_prf#3507 AS c_phone_prf_1#3516]
         :     :  :     :     +- Relation[c_acctbal_prf#3499,rid#3500,c_name_prf#3501,c_nationkey_prf#3502,c_custkey_prf#3503,c_comment_prf#3504,c_address_prf#3505,c_mktsegment_prf#3506,c_phone_prf#3507] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#3518 AS o_shippriority_prf_2#3528, rid#3519 AS rid_2#3529, o_orderdate_prf#3520 AS o_orderdate_prf_2#3530, o_custkey_prf#3521 AS o_custkey_prf_2#3531, o_orderpriority_prf#3522 AS o_orderpriority_prf_2#3532, o_clerk_prf#3523 AS o_clerk_prf_2#3533, o_orderstatus_prf#3524 AS o_orderstatus_prf_2#3534, o_totalprice_prf#3525 AS o_totalprice_prf_2#3535, o_orderkey_prf#3526 AS o_orderkey_prf_2#3536, o_comment_prf#3527 AS o_comment_prf_2#3537]
         :     :     +- Relation[o_shippriority_prf#3518,rid#3519,o_orderdate_prf#3520,o_custkey_prf#3521,o_orderpriority_prf#3522,o_clerk_prf#3523,o_orderstatus_prf#3524,o_totalprice_prf#3525,o_orderkey_prf#3526,o_comment_prf#3527] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3539 AS l_returnflag_prf_3#3558, l_orderkey_and_l_linenumber_prf#3540 AS l_orderkey_and_l_linenumber_prf_3#3559, l_comment_prf#3541 AS l_comment_prf_3#3560, l_linestatus_prf#3542 AS l_linestatus_prf_3#3561, rid#3543 AS rid_3#3562, l_shipmode_prf#3544 AS l_shipmode_prf_3#3563, l_shipinstruct_prf#3545 AS l_shipinstruct_prf_3#3564, l_quantity_prf#3546 AS l_quantity_prf_3#3565, l_receiptdate_prf#3547 AS l_receiptdate_prf_3#3566, l_linenumber_prf#3548 AS l_linenumber_prf_3#3567, l_tax_prf#3549 AS l_tax_prf_3#3568, l_shipdate_prf#3550 AS l_shipdate_prf_3#3569, l_extendedprice_prf#3551 AS l_extendedprice_prf_3#3570, l_partkey_prf#3552 AS l_partkey_prf_3#3571, l_discount_prf#3553 AS l_discount_prf_3#3572, l_partkey_and_l_suppkey_prf#3554 AS l_partkey_and_l_suppkey_prf_3#3573, l_commitdate_prf#3555 AS l_commitdate_prf_3#3574, l_suppkey_prf#3556 AS l_suppkey_prf_3#3575, l_orderkey_prf#3557 AS l_orderkey_prf_3#3576]
            +- Relation[l_returnflag_prf#3539,l_orderkey_and_l_linenumber_prf#3540,l_comment_prf#3541,l_linestatus_prf#3542,rid#3543,l_shipmode_prf#3544,l_shipinstruct_prf#3545,l_quantity_prf#3546,l_receiptdate_prf#3547,l_linenumber_prf#3548,l_tax_prf#3549,l_shipdate_prf#3550,l_extendedprice_prf#3551,l_partkey_prf#3552,l_discount_prf#3553,l_partkey_and_l_suppkey_prf#3554,l_commitdate_prf#3555,l_suppkey_prf#3556,l_orderkey_prf#3557] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 31105ms

fs1a=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/17 02:02:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:02:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3665L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [c_custkey#290L]
         :     :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L]
         :        +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/17 02:02:20 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:02:20 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:02:20 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:02:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3665L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, 'rid_2, 'l_returnflag_prf_2, 'l_orderkey_and_l_linenumber_prf_2, 'l_comment_prf_2, 'l_linestatus_prf_2, ... 15 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#3707]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#3686]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3677: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [c_acctbal_prf#3667 AS c_acctbal_prf_0#3676, rid#3668 AS rid_0#3677, c_name_prf#3669 AS c_name_prf_0#3678, c_nationkey_prf#3670 AS c_nationkey_prf_0#3679, c_custkey_prf#3671 AS c_custkey_prf_0#3680, c_comment_prf#3672 AS c_comment_prf_0#3681, c_address_prf#3673 AS c_address_prf_0#3682, c_mktsegment_prf#3674 AS c_mktsegment_prf_0#3683, c_phone_prf#3675 AS c_phone_prf_0#3684]
         :     :  :     :  :     :  :  +- Relation[c_acctbal_prf#3667,rid#3668,c_name_prf#3669,c_nationkey_prf#3670,c_custkey_prf#3671,c_comment_prf#3672,c_address_prf#3673,c_mktsegment_prf#3674,c_phone_prf#3675] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3685]
         :     :  :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :  :     :        +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [o_shippriority_prf#3687 AS o_shippriority_prf_1#3697, rid#3688 AS rid_1#3698, o_orderdate_prf#3689 AS o_orderdate_prf_1#3699, o_custkey_prf#3690 AS o_custkey_prf_1#3700, o_orderpriority_prf#3691 AS o_orderpriority_prf_1#3701, o_clerk_prf#3692 AS o_clerk_prf_1#3702, o_orderstatus_prf#3693 AS o_orderstatus_prf_1#3703, o_totalprice_prf#3694 AS o_totalprice_prf_1#3704, o_orderkey_prf#3695 AS o_orderkey_prf_1#3705, o_comment_prf#3696 AS o_comment_prf_1#3706]
         :     :  :     :     +- Relation[o_shippriority_prf#3687,rid#3688,o_orderdate_prf#3689,o_custkey_prf#3690,o_orderpriority_prf#3691,o_clerk_prf#3692,o_orderstatus_prf#3693,o_totalprice_prf#3694,o_orderkey_prf#3695,o_comment_prf#3696] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#3708 AS l_returnflag_prf_2#3727, l_orderkey_and_l_linenumber_prf#3709 AS l_orderkey_and_l_linenumber_prf_2#3728, l_comment_prf#3710 AS l_comment_prf_2#3729, l_linestatus_prf#3711 AS l_linestatus_prf_2#3730, rid#3712 AS rid_2#3731, l_shipmode_prf#3713 AS l_shipmode_prf_2#3732, l_shipinstruct_prf#3714 AS l_shipinstruct_prf_2#3733, l_quantity_prf#3715 AS l_quantity_prf_2#3734, l_receiptdate_prf#3716 AS l_receiptdate_prf_2#3735, l_linenumber_prf#3717 AS l_linenumber_prf_2#3736, l_tax_prf#3718 AS l_tax_prf_2#3737, l_shipdate_prf#3719 AS l_shipdate_prf_2#3738, l_extendedprice_prf#3720 AS l_extendedprice_prf_2#3739, l_partkey_prf#3721 AS l_partkey_prf_2#3740, l_discount_prf#3722 AS l_discount_prf_2#3741, l_partkey_and_l_suppkey_prf#3723 AS l_partkey_and_l_suppkey_prf_2#3742, l_commitdate_prf#3724 AS l_commitdate_prf_2#3743, l_suppkey_prf#3725 AS l_suppkey_prf_2#3744, l_orderkey_prf#3726 AS l_orderkey_prf_2#3745]
         :     :     +- Relation[l_returnflag_prf#3708,l_orderkey_and_l_linenumber_prf#3709,l_comment_prf#3710,l_linestatus_prf#3711,rid#3712,l_shipmode_prf#3713,l_shipinstruct_prf#3714,l_quantity_prf#3715,l_receiptdate_prf#3716,l_linenumber_prf#3717,l_tax_prf#3718,l_shipdate_prf#3719,l_extendedprice_prf#3720,l_partkey_prf#3721,l_discount_prf#3722,l_partkey_and_l_suppkey_prf#3723,l_commitdate_prf#3724,l_suppkey_prf#3725,l_orderkey_prf#3726] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#3747 AS p_comment_prf_3#3757, p_name_prf#3748 AS p_name_prf_3#3758, rid#3749 AS rid_3#3759, p_type_prf#3750 AS p_type_prf_3#3760, p_retailprice_prf#3751 AS p_retailprice_prf_3#3761, p_mfgr_prf#3752 AS p_mfgr_prf_3#3762, p_container_prf#3753 AS p_container_prf_3#3763, p_brand_prf#3754 AS p_brand_prf_3#3764, p_size_prf#3755 AS p_size_prf_3#3765, p_partkey_prf#3756 AS p_partkey_prf_3#3766]
            +- Relation[p_comment_prf#3747,p_name_prf#3748,rid#3749,p_type_prf#3750,p_retailprice_prf#3751,p_mfgr_prf#3752,p_container_prf#3753,p_brand_prf#3754,p_size_prf#3755,p_partkey_prf#3756] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 108636ms

fr1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and (l_orderkey = o_orderkey and c_mktsegment = 'BUILDING')
19/10/17 02:04:08 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:04:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3851L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 02:04:09 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:04:09 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:04:09 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:04:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3851L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#3853 AS l_returnflag_prf_0#3872, l_orderkey_and_l_linenumber_prf#3854 AS l_orderkey_and_l_linenumber_prf_0#3873, l_comment_prf#3855 AS l_comment_prf_0#3874, l_linestatus_prf#3856 AS l_linestatus_prf_0#3875, rid#3857 AS rid_0#3876, l_shipmode_prf#3858 AS l_shipmode_prf_0#3877, l_shipinstruct_prf#3859 AS l_shipinstruct_prf_0#3878, l_quantity_prf#3860 AS l_quantity_prf_0#3879, l_receiptdate_prf#3861 AS l_receiptdate_prf_0#3880, l_linenumber_prf#3862 AS l_linenumber_prf_0#3881, l_tax_prf#3863 AS l_tax_prf_0#3882, l_shipdate_prf#3864 AS l_shipdate_prf_0#3883, l_extendedprice_prf#3865 AS l_extendedprice_prf_0#3884, l_partkey_prf#3866 AS l_partkey_prf_0#3885, l_discount_prf#3867 AS l_discount_prf_0#3886, l_partkey_and_l_suppkey_prf#3868 AS l_partkey_and_l_suppkey_prf_0#3887, l_commitdate_prf#3869 AS l_commitdate_prf_0#3888, l_suppkey_prf#3870 AS l_suppkey_prf_0#3889, l_orderkey_prf#3871 AS l_orderkey_prf_0#3890]
         :  :  +- Relation[l_returnflag_prf#3853,l_orderkey_and_l_linenumber_prf#3854,l_comment_prf#3855,l_linestatus_prf#3856,rid#3857,l_shipmode_prf#3858,l_shipinstruct_prf#3859,l_quantity_prf#3860,l_receiptdate_prf#3861,l_linenumber_prf#3862,l_tax_prf#3863,l_shipdate_prf#3864,l_extendedprice_prf#3865,l_partkey_prf#3866,l_discount_prf#3867,l_partkey_and_l_suppkey_prf#3868,l_commitdate_prf#3869,l_suppkey_prf#3870,l_orderkey_prf#3871] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#3911]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3910]
         :        :  +- Relation[l_returnflag_prf#3891,l_orderkey_and_l_linenumber_prf#3892,l_comment_prf#3893,l_linestatus_prf#3894,rid#3895,l_shipmode_prf#3896,l_shipinstruct_prf#3897,l_quantity_prf#3898,l_receiptdate_prf#3899,l_linenumber_prf#3900,l_tax_prf#3901,l_shipdate_prf#3902,l_extendedprice_prf#3903,l_partkey_prf#3904,l_discount_prf#3905,l_partkey_and_l_suppkey_prf#3906,l_commitdate_prf#3907,l_suppkey_prf#3908,l_orderkey_prf#3909] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [o_shippriority_prf#3912 AS o_shippriority_prf_1#3922, rid#3913 AS rid_1#3923, o_orderdate_prf#3914 AS o_orderdate_prf_1#3924, o_custkey_prf#3915 AS o_custkey_prf_1#3925, o_orderpriority_prf#3916 AS o_orderpriority_prf_1#3926, o_clerk_prf#3917 AS o_clerk_prf_1#3927, o_orderstatus_prf#3918 AS o_orderstatus_prf_1#3928, o_totalprice_prf#3919 AS o_totalprice_prf_1#3929, o_orderkey_prf#3920 AS o_orderkey_prf_1#3930, o_comment_prf#3921 AS o_comment_prf_1#3931]
            :  :  +- Relation[o_shippriority_prf#3912,rid#3913,o_orderdate_prf#3914,o_custkey_prf#3915,o_orderpriority_prf#3916,o_clerk_prf#3917,o_orderstatus_prf#3918,o_totalprice_prf#3919,o_orderkey_prf#3920,o_comment_prf#3921] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#3943]
            :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#3942]
            :        :  +- Relation[o_shippriority_prf#3932,rid#3933,o_orderdate_prf#3934,o_custkey_prf#3935,o_orderpriority_prf#3936,o_clerk_prf#3937,o_orderstatus_prf#3938,o_totalprice_prf#3939,o_orderkey_prf#3940,o_comment_prf#3941] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [c_acctbal_prf#3944 AS c_acctbal_prf_2#3953, rid#3945 AS rid_2#3954, c_name_prf#3946 AS c_name_prf_2#3955, c_nationkey_prf#3947 AS c_nationkey_prf_2#3956, c_custkey_prf#3948 AS c_custkey_prf_2#3957, c_comment_prf#3949 AS c_comment_prf_2#3958, c_address_prf#3950 AS c_address_prf_2#3959, c_mktsegment_prf#3951 AS c_mktsegment_prf_2#3960, c_phone_prf#3952 AS c_phone_prf_2#3961]
               :  +- Relation[c_acctbal_prf#3944,rid#3945,c_name_prf#3946,c_nationkey_prf#3947,c_custkey_prf#3948,c_comment_prf#3949,c_address_prf#3950,c_mktsegment_prf#3951,c_phone_prf#3952] JDBCRelation(customer_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#3962]
                  +- DexRidFilter customer~c_mktsegment~BUILDING
                     +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 121407ms

fq1e=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 02:06:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:06:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4041L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [c_custkey#290L, c_nationkey#293L]
                  +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 02:06:10 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:06:10 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:06:10 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:06:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4041L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [l_returnflag_prf#4043 AS l_returnflag_prf_0#4062, l_orderkey_and_l_linenumber_prf#4044 AS l_orderkey_and_l_linenumber_prf_0#4063, l_comment_prf#4045 AS l_comment_prf_0#4064, l_linestatus_prf#4046 AS l_linestatus_prf_0#4065, rid#4047 AS rid_0#4066, l_shipmode_prf#4048 AS l_shipmode_prf_0#4067, l_shipinstruct_prf#4049 AS l_shipinstruct_prf_0#4068, l_quantity_prf#4050 AS l_quantity_prf_0#4069, l_receiptdate_prf#4051 AS l_receiptdate_prf_0#4070, l_linenumber_prf#4052 AS l_linenumber_prf_0#4071, l_tax_prf#4053 AS l_tax_prf_0#4072, l_shipdate_prf#4054 AS l_shipdate_prf_0#4073, l_extendedprice_prf#4055 AS l_extendedprice_prf_0#4074, l_partkey_prf#4056 AS l_partkey_prf_0#4075, l_discount_prf#4057 AS l_discount_prf_0#4076, l_partkey_and_l_suppkey_prf#4058 AS l_partkey_and_l_suppkey_prf_0#4077, l_commitdate_prf#4059 AS l_commitdate_prf_0#4078, l_suppkey_prf#4060 AS l_suppkey_prf_0#4079, l_orderkey_prf#4061 AS l_orderkey_prf_0#4080]
         :  :  :  :  +- Relation[l_returnflag_prf#4043,l_orderkey_and_l_linenumber_prf#4044,l_comment_prf#4045,l_linestatus_prf#4046,rid#4047,l_shipmode_prf#4048,l_shipinstruct_prf#4049,l_quantity_prf#4050,l_receiptdate_prf#4051,l_linenumber_prf#4052,l_tax_prf#4053,l_shipdate_prf#4054,l_extendedprice_prf#4055,l_partkey_prf#4056,l_discount_prf#4057,l_partkey_and_l_suppkey_prf#4058,l_commitdate_prf#4059,l_suppkey_prf#4060,l_orderkey_prf#4061] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#4101]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#4100]
         :  :  :        :  +- Relation[l_returnflag_prf#4081,l_orderkey_and_l_linenumber_prf#4082,l_comment_prf#4083,l_linestatus_prf#4084,rid#4085,l_shipmode_prf#4086,l_shipinstruct_prf#4087,l_quantity_prf#4088,l_receiptdate_prf#4089,l_linenumber_prf#4090,l_tax_prf#4091,l_shipdate_prf#4092,l_extendedprice_prf#4093,l_partkey_prf#4094,l_discount_prf#4095,l_partkey_and_l_suppkey_prf#4096,l_commitdate_prf#4097,l_suppkey_prf#4098,l_orderkey_prf#4099] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#4102 AS o_shippriority_prf_1#4112, rid#4103 AS rid_1#4113, o_orderdate_prf#4104 AS o_orderdate_prf_1#4114, o_custkey_prf#4105 AS o_custkey_prf_1#4115, o_orderpriority_prf#4106 AS o_orderpriority_prf_1#4116, o_clerk_prf#4107 AS o_clerk_prf_1#4117, o_orderstatus_prf#4108 AS o_orderstatus_prf_1#4118, o_totalprice_prf#4109 AS o_totalprice_prf_1#4119, o_orderkey_prf#4110 AS o_orderkey_prf_1#4120, o_comment_prf#4111 AS o_comment_prf_1#4121]
         :  :     +- Relation[o_shippriority_prf#4102,rid#4103,o_orderdate_prf#4104,o_custkey_prf#4105,o_orderpriority_prf#4106,o_clerk_prf#4107,o_orderstatus_prf#4108,o_totalprice_prf#4109,o_orderkey_prf#4110,o_comment_prf#4111] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2109) AS rid_3#4133]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4132]
         :        :  +- Relation[o_shippriority_prf#4122,rid#4123,o_orderdate_prf#4124,o_custkey_prf#4125,o_orderpriority_prf#4126,o_clerk_prf#4127,o_orderstatus_prf#4128,o_totalprice_prf#4129,o_orderkey_prf#4130,o_comment_prf#4131] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_2, 'n_regionkey_prf_2, 'n_nationkey_prf_2, 'n_name_prf_2, 'n_comment_prf_2, dexdecrypt('value_dec_key, value#2109) AS rid_3#4145]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_2#4139: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [rid#4134 AS rid_2#4139, n_regionkey_prf#4135 AS n_regionkey_prf_2#4140, n_nationkey_prf#4136 AS n_nationkey_prf_2#4141, n_name_prf#4137 AS n_name_prf_2#4142, n_comment_prf#4138 AS n_comment_prf_2#4143]
            :     :  :  +- Relation[rid#4134,n_regionkey_prf#4135,n_nationkey_prf#4136,n_name_prf#4137,n_comment_prf#4138] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#4144]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4146 AS c_acctbal_prf_3#4155, rid#4147 AS rid_3#4156, c_name_prf#4148 AS c_name_prf_3#4157, c_nationkey_prf#4149 AS c_nationkey_prf_3#4158, c_custkey_prf#4150 AS c_custkey_prf_3#4159, c_comment_prf#4151 AS c_comment_prf_3#4160, c_address_prf#4152 AS c_address_prf_3#4161, c_mktsegment_prf#4153 AS c_mktsegment_prf_3#4162, c_phone_prf#4154 AS c_phone_prf_3#4163]
               +- Relation[c_acctbal_prf#4146,rid#4147,c_name_prf#4148,c_nationkey_prf#4149,c_custkey_prf#4150,c_comment_prf#4151,c_address_prf#4152,c_mktsegment_prf#4153,c_phone_prf#4154] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 164930ms

fr2b=
select * from lineitem, orders, customer where o_custkey = c_custkey and o_orderstatus = 'F' and l_orderkey = o_orderkey
19/10/17 02:08:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:08:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4243L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 02:08:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4243L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#4245 AS l_returnflag_prf_0#4264, l_orderkey_and_l_linenumber_prf#4246 AS l_orderkey_and_l_linenumber_prf_0#4265, l_comment_prf#4247 AS l_comment_prf_0#4266, l_linestatus_prf#4248 AS l_linestatus_prf_0#4267, rid#4249 AS rid_0#4268, l_shipmode_prf#4250 AS l_shipmode_prf_0#4269, l_shipinstruct_prf#4251 AS l_shipinstruct_prf_0#4270, l_quantity_prf#4252 AS l_quantity_prf_0#4271, l_receiptdate_prf#4253 AS l_receiptdate_prf_0#4272, l_linenumber_prf#4254 AS l_linenumber_prf_0#4273, l_tax_prf#4255 AS l_tax_prf_0#4274, l_shipdate_prf#4256 AS l_shipdate_prf_0#4275, l_extendedprice_prf#4257 AS l_extendedprice_prf_0#4276, l_partkey_prf#4258 AS l_partkey_prf_0#4277, l_discount_prf#4259 AS l_discount_prf_0#4278, l_partkey_and_l_suppkey_prf#4260 AS l_partkey_and_l_suppkey_prf_0#4279, l_commitdate_prf#4261 AS l_commitdate_prf_0#4280, l_suppkey_prf#4262 AS l_suppkey_prf_0#4281, l_orderkey_prf#4263 AS l_orderkey_prf_0#4282]
         :  :  +- Relation[l_returnflag_prf#4245,l_orderkey_and_l_linenumber_prf#4246,l_comment_prf#4247,l_linestatus_prf#4248,rid#4249,l_shipmode_prf#4250,l_shipinstruct_prf#4251,l_quantity_prf#4252,l_receiptdate_prf#4253,l_linenumber_prf#4254,l_tax_prf#4255,l_shipdate_prf#4256,l_extendedprice_prf#4257,l_partkey_prf#4258,l_discount_prf#4259,l_partkey_and_l_suppkey_prf#4260,l_commitdate_prf#4261,l_suppkey_prf#4262,l_orderkey_prf#4263] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#4303]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4302]
         :        :  +- Relation[l_returnflag_prf#4283,l_orderkey_and_l_linenumber_prf#4284,l_comment_prf#4285,l_linestatus_prf#4286,rid#4287,l_shipmode_prf#4288,l_shipinstruct_prf#4289,l_quantity_prf#4290,l_receiptdate_prf#4291,l_linenumber_prf#4292,l_tax_prf#4293,l_shipdate_prf#4294,l_extendedprice_prf#4295,l_partkey_prf#4296,l_discount_prf#4297,l_partkey_and_l_suppkey_prf#4298,l_commitdate_prf#4299,l_suppkey_prf#4300,l_orderkey_prf#4301] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#4325]
            :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#4315: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#4304 AS o_shippriority_prf_1#4314, rid#4305 AS rid_1#4315, o_orderdate_prf#4306 AS o_orderdate_prf_1#4316, o_custkey_prf#4307 AS o_custkey_prf_1#4317, o_orderpriority_prf#4308 AS o_orderpriority_prf_1#4318, o_clerk_prf#4309 AS o_clerk_prf_1#4319, o_orderstatus_prf#4310 AS o_orderstatus_prf_1#4320, o_totalprice_prf#4311 AS o_totalprice_prf_1#4321, o_orderkey_prf#4312 AS o_orderkey_prf_1#4322, o_comment_prf#4313 AS o_comment_prf_1#4323]
            :     :  :  +- Relation[o_shippriority_prf#4304,rid#4305,o_orderdate_prf#4306,o_custkey_prf#4307,o_orderpriority_prf#4308,o_clerk_prf#4309,o_orderstatus_prf#4310,o_totalprice_prf#4311,o_orderkey_prf#4312,o_comment_prf#4313] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4324]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4326 AS c_acctbal_prf_2#4335, rid#4327 AS rid_2#4336, c_name_prf#4328 AS c_name_prf_2#4337, c_nationkey_prf#4329 AS c_nationkey_prf_2#4338, c_custkey_prf#4330 AS c_custkey_prf_2#4339, c_comment_prf#4331 AS c_comment_prf_2#4340, c_address_prf#4332 AS c_address_prf_2#4341, c_mktsegment_prf#4333 AS c_mktsegment_prf_2#4342, c_phone_prf#4334 AS c_phone_prf_2#4343]
               +- Relation[c_acctbal_prf#4326,rid#4327,c_name_prf#4328,c_nationkey_prf#4329,c_custkey_prf#4330,c_comment_prf#4331,c_address_prf#4332,c_mktsegment_prf#4333,c_phone_prf#4334] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 105962ms

fq1d=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 02:10:41 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:10:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4422L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :     :- Project [n_nationkey#108L]
               :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
               :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 02:10:41 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:10:41 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:10:41 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:10:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4422L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#4424 AS l_returnflag_prf_0#4443, l_orderkey_and_l_linenumber_prf#4425 AS l_orderkey_and_l_linenumber_prf_0#4444, l_comment_prf#4426 AS l_comment_prf_0#4445, l_linestatus_prf#4427 AS l_linestatus_prf_0#4446, rid#4428 AS rid_0#4447, l_shipmode_prf#4429 AS l_shipmode_prf_0#4448, l_shipinstruct_prf#4430 AS l_shipinstruct_prf_0#4449, l_quantity_prf#4431 AS l_quantity_prf_0#4450, l_receiptdate_prf#4432 AS l_receiptdate_prf_0#4451, l_linenumber_prf#4433 AS l_linenumber_prf_0#4452, l_tax_prf#4434 AS l_tax_prf_0#4453, l_shipdate_prf#4435 AS l_shipdate_prf_0#4454, l_extendedprice_prf#4436 AS l_extendedprice_prf_0#4455, l_partkey_prf#4437 AS l_partkey_prf_0#4456, l_discount_prf#4438 AS l_discount_prf_0#4457, l_partkey_and_l_suppkey_prf#4439 AS l_partkey_and_l_suppkey_prf_0#4458, l_commitdate_prf#4440 AS l_commitdate_prf_0#4459, l_suppkey_prf#4441 AS l_suppkey_prf_0#4460, l_orderkey_prf#4442 AS l_orderkey_prf_0#4461]
         :  :  +- Relation[l_returnflag_prf#4424,l_orderkey_and_l_linenumber_prf#4425,l_comment_prf#4426,l_linestatus_prf#4427,rid#4428,l_shipmode_prf#4429,l_shipinstruct_prf#4430,l_quantity_prf#4431,l_receiptdate_prf#4432,l_linenumber_prf#4433,l_tax_prf#4434,l_shipdate_prf#4435,l_extendedprice_prf#4436,l_partkey_prf#4437,l_discount_prf#4438,l_partkey_and_l_suppkey_prf#4439,l_commitdate_prf#4440,l_suppkey_prf#4441,l_orderkey_prf#4442] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2109) AS rid_3#4482]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4481]
         :        :  +- Relation[l_returnflag_prf#4462,l_orderkey_and_l_linenumber_prf#4463,l_comment_prf#4464,l_linestatus_prf#4465,rid#4466,l_shipmode_prf#4467,l_shipinstruct_prf#4468,l_quantity_prf#4469,l_receiptdate_prf#4470,l_linenumber_prf#4471,l_tax_prf#4472,l_shipdate_prf#4473,l_extendedprice_prf#4474,l_partkey_prf#4475,l_discount_prf#4476,l_partkey_and_l_suppkey_prf#4477,l_commitdate_prf#4478,l_suppkey_prf#4479,l_orderkey_prf#4480] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, 'rid_2, 'c_acctbal_prf_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2109) AS rid_3#4513]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_2
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#4494]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_1#4488: string
            :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :     :  :- Project [rid#4483 AS rid_1#4488, n_regionkey_prf#4484 AS n_regionkey_prf_1#4489, n_nationkey_prf#4485 AS n_nationkey_prf_1#4490, n_name_prf#4486 AS n_name_prf_1#4491, n_comment_prf#4487 AS n_comment_prf_1#4492]
            :     :  :     :  :  +- Relation[rid#4483,n_regionkey_prf#4484,n_nationkey_prf#4485,n_name_prf#4486,n_comment_prf#4487] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4493]
            :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :  :     :        +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [c_acctbal_prf#4495 AS c_acctbal_prf_2#4504, rid#4496 AS rid_2#4505, c_name_prf#4497 AS c_name_prf_2#4506, c_nationkey_prf#4498 AS c_nationkey_prf_2#4507, c_custkey_prf#4499 AS c_custkey_prf_2#4508, c_comment_prf#4500 AS c_comment_prf_2#4509, c_address_prf#4501 AS c_address_prf_2#4510, c_mktsegment_prf#4502 AS c_mktsegment_prf_2#4511, c_phone_prf#4503 AS c_phone_prf_2#4512]
            :     :     +- Relation[c_acctbal_prf#4495,rid#4496,c_name_prf#4497,c_nationkey_prf#4498,c_custkey_prf#4499,c_comment_prf#4500,c_address_prf#4501,c_mktsegment_prf#4502,c_phone_prf#4503] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4514 AS o_shippriority_prf_3#4524, rid#4515 AS rid_3#4525, o_orderdate_prf#4516 AS o_orderdate_prf_3#4526, o_custkey_prf#4517 AS o_custkey_prf_3#4527, o_orderpriority_prf#4518 AS o_orderpriority_prf_3#4528, o_clerk_prf#4519 AS o_clerk_prf_3#4529, o_orderstatus_prf#4520 AS o_orderstatus_prf_3#4530, o_totalprice_prf#4521 AS o_totalprice_prf_3#4531, o_orderkey_prf#4522 AS o_orderkey_prf_3#4532, o_comment_prf#4523 AS o_comment_prf_3#4533]
               +- Relation[o_shippriority_prf#4514,rid#4515,o_orderdate_prf#4516,o_custkey_prf#4517,o_orderpriority_prf#4518,o_clerk_prf#4519,o_orderstatus_prf#4520,o_totalprice_prf#4521,o_orderkey_prf#4522,o_comment_prf#4523] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 74679ms

fr2f=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/17 02:11:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:11:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4613L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_orderkey#342L, o_custkey#343L]
         :     :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L]
         :        +- Filter isnotnull(c_custkey#290L)
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 02:11:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4613L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#4655]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#4636]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_0#4626: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [o_shippriority_prf#4615 AS o_shippriority_prf_0#4625, rid#4616 AS rid_0#4626, o_orderdate_prf#4617 AS o_orderdate_prf_0#4627, o_custkey_prf#4618 AS o_custkey_prf_0#4628, o_orderpriority_prf#4619 AS o_orderpriority_prf_0#4629, o_clerk_prf#4620 AS o_clerk_prf_0#4630, o_orderstatus_prf#4621 AS o_orderstatus_prf_0#4631, o_totalprice_prf#4622 AS o_totalprice_prf_0#4632, o_orderkey_prf#4623 AS o_orderkey_prf_0#4633, o_comment_prf#4624 AS o_comment_prf_0#4634]
         :     :  :     :  :  +- Relation[o_shippriority_prf#4615,rid#4616,o_orderdate_prf#4617,o_custkey_prf#4618,o_orderpriority_prf#4619,o_clerk_prf#4620,o_orderstatus_prf#4621,o_totalprice_prf#4622,o_orderkey_prf#4623,o_comment_prf#4624] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4635]
         :     :  :     :     +- DexRidFilter orders~o_orderstatus~F
         :     :  :     :        +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#4637 AS c_acctbal_prf_1#4646, rid#4638 AS rid_1#4647, c_name_prf#4639 AS c_name_prf_1#4648, c_nationkey_prf#4640 AS c_nationkey_prf_1#4649, c_custkey_prf#4641 AS c_custkey_prf_1#4650, c_comment_prf#4642 AS c_comment_prf_1#4651, c_address_prf#4643 AS c_address_prf_1#4652, c_mktsegment_prf#4644 AS c_mktsegment_prf_1#4653, c_phone_prf#4645 AS c_phone_prf_1#4654]
         :     :     +- Relation[c_acctbal_prf#4637,rid#4638,c_name_prf#4639,c_nationkey_prf#4640,c_custkey_prf#4641,c_comment_prf#4642,c_address_prf#4643,c_mktsegment_prf#4644,c_phone_prf#4645] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4656 AS l_returnflag_prf_2#4675, l_orderkey_and_l_linenumber_prf#4657 AS l_orderkey_and_l_linenumber_prf_2#4676, l_comment_prf#4658 AS l_comment_prf_2#4677, l_linestatus_prf#4659 AS l_linestatus_prf_2#4678, rid#4660 AS rid_2#4679, l_shipmode_prf#4661 AS l_shipmode_prf_2#4680, l_shipinstruct_prf#4662 AS l_shipinstruct_prf_2#4681, l_quantity_prf#4663 AS l_quantity_prf_2#4682, l_receiptdate_prf#4664 AS l_receiptdate_prf_2#4683, l_linenumber_prf#4665 AS l_linenumber_prf_2#4684, l_tax_prf#4666 AS l_tax_prf_2#4685, l_shipdate_prf#4667 AS l_shipdate_prf_2#4686, l_extendedprice_prf#4668 AS l_extendedprice_prf_2#4687, l_partkey_prf#4669 AS l_partkey_prf_2#4688, l_discount_prf#4670 AS l_discount_prf_2#4689, l_partkey_and_l_suppkey_prf#4671 AS l_partkey_and_l_suppkey_prf_2#4690, l_commitdate_prf#4672 AS l_commitdate_prf_2#4691, l_suppkey_prf#4673 AS l_suppkey_prf_2#4692, l_orderkey_prf#4674 AS l_orderkey_prf_2#4693]
            +- Relation[l_returnflag_prf#4656,l_orderkey_and_l_linenumber_prf#4657,l_comment_prf#4658,l_linestatus_prf#4659,rid#4660,l_shipmode_prf#4661,l_shipinstruct_prf#4662,l_quantity_prf#4663,l_receiptdate_prf#4664,l_linenumber_prf#4665,l_tax_prf#4666,l_shipdate_prf#4667,l_extendedprice_prf#4668,l_partkey_prf#4669,l_discount_prf#4670,l_partkey_and_l_suppkey_prf#4671,l_commitdate_prf#4672,l_suppkey_prf#4673,l_orderkey_prf#4674] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 83035ms

fq1c=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 02:13:19 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:13:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4772L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [c_nationkey#293L, o_orderkey#342L]
               :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :     :- Project [c_custkey#290L, c_nationkey#293L]
               :     :  +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
               :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               :     +- Project [o_orderkey#342L, o_custkey#343L]
               :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 02:13:19 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:13:19 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:13:19 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:13:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4772L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#4785]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#4779: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [rid#4774 AS rid_0#4779, n_regionkey_prf#4775 AS n_regionkey_prf_0#4780, n_nationkey_prf#4776 AS n_nationkey_prf_0#4781, n_name_prf#4777 AS n_name_prf_0#4782, n_comment_prf#4778 AS n_comment_prf_0#4783]
         :     :  :  +- Relation[rid#4774,n_regionkey_prf#4775,n_nationkey_prf#4776,n_name_prf#4777,n_comment_prf#4778] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4784]
         :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :        +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join NaturalJoin(Inner)
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- Project [c_acctbal_prf#4786 AS c_acctbal_prf_1#4795, rid#4787 AS rid_1#4796, c_name_prf#4788 AS c_name_prf_1#4797, c_nationkey_prf#4789 AS c_nationkey_prf_1#4798, c_custkey_prf#4790 AS c_custkey_prf_1#4799, c_comment_prf#4791 AS c_comment_prf_1#4800, c_address_prf#4792 AS c_address_prf_1#4801, c_mktsegment_prf#4793 AS c_mktsegment_prf_1#4802, c_phone_prf#4794 AS c_phone_prf_1#4803]
            :  :  :  :  +- Relation[c_acctbal_prf#4786,rid#4787,c_name_prf#4788,c_nationkey_prf#4789,c_custkey_prf#4790,c_comment_prf#4791,c_address_prf#4792,c_mktsegment_prf#4793,c_phone_prf#4794] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#4814]
            :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
            :  :  :        :- 'Project ['rid AS rid_1#4813]
            :  :  :        :  +- Relation[c_acctbal_prf#4804,rid#4805,c_name_prf#4806,c_nationkey_prf#4807,c_custkey_prf#4808,c_comment_prf#4809,c_address_prf#4810,c_mktsegment_prf#4811,c_phone_prf#4812] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
            :  :  +- Project [o_shippriority_prf#4815 AS o_shippriority_prf_2#4825, rid#4816 AS rid_2#4826, o_orderdate_prf#4817 AS o_orderdate_prf_2#4827, o_custkey_prf#4818 AS o_custkey_prf_2#4828, o_orderpriority_prf#4819 AS o_orderpriority_prf_2#4829, o_clerk_prf#4820 AS o_clerk_prf_2#4830, o_orderstatus_prf#4821 AS o_orderstatus_prf_2#4831, o_totalprice_prf#4822 AS o_totalprice_prf_2#4832, o_orderkey_prf#4823 AS o_orderkey_prf_2#4833, o_comment_prf#4824 AS o_comment_prf_2#4834]
            :  :     +- Relation[o_shippriority_prf#4815,rid#4816,o_orderdate_prf#4817,o_custkey_prf#4818,o_orderpriority_prf#4819,o_clerk_prf#4820,o_orderstatus_prf#4821,o_totalprice_prf#4822,o_orderkey_prf#4823,o_comment_prf#4824] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2109) AS rid_3#4846]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#4845]
            :        :  +- Relation[o_shippriority_prf#4835,rid#4836,o_orderdate_prf#4837,o_custkey_prf#4838,o_orderpriority_prf#4839,o_clerk_prf#4840,o_orderstatus_prf#4841,o_totalprice_prf#4842,o_orderkey_prf#4843,o_comment_prf#4844] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4847 AS l_returnflag_prf_3#4866, l_orderkey_and_l_linenumber_prf#4848 AS l_orderkey_and_l_linenumber_prf_3#4867, l_comment_prf#4849 AS l_comment_prf_3#4868, l_linestatus_prf#4850 AS l_linestatus_prf_3#4869, rid#4851 AS rid_3#4870, l_shipmode_prf#4852 AS l_shipmode_prf_3#4871, l_shipinstruct_prf#4853 AS l_shipinstruct_prf_3#4872, l_quantity_prf#4854 AS l_quantity_prf_3#4873, l_receiptdate_prf#4855 AS l_receiptdate_prf_3#4874, l_linenumber_prf#4856 AS l_linenumber_prf_3#4875, l_tax_prf#4857 AS l_tax_prf_3#4876, l_shipdate_prf#4858 AS l_shipdate_prf_3#4877, l_extendedprice_prf#4859 AS l_extendedprice_prf_3#4878, l_partkey_prf#4860 AS l_partkey_prf_3#4879, l_discount_prf#4861 AS l_discount_prf_3#4880, l_partkey_and_l_suppkey_prf#4862 AS l_partkey_and_l_suppkey_prf_3#4881, l_commitdate_prf#4863 AS l_commitdate_prf_3#4882, l_suppkey_prf#4864 AS l_suppkey_prf_3#4883, l_orderkey_prf#4865 AS l_orderkey_prf_3#4884]
               +- Relation[l_returnflag_prf#4847,l_orderkey_and_l_linenumber_prf#4848,l_comment_prf#4849,l_linestatus_prf#4850,rid#4851,l_shipmode_prf#4852,l_shipinstruct_prf#4853,l_quantity_prf#4854,l_receiptdate_prf#4855,l_linenumber_prf#4856,l_tax_prf#4857,l_shipdate_prf#4858,l_extendedprice_prf#4859,l_partkey_prf#4860,l_discount_prf#4861,l_partkey_and_l_suppkey_prf#4862,l_commitdate_prf#4863,l_suppkey_prf#4864,l_orderkey_prf#4865] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 163600ms

fr1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey and c_mktsegment = 'BUILDING'
19/10/17 02:16:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:16:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4964L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 02:16:02 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:16:02 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:16:02 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:16:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4964L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [l_returnflag_prf#4966 AS l_returnflag_prf_0#4985, l_orderkey_and_l_linenumber_prf#4967 AS l_orderkey_and_l_linenumber_prf_0#4986, l_comment_prf#4968 AS l_comment_prf_0#4987, l_linestatus_prf#4969 AS l_linestatus_prf_0#4988, rid#4970 AS rid_0#4989, l_shipmode_prf#4971 AS l_shipmode_prf_0#4990, l_shipinstruct_prf#4972 AS l_shipinstruct_prf_0#4991, l_quantity_prf#4973 AS l_quantity_prf_0#4992, l_receiptdate_prf#4974 AS l_receiptdate_prf_0#4993, l_linenumber_prf#4975 AS l_linenumber_prf_0#4994, l_tax_prf#4976 AS l_tax_prf_0#4995, l_shipdate_prf#4977 AS l_shipdate_prf_0#4996, l_extendedprice_prf#4978 AS l_extendedprice_prf_0#4997, l_partkey_prf#4979 AS l_partkey_prf_0#4998, l_discount_prf#4980 AS l_discount_prf_0#4999, l_partkey_and_l_suppkey_prf#4981 AS l_partkey_and_l_suppkey_prf_0#5000, l_commitdate_prf#4982 AS l_commitdate_prf_0#5001, l_suppkey_prf#4983 AS l_suppkey_prf_0#5002, l_orderkey_prf#4984 AS l_orderkey_prf_0#5003]
         :  :  :  :  +- Relation[l_returnflag_prf#4966,l_orderkey_and_l_linenumber_prf#4967,l_comment_prf#4968,l_linestatus_prf#4969,rid#4970,l_shipmode_prf#4971,l_shipinstruct_prf#4972,l_quantity_prf#4973,l_receiptdate_prf#4974,l_linenumber_prf#4975,l_tax_prf#4976,l_shipdate_prf#4977,l_extendedprice_prf#4978,l_partkey_prf#4979,l_discount_prf#4980,l_partkey_and_l_suppkey_prf#4981,l_commitdate_prf#4982,l_suppkey_prf#4983,l_orderkey_prf#4984] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#5024]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#5023]
         :  :  :        :  +- Relation[l_returnflag_prf#5004,l_orderkey_and_l_linenumber_prf#5005,l_comment_prf#5006,l_linestatus_prf#5007,rid#5008,l_shipmode_prf#5009,l_shipinstruct_prf#5010,l_quantity_prf#5011,l_receiptdate_prf#5012,l_linenumber_prf#5013,l_tax_prf#5014,l_shipdate_prf#5015,l_extendedprice_prf#5016,l_partkey_prf#5017,l_discount_prf#5018,l_partkey_and_l_suppkey_prf#5019,l_commitdate_prf#5020,l_suppkey_prf#5021,l_orderkey_prf#5022] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#5025 AS o_shippriority_prf_1#5035, rid#5026 AS rid_1#5036, o_orderdate_prf#5027 AS o_orderdate_prf_1#5037, o_custkey_prf#5028 AS o_custkey_prf_1#5038, o_orderpriority_prf#5029 AS o_orderpriority_prf_1#5039, o_clerk_prf#5030 AS o_clerk_prf_1#5040, o_orderstatus_prf#5031 AS o_orderstatus_prf_1#5041, o_totalprice_prf#5032 AS o_totalprice_prf_1#5042, o_orderkey_prf#5033 AS o_orderkey_prf_1#5043, o_comment_prf#5034 AS o_comment_prf_1#5044]
         :  :     +- Relation[o_shippriority_prf#5025,rid#5026,o_orderdate_prf#5027,o_custkey_prf#5028,o_orderpriority_prf#5029,o_clerk_prf#5030,o_orderstatus_prf#5031,o_totalprice_prf#5032,o_orderkey_prf#5033,o_comment_prf#5034] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#5056]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5055]
         :        :  +- Relation[o_shippriority_prf#5045,rid#5046,o_orderdate_prf#5047,o_custkey_prf#5048,o_orderpriority_prf#5049,o_clerk_prf#5050,o_orderstatus_prf#5051,o_totalprice_prf#5052,o_orderkey_prf#5053,o_comment_prf#5054] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_2))
            :- Project [c_acctbal_prf#5057 AS c_acctbal_prf_2#5066, rid#5058 AS rid_2#5067, c_name_prf#5059 AS c_name_prf_2#5068, c_nationkey_prf#5060 AS c_nationkey_prf_2#5069, c_custkey_prf#5061 AS c_custkey_prf_2#5070, c_comment_prf#5062 AS c_comment_prf_2#5071, c_address_prf#5063 AS c_address_prf_2#5072, c_mktsegment_prf#5064 AS c_mktsegment_prf_2#5073, c_phone_prf#5065 AS c_phone_prf_2#5074]
            :  +- Relation[c_acctbal_prf#5057,rid#5058,c_name_prf#5059,c_nationkey_prf#5060,c_custkey_prf#5061,c_comment_prf#5062,c_address_prf#5063,c_mktsegment_prf#5064,c_phone_prf#5065] JDBCRelation(customer_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#5075]
               +- DexRidFilter customer~c_mktsegment~BUILDING
                  +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 121119ms

ft2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and p_size = 15 and ps_suppkey = s_suppkey
19/10/17 02:18:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:18:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5138L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 02:18:03 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 02:18:03 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 02:18:03 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 02:18:03 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 02:18:03 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:18:03 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:18:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5138L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#5184]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, rid_0#5148: string
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [ps_partkey_and_ps_suppkey_prf#5140 AS ps_partkey_and_ps_suppkey_prf_0#5147, rid#5141 AS rid_0#5148, ps_availqty_prf#5142 AS ps_availqty_prf_0#5149, ps_comment_prf#5143 AS ps_comment_prf_0#5150, ps_partkey_prf#5144 AS ps_partkey_prf_0#5151, ps_supplycost_prf#5145 AS ps_supplycost_prf_0#5152, ps_suppkey_prf#5146 AS ps_suppkey_prf_0#5153]
         :     :  :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#5140,rid#5141,ps_availqty_prf#5142,ps_comment_prf#5143,ps_partkey_prf#5144,ps_supplycost_prf#5145,ps_suppkey_prf#5146] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#5162]
         :     :  :     +- 'DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#5161]
         :     :  :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#5154,rid#5155,ps_availqty_prf#5156,ps_comment_prf#5157,ps_partkey_prf#5158,ps_supplycost_prf#5159,ps_suppkey_prf#5160] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [p_comment_prf#5163 AS p_comment_prf_1#5173, p_name_prf#5164 AS p_name_prf_1#5174, rid#5165 AS rid_1#5175, p_type_prf#5166 AS p_type_prf_1#5176, p_retailprice_prf#5167 AS p_retailprice_prf_1#5177, p_mfgr_prf#5168 AS p_mfgr_prf_1#5178, p_container_prf#5169 AS p_container_prf_1#5179, p_brand_prf#5170 AS p_brand_prf_1#5180, p_size_prf#5171 AS p_size_prf_1#5181, p_partkey_prf#5172 AS p_partkey_prf_1#5182]
         :     :     :  +- Relation[p_comment_prf#5163,p_name_prf#5164,rid#5165,p_type_prf#5166,p_retailprice_prf#5167,p_mfgr_prf#5168,p_container_prf#5169,p_brand_prf#5170,p_size_prf#5171,p_partkey_prf#5172] JDBCRelation(part_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5183]
         :     :        +- DexRidFilter part~p_size~15
         :     :           +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5185 AS s_phone_prf_2#5193, rid#5186 AS rid_2#5194, s_address_prf#5187 AS s_address_prf_2#5195, s_nationkey_prf#5188 AS s_nationkey_prf_2#5196, s_suppkey_prf#5189 AS s_suppkey_prf_2#5197, s_name_prf#5190 AS s_name_prf_2#5198, s_acctbal_prf#5191 AS s_acctbal_prf_2#5199, s_comment_prf#5192 AS s_comment_prf_2#5200]
            +- Relation[s_phone_prf#5185,rid#5186,s_address_prf#5187,s_nationkey_prf#5188,s_suppkey_prf#5189,s_name_prf#5190,s_acctbal_prf#5191,s_comment_prf#5192] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 49585ms

fq1b=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 02:18:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:18:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5266L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 02:18:53 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:18:53 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:18:53 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:18:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5266L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#5298]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#5279]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#5273: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#5268 AS rid_0#5273, n_regionkey_prf#5269 AS n_regionkey_prf_0#5274, n_nationkey_prf#5270 AS n_nationkey_prf_0#5275, n_name_prf#5271 AS n_name_prf_0#5276, n_comment_prf#5272 AS n_comment_prf_0#5277]
         :     :  :     :  :  +- Relation[rid#5268,n_regionkey_prf#5269,n_nationkey_prf#5270,n_name_prf#5271,n_comment_prf#5272] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5278]
         :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :        +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#5280 AS c_acctbal_prf_1#5289, rid#5281 AS rid_1#5290, c_name_prf#5282 AS c_name_prf_1#5291, c_nationkey_prf#5283 AS c_nationkey_prf_1#5292, c_custkey_prf#5284 AS c_custkey_prf_1#5293, c_comment_prf#5285 AS c_comment_prf_1#5294, c_address_prf#5286 AS c_address_prf_1#5295, c_mktsegment_prf#5287 AS c_mktsegment_prf_1#5296, c_phone_prf#5288 AS c_phone_prf_1#5297]
         :     :     +- Relation[c_acctbal_prf#5280,rid#5281,c_name_prf#5282,c_nationkey_prf#5283,c_custkey_prf#5284,c_comment_prf#5285,c_address_prf#5286,c_mktsegment_prf#5287,c_phone_prf#5288] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- Project [o_shippriority_prf#5299 AS o_shippriority_prf_2#5309, rid#5300 AS rid_2#5310, o_orderdate_prf#5301 AS o_orderdate_prf_2#5311, o_custkey_prf#5302 AS o_custkey_prf_2#5312, o_orderpriority_prf#5303 AS o_orderpriority_prf_2#5313, o_clerk_prf#5304 AS o_clerk_prf_2#5314, o_orderstatus_prf#5305 AS o_orderstatus_prf_2#5315, o_totalprice_prf#5306 AS o_totalprice_prf_2#5316, o_orderkey_prf#5307 AS o_orderkey_prf_2#5317, o_comment_prf#5308 AS o_comment_prf_2#5318]
            :  :  +- Relation[o_shippriority_prf#5299,rid#5300,o_orderdate_prf#5301,o_custkey_prf#5302,o_orderpriority_prf#5303,o_clerk_prf#5304,o_orderstatus_prf#5305,o_totalprice_prf#5306,o_orderkey_prf#5307,o_comment_prf#5308] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2109) AS rid_3#5330]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#5329]
            :        :  +- Relation[o_shippriority_prf#5319,rid#5320,o_orderdate_prf#5321,o_custkey_prf#5322,o_orderpriority_prf#5323,o_clerk_prf#5324,o_orderstatus_prf#5325,o_totalprice_prf#5326,o_orderkey_prf#5327,o_comment_prf#5328] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#5331 AS l_returnflag_prf_3#5350, l_orderkey_and_l_linenumber_prf#5332 AS l_orderkey_and_l_linenumber_prf_3#5351, l_comment_prf#5333 AS l_comment_prf_3#5352, l_linestatus_prf#5334 AS l_linestatus_prf_3#5353, rid#5335 AS rid_3#5354, l_shipmode_prf#5336 AS l_shipmode_prf_3#5355, l_shipinstruct_prf#5337 AS l_shipinstruct_prf_3#5356, l_quantity_prf#5338 AS l_quantity_prf_3#5357, l_receiptdate_prf#5339 AS l_receiptdate_prf_3#5358, l_linenumber_prf#5340 AS l_linenumber_prf_3#5359, l_tax_prf#5341 AS l_tax_prf_3#5360, l_shipdate_prf#5342 AS l_shipdate_prf_3#5361, l_extendedprice_prf#5343 AS l_extendedprice_prf_3#5362, l_partkey_prf#5344 AS l_partkey_prf_3#5363, l_discount_prf#5345 AS l_discount_prf_3#5364, l_partkey_and_l_suppkey_prf#5346 AS l_partkey_and_l_suppkey_prf_3#5365, l_commitdate_prf#5347 AS l_commitdate_prf_3#5366, l_suppkey_prf#5348 AS l_suppkey_prf_3#5367, l_orderkey_prf#5349 AS l_orderkey_prf_3#5368]
               +- Relation[l_returnflag_prf#5331,l_orderkey_and_l_linenumber_prf#5332,l_comment_prf#5333,l_linestatus_prf#5334,rid#5335,l_shipmode_prf#5336,l_shipinstruct_prf#5337,l_quantity_prf#5338,l_receiptdate_prf#5339,l_linenumber_prf#5340,l_tax_prf#5341,l_shipdate_prf#5342,l_extendedprice_prf#5343,l_partkey_prf#5344,l_discount_prf#5345,l_partkey_and_l_suppkey_prf#5346,l_commitdate_prf#5347,l_suppkey_prf#5348,l_orderkey_prf#5349] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 139740ms

ft1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_name = 'FRANCE' and n_nationkey = c_nationkey
19/10/17 02:21:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:21:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5434L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 02:21:13 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:21:13 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:21:13 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:21:13 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:21:13 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:21:13 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:21:13 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:21:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5434L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#5473]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [s_phone_prf#5436 AS s_phone_prf_0#5444, rid#5437 AS rid_0#5445, s_address_prf#5438 AS s_address_prf_0#5446, s_nationkey_prf#5439 AS s_nationkey_prf_0#5447, s_suppkey_prf#5440 AS s_suppkey_prf_0#5448, s_name_prf#5441 AS s_name_prf_0#5449, s_acctbal_prf#5442 AS s_acctbal_prf_0#5450, s_comment_prf#5443 AS s_comment_prf_0#5451]
         :     :  :  :  +- Relation[s_phone_prf#5436,rid#5437,s_address_prf#5438,s_nationkey_prf#5439,s_suppkey_prf#5440,s_name_prf#5441,s_acctbal_prf#5442,s_comment_prf#5443] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#5461]
         :     :  :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#5460]
         :     :  :        :  +- Relation[s_phone_prf#5452,rid#5453,s_address_prf#5454,s_nationkey_prf#5455,s_suppkey_prf#5456,s_name_prf#5457,s_acctbal_prf#5458,s_comment_prf#5459] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [rid#5462 AS rid_1#5467, n_regionkey_prf#5463 AS n_regionkey_prf_1#5468, n_nationkey_prf#5464 AS n_nationkey_prf_1#5469, n_name_prf#5465 AS n_name_prf_1#5470, n_comment_prf#5466 AS n_comment_prf_1#5471]
         :     :     :  +- Relation[rid#5462,n_regionkey_prf#5463,n_nationkey_prf#5464,n_name_prf#5465,n_comment_prf#5466] JDBCRelation(nation_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5472]
         :     :        +- DexRidFilter nation~n_name~FRANCE
         :     :           +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#5474 AS c_acctbal_prf_2#5483, rid#5475 AS rid_2#5484, c_name_prf#5476 AS c_name_prf_2#5485, c_nationkey_prf#5477 AS c_nationkey_prf_2#5486, c_custkey_prf#5478 AS c_custkey_prf_2#5487, c_comment_prf#5479 AS c_comment_prf_2#5488, c_address_prf#5480 AS c_address_prf_2#5489, c_mktsegment_prf#5481 AS c_mktsegment_prf_2#5490, c_phone_prf#5482 AS c_phone_prf_2#5491]
            +- Relation[c_acctbal_prf#5474,rid#5475,c_name_prf#5476,c_nationkey_prf#5477,c_custkey_prf#5478,c_comment_prf#5479,c_address_prf#5480,c_mktsegment_prf#5481,c_phone_prf#5482] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 47802ms

ft1d=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/17 02:22:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:22:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5536L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_nationkey#21L]
                  +- Filter isnotnull(s_nationkey#21L)
                     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 02:22:00 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:22:00 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:22:00 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:22:00 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:22:00 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:22:00 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:22:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5536L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#5538 AS c_acctbal_prf_0#5547, rid#5539 AS rid_0#5548, c_name_prf#5540 AS c_name_prf_0#5549, c_nationkey_prf#5541 AS c_nationkey_prf_0#5550, c_custkey_prf#5542 AS c_custkey_prf_0#5551, c_comment_prf#5543 AS c_comment_prf_0#5552, c_address_prf#5544 AS c_address_prf_0#5553, c_mktsegment_prf#5545 AS c_mktsegment_prf_0#5554, c_phone_prf#5546 AS c_phone_prf_0#5555]
         :  :  +- Relation[c_acctbal_prf#5538,rid#5539,c_name_prf#5540,c_nationkey_prf#5541,c_custkey_prf#5542,c_comment_prf#5543,c_address_prf#5544,c_mktsegment_prf#5545,c_phone_prf#5546] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#5566]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5565]
         :        :  +- Relation[c_acctbal_prf#5556,rid#5557,c_name_prf#5558,c_nationkey_prf#5559,c_custkey_prf#5560,c_comment_prf#5561,c_address_prf#5562,c_mktsegment_prf#5563,c_phone_prf#5564] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#5578]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_1#5572: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [rid#5567 AS rid_1#5572, n_regionkey_prf#5568 AS n_regionkey_prf_1#5573, n_nationkey_prf#5569 AS n_nationkey_prf_1#5574, n_name_prf#5570 AS n_name_prf_1#5575, n_comment_prf#5571 AS n_comment_prf_1#5576]
            :     :  :  +- Relation[rid#5567,n_regionkey_prf#5568,n_nationkey_prf#5569,n_name_prf#5570,n_comment_prf#5571] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5577]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [s_phone_prf#5579 AS s_phone_prf_2#5587, rid#5580 AS rid_2#5588, s_address_prf#5581 AS s_address_prf_2#5589, s_nationkey_prf#5582 AS s_nationkey_prf_2#5590, s_suppkey_prf#5583 AS s_suppkey_prf_2#5591, s_name_prf#5584 AS s_name_prf_2#5592, s_acctbal_prf#5585 AS s_acctbal_prf_2#5593, s_comment_prf#5586 AS s_comment_prf_2#5594]
               +- Relation[s_phone_prf#5579,rid#5580,s_address_prf#5581,s_nationkey_prf#5582,s_suppkey_prf#5583,s_name_prf#5584,s_acctbal_prf#5585,s_comment_prf#5586] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 24369ms

ft3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and p_size = 15 and l_suppkey = s_suppkey
19/10/17 02:22:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:22:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5652L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 02:22:25 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:22:25 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:22:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5652L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, rid_0#5677: string
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [l_returnflag_prf#5654 AS l_returnflag_prf_0#5673, l_orderkey_and_l_linenumber_prf#5655 AS l_orderkey_and_l_linenumber_prf_0#5674, l_comment_prf#5656 AS l_comment_prf_0#5675, l_linestatus_prf#5657 AS l_linestatus_prf_0#5676, rid#5658 AS rid_0#5677, l_shipmode_prf#5659 AS l_shipmode_prf_0#5678, l_shipinstruct_prf#5660 AS l_shipinstruct_prf_0#5679, l_quantity_prf#5661 AS l_quantity_prf_0#5680, l_receiptdate_prf#5662 AS l_receiptdate_prf_0#5681, l_linenumber_prf#5663 AS l_linenumber_prf_0#5682, l_tax_prf#5664 AS l_tax_prf_0#5683, l_shipdate_prf#5665 AS l_shipdate_prf_0#5684, l_extendedprice_prf#5666 AS l_extendedprice_prf_0#5685, l_partkey_prf#5667 AS l_partkey_prf_0#5686, l_discount_prf#5668 AS l_discount_prf_0#5687, l_partkey_and_l_suppkey_prf#5669 AS l_partkey_and_l_suppkey_prf_0#5688, l_commitdate_prf#5670 AS l_commitdate_prf_0#5689, l_suppkey_prf#5671 AS l_suppkey_prf_0#5690, l_orderkey_prf#5672 AS l_orderkey_prf_0#5691]
         :     :  :  :  +- Relation[l_returnflag_prf#5654,l_orderkey_and_l_linenumber_prf#5655,l_comment_prf#5656,l_linestatus_prf#5657,rid#5658,l_shipmode_prf#5659,l_shipinstruct_prf#5660,l_quantity_prf#5661,l_receiptdate_prf#5662,l_linenumber_prf#5663,l_tax_prf#5664,l_shipdate_prf#5665,l_extendedprice_prf#5666,l_partkey_prf#5667,l_discount_prf#5668,l_partkey_and_l_suppkey_prf#5669,l_commitdate_prf#5670,l_suppkey_prf#5671,l_orderkey_prf#5672] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#5712]
         :     :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#5711]
         :     :  :        :  +- Relation[l_returnflag_prf#5692,l_orderkey_and_l_linenumber_prf#5693,l_comment_prf#5694,l_linestatus_prf#5695,rid#5696,l_shipmode_prf#5697,l_shipinstruct_prf#5698,l_quantity_prf#5699,l_receiptdate_prf#5700,l_linenumber_prf#5701,l_tax_prf#5702,l_shipdate_prf#5703,l_extendedprice_prf#5704,l_partkey_prf#5705,l_discount_prf#5706,l_partkey_and_l_suppkey_prf#5707,l_commitdate_prf#5708,l_suppkey_prf#5709,l_orderkey_prf#5710] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [p_comment_prf#5713 AS p_comment_prf_1#5723, p_name_prf#5714 AS p_name_prf_1#5724, rid#5715 AS rid_1#5725, p_type_prf#5716 AS p_type_prf_1#5726, p_retailprice_prf#5717 AS p_retailprice_prf_1#5727, p_mfgr_prf#5718 AS p_mfgr_prf_1#5728, p_container_prf#5719 AS p_container_prf_1#5729, p_brand_prf#5720 AS p_brand_prf_1#5730, p_size_prf#5721 AS p_size_prf_1#5731, p_partkey_prf#5722 AS p_partkey_prf_1#5732]
         :     :     :  +- Relation[p_comment_prf#5713,p_name_prf#5714,rid#5715,p_type_prf#5716,p_retailprice_prf#5717,p_mfgr_prf#5718,p_container_prf#5719,p_brand_prf#5720,p_size_prf#5721,p_partkey_prf#5722] JDBCRelation(part_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5733]
         :     :        +- DexRidFilter part~p_size~15
         :     :           +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5735 AS s_phone_prf_2#5743, rid#5736 AS rid_2#5744, s_address_prf#5737 AS s_address_prf_2#5745, s_nationkey_prf#5738 AS s_nationkey_prf_2#5746, s_suppkey_prf#5739 AS s_suppkey_prf_2#5747, s_name_prf#5740 AS s_name_prf_2#5748, s_acctbal_prf#5741 AS s_acctbal_prf_2#5749, s_comment_prf#5742 AS s_comment_prf_2#5750]
            +- Relation[s_phone_prf#5735,rid#5736,s_address_prf#5737,s_nationkey_prf#5738,s_suppkey_prf#5739,s_name_prf#5740,s_acctbal_prf#5741,s_comment_prf#5742] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 96429ms

fr1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and (c_mktsegment = 'BUILDING' and l_orderkey = o_orderkey)
19/10/17 02:24:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:24:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5824L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 02:24:01 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:24:01 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:24:01 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:24:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5824L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#5826 AS l_returnflag_prf_0#5845, l_orderkey_and_l_linenumber_prf#5827 AS l_orderkey_and_l_linenumber_prf_0#5846, l_comment_prf#5828 AS l_comment_prf_0#5847, l_linestatus_prf#5829 AS l_linestatus_prf_0#5848, rid#5830 AS rid_0#5849, l_shipmode_prf#5831 AS l_shipmode_prf_0#5850, l_shipinstruct_prf#5832 AS l_shipinstruct_prf_0#5851, l_quantity_prf#5833 AS l_quantity_prf_0#5852, l_receiptdate_prf#5834 AS l_receiptdate_prf_0#5853, l_linenumber_prf#5835 AS l_linenumber_prf_0#5854, l_tax_prf#5836 AS l_tax_prf_0#5855, l_shipdate_prf#5837 AS l_shipdate_prf_0#5856, l_extendedprice_prf#5838 AS l_extendedprice_prf_0#5857, l_partkey_prf#5839 AS l_partkey_prf_0#5858, l_discount_prf#5840 AS l_discount_prf_0#5859, l_partkey_and_l_suppkey_prf#5841 AS l_partkey_and_l_suppkey_prf_0#5860, l_commitdate_prf#5842 AS l_commitdate_prf_0#5861, l_suppkey_prf#5843 AS l_suppkey_prf_0#5862, l_orderkey_prf#5844 AS l_orderkey_prf_0#5863]
         :  :  +- Relation[l_returnflag_prf#5826,l_orderkey_and_l_linenumber_prf#5827,l_comment_prf#5828,l_linestatus_prf#5829,rid#5830,l_shipmode_prf#5831,l_shipinstruct_prf#5832,l_quantity_prf#5833,l_receiptdate_prf#5834,l_linenumber_prf#5835,l_tax_prf#5836,l_shipdate_prf#5837,l_extendedprice_prf#5838,l_partkey_prf#5839,l_discount_prf#5840,l_partkey_and_l_suppkey_prf#5841,l_commitdate_prf#5842,l_suppkey_prf#5843,l_orderkey_prf#5844] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2109) AS rid_2#5884]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5883]
         :        :  +- Relation[l_returnflag_prf#5864,l_orderkey_and_l_linenumber_prf#5865,l_comment_prf#5866,l_linestatus_prf#5867,rid#5868,l_shipmode_prf#5869,l_shipinstruct_prf#5870,l_quantity_prf#5871,l_receiptdate_prf#5872,l_linenumber_prf#5873,l_tax_prf#5874,l_shipdate_prf#5875,l_extendedprice_prf#5876,l_partkey_prf#5877,l_discount_prf#5878,l_partkey_and_l_suppkey_prf#5879,l_commitdate_prf#5880,l_suppkey_prf#5881,l_orderkey_prf#5882] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#5904]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#5895: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [c_acctbal_prf#5885 AS c_acctbal_prf_1#5894, rid#5886 AS rid_1#5895, c_name_prf#5887 AS c_name_prf_1#5896, c_nationkey_prf#5888 AS c_nationkey_prf_1#5897, c_custkey_prf#5889 AS c_custkey_prf_1#5898, c_comment_prf#5890 AS c_comment_prf_1#5899, c_address_prf#5891 AS c_address_prf_1#5900, c_mktsegment_prf#5892 AS c_mktsegment_prf_1#5901, c_phone_prf#5893 AS c_phone_prf_1#5902]
            :     :  :  +- Relation[c_acctbal_prf#5885,rid#5886,c_name_prf#5887,c_nationkey_prf#5888,c_custkey_prf#5889,c_comment_prf#5890,c_address_prf#5891,c_mktsegment_prf#5892,c_phone_prf#5893] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5903]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#5905 AS o_shippriority_prf_2#5915, rid#5906 AS rid_2#5916, o_orderdate_prf#5907 AS o_orderdate_prf_2#5917, o_custkey_prf#5908 AS o_custkey_prf_2#5918, o_orderpriority_prf#5909 AS o_orderpriority_prf_2#5919, o_clerk_prf#5910 AS o_clerk_prf_2#5920, o_orderstatus_prf#5911 AS o_orderstatus_prf_2#5921, o_totalprice_prf#5912 AS o_totalprice_prf_2#5922, o_orderkey_prf#5913 AS o_orderkey_prf_2#5923, o_comment_prf#5914 AS o_comment_prf_2#5924]
               +- Relation[o_shippriority_prf#5905,rid#5906,o_orderdate_prf#5907,o_custkey_prf#5908,o_orderpriority_prf#5909,o_clerk_prf#5910,o_orderstatus_prf#5911,o_totalprice_prf#5912,o_orderkey_prf#5913,o_comment_prf#5914] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 83576ms

fr1d=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/17 02:25:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:25:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5999L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 02:25:25 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:25:25 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:25:25 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 02:25:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5999L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#6041]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#6020]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#6011: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [c_acctbal_prf#6001 AS c_acctbal_prf_0#6010, rid#6002 AS rid_0#6011, c_name_prf#6003 AS c_name_prf_0#6012, c_nationkey_prf#6004 AS c_nationkey_prf_0#6013, c_custkey_prf#6005 AS c_custkey_prf_0#6014, c_comment_prf#6006 AS c_comment_prf_0#6015, c_address_prf#6007 AS c_address_prf_0#6016, c_mktsegment_prf#6008 AS c_mktsegment_prf_0#6017, c_phone_prf#6009 AS c_phone_prf_0#6018]
         :     :  :     :  :  +- Relation[c_acctbal_prf#6001,rid#6002,c_name_prf#6003,c_nationkey_prf#6004,c_custkey_prf#6005,c_comment_prf#6006,c_address_prf#6007,c_mktsegment_prf#6008,c_phone_prf#6009] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#6019]
         :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :        +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#6021 AS o_shippriority_prf_1#6031, rid#6022 AS rid_1#6032, o_orderdate_prf#6023 AS o_orderdate_prf_1#6033, o_custkey_prf#6024 AS o_custkey_prf_1#6034, o_orderpriority_prf#6025 AS o_orderpriority_prf_1#6035, o_clerk_prf#6026 AS o_clerk_prf_1#6036, o_orderstatus_prf#6027 AS o_orderstatus_prf_1#6037, o_totalprice_prf#6028 AS o_totalprice_prf_1#6038, o_orderkey_prf#6029 AS o_orderkey_prf_1#6039, o_comment_prf#6030 AS o_comment_prf_1#6040]
         :     :     +- Relation[o_shippriority_prf#6021,rid#6022,o_orderdate_prf#6023,o_custkey_prf#6024,o_orderpriority_prf#6025,o_clerk_prf#6026,o_orderstatus_prf#6027,o_totalprice_prf#6028,o_orderkey_prf#6029,o_comment_prf#6030] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#6042 AS l_returnflag_prf_2#6061, l_orderkey_and_l_linenumber_prf#6043 AS l_orderkey_and_l_linenumber_prf_2#6062, l_comment_prf#6044 AS l_comment_prf_2#6063, l_linestatus_prf#6045 AS l_linestatus_prf_2#6064, rid#6046 AS rid_2#6065, l_shipmode_prf#6047 AS l_shipmode_prf_2#6066, l_shipinstruct_prf#6048 AS l_shipinstruct_prf_2#6067, l_quantity_prf#6049 AS l_quantity_prf_2#6068, l_receiptdate_prf#6050 AS l_receiptdate_prf_2#6069, l_linenumber_prf#6051 AS l_linenumber_prf_2#6070, l_tax_prf#6052 AS l_tax_prf_2#6071, l_shipdate_prf#6053 AS l_shipdate_prf_2#6072, l_extendedprice_prf#6054 AS l_extendedprice_prf_2#6073, l_partkey_prf#6055 AS l_partkey_prf_2#6074, l_discount_prf#6056 AS l_discount_prf_2#6075, l_partkey_and_l_suppkey_prf#6057 AS l_partkey_and_l_suppkey_prf_2#6076, l_commitdate_prf#6058 AS l_commitdate_prf_2#6077, l_suppkey_prf#6059 AS l_suppkey_prf_2#6078, l_orderkey_prf#6060 AS l_orderkey_prf_2#6079]
            +- Relation[l_returnflag_prf#6042,l_orderkey_and_l_linenumber_prf#6043,l_comment_prf#6044,l_linestatus_prf#6045,rid#6046,l_shipmode_prf#6047,l_shipinstruct_prf#6048,l_quantity_prf#6049,l_receiptdate_prf#6050,l_linenumber_prf#6051,l_tax_prf#6052,l_shipdate_prf#6053,l_extendedprice_prf#6054,l_partkey_prf#6055,l_discount_prf#6056,l_partkey_and_l_suppkey_prf#6057,l_commitdate_prf#6058,l_suppkey_prf#6059,l_orderkey_prf#6060] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 32722ms

fr2d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderstatus = 'F' and o_orderkey = l_orderkey
19/10/17 02:25:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:25:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6154L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 02:25:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6154L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#6206]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [c_acctbal_prf#6156 AS c_acctbal_prf_0#6165, rid#6157 AS rid_0#6166, c_name_prf#6158 AS c_name_prf_0#6167, c_nationkey_prf#6159 AS c_nationkey_prf_0#6168, c_custkey_prf#6160 AS c_custkey_prf_0#6169, c_comment_prf#6161 AS c_comment_prf_0#6170, c_address_prf#6162 AS c_address_prf_0#6171, c_mktsegment_prf#6163 AS c_mktsegment_prf_0#6172, c_phone_prf#6164 AS c_phone_prf_0#6173]
         :     :  :  :  +- Relation[c_acctbal_prf#6156,rid#6157,c_name_prf#6158,c_nationkey_prf#6159,c_custkey_prf#6160,c_comment_prf#6161,c_address_prf#6162,c_mktsegment_prf#6163,c_phone_prf#6164] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#6184]
         :     :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#6183]
         :     :  :        :  +- Relation[c_acctbal_prf#6174,rid#6175,c_name_prf#6176,c_nationkey_prf#6177,c_custkey_prf#6178,c_comment_prf#6179,c_address_prf#6180,c_mktsegment_prf#6181,c_phone_prf#6182] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [o_shippriority_prf#6185 AS o_shippriority_prf_1#6195, rid#6186 AS rid_1#6196, o_orderdate_prf#6187 AS o_orderdate_prf_1#6197, o_custkey_prf#6188 AS o_custkey_prf_1#6198, o_orderpriority_prf#6189 AS o_orderpriority_prf_1#6199, o_clerk_prf#6190 AS o_clerk_prf_1#6200, o_orderstatus_prf#6191 AS o_orderstatus_prf_1#6201, o_totalprice_prf#6192 AS o_totalprice_prf_1#6202, o_orderkey_prf#6193 AS o_orderkey_prf_1#6203, o_comment_prf#6194 AS o_comment_prf_1#6204]
         :     :     :  +- Relation[o_shippriority_prf#6185,rid#6186,o_orderdate_prf#6187,o_custkey_prf#6188,o_orderpriority_prf#6189,o_clerk_prf#6190,o_orderstatus_prf#6191,o_totalprice_prf#6192,o_orderkey_prf#6193,o_comment_prf#6194] JDBCRelation(orders_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6205]
         :     :        +- DexRidFilter orders~o_orderstatus~F
         :     :           +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#6207 AS l_returnflag_prf_2#6226, l_orderkey_and_l_linenumber_prf#6208 AS l_orderkey_and_l_linenumber_prf_2#6227, l_comment_prf#6209 AS l_comment_prf_2#6228, l_linestatus_prf#6210 AS l_linestatus_prf_2#6229, rid#6211 AS rid_2#6230, l_shipmode_prf#6212 AS l_shipmode_prf_2#6231, l_shipinstruct_prf#6213 AS l_shipinstruct_prf_2#6232, l_quantity_prf#6214 AS l_quantity_prf_2#6233, l_receiptdate_prf#6215 AS l_receiptdate_prf_2#6234, l_linenumber_prf#6216 AS l_linenumber_prf_2#6235, l_tax_prf#6217 AS l_tax_prf_2#6236, l_shipdate_prf#6218 AS l_shipdate_prf_2#6237, l_extendedprice_prf#6219 AS l_extendedprice_prf_2#6238, l_partkey_prf#6220 AS l_partkey_prf_2#6239, l_discount_prf#6221 AS l_discount_prf_2#6240, l_partkey_and_l_suppkey_prf#6222 AS l_partkey_and_l_suppkey_prf_2#6241, l_commitdate_prf#6223 AS l_commitdate_prf_2#6242, l_suppkey_prf#6224 AS l_suppkey_prf_2#6243, l_orderkey_prf#6225 AS l_orderkey_prf_2#6244]
            +- Relation[l_returnflag_prf#6207,l_orderkey_and_l_linenumber_prf#6208,l_comment_prf#6209,l_linestatus_prf#6210,rid#6211,l_shipmode_prf#6212,l_shipinstruct_prf#6213,l_quantity_prf#6214,l_receiptdate_prf#6215,l_linenumber_prf#6216,l_tax_prf#6217,l_shipdate_prf#6218,l_extendedprice_prf#6219,l_partkey_prf#6220,l_discount_prf#6221,l_partkey_and_l_suppkey_prf#6222,l_commitdate_prf#6223,l_suppkey_prf#6224,l_orderkey_prf#6225] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 107289ms

ft1b=
select * from nation, supplier, customer where n_name = 'FRANCE' and n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/17 02:27:45 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:27:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6305L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 02:27:45 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:27:45 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:27:45 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:27:45 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:27:45 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:27:45 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 02:27:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6305L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#6335]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#6318]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#6312: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#6307 AS rid_0#6312, n_regionkey_prf#6308 AS n_regionkey_prf_0#6313, n_nationkey_prf#6309 AS n_nationkey_prf_0#6314, n_name_prf#6310 AS n_name_prf_0#6315, n_comment_prf#6311 AS n_comment_prf_0#6316]
         :     :  :     :  :  +- Relation[rid#6307,n_regionkey_prf#6308,n_nationkey_prf#6309,n_name_prf#6310,n_comment_prf#6311] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#6317]
         :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :        +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#6319 AS s_phone_prf_1#6327, rid#6320 AS rid_1#6328, s_address_prf#6321 AS s_address_prf_1#6329, s_nationkey_prf#6322 AS s_nationkey_prf_1#6330, s_suppkey_prf#6323 AS s_suppkey_prf_1#6331, s_name_prf#6324 AS s_name_prf_1#6332, s_acctbal_prf#6325 AS s_acctbal_prf_1#6333, s_comment_prf#6326 AS s_comment_prf_1#6334]
         :     :     +- Relation[s_phone_prf#6319,rid#6320,s_address_prf#6321,s_nationkey_prf#6322,s_suppkey_prf#6323,s_name_prf#6324,s_acctbal_prf#6325,s_comment_prf#6326] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#6336 AS c_acctbal_prf_2#6345, rid#6337 AS rid_2#6346, c_name_prf#6338 AS c_name_prf_2#6347, c_nationkey_prf#6339 AS c_nationkey_prf_2#6348, c_custkey_prf#6340 AS c_custkey_prf_2#6349, c_comment_prf#6341 AS c_comment_prf_2#6350, c_address_prf#6342 AS c_address_prf_2#6351, c_mktsegment_prf#6343 AS c_mktsegment_prf_2#6352, c_phone_prf#6344 AS c_phone_prf_2#6353]
            +- Relation[c_acctbal_prf#6336,rid#6337,c_name_prf#6338,c_nationkey_prf#6339,c_custkey_prf#6340,c_comment_prf#6341,c_address_prf#6342,c_mktsegment_prf#6343,c_phone_prf#6344] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 30037ms

ft3b=
select * from part, lineitem, supplier where p_size = 15 and p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/17 02:28:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:28:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6411L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 02:28:15 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:28:15 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:28:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6411L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#6434]
         :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#6425: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [p_comment_prf#6413 AS p_comment_prf_0#6423, p_name_prf#6414 AS p_name_prf_0#6424, rid#6415 AS rid_0#6425, p_type_prf#6416 AS p_type_prf_0#6426, p_retailprice_prf#6417 AS p_retailprice_prf_0#6427, p_mfgr_prf#6418 AS p_mfgr_prf_0#6428, p_container_prf#6419 AS p_container_prf_0#6429, p_brand_prf#6420 AS p_brand_prf_0#6430, p_size_prf#6421 AS p_size_prf_0#6431, p_partkey_prf#6422 AS p_partkey_prf_0#6432]
         :     :  :     :  :  +- Relation[p_comment_prf#6413,p_name_prf#6414,rid#6415,p_type_prf#6416,p_retailprice_prf#6417,p_mfgr_prf#6418,p_container_prf#6419,p_brand_prf#6420,p_size_prf#6421,p_partkey_prf#6422] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#6433]
         :     :  :     :     +- DexRidFilter part~p_size~15
         :     :  :     :        +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#6435 AS l_returnflag_prf_1#6454, l_orderkey_and_l_linenumber_prf#6436 AS l_orderkey_and_l_linenumber_prf_1#6455, l_comment_prf#6437 AS l_comment_prf_1#6456, l_linestatus_prf#6438 AS l_linestatus_prf_1#6457, rid#6439 AS rid_1#6458, l_shipmode_prf#6440 AS l_shipmode_prf_1#6459, l_shipinstruct_prf#6441 AS l_shipinstruct_prf_1#6460, l_quantity_prf#6442 AS l_quantity_prf_1#6461, l_receiptdate_prf#6443 AS l_receiptdate_prf_1#6462, l_linenumber_prf#6444 AS l_linenumber_prf_1#6463, l_tax_prf#6445 AS l_tax_prf_1#6464, l_shipdate_prf#6446 AS l_shipdate_prf_1#6465, l_extendedprice_prf#6447 AS l_extendedprice_prf_1#6466, l_partkey_prf#6448 AS l_partkey_prf_1#6467, l_discount_prf#6449 AS l_discount_prf_1#6468, l_partkey_and_l_suppkey_prf#6450 AS l_partkey_and_l_suppkey_prf_1#6469, l_commitdate_prf#6451 AS l_commitdate_prf_1#6470, l_suppkey_prf#6452 AS l_suppkey_prf_1#6471, l_orderkey_prf#6453 AS l_orderkey_prf_1#6472]
         :     :     +- Relation[l_returnflag_prf#6435,l_orderkey_and_l_linenumber_prf#6436,l_comment_prf#6437,l_linestatus_prf#6438,rid#6439,l_shipmode_prf#6440,l_shipinstruct_prf#6441,l_quantity_prf#6442,l_receiptdate_prf#6443,l_linenumber_prf#6444,l_tax_prf#6445,l_shipdate_prf#6446,l_extendedprice_prf#6447,l_partkey_prf#6448,l_discount_prf#6449,l_partkey_and_l_suppkey_prf#6450,l_commitdate_prf#6451,l_suppkey_prf#6452,l_orderkey_prf#6453] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#6474 AS s_phone_prf_2#6482, rid#6475 AS rid_2#6483, s_address_prf#6476 AS s_address_prf_2#6484, s_nationkey_prf#6477 AS s_nationkey_prf_2#6485, s_suppkey_prf#6478 AS s_suppkey_prf_2#6486, s_name_prf#6479 AS s_name_prf_2#6487, s_acctbal_prf#6480 AS s_acctbal_prf_2#6488, s_comment_prf#6481 AS s_comment_prf_2#6489]
            +- Relation[s_phone_prf#6474,rid#6475,s_address_prf#6476,s_nationkey_prf#6477,s_suppkey_prf#6478,s_name_prf#6479,s_acctbal_prf#6480,s_comment_prf#6481] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 6189ms

fr2a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_orderstatus = 'F' and o_custkey = c_custkey
19/10/17 02:28:21 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:28:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6563L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 02:28:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6563L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [l_returnflag_prf#6565 AS l_returnflag_prf_0#6584, l_orderkey_and_l_linenumber_prf#6566 AS l_orderkey_and_l_linenumber_prf_0#6585, l_comment_prf#6567 AS l_comment_prf_0#6586, l_linestatus_prf#6568 AS l_linestatus_prf_0#6587, rid#6569 AS rid_0#6588, l_shipmode_prf#6570 AS l_shipmode_prf_0#6589, l_shipinstruct_prf#6571 AS l_shipinstruct_prf_0#6590, l_quantity_prf#6572 AS l_quantity_prf_0#6591, l_receiptdate_prf#6573 AS l_receiptdate_prf_0#6592, l_linenumber_prf#6574 AS l_linenumber_prf_0#6593, l_tax_prf#6575 AS l_tax_prf_0#6594, l_shipdate_prf#6576 AS l_shipdate_prf_0#6595, l_extendedprice_prf#6577 AS l_extendedprice_prf_0#6596, l_partkey_prf#6578 AS l_partkey_prf_0#6597, l_discount_prf#6579 AS l_discount_prf_0#6598, l_partkey_and_l_suppkey_prf#6580 AS l_partkey_and_l_suppkey_prf_0#6599, l_commitdate_prf#6581 AS l_commitdate_prf_0#6600, l_suppkey_prf#6582 AS l_suppkey_prf_0#6601, l_orderkey_prf#6583 AS l_orderkey_prf_0#6602]
         :     :  :  :  +- Relation[l_returnflag_prf#6565,l_orderkey_and_l_linenumber_prf#6566,l_comment_prf#6567,l_linestatus_prf#6568,rid#6569,l_shipmode_prf#6570,l_shipinstruct_prf#6571,l_quantity_prf#6572,l_receiptdate_prf#6573,l_linenumber_prf#6574,l_tax_prf#6575,l_shipdate_prf#6576,l_extendedprice_prf#6577,l_partkey_prf#6578,l_discount_prf#6579,l_partkey_and_l_suppkey_prf#6580,l_commitdate_prf#6581,l_suppkey_prf#6582,l_orderkey_prf#6583] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#6623]
         :     :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#6622]
         :     :  :        :  +- Relation[l_returnflag_prf#6603,l_orderkey_and_l_linenumber_prf#6604,l_comment_prf#6605,l_linestatus_prf#6606,rid#6607,l_shipmode_prf#6608,l_shipinstruct_prf#6609,l_quantity_prf#6610,l_receiptdate_prf#6611,l_linenumber_prf#6612,l_tax_prf#6613,l_shipdate_prf#6614,l_extendedprice_prf#6615,l_partkey_prf#6616,l_discount_prf#6617,l_partkey_and_l_suppkey_prf#6618,l_commitdate_prf#6619,l_suppkey_prf#6620,l_orderkey_prf#6621] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [o_shippriority_prf#6624 AS o_shippriority_prf_1#6634, rid#6625 AS rid_1#6635, o_orderdate_prf#6626 AS o_orderdate_prf_1#6636, o_custkey_prf#6627 AS o_custkey_prf_1#6637, o_orderpriority_prf#6628 AS o_orderpriority_prf_1#6638, o_clerk_prf#6629 AS o_clerk_prf_1#6639, o_orderstatus_prf#6630 AS o_orderstatus_prf_1#6640, o_totalprice_prf#6631 AS o_totalprice_prf_1#6641, o_orderkey_prf#6632 AS o_orderkey_prf_1#6642, o_comment_prf#6633 AS o_comment_prf_1#6643]
         :     :     :  +- Relation[o_shippriority_prf#6624,rid#6625,o_orderdate_prf#6626,o_custkey_prf#6627,o_orderpriority_prf#6628,o_clerk_prf#6629,o_orderstatus_prf#6630,o_totalprice_prf#6631,o_orderkey_prf#6632,o_comment_prf#6633] JDBCRelation(orders_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6644]
         :     :        +- DexRidFilter orders~o_orderstatus~F
         :     :           +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#6646 AS c_acctbal_prf_2#6655, rid#6647 AS rid_2#6656, c_name_prf#6648 AS c_name_prf_2#6657, c_nationkey_prf#6649 AS c_nationkey_prf_2#6658, c_custkey_prf#6650 AS c_custkey_prf_2#6659, c_comment_prf#6651 AS c_comment_prf_2#6660, c_address_prf#6652 AS c_address_prf_2#6661, c_mktsegment_prf#6653 AS c_mktsegment_prf_2#6662, c_phone_prf#6654 AS c_phone_prf_2#6663]
            +- Relation[c_acctbal_prf#6646,rid#6647,c_name_prf#6648,c_nationkey_prf#6649,c_custkey_prf#6650,c_comment_prf#6651,c_address_prf#6652,c_mktsegment_prf#6653,c_phone_prf#6654] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 192938ms

ft2b=
select * from part, partsupp, supplier where p_size = 15 and p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/17 02:31:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 02:31:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6726L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 02:31:34 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 02:31:34 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 02:31:34 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 02:31:34 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:31:34 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 02:31:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6726L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#2109) AS rid_2#6764]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2109) AS rid_1#6749]
         :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#6740: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [p_comment_prf#6728 AS p_comment_prf_0#6738, p_name_prf#6729 AS p_name_prf_0#6739, rid#6730 AS rid_0#6740, p_type_prf#6731 AS p_type_prf_0#6741, p_retailprice_prf#6732 AS p_retailprice_prf_0#6742, p_mfgr_prf#6733 AS p_mfgr_prf_0#6743, p_container_prf#6734 AS p_container_prf_0#6744, p_brand_prf#6735 AS p_brand_prf_0#6745, p_size_prf#6736 AS p_size_prf_0#6746, p_partkey_prf#6737 AS p_partkey_prf_0#6747]
         :     :  :     :  :  +- Relation[p_comment_prf#6728,p_name_prf#6729,rid#6730,p_type_prf#6731,p_retailprice_prf#6732,p_mfgr_prf#6733,p_container_prf#6734,p_brand_prf#6735,p_size_prf#6736,p_partkey_prf#6737] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#6748]
         :     :  :     :     +- DexRidFilter part~p_size~15
         :     :  :     :        +- Relation[label#2131,value#2132] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#6750 AS ps_partkey_and_ps_suppkey_prf_1#6757, rid#6751 AS rid_1#6758, ps_availqty_prf#6752 AS ps_availqty_prf_1#6759, ps_comment_prf#6753 AS ps_comment_prf_1#6760, ps_partkey_prf#6754 AS ps_partkey_prf_1#6761, ps_supplycost_prf#6755 AS ps_supplycost_prf_1#6762, ps_suppkey_prf#6756 AS ps_suppkey_prf_1#6763]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#6750,rid#6751,ps_availqty_prf#6752,ps_comment_prf#6753,ps_partkey_prf#6754,ps_supplycost_prf#6755,ps_suppkey_prf#6756] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#2108,value#2109] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#6765 AS s_phone_prf_2#6773, rid#6766 AS rid_2#6774, s_address_prf#6767 AS s_address_prf_2#6775, s_nationkey_prf#6768 AS s_nationkey_prf_2#6776, s_suppkey_prf#6769 AS s_suppkey_prf_2#6777, s_name_prf#6770 AS s_name_prf_2#6778, s_acctbal_prf#6771 AS s_acctbal_prf_2#6779, s_comment_prf#6772 AS s_comment_prf_2#6780]
            +- Relation[s_phone_prf#6765,rid#6766,s_address_prf#6767,s_nationkey_prf#6768,s_suppkey_prf#6769,s_name_prf#6770,s_acctbal_prf#6771,s_comment_prf#6772] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 910ms
query=fq1a, count=246415, duration=31105
query=fq1b, count=246415, duration=139740
query=fq1c, count=246415, duration=163600
query=fq1d, count=246415, duration=74679
query=fq1e, count=246415, duration=164930
query=fq1f, count=246415, duration=167989
query=fr1a, count=1214743, duration=121119
query=fr1b, count=1214743, duration=121407
query=fr1c, count=1214743, duration=83576
query=fr1d, count=1214743, duration=32722
query=fr1e, count=1214743, duration=152869
query=fr2a, count=2901744, duration=192938
query=fr2b, count=2901744, duration=105962
query=fr2d, count=2901744, duration=107289
query=fr2e, count=2901744, duration=96765
query=fr2f, count=2901744, duration=83035
query=fs1a, count=1214743, duration=108636
query=fs1b, count=1214743, duration=172655
query=fs1c, count=1214743, duration=172625
query=ft1a, count=2452200, duration=47802
query=ft1b, count=2452200, duration=30037
query=ft1c, count=2452200, duration=33166
query=ft1d, count=2452200, duration=24369
query=ft2a, count=15628, duration=49585
query=ft2b, count=15628, duration=910
query=ft2c, count=15628, duration=7219
query=ft3a, count=117754, duration=96429
query=ft3b, count=117754, duration=6189
query=ft3c, count=117754, duration=55778
