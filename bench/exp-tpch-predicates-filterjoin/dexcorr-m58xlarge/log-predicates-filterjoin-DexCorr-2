19/10/16 21:21:34 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7153ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Wed Oct 16 21:21:37 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Wed Oct 16 21:21:38 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Wed Oct 16 21:21:38 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Wed Oct 16 21:21:38 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Wed Oct 16 21:21:38 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Wed Oct 16 21:21:41 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Wed Oct 16 21:21:43 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Wed Oct 16 21:21:43 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



fr2d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderstatus = 'F' and o_orderkey = l_orderkey
19/10/16 21:21:44 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:21:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2093L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 21:21:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2093L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#2149]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [c_acctbal_prf#2095 AS c_acctbal_prf_0#2104, rid#2096 AS rid_0#2105, c_name_prf#2097 AS c_name_prf_0#2106, c_nationkey_prf#2098 AS c_nationkey_prf_0#2107, c_custkey_prf#2099 AS c_custkey_prf_0#2108, c_comment_prf#2100 AS c_comment_prf_0#2109, c_address_prf#2101 AS c_address_prf_0#2110, c_mktsegment_prf#2102 AS c_mktsegment_prf_0#2111, c_phone_prf#2103 AS c_phone_prf_0#2112]
         :     :  :  :  +- Relation[c_acctbal_prf#2095,rid#2096,c_name_prf#2097,c_nationkey_prf#2098,c_custkey_prf#2099,c_comment_prf#2100,c_address_prf#2101,c_mktsegment_prf#2102,c_phone_prf#2103] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#2125]
         :     :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#2122]
         :     :  :        :  +- Relation[c_acctbal_prf#2113,rid#2114,c_name_prf#2115,c_nationkey_prf#2116,c_custkey_prf#2117,c_comment_prf#2118,c_address_prf#2119,c_mktsegment_prf#2120,c_phone_prf#2121] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [o_shippriority_prf#2126 AS o_shippriority_prf_1#2136, rid#2127 AS rid_1#2137, o_orderdate_prf#2128 AS o_orderdate_prf_1#2138, o_custkey_prf#2129 AS o_custkey_prf_1#2139, o_orderpriority_prf#2130 AS o_orderpriority_prf_1#2140, o_clerk_prf#2131 AS o_clerk_prf_1#2141, o_orderstatus_prf#2132 AS o_orderstatus_prf_1#2142, o_totalprice_prf#2133 AS o_totalprice_prf_1#2143, o_orderkey_prf#2134 AS o_orderkey_prf_1#2144, o_comment_prf#2135 AS o_comment_prf_1#2145]
         :     :     :  +- Relation[o_shippriority_prf#2126,rid#2127,o_orderdate_prf#2128,o_custkey_prf#2129,o_orderpriority_prf#2130,o_clerk_prf#2131,o_orderstatus_prf#2132,o_totalprice_prf#2133,o_orderkey_prf#2134,o_comment_prf#2135] JDBCRelation(orders_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2148]
         :     :        +- DexRidFilter orders~o_orderstatus~F
         :     :           +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2150 AS l_returnflag_prf_2#2169, l_orderkey_and_l_linenumber_prf#2151 AS l_orderkey_and_l_linenumber_prf_2#2170, l_comment_prf#2152 AS l_comment_prf_2#2171, l_linestatus_prf#2153 AS l_linestatus_prf_2#2172, rid#2154 AS rid_2#2173, l_shipmode_prf#2155 AS l_shipmode_prf_2#2174, l_shipinstruct_prf#2156 AS l_shipinstruct_prf_2#2175, l_quantity_prf#2157 AS l_quantity_prf_2#2176, l_receiptdate_prf#2158 AS l_receiptdate_prf_2#2177, l_linenumber_prf#2159 AS l_linenumber_prf_2#2178, l_tax_prf#2160 AS l_tax_prf_2#2179, l_shipdate_prf#2161 AS l_shipdate_prf_2#2180, l_extendedprice_prf#2162 AS l_extendedprice_prf_2#2181, l_partkey_prf#2163 AS l_partkey_prf_2#2182, l_discount_prf#2164 AS l_discount_prf_2#2183, l_partkey_and_l_suppkey_prf#2165 AS l_partkey_and_l_suppkey_prf_2#2184, l_commitdate_prf#2166 AS l_commitdate_prf_2#2185, l_suppkey_prf#2167 AS l_suppkey_prf_2#2186, l_orderkey_prf#2168 AS l_orderkey_prf_2#2187]
            +- Relation[l_returnflag_prf#2150,l_orderkey_and_l_linenumber_prf#2151,l_comment_prf#2152,l_linestatus_prf#2153,rid#2154,l_shipmode_prf#2155,l_shipinstruct_prf#2156,l_quantity_prf#2157,l_receiptdate_prf#2158,l_linenumber_prf#2159,l_tax_prf#2160,l_shipdate_prf#2161,l_extendedprice_prf#2162,l_partkey_prf#2163,l_discount_prf#2164,l_partkey_and_l_suppkey_prf#2165,l_commitdate_prf#2166,l_suppkey_prf#2167,l_orderkey_prf#2168] JDBCRelation(lineitem_prf) [numPartitions=1]

19/10/16 21:21:44 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=2901744
Elapsed time: 108318ms

fq1a=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 21:23:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:23:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2266L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :     :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 21:23:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:23:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:23:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:23:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2266L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, 'rid_2, 'o_shippriority_prf_2, 'o_orderdate_prf_2, 'o_custkey_prf_2, 'o_orderpriority_prf_2, 'o_clerk_prf_2, 'o_orderstatus_prf_2, 'o_totalprice_prf_2, 'o_orderkey_prf_2, 'o_comment_prf_2, dexdecrypt('value_dec_key, value#2124) AS rid_3#2319]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#2298]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#2279]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#2273: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [rid#2268 AS rid_0#2273, n_regionkey_prf#2269 AS n_regionkey_prf_0#2274, n_nationkey_prf#2270 AS n_nationkey_prf_0#2275, n_name_prf#2271 AS n_name_prf_0#2276, n_comment_prf#2272 AS n_comment_prf_0#2277]
         :     :  :     :  :     :  :  +- Relation[rid#2268,n_regionkey_prf#2269,n_nationkey_prf#2270,n_name_prf#2271,n_comment_prf#2272] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2278]
         :     :  :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :  :     :        +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [c_acctbal_prf#2280 AS c_acctbal_prf_1#2289, rid#2281 AS rid_1#2290, c_name_prf#2282 AS c_name_prf_1#2291, c_nationkey_prf#2283 AS c_nationkey_prf_1#2292, c_custkey_prf#2284 AS c_custkey_prf_1#2293, c_comment_prf#2285 AS c_comment_prf_1#2294, c_address_prf#2286 AS c_address_prf_1#2295, c_mktsegment_prf#2287 AS c_mktsegment_prf_1#2296, c_phone_prf#2288 AS c_phone_prf_1#2297]
         :     :  :     :     +- Relation[c_acctbal_prf#2280,rid#2281,c_name_prf#2282,c_nationkey_prf#2283,c_custkey_prf#2284,c_comment_prf#2285,c_address_prf#2286,c_mktsegment_prf#2287,c_phone_prf#2288] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#2299 AS o_shippriority_prf_2#2309, rid#2300 AS rid_2#2310, o_orderdate_prf#2301 AS o_orderdate_prf_2#2311, o_custkey_prf#2302 AS o_custkey_prf_2#2312, o_orderpriority_prf#2303 AS o_orderpriority_prf_2#2313, o_clerk_prf#2304 AS o_clerk_prf_2#2314, o_orderstatus_prf#2305 AS o_orderstatus_prf_2#2315, o_totalprice_prf#2306 AS o_totalprice_prf_2#2316, o_orderkey_prf#2307 AS o_orderkey_prf_2#2317, o_comment_prf#2308 AS o_comment_prf_2#2318]
         :     :     +- Relation[o_shippriority_prf#2299,rid#2300,o_orderdate_prf#2301,o_custkey_prf#2302,o_orderpriority_prf#2303,o_clerk_prf#2304,o_orderstatus_prf#2305,o_totalprice_prf#2306,o_orderkey_prf#2307,o_comment_prf#2308] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2320 AS l_returnflag_prf_3#2339, l_orderkey_and_l_linenumber_prf#2321 AS l_orderkey_and_l_linenumber_prf_3#2340, l_comment_prf#2322 AS l_comment_prf_3#2341, l_linestatus_prf#2323 AS l_linestatus_prf_3#2342, rid#2324 AS rid_3#2343, l_shipmode_prf#2325 AS l_shipmode_prf_3#2344, l_shipinstruct_prf#2326 AS l_shipinstruct_prf_3#2345, l_quantity_prf#2327 AS l_quantity_prf_3#2346, l_receiptdate_prf#2328 AS l_receiptdate_prf_3#2347, l_linenumber_prf#2329 AS l_linenumber_prf_3#2348, l_tax_prf#2330 AS l_tax_prf_3#2349, l_shipdate_prf#2331 AS l_shipdate_prf_3#2350, l_extendedprice_prf#2332 AS l_extendedprice_prf_3#2351, l_partkey_prf#2333 AS l_partkey_prf_3#2352, l_discount_prf#2334 AS l_discount_prf_3#2353, l_partkey_and_l_suppkey_prf#2335 AS l_partkey_and_l_suppkey_prf_3#2354, l_commitdate_prf#2336 AS l_commitdate_prf_3#2355, l_suppkey_prf#2337 AS l_suppkey_prf_3#2356, l_orderkey_prf#2338 AS l_orderkey_prf_3#2357]
            +- Relation[l_returnflag_prf#2320,l_orderkey_and_l_linenumber_prf#2321,l_comment_prf#2322,l_linestatus_prf#2323,rid#2324,l_shipmode_prf#2325,l_shipinstruct_prf#2326,l_quantity_prf#2327,l_receiptdate_prf#2328,l_linenumber_prf#2329,l_tax_prf#2330,l_shipdate_prf#2331,l_extendedprice_prf#2332,l_partkey_prf#2333,l_discount_prf#2334,l_partkey_and_l_suppkey_prf#2335,l_commitdate_prf#2336,l_suppkey_prf#2337,l_orderkey_prf#2338] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 30849ms

fr1d=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/16 21:24:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:24:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2437L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 21:24:03 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:24:03 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:24:03 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:24:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2437L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#2479]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#2458]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2449: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [c_acctbal_prf#2439 AS c_acctbal_prf_0#2448, rid#2440 AS rid_0#2449, c_name_prf#2441 AS c_name_prf_0#2450, c_nationkey_prf#2442 AS c_nationkey_prf_0#2451, c_custkey_prf#2443 AS c_custkey_prf_0#2452, c_comment_prf#2444 AS c_comment_prf_0#2453, c_address_prf#2445 AS c_address_prf_0#2454, c_mktsegment_prf#2446 AS c_mktsegment_prf_0#2455, c_phone_prf#2447 AS c_phone_prf_0#2456]
         :     :  :     :  :  +- Relation[c_acctbal_prf#2439,rid#2440,c_name_prf#2441,c_nationkey_prf#2442,c_custkey_prf#2443,c_comment_prf#2444,c_address_prf#2445,c_mktsegment_prf#2446,c_phone_prf#2447] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2457]
         :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :        +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#2459 AS o_shippriority_prf_1#2469, rid#2460 AS rid_1#2470, o_orderdate_prf#2461 AS o_orderdate_prf_1#2471, o_custkey_prf#2462 AS o_custkey_prf_1#2472, o_orderpriority_prf#2463 AS o_orderpriority_prf_1#2473, o_clerk_prf#2464 AS o_clerk_prf_1#2474, o_orderstatus_prf#2465 AS o_orderstatus_prf_1#2475, o_totalprice_prf#2466 AS o_totalprice_prf_1#2476, o_orderkey_prf#2467 AS o_orderkey_prf_1#2477, o_comment_prf#2468 AS o_comment_prf_1#2478]
         :     :     +- Relation[o_shippriority_prf#2459,rid#2460,o_orderdate_prf#2461,o_custkey_prf#2462,o_orderpriority_prf#2463,o_clerk_prf#2464,o_orderstatus_prf#2465,o_totalprice_prf#2466,o_orderkey_prf#2467,o_comment_prf#2468] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2480 AS l_returnflag_prf_2#2499, l_orderkey_and_l_linenumber_prf#2481 AS l_orderkey_and_l_linenumber_prf_2#2500, l_comment_prf#2482 AS l_comment_prf_2#2501, l_linestatus_prf#2483 AS l_linestatus_prf_2#2502, rid#2484 AS rid_2#2503, l_shipmode_prf#2485 AS l_shipmode_prf_2#2504, l_shipinstruct_prf#2486 AS l_shipinstruct_prf_2#2505, l_quantity_prf#2487 AS l_quantity_prf_2#2506, l_receiptdate_prf#2488 AS l_receiptdate_prf_2#2507, l_linenumber_prf#2489 AS l_linenumber_prf_2#2508, l_tax_prf#2490 AS l_tax_prf_2#2509, l_shipdate_prf#2491 AS l_shipdate_prf_2#2510, l_extendedprice_prf#2492 AS l_extendedprice_prf_2#2511, l_partkey_prf#2493 AS l_partkey_prf_2#2512, l_discount_prf#2494 AS l_discount_prf_2#2513, l_partkey_and_l_suppkey_prf#2495 AS l_partkey_and_l_suppkey_prf_2#2514, l_commitdate_prf#2496 AS l_commitdate_prf_2#2515, l_suppkey_prf#2497 AS l_suppkey_prf_2#2516, l_orderkey_prf#2498 AS l_orderkey_prf_2#2517]
            +- Relation[l_returnflag_prf#2480,l_orderkey_and_l_linenumber_prf#2481,l_comment_prf#2482,l_linestatus_prf#2483,rid#2484,l_shipmode_prf#2485,l_shipinstruct_prf#2486,l_quantity_prf#2487,l_receiptdate_prf#2488,l_linenumber_prf#2489,l_tax_prf#2490,l_shipdate_prf#2491,l_extendedprice_prf#2492,l_partkey_prf#2493,l_discount_prf#2494,l_partkey_and_l_suppkey_prf#2495,l_commitdate_prf#2496,l_suppkey_prf#2497,l_orderkey_prf#2498] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 32917ms

fs1c=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/16 21:24:36 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:24:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2601L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_orderkey#306L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 21:24:36 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:24:36 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:24:36 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:24:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2601L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [p_comment_prf#2603 AS p_comment_prf_0#2613, p_name_prf#2604 AS p_name_prf_0#2614, rid#2605 AS rid_0#2615, p_type_prf#2606 AS p_type_prf_0#2616, p_retailprice_prf#2607 AS p_retailprice_prf_0#2617, p_mfgr_prf#2608 AS p_mfgr_prf_0#2618, p_container_prf#2609 AS p_container_prf_0#2619, p_brand_prf#2610 AS p_brand_prf_0#2620, p_size_prf#2611 AS p_size_prf_0#2621, p_partkey_prf#2612 AS p_partkey_prf_0#2622]
         :  :  :  :  +- Relation[p_comment_prf#2603,p_name_prf#2604,rid#2605,p_type_prf#2606,p_retailprice_prf#2607,p_mfgr_prf#2608,p_container_prf#2609,p_brand_prf#2610,p_size_prf#2611,p_partkey_prf#2612] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#2634]
         :  :  :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#2633]
         :  :  :        :  +- Relation[p_comment_prf#2623,p_name_prf#2624,rid#2625,p_type_prf#2626,p_retailprice_prf#2627,p_mfgr_prf#2628,p_container_prf#2629,p_brand_prf#2630,p_size_prf#2631,p_partkey_prf#2632] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#2635 AS l_returnflag_prf_1#2654, l_orderkey_and_l_linenumber_prf#2636 AS l_orderkey_and_l_linenumber_prf_1#2655, l_comment_prf#2637 AS l_comment_prf_1#2656, l_linestatus_prf#2638 AS l_linestatus_prf_1#2657, rid#2639 AS rid_1#2658, l_shipmode_prf#2640 AS l_shipmode_prf_1#2659, l_shipinstruct_prf#2641 AS l_shipinstruct_prf_1#2660, l_quantity_prf#2642 AS l_quantity_prf_1#2661, l_receiptdate_prf#2643 AS l_receiptdate_prf_1#2662, l_linenumber_prf#2644 AS l_linenumber_prf_1#2663, l_tax_prf#2645 AS l_tax_prf_1#2664, l_shipdate_prf#2646 AS l_shipdate_prf_1#2665, l_extendedprice_prf#2647 AS l_extendedprice_prf_1#2666, l_partkey_prf#2648 AS l_partkey_prf_1#2667, l_discount_prf#2649 AS l_discount_prf_1#2668, l_partkey_and_l_suppkey_prf#2650 AS l_partkey_and_l_suppkey_prf_1#2669, l_commitdate_prf#2651 AS l_commitdate_prf_1#2670, l_suppkey_prf#2652 AS l_suppkey_prf_1#2671, l_orderkey_prf#2653 AS l_orderkey_prf_1#2672]
         :  :     +- Relation[l_returnflag_prf#2635,l_orderkey_and_l_linenumber_prf#2636,l_comment_prf#2637,l_linestatus_prf#2638,rid#2639,l_shipmode_prf#2640,l_shipinstruct_prf#2641,l_quantity_prf#2642,l_receiptdate_prf#2643,l_linenumber_prf#2644,l_tax_prf#2645,l_shipdate_prf#2646,l_extendedprice_prf#2647,l_partkey_prf#2648,l_discount_prf#2649,l_partkey_and_l_suppkey_prf#2650,l_commitdate_prf#2651,l_suppkey_prf#2652,l_orderkey_prf#2653] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2124) AS rid_3#2693]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2692]
         :        :  +- Relation[l_returnflag_prf#2673,l_orderkey_and_l_linenumber_prf#2674,l_comment_prf#2675,l_linestatus_prf#2676,rid#2677,l_shipmode_prf#2678,l_shipinstruct_prf#2679,l_quantity_prf#2680,l_receiptdate_prf#2681,l_linenumber_prf#2682,l_tax_prf#2683,l_shipdate_prf#2684,l_extendedprice_prf#2685,l_partkey_prf#2686,l_discount_prf#2687,l_partkey_and_l_suppkey_prf#2688,l_commitdate_prf#2689,l_suppkey_prf#2690,l_orderkey_prf#2691] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_2, 'rid_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2124) AS rid_3#2713]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_2#2704: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [c_acctbal_prf#2694 AS c_acctbal_prf_2#2703, rid#2695 AS rid_2#2704, c_name_prf#2696 AS c_name_prf_2#2705, c_nationkey_prf#2697 AS c_nationkey_prf_2#2706, c_custkey_prf#2698 AS c_custkey_prf_2#2707, c_comment_prf#2699 AS c_comment_prf_2#2708, c_address_prf#2700 AS c_address_prf_2#2709, c_mktsegment_prf#2701 AS c_mktsegment_prf_2#2710, c_phone_prf#2702 AS c_phone_prf_2#2711]
            :     :  :  +- Relation[c_acctbal_prf#2694,rid#2695,c_name_prf#2696,c_nationkey_prf#2697,c_custkey_prf#2698,c_comment_prf#2699,c_address_prf#2700,c_mktsegment_prf#2701,c_phone_prf#2702] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#2712]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2714 AS o_shippriority_prf_3#2724, rid#2715 AS rid_3#2725, o_orderdate_prf#2716 AS o_orderdate_prf_3#2726, o_custkey_prf#2717 AS o_custkey_prf_3#2727, o_orderpriority_prf#2718 AS o_orderpriority_prf_3#2728, o_clerk_prf#2719 AS o_clerk_prf_3#2729, o_orderstatus_prf#2720 AS o_orderstatus_prf_3#2730, o_totalprice_prf#2721 AS o_totalprice_prf_3#2731, o_orderkey_prf#2722 AS o_orderkey_prf_3#2732, o_comment_prf#2723 AS o_comment_prf_3#2733]
               +- Relation[o_shippriority_prf#2714,rid#2715,o_orderdate_prf#2716,o_custkey_prf#2717,o_orderpriority_prf#2718,o_clerk_prf#2719,o_orderstatus_prf#2720,o_totalprice_prf#2721,o_orderkey_prf#2722,o_comment_prf#2723] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 172597ms

fr2b=
select * from lineitem, orders, customer where o_custkey = c_custkey and o_orderstatus = 'F' and l_orderkey = o_orderkey
19/10/16 21:27:29 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:27:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2818L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 21:27:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2818L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#2820 AS l_returnflag_prf_0#2839, l_orderkey_and_l_linenumber_prf#2821 AS l_orderkey_and_l_linenumber_prf_0#2840, l_comment_prf#2822 AS l_comment_prf_0#2841, l_linestatus_prf#2823 AS l_linestatus_prf_0#2842, rid#2824 AS rid_0#2843, l_shipmode_prf#2825 AS l_shipmode_prf_0#2844, l_shipinstruct_prf#2826 AS l_shipinstruct_prf_0#2845, l_quantity_prf#2827 AS l_quantity_prf_0#2846, l_receiptdate_prf#2828 AS l_receiptdate_prf_0#2847, l_linenumber_prf#2829 AS l_linenumber_prf_0#2848, l_tax_prf#2830 AS l_tax_prf_0#2849, l_shipdate_prf#2831 AS l_shipdate_prf_0#2850, l_extendedprice_prf#2832 AS l_extendedprice_prf_0#2851, l_partkey_prf#2833 AS l_partkey_prf_0#2852, l_discount_prf#2834 AS l_discount_prf_0#2853, l_partkey_and_l_suppkey_prf#2835 AS l_partkey_and_l_suppkey_prf_0#2854, l_commitdate_prf#2836 AS l_commitdate_prf_0#2855, l_suppkey_prf#2837 AS l_suppkey_prf_0#2856, l_orderkey_prf#2838 AS l_orderkey_prf_0#2857]
         :  :  +- Relation[l_returnflag_prf#2820,l_orderkey_and_l_linenumber_prf#2821,l_comment_prf#2822,l_linestatus_prf#2823,rid#2824,l_shipmode_prf#2825,l_shipinstruct_prf#2826,l_quantity_prf#2827,l_receiptdate_prf#2828,l_linenumber_prf#2829,l_tax_prf#2830,l_shipdate_prf#2831,l_extendedprice_prf#2832,l_partkey_prf#2833,l_discount_prf#2834,l_partkey_and_l_suppkey_prf#2835,l_commitdate_prf#2836,l_suppkey_prf#2837,l_orderkey_prf#2838] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#2878]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2877]
         :        :  +- Relation[l_returnflag_prf#2858,l_orderkey_and_l_linenumber_prf#2859,l_comment_prf#2860,l_linestatus_prf#2861,rid#2862,l_shipmode_prf#2863,l_shipinstruct_prf#2864,l_quantity_prf#2865,l_receiptdate_prf#2866,l_linenumber_prf#2867,l_tax_prf#2868,l_shipdate_prf#2869,l_extendedprice_prf#2870,l_partkey_prf#2871,l_discount_prf#2872,l_partkey_and_l_suppkey_prf#2873,l_commitdate_prf#2874,l_suppkey_prf#2875,l_orderkey_prf#2876] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#2900]
            :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#2890: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#2879 AS o_shippriority_prf_1#2889, rid#2880 AS rid_1#2890, o_orderdate_prf#2881 AS o_orderdate_prf_1#2891, o_custkey_prf#2882 AS o_custkey_prf_1#2892, o_orderpriority_prf#2883 AS o_orderpriority_prf_1#2893, o_clerk_prf#2884 AS o_clerk_prf_1#2894, o_orderstatus_prf#2885 AS o_orderstatus_prf_1#2895, o_totalprice_prf#2886 AS o_totalprice_prf_1#2896, o_orderkey_prf#2887 AS o_orderkey_prf_1#2897, o_comment_prf#2888 AS o_comment_prf_1#2898]
            :     :  :  +- Relation[o_shippriority_prf#2879,rid#2880,o_orderdate_prf#2881,o_custkey_prf#2882,o_orderpriority_prf#2883,o_clerk_prf#2884,o_orderstatus_prf#2885,o_totalprice_prf#2886,o_orderkey_prf#2887,o_comment_prf#2888] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2899]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#2901 AS c_acctbal_prf_2#2910, rid#2902 AS rid_2#2911, c_name_prf#2903 AS c_name_prf_2#2912, c_nationkey_prf#2904 AS c_nationkey_prf_2#2913, c_custkey_prf#2905 AS c_custkey_prf_2#2914, c_comment_prf#2906 AS c_comment_prf_2#2915, c_address_prf#2907 AS c_address_prf_2#2916, c_mktsegment_prf#2908 AS c_mktsegment_prf_2#2917, c_phone_prf#2909 AS c_phone_prf_2#2918]
               +- Relation[c_acctbal_prf#2901,rid#2902,c_name_prf#2903,c_nationkey_prf#2904,c_custkey_prf#2905,c_comment_prf#2906,c_address_prf#2907,c_mktsegment_prf#2908,c_phone_prf#2909] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 105319ms

ft2b=
select * from part, partsupp, supplier where p_size = 15 and p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/16 21:29:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:29:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2981L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 21:29:14 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 21:29:14 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 21:29:14 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 21:29:14 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:29:14 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:29:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2981L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#3019]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#3004]
         :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2995: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [p_comment_prf#2983 AS p_comment_prf_0#2993, p_name_prf#2984 AS p_name_prf_0#2994, rid#2985 AS rid_0#2995, p_type_prf#2986 AS p_type_prf_0#2996, p_retailprice_prf#2987 AS p_retailprice_prf_0#2997, p_mfgr_prf#2988 AS p_mfgr_prf_0#2998, p_container_prf#2989 AS p_container_prf_0#2999, p_brand_prf#2990 AS p_brand_prf_0#3000, p_size_prf#2991 AS p_size_prf_0#3001, p_partkey_prf#2992 AS p_partkey_prf_0#3002]
         :     :  :     :  :  +- Relation[p_comment_prf#2983,p_name_prf#2984,rid#2985,p_type_prf#2986,p_retailprice_prf#2987,p_mfgr_prf#2988,p_container_prf#2989,p_brand_prf#2990,p_size_prf#2991,p_partkey_prf#2992] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3003]
         :     :  :     :     +- DexRidFilter part~p_size~15
         :     :  :     :        +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#3005 AS ps_partkey_and_ps_suppkey_prf_1#3012, rid#3006 AS rid_1#3013, ps_availqty_prf#3007 AS ps_availqty_prf_1#3014, ps_comment_prf#3008 AS ps_comment_prf_1#3015, ps_partkey_prf#3009 AS ps_partkey_prf_1#3016, ps_supplycost_prf#3010 AS ps_supplycost_prf_1#3017, ps_suppkey_prf#3011 AS ps_suppkey_prf_1#3018]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#3005,rid#3006,ps_availqty_prf#3007,ps_comment_prf#3008,ps_partkey_prf#3009,ps_supplycost_prf#3010,ps_suppkey_prf#3011] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3020 AS s_phone_prf_2#3028, rid#3021 AS rid_2#3029, s_address_prf#3022 AS s_address_prf_2#3030, s_nationkey_prf#3023 AS s_nationkey_prf_2#3031, s_suppkey_prf#3024 AS s_suppkey_prf_2#3032, s_name_prf#3025 AS s_name_prf_2#3033, s_acctbal_prf#3026 AS s_acctbal_prf_2#3034, s_comment_prf#3027 AS s_comment_prf_2#3035]
            +- Relation[s_phone_prf#3020,rid#3021,s_address_prf#3022,s_nationkey_prf#3023,s_suppkey_prf#3024,s_name_prf#3025,s_acctbal_prf#3026,s_comment_prf#3027] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 924ms

fq1d=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 21:29:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:29:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3101L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :     :- Project [n_nationkey#108L]
               :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
               :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 21:29:15 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:29:15 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:29:15 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:29:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3101L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#3103 AS l_returnflag_prf_0#3122, l_orderkey_and_l_linenumber_prf#3104 AS l_orderkey_and_l_linenumber_prf_0#3123, l_comment_prf#3105 AS l_comment_prf_0#3124, l_linestatus_prf#3106 AS l_linestatus_prf_0#3125, rid#3107 AS rid_0#3126, l_shipmode_prf#3108 AS l_shipmode_prf_0#3127, l_shipinstruct_prf#3109 AS l_shipinstruct_prf_0#3128, l_quantity_prf#3110 AS l_quantity_prf_0#3129, l_receiptdate_prf#3111 AS l_receiptdate_prf_0#3130, l_linenumber_prf#3112 AS l_linenumber_prf_0#3131, l_tax_prf#3113 AS l_tax_prf_0#3132, l_shipdate_prf#3114 AS l_shipdate_prf_0#3133, l_extendedprice_prf#3115 AS l_extendedprice_prf_0#3134, l_partkey_prf#3116 AS l_partkey_prf_0#3135, l_discount_prf#3117 AS l_discount_prf_0#3136, l_partkey_and_l_suppkey_prf#3118 AS l_partkey_and_l_suppkey_prf_0#3137, l_commitdate_prf#3119 AS l_commitdate_prf_0#3138, l_suppkey_prf#3120 AS l_suppkey_prf_0#3139, l_orderkey_prf#3121 AS l_orderkey_prf_0#3140]
         :  :  +- Relation[l_returnflag_prf#3103,l_orderkey_and_l_linenumber_prf#3104,l_comment_prf#3105,l_linestatus_prf#3106,rid#3107,l_shipmode_prf#3108,l_shipinstruct_prf#3109,l_quantity_prf#3110,l_receiptdate_prf#3111,l_linenumber_prf#3112,l_tax_prf#3113,l_shipdate_prf#3114,l_extendedprice_prf#3115,l_partkey_prf#3116,l_discount_prf#3117,l_partkey_and_l_suppkey_prf#3118,l_commitdate_prf#3119,l_suppkey_prf#3120,l_orderkey_prf#3121] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2124) AS rid_3#3161]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3160]
         :        :  +- Relation[l_returnflag_prf#3141,l_orderkey_and_l_linenumber_prf#3142,l_comment_prf#3143,l_linestatus_prf#3144,rid#3145,l_shipmode_prf#3146,l_shipinstruct_prf#3147,l_quantity_prf#3148,l_receiptdate_prf#3149,l_linenumber_prf#3150,l_tax_prf#3151,l_shipdate_prf#3152,l_extendedprice_prf#3153,l_partkey_prf#3154,l_discount_prf#3155,l_partkey_and_l_suppkey_prf#3156,l_commitdate_prf#3157,l_suppkey_prf#3158,l_orderkey_prf#3159] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, 'rid_2, 'c_acctbal_prf_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2124) AS rid_3#3192]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_2
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#3173]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_1#3167: string
            :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :     :  :- Project [rid#3162 AS rid_1#3167, n_regionkey_prf#3163 AS n_regionkey_prf_1#3168, n_nationkey_prf#3164 AS n_nationkey_prf_1#3169, n_name_prf#3165 AS n_name_prf_1#3170, n_comment_prf#3166 AS n_comment_prf_1#3171]
            :     :  :     :  :  +- Relation[rid#3162,n_regionkey_prf#3163,n_nationkey_prf#3164,n_name_prf#3165,n_comment_prf#3166] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3172]
            :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :  :     :        +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [c_acctbal_prf#3174 AS c_acctbal_prf_2#3183, rid#3175 AS rid_2#3184, c_name_prf#3176 AS c_name_prf_2#3185, c_nationkey_prf#3177 AS c_nationkey_prf_2#3186, c_custkey_prf#3178 AS c_custkey_prf_2#3187, c_comment_prf#3179 AS c_comment_prf_2#3188, c_address_prf#3180 AS c_address_prf_2#3189, c_mktsegment_prf#3181 AS c_mktsegment_prf_2#3190, c_phone_prf#3182 AS c_phone_prf_2#3191]
            :     :     +- Relation[c_acctbal_prf#3174,rid#3175,c_name_prf#3176,c_nationkey_prf#3177,c_custkey_prf#3178,c_comment_prf#3179,c_address_prf#3180,c_mktsegment_prf#3181,c_phone_prf#3182] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3193 AS o_shippriority_prf_3#3203, rid#3194 AS rid_3#3204, o_orderdate_prf#3195 AS o_orderdate_prf_3#3205, o_custkey_prf#3196 AS o_custkey_prf_3#3206, o_orderpriority_prf#3197 AS o_orderpriority_prf_3#3207, o_clerk_prf#3198 AS o_clerk_prf_3#3208, o_orderstatus_prf#3199 AS o_orderstatus_prf_3#3209, o_totalprice_prf#3200 AS o_totalprice_prf_3#3210, o_orderkey_prf#3201 AS o_orderkey_prf_3#3211, o_comment_prf#3202 AS o_comment_prf_3#3212]
               +- Relation[o_shippriority_prf#3193,rid#3194,o_orderdate_prf#3195,o_custkey_prf#3196,o_orderpriority_prf#3197,o_clerk_prf#3198,o_orderstatus_prf#3199,o_totalprice_prf#3200,o_orderkey_prf#3201,o_comment_prf#3202] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 74211ms

fs1a=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/16 21:30:29 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:30:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3301L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [c_custkey#290L]
         :     :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L]
         :        +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/16 21:30:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:30:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:30:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:30:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3301L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, 'rid_2, 'l_returnflag_prf_2, 'l_orderkey_and_l_linenumber_prf_2, 'l_comment_prf_2, 'l_linestatus_prf_2, ... 15 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#3343]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#3322]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3313: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [c_acctbal_prf#3303 AS c_acctbal_prf_0#3312, rid#3304 AS rid_0#3313, c_name_prf#3305 AS c_name_prf_0#3314, c_nationkey_prf#3306 AS c_nationkey_prf_0#3315, c_custkey_prf#3307 AS c_custkey_prf_0#3316, c_comment_prf#3308 AS c_comment_prf_0#3317, c_address_prf#3309 AS c_address_prf_0#3318, c_mktsegment_prf#3310 AS c_mktsegment_prf_0#3319, c_phone_prf#3311 AS c_phone_prf_0#3320]
         :     :  :     :  :     :  :  +- Relation[c_acctbal_prf#3303,rid#3304,c_name_prf#3305,c_nationkey_prf#3306,c_custkey_prf#3307,c_comment_prf#3308,c_address_prf#3309,c_mktsegment_prf#3310,c_phone_prf#3311] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3321]
         :     :  :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :  :     :        +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [o_shippriority_prf#3323 AS o_shippriority_prf_1#3333, rid#3324 AS rid_1#3334, o_orderdate_prf#3325 AS o_orderdate_prf_1#3335, o_custkey_prf#3326 AS o_custkey_prf_1#3336, o_orderpriority_prf#3327 AS o_orderpriority_prf_1#3337, o_clerk_prf#3328 AS o_clerk_prf_1#3338, o_orderstatus_prf#3329 AS o_orderstatus_prf_1#3339, o_totalprice_prf#3330 AS o_totalprice_prf_1#3340, o_orderkey_prf#3331 AS o_orderkey_prf_1#3341, o_comment_prf#3332 AS o_comment_prf_1#3342]
         :     :  :     :     +- Relation[o_shippriority_prf#3323,rid#3324,o_orderdate_prf#3325,o_custkey_prf#3326,o_orderpriority_prf#3327,o_clerk_prf#3328,o_orderstatus_prf#3329,o_totalprice_prf#3330,o_orderkey_prf#3331,o_comment_prf#3332] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#3344 AS l_returnflag_prf_2#3363, l_orderkey_and_l_linenumber_prf#3345 AS l_orderkey_and_l_linenumber_prf_2#3364, l_comment_prf#3346 AS l_comment_prf_2#3365, l_linestatus_prf#3347 AS l_linestatus_prf_2#3366, rid#3348 AS rid_2#3367, l_shipmode_prf#3349 AS l_shipmode_prf_2#3368, l_shipinstruct_prf#3350 AS l_shipinstruct_prf_2#3369, l_quantity_prf#3351 AS l_quantity_prf_2#3370, l_receiptdate_prf#3352 AS l_receiptdate_prf_2#3371, l_linenumber_prf#3353 AS l_linenumber_prf_2#3372, l_tax_prf#3354 AS l_tax_prf_2#3373, l_shipdate_prf#3355 AS l_shipdate_prf_2#3374, l_extendedprice_prf#3356 AS l_extendedprice_prf_2#3375, l_partkey_prf#3357 AS l_partkey_prf_2#3376, l_discount_prf#3358 AS l_discount_prf_2#3377, l_partkey_and_l_suppkey_prf#3359 AS l_partkey_and_l_suppkey_prf_2#3378, l_commitdate_prf#3360 AS l_commitdate_prf_2#3379, l_suppkey_prf#3361 AS l_suppkey_prf_2#3380, l_orderkey_prf#3362 AS l_orderkey_prf_2#3381]
         :     :     +- Relation[l_returnflag_prf#3344,l_orderkey_and_l_linenumber_prf#3345,l_comment_prf#3346,l_linestatus_prf#3347,rid#3348,l_shipmode_prf#3349,l_shipinstruct_prf#3350,l_quantity_prf#3351,l_receiptdate_prf#3352,l_linenumber_prf#3353,l_tax_prf#3354,l_shipdate_prf#3355,l_extendedprice_prf#3356,l_partkey_prf#3357,l_discount_prf#3358,l_partkey_and_l_suppkey_prf#3359,l_commitdate_prf#3360,l_suppkey_prf#3361,l_orderkey_prf#3362] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#3383 AS p_comment_prf_3#3393, p_name_prf#3384 AS p_name_prf_3#3394, rid#3385 AS rid_3#3395, p_type_prf#3386 AS p_type_prf_3#3396, p_retailprice_prf#3387 AS p_retailprice_prf_3#3397, p_mfgr_prf#3388 AS p_mfgr_prf_3#3398, p_container_prf#3389 AS p_container_prf_3#3399, p_brand_prf#3390 AS p_brand_prf_3#3400, p_size_prf#3391 AS p_size_prf_3#3401, p_partkey_prf#3392 AS p_partkey_prf_3#3402]
            +- Relation[p_comment_prf#3383,p_name_prf#3384,rid#3385,p_type_prf#3386,p_retailprice_prf#3387,p_mfgr_prf#3388,p_container_prf#3389,p_brand_prf#3390,p_size_prf#3391,p_partkey_prf#3392] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 107926ms

ft1b=
select * from nation, supplier, customer where n_name = 'FRANCE' and n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/16 21:32:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:32:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3473L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 21:32:17 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:32:17 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:32:17 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:32:17 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:32:17 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:32:17 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:32:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3473L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#3503]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#3486]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#3480: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#3475 AS rid_0#3480, n_regionkey_prf#3476 AS n_regionkey_prf_0#3481, n_nationkey_prf#3477 AS n_nationkey_prf_0#3482, n_name_prf#3478 AS n_name_prf_0#3483, n_comment_prf#3479 AS n_comment_prf_0#3484]
         :     :  :     :  :  +- Relation[rid#3475,n_regionkey_prf#3476,n_nationkey_prf#3477,n_name_prf#3478,n_comment_prf#3479] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3485]
         :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :        +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#3487 AS s_phone_prf_1#3495, rid#3488 AS rid_1#3496, s_address_prf#3489 AS s_address_prf_1#3497, s_nationkey_prf#3490 AS s_nationkey_prf_1#3498, s_suppkey_prf#3491 AS s_suppkey_prf_1#3499, s_name_prf#3492 AS s_name_prf_1#3500, s_acctbal_prf#3493 AS s_acctbal_prf_1#3501, s_comment_prf#3494 AS s_comment_prf_1#3502]
         :     :     +- Relation[s_phone_prf#3487,rid#3488,s_address_prf#3489,s_nationkey_prf#3490,s_suppkey_prf#3491,s_name_prf#3492,s_acctbal_prf#3493,s_comment_prf#3494] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3504 AS c_acctbal_prf_2#3513, rid#3505 AS rid_2#3514, c_name_prf#3506 AS c_name_prf_2#3515, c_nationkey_prf#3507 AS c_nationkey_prf_2#3516, c_custkey_prf#3508 AS c_custkey_prf_2#3517, c_comment_prf#3509 AS c_comment_prf_2#3518, c_address_prf#3510 AS c_address_prf_2#3519, c_mktsegment_prf#3511 AS c_mktsegment_prf_2#3520, c_phone_prf#3512 AS c_phone_prf_2#3521]
            +- Relation[c_acctbal_prf#3504,rid#3505,c_name_prf#3506,c_nationkey_prf#3507,c_custkey_prf#3508,c_comment_prf#3509,c_address_prf#3510,c_mktsegment_prf#3511,c_phone_prf#3512] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 30036ms

ft1d=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/16 21:32:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:32:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3566L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_nationkey#21L]
                  +- Filter isnotnull(s_nationkey#21L)
                     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 21:32:47 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:32:47 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:32:47 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:32:47 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:32:47 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:32:47 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:32:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3566L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#3568 AS c_acctbal_prf_0#3577, rid#3569 AS rid_0#3578, c_name_prf#3570 AS c_name_prf_0#3579, c_nationkey_prf#3571 AS c_nationkey_prf_0#3580, c_custkey_prf#3572 AS c_custkey_prf_0#3581, c_comment_prf#3573 AS c_comment_prf_0#3582, c_address_prf#3574 AS c_address_prf_0#3583, c_mktsegment_prf#3575 AS c_mktsegment_prf_0#3584, c_phone_prf#3576 AS c_phone_prf_0#3585]
         :  :  +- Relation[c_acctbal_prf#3568,rid#3569,c_name_prf#3570,c_nationkey_prf#3571,c_custkey_prf#3572,c_comment_prf#3573,c_address_prf#3574,c_mktsegment_prf#3575,c_phone_prf#3576] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#3596]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3595]
         :        :  +- Relation[c_acctbal_prf#3586,rid#3587,c_name_prf#3588,c_nationkey_prf#3589,c_custkey_prf#3590,c_comment_prf#3591,c_address_prf#3592,c_mktsegment_prf#3593,c_phone_prf#3594] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#3608]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_1#3602: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [rid#3597 AS rid_1#3602, n_regionkey_prf#3598 AS n_regionkey_prf_1#3603, n_nationkey_prf#3599 AS n_nationkey_prf_1#3604, n_name_prf#3600 AS n_name_prf_1#3605, n_comment_prf#3601 AS n_comment_prf_1#3606]
            :     :  :  +- Relation[rid#3597,n_regionkey_prf#3598,n_nationkey_prf#3599,n_name_prf#3600,n_comment_prf#3601] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3607]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [s_phone_prf#3609 AS s_phone_prf_2#3617, rid#3610 AS rid_2#3618, s_address_prf#3611 AS s_address_prf_2#3619, s_nationkey_prf#3612 AS s_nationkey_prf_2#3620, s_suppkey_prf#3613 AS s_suppkey_prf_2#3621, s_name_prf#3614 AS s_name_prf_2#3622, s_acctbal_prf#3615 AS s_acctbal_prf_2#3623, s_comment_prf#3616 AS s_comment_prf_2#3624]
               +- Relation[s_phone_prf#3609,rid#3610,s_address_prf#3611,s_nationkey_prf#3612,s_suppkey_prf#3613,s_name_prf#3614,s_acctbal_prf#3615,s_comment_prf#3616] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 24126ms

fr1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and (l_orderkey = o_orderkey and c_mktsegment = 'BUILDING')
19/10/16 21:33:11 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:33:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3683L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 21:33:11 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:33:11 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:33:11 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:33:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3683L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#3685 AS l_returnflag_prf_0#3704, l_orderkey_and_l_linenumber_prf#3686 AS l_orderkey_and_l_linenumber_prf_0#3705, l_comment_prf#3687 AS l_comment_prf_0#3706, l_linestatus_prf#3688 AS l_linestatus_prf_0#3707, rid#3689 AS rid_0#3708, l_shipmode_prf#3690 AS l_shipmode_prf_0#3709, l_shipinstruct_prf#3691 AS l_shipinstruct_prf_0#3710, l_quantity_prf#3692 AS l_quantity_prf_0#3711, l_receiptdate_prf#3693 AS l_receiptdate_prf_0#3712, l_linenumber_prf#3694 AS l_linenumber_prf_0#3713, l_tax_prf#3695 AS l_tax_prf_0#3714, l_shipdate_prf#3696 AS l_shipdate_prf_0#3715, l_extendedprice_prf#3697 AS l_extendedprice_prf_0#3716, l_partkey_prf#3698 AS l_partkey_prf_0#3717, l_discount_prf#3699 AS l_discount_prf_0#3718, l_partkey_and_l_suppkey_prf#3700 AS l_partkey_and_l_suppkey_prf_0#3719, l_commitdate_prf#3701 AS l_commitdate_prf_0#3720, l_suppkey_prf#3702 AS l_suppkey_prf_0#3721, l_orderkey_prf#3703 AS l_orderkey_prf_0#3722]
         :  :  +- Relation[l_returnflag_prf#3685,l_orderkey_and_l_linenumber_prf#3686,l_comment_prf#3687,l_linestatus_prf#3688,rid#3689,l_shipmode_prf#3690,l_shipinstruct_prf#3691,l_quantity_prf#3692,l_receiptdate_prf#3693,l_linenumber_prf#3694,l_tax_prf#3695,l_shipdate_prf#3696,l_extendedprice_prf#3697,l_partkey_prf#3698,l_discount_prf#3699,l_partkey_and_l_suppkey_prf#3700,l_commitdate_prf#3701,l_suppkey_prf#3702,l_orderkey_prf#3703] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#3743]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3742]
         :        :  +- Relation[l_returnflag_prf#3723,l_orderkey_and_l_linenumber_prf#3724,l_comment_prf#3725,l_linestatus_prf#3726,rid#3727,l_shipmode_prf#3728,l_shipinstruct_prf#3729,l_quantity_prf#3730,l_receiptdate_prf#3731,l_linenumber_prf#3732,l_tax_prf#3733,l_shipdate_prf#3734,l_extendedprice_prf#3735,l_partkey_prf#3736,l_discount_prf#3737,l_partkey_and_l_suppkey_prf#3738,l_commitdate_prf#3739,l_suppkey_prf#3740,l_orderkey_prf#3741] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [o_shippriority_prf#3744 AS o_shippriority_prf_1#3754, rid#3745 AS rid_1#3755, o_orderdate_prf#3746 AS o_orderdate_prf_1#3756, o_custkey_prf#3747 AS o_custkey_prf_1#3757, o_orderpriority_prf#3748 AS o_orderpriority_prf_1#3758, o_clerk_prf#3749 AS o_clerk_prf_1#3759, o_orderstatus_prf#3750 AS o_orderstatus_prf_1#3760, o_totalprice_prf#3751 AS o_totalprice_prf_1#3761, o_orderkey_prf#3752 AS o_orderkey_prf_1#3762, o_comment_prf#3753 AS o_comment_prf_1#3763]
            :  :  +- Relation[o_shippriority_prf#3744,rid#3745,o_orderdate_prf#3746,o_custkey_prf#3747,o_orderpriority_prf#3748,o_clerk_prf#3749,o_orderstatus_prf#3750,o_totalprice_prf#3751,o_orderkey_prf#3752,o_comment_prf#3753] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#3775]
            :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#3774]
            :        :  +- Relation[o_shippriority_prf#3764,rid#3765,o_orderdate_prf#3766,o_custkey_prf#3767,o_orderpriority_prf#3768,o_clerk_prf#3769,o_orderstatus_prf#3770,o_totalprice_prf#3771,o_orderkey_prf#3772,o_comment_prf#3773] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [c_acctbal_prf#3776 AS c_acctbal_prf_2#3785, rid#3777 AS rid_2#3786, c_name_prf#3778 AS c_name_prf_2#3787, c_nationkey_prf#3779 AS c_nationkey_prf_2#3788, c_custkey_prf#3780 AS c_custkey_prf_2#3789, c_comment_prf#3781 AS c_comment_prf_2#3790, c_address_prf#3782 AS c_address_prf_2#3791, c_mktsegment_prf#3783 AS c_mktsegment_prf_2#3792, c_phone_prf#3784 AS c_phone_prf_2#3793]
               :  +- Relation[c_acctbal_prf#3776,rid#3777,c_name_prf#3778,c_nationkey_prf#3779,c_custkey_prf#3780,c_comment_prf#3781,c_address_prf#3782,c_mktsegment_prf#3783,c_phone_prf#3784] JDBCRelation(customer_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#3794]
                  +- DexRidFilter customer~c_mktsegment~BUILDING
                     +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 121112ms

ft2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and (p_size = 15 and s_suppkey = ps_suppkey)
19/10/16 21:35:12 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:35:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3857L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/16 21:35:12 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:35:12 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:35:12 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 21:35:12 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:35:12 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 21:35:12 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 21:35:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3857L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#3859 AS s_phone_prf_0#3867, rid#3860 AS rid_0#3868, s_address_prf#3861 AS s_address_prf_0#3869, s_nationkey_prf#3862 AS s_nationkey_prf_0#3870, s_suppkey_prf#3863 AS s_suppkey_prf_0#3871, s_name_prf#3864 AS s_name_prf_0#3872, s_acctbal_prf#3865 AS s_acctbal_prf_0#3873, s_comment_prf#3866 AS s_comment_prf_0#3874]
         :  :  +- Relation[s_phone_prf#3859,rid#3860,s_address_prf#3861,s_nationkey_prf#3862,s_suppkey_prf#3863,s_name_prf#3864,s_acctbal_prf#3865,s_comment_prf#3866] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2124) AS rid_2#3884]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3883]
         :        :  +- Relation[s_phone_prf#3875,rid#3876,s_address_prf#3877,s_nationkey_prf#3878,s_suppkey_prf#3879,s_name_prf#3880,s_acctbal_prf#3881,s_comment_prf#3882] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#3906]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#3897: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#3885 AS p_comment_prf_1#3895, p_name_prf#3886 AS p_name_prf_1#3896, rid#3887 AS rid_1#3897, p_type_prf#3888 AS p_type_prf_1#3898, p_retailprice_prf#3889 AS p_retailprice_prf_1#3899, p_mfgr_prf#3890 AS p_mfgr_prf_1#3900, p_container_prf#3891 AS p_container_prf_1#3901, p_brand_prf#3892 AS p_brand_prf_1#3902, p_size_prf#3893 AS p_size_prf_1#3903, p_partkey_prf#3894 AS p_partkey_prf_1#3904]
            :     :  :  +- Relation[p_comment_prf#3885,p_name_prf#3886,rid#3887,p_type_prf#3888,p_retailprice_prf#3889,p_mfgr_prf#3890,p_container_prf#3891,p_brand_prf#3892,p_size_prf#3893,p_partkey_prf#3894] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3905]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#3907 AS ps_partkey_and_ps_suppkey_prf_2#3914, rid#3908 AS rid_2#3915, ps_availqty_prf#3909 AS ps_availqty_prf_2#3916, ps_comment_prf#3910 AS ps_comment_prf_2#3917, ps_partkey_prf#3911 AS ps_partkey_prf_2#3918, ps_supplycost_prf#3912 AS ps_supplycost_prf_2#3919, ps_suppkey_prf#3913 AS ps_suppkey_prf_2#3920]
               +- Relation[ps_partkey_and_ps_suppkey_prf#3907,rid#3908,ps_availqty_prf#3909,ps_comment_prf#3910,ps_partkey_prf#3911,ps_supplycost_prf#3912,ps_suppkey_prf#3913] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 6993ms

fr2a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_orderstatus = 'F' and o_custkey = c_custkey
19/10/16 21:35:19 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:35:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3982L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 21:35:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3982L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [l_returnflag_prf#3984 AS l_returnflag_prf_0#4003, l_orderkey_and_l_linenumber_prf#3985 AS l_orderkey_and_l_linenumber_prf_0#4004, l_comment_prf#3986 AS l_comment_prf_0#4005, l_linestatus_prf#3987 AS l_linestatus_prf_0#4006, rid#3988 AS rid_0#4007, l_shipmode_prf#3989 AS l_shipmode_prf_0#4008, l_shipinstruct_prf#3990 AS l_shipinstruct_prf_0#4009, l_quantity_prf#3991 AS l_quantity_prf_0#4010, l_receiptdate_prf#3992 AS l_receiptdate_prf_0#4011, l_linenumber_prf#3993 AS l_linenumber_prf_0#4012, l_tax_prf#3994 AS l_tax_prf_0#4013, l_shipdate_prf#3995 AS l_shipdate_prf_0#4014, l_extendedprice_prf#3996 AS l_extendedprice_prf_0#4015, l_partkey_prf#3997 AS l_partkey_prf_0#4016, l_discount_prf#3998 AS l_discount_prf_0#4017, l_partkey_and_l_suppkey_prf#3999 AS l_partkey_and_l_suppkey_prf_0#4018, l_commitdate_prf#4000 AS l_commitdate_prf_0#4019, l_suppkey_prf#4001 AS l_suppkey_prf_0#4020, l_orderkey_prf#4002 AS l_orderkey_prf_0#4021]
         :     :  :  :  +- Relation[l_returnflag_prf#3984,l_orderkey_and_l_linenumber_prf#3985,l_comment_prf#3986,l_linestatus_prf#3987,rid#3988,l_shipmode_prf#3989,l_shipinstruct_prf#3990,l_quantity_prf#3991,l_receiptdate_prf#3992,l_linenumber_prf#3993,l_tax_prf#3994,l_shipdate_prf#3995,l_extendedprice_prf#3996,l_partkey_prf#3997,l_discount_prf#3998,l_partkey_and_l_suppkey_prf#3999,l_commitdate_prf#4000,l_suppkey_prf#4001,l_orderkey_prf#4002] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#4042]
         :     :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#4041]
         :     :  :        :  +- Relation[l_returnflag_prf#4022,l_orderkey_and_l_linenumber_prf#4023,l_comment_prf#4024,l_linestatus_prf#4025,rid#4026,l_shipmode_prf#4027,l_shipinstruct_prf#4028,l_quantity_prf#4029,l_receiptdate_prf#4030,l_linenumber_prf#4031,l_tax_prf#4032,l_shipdate_prf#4033,l_extendedprice_prf#4034,l_partkey_prf#4035,l_discount_prf#4036,l_partkey_and_l_suppkey_prf#4037,l_commitdate_prf#4038,l_suppkey_prf#4039,l_orderkey_prf#4040] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [o_shippriority_prf#4043 AS o_shippriority_prf_1#4053, rid#4044 AS rid_1#4054, o_orderdate_prf#4045 AS o_orderdate_prf_1#4055, o_custkey_prf#4046 AS o_custkey_prf_1#4056, o_orderpriority_prf#4047 AS o_orderpriority_prf_1#4057, o_clerk_prf#4048 AS o_clerk_prf_1#4058, o_orderstatus_prf#4049 AS o_orderstatus_prf_1#4059, o_totalprice_prf#4050 AS o_totalprice_prf_1#4060, o_orderkey_prf#4051 AS o_orderkey_prf_1#4061, o_comment_prf#4052 AS o_comment_prf_1#4062]
         :     :     :  +- Relation[o_shippriority_prf#4043,rid#4044,o_orderdate_prf#4045,o_custkey_prf#4046,o_orderpriority_prf#4047,o_clerk_prf#4048,o_orderstatus_prf#4049,o_totalprice_prf#4050,o_orderkey_prf#4051,o_comment_prf#4052] JDBCRelation(orders_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4063]
         :     :        +- DexRidFilter orders~o_orderstatus~F
         :     :           +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4065 AS c_acctbal_prf_2#4074, rid#4066 AS rid_2#4075, c_name_prf#4067 AS c_name_prf_2#4076, c_nationkey_prf#4068 AS c_nationkey_prf_2#4077, c_custkey_prf#4069 AS c_custkey_prf_2#4078, c_comment_prf#4070 AS c_comment_prf_2#4079, c_address_prf#4071 AS c_address_prf_2#4080, c_mktsegment_prf#4072 AS c_mktsegment_prf_2#4081, c_phone_prf#4073 AS c_phone_prf_2#4082]
            +- Relation[c_acctbal_prf#4065,rid#4066,c_name_prf#4067,c_nationkey_prf#4068,c_custkey_prf#4069,c_comment_prf#4070,c_address_prf#4071,c_mktsegment_prf#4072,c_phone_prf#4073] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 193180ms

fq1c=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 21:38:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:38:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4161L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [c_nationkey#293L, o_orderkey#342L]
               :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :     :- Project [c_custkey#290L, c_nationkey#293L]
               :     :  +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
               :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               :     +- Project [o_orderkey#342L, o_custkey#343L]
               :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 21:38:33 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:38:33 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:38:33 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:38:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4161L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#4174]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#4168: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [rid#4163 AS rid_0#4168, n_regionkey_prf#4164 AS n_regionkey_prf_0#4169, n_nationkey_prf#4165 AS n_nationkey_prf_0#4170, n_name_prf#4166 AS n_name_prf_0#4171, n_comment_prf#4167 AS n_comment_prf_0#4172]
         :     :  :  +- Relation[rid#4163,n_regionkey_prf#4164,n_nationkey_prf#4165,n_name_prf#4166,n_comment_prf#4167] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4173]
         :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :        +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join NaturalJoin(Inner)
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- Project [c_acctbal_prf#4175 AS c_acctbal_prf_1#4184, rid#4176 AS rid_1#4185, c_name_prf#4177 AS c_name_prf_1#4186, c_nationkey_prf#4178 AS c_nationkey_prf_1#4187, c_custkey_prf#4179 AS c_custkey_prf_1#4188, c_comment_prf#4180 AS c_comment_prf_1#4189, c_address_prf#4181 AS c_address_prf_1#4190, c_mktsegment_prf#4182 AS c_mktsegment_prf_1#4191, c_phone_prf#4183 AS c_phone_prf_1#4192]
            :  :  :  :  +- Relation[c_acctbal_prf#4175,rid#4176,c_name_prf#4177,c_nationkey_prf#4178,c_custkey_prf#4179,c_comment_prf#4180,c_address_prf#4181,c_mktsegment_prf#4182,c_phone_prf#4183] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#4203]
            :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
            :  :  :        :- 'Project ['rid AS rid_1#4202]
            :  :  :        :  +- Relation[c_acctbal_prf#4193,rid#4194,c_name_prf#4195,c_nationkey_prf#4196,c_custkey_prf#4197,c_comment_prf#4198,c_address_prf#4199,c_mktsegment_prf#4200,c_phone_prf#4201] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
            :  :  +- Project [o_shippriority_prf#4204 AS o_shippriority_prf_2#4214, rid#4205 AS rid_2#4215, o_orderdate_prf#4206 AS o_orderdate_prf_2#4216, o_custkey_prf#4207 AS o_custkey_prf_2#4217, o_orderpriority_prf#4208 AS o_orderpriority_prf_2#4218, o_clerk_prf#4209 AS o_clerk_prf_2#4219, o_orderstatus_prf#4210 AS o_orderstatus_prf_2#4220, o_totalprice_prf#4211 AS o_totalprice_prf_2#4221, o_orderkey_prf#4212 AS o_orderkey_prf_2#4222, o_comment_prf#4213 AS o_comment_prf_2#4223]
            :  :     +- Relation[o_shippriority_prf#4204,rid#4205,o_orderdate_prf#4206,o_custkey_prf#4207,o_orderpriority_prf#4208,o_clerk_prf#4209,o_orderstatus_prf#4210,o_totalprice_prf#4211,o_orderkey_prf#4212,o_comment_prf#4213] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2124) AS rid_3#4235]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#4234]
            :        :  +- Relation[o_shippriority_prf#4224,rid#4225,o_orderdate_prf#4226,o_custkey_prf#4227,o_orderpriority_prf#4228,o_clerk_prf#4229,o_orderstatus_prf#4230,o_totalprice_prf#4231,o_orderkey_prf#4232,o_comment_prf#4233] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4236 AS l_returnflag_prf_3#4255, l_orderkey_and_l_linenumber_prf#4237 AS l_orderkey_and_l_linenumber_prf_3#4256, l_comment_prf#4238 AS l_comment_prf_3#4257, l_linestatus_prf#4239 AS l_linestatus_prf_3#4258, rid#4240 AS rid_3#4259, l_shipmode_prf#4241 AS l_shipmode_prf_3#4260, l_shipinstruct_prf#4242 AS l_shipinstruct_prf_3#4261, l_quantity_prf#4243 AS l_quantity_prf_3#4262, l_receiptdate_prf#4244 AS l_receiptdate_prf_3#4263, l_linenumber_prf#4245 AS l_linenumber_prf_3#4264, l_tax_prf#4246 AS l_tax_prf_3#4265, l_shipdate_prf#4247 AS l_shipdate_prf_3#4266, l_extendedprice_prf#4248 AS l_extendedprice_prf_3#4267, l_partkey_prf#4249 AS l_partkey_prf_3#4268, l_discount_prf#4250 AS l_discount_prf_3#4269, l_partkey_and_l_suppkey_prf#4251 AS l_partkey_and_l_suppkey_prf_3#4270, l_commitdate_prf#4252 AS l_commitdate_prf_3#4271, l_suppkey_prf#4253 AS l_suppkey_prf_3#4272, l_orderkey_prf#4254 AS l_orderkey_prf_3#4273]
               +- Relation[l_returnflag_prf#4236,l_orderkey_and_l_linenumber_prf#4237,l_comment_prf#4238,l_linestatus_prf#4239,rid#4240,l_shipmode_prf#4241,l_shipinstruct_prf#4242,l_quantity_prf#4243,l_receiptdate_prf#4244,l_linenumber_prf#4245,l_tax_prf#4246,l_shipdate_prf#4247,l_extendedprice_prf#4248,l_partkey_prf#4249,l_discount_prf#4250,l_partkey_and_l_suppkey_prf#4251,l_commitdate_prf#4252,l_suppkey_prf#4253,l_orderkey_prf#4254] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 164102ms

fq1e=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 21:41:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:41:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4357L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [c_custkey#290L, c_nationkey#293L]
                  +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 21:41:17 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:41:17 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:41:17 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:41:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4357L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [l_returnflag_prf#4359 AS l_returnflag_prf_0#4378, l_orderkey_and_l_linenumber_prf#4360 AS l_orderkey_and_l_linenumber_prf_0#4379, l_comment_prf#4361 AS l_comment_prf_0#4380, l_linestatus_prf#4362 AS l_linestatus_prf_0#4381, rid#4363 AS rid_0#4382, l_shipmode_prf#4364 AS l_shipmode_prf_0#4383, l_shipinstruct_prf#4365 AS l_shipinstruct_prf_0#4384, l_quantity_prf#4366 AS l_quantity_prf_0#4385, l_receiptdate_prf#4367 AS l_receiptdate_prf_0#4386, l_linenumber_prf#4368 AS l_linenumber_prf_0#4387, l_tax_prf#4369 AS l_tax_prf_0#4388, l_shipdate_prf#4370 AS l_shipdate_prf_0#4389, l_extendedprice_prf#4371 AS l_extendedprice_prf_0#4390, l_partkey_prf#4372 AS l_partkey_prf_0#4391, l_discount_prf#4373 AS l_discount_prf_0#4392, l_partkey_and_l_suppkey_prf#4374 AS l_partkey_and_l_suppkey_prf_0#4393, l_commitdate_prf#4375 AS l_commitdate_prf_0#4394, l_suppkey_prf#4376 AS l_suppkey_prf_0#4395, l_orderkey_prf#4377 AS l_orderkey_prf_0#4396]
         :  :  :  :  +- Relation[l_returnflag_prf#4359,l_orderkey_and_l_linenumber_prf#4360,l_comment_prf#4361,l_linestatus_prf#4362,rid#4363,l_shipmode_prf#4364,l_shipinstruct_prf#4365,l_quantity_prf#4366,l_receiptdate_prf#4367,l_linenumber_prf#4368,l_tax_prf#4369,l_shipdate_prf#4370,l_extendedprice_prf#4371,l_partkey_prf#4372,l_discount_prf#4373,l_partkey_and_l_suppkey_prf#4374,l_commitdate_prf#4375,l_suppkey_prf#4376,l_orderkey_prf#4377] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#4417]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#4416]
         :  :  :        :  +- Relation[l_returnflag_prf#4397,l_orderkey_and_l_linenumber_prf#4398,l_comment_prf#4399,l_linestatus_prf#4400,rid#4401,l_shipmode_prf#4402,l_shipinstruct_prf#4403,l_quantity_prf#4404,l_receiptdate_prf#4405,l_linenumber_prf#4406,l_tax_prf#4407,l_shipdate_prf#4408,l_extendedprice_prf#4409,l_partkey_prf#4410,l_discount_prf#4411,l_partkey_and_l_suppkey_prf#4412,l_commitdate_prf#4413,l_suppkey_prf#4414,l_orderkey_prf#4415] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#4418 AS o_shippriority_prf_1#4428, rid#4419 AS rid_1#4429, o_orderdate_prf#4420 AS o_orderdate_prf_1#4430, o_custkey_prf#4421 AS o_custkey_prf_1#4431, o_orderpriority_prf#4422 AS o_orderpriority_prf_1#4432, o_clerk_prf#4423 AS o_clerk_prf_1#4433, o_orderstatus_prf#4424 AS o_orderstatus_prf_1#4434, o_totalprice_prf#4425 AS o_totalprice_prf_1#4435, o_orderkey_prf#4426 AS o_orderkey_prf_1#4436, o_comment_prf#4427 AS o_comment_prf_1#4437]
         :  :     +- Relation[o_shippriority_prf#4418,rid#4419,o_orderdate_prf#4420,o_custkey_prf#4421,o_orderpriority_prf#4422,o_clerk_prf#4423,o_orderstatus_prf#4424,o_totalprice_prf#4425,o_orderkey_prf#4426,o_comment_prf#4427] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2124) AS rid_3#4449]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4448]
         :        :  +- Relation[o_shippriority_prf#4438,rid#4439,o_orderdate_prf#4440,o_custkey_prf#4441,o_orderpriority_prf#4442,o_clerk_prf#4443,o_orderstatus_prf#4444,o_totalprice_prf#4445,o_orderkey_prf#4446,o_comment_prf#4447] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_2, 'n_regionkey_prf_2, 'n_nationkey_prf_2, 'n_name_prf_2, 'n_comment_prf_2, dexdecrypt('value_dec_key, value#2124) AS rid_3#4461]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_2#4455: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [rid#4450 AS rid_2#4455, n_regionkey_prf#4451 AS n_regionkey_prf_2#4456, n_nationkey_prf#4452 AS n_nationkey_prf_2#4457, n_name_prf#4453 AS n_name_prf_2#4458, n_comment_prf#4454 AS n_comment_prf_2#4459]
            :     :  :  +- Relation[rid#4450,n_regionkey_prf#4451,n_nationkey_prf#4452,n_name_prf#4453,n_comment_prf#4454] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#4460]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4462 AS c_acctbal_prf_3#4471, rid#4463 AS rid_3#4472, c_name_prf#4464 AS c_name_prf_3#4473, c_nationkey_prf#4465 AS c_nationkey_prf_3#4474, c_custkey_prf#4466 AS c_custkey_prf_3#4475, c_comment_prf#4467 AS c_comment_prf_3#4476, c_address_prf#4468 AS c_address_prf_3#4477, c_mktsegment_prf#4469 AS c_mktsegment_prf_3#4478, c_phone_prf#4470 AS c_phone_prf_3#4479]
               +- Relation[c_acctbal_prf#4462,rid#4463,c_name_prf#4464,c_nationkey_prf#4465,c_custkey_prf#4466,c_comment_prf#4467,c_address_prf#4468,c_mktsegment_prf#4469,c_phone_prf#4470] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 164856ms

ft3b=
select * from part, lineitem, supplier where p_size = 15 and p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/16 21:44:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:44:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4558L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 21:44:01 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:44:01 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:44:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4558L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#4581]
         :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#4572: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [p_comment_prf#4560 AS p_comment_prf_0#4570, p_name_prf#4561 AS p_name_prf_0#4571, rid#4562 AS rid_0#4572, p_type_prf#4563 AS p_type_prf_0#4573, p_retailprice_prf#4564 AS p_retailprice_prf_0#4574, p_mfgr_prf#4565 AS p_mfgr_prf_0#4575, p_container_prf#4566 AS p_container_prf_0#4576, p_brand_prf#4567 AS p_brand_prf_0#4577, p_size_prf#4568 AS p_size_prf_0#4578, p_partkey_prf#4569 AS p_partkey_prf_0#4579]
         :     :  :     :  :  +- Relation[p_comment_prf#4560,p_name_prf#4561,rid#4562,p_type_prf#4563,p_retailprice_prf#4564,p_mfgr_prf#4565,p_container_prf#4566,p_brand_prf#4567,p_size_prf#4568,p_partkey_prf#4569] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4580]
         :     :  :     :     +- DexRidFilter part~p_size~15
         :     :  :     :        +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#4582 AS l_returnflag_prf_1#4601, l_orderkey_and_l_linenumber_prf#4583 AS l_orderkey_and_l_linenumber_prf_1#4602, l_comment_prf#4584 AS l_comment_prf_1#4603, l_linestatus_prf#4585 AS l_linestatus_prf_1#4604, rid#4586 AS rid_1#4605, l_shipmode_prf#4587 AS l_shipmode_prf_1#4606, l_shipinstruct_prf#4588 AS l_shipinstruct_prf_1#4607, l_quantity_prf#4589 AS l_quantity_prf_1#4608, l_receiptdate_prf#4590 AS l_receiptdate_prf_1#4609, l_linenumber_prf#4591 AS l_linenumber_prf_1#4610, l_tax_prf#4592 AS l_tax_prf_1#4611, l_shipdate_prf#4593 AS l_shipdate_prf_1#4612, l_extendedprice_prf#4594 AS l_extendedprice_prf_1#4613, l_partkey_prf#4595 AS l_partkey_prf_1#4614, l_discount_prf#4596 AS l_discount_prf_1#4615, l_partkey_and_l_suppkey_prf#4597 AS l_partkey_and_l_suppkey_prf_1#4616, l_commitdate_prf#4598 AS l_commitdate_prf_1#4617, l_suppkey_prf#4599 AS l_suppkey_prf_1#4618, l_orderkey_prf#4600 AS l_orderkey_prf_1#4619]
         :     :     +- Relation[l_returnflag_prf#4582,l_orderkey_and_l_linenumber_prf#4583,l_comment_prf#4584,l_linestatus_prf#4585,rid#4586,l_shipmode_prf#4587,l_shipinstruct_prf#4588,l_quantity_prf#4589,l_receiptdate_prf#4590,l_linenumber_prf#4591,l_tax_prf#4592,l_shipdate_prf#4593,l_extendedprice_prf#4594,l_partkey_prf#4595,l_discount_prf#4596,l_partkey_and_l_suppkey_prf#4597,l_commitdate_prf#4598,l_suppkey_prf#4599,l_orderkey_prf#4600] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4621 AS s_phone_prf_2#4629, rid#4622 AS rid_2#4630, s_address_prf#4623 AS s_address_prf_2#4631, s_nationkey_prf#4624 AS s_nationkey_prf_2#4632, s_suppkey_prf#4625 AS s_suppkey_prf_2#4633, s_name_prf#4626 AS s_name_prf_2#4634, s_acctbal_prf#4627 AS s_acctbal_prf_2#4635, s_comment_prf#4628 AS s_comment_prf_2#4636]
            +- Relation[s_phone_prf#4621,rid#4622,s_address_prf#4623,s_nationkey_prf#4624,s_suppkey_prf#4625,s_name_prf#4626,s_acctbal_prf#4627,s_comment_prf#4628] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 6190ms

fr1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey and c_mktsegment = 'BUILDING'
19/10/16 21:44:08 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:44:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4710L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 21:44:08 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:44:08 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:44:08 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:44:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4710L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [l_returnflag_prf#4712 AS l_returnflag_prf_0#4731, l_orderkey_and_l_linenumber_prf#4713 AS l_orderkey_and_l_linenumber_prf_0#4732, l_comment_prf#4714 AS l_comment_prf_0#4733, l_linestatus_prf#4715 AS l_linestatus_prf_0#4734, rid#4716 AS rid_0#4735, l_shipmode_prf#4717 AS l_shipmode_prf_0#4736, l_shipinstruct_prf#4718 AS l_shipinstruct_prf_0#4737, l_quantity_prf#4719 AS l_quantity_prf_0#4738, l_receiptdate_prf#4720 AS l_receiptdate_prf_0#4739, l_linenumber_prf#4721 AS l_linenumber_prf_0#4740, l_tax_prf#4722 AS l_tax_prf_0#4741, l_shipdate_prf#4723 AS l_shipdate_prf_0#4742, l_extendedprice_prf#4724 AS l_extendedprice_prf_0#4743, l_partkey_prf#4725 AS l_partkey_prf_0#4744, l_discount_prf#4726 AS l_discount_prf_0#4745, l_partkey_and_l_suppkey_prf#4727 AS l_partkey_and_l_suppkey_prf_0#4746, l_commitdate_prf#4728 AS l_commitdate_prf_0#4747, l_suppkey_prf#4729 AS l_suppkey_prf_0#4748, l_orderkey_prf#4730 AS l_orderkey_prf_0#4749]
         :  :  :  :  +- Relation[l_returnflag_prf#4712,l_orderkey_and_l_linenumber_prf#4713,l_comment_prf#4714,l_linestatus_prf#4715,rid#4716,l_shipmode_prf#4717,l_shipinstruct_prf#4718,l_quantity_prf#4719,l_receiptdate_prf#4720,l_linenumber_prf#4721,l_tax_prf#4722,l_shipdate_prf#4723,l_extendedprice_prf#4724,l_partkey_prf#4725,l_discount_prf#4726,l_partkey_and_l_suppkey_prf#4727,l_commitdate_prf#4728,l_suppkey_prf#4729,l_orderkey_prf#4730] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#4770]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#4769]
         :  :  :        :  +- Relation[l_returnflag_prf#4750,l_orderkey_and_l_linenumber_prf#4751,l_comment_prf#4752,l_linestatus_prf#4753,rid#4754,l_shipmode_prf#4755,l_shipinstruct_prf#4756,l_quantity_prf#4757,l_receiptdate_prf#4758,l_linenumber_prf#4759,l_tax_prf#4760,l_shipdate_prf#4761,l_extendedprice_prf#4762,l_partkey_prf#4763,l_discount_prf#4764,l_partkey_and_l_suppkey_prf#4765,l_commitdate_prf#4766,l_suppkey_prf#4767,l_orderkey_prf#4768] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#4771 AS o_shippriority_prf_1#4781, rid#4772 AS rid_1#4782, o_orderdate_prf#4773 AS o_orderdate_prf_1#4783, o_custkey_prf#4774 AS o_custkey_prf_1#4784, o_orderpriority_prf#4775 AS o_orderpriority_prf_1#4785, o_clerk_prf#4776 AS o_clerk_prf_1#4786, o_orderstatus_prf#4777 AS o_orderstatus_prf_1#4787, o_totalprice_prf#4778 AS o_totalprice_prf_1#4788, o_orderkey_prf#4779 AS o_orderkey_prf_1#4789, o_comment_prf#4780 AS o_comment_prf_1#4790]
         :  :     +- Relation[o_shippriority_prf#4771,rid#4772,o_orderdate_prf#4773,o_custkey_prf#4774,o_orderpriority_prf#4775,o_clerk_prf#4776,o_orderstatus_prf#4777,o_totalprice_prf#4778,o_orderkey_prf#4779,o_comment_prf#4780] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#4802]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4801]
         :        :  +- Relation[o_shippriority_prf#4791,rid#4792,o_orderdate_prf#4793,o_custkey_prf#4794,o_orderpriority_prf#4795,o_clerk_prf#4796,o_orderstatus_prf#4797,o_totalprice_prf#4798,o_orderkey_prf#4799,o_comment_prf#4800] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_2))
            :- Project [c_acctbal_prf#4803 AS c_acctbal_prf_2#4812, rid#4804 AS rid_2#4813, c_name_prf#4805 AS c_name_prf_2#4814, c_nationkey_prf#4806 AS c_nationkey_prf_2#4815, c_custkey_prf#4807 AS c_custkey_prf_2#4816, c_comment_prf#4808 AS c_comment_prf_2#4817, c_address_prf#4809 AS c_address_prf_2#4818, c_mktsegment_prf#4810 AS c_mktsegment_prf_2#4819, c_phone_prf#4811 AS c_phone_prf_2#4820]
            :  +- Relation[c_acctbal_prf#4803,rid#4804,c_name_prf#4805,c_nationkey_prf#4806,c_custkey_prf#4807,c_comment_prf#4808,c_address_prf#4809,c_mktsegment_prf#4810,c_phone_prf#4811] JDBCRelation(customer_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#4821]
               +- DexRidFilter customer~c_mktsegment~BUILDING
                  +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 121413ms

ft1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_name = 'FRANCE' and n_nationkey = c_nationkey
19/10/16 21:46:09 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:46:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4882L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 21:46:09 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:46:09 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:46:09 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:46:09 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:46:09 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:46:09 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:46:09 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:46:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4882L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#4921]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [s_phone_prf#4884 AS s_phone_prf_0#4892, rid#4885 AS rid_0#4893, s_address_prf#4886 AS s_address_prf_0#4894, s_nationkey_prf#4887 AS s_nationkey_prf_0#4895, s_suppkey_prf#4888 AS s_suppkey_prf_0#4896, s_name_prf#4889 AS s_name_prf_0#4897, s_acctbal_prf#4890 AS s_acctbal_prf_0#4898, s_comment_prf#4891 AS s_comment_prf_0#4899]
         :     :  :  :  +- Relation[s_phone_prf#4884,rid#4885,s_address_prf#4886,s_nationkey_prf#4887,s_suppkey_prf#4888,s_name_prf#4889,s_acctbal_prf#4890,s_comment_prf#4891] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#4909]
         :     :  :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#4908]
         :     :  :        :  +- Relation[s_phone_prf#4900,rid#4901,s_address_prf#4902,s_nationkey_prf#4903,s_suppkey_prf#4904,s_name_prf#4905,s_acctbal_prf#4906,s_comment_prf#4907] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [rid#4910 AS rid_1#4915, n_regionkey_prf#4911 AS n_regionkey_prf_1#4916, n_nationkey_prf#4912 AS n_nationkey_prf_1#4917, n_name_prf#4913 AS n_name_prf_1#4918, n_comment_prf#4914 AS n_comment_prf_1#4919]
         :     :     :  +- Relation[rid#4910,n_regionkey_prf#4911,n_nationkey_prf#4912,n_name_prf#4913,n_comment_prf#4914] JDBCRelation(nation_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4920]
         :     :        +- DexRidFilter nation~n_name~FRANCE
         :     :           +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4922 AS c_acctbal_prf_2#4931, rid#4923 AS rid_2#4932, c_name_prf#4924 AS c_name_prf_2#4933, c_nationkey_prf#4925 AS c_nationkey_prf_2#4934, c_custkey_prf#4926 AS c_custkey_prf_2#4935, c_comment_prf#4927 AS c_comment_prf_2#4936, c_address_prf#4928 AS c_address_prf_2#4937, c_mktsegment_prf#4929 AS c_mktsegment_prf_2#4938, c_phone_prf#4930 AS c_phone_prf_2#4939]
            +- Relation[c_acctbal_prf#4922,rid#4923,c_name_prf#4924,c_nationkey_prf#4925,c_custkey_prf#4926,c_comment_prf#4927,c_address_prf#4928,c_mktsegment_prf#4929,c_phone_prf#4930] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 47843ms

ft3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and p_size = 15 and l_suppkey = s_suppkey
19/10/16 21:46:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:46:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4997L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 21:46:57 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:46:57 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:46:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4997L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, rid_0#5022: string
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [l_returnflag_prf#4999 AS l_returnflag_prf_0#5018, l_orderkey_and_l_linenumber_prf#5000 AS l_orderkey_and_l_linenumber_prf_0#5019, l_comment_prf#5001 AS l_comment_prf_0#5020, l_linestatus_prf#5002 AS l_linestatus_prf_0#5021, rid#5003 AS rid_0#5022, l_shipmode_prf#5004 AS l_shipmode_prf_0#5023, l_shipinstruct_prf#5005 AS l_shipinstruct_prf_0#5024, l_quantity_prf#5006 AS l_quantity_prf_0#5025, l_receiptdate_prf#5007 AS l_receiptdate_prf_0#5026, l_linenumber_prf#5008 AS l_linenumber_prf_0#5027, l_tax_prf#5009 AS l_tax_prf_0#5028, l_shipdate_prf#5010 AS l_shipdate_prf_0#5029, l_extendedprice_prf#5011 AS l_extendedprice_prf_0#5030, l_partkey_prf#5012 AS l_partkey_prf_0#5031, l_discount_prf#5013 AS l_discount_prf_0#5032, l_partkey_and_l_suppkey_prf#5014 AS l_partkey_and_l_suppkey_prf_0#5033, l_commitdate_prf#5015 AS l_commitdate_prf_0#5034, l_suppkey_prf#5016 AS l_suppkey_prf_0#5035, l_orderkey_prf#5017 AS l_orderkey_prf_0#5036]
         :     :  :  :  +- Relation[l_returnflag_prf#4999,l_orderkey_and_l_linenumber_prf#5000,l_comment_prf#5001,l_linestatus_prf#5002,rid#5003,l_shipmode_prf#5004,l_shipinstruct_prf#5005,l_quantity_prf#5006,l_receiptdate_prf#5007,l_linenumber_prf#5008,l_tax_prf#5009,l_shipdate_prf#5010,l_extendedprice_prf#5011,l_partkey_prf#5012,l_discount_prf#5013,l_partkey_and_l_suppkey_prf#5014,l_commitdate_prf#5015,l_suppkey_prf#5016,l_orderkey_prf#5017] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#5057]
         :     :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#5056]
         :     :  :        :  +- Relation[l_returnflag_prf#5037,l_orderkey_and_l_linenumber_prf#5038,l_comment_prf#5039,l_linestatus_prf#5040,rid#5041,l_shipmode_prf#5042,l_shipinstruct_prf#5043,l_quantity_prf#5044,l_receiptdate_prf#5045,l_linenumber_prf#5046,l_tax_prf#5047,l_shipdate_prf#5048,l_extendedprice_prf#5049,l_partkey_prf#5050,l_discount_prf#5051,l_partkey_and_l_suppkey_prf#5052,l_commitdate_prf#5053,l_suppkey_prf#5054,l_orderkey_prf#5055] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [p_comment_prf#5058 AS p_comment_prf_1#5068, p_name_prf#5059 AS p_name_prf_1#5069, rid#5060 AS rid_1#5070, p_type_prf#5061 AS p_type_prf_1#5071, p_retailprice_prf#5062 AS p_retailprice_prf_1#5072, p_mfgr_prf#5063 AS p_mfgr_prf_1#5073, p_container_prf#5064 AS p_container_prf_1#5074, p_brand_prf#5065 AS p_brand_prf_1#5075, p_size_prf#5066 AS p_size_prf_1#5076, p_partkey_prf#5067 AS p_partkey_prf_1#5077]
         :     :     :  +- Relation[p_comment_prf#5058,p_name_prf#5059,rid#5060,p_type_prf#5061,p_retailprice_prf#5062,p_mfgr_prf#5063,p_container_prf#5064,p_brand_prf#5065,p_size_prf#5066,p_partkey_prf#5067] JDBCRelation(part_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5078]
         :     :        +- DexRidFilter part~p_size~15
         :     :           +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5080 AS s_phone_prf_2#5088, rid#5081 AS rid_2#5089, s_address_prf#5082 AS s_address_prf_2#5090, s_nationkey_prf#5083 AS s_nationkey_prf_2#5091, s_suppkey_prf#5084 AS s_suppkey_prf_2#5092, s_name_prf#5085 AS s_name_prf_2#5093, s_acctbal_prf#5086 AS s_acctbal_prf_2#5094, s_comment_prf#5087 AS s_comment_prf_2#5095]
            +- Relation[s_phone_prf#5080,rid#5081,s_address_prf#5082,s_nationkey_prf#5083,s_suppkey_prf#5084,s_name_prf#5085,s_acctbal_prf#5086,s_comment_prf#5087] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 96282ms

ft3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and (p_size = 15 and s_suppkey = l_suppkey)
19/10/16 21:48:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:48:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5168L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 21:48:33 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:48:33 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:48:33 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:48:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5168L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#5170 AS s_phone_prf_0#5178, rid#5171 AS rid_0#5179, s_address_prf#5172 AS s_address_prf_0#5180, s_nationkey_prf#5173 AS s_nationkey_prf_0#5181, s_suppkey_prf#5174 AS s_suppkey_prf_0#5182, s_name_prf#5175 AS s_name_prf_0#5183, s_acctbal_prf#5176 AS s_acctbal_prf_0#5184, s_comment_prf#5177 AS s_comment_prf_0#5185]
         :  :  +- Relation[s_phone_prf#5170,rid#5171,s_address_prf#5172,s_nationkey_prf#5173,s_suppkey_prf#5174,s_name_prf#5175,s_acctbal_prf#5176,s_comment_prf#5177] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2124) AS rid_2#5195]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5194]
         :        :  +- Relation[s_phone_prf#5186,rid#5187,s_address_prf#5188,s_nationkey_prf#5189,s_suppkey_prf#5190,s_name_prf#5191,s_acctbal_prf#5192,s_comment_prf#5193] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#5217]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#5208: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#5196 AS p_comment_prf_1#5206, p_name_prf#5197 AS p_name_prf_1#5207, rid#5198 AS rid_1#5208, p_type_prf#5199 AS p_type_prf_1#5209, p_retailprice_prf#5200 AS p_retailprice_prf_1#5210, p_mfgr_prf#5201 AS p_mfgr_prf_1#5211, p_container_prf#5202 AS p_container_prf_1#5212, p_brand_prf#5203 AS p_brand_prf_1#5213, p_size_prf#5204 AS p_size_prf_1#5214, p_partkey_prf#5205 AS p_partkey_prf_1#5215]
            :     :  :  +- Relation[p_comment_prf#5196,p_name_prf#5197,rid#5198,p_type_prf#5199,p_retailprice_prf#5200,p_mfgr_prf#5201,p_container_prf#5202,p_brand_prf#5203,p_size_prf#5204,p_partkey_prf#5205] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5216]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#5218 AS l_returnflag_prf_2#5237, l_orderkey_and_l_linenumber_prf#5219 AS l_orderkey_and_l_linenumber_prf_2#5238, l_comment_prf#5220 AS l_comment_prf_2#5239, l_linestatus_prf#5221 AS l_linestatus_prf_2#5240, rid#5222 AS rid_2#5241, l_shipmode_prf#5223 AS l_shipmode_prf_2#5242, l_shipinstruct_prf#5224 AS l_shipinstruct_prf_2#5243, l_quantity_prf#5225 AS l_quantity_prf_2#5244, l_receiptdate_prf#5226 AS l_receiptdate_prf_2#5245, l_linenumber_prf#5227 AS l_linenumber_prf_2#5246, l_tax_prf#5228 AS l_tax_prf_2#5247, l_shipdate_prf#5229 AS l_shipdate_prf_2#5248, l_extendedprice_prf#5230 AS l_extendedprice_prf_2#5249, l_partkey_prf#5231 AS l_partkey_prf_2#5250, l_discount_prf#5232 AS l_discount_prf_2#5251, l_partkey_and_l_suppkey_prf#5233 AS l_partkey_and_l_suppkey_prf_2#5252, l_commitdate_prf#5234 AS l_commitdate_prf_2#5253, l_suppkey_prf#5235 AS l_suppkey_prf_2#5254, l_orderkey_prf#5236 AS l_orderkey_prf_2#5255]
               +- Relation[l_returnflag_prf#5218,l_orderkey_and_l_linenumber_prf#5219,l_comment_prf#5220,l_linestatus_prf#5221,rid#5222,l_shipmode_prf#5223,l_shipinstruct_prf#5224,l_quantity_prf#5225,l_receiptdate_prf#5226,l_linenumber_prf#5227,l_tax_prf#5228,l_shipdate_prf#5229,l_extendedprice_prf#5230,l_partkey_prf#5231,l_discount_prf#5232,l_partkey_and_l_suppkey_prf#5233,l_commitdate_prf#5234,l_suppkey_prf#5235,l_orderkey_prf#5236] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 55692ms

fr1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and (c_mktsegment = 'BUILDING' and l_orderkey = o_orderkey)
19/10/16 21:49:29 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:49:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5329L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 21:49:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:49:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:49:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:49:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5329L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#5331 AS l_returnflag_prf_0#5350, l_orderkey_and_l_linenumber_prf#5332 AS l_orderkey_and_l_linenumber_prf_0#5351, l_comment_prf#5333 AS l_comment_prf_0#5352, l_linestatus_prf#5334 AS l_linestatus_prf_0#5353, rid#5335 AS rid_0#5354, l_shipmode_prf#5336 AS l_shipmode_prf_0#5355, l_shipinstruct_prf#5337 AS l_shipinstruct_prf_0#5356, l_quantity_prf#5338 AS l_quantity_prf_0#5357, l_receiptdate_prf#5339 AS l_receiptdate_prf_0#5358, l_linenumber_prf#5340 AS l_linenumber_prf_0#5359, l_tax_prf#5341 AS l_tax_prf_0#5360, l_shipdate_prf#5342 AS l_shipdate_prf_0#5361, l_extendedprice_prf#5343 AS l_extendedprice_prf_0#5362, l_partkey_prf#5344 AS l_partkey_prf_0#5363, l_discount_prf#5345 AS l_discount_prf_0#5364, l_partkey_and_l_suppkey_prf#5346 AS l_partkey_and_l_suppkey_prf_0#5365, l_commitdate_prf#5347 AS l_commitdate_prf_0#5366, l_suppkey_prf#5348 AS l_suppkey_prf_0#5367, l_orderkey_prf#5349 AS l_orderkey_prf_0#5368]
         :  :  +- Relation[l_returnflag_prf#5331,l_orderkey_and_l_linenumber_prf#5332,l_comment_prf#5333,l_linestatus_prf#5334,rid#5335,l_shipmode_prf#5336,l_shipinstruct_prf#5337,l_quantity_prf#5338,l_receiptdate_prf#5339,l_linenumber_prf#5340,l_tax_prf#5341,l_shipdate_prf#5342,l_extendedprice_prf#5343,l_partkey_prf#5344,l_discount_prf#5345,l_partkey_and_l_suppkey_prf#5346,l_commitdate_prf#5347,l_suppkey_prf#5348,l_orderkey_prf#5349] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2124) AS rid_2#5389]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5388]
         :        :  +- Relation[l_returnflag_prf#5369,l_orderkey_and_l_linenumber_prf#5370,l_comment_prf#5371,l_linestatus_prf#5372,rid#5373,l_shipmode_prf#5374,l_shipinstruct_prf#5375,l_quantity_prf#5376,l_receiptdate_prf#5377,l_linenumber_prf#5378,l_tax_prf#5379,l_shipdate_prf#5380,l_extendedprice_prf#5381,l_partkey_prf#5382,l_discount_prf#5383,l_partkey_and_l_suppkey_prf#5384,l_commitdate_prf#5385,l_suppkey_prf#5386,l_orderkey_prf#5387] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#5409]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#5400: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [c_acctbal_prf#5390 AS c_acctbal_prf_1#5399, rid#5391 AS rid_1#5400, c_name_prf#5392 AS c_name_prf_1#5401, c_nationkey_prf#5393 AS c_nationkey_prf_1#5402, c_custkey_prf#5394 AS c_custkey_prf_1#5403, c_comment_prf#5395 AS c_comment_prf_1#5404, c_address_prf#5396 AS c_address_prf_1#5405, c_mktsegment_prf#5397 AS c_mktsegment_prf_1#5406, c_phone_prf#5398 AS c_phone_prf_1#5407]
            :     :  :  +- Relation[c_acctbal_prf#5390,rid#5391,c_name_prf#5392,c_nationkey_prf#5393,c_custkey_prf#5394,c_comment_prf#5395,c_address_prf#5396,c_mktsegment_prf#5397,c_phone_prf#5398] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5408]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#5410 AS o_shippriority_prf_2#5420, rid#5411 AS rid_2#5421, o_orderdate_prf#5412 AS o_orderdate_prf_2#5422, o_custkey_prf#5413 AS o_custkey_prf_2#5423, o_orderpriority_prf#5414 AS o_orderpriority_prf_2#5424, o_clerk_prf#5415 AS o_clerk_prf_2#5425, o_orderstatus_prf#5416 AS o_orderstatus_prf_2#5426, o_totalprice_prf#5417 AS o_totalprice_prf_2#5427, o_orderkey_prf#5418 AS o_orderkey_prf_2#5428, o_comment_prf#5419 AS o_comment_prf_2#5429]
               +- Relation[o_shippriority_prf#5410,rid#5411,o_orderdate_prf#5412,o_custkey_prf#5413,o_orderpriority_prf#5414,o_clerk_prf#5415,o_orderstatus_prf#5416,o_totalprice_prf#5417,o_orderkey_prf#5418,o_comment_prf#5419] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 83229ms

fr2f=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/16 21:50:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:50:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5504L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_orderkey#342L, o_custkey#343L]
         :     :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L]
         :        +- Filter isnotnull(c_custkey#290L)
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 21:50:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5504L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#5546]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#5527]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_0#5517: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [o_shippriority_prf#5506 AS o_shippriority_prf_0#5516, rid#5507 AS rid_0#5517, o_orderdate_prf#5508 AS o_orderdate_prf_0#5518, o_custkey_prf#5509 AS o_custkey_prf_0#5519, o_orderpriority_prf#5510 AS o_orderpriority_prf_0#5520, o_clerk_prf#5511 AS o_clerk_prf_0#5521, o_orderstatus_prf#5512 AS o_orderstatus_prf_0#5522, o_totalprice_prf#5513 AS o_totalprice_prf_0#5523, o_orderkey_prf#5514 AS o_orderkey_prf_0#5524, o_comment_prf#5515 AS o_comment_prf_0#5525]
         :     :  :     :  :  +- Relation[o_shippriority_prf#5506,rid#5507,o_orderdate_prf#5508,o_custkey_prf#5509,o_orderpriority_prf#5510,o_clerk_prf#5511,o_orderstatus_prf#5512,o_totalprice_prf#5513,o_orderkey_prf#5514,o_comment_prf#5515] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5526]
         :     :  :     :     +- DexRidFilter orders~o_orderstatus~F
         :     :  :     :        +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#5528 AS c_acctbal_prf_1#5537, rid#5529 AS rid_1#5538, c_name_prf#5530 AS c_name_prf_1#5539, c_nationkey_prf#5531 AS c_nationkey_prf_1#5540, c_custkey_prf#5532 AS c_custkey_prf_1#5541, c_comment_prf#5533 AS c_comment_prf_1#5542, c_address_prf#5534 AS c_address_prf_1#5543, c_mktsegment_prf#5535 AS c_mktsegment_prf_1#5544, c_phone_prf#5536 AS c_phone_prf_1#5545]
         :     :     +- Relation[c_acctbal_prf#5528,rid#5529,c_name_prf#5530,c_nationkey_prf#5531,c_custkey_prf#5532,c_comment_prf#5533,c_address_prf#5534,c_mktsegment_prf#5535,c_phone_prf#5536] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5547 AS l_returnflag_prf_2#5566, l_orderkey_and_l_linenumber_prf#5548 AS l_orderkey_and_l_linenumber_prf_2#5567, l_comment_prf#5549 AS l_comment_prf_2#5568, l_linestatus_prf#5550 AS l_linestatus_prf_2#5569, rid#5551 AS rid_2#5570, l_shipmode_prf#5552 AS l_shipmode_prf_2#5571, l_shipinstruct_prf#5553 AS l_shipinstruct_prf_2#5572, l_quantity_prf#5554 AS l_quantity_prf_2#5573, l_receiptdate_prf#5555 AS l_receiptdate_prf_2#5574, l_linenumber_prf#5556 AS l_linenumber_prf_2#5575, l_tax_prf#5557 AS l_tax_prf_2#5576, l_shipdate_prf#5558 AS l_shipdate_prf_2#5577, l_extendedprice_prf#5559 AS l_extendedprice_prf_2#5578, l_partkey_prf#5560 AS l_partkey_prf_2#5579, l_discount_prf#5561 AS l_discount_prf_2#5580, l_partkey_and_l_suppkey_prf#5562 AS l_partkey_and_l_suppkey_prf_2#5581, l_commitdate_prf#5563 AS l_commitdate_prf_2#5582, l_suppkey_prf#5564 AS l_suppkey_prf_2#5583, l_orderkey_prf#5565 AS l_orderkey_prf_2#5584]
            +- Relation[l_returnflag_prf#5547,l_orderkey_and_l_linenumber_prf#5548,l_comment_prf#5549,l_linestatus_prf#5550,rid#5551,l_shipmode_prf#5552,l_shipinstruct_prf#5553,l_quantity_prf#5554,l_receiptdate_prf#5555,l_linenumber_prf#5556,l_tax_prf#5557,l_shipdate_prf#5558,l_extendedprice_prf#5559,l_partkey_prf#5560,l_discount_prf#5561,l_partkey_and_l_suppkey_prf#5562,l_commitdate_prf#5563,l_suppkey_prf#5564,l_orderkey_prf#5565] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 83010ms

fr2e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/16 21:52:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:52:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5659L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 21:52:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5659L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#5661 AS c_acctbal_prf_0#5670, rid#5662 AS rid_0#5671, c_name_prf#5663 AS c_name_prf_0#5672, c_nationkey_prf#5664 AS c_nationkey_prf_0#5673, c_custkey_prf#5665 AS c_custkey_prf_0#5674, c_comment_prf#5666 AS c_comment_prf_0#5675, c_address_prf#5667 AS c_address_prf_0#5676, c_mktsegment_prf#5668 AS c_mktsegment_prf_0#5677, c_phone_prf#5669 AS c_phone_prf_0#5678]
         :  :  +- Relation[c_acctbal_prf#5661,rid#5662,c_name_prf#5663,c_nationkey_prf#5664,c_custkey_prf#5665,c_comment_prf#5666,c_address_prf#5667,c_mktsegment_prf#5668,c_phone_prf#5669] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#5689]
         :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5688]
         :        :  +- Relation[c_acctbal_prf#5679,rid#5680,c_name_prf#5681,c_nationkey_prf#5682,c_custkey_prf#5683,c_comment_prf#5684,c_address_prf#5685,c_mktsegment_prf#5686,c_phone_prf#5687] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#5711]
            :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#5701: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#5690 AS o_shippriority_prf_1#5700, rid#5691 AS rid_1#5701, o_orderdate_prf#5692 AS o_orderdate_prf_1#5702, o_custkey_prf#5693 AS o_custkey_prf_1#5703, o_orderpriority_prf#5694 AS o_orderpriority_prf_1#5704, o_clerk_prf#5695 AS o_clerk_prf_1#5705, o_orderstatus_prf#5696 AS o_orderstatus_prf_1#5706, o_totalprice_prf#5697 AS o_totalprice_prf_1#5707, o_orderkey_prf#5698 AS o_orderkey_prf_1#5708, o_comment_prf#5699 AS o_comment_prf_1#5709]
            :     :  :  +- Relation[o_shippriority_prf#5690,rid#5691,o_orderdate_prf#5692,o_custkey_prf#5693,o_orderpriority_prf#5694,o_clerk_prf#5695,o_orderstatus_prf#5696,o_totalprice_prf#5697,o_orderkey_prf#5698,o_comment_prf#5699] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5710]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#5712 AS l_returnflag_prf_2#5731, l_orderkey_and_l_linenumber_prf#5713 AS l_orderkey_and_l_linenumber_prf_2#5732, l_comment_prf#5714 AS l_comment_prf_2#5733, l_linestatus_prf#5715 AS l_linestatus_prf_2#5734, rid#5716 AS rid_2#5735, l_shipmode_prf#5717 AS l_shipmode_prf_2#5736, l_shipinstruct_prf#5718 AS l_shipinstruct_prf_2#5737, l_quantity_prf#5719 AS l_quantity_prf_2#5738, l_receiptdate_prf#5720 AS l_receiptdate_prf_2#5739, l_linenumber_prf#5721 AS l_linenumber_prf_2#5740, l_tax_prf#5722 AS l_tax_prf_2#5741, l_shipdate_prf#5723 AS l_shipdate_prf_2#5742, l_extendedprice_prf#5724 AS l_extendedprice_prf_2#5743, l_partkey_prf#5725 AS l_partkey_prf_2#5744, l_discount_prf#5726 AS l_discount_prf_2#5745, l_partkey_and_l_suppkey_prf#5727 AS l_partkey_and_l_suppkey_prf_2#5746, l_commitdate_prf#5728 AS l_commitdate_prf_2#5747, l_suppkey_prf#5729 AS l_suppkey_prf_2#5748, l_orderkey_prf#5730 AS l_orderkey_prf_2#5749]
               +- Relation[l_returnflag_prf#5712,l_orderkey_and_l_linenumber_prf#5713,l_comment_prf#5714,l_linestatus_prf#5715,rid#5716,l_shipmode_prf#5717,l_shipinstruct_prf#5718,l_quantity_prf#5719,l_receiptdate_prf#5720,l_linenumber_prf#5721,l_tax_prf#5722,l_shipdate_prf#5723,l_extendedprice_prf#5724,l_partkey_prf#5725,l_discount_prf#5726,l_partkey_and_l_suppkey_prf#5727,l_commitdate_prf#5728,l_suppkey_prf#5729,l_orderkey_prf#5730] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 95923ms

fq1f=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 21:53:51 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:53:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5828L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/16 21:53:51 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:53:51 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:53:51 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:53:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5828L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- Project [l_returnflag_prf#5830 AS l_returnflag_prf_0#5849, l_orderkey_and_l_linenumber_prf#5831 AS l_orderkey_and_l_linenumber_prf_0#5850, l_comment_prf#5832 AS l_comment_prf_0#5851, l_linestatus_prf#5833 AS l_linestatus_prf_0#5852, rid#5834 AS rid_0#5853, l_shipmode_prf#5835 AS l_shipmode_prf_0#5854, l_shipinstruct_prf#5836 AS l_shipinstruct_prf_0#5855, l_quantity_prf#5837 AS l_quantity_prf_0#5856, l_receiptdate_prf#5838 AS l_receiptdate_prf_0#5857, l_linenumber_prf#5839 AS l_linenumber_prf_0#5858, l_tax_prf#5840 AS l_tax_prf_0#5859, l_shipdate_prf#5841 AS l_shipdate_prf_0#5860, l_extendedprice_prf#5842 AS l_extendedprice_prf_0#5861, l_partkey_prf#5843 AS l_partkey_prf_0#5862, l_discount_prf#5844 AS l_discount_prf_0#5863, l_partkey_and_l_suppkey_prf#5845 AS l_partkey_and_l_suppkey_prf_0#5864, l_commitdate_prf#5846 AS l_commitdate_prf_0#5865, l_suppkey_prf#5847 AS l_suppkey_prf_0#5866, l_orderkey_prf#5848 AS l_orderkey_prf_0#5867]
         :  :  :  :  :  :  +- Relation[l_returnflag_prf#5830,l_orderkey_and_l_linenumber_prf#5831,l_comment_prf#5832,l_linestatus_prf#5833,rid#5834,l_shipmode_prf#5835,l_shipinstruct_prf#5836,l_quantity_prf#5837,l_receiptdate_prf#5838,l_linenumber_prf#5839,l_tax_prf#5840,l_shipdate_prf#5841,l_extendedprice_prf#5842,l_partkey_prf#5843,l_discount_prf#5844,l_partkey_and_l_suppkey_prf#5845,l_commitdate_prf#5846,l_suppkey_prf#5847,l_orderkey_prf#5848] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#5888]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :  :  :        :- 'Project ['rid AS rid_0#5887]
         :  :  :  :  :        :  +- Relation[l_returnflag_prf#5868,l_orderkey_and_l_linenumber_prf#5869,l_comment_prf#5870,l_linestatus_prf#5871,rid#5872,l_shipmode_prf#5873,l_shipinstruct_prf#5874,l_quantity_prf#5875,l_receiptdate_prf#5876,l_linenumber_prf#5877,l_tax_prf#5878,l_shipdate_prf#5879,l_extendedprice_prf#5880,l_partkey_prf#5881,l_discount_prf#5882,l_partkey_and_l_suppkey_prf#5883,l_commitdate_prf#5884,l_suppkey_prf#5885,l_orderkey_prf#5886] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [o_shippriority_prf#5889 AS o_shippriority_prf_1#5899, rid#5890 AS rid_1#5900, o_orderdate_prf#5891 AS o_orderdate_prf_1#5901, o_custkey_prf#5892 AS o_custkey_prf_1#5902, o_orderpriority_prf#5893 AS o_orderpriority_prf_1#5903, o_clerk_prf#5894 AS o_clerk_prf_1#5904, o_orderstatus_prf#5895 AS o_orderstatus_prf_1#5905, o_totalprice_prf#5896 AS o_totalprice_prf_1#5906, o_orderkey_prf#5897 AS o_orderkey_prf_1#5907, o_comment_prf#5898 AS o_comment_prf_1#5908]
         :  :  :  :     +- Relation[o_shippriority_prf#5889,rid#5890,o_orderdate_prf#5891,o_custkey_prf#5892,o_orderpriority_prf#5893,o_clerk_prf#5894,o_orderstatus_prf#5895,o_totalprice_prf#5896,o_orderkey_prf#5897,o_comment_prf#5898] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#5920]
         :  :  :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :  :  :        :- 'Project ['rid AS rid_1#5919]
         :  :  :        :  +- Relation[o_shippriority_prf#5909,rid#5910,o_orderdate_prf#5911,o_custkey_prf#5912,o_orderpriority_prf#5913,o_clerk_prf#5914,o_orderstatus_prf#5915,o_totalprice_prf#5916,o_orderkey_prf#5917,o_comment_prf#5918] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#5921 AS c_acctbal_prf_2#5930, rid#5922 AS rid_2#5931, c_name_prf#5923 AS c_name_prf_2#5932, c_nationkey_prf#5924 AS c_nationkey_prf_2#5933, c_custkey_prf#5925 AS c_custkey_prf_2#5934, c_comment_prf#5926 AS c_comment_prf_2#5935, c_address_prf#5927 AS c_address_prf_2#5936, c_mktsegment_prf#5928 AS c_mktsegment_prf_2#5937, c_phone_prf#5929 AS c_phone_prf_2#5938]
         :  :     +- Relation[c_acctbal_prf#5921,rid#5922,c_name_prf#5923,c_nationkey_prf#5924,c_custkey_prf#5925,c_comment_prf#5926,c_address_prf#5927,c_mktsegment_prf#5928,c_phone_prf#5929] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2124) AS rid_3#5949]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#5948]
         :        :  +- Relation[c_acctbal_prf#5939,rid#5940,c_name_prf#5941,c_nationkey_prf#5942,c_custkey_prf#5943,c_comment_prf#5944,c_address_prf#5945,c_mktsegment_prf#5946,c_phone_prf#5947] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_3))
            :- Project [rid#5950 AS rid_3#5955, n_regionkey_prf#5951 AS n_regionkey_prf_3#5956, n_nationkey_prf#5952 AS n_nationkey_prf_3#5957, n_name_prf#5953 AS n_name_prf_3#5958, n_comment_prf#5954 AS n_comment_prf_3#5959]
            :  +- Relation[rid#5950,n_regionkey_prf#5951,n_nationkey_prf#5952,n_name_prf#5953,n_comment_prf#5954] JDBCRelation(nation_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#5960]
               +- DexRidFilter nation~n_name~FRANCE
                  +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 168604ms

ft1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/16 21:56:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:56:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6026L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/16 21:56:40 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:56:40 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:56:40 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:56:40 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:56:40 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:56:40 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:56:40 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:56:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6026L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#6028 AS c_acctbal_prf_0#6037, rid#6029 AS rid_0#6038, c_name_prf#6030 AS c_name_prf_0#6039, c_nationkey_prf#6031 AS c_nationkey_prf_0#6040, c_custkey_prf#6032 AS c_custkey_prf_0#6041, c_comment_prf#6033 AS c_comment_prf_0#6042, c_address_prf#6034 AS c_address_prf_0#6043, c_mktsegment_prf#6035 AS c_mktsegment_prf_0#6044, c_phone_prf#6036 AS c_phone_prf_0#6045]
         :  :  +- Relation[c_acctbal_prf#6028,rid#6029,c_name_prf#6030,c_nationkey_prf#6031,c_custkey_prf#6032,c_comment_prf#6033,c_address_prf#6034,c_mktsegment_prf#6035,c_phone_prf#6036] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2124) AS rid_2#6056]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#6055]
         :        :  +- Relation[c_acctbal_prf#6046,rid#6047,c_name_prf#6048,c_nationkey_prf#6049,c_custkey_prf#6050,c_comment_prf#6051,c_address_prf#6052,c_mktsegment_prf#6053,c_phone_prf#6054] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [s_phone_prf#6057 AS s_phone_prf_1#6065, rid#6058 AS rid_1#6066, s_address_prf#6059 AS s_address_prf_1#6067, s_nationkey_prf#6060 AS s_nationkey_prf_1#6068, s_suppkey_prf#6061 AS s_suppkey_prf_1#6069, s_name_prf#6062 AS s_name_prf_1#6070, s_acctbal_prf#6063 AS s_acctbal_prf_1#6071, s_comment_prf#6064 AS s_comment_prf_1#6072]
            :  :  +- Relation[s_phone_prf#6057,rid#6058,s_address_prf#6059,s_nationkey_prf#6060,s_suppkey_prf#6061,s_name_prf#6062,s_acctbal_prf#6063,s_comment_prf#6064] JDBCRelation(supplier_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#6082]
            :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#6081]
            :        :  +- Relation[s_phone_prf#6073,rid#6074,s_address_prf#6075,s_nationkey_prf#6076,s_suppkey_prf#6077,s_name_prf#6078,s_acctbal_prf#6079,s_comment_prf#6080] JDBCRelation(supplier_prf) [numPartitions=1]
            :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [rid#6083 AS rid_2#6088, n_regionkey_prf#6084 AS n_regionkey_prf_2#6089, n_nationkey_prf#6085 AS n_nationkey_prf_2#6090, n_name_prf#6086 AS n_name_prf_2#6091, n_comment_prf#6087 AS n_comment_prf_2#6092]
               :  +- Relation[rid#6083,n_regionkey_prf#6084,n_nationkey_prf#6085,n_name_prf#6086,n_comment_prf#6087] JDBCRelation(nation_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#6093]
                  +- DexRidFilter nation~n_name~FRANCE
                     +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 33190ms

fr1e=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and (o_orderkey = l_orderkey and c_custkey = o_custkey)
19/10/16 21:57:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:57:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6152L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 21:57:13 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:57:13 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:57:13 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:57:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6152L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#6173]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#6164: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [c_acctbal_prf#6154 AS c_acctbal_prf_0#6163, rid#6155 AS rid_0#6164, c_name_prf#6156 AS c_name_prf_0#6165, c_nationkey_prf#6157 AS c_nationkey_prf_0#6166, c_custkey_prf#6158 AS c_custkey_prf_0#6167, c_comment_prf#6159 AS c_comment_prf_0#6168, c_address_prf#6160 AS c_address_prf_0#6169, c_mktsegment_prf#6161 AS c_mktsegment_prf_0#6170, c_phone_prf#6162 AS c_phone_prf_0#6171]
         :     :  :  +- Relation[c_acctbal_prf#6154,rid#6155,c_name_prf#6156,c_nationkey_prf#6157,c_custkey_prf#6158,c_comment_prf#6159,c_address_prf#6160,c_mktsegment_prf#6161,c_phone_prf#6162] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#6172]
         :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :        +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [o_shippriority_prf#6174 AS o_shippriority_prf_1#6184, rid#6175 AS rid_1#6185, o_orderdate_prf#6176 AS o_orderdate_prf_1#6186, o_custkey_prf#6177 AS o_custkey_prf_1#6187, o_orderpriority_prf#6178 AS o_orderpriority_prf_1#6188, o_clerk_prf#6179 AS o_clerk_prf_1#6189, o_orderstatus_prf#6180 AS o_orderstatus_prf_1#6190, o_totalprice_prf#6181 AS o_totalprice_prf_1#6191, o_orderkey_prf#6182 AS o_orderkey_prf_1#6192, o_comment_prf#6183 AS o_comment_prf_1#6193]
            :  :  +- Relation[o_shippriority_prf#6174,rid#6175,o_orderdate_prf#6176,o_custkey_prf#6177,o_orderpriority_prf#6178,o_clerk_prf#6179,o_orderstatus_prf#6180,o_totalprice_prf#6181,o_orderkey_prf#6182,o_comment_prf#6183] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#6205]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#6204]
            :        :  +- Relation[o_shippriority_prf#6194,rid#6195,o_orderdate_prf#6196,o_custkey_prf#6197,o_orderpriority_prf#6198,o_clerk_prf#6199,o_orderstatus_prf#6200,o_totalprice_prf#6201,o_orderkey_prf#6202,o_comment_prf#6203] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#6206 AS l_returnflag_prf_2#6225, l_orderkey_and_l_linenumber_prf#6207 AS l_orderkey_and_l_linenumber_prf_2#6226, l_comment_prf#6208 AS l_comment_prf_2#6227, l_linestatus_prf#6209 AS l_linestatus_prf_2#6228, rid#6210 AS rid_2#6229, l_shipmode_prf#6211 AS l_shipmode_prf_2#6230, l_shipinstruct_prf#6212 AS l_shipinstruct_prf_2#6231, l_quantity_prf#6213 AS l_quantity_prf_2#6232, l_receiptdate_prf#6214 AS l_receiptdate_prf_2#6233, l_linenumber_prf#6215 AS l_linenumber_prf_2#6234, l_tax_prf#6216 AS l_tax_prf_2#6235, l_shipdate_prf#6217 AS l_shipdate_prf_2#6236, l_extendedprice_prf#6218 AS l_extendedprice_prf_2#6237, l_partkey_prf#6219 AS l_partkey_prf_2#6238, l_discount_prf#6220 AS l_discount_prf_2#6239, l_partkey_and_l_suppkey_prf#6221 AS l_partkey_and_l_suppkey_prf_2#6240, l_commitdate_prf#6222 AS l_commitdate_prf_2#6241, l_suppkey_prf#6223 AS l_suppkey_prf_2#6242, l_orderkey_prf#6224 AS l_orderkey_prf_2#6243]
               +- Relation[l_returnflag_prf#6206,l_orderkey_and_l_linenumber_prf#6207,l_comment_prf#6208,l_linestatus_prf#6209,rid#6210,l_shipmode_prf#6211,l_shipinstruct_prf#6212,l_quantity_prf#6213,l_receiptdate_prf#6214,l_linenumber_prf#6215,l_tax_prf#6216,l_shipdate_prf#6217,l_extendedprice_prf#6218,l_partkey_prf#6219,l_discount_prf#6220,l_partkey_and_l_suppkey_prf#6221,l_commitdate_prf#6222,l_suppkey_prf#6223,l_orderkey_prf#6224] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 153045ms

ft2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and p_size = 15 and ps_suppkey = s_suppkey
19/10/16 21:59:46 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:59:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6306L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 21:59:46 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 21:59:46 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 21:59:46 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 21:59:46 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 21:59:46 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:59:46 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:59:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6306L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#6352]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, rid_0#6316: string
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [ps_partkey_and_ps_suppkey_prf#6308 AS ps_partkey_and_ps_suppkey_prf_0#6315, rid#6309 AS rid_0#6316, ps_availqty_prf#6310 AS ps_availqty_prf_0#6317, ps_comment_prf#6311 AS ps_comment_prf_0#6318, ps_partkey_prf#6312 AS ps_partkey_prf_0#6319, ps_supplycost_prf#6313 AS ps_supplycost_prf_0#6320, ps_suppkey_prf#6314 AS ps_suppkey_prf_0#6321]
         :     :  :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#6308,rid#6309,ps_availqty_prf#6310,ps_comment_prf#6311,ps_partkey_prf#6312,ps_supplycost_prf#6313,ps_suppkey_prf#6314] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#6330]
         :     :  :     +- 'DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#6329]
         :     :  :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#6322,rid#6323,ps_availqty_prf#6324,ps_comment_prf#6325,ps_partkey_prf#6326,ps_supplycost_prf#6327,ps_suppkey_prf#6328] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [p_comment_prf#6331 AS p_comment_prf_1#6341, p_name_prf#6332 AS p_name_prf_1#6342, rid#6333 AS rid_1#6343, p_type_prf#6334 AS p_type_prf_1#6344, p_retailprice_prf#6335 AS p_retailprice_prf_1#6345, p_mfgr_prf#6336 AS p_mfgr_prf_1#6346, p_container_prf#6337 AS p_container_prf_1#6347, p_brand_prf#6338 AS p_brand_prf_1#6348, p_size_prf#6339 AS p_size_prf_1#6349, p_partkey_prf#6340 AS p_partkey_prf_1#6350]
         :     :     :  +- Relation[p_comment_prf#6331,p_name_prf#6332,rid#6333,p_type_prf#6334,p_retailprice_prf#6335,p_mfgr_prf#6336,p_container_prf#6337,p_brand_prf#6338,p_size_prf#6339,p_partkey_prf#6340] JDBCRelation(part_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6351]
         :     :        +- DexRidFilter part~p_size~15
         :     :           +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#6353 AS s_phone_prf_2#6361, rid#6354 AS rid_2#6362, s_address_prf#6355 AS s_address_prf_2#6363, s_nationkey_prf#6356 AS s_nationkey_prf_2#6364, s_suppkey_prf#6357 AS s_suppkey_prf_2#6365, s_name_prf#6358 AS s_name_prf_2#6366, s_acctbal_prf#6359 AS s_acctbal_prf_2#6367, s_comment_prf#6360 AS s_comment_prf_2#6368]
            +- Relation[s_phone_prf#6353,rid#6354,s_address_prf#6355,s_nationkey_prf#6356,s_suppkey_prf#6357,s_name_prf#6358,s_acctbal_prf#6359,s_comment_prf#6360] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 49257ms

fq1b=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 22:00:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:00:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6434L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 22:00:35 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:00:35 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:00:35 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:00:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6434L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2124) AS rid_2#6466]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#6447]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#6441: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#6436 AS rid_0#6441, n_regionkey_prf#6437 AS n_regionkey_prf_0#6442, n_nationkey_prf#6438 AS n_nationkey_prf_0#6443, n_name_prf#6439 AS n_name_prf_0#6444, n_comment_prf#6440 AS n_comment_prf_0#6445]
         :     :  :     :  :  +- Relation[rid#6436,n_regionkey_prf#6437,n_nationkey_prf#6438,n_name_prf#6439,n_comment_prf#6440] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#6446]
         :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :        +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#6448 AS c_acctbal_prf_1#6457, rid#6449 AS rid_1#6458, c_name_prf#6450 AS c_name_prf_1#6459, c_nationkey_prf#6451 AS c_nationkey_prf_1#6460, c_custkey_prf#6452 AS c_custkey_prf_1#6461, c_comment_prf#6453 AS c_comment_prf_1#6462, c_address_prf#6454 AS c_address_prf_1#6463, c_mktsegment_prf#6455 AS c_mktsegment_prf_1#6464, c_phone_prf#6456 AS c_phone_prf_1#6465]
         :     :     +- Relation[c_acctbal_prf#6448,rid#6449,c_name_prf#6450,c_nationkey_prf#6451,c_custkey_prf#6452,c_comment_prf#6453,c_address_prf#6454,c_mktsegment_prf#6455,c_phone_prf#6456] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- Project [o_shippriority_prf#6467 AS o_shippriority_prf_2#6477, rid#6468 AS rid_2#6478, o_orderdate_prf#6469 AS o_orderdate_prf_2#6479, o_custkey_prf#6470 AS o_custkey_prf_2#6480, o_orderpriority_prf#6471 AS o_orderpriority_prf_2#6481, o_clerk_prf#6472 AS o_clerk_prf_2#6482, o_orderstatus_prf#6473 AS o_orderstatus_prf_2#6483, o_totalprice_prf#6474 AS o_totalprice_prf_2#6484, o_orderkey_prf#6475 AS o_orderkey_prf_2#6485, o_comment_prf#6476 AS o_comment_prf_2#6486]
            :  :  +- Relation[o_shippriority_prf#6467,rid#6468,o_orderdate_prf#6469,o_custkey_prf#6470,o_orderpriority_prf#6471,o_clerk_prf#6472,o_orderstatus_prf#6473,o_totalprice_prf#6474,o_orderkey_prf#6475,o_comment_prf#6476] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2124) AS rid_3#6498]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#6497]
            :        :  +- Relation[o_shippriority_prf#6487,rid#6488,o_orderdate_prf#6489,o_custkey_prf#6490,o_orderpriority_prf#6491,o_clerk_prf#6492,o_orderstatus_prf#6493,o_totalprice_prf#6494,o_orderkey_prf#6495,o_comment_prf#6496] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#6499 AS l_returnflag_prf_3#6518, l_orderkey_and_l_linenumber_prf#6500 AS l_orderkey_and_l_linenumber_prf_3#6519, l_comment_prf#6501 AS l_comment_prf_3#6520, l_linestatus_prf#6502 AS l_linestatus_prf_3#6521, rid#6503 AS rid_3#6522, l_shipmode_prf#6504 AS l_shipmode_prf_3#6523, l_shipinstruct_prf#6505 AS l_shipinstruct_prf_3#6524, l_quantity_prf#6506 AS l_quantity_prf_3#6525, l_receiptdate_prf#6507 AS l_receiptdate_prf_3#6526, l_linenumber_prf#6508 AS l_linenumber_prf_3#6527, l_tax_prf#6509 AS l_tax_prf_3#6528, l_shipdate_prf#6510 AS l_shipdate_prf_3#6529, l_extendedprice_prf#6511 AS l_extendedprice_prf_3#6530, l_partkey_prf#6512 AS l_partkey_prf_3#6531, l_discount_prf#6513 AS l_discount_prf_3#6532, l_partkey_and_l_suppkey_prf#6514 AS l_partkey_and_l_suppkey_prf_3#6533, l_commitdate_prf#6515 AS l_commitdate_prf_3#6534, l_suppkey_prf#6516 AS l_suppkey_prf_3#6535, l_orderkey_prf#6517 AS l_orderkey_prf_3#6536]
               +- Relation[l_returnflag_prf#6499,l_orderkey_and_l_linenumber_prf#6500,l_comment_prf#6501,l_linestatus_prf#6502,rid#6503,l_shipmode_prf#6504,l_shipinstruct_prf#6505,l_quantity_prf#6506,l_receiptdate_prf#6507,l_linenumber_prf#6508,l_tax_prf#6509,l_shipdate_prf#6510,l_extendedprice_prf#6511,l_partkey_prf#6512,l_discount_prf#6513,l_partkey_and_l_suppkey_prf#6514,l_commitdate_prf#6515,l_suppkey_prf#6516,l_orderkey_prf#6517] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 140537ms

fs1b=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/16 22:02:56 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:02:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6625L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L, l_partkey#307L]
               :  +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L]
                  +- Join Inner, (c_custkey#290L = o_custkey#343L)
                     :- Project [c_custkey#290L]
                     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
                     +- Project [o_orderkey#342L, o_custkey#343L]
                        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 22:02:56 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:02:56 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:02:56 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:02:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6625L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [p_comment_prf#6627 AS p_comment_prf_0#6637, p_name_prf#6628 AS p_name_prf_0#6638, rid#6629 AS rid_0#6639, p_type_prf#6630 AS p_type_prf_0#6640, p_retailprice_prf#6631 AS p_retailprice_prf_0#6641, p_mfgr_prf#6632 AS p_mfgr_prf_0#6642, p_container_prf#6633 AS p_container_prf_0#6643, p_brand_prf#6634 AS p_brand_prf_0#6644, p_size_prf#6635 AS p_size_prf_0#6645, p_partkey_prf#6636 AS p_partkey_prf_0#6646]
         :  :  +- Relation[p_comment_prf#6627,p_name_prf#6628,rid#6629,p_type_prf#6630,p_retailprice_prf#6631,p_mfgr_prf#6632,p_container_prf#6633,p_brand_prf#6634,p_size_prf#6635,p_partkey_prf#6636] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2124) AS rid_1#6658]
         :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#6657]
         :        :  +- Relation[p_comment_prf#6647,p_name_prf#6648,rid#6649,p_type_prf#6650,p_retailprice_prf#6651,p_mfgr_prf#6652,p_container_prf#6653,p_brand_prf#6654,p_size_prf#6655,p_partkey_prf#6656] JDBCRelation(part_prf) [numPartitions=1]
         :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [l_returnflag_prf#6659 AS l_returnflag_prf_1#6678, l_orderkey_and_l_linenumber_prf#6660 AS l_orderkey_and_l_linenumber_prf_1#6679, l_comment_prf#6661 AS l_comment_prf_1#6680, l_linestatus_prf#6662 AS l_linestatus_prf_1#6681, rid#6663 AS rid_1#6682, l_shipmode_prf#6664 AS l_shipmode_prf_1#6683, l_shipinstruct_prf#6665 AS l_shipinstruct_prf_1#6684, l_quantity_prf#6666 AS l_quantity_prf_1#6685, l_receiptdate_prf#6667 AS l_receiptdate_prf_1#6686, l_linenumber_prf#6668 AS l_linenumber_prf_1#6687, l_tax_prf#6669 AS l_tax_prf_1#6688, l_shipdate_prf#6670 AS l_shipdate_prf_1#6689, l_extendedprice_prf#6671 AS l_extendedprice_prf_1#6690, l_partkey_prf#6672 AS l_partkey_prf_1#6691, l_discount_prf#6673 AS l_discount_prf_1#6692, l_partkey_and_l_suppkey_prf#6674 AS l_partkey_and_l_suppkey_prf_1#6693, l_commitdate_prf#6675 AS l_commitdate_prf_1#6694, l_suppkey_prf#6676 AS l_suppkey_prf_1#6695, l_orderkey_prf#6677 AS l_orderkey_prf_1#6696]
            :  :  +- Relation[l_returnflag_prf#6659,l_orderkey_and_l_linenumber_prf#6660,l_comment_prf#6661,l_linestatus_prf#6662,rid#6663,l_shipmode_prf#6664,l_shipinstruct_prf#6665,l_quantity_prf#6666,l_receiptdate_prf#6667,l_linenumber_prf#6668,l_tax_prf#6669,l_shipdate_prf#6670,l_extendedprice_prf#6671,l_partkey_prf#6672,l_discount_prf#6673,l_partkey_and_l_suppkey_prf#6674,l_commitdate_prf#6675,l_suppkey_prf#6676,l_orderkey_prf#6677] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2124) AS rid_3#6717]
            :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#6716]
            :        :  +- Relation[l_returnflag_prf#6697,l_orderkey_and_l_linenumber_prf#6698,l_comment_prf#6699,l_linestatus_prf#6700,rid#6701,l_shipmode_prf#6702,l_shipinstruct_prf#6703,l_quantity_prf#6704,l_receiptdate_prf#6705,l_linenumber_prf#6706,l_tax_prf#6707,l_shipdate_prf#6708,l_extendedprice_prf#6709,l_partkey_prf#6710,l_discount_prf#6711,l_partkey_and_l_suppkey_prf#6712,l_commitdate_prf#6713,l_suppkey_prf#6714,l_orderkey_prf#6715] JDBCRelation(lineitem_prf) [numPartitions=1]
            :        +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join NaturalJoin(Inner)
               :- 'Project ['c_acctbal_prf_2, 'rid_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2124) AS rid_3#6737]
               :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_2#6728: string
               :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :     :  :- Project [c_acctbal_prf#6718 AS c_acctbal_prf_2#6727, rid#6719 AS rid_2#6728, c_name_prf#6720 AS c_name_prf_2#6729, c_nationkey_prf#6721 AS c_nationkey_prf_2#6730, c_custkey_prf#6722 AS c_custkey_prf_2#6731, c_comment_prf#6723 AS c_comment_prf_2#6732, c_address_prf#6724 AS c_address_prf_2#6733, c_mktsegment_prf#6725 AS c_mktsegment_prf_2#6734, c_phone_prf#6726 AS c_phone_prf_2#6735]
               :     :  :  +- Relation[c_acctbal_prf#6718,rid#6719,c_name_prf#6720,c_nationkey_prf#6721,c_custkey_prf#6722,c_comment_prf#6723,c_address_prf#6724,c_mktsegment_prf#6725,c_phone_prf#6726] JDBCRelation(customer_prf) [numPartitions=1]
               :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#6736]
               :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
               :     :        +- Relation[label#2146,value#2147] JDBCRelation(t_filter) [numPartitions=1]
               :     +- Relation[label#2123,value#2124] JDBCRelation(t_correlated_join) [numPartitions=1]
               +- Project [o_shippriority_prf#6738 AS o_shippriority_prf_3#6748, rid#6739 AS rid_3#6749, o_orderdate_prf#6740 AS o_orderdate_prf_3#6750, o_custkey_prf#6741 AS o_custkey_prf_3#6751, o_orderpriority_prf#6742 AS o_orderpriority_prf_3#6752, o_clerk_prf#6743 AS o_clerk_prf_3#6753, o_orderstatus_prf#6744 AS o_orderstatus_prf_3#6754, o_totalprice_prf#6745 AS o_totalprice_prf_3#6755, o_orderkey_prf#6746 AS o_orderkey_prf_3#6756, o_comment_prf#6747 AS o_comment_prf_3#6757]
                  +- Relation[o_shippriority_prf#6738,rid#6739,o_orderdate_prf#6740,o_custkey_prf#6741,o_orderpriority_prf#6742,o_clerk_prf#6743,o_orderstatus_prf#6744,o_totalprice_prf#6745,o_orderkey_prf#6746,o_comment_prf#6747] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 172602ms
query=fq1a, count=246415, duration=30849
query=fq1b, count=246415, duration=140537
query=fq1c, count=246415, duration=164102
query=fq1d, count=246415, duration=74211
query=fq1e, count=246415, duration=164856
query=fq1f, count=246415, duration=168604
query=fr1a, count=1214743, duration=121413
query=fr1b, count=1214743, duration=121112
query=fr1c, count=1214743, duration=83229
query=fr1d, count=1214743, duration=32917
query=fr1e, count=1214743, duration=153045
query=fr2a, count=2901744, duration=193180
query=fr2b, count=2901744, duration=105319
query=fr2d, count=2901744, duration=108318
query=fr2e, count=2901744, duration=95923
query=fr2f, count=2901744, duration=83010
query=fs1a, count=1214743, duration=107926
query=fs1b, count=1214743, duration=172602
query=fs1c, count=1214743, duration=172597
query=ft1a, count=2452200, duration=47843
query=ft1b, count=2452200, duration=30036
query=ft1c, count=2452200, duration=33190
query=ft1d, count=2452200, duration=24126
query=ft2a, count=15628, duration=49257
query=ft2b, count=15628, duration=924
query=ft2c, count=15628, duration=6993
query=ft3a, count=117754, duration=96282
query=ft3b, count=117754, duration=6190
query=ft3c, count=117754, duration=55692
