19/10/16 22:05:49 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7126ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Wed Oct 16 22:05:52 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Wed Oct 16 22:05:53 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Wed Oct 16 22:05:53 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Wed Oct 16 22:05:53 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Wed Oct 16 22:05:53 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Wed Oct 16 22:05:55 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Wed Oct 16 22:05:58 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Wed Oct 16 22:05:58 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



ft1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/16 22:05:59 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:05:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2079L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/16 22:05:59 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:05:59 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:05:59 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:05:59 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:05:59 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:05:59 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:05:59 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:05:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2079L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#2081 AS c_acctbal_prf_0#2090, rid#2082 AS rid_0#2091, c_name_prf#2083 AS c_name_prf_0#2092, c_nationkey_prf#2084 AS c_nationkey_prf_0#2093, c_custkey_prf#2085 AS c_custkey_prf_0#2094, c_comment_prf#2086 AS c_comment_prf_0#2095, c_address_prf#2087 AS c_address_prf_0#2096, c_mktsegment_prf#2088 AS c_mktsegment_prf_0#2097, c_phone_prf#2089 AS c_phone_prf_0#2098]
         :  :  +- Relation[c_acctbal_prf#2081,rid#2082,c_name_prf#2083,c_nationkey_prf#2084,c_custkey_prf#2085,c_comment_prf#2086,c_address_prf#2087,c_mktsegment_prf#2088,c_phone_prf#2089] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_2#2111]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2108]
         :        :  +- Relation[c_acctbal_prf#2099,rid#2100,c_name_prf#2101,c_nationkey_prf#2102,c_custkey_prf#2103,c_comment_prf#2104,c_address_prf#2105,c_mktsegment_prf#2106,c_phone_prf#2107] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [s_phone_prf#2112 AS s_phone_prf_1#2120, rid#2113 AS rid_1#2121, s_address_prf#2114 AS s_address_prf_1#2122, s_nationkey_prf#2115 AS s_nationkey_prf_1#2123, s_suppkey_prf#2116 AS s_suppkey_prf_1#2124, s_name_prf#2117 AS s_name_prf_1#2125, s_acctbal_prf#2118 AS s_acctbal_prf_1#2126, s_comment_prf#2119 AS s_comment_prf_1#2127]
            :  :  +- Relation[s_phone_prf#2112,rid#2113,s_address_prf#2114,s_nationkey_prf#2115,s_suppkey_prf#2116,s_name_prf#2117,s_acctbal_prf#2118,s_comment_prf#2119] JDBCRelation(supplier_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#2137]
            :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#2136]
            :        :  +- Relation[s_phone_prf#2128,rid#2129,s_address_prf#2130,s_nationkey_prf#2131,s_suppkey_prf#2132,s_name_prf#2133,s_acctbal_prf#2134,s_comment_prf#2135] JDBCRelation(supplier_prf) [numPartitions=1]
            :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [rid#2138 AS rid_2#2143, n_regionkey_prf#2139 AS n_regionkey_prf_2#2144, n_nationkey_prf#2140 AS n_nationkey_prf_2#2145, n_name_prf#2141 AS n_name_prf_2#2146, n_comment_prf#2142 AS n_comment_prf_2#2147]
               :  +- Relation[rid#2138,n_regionkey_prf#2139,n_nationkey_prf#2140,n_name_prf#2141,n_comment_prf#2142] JDBCRelation(nation_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#2150]
                  +- DexRidFilter nation~n_name~FRANCE
                     +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 33580ms

fq1d=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 22:06:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:06:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2213L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :     :- Project [n_nationkey#108L]
               :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
               :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 22:06:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:06:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:06:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:06:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2213L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#2215 AS l_returnflag_prf_0#2234, l_orderkey_and_l_linenumber_prf#2216 AS l_orderkey_and_l_linenumber_prf_0#2235, l_comment_prf#2217 AS l_comment_prf_0#2236, l_linestatus_prf#2218 AS l_linestatus_prf_0#2237, rid#2219 AS rid_0#2238, l_shipmode_prf#2220 AS l_shipmode_prf_0#2239, l_shipinstruct_prf#2221 AS l_shipinstruct_prf_0#2240, l_quantity_prf#2222 AS l_quantity_prf_0#2241, l_receiptdate_prf#2223 AS l_receiptdate_prf_0#2242, l_linenumber_prf#2224 AS l_linenumber_prf_0#2243, l_tax_prf#2225 AS l_tax_prf_0#2244, l_shipdate_prf#2226 AS l_shipdate_prf_0#2245, l_extendedprice_prf#2227 AS l_extendedprice_prf_0#2246, l_partkey_prf#2228 AS l_partkey_prf_0#2247, l_discount_prf#2229 AS l_discount_prf_0#2248, l_partkey_and_l_suppkey_prf#2230 AS l_partkey_and_l_suppkey_prf_0#2249, l_commitdate_prf#2231 AS l_commitdate_prf_0#2250, l_suppkey_prf#2232 AS l_suppkey_prf_0#2251, l_orderkey_prf#2233 AS l_orderkey_prf_0#2252]
         :  :  +- Relation[l_returnflag_prf#2215,l_orderkey_and_l_linenumber_prf#2216,l_comment_prf#2217,l_linestatus_prf#2218,rid#2219,l_shipmode_prf#2220,l_shipinstruct_prf#2221,l_quantity_prf#2222,l_receiptdate_prf#2223,l_linenumber_prf#2224,l_tax_prf#2225,l_shipdate_prf#2226,l_extendedprice_prf#2227,l_partkey_prf#2228,l_discount_prf#2229,l_partkey_and_l_suppkey_prf#2230,l_commitdate_prf#2231,l_suppkey_prf#2232,l_orderkey_prf#2233] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_3#2273]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2272]
         :        :  +- Relation[l_returnflag_prf#2253,l_orderkey_and_l_linenumber_prf#2254,l_comment_prf#2255,l_linestatus_prf#2256,rid#2257,l_shipmode_prf#2258,l_shipinstruct_prf#2259,l_quantity_prf#2260,l_receiptdate_prf#2261,l_linenumber_prf#2262,l_tax_prf#2263,l_shipdate_prf#2264,l_extendedprice_prf#2265,l_partkey_prf#2266,l_discount_prf#2267,l_partkey_and_l_suppkey_prf#2268,l_commitdate_prf#2269,l_suppkey_prf#2270,l_orderkey_prf#2271] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, 'rid_2, 'c_acctbal_prf_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2110) AS rid_3#2304]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_2
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#2285]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_1#2279: string
            :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :     :  :- Project [rid#2274 AS rid_1#2279, n_regionkey_prf#2275 AS n_regionkey_prf_1#2280, n_nationkey_prf#2276 AS n_nationkey_prf_1#2281, n_name_prf#2277 AS n_name_prf_1#2282, n_comment_prf#2278 AS n_comment_prf_1#2283]
            :     :  :     :  :  +- Relation[rid#2274,n_regionkey_prf#2275,n_nationkey_prf#2276,n_name_prf#2277,n_comment_prf#2278] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2284]
            :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :  :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [c_acctbal_prf#2286 AS c_acctbal_prf_2#2295, rid#2287 AS rid_2#2296, c_name_prf#2288 AS c_name_prf_2#2297, c_nationkey_prf#2289 AS c_nationkey_prf_2#2298, c_custkey_prf#2290 AS c_custkey_prf_2#2299, c_comment_prf#2291 AS c_comment_prf_2#2300, c_address_prf#2292 AS c_address_prf_2#2301, c_mktsegment_prf#2293 AS c_mktsegment_prf_2#2302, c_phone_prf#2294 AS c_phone_prf_2#2303]
            :     :     +- Relation[c_acctbal_prf#2286,rid#2287,c_name_prf#2288,c_nationkey_prf#2289,c_custkey_prf#2290,c_comment_prf#2291,c_address_prf#2292,c_mktsegment_prf#2293,c_phone_prf#2294] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2305 AS o_shippriority_prf_3#2315, rid#2306 AS rid_3#2316, o_orderdate_prf#2307 AS o_orderdate_prf_3#2317, o_custkey_prf#2308 AS o_custkey_prf_3#2318, o_orderpriority_prf#2309 AS o_orderpriority_prf_3#2319, o_clerk_prf#2310 AS o_clerk_prf_3#2320, o_orderstatus_prf#2311 AS o_orderstatus_prf_3#2321, o_totalprice_prf#2312 AS o_totalprice_prf_3#2322, o_orderkey_prf#2313 AS o_orderkey_prf_3#2323, o_comment_prf#2314 AS o_comment_prf_3#2324]
               +- Relation[o_shippriority_prf#2305,rid#2306,o_orderdate_prf#2307,o_custkey_prf#2308,o_orderpriority_prf#2309,o_clerk_prf#2310,o_orderstatus_prf#2311,o_totalprice_prf#2312,o_orderkey_prf#2313,o_comment_prf#2314] JDBCRelation(orders_prf) [numPartitions=1]

19/10/16 22:06:33 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=246415
Elapsed time: 74591ms

ft3b=
select * from part, lineitem, supplier where p_size = 15 and p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/16 22:07:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:07:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2403L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 22:07:47 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:07:47 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:07:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2403L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#2426]
         :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2417: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [p_comment_prf#2405 AS p_comment_prf_0#2415, p_name_prf#2406 AS p_name_prf_0#2416, rid#2407 AS rid_0#2417, p_type_prf#2408 AS p_type_prf_0#2418, p_retailprice_prf#2409 AS p_retailprice_prf_0#2419, p_mfgr_prf#2410 AS p_mfgr_prf_0#2420, p_container_prf#2411 AS p_container_prf_0#2421, p_brand_prf#2412 AS p_brand_prf_0#2422, p_size_prf#2413 AS p_size_prf_0#2423, p_partkey_prf#2414 AS p_partkey_prf_0#2424]
         :     :  :     :  :  +- Relation[p_comment_prf#2405,p_name_prf#2406,rid#2407,p_type_prf#2408,p_retailprice_prf#2409,p_mfgr_prf#2410,p_container_prf#2411,p_brand_prf#2412,p_size_prf#2413,p_partkey_prf#2414] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2425]
         :     :  :     :     +- DexRidFilter part~p_size~15
         :     :  :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#2427 AS l_returnflag_prf_1#2446, l_orderkey_and_l_linenumber_prf#2428 AS l_orderkey_and_l_linenumber_prf_1#2447, l_comment_prf#2429 AS l_comment_prf_1#2448, l_linestatus_prf#2430 AS l_linestatus_prf_1#2449, rid#2431 AS rid_1#2450, l_shipmode_prf#2432 AS l_shipmode_prf_1#2451, l_shipinstruct_prf#2433 AS l_shipinstruct_prf_1#2452, l_quantity_prf#2434 AS l_quantity_prf_1#2453, l_receiptdate_prf#2435 AS l_receiptdate_prf_1#2454, l_linenumber_prf#2436 AS l_linenumber_prf_1#2455, l_tax_prf#2437 AS l_tax_prf_1#2456, l_shipdate_prf#2438 AS l_shipdate_prf_1#2457, l_extendedprice_prf#2439 AS l_extendedprice_prf_1#2458, l_partkey_prf#2440 AS l_partkey_prf_1#2459, l_discount_prf#2441 AS l_discount_prf_1#2460, l_partkey_and_l_suppkey_prf#2442 AS l_partkey_and_l_suppkey_prf_1#2461, l_commitdate_prf#2443 AS l_commitdate_prf_1#2462, l_suppkey_prf#2444 AS l_suppkey_prf_1#2463, l_orderkey_prf#2445 AS l_orderkey_prf_1#2464]
         :     :     +- Relation[l_returnflag_prf#2427,l_orderkey_and_l_linenumber_prf#2428,l_comment_prf#2429,l_linestatus_prf#2430,rid#2431,l_shipmode_prf#2432,l_shipinstruct_prf#2433,l_quantity_prf#2434,l_receiptdate_prf#2435,l_linenumber_prf#2436,l_tax_prf#2437,l_shipdate_prf#2438,l_extendedprice_prf#2439,l_partkey_prf#2440,l_discount_prf#2441,l_partkey_and_l_suppkey_prf#2442,l_commitdate_prf#2443,l_suppkey_prf#2444,l_orderkey_prf#2445] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2466 AS s_phone_prf_2#2474, rid#2467 AS rid_2#2475, s_address_prf#2468 AS s_address_prf_2#2476, s_nationkey_prf#2469 AS s_nationkey_prf_2#2477, s_suppkey_prf#2470 AS s_suppkey_prf_2#2478, s_name_prf#2471 AS s_name_prf_2#2479, s_acctbal_prf#2472 AS s_acctbal_prf_2#2480, s_comment_prf#2473 AS s_comment_prf_2#2481]
            +- Relation[s_phone_prf#2466,rid#2467,s_address_prf#2468,s_nationkey_prf#2469,s_suppkey_prf#2470,s_name_prf#2471,s_acctbal_prf#2472,s_comment_prf#2473] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 6162ms

ft3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and p_size = 15 and l_suppkey = s_suppkey
19/10/16 22:07:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:07:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2554L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 22:07:53 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:07:53 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:07:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2554L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, rid_0#2579: string
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [l_returnflag_prf#2556 AS l_returnflag_prf_0#2575, l_orderkey_and_l_linenumber_prf#2557 AS l_orderkey_and_l_linenumber_prf_0#2576, l_comment_prf#2558 AS l_comment_prf_0#2577, l_linestatus_prf#2559 AS l_linestatus_prf_0#2578, rid#2560 AS rid_0#2579, l_shipmode_prf#2561 AS l_shipmode_prf_0#2580, l_shipinstruct_prf#2562 AS l_shipinstruct_prf_0#2581, l_quantity_prf#2563 AS l_quantity_prf_0#2582, l_receiptdate_prf#2564 AS l_receiptdate_prf_0#2583, l_linenumber_prf#2565 AS l_linenumber_prf_0#2584, l_tax_prf#2566 AS l_tax_prf_0#2585, l_shipdate_prf#2567 AS l_shipdate_prf_0#2586, l_extendedprice_prf#2568 AS l_extendedprice_prf_0#2587, l_partkey_prf#2569 AS l_partkey_prf_0#2588, l_discount_prf#2570 AS l_discount_prf_0#2589, l_partkey_and_l_suppkey_prf#2571 AS l_partkey_and_l_suppkey_prf_0#2590, l_commitdate_prf#2572 AS l_commitdate_prf_0#2591, l_suppkey_prf#2573 AS l_suppkey_prf_0#2592, l_orderkey_prf#2574 AS l_orderkey_prf_0#2593]
         :     :  :  :  +- Relation[l_returnflag_prf#2556,l_orderkey_and_l_linenumber_prf#2557,l_comment_prf#2558,l_linestatus_prf#2559,rid#2560,l_shipmode_prf#2561,l_shipinstruct_prf#2562,l_quantity_prf#2563,l_receiptdate_prf#2564,l_linenumber_prf#2565,l_tax_prf#2566,l_shipdate_prf#2567,l_extendedprice_prf#2568,l_partkey_prf#2569,l_discount_prf#2570,l_partkey_and_l_suppkey_prf#2571,l_commitdate_prf#2572,l_suppkey_prf#2573,l_orderkey_prf#2574] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#2614]
         :     :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#2613]
         :     :  :        :  +- Relation[l_returnflag_prf#2594,l_orderkey_and_l_linenumber_prf#2595,l_comment_prf#2596,l_linestatus_prf#2597,rid#2598,l_shipmode_prf#2599,l_shipinstruct_prf#2600,l_quantity_prf#2601,l_receiptdate_prf#2602,l_linenumber_prf#2603,l_tax_prf#2604,l_shipdate_prf#2605,l_extendedprice_prf#2606,l_partkey_prf#2607,l_discount_prf#2608,l_partkey_and_l_suppkey_prf#2609,l_commitdate_prf#2610,l_suppkey_prf#2611,l_orderkey_prf#2612] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [p_comment_prf#2615 AS p_comment_prf_1#2625, p_name_prf#2616 AS p_name_prf_1#2626, rid#2617 AS rid_1#2627, p_type_prf#2618 AS p_type_prf_1#2628, p_retailprice_prf#2619 AS p_retailprice_prf_1#2629, p_mfgr_prf#2620 AS p_mfgr_prf_1#2630, p_container_prf#2621 AS p_container_prf_1#2631, p_brand_prf#2622 AS p_brand_prf_1#2632, p_size_prf#2623 AS p_size_prf_1#2633, p_partkey_prf#2624 AS p_partkey_prf_1#2634]
         :     :     :  +- Relation[p_comment_prf#2615,p_name_prf#2616,rid#2617,p_type_prf#2618,p_retailprice_prf#2619,p_mfgr_prf#2620,p_container_prf#2621,p_brand_prf#2622,p_size_prf#2623,p_partkey_prf#2624] JDBCRelation(part_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2635]
         :     :        +- DexRidFilter part~p_size~15
         :     :           +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2637 AS s_phone_prf_2#2645, rid#2638 AS rid_2#2646, s_address_prf#2639 AS s_address_prf_2#2647, s_nationkey_prf#2640 AS s_nationkey_prf_2#2648, s_suppkey_prf#2641 AS s_suppkey_prf_2#2649, s_name_prf#2642 AS s_name_prf_2#2650, s_acctbal_prf#2643 AS s_acctbal_prf_2#2651, s_comment_prf#2644 AS s_comment_prf_2#2652]
            +- Relation[s_phone_prf#2637,rid#2638,s_address_prf#2639,s_nationkey_prf#2640,s_suppkey_prf#2641,s_name_prf#2642,s_acctbal_prf#2643,s_comment_prf#2644] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 95893ms

fr1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and (c_mktsegment = 'BUILDING' and l_orderkey = o_orderkey)
19/10/16 22:09:29 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:09:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2726L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 22:09:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:09:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:09:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:09:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2726L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#2728 AS l_returnflag_prf_0#2747, l_orderkey_and_l_linenumber_prf#2729 AS l_orderkey_and_l_linenumber_prf_0#2748, l_comment_prf#2730 AS l_comment_prf_0#2749, l_linestatus_prf#2731 AS l_linestatus_prf_0#2750, rid#2732 AS rid_0#2751, l_shipmode_prf#2733 AS l_shipmode_prf_0#2752, l_shipinstruct_prf#2734 AS l_shipinstruct_prf_0#2753, l_quantity_prf#2735 AS l_quantity_prf_0#2754, l_receiptdate_prf#2736 AS l_receiptdate_prf_0#2755, l_linenumber_prf#2737 AS l_linenumber_prf_0#2756, l_tax_prf#2738 AS l_tax_prf_0#2757, l_shipdate_prf#2739 AS l_shipdate_prf_0#2758, l_extendedprice_prf#2740 AS l_extendedprice_prf_0#2759, l_partkey_prf#2741 AS l_partkey_prf_0#2760, l_discount_prf#2742 AS l_discount_prf_0#2761, l_partkey_and_l_suppkey_prf#2743 AS l_partkey_and_l_suppkey_prf_0#2762, l_commitdate_prf#2744 AS l_commitdate_prf_0#2763, l_suppkey_prf#2745 AS l_suppkey_prf_0#2764, l_orderkey_prf#2746 AS l_orderkey_prf_0#2765]
         :  :  +- Relation[l_returnflag_prf#2728,l_orderkey_and_l_linenumber_prf#2729,l_comment_prf#2730,l_linestatus_prf#2731,rid#2732,l_shipmode_prf#2733,l_shipinstruct_prf#2734,l_quantity_prf#2735,l_receiptdate_prf#2736,l_linenumber_prf#2737,l_tax_prf#2738,l_shipdate_prf#2739,l_extendedprice_prf#2740,l_partkey_prf#2741,l_discount_prf#2742,l_partkey_and_l_suppkey_prf#2743,l_commitdate_prf#2744,l_suppkey_prf#2745,l_orderkey_prf#2746] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_2#2786]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2785]
         :        :  +- Relation[l_returnflag_prf#2766,l_orderkey_and_l_linenumber_prf#2767,l_comment_prf#2768,l_linestatus_prf#2769,rid#2770,l_shipmode_prf#2771,l_shipinstruct_prf#2772,l_quantity_prf#2773,l_receiptdate_prf#2774,l_linenumber_prf#2775,l_tax_prf#2776,l_shipdate_prf#2777,l_extendedprice_prf#2778,l_partkey_prf#2779,l_discount_prf#2780,l_partkey_and_l_suppkey_prf#2781,l_commitdate_prf#2782,l_suppkey_prf#2783,l_orderkey_prf#2784] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#2806]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#2797: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [c_acctbal_prf#2787 AS c_acctbal_prf_1#2796, rid#2788 AS rid_1#2797, c_name_prf#2789 AS c_name_prf_1#2798, c_nationkey_prf#2790 AS c_nationkey_prf_1#2799, c_custkey_prf#2791 AS c_custkey_prf_1#2800, c_comment_prf#2792 AS c_comment_prf_1#2801, c_address_prf#2793 AS c_address_prf_1#2802, c_mktsegment_prf#2794 AS c_mktsegment_prf_1#2803, c_phone_prf#2795 AS c_phone_prf_1#2804]
            :     :  :  +- Relation[c_acctbal_prf#2787,rid#2788,c_name_prf#2789,c_nationkey_prf#2790,c_custkey_prf#2791,c_comment_prf#2792,c_address_prf#2793,c_mktsegment_prf#2794,c_phone_prf#2795] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2805]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2807 AS o_shippriority_prf_2#2817, rid#2808 AS rid_2#2818, o_orderdate_prf#2809 AS o_orderdate_prf_2#2819, o_custkey_prf#2810 AS o_custkey_prf_2#2820, o_orderpriority_prf#2811 AS o_orderpriority_prf_2#2821, o_clerk_prf#2812 AS o_clerk_prf_2#2822, o_orderstatus_prf#2813 AS o_orderstatus_prf_2#2823, o_totalprice_prf#2814 AS o_totalprice_prf_2#2824, o_orderkey_prf#2815 AS o_orderkey_prf_2#2825, o_comment_prf#2816 AS o_comment_prf_2#2826]
               +- Relation[o_shippriority_prf#2807,rid#2808,o_orderdate_prf#2809,o_custkey_prf#2810,o_orderpriority_prf#2811,o_clerk_prf#2812,o_orderstatus_prf#2813,o_totalprice_prf#2814,o_orderkey_prf#2815,o_comment_prf#2816] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 82888ms

fr1e=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and (o_orderkey = l_orderkey and c_custkey = o_custkey)
19/10/16 22:10:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:10:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2901L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 22:10:52 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:10:52 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:10:52 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:10:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2901L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#2922]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2913: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [c_acctbal_prf#2903 AS c_acctbal_prf_0#2912, rid#2904 AS rid_0#2913, c_name_prf#2905 AS c_name_prf_0#2914, c_nationkey_prf#2906 AS c_nationkey_prf_0#2915, c_custkey_prf#2907 AS c_custkey_prf_0#2916, c_comment_prf#2908 AS c_comment_prf_0#2917, c_address_prf#2909 AS c_address_prf_0#2918, c_mktsegment_prf#2910 AS c_mktsegment_prf_0#2919, c_phone_prf#2911 AS c_phone_prf_0#2920]
         :     :  :  +- Relation[c_acctbal_prf#2903,rid#2904,c_name_prf#2905,c_nationkey_prf#2906,c_custkey_prf#2907,c_comment_prf#2908,c_address_prf#2909,c_mktsegment_prf#2910,c_phone_prf#2911] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2921]
         :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [o_shippriority_prf#2923 AS o_shippriority_prf_1#2933, rid#2924 AS rid_1#2934, o_orderdate_prf#2925 AS o_orderdate_prf_1#2935, o_custkey_prf#2926 AS o_custkey_prf_1#2936, o_orderpriority_prf#2927 AS o_orderpriority_prf_1#2937, o_clerk_prf#2928 AS o_clerk_prf_1#2938, o_orderstatus_prf#2929 AS o_orderstatus_prf_1#2939, o_totalprice_prf#2930 AS o_totalprice_prf_1#2940, o_orderkey_prf#2931 AS o_orderkey_prf_1#2941, o_comment_prf#2932 AS o_comment_prf_1#2942]
            :  :  +- Relation[o_shippriority_prf#2923,rid#2924,o_orderdate_prf#2925,o_custkey_prf#2926,o_orderpriority_prf#2927,o_clerk_prf#2928,o_orderstatus_prf#2929,o_totalprice_prf#2930,o_orderkey_prf#2931,o_comment_prf#2932] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#2954]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#2953]
            :        :  +- Relation[o_shippriority_prf#2943,rid#2944,o_orderdate_prf#2945,o_custkey_prf#2946,o_orderpriority_prf#2947,o_clerk_prf#2948,o_orderstatus_prf#2949,o_totalprice_prf#2950,o_orderkey_prf#2951,o_comment_prf#2952] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2955 AS l_returnflag_prf_2#2974, l_orderkey_and_l_linenumber_prf#2956 AS l_orderkey_and_l_linenumber_prf_2#2975, l_comment_prf#2957 AS l_comment_prf_2#2976, l_linestatus_prf#2958 AS l_linestatus_prf_2#2977, rid#2959 AS rid_2#2978, l_shipmode_prf#2960 AS l_shipmode_prf_2#2979, l_shipinstruct_prf#2961 AS l_shipinstruct_prf_2#2980, l_quantity_prf#2962 AS l_quantity_prf_2#2981, l_receiptdate_prf#2963 AS l_receiptdate_prf_2#2982, l_linenumber_prf#2964 AS l_linenumber_prf_2#2983, l_tax_prf#2965 AS l_tax_prf_2#2984, l_shipdate_prf#2966 AS l_shipdate_prf_2#2985, l_extendedprice_prf#2967 AS l_extendedprice_prf_2#2986, l_partkey_prf#2968 AS l_partkey_prf_2#2987, l_discount_prf#2969 AS l_discount_prf_2#2988, l_partkey_and_l_suppkey_prf#2970 AS l_partkey_and_l_suppkey_prf_2#2989, l_commitdate_prf#2971 AS l_commitdate_prf_2#2990, l_suppkey_prf#2972 AS l_suppkey_prf_2#2991, l_orderkey_prf#2973 AS l_orderkey_prf_2#2992]
               +- Relation[l_returnflag_prf#2955,l_orderkey_and_l_linenumber_prf#2956,l_comment_prf#2957,l_linestatus_prf#2958,rid#2959,l_shipmode_prf#2960,l_shipinstruct_prf#2961,l_quantity_prf#2962,l_receiptdate_prf#2963,l_linenumber_prf#2964,l_tax_prf#2965,l_shipdate_prf#2966,l_extendedprice_prf#2967,l_partkey_prf#2968,l_discount_prf#2969,l_partkey_and_l_suppkey_prf#2970,l_commitdate_prf#2971,l_suppkey_prf#2972,l_orderkey_prf#2973] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 152403ms

ft1b=
select * from nation, supplier, customer where n_name = 'FRANCE' and n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/16 22:13:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:13:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3053L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 22:13:24 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:13:24 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:13:24 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:13:24 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:13:24 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:13:24 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:13:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3053L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#3083]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#3066]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#3060: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#3055 AS rid_0#3060, n_regionkey_prf#3056 AS n_regionkey_prf_0#3061, n_nationkey_prf#3057 AS n_nationkey_prf_0#3062, n_name_prf#3058 AS n_name_prf_0#3063, n_comment_prf#3059 AS n_comment_prf_0#3064]
         :     :  :     :  :  +- Relation[rid#3055,n_regionkey_prf#3056,n_nationkey_prf#3057,n_name_prf#3058,n_comment_prf#3059] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3065]
         :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#3067 AS s_phone_prf_1#3075, rid#3068 AS rid_1#3076, s_address_prf#3069 AS s_address_prf_1#3077, s_nationkey_prf#3070 AS s_nationkey_prf_1#3078, s_suppkey_prf#3071 AS s_suppkey_prf_1#3079, s_name_prf#3072 AS s_name_prf_1#3080, s_acctbal_prf#3073 AS s_acctbal_prf_1#3081, s_comment_prf#3074 AS s_comment_prf_1#3082]
         :     :     +- Relation[s_phone_prf#3067,rid#3068,s_address_prf#3069,s_nationkey_prf#3070,s_suppkey_prf#3071,s_name_prf#3072,s_acctbal_prf#3073,s_comment_prf#3074] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3084 AS c_acctbal_prf_2#3093, rid#3085 AS rid_2#3094, c_name_prf#3086 AS c_name_prf_2#3095, c_nationkey_prf#3087 AS c_nationkey_prf_2#3096, c_custkey_prf#3088 AS c_custkey_prf_2#3097, c_comment_prf#3089 AS c_comment_prf_2#3098, c_address_prf#3090 AS c_address_prf_2#3099, c_mktsegment_prf#3091 AS c_mktsegment_prf_2#3100, c_phone_prf#3092 AS c_phone_prf_2#3101]
            +- Relation[c_acctbal_prf#3084,rid#3085,c_name_prf#3086,c_nationkey_prf#3087,c_custkey_prf#3088,c_comment_prf#3089,c_address_prf#3090,c_mktsegment_prf#3091,c_phone_prf#3092] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 30116ms

fq1b=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 22:13:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:13:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3164L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 22:13:54 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:13:54 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:13:54 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:13:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3164L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#3196]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#3177]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#3171: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#3166 AS rid_0#3171, n_regionkey_prf#3167 AS n_regionkey_prf_0#3172, n_nationkey_prf#3168 AS n_nationkey_prf_0#3173, n_name_prf#3169 AS n_name_prf_0#3174, n_comment_prf#3170 AS n_comment_prf_0#3175]
         :     :  :     :  :  +- Relation[rid#3166,n_regionkey_prf#3167,n_nationkey_prf#3168,n_name_prf#3169,n_comment_prf#3170] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3176]
         :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#3178 AS c_acctbal_prf_1#3187, rid#3179 AS rid_1#3188, c_name_prf#3180 AS c_name_prf_1#3189, c_nationkey_prf#3181 AS c_nationkey_prf_1#3190, c_custkey_prf#3182 AS c_custkey_prf_1#3191, c_comment_prf#3183 AS c_comment_prf_1#3192, c_address_prf#3184 AS c_address_prf_1#3193, c_mktsegment_prf#3185 AS c_mktsegment_prf_1#3194, c_phone_prf#3186 AS c_phone_prf_1#3195]
         :     :     +- Relation[c_acctbal_prf#3178,rid#3179,c_name_prf#3180,c_nationkey_prf#3181,c_custkey_prf#3182,c_comment_prf#3183,c_address_prf#3184,c_mktsegment_prf#3185,c_phone_prf#3186] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- Project [o_shippriority_prf#3197 AS o_shippriority_prf_2#3207, rid#3198 AS rid_2#3208, o_orderdate_prf#3199 AS o_orderdate_prf_2#3209, o_custkey_prf#3200 AS o_custkey_prf_2#3210, o_orderpriority_prf#3201 AS o_orderpriority_prf_2#3211, o_clerk_prf#3202 AS o_clerk_prf_2#3212, o_orderstatus_prf#3203 AS o_orderstatus_prf_2#3213, o_totalprice_prf#3204 AS o_totalprice_prf_2#3214, o_orderkey_prf#3205 AS o_orderkey_prf_2#3215, o_comment_prf#3206 AS o_comment_prf_2#3216]
            :  :  +- Relation[o_shippriority_prf#3197,rid#3198,o_orderdate_prf#3199,o_custkey_prf#3200,o_orderpriority_prf#3201,o_clerk_prf#3202,o_orderstatus_prf#3203,o_totalprice_prf#3204,o_orderkey_prf#3205,o_comment_prf#3206] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2110) AS rid_3#3228]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#3227]
            :        :  +- Relation[o_shippriority_prf#3217,rid#3218,o_orderdate_prf#3219,o_custkey_prf#3220,o_orderpriority_prf#3221,o_clerk_prf#3222,o_orderstatus_prf#3223,o_totalprice_prf#3224,o_orderkey_prf#3225,o_comment_prf#3226] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3229 AS l_returnflag_prf_3#3248, l_orderkey_and_l_linenumber_prf#3230 AS l_orderkey_and_l_linenumber_prf_3#3249, l_comment_prf#3231 AS l_comment_prf_3#3250, l_linestatus_prf#3232 AS l_linestatus_prf_3#3251, rid#3233 AS rid_3#3252, l_shipmode_prf#3234 AS l_shipmode_prf_3#3253, l_shipinstruct_prf#3235 AS l_shipinstruct_prf_3#3254, l_quantity_prf#3236 AS l_quantity_prf_3#3255, l_receiptdate_prf#3237 AS l_receiptdate_prf_3#3256, l_linenumber_prf#3238 AS l_linenumber_prf_3#3257, l_tax_prf#3239 AS l_tax_prf_3#3258, l_shipdate_prf#3240 AS l_shipdate_prf_3#3259, l_extendedprice_prf#3241 AS l_extendedprice_prf_3#3260, l_partkey_prf#3242 AS l_partkey_prf_3#3261, l_discount_prf#3243 AS l_discount_prf_3#3262, l_partkey_and_l_suppkey_prf#3244 AS l_partkey_and_l_suppkey_prf_3#3263, l_commitdate_prf#3245 AS l_commitdate_prf_3#3264, l_suppkey_prf#3246 AS l_suppkey_prf_3#3265, l_orderkey_prf#3247 AS l_orderkey_prf_3#3266]
               +- Relation[l_returnflag_prf#3229,l_orderkey_and_l_linenumber_prf#3230,l_comment_prf#3231,l_linestatus_prf#3232,rid#3233,l_shipmode_prf#3234,l_shipinstruct_prf#3235,l_quantity_prf#3236,l_receiptdate_prf#3237,l_linenumber_prf#3238,l_tax_prf#3239,l_shipdate_prf#3240,l_extendedprice_prf#3241,l_partkey_prf#3242,l_discount_prf#3243,l_partkey_and_l_suppkey_prf#3244,l_commitdate_prf#3245,l_suppkey_prf#3246,l_orderkey_prf#3247] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 140344ms

ft2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and (p_size = 15 and s_suppkey = ps_suppkey)
19/10/16 22:16:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:16:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3334L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/16 22:16:15 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:16:15 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:16:15 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 22:16:15 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:16:15 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 22:16:15 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 22:16:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3334L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#3336 AS s_phone_prf_0#3344, rid#3337 AS rid_0#3345, s_address_prf#3338 AS s_address_prf_0#3346, s_nationkey_prf#3339 AS s_nationkey_prf_0#3347, s_suppkey_prf#3340 AS s_suppkey_prf_0#3348, s_name_prf#3341 AS s_name_prf_0#3349, s_acctbal_prf#3342 AS s_acctbal_prf_0#3350, s_comment_prf#3343 AS s_comment_prf_0#3351]
         :  :  +- Relation[s_phone_prf#3336,rid#3337,s_address_prf#3338,s_nationkey_prf#3339,s_suppkey_prf#3340,s_name_prf#3341,s_acctbal_prf#3342,s_comment_prf#3343] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_2#3361]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3360]
         :        :  +- Relation[s_phone_prf#3352,rid#3353,s_address_prf#3354,s_nationkey_prf#3355,s_suppkey_prf#3356,s_name_prf#3357,s_acctbal_prf#3358,s_comment_prf#3359] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#3383]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#3374: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#3362 AS p_comment_prf_1#3372, p_name_prf#3363 AS p_name_prf_1#3373, rid#3364 AS rid_1#3374, p_type_prf#3365 AS p_type_prf_1#3375, p_retailprice_prf#3366 AS p_retailprice_prf_1#3376, p_mfgr_prf#3367 AS p_mfgr_prf_1#3377, p_container_prf#3368 AS p_container_prf_1#3378, p_brand_prf#3369 AS p_brand_prf_1#3379, p_size_prf#3370 AS p_size_prf_1#3380, p_partkey_prf#3371 AS p_partkey_prf_1#3381]
            :     :  :  +- Relation[p_comment_prf#3362,p_name_prf#3363,rid#3364,p_type_prf#3365,p_retailprice_prf#3366,p_mfgr_prf#3367,p_container_prf#3368,p_brand_prf#3369,p_size_prf#3370,p_partkey_prf#3371] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3382]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#3384 AS ps_partkey_and_ps_suppkey_prf_2#3391, rid#3385 AS rid_2#3392, ps_availqty_prf#3386 AS ps_availqty_prf_2#3393, ps_comment_prf#3387 AS ps_comment_prf_2#3394, ps_partkey_prf#3388 AS ps_partkey_prf_2#3395, ps_supplycost_prf#3389 AS ps_supplycost_prf_2#3396, ps_suppkey_prf#3390 AS ps_suppkey_prf_2#3397]
               +- Relation[ps_partkey_and_ps_suppkey_prf#3384,rid#3385,ps_availqty_prf#3386,ps_comment_prf#3387,ps_partkey_prf#3388,ps_supplycost_prf#3389,ps_suppkey_prf#3390] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 7012ms

fr2e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/16 22:16:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:16:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3459L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 22:16:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3459L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#3461 AS c_acctbal_prf_0#3470, rid#3462 AS rid_0#3471, c_name_prf#3463 AS c_name_prf_0#3472, c_nationkey_prf#3464 AS c_nationkey_prf_0#3473, c_custkey_prf#3465 AS c_custkey_prf_0#3474, c_comment_prf#3466 AS c_comment_prf_0#3475, c_address_prf#3467 AS c_address_prf_0#3476, c_mktsegment_prf#3468 AS c_mktsegment_prf_0#3477, c_phone_prf#3469 AS c_phone_prf_0#3478]
         :  :  +- Relation[c_acctbal_prf#3461,rid#3462,c_name_prf#3463,c_nationkey_prf#3464,c_custkey_prf#3465,c_comment_prf#3466,c_address_prf#3467,c_mktsegment_prf#3468,c_phone_prf#3469] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#3489]
         :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3488]
         :        :  +- Relation[c_acctbal_prf#3479,rid#3480,c_name_prf#3481,c_nationkey_prf#3482,c_custkey_prf#3483,c_comment_prf#3484,c_address_prf#3485,c_mktsegment_prf#3486,c_phone_prf#3487] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#3511]
            :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#3501: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#3490 AS o_shippriority_prf_1#3500, rid#3491 AS rid_1#3501, o_orderdate_prf#3492 AS o_orderdate_prf_1#3502, o_custkey_prf#3493 AS o_custkey_prf_1#3503, o_orderpriority_prf#3494 AS o_orderpriority_prf_1#3504, o_clerk_prf#3495 AS o_clerk_prf_1#3505, o_orderstatus_prf#3496 AS o_orderstatus_prf_1#3506, o_totalprice_prf#3497 AS o_totalprice_prf_1#3507, o_orderkey_prf#3498 AS o_orderkey_prf_1#3508, o_comment_prf#3499 AS o_comment_prf_1#3509]
            :     :  :  +- Relation[o_shippriority_prf#3490,rid#3491,o_orderdate_prf#3492,o_custkey_prf#3493,o_orderpriority_prf#3494,o_clerk_prf#3495,o_orderstatus_prf#3496,o_totalprice_prf#3497,o_orderkey_prf#3498,o_comment_prf#3499] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3510]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3512 AS l_returnflag_prf_2#3531, l_orderkey_and_l_linenumber_prf#3513 AS l_orderkey_and_l_linenumber_prf_2#3532, l_comment_prf#3514 AS l_comment_prf_2#3533, l_linestatus_prf#3515 AS l_linestatus_prf_2#3534, rid#3516 AS rid_2#3535, l_shipmode_prf#3517 AS l_shipmode_prf_2#3536, l_shipinstruct_prf#3518 AS l_shipinstruct_prf_2#3537, l_quantity_prf#3519 AS l_quantity_prf_2#3538, l_receiptdate_prf#3520 AS l_receiptdate_prf_2#3539, l_linenumber_prf#3521 AS l_linenumber_prf_2#3540, l_tax_prf#3522 AS l_tax_prf_2#3541, l_shipdate_prf#3523 AS l_shipdate_prf_2#3542, l_extendedprice_prf#3524 AS l_extendedprice_prf_2#3543, l_partkey_prf#3525 AS l_partkey_prf_2#3544, l_discount_prf#3526 AS l_discount_prf_2#3545, l_partkey_and_l_suppkey_prf#3527 AS l_partkey_and_l_suppkey_prf_2#3546, l_commitdate_prf#3528 AS l_commitdate_prf_2#3547, l_suppkey_prf#3529 AS l_suppkey_prf_2#3548, l_orderkey_prf#3530 AS l_orderkey_prf_2#3549]
               +- Relation[l_returnflag_prf#3512,l_orderkey_and_l_linenumber_prf#3513,l_comment_prf#3514,l_linestatus_prf#3515,rid#3516,l_shipmode_prf#3517,l_shipinstruct_prf#3518,l_quantity_prf#3519,l_receiptdate_prf#3520,l_linenumber_prf#3521,l_tax_prf#3522,l_shipdate_prf#3523,l_extendedprice_prf#3524,l_partkey_prf#3525,l_discount_prf#3526,l_partkey_and_l_suppkey_prf#3527,l_commitdate_prf#3528,l_suppkey_prf#3529,l_orderkey_prf#3530] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 95998ms

fs1c=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/16 22:17:58 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:17:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3633L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_orderkey#306L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 22:17:58 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:17:58 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:17:58 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:17:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3633L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [p_comment_prf#3635 AS p_comment_prf_0#3645, p_name_prf#3636 AS p_name_prf_0#3646, rid#3637 AS rid_0#3647, p_type_prf#3638 AS p_type_prf_0#3648, p_retailprice_prf#3639 AS p_retailprice_prf_0#3649, p_mfgr_prf#3640 AS p_mfgr_prf_0#3650, p_container_prf#3641 AS p_container_prf_0#3651, p_brand_prf#3642 AS p_brand_prf_0#3652, p_size_prf#3643 AS p_size_prf_0#3653, p_partkey_prf#3644 AS p_partkey_prf_0#3654]
         :  :  :  :  +- Relation[p_comment_prf#3635,p_name_prf#3636,rid#3637,p_type_prf#3638,p_retailprice_prf#3639,p_mfgr_prf#3640,p_container_prf#3641,p_brand_prf#3642,p_size_prf#3643,p_partkey_prf#3644] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#3666]
         :  :  :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#3665]
         :  :  :        :  +- Relation[p_comment_prf#3655,p_name_prf#3656,rid#3657,p_type_prf#3658,p_retailprice_prf#3659,p_mfgr_prf#3660,p_container_prf#3661,p_brand_prf#3662,p_size_prf#3663,p_partkey_prf#3664] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#3667 AS l_returnflag_prf_1#3686, l_orderkey_and_l_linenumber_prf#3668 AS l_orderkey_and_l_linenumber_prf_1#3687, l_comment_prf#3669 AS l_comment_prf_1#3688, l_linestatus_prf#3670 AS l_linestatus_prf_1#3689, rid#3671 AS rid_1#3690, l_shipmode_prf#3672 AS l_shipmode_prf_1#3691, l_shipinstruct_prf#3673 AS l_shipinstruct_prf_1#3692, l_quantity_prf#3674 AS l_quantity_prf_1#3693, l_receiptdate_prf#3675 AS l_receiptdate_prf_1#3694, l_linenumber_prf#3676 AS l_linenumber_prf_1#3695, l_tax_prf#3677 AS l_tax_prf_1#3696, l_shipdate_prf#3678 AS l_shipdate_prf_1#3697, l_extendedprice_prf#3679 AS l_extendedprice_prf_1#3698, l_partkey_prf#3680 AS l_partkey_prf_1#3699, l_discount_prf#3681 AS l_discount_prf_1#3700, l_partkey_and_l_suppkey_prf#3682 AS l_partkey_and_l_suppkey_prf_1#3701, l_commitdate_prf#3683 AS l_commitdate_prf_1#3702, l_suppkey_prf#3684 AS l_suppkey_prf_1#3703, l_orderkey_prf#3685 AS l_orderkey_prf_1#3704]
         :  :     +- Relation[l_returnflag_prf#3667,l_orderkey_and_l_linenumber_prf#3668,l_comment_prf#3669,l_linestatus_prf#3670,rid#3671,l_shipmode_prf#3672,l_shipinstruct_prf#3673,l_quantity_prf#3674,l_receiptdate_prf#3675,l_linenumber_prf#3676,l_tax_prf#3677,l_shipdate_prf#3678,l_extendedprice_prf#3679,l_partkey_prf#3680,l_discount_prf#3681,l_partkey_and_l_suppkey_prf#3682,l_commitdate_prf#3683,l_suppkey_prf#3684,l_orderkey_prf#3685] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2110) AS rid_3#3725]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3724]
         :        :  +- Relation[l_returnflag_prf#3705,l_orderkey_and_l_linenumber_prf#3706,l_comment_prf#3707,l_linestatus_prf#3708,rid#3709,l_shipmode_prf#3710,l_shipinstruct_prf#3711,l_quantity_prf#3712,l_receiptdate_prf#3713,l_linenumber_prf#3714,l_tax_prf#3715,l_shipdate_prf#3716,l_extendedprice_prf#3717,l_partkey_prf#3718,l_discount_prf#3719,l_partkey_and_l_suppkey_prf#3720,l_commitdate_prf#3721,l_suppkey_prf#3722,l_orderkey_prf#3723] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_2, 'rid_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2110) AS rid_3#3745]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_2#3736: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [c_acctbal_prf#3726 AS c_acctbal_prf_2#3735, rid#3727 AS rid_2#3736, c_name_prf#3728 AS c_name_prf_2#3737, c_nationkey_prf#3729 AS c_nationkey_prf_2#3738, c_custkey_prf#3730 AS c_custkey_prf_2#3739, c_comment_prf#3731 AS c_comment_prf_2#3740, c_address_prf#3732 AS c_address_prf_2#3741, c_mktsegment_prf#3733 AS c_mktsegment_prf_2#3742, c_phone_prf#3734 AS c_phone_prf_2#3743]
            :     :  :  +- Relation[c_acctbal_prf#3726,rid#3727,c_name_prf#3728,c_nationkey_prf#3729,c_custkey_prf#3730,c_comment_prf#3731,c_address_prf#3732,c_mktsegment_prf#3733,c_phone_prf#3734] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#3744]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3746 AS o_shippriority_prf_3#3756, rid#3747 AS rid_3#3757, o_orderdate_prf#3748 AS o_orderdate_prf_3#3758, o_custkey_prf#3749 AS o_custkey_prf_3#3759, o_orderpriority_prf#3750 AS o_orderpriority_prf_3#3760, o_clerk_prf#3751 AS o_clerk_prf_3#3761, o_orderstatus_prf#3752 AS o_orderstatus_prf_3#3762, o_totalprice_prf#3753 AS o_totalprice_prf_3#3763, o_orderkey_prf#3754 AS o_orderkey_prf_3#3764, o_comment_prf#3755 AS o_comment_prf_3#3765]
               +- Relation[o_shippriority_prf#3746,rid#3747,o_orderdate_prf#3748,o_custkey_prf#3749,o_orderpriority_prf#3750,o_clerk_prf#3751,o_orderstatus_prf#3752,o_totalprice_prf#3753,o_orderkey_prf#3754,o_comment_prf#3755] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 172973ms

ft2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and p_size = 15 and ps_suppkey = s_suppkey
19/10/16 22:20:51 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:20:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3838L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 22:20:51 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 22:20:51 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 22:20:51 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 22:20:51 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 22:20:51 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:20:51 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:20:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3838L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#3884]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, rid_0#3848: string
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [ps_partkey_and_ps_suppkey_prf#3840 AS ps_partkey_and_ps_suppkey_prf_0#3847, rid#3841 AS rid_0#3848, ps_availqty_prf#3842 AS ps_availqty_prf_0#3849, ps_comment_prf#3843 AS ps_comment_prf_0#3850, ps_partkey_prf#3844 AS ps_partkey_prf_0#3851, ps_supplycost_prf#3845 AS ps_supplycost_prf_0#3852, ps_suppkey_prf#3846 AS ps_suppkey_prf_0#3853]
         :     :  :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#3840,rid#3841,ps_availqty_prf#3842,ps_comment_prf#3843,ps_partkey_prf#3844,ps_supplycost_prf#3845,ps_suppkey_prf#3846] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#3862]
         :     :  :     +- 'DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#3861]
         :     :  :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#3854,rid#3855,ps_availqty_prf#3856,ps_comment_prf#3857,ps_partkey_prf#3858,ps_supplycost_prf#3859,ps_suppkey_prf#3860] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [p_comment_prf#3863 AS p_comment_prf_1#3873, p_name_prf#3864 AS p_name_prf_1#3874, rid#3865 AS rid_1#3875, p_type_prf#3866 AS p_type_prf_1#3876, p_retailprice_prf#3867 AS p_retailprice_prf_1#3877, p_mfgr_prf#3868 AS p_mfgr_prf_1#3878, p_container_prf#3869 AS p_container_prf_1#3879, p_brand_prf#3870 AS p_brand_prf_1#3880, p_size_prf#3871 AS p_size_prf_1#3881, p_partkey_prf#3872 AS p_partkey_prf_1#3882]
         :     :     :  +- Relation[p_comment_prf#3863,p_name_prf#3864,rid#3865,p_type_prf#3866,p_retailprice_prf#3867,p_mfgr_prf#3868,p_container_prf#3869,p_brand_prf#3870,p_size_prf#3871,p_partkey_prf#3872] JDBCRelation(part_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3883]
         :     :        +- DexRidFilter part~p_size~15
         :     :           +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3885 AS s_phone_prf_2#3893, rid#3886 AS rid_2#3894, s_address_prf#3887 AS s_address_prf_2#3895, s_nationkey_prf#3888 AS s_nationkey_prf_2#3896, s_suppkey_prf#3889 AS s_suppkey_prf_2#3897, s_name_prf#3890 AS s_name_prf_2#3898, s_acctbal_prf#3891 AS s_acctbal_prf_2#3899, s_comment_prf#3892 AS s_comment_prf_2#3900]
            +- Relation[s_phone_prf#3885,rid#3886,s_address_prf#3887,s_nationkey_prf#3888,s_suppkey_prf#3889,s_name_prf#3890,s_acctbal_prf#3891,s_comment_prf#3892] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 49080ms

fr2b=
select * from lineitem, orders, customer where o_custkey = c_custkey and o_orderstatus = 'F' and l_orderkey = o_orderkey
19/10/16 22:21:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:21:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3962L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 22:21:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3962L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#3964 AS l_returnflag_prf_0#3983, l_orderkey_and_l_linenumber_prf#3965 AS l_orderkey_and_l_linenumber_prf_0#3984, l_comment_prf#3966 AS l_comment_prf_0#3985, l_linestatus_prf#3967 AS l_linestatus_prf_0#3986, rid#3968 AS rid_0#3987, l_shipmode_prf#3969 AS l_shipmode_prf_0#3988, l_shipinstruct_prf#3970 AS l_shipinstruct_prf_0#3989, l_quantity_prf#3971 AS l_quantity_prf_0#3990, l_receiptdate_prf#3972 AS l_receiptdate_prf_0#3991, l_linenumber_prf#3973 AS l_linenumber_prf_0#3992, l_tax_prf#3974 AS l_tax_prf_0#3993, l_shipdate_prf#3975 AS l_shipdate_prf_0#3994, l_extendedprice_prf#3976 AS l_extendedprice_prf_0#3995, l_partkey_prf#3977 AS l_partkey_prf_0#3996, l_discount_prf#3978 AS l_discount_prf_0#3997, l_partkey_and_l_suppkey_prf#3979 AS l_partkey_and_l_suppkey_prf_0#3998, l_commitdate_prf#3980 AS l_commitdate_prf_0#3999, l_suppkey_prf#3981 AS l_suppkey_prf_0#4000, l_orderkey_prf#3982 AS l_orderkey_prf_0#4001]
         :  :  +- Relation[l_returnflag_prf#3964,l_orderkey_and_l_linenumber_prf#3965,l_comment_prf#3966,l_linestatus_prf#3967,rid#3968,l_shipmode_prf#3969,l_shipinstruct_prf#3970,l_quantity_prf#3971,l_receiptdate_prf#3972,l_linenumber_prf#3973,l_tax_prf#3974,l_shipdate_prf#3975,l_extendedprice_prf#3976,l_partkey_prf#3977,l_discount_prf#3978,l_partkey_and_l_suppkey_prf#3979,l_commitdate_prf#3980,l_suppkey_prf#3981,l_orderkey_prf#3982] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#4022]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4021]
         :        :  +- Relation[l_returnflag_prf#4002,l_orderkey_and_l_linenumber_prf#4003,l_comment_prf#4004,l_linestatus_prf#4005,rid#4006,l_shipmode_prf#4007,l_shipinstruct_prf#4008,l_quantity_prf#4009,l_receiptdate_prf#4010,l_linenumber_prf#4011,l_tax_prf#4012,l_shipdate_prf#4013,l_extendedprice_prf#4014,l_partkey_prf#4015,l_discount_prf#4016,l_partkey_and_l_suppkey_prf#4017,l_commitdate_prf#4018,l_suppkey_prf#4019,l_orderkey_prf#4020] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#4044]
            :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#4034: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#4023 AS o_shippriority_prf_1#4033, rid#4024 AS rid_1#4034, o_orderdate_prf#4025 AS o_orderdate_prf_1#4035, o_custkey_prf#4026 AS o_custkey_prf_1#4036, o_orderpriority_prf#4027 AS o_orderpriority_prf_1#4037, o_clerk_prf#4028 AS o_clerk_prf_1#4038, o_orderstatus_prf#4029 AS o_orderstatus_prf_1#4039, o_totalprice_prf#4030 AS o_totalprice_prf_1#4040, o_orderkey_prf#4031 AS o_orderkey_prf_1#4041, o_comment_prf#4032 AS o_comment_prf_1#4042]
            :     :  :  +- Relation[o_shippriority_prf#4023,rid#4024,o_orderdate_prf#4025,o_custkey_prf#4026,o_orderpriority_prf#4027,o_clerk_prf#4028,o_orderstatus_prf#4029,o_totalprice_prf#4030,o_orderkey_prf#4031,o_comment_prf#4032] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4043]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4045 AS c_acctbal_prf_2#4054, rid#4046 AS rid_2#4055, c_name_prf#4047 AS c_name_prf_2#4056, c_nationkey_prf#4048 AS c_nationkey_prf_2#4057, c_custkey_prf#4049 AS c_custkey_prf_2#4058, c_comment_prf#4050 AS c_comment_prf_2#4059, c_address_prf#4051 AS c_address_prf_2#4060, c_mktsegment_prf#4052 AS c_mktsegment_prf_2#4061, c_phone_prf#4053 AS c_phone_prf_2#4062]
               +- Relation[c_acctbal_prf#4045,rid#4046,c_name_prf#4047,c_nationkey_prf#4048,c_custkey_prf#4049,c_comment_prf#4050,c_address_prf#4051,c_mktsegment_prf#4052,c_phone_prf#4053] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 105891ms

ft1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_name = 'FRANCE' and n_nationkey = c_nationkey
19/10/16 22:23:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:23:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4123L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 22:23:26 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:23:26 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:23:26 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:23:26 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:23:26 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:23:26 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:23:26 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:23:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4123L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#4162]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [s_phone_prf#4125 AS s_phone_prf_0#4133, rid#4126 AS rid_0#4134, s_address_prf#4127 AS s_address_prf_0#4135, s_nationkey_prf#4128 AS s_nationkey_prf_0#4136, s_suppkey_prf#4129 AS s_suppkey_prf_0#4137, s_name_prf#4130 AS s_name_prf_0#4138, s_acctbal_prf#4131 AS s_acctbal_prf_0#4139, s_comment_prf#4132 AS s_comment_prf_0#4140]
         :     :  :  :  +- Relation[s_phone_prf#4125,rid#4126,s_address_prf#4127,s_nationkey_prf#4128,s_suppkey_prf#4129,s_name_prf#4130,s_acctbal_prf#4131,s_comment_prf#4132] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#4150]
         :     :  :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#4149]
         :     :  :        :  +- Relation[s_phone_prf#4141,rid#4142,s_address_prf#4143,s_nationkey_prf#4144,s_suppkey_prf#4145,s_name_prf#4146,s_acctbal_prf#4147,s_comment_prf#4148] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [rid#4151 AS rid_1#4156, n_regionkey_prf#4152 AS n_regionkey_prf_1#4157, n_nationkey_prf#4153 AS n_nationkey_prf_1#4158, n_name_prf#4154 AS n_name_prf_1#4159, n_comment_prf#4155 AS n_comment_prf_1#4160]
         :     :     :  +- Relation[rid#4151,n_regionkey_prf#4152,n_nationkey_prf#4153,n_name_prf#4154,n_comment_prf#4155] JDBCRelation(nation_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4161]
         :     :        +- DexRidFilter nation~n_name~FRANCE
         :     :           +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4163 AS c_acctbal_prf_2#4172, rid#4164 AS rid_2#4173, c_name_prf#4165 AS c_name_prf_2#4174, c_nationkey_prf#4166 AS c_nationkey_prf_2#4175, c_custkey_prf#4167 AS c_custkey_prf_2#4176, c_comment_prf#4168 AS c_comment_prf_2#4177, c_address_prf#4169 AS c_address_prf_2#4178, c_mktsegment_prf#4170 AS c_mktsegment_prf_2#4179, c_phone_prf#4171 AS c_phone_prf_2#4180]
            +- Relation[c_acctbal_prf#4163,rid#4164,c_name_prf#4165,c_nationkey_prf#4166,c_custkey_prf#4167,c_comment_prf#4168,c_address_prf#4169,c_mktsegment_prf#4170,c_phone_prf#4171] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 47770ms

fq1f=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 22:24:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:24:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4243L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/16 22:24:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:24:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:24:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:24:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4243L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- Project [l_returnflag_prf#4245 AS l_returnflag_prf_0#4264, l_orderkey_and_l_linenumber_prf#4246 AS l_orderkey_and_l_linenumber_prf_0#4265, l_comment_prf#4247 AS l_comment_prf_0#4266, l_linestatus_prf#4248 AS l_linestatus_prf_0#4267, rid#4249 AS rid_0#4268, l_shipmode_prf#4250 AS l_shipmode_prf_0#4269, l_shipinstruct_prf#4251 AS l_shipinstruct_prf_0#4270, l_quantity_prf#4252 AS l_quantity_prf_0#4271, l_receiptdate_prf#4253 AS l_receiptdate_prf_0#4272, l_linenumber_prf#4254 AS l_linenumber_prf_0#4273, l_tax_prf#4255 AS l_tax_prf_0#4274, l_shipdate_prf#4256 AS l_shipdate_prf_0#4275, l_extendedprice_prf#4257 AS l_extendedprice_prf_0#4276, l_partkey_prf#4258 AS l_partkey_prf_0#4277, l_discount_prf#4259 AS l_discount_prf_0#4278, l_partkey_and_l_suppkey_prf#4260 AS l_partkey_and_l_suppkey_prf_0#4279, l_commitdate_prf#4261 AS l_commitdate_prf_0#4280, l_suppkey_prf#4262 AS l_suppkey_prf_0#4281, l_orderkey_prf#4263 AS l_orderkey_prf_0#4282]
         :  :  :  :  :  :  +- Relation[l_returnflag_prf#4245,l_orderkey_and_l_linenumber_prf#4246,l_comment_prf#4247,l_linestatus_prf#4248,rid#4249,l_shipmode_prf#4250,l_shipinstruct_prf#4251,l_quantity_prf#4252,l_receiptdate_prf#4253,l_linenumber_prf#4254,l_tax_prf#4255,l_shipdate_prf#4256,l_extendedprice_prf#4257,l_partkey_prf#4258,l_discount_prf#4259,l_partkey_and_l_suppkey_prf#4260,l_commitdate_prf#4261,l_suppkey_prf#4262,l_orderkey_prf#4263] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#4303]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :  :  :        :- 'Project ['rid AS rid_0#4302]
         :  :  :  :  :        :  +- Relation[l_returnflag_prf#4283,l_orderkey_and_l_linenumber_prf#4284,l_comment_prf#4285,l_linestatus_prf#4286,rid#4287,l_shipmode_prf#4288,l_shipinstruct_prf#4289,l_quantity_prf#4290,l_receiptdate_prf#4291,l_linenumber_prf#4292,l_tax_prf#4293,l_shipdate_prf#4294,l_extendedprice_prf#4295,l_partkey_prf#4296,l_discount_prf#4297,l_partkey_and_l_suppkey_prf#4298,l_commitdate_prf#4299,l_suppkey_prf#4300,l_orderkey_prf#4301] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [o_shippriority_prf#4304 AS o_shippriority_prf_1#4314, rid#4305 AS rid_1#4315, o_orderdate_prf#4306 AS o_orderdate_prf_1#4316, o_custkey_prf#4307 AS o_custkey_prf_1#4317, o_orderpriority_prf#4308 AS o_orderpriority_prf_1#4318, o_clerk_prf#4309 AS o_clerk_prf_1#4319, o_orderstatus_prf#4310 AS o_orderstatus_prf_1#4320, o_totalprice_prf#4311 AS o_totalprice_prf_1#4321, o_orderkey_prf#4312 AS o_orderkey_prf_1#4322, o_comment_prf#4313 AS o_comment_prf_1#4323]
         :  :  :  :     +- Relation[o_shippriority_prf#4304,rid#4305,o_orderdate_prf#4306,o_custkey_prf#4307,o_orderpriority_prf#4308,o_clerk_prf#4309,o_orderstatus_prf#4310,o_totalprice_prf#4311,o_orderkey_prf#4312,o_comment_prf#4313] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#4335]
         :  :  :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :  :  :        :- 'Project ['rid AS rid_1#4334]
         :  :  :        :  +- Relation[o_shippriority_prf#4324,rid#4325,o_orderdate_prf#4326,o_custkey_prf#4327,o_orderpriority_prf#4328,o_clerk_prf#4329,o_orderstatus_prf#4330,o_totalprice_prf#4331,o_orderkey_prf#4332,o_comment_prf#4333] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#4336 AS c_acctbal_prf_2#4345, rid#4337 AS rid_2#4346, c_name_prf#4338 AS c_name_prf_2#4347, c_nationkey_prf#4339 AS c_nationkey_prf_2#4348, c_custkey_prf#4340 AS c_custkey_prf_2#4349, c_comment_prf#4341 AS c_comment_prf_2#4350, c_address_prf#4342 AS c_address_prf_2#4351, c_mktsegment_prf#4343 AS c_mktsegment_prf_2#4352, c_phone_prf#4344 AS c_phone_prf_2#4353]
         :  :     +- Relation[c_acctbal_prf#4336,rid#4337,c_name_prf#4338,c_nationkey_prf#4339,c_custkey_prf#4340,c_comment_prf#4341,c_address_prf#4342,c_mktsegment_prf#4343,c_phone_prf#4344] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2110) AS rid_3#4364]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#4363]
         :        :  +- Relation[c_acctbal_prf#4354,rid#4355,c_name_prf#4356,c_nationkey_prf#4357,c_custkey_prf#4358,c_comment_prf#4359,c_address_prf#4360,c_mktsegment_prf#4361,c_phone_prf#4362] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_3))
            :- Project [rid#4365 AS rid_3#4370, n_regionkey_prf#4366 AS n_regionkey_prf_3#4371, n_nationkey_prf#4367 AS n_nationkey_prf_3#4372, n_name_prf#4368 AS n_name_prf_3#4373, n_comment_prf#4369 AS n_comment_prf_3#4374]
            :  +- Relation[rid#4365,n_regionkey_prf#4366,n_nationkey_prf#4367,n_name_prf#4368,n_comment_prf#4369] JDBCRelation(nation_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#4375]
               +- DexRidFilter nation~n_name~FRANCE
                  +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 168519ms

fr2a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_orderstatus = 'F' and o_custkey = c_custkey
19/10/16 22:27:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:27:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4455L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 22:27:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4455L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [l_returnflag_prf#4457 AS l_returnflag_prf_0#4476, l_orderkey_and_l_linenumber_prf#4458 AS l_orderkey_and_l_linenumber_prf_0#4477, l_comment_prf#4459 AS l_comment_prf_0#4478, l_linestatus_prf#4460 AS l_linestatus_prf_0#4479, rid#4461 AS rid_0#4480, l_shipmode_prf#4462 AS l_shipmode_prf_0#4481, l_shipinstruct_prf#4463 AS l_shipinstruct_prf_0#4482, l_quantity_prf#4464 AS l_quantity_prf_0#4483, l_receiptdate_prf#4465 AS l_receiptdate_prf_0#4484, l_linenumber_prf#4466 AS l_linenumber_prf_0#4485, l_tax_prf#4467 AS l_tax_prf_0#4486, l_shipdate_prf#4468 AS l_shipdate_prf_0#4487, l_extendedprice_prf#4469 AS l_extendedprice_prf_0#4488, l_partkey_prf#4470 AS l_partkey_prf_0#4489, l_discount_prf#4471 AS l_discount_prf_0#4490, l_partkey_and_l_suppkey_prf#4472 AS l_partkey_and_l_suppkey_prf_0#4491, l_commitdate_prf#4473 AS l_commitdate_prf_0#4492, l_suppkey_prf#4474 AS l_suppkey_prf_0#4493, l_orderkey_prf#4475 AS l_orderkey_prf_0#4494]
         :     :  :  :  +- Relation[l_returnflag_prf#4457,l_orderkey_and_l_linenumber_prf#4458,l_comment_prf#4459,l_linestatus_prf#4460,rid#4461,l_shipmode_prf#4462,l_shipinstruct_prf#4463,l_quantity_prf#4464,l_receiptdate_prf#4465,l_linenumber_prf#4466,l_tax_prf#4467,l_shipdate_prf#4468,l_extendedprice_prf#4469,l_partkey_prf#4470,l_discount_prf#4471,l_partkey_and_l_suppkey_prf#4472,l_commitdate_prf#4473,l_suppkey_prf#4474,l_orderkey_prf#4475] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#4515]
         :     :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#4514]
         :     :  :        :  +- Relation[l_returnflag_prf#4495,l_orderkey_and_l_linenumber_prf#4496,l_comment_prf#4497,l_linestatus_prf#4498,rid#4499,l_shipmode_prf#4500,l_shipinstruct_prf#4501,l_quantity_prf#4502,l_receiptdate_prf#4503,l_linenumber_prf#4504,l_tax_prf#4505,l_shipdate_prf#4506,l_extendedprice_prf#4507,l_partkey_prf#4508,l_discount_prf#4509,l_partkey_and_l_suppkey_prf#4510,l_commitdate_prf#4511,l_suppkey_prf#4512,l_orderkey_prf#4513] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [o_shippriority_prf#4516 AS o_shippriority_prf_1#4526, rid#4517 AS rid_1#4527, o_orderdate_prf#4518 AS o_orderdate_prf_1#4528, o_custkey_prf#4519 AS o_custkey_prf_1#4529, o_orderpriority_prf#4520 AS o_orderpriority_prf_1#4530, o_clerk_prf#4521 AS o_clerk_prf_1#4531, o_orderstatus_prf#4522 AS o_orderstatus_prf_1#4532, o_totalprice_prf#4523 AS o_totalprice_prf_1#4533, o_orderkey_prf#4524 AS o_orderkey_prf_1#4534, o_comment_prf#4525 AS o_comment_prf_1#4535]
         :     :     :  +- Relation[o_shippriority_prf#4516,rid#4517,o_orderdate_prf#4518,o_custkey_prf#4519,o_orderpriority_prf#4520,o_clerk_prf#4521,o_orderstatus_prf#4522,o_totalprice_prf#4523,o_orderkey_prf#4524,o_comment_prf#4525] JDBCRelation(orders_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4536]
         :     :        +- DexRidFilter orders~o_orderstatus~F
         :     :           +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4538 AS c_acctbal_prf_2#4547, rid#4539 AS rid_2#4548, c_name_prf#4540 AS c_name_prf_2#4549, c_nationkey_prf#4541 AS c_nationkey_prf_2#4550, c_custkey_prf#4542 AS c_custkey_prf_2#4551, c_comment_prf#4543 AS c_comment_prf_2#4552, c_address_prf#4544 AS c_address_prf_2#4553, c_mktsegment_prf#4545 AS c_mktsegment_prf_2#4554, c_phone_prf#4546 AS c_phone_prf_2#4555]
            +- Relation[c_acctbal_prf#4538,rid#4539,c_name_prf#4540,c_nationkey_prf#4541,c_custkey_prf#4542,c_comment_prf#4543,c_address_prf#4544,c_mktsegment_prf#4545,c_phone_prf#4546] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 194047ms

ft3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and (p_size = 15 and s_suppkey = l_suppkey)
19/10/16 22:30:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:30:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4629L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 22:30:16 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:30:16 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:30:16 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:30:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4629L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#4631 AS s_phone_prf_0#4639, rid#4632 AS rid_0#4640, s_address_prf#4633 AS s_address_prf_0#4641, s_nationkey_prf#4634 AS s_nationkey_prf_0#4642, s_suppkey_prf#4635 AS s_suppkey_prf_0#4643, s_name_prf#4636 AS s_name_prf_0#4644, s_acctbal_prf#4637 AS s_acctbal_prf_0#4645, s_comment_prf#4638 AS s_comment_prf_0#4646]
         :  :  +- Relation[s_phone_prf#4631,rid#4632,s_address_prf#4633,s_nationkey_prf#4634,s_suppkey_prf#4635,s_name_prf#4636,s_acctbal_prf#4637,s_comment_prf#4638] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_2#4656]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4655]
         :        :  +- Relation[s_phone_prf#4647,rid#4648,s_address_prf#4649,s_nationkey_prf#4650,s_suppkey_prf#4651,s_name_prf#4652,s_acctbal_prf#4653,s_comment_prf#4654] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#4678]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#4669: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#4657 AS p_comment_prf_1#4667, p_name_prf#4658 AS p_name_prf_1#4668, rid#4659 AS rid_1#4669, p_type_prf#4660 AS p_type_prf_1#4670, p_retailprice_prf#4661 AS p_retailprice_prf_1#4671, p_mfgr_prf#4662 AS p_mfgr_prf_1#4672, p_container_prf#4663 AS p_container_prf_1#4673, p_brand_prf#4664 AS p_brand_prf_1#4674, p_size_prf#4665 AS p_size_prf_1#4675, p_partkey_prf#4666 AS p_partkey_prf_1#4676]
            :     :  :  +- Relation[p_comment_prf#4657,p_name_prf#4658,rid#4659,p_type_prf#4660,p_retailprice_prf#4661,p_mfgr_prf#4662,p_container_prf#4663,p_brand_prf#4664,p_size_prf#4665,p_partkey_prf#4666] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4677]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4679 AS l_returnflag_prf_2#4698, l_orderkey_and_l_linenumber_prf#4680 AS l_orderkey_and_l_linenumber_prf_2#4699, l_comment_prf#4681 AS l_comment_prf_2#4700, l_linestatus_prf#4682 AS l_linestatus_prf_2#4701, rid#4683 AS rid_2#4702, l_shipmode_prf#4684 AS l_shipmode_prf_2#4703, l_shipinstruct_prf#4685 AS l_shipinstruct_prf_2#4704, l_quantity_prf#4686 AS l_quantity_prf_2#4705, l_receiptdate_prf#4687 AS l_receiptdate_prf_2#4706, l_linenumber_prf#4688 AS l_linenumber_prf_2#4707, l_tax_prf#4689 AS l_tax_prf_2#4708, l_shipdate_prf#4690 AS l_shipdate_prf_2#4709, l_extendedprice_prf#4691 AS l_extendedprice_prf_2#4710, l_partkey_prf#4692 AS l_partkey_prf_2#4711, l_discount_prf#4693 AS l_discount_prf_2#4712, l_partkey_and_l_suppkey_prf#4694 AS l_partkey_and_l_suppkey_prf_2#4713, l_commitdate_prf#4695 AS l_commitdate_prf_2#4714, l_suppkey_prf#4696 AS l_suppkey_prf_2#4715, l_orderkey_prf#4697 AS l_orderkey_prf_2#4716]
               +- Relation[l_returnflag_prf#4679,l_orderkey_and_l_linenumber_prf#4680,l_comment_prf#4681,l_linestatus_prf#4682,rid#4683,l_shipmode_prf#4684,l_shipinstruct_prf#4685,l_quantity_prf#4686,l_receiptdate_prf#4687,l_linenumber_prf#4688,l_tax_prf#4689,l_shipdate_prf#4690,l_extendedprice_prf#4691,l_partkey_prf#4692,l_discount_prf#4693,l_partkey_and_l_suppkey_prf#4694,l_commitdate_prf#4695,l_suppkey_prf#4696,l_orderkey_prf#4697] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 55629ms

fq1a=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 22:31:12 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:31:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4794L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :     :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 22:31:12 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:31:12 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:31:12 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:31:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4794L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, 'rid_2, 'o_shippriority_prf_2, 'o_orderdate_prf_2, 'o_custkey_prf_2, 'o_orderpriority_prf_2, 'o_clerk_prf_2, 'o_orderstatus_prf_2, 'o_totalprice_prf_2, 'o_orderkey_prf_2, 'o_comment_prf_2, dexdecrypt('value_dec_key, value#2110) AS rid_3#4847]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#4826]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#4807]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#4801: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [rid#4796 AS rid_0#4801, n_regionkey_prf#4797 AS n_regionkey_prf_0#4802, n_nationkey_prf#4798 AS n_nationkey_prf_0#4803, n_name_prf#4799 AS n_name_prf_0#4804, n_comment_prf#4800 AS n_comment_prf_0#4805]
         :     :  :     :  :     :  :  +- Relation[rid#4796,n_regionkey_prf#4797,n_nationkey_prf#4798,n_name_prf#4799,n_comment_prf#4800] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4806]
         :     :  :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :  :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [c_acctbal_prf#4808 AS c_acctbal_prf_1#4817, rid#4809 AS rid_1#4818, c_name_prf#4810 AS c_name_prf_1#4819, c_nationkey_prf#4811 AS c_nationkey_prf_1#4820, c_custkey_prf#4812 AS c_custkey_prf_1#4821, c_comment_prf#4813 AS c_comment_prf_1#4822, c_address_prf#4814 AS c_address_prf_1#4823, c_mktsegment_prf#4815 AS c_mktsegment_prf_1#4824, c_phone_prf#4816 AS c_phone_prf_1#4825]
         :     :  :     :     +- Relation[c_acctbal_prf#4808,rid#4809,c_name_prf#4810,c_nationkey_prf#4811,c_custkey_prf#4812,c_comment_prf#4813,c_address_prf#4814,c_mktsegment_prf#4815,c_phone_prf#4816] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#4827 AS o_shippriority_prf_2#4837, rid#4828 AS rid_2#4838, o_orderdate_prf#4829 AS o_orderdate_prf_2#4839, o_custkey_prf#4830 AS o_custkey_prf_2#4840, o_orderpriority_prf#4831 AS o_orderpriority_prf_2#4841, o_clerk_prf#4832 AS o_clerk_prf_2#4842, o_orderstatus_prf#4833 AS o_orderstatus_prf_2#4843, o_totalprice_prf#4834 AS o_totalprice_prf_2#4844, o_orderkey_prf#4835 AS o_orderkey_prf_2#4845, o_comment_prf#4836 AS o_comment_prf_2#4846]
         :     :     +- Relation[o_shippriority_prf#4827,rid#4828,o_orderdate_prf#4829,o_custkey_prf#4830,o_orderpriority_prf#4831,o_clerk_prf#4832,o_orderstatus_prf#4833,o_totalprice_prf#4834,o_orderkey_prf#4835,o_comment_prf#4836] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4848 AS l_returnflag_prf_3#4867, l_orderkey_and_l_linenumber_prf#4849 AS l_orderkey_and_l_linenumber_prf_3#4868, l_comment_prf#4850 AS l_comment_prf_3#4869, l_linestatus_prf#4851 AS l_linestatus_prf_3#4870, rid#4852 AS rid_3#4871, l_shipmode_prf#4853 AS l_shipmode_prf_3#4872, l_shipinstruct_prf#4854 AS l_shipinstruct_prf_3#4873, l_quantity_prf#4855 AS l_quantity_prf_3#4874, l_receiptdate_prf#4856 AS l_receiptdate_prf_3#4875, l_linenumber_prf#4857 AS l_linenumber_prf_3#4876, l_tax_prf#4858 AS l_tax_prf_3#4877, l_shipdate_prf#4859 AS l_shipdate_prf_3#4878, l_extendedprice_prf#4860 AS l_extendedprice_prf_3#4879, l_partkey_prf#4861 AS l_partkey_prf_3#4880, l_discount_prf#4862 AS l_discount_prf_3#4881, l_partkey_and_l_suppkey_prf#4863 AS l_partkey_and_l_suppkey_prf_3#4882, l_commitdate_prf#4864 AS l_commitdate_prf_3#4883, l_suppkey_prf#4865 AS l_suppkey_prf_3#4884, l_orderkey_prf#4866 AS l_orderkey_prf_3#4885]
            +- Relation[l_returnflag_prf#4848,l_orderkey_and_l_linenumber_prf#4849,l_comment_prf#4850,l_linestatus_prf#4851,rid#4852,l_shipmode_prf#4853,l_shipinstruct_prf#4854,l_quantity_prf#4855,l_receiptdate_prf#4856,l_linenumber_prf#4857,l_tax_prf#4858,l_shipdate_prf#4859,l_extendedprice_prf#4860,l_partkey_prf#4861,l_discount_prf#4862,l_partkey_and_l_suppkey_prf#4863,l_commitdate_prf#4864,l_suppkey_prf#4865,l_orderkey_prf#4866] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 31008ms

fq1c=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 22:31:43 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:31:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4969L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [c_nationkey#293L, o_orderkey#342L]
               :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :     :- Project [c_custkey#290L, c_nationkey#293L]
               :     :  +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
               :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               :     +- Project [o_orderkey#342L, o_custkey#343L]
               :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 22:31:43 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:31:43 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:31:43 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:31:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4969L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#4982]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#4976: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [rid#4971 AS rid_0#4976, n_regionkey_prf#4972 AS n_regionkey_prf_0#4977, n_nationkey_prf#4973 AS n_nationkey_prf_0#4978, n_name_prf#4974 AS n_name_prf_0#4979, n_comment_prf#4975 AS n_comment_prf_0#4980]
         :     :  :  +- Relation[rid#4971,n_regionkey_prf#4972,n_nationkey_prf#4973,n_name_prf#4974,n_comment_prf#4975] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4981]
         :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join NaturalJoin(Inner)
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- Project [c_acctbal_prf#4983 AS c_acctbal_prf_1#4992, rid#4984 AS rid_1#4993, c_name_prf#4985 AS c_name_prf_1#4994, c_nationkey_prf#4986 AS c_nationkey_prf_1#4995, c_custkey_prf#4987 AS c_custkey_prf_1#4996, c_comment_prf#4988 AS c_comment_prf_1#4997, c_address_prf#4989 AS c_address_prf_1#4998, c_mktsegment_prf#4990 AS c_mktsegment_prf_1#4999, c_phone_prf#4991 AS c_phone_prf_1#5000]
            :  :  :  :  +- Relation[c_acctbal_prf#4983,rid#4984,c_name_prf#4985,c_nationkey_prf#4986,c_custkey_prf#4987,c_comment_prf#4988,c_address_prf#4989,c_mktsegment_prf#4990,c_phone_prf#4991] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#5011]
            :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
            :  :  :        :- 'Project ['rid AS rid_1#5010]
            :  :  :        :  +- Relation[c_acctbal_prf#5001,rid#5002,c_name_prf#5003,c_nationkey_prf#5004,c_custkey_prf#5005,c_comment_prf#5006,c_address_prf#5007,c_mktsegment_prf#5008,c_phone_prf#5009] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            :  :  +- Project [o_shippriority_prf#5012 AS o_shippriority_prf_2#5022, rid#5013 AS rid_2#5023, o_orderdate_prf#5014 AS o_orderdate_prf_2#5024, o_custkey_prf#5015 AS o_custkey_prf_2#5025, o_orderpriority_prf#5016 AS o_orderpriority_prf_2#5026, o_clerk_prf#5017 AS o_clerk_prf_2#5027, o_orderstatus_prf#5018 AS o_orderstatus_prf_2#5028, o_totalprice_prf#5019 AS o_totalprice_prf_2#5029, o_orderkey_prf#5020 AS o_orderkey_prf_2#5030, o_comment_prf#5021 AS o_comment_prf_2#5031]
            :  :     +- Relation[o_shippriority_prf#5012,rid#5013,o_orderdate_prf#5014,o_custkey_prf#5015,o_orderpriority_prf#5016,o_clerk_prf#5017,o_orderstatus_prf#5018,o_totalprice_prf#5019,o_orderkey_prf#5020,o_comment_prf#5021] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2110) AS rid_3#5043]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#5042]
            :        :  +- Relation[o_shippriority_prf#5032,rid#5033,o_orderdate_prf#5034,o_custkey_prf#5035,o_orderpriority_prf#5036,o_clerk_prf#5037,o_orderstatus_prf#5038,o_totalprice_prf#5039,o_orderkey_prf#5040,o_comment_prf#5041] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#5044 AS l_returnflag_prf_3#5063, l_orderkey_and_l_linenumber_prf#5045 AS l_orderkey_and_l_linenumber_prf_3#5064, l_comment_prf#5046 AS l_comment_prf_3#5065, l_linestatus_prf#5047 AS l_linestatus_prf_3#5066, rid#5048 AS rid_3#5067, l_shipmode_prf#5049 AS l_shipmode_prf_3#5068, l_shipinstruct_prf#5050 AS l_shipinstruct_prf_3#5069, l_quantity_prf#5051 AS l_quantity_prf_3#5070, l_receiptdate_prf#5052 AS l_receiptdate_prf_3#5071, l_linenumber_prf#5053 AS l_linenumber_prf_3#5072, l_tax_prf#5054 AS l_tax_prf_3#5073, l_shipdate_prf#5055 AS l_shipdate_prf_3#5074, l_extendedprice_prf#5056 AS l_extendedprice_prf_3#5075, l_partkey_prf#5057 AS l_partkey_prf_3#5076, l_discount_prf#5058 AS l_discount_prf_3#5077, l_partkey_and_l_suppkey_prf#5059 AS l_partkey_and_l_suppkey_prf_3#5078, l_commitdate_prf#5060 AS l_commitdate_prf_3#5079, l_suppkey_prf#5061 AS l_suppkey_prf_3#5080, l_orderkey_prf#5062 AS l_orderkey_prf_3#5081]
               +- Relation[l_returnflag_prf#5044,l_orderkey_and_l_linenumber_prf#5045,l_comment_prf#5046,l_linestatus_prf#5047,rid#5048,l_shipmode_prf#5049,l_shipinstruct_prf#5050,l_quantity_prf#5051,l_receiptdate_prf#5052,l_linenumber_prf#5053,l_tax_prf#5054,l_shipdate_prf#5055,l_extendedprice_prf#5056,l_partkey_prf#5057,l_discount_prf#5058,l_partkey_and_l_suppkey_prf#5059,l_commitdate_prf#5060,l_suppkey_prf#5061,l_orderkey_prf#5062] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 163582ms

fs1b=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/16 22:34:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:34:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5170L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L, l_partkey#307L]
               :  +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L]
                  +- Join Inner, (c_custkey#290L = o_custkey#343L)
                     :- Project [c_custkey#290L]
                     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
                     +- Project [o_orderkey#342L, o_custkey#343L]
                        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 22:34:26 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:34:26 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:34:26 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:34:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5170L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [p_comment_prf#5172 AS p_comment_prf_0#5182, p_name_prf#5173 AS p_name_prf_0#5183, rid#5174 AS rid_0#5184, p_type_prf#5175 AS p_type_prf_0#5185, p_retailprice_prf#5176 AS p_retailprice_prf_0#5186, p_mfgr_prf#5177 AS p_mfgr_prf_0#5187, p_container_prf#5178 AS p_container_prf_0#5188, p_brand_prf#5179 AS p_brand_prf_0#5189, p_size_prf#5180 AS p_size_prf_0#5190, p_partkey_prf#5181 AS p_partkey_prf_0#5191]
         :  :  +- Relation[p_comment_prf#5172,p_name_prf#5173,rid#5174,p_type_prf#5175,p_retailprice_prf#5176,p_mfgr_prf#5177,p_container_prf#5178,p_brand_prf#5179,p_size_prf#5180,p_partkey_prf#5181] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#5203]
         :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5202]
         :        :  +- Relation[p_comment_prf#5192,p_name_prf#5193,rid#5194,p_type_prf#5195,p_retailprice_prf#5196,p_mfgr_prf#5197,p_container_prf#5198,p_brand_prf#5199,p_size_prf#5200,p_partkey_prf#5201] JDBCRelation(part_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [l_returnflag_prf#5204 AS l_returnflag_prf_1#5223, l_orderkey_and_l_linenumber_prf#5205 AS l_orderkey_and_l_linenumber_prf_1#5224, l_comment_prf#5206 AS l_comment_prf_1#5225, l_linestatus_prf#5207 AS l_linestatus_prf_1#5226, rid#5208 AS rid_1#5227, l_shipmode_prf#5209 AS l_shipmode_prf_1#5228, l_shipinstruct_prf#5210 AS l_shipinstruct_prf_1#5229, l_quantity_prf#5211 AS l_quantity_prf_1#5230, l_receiptdate_prf#5212 AS l_receiptdate_prf_1#5231, l_linenumber_prf#5213 AS l_linenumber_prf_1#5232, l_tax_prf#5214 AS l_tax_prf_1#5233, l_shipdate_prf#5215 AS l_shipdate_prf_1#5234, l_extendedprice_prf#5216 AS l_extendedprice_prf_1#5235, l_partkey_prf#5217 AS l_partkey_prf_1#5236, l_discount_prf#5218 AS l_discount_prf_1#5237, l_partkey_and_l_suppkey_prf#5219 AS l_partkey_and_l_suppkey_prf_1#5238, l_commitdate_prf#5220 AS l_commitdate_prf_1#5239, l_suppkey_prf#5221 AS l_suppkey_prf_1#5240, l_orderkey_prf#5222 AS l_orderkey_prf_1#5241]
            :  :  +- Relation[l_returnflag_prf#5204,l_orderkey_and_l_linenumber_prf#5205,l_comment_prf#5206,l_linestatus_prf#5207,rid#5208,l_shipmode_prf#5209,l_shipinstruct_prf#5210,l_quantity_prf#5211,l_receiptdate_prf#5212,l_linenumber_prf#5213,l_tax_prf#5214,l_shipdate_prf#5215,l_extendedprice_prf#5216,l_partkey_prf#5217,l_discount_prf#5218,l_partkey_and_l_suppkey_prf#5219,l_commitdate_prf#5220,l_suppkey_prf#5221,l_orderkey_prf#5222] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2110) AS rid_3#5262]
            :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#5261]
            :        :  +- Relation[l_returnflag_prf#5242,l_orderkey_and_l_linenumber_prf#5243,l_comment_prf#5244,l_linestatus_prf#5245,rid#5246,l_shipmode_prf#5247,l_shipinstruct_prf#5248,l_quantity_prf#5249,l_receiptdate_prf#5250,l_linenumber_prf#5251,l_tax_prf#5252,l_shipdate_prf#5253,l_extendedprice_prf#5254,l_partkey_prf#5255,l_discount_prf#5256,l_partkey_and_l_suppkey_prf#5257,l_commitdate_prf#5258,l_suppkey_prf#5259,l_orderkey_prf#5260] JDBCRelation(lineitem_prf) [numPartitions=1]
            :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join NaturalJoin(Inner)
               :- 'Project ['c_acctbal_prf_2, 'rid_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2110) AS rid_3#5282]
               :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_2#5273: string
               :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :     :  :- Project [c_acctbal_prf#5263 AS c_acctbal_prf_2#5272, rid#5264 AS rid_2#5273, c_name_prf#5265 AS c_name_prf_2#5274, c_nationkey_prf#5266 AS c_nationkey_prf_2#5275, c_custkey_prf#5267 AS c_custkey_prf_2#5276, c_comment_prf#5268 AS c_comment_prf_2#5277, c_address_prf#5269 AS c_address_prf_2#5278, c_mktsegment_prf#5270 AS c_mktsegment_prf_2#5279, c_phone_prf#5271 AS c_phone_prf_2#5280]
               :     :  :  +- Relation[c_acctbal_prf#5263,rid#5264,c_name_prf#5265,c_nationkey_prf#5266,c_custkey_prf#5267,c_comment_prf#5268,c_address_prf#5269,c_mktsegment_prf#5270,c_phone_prf#5271] JDBCRelation(customer_prf) [numPartitions=1]
               :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#5281]
               :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
               :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
               :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
               +- Project [o_shippriority_prf#5283 AS o_shippriority_prf_3#5293, rid#5284 AS rid_3#5294, o_orderdate_prf#5285 AS o_orderdate_prf_3#5295, o_custkey_prf#5286 AS o_custkey_prf_3#5296, o_orderpriority_prf#5287 AS o_orderpriority_prf_3#5297, o_clerk_prf#5288 AS o_clerk_prf_3#5298, o_orderstatus_prf#5289 AS o_orderstatus_prf_3#5299, o_totalprice_prf#5290 AS o_totalprice_prf_3#5300, o_orderkey_prf#5291 AS o_orderkey_prf_3#5301, o_comment_prf#5292 AS o_comment_prf_3#5302]
                  +- Relation[o_shippriority_prf#5283,rid#5284,o_orderdate_prf#5285,o_custkey_prf#5286,o_orderpriority_prf#5287,o_clerk_prf#5288,o_orderstatus_prf#5289,o_totalprice_prf#5290,o_orderkey_prf#5291,o_comment_prf#5292] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 172827ms

ft1d=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/16 22:37:19 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:37:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5373L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_nationkey#21L]
                  +- Filter isnotnull(s_nationkey#21L)
                     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 22:37:19 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:37:19 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:37:19 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:37:19 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:37:19 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:37:19 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:37:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5373L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#5375 AS c_acctbal_prf_0#5384, rid#5376 AS rid_0#5385, c_name_prf#5377 AS c_name_prf_0#5386, c_nationkey_prf#5378 AS c_nationkey_prf_0#5387, c_custkey_prf#5379 AS c_custkey_prf_0#5388, c_comment_prf#5380 AS c_comment_prf_0#5389, c_address_prf#5381 AS c_address_prf_0#5390, c_mktsegment_prf#5382 AS c_mktsegment_prf_0#5391, c_phone_prf#5383 AS c_phone_prf_0#5392]
         :  :  +- Relation[c_acctbal_prf#5375,rid#5376,c_name_prf#5377,c_nationkey_prf#5378,c_custkey_prf#5379,c_comment_prf#5380,c_address_prf#5381,c_mktsegment_prf#5382,c_phone_prf#5383] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#5403]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5402]
         :        :  +- Relation[c_acctbal_prf#5393,rid#5394,c_name_prf#5395,c_nationkey_prf#5396,c_custkey_prf#5397,c_comment_prf#5398,c_address_prf#5399,c_mktsegment_prf#5400,c_phone_prf#5401] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#5415]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_1#5409: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [rid#5404 AS rid_1#5409, n_regionkey_prf#5405 AS n_regionkey_prf_1#5410, n_nationkey_prf#5406 AS n_nationkey_prf_1#5411, n_name_prf#5407 AS n_name_prf_1#5412, n_comment_prf#5408 AS n_comment_prf_1#5413]
            :     :  :  +- Relation[rid#5404,n_regionkey_prf#5405,n_nationkey_prf#5406,n_name_prf#5407,n_comment_prf#5408] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5414]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [s_phone_prf#5416 AS s_phone_prf_2#5424, rid#5417 AS rid_2#5425, s_address_prf#5418 AS s_address_prf_2#5426, s_nationkey_prf#5419 AS s_nationkey_prf_2#5427, s_suppkey_prf#5420 AS s_suppkey_prf_2#5428, s_name_prf#5421 AS s_name_prf_2#5429, s_acctbal_prf#5422 AS s_acctbal_prf_2#5430, s_comment_prf#5423 AS s_comment_prf_2#5431]
               +- Relation[s_phone_prf#5416,rid#5417,s_address_prf#5418,s_nationkey_prf#5419,s_suppkey_prf#5420,s_name_prf#5421,s_acctbal_prf#5422,s_comment_prf#5423] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 24073ms

fs1a=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/16 22:37:43 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:37:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5499L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [c_custkey#290L]
         :     :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L]
         :        +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/16 22:37:43 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:37:43 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:37:43 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:37:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5499L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, 'rid_2, 'l_returnflag_prf_2, 'l_orderkey_and_l_linenumber_prf_2, 'l_comment_prf_2, 'l_linestatus_prf_2, ... 15 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#5541]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#5520]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#5511: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [c_acctbal_prf#5501 AS c_acctbal_prf_0#5510, rid#5502 AS rid_0#5511, c_name_prf#5503 AS c_name_prf_0#5512, c_nationkey_prf#5504 AS c_nationkey_prf_0#5513, c_custkey_prf#5505 AS c_custkey_prf_0#5514, c_comment_prf#5506 AS c_comment_prf_0#5515, c_address_prf#5507 AS c_address_prf_0#5516, c_mktsegment_prf#5508 AS c_mktsegment_prf_0#5517, c_phone_prf#5509 AS c_phone_prf_0#5518]
         :     :  :     :  :     :  :  +- Relation[c_acctbal_prf#5501,rid#5502,c_name_prf#5503,c_nationkey_prf#5504,c_custkey_prf#5505,c_comment_prf#5506,c_address_prf#5507,c_mktsegment_prf#5508,c_phone_prf#5509] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5519]
         :     :  :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :  :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [o_shippriority_prf#5521 AS o_shippriority_prf_1#5531, rid#5522 AS rid_1#5532, o_orderdate_prf#5523 AS o_orderdate_prf_1#5533, o_custkey_prf#5524 AS o_custkey_prf_1#5534, o_orderpriority_prf#5525 AS o_orderpriority_prf_1#5535, o_clerk_prf#5526 AS o_clerk_prf_1#5536, o_orderstatus_prf#5527 AS o_orderstatus_prf_1#5537, o_totalprice_prf#5528 AS o_totalprice_prf_1#5538, o_orderkey_prf#5529 AS o_orderkey_prf_1#5539, o_comment_prf#5530 AS o_comment_prf_1#5540]
         :     :  :     :     +- Relation[o_shippriority_prf#5521,rid#5522,o_orderdate_prf#5523,o_custkey_prf#5524,o_orderpriority_prf#5525,o_clerk_prf#5526,o_orderstatus_prf#5527,o_totalprice_prf#5528,o_orderkey_prf#5529,o_comment_prf#5530] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#5542 AS l_returnflag_prf_2#5561, l_orderkey_and_l_linenumber_prf#5543 AS l_orderkey_and_l_linenumber_prf_2#5562, l_comment_prf#5544 AS l_comment_prf_2#5563, l_linestatus_prf#5545 AS l_linestatus_prf_2#5564, rid#5546 AS rid_2#5565, l_shipmode_prf#5547 AS l_shipmode_prf_2#5566, l_shipinstruct_prf#5548 AS l_shipinstruct_prf_2#5567, l_quantity_prf#5549 AS l_quantity_prf_2#5568, l_receiptdate_prf#5550 AS l_receiptdate_prf_2#5569, l_linenumber_prf#5551 AS l_linenumber_prf_2#5570, l_tax_prf#5552 AS l_tax_prf_2#5571, l_shipdate_prf#5553 AS l_shipdate_prf_2#5572, l_extendedprice_prf#5554 AS l_extendedprice_prf_2#5573, l_partkey_prf#5555 AS l_partkey_prf_2#5574, l_discount_prf#5556 AS l_discount_prf_2#5575, l_partkey_and_l_suppkey_prf#5557 AS l_partkey_and_l_suppkey_prf_2#5576, l_commitdate_prf#5558 AS l_commitdate_prf_2#5577, l_suppkey_prf#5559 AS l_suppkey_prf_2#5578, l_orderkey_prf#5560 AS l_orderkey_prf_2#5579]
         :     :     +- Relation[l_returnflag_prf#5542,l_orderkey_and_l_linenumber_prf#5543,l_comment_prf#5544,l_linestatus_prf#5545,rid#5546,l_shipmode_prf#5547,l_shipinstruct_prf#5548,l_quantity_prf#5549,l_receiptdate_prf#5550,l_linenumber_prf#5551,l_tax_prf#5552,l_shipdate_prf#5553,l_extendedprice_prf#5554,l_partkey_prf#5555,l_discount_prf#5556,l_partkey_and_l_suppkey_prf#5557,l_commitdate_prf#5558,l_suppkey_prf#5559,l_orderkey_prf#5560] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#5581 AS p_comment_prf_3#5591, p_name_prf#5582 AS p_name_prf_3#5592, rid#5583 AS rid_3#5593, p_type_prf#5584 AS p_type_prf_3#5594, p_retailprice_prf#5585 AS p_retailprice_prf_3#5595, p_mfgr_prf#5586 AS p_mfgr_prf_3#5596, p_container_prf#5587 AS p_container_prf_3#5597, p_brand_prf#5588 AS p_brand_prf_3#5598, p_size_prf#5589 AS p_size_prf_3#5599, p_partkey_prf#5590 AS p_partkey_prf_3#5600]
            +- Relation[p_comment_prf#5581,p_name_prf#5582,rid#5583,p_type_prf#5584,p_retailprice_prf#5585,p_mfgr_prf#5586,p_container_prf#5587,p_brand_prf#5588,p_size_prf#5589,p_partkey_prf#5590] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 108649ms

fr1d=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/16 22:39:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:39:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5685L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 22:39:32 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:39:32 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:39:32 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:39:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5685L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#5727]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#5706]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#5697: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [c_acctbal_prf#5687 AS c_acctbal_prf_0#5696, rid#5688 AS rid_0#5697, c_name_prf#5689 AS c_name_prf_0#5698, c_nationkey_prf#5690 AS c_nationkey_prf_0#5699, c_custkey_prf#5691 AS c_custkey_prf_0#5700, c_comment_prf#5692 AS c_comment_prf_0#5701, c_address_prf#5693 AS c_address_prf_0#5702, c_mktsegment_prf#5694 AS c_mktsegment_prf_0#5703, c_phone_prf#5695 AS c_phone_prf_0#5704]
         :     :  :     :  :  +- Relation[c_acctbal_prf#5687,rid#5688,c_name_prf#5689,c_nationkey_prf#5690,c_custkey_prf#5691,c_comment_prf#5692,c_address_prf#5693,c_mktsegment_prf#5694,c_phone_prf#5695] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5705]
         :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#5707 AS o_shippriority_prf_1#5717, rid#5708 AS rid_1#5718, o_orderdate_prf#5709 AS o_orderdate_prf_1#5719, o_custkey_prf#5710 AS o_custkey_prf_1#5720, o_orderpriority_prf#5711 AS o_orderpriority_prf_1#5721, o_clerk_prf#5712 AS o_clerk_prf_1#5722, o_orderstatus_prf#5713 AS o_orderstatus_prf_1#5723, o_totalprice_prf#5714 AS o_totalprice_prf_1#5724, o_orderkey_prf#5715 AS o_orderkey_prf_1#5725, o_comment_prf#5716 AS o_comment_prf_1#5726]
         :     :     +- Relation[o_shippriority_prf#5707,rid#5708,o_orderdate_prf#5709,o_custkey_prf#5710,o_orderpriority_prf#5711,o_clerk_prf#5712,o_orderstatus_prf#5713,o_totalprice_prf#5714,o_orderkey_prf#5715,o_comment_prf#5716] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5728 AS l_returnflag_prf_2#5747, l_orderkey_and_l_linenumber_prf#5729 AS l_orderkey_and_l_linenumber_prf_2#5748, l_comment_prf#5730 AS l_comment_prf_2#5749, l_linestatus_prf#5731 AS l_linestatus_prf_2#5750, rid#5732 AS rid_2#5751, l_shipmode_prf#5733 AS l_shipmode_prf_2#5752, l_shipinstruct_prf#5734 AS l_shipinstruct_prf_2#5753, l_quantity_prf#5735 AS l_quantity_prf_2#5754, l_receiptdate_prf#5736 AS l_receiptdate_prf_2#5755, l_linenumber_prf#5737 AS l_linenumber_prf_2#5756, l_tax_prf#5738 AS l_tax_prf_2#5757, l_shipdate_prf#5739 AS l_shipdate_prf_2#5758, l_extendedprice_prf#5740 AS l_extendedprice_prf_2#5759, l_partkey_prf#5741 AS l_partkey_prf_2#5760, l_discount_prf#5742 AS l_discount_prf_2#5761, l_partkey_and_l_suppkey_prf#5743 AS l_partkey_and_l_suppkey_prf_2#5762, l_commitdate_prf#5744 AS l_commitdate_prf_2#5763, l_suppkey_prf#5745 AS l_suppkey_prf_2#5764, l_orderkey_prf#5746 AS l_orderkey_prf_2#5765]
            +- Relation[l_returnflag_prf#5728,l_orderkey_and_l_linenumber_prf#5729,l_comment_prf#5730,l_linestatus_prf#5731,rid#5732,l_shipmode_prf#5733,l_shipinstruct_prf#5734,l_quantity_prf#5735,l_receiptdate_prf#5736,l_linenumber_prf#5737,l_tax_prf#5738,l_shipdate_prf#5739,l_extendedprice_prf#5740,l_partkey_prf#5741,l_discount_prf#5742,l_partkey_and_l_suppkey_prf#5743,l_commitdate_prf#5744,l_suppkey_prf#5745,l_orderkey_prf#5746] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 32737ms

fq1e=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 22:40:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:40:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5844L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [c_custkey#290L, c_nationkey#293L]
                  +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 22:40:05 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:40:05 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:40:05 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:40:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5844L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [l_returnflag_prf#5846 AS l_returnflag_prf_0#5865, l_orderkey_and_l_linenumber_prf#5847 AS l_orderkey_and_l_linenumber_prf_0#5866, l_comment_prf#5848 AS l_comment_prf_0#5867, l_linestatus_prf#5849 AS l_linestatus_prf_0#5868, rid#5850 AS rid_0#5869, l_shipmode_prf#5851 AS l_shipmode_prf_0#5870, l_shipinstruct_prf#5852 AS l_shipinstruct_prf_0#5871, l_quantity_prf#5853 AS l_quantity_prf_0#5872, l_receiptdate_prf#5854 AS l_receiptdate_prf_0#5873, l_linenumber_prf#5855 AS l_linenumber_prf_0#5874, l_tax_prf#5856 AS l_tax_prf_0#5875, l_shipdate_prf#5857 AS l_shipdate_prf_0#5876, l_extendedprice_prf#5858 AS l_extendedprice_prf_0#5877, l_partkey_prf#5859 AS l_partkey_prf_0#5878, l_discount_prf#5860 AS l_discount_prf_0#5879, l_partkey_and_l_suppkey_prf#5861 AS l_partkey_and_l_suppkey_prf_0#5880, l_commitdate_prf#5862 AS l_commitdate_prf_0#5881, l_suppkey_prf#5863 AS l_suppkey_prf_0#5882, l_orderkey_prf#5864 AS l_orderkey_prf_0#5883]
         :  :  :  :  +- Relation[l_returnflag_prf#5846,l_orderkey_and_l_linenumber_prf#5847,l_comment_prf#5848,l_linestatus_prf#5849,rid#5850,l_shipmode_prf#5851,l_shipinstruct_prf#5852,l_quantity_prf#5853,l_receiptdate_prf#5854,l_linenumber_prf#5855,l_tax_prf#5856,l_shipdate_prf#5857,l_extendedprice_prf#5858,l_partkey_prf#5859,l_discount_prf#5860,l_partkey_and_l_suppkey_prf#5861,l_commitdate_prf#5862,l_suppkey_prf#5863,l_orderkey_prf#5864] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#5904]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#5903]
         :  :  :        :  +- Relation[l_returnflag_prf#5884,l_orderkey_and_l_linenumber_prf#5885,l_comment_prf#5886,l_linestatus_prf#5887,rid#5888,l_shipmode_prf#5889,l_shipinstruct_prf#5890,l_quantity_prf#5891,l_receiptdate_prf#5892,l_linenumber_prf#5893,l_tax_prf#5894,l_shipdate_prf#5895,l_extendedprice_prf#5896,l_partkey_prf#5897,l_discount_prf#5898,l_partkey_and_l_suppkey_prf#5899,l_commitdate_prf#5900,l_suppkey_prf#5901,l_orderkey_prf#5902] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#5905 AS o_shippriority_prf_1#5915, rid#5906 AS rid_1#5916, o_orderdate_prf#5907 AS o_orderdate_prf_1#5917, o_custkey_prf#5908 AS o_custkey_prf_1#5918, o_orderpriority_prf#5909 AS o_orderpriority_prf_1#5919, o_clerk_prf#5910 AS o_clerk_prf_1#5920, o_orderstatus_prf#5911 AS o_orderstatus_prf_1#5921, o_totalprice_prf#5912 AS o_totalprice_prf_1#5922, o_orderkey_prf#5913 AS o_orderkey_prf_1#5923, o_comment_prf#5914 AS o_comment_prf_1#5924]
         :  :     +- Relation[o_shippriority_prf#5905,rid#5906,o_orderdate_prf#5907,o_custkey_prf#5908,o_orderpriority_prf#5909,o_clerk_prf#5910,o_orderstatus_prf#5911,o_totalprice_prf#5912,o_orderkey_prf#5913,o_comment_prf#5914] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2110) AS rid_3#5936]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5935]
         :        :  +- Relation[o_shippriority_prf#5925,rid#5926,o_orderdate_prf#5927,o_custkey_prf#5928,o_orderpriority_prf#5929,o_clerk_prf#5930,o_orderstatus_prf#5931,o_totalprice_prf#5932,o_orderkey_prf#5933,o_comment_prf#5934] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_2, 'n_regionkey_prf_2, 'n_nationkey_prf_2, 'n_name_prf_2, 'n_comment_prf_2, dexdecrypt('value_dec_key, value#2110) AS rid_3#5948]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_2#5942: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [rid#5937 AS rid_2#5942, n_regionkey_prf#5938 AS n_regionkey_prf_2#5943, n_nationkey_prf#5939 AS n_nationkey_prf_2#5944, n_name_prf#5940 AS n_name_prf_2#5945, n_comment_prf#5941 AS n_comment_prf_2#5946]
            :     :  :  +- Relation[rid#5937,n_regionkey_prf#5938,n_nationkey_prf#5939,n_name_prf#5940,n_comment_prf#5941] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#5947]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#5949 AS c_acctbal_prf_3#5958, rid#5950 AS rid_3#5959, c_name_prf#5951 AS c_name_prf_3#5960, c_nationkey_prf#5952 AS c_nationkey_prf_3#5961, c_custkey_prf#5953 AS c_custkey_prf_3#5962, c_comment_prf#5954 AS c_comment_prf_3#5963, c_address_prf#5955 AS c_address_prf_3#5964, c_mktsegment_prf#5956 AS c_mktsegment_prf_3#5965, c_phone_prf#5957 AS c_phone_prf_3#5966]
               +- Relation[c_acctbal_prf#5949,rid#5950,c_name_prf#5951,c_nationkey_prf#5952,c_custkey_prf#5953,c_comment_prf#5954,c_address_prf#5955,c_mktsegment_prf#5956,c_phone_prf#5957] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 164398ms

ft2b=
select * from part, partsupp, supplier where p_size = 15 and p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/16 22:42:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:42:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6034L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 22:42:49 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 22:42:49 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 22:42:49 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 22:42:49 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:42:49 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:42:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6034L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#6072]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#6057]
         :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#6048: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [p_comment_prf#6036 AS p_comment_prf_0#6046, p_name_prf#6037 AS p_name_prf_0#6047, rid#6038 AS rid_0#6048, p_type_prf#6039 AS p_type_prf_0#6049, p_retailprice_prf#6040 AS p_retailprice_prf_0#6050, p_mfgr_prf#6041 AS p_mfgr_prf_0#6051, p_container_prf#6042 AS p_container_prf_0#6052, p_brand_prf#6043 AS p_brand_prf_0#6053, p_size_prf#6044 AS p_size_prf_0#6054, p_partkey_prf#6045 AS p_partkey_prf_0#6055]
         :     :  :     :  :  +- Relation[p_comment_prf#6036,p_name_prf#6037,rid#6038,p_type_prf#6039,p_retailprice_prf#6040,p_mfgr_prf#6041,p_container_prf#6042,p_brand_prf#6043,p_size_prf#6044,p_partkey_prf#6045] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#6056]
         :     :  :     :     +- DexRidFilter part~p_size~15
         :     :  :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#6058 AS ps_partkey_and_ps_suppkey_prf_1#6065, rid#6059 AS rid_1#6066, ps_availqty_prf#6060 AS ps_availqty_prf_1#6067, ps_comment_prf#6061 AS ps_comment_prf_1#6068, ps_partkey_prf#6062 AS ps_partkey_prf_1#6069, ps_supplycost_prf#6063 AS ps_supplycost_prf_1#6070, ps_suppkey_prf#6064 AS ps_suppkey_prf_1#6071]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#6058,rid#6059,ps_availqty_prf#6060,ps_comment_prf#6061,ps_partkey_prf#6062,ps_supplycost_prf#6063,ps_suppkey_prf#6064] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#6073 AS s_phone_prf_2#6081, rid#6074 AS rid_2#6082, s_address_prf#6075 AS s_address_prf_2#6083, s_nationkey_prf#6076 AS s_nationkey_prf_2#6084, s_suppkey_prf#6077 AS s_suppkey_prf_2#6085, s_name_prf#6078 AS s_name_prf_2#6086, s_acctbal_prf#6079 AS s_acctbal_prf_2#6087, s_comment_prf#6080 AS s_comment_prf_2#6088]
            +- Relation[s_phone_prf#6073,rid#6074,s_address_prf#6075,s_nationkey_prf#6076,s_suppkey_prf#6077,s_name_prf#6078,s_acctbal_prf#6079,s_comment_prf#6080] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 915ms

fr2f=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/16 22:42:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:42:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6150L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_orderkey#342L, o_custkey#343L]
         :     :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L]
         :        +- Filter isnotnull(c_custkey#290L)
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 22:42:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6150L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#6192]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#6173]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_0#6163: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [o_shippriority_prf#6152 AS o_shippriority_prf_0#6162, rid#6153 AS rid_0#6163, o_orderdate_prf#6154 AS o_orderdate_prf_0#6164, o_custkey_prf#6155 AS o_custkey_prf_0#6165, o_orderpriority_prf#6156 AS o_orderpriority_prf_0#6166, o_clerk_prf#6157 AS o_clerk_prf_0#6167, o_orderstatus_prf#6158 AS o_orderstatus_prf_0#6168, o_totalprice_prf#6159 AS o_totalprice_prf_0#6169, o_orderkey_prf#6160 AS o_orderkey_prf_0#6170, o_comment_prf#6161 AS o_comment_prf_0#6171]
         :     :  :     :  :  +- Relation[o_shippriority_prf#6152,rid#6153,o_orderdate_prf#6154,o_custkey_prf#6155,o_orderpriority_prf#6156,o_clerk_prf#6157,o_orderstatus_prf#6158,o_totalprice_prf#6159,o_orderkey_prf#6160,o_comment_prf#6161] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#6172]
         :     :  :     :     +- DexRidFilter orders~o_orderstatus~F
         :     :  :     :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#6174 AS c_acctbal_prf_1#6183, rid#6175 AS rid_1#6184, c_name_prf#6176 AS c_name_prf_1#6185, c_nationkey_prf#6177 AS c_nationkey_prf_1#6186, c_custkey_prf#6178 AS c_custkey_prf_1#6187, c_comment_prf#6179 AS c_comment_prf_1#6188, c_address_prf#6180 AS c_address_prf_1#6189, c_mktsegment_prf#6181 AS c_mktsegment_prf_1#6190, c_phone_prf#6182 AS c_phone_prf_1#6191]
         :     :     +- Relation[c_acctbal_prf#6174,rid#6175,c_name_prf#6176,c_nationkey_prf#6177,c_custkey_prf#6178,c_comment_prf#6179,c_address_prf#6180,c_mktsegment_prf#6181,c_phone_prf#6182] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#6193 AS l_returnflag_prf_2#6212, l_orderkey_and_l_linenumber_prf#6194 AS l_orderkey_and_l_linenumber_prf_2#6213, l_comment_prf#6195 AS l_comment_prf_2#6214, l_linestatus_prf#6196 AS l_linestatus_prf_2#6215, rid#6197 AS rid_2#6216, l_shipmode_prf#6198 AS l_shipmode_prf_2#6217, l_shipinstruct_prf#6199 AS l_shipinstruct_prf_2#6218, l_quantity_prf#6200 AS l_quantity_prf_2#6219, l_receiptdate_prf#6201 AS l_receiptdate_prf_2#6220, l_linenumber_prf#6202 AS l_linenumber_prf_2#6221, l_tax_prf#6203 AS l_tax_prf_2#6222, l_shipdate_prf#6204 AS l_shipdate_prf_2#6223, l_extendedprice_prf#6205 AS l_extendedprice_prf_2#6224, l_partkey_prf#6206 AS l_partkey_prf_2#6225, l_discount_prf#6207 AS l_discount_prf_2#6226, l_partkey_and_l_suppkey_prf#6208 AS l_partkey_and_l_suppkey_prf_2#6227, l_commitdate_prf#6209 AS l_commitdate_prf_2#6228, l_suppkey_prf#6210 AS l_suppkey_prf_2#6229, l_orderkey_prf#6211 AS l_orderkey_prf_2#6230]
            +- Relation[l_returnflag_prf#6193,l_orderkey_and_l_linenumber_prf#6194,l_comment_prf#6195,l_linestatus_prf#6196,rid#6197,l_shipmode_prf#6198,l_shipinstruct_prf#6199,l_quantity_prf#6200,l_receiptdate_prf#6201,l_linenumber_prf#6202,l_tax_prf#6203,l_shipdate_prf#6204,l_extendedprice_prf#6205,l_partkey_prf#6206,l_discount_prf#6207,l_partkey_and_l_suppkey_prf#6208,l_commitdate_prf#6209,l_suppkey_prf#6210,l_orderkey_prf#6211] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 83171ms

fr1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and (l_orderkey = o_orderkey and c_mktsegment = 'BUILDING')
19/10/16 22:44:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:44:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6305L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 22:44:13 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:44:13 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:44:13 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:44:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6305L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#6307 AS l_returnflag_prf_0#6326, l_orderkey_and_l_linenumber_prf#6308 AS l_orderkey_and_l_linenumber_prf_0#6327, l_comment_prf#6309 AS l_comment_prf_0#6328, l_linestatus_prf#6310 AS l_linestatus_prf_0#6329, rid#6311 AS rid_0#6330, l_shipmode_prf#6312 AS l_shipmode_prf_0#6331, l_shipinstruct_prf#6313 AS l_shipinstruct_prf_0#6332, l_quantity_prf#6314 AS l_quantity_prf_0#6333, l_receiptdate_prf#6315 AS l_receiptdate_prf_0#6334, l_linenumber_prf#6316 AS l_linenumber_prf_0#6335, l_tax_prf#6317 AS l_tax_prf_0#6336, l_shipdate_prf#6318 AS l_shipdate_prf_0#6337, l_extendedprice_prf#6319 AS l_extendedprice_prf_0#6338, l_partkey_prf#6320 AS l_partkey_prf_0#6339, l_discount_prf#6321 AS l_discount_prf_0#6340, l_partkey_and_l_suppkey_prf#6322 AS l_partkey_and_l_suppkey_prf_0#6341, l_commitdate_prf#6323 AS l_commitdate_prf_0#6342, l_suppkey_prf#6324 AS l_suppkey_prf_0#6343, l_orderkey_prf#6325 AS l_orderkey_prf_0#6344]
         :  :  +- Relation[l_returnflag_prf#6307,l_orderkey_and_l_linenumber_prf#6308,l_comment_prf#6309,l_linestatus_prf#6310,rid#6311,l_shipmode_prf#6312,l_shipinstruct_prf#6313,l_quantity_prf#6314,l_receiptdate_prf#6315,l_linenumber_prf#6316,l_tax_prf#6317,l_shipdate_prf#6318,l_extendedprice_prf#6319,l_partkey_prf#6320,l_discount_prf#6321,l_partkey_and_l_suppkey_prf#6322,l_commitdate_prf#6323,l_suppkey_prf#6324,l_orderkey_prf#6325] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#6365]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#6364]
         :        :  +- Relation[l_returnflag_prf#6345,l_orderkey_and_l_linenumber_prf#6346,l_comment_prf#6347,l_linestatus_prf#6348,rid#6349,l_shipmode_prf#6350,l_shipinstruct_prf#6351,l_quantity_prf#6352,l_receiptdate_prf#6353,l_linenumber_prf#6354,l_tax_prf#6355,l_shipdate_prf#6356,l_extendedprice_prf#6357,l_partkey_prf#6358,l_discount_prf#6359,l_partkey_and_l_suppkey_prf#6360,l_commitdate_prf#6361,l_suppkey_prf#6362,l_orderkey_prf#6363] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [o_shippriority_prf#6366 AS o_shippriority_prf_1#6376, rid#6367 AS rid_1#6377, o_orderdate_prf#6368 AS o_orderdate_prf_1#6378, o_custkey_prf#6369 AS o_custkey_prf_1#6379, o_orderpriority_prf#6370 AS o_orderpriority_prf_1#6380, o_clerk_prf#6371 AS o_clerk_prf_1#6381, o_orderstatus_prf#6372 AS o_orderstatus_prf_1#6382, o_totalprice_prf#6373 AS o_totalprice_prf_1#6383, o_orderkey_prf#6374 AS o_orderkey_prf_1#6384, o_comment_prf#6375 AS o_comment_prf_1#6385]
            :  :  +- Relation[o_shippriority_prf#6366,rid#6367,o_orderdate_prf#6368,o_custkey_prf#6369,o_orderpriority_prf#6370,o_clerk_prf#6371,o_orderstatus_prf#6372,o_totalprice_prf#6373,o_orderkey_prf#6374,o_comment_prf#6375] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#6397]
            :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#6396]
            :        :  +- Relation[o_shippriority_prf#6386,rid#6387,o_orderdate_prf#6388,o_custkey_prf#6389,o_orderpriority_prf#6390,o_clerk_prf#6391,o_orderstatus_prf#6392,o_totalprice_prf#6393,o_orderkey_prf#6394,o_comment_prf#6395] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [c_acctbal_prf#6398 AS c_acctbal_prf_2#6407, rid#6399 AS rid_2#6408, c_name_prf#6400 AS c_name_prf_2#6409, c_nationkey_prf#6401 AS c_nationkey_prf_2#6410, c_custkey_prf#6402 AS c_custkey_prf_2#6411, c_comment_prf#6403 AS c_comment_prf_2#6412, c_address_prf#6404 AS c_address_prf_2#6413, c_mktsegment_prf#6405 AS c_mktsegment_prf_2#6414, c_phone_prf#6406 AS c_phone_prf_2#6415]
               :  +- Relation[c_acctbal_prf#6398,rid#6399,c_name_prf#6400,c_nationkey_prf#6401,c_custkey_prf#6402,c_comment_prf#6403,c_address_prf#6404,c_mktsegment_prf#6405,c_phone_prf#6406] JDBCRelation(customer_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#6416]
                  +- DexRidFilter customer~c_mktsegment~BUILDING
                     +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 121119ms

fr1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey and c_mktsegment = 'BUILDING'
19/10/16 22:46:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:46:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6491L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 22:46:14 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:46:14 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:46:14 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:46:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6491L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [l_returnflag_prf#6493 AS l_returnflag_prf_0#6512, l_orderkey_and_l_linenumber_prf#6494 AS l_orderkey_and_l_linenumber_prf_0#6513, l_comment_prf#6495 AS l_comment_prf_0#6514, l_linestatus_prf#6496 AS l_linestatus_prf_0#6515, rid#6497 AS rid_0#6516, l_shipmode_prf#6498 AS l_shipmode_prf_0#6517, l_shipinstruct_prf#6499 AS l_shipinstruct_prf_0#6518, l_quantity_prf#6500 AS l_quantity_prf_0#6519, l_receiptdate_prf#6501 AS l_receiptdate_prf_0#6520, l_linenumber_prf#6502 AS l_linenumber_prf_0#6521, l_tax_prf#6503 AS l_tax_prf_0#6522, l_shipdate_prf#6504 AS l_shipdate_prf_0#6523, l_extendedprice_prf#6505 AS l_extendedprice_prf_0#6524, l_partkey_prf#6506 AS l_partkey_prf_0#6525, l_discount_prf#6507 AS l_discount_prf_0#6526, l_partkey_and_l_suppkey_prf#6508 AS l_partkey_and_l_suppkey_prf_0#6527, l_commitdate_prf#6509 AS l_commitdate_prf_0#6528, l_suppkey_prf#6510 AS l_suppkey_prf_0#6529, l_orderkey_prf#6511 AS l_orderkey_prf_0#6530]
         :  :  :  :  +- Relation[l_returnflag_prf#6493,l_orderkey_and_l_linenumber_prf#6494,l_comment_prf#6495,l_linestatus_prf#6496,rid#6497,l_shipmode_prf#6498,l_shipinstruct_prf#6499,l_quantity_prf#6500,l_receiptdate_prf#6501,l_linenumber_prf#6502,l_tax_prf#6503,l_shipdate_prf#6504,l_extendedprice_prf#6505,l_partkey_prf#6506,l_discount_prf#6507,l_partkey_and_l_suppkey_prf#6508,l_commitdate_prf#6509,l_suppkey_prf#6510,l_orderkey_prf#6511] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#6551]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#6550]
         :  :  :        :  +- Relation[l_returnflag_prf#6531,l_orderkey_and_l_linenumber_prf#6532,l_comment_prf#6533,l_linestatus_prf#6534,rid#6535,l_shipmode_prf#6536,l_shipinstruct_prf#6537,l_quantity_prf#6538,l_receiptdate_prf#6539,l_linenumber_prf#6540,l_tax_prf#6541,l_shipdate_prf#6542,l_extendedprice_prf#6543,l_partkey_prf#6544,l_discount_prf#6545,l_partkey_and_l_suppkey_prf#6546,l_commitdate_prf#6547,l_suppkey_prf#6548,l_orderkey_prf#6549] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#6552 AS o_shippriority_prf_1#6562, rid#6553 AS rid_1#6563, o_orderdate_prf#6554 AS o_orderdate_prf_1#6564, o_custkey_prf#6555 AS o_custkey_prf_1#6565, o_orderpriority_prf#6556 AS o_orderpriority_prf_1#6566, o_clerk_prf#6557 AS o_clerk_prf_1#6567, o_orderstatus_prf#6558 AS o_orderstatus_prf_1#6568, o_totalprice_prf#6559 AS o_totalprice_prf_1#6569, o_orderkey_prf#6560 AS o_orderkey_prf_1#6570, o_comment_prf#6561 AS o_comment_prf_1#6571]
         :  :     +- Relation[o_shippriority_prf#6552,rid#6553,o_orderdate_prf#6554,o_custkey_prf#6555,o_orderpriority_prf#6556,o_clerk_prf#6557,o_orderstatus_prf#6558,o_totalprice_prf#6559,o_orderkey_prf#6560,o_comment_prf#6561] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#6583]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#6582]
         :        :  +- Relation[o_shippriority_prf#6572,rid#6573,o_orderdate_prf#6574,o_custkey_prf#6575,o_orderpriority_prf#6576,o_clerk_prf#6577,o_orderstatus_prf#6578,o_totalprice_prf#6579,o_orderkey_prf#6580,o_comment_prf#6581] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_2))
            :- Project [c_acctbal_prf#6584 AS c_acctbal_prf_2#6593, rid#6585 AS rid_2#6594, c_name_prf#6586 AS c_name_prf_2#6595, c_nationkey_prf#6587 AS c_nationkey_prf_2#6596, c_custkey_prf#6588 AS c_custkey_prf_2#6597, c_comment_prf#6589 AS c_comment_prf_2#6598, c_address_prf#6590 AS c_address_prf_2#6599, c_mktsegment_prf#6591 AS c_mktsegment_prf_2#6600, c_phone_prf#6592 AS c_phone_prf_2#6601]
            :  +- Relation[c_acctbal_prf#6584,rid#6585,c_name_prf#6586,c_nationkey_prf#6587,c_custkey_prf#6588,c_comment_prf#6589,c_address_prf#6590,c_mktsegment_prf#6591,c_phone_prf#6592] JDBCRelation(customer_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#6602]
               +- DexRidFilter customer~c_mktsegment~BUILDING
                  +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 122263ms

fr2d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderstatus = 'F' and o_orderkey = l_orderkey
19/10/16 22:48:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:48:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6677L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 22:48:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6677L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2110) AS rid_2#6729]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [c_acctbal_prf#6679 AS c_acctbal_prf_0#6688, rid#6680 AS rid_0#6689, c_name_prf#6681 AS c_name_prf_0#6690, c_nationkey_prf#6682 AS c_nationkey_prf_0#6691, c_custkey_prf#6683 AS c_custkey_prf_0#6692, c_comment_prf#6684 AS c_comment_prf_0#6693, c_address_prf#6685 AS c_address_prf_0#6694, c_mktsegment_prf#6686 AS c_mktsegment_prf_0#6695, c_phone_prf#6687 AS c_phone_prf_0#6696]
         :     :  :  :  +- Relation[c_acctbal_prf#6679,rid#6680,c_name_prf#6681,c_nationkey_prf#6682,c_custkey_prf#6683,c_comment_prf#6684,c_address_prf#6685,c_mktsegment_prf#6686,c_phone_prf#6687] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2110) AS rid_1#6707]
         :     :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#6706]
         :     :  :        :  +- Relation[c_acctbal_prf#6697,rid#6698,c_name_prf#6699,c_nationkey_prf#6700,c_custkey_prf#6701,c_comment_prf#6702,c_address_prf#6703,c_mktsegment_prf#6704,c_phone_prf#6705] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [o_shippriority_prf#6708 AS o_shippriority_prf_1#6718, rid#6709 AS rid_1#6719, o_orderdate_prf#6710 AS o_orderdate_prf_1#6720, o_custkey_prf#6711 AS o_custkey_prf_1#6721, o_orderpriority_prf#6712 AS o_orderpriority_prf_1#6722, o_clerk_prf#6713 AS o_clerk_prf_1#6723, o_orderstatus_prf#6714 AS o_orderstatus_prf_1#6724, o_totalprice_prf#6715 AS o_totalprice_prf_1#6725, o_orderkey_prf#6716 AS o_orderkey_prf_1#6726, o_comment_prf#6717 AS o_comment_prf_1#6727]
         :     :     :  +- Relation[o_shippriority_prf#6708,rid#6709,o_orderdate_prf#6710,o_custkey_prf#6711,o_orderpriority_prf#6712,o_clerk_prf#6713,o_orderstatus_prf#6714,o_totalprice_prf#6715,o_orderkey_prf#6716,o_comment_prf#6717] JDBCRelation(orders_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6728]
         :     :        +- DexRidFilter orders~o_orderstatus~F
         :     :           +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2109,value#2110] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#6730 AS l_returnflag_prf_2#6749, l_orderkey_and_l_linenumber_prf#6731 AS l_orderkey_and_l_linenumber_prf_2#6750, l_comment_prf#6732 AS l_comment_prf_2#6751, l_linestatus_prf#6733 AS l_linestatus_prf_2#6752, rid#6734 AS rid_2#6753, l_shipmode_prf#6735 AS l_shipmode_prf_2#6754, l_shipinstruct_prf#6736 AS l_shipinstruct_prf_2#6755, l_quantity_prf#6737 AS l_quantity_prf_2#6756, l_receiptdate_prf#6738 AS l_receiptdate_prf_2#6757, l_linenumber_prf#6739 AS l_linenumber_prf_2#6758, l_tax_prf#6740 AS l_tax_prf_2#6759, l_shipdate_prf#6741 AS l_shipdate_prf_2#6760, l_extendedprice_prf#6742 AS l_extendedprice_prf_2#6761, l_partkey_prf#6743 AS l_partkey_prf_2#6762, l_discount_prf#6744 AS l_discount_prf_2#6763, l_partkey_and_l_suppkey_prf#6745 AS l_partkey_and_l_suppkey_prf_2#6764, l_commitdate_prf#6746 AS l_commitdate_prf_2#6765, l_suppkey_prf#6747 AS l_suppkey_prf_2#6766, l_orderkey_prf#6748 AS l_orderkey_prf_2#6767]
            +- Relation[l_returnflag_prf#6730,l_orderkey_and_l_linenumber_prf#6731,l_comment_prf#6732,l_linestatus_prf#6733,rid#6734,l_shipmode_prf#6735,l_shipinstruct_prf#6736,l_quantity_prf#6737,l_receiptdate_prf#6738,l_linenumber_prf#6739,l_tax_prf#6740,l_shipdate_prf#6741,l_extendedprice_prf#6742,l_partkey_prf#6743,l_discount_prf#6744,l_partkey_and_l_suppkey_prf#6745,l_commitdate_prf#6746,l_suppkey_prf#6747,l_orderkey_prf#6748] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 107714ms
query=fq1a, count=246415, duration=31008
query=fq1b, count=246415, duration=140344
query=fq1c, count=246415, duration=163582
query=fq1d, count=246415, duration=74591
query=fq1e, count=246415, duration=164398
query=fq1f, count=246415, duration=168519
query=fr1a, count=1214743, duration=122263
query=fr1b, count=1214743, duration=121119
query=fr1c, count=1214743, duration=82888
query=fr1d, count=1214743, duration=32737
query=fr1e, count=1214743, duration=152403
query=fr2a, count=2901744, duration=194047
query=fr2b, count=2901744, duration=105891
query=fr2d, count=2901744, duration=107714
query=fr2e, count=2901744, duration=95998
query=fr2f, count=2901744, duration=83171
query=fs1a, count=1214743, duration=108649
query=fs1b, count=1214743, duration=172827
query=fs1c, count=1214743, duration=172973
query=ft1a, count=2452200, duration=47770
query=ft1b, count=2452200, duration=30116
query=ft1c, count=2452200, duration=33580
query=ft1d, count=2452200, duration=24073
query=ft2a, count=15628, duration=49080
query=ft2b, count=15628, duration=915
query=ft2c, count=15628, duration=7012
query=ft3a, count=117754, duration=95893
query=ft3b, count=117754, duration=6162
query=ft3c, count=117754, duration=55629
