19/10/16 23:34:23 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7124ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Wed Oct 16 23:34:25 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Wed Oct 16 23:34:26 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Wed Oct 16 23:34:26 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Wed Oct 16 23:34:26 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Wed Oct 16 23:34:26 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Wed Oct 16 23:34:29 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Wed Oct 16 23:34:31 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Wed Oct 16 23:34:31 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



ft3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and p_size = 15 and l_suppkey = s_suppkey
19/10/16 23:34:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:34:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2092L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 23:34:33 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:34:33 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:34:33 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
19/10/16 23:34:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2092L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, rid_0#2117: string
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [l_returnflag_prf#2094 AS l_returnflag_prf_0#2113, l_orderkey_and_l_linenumber_prf#2095 AS l_orderkey_and_l_linenumber_prf_0#2114, l_comment_prf#2096 AS l_comment_prf_0#2115, l_linestatus_prf#2097 AS l_linestatus_prf_0#2116, rid#2098 AS rid_0#2117, l_shipmode_prf#2099 AS l_shipmode_prf_0#2118, l_shipinstruct_prf#2100 AS l_shipinstruct_prf_0#2119, l_quantity_prf#2101 AS l_quantity_prf_0#2120, l_receiptdate_prf#2102 AS l_receiptdate_prf_0#2121, l_linenumber_prf#2103 AS l_linenumber_prf_0#2122, l_tax_prf#2104 AS l_tax_prf_0#2123, l_shipdate_prf#2105 AS l_shipdate_prf_0#2124, l_extendedprice_prf#2106 AS l_extendedprice_prf_0#2125, l_partkey_prf#2107 AS l_partkey_prf_0#2126, l_discount_prf#2108 AS l_discount_prf_0#2127, l_partkey_and_l_suppkey_prf#2109 AS l_partkey_and_l_suppkey_prf_0#2128, l_commitdate_prf#2110 AS l_commitdate_prf_0#2129, l_suppkey_prf#2111 AS l_suppkey_prf_0#2130, l_orderkey_prf#2112 AS l_orderkey_prf_0#2131]
         :     :  :  :  +- Relation[l_returnflag_prf#2094,l_orderkey_and_l_linenumber_prf#2095,l_comment_prf#2096,l_linestatus_prf#2097,rid#2098,l_shipmode_prf#2099,l_shipinstruct_prf#2100,l_quantity_prf#2101,l_receiptdate_prf#2102,l_linenumber_prf#2103,l_tax_prf#2104,l_shipdate_prf#2105,l_extendedprice_prf#2106,l_partkey_prf#2107,l_discount_prf#2108,l_partkey_and_l_suppkey_prf#2109,l_commitdate_prf#2110,l_suppkey_prf#2111,l_orderkey_prf#2112] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#2154]
         :     :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#2151]
         :     :  :        :  +- Relation[l_returnflag_prf#2132,l_orderkey_and_l_linenumber_prf#2133,l_comment_prf#2134,l_linestatus_prf#2135,rid#2136,l_shipmode_prf#2137,l_shipinstruct_prf#2138,l_quantity_prf#2139,l_receiptdate_prf#2140,l_linenumber_prf#2141,l_tax_prf#2142,l_shipdate_prf#2143,l_extendedprice_prf#2144,l_partkey_prf#2145,l_discount_prf#2146,l_partkey_and_l_suppkey_prf#2147,l_commitdate_prf#2148,l_suppkey_prf#2149,l_orderkey_prf#2150] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [p_comment_prf#2155 AS p_comment_prf_1#2165, p_name_prf#2156 AS p_name_prf_1#2166, rid#2157 AS rid_1#2167, p_type_prf#2158 AS p_type_prf_1#2168, p_retailprice_prf#2159 AS p_retailprice_prf_1#2169, p_mfgr_prf#2160 AS p_mfgr_prf_1#2170, p_container_prf#2161 AS p_container_prf_1#2171, p_brand_prf#2162 AS p_brand_prf_1#2172, p_size_prf#2163 AS p_size_prf_1#2173, p_partkey_prf#2164 AS p_partkey_prf_1#2174]
         :     :     :  +- Relation[p_comment_prf#2155,p_name_prf#2156,rid#2157,p_type_prf#2158,p_retailprice_prf#2159,p_mfgr_prf#2160,p_container_prf#2161,p_brand_prf#2162,p_size_prf#2163,p_partkey_prf#2164] JDBCRelation(part_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2177]
         :     :        +- DexRidFilter part~p_size~15
         :     :           +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2179 AS s_phone_prf_2#2187, rid#2180 AS rid_2#2188, s_address_prf#2181 AS s_address_prf_2#2189, s_nationkey_prf#2182 AS s_nationkey_prf_2#2190, s_suppkey_prf#2183 AS s_suppkey_prf_2#2191, s_name_prf#2184 AS s_name_prf_2#2192, s_acctbal_prf#2185 AS s_acctbal_prf_2#2193, s_comment_prf#2186 AS s_comment_prf_2#2194]
            +- Relation[s_phone_prf#2179,rid#2180,s_address_prf#2181,s_nationkey_prf#2182,s_suppkey_prf#2183,s_name_prf#2184,s_acctbal_prf#2185,s_comment_prf#2186] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 97180ms

fq1a=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 23:36:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:36:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2272L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :     :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 23:36:10 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:36:10 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:36:10 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:36:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2272L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, 'rid_2, 'o_shippriority_prf_2, 'o_orderdate_prf_2, 'o_custkey_prf_2, 'o_orderpriority_prf_2, 'o_clerk_prf_2, 'o_orderstatus_prf_2, 'o_totalprice_prf_2, 'o_orderkey_prf_2, 'o_comment_prf_2, dexdecrypt('value_dec_key, value#2153) AS rid_3#2325]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#2304]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#2285]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#2279: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [rid#2274 AS rid_0#2279, n_regionkey_prf#2275 AS n_regionkey_prf_0#2280, n_nationkey_prf#2276 AS n_nationkey_prf_0#2281, n_name_prf#2277 AS n_name_prf_0#2282, n_comment_prf#2278 AS n_comment_prf_0#2283]
         :     :  :     :  :     :  :  +- Relation[rid#2274,n_regionkey_prf#2275,n_nationkey_prf#2276,n_name_prf#2277,n_comment_prf#2278] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2284]
         :     :  :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :  :     :        +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [c_acctbal_prf#2286 AS c_acctbal_prf_1#2295, rid#2287 AS rid_1#2296, c_name_prf#2288 AS c_name_prf_1#2297, c_nationkey_prf#2289 AS c_nationkey_prf_1#2298, c_custkey_prf#2290 AS c_custkey_prf_1#2299, c_comment_prf#2291 AS c_comment_prf_1#2300, c_address_prf#2292 AS c_address_prf_1#2301, c_mktsegment_prf#2293 AS c_mktsegment_prf_1#2302, c_phone_prf#2294 AS c_phone_prf_1#2303]
         :     :  :     :     +- Relation[c_acctbal_prf#2286,rid#2287,c_name_prf#2288,c_nationkey_prf#2289,c_custkey_prf#2290,c_comment_prf#2291,c_address_prf#2292,c_mktsegment_prf#2293,c_phone_prf#2294] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#2305 AS o_shippriority_prf_2#2315, rid#2306 AS rid_2#2316, o_orderdate_prf#2307 AS o_orderdate_prf_2#2317, o_custkey_prf#2308 AS o_custkey_prf_2#2318, o_orderpriority_prf#2309 AS o_orderpriority_prf_2#2319, o_clerk_prf#2310 AS o_clerk_prf_2#2320, o_orderstatus_prf#2311 AS o_orderstatus_prf_2#2321, o_totalprice_prf#2312 AS o_totalprice_prf_2#2322, o_orderkey_prf#2313 AS o_orderkey_prf_2#2323, o_comment_prf#2314 AS o_comment_prf_2#2324]
         :     :     +- Relation[o_shippriority_prf#2305,rid#2306,o_orderdate_prf#2307,o_custkey_prf#2308,o_orderpriority_prf#2309,o_clerk_prf#2310,o_orderstatus_prf#2311,o_totalprice_prf#2312,o_orderkey_prf#2313,o_comment_prf#2314] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2326 AS l_returnflag_prf_3#2345, l_orderkey_and_l_linenumber_prf#2327 AS l_orderkey_and_l_linenumber_prf_3#2346, l_comment_prf#2328 AS l_comment_prf_3#2347, l_linestatus_prf#2329 AS l_linestatus_prf_3#2348, rid#2330 AS rid_3#2349, l_shipmode_prf#2331 AS l_shipmode_prf_3#2350, l_shipinstruct_prf#2332 AS l_shipinstruct_prf_3#2351, l_quantity_prf#2333 AS l_quantity_prf_3#2352, l_receiptdate_prf#2334 AS l_receiptdate_prf_3#2353, l_linenumber_prf#2335 AS l_linenumber_prf_3#2354, l_tax_prf#2336 AS l_tax_prf_3#2355, l_shipdate_prf#2337 AS l_shipdate_prf_3#2356, l_extendedprice_prf#2338 AS l_extendedprice_prf_3#2357, l_partkey_prf#2339 AS l_partkey_prf_3#2358, l_discount_prf#2340 AS l_discount_prf_3#2359, l_partkey_and_l_suppkey_prf#2341 AS l_partkey_and_l_suppkey_prf_3#2360, l_commitdate_prf#2342 AS l_commitdate_prf_3#2361, l_suppkey_prf#2343 AS l_suppkey_prf_3#2362, l_orderkey_prf#2344 AS l_orderkey_prf_3#2363]
            +- Relation[l_returnflag_prf#2326,l_orderkey_and_l_linenumber_prf#2327,l_comment_prf#2328,l_linestatus_prf#2329,rid#2330,l_shipmode_prf#2331,l_shipinstruct_prf#2332,l_quantity_prf#2333,l_receiptdate_prf#2334,l_linenumber_prf#2335,l_tax_prf#2336,l_shipdate_prf#2337,l_extendedprice_prf#2338,l_partkey_prf#2339,l_discount_prf#2340,l_partkey_and_l_suppkey_prf#2341,l_commitdate_prf#2342,l_suppkey_prf#2343,l_orderkey_prf#2344] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 31190ms

ft1b=
select * from nation, supplier, customer where n_name = 'FRANCE' and n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/16 23:36:41 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:36:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2429L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 23:36:41 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:36:41 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:36:41 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:36:41 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:36:41 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:36:41 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:36:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2429L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#2459]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#2442]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#2436: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#2431 AS rid_0#2436, n_regionkey_prf#2432 AS n_regionkey_prf_0#2437, n_nationkey_prf#2433 AS n_nationkey_prf_0#2438, n_name_prf#2434 AS n_name_prf_0#2439, n_comment_prf#2435 AS n_comment_prf_0#2440]
         :     :  :     :  :  +- Relation[rid#2431,n_regionkey_prf#2432,n_nationkey_prf#2433,n_name_prf#2434,n_comment_prf#2435] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2441]
         :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :        +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#2443 AS s_phone_prf_1#2451, rid#2444 AS rid_1#2452, s_address_prf#2445 AS s_address_prf_1#2453, s_nationkey_prf#2446 AS s_nationkey_prf_1#2454, s_suppkey_prf#2447 AS s_suppkey_prf_1#2455, s_name_prf#2448 AS s_name_prf_1#2456, s_acctbal_prf#2449 AS s_acctbal_prf_1#2457, s_comment_prf#2450 AS s_comment_prf_1#2458]
         :     :     +- Relation[s_phone_prf#2443,rid#2444,s_address_prf#2445,s_nationkey_prf#2446,s_suppkey_prf#2447,s_name_prf#2448,s_acctbal_prf#2449,s_comment_prf#2450] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2460 AS c_acctbal_prf_2#2469, rid#2461 AS rid_2#2470, c_name_prf#2462 AS c_name_prf_2#2471, c_nationkey_prf#2463 AS c_nationkey_prf_2#2472, c_custkey_prf#2464 AS c_custkey_prf_2#2473, c_comment_prf#2465 AS c_comment_prf_2#2474, c_address_prf#2466 AS c_address_prf_2#2475, c_mktsegment_prf#2467 AS c_mktsegment_prf_2#2476, c_phone_prf#2468 AS c_phone_prf_2#2477]
            +- Relation[c_acctbal_prf#2460,rid#2461,c_name_prf#2462,c_nationkey_prf#2463,c_custkey_prf#2464,c_comment_prf#2465,c_address_prf#2466,c_mktsegment_prf#2467,c_phone_prf#2468] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 30060ms

fr2d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderstatus = 'F' and o_orderkey = l_orderkey
19/10/16 23:37:11 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:37:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2536L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 23:37:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2536L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#2588]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [c_acctbal_prf#2538 AS c_acctbal_prf_0#2547, rid#2539 AS rid_0#2548, c_name_prf#2540 AS c_name_prf_0#2549, c_nationkey_prf#2541 AS c_nationkey_prf_0#2550, c_custkey_prf#2542 AS c_custkey_prf_0#2551, c_comment_prf#2543 AS c_comment_prf_0#2552, c_address_prf#2544 AS c_address_prf_0#2553, c_mktsegment_prf#2545 AS c_mktsegment_prf_0#2554, c_phone_prf#2546 AS c_phone_prf_0#2555]
         :     :  :  :  +- Relation[c_acctbal_prf#2538,rid#2539,c_name_prf#2540,c_nationkey_prf#2541,c_custkey_prf#2542,c_comment_prf#2543,c_address_prf#2544,c_mktsegment_prf#2545,c_phone_prf#2546] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#2566]
         :     :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#2565]
         :     :  :        :  +- Relation[c_acctbal_prf#2556,rid#2557,c_name_prf#2558,c_nationkey_prf#2559,c_custkey_prf#2560,c_comment_prf#2561,c_address_prf#2562,c_mktsegment_prf#2563,c_phone_prf#2564] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [o_shippriority_prf#2567 AS o_shippriority_prf_1#2577, rid#2568 AS rid_1#2578, o_orderdate_prf#2569 AS o_orderdate_prf_1#2579, o_custkey_prf#2570 AS o_custkey_prf_1#2580, o_orderpriority_prf#2571 AS o_orderpriority_prf_1#2581, o_clerk_prf#2572 AS o_clerk_prf_1#2582, o_orderstatus_prf#2573 AS o_orderstatus_prf_1#2583, o_totalprice_prf#2574 AS o_totalprice_prf_1#2584, o_orderkey_prf#2575 AS o_orderkey_prf_1#2585, o_comment_prf#2576 AS o_comment_prf_1#2586]
         :     :     :  +- Relation[o_shippriority_prf#2567,rid#2568,o_orderdate_prf#2569,o_custkey_prf#2570,o_orderpriority_prf#2571,o_clerk_prf#2572,o_orderstatus_prf#2573,o_totalprice_prf#2574,o_orderkey_prf#2575,o_comment_prf#2576] JDBCRelation(orders_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2587]
         :     :        +- DexRidFilter orders~o_orderstatus~F
         :     :           +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2589 AS l_returnflag_prf_2#2608, l_orderkey_and_l_linenumber_prf#2590 AS l_orderkey_and_l_linenumber_prf_2#2609, l_comment_prf#2591 AS l_comment_prf_2#2610, l_linestatus_prf#2592 AS l_linestatus_prf_2#2611, rid#2593 AS rid_2#2612, l_shipmode_prf#2594 AS l_shipmode_prf_2#2613, l_shipinstruct_prf#2595 AS l_shipinstruct_prf_2#2614, l_quantity_prf#2596 AS l_quantity_prf_2#2615, l_receiptdate_prf#2597 AS l_receiptdate_prf_2#2616, l_linenumber_prf#2598 AS l_linenumber_prf_2#2617, l_tax_prf#2599 AS l_tax_prf_2#2618, l_shipdate_prf#2600 AS l_shipdate_prf_2#2619, l_extendedprice_prf#2601 AS l_extendedprice_prf_2#2620, l_partkey_prf#2602 AS l_partkey_prf_2#2621, l_discount_prf#2603 AS l_discount_prf_2#2622, l_partkey_and_l_suppkey_prf#2604 AS l_partkey_and_l_suppkey_prf_2#2623, l_commitdate_prf#2605 AS l_commitdate_prf_2#2624, l_suppkey_prf#2606 AS l_suppkey_prf_2#2625, l_orderkey_prf#2607 AS l_orderkey_prf_2#2626]
            +- Relation[l_returnflag_prf#2589,l_orderkey_and_l_linenumber_prf#2590,l_comment_prf#2591,l_linestatus_prf#2592,rid#2593,l_shipmode_prf#2594,l_shipinstruct_prf#2595,l_quantity_prf#2596,l_receiptdate_prf#2597,l_linenumber_prf#2598,l_tax_prf#2599,l_shipdate_prf#2600,l_extendedprice_prf#2601,l_partkey_prf#2602,l_discount_prf#2603,l_partkey_and_l_suppkey_prf#2604,l_commitdate_prf#2605,l_suppkey_prf#2606,l_orderkey_prf#2607] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 107987ms

fr1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and (l_orderkey = o_orderkey and c_mktsegment = 'BUILDING')
19/10/16 23:38:59 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:38:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2701L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 23:38:59 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:38:59 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:38:59 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:38:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2701L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#2703 AS l_returnflag_prf_0#2722, l_orderkey_and_l_linenumber_prf#2704 AS l_orderkey_and_l_linenumber_prf_0#2723, l_comment_prf#2705 AS l_comment_prf_0#2724, l_linestatus_prf#2706 AS l_linestatus_prf_0#2725, rid#2707 AS rid_0#2726, l_shipmode_prf#2708 AS l_shipmode_prf_0#2727, l_shipinstruct_prf#2709 AS l_shipinstruct_prf_0#2728, l_quantity_prf#2710 AS l_quantity_prf_0#2729, l_receiptdate_prf#2711 AS l_receiptdate_prf_0#2730, l_linenumber_prf#2712 AS l_linenumber_prf_0#2731, l_tax_prf#2713 AS l_tax_prf_0#2732, l_shipdate_prf#2714 AS l_shipdate_prf_0#2733, l_extendedprice_prf#2715 AS l_extendedprice_prf_0#2734, l_partkey_prf#2716 AS l_partkey_prf_0#2735, l_discount_prf#2717 AS l_discount_prf_0#2736, l_partkey_and_l_suppkey_prf#2718 AS l_partkey_and_l_suppkey_prf_0#2737, l_commitdate_prf#2719 AS l_commitdate_prf_0#2738, l_suppkey_prf#2720 AS l_suppkey_prf_0#2739, l_orderkey_prf#2721 AS l_orderkey_prf_0#2740]
         :  :  +- Relation[l_returnflag_prf#2703,l_orderkey_and_l_linenumber_prf#2704,l_comment_prf#2705,l_linestatus_prf#2706,rid#2707,l_shipmode_prf#2708,l_shipinstruct_prf#2709,l_quantity_prf#2710,l_receiptdate_prf#2711,l_linenumber_prf#2712,l_tax_prf#2713,l_shipdate_prf#2714,l_extendedprice_prf#2715,l_partkey_prf#2716,l_discount_prf#2717,l_partkey_and_l_suppkey_prf#2718,l_commitdate_prf#2719,l_suppkey_prf#2720,l_orderkey_prf#2721] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#2761]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2760]
         :        :  +- Relation[l_returnflag_prf#2741,l_orderkey_and_l_linenumber_prf#2742,l_comment_prf#2743,l_linestatus_prf#2744,rid#2745,l_shipmode_prf#2746,l_shipinstruct_prf#2747,l_quantity_prf#2748,l_receiptdate_prf#2749,l_linenumber_prf#2750,l_tax_prf#2751,l_shipdate_prf#2752,l_extendedprice_prf#2753,l_partkey_prf#2754,l_discount_prf#2755,l_partkey_and_l_suppkey_prf#2756,l_commitdate_prf#2757,l_suppkey_prf#2758,l_orderkey_prf#2759] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [o_shippriority_prf#2762 AS o_shippriority_prf_1#2772, rid#2763 AS rid_1#2773, o_orderdate_prf#2764 AS o_orderdate_prf_1#2774, o_custkey_prf#2765 AS o_custkey_prf_1#2775, o_orderpriority_prf#2766 AS o_orderpriority_prf_1#2776, o_clerk_prf#2767 AS o_clerk_prf_1#2777, o_orderstatus_prf#2768 AS o_orderstatus_prf_1#2778, o_totalprice_prf#2769 AS o_totalprice_prf_1#2779, o_orderkey_prf#2770 AS o_orderkey_prf_1#2780, o_comment_prf#2771 AS o_comment_prf_1#2781]
            :  :  +- Relation[o_shippriority_prf#2762,rid#2763,o_orderdate_prf#2764,o_custkey_prf#2765,o_orderpriority_prf#2766,o_clerk_prf#2767,o_orderstatus_prf#2768,o_totalprice_prf#2769,o_orderkey_prf#2770,o_comment_prf#2771] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#2793]
            :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#2792]
            :        :  +- Relation[o_shippriority_prf#2782,rid#2783,o_orderdate_prf#2784,o_custkey_prf#2785,o_orderpriority_prf#2786,o_clerk_prf#2787,o_orderstatus_prf#2788,o_totalprice_prf#2789,o_orderkey_prf#2790,o_comment_prf#2791] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [c_acctbal_prf#2794 AS c_acctbal_prf_2#2803, rid#2795 AS rid_2#2804, c_name_prf#2796 AS c_name_prf_2#2805, c_nationkey_prf#2797 AS c_nationkey_prf_2#2806, c_custkey_prf#2798 AS c_custkey_prf_2#2807, c_comment_prf#2799 AS c_comment_prf_2#2808, c_address_prf#2800 AS c_address_prf_2#2809, c_mktsegment_prf#2801 AS c_mktsegment_prf_2#2810, c_phone_prf#2802 AS c_phone_prf_2#2811]
               :  +- Relation[c_acctbal_prf#2794,rid#2795,c_name_prf#2796,c_nationkey_prf#2797,c_custkey_prf#2798,c_comment_prf#2799,c_address_prf#2800,c_mktsegment_prf#2801,c_phone_prf#2802] JDBCRelation(customer_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#2812]
                  +- DexRidFilter customer~c_mktsegment~BUILDING
                     +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 121539ms

fs1b=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/16 23:41:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:41:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2896L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L, l_partkey#307L]
               :  +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L]
                  +- Join Inner, (c_custkey#290L = o_custkey#343L)
                     :- Project [c_custkey#290L]
                     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
                     +- Project [o_orderkey#342L, o_custkey#343L]
                        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 23:41:00 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:41:00 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:41:00 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:41:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2896L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [p_comment_prf#2898 AS p_comment_prf_0#2908, p_name_prf#2899 AS p_name_prf_0#2909, rid#2900 AS rid_0#2910, p_type_prf#2901 AS p_type_prf_0#2911, p_retailprice_prf#2902 AS p_retailprice_prf_0#2912, p_mfgr_prf#2903 AS p_mfgr_prf_0#2913, p_container_prf#2904 AS p_container_prf_0#2914, p_brand_prf#2905 AS p_brand_prf_0#2915, p_size_prf#2906 AS p_size_prf_0#2916, p_partkey_prf#2907 AS p_partkey_prf_0#2917]
         :  :  +- Relation[p_comment_prf#2898,p_name_prf#2899,rid#2900,p_type_prf#2901,p_retailprice_prf#2902,p_mfgr_prf#2903,p_container_prf#2904,p_brand_prf#2905,p_size_prf#2906,p_partkey_prf#2907] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#2929]
         :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2928]
         :        :  +- Relation[p_comment_prf#2918,p_name_prf#2919,rid#2920,p_type_prf#2921,p_retailprice_prf#2922,p_mfgr_prf#2923,p_container_prf#2924,p_brand_prf#2925,p_size_prf#2926,p_partkey_prf#2927] JDBCRelation(part_prf) [numPartitions=1]
         :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [l_returnflag_prf#2930 AS l_returnflag_prf_1#2949, l_orderkey_and_l_linenumber_prf#2931 AS l_orderkey_and_l_linenumber_prf_1#2950, l_comment_prf#2932 AS l_comment_prf_1#2951, l_linestatus_prf#2933 AS l_linestatus_prf_1#2952, rid#2934 AS rid_1#2953, l_shipmode_prf#2935 AS l_shipmode_prf_1#2954, l_shipinstruct_prf#2936 AS l_shipinstruct_prf_1#2955, l_quantity_prf#2937 AS l_quantity_prf_1#2956, l_receiptdate_prf#2938 AS l_receiptdate_prf_1#2957, l_linenumber_prf#2939 AS l_linenumber_prf_1#2958, l_tax_prf#2940 AS l_tax_prf_1#2959, l_shipdate_prf#2941 AS l_shipdate_prf_1#2960, l_extendedprice_prf#2942 AS l_extendedprice_prf_1#2961, l_partkey_prf#2943 AS l_partkey_prf_1#2962, l_discount_prf#2944 AS l_discount_prf_1#2963, l_partkey_and_l_suppkey_prf#2945 AS l_partkey_and_l_suppkey_prf_1#2964, l_commitdate_prf#2946 AS l_commitdate_prf_1#2965, l_suppkey_prf#2947 AS l_suppkey_prf_1#2966, l_orderkey_prf#2948 AS l_orderkey_prf_1#2967]
            :  :  +- Relation[l_returnflag_prf#2930,l_orderkey_and_l_linenumber_prf#2931,l_comment_prf#2932,l_linestatus_prf#2933,rid#2934,l_shipmode_prf#2935,l_shipinstruct_prf#2936,l_quantity_prf#2937,l_receiptdate_prf#2938,l_linenumber_prf#2939,l_tax_prf#2940,l_shipdate_prf#2941,l_extendedprice_prf#2942,l_partkey_prf#2943,l_discount_prf#2944,l_partkey_and_l_suppkey_prf#2945,l_commitdate_prf#2946,l_suppkey_prf#2947,l_orderkey_prf#2948] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2153) AS rid_3#2988]
            :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#2987]
            :        :  +- Relation[l_returnflag_prf#2968,l_orderkey_and_l_linenumber_prf#2969,l_comment_prf#2970,l_linestatus_prf#2971,rid#2972,l_shipmode_prf#2973,l_shipinstruct_prf#2974,l_quantity_prf#2975,l_receiptdate_prf#2976,l_linenumber_prf#2977,l_tax_prf#2978,l_shipdate_prf#2979,l_extendedprice_prf#2980,l_partkey_prf#2981,l_discount_prf#2982,l_partkey_and_l_suppkey_prf#2983,l_commitdate_prf#2984,l_suppkey_prf#2985,l_orderkey_prf#2986] JDBCRelation(lineitem_prf) [numPartitions=1]
            :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join NaturalJoin(Inner)
               :- 'Project ['c_acctbal_prf_2, 'rid_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2153) AS rid_3#3008]
               :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_2#2999: string
               :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :     :  :- Project [c_acctbal_prf#2989 AS c_acctbal_prf_2#2998, rid#2990 AS rid_2#2999, c_name_prf#2991 AS c_name_prf_2#3000, c_nationkey_prf#2992 AS c_nationkey_prf_2#3001, c_custkey_prf#2993 AS c_custkey_prf_2#3002, c_comment_prf#2994 AS c_comment_prf_2#3003, c_address_prf#2995 AS c_address_prf_2#3004, c_mktsegment_prf#2996 AS c_mktsegment_prf_2#3005, c_phone_prf#2997 AS c_phone_prf_2#3006]
               :     :  :  +- Relation[c_acctbal_prf#2989,rid#2990,c_name_prf#2991,c_nationkey_prf#2992,c_custkey_prf#2993,c_comment_prf#2994,c_address_prf#2995,c_mktsegment_prf#2996,c_phone_prf#2997] JDBCRelation(customer_prf) [numPartitions=1]
               :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#3007]
               :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
               :     :        +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
               :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
               +- Project [o_shippriority_prf#3009 AS o_shippriority_prf_3#3019, rid#3010 AS rid_3#3020, o_orderdate_prf#3011 AS o_orderdate_prf_3#3021, o_custkey_prf#3012 AS o_custkey_prf_3#3022, o_orderpriority_prf#3013 AS o_orderpriority_prf_3#3023, o_clerk_prf#3014 AS o_clerk_prf_3#3024, o_orderstatus_prf#3015 AS o_orderstatus_prf_3#3025, o_totalprice_prf#3016 AS o_totalprice_prf_3#3026, o_orderkey_prf#3017 AS o_orderkey_prf_3#3027, o_comment_prf#3018 AS o_comment_prf_3#3028]
                  +- Relation[o_shippriority_prf#3009,rid#3010,o_orderdate_prf#3011,o_custkey_prf#3012,o_orderpriority_prf#3013,o_clerk_prf#3014,o_orderstatus_prf#3015,o_totalprice_prf#3016,o_orderkey_prf#3017,o_comment_prf#3018] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 173467ms

fq1e=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 23:43:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:43:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3117L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [c_custkey#290L, c_nationkey#293L]
                  +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 23:43:54 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:43:54 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:43:54 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:43:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3117L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [l_returnflag_prf#3119 AS l_returnflag_prf_0#3138, l_orderkey_and_l_linenumber_prf#3120 AS l_orderkey_and_l_linenumber_prf_0#3139, l_comment_prf#3121 AS l_comment_prf_0#3140, l_linestatus_prf#3122 AS l_linestatus_prf_0#3141, rid#3123 AS rid_0#3142, l_shipmode_prf#3124 AS l_shipmode_prf_0#3143, l_shipinstruct_prf#3125 AS l_shipinstruct_prf_0#3144, l_quantity_prf#3126 AS l_quantity_prf_0#3145, l_receiptdate_prf#3127 AS l_receiptdate_prf_0#3146, l_linenumber_prf#3128 AS l_linenumber_prf_0#3147, l_tax_prf#3129 AS l_tax_prf_0#3148, l_shipdate_prf#3130 AS l_shipdate_prf_0#3149, l_extendedprice_prf#3131 AS l_extendedprice_prf_0#3150, l_partkey_prf#3132 AS l_partkey_prf_0#3151, l_discount_prf#3133 AS l_discount_prf_0#3152, l_partkey_and_l_suppkey_prf#3134 AS l_partkey_and_l_suppkey_prf_0#3153, l_commitdate_prf#3135 AS l_commitdate_prf_0#3154, l_suppkey_prf#3136 AS l_suppkey_prf_0#3155, l_orderkey_prf#3137 AS l_orderkey_prf_0#3156]
         :  :  :  :  +- Relation[l_returnflag_prf#3119,l_orderkey_and_l_linenumber_prf#3120,l_comment_prf#3121,l_linestatus_prf#3122,rid#3123,l_shipmode_prf#3124,l_shipinstruct_prf#3125,l_quantity_prf#3126,l_receiptdate_prf#3127,l_linenumber_prf#3128,l_tax_prf#3129,l_shipdate_prf#3130,l_extendedprice_prf#3131,l_partkey_prf#3132,l_discount_prf#3133,l_partkey_and_l_suppkey_prf#3134,l_commitdate_prf#3135,l_suppkey_prf#3136,l_orderkey_prf#3137] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#3177]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#3176]
         :  :  :        :  +- Relation[l_returnflag_prf#3157,l_orderkey_and_l_linenumber_prf#3158,l_comment_prf#3159,l_linestatus_prf#3160,rid#3161,l_shipmode_prf#3162,l_shipinstruct_prf#3163,l_quantity_prf#3164,l_receiptdate_prf#3165,l_linenumber_prf#3166,l_tax_prf#3167,l_shipdate_prf#3168,l_extendedprice_prf#3169,l_partkey_prf#3170,l_discount_prf#3171,l_partkey_and_l_suppkey_prf#3172,l_commitdate_prf#3173,l_suppkey_prf#3174,l_orderkey_prf#3175] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#3178 AS o_shippriority_prf_1#3188, rid#3179 AS rid_1#3189, o_orderdate_prf#3180 AS o_orderdate_prf_1#3190, o_custkey_prf#3181 AS o_custkey_prf_1#3191, o_orderpriority_prf#3182 AS o_orderpriority_prf_1#3192, o_clerk_prf#3183 AS o_clerk_prf_1#3193, o_orderstatus_prf#3184 AS o_orderstatus_prf_1#3194, o_totalprice_prf#3185 AS o_totalprice_prf_1#3195, o_orderkey_prf#3186 AS o_orderkey_prf_1#3196, o_comment_prf#3187 AS o_comment_prf_1#3197]
         :  :     +- Relation[o_shippriority_prf#3178,rid#3179,o_orderdate_prf#3180,o_custkey_prf#3181,o_orderpriority_prf#3182,o_clerk_prf#3183,o_orderstatus_prf#3184,o_totalprice_prf#3185,o_orderkey_prf#3186,o_comment_prf#3187] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2153) AS rid_3#3209]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3208]
         :        :  +- Relation[o_shippriority_prf#3198,rid#3199,o_orderdate_prf#3200,o_custkey_prf#3201,o_orderpriority_prf#3202,o_clerk_prf#3203,o_orderstatus_prf#3204,o_totalprice_prf#3205,o_orderkey_prf#3206,o_comment_prf#3207] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_2, 'n_regionkey_prf_2, 'n_nationkey_prf_2, 'n_name_prf_2, 'n_comment_prf_2, dexdecrypt('value_dec_key, value#2153) AS rid_3#3221]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_2#3215: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [rid#3210 AS rid_2#3215, n_regionkey_prf#3211 AS n_regionkey_prf_2#3216, n_nationkey_prf#3212 AS n_nationkey_prf_2#3217, n_name_prf#3213 AS n_name_prf_2#3218, n_comment_prf#3214 AS n_comment_prf_2#3219]
            :     :  :  +- Relation[rid#3210,n_regionkey_prf#3211,n_nationkey_prf#3212,n_name_prf#3213,n_comment_prf#3214] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#3220]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#3222 AS c_acctbal_prf_3#3231, rid#3223 AS rid_3#3232, c_name_prf#3224 AS c_name_prf_3#3233, c_nationkey_prf#3225 AS c_nationkey_prf_3#3234, c_custkey_prf#3226 AS c_custkey_prf_3#3235, c_comment_prf#3227 AS c_comment_prf_3#3236, c_address_prf#3228 AS c_address_prf_3#3237, c_mktsegment_prf#3229 AS c_mktsegment_prf_3#3238, c_phone_prf#3230 AS c_phone_prf_3#3239]
               +- Relation[c_acctbal_prf#3222,rid#3223,c_name_prf#3224,c_nationkey_prf#3225,c_custkey_prf#3226,c_comment_prf#3227,c_address_prf#3228,c_mktsegment_prf#3229,c_phone_prf#3230] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 166430ms

fr2b=
select * from lineitem, orders, customer where o_custkey = c_custkey and o_orderstatus = 'F' and l_orderkey = o_orderkey
19/10/16 23:46:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:46:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3319L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 23:46:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3319L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#3321 AS l_returnflag_prf_0#3340, l_orderkey_and_l_linenumber_prf#3322 AS l_orderkey_and_l_linenumber_prf_0#3341, l_comment_prf#3323 AS l_comment_prf_0#3342, l_linestatus_prf#3324 AS l_linestatus_prf_0#3343, rid#3325 AS rid_0#3344, l_shipmode_prf#3326 AS l_shipmode_prf_0#3345, l_shipinstruct_prf#3327 AS l_shipinstruct_prf_0#3346, l_quantity_prf#3328 AS l_quantity_prf_0#3347, l_receiptdate_prf#3329 AS l_receiptdate_prf_0#3348, l_linenumber_prf#3330 AS l_linenumber_prf_0#3349, l_tax_prf#3331 AS l_tax_prf_0#3350, l_shipdate_prf#3332 AS l_shipdate_prf_0#3351, l_extendedprice_prf#3333 AS l_extendedprice_prf_0#3352, l_partkey_prf#3334 AS l_partkey_prf_0#3353, l_discount_prf#3335 AS l_discount_prf_0#3354, l_partkey_and_l_suppkey_prf#3336 AS l_partkey_and_l_suppkey_prf_0#3355, l_commitdate_prf#3337 AS l_commitdate_prf_0#3356, l_suppkey_prf#3338 AS l_suppkey_prf_0#3357, l_orderkey_prf#3339 AS l_orderkey_prf_0#3358]
         :  :  +- Relation[l_returnflag_prf#3321,l_orderkey_and_l_linenumber_prf#3322,l_comment_prf#3323,l_linestatus_prf#3324,rid#3325,l_shipmode_prf#3326,l_shipinstruct_prf#3327,l_quantity_prf#3328,l_receiptdate_prf#3329,l_linenumber_prf#3330,l_tax_prf#3331,l_shipdate_prf#3332,l_extendedprice_prf#3333,l_partkey_prf#3334,l_discount_prf#3335,l_partkey_and_l_suppkey_prf#3336,l_commitdate_prf#3337,l_suppkey_prf#3338,l_orderkey_prf#3339] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#3379]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3378]
         :        :  +- Relation[l_returnflag_prf#3359,l_orderkey_and_l_linenumber_prf#3360,l_comment_prf#3361,l_linestatus_prf#3362,rid#3363,l_shipmode_prf#3364,l_shipinstruct_prf#3365,l_quantity_prf#3366,l_receiptdate_prf#3367,l_linenumber_prf#3368,l_tax_prf#3369,l_shipdate_prf#3370,l_extendedprice_prf#3371,l_partkey_prf#3372,l_discount_prf#3373,l_partkey_and_l_suppkey_prf#3374,l_commitdate_prf#3375,l_suppkey_prf#3376,l_orderkey_prf#3377] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#3401]
            :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#3391: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#3380 AS o_shippriority_prf_1#3390, rid#3381 AS rid_1#3391, o_orderdate_prf#3382 AS o_orderdate_prf_1#3392, o_custkey_prf#3383 AS o_custkey_prf_1#3393, o_orderpriority_prf#3384 AS o_orderpriority_prf_1#3394, o_clerk_prf#3385 AS o_clerk_prf_1#3395, o_orderstatus_prf#3386 AS o_orderstatus_prf_1#3396, o_totalprice_prf#3387 AS o_totalprice_prf_1#3397, o_orderkey_prf#3388 AS o_orderkey_prf_1#3398, o_comment_prf#3389 AS o_comment_prf_1#3399]
            :     :  :  +- Relation[o_shippriority_prf#3380,rid#3381,o_orderdate_prf#3382,o_custkey_prf#3383,o_orderpriority_prf#3384,o_clerk_prf#3385,o_orderstatus_prf#3386,o_totalprice_prf#3387,o_orderkey_prf#3388,o_comment_prf#3389] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3400]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#3402 AS c_acctbal_prf_2#3411, rid#3403 AS rid_2#3412, c_name_prf#3404 AS c_name_prf_2#3413, c_nationkey_prf#3405 AS c_nationkey_prf_2#3414, c_custkey_prf#3406 AS c_custkey_prf_2#3415, c_comment_prf#3407 AS c_comment_prf_2#3416, c_address_prf#3408 AS c_address_prf_2#3417, c_mktsegment_prf#3409 AS c_mktsegment_prf_2#3418, c_phone_prf#3410 AS c_phone_prf_2#3419]
               +- Relation[c_acctbal_prf#3402,rid#3403,c_name_prf#3404,c_nationkey_prf#3405,c_custkey_prf#3406,c_comment_prf#3407,c_address_prf#3408,c_mktsegment_prf#3409,c_phone_prf#3410] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 106301ms

fr2e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/16 23:48:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:48:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3494L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 23:48:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3494L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#3496 AS c_acctbal_prf_0#3505, rid#3497 AS rid_0#3506, c_name_prf#3498 AS c_name_prf_0#3507, c_nationkey_prf#3499 AS c_nationkey_prf_0#3508, c_custkey_prf#3500 AS c_custkey_prf_0#3509, c_comment_prf#3501 AS c_comment_prf_0#3510, c_address_prf#3502 AS c_address_prf_0#3511, c_mktsegment_prf#3503 AS c_mktsegment_prf_0#3512, c_phone_prf#3504 AS c_phone_prf_0#3513]
         :  :  +- Relation[c_acctbal_prf#3496,rid#3497,c_name_prf#3498,c_nationkey_prf#3499,c_custkey_prf#3500,c_comment_prf#3501,c_address_prf#3502,c_mktsegment_prf#3503,c_phone_prf#3504] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#3524]
         :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3523]
         :        :  +- Relation[c_acctbal_prf#3514,rid#3515,c_name_prf#3516,c_nationkey_prf#3517,c_custkey_prf#3518,c_comment_prf#3519,c_address_prf#3520,c_mktsegment_prf#3521,c_phone_prf#3522] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#3546]
            :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#3536: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#3525 AS o_shippriority_prf_1#3535, rid#3526 AS rid_1#3536, o_orderdate_prf#3527 AS o_orderdate_prf_1#3537, o_custkey_prf#3528 AS o_custkey_prf_1#3538, o_orderpriority_prf#3529 AS o_orderpriority_prf_1#3539, o_clerk_prf#3530 AS o_clerk_prf_1#3540, o_orderstatus_prf#3531 AS o_orderstatus_prf_1#3541, o_totalprice_prf#3532 AS o_totalprice_prf_1#3542, o_orderkey_prf#3533 AS o_orderkey_prf_1#3543, o_comment_prf#3534 AS o_comment_prf_1#3544]
            :     :  :  +- Relation[o_shippriority_prf#3525,rid#3526,o_orderdate_prf#3527,o_custkey_prf#3528,o_orderpriority_prf#3529,o_clerk_prf#3530,o_orderstatus_prf#3531,o_totalprice_prf#3532,o_orderkey_prf#3533,o_comment_prf#3534] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3545]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3547 AS l_returnflag_prf_2#3566, l_orderkey_and_l_linenumber_prf#3548 AS l_orderkey_and_l_linenumber_prf_2#3567, l_comment_prf#3549 AS l_comment_prf_2#3568, l_linestatus_prf#3550 AS l_linestatus_prf_2#3569, rid#3551 AS rid_2#3570, l_shipmode_prf#3552 AS l_shipmode_prf_2#3571, l_shipinstruct_prf#3553 AS l_shipinstruct_prf_2#3572, l_quantity_prf#3554 AS l_quantity_prf_2#3573, l_receiptdate_prf#3555 AS l_receiptdate_prf_2#3574, l_linenumber_prf#3556 AS l_linenumber_prf_2#3575, l_tax_prf#3557 AS l_tax_prf_2#3576, l_shipdate_prf#3558 AS l_shipdate_prf_2#3577, l_extendedprice_prf#3559 AS l_extendedprice_prf_2#3578, l_partkey_prf#3560 AS l_partkey_prf_2#3579, l_discount_prf#3561 AS l_discount_prf_2#3580, l_partkey_and_l_suppkey_prf#3562 AS l_partkey_and_l_suppkey_prf_2#3581, l_commitdate_prf#3563 AS l_commitdate_prf_2#3582, l_suppkey_prf#3564 AS l_suppkey_prf_2#3583, l_orderkey_prf#3565 AS l_orderkey_prf_2#3584]
               +- Relation[l_returnflag_prf#3547,l_orderkey_and_l_linenumber_prf#3548,l_comment_prf#3549,l_linestatus_prf#3550,rid#3551,l_shipmode_prf#3552,l_shipinstruct_prf#3553,l_quantity_prf#3554,l_receiptdate_prf#3555,l_linenumber_prf#3556,l_tax_prf#3557,l_shipdate_prf#3558,l_extendedprice_prf#3559,l_partkey_prf#3560,l_discount_prf#3561,l_partkey_and_l_suppkey_prf#3562,l_commitdate_prf#3563,l_suppkey_prf#3564,l_orderkey_prf#3565] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 96132ms

ft3b=
select * from part, lineitem, supplier where p_size = 15 and p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/16 23:50:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:50:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3658L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 23:50:03 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:50:03 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:50:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3658L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#3681]
         :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3672: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [p_comment_prf#3660 AS p_comment_prf_0#3670, p_name_prf#3661 AS p_name_prf_0#3671, rid#3662 AS rid_0#3672, p_type_prf#3663 AS p_type_prf_0#3673, p_retailprice_prf#3664 AS p_retailprice_prf_0#3674, p_mfgr_prf#3665 AS p_mfgr_prf_0#3675, p_container_prf#3666 AS p_container_prf_0#3676, p_brand_prf#3667 AS p_brand_prf_0#3677, p_size_prf#3668 AS p_size_prf_0#3678, p_partkey_prf#3669 AS p_partkey_prf_0#3679]
         :     :  :     :  :  +- Relation[p_comment_prf#3660,p_name_prf#3661,rid#3662,p_type_prf#3663,p_retailprice_prf#3664,p_mfgr_prf#3665,p_container_prf#3666,p_brand_prf#3667,p_size_prf#3668,p_partkey_prf#3669] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3680]
         :     :  :     :     +- DexRidFilter part~p_size~15
         :     :  :     :        +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#3682 AS l_returnflag_prf_1#3701, l_orderkey_and_l_linenumber_prf#3683 AS l_orderkey_and_l_linenumber_prf_1#3702, l_comment_prf#3684 AS l_comment_prf_1#3703, l_linestatus_prf#3685 AS l_linestatus_prf_1#3704, rid#3686 AS rid_1#3705, l_shipmode_prf#3687 AS l_shipmode_prf_1#3706, l_shipinstruct_prf#3688 AS l_shipinstruct_prf_1#3707, l_quantity_prf#3689 AS l_quantity_prf_1#3708, l_receiptdate_prf#3690 AS l_receiptdate_prf_1#3709, l_linenumber_prf#3691 AS l_linenumber_prf_1#3710, l_tax_prf#3692 AS l_tax_prf_1#3711, l_shipdate_prf#3693 AS l_shipdate_prf_1#3712, l_extendedprice_prf#3694 AS l_extendedprice_prf_1#3713, l_partkey_prf#3695 AS l_partkey_prf_1#3714, l_discount_prf#3696 AS l_discount_prf_1#3715, l_partkey_and_l_suppkey_prf#3697 AS l_partkey_and_l_suppkey_prf_1#3716, l_commitdate_prf#3698 AS l_commitdate_prf_1#3717, l_suppkey_prf#3699 AS l_suppkey_prf_1#3718, l_orderkey_prf#3700 AS l_orderkey_prf_1#3719]
         :     :     +- Relation[l_returnflag_prf#3682,l_orderkey_and_l_linenumber_prf#3683,l_comment_prf#3684,l_linestatus_prf#3685,rid#3686,l_shipmode_prf#3687,l_shipinstruct_prf#3688,l_quantity_prf#3689,l_receiptdate_prf#3690,l_linenumber_prf#3691,l_tax_prf#3692,l_shipdate_prf#3693,l_extendedprice_prf#3694,l_partkey_prf#3695,l_discount_prf#3696,l_partkey_and_l_suppkey_prf#3697,l_commitdate_prf#3698,l_suppkey_prf#3699,l_orderkey_prf#3700] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3721 AS s_phone_prf_2#3729, rid#3722 AS rid_2#3730, s_address_prf#3723 AS s_address_prf_2#3731, s_nationkey_prf#3724 AS s_nationkey_prf_2#3732, s_suppkey_prf#3725 AS s_suppkey_prf_2#3733, s_name_prf#3726 AS s_name_prf_2#3734, s_acctbal_prf#3727 AS s_acctbal_prf_2#3735, s_comment_prf#3728 AS s_comment_prf_2#3736]
            +- Relation[s_phone_prf#3721,rid#3722,s_address_prf#3723,s_nationkey_prf#3724,s_suppkey_prf#3725,s_name_prf#3726,s_acctbal_prf#3727,s_comment_prf#3728] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 6155ms

fr1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and (c_mktsegment = 'BUILDING' and l_orderkey = o_orderkey)
19/10/16 23:50:09 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:50:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3810L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 23:50:09 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:50:09 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:50:09 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:50:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3810L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#3812 AS l_returnflag_prf_0#3831, l_orderkey_and_l_linenumber_prf#3813 AS l_orderkey_and_l_linenumber_prf_0#3832, l_comment_prf#3814 AS l_comment_prf_0#3833, l_linestatus_prf#3815 AS l_linestatus_prf_0#3834, rid#3816 AS rid_0#3835, l_shipmode_prf#3817 AS l_shipmode_prf_0#3836, l_shipinstruct_prf#3818 AS l_shipinstruct_prf_0#3837, l_quantity_prf#3819 AS l_quantity_prf_0#3838, l_receiptdate_prf#3820 AS l_receiptdate_prf_0#3839, l_linenumber_prf#3821 AS l_linenumber_prf_0#3840, l_tax_prf#3822 AS l_tax_prf_0#3841, l_shipdate_prf#3823 AS l_shipdate_prf_0#3842, l_extendedprice_prf#3824 AS l_extendedprice_prf_0#3843, l_partkey_prf#3825 AS l_partkey_prf_0#3844, l_discount_prf#3826 AS l_discount_prf_0#3845, l_partkey_and_l_suppkey_prf#3827 AS l_partkey_and_l_suppkey_prf_0#3846, l_commitdate_prf#3828 AS l_commitdate_prf_0#3847, l_suppkey_prf#3829 AS l_suppkey_prf_0#3848, l_orderkey_prf#3830 AS l_orderkey_prf_0#3849]
         :  :  +- Relation[l_returnflag_prf#3812,l_orderkey_and_l_linenumber_prf#3813,l_comment_prf#3814,l_linestatus_prf#3815,rid#3816,l_shipmode_prf#3817,l_shipinstruct_prf#3818,l_quantity_prf#3819,l_receiptdate_prf#3820,l_linenumber_prf#3821,l_tax_prf#3822,l_shipdate_prf#3823,l_extendedprice_prf#3824,l_partkey_prf#3825,l_discount_prf#3826,l_partkey_and_l_suppkey_prf#3827,l_commitdate_prf#3828,l_suppkey_prf#3829,l_orderkey_prf#3830] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2153) AS rid_2#3870]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3869]
         :        :  +- Relation[l_returnflag_prf#3850,l_orderkey_and_l_linenumber_prf#3851,l_comment_prf#3852,l_linestatus_prf#3853,rid#3854,l_shipmode_prf#3855,l_shipinstruct_prf#3856,l_quantity_prf#3857,l_receiptdate_prf#3858,l_linenumber_prf#3859,l_tax_prf#3860,l_shipdate_prf#3861,l_extendedprice_prf#3862,l_partkey_prf#3863,l_discount_prf#3864,l_partkey_and_l_suppkey_prf#3865,l_commitdate_prf#3866,l_suppkey_prf#3867,l_orderkey_prf#3868] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#3890]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#3881: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [c_acctbal_prf#3871 AS c_acctbal_prf_1#3880, rid#3872 AS rid_1#3881, c_name_prf#3873 AS c_name_prf_1#3882, c_nationkey_prf#3874 AS c_nationkey_prf_1#3883, c_custkey_prf#3875 AS c_custkey_prf_1#3884, c_comment_prf#3876 AS c_comment_prf_1#3885, c_address_prf#3877 AS c_address_prf_1#3886, c_mktsegment_prf#3878 AS c_mktsegment_prf_1#3887, c_phone_prf#3879 AS c_phone_prf_1#3888]
            :     :  :  +- Relation[c_acctbal_prf#3871,rid#3872,c_name_prf#3873,c_nationkey_prf#3874,c_custkey_prf#3875,c_comment_prf#3876,c_address_prf#3877,c_mktsegment_prf#3878,c_phone_prf#3879] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3889]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3891 AS o_shippriority_prf_2#3901, rid#3892 AS rid_2#3902, o_orderdate_prf#3893 AS o_orderdate_prf_2#3903, o_custkey_prf#3894 AS o_custkey_prf_2#3904, o_orderpriority_prf#3895 AS o_orderpriority_prf_2#3905, o_clerk_prf#3896 AS o_clerk_prf_2#3906, o_orderstatus_prf#3897 AS o_orderstatus_prf_2#3907, o_totalprice_prf#3898 AS o_totalprice_prf_2#3908, o_orderkey_prf#3899 AS o_orderkey_prf_2#3909, o_comment_prf#3900 AS o_comment_prf_2#3910]
               +- Relation[o_shippriority_prf#3891,rid#3892,o_orderdate_prf#3893,o_custkey_prf#3894,o_orderpriority_prf#3895,o_clerk_prf#3896,o_orderstatus_prf#3897,o_totalprice_prf#3898,o_orderkey_prf#3899,o_comment_prf#3900] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 83058ms

fq1f=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 23:51:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:51:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3989L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/16 23:51:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:51:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:51:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:51:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3989L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- Project [l_returnflag_prf#3991 AS l_returnflag_prf_0#4010, l_orderkey_and_l_linenumber_prf#3992 AS l_orderkey_and_l_linenumber_prf_0#4011, l_comment_prf#3993 AS l_comment_prf_0#4012, l_linestatus_prf#3994 AS l_linestatus_prf_0#4013, rid#3995 AS rid_0#4014, l_shipmode_prf#3996 AS l_shipmode_prf_0#4015, l_shipinstruct_prf#3997 AS l_shipinstruct_prf_0#4016, l_quantity_prf#3998 AS l_quantity_prf_0#4017, l_receiptdate_prf#3999 AS l_receiptdate_prf_0#4018, l_linenumber_prf#4000 AS l_linenumber_prf_0#4019, l_tax_prf#4001 AS l_tax_prf_0#4020, l_shipdate_prf#4002 AS l_shipdate_prf_0#4021, l_extendedprice_prf#4003 AS l_extendedprice_prf_0#4022, l_partkey_prf#4004 AS l_partkey_prf_0#4023, l_discount_prf#4005 AS l_discount_prf_0#4024, l_partkey_and_l_suppkey_prf#4006 AS l_partkey_and_l_suppkey_prf_0#4025, l_commitdate_prf#4007 AS l_commitdate_prf_0#4026, l_suppkey_prf#4008 AS l_suppkey_prf_0#4027, l_orderkey_prf#4009 AS l_orderkey_prf_0#4028]
         :  :  :  :  :  :  +- Relation[l_returnflag_prf#3991,l_orderkey_and_l_linenumber_prf#3992,l_comment_prf#3993,l_linestatus_prf#3994,rid#3995,l_shipmode_prf#3996,l_shipinstruct_prf#3997,l_quantity_prf#3998,l_receiptdate_prf#3999,l_linenumber_prf#4000,l_tax_prf#4001,l_shipdate_prf#4002,l_extendedprice_prf#4003,l_partkey_prf#4004,l_discount_prf#4005,l_partkey_and_l_suppkey_prf#4006,l_commitdate_prf#4007,l_suppkey_prf#4008,l_orderkey_prf#4009] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#4049]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :  :  :        :- 'Project ['rid AS rid_0#4048]
         :  :  :  :  :        :  +- Relation[l_returnflag_prf#4029,l_orderkey_and_l_linenumber_prf#4030,l_comment_prf#4031,l_linestatus_prf#4032,rid#4033,l_shipmode_prf#4034,l_shipinstruct_prf#4035,l_quantity_prf#4036,l_receiptdate_prf#4037,l_linenumber_prf#4038,l_tax_prf#4039,l_shipdate_prf#4040,l_extendedprice_prf#4041,l_partkey_prf#4042,l_discount_prf#4043,l_partkey_and_l_suppkey_prf#4044,l_commitdate_prf#4045,l_suppkey_prf#4046,l_orderkey_prf#4047] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [o_shippriority_prf#4050 AS o_shippriority_prf_1#4060, rid#4051 AS rid_1#4061, o_orderdate_prf#4052 AS o_orderdate_prf_1#4062, o_custkey_prf#4053 AS o_custkey_prf_1#4063, o_orderpriority_prf#4054 AS o_orderpriority_prf_1#4064, o_clerk_prf#4055 AS o_clerk_prf_1#4065, o_orderstatus_prf#4056 AS o_orderstatus_prf_1#4066, o_totalprice_prf#4057 AS o_totalprice_prf_1#4067, o_orderkey_prf#4058 AS o_orderkey_prf_1#4068, o_comment_prf#4059 AS o_comment_prf_1#4069]
         :  :  :  :     +- Relation[o_shippriority_prf#4050,rid#4051,o_orderdate_prf#4052,o_custkey_prf#4053,o_orderpriority_prf#4054,o_clerk_prf#4055,o_orderstatus_prf#4056,o_totalprice_prf#4057,o_orderkey_prf#4058,o_comment_prf#4059] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#4081]
         :  :  :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :  :  :        :- 'Project ['rid AS rid_1#4080]
         :  :  :        :  +- Relation[o_shippriority_prf#4070,rid#4071,o_orderdate_prf#4072,o_custkey_prf#4073,o_orderpriority_prf#4074,o_clerk_prf#4075,o_orderstatus_prf#4076,o_totalprice_prf#4077,o_orderkey_prf#4078,o_comment_prf#4079] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#4082 AS c_acctbal_prf_2#4091, rid#4083 AS rid_2#4092, c_name_prf#4084 AS c_name_prf_2#4093, c_nationkey_prf#4085 AS c_nationkey_prf_2#4094, c_custkey_prf#4086 AS c_custkey_prf_2#4095, c_comment_prf#4087 AS c_comment_prf_2#4096, c_address_prf#4088 AS c_address_prf_2#4097, c_mktsegment_prf#4089 AS c_mktsegment_prf_2#4098, c_phone_prf#4090 AS c_phone_prf_2#4099]
         :  :     +- Relation[c_acctbal_prf#4082,rid#4083,c_name_prf#4084,c_nationkey_prf#4085,c_custkey_prf#4086,c_comment_prf#4087,c_address_prf#4088,c_mktsegment_prf#4089,c_phone_prf#4090] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2153) AS rid_3#4110]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#4109]
         :        :  +- Relation[c_acctbal_prf#4100,rid#4101,c_name_prf#4102,c_nationkey_prf#4103,c_custkey_prf#4104,c_comment_prf#4105,c_address_prf#4106,c_mktsegment_prf#4107,c_phone_prf#4108] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_3))
            :- Project [rid#4111 AS rid_3#4116, n_regionkey_prf#4112 AS n_regionkey_prf_3#4117, n_nationkey_prf#4113 AS n_nationkey_prf_3#4118, n_name_prf#4114 AS n_name_prf_3#4119, n_comment_prf#4115 AS n_comment_prf_3#4120]
            :  +- Relation[rid#4111,n_regionkey_prf#4112,n_nationkey_prf#4113,n_name_prf#4114,n_comment_prf#4115] JDBCRelation(nation_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#4121]
               +- DexRidFilter nation~n_name~FRANCE
                  +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 169276ms

fr1d=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/16 23:54:21 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:54:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4201L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 23:54:21 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:54:21 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:54:21 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:54:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4201L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#4243]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#4222]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4213: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [c_acctbal_prf#4203 AS c_acctbal_prf_0#4212, rid#4204 AS rid_0#4213, c_name_prf#4205 AS c_name_prf_0#4214, c_nationkey_prf#4206 AS c_nationkey_prf_0#4215, c_custkey_prf#4207 AS c_custkey_prf_0#4216, c_comment_prf#4208 AS c_comment_prf_0#4217, c_address_prf#4209 AS c_address_prf_0#4218, c_mktsegment_prf#4210 AS c_mktsegment_prf_0#4219, c_phone_prf#4211 AS c_phone_prf_0#4220]
         :     :  :     :  :  +- Relation[c_acctbal_prf#4203,rid#4204,c_name_prf#4205,c_nationkey_prf#4206,c_custkey_prf#4207,c_comment_prf#4208,c_address_prf#4209,c_mktsegment_prf#4210,c_phone_prf#4211] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4221]
         :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :        +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#4223 AS o_shippriority_prf_1#4233, rid#4224 AS rid_1#4234, o_orderdate_prf#4225 AS o_orderdate_prf_1#4235, o_custkey_prf#4226 AS o_custkey_prf_1#4236, o_orderpriority_prf#4227 AS o_orderpriority_prf_1#4237, o_clerk_prf#4228 AS o_clerk_prf_1#4238, o_orderstatus_prf#4229 AS o_orderstatus_prf_1#4239, o_totalprice_prf#4230 AS o_totalprice_prf_1#4240, o_orderkey_prf#4231 AS o_orderkey_prf_1#4241, o_comment_prf#4232 AS o_comment_prf_1#4242]
         :     :     +- Relation[o_shippriority_prf#4223,rid#4224,o_orderdate_prf#4225,o_custkey_prf#4226,o_orderpriority_prf#4227,o_clerk_prf#4228,o_orderstatus_prf#4229,o_totalprice_prf#4230,o_orderkey_prf#4231,o_comment_prf#4232] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4244 AS l_returnflag_prf_2#4263, l_orderkey_and_l_linenumber_prf#4245 AS l_orderkey_and_l_linenumber_prf_2#4264, l_comment_prf#4246 AS l_comment_prf_2#4265, l_linestatus_prf#4247 AS l_linestatus_prf_2#4266, rid#4248 AS rid_2#4267, l_shipmode_prf#4249 AS l_shipmode_prf_2#4268, l_shipinstruct_prf#4250 AS l_shipinstruct_prf_2#4269, l_quantity_prf#4251 AS l_quantity_prf_2#4270, l_receiptdate_prf#4252 AS l_receiptdate_prf_2#4271, l_linenumber_prf#4253 AS l_linenumber_prf_2#4272, l_tax_prf#4254 AS l_tax_prf_2#4273, l_shipdate_prf#4255 AS l_shipdate_prf_2#4274, l_extendedprice_prf#4256 AS l_extendedprice_prf_2#4275, l_partkey_prf#4257 AS l_partkey_prf_2#4276, l_discount_prf#4258 AS l_discount_prf_2#4277, l_partkey_and_l_suppkey_prf#4259 AS l_partkey_and_l_suppkey_prf_2#4278, l_commitdate_prf#4260 AS l_commitdate_prf_2#4279, l_suppkey_prf#4261 AS l_suppkey_prf_2#4280, l_orderkey_prf#4262 AS l_orderkey_prf_2#4281]
            +- Relation[l_returnflag_prf#4244,l_orderkey_and_l_linenumber_prf#4245,l_comment_prf#4246,l_linestatus_prf#4247,rid#4248,l_shipmode_prf#4249,l_shipinstruct_prf#4250,l_quantity_prf#4251,l_receiptdate_prf#4252,l_linenumber_prf#4253,l_tax_prf#4254,l_shipdate_prf#4255,l_extendedprice_prf#4256,l_partkey_prf#4257,l_discount_prf#4258,l_partkey_and_l_suppkey_prf#4259,l_commitdate_prf#4260,l_suppkey_prf#4261,l_orderkey_prf#4262] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 32838ms

ft2b=
select * from part, partsupp, supplier where p_size = 15 and p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/16 23:54:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:54:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4344L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 23:54:54 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 23:54:54 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 23:54:54 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 23:54:54 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:54:54 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:54:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4344L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#4382]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#4367]
         :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4358: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [p_comment_prf#4346 AS p_comment_prf_0#4356, p_name_prf#4347 AS p_name_prf_0#4357, rid#4348 AS rid_0#4358, p_type_prf#4349 AS p_type_prf_0#4359, p_retailprice_prf#4350 AS p_retailprice_prf_0#4360, p_mfgr_prf#4351 AS p_mfgr_prf_0#4361, p_container_prf#4352 AS p_container_prf_0#4362, p_brand_prf#4353 AS p_brand_prf_0#4363, p_size_prf#4354 AS p_size_prf_0#4364, p_partkey_prf#4355 AS p_partkey_prf_0#4365]
         :     :  :     :  :  +- Relation[p_comment_prf#4346,p_name_prf#4347,rid#4348,p_type_prf#4349,p_retailprice_prf#4350,p_mfgr_prf#4351,p_container_prf#4352,p_brand_prf#4353,p_size_prf#4354,p_partkey_prf#4355] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4366]
         :     :  :     :     +- DexRidFilter part~p_size~15
         :     :  :     :        +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#4368 AS ps_partkey_and_ps_suppkey_prf_1#4375, rid#4369 AS rid_1#4376, ps_availqty_prf#4370 AS ps_availqty_prf_1#4377, ps_comment_prf#4371 AS ps_comment_prf_1#4378, ps_partkey_prf#4372 AS ps_partkey_prf_1#4379, ps_supplycost_prf#4373 AS ps_supplycost_prf_1#4380, ps_suppkey_prf#4374 AS ps_suppkey_prf_1#4381]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#4368,rid#4369,ps_availqty_prf#4370,ps_comment_prf#4371,ps_partkey_prf#4372,ps_supplycost_prf#4373,ps_suppkey_prf#4374] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4383 AS s_phone_prf_2#4391, rid#4384 AS rid_2#4392, s_address_prf#4385 AS s_address_prf_2#4393, s_nationkey_prf#4386 AS s_nationkey_prf_2#4394, s_suppkey_prf#4387 AS s_suppkey_prf_2#4395, s_name_prf#4388 AS s_name_prf_2#4396, s_acctbal_prf#4389 AS s_acctbal_prf_2#4397, s_comment_prf#4390 AS s_comment_prf_2#4398]
            +- Relation[s_phone_prf#4383,rid#4384,s_address_prf#4385,s_nationkey_prf#4386,s_suppkey_prf#4387,s_name_prf#4388,s_acctbal_prf#4389,s_comment_prf#4390] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 913ms

fs1c=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/16 23:54:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:54:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4469L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_orderkey#306L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 23:54:55 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:54:55 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:54:55 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:54:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4469L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [p_comment_prf#4471 AS p_comment_prf_0#4481, p_name_prf#4472 AS p_name_prf_0#4482, rid#4473 AS rid_0#4483, p_type_prf#4474 AS p_type_prf_0#4484, p_retailprice_prf#4475 AS p_retailprice_prf_0#4485, p_mfgr_prf#4476 AS p_mfgr_prf_0#4486, p_container_prf#4477 AS p_container_prf_0#4487, p_brand_prf#4478 AS p_brand_prf_0#4488, p_size_prf#4479 AS p_size_prf_0#4489, p_partkey_prf#4480 AS p_partkey_prf_0#4490]
         :  :  :  :  +- Relation[p_comment_prf#4471,p_name_prf#4472,rid#4473,p_type_prf#4474,p_retailprice_prf#4475,p_mfgr_prf#4476,p_container_prf#4477,p_brand_prf#4478,p_size_prf#4479,p_partkey_prf#4480] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#4502]
         :  :  :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#4501]
         :  :  :        :  +- Relation[p_comment_prf#4491,p_name_prf#4492,rid#4493,p_type_prf#4494,p_retailprice_prf#4495,p_mfgr_prf#4496,p_container_prf#4497,p_brand_prf#4498,p_size_prf#4499,p_partkey_prf#4500] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#4503 AS l_returnflag_prf_1#4522, l_orderkey_and_l_linenumber_prf#4504 AS l_orderkey_and_l_linenumber_prf_1#4523, l_comment_prf#4505 AS l_comment_prf_1#4524, l_linestatus_prf#4506 AS l_linestatus_prf_1#4525, rid#4507 AS rid_1#4526, l_shipmode_prf#4508 AS l_shipmode_prf_1#4527, l_shipinstruct_prf#4509 AS l_shipinstruct_prf_1#4528, l_quantity_prf#4510 AS l_quantity_prf_1#4529, l_receiptdate_prf#4511 AS l_receiptdate_prf_1#4530, l_linenumber_prf#4512 AS l_linenumber_prf_1#4531, l_tax_prf#4513 AS l_tax_prf_1#4532, l_shipdate_prf#4514 AS l_shipdate_prf_1#4533, l_extendedprice_prf#4515 AS l_extendedprice_prf_1#4534, l_partkey_prf#4516 AS l_partkey_prf_1#4535, l_discount_prf#4517 AS l_discount_prf_1#4536, l_partkey_and_l_suppkey_prf#4518 AS l_partkey_and_l_suppkey_prf_1#4537, l_commitdate_prf#4519 AS l_commitdate_prf_1#4538, l_suppkey_prf#4520 AS l_suppkey_prf_1#4539, l_orderkey_prf#4521 AS l_orderkey_prf_1#4540]
         :  :     +- Relation[l_returnflag_prf#4503,l_orderkey_and_l_linenumber_prf#4504,l_comment_prf#4505,l_linestatus_prf#4506,rid#4507,l_shipmode_prf#4508,l_shipinstruct_prf#4509,l_quantity_prf#4510,l_receiptdate_prf#4511,l_linenumber_prf#4512,l_tax_prf#4513,l_shipdate_prf#4514,l_extendedprice_prf#4515,l_partkey_prf#4516,l_discount_prf#4517,l_partkey_and_l_suppkey_prf#4518,l_commitdate_prf#4519,l_suppkey_prf#4520,l_orderkey_prf#4521] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2153) AS rid_3#4561]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4560]
         :        :  +- Relation[l_returnflag_prf#4541,l_orderkey_and_l_linenumber_prf#4542,l_comment_prf#4543,l_linestatus_prf#4544,rid#4545,l_shipmode_prf#4546,l_shipinstruct_prf#4547,l_quantity_prf#4548,l_receiptdate_prf#4549,l_linenumber_prf#4550,l_tax_prf#4551,l_shipdate_prf#4552,l_extendedprice_prf#4553,l_partkey_prf#4554,l_discount_prf#4555,l_partkey_and_l_suppkey_prf#4556,l_commitdate_prf#4557,l_suppkey_prf#4558,l_orderkey_prf#4559] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_2, 'rid_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2153) AS rid_3#4581]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_2#4572: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [c_acctbal_prf#4562 AS c_acctbal_prf_2#4571, rid#4563 AS rid_2#4572, c_name_prf#4564 AS c_name_prf_2#4573, c_nationkey_prf#4565 AS c_nationkey_prf_2#4574, c_custkey_prf#4566 AS c_custkey_prf_2#4575, c_comment_prf#4567 AS c_comment_prf_2#4576, c_address_prf#4568 AS c_address_prf_2#4577, c_mktsegment_prf#4569 AS c_mktsegment_prf_2#4578, c_phone_prf#4570 AS c_phone_prf_2#4579]
            :     :  :  +- Relation[c_acctbal_prf#4562,rid#4563,c_name_prf#4564,c_nationkey_prf#4565,c_custkey_prf#4566,c_comment_prf#4567,c_address_prf#4568,c_mktsegment_prf#4569,c_phone_prf#4570] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#4580]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4582 AS o_shippriority_prf_3#4592, rid#4583 AS rid_3#4593, o_orderdate_prf#4584 AS o_orderdate_prf_3#4594, o_custkey_prf#4585 AS o_custkey_prf_3#4595, o_orderpriority_prf#4586 AS o_orderpriority_prf_3#4596, o_clerk_prf#4587 AS o_clerk_prf_3#4597, o_orderstatus_prf#4588 AS o_orderstatus_prf_3#4598, o_totalprice_prf#4589 AS o_totalprice_prf_3#4599, o_orderkey_prf#4590 AS o_orderkey_prf_3#4600, o_comment_prf#4591 AS o_comment_prf_3#4601]
               +- Relation[o_shippriority_prf#4582,rid#4583,o_orderdate_prf#4584,o_custkey_prf#4585,o_orderpriority_prf#4586,o_clerk_prf#4587,o_orderstatus_prf#4588,o_totalprice_prf#4589,o_orderkey_prf#4590,o_comment_prf#4591] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 173840ms

ft2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and p_size = 15 and ps_suppkey = s_suppkey
19/10/16 23:57:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:57:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4674L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 23:57:49 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 23:57:49 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 23:57:49 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 23:57:49 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 23:57:49 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:57:49 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:57:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4674L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#4720]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, rid_0#4684: string
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [ps_partkey_and_ps_suppkey_prf#4676 AS ps_partkey_and_ps_suppkey_prf_0#4683, rid#4677 AS rid_0#4684, ps_availqty_prf#4678 AS ps_availqty_prf_0#4685, ps_comment_prf#4679 AS ps_comment_prf_0#4686, ps_partkey_prf#4680 AS ps_partkey_prf_0#4687, ps_supplycost_prf#4681 AS ps_supplycost_prf_0#4688, ps_suppkey_prf#4682 AS ps_suppkey_prf_0#4689]
         :     :  :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#4676,rid#4677,ps_availqty_prf#4678,ps_comment_prf#4679,ps_partkey_prf#4680,ps_supplycost_prf#4681,ps_suppkey_prf#4682] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#4698]
         :     :  :     +- 'DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#4697]
         :     :  :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#4690,rid#4691,ps_availqty_prf#4692,ps_comment_prf#4693,ps_partkey_prf#4694,ps_supplycost_prf#4695,ps_suppkey_prf#4696] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [p_comment_prf#4699 AS p_comment_prf_1#4709, p_name_prf#4700 AS p_name_prf_1#4710, rid#4701 AS rid_1#4711, p_type_prf#4702 AS p_type_prf_1#4712, p_retailprice_prf#4703 AS p_retailprice_prf_1#4713, p_mfgr_prf#4704 AS p_mfgr_prf_1#4714, p_container_prf#4705 AS p_container_prf_1#4715, p_brand_prf#4706 AS p_brand_prf_1#4716, p_size_prf#4707 AS p_size_prf_1#4717, p_partkey_prf#4708 AS p_partkey_prf_1#4718]
         :     :     :  +- Relation[p_comment_prf#4699,p_name_prf#4700,rid#4701,p_type_prf#4702,p_retailprice_prf#4703,p_mfgr_prf#4704,p_container_prf#4705,p_brand_prf#4706,p_size_prf#4707,p_partkey_prf#4708] JDBCRelation(part_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4719]
         :     :        +- DexRidFilter part~p_size~15
         :     :           +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4721 AS s_phone_prf_2#4729, rid#4722 AS rid_2#4730, s_address_prf#4723 AS s_address_prf_2#4731, s_nationkey_prf#4724 AS s_nationkey_prf_2#4732, s_suppkey_prf#4725 AS s_suppkey_prf_2#4733, s_name_prf#4726 AS s_name_prf_2#4734, s_acctbal_prf#4727 AS s_acctbal_prf_2#4735, s_comment_prf#4728 AS s_comment_prf_2#4736]
            +- Relation[s_phone_prf#4721,rid#4722,s_address_prf#4723,s_nationkey_prf#4724,s_suppkey_prf#4725,s_name_prf#4726,s_acctbal_prf#4727,s_comment_prf#4728] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 49132ms

fr2f=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/16 23:58:38 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:58:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4798L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_orderkey#342L, o_custkey#343L]
         :     :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L]
         :        +- Filter isnotnull(c_custkey#290L)
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 23:58:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4798L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#4840]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#4821]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_0#4811: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [o_shippriority_prf#4800 AS o_shippriority_prf_0#4810, rid#4801 AS rid_0#4811, o_orderdate_prf#4802 AS o_orderdate_prf_0#4812, o_custkey_prf#4803 AS o_custkey_prf_0#4813, o_orderpriority_prf#4804 AS o_orderpriority_prf_0#4814, o_clerk_prf#4805 AS o_clerk_prf_0#4815, o_orderstatus_prf#4806 AS o_orderstatus_prf_0#4816, o_totalprice_prf#4807 AS o_totalprice_prf_0#4817, o_orderkey_prf#4808 AS o_orderkey_prf_0#4818, o_comment_prf#4809 AS o_comment_prf_0#4819]
         :     :  :     :  :  +- Relation[o_shippriority_prf#4800,rid#4801,o_orderdate_prf#4802,o_custkey_prf#4803,o_orderpriority_prf#4804,o_clerk_prf#4805,o_orderstatus_prf#4806,o_totalprice_prf#4807,o_orderkey_prf#4808,o_comment_prf#4809] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4820]
         :     :  :     :     +- DexRidFilter orders~o_orderstatus~F
         :     :  :     :        +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#4822 AS c_acctbal_prf_1#4831, rid#4823 AS rid_1#4832, c_name_prf#4824 AS c_name_prf_1#4833, c_nationkey_prf#4825 AS c_nationkey_prf_1#4834, c_custkey_prf#4826 AS c_custkey_prf_1#4835, c_comment_prf#4827 AS c_comment_prf_1#4836, c_address_prf#4828 AS c_address_prf_1#4837, c_mktsegment_prf#4829 AS c_mktsegment_prf_1#4838, c_phone_prf#4830 AS c_phone_prf_1#4839]
         :     :     +- Relation[c_acctbal_prf#4822,rid#4823,c_name_prf#4824,c_nationkey_prf#4825,c_custkey_prf#4826,c_comment_prf#4827,c_address_prf#4828,c_mktsegment_prf#4829,c_phone_prf#4830] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4841 AS l_returnflag_prf_2#4860, l_orderkey_and_l_linenumber_prf#4842 AS l_orderkey_and_l_linenumber_prf_2#4861, l_comment_prf#4843 AS l_comment_prf_2#4862, l_linestatus_prf#4844 AS l_linestatus_prf_2#4863, rid#4845 AS rid_2#4864, l_shipmode_prf#4846 AS l_shipmode_prf_2#4865, l_shipinstruct_prf#4847 AS l_shipinstruct_prf_2#4866, l_quantity_prf#4848 AS l_quantity_prf_2#4867, l_receiptdate_prf#4849 AS l_receiptdate_prf_2#4868, l_linenumber_prf#4850 AS l_linenumber_prf_2#4869, l_tax_prf#4851 AS l_tax_prf_2#4870, l_shipdate_prf#4852 AS l_shipdate_prf_2#4871, l_extendedprice_prf#4853 AS l_extendedprice_prf_2#4872, l_partkey_prf#4854 AS l_partkey_prf_2#4873, l_discount_prf#4855 AS l_discount_prf_2#4874, l_partkey_and_l_suppkey_prf#4856 AS l_partkey_and_l_suppkey_prf_2#4875, l_commitdate_prf#4857 AS l_commitdate_prf_2#4876, l_suppkey_prf#4858 AS l_suppkey_prf_2#4877, l_orderkey_prf#4859 AS l_orderkey_prf_2#4878]
            +- Relation[l_returnflag_prf#4841,l_orderkey_and_l_linenumber_prf#4842,l_comment_prf#4843,l_linestatus_prf#4844,rid#4845,l_shipmode_prf#4846,l_shipinstruct_prf#4847,l_quantity_prf#4848,l_receiptdate_prf#4849,l_linenumber_prf#4850,l_tax_prf#4851,l_shipdate_prf#4852,l_extendedprice_prf#4853,l_partkey_prf#4854,l_discount_prf#4855,l_partkey_and_l_suppkey_prf#4856,l_commitdate_prf#4857,l_suppkey_prf#4858,l_orderkey_prf#4859] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 83139ms

ft1d=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/17 00:00:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:00:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4939L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_nationkey#21L]
                  +- Filter isnotnull(s_nationkey#21L)
                     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 00:00:01 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:00:01 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:00:01 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:00:01 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:00:01 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:00:01 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:00:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4939L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#4941 AS c_acctbal_prf_0#4950, rid#4942 AS rid_0#4951, c_name_prf#4943 AS c_name_prf_0#4952, c_nationkey_prf#4944 AS c_nationkey_prf_0#4953, c_custkey_prf#4945 AS c_custkey_prf_0#4954, c_comment_prf#4946 AS c_comment_prf_0#4955, c_address_prf#4947 AS c_address_prf_0#4956, c_mktsegment_prf#4948 AS c_mktsegment_prf_0#4957, c_phone_prf#4949 AS c_phone_prf_0#4958]
         :  :  +- Relation[c_acctbal_prf#4941,rid#4942,c_name_prf#4943,c_nationkey_prf#4944,c_custkey_prf#4945,c_comment_prf#4946,c_address_prf#4947,c_mktsegment_prf#4948,c_phone_prf#4949] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#4969]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4968]
         :        :  +- Relation[c_acctbal_prf#4959,rid#4960,c_name_prf#4961,c_nationkey_prf#4962,c_custkey_prf#4963,c_comment_prf#4964,c_address_prf#4965,c_mktsegment_prf#4966,c_phone_prf#4967] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#4981]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_1#4975: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [rid#4970 AS rid_1#4975, n_regionkey_prf#4971 AS n_regionkey_prf_1#4976, n_nationkey_prf#4972 AS n_nationkey_prf_1#4977, n_name_prf#4973 AS n_name_prf_1#4978, n_comment_prf#4974 AS n_comment_prf_1#4979]
            :     :  :  +- Relation[rid#4970,n_regionkey_prf#4971,n_nationkey_prf#4972,n_name_prf#4973,n_comment_prf#4974] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4980]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [s_phone_prf#4982 AS s_phone_prf_2#4990, rid#4983 AS rid_2#4991, s_address_prf#4984 AS s_address_prf_2#4992, s_nationkey_prf#4985 AS s_nationkey_prf_2#4993, s_suppkey_prf#4986 AS s_suppkey_prf_2#4994, s_name_prf#4987 AS s_name_prf_2#4995, s_acctbal_prf#4988 AS s_acctbal_prf_2#4996, s_comment_prf#4989 AS s_comment_prf_2#4997]
               +- Relation[s_phone_prf#4982,rid#4983,s_address_prf#4984,s_nationkey_prf#4985,s_suppkey_prf#4986,s_name_prf#4987,s_acctbal_prf#4988,s_comment_prf#4989] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 24271ms

ft1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_name = 'FRANCE' and n_nationkey = c_nationkey
19/10/17 00:00:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:00:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5042L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 00:00:25 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:00:25 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:00:25 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:00:25 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:00:25 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:00:25 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:00:25 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:00:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5042L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#5081]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [s_phone_prf#5044 AS s_phone_prf_0#5052, rid#5045 AS rid_0#5053, s_address_prf#5046 AS s_address_prf_0#5054, s_nationkey_prf#5047 AS s_nationkey_prf_0#5055, s_suppkey_prf#5048 AS s_suppkey_prf_0#5056, s_name_prf#5049 AS s_name_prf_0#5057, s_acctbal_prf#5050 AS s_acctbal_prf_0#5058, s_comment_prf#5051 AS s_comment_prf_0#5059]
         :     :  :  :  +- Relation[s_phone_prf#5044,rid#5045,s_address_prf#5046,s_nationkey_prf#5047,s_suppkey_prf#5048,s_name_prf#5049,s_acctbal_prf#5050,s_comment_prf#5051] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#5069]
         :     :  :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#5068]
         :     :  :        :  +- Relation[s_phone_prf#5060,rid#5061,s_address_prf#5062,s_nationkey_prf#5063,s_suppkey_prf#5064,s_name_prf#5065,s_acctbal_prf#5066,s_comment_prf#5067] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [rid#5070 AS rid_1#5075, n_regionkey_prf#5071 AS n_regionkey_prf_1#5076, n_nationkey_prf#5072 AS n_nationkey_prf_1#5077, n_name_prf#5073 AS n_name_prf_1#5078, n_comment_prf#5074 AS n_comment_prf_1#5079]
         :     :     :  +- Relation[rid#5070,n_regionkey_prf#5071,n_nationkey_prf#5072,n_name_prf#5073,n_comment_prf#5074] JDBCRelation(nation_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5080]
         :     :        +- DexRidFilter nation~n_name~FRANCE
         :     :           +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#5082 AS c_acctbal_prf_2#5091, rid#5083 AS rid_2#5092, c_name_prf#5084 AS c_name_prf_2#5093, c_nationkey_prf#5085 AS c_nationkey_prf_2#5094, c_custkey_prf#5086 AS c_custkey_prf_2#5095, c_comment_prf#5087 AS c_comment_prf_2#5096, c_address_prf#5088 AS c_address_prf_2#5097, c_mktsegment_prf#5089 AS c_mktsegment_prf_2#5098, c_phone_prf#5090 AS c_phone_prf_2#5099]
            +- Relation[c_acctbal_prf#5082,rid#5083,c_name_prf#5084,c_nationkey_prf#5085,c_custkey_prf#5086,c_comment_prf#5087,c_address_prf#5088,c_mktsegment_prf#5089,c_phone_prf#5090] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 48069ms

fr1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey and c_mktsegment = 'BUILDING'
19/10/17 00:01:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:01:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5158L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 00:01:13 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:01:13 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:01:13 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:01:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5158L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [l_returnflag_prf#5160 AS l_returnflag_prf_0#5179, l_orderkey_and_l_linenumber_prf#5161 AS l_orderkey_and_l_linenumber_prf_0#5180, l_comment_prf#5162 AS l_comment_prf_0#5181, l_linestatus_prf#5163 AS l_linestatus_prf_0#5182, rid#5164 AS rid_0#5183, l_shipmode_prf#5165 AS l_shipmode_prf_0#5184, l_shipinstruct_prf#5166 AS l_shipinstruct_prf_0#5185, l_quantity_prf#5167 AS l_quantity_prf_0#5186, l_receiptdate_prf#5168 AS l_receiptdate_prf_0#5187, l_linenumber_prf#5169 AS l_linenumber_prf_0#5188, l_tax_prf#5170 AS l_tax_prf_0#5189, l_shipdate_prf#5171 AS l_shipdate_prf_0#5190, l_extendedprice_prf#5172 AS l_extendedprice_prf_0#5191, l_partkey_prf#5173 AS l_partkey_prf_0#5192, l_discount_prf#5174 AS l_discount_prf_0#5193, l_partkey_and_l_suppkey_prf#5175 AS l_partkey_and_l_suppkey_prf_0#5194, l_commitdate_prf#5176 AS l_commitdate_prf_0#5195, l_suppkey_prf#5177 AS l_suppkey_prf_0#5196, l_orderkey_prf#5178 AS l_orderkey_prf_0#5197]
         :  :  :  :  +- Relation[l_returnflag_prf#5160,l_orderkey_and_l_linenumber_prf#5161,l_comment_prf#5162,l_linestatus_prf#5163,rid#5164,l_shipmode_prf#5165,l_shipinstruct_prf#5166,l_quantity_prf#5167,l_receiptdate_prf#5168,l_linenumber_prf#5169,l_tax_prf#5170,l_shipdate_prf#5171,l_extendedprice_prf#5172,l_partkey_prf#5173,l_discount_prf#5174,l_partkey_and_l_suppkey_prf#5175,l_commitdate_prf#5176,l_suppkey_prf#5177,l_orderkey_prf#5178] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#5218]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#5217]
         :  :  :        :  +- Relation[l_returnflag_prf#5198,l_orderkey_and_l_linenumber_prf#5199,l_comment_prf#5200,l_linestatus_prf#5201,rid#5202,l_shipmode_prf#5203,l_shipinstruct_prf#5204,l_quantity_prf#5205,l_receiptdate_prf#5206,l_linenumber_prf#5207,l_tax_prf#5208,l_shipdate_prf#5209,l_extendedprice_prf#5210,l_partkey_prf#5211,l_discount_prf#5212,l_partkey_and_l_suppkey_prf#5213,l_commitdate_prf#5214,l_suppkey_prf#5215,l_orderkey_prf#5216] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#5219 AS o_shippriority_prf_1#5229, rid#5220 AS rid_1#5230, o_orderdate_prf#5221 AS o_orderdate_prf_1#5231, o_custkey_prf#5222 AS o_custkey_prf_1#5232, o_orderpriority_prf#5223 AS o_orderpriority_prf_1#5233, o_clerk_prf#5224 AS o_clerk_prf_1#5234, o_orderstatus_prf#5225 AS o_orderstatus_prf_1#5235, o_totalprice_prf#5226 AS o_totalprice_prf_1#5236, o_orderkey_prf#5227 AS o_orderkey_prf_1#5237, o_comment_prf#5228 AS o_comment_prf_1#5238]
         :  :     +- Relation[o_shippriority_prf#5219,rid#5220,o_orderdate_prf#5221,o_custkey_prf#5222,o_orderpriority_prf#5223,o_clerk_prf#5224,o_orderstatus_prf#5225,o_totalprice_prf#5226,o_orderkey_prf#5227,o_comment_prf#5228] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#5250]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5249]
         :        :  +- Relation[o_shippriority_prf#5239,rid#5240,o_orderdate_prf#5241,o_custkey_prf#5242,o_orderpriority_prf#5243,o_clerk_prf#5244,o_orderstatus_prf#5245,o_totalprice_prf#5246,o_orderkey_prf#5247,o_comment_prf#5248] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_2))
            :- Project [c_acctbal_prf#5251 AS c_acctbal_prf_2#5260, rid#5252 AS rid_2#5261, c_name_prf#5253 AS c_name_prf_2#5262, c_nationkey_prf#5254 AS c_nationkey_prf_2#5263, c_custkey_prf#5255 AS c_custkey_prf_2#5264, c_comment_prf#5256 AS c_comment_prf_2#5265, c_address_prf#5257 AS c_address_prf_2#5266, c_mktsegment_prf#5258 AS c_mktsegment_prf_2#5267, c_phone_prf#5259 AS c_phone_prf_2#5268]
            :  +- Relation[c_acctbal_prf#5251,rid#5252,c_name_prf#5253,c_nationkey_prf#5254,c_custkey_prf#5255,c_comment_prf#5256,c_address_prf#5257,c_mktsegment_prf#5258,c_phone_prf#5259] JDBCRelation(customer_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#5269]
               +- DexRidFilter customer~c_mktsegment~BUILDING
                  +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 121617ms

fq1c=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 00:03:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:03:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5348L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [c_nationkey#293L, o_orderkey#342L]
               :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :     :- Project [c_custkey#290L, c_nationkey#293L]
               :     :  +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
               :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               :     +- Project [o_orderkey#342L, o_custkey#343L]
               :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 00:03:15 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:03:15 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:03:15 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:03:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5348L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#5361]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#5355: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [rid#5350 AS rid_0#5355, n_regionkey_prf#5351 AS n_regionkey_prf_0#5356, n_nationkey_prf#5352 AS n_nationkey_prf_0#5357, n_name_prf#5353 AS n_name_prf_0#5358, n_comment_prf#5354 AS n_comment_prf_0#5359]
         :     :  :  +- Relation[rid#5350,n_regionkey_prf#5351,n_nationkey_prf#5352,n_name_prf#5353,n_comment_prf#5354] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5360]
         :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :        +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join NaturalJoin(Inner)
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- Project [c_acctbal_prf#5362 AS c_acctbal_prf_1#5371, rid#5363 AS rid_1#5372, c_name_prf#5364 AS c_name_prf_1#5373, c_nationkey_prf#5365 AS c_nationkey_prf_1#5374, c_custkey_prf#5366 AS c_custkey_prf_1#5375, c_comment_prf#5367 AS c_comment_prf_1#5376, c_address_prf#5368 AS c_address_prf_1#5377, c_mktsegment_prf#5369 AS c_mktsegment_prf_1#5378, c_phone_prf#5370 AS c_phone_prf_1#5379]
            :  :  :  :  +- Relation[c_acctbal_prf#5362,rid#5363,c_name_prf#5364,c_nationkey_prf#5365,c_custkey_prf#5366,c_comment_prf#5367,c_address_prf#5368,c_mktsegment_prf#5369,c_phone_prf#5370] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#5390]
            :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
            :  :  :        :- 'Project ['rid AS rid_1#5389]
            :  :  :        :  +- Relation[c_acctbal_prf#5380,rid#5381,c_name_prf#5382,c_nationkey_prf#5383,c_custkey_prf#5384,c_comment_prf#5385,c_address_prf#5386,c_mktsegment_prf#5387,c_phone_prf#5388] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
            :  :  +- Project [o_shippriority_prf#5391 AS o_shippriority_prf_2#5401, rid#5392 AS rid_2#5402, o_orderdate_prf#5393 AS o_orderdate_prf_2#5403, o_custkey_prf#5394 AS o_custkey_prf_2#5404, o_orderpriority_prf#5395 AS o_orderpriority_prf_2#5405, o_clerk_prf#5396 AS o_clerk_prf_2#5406, o_orderstatus_prf#5397 AS o_orderstatus_prf_2#5407, o_totalprice_prf#5398 AS o_totalprice_prf_2#5408, o_orderkey_prf#5399 AS o_orderkey_prf_2#5409, o_comment_prf#5400 AS o_comment_prf_2#5410]
            :  :     +- Relation[o_shippriority_prf#5391,rid#5392,o_orderdate_prf#5393,o_custkey_prf#5394,o_orderpriority_prf#5395,o_clerk_prf#5396,o_orderstatus_prf#5397,o_totalprice_prf#5398,o_orderkey_prf#5399,o_comment_prf#5400] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2153) AS rid_3#5422]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#5421]
            :        :  +- Relation[o_shippriority_prf#5411,rid#5412,o_orderdate_prf#5413,o_custkey_prf#5414,o_orderpriority_prf#5415,o_clerk_prf#5416,o_orderstatus_prf#5417,o_totalprice_prf#5418,o_orderkey_prf#5419,o_comment_prf#5420] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#5423 AS l_returnflag_prf_3#5442, l_orderkey_and_l_linenumber_prf#5424 AS l_orderkey_and_l_linenumber_prf_3#5443, l_comment_prf#5425 AS l_comment_prf_3#5444, l_linestatus_prf#5426 AS l_linestatus_prf_3#5445, rid#5427 AS rid_3#5446, l_shipmode_prf#5428 AS l_shipmode_prf_3#5447, l_shipinstruct_prf#5429 AS l_shipinstruct_prf_3#5448, l_quantity_prf#5430 AS l_quantity_prf_3#5449, l_receiptdate_prf#5431 AS l_receiptdate_prf_3#5450, l_linenumber_prf#5432 AS l_linenumber_prf_3#5451, l_tax_prf#5433 AS l_tax_prf_3#5452, l_shipdate_prf#5434 AS l_shipdate_prf_3#5453, l_extendedprice_prf#5435 AS l_extendedprice_prf_3#5454, l_partkey_prf#5436 AS l_partkey_prf_3#5455, l_discount_prf#5437 AS l_discount_prf_3#5456, l_partkey_and_l_suppkey_prf#5438 AS l_partkey_and_l_suppkey_prf_3#5457, l_commitdate_prf#5439 AS l_commitdate_prf_3#5458, l_suppkey_prf#5440 AS l_suppkey_prf_3#5459, l_orderkey_prf#5441 AS l_orderkey_prf_3#5460]
               +- Relation[l_returnflag_prf#5423,l_orderkey_and_l_linenumber_prf#5424,l_comment_prf#5425,l_linestatus_prf#5426,rid#5427,l_shipmode_prf#5428,l_shipinstruct_prf#5429,l_quantity_prf#5430,l_receiptdate_prf#5431,l_linenumber_prf#5432,l_tax_prf#5433,l_shipdate_prf#5434,l_extendedprice_prf#5435,l_partkey_prf#5436,l_discount_prf#5437,l_partkey_and_l_suppkey_prf#5438,l_commitdate_prf#5439,l_suppkey_prf#5440,l_orderkey_prf#5441] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 164550ms

ft1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/17 00:06:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:06:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5526L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/17 00:06:00 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:06:00 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:06:00 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:06:00 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:06:00 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:06:00 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:06:00 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:06:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5526L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#5528 AS c_acctbal_prf_0#5537, rid#5529 AS rid_0#5538, c_name_prf#5530 AS c_name_prf_0#5539, c_nationkey_prf#5531 AS c_nationkey_prf_0#5540, c_custkey_prf#5532 AS c_custkey_prf_0#5541, c_comment_prf#5533 AS c_comment_prf_0#5542, c_address_prf#5534 AS c_address_prf_0#5543, c_mktsegment_prf#5535 AS c_mktsegment_prf_0#5544, c_phone_prf#5536 AS c_phone_prf_0#5545]
         :  :  +- Relation[c_acctbal_prf#5528,rid#5529,c_name_prf#5530,c_nationkey_prf#5531,c_custkey_prf#5532,c_comment_prf#5533,c_address_prf#5534,c_mktsegment_prf#5535,c_phone_prf#5536] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2153) AS rid_2#5556]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5555]
         :        :  +- Relation[c_acctbal_prf#5546,rid#5547,c_name_prf#5548,c_nationkey_prf#5549,c_custkey_prf#5550,c_comment_prf#5551,c_address_prf#5552,c_mktsegment_prf#5553,c_phone_prf#5554] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [s_phone_prf#5557 AS s_phone_prf_1#5565, rid#5558 AS rid_1#5566, s_address_prf#5559 AS s_address_prf_1#5567, s_nationkey_prf#5560 AS s_nationkey_prf_1#5568, s_suppkey_prf#5561 AS s_suppkey_prf_1#5569, s_name_prf#5562 AS s_name_prf_1#5570, s_acctbal_prf#5563 AS s_acctbal_prf_1#5571, s_comment_prf#5564 AS s_comment_prf_1#5572]
            :  :  +- Relation[s_phone_prf#5557,rid#5558,s_address_prf#5559,s_nationkey_prf#5560,s_suppkey_prf#5561,s_name_prf#5562,s_acctbal_prf#5563,s_comment_prf#5564] JDBCRelation(supplier_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#5582]
            :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#5581]
            :        :  +- Relation[s_phone_prf#5573,rid#5574,s_address_prf#5575,s_nationkey_prf#5576,s_suppkey_prf#5577,s_name_prf#5578,s_acctbal_prf#5579,s_comment_prf#5580] JDBCRelation(supplier_prf) [numPartitions=1]
            :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [rid#5583 AS rid_2#5588, n_regionkey_prf#5584 AS n_regionkey_prf_2#5589, n_nationkey_prf#5585 AS n_nationkey_prf_2#5590, n_name_prf#5586 AS n_name_prf_2#5591, n_comment_prf#5587 AS n_comment_prf_2#5592]
               :  +- Relation[rid#5583,n_regionkey_prf#5584,n_nationkey_prf#5585,n_name_prf#5586,n_comment_prf#5587] JDBCRelation(nation_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#5593]
                  +- DexRidFilter nation~n_name~FRANCE
                     +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 33308ms

fs1a=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/17 00:06:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:06:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5661L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [c_custkey#290L]
         :     :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L]
         :        +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/17 00:06:33 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:06:33 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:06:33 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:06:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5661L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, 'rid_2, 'l_returnflag_prf_2, 'l_orderkey_and_l_linenumber_prf_2, 'l_comment_prf_2, 'l_linestatus_prf_2, ... 15 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#5703]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#5682]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#5673: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [c_acctbal_prf#5663 AS c_acctbal_prf_0#5672, rid#5664 AS rid_0#5673, c_name_prf#5665 AS c_name_prf_0#5674, c_nationkey_prf#5666 AS c_nationkey_prf_0#5675, c_custkey_prf#5667 AS c_custkey_prf_0#5676, c_comment_prf#5668 AS c_comment_prf_0#5677, c_address_prf#5669 AS c_address_prf_0#5678, c_mktsegment_prf#5670 AS c_mktsegment_prf_0#5679, c_phone_prf#5671 AS c_phone_prf_0#5680]
         :     :  :     :  :     :  :  +- Relation[c_acctbal_prf#5663,rid#5664,c_name_prf#5665,c_nationkey_prf#5666,c_custkey_prf#5667,c_comment_prf#5668,c_address_prf#5669,c_mktsegment_prf#5670,c_phone_prf#5671] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5681]
         :     :  :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :  :     :        +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [o_shippriority_prf#5683 AS o_shippriority_prf_1#5693, rid#5684 AS rid_1#5694, o_orderdate_prf#5685 AS o_orderdate_prf_1#5695, o_custkey_prf#5686 AS o_custkey_prf_1#5696, o_orderpriority_prf#5687 AS o_orderpriority_prf_1#5697, o_clerk_prf#5688 AS o_clerk_prf_1#5698, o_orderstatus_prf#5689 AS o_orderstatus_prf_1#5699, o_totalprice_prf#5690 AS o_totalprice_prf_1#5700, o_orderkey_prf#5691 AS o_orderkey_prf_1#5701, o_comment_prf#5692 AS o_comment_prf_1#5702]
         :     :  :     :     +- Relation[o_shippriority_prf#5683,rid#5684,o_orderdate_prf#5685,o_custkey_prf#5686,o_orderpriority_prf#5687,o_clerk_prf#5688,o_orderstatus_prf#5689,o_totalprice_prf#5690,o_orderkey_prf#5691,o_comment_prf#5692] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#5704 AS l_returnflag_prf_2#5723, l_orderkey_and_l_linenumber_prf#5705 AS l_orderkey_and_l_linenumber_prf_2#5724, l_comment_prf#5706 AS l_comment_prf_2#5725, l_linestatus_prf#5707 AS l_linestatus_prf_2#5726, rid#5708 AS rid_2#5727, l_shipmode_prf#5709 AS l_shipmode_prf_2#5728, l_shipinstruct_prf#5710 AS l_shipinstruct_prf_2#5729, l_quantity_prf#5711 AS l_quantity_prf_2#5730, l_receiptdate_prf#5712 AS l_receiptdate_prf_2#5731, l_linenumber_prf#5713 AS l_linenumber_prf_2#5732, l_tax_prf#5714 AS l_tax_prf_2#5733, l_shipdate_prf#5715 AS l_shipdate_prf_2#5734, l_extendedprice_prf#5716 AS l_extendedprice_prf_2#5735, l_partkey_prf#5717 AS l_partkey_prf_2#5736, l_discount_prf#5718 AS l_discount_prf_2#5737, l_partkey_and_l_suppkey_prf#5719 AS l_partkey_and_l_suppkey_prf_2#5738, l_commitdate_prf#5720 AS l_commitdate_prf_2#5739, l_suppkey_prf#5721 AS l_suppkey_prf_2#5740, l_orderkey_prf#5722 AS l_orderkey_prf_2#5741]
         :     :     +- Relation[l_returnflag_prf#5704,l_orderkey_and_l_linenumber_prf#5705,l_comment_prf#5706,l_linestatus_prf#5707,rid#5708,l_shipmode_prf#5709,l_shipinstruct_prf#5710,l_quantity_prf#5711,l_receiptdate_prf#5712,l_linenumber_prf#5713,l_tax_prf#5714,l_shipdate_prf#5715,l_extendedprice_prf#5716,l_partkey_prf#5717,l_discount_prf#5718,l_partkey_and_l_suppkey_prf#5719,l_commitdate_prf#5720,l_suppkey_prf#5721,l_orderkey_prf#5722] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#5743 AS p_comment_prf_3#5753, p_name_prf#5744 AS p_name_prf_3#5754, rid#5745 AS rid_3#5755, p_type_prf#5746 AS p_type_prf_3#5756, p_retailprice_prf#5747 AS p_retailprice_prf_3#5757, p_mfgr_prf#5748 AS p_mfgr_prf_3#5758, p_container_prf#5749 AS p_container_prf_3#5759, p_brand_prf#5750 AS p_brand_prf_3#5760, p_size_prf#5751 AS p_size_prf_3#5761, p_partkey_prf#5752 AS p_partkey_prf_3#5762]
            +- Relation[p_comment_prf#5743,p_name_prf#5744,rid#5745,p_type_prf#5746,p_retailprice_prf#5747,p_mfgr_prf#5748,p_container_prf#5749,p_brand_prf#5750,p_size_prf#5751,p_partkey_prf#5752] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 108832ms

fq1d=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 00:08:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:08:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5851L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :     :- Project [n_nationkey#108L]
               :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
               :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 00:08:22 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:08:22 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:08:22 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:08:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5851L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#5853 AS l_returnflag_prf_0#5872, l_orderkey_and_l_linenumber_prf#5854 AS l_orderkey_and_l_linenumber_prf_0#5873, l_comment_prf#5855 AS l_comment_prf_0#5874, l_linestatus_prf#5856 AS l_linestatus_prf_0#5875, rid#5857 AS rid_0#5876, l_shipmode_prf#5858 AS l_shipmode_prf_0#5877, l_shipinstruct_prf#5859 AS l_shipinstruct_prf_0#5878, l_quantity_prf#5860 AS l_quantity_prf_0#5879, l_receiptdate_prf#5861 AS l_receiptdate_prf_0#5880, l_linenumber_prf#5862 AS l_linenumber_prf_0#5881, l_tax_prf#5863 AS l_tax_prf_0#5882, l_shipdate_prf#5864 AS l_shipdate_prf_0#5883, l_extendedprice_prf#5865 AS l_extendedprice_prf_0#5884, l_partkey_prf#5866 AS l_partkey_prf_0#5885, l_discount_prf#5867 AS l_discount_prf_0#5886, l_partkey_and_l_suppkey_prf#5868 AS l_partkey_and_l_suppkey_prf_0#5887, l_commitdate_prf#5869 AS l_commitdate_prf_0#5888, l_suppkey_prf#5870 AS l_suppkey_prf_0#5889, l_orderkey_prf#5871 AS l_orderkey_prf_0#5890]
         :  :  +- Relation[l_returnflag_prf#5853,l_orderkey_and_l_linenumber_prf#5854,l_comment_prf#5855,l_linestatus_prf#5856,rid#5857,l_shipmode_prf#5858,l_shipinstruct_prf#5859,l_quantity_prf#5860,l_receiptdate_prf#5861,l_linenumber_prf#5862,l_tax_prf#5863,l_shipdate_prf#5864,l_extendedprice_prf#5865,l_partkey_prf#5866,l_discount_prf#5867,l_partkey_and_l_suppkey_prf#5868,l_commitdate_prf#5869,l_suppkey_prf#5870,l_orderkey_prf#5871] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2153) AS rid_3#5911]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5910]
         :        :  +- Relation[l_returnflag_prf#5891,l_orderkey_and_l_linenumber_prf#5892,l_comment_prf#5893,l_linestatus_prf#5894,rid#5895,l_shipmode_prf#5896,l_shipinstruct_prf#5897,l_quantity_prf#5898,l_receiptdate_prf#5899,l_linenumber_prf#5900,l_tax_prf#5901,l_shipdate_prf#5902,l_extendedprice_prf#5903,l_partkey_prf#5904,l_discount_prf#5905,l_partkey_and_l_suppkey_prf#5906,l_commitdate_prf#5907,l_suppkey_prf#5908,l_orderkey_prf#5909] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, 'rid_2, 'c_acctbal_prf_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2153) AS rid_3#5942]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_2
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#5923]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_1#5917: string
            :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :     :  :- Project [rid#5912 AS rid_1#5917, n_regionkey_prf#5913 AS n_regionkey_prf_1#5918, n_nationkey_prf#5914 AS n_nationkey_prf_1#5919, n_name_prf#5915 AS n_name_prf_1#5920, n_comment_prf#5916 AS n_comment_prf_1#5921]
            :     :  :     :  :  +- Relation[rid#5912,n_regionkey_prf#5913,n_nationkey_prf#5914,n_name_prf#5915,n_comment_prf#5916] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5922]
            :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :  :     :        +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [c_acctbal_prf#5924 AS c_acctbal_prf_2#5933, rid#5925 AS rid_2#5934, c_name_prf#5926 AS c_name_prf_2#5935, c_nationkey_prf#5927 AS c_nationkey_prf_2#5936, c_custkey_prf#5928 AS c_custkey_prf_2#5937, c_comment_prf#5929 AS c_comment_prf_2#5938, c_address_prf#5930 AS c_address_prf_2#5939, c_mktsegment_prf#5931 AS c_mktsegment_prf_2#5940, c_phone_prf#5932 AS c_phone_prf_2#5941]
            :     :     +- Relation[c_acctbal_prf#5924,rid#5925,c_name_prf#5926,c_nationkey_prf#5927,c_custkey_prf#5928,c_comment_prf#5929,c_address_prf#5930,c_mktsegment_prf#5931,c_phone_prf#5932] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#5943 AS o_shippriority_prf_3#5953, rid#5944 AS rid_3#5954, o_orderdate_prf#5945 AS o_orderdate_prf_3#5955, o_custkey_prf#5946 AS o_custkey_prf_3#5956, o_orderpriority_prf#5947 AS o_orderpriority_prf_3#5957, o_clerk_prf#5948 AS o_clerk_prf_3#5958, o_orderstatus_prf#5949 AS o_orderstatus_prf_3#5959, o_totalprice_prf#5950 AS o_totalprice_prf_3#5960, o_orderkey_prf#5951 AS o_orderkey_prf_3#5961, o_comment_prf#5952 AS o_comment_prf_3#5962]
               +- Relation[o_shippriority_prf#5943,rid#5944,o_orderdate_prf#5945,o_custkey_prf#5946,o_orderpriority_prf#5947,o_clerk_prf#5948,o_orderstatus_prf#5949,o_totalprice_prf#5950,o_orderkey_prf#5951,o_comment_prf#5952] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 74544ms

fq1b=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 00:09:36 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:09:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6046L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 00:09:36 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:09:36 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:09:36 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:09:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6046L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#6078]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#6059]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#6053: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#6048 AS rid_0#6053, n_regionkey_prf#6049 AS n_regionkey_prf_0#6054, n_nationkey_prf#6050 AS n_nationkey_prf_0#6055, n_name_prf#6051 AS n_name_prf_0#6056, n_comment_prf#6052 AS n_comment_prf_0#6057]
         :     :  :     :  :  +- Relation[rid#6048,n_regionkey_prf#6049,n_nationkey_prf#6050,n_name_prf#6051,n_comment_prf#6052] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#6058]
         :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :        +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#6060 AS c_acctbal_prf_1#6069, rid#6061 AS rid_1#6070, c_name_prf#6062 AS c_name_prf_1#6071, c_nationkey_prf#6063 AS c_nationkey_prf_1#6072, c_custkey_prf#6064 AS c_custkey_prf_1#6073, c_comment_prf#6065 AS c_comment_prf_1#6074, c_address_prf#6066 AS c_address_prf_1#6075, c_mktsegment_prf#6067 AS c_mktsegment_prf_1#6076, c_phone_prf#6068 AS c_phone_prf_1#6077]
         :     :     +- Relation[c_acctbal_prf#6060,rid#6061,c_name_prf#6062,c_nationkey_prf#6063,c_custkey_prf#6064,c_comment_prf#6065,c_address_prf#6066,c_mktsegment_prf#6067,c_phone_prf#6068] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- Project [o_shippriority_prf#6079 AS o_shippriority_prf_2#6089, rid#6080 AS rid_2#6090, o_orderdate_prf#6081 AS o_orderdate_prf_2#6091, o_custkey_prf#6082 AS o_custkey_prf_2#6092, o_orderpriority_prf#6083 AS o_orderpriority_prf_2#6093, o_clerk_prf#6084 AS o_clerk_prf_2#6094, o_orderstatus_prf#6085 AS o_orderstatus_prf_2#6095, o_totalprice_prf#6086 AS o_totalprice_prf_2#6096, o_orderkey_prf#6087 AS o_orderkey_prf_2#6097, o_comment_prf#6088 AS o_comment_prf_2#6098]
            :  :  +- Relation[o_shippriority_prf#6079,rid#6080,o_orderdate_prf#6081,o_custkey_prf#6082,o_orderpriority_prf#6083,o_clerk_prf#6084,o_orderstatus_prf#6085,o_totalprice_prf#6086,o_orderkey_prf#6087,o_comment_prf#6088] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2153) AS rid_3#6110]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#6109]
            :        :  +- Relation[o_shippriority_prf#6099,rid#6100,o_orderdate_prf#6101,o_custkey_prf#6102,o_orderpriority_prf#6103,o_clerk_prf#6104,o_orderstatus_prf#6105,o_totalprice_prf#6106,o_orderkey_prf#6107,o_comment_prf#6108] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#6111 AS l_returnflag_prf_3#6130, l_orderkey_and_l_linenumber_prf#6112 AS l_orderkey_and_l_linenumber_prf_3#6131, l_comment_prf#6113 AS l_comment_prf_3#6132, l_linestatus_prf#6114 AS l_linestatus_prf_3#6133, rid#6115 AS rid_3#6134, l_shipmode_prf#6116 AS l_shipmode_prf_3#6135, l_shipinstruct_prf#6117 AS l_shipinstruct_prf_3#6136, l_quantity_prf#6118 AS l_quantity_prf_3#6137, l_receiptdate_prf#6119 AS l_receiptdate_prf_3#6138, l_linenumber_prf#6120 AS l_linenumber_prf_3#6139, l_tax_prf#6121 AS l_tax_prf_3#6140, l_shipdate_prf#6122 AS l_shipdate_prf_3#6141, l_extendedprice_prf#6123 AS l_extendedprice_prf_3#6142, l_partkey_prf#6124 AS l_partkey_prf_3#6143, l_discount_prf#6125 AS l_discount_prf_3#6144, l_partkey_and_l_suppkey_prf#6126 AS l_partkey_and_l_suppkey_prf_3#6145, l_commitdate_prf#6127 AS l_commitdate_prf_3#6146, l_suppkey_prf#6128 AS l_suppkey_prf_3#6147, l_orderkey_prf#6129 AS l_orderkey_prf_3#6148]
               +- Relation[l_returnflag_prf#6111,l_orderkey_and_l_linenumber_prf#6112,l_comment_prf#6113,l_linestatus_prf#6114,rid#6115,l_shipmode_prf#6116,l_shipinstruct_prf#6117,l_quantity_prf#6118,l_receiptdate_prf#6119,l_linenumber_prf#6120,l_tax_prf#6121,l_shipdate_prf#6122,l_extendedprice_prf#6123,l_partkey_prf#6124,l_discount_prf#6125,l_partkey_and_l_suppkey_prf#6126,l_commitdate_prf#6127,l_suppkey_prf#6128,l_orderkey_prf#6129] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 140555ms

ft2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and (p_size = 15 and s_suppkey = ps_suppkey)
19/10/17 00:11:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:11:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6216L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/17 00:11:57 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:11:57 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:11:57 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 00:11:57 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:11:57 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 00:11:57 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 00:11:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6216L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#6218 AS s_phone_prf_0#6226, rid#6219 AS rid_0#6227, s_address_prf#6220 AS s_address_prf_0#6228, s_nationkey_prf#6221 AS s_nationkey_prf_0#6229, s_suppkey_prf#6222 AS s_suppkey_prf_0#6230, s_name_prf#6223 AS s_name_prf_0#6231, s_acctbal_prf#6224 AS s_acctbal_prf_0#6232, s_comment_prf#6225 AS s_comment_prf_0#6233]
         :  :  +- Relation[s_phone_prf#6218,rid#6219,s_address_prf#6220,s_nationkey_prf#6221,s_suppkey_prf#6222,s_name_prf#6223,s_acctbal_prf#6224,s_comment_prf#6225] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2153) AS rid_2#6243]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#6242]
         :        :  +- Relation[s_phone_prf#6234,rid#6235,s_address_prf#6236,s_nationkey_prf#6237,s_suppkey_prf#6238,s_name_prf#6239,s_acctbal_prf#6240,s_comment_prf#6241] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#6265]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#6256: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#6244 AS p_comment_prf_1#6254, p_name_prf#6245 AS p_name_prf_1#6255, rid#6246 AS rid_1#6256, p_type_prf#6247 AS p_type_prf_1#6257, p_retailprice_prf#6248 AS p_retailprice_prf_1#6258, p_mfgr_prf#6249 AS p_mfgr_prf_1#6259, p_container_prf#6250 AS p_container_prf_1#6260, p_brand_prf#6251 AS p_brand_prf_1#6261, p_size_prf#6252 AS p_size_prf_1#6262, p_partkey_prf#6253 AS p_partkey_prf_1#6263]
            :     :  :  +- Relation[p_comment_prf#6244,p_name_prf#6245,rid#6246,p_type_prf#6247,p_retailprice_prf#6248,p_mfgr_prf#6249,p_container_prf#6250,p_brand_prf#6251,p_size_prf#6252,p_partkey_prf#6253] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6264]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#6266 AS ps_partkey_and_ps_suppkey_prf_2#6273, rid#6267 AS rid_2#6274, ps_availqty_prf#6268 AS ps_availqty_prf_2#6275, ps_comment_prf#6269 AS ps_comment_prf_2#6276, ps_partkey_prf#6270 AS ps_partkey_prf_2#6277, ps_supplycost_prf#6271 AS ps_supplycost_prf_2#6278, ps_suppkey_prf#6272 AS ps_suppkey_prf_2#6279]
               +- Relation[ps_partkey_and_ps_suppkey_prf#6266,rid#6267,ps_availqty_prf#6268,ps_comment_prf#6269,ps_partkey_prf#6270,ps_supplycost_prf#6271,ps_suppkey_prf#6272] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 7000ms

fr1e=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and (o_orderkey = l_orderkey and c_custkey = o_custkey)
19/10/17 00:12:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:12:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6341L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 00:12:04 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:12:04 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:12:04 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:12:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6341L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#6362]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#6353: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [c_acctbal_prf#6343 AS c_acctbal_prf_0#6352, rid#6344 AS rid_0#6353, c_name_prf#6345 AS c_name_prf_0#6354, c_nationkey_prf#6346 AS c_nationkey_prf_0#6355, c_custkey_prf#6347 AS c_custkey_prf_0#6356, c_comment_prf#6348 AS c_comment_prf_0#6357, c_address_prf#6349 AS c_address_prf_0#6358, c_mktsegment_prf#6350 AS c_mktsegment_prf_0#6359, c_phone_prf#6351 AS c_phone_prf_0#6360]
         :     :  :  +- Relation[c_acctbal_prf#6343,rid#6344,c_name_prf#6345,c_nationkey_prf#6346,c_custkey_prf#6347,c_comment_prf#6348,c_address_prf#6349,c_mktsegment_prf#6350,c_phone_prf#6351] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#6361]
         :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :        +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [o_shippriority_prf#6363 AS o_shippriority_prf_1#6373, rid#6364 AS rid_1#6374, o_orderdate_prf#6365 AS o_orderdate_prf_1#6375, o_custkey_prf#6366 AS o_custkey_prf_1#6376, o_orderpriority_prf#6367 AS o_orderpriority_prf_1#6377, o_clerk_prf#6368 AS o_clerk_prf_1#6378, o_orderstatus_prf#6369 AS o_orderstatus_prf_1#6379, o_totalprice_prf#6370 AS o_totalprice_prf_1#6380, o_orderkey_prf#6371 AS o_orderkey_prf_1#6381, o_comment_prf#6372 AS o_comment_prf_1#6382]
            :  :  +- Relation[o_shippriority_prf#6363,rid#6364,o_orderdate_prf#6365,o_custkey_prf#6366,o_orderpriority_prf#6367,o_clerk_prf#6368,o_orderstatus_prf#6369,o_totalprice_prf#6370,o_orderkey_prf#6371,o_comment_prf#6372] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#6394]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#6393]
            :        :  +- Relation[o_shippriority_prf#6383,rid#6384,o_orderdate_prf#6385,o_custkey_prf#6386,o_orderpriority_prf#6387,o_clerk_prf#6388,o_orderstatus_prf#6389,o_totalprice_prf#6390,o_orderkey_prf#6391,o_comment_prf#6392] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#6395 AS l_returnflag_prf_2#6414, l_orderkey_and_l_linenumber_prf#6396 AS l_orderkey_and_l_linenumber_prf_2#6415, l_comment_prf#6397 AS l_comment_prf_2#6416, l_linestatus_prf#6398 AS l_linestatus_prf_2#6417, rid#6399 AS rid_2#6418, l_shipmode_prf#6400 AS l_shipmode_prf_2#6419, l_shipinstruct_prf#6401 AS l_shipinstruct_prf_2#6420, l_quantity_prf#6402 AS l_quantity_prf_2#6421, l_receiptdate_prf#6403 AS l_receiptdate_prf_2#6422, l_linenumber_prf#6404 AS l_linenumber_prf_2#6423, l_tax_prf#6405 AS l_tax_prf_2#6424, l_shipdate_prf#6406 AS l_shipdate_prf_2#6425, l_extendedprice_prf#6407 AS l_extendedprice_prf_2#6426, l_partkey_prf#6408 AS l_partkey_prf_2#6427, l_discount_prf#6409 AS l_discount_prf_2#6428, l_partkey_and_l_suppkey_prf#6410 AS l_partkey_and_l_suppkey_prf_2#6429, l_commitdate_prf#6411 AS l_commitdate_prf_2#6430, l_suppkey_prf#6412 AS l_suppkey_prf_2#6431, l_orderkey_prf#6413 AS l_orderkey_prf_2#6432]
               +- Relation[l_returnflag_prf#6395,l_orderkey_and_l_linenumber_prf#6396,l_comment_prf#6397,l_linestatus_prf#6398,rid#6399,l_shipmode_prf#6400,l_shipinstruct_prf#6401,l_quantity_prf#6402,l_receiptdate_prf#6403,l_linenumber_prf#6404,l_tax_prf#6405,l_shipdate_prf#6406,l_extendedprice_prf#6407,l_partkey_prf#6408,l_discount_prf#6409,l_partkey_and_l_suppkey_prf#6410,l_commitdate_prf#6411,l_suppkey_prf#6412,l_orderkey_prf#6413] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 153323ms

fr2a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_orderstatus = 'F' and o_custkey = c_custkey
19/10/17 00:14:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:14:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6507L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 00:14:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6507L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [l_returnflag_prf#6509 AS l_returnflag_prf_0#6528, l_orderkey_and_l_linenumber_prf#6510 AS l_orderkey_and_l_linenumber_prf_0#6529, l_comment_prf#6511 AS l_comment_prf_0#6530, l_linestatus_prf#6512 AS l_linestatus_prf_0#6531, rid#6513 AS rid_0#6532, l_shipmode_prf#6514 AS l_shipmode_prf_0#6533, l_shipinstruct_prf#6515 AS l_shipinstruct_prf_0#6534, l_quantity_prf#6516 AS l_quantity_prf_0#6535, l_receiptdate_prf#6517 AS l_receiptdate_prf_0#6536, l_linenumber_prf#6518 AS l_linenumber_prf_0#6537, l_tax_prf#6519 AS l_tax_prf_0#6538, l_shipdate_prf#6520 AS l_shipdate_prf_0#6539, l_extendedprice_prf#6521 AS l_extendedprice_prf_0#6540, l_partkey_prf#6522 AS l_partkey_prf_0#6541, l_discount_prf#6523 AS l_discount_prf_0#6542, l_partkey_and_l_suppkey_prf#6524 AS l_partkey_and_l_suppkey_prf_0#6543, l_commitdate_prf#6525 AS l_commitdate_prf_0#6544, l_suppkey_prf#6526 AS l_suppkey_prf_0#6545, l_orderkey_prf#6527 AS l_orderkey_prf_0#6546]
         :     :  :  :  +- Relation[l_returnflag_prf#6509,l_orderkey_and_l_linenumber_prf#6510,l_comment_prf#6511,l_linestatus_prf#6512,rid#6513,l_shipmode_prf#6514,l_shipinstruct_prf#6515,l_quantity_prf#6516,l_receiptdate_prf#6517,l_linenumber_prf#6518,l_tax_prf#6519,l_shipdate_prf#6520,l_extendedprice_prf#6521,l_partkey_prf#6522,l_discount_prf#6523,l_partkey_and_l_suppkey_prf#6524,l_commitdate_prf#6525,l_suppkey_prf#6526,l_orderkey_prf#6527] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2153) AS rid_1#6567]
         :     :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#6566]
         :     :  :        :  +- Relation[l_returnflag_prf#6547,l_orderkey_and_l_linenumber_prf#6548,l_comment_prf#6549,l_linestatus_prf#6550,rid#6551,l_shipmode_prf#6552,l_shipinstruct_prf#6553,l_quantity_prf#6554,l_receiptdate_prf#6555,l_linenumber_prf#6556,l_tax_prf#6557,l_shipdate_prf#6558,l_extendedprice_prf#6559,l_partkey_prf#6560,l_discount_prf#6561,l_partkey_and_l_suppkey_prf#6562,l_commitdate_prf#6563,l_suppkey_prf#6564,l_orderkey_prf#6565] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [o_shippriority_prf#6568 AS o_shippriority_prf_1#6578, rid#6569 AS rid_1#6579, o_orderdate_prf#6570 AS o_orderdate_prf_1#6580, o_custkey_prf#6571 AS o_custkey_prf_1#6581, o_orderpriority_prf#6572 AS o_orderpriority_prf_1#6582, o_clerk_prf#6573 AS o_clerk_prf_1#6583, o_orderstatus_prf#6574 AS o_orderstatus_prf_1#6584, o_totalprice_prf#6575 AS o_totalprice_prf_1#6585, o_orderkey_prf#6576 AS o_orderkey_prf_1#6586, o_comment_prf#6577 AS o_comment_prf_1#6587]
         :     :     :  +- Relation[o_shippriority_prf#6568,rid#6569,o_orderdate_prf#6570,o_custkey_prf#6571,o_orderpriority_prf#6572,o_clerk_prf#6573,o_orderstatus_prf#6574,o_totalprice_prf#6575,o_orderkey_prf#6576,o_comment_prf#6577] JDBCRelation(orders_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6588]
         :     :        +- DexRidFilter orders~o_orderstatus~F
         :     :           +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#6590 AS c_acctbal_prf_2#6599, rid#6591 AS rid_2#6600, c_name_prf#6592 AS c_name_prf_2#6601, c_nationkey_prf#6593 AS c_nationkey_prf_2#6602, c_custkey_prf#6594 AS c_custkey_prf_2#6603, c_comment_prf#6595 AS c_comment_prf_2#6604, c_address_prf#6596 AS c_address_prf_2#6605, c_mktsegment_prf#6597 AS c_mktsegment_prf_2#6606, c_phone_prf#6598 AS c_phone_prf_2#6607]
            +- Relation[c_acctbal_prf#6590,rid#6591,c_name_prf#6592,c_nationkey_prf#6593,c_custkey_prf#6594,c_comment_prf#6595,c_address_prf#6596,c_mktsegment_prf#6597,c_phone_prf#6598] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 194027ms

ft3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and (p_size = 15 and s_suppkey = l_suppkey)
19/10/17 00:17:51 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:17:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6681L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 00:17:51 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:17:51 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:17:51 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:17:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6681L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#6683 AS s_phone_prf_0#6691, rid#6684 AS rid_0#6692, s_address_prf#6685 AS s_address_prf_0#6693, s_nationkey_prf#6686 AS s_nationkey_prf_0#6694, s_suppkey_prf#6687 AS s_suppkey_prf_0#6695, s_name_prf#6688 AS s_name_prf_0#6696, s_acctbal_prf#6689 AS s_acctbal_prf_0#6697, s_comment_prf#6690 AS s_comment_prf_0#6698]
         :  :  +- Relation[s_phone_prf#6683,rid#6684,s_address_prf#6685,s_nationkey_prf#6686,s_suppkey_prf#6687,s_name_prf#6688,s_acctbal_prf#6689,s_comment_prf#6690] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2153) AS rid_2#6708]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#6707]
         :        :  +- Relation[s_phone_prf#6699,rid#6700,s_address_prf#6701,s_nationkey_prf#6702,s_suppkey_prf#6703,s_name_prf#6704,s_acctbal_prf#6705,s_comment_prf#6706] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2153) AS rid_2#6730]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#6721: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#6709 AS p_comment_prf_1#6719, p_name_prf#6710 AS p_name_prf_1#6720, rid#6711 AS rid_1#6721, p_type_prf#6712 AS p_type_prf_1#6722, p_retailprice_prf#6713 AS p_retailprice_prf_1#6723, p_mfgr_prf#6714 AS p_mfgr_prf_1#6724, p_container_prf#6715 AS p_container_prf_1#6725, p_brand_prf#6716 AS p_brand_prf_1#6726, p_size_prf#6717 AS p_size_prf_1#6727, p_partkey_prf#6718 AS p_partkey_prf_1#6728]
            :     :  :  +- Relation[p_comment_prf#6709,p_name_prf#6710,rid#6711,p_type_prf#6712,p_retailprice_prf#6713,p_mfgr_prf#6714,p_container_prf#6715,p_brand_prf#6716,p_size_prf#6717,p_partkey_prf#6718] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6729]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2175,value#2176] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2152,value#2153] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#6731 AS l_returnflag_prf_2#6750, l_orderkey_and_l_linenumber_prf#6732 AS l_orderkey_and_l_linenumber_prf_2#6751, l_comment_prf#6733 AS l_comment_prf_2#6752, l_linestatus_prf#6734 AS l_linestatus_prf_2#6753, rid#6735 AS rid_2#6754, l_shipmode_prf#6736 AS l_shipmode_prf_2#6755, l_shipinstruct_prf#6737 AS l_shipinstruct_prf_2#6756, l_quantity_prf#6738 AS l_quantity_prf_2#6757, l_receiptdate_prf#6739 AS l_receiptdate_prf_2#6758, l_linenumber_prf#6740 AS l_linenumber_prf_2#6759, l_tax_prf#6741 AS l_tax_prf_2#6760, l_shipdate_prf#6742 AS l_shipdate_prf_2#6761, l_extendedprice_prf#6743 AS l_extendedprice_prf_2#6762, l_partkey_prf#6744 AS l_partkey_prf_2#6763, l_discount_prf#6745 AS l_discount_prf_2#6764, l_partkey_and_l_suppkey_prf#6746 AS l_partkey_and_l_suppkey_prf_2#6765, l_commitdate_prf#6747 AS l_commitdate_prf_2#6766, l_suppkey_prf#6748 AS l_suppkey_prf_2#6767, l_orderkey_prf#6749 AS l_orderkey_prf_2#6768]
               +- Relation[l_returnflag_prf#6731,l_orderkey_and_l_linenumber_prf#6732,l_comment_prf#6733,l_linestatus_prf#6734,rid#6735,l_shipmode_prf#6736,l_shipinstruct_prf#6737,l_quantity_prf#6738,l_receiptdate_prf#6739,l_linenumber_prf#6740,l_tax_prf#6741,l_shipdate_prf#6742,l_extendedprice_prf#6743,l_partkey_prf#6744,l_discount_prf#6745,l_partkey_and_l_suppkey_prf#6746,l_commitdate_prf#6747,l_suppkey_prf#6748,l_orderkey_prf#6749] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 55430ms
query=fq1a, count=246415, duration=31190
query=fq1b, count=246415, duration=140555
query=fq1c, count=246415, duration=164550
query=fq1d, count=246415, duration=74544
query=fq1e, count=246415, duration=166430
query=fq1f, count=246415, duration=169276
query=fr1a, count=1214743, duration=121617
query=fr1b, count=1214743, duration=121539
query=fr1c, count=1214743, duration=83058
query=fr1d, count=1214743, duration=32838
query=fr1e, count=1214743, duration=153323
query=fr2a, count=2901744, duration=194027
query=fr2b, count=2901744, duration=106301
query=fr2d, count=2901744, duration=107987
query=fr2e, count=2901744, duration=96132
query=fr2f, count=2901744, duration=83139
query=fs1a, count=1214743, duration=108832
query=fs1b, count=1214743, duration=173467
query=fs1c, count=1214743, duration=173840
query=ft1a, count=2452200, duration=48069
query=ft1b, count=2452200, duration=30060
query=ft1c, count=2452200, duration=33308
query=ft1d, count=2452200, duration=24271
query=ft2a, count=15628, duration=49132
query=ft2b, count=15628, duration=913
query=ft2c, count=15628, duration=7000
query=ft3a, count=117754, duration=97180
query=ft3b, count=117754, duration=6155
query=ft3c, count=117754, duration=55430
