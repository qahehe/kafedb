19/10/15 03:14:08 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7109ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Tue Oct 15 03:14:10 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Tue Oct 15 03:14:11 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Tue Oct 15 03:14:11 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Tue Oct 15 03:14:11 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Tue Oct 15 03:14:11 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Tue Oct 15 03:14:14 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Tue Oct 15 03:14:16 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Tue Oct 15 03:14:16 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/15 03:14:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:14:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1490L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/15 03:14:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1490L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#1504]
         :  :  :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#1497: string
         :  :  :     :- Project [rid#1492 AS rid_0#1497, n_regionkey_prf#1493 AS n_regionkey_prf_0#1498, n_nationkey_prf#1494 AS n_nationkey_prf_0#1499, n_name_prf#1495 AS n_name_prf_0#1500, n_comment_prf#1496 AS n_comment_prf_0#1501]
         :  :  :     :  +- Relation[rid#1492,n_regionkey_prf#1493,n_nationkey_prf#1494,n_name_prf#1495,n_comment_prf#1496] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#1505 AS s_phone_prf_1#1513, rid#1506 AS rid_1#1514, s_address_prf#1507 AS s_address_prf_1#1515, s_nationkey_prf#1508 AS s_nationkey_prf_1#1516, s_suppkey_prf#1509 AS s_suppkey_prf_1#1517, s_name_prf#1510 AS s_name_prf_1#1518, s_acctbal_prf#1511 AS s_acctbal_prf_1#1519, s_comment_prf#1512 AS s_comment_prf_1#1520]
         :  :     +- Relation[s_phone_prf#1505,rid#1506,s_address_prf#1507,s_nationkey_prf#1508,s_suppkey_prf#1509,s_name_prf#1510,s_acctbal_prf#1511,s_comment_prf#1512] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1503) AS rid_2#1527]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#1526]
         :        :  +- Relation[rid#1521,n_regionkey_prf#1522,n_nationkey_prf#1523,n_name_prf#1524,n_comment_prf#1525] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#1528 AS c_acctbal_prf_2#1537, rid#1529 AS rid_2#1538, c_name_prf#1530 AS c_name_prf_2#1539, c_nationkey_prf#1531 AS c_nationkey_prf_2#1540, c_custkey_prf#1532 AS c_custkey_prf_2#1541, c_comment_prf#1533 AS c_comment_prf_2#1542, c_address_prf#1534 AS c_address_prf_2#1543, c_mktsegment_prf#1535 AS c_mktsegment_prf_2#1544, c_phone_prf#1536 AS c_phone_prf_2#1545]
            +- Relation[c_acctbal_prf#1528,rid#1529,c_name_prf#1530,c_nationkey_prf#1531,c_custkey_prf#1532,c_comment_prf#1533,c_address_prf#1534,c_mktsegment_prf#1535,c_phone_prf#1536] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 45658ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/15 03:15:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:15:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1604L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 03:15:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1604L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#1624]
         :  :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#1616: string
         :  :  :     :- Project [c_acctbal_prf#1606 AS c_acctbal_prf_0#1615, rid#1607 AS rid_0#1616, c_name_prf#1608 AS c_name_prf_0#1617, c_nationkey_prf#1609 AS c_nationkey_prf_0#1618, c_custkey_prf#1610 AS c_custkey_prf_0#1619, c_comment_prf#1611 AS c_comment_prf_0#1620, c_address_prf#1612 AS c_address_prf_0#1621, c_mktsegment_prf#1613 AS c_mktsegment_prf_0#1622, c_phone_prf#1614 AS c_phone_prf_0#1623]
         :  :  :     :  +- Relation[c_acctbal_prf#1606,rid#1607,c_name_prf#1608,c_nationkey_prf#1609,c_custkey_prf#1610,c_comment_prf#1611,c_address_prf#1612,c_mktsegment_prf#1613,c_phone_prf#1614] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#1625 AS o_shippriority_prf_1#1635, rid#1626 AS rid_1#1636, o_orderdate_prf#1627 AS o_orderdate_prf_1#1637, o_custkey_prf#1628 AS o_custkey_prf_1#1638, o_orderpriority_prf#1629 AS o_orderpriority_prf_1#1639, o_clerk_prf#1630 AS o_clerk_prf_1#1640, o_orderstatus_prf#1631 AS o_orderstatus_prf_1#1641, o_totalprice_prf#1632 AS o_totalprice_prf_1#1642, o_orderkey_prf#1633 AS o_orderkey_prf_1#1643, o_comment_prf#1634 AS o_comment_prf_1#1644]
         :  :     +- Relation[o_shippriority_prf#1625,rid#1626,o_orderdate_prf#1627,o_custkey_prf#1628,o_orderpriority_prf#1629,o_clerk_prf#1630,o_orderstatus_prf#1631,o_totalprice_prf#1632,o_orderkey_prf#1633,o_comment_prf#1634] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1503) AS rid_2#1656]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#1655]
         :        :  +- Relation[o_shippriority_prf#1645,rid#1646,o_orderdate_prf#1647,o_custkey_prf#1648,o_orderpriority_prf#1649,o_clerk_prf#1650,o_orderstatus_prf#1651,o_totalprice_prf#1652,o_orderkey_prf#1653,o_comment_prf#1654] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1657 AS l_returnflag_prf_2#1676, l_orderkey_and_l_linenumber_prf#1658 AS l_orderkey_and_l_linenumber_prf_2#1677, l_comment_prf#1659 AS l_comment_prf_2#1678, l_linestatus_prf#1660 AS l_linestatus_prf_2#1679, rid#1661 AS rid_2#1680, l_shipmode_prf#1662 AS l_shipmode_prf_2#1681, l_shipinstruct_prf#1663 AS l_shipinstruct_prf_2#1682, l_quantity_prf#1664 AS l_quantity_prf_2#1683, l_receiptdate_prf#1665 AS l_receiptdate_prf_2#1684, l_linenumber_prf#1666 AS l_linenumber_prf_2#1685, l_tax_prf#1667 AS l_tax_prf_2#1686, l_shipdate_prf#1668 AS l_shipdate_prf_2#1687, l_extendedprice_prf#1669 AS l_extendedprice_prf_2#1688, l_partkey_prf#1670 AS l_partkey_prf_2#1689, l_discount_prf#1671 AS l_discount_prf_2#1690, l_partkey_and_l_suppkey_prf#1672 AS l_partkey_and_l_suppkey_prf_2#1691, l_commitdate_prf#1673 AS l_commitdate_prf_2#1692, l_suppkey_prf#1674 AS l_suppkey_prf_2#1693, l_orderkey_prf#1675 AS l_orderkey_prf_2#1694]
            +- Relation[l_returnflag_prf#1657,l_orderkey_and_l_linenumber_prf#1658,l_comment_prf#1659,l_linestatus_prf#1660,rid#1661,l_shipmode_prf#1662,l_shipinstruct_prf#1663,l_quantity_prf#1664,l_receiptdate_prf#1665,l_linenumber_prf#1666,l_tax_prf#1667,l_shipdate_prf#1668,l_extendedprice_prf#1669,l_partkey_prf#1670,l_discount_prf#1671,l_partkey_and_l_suppkey_prf#1672,l_commitdate_prf#1673,l_suppkey_prf#1674,l_orderkey_prf#1675] JDBCRelation(lineitem_prf) [numPartitions=1]

19/10/15 03:15:03 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=6001215
Elapsed time: 232866ms

f1=
select * from region where r_name = 'EUROPE'
19/10/15 03:18:56 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:18:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1739L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/15 03:18:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1739L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#1741 AS r_regionkey_prf_0#1745, r_name_prf#1742 AS r_name_prf_0#1746, r_comment_prf#1743 AS r_comment_prf_0#1747, rid#1744 AS rid_0#1748]
         :  +- Relation[r_regionkey_prf#1741,r_name_prf#1742,r_comment_prf#1743,rid#1744] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1751]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1749,value#1750] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 69ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/15 03:18:56 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:18:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1775L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 03:18:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1775L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#1777 AS l_returnflag_prf_0#1796, l_orderkey_and_l_linenumber_prf#1778 AS l_orderkey_and_l_linenumber_prf_0#1797, l_comment_prf#1779 AS l_comment_prf_0#1798, l_linestatus_prf#1780 AS l_linestatus_prf_0#1799, rid#1781 AS rid_0#1800, l_shipmode_prf#1782 AS l_shipmode_prf_0#1801, l_shipinstruct_prf#1783 AS l_shipinstruct_prf_0#1802, l_quantity_prf#1784 AS l_quantity_prf_0#1803, l_receiptdate_prf#1785 AS l_receiptdate_prf_0#1804, l_linenumber_prf#1786 AS l_linenumber_prf_0#1805, l_tax_prf#1787 AS l_tax_prf_0#1806, l_shipdate_prf#1788 AS l_shipdate_prf_0#1807, l_extendedprice_prf#1789 AS l_extendedprice_prf_0#1808, l_partkey_prf#1790 AS l_partkey_prf_0#1809, l_discount_prf#1791 AS l_discount_prf_0#1810, l_partkey_and_l_suppkey_prf#1792 AS l_partkey_and_l_suppkey_prf_0#1811, l_commitdate_prf#1793 AS l_commitdate_prf_0#1812, l_suppkey_prf#1794 AS l_suppkey_prf_0#1813, l_orderkey_prf#1795 AS l_orderkey_prf_0#1814]
         :  +- Relation[l_returnflag_prf#1777,l_orderkey_and_l_linenumber_prf#1778,l_comment_prf#1779,l_linestatus_prf#1780,rid#1781,l_shipmode_prf#1782,l_shipinstruct_prf#1783,l_quantity_prf#1784,l_receiptdate_prf#1785,l_linenumber_prf#1786,l_tax_prf#1787,l_shipdate_prf#1788,l_extendedprice_prf#1789,l_partkey_prf#1790,l_discount_prf#1791,l_partkey_and_l_suppkey_prf#1792,l_commitdate_prf#1793,l_suppkey_prf#1794,l_orderkey_prf#1795] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1815]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1749,value#1750] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 23531ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/15 03:19:19 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:19:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1859L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 03:19:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1859L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#1875]
         :  :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#1869: string
         :  :  :     :- Project [ps_partkey_and_ps_suppkey_prf#1861 AS ps_partkey_and_ps_suppkey_prf_0#1868, rid#1862 AS rid_0#1869, ps_availqty_prf#1863 AS ps_availqty_prf_0#1870, ps_comment_prf#1864 AS ps_comment_prf_0#1871, ps_partkey_prf#1865 AS ps_partkey_prf_0#1872, ps_supplycost_prf#1866 AS ps_supplycost_prf_0#1873, ps_suppkey_prf#1867 AS ps_suppkey_prf_0#1874]
         :  :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#1861,rid#1862,ps_availqty_prf#1863,ps_comment_prf#1864,ps_partkey_prf#1865,ps_supplycost_prf#1866,ps_suppkey_prf#1867] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#1876 AS p_comment_prf_1#1886, p_name_prf#1877 AS p_name_prf_1#1887, rid#1878 AS rid_1#1888, p_type_prf#1879 AS p_type_prf_1#1889, p_retailprice_prf#1880 AS p_retailprice_prf_1#1890, p_mfgr_prf#1881 AS p_mfgr_prf_1#1891, p_container_prf#1882 AS p_container_prf_1#1892, p_brand_prf#1883 AS p_brand_prf_1#1893, p_size_prf#1884 AS p_size_prf_1#1894, p_partkey_prf#1885 AS p_partkey_prf_1#1895]
         :  :     +- Relation[p_comment_prf#1876,p_name_prf#1877,rid#1878,p_type_prf#1879,p_retailprice_prf#1880,p_mfgr_prf#1881,p_container_prf#1882,p_brand_prf#1883,p_size_prf#1884,p_partkey_prf#1885] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1503) AS rid_2#1904]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#1903]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#1896,rid#1897,ps_availqty_prf#1898,ps_comment_prf#1899,ps_partkey_prf#1900,ps_supplycost_prf#1901,ps_suppkey_prf#1902] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#1905 AS s_phone_prf_2#1913, rid#1906 AS rid_2#1914, s_address_prf#1907 AS s_address_prf_2#1915, s_nationkey_prf#1908 AS s_nationkey_prf_2#1916, s_suppkey_prf#1909 AS s_suppkey_prf_2#1917, s_name_prf#1910 AS s_name_prf_2#1918, s_acctbal_prf#1911 AS s_acctbal_prf_2#1919, s_comment_prf#1912 AS s_comment_prf_2#1920]
            +- Relation[s_phone_prf#1905,rid#1906,s_address_prf#1907,s_nationkey_prf#1908,s_suppkey_prf#1909,s_name_prf#1910,s_acctbal_prf#1911,s_comment_prf#1912] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 104437ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/15 03:21:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:21:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1956L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/15 03:21:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1956L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#1966]
         :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#1965: string
         :     :- Project [r_regionkey_prf#1958 AS r_regionkey_prf_0#1962, r_name_prf#1959 AS r_name_prf_0#1963, r_comment_prf#1960 AS r_comment_prf_0#1964, rid#1961 AS rid_0#1965]
         :     :  +- Relation[r_regionkey_prf#1958,r_name_prf#1959,r_comment_prf#1960,rid#1961] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#1967 AS rid_1#1972, n_regionkey_prf#1968 AS n_regionkey_prf_1#1973, n_nationkey_prf#1969 AS n_nationkey_prf_1#1974, n_name_prf#1970 AS n_name_prf_1#1975, n_comment_prf#1971 AS n_comment_prf_1#1976]
            +- Relation[rid#1967,n_regionkey_prf#1968,n_nationkey_prf#1969,n_name_prf#1970,n_comment_prf#1971] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=25
Elapsed time: 73ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/15 03:21:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:21:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1998L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 03:21:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1998L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#2000 AS p_comment_prf_0#2010, p_name_prf#2001 AS p_name_prf_0#2011, rid#2002 AS rid_0#2012, p_type_prf#2003 AS p_type_prf_0#2013, p_retailprice_prf#2004 AS p_retailprice_prf_0#2014, p_mfgr_prf#2005 AS p_mfgr_prf_0#2015, p_container_prf#2006 AS p_container_prf_0#2016, p_brand_prf#2007 AS p_brand_prf_0#2017, p_size_prf#2008 AS p_size_prf_0#2018, p_partkey_prf#2009 AS p_partkey_prf_0#2019]
         :  +- Relation[p_comment_prf#2000,p_name_prf#2001,rid#2002,p_type_prf#2003,p_retailprice_prf#2004,p_mfgr_prf#2005,p_container_prf#2006,p_brand_prf#2007,p_size_prf#2008,p_partkey_prf#2009] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2020]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1749,value#1750] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1451
Elapsed time: 85ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/15 03:21:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:21:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2067L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/15 03:21:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2067L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#2107]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2092: string
         :  :  :     :- Project [l_returnflag_prf#2069 AS l_returnflag_prf_0#2088, l_orderkey_and_l_linenumber_prf#2070 AS l_orderkey_and_l_linenumber_prf_0#2089, l_comment_prf#2071 AS l_comment_prf_0#2090, l_linestatus_prf#2072 AS l_linestatus_prf_0#2091, rid#2073 AS rid_0#2092, l_shipmode_prf#2074 AS l_shipmode_prf_0#2093, l_shipinstruct_prf#2075 AS l_shipinstruct_prf_0#2094, l_quantity_prf#2076 AS l_quantity_prf_0#2095, l_receiptdate_prf#2077 AS l_receiptdate_prf_0#2096, l_linenumber_prf#2078 AS l_linenumber_prf_0#2097, l_tax_prf#2079 AS l_tax_prf_0#2098, l_shipdate_prf#2080 AS l_shipdate_prf_0#2099, l_extendedprice_prf#2081 AS l_extendedprice_prf_0#2100, l_partkey_prf#2082 AS l_partkey_prf_0#2101, l_discount_prf#2083 AS l_discount_prf_0#2102, l_partkey_and_l_suppkey_prf#2084 AS l_partkey_and_l_suppkey_prf_0#2103, l_commitdate_prf#2085 AS l_commitdate_prf_0#2104, l_suppkey_prf#2086 AS l_suppkey_prf_0#2105, l_orderkey_prf#2087 AS l_orderkey_prf_0#2106]
         :  :  :     :  +- Relation[l_returnflag_prf#2069,l_orderkey_and_l_linenumber_prf#2070,l_comment_prf#2071,l_linestatus_prf#2072,rid#2073,l_shipmode_prf#2074,l_shipinstruct_prf#2075,l_quantity_prf#2076,l_receiptdate_prf#2077,l_linenumber_prf#2078,l_tax_prf#2079,l_shipdate_prf#2080,l_extendedprice_prf#2081,l_partkey_prf#2082,l_discount_prf#2083,l_partkey_and_l_suppkey_prf#2084,l_commitdate_prf#2085,l_suppkey_prf#2086,l_orderkey_prf#2087] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#2108 AS o_shippriority_prf_1#2118, rid#2109 AS rid_1#2119, o_orderdate_prf#2110 AS o_orderdate_prf_1#2120, o_custkey_prf#2111 AS o_custkey_prf_1#2121, o_orderpriority_prf#2112 AS o_orderpriority_prf_1#2122, o_clerk_prf#2113 AS o_clerk_prf_1#2123, o_orderstatus_prf#2114 AS o_orderstatus_prf_1#2124, o_totalprice_prf#2115 AS o_totalprice_prf_1#2125, o_orderkey_prf#2116 AS o_orderkey_prf_1#2126, o_comment_prf#2117 AS o_comment_prf_1#2127]
         :  :     +- Relation[o_shippriority_prf#2108,rid#2109,o_orderdate_prf#2110,o_custkey_prf#2111,o_orderpriority_prf#2112,o_clerk_prf#2113,o_orderstatus_prf#2114,o_totalprice_prf#2115,o_orderkey_prf#2116,o_comment_prf#2117] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1503) AS rid_2#2139]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2138]
         :        :  +- Relation[o_shippriority_prf#2128,rid#2129,o_orderdate_prf#2130,o_custkey_prf#2131,o_orderpriority_prf#2132,o_clerk_prf#2133,o_orderstatus_prf#2134,o_totalprice_prf#2135,o_orderkey_prf#2136,o_comment_prf#2137] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2140 AS c_acctbal_prf_2#2149, rid#2141 AS rid_2#2150, c_name_prf#2142 AS c_name_prf_2#2151, c_nationkey_prf#2143 AS c_nationkey_prf_2#2152, c_custkey_prf#2144 AS c_custkey_prf_2#2153, c_comment_prf#2145 AS c_comment_prf_2#2154, c_address_prf#2146 AS c_address_prf_2#2155, c_mktsegment_prf#2147 AS c_mktsegment_prf_2#2156, c_phone_prf#2148 AS c_phone_prf_2#2157]
            +- Relation[c_acctbal_prf#2140,rid#2141,c_name_prf#2142,c_nationkey_prf#2143,c_custkey_prf#2144,c_comment_prf#2145,c_address_prf#2146,c_mktsegment_prf#2147,c_phone_prf#2148] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 172041ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/15 03:23:56 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:23:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2203L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/15 03:23:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2203L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#2205 AS rid_0#2210, n_regionkey_prf#2206 AS n_regionkey_prf_0#2211, n_nationkey_prf#2207 AS n_nationkey_prf_0#2212, n_name_prf#2208 AS n_name_prf_0#2213, n_comment_prf#2209 AS n_comment_prf_0#2214]
         :  +- Relation[rid#2205,n_regionkey_prf#2206,n_nationkey_prf#2207,n_name_prf#2208,n_comment_prf#2209] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2215]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1749,value#1750] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 58ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/15 03:23:56 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:23:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2249L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 03:23:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2249L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#2289]
         :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#2274: string
         :     :- Project [l_returnflag_prf#2251 AS l_returnflag_prf_0#2270, l_orderkey_and_l_linenumber_prf#2252 AS l_orderkey_and_l_linenumber_prf_0#2271, l_comment_prf#2253 AS l_comment_prf_0#2272, l_linestatus_prf#2254 AS l_linestatus_prf_0#2273, rid#2255 AS rid_0#2274, l_shipmode_prf#2256 AS l_shipmode_prf_0#2275, l_shipinstruct_prf#2257 AS l_shipinstruct_prf_0#2276, l_quantity_prf#2258 AS l_quantity_prf_0#2277, l_receiptdate_prf#2259 AS l_receiptdate_prf_0#2278, l_linenumber_prf#2260 AS l_linenumber_prf_0#2279, l_tax_prf#2261 AS l_tax_prf_0#2280, l_shipdate_prf#2262 AS l_shipdate_prf_0#2281, l_extendedprice_prf#2263 AS l_extendedprice_prf_0#2282, l_partkey_prf#2264 AS l_partkey_prf_0#2283, l_discount_prf#2265 AS l_discount_prf_0#2284, l_partkey_and_l_suppkey_prf#2266 AS l_partkey_and_l_suppkey_prf_0#2285, l_commitdate_prf#2267 AS l_commitdate_prf_0#2286, l_suppkey_prf#2268 AS l_suppkey_prf_0#2287, l_orderkey_prf#2269 AS l_orderkey_prf_0#2288]
         :     :  +- Relation[l_returnflag_prf#2251,l_orderkey_and_l_linenumber_prf#2252,l_comment_prf#2253,l_linestatus_prf#2254,rid#2255,l_shipmode_prf#2256,l_shipinstruct_prf#2257,l_quantity_prf#2258,l_receiptdate_prf#2259,l_linenumber_prf#2260,l_tax_prf#2261,l_shipdate_prf#2262,l_extendedprice_prf#2263,l_partkey_prf#2264,l_discount_prf#2265,l_partkey_and_l_suppkey_prf#2266,l_commitdate_prf#2267,l_suppkey_prf#2268,l_orderkey_prf#2269] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#2290 AS p_comment_prf_1#2300, p_name_prf#2291 AS p_name_prf_1#2301, rid#2292 AS rid_1#2302, p_type_prf#2293 AS p_type_prf_1#2303, p_retailprice_prf#2294 AS p_retailprice_prf_1#2304, p_mfgr_prf#2295 AS p_mfgr_prf_1#2305, p_container_prf#2296 AS p_container_prf_1#2306, p_brand_prf#2297 AS p_brand_prf_1#2307, p_size_prf#2298 AS p_size_prf_1#2308, p_partkey_prf#2299 AS p_partkey_prf_1#2309]
            +- Relation[p_comment_prf#2290,p_name_prf#2291,rid#2292,p_type_prf#2293,p_retailprice_prf#2294,p_mfgr_prf#2295,p_container_prf#2296,p_brand_prf#2297,p_size_prf#2298,p_partkey_prf#2299] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 117651ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/15 03:25:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:25:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2363L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 03:25:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2363L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#2379]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, rid_0#2373: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#2365 AS ps_partkey_and_ps_suppkey_prf_0#2372, rid#2366 AS rid_0#2373, ps_availqty_prf#2367 AS ps_availqty_prf_0#2374, ps_comment_prf#2368 AS ps_comment_prf_0#2375, ps_partkey_prf#2369 AS ps_partkey_prf_0#2376, ps_supplycost_prf#2370 AS ps_supplycost_prf_0#2377, ps_suppkey_prf#2371 AS ps_suppkey_prf_0#2378]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2365,rid#2366,ps_availqty_prf#2367,ps_comment_prf#2368,ps_partkey_prf#2369,ps_supplycost_prf#2370,ps_suppkey_prf#2371] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2380 AS l_returnflag_prf_1#2399, l_orderkey_and_l_linenumber_prf#2381 AS l_orderkey_and_l_linenumber_prf_1#2400, l_comment_prf#2382 AS l_comment_prf_1#2401, l_linestatus_prf#2383 AS l_linestatus_prf_1#2402, rid#2384 AS rid_1#2403, l_shipmode_prf#2385 AS l_shipmode_prf_1#2404, l_shipinstruct_prf#2386 AS l_shipinstruct_prf_1#2405, l_quantity_prf#2387 AS l_quantity_prf_1#2406, l_receiptdate_prf#2388 AS l_receiptdate_prf_1#2407, l_linenumber_prf#2389 AS l_linenumber_prf_1#2408, l_tax_prf#2390 AS l_tax_prf_1#2409, l_shipdate_prf#2391 AS l_shipdate_prf_1#2410, l_extendedprice_prf#2392 AS l_extendedprice_prf_1#2411, l_partkey_prf#2393 AS l_partkey_prf_1#2412, l_discount_prf#2394 AS l_discount_prf_1#2413, l_partkey_and_l_suppkey_prf#2395 AS l_partkey_and_l_suppkey_prf_1#2414, l_commitdate_prf#2396 AS l_commitdate_prf_1#2415, l_suppkey_prf#2397 AS l_suppkey_prf_1#2416, l_orderkey_prf#2398 AS l_orderkey_prf_1#2417]
            +- Relation[l_returnflag_prf#2380,l_orderkey_and_l_linenumber_prf#2381,l_comment_prf#2382,l_linestatus_prf#2383,rid#2384,l_shipmode_prf#2385,l_shipinstruct_prf#2386,l_quantity_prf#2387,l_receiptdate_prf#2388,l_linenumber_prf#2389,l_tax_prf#2390,l_shipdate_prf#2391,l_extendedprice_prf#2392,l_partkey_prf#2393,l_discount_prf#2394,l_partkey_and_l_suppkey_prf#2395,l_commitdate_prf#2396,l_suppkey_prf#2397,l_orderkey_prf#2398] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 116061ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/15 03:27:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:27:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2479L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 03:27:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2479L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#2501]
         :  :  :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2493: string
         :  :  :     :- Project [p_comment_prf#2481 AS p_comment_prf_0#2491, p_name_prf#2482 AS p_name_prf_0#2492, rid#2483 AS rid_0#2493, p_type_prf#2484 AS p_type_prf_0#2494, p_retailprice_prf#2485 AS p_retailprice_prf_0#2495, p_mfgr_prf#2486 AS p_mfgr_prf_0#2496, p_container_prf#2487 AS p_container_prf_0#2497, p_brand_prf#2488 AS p_brand_prf_0#2498, p_size_prf#2489 AS p_size_prf_0#2499, p_partkey_prf#2490 AS p_partkey_prf_0#2500]
         :  :  :     :  +- Relation[p_comment_prf#2481,p_name_prf#2482,rid#2483,p_type_prf#2484,p_retailprice_prf#2485,p_mfgr_prf#2486,p_container_prf#2487,p_brand_prf#2488,p_size_prf#2489,p_partkey_prf#2490] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#2502 AS l_returnflag_prf_1#2521, l_orderkey_and_l_linenumber_prf#2503 AS l_orderkey_and_l_linenumber_prf_1#2522, l_comment_prf#2504 AS l_comment_prf_1#2523, l_linestatus_prf#2505 AS l_linestatus_prf_1#2524, rid#2506 AS rid_1#2525, l_shipmode_prf#2507 AS l_shipmode_prf_1#2526, l_shipinstruct_prf#2508 AS l_shipinstruct_prf_1#2527, l_quantity_prf#2509 AS l_quantity_prf_1#2528, l_receiptdate_prf#2510 AS l_receiptdate_prf_1#2529, l_linenumber_prf#2511 AS l_linenumber_prf_1#2530, l_tax_prf#2512 AS l_tax_prf_1#2531, l_shipdate_prf#2513 AS l_shipdate_prf_1#2532, l_extendedprice_prf#2514 AS l_extendedprice_prf_1#2533, l_partkey_prf#2515 AS l_partkey_prf_1#2534, l_discount_prf#2516 AS l_discount_prf_1#2535, l_partkey_and_l_suppkey_prf#2517 AS l_partkey_and_l_suppkey_prf_1#2536, l_commitdate_prf#2518 AS l_commitdate_prf_1#2537, l_suppkey_prf#2519 AS l_suppkey_prf_1#2538, l_orderkey_prf#2520 AS l_orderkey_prf_1#2539]
         :  :     +- Relation[l_returnflag_prf#2502,l_orderkey_and_l_linenumber_prf#2503,l_comment_prf#2504,l_linestatus_prf#2505,rid#2506,l_shipmode_prf#2507,l_shipinstruct_prf#2508,l_quantity_prf#2509,l_receiptdate_prf#2510,l_linenumber_prf#2511,l_tax_prf#2512,l_shipdate_prf#2513,l_extendedprice_prf#2514,l_partkey_prf#2515,l_discount_prf#2516,l_partkey_and_l_suppkey_prf#2517,l_commitdate_prf#2518,l_suppkey_prf#2519,l_orderkey_prf#2520] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1503) AS rid_2#2560]
         :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2559]
         :        :  +- Relation[l_returnflag_prf#2540,l_orderkey_and_l_linenumber_prf#2541,l_comment_prf#2542,l_linestatus_prf#2543,rid#2544,l_shipmode_prf#2545,l_shipinstruct_prf#2546,l_quantity_prf#2547,l_receiptdate_prf#2548,l_linenumber_prf#2549,l_tax_prf#2550,l_shipdate_prf#2551,l_extendedprice_prf#2552,l_partkey_prf#2553,l_discount_prf#2554,l_partkey_and_l_suppkey_prf#2555,l_commitdate_prf#2556,l_suppkey_prf#2557,l_orderkey_prf#2558] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2561 AS s_phone_prf_2#2569, rid#2562 AS rid_2#2570, s_address_prf#2563 AS s_address_prf_2#2571, s_nationkey_prf#2564 AS s_nationkey_prf_2#2572, s_suppkey_prf#2565 AS s_suppkey_prf_2#2573, s_name_prf#2566 AS s_name_prf_2#2574, s_acctbal_prf#2567 AS s_acctbal_prf_2#2575, s_comment_prf#2568 AS s_comment_prf_2#2576]
            +- Relation[s_phone_prf#2561,rid#2562,s_address_prf#2563,s_nationkey_prf#2564,s_suppkey_prf#2565,s_name_prf#2566,s_acctbal_prf#2567,s_comment_prf#2568] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 196720ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/15 03:31:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:31:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2638L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/15 03:31:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2638L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_2#2656]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#2649: string
         :     :- Project [s_phone_prf#2640 AS s_phone_prf_0#2648, rid#2641 AS rid_0#2649, s_address_prf#2642 AS s_address_prf_0#2650, s_nationkey_prf#2643 AS s_nationkey_prf_0#2651, s_suppkey_prf#2644 AS s_suppkey_prf_0#2652, s_name_prf#2645 AS s_name_prf_0#2653, s_acctbal_prf#2646 AS s_acctbal_prf_0#2654, s_comment_prf#2647 AS s_comment_prf_0#2655]
         :     :  +- Relation[s_phone_prf#2640,rid#2641,s_address_prf#2642,s_nationkey_prf#2643,s_suppkey_prf#2644,s_name_prf#2645,s_acctbal_prf#2646,s_comment_prf#2647] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1503) AS rid_2#2677]
            :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#2669: string
            :     :- Project [p_comment_prf#2657 AS p_comment_prf_1#2667, p_name_prf#2658 AS p_name_prf_1#2668, rid#2659 AS rid_1#2669, p_type_prf#2660 AS p_type_prf_1#2670, p_retailprice_prf#2661 AS p_retailprice_prf_1#2671, p_mfgr_prf#2662 AS p_mfgr_prf_1#2672, p_container_prf#2663 AS p_container_prf_1#2673, p_brand_prf#2664 AS p_brand_prf_1#2674, p_size_prf#2665 AS p_size_prf_1#2675, p_partkey_prf#2666 AS p_partkey_prf_1#2676]
            :     :  +- Relation[p_comment_prf#2657,p_name_prf#2658,rid#2659,p_type_prf#2660,p_retailprice_prf#2661,p_mfgr_prf#2662,p_container_prf#2663,p_brand_prf#2664,p_size_prf#2665,p_partkey_prf#2666] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#2678 AS ps_partkey_and_ps_suppkey_prf_2#2685, rid#2679 AS rid_2#2686, ps_availqty_prf#2680 AS ps_availqty_prf_2#2687, ps_comment_prf#2681 AS ps_comment_prf_2#2688, ps_partkey_prf#2682 AS ps_partkey_prf_2#2689, ps_supplycost_prf#2683 AS ps_supplycost_prf_2#2690, ps_suppkey_prf#2684 AS ps_suppkey_prf_2#2691]
               +- Relation[ps_partkey_and_ps_suppkey_prf#2678,rid#2679,ps_availqty_prf#2680,ps_comment_prf#2681,ps_partkey_prf#2682,ps_supplycost_prf#2683,ps_suppkey_prf#2684] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 42738ms

f2=
select * from part where p_size = 15
19/10/15 03:31:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:31:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2729L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 03:31:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2729L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#2731 AS p_comment_prf_0#2741, p_name_prf#2732 AS p_name_prf_0#2742, rid#2733 AS rid_0#2743, p_type_prf#2734 AS p_type_prf_0#2744, p_retailprice_prf#2735 AS p_retailprice_prf_0#2745, p_mfgr_prf#2736 AS p_mfgr_prf_0#2746, p_container_prf#2737 AS p_container_prf_0#2747, p_brand_prf#2738 AS p_brand_prf_0#2748, p_size_prf#2739 AS p_size_prf_0#2749, p_partkey_prf#2740 AS p_partkey_prf_0#2750]
         :  +- Relation[p_comment_prf#2731,p_name_prf#2732,rid#2733,p_type_prf#2734,p_retailprice_prf#2735,p_mfgr_prf#2736,p_container_prf#2737,p_brand_prf#2738,p_size_prf#2739,p_partkey_prf#2740] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2751]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1749,value#1750] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3907
Elapsed time: 132ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/15 03:31:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:31:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2779L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/15 03:31:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2779L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#2802]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2793: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#2781 AS p_comment_prf_0#2791, p_name_prf#2782 AS p_name_prf_0#2792, rid#2783 AS rid_0#2793, p_type_prf#2784 AS p_type_prf_0#2794, p_retailprice_prf#2785 AS p_retailprice_prf_0#2795, p_mfgr_prf#2786 AS p_mfgr_prf_0#2796, p_container_prf#2787 AS p_container_prf_0#2797, p_brand_prf#2788 AS p_brand_prf_0#2798, p_size_prf#2789 AS p_size_prf_0#2799, p_partkey_prf#2790 AS p_partkey_prf_0#2800]
         :     :  :  +- Relation[p_comment_prf#2781,p_name_prf#2782,rid#2783,p_type_prf#2784,p_retailprice_prf#2785,p_mfgr_prf#2786,p_container_prf#2787,p_brand_prf#2788,p_size_prf#2789,p_partkey_prf#2790] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2801]
         :     :     +- DexRidFilter part~p_size~15
         :     :        +- Relation[label#1749,value#1750] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2803 AS ps_partkey_and_ps_suppkey_prf_1#2810, rid#2804 AS rid_1#2811, ps_availqty_prf#2805 AS ps_availqty_prf_1#2812, ps_comment_prf#2806 AS ps_comment_prf_1#2813, ps_partkey_prf#2807 AS ps_partkey_prf_1#2814, ps_supplycost_prf#2808 AS ps_supplycost_prf_1#2815, ps_suppkey_prf#2809 AS ps_suppkey_prf_1#2816]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2803,rid#2804,ps_availqty_prf#2805,ps_comment_prf#2806,ps_partkey_prf#2807,ps_supplycost_prf#2808,ps_suppkey_prf#2809] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 400ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/15 03:31:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:31:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2862L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 03:31:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2862L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#2884]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#2875: string
         :     :- Project [o_shippriority_prf#2864 AS o_shippriority_prf_0#2874, rid#2865 AS rid_0#2875, o_orderdate_prf#2866 AS o_orderdate_prf_0#2876, o_custkey_prf#2867 AS o_custkey_prf_0#2877, o_orderpriority_prf#2868 AS o_orderpriority_prf_0#2878, o_clerk_prf#2869 AS o_clerk_prf_0#2879, o_orderstatus_prf#2870 AS o_orderstatus_prf_0#2880, o_totalprice_prf#2871 AS o_totalprice_prf_0#2881, o_orderkey_prf#2872 AS o_orderkey_prf_0#2882, o_comment_prf#2873 AS o_comment_prf_0#2883]
         :     :  +- Relation[o_shippriority_prf#2864,rid#2865,o_orderdate_prf#2866,o_custkey_prf#2867,o_orderpriority_prf#2868,o_clerk_prf#2869,o_orderstatus_prf#2870,o_totalprice_prf#2871,o_orderkey_prf#2872,o_comment_prf#2873] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2885 AS l_returnflag_prf_1#2904, l_orderkey_and_l_linenumber_prf#2886 AS l_orderkey_and_l_linenumber_prf_1#2905, l_comment_prf#2887 AS l_comment_prf_1#2906, l_linestatus_prf#2888 AS l_linestatus_prf_1#2907, rid#2889 AS rid_1#2908, l_shipmode_prf#2890 AS l_shipmode_prf_1#2909, l_shipinstruct_prf#2891 AS l_shipinstruct_prf_1#2910, l_quantity_prf#2892 AS l_quantity_prf_1#2911, l_receiptdate_prf#2893 AS l_receiptdate_prf_1#2912, l_linenumber_prf#2894 AS l_linenumber_prf_1#2913, l_tax_prf#2895 AS l_tax_prf_1#2914, l_shipdate_prf#2896 AS l_shipdate_prf_1#2915, l_extendedprice_prf#2897 AS l_extendedprice_prf_1#2916, l_partkey_prf#2898 AS l_partkey_prf_1#2917, l_discount_prf#2899 AS l_discount_prf_1#2918, l_partkey_and_l_suppkey_prf#2900 AS l_partkey_and_l_suppkey_prf_1#2919, l_commitdate_prf#2901 AS l_commitdate_prf_1#2920, l_suppkey_prf#2902 AS l_suppkey_prf_1#2921, l_orderkey_prf#2903 AS l_orderkey_prf_1#2922]
            +- Relation[l_returnflag_prf#2885,l_orderkey_and_l_linenumber_prf#2886,l_comment_prf#2887,l_linestatus_prf#2888,rid#2889,l_shipmode_prf#2890,l_shipinstruct_prf#2891,l_quantity_prf#2892,l_receiptdate_prf#2893,l_linenumber_prf#2894,l_tax_prf#2895,l_shipdate_prf#2896,l_extendedprice_prf#2897,l_partkey_prf#2898,l_discount_prf#2899,l_partkey_and_l_suppkey_prf#2900,l_commitdate_prf#2901,l_suppkey_prf#2902,l_orderkey_prf#2903] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 195908ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/15 03:35:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:35:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2967L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/15 03:35:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2967L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#2985]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#2978: string
         :     :- Project [s_phone_prf#2969 AS s_phone_prf_0#2977, rid#2970 AS rid_0#2978, s_address_prf#2971 AS s_address_prf_0#2979, s_nationkey_prf#2972 AS s_nationkey_prf_0#2980, s_suppkey_prf#2973 AS s_suppkey_prf_0#2981, s_name_prf#2974 AS s_name_prf_0#2982, s_acctbal_prf#2975 AS s_acctbal_prf_0#2983, s_comment_prf#2976 AS s_comment_prf_0#2984]
         :     :  +- Relation[s_phone_prf#2969,rid#2970,s_address_prf#2971,s_nationkey_prf#2972,s_suppkey_prf#2973,s_name_prf#2974,s_acctbal_prf#2975,s_comment_prf#2976] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2986 AS ps_partkey_and_ps_suppkey_prf_1#2993, rid#2987 AS rid_1#2994, ps_availqty_prf#2988 AS ps_availqty_prf_1#2995, ps_comment_prf#2989 AS ps_comment_prf_1#2996, ps_partkey_prf#2990 AS ps_partkey_prf_1#2997, ps_supplycost_prf#2991 AS ps_supplycost_prf_1#2998, ps_suppkey_prf#2992 AS ps_suppkey_prf_1#2999]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2986,rid#2987,ps_availqty_prf#2988,ps_comment_prf#2989,ps_partkey_prf#2990,ps_supplycost_prf#2991,ps_suppkey_prf#2992] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 10960ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/15 03:35:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:35:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3050L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 03:35:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3050L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_2#3068]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#3061: string
         :     :- Project [s_phone_prf#3052 AS s_phone_prf_0#3060, rid#3053 AS rid_0#3061, s_address_prf#3054 AS s_address_prf_0#3062, s_nationkey_prf#3055 AS s_nationkey_prf_0#3063, s_suppkey_prf#3056 AS s_suppkey_prf_0#3064, s_name_prf#3057 AS s_name_prf_0#3065, s_acctbal_prf#3058 AS s_acctbal_prf_0#3066, s_comment_prf#3059 AS s_comment_prf_0#3067]
         :     :  +- Relation[s_phone_prf#3052,rid#3053,s_address_prf#3054,s_nationkey_prf#3055,s_suppkey_prf#3056,s_name_prf#3057,s_acctbal_prf#3058,s_comment_prf#3059] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1503) AS rid_2#3089]
            :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#3081: string
            :     :- Project [p_comment_prf#3069 AS p_comment_prf_1#3079, p_name_prf#3070 AS p_name_prf_1#3080, rid#3071 AS rid_1#3081, p_type_prf#3072 AS p_type_prf_1#3082, p_retailprice_prf#3073 AS p_retailprice_prf_1#3083, p_mfgr_prf#3074 AS p_mfgr_prf_1#3084, p_container_prf#3075 AS p_container_prf_1#3085, p_brand_prf#3076 AS p_brand_prf_1#3086, p_size_prf#3077 AS p_size_prf_1#3087, p_partkey_prf#3078 AS p_partkey_prf_1#3088]
            :     :  +- Relation[p_comment_prf#3069,p_name_prf#3070,rid#3071,p_type_prf#3072,p_retailprice_prf#3073,p_mfgr_prf#3074,p_container_prf#3075,p_brand_prf#3076,p_size_prf#3077,p_partkey_prf#3078] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3090 AS l_returnflag_prf_2#3109, l_orderkey_and_l_linenumber_prf#3091 AS l_orderkey_and_l_linenumber_prf_2#3110, l_comment_prf#3092 AS l_comment_prf_2#3111, l_linestatus_prf#3093 AS l_linestatus_prf_2#3112, rid#3094 AS rid_2#3113, l_shipmode_prf#3095 AS l_shipmode_prf_2#3114, l_shipinstruct_prf#3096 AS l_shipinstruct_prf_2#3115, l_quantity_prf#3097 AS l_quantity_prf_2#3116, l_receiptdate_prf#3098 AS l_receiptdate_prf_2#3117, l_linenumber_prf#3099 AS l_linenumber_prf_2#3118, l_tax_prf#3100 AS l_tax_prf_2#3119, l_shipdate_prf#3101 AS l_shipdate_prf_2#3120, l_extendedprice_prf#3102 AS l_extendedprice_prf_2#3121, l_partkey_prf#3103 AS l_partkey_prf_2#3122, l_discount_prf#3104 AS l_discount_prf_2#3123, l_partkey_and_l_suppkey_prf#3105 AS l_partkey_and_l_suppkey_prf_2#3124, l_commitdate_prf#3106 AS l_commitdate_prf_2#3125, l_suppkey_prf#3107 AS l_suppkey_prf_2#3126, l_orderkey_prf#3108 AS l_orderkey_prf_2#3127]
               +- Relation[l_returnflag_prf#3090,l_orderkey_and_l_linenumber_prf#3091,l_comment_prf#3092,l_linestatus_prf#3093,rid#3094,l_shipmode_prf#3095,l_shipinstruct_prf#3096,l_quantity_prf#3097,l_receiptdate_prf#3098,l_linenumber_prf#3099,l_tax_prf#3100,l_shipdate_prf#3101,l_extendedprice_prf#3102,l_partkey_prf#3103,l_discount_prf#3104,l_partkey_and_l_suppkey_prf#3105,l_commitdate_prf#3106,l_suppkey_prf#3107,l_orderkey_prf#3108] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 188273ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/15 03:38:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:38:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3201L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 03:38:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3201L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_2#3221]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3213: string
         :     :- Project [c_acctbal_prf#3203 AS c_acctbal_prf_0#3212, rid#3204 AS rid_0#3213, c_name_prf#3205 AS c_name_prf_0#3214, c_nationkey_prf#3206 AS c_nationkey_prf_0#3215, c_custkey_prf#3207 AS c_custkey_prf_0#3216, c_comment_prf#3208 AS c_comment_prf_0#3217, c_address_prf#3209 AS c_address_prf_0#3218, c_mktsegment_prf#3210 AS c_mktsegment_prf_0#3219, c_phone_prf#3211 AS c_phone_prf_0#3220]
         :     :  +- Relation[c_acctbal_prf#3203,rid#3204,c_name_prf#3205,c_nationkey_prf#3206,c_custkey_prf#3207,c_comment_prf#3208,c_address_prf#3209,c_mktsegment_prf#3210,c_phone_prf#3211] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1503) AS rid_2#3260]
            :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_1#3245: string
            :     :- Project [l_returnflag_prf#3222 AS l_returnflag_prf_1#3241, l_orderkey_and_l_linenumber_prf#3223 AS l_orderkey_and_l_linenumber_prf_1#3242, l_comment_prf#3224 AS l_comment_prf_1#3243, l_linestatus_prf#3225 AS l_linestatus_prf_1#3244, rid#3226 AS rid_1#3245, l_shipmode_prf#3227 AS l_shipmode_prf_1#3246, l_shipinstruct_prf#3228 AS l_shipinstruct_prf_1#3247, l_quantity_prf#3229 AS l_quantity_prf_1#3248, l_receiptdate_prf#3230 AS l_receiptdate_prf_1#3249, l_linenumber_prf#3231 AS l_linenumber_prf_1#3250, l_tax_prf#3232 AS l_tax_prf_1#3251, l_shipdate_prf#3233 AS l_shipdate_prf_1#3252, l_extendedprice_prf#3234 AS l_extendedprice_prf_1#3253, l_partkey_prf#3235 AS l_partkey_prf_1#3254, l_discount_prf#3236 AS l_discount_prf_1#3255, l_partkey_and_l_suppkey_prf#3237 AS l_partkey_and_l_suppkey_prf_1#3256, l_commitdate_prf#3238 AS l_commitdate_prf_1#3257, l_suppkey_prf#3239 AS l_suppkey_prf_1#3258, l_orderkey_prf#3240 AS l_orderkey_prf_1#3259]
            :     :  +- Relation[l_returnflag_prf#3222,l_orderkey_and_l_linenumber_prf#3223,l_comment_prf#3224,l_linestatus_prf#3225,rid#3226,l_shipmode_prf#3227,l_shipinstruct_prf#3228,l_quantity_prf#3229,l_receiptdate_prf#3230,l_linenumber_prf#3231,l_tax_prf#3232,l_shipdate_prf#3233,l_extendedprice_prf#3234,l_partkey_prf#3235,l_discount_prf#3236,l_partkey_and_l_suppkey_prf#3237,l_commitdate_prf#3238,l_suppkey_prf#3239,l_orderkey_prf#3240] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3261 AS o_shippriority_prf_2#3271, rid#3262 AS rid_2#3272, o_orderdate_prf#3263 AS o_orderdate_prf_2#3273, o_custkey_prf#3264 AS o_custkey_prf_2#3274, o_orderpriority_prf#3265 AS o_orderpriority_prf_2#3275, o_clerk_prf#3266 AS o_clerk_prf_2#3276, o_orderstatus_prf#3267 AS o_orderstatus_prf_2#3277, o_totalprice_prf#3268 AS o_totalprice_prf_2#3278, o_orderkey_prf#3269 AS o_orderkey_prf_2#3279, o_comment_prf#3270 AS o_comment_prf_2#3280]
               +- Relation[o_shippriority_prf#3261,rid#3262,o_orderdate_prf#3263,o_custkey_prf#3264,o_orderpriority_prf#3265,o_clerk_prf#3266,o_orderstatus_prf#3267,o_totalprice_prf#3268,o_orderkey_prf#3269,o_comment_prf#3270] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 157041ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/15 03:41:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:41:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3336L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 03:41:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3336L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#3352]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#3346: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#3338 AS ps_partkey_and_ps_suppkey_prf_0#3345, rid#3339 AS rid_0#3346, ps_availqty_prf#3340 AS ps_availqty_prf_0#3347, ps_comment_prf#3341 AS ps_comment_prf_0#3348, ps_partkey_prf#3342 AS ps_partkey_prf_0#3349, ps_supplycost_prf#3343 AS ps_supplycost_prf_0#3350, ps_suppkey_prf#3344 AS ps_suppkey_prf_0#3351]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#3338,rid#3339,ps_availqty_prf#3340,ps_comment_prf#3341,ps_partkey_prf#3342,ps_supplycost_prf#3343,ps_suppkey_prf#3344] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#3353 AS p_comment_prf_1#3363, p_name_prf#3354 AS p_name_prf_1#3364, rid#3355 AS rid_1#3365, p_type_prf#3356 AS p_type_prf_1#3366, p_retailprice_prf#3357 AS p_retailprice_prf_1#3367, p_mfgr_prf#3358 AS p_mfgr_prf_1#3368, p_container_prf#3359 AS p_container_prf_1#3369, p_brand_prf#3360 AS p_brand_prf_1#3370, p_size_prf#3361 AS p_size_prf_1#3371, p_partkey_prf#3362 AS p_partkey_prf_1#3372]
            :  +- Relation[p_comment_prf#3353,p_name_prf#3354,rid#3355,p_type_prf#3356,p_retailprice_prf#3357,p_mfgr_prf#3358,p_container_prf#3359,p_brand_prf#3360,p_size_prf#3361,p_partkey_prf#3362] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3373]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1749,value#1750] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 49998ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/15 03:41:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:41:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3405L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 03:41:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3405L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#3417]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#3412: string
         :     :- Project [rid#3407 AS rid_0#3412, n_regionkey_prf#3408 AS n_regionkey_prf_0#3413, n_nationkey_prf#3409 AS n_nationkey_prf_0#3414, n_name_prf#3410 AS n_name_prf_0#3415, n_comment_prf#3411 AS n_comment_prf_0#3416]
         :     :  +- Relation[rid#3407,n_regionkey_prf#3408,n_nationkey_prf#3409,n_name_prf#3410,n_comment_prf#3411] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3418 AS s_phone_prf_1#3426, rid#3419 AS rid_1#3427, s_address_prf#3420 AS s_address_prf_1#3428, s_nationkey_prf#3421 AS s_nationkey_prf_1#3429, s_suppkey_prf#3422 AS s_suppkey_prf_1#3430, s_name_prf#3423 AS s_name_prf_1#3431, s_acctbal_prf#3424 AS s_acctbal_prf_1#3432, s_comment_prf#3425 AS s_comment_prf_1#3433]
            +- Relation[s_phone_prf#3418,rid#3419,s_address_prf#3420,s_nationkey_prf#3421,s_suppkey_prf#3422,s_name_prf#3423,s_acctbal_prf#3424,s_comment_prf#3425] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=10000
Elapsed time: 189ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/15 03:41:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:41:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3466L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 03:41:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3466L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#3468 AS l_returnflag_prf_0#3487, l_orderkey_and_l_linenumber_prf#3469 AS l_orderkey_and_l_linenumber_prf_0#3488, l_comment_prf#3470 AS l_comment_prf_0#3489, l_linestatus_prf#3471 AS l_linestatus_prf_0#3490, rid#3472 AS rid_0#3491, l_shipmode_prf#3473 AS l_shipmode_prf_0#3492, l_shipinstruct_prf#3474 AS l_shipinstruct_prf_0#3493, l_quantity_prf#3475 AS l_quantity_prf_0#3494, l_receiptdate_prf#3476 AS l_receiptdate_prf_0#3495, l_linenumber_prf#3477 AS l_linenumber_prf_0#3496, l_tax_prf#3478 AS l_tax_prf_0#3497, l_shipdate_prf#3479 AS l_shipdate_prf_0#3498, l_extendedprice_prf#3480 AS l_extendedprice_prf_0#3499, l_partkey_prf#3481 AS l_partkey_prf_0#3500, l_discount_prf#3482 AS l_discount_prf_0#3501, l_partkey_and_l_suppkey_prf#3483 AS l_partkey_and_l_suppkey_prf_0#3502, l_commitdate_prf#3484 AS l_commitdate_prf_0#3503, l_suppkey_prf#3485 AS l_suppkey_prf_0#3504, l_orderkey_prf#3486 AS l_orderkey_prf_0#3505]
         :  +- Relation[l_returnflag_prf#3468,l_orderkey_and_l_linenumber_prf#3469,l_comment_prf#3470,l_linestatus_prf#3471,rid#3472,l_shipmode_prf#3473,l_shipinstruct_prf#3474,l_quantity_prf#3475,l_receiptdate_prf#3476,l_linenumber_prf#3477,l_tax_prf#3478,l_shipdate_prf#3479,l_extendedprice_prf#3480,l_partkey_prf#3481,l_discount_prf#3482,l_partkey_and_l_suppkey_prf#3483,l_commitdate_prf#3484,l_suppkey_prf#3485,l_orderkey_prf#3486] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3506]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1749,value#1750] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 13730ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/15 03:42:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:42:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3554L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 03:42:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3554L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#3576]
         :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3568: string
         :     :- Project [p_comment_prf#3556 AS p_comment_prf_0#3566, p_name_prf#3557 AS p_name_prf_0#3567, rid#3558 AS rid_0#3568, p_type_prf#3559 AS p_type_prf_0#3569, p_retailprice_prf#3560 AS p_retailprice_prf_0#3570, p_mfgr_prf#3561 AS p_mfgr_prf_0#3571, p_container_prf#3562 AS p_container_prf_0#3572, p_brand_prf#3563 AS p_brand_prf_0#3573, p_size_prf#3564 AS p_size_prf_0#3574, p_partkey_prf#3565 AS p_partkey_prf_0#3575]
         :     :  +- Relation[p_comment_prf#3556,p_name_prf#3557,rid#3558,p_type_prf#3559,p_retailprice_prf#3560,p_mfgr_prf#3561,p_container_prf#3562,p_brand_prf#3563,p_size_prf#3564,p_partkey_prf#3565] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3577 AS l_returnflag_prf_1#3596, l_orderkey_and_l_linenumber_prf#3578 AS l_orderkey_and_l_linenumber_prf_1#3597, l_comment_prf#3579 AS l_comment_prf_1#3598, l_linestatus_prf#3580 AS l_linestatus_prf_1#3599, rid#3581 AS rid_1#3600, l_shipmode_prf#3582 AS l_shipmode_prf_1#3601, l_shipinstruct_prf#3583 AS l_shipinstruct_prf_1#3602, l_quantity_prf#3584 AS l_quantity_prf_1#3603, l_receiptdate_prf#3585 AS l_receiptdate_prf_1#3604, l_linenumber_prf#3586 AS l_linenumber_prf_1#3605, l_tax_prf#3587 AS l_tax_prf_1#3606, l_shipdate_prf#3588 AS l_shipdate_prf_1#3607, l_extendedprice_prf#3589 AS l_extendedprice_prf_1#3608, l_partkey_prf#3590 AS l_partkey_prf_1#3609, l_discount_prf#3591 AS l_discount_prf_1#3610, l_partkey_and_l_suppkey_prf#3592 AS l_partkey_and_l_suppkey_prf_1#3611, l_commitdate_prf#3593 AS l_commitdate_prf_1#3612, l_suppkey_prf#3594 AS l_suppkey_prf_1#3613, l_orderkey_prf#3595 AS l_orderkey_prf_1#3614]
            +- Relation[l_returnflag_prf#3577,l_orderkey_and_l_linenumber_prf#3578,l_comment_prf#3579,l_linestatus_prf#3580,rid#3581,l_shipmode_prf#3582,l_shipinstruct_prf#3583,l_quantity_prf#3584,l_receiptdate_prf#3585,l_linenumber_prf#3586,l_tax_prf#3587,l_shipdate_prf#3588,l_extendedprice_prf#3589,l_partkey_prf#3590,l_discount_prf#3591,l_partkey_and_l_suppkey_prf#3592,l_commitdate_prf#3593,l_suppkey_prf#3594,l_orderkey_prf#3595] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 93948ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/15 03:43:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:43:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3661L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/15 03:43:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3661L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#3683]
         :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#3675: string
         :     :- Project [p_comment_prf#3663 AS p_comment_prf_0#3673, p_name_prf#3664 AS p_name_prf_0#3674, rid#3665 AS rid_0#3675, p_type_prf#3666 AS p_type_prf_0#3676, p_retailprice_prf#3667 AS p_retailprice_prf_0#3677, p_mfgr_prf#3668 AS p_mfgr_prf_0#3678, p_container_prf#3669 AS p_container_prf_0#3679, p_brand_prf#3670 AS p_brand_prf_0#3680, p_size_prf#3671 AS p_size_prf_0#3681, p_partkey_prf#3672 AS p_partkey_prf_0#3682]
         :     :  +- Relation[p_comment_prf#3663,p_name_prf#3664,rid#3665,p_type_prf#3666,p_retailprice_prf#3667,p_mfgr_prf#3668,p_container_prf#3669,p_brand_prf#3670,p_size_prf#3671,p_partkey_prf#3672] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#3684 AS ps_partkey_and_ps_suppkey_prf_1#3691, rid#3685 AS rid_1#3692, ps_availqty_prf#3686 AS ps_availqty_prf_1#3693, ps_comment_prf#3687 AS ps_comment_prf_1#3694, ps_partkey_prf#3688 AS ps_partkey_prf_1#3695, ps_supplycost_prf#3689 AS ps_supplycost_prf_1#3696, ps_suppkey_prf#3690 AS ps_suppkey_prf_1#3697]
            +- Relation[ps_partkey_and_ps_suppkey_prf#3684,rid#3685,ps_availqty_prf#3686,ps_comment_prf#3687,ps_partkey_prf#3688,ps_supplycost_prf#3689,ps_suppkey_prf#3690] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 31752ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/15 03:44:12 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:44:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3739L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 03:44:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3739L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#3757]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#3750: string
         :     :- Project [s_phone_prf#3741 AS s_phone_prf_0#3749, rid#3742 AS rid_0#3750, s_address_prf#3743 AS s_address_prf_0#3751, s_nationkey_prf#3744 AS s_nationkey_prf_0#3752, s_suppkey_prf#3745 AS s_suppkey_prf_0#3753, s_name_prf#3746 AS s_name_prf_0#3754, s_acctbal_prf#3747 AS s_acctbal_prf_0#3755, s_comment_prf#3748 AS s_comment_prf_0#3756]
         :     :  +- Relation[s_phone_prf#3741,rid#3742,s_address_prf#3743,s_nationkey_prf#3744,s_suppkey_prf#3745,s_name_prf#3746,s_acctbal_prf#3747,s_comment_prf#3748] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1503) AS rid_2#3772]
            :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_1#3766: string
            :     :- Project [ps_partkey_and_ps_suppkey_prf#3758 AS ps_partkey_and_ps_suppkey_prf_1#3765, rid#3759 AS rid_1#3766, ps_availqty_prf#3760 AS ps_availqty_prf_1#3767, ps_comment_prf#3761 AS ps_comment_prf_1#3768, ps_partkey_prf#3762 AS ps_partkey_prf_1#3769, ps_supplycost_prf#3763 AS ps_supplycost_prf_1#3770, ps_suppkey_prf#3764 AS ps_suppkey_prf_1#3771]
            :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#3758,rid#3759,ps_availqty_prf#3760,ps_comment_prf#3761,ps_partkey_prf#3762,ps_supplycost_prf#3763,ps_suppkey_prf#3764] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#3773 AS p_comment_prf_2#3783, p_name_prf#3774 AS p_name_prf_2#3784, rid#3775 AS rid_2#3785, p_type_prf#3776 AS p_type_prf_2#3786, p_retailprice_prf#3777 AS p_retailprice_prf_2#3787, p_mfgr_prf#3778 AS p_mfgr_prf_2#3788, p_container_prf#3779 AS p_container_prf_2#3789, p_brand_prf#3780 AS p_brand_prf_2#3790, p_size_prf#3781 AS p_size_prf_2#3791, p_partkey_prf#3782 AS p_partkey_prf_2#3792]
               +- Relation[p_comment_prf#3773,p_name_prf#3774,rid#3775,p_type_prf#3776,p_retailprice_prf#3777,p_mfgr_prf#3778,p_container_prf#3779,p_brand_prf#3780,p_size_prf#3781,p_partkey_prf#3782] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 61164ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/15 03:45:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:45:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3853L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 03:45:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3853L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#3893]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#3878: string
         :  :  :     :- Project [l_returnflag_prf#3855 AS l_returnflag_prf_0#3874, l_orderkey_and_l_linenumber_prf#3856 AS l_orderkey_and_l_linenumber_prf_0#3875, l_comment_prf#3857 AS l_comment_prf_0#3876, l_linestatus_prf#3858 AS l_linestatus_prf_0#3877, rid#3859 AS rid_0#3878, l_shipmode_prf#3860 AS l_shipmode_prf_0#3879, l_shipinstruct_prf#3861 AS l_shipinstruct_prf_0#3880, l_quantity_prf#3862 AS l_quantity_prf_0#3881, l_receiptdate_prf#3863 AS l_receiptdate_prf_0#3882, l_linenumber_prf#3864 AS l_linenumber_prf_0#3883, l_tax_prf#3865 AS l_tax_prf_0#3884, l_shipdate_prf#3866 AS l_shipdate_prf_0#3885, l_extendedprice_prf#3867 AS l_extendedprice_prf_0#3886, l_partkey_prf#3868 AS l_partkey_prf_0#3887, l_discount_prf#3869 AS l_discount_prf_0#3888, l_partkey_and_l_suppkey_prf#3870 AS l_partkey_and_l_suppkey_prf_0#3889, l_commitdate_prf#3871 AS l_commitdate_prf_0#3890, l_suppkey_prf#3872 AS l_suppkey_prf_0#3891, l_orderkey_prf#3873 AS l_orderkey_prf_0#3892]
         :  :  :     :  +- Relation[l_returnflag_prf#3855,l_orderkey_and_l_linenumber_prf#3856,l_comment_prf#3857,l_linestatus_prf#3858,rid#3859,l_shipmode_prf#3860,l_shipinstruct_prf#3861,l_quantity_prf#3862,l_receiptdate_prf#3863,l_linenumber_prf#3864,l_tax_prf#3865,l_shipdate_prf#3866,l_extendedprice_prf#3867,l_partkey_prf#3868,l_discount_prf#3869,l_partkey_and_l_suppkey_prf#3870,l_commitdate_prf#3871,l_suppkey_prf#3872,l_orderkey_prf#3873] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#3894 AS p_comment_prf_1#3904, p_name_prf#3895 AS p_name_prf_1#3905, rid#3896 AS rid_1#3906, p_type_prf#3897 AS p_type_prf_1#3907, p_retailprice_prf#3898 AS p_retailprice_prf_1#3908, p_mfgr_prf#3899 AS p_mfgr_prf_1#3909, p_container_prf#3900 AS p_container_prf_1#3910, p_brand_prf#3901 AS p_brand_prf_1#3911, p_size_prf#3902 AS p_size_prf_1#3912, p_partkey_prf#3903 AS p_partkey_prf_1#3913]
         :  :     +- Relation[p_comment_prf#3894,p_name_prf#3895,rid#3896,p_type_prf#3897,p_retailprice_prf#3898,p_mfgr_prf#3899,p_container_prf#3900,p_brand_prf#3901,p_size_prf#3902,p_partkey_prf#3903] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1503) AS rid_2#3934]
         :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3933]
         :        :  +- Relation[l_returnflag_prf#3914,l_orderkey_and_l_linenumber_prf#3915,l_comment_prf#3916,l_linestatus_prf#3917,rid#3918,l_shipmode_prf#3919,l_shipinstruct_prf#3920,l_quantity_prf#3921,l_receiptdate_prf#3922,l_linenumber_prf#3923,l_tax_prf#3924,l_shipdate_prf#3925,l_extendedprice_prf#3926,l_partkey_prf#3927,l_discount_prf#3928,l_partkey_and_l_suppkey_prf#3929,l_commitdate_prf#3930,l_suppkey_prf#3931,l_orderkey_prf#3932] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3935 AS s_phone_prf_2#3943, rid#3936 AS rid_2#3944, s_address_prf#3937 AS s_address_prf_2#3945, s_nationkey_prf#3938 AS s_nationkey_prf_2#3946, s_suppkey_prf#3939 AS s_suppkey_prf_2#3947, s_name_prf#3940 AS s_name_prf_2#3948, s_acctbal_prf#3941 AS s_acctbal_prf_2#3949, s_comment_prf#3942 AS s_comment_prf_2#3950]
            +- Relation[s_phone_prf#3935,rid#3936,s_address_prf#3937,s_nationkey_prf#3938,s_suppkey_prf#3939,s_name_prf#3940,s_acctbal_prf#3941,s_comment_prf#3942] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 221819ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/15 03:48:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:48:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4008L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 03:48:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4008L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#4028]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4020: string
         :     :- Project [c_acctbal_prf#4010 AS c_acctbal_prf_0#4019, rid#4011 AS rid_0#4020, c_name_prf#4012 AS c_name_prf_0#4021, c_nationkey_prf#4013 AS c_nationkey_prf_0#4022, c_custkey_prf#4014 AS c_custkey_prf_0#4023, c_comment_prf#4015 AS c_comment_prf_0#4024, c_address_prf#4016 AS c_address_prf_0#4025, c_mktsegment_prf#4017 AS c_mktsegment_prf_0#4026, c_phone_prf#4018 AS c_phone_prf_0#4027]
         :     :  +- Relation[c_acctbal_prf#4010,rid#4011,c_name_prf#4012,c_nationkey_prf#4013,c_custkey_prf#4014,c_comment_prf#4015,c_address_prf#4016,c_mktsegment_prf#4017,c_phone_prf#4018] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4029 AS o_shippriority_prf_1#4039, rid#4030 AS rid_1#4040, o_orderdate_prf#4031 AS o_orderdate_prf_1#4041, o_custkey_prf#4032 AS o_custkey_prf_1#4042, o_orderpriority_prf#4033 AS o_orderpriority_prf_1#4043, o_clerk_prf#4034 AS o_clerk_prf_1#4044, o_orderstatus_prf#4035 AS o_orderstatus_prf_1#4045, o_totalprice_prf#4036 AS o_totalprice_prf_1#4046, o_orderkey_prf#4037 AS o_orderkey_prf_1#4047, o_comment_prf#4038 AS o_comment_prf_1#4048]
            +- Relation[o_shippriority_prf#4029,rid#4030,o_orderdate_prf#4031,o_custkey_prf#4032,o_orderpriority_prf#4033,o_clerk_prf#4034,o_orderstatus_prf#4035,o_totalprice_prf#4036,o_orderkey_prf#4037,o_comment_prf#4038] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1500000
Elapsed time: 40430ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/15 03:49:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:49:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4083L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/15 03:49:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4083L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#4095]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#4090: string
         :     :- Project [rid#4085 AS rid_0#4090, n_regionkey_prf#4086 AS n_regionkey_prf_0#4091, n_nationkey_prf#4087 AS n_nationkey_prf_0#4092, n_name_prf#4088 AS n_name_prf_0#4093, n_comment_prf#4089 AS n_comment_prf_0#4094]
         :     :  +- Relation[rid#4085,n_regionkey_prf#4086,n_nationkey_prf#4087,n_name_prf#4088,n_comment_prf#4089] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4096 AS c_acctbal_prf_1#4105, rid#4097 AS rid_1#4106, c_name_prf#4098 AS c_name_prf_1#4107, c_nationkey_prf#4099 AS c_nationkey_prf_1#4108, c_custkey_prf#4100 AS c_custkey_prf_1#4109, c_comment_prf#4101 AS c_comment_prf_1#4110, c_address_prf#4102 AS c_address_prf_1#4111, c_mktsegment_prf#4103 AS c_mktsegment_prf_1#4112, c_phone_prf#4104 AS c_phone_prf_1#4113]
            +- Relation[c_acctbal_prf#4096,rid#4097,c_name_prf#4098,c_nationkey_prf#4099,c_custkey_prf#4100,c_comment_prf#4101,c_address_prf#4102,c_mktsegment_prf#4103,c_phone_prf#4104] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=150000
Elapsed time: 1938ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/15 03:49:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:49:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4156L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 03:49:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4156L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#4178]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#4169: string
         :     :- Project [o_shippriority_prf#4158 AS o_shippriority_prf_0#4168, rid#4159 AS rid_0#4169, o_orderdate_prf#4160 AS o_orderdate_prf_0#4170, o_custkey_prf#4161 AS o_custkey_prf_0#4171, o_orderpriority_prf#4162 AS o_orderpriority_prf_0#4172, o_clerk_prf#4163 AS o_clerk_prf_0#4173, o_orderstatus_prf#4164 AS o_orderstatus_prf_0#4174, o_totalprice_prf#4165 AS o_totalprice_prf_0#4175, o_orderkey_prf#4166 AS o_orderkey_prf_0#4176, o_comment_prf#4167 AS o_comment_prf_0#4177]
         :     :  +- Relation[o_shippriority_prf#4158,rid#4159,o_orderdate_prf#4160,o_custkey_prf#4161,o_orderpriority_prf#4162,o_clerk_prf#4163,o_orderstatus_prf#4164,o_totalprice_prf#4165,o_orderkey_prf#4166,o_comment_prf#4167] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#4179 AS l_returnflag_prf_1#4198, l_orderkey_and_l_linenumber_prf#4180 AS l_orderkey_and_l_linenumber_prf_1#4199, l_comment_prf#4181 AS l_comment_prf_1#4200, l_linestatus_prf#4182 AS l_linestatus_prf_1#4201, rid#4183 AS rid_1#4202, l_shipmode_prf#4184 AS l_shipmode_prf_1#4203, l_shipinstruct_prf#4185 AS l_shipinstruct_prf_1#4204, l_quantity_prf#4186 AS l_quantity_prf_1#4205, l_receiptdate_prf#4187 AS l_receiptdate_prf_1#4206, l_linenumber_prf#4188 AS l_linenumber_prf_1#4207, l_tax_prf#4189 AS l_tax_prf_1#4208, l_shipdate_prf#4190 AS l_shipdate_prf_1#4209, l_extendedprice_prf#4191 AS l_extendedprice_prf_1#4210, l_partkey_prf#4192 AS l_partkey_prf_1#4211, l_discount_prf#4193 AS l_discount_prf_1#4212, l_partkey_and_l_suppkey_prf#4194 AS l_partkey_and_l_suppkey_prf_1#4213, l_commitdate_prf#4195 AS l_commitdate_prf_1#4214, l_suppkey_prf#4196 AS l_suppkey_prf_1#4215, l_orderkey_prf#4197 AS l_orderkey_prf_1#4216]
            :  +- Relation[l_returnflag_prf#4179,l_orderkey_and_l_linenumber_prf#4180,l_comment_prf#4181,l_linestatus_prf#4182,rid#4183,l_shipmode_prf#4184,l_shipinstruct_prf#4185,l_quantity_prf#4186,l_receiptdate_prf#4187,l_linenumber_prf#4188,l_tax_prf#4189,l_shipdate_prf#4190,l_extendedprice_prf#4191,l_partkey_prf#4192,l_discount_prf#4193,l_partkey_and_l_suppkey_prf#4194,l_commitdate_prf#4195,l_suppkey_prf#4196,l_orderkey_prf#4197] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4217]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1749,value#1750] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 196268ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/15 03:52:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:52:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4275L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 03:52:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4275L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#4315]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4300: string
         :     :- Project [l_returnflag_prf#4277 AS l_returnflag_prf_0#4296, l_orderkey_and_l_linenumber_prf#4278 AS l_orderkey_and_l_linenumber_prf_0#4297, l_comment_prf#4279 AS l_comment_prf_0#4298, l_linestatus_prf#4280 AS l_linestatus_prf_0#4299, rid#4281 AS rid_0#4300, l_shipmode_prf#4282 AS l_shipmode_prf_0#4301, l_shipinstruct_prf#4283 AS l_shipinstruct_prf_0#4302, l_quantity_prf#4284 AS l_quantity_prf_0#4303, l_receiptdate_prf#4285 AS l_receiptdate_prf_0#4304, l_linenumber_prf#4286 AS l_linenumber_prf_0#4305, l_tax_prf#4287 AS l_tax_prf_0#4306, l_shipdate_prf#4288 AS l_shipdate_prf_0#4307, l_extendedprice_prf#4289 AS l_extendedprice_prf_0#4308, l_partkey_prf#4290 AS l_partkey_prf_0#4309, l_discount_prf#4291 AS l_discount_prf_0#4310, l_partkey_and_l_suppkey_prf#4292 AS l_partkey_and_l_suppkey_prf_0#4311, l_commitdate_prf#4293 AS l_commitdate_prf_0#4312, l_suppkey_prf#4294 AS l_suppkey_prf_0#4313, l_orderkey_prf#4295 AS l_orderkey_prf_0#4314]
         :     :  +- Relation[l_returnflag_prf#4277,l_orderkey_and_l_linenumber_prf#4278,l_comment_prf#4279,l_linestatus_prf#4280,rid#4281,l_shipmode_prf#4282,l_shipinstruct_prf#4283,l_quantity_prf#4284,l_receiptdate_prf#4285,l_linenumber_prf#4286,l_tax_prf#4287,l_shipdate_prf#4288,l_extendedprice_prf#4289,l_partkey_prf#4290,l_discount_prf#4291,l_partkey_and_l_suppkey_prf#4292,l_commitdate_prf#4293,l_suppkey_prf#4294,l_orderkey_prf#4295] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4316 AS o_shippriority_prf_1#4326, rid#4317 AS rid_1#4327, o_orderdate_prf#4318 AS o_orderdate_prf_1#4328, o_custkey_prf#4319 AS o_custkey_prf_1#4329, o_orderpriority_prf#4320 AS o_orderpriority_prf_1#4330, o_clerk_prf#4321 AS o_clerk_prf_1#4331, o_orderstatus_prf#4322 AS o_orderstatus_prf_1#4332, o_totalprice_prf#4323 AS o_totalprice_prf_1#4333, o_orderkey_prf#4324 AS o_orderkey_prf_1#4334, o_comment_prf#4325 AS o_comment_prf_1#4335]
            +- Relation[o_shippriority_prf#4316,rid#4317,o_orderdate_prf#4318,o_custkey_prf#4319,o_orderpriority_prf#4320,o_clerk_prf#4321,o_orderstatus_prf#4322,o_totalprice_prf#4323,o_orderkey_prf#4324,o_comment_prf#4325] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 114874ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/15 03:54:48 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:54:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4401L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/15 03:54:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4401L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#4441]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4426: string
         :     :- Project [l_returnflag_prf#4403 AS l_returnflag_prf_0#4422, l_orderkey_and_l_linenumber_prf#4404 AS l_orderkey_and_l_linenumber_prf_0#4423, l_comment_prf#4405 AS l_comment_prf_0#4424, l_linestatus_prf#4406 AS l_linestatus_prf_0#4425, rid#4407 AS rid_0#4426, l_shipmode_prf#4408 AS l_shipmode_prf_0#4427, l_shipinstruct_prf#4409 AS l_shipinstruct_prf_0#4428, l_quantity_prf#4410 AS l_quantity_prf_0#4429, l_receiptdate_prf#4411 AS l_receiptdate_prf_0#4430, l_linenumber_prf#4412 AS l_linenumber_prf_0#4431, l_tax_prf#4413 AS l_tax_prf_0#4432, l_shipdate_prf#4414 AS l_shipdate_prf_0#4433, l_extendedprice_prf#4415 AS l_extendedprice_prf_0#4434, l_partkey_prf#4416 AS l_partkey_prf_0#4435, l_discount_prf#4417 AS l_discount_prf_0#4436, l_partkey_and_l_suppkey_prf#4418 AS l_partkey_and_l_suppkey_prf_0#4437, l_commitdate_prf#4419 AS l_commitdate_prf_0#4438, l_suppkey_prf#4420 AS l_suppkey_prf_0#4439, l_orderkey_prf#4421 AS l_orderkey_prf_0#4440]
         :     :  +- Relation[l_returnflag_prf#4403,l_orderkey_and_l_linenumber_prf#4404,l_comment_prf#4405,l_linestatus_prf#4406,rid#4407,l_shipmode_prf#4408,l_shipinstruct_prf#4409,l_quantity_prf#4410,l_receiptdate_prf#4411,l_linenumber_prf#4412,l_tax_prf#4413,l_shipdate_prf#4414,l_extendedprice_prf#4415,l_partkey_prf#4416,l_discount_prf#4417,l_partkey_and_l_suppkey_prf#4418,l_commitdate_prf#4419,l_suppkey_prf#4420,l_orderkey_prf#4421] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1503) AS rid_2#4462]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#4453: string
            :     :- Project [o_shippriority_prf#4442 AS o_shippriority_prf_1#4452, rid#4443 AS rid_1#4453, o_orderdate_prf#4444 AS o_orderdate_prf_1#4454, o_custkey_prf#4445 AS o_custkey_prf_1#4455, o_orderpriority_prf#4446 AS o_orderpriority_prf_1#4456, o_clerk_prf#4447 AS o_clerk_prf_1#4457, o_orderstatus_prf#4448 AS o_orderstatus_prf_1#4458, o_totalprice_prf#4449 AS o_totalprice_prf_1#4459, o_orderkey_prf#4450 AS o_orderkey_prf_1#4460, o_comment_prf#4451 AS o_comment_prf_1#4461]
            :     :  +- Relation[o_shippriority_prf#4442,rid#4443,o_orderdate_prf#4444,o_custkey_prf#4445,o_orderpriority_prf#4446,o_clerk_prf#4447,o_orderstatus_prf#4448,o_totalprice_prf#4449,o_orderkey_prf#4450,o_comment_prf#4451] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4463 AS c_acctbal_prf_2#4472, rid#4464 AS rid_2#4473, c_name_prf#4465 AS c_name_prf_2#4474, c_nationkey_prf#4466 AS c_nationkey_prf_2#4475, c_custkey_prf#4467 AS c_custkey_prf_2#4476, c_comment_prf#4468 AS c_comment_prf_2#4477, c_address_prf#4469 AS c_address_prf_2#4478, c_mktsegment_prf#4470 AS c_mktsegment_prf_2#4479, c_phone_prf#4471 AS c_phone_prf_2#4480]
               +- Relation[c_acctbal_prf#4463,rid#4464,c_name_prf#4465,c_nationkey_prf#4466,c_custkey_prf#4467,c_comment_prf#4468,c_address_prf#4469,c_mktsegment_prf#4470,c_phone_prf#4471] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 148070ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/15 03:57:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:57:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4545L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 03:57:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4545L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#4563]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#4556: string
         :     :- Project [s_phone_prf#4547 AS s_phone_prf_0#4555, rid#4548 AS rid_0#4556, s_address_prf#4549 AS s_address_prf_0#4557, s_nationkey_prf#4550 AS s_nationkey_prf_0#4558, s_suppkey_prf#4551 AS s_suppkey_prf_0#4559, s_name_prf#4552 AS s_name_prf_0#4560, s_acctbal_prf#4553 AS s_acctbal_prf_0#4561, s_comment_prf#4554 AS s_comment_prf_0#4562]
         :     :  +- Relation[s_phone_prf#4547,rid#4548,s_address_prf#4549,s_nationkey_prf#4550,s_suppkey_prf#4551,s_name_prf#4552,s_acctbal_prf#4553,s_comment_prf#4554] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4564 AS l_returnflag_prf_1#4583, l_orderkey_and_l_linenumber_prf#4565 AS l_orderkey_and_l_linenumber_prf_1#4584, l_comment_prf#4566 AS l_comment_prf_1#4585, l_linestatus_prf#4567 AS l_linestatus_prf_1#4586, rid#4568 AS rid_1#4587, l_shipmode_prf#4569 AS l_shipmode_prf_1#4588, l_shipinstruct_prf#4570 AS l_shipinstruct_prf_1#4589, l_quantity_prf#4571 AS l_quantity_prf_1#4590, l_receiptdate_prf#4572 AS l_receiptdate_prf_1#4591, l_linenumber_prf#4573 AS l_linenumber_prf_1#4592, l_tax_prf#4574 AS l_tax_prf_1#4593, l_shipdate_prf#4575 AS l_shipdate_prf_1#4594, l_extendedprice_prf#4576 AS l_extendedprice_prf_1#4595, l_partkey_prf#4577 AS l_partkey_prf_1#4596, l_discount_prf#4578 AS l_discount_prf_1#4597, l_partkey_and_l_suppkey_prf#4579 AS l_partkey_and_l_suppkey_prf_1#4598, l_commitdate_prf#4580 AS l_commitdate_prf_1#4599, l_suppkey_prf#4581 AS l_suppkey_prf_1#4600, l_orderkey_prf#4582 AS l_orderkey_prf_1#4601]
            +- Relation[l_returnflag_prf#4564,l_orderkey_and_l_linenumber_prf#4565,l_comment_prf#4566,l_linestatus_prf#4567,rid#4568,l_shipmode_prf#4569,l_shipinstruct_prf#4570,l_quantity_prf#4571,l_receiptdate_prf#4572,l_linenumber_prf#4573,l_tax_prf#4574,l_shipdate_prf#4575,l_extendedprice_prf#4576,l_partkey_prf#4577,l_discount_prf#4578,l_partkey_and_l_suppkey_prf#4579,l_commitdate_prf#4580,l_suppkey_prf#4581,l_orderkey_prf#4582] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 87118ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/15 03:58:43 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:58:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4665L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 03:58:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4665L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#4685]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4677: string
         :     :- Project [c_acctbal_prf#4667 AS c_acctbal_prf_0#4676, rid#4668 AS rid_0#4677, c_name_prf#4669 AS c_name_prf_0#4678, c_nationkey_prf#4670 AS c_nationkey_prf_0#4679, c_custkey_prf#4671 AS c_custkey_prf_0#4680, c_comment_prf#4672 AS c_comment_prf_0#4681, c_address_prf#4673 AS c_address_prf_0#4682, c_mktsegment_prf#4674 AS c_mktsegment_prf_0#4683, c_phone_prf#4675 AS c_phone_prf_0#4684]
         :     :  +- Relation[c_acctbal_prf#4667,rid#4668,c_name_prf#4669,c_nationkey_prf#4670,c_custkey_prf#4671,c_comment_prf#4672,c_address_prf#4673,c_mktsegment_prf#4674,c_phone_prf#4675] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1503) AS rid_2#4706]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#4697: string
            :     :- Project [o_shippriority_prf#4686 AS o_shippriority_prf_1#4696, rid#4687 AS rid_1#4697, o_orderdate_prf#4688 AS o_orderdate_prf_1#4698, o_custkey_prf#4689 AS o_custkey_prf_1#4699, o_orderpriority_prf#4690 AS o_orderpriority_prf_1#4700, o_clerk_prf#4691 AS o_clerk_prf_1#4701, o_orderstatus_prf#4692 AS o_orderstatus_prf_1#4702, o_totalprice_prf#4693 AS o_totalprice_prf_1#4703, o_orderkey_prf#4694 AS o_orderkey_prf_1#4704, o_comment_prf#4695 AS o_comment_prf_1#4705]
            :     :  +- Relation[o_shippriority_prf#4686,rid#4687,o_orderdate_prf#4688,o_custkey_prf#4689,o_orderpriority_prf#4690,o_clerk_prf#4691,o_orderstatus_prf#4692,o_totalprice_prf#4693,o_orderkey_prf#4694,o_comment_prf#4695] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4707 AS l_returnflag_prf_2#4726, l_orderkey_and_l_linenumber_prf#4708 AS l_orderkey_and_l_linenumber_prf_2#4727, l_comment_prf#4709 AS l_comment_prf_2#4728, l_linestatus_prf#4710 AS l_linestatus_prf_2#4729, rid#4711 AS rid_2#4730, l_shipmode_prf#4712 AS l_shipmode_prf_2#4731, l_shipinstruct_prf#4713 AS l_shipinstruct_prf_2#4732, l_quantity_prf#4714 AS l_quantity_prf_2#4733, l_receiptdate_prf#4715 AS l_receiptdate_prf_2#4734, l_linenumber_prf#4716 AS l_linenumber_prf_2#4735, l_tax_prf#4717 AS l_tax_prf_2#4736, l_shipdate_prf#4718 AS l_shipdate_prf_2#4737, l_extendedprice_prf#4719 AS l_extendedprice_prf_2#4738, l_partkey_prf#4720 AS l_partkey_prf_2#4739, l_discount_prf#4721 AS l_discount_prf_2#4740, l_partkey_and_l_suppkey_prf#4722 AS l_partkey_and_l_suppkey_prf_2#4741, l_commitdate_prf#4723 AS l_commitdate_prf_2#4742, l_suppkey_prf#4724 AS l_suppkey_prf_2#4743, l_orderkey_prf#4725 AS l_orderkey_prf_2#4744]
               +- Relation[l_returnflag_prf#4707,l_orderkey_and_l_linenumber_prf#4708,l_comment_prf#4709,l_linestatus_prf#4710,rid#4711,l_shipmode_prf#4712,l_shipinstruct_prf#4713,l_quantity_prf#4714,l_receiptdate_prf#4715,l_linenumber_prf#4716,l_tax_prf#4717,l_shipdate_prf#4718,l_extendedprice_prf#4719,l_partkey_prf#4720,l_discount_prf#4721,l_partkey_and_l_suppkey_prf#4722,l_commitdate_prf#4723,l_suppkey_prf#4724,l_orderkey_prf#4725] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 233393ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/15 04:02:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 04:02:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4811L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 04:02:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4811L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#4852]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4836: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#4813 AS l_returnflag_prf_0#4832, l_orderkey_and_l_linenumber_prf#4814 AS l_orderkey_and_l_linenumber_prf_0#4833, l_comment_prf#4815 AS l_comment_prf_0#4834, l_linestatus_prf#4816 AS l_linestatus_prf_0#4835, rid#4817 AS rid_0#4836, l_shipmode_prf#4818 AS l_shipmode_prf_0#4837, l_shipinstruct_prf#4819 AS l_shipinstruct_prf_0#4838, l_quantity_prf#4820 AS l_quantity_prf_0#4839, l_receiptdate_prf#4821 AS l_receiptdate_prf_0#4840, l_linenumber_prf#4822 AS l_linenumber_prf_0#4841, l_tax_prf#4823 AS l_tax_prf_0#4842, l_shipdate_prf#4824 AS l_shipdate_prf_0#4843, l_extendedprice_prf#4825 AS l_extendedprice_prf_0#4844, l_partkey_prf#4826 AS l_partkey_prf_0#4845, l_discount_prf#4827 AS l_discount_prf_0#4846, l_partkey_and_l_suppkey_prf#4828 AS l_partkey_and_l_suppkey_prf_0#4847, l_commitdate_prf#4829 AS l_commitdate_prf_0#4848, l_suppkey_prf#4830 AS l_suppkey_prf_0#4849, l_orderkey_prf#4831 AS l_orderkey_prf_0#4850]
         :     :  :  +- Relation[l_returnflag_prf#4813,l_orderkey_and_l_linenumber_prf#4814,l_comment_prf#4815,l_linestatus_prf#4816,rid#4817,l_shipmode_prf#4818,l_shipinstruct_prf#4819,l_quantity_prf#4820,l_receiptdate_prf#4821,l_linenumber_prf#4822,l_tax_prf#4823,l_shipdate_prf#4824,l_extendedprice_prf#4825,l_partkey_prf#4826,l_discount_prf#4827,l_partkey_and_l_suppkey_prf#4828,l_commitdate_prf#4829,l_suppkey_prf#4830,l_orderkey_prf#4831] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4851]
         :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :        +- Relation[label#1749,value#1750] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4853 AS o_shippriority_prf_1#4863, rid#4854 AS rid_1#4864, o_orderdate_prf#4855 AS o_orderdate_prf_1#4865, o_custkey_prf#4856 AS o_custkey_prf_1#4866, o_orderpriority_prf#4857 AS o_orderpriority_prf_1#4867, o_clerk_prf#4858 AS o_clerk_prf_1#4868, o_orderstatus_prf#4859 AS o_orderstatus_prf_1#4869, o_totalprice_prf#4860 AS o_totalprice_prf_1#4870, o_orderkey_prf#4861 AS o_orderkey_prf_1#4871, o_comment_prf#4862 AS o_comment_prf_1#4872]
            +- Relation[o_shippriority_prf#4853,rid#4854,o_orderdate_prf#4855,o_custkey_prf#4856,o_orderpriority_prf#4857,o_clerk_prf#4858,o_orderstatus_prf#4859,o_totalprice_prf#4860,o_orderkey_prf#4861,o_comment_prf#4862] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 54755ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/15 04:03:31 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 04:03:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4937L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 04:03:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4937L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#4955]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#4948: string
         :     :- Project [s_phone_prf#4939 AS s_phone_prf_0#4947, rid#4940 AS rid_0#4948, s_address_prf#4941 AS s_address_prf_0#4949, s_nationkey_prf#4942 AS s_nationkey_prf_0#4950, s_suppkey_prf#4943 AS s_suppkey_prf_0#4951, s_name_prf#4944 AS s_name_prf_0#4952, s_acctbal_prf#4945 AS s_acctbal_prf_0#4953, s_comment_prf#4946 AS s_comment_prf_0#4954]
         :     :  +- Relation[s_phone_prf#4939,rid#4940,s_address_prf#4941,s_nationkey_prf#4942,s_suppkey_prf#4943,s_name_prf#4944,s_acctbal_prf#4945,s_comment_prf#4946] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1503) AS rid_2#4994]
            :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_1#4979: string
            :     :- Project [l_returnflag_prf#4956 AS l_returnflag_prf_1#4975, l_orderkey_and_l_linenumber_prf#4957 AS l_orderkey_and_l_linenumber_prf_1#4976, l_comment_prf#4958 AS l_comment_prf_1#4977, l_linestatus_prf#4959 AS l_linestatus_prf_1#4978, rid#4960 AS rid_1#4979, l_shipmode_prf#4961 AS l_shipmode_prf_1#4980, l_shipinstruct_prf#4962 AS l_shipinstruct_prf_1#4981, l_quantity_prf#4963 AS l_quantity_prf_1#4982, l_receiptdate_prf#4964 AS l_receiptdate_prf_1#4983, l_linenumber_prf#4965 AS l_linenumber_prf_1#4984, l_tax_prf#4966 AS l_tax_prf_1#4985, l_shipdate_prf#4967 AS l_shipdate_prf_1#4986, l_extendedprice_prf#4968 AS l_extendedprice_prf_1#4987, l_partkey_prf#4969 AS l_partkey_prf_1#4988, l_discount_prf#4970 AS l_discount_prf_1#4989, l_partkey_and_l_suppkey_prf#4971 AS l_partkey_and_l_suppkey_prf_1#4990, l_commitdate_prf#4972 AS l_commitdate_prf_1#4991, l_suppkey_prf#4973 AS l_suppkey_prf_1#4992, l_orderkey_prf#4974 AS l_orderkey_prf_1#4993]
            :     :  +- Relation[l_returnflag_prf#4956,l_orderkey_and_l_linenumber_prf#4957,l_comment_prf#4958,l_linestatus_prf#4959,rid#4960,l_shipmode_prf#4961,l_shipinstruct_prf#4962,l_quantity_prf#4963,l_receiptdate_prf#4964,l_linenumber_prf#4965,l_tax_prf#4966,l_shipdate_prf#4967,l_extendedprice_prf#4968,l_partkey_prf#4969,l_discount_prf#4970,l_partkey_and_l_suppkey_prf#4971,l_commitdate_prf#4972,l_suppkey_prf#4973,l_orderkey_prf#4974] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#4995 AS p_comment_prf_2#5005, p_name_prf#4996 AS p_name_prf_2#5006, rid#4997 AS rid_2#5007, p_type_prf#4998 AS p_type_prf_2#5008, p_retailprice_prf#4999 AS p_retailprice_prf_2#5009, p_mfgr_prf#5000 AS p_mfgr_prf_2#5010, p_container_prf#5001 AS p_container_prf_2#5011, p_brand_prf#5002 AS p_brand_prf_2#5012, p_size_prf#5003 AS p_size_prf_2#5013, p_partkey_prf#5004 AS p_partkey_prf_2#5014]
               +- Relation[p_comment_prf#4995,p_name_prf#4996,rid#4997,p_type_prf#4998,p_retailprice_prf#4999,p_mfgr_prf#5000,p_container_prf#5001,p_brand_prf#5002,p_size_prf#5003,p_partkey_prf#5004] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 185202ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/15 04:06:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 04:06:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5074L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/15 04:06:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5074L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_2#5094]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#5086: string
         :     :- Project [c_acctbal_prf#5076 AS c_acctbal_prf_0#5085, rid#5077 AS rid_0#5086, c_name_prf#5078 AS c_name_prf_0#5087, c_nationkey_prf#5079 AS c_nationkey_prf_0#5088, c_custkey_prf#5080 AS c_custkey_prf_0#5089, c_comment_prf#5081 AS c_comment_prf_0#5090, c_address_prf#5082 AS c_address_prf_0#5091, c_mktsegment_prf#5083 AS c_mktsegment_prf_0#5092, c_phone_prf#5084 AS c_phone_prf_0#5093]
         :     :  +- Relation[c_acctbal_prf#5076,rid#5077,c_name_prf#5078,c_nationkey_prf#5079,c_custkey_prf#5080,c_comment_prf#5081,c_address_prf#5082,c_mktsegment_prf#5083,c_phone_prf#5084] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1503) AS rid_2#5111]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#5104: string
            :     :- Project [s_phone_prf#5095 AS s_phone_prf_1#5103, rid#5096 AS rid_1#5104, s_address_prf#5097 AS s_address_prf_1#5105, s_nationkey_prf#5098 AS s_nationkey_prf_1#5106, s_suppkey_prf#5099 AS s_suppkey_prf_1#5107, s_name_prf#5100 AS s_name_prf_1#5108, s_acctbal_prf#5101 AS s_acctbal_prf_1#5109, s_comment_prf#5102 AS s_comment_prf_1#5110]
            :     :  +- Relation[s_phone_prf#5095,rid#5096,s_address_prf#5097,s_nationkey_prf#5098,s_suppkey_prf#5099,s_name_prf#5100,s_acctbal_prf#5101,s_comment_prf#5102] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [rid#5112 AS rid_2#5117, n_regionkey_prf#5113 AS n_regionkey_prf_2#5118, n_nationkey_prf#5114 AS n_nationkey_prf_2#5119, n_name_prf#5115 AS n_name_prf_2#5120, n_comment_prf#5116 AS n_comment_prf_2#5121]
               +- Relation[rid#5112,n_regionkey_prf#5113,n_nationkey_prf#5114,n_name_prf#5115,n_comment_prf#5116] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 42748ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/15 04:07:19 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 04:07:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5168L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 04:07:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5168L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#5190]
         :  :  :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#5182: string
         :  :  :     :- Project [p_comment_prf#5170 AS p_comment_prf_0#5180, p_name_prf#5171 AS p_name_prf_0#5181, rid#5172 AS rid_0#5182, p_type_prf#5173 AS p_type_prf_0#5183, p_retailprice_prf#5174 AS p_retailprice_prf_0#5184, p_mfgr_prf#5175 AS p_mfgr_prf_0#5185, p_container_prf#5176 AS p_container_prf_0#5186, p_brand_prf#5177 AS p_brand_prf_0#5187, p_size_prf#5178 AS p_size_prf_0#5188, p_partkey_prf#5179 AS p_partkey_prf_0#5189]
         :  :  :     :  +- Relation[p_comment_prf#5170,p_name_prf#5171,rid#5172,p_type_prf#5173,p_retailprice_prf#5174,p_mfgr_prf#5175,p_container_prf#5176,p_brand_prf#5177,p_size_prf#5178,p_partkey_prf#5179] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#5191 AS ps_partkey_and_ps_suppkey_prf_1#5198, rid#5192 AS rid_1#5199, ps_availqty_prf#5193 AS ps_availqty_prf_1#5200, ps_comment_prf#5194 AS ps_comment_prf_1#5201, ps_partkey_prf#5195 AS ps_partkey_prf_1#5202, ps_supplycost_prf#5196 AS ps_supplycost_prf_1#5203, ps_suppkey_prf#5197 AS ps_suppkey_prf_1#5204]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#5191,rid#5192,ps_availqty_prf#5193,ps_comment_prf#5194,ps_partkey_prf#5195,ps_supplycost_prf#5196,ps_suppkey_prf#5197] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1503) AS rid_2#5213]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5212]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#5205,rid#5206,ps_availqty_prf#5207,ps_comment_prf#5208,ps_partkey_prf#5209,ps_supplycost_prf#5210,ps_suppkey_prf#5211] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5214 AS s_phone_prf_2#5222, rid#5215 AS rid_2#5223, s_address_prf#5216 AS s_address_prf_2#5224, s_nationkey_prf#5217 AS s_nationkey_prf_2#5225, s_suppkey_prf#5218 AS s_suppkey_prf_2#5226, s_name_prf#5219 AS s_name_prf_2#5227, s_acctbal_prf#5220 AS s_acctbal_prf_2#5228, s_comment_prf#5221 AS s_comment_prf_2#5229]
            +- Relation[s_phone_prf#5214,rid#5215,s_address_prf#5216,s_nationkey_prf#5217,s_suppkey_prf#5218,s_name_prf#5219,s_acctbal_prf#5220,s_comment_prf#5221] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 83571ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/15 04:08:43 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 04:08:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5291L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 04:08:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5291L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_2#5331]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#5316: string
         :     :- Project [l_returnflag_prf#5293 AS l_returnflag_prf_0#5312, l_orderkey_and_l_linenumber_prf#5294 AS l_orderkey_and_l_linenumber_prf_0#5313, l_comment_prf#5295 AS l_comment_prf_0#5314, l_linestatus_prf#5296 AS l_linestatus_prf_0#5315, rid#5297 AS rid_0#5316, l_shipmode_prf#5298 AS l_shipmode_prf_0#5317, l_shipinstruct_prf#5299 AS l_shipinstruct_prf_0#5318, l_quantity_prf#5300 AS l_quantity_prf_0#5319, l_receiptdate_prf#5301 AS l_receiptdate_prf_0#5320, l_linenumber_prf#5302 AS l_linenumber_prf_0#5321, l_tax_prf#5303 AS l_tax_prf_0#5322, l_shipdate_prf#5304 AS l_shipdate_prf_0#5323, l_extendedprice_prf#5305 AS l_extendedprice_prf_0#5324, l_partkey_prf#5306 AS l_partkey_prf_0#5325, l_discount_prf#5307 AS l_discount_prf_0#5326, l_partkey_and_l_suppkey_prf#5308 AS l_partkey_and_l_suppkey_prf_0#5327, l_commitdate_prf#5309 AS l_commitdate_prf_0#5328, l_suppkey_prf#5310 AS l_suppkey_prf_0#5329, l_orderkey_prf#5311 AS l_orderkey_prf_0#5330]
         :     :  +- Relation[l_returnflag_prf#5293,l_orderkey_and_l_linenumber_prf#5294,l_comment_prf#5295,l_linestatus_prf#5296,rid#5297,l_shipmode_prf#5298,l_shipinstruct_prf#5299,l_quantity_prf#5300,l_receiptdate_prf#5301,l_linenumber_prf#5302,l_tax_prf#5303,l_shipdate_prf#5304,l_extendedprice_prf#5305,l_partkey_prf#5306,l_discount_prf#5307,l_partkey_and_l_suppkey_prf#5308,l_commitdate_prf#5309,l_suppkey_prf#5310,l_orderkey_prf#5311] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1503) AS rid_2#5350]
            :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#5342: string
            :     :- Project [c_acctbal_prf#5332 AS c_acctbal_prf_1#5341, rid#5333 AS rid_1#5342, c_name_prf#5334 AS c_name_prf_1#5343, c_nationkey_prf#5335 AS c_nationkey_prf_1#5344, c_custkey_prf#5336 AS c_custkey_prf_1#5345, c_comment_prf#5337 AS c_comment_prf_1#5346, c_address_prf#5338 AS c_address_prf_1#5347, c_mktsegment_prf#5339 AS c_mktsegment_prf_1#5348, c_phone_prf#5340 AS c_phone_prf_1#5349]
            :     :  +- Relation[c_acctbal_prf#5332,rid#5333,c_name_prf#5334,c_nationkey_prf#5335,c_custkey_prf#5336,c_comment_prf#5337,c_address_prf#5338,c_mktsegment_prf#5339,c_phone_prf#5340] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#5351 AS o_shippriority_prf_2#5361, rid#5352 AS rid_2#5362, o_orderdate_prf#5353 AS o_orderdate_prf_2#5363, o_custkey_prf#5354 AS o_custkey_prf_2#5364, o_orderpriority_prf#5355 AS o_orderpriority_prf_2#5365, o_clerk_prf#5356 AS o_clerk_prf_2#5366, o_orderstatus_prf#5357 AS o_orderstatus_prf_2#5367, o_totalprice_prf#5358 AS o_totalprice_prf_2#5368, o_orderkey_prf#5359 AS o_orderkey_prf_2#5369, o_comment_prf#5360 AS o_comment_prf_2#5370]
               +- Relation[o_shippriority_prf#5351,rid#5352,o_orderdate_prf#5353,o_custkey_prf#5354,o_orderpriority_prf#5355,o_clerk_prf#5356,o_orderstatus_prf#5357,o_totalprice_prf#5358,o_orderkey_prf#5359,o_comment_prf#5360] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 158129ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/15 04:11:21 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 04:11:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5431L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/15 04:11:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5431L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1503) AS rid_1#5449]
         :  :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#5442: string
         :  :  :     :- Project [s_phone_prf#5433 AS s_phone_prf_0#5441, rid#5434 AS rid_0#5442, s_address_prf#5435 AS s_address_prf_0#5443, s_nationkey_prf#5436 AS s_nationkey_prf_0#5444, s_suppkey_prf#5437 AS s_suppkey_prf_0#5445, s_name_prf#5438 AS s_name_prf_0#5446, s_acctbal_prf#5439 AS s_acctbal_prf_0#5447, s_comment_prf#5440 AS s_comment_prf_0#5448]
         :  :  :     :  +- Relation[s_phone_prf#5433,rid#5434,s_address_prf#5435,s_nationkey_prf#5436,s_suppkey_prf#5437,s_name_prf#5438,s_acctbal_prf#5439,s_comment_prf#5440] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [rid#5450 AS rid_1#5455, n_regionkey_prf#5451 AS n_regionkey_prf_1#5456, n_nationkey_prf#5452 AS n_nationkey_prf_1#5457, n_name_prf#5453 AS n_name_prf_1#5458, n_comment_prf#5454 AS n_comment_prf_1#5459]
         :  :     +- Relation[rid#5450,n_regionkey_prf#5451,n_nationkey_prf#5452,n_name_prf#5453,n_comment_prf#5454] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1503) AS rid_2#5466]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5465]
         :        :  +- Relation[rid#5460,n_regionkey_prf#5461,n_nationkey_prf#5462,n_name_prf#5463,n_comment_prf#5464] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#1502,value#1503] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#5467 AS c_acctbal_prf_2#5476, rid#5468 AS rid_2#5477, c_name_prf#5469 AS c_name_prf_2#5478, c_nationkey_prf#5470 AS c_nationkey_prf_2#5479, c_custkey_prf#5471 AS c_custkey_prf_2#5480, c_comment_prf#5472 AS c_comment_prf_2#5481, c_address_prf#5473 AS c_address_prf_2#5482, c_mktsegment_prf#5474 AS c_mktsegment_prf_2#5483, c_phone_prf#5475 AS c_phone_prf_2#5484]
            +- Relation[c_acctbal_prf#5467,rid#5468,c_name_prf#5469,c_nationkey_prf#5470,c_custkey_prf#5471,c_comment_prf#5472,c_address_prf#5473,c_mktsegment_prf#5474,c_phone_prf#5475] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 28306ms
query=b1a, count=15628, duration=400
query=b1b, count=15628, duration=49998
query=b2a, count=1478870, duration=196268
query=b2b, count=1478870, duration=54755
query=f1, count=1, duration=69
query=f2, count=3907, duration=132
query=f3, count=1451, duration=85
query=f4, count=1, duration=58
query=f5, count=1478870, duration=23531
query=f6, count=857401, duration=13730
query=j1, count=800000, duration=31752
query=j10, count=6001215, duration=87118
query=j2, count=800000, duration=10960
query=j3, count=25, duration=73
query=j4, count=150000, duration=1938
query=j5, count=10000, duration=189
query=j6, count=6001215, duration=116061
query=j7, count=1500000, duration=40430
query=j8, count=6001215, duration=195908
query=j8b, count=6001215, duration=114874
query=j9, count=6001215, duration=93948
query=j9b, count=6001215, duration=117651
query=r1a, count=6001215, duration=172041
query=r1b, count=6001215, duration=148070
query=r1c, count=6001215, duration=158129
query=r1d, count=6001215, duration=232866
query=r1e, count=6001215, duration=233393
query=r1f, count=6001215, duration=157041
query=t1a, count=60000414, duration=28306
query=t1b, count=60000414, duration=45658
query=t1c, count=60000414, duration=42748
query=t2a, count=800000, duration=104437
query=t2b, count=800000, duration=83571
query=t2c, count=800000, duration=42738
query=t2d, count=800000, duration=61164
query=t3a, count=6001215, duration=221819
query=t3b, count=6001215, duration=196720
query=t3c, count=6001215, duration=188273
query=t3d, count=6001215, duration=185202
