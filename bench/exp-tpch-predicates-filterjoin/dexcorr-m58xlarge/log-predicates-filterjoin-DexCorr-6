19/10/16 09:52:08 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7175ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Wed Oct 16 09:52:10 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Wed Oct 16 09:52:11 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Wed Oct 16 09:52:11 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Wed Oct 16 09:52:11 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Wed Oct 16 09:52:11 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Wed Oct 16 09:52:14 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Wed Oct 16 09:52:16 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Wed Oct 16 09:52:16 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



fr2e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/16 09:52:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 09:52:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1795L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 09:52:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1795L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_1#1817]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#1807: string
         :     :- Project [c_acctbal_prf#1797 AS c_acctbal_prf_0#1806, rid#1798 AS rid_0#1807, c_name_prf#1799 AS c_name_prf_0#1808, c_nationkey_prf#1800 AS c_nationkey_prf_0#1809, c_custkey_prf#1801 AS c_custkey_prf_0#1810, c_comment_prf#1802 AS c_comment_prf_0#1811, c_address_prf#1803 AS c_address_prf_0#1812, c_mktsegment_prf#1804 AS c_mktsegment_prf_0#1813, c_phone_prf#1805 AS c_phone_prf_0#1814]
         :     :  +- Relation[c_acctbal_prf#1797,rid#1798,c_name_prf#1799,c_nationkey_prf#1800,c_custkey_prf#1801,c_comment_prf#1802,c_address_prf#1803,c_mktsegment_prf#1804,c_phone_prf#1805] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1816) AS rid_2#1841]
            :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#1829: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#1818 AS o_shippriority_prf_1#1828, rid#1819 AS rid_1#1829, o_orderdate_prf#1820 AS o_orderdate_prf_1#1830, o_custkey_prf#1821 AS o_custkey_prf_1#1831, o_orderpriority_prf#1822 AS o_orderpriority_prf_1#1832, o_clerk_prf#1823 AS o_clerk_prf_1#1833, o_orderstatus_prf#1824 AS o_orderstatus_prf_1#1834, o_totalprice_prf#1825 AS o_totalprice_prf_1#1835, o_orderkey_prf#1826 AS o_orderkey_prf_1#1836, o_comment_prf#1827 AS o_comment_prf_1#1837]
            :     :  :  +- Relation[o_shippriority_prf#1818,rid#1819,o_orderdate_prf#1820,o_custkey_prf#1821,o_orderpriority_prf#1822,o_clerk_prf#1823,o_orderstatus_prf#1824,o_totalprice_prf#1825,o_orderkey_prf#1826,o_comment_prf#1827] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#1840]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#1842 AS l_returnflag_prf_2#1861, l_orderkey_and_l_linenumber_prf#1843 AS l_orderkey_and_l_linenumber_prf_2#1862, l_comment_prf#1844 AS l_comment_prf_2#1863, l_linestatus_prf#1845 AS l_linestatus_prf_2#1864, rid#1846 AS rid_2#1865, l_shipmode_prf#1847 AS l_shipmode_prf_2#1866, l_shipinstruct_prf#1848 AS l_shipinstruct_prf_2#1867, l_quantity_prf#1849 AS l_quantity_prf_2#1868, l_receiptdate_prf#1850 AS l_receiptdate_prf_2#1869, l_linenumber_prf#1851 AS l_linenumber_prf_2#1870, l_tax_prf#1852 AS l_tax_prf_2#1871, l_shipdate_prf#1853 AS l_shipdate_prf_2#1872, l_extendedprice_prf#1854 AS l_extendedprice_prf_2#1873, l_partkey_prf#1855 AS l_partkey_prf_2#1874, l_discount_prf#1856 AS l_discount_prf_2#1875, l_partkey_and_l_suppkey_prf#1857 AS l_partkey_and_l_suppkey_prf_2#1876, l_commitdate_prf#1858 AS l_commitdate_prf_2#1877, l_suppkey_prf#1859 AS l_suppkey_prf_2#1878, l_orderkey_prf#1860 AS l_orderkey_prf_2#1879]
               +- Relation[l_returnflag_prf#1842,l_orderkey_and_l_linenumber_prf#1843,l_comment_prf#1844,l_linestatus_prf#1845,rid#1846,l_shipmode_prf#1847,l_shipinstruct_prf#1848,l_quantity_prf#1849,l_receiptdate_prf#1850,l_linenumber_prf#1851,l_tax_prf#1852,l_shipdate_prf#1853,l_extendedprice_prf#1854,l_partkey_prf#1855,l_discount_prf#1856,l_partkey_and_l_suppkey_prf#1857,l_commitdate_prf#1858,l_suppkey_prf#1859,l_orderkey_prf#1860] JDBCRelation(lineitem_prf) [numPartitions=1]

19/10/16 09:52:18 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=2901744
Elapsed time: 98230ms

fq1b=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 09:53:56 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 09:53:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1958L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 09:53:56 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 09:53:56 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 09:53:56 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 09:53:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1958L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_1#1971]
         :  :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#1965: string
         :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :     :  :- Project [rid#1960 AS rid_0#1965, n_regionkey_prf#1961 AS n_regionkey_prf_0#1966, n_nationkey_prf#1962 AS n_nationkey_prf_0#1967, n_name_prf#1963 AS n_name_prf_0#1968, n_comment_prf#1964 AS n_comment_prf_0#1969]
         :  :  :     :  :  +- Relation[rid#1960,n_regionkey_prf#1961,n_nationkey_prf#1962,n_name_prf#1963,n_comment_prf#1964] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1970]
         :  :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :  :  :     :        +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#1972 AS c_acctbal_prf_1#1981, rid#1973 AS rid_1#1982, c_name_prf#1974 AS c_name_prf_1#1983, c_nationkey_prf#1975 AS c_nationkey_prf_1#1984, c_custkey_prf#1976 AS c_custkey_prf_1#1985, c_comment_prf#1977 AS c_comment_prf_1#1986, c_address_prf#1978 AS c_address_prf_1#1987, c_mktsegment_prf#1979 AS c_mktsegment_prf_1#1988, c_phone_prf#1980 AS c_phone_prf_1#1989]
         :  :     +- Relation[c_acctbal_prf#1972,rid#1973,c_name_prf#1974,c_nationkey_prf#1975,c_custkey_prf#1976,c_comment_prf#1977,c_address_prf#1978,c_mktsegment_prf#1979,c_phone_prf#1980] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1816) AS rid_2#2000]
         :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#1999]
         :        :  +- Relation[c_acctbal_prf#1990,rid#1991,c_name_prf#1992,c_nationkey_prf#1993,c_custkey_prf#1994,c_comment_prf#1995,c_address_prf#1996,c_mktsegment_prf#1997,c_phone_prf#1998] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_2, 'rid_2, 'o_orderdate_prf_2, 'o_custkey_prf_2, 'o_orderpriority_prf_2, 'o_clerk_prf_2, 'o_orderstatus_prf_2, 'o_totalprice_prf_2, 'o_orderkey_prf_2, 'o_comment_prf_2, dexdecrypt('value_dec_key, value#1816) AS rid_3#2021]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_2#2012: string
            :     :- Project [o_shippriority_prf#2001 AS o_shippriority_prf_2#2011, rid#2002 AS rid_2#2012, o_orderdate_prf#2003 AS o_orderdate_prf_2#2013, o_custkey_prf#2004 AS o_custkey_prf_2#2014, o_orderpriority_prf#2005 AS o_orderpriority_prf_2#2015, o_clerk_prf#2006 AS o_clerk_prf_2#2016, o_orderstatus_prf#2007 AS o_orderstatus_prf_2#2017, o_totalprice_prf#2008 AS o_totalprice_prf_2#2018, o_orderkey_prf#2009 AS o_orderkey_prf_2#2019, o_comment_prf#2010 AS o_comment_prf_2#2020]
            :     :  +- Relation[o_shippriority_prf#2001,rid#2002,o_orderdate_prf#2003,o_custkey_prf#2004,o_orderpriority_prf#2005,o_clerk_prf#2006,o_orderstatus_prf#2007,o_totalprice_prf#2008,o_orderkey_prf#2009,o_comment_prf#2010] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2022 AS l_returnflag_prf_3#2041, l_orderkey_and_l_linenumber_prf#2023 AS l_orderkey_and_l_linenumber_prf_3#2042, l_comment_prf#2024 AS l_comment_prf_3#2043, l_linestatus_prf#2025 AS l_linestatus_prf_3#2044, rid#2026 AS rid_3#2045, l_shipmode_prf#2027 AS l_shipmode_prf_3#2046, l_shipinstruct_prf#2028 AS l_shipinstruct_prf_3#2047, l_quantity_prf#2029 AS l_quantity_prf_3#2048, l_receiptdate_prf#2030 AS l_receiptdate_prf_3#2049, l_linenumber_prf#2031 AS l_linenumber_prf_3#2050, l_tax_prf#2032 AS l_tax_prf_3#2051, l_shipdate_prf#2033 AS l_shipdate_prf_3#2052, l_extendedprice_prf#2034 AS l_extendedprice_prf_3#2053, l_partkey_prf#2035 AS l_partkey_prf_3#2054, l_discount_prf#2036 AS l_discount_prf_3#2055, l_partkey_and_l_suppkey_prf#2037 AS l_partkey_and_l_suppkey_prf_3#2056, l_commitdate_prf#2038 AS l_commitdate_prf_3#2057, l_suppkey_prf#2039 AS l_suppkey_prf_3#2058, l_orderkey_prf#2040 AS l_orderkey_prf_3#2059]
               +- Relation[l_returnflag_prf#2022,l_orderkey_and_l_linenumber_prf#2023,l_comment_prf#2024,l_linestatus_prf#2025,rid#2026,l_shipmode_prf#2027,l_shipinstruct_prf#2028,l_quantity_prf#2029,l_receiptdate_prf#2030,l_linenumber_prf#2031,l_tax_prf#2032,l_shipdate_prf#2033,l_extendedprice_prf#2034,l_partkey_prf#2035,l_discount_prf#2036,l_partkey_and_l_suppkey_prf#2037,l_commitdate_prf#2038,l_suppkey_prf#2039,l_orderkey_prf#2040] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 225858ms

ft3b=
select * from part, lineitem, supplier where p_size = 15 and p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/16 09:57:42 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 09:57:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2138L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 09:57:42 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 09:57:42 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 09:57:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2138L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_1#2161]
         :  :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2152: string
         :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :     :  :- Project [p_comment_prf#2140 AS p_comment_prf_0#2150, p_name_prf#2141 AS p_name_prf_0#2151, rid#2142 AS rid_0#2152, p_type_prf#2143 AS p_type_prf_0#2153, p_retailprice_prf#2144 AS p_retailprice_prf_0#2154, p_mfgr_prf#2145 AS p_mfgr_prf_0#2155, p_container_prf#2146 AS p_container_prf_0#2156, p_brand_prf#2147 AS p_brand_prf_0#2157, p_size_prf#2148 AS p_size_prf_0#2158, p_partkey_prf#2149 AS p_partkey_prf_0#2159]
         :  :  :     :  :  +- Relation[p_comment_prf#2140,p_name_prf#2141,rid#2142,p_type_prf#2143,p_retailprice_prf#2144,p_mfgr_prf#2145,p_container_prf#2146,p_brand_prf#2147,p_size_prf#2148,p_partkey_prf#2149] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2160]
         :  :  :     :     +- DexRidFilter part~p_size~15
         :  :  :     :        +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#2162 AS l_returnflag_prf_1#2181, l_orderkey_and_l_linenumber_prf#2163 AS l_orderkey_and_l_linenumber_prf_1#2182, l_comment_prf#2164 AS l_comment_prf_1#2183, l_linestatus_prf#2165 AS l_linestatus_prf_1#2184, rid#2166 AS rid_1#2185, l_shipmode_prf#2167 AS l_shipmode_prf_1#2186, l_shipinstruct_prf#2168 AS l_shipinstruct_prf_1#2187, l_quantity_prf#2169 AS l_quantity_prf_1#2188, l_receiptdate_prf#2170 AS l_receiptdate_prf_1#2189, l_linenumber_prf#2171 AS l_linenumber_prf_1#2190, l_tax_prf#2172 AS l_tax_prf_1#2191, l_shipdate_prf#2173 AS l_shipdate_prf_1#2192, l_extendedprice_prf#2174 AS l_extendedprice_prf_1#2193, l_partkey_prf#2175 AS l_partkey_prf_1#2194, l_discount_prf#2176 AS l_discount_prf_1#2195, l_partkey_and_l_suppkey_prf#2177 AS l_partkey_and_l_suppkey_prf_1#2196, l_commitdate_prf#2178 AS l_commitdate_prf_1#2197, l_suppkey_prf#2179 AS l_suppkey_prf_1#2198, l_orderkey_prf#2180 AS l_orderkey_prf_1#2199]
         :  :     +- Relation[l_returnflag_prf#2162,l_orderkey_and_l_linenumber_prf#2163,l_comment_prf#2164,l_linestatus_prf#2165,rid#2166,l_shipmode_prf#2167,l_shipinstruct_prf#2168,l_quantity_prf#2169,l_receiptdate_prf#2170,l_linenumber_prf#2171,l_tax_prf#2172,l_shipdate_prf#2173,l_extendedprice_prf#2174,l_partkey_prf#2175,l_discount_prf#2176,l_partkey_and_l_suppkey_prf#2177,l_commitdate_prf#2178,l_suppkey_prf#2179,l_orderkey_prf#2180] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1816) AS rid_2#2220]
         :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2219]
         :        :  +- Relation[l_returnflag_prf#2200,l_orderkey_and_l_linenumber_prf#2201,l_comment_prf#2202,l_linestatus_prf#2203,rid#2204,l_shipmode_prf#2205,l_shipinstruct_prf#2206,l_quantity_prf#2207,l_receiptdate_prf#2208,l_linenumber_prf#2209,l_tax_prf#2210,l_shipdate_prf#2211,l_extendedprice_prf#2212,l_partkey_prf#2213,l_discount_prf#2214,l_partkey_and_l_suppkey_prf#2215,l_commitdate_prf#2216,l_suppkey_prf#2217,l_orderkey_prf#2218] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2221 AS s_phone_prf_2#2229, rid#2222 AS rid_2#2230, s_address_prf#2223 AS s_address_prf_2#2231, s_nationkey_prf#2224 AS s_nationkey_prf_2#2232, s_suppkey_prf#2225 AS s_suppkey_prf_2#2233, s_name_prf#2226 AS s_name_prf_2#2234, s_acctbal_prf#2227 AS s_acctbal_prf_2#2235, s_comment_prf#2228 AS s_comment_prf_2#2236]
            +- Relation[s_phone_prf#2221,rid#2222,s_address_prf#2223,s_nationkey_prf#2224,s_suppkey_prf#2225,s_name_prf#2226,s_acctbal_prf#2227,s_comment_prf#2228] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 53220ms

fr1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and (l_orderkey = o_orderkey and c_mktsegment = 'BUILDING')
19/10/16 09:58:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 09:58:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2310L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 09:58:35 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 09:58:35 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 09:58:35 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 09:58:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2310L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_1#2350]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2335: string
         :     :- Project [l_returnflag_prf#2312 AS l_returnflag_prf_0#2331, l_orderkey_and_l_linenumber_prf#2313 AS l_orderkey_and_l_linenumber_prf_0#2332, l_comment_prf#2314 AS l_comment_prf_0#2333, l_linestatus_prf#2315 AS l_linestatus_prf_0#2334, rid#2316 AS rid_0#2335, l_shipmode_prf#2317 AS l_shipmode_prf_0#2336, l_shipinstruct_prf#2318 AS l_shipinstruct_prf_0#2337, l_quantity_prf#2319 AS l_quantity_prf_0#2338, l_receiptdate_prf#2320 AS l_receiptdate_prf_0#2339, l_linenumber_prf#2321 AS l_linenumber_prf_0#2340, l_tax_prf#2322 AS l_tax_prf_0#2341, l_shipdate_prf#2323 AS l_shipdate_prf_0#2342, l_extendedprice_prf#2324 AS l_extendedprice_prf_0#2343, l_partkey_prf#2325 AS l_partkey_prf_0#2344, l_discount_prf#2326 AS l_discount_prf_0#2345, l_partkey_and_l_suppkey_prf#2327 AS l_partkey_and_l_suppkey_prf_0#2346, l_commitdate_prf#2328 AS l_commitdate_prf_0#2347, l_suppkey_prf#2329 AS l_suppkey_prf_0#2348, l_orderkey_prf#2330 AS l_orderkey_prf_0#2349]
         :     :  +- Relation[l_returnflag_prf#2312,l_orderkey_and_l_linenumber_prf#2313,l_comment_prf#2314,l_linestatus_prf#2315,rid#2316,l_shipmode_prf#2317,l_shipinstruct_prf#2318,l_quantity_prf#2319,l_receiptdate_prf#2320,l_linenumber_prf#2321,l_tax_prf#2322,l_shipdate_prf#2323,l_extendedprice_prf#2324,l_partkey_prf#2325,l_discount_prf#2326,l_partkey_and_l_suppkey_prf#2327,l_commitdate_prf#2328,l_suppkey_prf#2329,l_orderkey_prf#2330] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1816) AS rid_2#2371]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#2362: string
            :     :- Project [o_shippriority_prf#2351 AS o_shippriority_prf_1#2361, rid#2352 AS rid_1#2362, o_orderdate_prf#2353 AS o_orderdate_prf_1#2363, o_custkey_prf#2354 AS o_custkey_prf_1#2364, o_orderpriority_prf#2355 AS o_orderpriority_prf_1#2365, o_clerk_prf#2356 AS o_clerk_prf_1#2366, o_orderstatus_prf#2357 AS o_orderstatus_prf_1#2367, o_totalprice_prf#2358 AS o_totalprice_prf_1#2368, o_orderkey_prf#2359 AS o_orderkey_prf_1#2369, o_comment_prf#2360 AS o_comment_prf_1#2370]
            :     :  +- Relation[o_shippriority_prf#2351,rid#2352,o_orderdate_prf#2353,o_custkey_prf#2354,o_orderpriority_prf#2355,o_clerk_prf#2356,o_orderstatus_prf#2357,o_totalprice_prf#2358,o_orderkey_prf#2359,o_comment_prf#2360] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [c_acctbal_prf#2372 AS c_acctbal_prf_2#2381, rid#2373 AS rid_2#2382, c_name_prf#2374 AS c_name_prf_2#2383, c_nationkey_prf#2375 AS c_nationkey_prf_2#2384, c_custkey_prf#2376 AS c_custkey_prf_2#2385, c_comment_prf#2377 AS c_comment_prf_2#2386, c_address_prf#2378 AS c_address_prf_2#2387, c_mktsegment_prf#2379 AS c_mktsegment_prf_2#2388, c_phone_prf#2380 AS c_phone_prf_2#2389]
               :  +- Relation[c_acctbal_prf#2372,rid#2373,c_name_prf#2374,c_nationkey_prf#2375,c_custkey_prf#2376,c_comment_prf#2377,c_address_prf#2378,c_mktsegment_prf#2379,c_phone_prf#2380] JDBCRelation(customer_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#2390]
                  +- DexRidFilter customer~c_mktsegment~BUILDING
                     +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 143126ms

fr2b=
select * from lineitem, orders, customer where o_custkey = c_custkey and o_orderstatus = 'F' and l_orderkey = o_orderkey
19/10/16 10:00:58 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:00:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2465L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 10:00:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2465L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_1#2505]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2490: string
         :     :- Project [l_returnflag_prf#2467 AS l_returnflag_prf_0#2486, l_orderkey_and_l_linenumber_prf#2468 AS l_orderkey_and_l_linenumber_prf_0#2487, l_comment_prf#2469 AS l_comment_prf_0#2488, l_linestatus_prf#2470 AS l_linestatus_prf_0#2489, rid#2471 AS rid_0#2490, l_shipmode_prf#2472 AS l_shipmode_prf_0#2491, l_shipinstruct_prf#2473 AS l_shipinstruct_prf_0#2492, l_quantity_prf#2474 AS l_quantity_prf_0#2493, l_receiptdate_prf#2475 AS l_receiptdate_prf_0#2494, l_linenumber_prf#2476 AS l_linenumber_prf_0#2495, l_tax_prf#2477 AS l_tax_prf_0#2496, l_shipdate_prf#2478 AS l_shipdate_prf_0#2497, l_extendedprice_prf#2479 AS l_extendedprice_prf_0#2498, l_partkey_prf#2480 AS l_partkey_prf_0#2499, l_discount_prf#2481 AS l_discount_prf_0#2500, l_partkey_and_l_suppkey_prf#2482 AS l_partkey_and_l_suppkey_prf_0#2501, l_commitdate_prf#2483 AS l_commitdate_prf_0#2502, l_suppkey_prf#2484 AS l_suppkey_prf_0#2503, l_orderkey_prf#2485 AS l_orderkey_prf_0#2504]
         :     :  +- Relation[l_returnflag_prf#2467,l_orderkey_and_l_linenumber_prf#2468,l_comment_prf#2469,l_linestatus_prf#2470,rid#2471,l_shipmode_prf#2472,l_shipinstruct_prf#2473,l_quantity_prf#2474,l_receiptdate_prf#2475,l_linenumber_prf#2476,l_tax_prf#2477,l_shipdate_prf#2478,l_extendedprice_prf#2479,l_partkey_prf#2480,l_discount_prf#2481,l_partkey_and_l_suppkey_prf#2482,l_commitdate_prf#2483,l_suppkey_prf#2484,l_orderkey_prf#2485] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1816) AS rid_2#2527]
            :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#2517: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#2506 AS o_shippriority_prf_1#2516, rid#2507 AS rid_1#2517, o_orderdate_prf#2508 AS o_orderdate_prf_1#2518, o_custkey_prf#2509 AS o_custkey_prf_1#2519, o_orderpriority_prf#2510 AS o_orderpriority_prf_1#2520, o_clerk_prf#2511 AS o_clerk_prf_1#2521, o_orderstatus_prf#2512 AS o_orderstatus_prf_1#2522, o_totalprice_prf#2513 AS o_totalprice_prf_1#2523, o_orderkey_prf#2514 AS o_orderkey_prf_1#2524, o_comment_prf#2515 AS o_comment_prf_1#2525]
            :     :  :  +- Relation[o_shippriority_prf#2506,rid#2507,o_orderdate_prf#2508,o_custkey_prf#2509,o_orderpriority_prf#2510,o_clerk_prf#2511,o_orderstatus_prf#2512,o_totalprice_prf#2513,o_orderkey_prf#2514,o_comment_prf#2515] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2526]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#2528 AS c_acctbal_prf_2#2537, rid#2529 AS rid_2#2538, c_name_prf#2530 AS c_name_prf_2#2539, c_nationkey_prf#2531 AS c_nationkey_prf_2#2540, c_custkey_prf#2532 AS c_custkey_prf_2#2541, c_comment_prf#2533 AS c_comment_prf_2#2542, c_address_prf#2534 AS c_address_prf_2#2543, c_mktsegment_prf#2535 AS c_mktsegment_prf_2#2544, c_phone_prf#2536 AS c_phone_prf_2#2545]
               +- Relation[c_acctbal_prf#2528,rid#2529,c_name_prf#2530,c_nationkey_prf#2531,c_custkey_prf#2532,c_comment_prf#2533,c_address_prf#2534,c_mktsegment_prf#2535,c_phone_prf#2536] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 121020ms

fq1d=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 10:02:59 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:02:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2624L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_orderkey#342L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :     :- Project [n_nationkey#108L]
               :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
               :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L]
                  +- Filter isnotnull(o_orderkey#342L)
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 10:02:59 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:02:59 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:02:59 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:02:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2624L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_3#2664]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2649: string
         :     :- Project [l_returnflag_prf#2626 AS l_returnflag_prf_0#2645, l_orderkey_and_l_linenumber_prf#2627 AS l_orderkey_and_l_linenumber_prf_0#2646, l_comment_prf#2628 AS l_comment_prf_0#2647, l_linestatus_prf#2629 AS l_linestatus_prf_0#2648, rid#2630 AS rid_0#2649, l_shipmode_prf#2631 AS l_shipmode_prf_0#2650, l_shipinstruct_prf#2632 AS l_shipinstruct_prf_0#2651, l_quantity_prf#2633 AS l_quantity_prf_0#2652, l_receiptdate_prf#2634 AS l_receiptdate_prf_0#2653, l_linenumber_prf#2635 AS l_linenumber_prf_0#2654, l_tax_prf#2636 AS l_tax_prf_0#2655, l_shipdate_prf#2637 AS l_shipdate_prf_0#2656, l_extendedprice_prf#2638 AS l_extendedprice_prf_0#2657, l_partkey_prf#2639 AS l_partkey_prf_0#2658, l_discount_prf#2640 AS l_discount_prf_0#2659, l_partkey_and_l_suppkey_prf#2641 AS l_partkey_and_l_suppkey_prf_0#2660, l_commitdate_prf#2642 AS l_commitdate_prf_0#2661, l_suppkey_prf#2643 AS l_suppkey_prf_0#2662, l_orderkey_prf#2644 AS l_orderkey_prf_0#2663]
         :     :  +- Relation[l_returnflag_prf#2626,l_orderkey_and_l_linenumber_prf#2627,l_comment_prf#2628,l_linestatus_prf#2629,rid#2630,l_shipmode_prf#2631,l_shipinstruct_prf#2632,l_quantity_prf#2633,l_receiptdate_prf#2634,l_linenumber_prf#2635,l_tax_prf#2636,l_shipdate_prf#2637,l_extendedprice_prf#2638,l_partkey_prf#2639,l_discount_prf#2640,l_partkey_and_l_suppkey_prf#2641,l_commitdate_prf#2642,l_suppkey_prf#2643,l_orderkey_prf#2644] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join NaturalJoin(Inner)
            :  :  :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#1816) AS rid_2#2676]
            :  :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_1#2670: string
            :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :  :     :  :- Project [rid#2665 AS rid_1#2670, n_regionkey_prf#2666 AS n_regionkey_prf_1#2671, n_nationkey_prf#2667 AS n_nationkey_prf_1#2672, n_name_prf#2668 AS n_name_prf_1#2673, n_comment_prf#2669 AS n_comment_prf_1#2674]
            :  :  :     :  :  +- Relation[rid#2665,n_regionkey_prf#2666,n_nationkey_prf#2667,n_name_prf#2668,n_comment_prf#2669] JDBCRelation(nation_prf) [numPartitions=1]
            :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2675]
            :  :  :     :     +- DexRidFilter nation~n_name~FRANCE
            :  :  :     :        +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]
            :  :  :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
            :  :  +- Project [c_acctbal_prf#2677 AS c_acctbal_prf_2#2686, rid#2678 AS rid_2#2687, c_name_prf#2679 AS c_name_prf_2#2688, c_nationkey_prf#2680 AS c_nationkey_prf_2#2689, c_custkey_prf#2681 AS c_custkey_prf_2#2690, c_comment_prf#2682 AS c_comment_prf_2#2691, c_address_prf#2683 AS c_address_prf_2#2692, c_mktsegment_prf#2684 AS c_mktsegment_prf_2#2693, c_phone_prf#2685 AS c_phone_prf_2#2694]
            :  :     +- Relation[c_acctbal_prf#2677,rid#2678,c_name_prf#2679,c_nationkey_prf#2680,c_custkey_prf#2681,c_comment_prf#2682,c_address_prf#2683,c_mktsegment_prf#2684,c_phone_prf#2685] JDBCRelation(customer_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1816) AS rid_3#2705]
            :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#2704]
            :        :  +- Relation[c_acctbal_prf#2695,rid#2696,c_name_prf#2697,c_nationkey_prf#2698,c_custkey_prf#2699,c_comment_prf#2700,c_address_prf#2701,c_mktsegment_prf#2702,c_phone_prf#2703] JDBCRelation(customer_prf) [numPartitions=1]
            :        +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2706 AS o_shippriority_prf_3#2716, rid#2707 AS rid_3#2717, o_orderdate_prf#2708 AS o_orderdate_prf_3#2718, o_custkey_prf#2709 AS o_custkey_prf_3#2719, o_orderpriority_prf#2710 AS o_orderpriority_prf_3#2720, o_clerk_prf#2711 AS o_clerk_prf_3#2721, o_orderstatus_prf#2712 AS o_orderstatus_prf_3#2722, o_totalprice_prf#2713 AS o_totalprice_prf_3#2723, o_orderkey_prf#2714 AS o_orderkey_prf_3#2724, o_comment_prf#2715 AS o_comment_prf_3#2725]
               +- Relation[o_shippriority_prf#2706,rid#2707,o_orderdate_prf#2708,o_custkey_prf#2709,o_orderpriority_prf#2710,o_clerk_prf#2711,o_orderstatus_prf#2712,o_totalprice_prf#2713,o_orderkey_prf#2714,o_comment_prf#2715] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=0
Elapsed time: 1033ms

ft3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and p_size = 15 and l_suppkey = s_suppkey
19/10/16 10:03:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:03:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2804L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 10:03:00 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 10:03:00 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 10:03:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2804L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_1#2844]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#2829: string
         :  :  :     :- Project [l_returnflag_prf#2806 AS l_returnflag_prf_0#2825, l_orderkey_and_l_linenumber_prf#2807 AS l_orderkey_and_l_linenumber_prf_0#2826, l_comment_prf#2808 AS l_comment_prf_0#2827, l_linestatus_prf#2809 AS l_linestatus_prf_0#2828, rid#2810 AS rid_0#2829, l_shipmode_prf#2811 AS l_shipmode_prf_0#2830, l_shipinstruct_prf#2812 AS l_shipinstruct_prf_0#2831, l_quantity_prf#2813 AS l_quantity_prf_0#2832, l_receiptdate_prf#2814 AS l_receiptdate_prf_0#2833, l_linenumber_prf#2815 AS l_linenumber_prf_0#2834, l_tax_prf#2816 AS l_tax_prf_0#2835, l_shipdate_prf#2817 AS l_shipdate_prf_0#2836, l_extendedprice_prf#2818 AS l_extendedprice_prf_0#2837, l_partkey_prf#2819 AS l_partkey_prf_0#2838, l_discount_prf#2820 AS l_discount_prf_0#2839, l_partkey_and_l_suppkey_prf#2821 AS l_partkey_and_l_suppkey_prf_0#2840, l_commitdate_prf#2822 AS l_commitdate_prf_0#2841, l_suppkey_prf#2823 AS l_suppkey_prf_0#2842, l_orderkey_prf#2824 AS l_orderkey_prf_0#2843]
         :  :  :     :  +- Relation[l_returnflag_prf#2806,l_orderkey_and_l_linenumber_prf#2807,l_comment_prf#2808,l_linestatus_prf#2809,rid#2810,l_shipmode_prf#2811,l_shipinstruct_prf#2812,l_quantity_prf#2813,l_receiptdate_prf#2814,l_linenumber_prf#2815,l_tax_prf#2816,l_shipdate_prf#2817,l_extendedprice_prf#2818,l_partkey_prf#2819,l_discount_prf#2820,l_partkey_and_l_suppkey_prf#2821,l_commitdate_prf#2822,l_suppkey_prf#2823,l_orderkey_prf#2824] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#2845 AS p_comment_prf_1#2855, p_name_prf#2846 AS p_name_prf_1#2856, rid#2847 AS rid_1#2857, p_type_prf#2848 AS p_type_prf_1#2858, p_retailprice_prf#2849 AS p_retailprice_prf_1#2859, p_mfgr_prf#2850 AS p_mfgr_prf_1#2860, p_container_prf#2851 AS p_container_prf_1#2861, p_brand_prf#2852 AS p_brand_prf_1#2862, p_size_prf#2853 AS p_size_prf_1#2863, p_partkey_prf#2854 AS p_partkey_prf_1#2864]
         :  :     +- Relation[p_comment_prf#2845,p_name_prf#2846,rid#2847,p_type_prf#2848,p_retailprice_prf#2849,p_mfgr_prf#2850,p_container_prf#2851,p_brand_prf#2852,p_size_prf#2853,p_partkey_prf#2854] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1816) AS rid_2#2885]
         :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2884]
         :        :  +- Relation[l_returnflag_prf#2865,l_orderkey_and_l_linenumber_prf#2866,l_comment_prf#2867,l_linestatus_prf#2868,rid#2869,l_shipmode_prf#2870,l_shipinstruct_prf#2871,l_quantity_prf#2872,l_receiptdate_prf#2873,l_linenumber_prf#2874,l_tax_prf#2875,l_shipdate_prf#2876,l_extendedprice_prf#2877,l_partkey_prf#2878,l_discount_prf#2879,l_partkey_and_l_suppkey_prf#2880,l_commitdate_prf#2881,l_suppkey_prf#2882,l_orderkey_prf#2883] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2886 AS s_phone_prf_2#2894, rid#2887 AS rid_2#2895, s_address_prf#2888 AS s_address_prf_2#2896, s_nationkey_prf#2889 AS s_nationkey_prf_2#2897, s_suppkey_prf#2890 AS s_suppkey_prf_2#2898, s_name_prf#2891 AS s_name_prf_2#2899, s_acctbal_prf#2892 AS s_acctbal_prf_2#2900, s_comment_prf#2893 AS s_comment_prf_2#2901]
            +- Relation[s_phone_prf#2886,rid#2887,s_address_prf#2888,s_nationkey_prf#2889,s_suppkey_prf#2890,s_name_prf#2891,s_acctbal_prf#2892,s_comment_prf#2893] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 222163ms

fr2f=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/16 10:06:42 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:06:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2975L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_orderkey#342L, o_custkey#343L]
         :     :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L]
         :        +- Filter isnotnull(c_custkey#290L)
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 10:06:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2975L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_1#2998]
         :  :  :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_0#2988: string
         :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :     :  :- Project [o_shippriority_prf#2977 AS o_shippriority_prf_0#2987, rid#2978 AS rid_0#2988, o_orderdate_prf#2979 AS o_orderdate_prf_0#2989, o_custkey_prf#2980 AS o_custkey_prf_0#2990, o_orderpriority_prf#2981 AS o_orderpriority_prf_0#2991, o_clerk_prf#2982 AS o_clerk_prf_0#2992, o_orderstatus_prf#2983 AS o_orderstatus_prf_0#2993, o_totalprice_prf#2984 AS o_totalprice_prf_0#2994, o_orderkey_prf#2985 AS o_orderkey_prf_0#2995, o_comment_prf#2986 AS o_comment_prf_0#2996]
         :  :  :     :  :  +- Relation[o_shippriority_prf#2977,rid#2978,o_orderdate_prf#2979,o_custkey_prf#2980,o_orderpriority_prf#2981,o_clerk_prf#2982,o_orderstatus_prf#2983,o_totalprice_prf#2984,o_orderkey_prf#2985,o_comment_prf#2986] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2997]
         :  :  :     :     +- DexRidFilter orders~o_orderstatus~F
         :  :  :     :        +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#2999 AS c_acctbal_prf_1#3008, rid#3000 AS rid_1#3009, c_name_prf#3001 AS c_name_prf_1#3010, c_nationkey_prf#3002 AS c_nationkey_prf_1#3011, c_custkey_prf#3003 AS c_custkey_prf_1#3012, c_comment_prf#3004 AS c_comment_prf_1#3013, c_address_prf#3005 AS c_address_prf_1#3014, c_mktsegment_prf#3006 AS c_mktsegment_prf_1#3015, c_phone_prf#3007 AS c_phone_prf_1#3016]
         :  :     +- Relation[c_acctbal_prf#2999,rid#3000,c_name_prf#3001,c_nationkey_prf#3002,c_custkey_prf#3003,c_comment_prf#3004,c_address_prf#3005,c_mktsegment_prf#3006,c_phone_prf#3007] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1816) AS rid_2#3028]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3027]
         :        :  +- Relation[o_shippriority_prf#3017,rid#3018,o_orderdate_prf#3019,o_custkey_prf#3020,o_orderpriority_prf#3021,o_clerk_prf#3022,o_orderstatus_prf#3023,o_totalprice_prf#3024,o_orderkey_prf#3025,o_comment_prf#3026] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3029 AS l_returnflag_prf_2#3048, l_orderkey_and_l_linenumber_prf#3030 AS l_orderkey_and_l_linenumber_prf_2#3049, l_comment_prf#3031 AS l_comment_prf_2#3050, l_linestatus_prf#3032 AS l_linestatus_prf_2#3051, rid#3033 AS rid_2#3052, l_shipmode_prf#3034 AS l_shipmode_prf_2#3053, l_shipinstruct_prf#3035 AS l_shipinstruct_prf_2#3054, l_quantity_prf#3036 AS l_quantity_prf_2#3055, l_receiptdate_prf#3037 AS l_receiptdate_prf_2#3056, l_linenumber_prf#3038 AS l_linenumber_prf_2#3057, l_tax_prf#3039 AS l_tax_prf_2#3058, l_shipdate_prf#3040 AS l_shipdate_prf_2#3059, l_extendedprice_prf#3041 AS l_extendedprice_prf_2#3060, l_partkey_prf#3042 AS l_partkey_prf_2#3061, l_discount_prf#3043 AS l_discount_prf_2#3062, l_partkey_and_l_suppkey_prf#3044 AS l_partkey_and_l_suppkey_prf_2#3063, l_commitdate_prf#3045 AS l_commitdate_prf_2#3064, l_suppkey_prf#3046 AS l_suppkey_prf_2#3065, l_orderkey_prf#3047 AS l_orderkey_prf_2#3066]
            +- Relation[l_returnflag_prf#3029,l_orderkey_and_l_linenumber_prf#3030,l_comment_prf#3031,l_linestatus_prf#3032,rid#3033,l_shipmode_prf#3034,l_shipinstruct_prf#3035,l_quantity_prf#3036,l_receiptdate_prf#3037,l_linenumber_prf#3038,l_tax_prf#3039,l_shipdate_prf#3040,l_extendedprice_prf#3041,l_partkey_prf#3042,l_discount_prf#3043,l_partkey_and_l_suppkey_prf#3044,l_commitdate_prf#3045,l_suppkey_prf#3046,l_orderkey_prf#3047] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 217349ms

fr2a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_orderstatus = 'F' and o_custkey = c_custkey
19/10/16 10:10:19 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:10:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3141L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 10:10:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3141L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_1#3181]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3166: string
         :  :  :     :- Project [l_returnflag_prf#3143 AS l_returnflag_prf_0#3162, l_orderkey_and_l_linenumber_prf#3144 AS l_orderkey_and_l_linenumber_prf_0#3163, l_comment_prf#3145 AS l_comment_prf_0#3164, l_linestatus_prf#3146 AS l_linestatus_prf_0#3165, rid#3147 AS rid_0#3166, l_shipmode_prf#3148 AS l_shipmode_prf_0#3167, l_shipinstruct_prf#3149 AS l_shipinstruct_prf_0#3168, l_quantity_prf#3150 AS l_quantity_prf_0#3169, l_receiptdate_prf#3151 AS l_receiptdate_prf_0#3170, l_linenumber_prf#3152 AS l_linenumber_prf_0#3171, l_tax_prf#3153 AS l_tax_prf_0#3172, l_shipdate_prf#3154 AS l_shipdate_prf_0#3173, l_extendedprice_prf#3155 AS l_extendedprice_prf_0#3174, l_partkey_prf#3156 AS l_partkey_prf_0#3175, l_discount_prf#3157 AS l_discount_prf_0#3176, l_partkey_and_l_suppkey_prf#3158 AS l_partkey_and_l_suppkey_prf_0#3177, l_commitdate_prf#3159 AS l_commitdate_prf_0#3178, l_suppkey_prf#3160 AS l_suppkey_prf_0#3179, l_orderkey_prf#3161 AS l_orderkey_prf_0#3180]
         :  :  :     :  +- Relation[l_returnflag_prf#3143,l_orderkey_and_l_linenumber_prf#3144,l_comment_prf#3145,l_linestatus_prf#3146,rid#3147,l_shipmode_prf#3148,l_shipinstruct_prf#3149,l_quantity_prf#3150,l_receiptdate_prf#3151,l_linenumber_prf#3152,l_tax_prf#3153,l_shipdate_prf#3154,l_extendedprice_prf#3155,l_partkey_prf#3156,l_discount_prf#3157,l_partkey_and_l_suppkey_prf#3158,l_commitdate_prf#3159,l_suppkey_prf#3160,l_orderkey_prf#3161] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :     :- Project [o_shippriority_prf#3182 AS o_shippriority_prf_1#3192, rid#3183 AS rid_1#3193, o_orderdate_prf#3184 AS o_orderdate_prf_1#3194, o_custkey_prf#3185 AS o_custkey_prf_1#3195, o_orderpriority_prf#3186 AS o_orderpriority_prf_1#3196, o_clerk_prf#3187 AS o_clerk_prf_1#3197, o_orderstatus_prf#3188 AS o_orderstatus_prf_1#3198, o_totalprice_prf#3189 AS o_totalprice_prf_1#3199, o_orderkey_prf#3190 AS o_orderkey_prf_1#3200, o_comment_prf#3191 AS o_comment_prf_1#3201]
         :  :     :  +- Relation[o_shippriority_prf#3182,rid#3183,o_orderdate_prf#3184,o_custkey_prf#3185,o_orderpriority_prf#3186,o_clerk_prf#3187,o_orderstatus_prf#3188,o_totalprice_prf#3189,o_orderkey_prf#3190,o_comment_prf#3191] JDBCRelation(orders_prf) [numPartitions=1]
         :  :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3202]
         :  :        +- DexRidFilter orders~o_orderstatus~F
         :  :           +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1816) AS rid_2#3214]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3213]
         :        :  +- Relation[o_shippriority_prf#3203,rid#3204,o_orderdate_prf#3205,o_custkey_prf#3206,o_orderpriority_prf#3207,o_clerk_prf#3208,o_orderstatus_prf#3209,o_totalprice_prf#3210,o_orderkey_prf#3211,o_comment_prf#3212] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3215 AS c_acctbal_prf_2#3224, rid#3216 AS rid_2#3225, c_name_prf#3217 AS c_name_prf_2#3226, c_nationkey_prf#3218 AS c_nationkey_prf_2#3227, c_custkey_prf#3219 AS c_custkey_prf_2#3228, c_comment_prf#3220 AS c_comment_prf_2#3229, c_address_prf#3221 AS c_address_prf_2#3230, c_mktsegment_prf#3222 AS c_mktsegment_prf_2#3231, c_phone_prf#3223 AS c_phone_prf_2#3232]
            +- Relation[c_acctbal_prf#3215,rid#3216,c_name_prf#3217,c_nationkey_prf#3218,c_custkey_prf#3219,c_comment_prf#3220,c_address_prf#3221,c_mktsegment_prf#3222,c_phone_prf#3223] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 174223ms

fq1f=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 10:13:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:13:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3311L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/16 10:13:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:13:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:13:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:13:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3311L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_1#3351]
         :  :  :  :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3336: string
         :  :  :  :  :     :- Project [l_returnflag_prf#3313 AS l_returnflag_prf_0#3332, l_orderkey_and_l_linenumber_prf#3314 AS l_orderkey_and_l_linenumber_prf_0#3333, l_comment_prf#3315 AS l_comment_prf_0#3334, l_linestatus_prf#3316 AS l_linestatus_prf_0#3335, rid#3317 AS rid_0#3336, l_shipmode_prf#3318 AS l_shipmode_prf_0#3337, l_shipinstruct_prf#3319 AS l_shipinstruct_prf_0#3338, l_quantity_prf#3320 AS l_quantity_prf_0#3339, l_receiptdate_prf#3321 AS l_receiptdate_prf_0#3340, l_linenumber_prf#3322 AS l_linenumber_prf_0#3341, l_tax_prf#3323 AS l_tax_prf_0#3342, l_shipdate_prf#3324 AS l_shipdate_prf_0#3343, l_extendedprice_prf#3325 AS l_extendedprice_prf_0#3344, l_partkey_prf#3326 AS l_partkey_prf_0#3345, l_discount_prf#3327 AS l_discount_prf_0#3346, l_partkey_and_l_suppkey_prf#3328 AS l_partkey_and_l_suppkey_prf_0#3347, l_commitdate_prf#3329 AS l_commitdate_prf_0#3348, l_suppkey_prf#3330 AS l_suppkey_prf_0#3349, l_orderkey_prf#3331 AS l_orderkey_prf_0#3350]
         :  :  :  :  :     :  +- Relation[l_returnflag_prf#3313,l_orderkey_and_l_linenumber_prf#3314,l_comment_prf#3315,l_linestatus_prf#3316,rid#3317,l_shipmode_prf#3318,l_shipinstruct_prf#3319,l_quantity_prf#3320,l_receiptdate_prf#3321,l_linenumber_prf#3322,l_tax_prf#3323,l_shipdate_prf#3324,l_extendedprice_prf#3325,l_partkey_prf#3326,l_discount_prf#3327,l_partkey_and_l_suppkey_prf#3328,l_commitdate_prf#3329,l_suppkey_prf#3330,l_orderkey_prf#3331] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [o_shippriority_prf#3352 AS o_shippriority_prf_1#3362, rid#3353 AS rid_1#3363, o_orderdate_prf#3354 AS o_orderdate_prf_1#3364, o_custkey_prf#3355 AS o_custkey_prf_1#3365, o_orderpriority_prf#3356 AS o_orderpriority_prf_1#3366, o_clerk_prf#3357 AS o_clerk_prf_1#3367, o_orderstatus_prf#3358 AS o_orderstatus_prf_1#3368, o_totalprice_prf#3359 AS o_totalprice_prf_1#3369, o_orderkey_prf#3360 AS o_orderkey_prf_1#3370, o_comment_prf#3361 AS o_comment_prf_1#3371]
         :  :  :  :     +- Relation[o_shippriority_prf#3352,rid#3353,o_orderdate_prf#3354,o_custkey_prf#3355,o_orderpriority_prf#3356,o_clerk_prf#3357,o_orderstatus_prf#3358,o_totalprice_prf#3359,o_orderkey_prf#3360,o_comment_prf#3361] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1816) AS rid_2#3383]
         :  :  :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :  :  :        :- 'Project ['rid AS rid_1#3382]
         :  :  :        :  +- Relation[o_shippriority_prf#3372,rid#3373,o_orderdate_prf#3374,o_custkey_prf#3375,o_orderpriority_prf#3376,o_clerk_prf#3377,o_orderstatus_prf#3378,o_totalprice_prf#3379,o_orderkey_prf#3380,o_comment_prf#3381] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :        +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#3384 AS c_acctbal_prf_2#3393, rid#3385 AS rid_2#3394, c_name_prf#3386 AS c_name_prf_2#3395, c_nationkey_prf#3387 AS c_nationkey_prf_2#3396, c_custkey_prf#3388 AS c_custkey_prf_2#3397, c_comment_prf#3389 AS c_comment_prf_2#3398, c_address_prf#3390 AS c_address_prf_2#3399, c_mktsegment_prf#3391 AS c_mktsegment_prf_2#3400, c_phone_prf#3392 AS c_phone_prf_2#3401]
         :  :     +- Relation[c_acctbal_prf#3384,rid#3385,c_name_prf#3386,c_nationkey_prf#3387,c_custkey_prf#3388,c_comment_prf#3389,c_address_prf#3390,c_mktsegment_prf#3391,c_phone_prf#3392] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1816) AS rid_3#3412]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#3411]
         :        :  +- Relation[c_acctbal_prf#3402,rid#3403,c_name_prf#3404,c_nationkey_prf#3405,c_custkey_prf#3406,c_comment_prf#3407,c_address_prf#3408,c_mktsegment_prf#3409,c_phone_prf#3410] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_3))
            :- Project [rid#3413 AS rid_3#3418, n_regionkey_prf#3414 AS n_regionkey_prf_3#3419, n_nationkey_prf#3415 AS n_nationkey_prf_3#3420, n_name_prf#3416 AS n_name_prf_3#3421, n_comment_prf#3417 AS n_comment_prf_3#3422]
            :  +- Relation[rid#3413,n_regionkey_prf#3414,n_nationkey_prf#3415,n_name_prf#3416,n_comment_prf#3417] JDBCRelation(nation_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#3423]
               +- DexRidFilter nation~n_name~FRANCE
                  +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 184058ms

fq1a=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 10:16:18 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:16:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3507L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :     :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 10:16:18 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:16:18 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:16:18 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:16:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3507L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_1#3520]
         :  :  :  :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#3514: string
         :  :  :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :     :  :- Project [rid#3509 AS rid_0#3514, n_regionkey_prf#3510 AS n_regionkey_prf_0#3515, n_nationkey_prf#3511 AS n_nationkey_prf_0#3516, n_name_prf#3512 AS n_name_prf_0#3517, n_comment_prf#3513 AS n_comment_prf_0#3518]
         :  :  :  :  :     :  :  +- Relation[rid#3509,n_regionkey_prf#3510,n_nationkey_prf#3511,n_name_prf#3512,n_comment_prf#3513] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3519]
         :  :  :  :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :  :  :  :  :     :        +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :  :  :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [c_acctbal_prf#3521 AS c_acctbal_prf_1#3530, rid#3522 AS rid_1#3531, c_name_prf#3523 AS c_name_prf_1#3532, c_nationkey_prf#3524 AS c_nationkey_prf_1#3533, c_custkey_prf#3525 AS c_custkey_prf_1#3534, c_comment_prf#3526 AS c_comment_prf_1#3535, c_address_prf#3527 AS c_address_prf_1#3536, c_mktsegment_prf#3528 AS c_mktsegment_prf_1#3537, c_phone_prf#3529 AS c_phone_prf_1#3538]
         :  :  :  :     +- Relation[c_acctbal_prf#3521,rid#3522,c_name_prf#3523,c_nationkey_prf#3524,c_custkey_prf#3525,c_comment_prf#3526,c_address_prf#3527,c_mktsegment_prf#3528,c_phone_prf#3529] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1816) AS rid_2#3549]
         :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :  :  :        :- 'Project ['rid AS rid_1#3548]
         :  :  :        :  +- Relation[c_acctbal_prf#3539,rid#3540,c_name_prf#3541,c_nationkey_prf#3542,c_custkey_prf#3543,c_comment_prf#3544,c_address_prf#3545,c_mktsegment_prf#3546,c_phone_prf#3547] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :        +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#3550 AS o_shippriority_prf_2#3560, rid#3551 AS rid_2#3561, o_orderdate_prf#3552 AS o_orderdate_prf_2#3562, o_custkey_prf#3553 AS o_custkey_prf_2#3563, o_orderpriority_prf#3554 AS o_orderpriority_prf_2#3564, o_clerk_prf#3555 AS o_clerk_prf_2#3565, o_orderstatus_prf#3556 AS o_orderstatus_prf_2#3566, o_totalprice_prf#3557 AS o_totalprice_prf_2#3567, o_orderkey_prf#3558 AS o_orderkey_prf_2#3568, o_comment_prf#3559 AS o_comment_prf_2#3569]
         :  :     +- Relation[o_shippriority_prf#3550,rid#3551,o_orderdate_prf#3552,o_custkey_prf#3553,o_orderpriority_prf#3554,o_clerk_prf#3555,o_orderstatus_prf#3556,o_totalprice_prf#3557,o_orderkey_prf#3558,o_comment_prf#3559] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1816) AS rid_3#3581]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#3580]
         :        :  +- Relation[o_shippriority_prf#3570,rid#3571,o_orderdate_prf#3572,o_custkey_prf#3573,o_orderpriority_prf#3574,o_clerk_prf#3575,o_orderstatus_prf#3576,o_totalprice_prf#3577,o_orderkey_prf#3578,o_comment_prf#3579] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3582 AS l_returnflag_prf_3#3601, l_orderkey_and_l_linenumber_prf#3583 AS l_orderkey_and_l_linenumber_prf_3#3602, l_comment_prf#3584 AS l_comment_prf_3#3603, l_linestatus_prf#3585 AS l_linestatus_prf_3#3604, rid#3586 AS rid_3#3605, l_shipmode_prf#3587 AS l_shipmode_prf_3#3606, l_shipinstruct_prf#3588 AS l_shipinstruct_prf_3#3607, l_quantity_prf#3589 AS l_quantity_prf_3#3608, l_receiptdate_prf#3590 AS l_receiptdate_prf_3#3609, l_linenumber_prf#3591 AS l_linenumber_prf_3#3610, l_tax_prf#3592 AS l_tax_prf_3#3611, l_shipdate_prf#3593 AS l_shipdate_prf_3#3612, l_extendedprice_prf#3594 AS l_extendedprice_prf_3#3613, l_partkey_prf#3595 AS l_partkey_prf_3#3614, l_discount_prf#3596 AS l_discount_prf_3#3615, l_partkey_and_l_suppkey_prf#3597 AS l_partkey_and_l_suppkey_prf_3#3616, l_commitdate_prf#3598 AS l_commitdate_prf_3#3617, l_suppkey_prf#3599 AS l_suppkey_prf_3#3618, l_orderkey_prf#3600 AS l_orderkey_prf_3#3619]
            +- Relation[l_returnflag_prf#3582,l_orderkey_and_l_linenumber_prf#3583,l_comment_prf#3584,l_linestatus_prf#3585,rid#3586,l_shipmode_prf#3587,l_shipinstruct_prf#3588,l_quantity_prf#3589,l_receiptdate_prf#3590,l_linenumber_prf#3591,l_tax_prf#3592,l_shipdate_prf#3593,l_extendedprice_prf#3594,l_partkey_prf#3595,l_discount_prf#3596,l_partkey_and_l_suppkey_prf#3597,l_commitdate_prf#3598,l_suppkey_prf#3599,l_orderkey_prf#3600] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 163928ms

fr1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and (c_mktsegment = 'BUILDING' and l_orderkey = o_orderkey)
19/10/16 10:19:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:19:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3699L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 10:19:02 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 10:19:02 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 10:19:02 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 10:19:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3699L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_2#3739]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3724: string
         :     :- Project [l_returnflag_prf#3701 AS l_returnflag_prf_0#3720, l_orderkey_and_l_linenumber_prf#3702 AS l_orderkey_and_l_linenumber_prf_0#3721, l_comment_prf#3703 AS l_comment_prf_0#3722, l_linestatus_prf#3704 AS l_linestatus_prf_0#3723, rid#3705 AS rid_0#3724, l_shipmode_prf#3706 AS l_shipmode_prf_0#3725, l_shipinstruct_prf#3707 AS l_shipinstruct_prf_0#3726, l_quantity_prf#3708 AS l_quantity_prf_0#3727, l_receiptdate_prf#3709 AS l_receiptdate_prf_0#3728, l_linenumber_prf#3710 AS l_linenumber_prf_0#3729, l_tax_prf#3711 AS l_tax_prf_0#3730, l_shipdate_prf#3712 AS l_shipdate_prf_0#3731, l_extendedprice_prf#3713 AS l_extendedprice_prf_0#3732, l_partkey_prf#3714 AS l_partkey_prf_0#3733, l_discount_prf#3715 AS l_discount_prf_0#3734, l_partkey_and_l_suppkey_prf#3716 AS l_partkey_and_l_suppkey_prf_0#3735, l_commitdate_prf#3717 AS l_commitdate_prf_0#3736, l_suppkey_prf#3718 AS l_suppkey_prf_0#3737, l_orderkey_prf#3719 AS l_orderkey_prf_0#3738]
         :     :  +- Relation[l_returnflag_prf#3701,l_orderkey_and_l_linenumber_prf#3702,l_comment_prf#3703,l_linestatus_prf#3704,rid#3705,l_shipmode_prf#3706,l_shipinstruct_prf#3707,l_quantity_prf#3708,l_receiptdate_prf#3709,l_linenumber_prf#3710,l_tax_prf#3711,l_shipdate_prf#3712,l_extendedprice_prf#3713,l_partkey_prf#3714,l_discount_prf#3715,l_partkey_and_l_suppkey_prf#3716,l_commitdate_prf#3717,l_suppkey_prf#3718,l_orderkey_prf#3719] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1816) AS rid_2#3759]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#3750: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [c_acctbal_prf#3740 AS c_acctbal_prf_1#3749, rid#3741 AS rid_1#3750, c_name_prf#3742 AS c_name_prf_1#3751, c_nationkey_prf#3743 AS c_nationkey_prf_1#3752, c_custkey_prf#3744 AS c_custkey_prf_1#3753, c_comment_prf#3745 AS c_comment_prf_1#3754, c_address_prf#3746 AS c_address_prf_1#3755, c_mktsegment_prf#3747 AS c_mktsegment_prf_1#3756, c_phone_prf#3748 AS c_phone_prf_1#3757]
            :     :  :  +- Relation[c_acctbal_prf#3740,rid#3741,c_name_prf#3742,c_nationkey_prf#3743,c_custkey_prf#3744,c_comment_prf#3745,c_address_prf#3746,c_mktsegment_prf#3747,c_phone_prf#3748] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3758]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3760 AS o_shippriority_prf_2#3770, rid#3761 AS rid_2#3771, o_orderdate_prf#3762 AS o_orderdate_prf_2#3772, o_custkey_prf#3763 AS o_custkey_prf_2#3773, o_orderpriority_prf#3764 AS o_orderpriority_prf_2#3774, o_clerk_prf#3765 AS o_clerk_prf_2#3775, o_orderstatus_prf#3766 AS o_orderstatus_prf_2#3776, o_totalprice_prf#3767 AS o_totalprice_prf_2#3777, o_orderkey_prf#3768 AS o_orderkey_prf_2#3778, o_comment_prf#3769 AS o_comment_prf_2#3779]
               +- Relation[o_shippriority_prf#3760,rid#3761,o_orderdate_prf#3762,o_custkey_prf#3763,o_orderpriority_prf#3764,o_clerk_prf#3765,o_orderstatus_prf#3766,o_totalprice_prf#3767,o_orderkey_prf#3768,o_comment_prf#3769] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 99487ms

fr1e=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and (o_orderkey = l_orderkey and c_custkey = o_custkey)
19/10/16 10:20:41 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:20:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3854L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 10:20:41 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 10:20:41 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 10:20:41 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 10:20:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3854L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_1#3875]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3866: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [c_acctbal_prf#3856 AS c_acctbal_prf_0#3865, rid#3857 AS rid_0#3866, c_name_prf#3858 AS c_name_prf_0#3867, c_nationkey_prf#3859 AS c_nationkey_prf_0#3868, c_custkey_prf#3860 AS c_custkey_prf_0#3869, c_comment_prf#3861 AS c_comment_prf_0#3870, c_address_prf#3862 AS c_address_prf_0#3871, c_mktsegment_prf#3863 AS c_mktsegment_prf_0#3872, c_phone_prf#3864 AS c_phone_prf_0#3873]
         :     :  :  +- Relation[c_acctbal_prf#3856,rid#3857,c_name_prf#3858,c_nationkey_prf#3859,c_custkey_prf#3860,c_comment_prf#3861,c_address_prf#3862,c_mktsegment_prf#3863,c_phone_prf#3864] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3874]
         :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :        +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1816) AS rid_2#3896]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#3887: string
            :     :- Project [o_shippriority_prf#3876 AS o_shippriority_prf_1#3886, rid#3877 AS rid_1#3887, o_orderdate_prf#3878 AS o_orderdate_prf_1#3888, o_custkey_prf#3879 AS o_custkey_prf_1#3889, o_orderpriority_prf#3880 AS o_orderpriority_prf_1#3890, o_clerk_prf#3881 AS o_clerk_prf_1#3891, o_orderstatus_prf#3882 AS o_orderstatus_prf_1#3892, o_totalprice_prf#3883 AS o_totalprice_prf_1#3893, o_orderkey_prf#3884 AS o_orderkey_prf_1#3894, o_comment_prf#3885 AS o_comment_prf_1#3895]
            :     :  +- Relation[o_shippriority_prf#3876,rid#3877,o_orderdate_prf#3878,o_custkey_prf#3879,o_orderpriority_prf#3880,o_clerk_prf#3881,o_orderstatus_prf#3882,o_totalprice_prf#3883,o_orderkey_prf#3884,o_comment_prf#3885] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3897 AS l_returnflag_prf_2#3916, l_orderkey_and_l_linenumber_prf#3898 AS l_orderkey_and_l_linenumber_prf_2#3917, l_comment_prf#3899 AS l_comment_prf_2#3918, l_linestatus_prf#3900 AS l_linestatus_prf_2#3919, rid#3901 AS rid_2#3920, l_shipmode_prf#3902 AS l_shipmode_prf_2#3921, l_shipinstruct_prf#3903 AS l_shipinstruct_prf_2#3922, l_quantity_prf#3904 AS l_quantity_prf_2#3923, l_receiptdate_prf#3905 AS l_receiptdate_prf_2#3924, l_linenumber_prf#3906 AS l_linenumber_prf_2#3925, l_tax_prf#3907 AS l_tax_prf_2#3926, l_shipdate_prf#3908 AS l_shipdate_prf_2#3927, l_extendedprice_prf#3909 AS l_extendedprice_prf_2#3928, l_partkey_prf#3910 AS l_partkey_prf_2#3929, l_discount_prf#3911 AS l_discount_prf_2#3930, l_partkey_and_l_suppkey_prf#3912 AS l_partkey_and_l_suppkey_prf_2#3931, l_commitdate_prf#3913 AS l_commitdate_prf_2#3932, l_suppkey_prf#3914 AS l_suppkey_prf_2#3933, l_orderkey_prf#3915 AS l_orderkey_prf_2#3934]
               +- Relation[l_returnflag_prf#3897,l_orderkey_and_l_linenumber_prf#3898,l_comment_prf#3899,l_linestatus_prf#3900,rid#3901,l_shipmode_prf#3902,l_shipinstruct_prf#3903,l_quantity_prf#3904,l_receiptdate_prf#3905,l_linenumber_prf#3906,l_tax_prf#3907,l_shipdate_prf#3908,l_extendedprice_prf#3909,l_partkey_prf#3910,l_discount_prf#3911,l_partkey_and_l_suppkey_prf#3912,l_commitdate_prf#3913,l_suppkey_prf#3914,l_orderkey_prf#3915] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 203418ms

fq1e=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 10:24:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:24:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4013L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [c_custkey#290L, c_nationkey#293L]
                  +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 10:24:05 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:24:05 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:24:05 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:24:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4013L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_1#4053]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4038: string
         :  :  :     :- Project [l_returnflag_prf#4015 AS l_returnflag_prf_0#4034, l_orderkey_and_l_linenumber_prf#4016 AS l_orderkey_and_l_linenumber_prf_0#4035, l_comment_prf#4017 AS l_comment_prf_0#4036, l_linestatus_prf#4018 AS l_linestatus_prf_0#4037, rid#4019 AS rid_0#4038, l_shipmode_prf#4020 AS l_shipmode_prf_0#4039, l_shipinstruct_prf#4021 AS l_shipinstruct_prf_0#4040, l_quantity_prf#4022 AS l_quantity_prf_0#4041, l_receiptdate_prf#4023 AS l_receiptdate_prf_0#4042, l_linenumber_prf#4024 AS l_linenumber_prf_0#4043, l_tax_prf#4025 AS l_tax_prf_0#4044, l_shipdate_prf#4026 AS l_shipdate_prf_0#4045, l_extendedprice_prf#4027 AS l_extendedprice_prf_0#4046, l_partkey_prf#4028 AS l_partkey_prf_0#4047, l_discount_prf#4029 AS l_discount_prf_0#4048, l_partkey_and_l_suppkey_prf#4030 AS l_partkey_and_l_suppkey_prf_0#4049, l_commitdate_prf#4031 AS l_commitdate_prf_0#4050, l_suppkey_prf#4032 AS l_suppkey_prf_0#4051, l_orderkey_prf#4033 AS l_orderkey_prf_0#4052]
         :  :  :     :  +- Relation[l_returnflag_prf#4015,l_orderkey_and_l_linenumber_prf#4016,l_comment_prf#4017,l_linestatus_prf#4018,rid#4019,l_shipmode_prf#4020,l_shipinstruct_prf#4021,l_quantity_prf#4022,l_receiptdate_prf#4023,l_linenumber_prf#4024,l_tax_prf#4025,l_shipdate_prf#4026,l_extendedprice_prf#4027,l_partkey_prf#4028,l_discount_prf#4029,l_partkey_and_l_suppkey_prf#4030,l_commitdate_prf#4031,l_suppkey_prf#4032,l_orderkey_prf#4033] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#4054 AS o_shippriority_prf_1#4064, rid#4055 AS rid_1#4065, o_orderdate_prf#4056 AS o_orderdate_prf_1#4066, o_custkey_prf#4057 AS o_custkey_prf_1#4067, o_orderpriority_prf#4058 AS o_orderpriority_prf_1#4068, o_clerk_prf#4059 AS o_clerk_prf_1#4069, o_orderstatus_prf#4060 AS o_orderstatus_prf_1#4070, o_totalprice_prf#4061 AS o_totalprice_prf_1#4071, o_orderkey_prf#4062 AS o_orderkey_prf_1#4072, o_comment_prf#4063 AS o_comment_prf_1#4073]
         :  :     +- Relation[o_shippriority_prf#4054,rid#4055,o_orderdate_prf#4056,o_custkey_prf#4057,o_orderpriority_prf#4058,o_clerk_prf#4059,o_orderstatus_prf#4060,o_totalprice_prf#4061,o_orderkey_prf#4062,o_comment_prf#4063] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1816) AS rid_3#4085]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4084]
         :        :  +- Relation[o_shippriority_prf#4074,rid#4075,o_orderdate_prf#4076,o_custkey_prf#4077,o_orderpriority_prf#4078,o_clerk_prf#4079,o_orderstatus_prf#4080,o_totalprice_prf#4081,o_orderkey_prf#4082,o_comment_prf#4083] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_2, 'n_regionkey_prf_2, 'n_nationkey_prf_2, 'n_name_prf_2, 'n_comment_prf_2, dexdecrypt('value_dec_key, value#1816) AS rid_3#4097]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_2#4091: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [rid#4086 AS rid_2#4091, n_regionkey_prf#4087 AS n_regionkey_prf_2#4092, n_nationkey_prf#4088 AS n_nationkey_prf_2#4093, n_name_prf#4089 AS n_name_prf_2#4094, n_comment_prf#4090 AS n_comment_prf_2#4095]
            :     :  :  +- Relation[rid#4086,n_regionkey_prf#4087,n_nationkey_prf#4088,n_name_prf#4089,n_comment_prf#4090] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#4096]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4098 AS c_acctbal_prf_3#4107, rid#4099 AS rid_3#4108, c_name_prf#4100 AS c_name_prf_3#4109, c_nationkey_prf#4101 AS c_nationkey_prf_3#4110, c_custkey_prf#4102 AS c_custkey_prf_3#4111, c_comment_prf#4103 AS c_comment_prf_3#4112, c_address_prf#4104 AS c_address_prf_3#4113, c_mktsegment_prf#4105 AS c_mktsegment_prf_3#4114, c_phone_prf#4106 AS c_phone_prf_3#4115]
               +- Relation[c_acctbal_prf#4098,rid#4099,c_name_prf#4100,c_nationkey_prf#4101,c_custkey_prf#4102,c_comment_prf#4103,c_address_prf#4104,c_mktsegment_prf#4105,c_phone_prf#4106] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 181289ms

ft1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/16 10:27:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:27:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4181L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/16 10:27:06 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:27:06 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 10:27:06 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 10:27:06 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:27:06 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:27:06 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:27:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4181L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_2#4201]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#4193: string
         :     :- Project [c_acctbal_prf#4183 AS c_acctbal_prf_0#4192, rid#4184 AS rid_0#4193, c_name_prf#4185 AS c_name_prf_0#4194, c_nationkey_prf#4186 AS c_nationkey_prf_0#4195, c_custkey_prf#4187 AS c_custkey_prf_0#4196, c_comment_prf#4188 AS c_comment_prf_0#4197, c_address_prf#4189 AS c_address_prf_0#4198, c_mktsegment_prf#4190 AS c_mktsegment_prf_0#4199, c_phone_prf#4191 AS c_phone_prf_0#4200]
         :     :  +- Relation[c_acctbal_prf#4183,rid#4184,c_name_prf#4185,c_nationkey_prf#4186,c_custkey_prf#4187,c_comment_prf#4188,c_address_prf#4189,c_mktsegment_prf#4190,c_phone_prf#4191] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1816) AS rid_2#4218]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#4211: string
            :     :- Project [s_phone_prf#4202 AS s_phone_prf_1#4210, rid#4203 AS rid_1#4211, s_address_prf#4204 AS s_address_prf_1#4212, s_nationkey_prf#4205 AS s_nationkey_prf_1#4213, s_suppkey_prf#4206 AS s_suppkey_prf_1#4214, s_name_prf#4207 AS s_name_prf_1#4215, s_acctbal_prf#4208 AS s_acctbal_prf_1#4216, s_comment_prf#4209 AS s_comment_prf_1#4217]
            :     :  +- Relation[s_phone_prf#4202,rid#4203,s_address_prf#4204,s_nationkey_prf#4205,s_suppkey_prf#4206,s_name_prf#4207,s_acctbal_prf#4208,s_comment_prf#4209] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [rid#4219 AS rid_2#4224, n_regionkey_prf#4220 AS n_regionkey_prf_2#4225, n_nationkey_prf#4221 AS n_nationkey_prf_2#4226, n_name_prf#4222 AS n_name_prf_2#4227, n_comment_prf#4223 AS n_comment_prf_2#4228]
               :  +- Relation[rid#4219,n_regionkey_prf#4220,n_nationkey_prf#4221,n_name_prf#4222,n_comment_prf#4223] JDBCRelation(nation_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#4229]
                  +- DexRidFilter nation~n_name~FRANCE
                     +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 33513ms

fq1c=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 10:27:39 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:27:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4292L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [c_nationkey#293L, o_orderkey#342L]
               :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :     :- Project [c_custkey#290L, c_nationkey#293L]
               :     :  +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
               :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               :     +- Project [o_orderkey#342L, o_custkey#343L]
               :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 10:27:39 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:27:39 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:27:39 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:27:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4292L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_1#4305]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#4299: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [rid#4294 AS rid_0#4299, n_regionkey_prf#4295 AS n_regionkey_prf_0#4300, n_nationkey_prf#4296 AS n_nationkey_prf_0#4301, n_name_prf#4297 AS n_name_prf_0#4302, n_comment_prf#4298 AS n_comment_prf_0#4303]
         :     :  :  +- Relation[rid#4294,n_regionkey_prf#4295,n_nationkey_prf#4296,n_name_prf#4297,n_comment_prf#4298] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4304]
         :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :        +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join NaturalJoin(Inner)
            :  :  :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1816) AS rid_2#4324]
            :  :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#4316: string
            :  :  :     :- Project [c_acctbal_prf#4306 AS c_acctbal_prf_1#4315, rid#4307 AS rid_1#4316, c_name_prf#4308 AS c_name_prf_1#4317, c_nationkey_prf#4309 AS c_nationkey_prf_1#4318, c_custkey_prf#4310 AS c_custkey_prf_1#4319, c_comment_prf#4311 AS c_comment_prf_1#4320, c_address_prf#4312 AS c_address_prf_1#4321, c_mktsegment_prf#4313 AS c_mktsegment_prf_1#4322, c_phone_prf#4314 AS c_phone_prf_1#4323]
            :  :  :     :  +- Relation[c_acctbal_prf#4306,rid#4307,c_name_prf#4308,c_nationkey_prf#4309,c_custkey_prf#4310,c_comment_prf#4311,c_address_prf#4312,c_mktsegment_prf#4313,c_phone_prf#4314] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
            :  :  +- Project [o_shippriority_prf#4325 AS o_shippriority_prf_2#4335, rid#4326 AS rid_2#4336, o_orderdate_prf#4327 AS o_orderdate_prf_2#4337, o_custkey_prf#4328 AS o_custkey_prf_2#4338, o_orderpriority_prf#4329 AS o_orderpriority_prf_2#4339, o_clerk_prf#4330 AS o_clerk_prf_2#4340, o_orderstatus_prf#4331 AS o_orderstatus_prf_2#4341, o_totalprice_prf#4332 AS o_totalprice_prf_2#4342, o_orderkey_prf#4333 AS o_orderkey_prf_2#4343, o_comment_prf#4334 AS o_comment_prf_2#4344]
            :  :     +- Relation[o_shippriority_prf#4325,rid#4326,o_orderdate_prf#4327,o_custkey_prf#4328,o_orderpriority_prf#4329,o_clerk_prf#4330,o_orderstatus_prf#4331,o_totalprice_prf#4332,o_orderkey_prf#4333,o_comment_prf#4334] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1816) AS rid_3#4356]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#4355]
            :        :  +- Relation[o_shippriority_prf#4345,rid#4346,o_orderdate_prf#4347,o_custkey_prf#4348,o_orderpriority_prf#4349,o_clerk_prf#4350,o_orderstatus_prf#4351,o_totalprice_prf#4352,o_orderkey_prf#4353,o_comment_prf#4354] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4357 AS l_returnflag_prf_3#4376, l_orderkey_and_l_linenumber_prf#4358 AS l_orderkey_and_l_linenumber_prf_3#4377, l_comment_prf#4359 AS l_comment_prf_3#4378, l_linestatus_prf#4360 AS l_linestatus_prf_3#4379, rid#4361 AS rid_3#4380, l_shipmode_prf#4362 AS l_shipmode_prf_3#4381, l_shipinstruct_prf#4363 AS l_shipinstruct_prf_3#4382, l_quantity_prf#4364 AS l_quantity_prf_3#4383, l_receiptdate_prf#4365 AS l_receiptdate_prf_3#4384, l_linenumber_prf#4366 AS l_linenumber_prf_3#4385, l_tax_prf#4367 AS l_tax_prf_3#4386, l_shipdate_prf#4368 AS l_shipdate_prf_3#4387, l_extendedprice_prf#4369 AS l_extendedprice_prf_3#4388, l_partkey_prf#4370 AS l_partkey_prf_3#4389, l_discount_prf#4371 AS l_discount_prf_3#4390, l_partkey_and_l_suppkey_prf#4372 AS l_partkey_and_l_suppkey_prf_3#4391, l_commitdate_prf#4373 AS l_commitdate_prf_3#4392, l_suppkey_prf#4374 AS l_suppkey_prf_3#4393, l_orderkey_prf#4375 AS l_orderkey_prf_3#4394]
               +- Relation[l_returnflag_prf#4357,l_orderkey_and_l_linenumber_prf#4358,l_comment_prf#4359,l_linestatus_prf#4360,rid#4361,l_shipmode_prf#4362,l_shipinstruct_prf#4363,l_quantity_prf#4364,l_receiptdate_prf#4365,l_linenumber_prf#4366,l_tax_prf#4367,l_shipdate_prf#4368,l_extendedprice_prf#4369,l_partkey_prf#4370,l_discount_prf#4371,l_partkey_and_l_suppkey_prf#4372,l_commitdate_prf#4373,l_suppkey_prf#4374,l_orderkey_prf#4375] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 229954ms

fr2d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderstatus = 'F' and o_orderkey = l_orderkey
19/10/16 10:31:29 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:31:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4474L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 10:31:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4474L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_1#4494]
         :  :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4486: string
         :  :  :     :- Project [c_acctbal_prf#4476 AS c_acctbal_prf_0#4485, rid#4477 AS rid_0#4486, c_name_prf#4478 AS c_name_prf_0#4487, c_nationkey_prf#4479 AS c_nationkey_prf_0#4488, c_custkey_prf#4480 AS c_custkey_prf_0#4489, c_comment_prf#4481 AS c_comment_prf_0#4490, c_address_prf#4482 AS c_address_prf_0#4491, c_mktsegment_prf#4483 AS c_mktsegment_prf_0#4492, c_phone_prf#4484 AS c_phone_prf_0#4493]
         :  :  :     :  +- Relation[c_acctbal_prf#4476,rid#4477,c_name_prf#4478,c_nationkey_prf#4479,c_custkey_prf#4480,c_comment_prf#4481,c_address_prf#4482,c_mktsegment_prf#4483,c_phone_prf#4484] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :     :- Project [o_shippriority_prf#4495 AS o_shippriority_prf_1#4505, rid#4496 AS rid_1#4506, o_orderdate_prf#4497 AS o_orderdate_prf_1#4507, o_custkey_prf#4498 AS o_custkey_prf_1#4508, o_orderpriority_prf#4499 AS o_orderpriority_prf_1#4509, o_clerk_prf#4500 AS o_clerk_prf_1#4510, o_orderstatus_prf#4501 AS o_orderstatus_prf_1#4511, o_totalprice_prf#4502 AS o_totalprice_prf_1#4512, o_orderkey_prf#4503 AS o_orderkey_prf_1#4513, o_comment_prf#4504 AS o_comment_prf_1#4514]
         :  :     :  +- Relation[o_shippriority_prf#4495,rid#4496,o_orderdate_prf#4497,o_custkey_prf#4498,o_orderpriority_prf#4499,o_clerk_prf#4500,o_orderstatus_prf#4501,o_totalprice_prf#4502,o_orderkey_prf#4503,o_comment_prf#4504] JDBCRelation(orders_prf) [numPartitions=1]
         :  :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4515]
         :  :        +- DexRidFilter orders~o_orderstatus~F
         :  :           +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1816) AS rid_2#4527]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4526]
         :        :  +- Relation[o_shippriority_prf#4516,rid#4517,o_orderdate_prf#4518,o_custkey_prf#4519,o_orderpriority_prf#4520,o_clerk_prf#4521,o_orderstatus_prf#4522,o_totalprice_prf#4523,o_orderkey_prf#4524,o_comment_prf#4525] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4528 AS l_returnflag_prf_2#4547, l_orderkey_and_l_linenumber_prf#4529 AS l_orderkey_and_l_linenumber_prf_2#4548, l_comment_prf#4530 AS l_comment_prf_2#4549, l_linestatus_prf#4531 AS l_linestatus_prf_2#4550, rid#4532 AS rid_2#4551, l_shipmode_prf#4533 AS l_shipmode_prf_2#4552, l_shipinstruct_prf#4534 AS l_shipinstruct_prf_2#4553, l_quantity_prf#4535 AS l_quantity_prf_2#4554, l_receiptdate_prf#4536 AS l_receiptdate_prf_2#4555, l_linenumber_prf#4537 AS l_linenumber_prf_2#4556, l_tax_prf#4538 AS l_tax_prf_2#4557, l_shipdate_prf#4539 AS l_shipdate_prf_2#4558, l_extendedprice_prf#4540 AS l_extendedprice_prf_2#4559, l_partkey_prf#4541 AS l_partkey_prf_2#4560, l_discount_prf#4542 AS l_discount_prf_2#4561, l_partkey_and_l_suppkey_prf#4543 AS l_partkey_and_l_suppkey_prf_2#4562, l_commitdate_prf#4544 AS l_commitdate_prf_2#4563, l_suppkey_prf#4545 AS l_suppkey_prf_2#4564, l_orderkey_prf#4546 AS l_orderkey_prf_2#4565]
            +- Relation[l_returnflag_prf#4528,l_orderkey_and_l_linenumber_prf#4529,l_comment_prf#4530,l_linestatus_prf#4531,rid#4532,l_shipmode_prf#4533,l_shipinstruct_prf#4534,l_quantity_prf#4535,l_receiptdate_prf#4536,l_linenumber_prf#4537,l_tax_prf#4538,l_shipdate_prf#4539,l_extendedprice_prf#4540,l_partkey_prf#4541,l_discount_prf#4542,l_partkey_and_l_suppkey_prf#4543,l_commitdate_prf#4544,l_suppkey_prf#4545,l_orderkey_prf#4546] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 207708ms

ft2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and p_size = 15 and ps_suppkey = s_suppkey
19/10/16 10:34:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:34:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4628L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 10:34:57 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 10:34:57 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 10:34:57 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 10:34:57 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 10:34:57 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 10:34:57 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 10:34:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4628L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_1#4644]
         :  :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#4638: string
         :  :  :     :- Project [ps_partkey_and_ps_suppkey_prf#4630 AS ps_partkey_and_ps_suppkey_prf_0#4637, rid#4631 AS rid_0#4638, ps_availqty_prf#4632 AS ps_availqty_prf_0#4639, ps_comment_prf#4633 AS ps_comment_prf_0#4640, ps_partkey_prf#4634 AS ps_partkey_prf_0#4641, ps_supplycost_prf#4635 AS ps_supplycost_prf_0#4642, ps_suppkey_prf#4636 AS ps_suppkey_prf_0#4643]
         :  :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#4630,rid#4631,ps_availqty_prf#4632,ps_comment_prf#4633,ps_partkey_prf#4634,ps_supplycost_prf#4635,ps_suppkey_prf#4636] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :     :- Project [p_comment_prf#4645 AS p_comment_prf_1#4655, p_name_prf#4646 AS p_name_prf_1#4656, rid#4647 AS rid_1#4657, p_type_prf#4648 AS p_type_prf_1#4658, p_retailprice_prf#4649 AS p_retailprice_prf_1#4659, p_mfgr_prf#4650 AS p_mfgr_prf_1#4660, p_container_prf#4651 AS p_container_prf_1#4661, p_brand_prf#4652 AS p_brand_prf_1#4662, p_size_prf#4653 AS p_size_prf_1#4663, p_partkey_prf#4654 AS p_partkey_prf_1#4664]
         :  :     :  +- Relation[p_comment_prf#4645,p_name_prf#4646,rid#4647,p_type_prf#4648,p_retailprice_prf#4649,p_mfgr_prf#4650,p_container_prf#4651,p_brand_prf#4652,p_size_prf#4653,p_partkey_prf#4654] JDBCRelation(part_prf) [numPartitions=1]
         :  :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4665]
         :  :        +- DexRidFilter part~p_size~15
         :  :           +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1816) AS rid_2#4674]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4673]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#4666,rid#4667,ps_availqty_prf#4668,ps_comment_prf#4669,ps_partkey_prf#4670,ps_supplycost_prf#4671,ps_suppkey_prf#4672] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4675 AS s_phone_prf_2#4683, rid#4676 AS rid_2#4684, s_address_prf#4677 AS s_address_prf_2#4685, s_nationkey_prf#4678 AS s_nationkey_prf_2#4686, s_suppkey_prf#4679 AS s_suppkey_prf_2#4687, s_name_prf#4680 AS s_name_prf_2#4688, s_acctbal_prf#4681 AS s_acctbal_prf_2#4689, s_comment_prf#4682 AS s_comment_prf_2#4690]
            +- Relation[s_phone_prf#4675,rid#4676,s_address_prf#4677,s_nationkey_prf#4678,s_suppkey_prf#4679,s_name_prf#4680,s_acctbal_prf#4681,s_comment_prf#4682] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 102212ms

ft2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and (p_size = 15 and s_suppkey = ps_suppkey)
19/10/16 10:36:39 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:36:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4740L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/16 10:36:39 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 10:36:39 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 10:36:39 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 10:36:39 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 10:36:39 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 10:36:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4740L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_2#4758]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#4751: string
         :     :- Project [s_phone_prf#4742 AS s_phone_prf_0#4750, rid#4743 AS rid_0#4751, s_address_prf#4744 AS s_address_prf_0#4752, s_nationkey_prf#4745 AS s_nationkey_prf_0#4753, s_suppkey_prf#4746 AS s_suppkey_prf_0#4754, s_name_prf#4747 AS s_name_prf_0#4755, s_acctbal_prf#4748 AS s_acctbal_prf_0#4756, s_comment_prf#4749 AS s_comment_prf_0#4757]
         :     :  +- Relation[s_phone_prf#4742,rid#4743,s_address_prf#4744,s_nationkey_prf#4745,s_suppkey_prf#4746,s_name_prf#4747,s_acctbal_prf#4748,s_comment_prf#4749] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1816) AS rid_2#4780]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#4771: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#4759 AS p_comment_prf_1#4769, p_name_prf#4760 AS p_name_prf_1#4770, rid#4761 AS rid_1#4771, p_type_prf#4762 AS p_type_prf_1#4772, p_retailprice_prf#4763 AS p_retailprice_prf_1#4773, p_mfgr_prf#4764 AS p_mfgr_prf_1#4774, p_container_prf#4765 AS p_container_prf_1#4775, p_brand_prf#4766 AS p_brand_prf_1#4776, p_size_prf#4767 AS p_size_prf_1#4777, p_partkey_prf#4768 AS p_partkey_prf_1#4778]
            :     :  :  +- Relation[p_comment_prf#4759,p_name_prf#4760,rid#4761,p_type_prf#4762,p_retailprice_prf#4763,p_mfgr_prf#4764,p_container_prf#4765,p_brand_prf#4766,p_size_prf#4767,p_partkey_prf#4768] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4779]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#4781 AS ps_partkey_and_ps_suppkey_prf_2#4788, rid#4782 AS rid_2#4789, ps_availqty_prf#4783 AS ps_availqty_prf_2#4790, ps_comment_prf#4784 AS ps_comment_prf_2#4791, ps_partkey_prf#4785 AS ps_partkey_prf_2#4792, ps_supplycost_prf#4786 AS ps_supplycost_prf_2#4793, ps_suppkey_prf#4787 AS ps_suppkey_prf_2#4794]
               +- Relation[ps_partkey_and_ps_suppkey_prf#4781,rid#4782,ps_availqty_prf#4783,ps_comment_prf#4784,ps_partkey_prf#4785,ps_supplycost_prf#4786,ps_suppkey_prf#4787] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 7687ms

ft1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_name = 'FRANCE' and n_nationkey = c_nationkey
19/10/16 10:36:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:36:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4842L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 10:36:47 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 10:36:47 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 10:36:47 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:36:47 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:36:47 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:36:47 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:36:47 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:36:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4842L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_1#4860]
         :  :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#4853: string
         :  :  :     :- Project [s_phone_prf#4844 AS s_phone_prf_0#4852, rid#4845 AS rid_0#4853, s_address_prf#4846 AS s_address_prf_0#4854, s_nationkey_prf#4847 AS s_nationkey_prf_0#4855, s_suppkey_prf#4848 AS s_suppkey_prf_0#4856, s_name_prf#4849 AS s_name_prf_0#4857, s_acctbal_prf#4850 AS s_acctbal_prf_0#4858, s_comment_prf#4851 AS s_comment_prf_0#4859]
         :  :  :     :  +- Relation[s_phone_prf#4844,rid#4845,s_address_prf#4846,s_nationkey_prf#4847,s_suppkey_prf#4848,s_name_prf#4849,s_acctbal_prf#4850,s_comment_prf#4851] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :     :- Project [rid#4861 AS rid_1#4866, n_regionkey_prf#4862 AS n_regionkey_prf_1#4867, n_nationkey_prf#4863 AS n_nationkey_prf_1#4868, n_name_prf#4864 AS n_name_prf_1#4869, n_comment_prf#4865 AS n_comment_prf_1#4870]
         :  :     :  +- Relation[rid#4861,n_regionkey_prf#4862,n_nationkey_prf#4863,n_name_prf#4864,n_comment_prf#4865] JDBCRelation(nation_prf) [numPartitions=1]
         :  :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4871]
         :  :        +- DexRidFilter nation~n_name~FRANCE
         :  :           +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1816) AS rid_2#4878]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4877]
         :        :  +- Relation[rid#4872,n_regionkey_prf#4873,n_nationkey_prf#4874,n_name_prf#4875,n_comment_prf#4876] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4879 AS c_acctbal_prf_2#4888, rid#4880 AS rid_2#4889, c_name_prf#4881 AS c_name_prf_2#4890, c_nationkey_prf#4882 AS c_nationkey_prf_2#4891, c_custkey_prf#4883 AS c_custkey_prf_2#4892, c_comment_prf#4884 AS c_comment_prf_2#4893, c_address_prf#4885 AS c_address_prf_2#4894, c_mktsegment_prf#4886 AS c_mktsegment_prf_2#4895, c_phone_prf#4887 AS c_phone_prf_2#4896]
            +- Relation[c_acctbal_prf#4879,rid#4880,c_name_prf#4881,c_nationkey_prf#4882,c_custkey_prf#4883,c_comment_prf#4884,c_address_prf#4885,c_mktsegment_prf#4886,c_phone_prf#4887] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 1474ms

ft2b=
select * from part, partsupp, supplier where p_size = 15 and p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/16 10:36:48 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:36:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4943L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 10:36:48 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 10:36:48 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 10:36:48 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 10:36:48 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 10:36:48 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 10:36:48 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 10:36:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4943L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_1#4966]
         :  :  :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4957: string
         :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :     :  :- Project [p_comment_prf#4945 AS p_comment_prf_0#4955, p_name_prf#4946 AS p_name_prf_0#4956, rid#4947 AS rid_0#4957, p_type_prf#4948 AS p_type_prf_0#4958, p_retailprice_prf#4949 AS p_retailprice_prf_0#4959, p_mfgr_prf#4950 AS p_mfgr_prf_0#4960, p_container_prf#4951 AS p_container_prf_0#4961, p_brand_prf#4952 AS p_brand_prf_0#4962, p_size_prf#4953 AS p_size_prf_0#4963, p_partkey_prf#4954 AS p_partkey_prf_0#4964]
         :  :  :     :  :  +- Relation[p_comment_prf#4945,p_name_prf#4946,rid#4947,p_type_prf#4948,p_retailprice_prf#4949,p_mfgr_prf#4950,p_container_prf#4951,p_brand_prf#4952,p_size_prf#4953,p_partkey_prf#4954] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4965]
         :  :  :     :     +- DexRidFilter part~p_size~15
         :  :  :     :        +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#4967 AS ps_partkey_and_ps_suppkey_prf_1#4974, rid#4968 AS rid_1#4975, ps_availqty_prf#4969 AS ps_availqty_prf_1#4976, ps_comment_prf#4970 AS ps_comment_prf_1#4977, ps_partkey_prf#4971 AS ps_partkey_prf_1#4978, ps_supplycost_prf#4972 AS ps_supplycost_prf_1#4979, ps_suppkey_prf#4973 AS ps_suppkey_prf_1#4980]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#4967,rid#4968,ps_availqty_prf#4969,ps_comment_prf#4970,ps_partkey_prf#4971,ps_supplycost_prf#4972,ps_suppkey_prf#4973] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1816) AS rid_2#4989]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4988]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#4981,rid#4982,ps_availqty_prf#4983,ps_comment_prf#4984,ps_partkey_prf#4985,ps_supplycost_prf#4986,ps_suppkey_prf#4987] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4990 AS s_phone_prf_2#4998, rid#4991 AS rid_2#4999, s_address_prf#4992 AS s_address_prf_2#5000, s_nationkey_prf#4993 AS s_nationkey_prf_2#5001, s_suppkey_prf#4994 AS s_suppkey_prf_2#5002, s_name_prf#4995 AS s_name_prf_2#5003, s_acctbal_prf#4996 AS s_acctbal_prf_2#5004, s_comment_prf#4997 AS s_comment_prf_2#5005]
            +- Relation[s_phone_prf#4990,rid#4991,s_address_prf#4992,s_nationkey_prf#4993,s_suppkey_prf#4994,s_name_prf#4995,s_acctbal_prf#4996,s_comment_prf#4997] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 46176ms

fr1d=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/16 10:37:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:37:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5067L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 10:37:35 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 10:37:35 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 10:37:35 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 10:37:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5067L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_1#5088]
         :  :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#5079: string
         :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :     :  :- Project [c_acctbal_prf#5069 AS c_acctbal_prf_0#5078, rid#5070 AS rid_0#5079, c_name_prf#5071 AS c_name_prf_0#5080, c_nationkey_prf#5072 AS c_nationkey_prf_0#5081, c_custkey_prf#5073 AS c_custkey_prf_0#5082, c_comment_prf#5074 AS c_comment_prf_0#5083, c_address_prf#5075 AS c_address_prf_0#5084, c_mktsegment_prf#5076 AS c_mktsegment_prf_0#5085, c_phone_prf#5077 AS c_phone_prf_0#5086]
         :  :  :     :  :  +- Relation[c_acctbal_prf#5069,rid#5070,c_name_prf#5071,c_nationkey_prf#5072,c_custkey_prf#5073,c_comment_prf#5074,c_address_prf#5075,c_mktsegment_prf#5076,c_phone_prf#5077] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5087]
         :  :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :  :  :     :        +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#5089 AS o_shippriority_prf_1#5099, rid#5090 AS rid_1#5100, o_orderdate_prf#5091 AS o_orderdate_prf_1#5101, o_custkey_prf#5092 AS o_custkey_prf_1#5102, o_orderpriority_prf#5093 AS o_orderpriority_prf_1#5103, o_clerk_prf#5094 AS o_clerk_prf_1#5104, o_orderstatus_prf#5095 AS o_orderstatus_prf_1#5105, o_totalprice_prf#5096 AS o_totalprice_prf_1#5106, o_orderkey_prf#5097 AS o_orderkey_prf_1#5107, o_comment_prf#5098 AS o_comment_prf_1#5108]
         :  :     +- Relation[o_shippriority_prf#5089,rid#5090,o_orderdate_prf#5091,o_custkey_prf#5092,o_orderpriority_prf#5093,o_clerk_prf#5094,o_orderstatus_prf#5095,o_totalprice_prf#5096,o_orderkey_prf#5097,o_comment_prf#5098] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1816) AS rid_2#5120]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5119]
         :        :  +- Relation[o_shippriority_prf#5109,rid#5110,o_orderdate_prf#5111,o_custkey_prf#5112,o_orderpriority_prf#5113,o_clerk_prf#5114,o_orderstatus_prf#5115,o_totalprice_prf#5116,o_orderkey_prf#5117,o_comment_prf#5118] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5121 AS l_returnflag_prf_2#5140, l_orderkey_and_l_linenumber_prf#5122 AS l_orderkey_and_l_linenumber_prf_2#5141, l_comment_prf#5123 AS l_comment_prf_2#5142, l_linestatus_prf#5124 AS l_linestatus_prf_2#5143, rid#5125 AS rid_2#5144, l_shipmode_prf#5126 AS l_shipmode_prf_2#5145, l_shipinstruct_prf#5127 AS l_shipinstruct_prf_2#5146, l_quantity_prf#5128 AS l_quantity_prf_2#5147, l_receiptdate_prf#5129 AS l_receiptdate_prf_2#5148, l_linenumber_prf#5130 AS l_linenumber_prf_2#5149, l_tax_prf#5131 AS l_tax_prf_2#5150, l_shipdate_prf#5132 AS l_shipdate_prf_2#5151, l_extendedprice_prf#5133 AS l_extendedprice_prf_2#5152, l_partkey_prf#5134 AS l_partkey_prf_2#5153, l_discount_prf#5135 AS l_discount_prf_2#5154, l_partkey_and_l_suppkey_prf#5136 AS l_partkey_and_l_suppkey_prf_2#5155, l_commitdate_prf#5137 AS l_commitdate_prf_2#5156, l_suppkey_prf#5138 AS l_suppkey_prf_2#5157, l_orderkey_prf#5139 AS l_orderkey_prf_2#5158]
            +- Relation[l_returnflag_prf#5121,l_orderkey_and_l_linenumber_prf#5122,l_comment_prf#5123,l_linestatus_prf#5124,rid#5125,l_shipmode_prf#5126,l_shipinstruct_prf#5127,l_quantity_prf#5128,l_receiptdate_prf#5129,l_linenumber_prf#5130,l_tax_prf#5131,l_shipdate_prf#5132,l_extendedprice_prf#5133,l_partkey_prf#5134,l_discount_prf#5135,l_partkey_and_l_suppkey_prf#5136,l_commitdate_prf#5137,l_suppkey_prf#5138,l_orderkey_prf#5139] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 151918ms

fr1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey and c_mktsegment = 'BUILDING'
19/10/16 10:40:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:40:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5233L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 10:40:07 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 10:40:07 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 10:40:07 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 10:40:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5233L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_1#5273]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#5258: string
         :  :  :     :- Project [l_returnflag_prf#5235 AS l_returnflag_prf_0#5254, l_orderkey_and_l_linenumber_prf#5236 AS l_orderkey_and_l_linenumber_prf_0#5255, l_comment_prf#5237 AS l_comment_prf_0#5256, l_linestatus_prf#5238 AS l_linestatus_prf_0#5257, rid#5239 AS rid_0#5258, l_shipmode_prf#5240 AS l_shipmode_prf_0#5259, l_shipinstruct_prf#5241 AS l_shipinstruct_prf_0#5260, l_quantity_prf#5242 AS l_quantity_prf_0#5261, l_receiptdate_prf#5243 AS l_receiptdate_prf_0#5262, l_linenumber_prf#5244 AS l_linenumber_prf_0#5263, l_tax_prf#5245 AS l_tax_prf_0#5264, l_shipdate_prf#5246 AS l_shipdate_prf_0#5265, l_extendedprice_prf#5247 AS l_extendedprice_prf_0#5266, l_partkey_prf#5248 AS l_partkey_prf_0#5267, l_discount_prf#5249 AS l_discount_prf_0#5268, l_partkey_and_l_suppkey_prf#5250 AS l_partkey_and_l_suppkey_prf_0#5269, l_commitdate_prf#5251 AS l_commitdate_prf_0#5270, l_suppkey_prf#5252 AS l_suppkey_prf_0#5271, l_orderkey_prf#5253 AS l_orderkey_prf_0#5272]
         :  :  :     :  +- Relation[l_returnflag_prf#5235,l_orderkey_and_l_linenumber_prf#5236,l_comment_prf#5237,l_linestatus_prf#5238,rid#5239,l_shipmode_prf#5240,l_shipinstruct_prf#5241,l_quantity_prf#5242,l_receiptdate_prf#5243,l_linenumber_prf#5244,l_tax_prf#5245,l_shipdate_prf#5246,l_extendedprice_prf#5247,l_partkey_prf#5248,l_discount_prf#5249,l_partkey_and_l_suppkey_prf#5250,l_commitdate_prf#5251,l_suppkey_prf#5252,l_orderkey_prf#5253] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#5274 AS o_shippriority_prf_1#5284, rid#5275 AS rid_1#5285, o_orderdate_prf#5276 AS o_orderdate_prf_1#5286, o_custkey_prf#5277 AS o_custkey_prf_1#5287, o_orderpriority_prf#5278 AS o_orderpriority_prf_1#5288, o_clerk_prf#5279 AS o_clerk_prf_1#5289, o_orderstatus_prf#5280 AS o_orderstatus_prf_1#5290, o_totalprice_prf#5281 AS o_totalprice_prf_1#5291, o_orderkey_prf#5282 AS o_orderkey_prf_1#5292, o_comment_prf#5283 AS o_comment_prf_1#5293]
         :  :     +- Relation[o_shippriority_prf#5274,rid#5275,o_orderdate_prf#5276,o_custkey_prf#5277,o_orderpriority_prf#5278,o_clerk_prf#5279,o_orderstatus_prf#5280,o_totalprice_prf#5281,o_orderkey_prf#5282,o_comment_prf#5283] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1816) AS rid_2#5305]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5304]
         :        :  +- Relation[o_shippriority_prf#5294,rid#5295,o_orderdate_prf#5296,o_custkey_prf#5297,o_orderpriority_prf#5298,o_clerk_prf#5299,o_orderstatus_prf#5300,o_totalprice_prf#5301,o_orderkey_prf#5302,o_comment_prf#5303] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_2))
            :- Project [c_acctbal_prf#5306 AS c_acctbal_prf_2#5315, rid#5307 AS rid_2#5316, c_name_prf#5308 AS c_name_prf_2#5317, c_nationkey_prf#5309 AS c_nationkey_prf_2#5318, c_custkey_prf#5310 AS c_custkey_prf_2#5319, c_comment_prf#5311 AS c_comment_prf_2#5320, c_address_prf#5312 AS c_address_prf_2#5321, c_mktsegment_prf#5313 AS c_mktsegment_prf_2#5322, c_phone_prf#5314 AS c_phone_prf_2#5323]
            :  +- Relation[c_acctbal_prf#5306,rid#5307,c_name_prf#5308,c_nationkey_prf#5309,c_custkey_prf#5310,c_comment_prf#5311,c_address_prf#5312,c_mktsegment_prf#5313,c_phone_prf#5314] JDBCRelation(customer_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#5324]
               +- DexRidFilter customer~c_mktsegment~BUILDING
                  +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 139541ms

ft3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and (p_size = 15 and s_suppkey = l_suppkey)
19/10/16 10:42:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:42:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5398L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 10:42:26 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 10:42:26 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 10:42:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5398L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_2#5416]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#5409: string
         :     :- Project [s_phone_prf#5400 AS s_phone_prf_0#5408, rid#5401 AS rid_0#5409, s_address_prf#5402 AS s_address_prf_0#5410, s_nationkey_prf#5403 AS s_nationkey_prf_0#5411, s_suppkey_prf#5404 AS s_suppkey_prf_0#5412, s_name_prf#5405 AS s_name_prf_0#5413, s_acctbal_prf#5406 AS s_acctbal_prf_0#5414, s_comment_prf#5407 AS s_comment_prf_0#5415]
         :     :  +- Relation[s_phone_prf#5400,rid#5401,s_address_prf#5402,s_nationkey_prf#5403,s_suppkey_prf#5404,s_name_prf#5405,s_acctbal_prf#5406,s_comment_prf#5407] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1816) AS rid_2#5438]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#5429: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#5417 AS p_comment_prf_1#5427, p_name_prf#5418 AS p_name_prf_1#5428, rid#5419 AS rid_1#5429, p_type_prf#5420 AS p_type_prf_1#5430, p_retailprice_prf#5421 AS p_retailprice_prf_1#5431, p_mfgr_prf#5422 AS p_mfgr_prf_1#5432, p_container_prf#5423 AS p_container_prf_1#5433, p_brand_prf#5424 AS p_brand_prf_1#5434, p_size_prf#5425 AS p_size_prf_1#5435, p_partkey_prf#5426 AS p_partkey_prf_1#5436]
            :     :  :  +- Relation[p_comment_prf#5417,p_name_prf#5418,rid#5419,p_type_prf#5420,p_retailprice_prf#5421,p_mfgr_prf#5422,p_container_prf#5423,p_brand_prf#5424,p_size_prf#5425,p_partkey_prf#5426] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5437]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#5439 AS l_returnflag_prf_2#5458, l_orderkey_and_l_linenumber_prf#5440 AS l_orderkey_and_l_linenumber_prf_2#5459, l_comment_prf#5441 AS l_comment_prf_2#5460, l_linestatus_prf#5442 AS l_linestatus_prf_2#5461, rid#5443 AS rid_2#5462, l_shipmode_prf#5444 AS l_shipmode_prf_2#5463, l_shipinstruct_prf#5445 AS l_shipinstruct_prf_2#5464, l_quantity_prf#5446 AS l_quantity_prf_2#5465, l_receiptdate_prf#5447 AS l_receiptdate_prf_2#5466, l_linenumber_prf#5448 AS l_linenumber_prf_2#5467, l_tax_prf#5449 AS l_tax_prf_2#5468, l_shipdate_prf#5450 AS l_shipdate_prf_2#5469, l_extendedprice_prf#5451 AS l_extendedprice_prf_2#5470, l_partkey_prf#5452 AS l_partkey_prf_2#5471, l_discount_prf#5453 AS l_discount_prf_2#5472, l_partkey_and_l_suppkey_prf#5454 AS l_partkey_and_l_suppkey_prf_2#5473, l_commitdate_prf#5455 AS l_commitdate_prf_2#5474, l_suppkey_prf#5456 AS l_suppkey_prf_2#5475, l_orderkey_prf#5457 AS l_orderkey_prf_2#5476]
               +- Relation[l_returnflag_prf#5439,l_orderkey_and_l_linenumber_prf#5440,l_comment_prf#5441,l_linestatus_prf#5442,rid#5443,l_shipmode_prf#5444,l_shipinstruct_prf#5445,l_quantity_prf#5446,l_receiptdate_prf#5447,l_linenumber_prf#5448,l_tax_prf#5449,l_shipdate_prf#5450,l_extendedprice_prf#5451,l_partkey_prf#5452,l_discount_prf#5453,l_partkey_and_l_suppkey_prf#5454,l_commitdate_prf#5455,l_suppkey_prf#5456,l_orderkey_prf#5457] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 59943ms

ft1b=
select * from nation, supplier, customer where n_name = 'FRANCE' and n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/16 10:43:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 10:43:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5536L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 10:43:26 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:43:26 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:43:26 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:43:26 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 10:43:26 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 10:43:26 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:43:26 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 10:43:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5536L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1816) AS rid_1#5549]
         :  :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#5543: string
         :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :     :  :- Project [rid#5538 AS rid_0#5543, n_regionkey_prf#5539 AS n_regionkey_prf_0#5544, n_nationkey_prf#5540 AS n_nationkey_prf_0#5545, n_name_prf#5541 AS n_name_prf_0#5546, n_comment_prf#5542 AS n_comment_prf_0#5547]
         :  :  :     :  :  +- Relation[rid#5538,n_regionkey_prf#5539,n_nationkey_prf#5540,n_name_prf#5541,n_comment_prf#5542] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5548]
         :  :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :  :  :     :        +- Relation[label#1838,value#1839] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :     +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#5550 AS s_phone_prf_1#5558, rid#5551 AS rid_1#5559, s_address_prf#5552 AS s_address_prf_1#5560, s_nationkey_prf#5553 AS s_nationkey_prf_1#5561, s_suppkey_prf#5554 AS s_suppkey_prf_1#5562, s_name_prf#5555 AS s_name_prf_1#5563, s_acctbal_prf#5556 AS s_acctbal_prf_1#5564, s_comment_prf#5557 AS s_comment_prf_1#5565]
         :  :     +- Relation[s_phone_prf#5550,rid#5551,s_address_prf#5552,s_nationkey_prf#5553,s_suppkey_prf#5554,s_name_prf#5555,s_acctbal_prf#5556,s_comment_prf#5557] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1816) AS rid_2#5572]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5571]
         :        :  +- Relation[rid#5566,n_regionkey_prf#5567,n_nationkey_prf#5568,n_name_prf#5569,n_comment_prf#5570] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#1815,value#1816] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#5573 AS c_acctbal_prf_2#5582, rid#5574 AS rid_2#5583, c_name_prf#5575 AS c_name_prf_2#5584, c_nationkey_prf#5576 AS c_nationkey_prf_2#5585, c_custkey_prf#5577 AS c_custkey_prf_2#5586, c_comment_prf#5578 AS c_comment_prf_2#5587, c_address_prf#5579 AS c_address_prf_2#5588, c_mktsegment_prf#5580 AS c_mktsegment_prf_2#5589, c_phone_prf#5581 AS c_phone_prf_2#5590]
            +- Relation[c_acctbal_prf#5573,rid#5574,c_name_prf#5575,c_nationkey_prf#5576,c_custkey_prf#5577,c_comment_prf#5578,c_address_prf#5579,c_mktsegment_prf#5580,c_phone_prf#5581] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 2608ms
query=fq1a, count=246415, duration=163928
query=fq1b, count=246415, duration=225858
query=fq1c, count=246415, duration=229954
query=fq1d, count=0, duration=1033
query=fq1e, count=246415, duration=181289
query=fq1f, count=246415, duration=184058
query=fr1a, count=1214743, duration=139541
query=fr1b, count=1214743, duration=143126
query=fr1c, count=1214743, duration=99487
query=fr1d, count=1214743, duration=151918
query=fr1e, count=1214743, duration=203418
query=fr2a, count=2901744, duration=174223
query=fr2b, count=2901744, duration=121020
query=fr2d, count=2901744, duration=207708
query=fr2e, count=2901744, duration=98230
query=fr2f, count=2901744, duration=217349
query=ft1a, count=2452200, duration=1474
query=ft1b, count=2452200, duration=2608
query=ft1c, count=2452200, duration=33513
query=ft2a, count=15628, duration=102212
query=ft2b, count=15628, duration=46176
query=ft2c, count=15628, duration=7687
query=ft3a, count=6001215, duration=222163
query=ft3b, count=117754, duration=53220
query=ft3c, count=117754, duration=59943
