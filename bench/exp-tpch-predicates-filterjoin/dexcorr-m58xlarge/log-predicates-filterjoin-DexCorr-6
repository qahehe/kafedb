19/10/17 00:18:48 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7079ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Thu Oct 17 00:18:50 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Thu Oct 17 00:18:51 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Thu Oct 17 00:18:51 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Thu Oct 17 00:18:51 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Thu Oct 17 00:18:51 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Thu Oct 17 00:18:54 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Thu Oct 17 00:18:56 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Thu Oct 17 00:18:56 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



fs1b=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/17 00:18:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:18:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2102L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L, l_partkey#307L]
               :  +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L]
                  +- Join Inner, (c_custkey#290L = o_custkey#343L)
                     :- Project [c_custkey#290L]
                     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
                     +- Project [o_orderkey#342L, o_custkey#343L]
                        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 00:18:57 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:18:57 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:18:57 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:18:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2102L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [p_comment_prf#2104 AS p_comment_prf_0#2114, p_name_prf#2105 AS p_name_prf_0#2115, rid#2106 AS rid_0#2116, p_type_prf#2107 AS p_type_prf_0#2117, p_retailprice_prf#2108 AS p_retailprice_prf_0#2118, p_mfgr_prf#2109 AS p_mfgr_prf_0#2119, p_container_prf#2110 AS p_container_prf_0#2120, p_brand_prf#2111 AS p_brand_prf_0#2121, p_size_prf#2112 AS p_size_prf_0#2122, p_partkey_prf#2113 AS p_partkey_prf_0#2123]
         :  :  +- Relation[p_comment_prf#2104,p_name_prf#2105,rid#2106,p_type_prf#2107,p_retailprice_prf#2108,p_mfgr_prf#2109,p_container_prf#2110,p_brand_prf#2111,p_size_prf#2112,p_partkey_prf#2113] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#2137]
         :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2134]
         :        :  +- Relation[p_comment_prf#2124,p_name_prf#2125,rid#2126,p_type_prf#2127,p_retailprice_prf#2128,p_mfgr_prf#2129,p_container_prf#2130,p_brand_prf#2131,p_size_prf#2132,p_partkey_prf#2133] JDBCRelation(part_prf) [numPartitions=1]
         :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [l_returnflag_prf#2138 AS l_returnflag_prf_1#2157, l_orderkey_and_l_linenumber_prf#2139 AS l_orderkey_and_l_linenumber_prf_1#2158, l_comment_prf#2140 AS l_comment_prf_1#2159, l_linestatus_prf#2141 AS l_linestatus_prf_1#2160, rid#2142 AS rid_1#2161, l_shipmode_prf#2143 AS l_shipmode_prf_1#2162, l_shipinstruct_prf#2144 AS l_shipinstruct_prf_1#2163, l_quantity_prf#2145 AS l_quantity_prf_1#2164, l_receiptdate_prf#2146 AS l_receiptdate_prf_1#2165, l_linenumber_prf#2147 AS l_linenumber_prf_1#2166, l_tax_prf#2148 AS l_tax_prf_1#2167, l_shipdate_prf#2149 AS l_shipdate_prf_1#2168, l_extendedprice_prf#2150 AS l_extendedprice_prf_1#2169, l_partkey_prf#2151 AS l_partkey_prf_1#2170, l_discount_prf#2152 AS l_discount_prf_1#2171, l_partkey_and_l_suppkey_prf#2153 AS l_partkey_and_l_suppkey_prf_1#2172, l_commitdate_prf#2154 AS l_commitdate_prf_1#2173, l_suppkey_prf#2155 AS l_suppkey_prf_1#2174, l_orderkey_prf#2156 AS l_orderkey_prf_1#2175]
            :  :  +- Relation[l_returnflag_prf#2138,l_orderkey_and_l_linenumber_prf#2139,l_comment_prf#2140,l_linestatus_prf#2141,rid#2142,l_shipmode_prf#2143,l_shipinstruct_prf#2144,l_quantity_prf#2145,l_receiptdate_prf#2146,l_linenumber_prf#2147,l_tax_prf#2148,l_shipdate_prf#2149,l_extendedprice_prf#2150,l_partkey_prf#2151,l_discount_prf#2152,l_partkey_and_l_suppkey_prf#2153,l_commitdate_prf#2154,l_suppkey_prf#2155,l_orderkey_prf#2156] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2136) AS rid_3#2196]
            :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#2195]
            :        :  +- Relation[l_returnflag_prf#2176,l_orderkey_and_l_linenumber_prf#2177,l_comment_prf#2178,l_linestatus_prf#2179,rid#2180,l_shipmode_prf#2181,l_shipinstruct_prf#2182,l_quantity_prf#2183,l_receiptdate_prf#2184,l_linenumber_prf#2185,l_tax_prf#2186,l_shipdate_prf#2187,l_extendedprice_prf#2188,l_partkey_prf#2189,l_discount_prf#2190,l_partkey_and_l_suppkey_prf#2191,l_commitdate_prf#2192,l_suppkey_prf#2193,l_orderkey_prf#2194] JDBCRelation(lineitem_prf) [numPartitions=1]
            :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join NaturalJoin(Inner)
               :- 'Project ['c_acctbal_prf_2, 'rid_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2136) AS rid_3#2218]
               :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_2#2207: string
               :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :     :  :- Project [c_acctbal_prf#2197 AS c_acctbal_prf_2#2206, rid#2198 AS rid_2#2207, c_name_prf#2199 AS c_name_prf_2#2208, c_nationkey_prf#2200 AS c_nationkey_prf_2#2209, c_custkey_prf#2201 AS c_custkey_prf_2#2210, c_comment_prf#2202 AS c_comment_prf_2#2211, c_address_prf#2203 AS c_address_prf_2#2212, c_mktsegment_prf#2204 AS c_mktsegment_prf_2#2213, c_phone_prf#2205 AS c_phone_prf_2#2214]
               :     :  :  +- Relation[c_acctbal_prf#2197,rid#2198,c_name_prf#2199,c_nationkey_prf#2200,c_custkey_prf#2201,c_comment_prf#2202,c_address_prf#2203,c_mktsegment_prf#2204,c_phone_prf#2205] JDBCRelation(customer_prf) [numPartitions=1]
               :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#2217]
               :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
               :     :        +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
               :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
               +- Project [o_shippriority_prf#2219 AS o_shippriority_prf_3#2229, rid#2220 AS rid_3#2230, o_orderdate_prf#2221 AS o_orderdate_prf_3#2231, o_custkey_prf#2222 AS o_custkey_prf_3#2232, o_orderpriority_prf#2223 AS o_orderpriority_prf_3#2233, o_clerk_prf#2224 AS o_clerk_prf_3#2234, o_orderstatus_prf#2225 AS o_orderstatus_prf_3#2235, o_totalprice_prf#2226 AS o_totalprice_prf_3#2236, o_orderkey_prf#2227 AS o_orderkey_prf_3#2237, o_comment_prf#2228 AS o_comment_prf_3#2238]
                  +- Relation[o_shippriority_prf#2219,rid#2220,o_orderdate_prf#2221,o_custkey_prf#2222,o_orderpriority_prf#2223,o_clerk_prf#2224,o_orderstatus_prf#2225,o_totalprice_prf#2226,o_orderkey_prf#2227,o_comment_prf#2228] JDBCRelation(orders_prf) [numPartitions=1]

19/10/17 00:18:57 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=1214743
Elapsed time: 173204ms

fq1a=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 00:21:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:21:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2327L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :     :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 00:21:50 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:21:50 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:21:50 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:21:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2327L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, 'rid_2, 'o_shippriority_prf_2, 'o_orderdate_prf_2, 'o_custkey_prf_2, 'o_orderpriority_prf_2, 'o_clerk_prf_2, 'o_orderstatus_prf_2, 'o_totalprice_prf_2, 'o_orderkey_prf_2, 'o_comment_prf_2, dexdecrypt('value_dec_key, value#2136) AS rid_3#2380]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#2359]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#2340]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#2334: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [rid#2329 AS rid_0#2334, n_regionkey_prf#2330 AS n_regionkey_prf_0#2335, n_nationkey_prf#2331 AS n_nationkey_prf_0#2336, n_name_prf#2332 AS n_name_prf_0#2337, n_comment_prf#2333 AS n_comment_prf_0#2338]
         :     :  :     :  :     :  :  +- Relation[rid#2329,n_regionkey_prf#2330,n_nationkey_prf#2331,n_name_prf#2332,n_comment_prf#2333] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2339]
         :     :  :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :  :     :        +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [c_acctbal_prf#2341 AS c_acctbal_prf_1#2350, rid#2342 AS rid_1#2351, c_name_prf#2343 AS c_name_prf_1#2352, c_nationkey_prf#2344 AS c_nationkey_prf_1#2353, c_custkey_prf#2345 AS c_custkey_prf_1#2354, c_comment_prf#2346 AS c_comment_prf_1#2355, c_address_prf#2347 AS c_address_prf_1#2356, c_mktsegment_prf#2348 AS c_mktsegment_prf_1#2357, c_phone_prf#2349 AS c_phone_prf_1#2358]
         :     :  :     :     +- Relation[c_acctbal_prf#2341,rid#2342,c_name_prf#2343,c_nationkey_prf#2344,c_custkey_prf#2345,c_comment_prf#2346,c_address_prf#2347,c_mktsegment_prf#2348,c_phone_prf#2349] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#2360 AS o_shippriority_prf_2#2370, rid#2361 AS rid_2#2371, o_orderdate_prf#2362 AS o_orderdate_prf_2#2372, o_custkey_prf#2363 AS o_custkey_prf_2#2373, o_orderpriority_prf#2364 AS o_orderpriority_prf_2#2374, o_clerk_prf#2365 AS o_clerk_prf_2#2375, o_orderstatus_prf#2366 AS o_orderstatus_prf_2#2376, o_totalprice_prf#2367 AS o_totalprice_prf_2#2377, o_orderkey_prf#2368 AS o_orderkey_prf_2#2378, o_comment_prf#2369 AS o_comment_prf_2#2379]
         :     :     +- Relation[o_shippriority_prf#2360,rid#2361,o_orderdate_prf#2362,o_custkey_prf#2363,o_orderpriority_prf#2364,o_clerk_prf#2365,o_orderstatus_prf#2366,o_totalprice_prf#2367,o_orderkey_prf#2368,o_comment_prf#2369] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2381 AS l_returnflag_prf_3#2400, l_orderkey_and_l_linenumber_prf#2382 AS l_orderkey_and_l_linenumber_prf_3#2401, l_comment_prf#2383 AS l_comment_prf_3#2402, l_linestatus_prf#2384 AS l_linestatus_prf_3#2403, rid#2385 AS rid_3#2404, l_shipmode_prf#2386 AS l_shipmode_prf_3#2405, l_shipinstruct_prf#2387 AS l_shipinstruct_prf_3#2406, l_quantity_prf#2388 AS l_quantity_prf_3#2407, l_receiptdate_prf#2389 AS l_receiptdate_prf_3#2408, l_linenumber_prf#2390 AS l_linenumber_prf_3#2409, l_tax_prf#2391 AS l_tax_prf_3#2410, l_shipdate_prf#2392 AS l_shipdate_prf_3#2411, l_extendedprice_prf#2393 AS l_extendedprice_prf_3#2412, l_partkey_prf#2394 AS l_partkey_prf_3#2413, l_discount_prf#2395 AS l_discount_prf_3#2414, l_partkey_and_l_suppkey_prf#2396 AS l_partkey_and_l_suppkey_prf_3#2415, l_commitdate_prf#2397 AS l_commitdate_prf_3#2416, l_suppkey_prf#2398 AS l_suppkey_prf_3#2417, l_orderkey_prf#2399 AS l_orderkey_prf_3#2418]
            +- Relation[l_returnflag_prf#2381,l_orderkey_and_l_linenumber_prf#2382,l_comment_prf#2383,l_linestatus_prf#2384,rid#2385,l_shipmode_prf#2386,l_shipinstruct_prf#2387,l_quantity_prf#2388,l_receiptdate_prf#2389,l_linenumber_prf#2390,l_tax_prf#2391,l_shipdate_prf#2392,l_extendedprice_prf#2393,l_partkey_prf#2394,l_discount_prf#2395,l_partkey_and_l_suppkey_prf#2396,l_commitdate_prf#2397,l_suppkey_prf#2398,l_orderkey_prf#2399] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 31059ms

fr1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and (l_orderkey = o_orderkey and c_mktsegment = 'BUILDING')
19/10/17 00:22:21 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:22:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2498L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 00:22:21 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:22:21 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:22:21 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:22:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2498L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#2500 AS l_returnflag_prf_0#2519, l_orderkey_and_l_linenumber_prf#2501 AS l_orderkey_and_l_linenumber_prf_0#2520, l_comment_prf#2502 AS l_comment_prf_0#2521, l_linestatus_prf#2503 AS l_linestatus_prf_0#2522, rid#2504 AS rid_0#2523, l_shipmode_prf#2505 AS l_shipmode_prf_0#2524, l_shipinstruct_prf#2506 AS l_shipinstruct_prf_0#2525, l_quantity_prf#2507 AS l_quantity_prf_0#2526, l_receiptdate_prf#2508 AS l_receiptdate_prf_0#2527, l_linenumber_prf#2509 AS l_linenumber_prf_0#2528, l_tax_prf#2510 AS l_tax_prf_0#2529, l_shipdate_prf#2511 AS l_shipdate_prf_0#2530, l_extendedprice_prf#2512 AS l_extendedprice_prf_0#2531, l_partkey_prf#2513 AS l_partkey_prf_0#2532, l_discount_prf#2514 AS l_discount_prf_0#2533, l_partkey_and_l_suppkey_prf#2515 AS l_partkey_and_l_suppkey_prf_0#2534, l_commitdate_prf#2516 AS l_commitdate_prf_0#2535, l_suppkey_prf#2517 AS l_suppkey_prf_0#2536, l_orderkey_prf#2518 AS l_orderkey_prf_0#2537]
         :  :  +- Relation[l_returnflag_prf#2500,l_orderkey_and_l_linenumber_prf#2501,l_comment_prf#2502,l_linestatus_prf#2503,rid#2504,l_shipmode_prf#2505,l_shipinstruct_prf#2506,l_quantity_prf#2507,l_receiptdate_prf#2508,l_linenumber_prf#2509,l_tax_prf#2510,l_shipdate_prf#2511,l_extendedprice_prf#2512,l_partkey_prf#2513,l_discount_prf#2514,l_partkey_and_l_suppkey_prf#2515,l_commitdate_prf#2516,l_suppkey_prf#2517,l_orderkey_prf#2518] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#2558]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2557]
         :        :  +- Relation[l_returnflag_prf#2538,l_orderkey_and_l_linenumber_prf#2539,l_comment_prf#2540,l_linestatus_prf#2541,rid#2542,l_shipmode_prf#2543,l_shipinstruct_prf#2544,l_quantity_prf#2545,l_receiptdate_prf#2546,l_linenumber_prf#2547,l_tax_prf#2548,l_shipdate_prf#2549,l_extendedprice_prf#2550,l_partkey_prf#2551,l_discount_prf#2552,l_partkey_and_l_suppkey_prf#2553,l_commitdate_prf#2554,l_suppkey_prf#2555,l_orderkey_prf#2556] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [o_shippriority_prf#2559 AS o_shippriority_prf_1#2569, rid#2560 AS rid_1#2570, o_orderdate_prf#2561 AS o_orderdate_prf_1#2571, o_custkey_prf#2562 AS o_custkey_prf_1#2572, o_orderpriority_prf#2563 AS o_orderpriority_prf_1#2573, o_clerk_prf#2564 AS o_clerk_prf_1#2574, o_orderstatus_prf#2565 AS o_orderstatus_prf_1#2575, o_totalprice_prf#2566 AS o_totalprice_prf_1#2576, o_orderkey_prf#2567 AS o_orderkey_prf_1#2577, o_comment_prf#2568 AS o_comment_prf_1#2578]
            :  :  +- Relation[o_shippriority_prf#2559,rid#2560,o_orderdate_prf#2561,o_custkey_prf#2562,o_orderpriority_prf#2563,o_clerk_prf#2564,o_orderstatus_prf#2565,o_totalprice_prf#2566,o_orderkey_prf#2567,o_comment_prf#2568] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#2590]
            :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#2589]
            :        :  +- Relation[o_shippriority_prf#2579,rid#2580,o_orderdate_prf#2581,o_custkey_prf#2582,o_orderpriority_prf#2583,o_clerk_prf#2584,o_orderstatus_prf#2585,o_totalprice_prf#2586,o_orderkey_prf#2587,o_comment_prf#2588] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [c_acctbal_prf#2591 AS c_acctbal_prf_2#2600, rid#2592 AS rid_2#2601, c_name_prf#2593 AS c_name_prf_2#2602, c_nationkey_prf#2594 AS c_nationkey_prf_2#2603, c_custkey_prf#2595 AS c_custkey_prf_2#2604, c_comment_prf#2596 AS c_comment_prf_2#2605, c_address_prf#2597 AS c_address_prf_2#2606, c_mktsegment_prf#2598 AS c_mktsegment_prf_2#2607, c_phone_prf#2599 AS c_phone_prf_2#2608]
               :  +- Relation[c_acctbal_prf#2591,rid#2592,c_name_prf#2593,c_nationkey_prf#2594,c_custkey_prf#2595,c_comment_prf#2596,c_address_prf#2597,c_mktsegment_prf#2598,c_phone_prf#2599] JDBCRelation(customer_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#2609]
                  +- DexRidFilter customer~c_mktsegment~BUILDING
                     +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 120786ms

fr2a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_orderstatus = 'F' and o_custkey = c_custkey
19/10/17 00:24:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:24:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2684L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 00:24:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2684L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [l_returnflag_prf#2686 AS l_returnflag_prf_0#2705, l_orderkey_and_l_linenumber_prf#2687 AS l_orderkey_and_l_linenumber_prf_0#2706, l_comment_prf#2688 AS l_comment_prf_0#2707, l_linestatus_prf#2689 AS l_linestatus_prf_0#2708, rid#2690 AS rid_0#2709, l_shipmode_prf#2691 AS l_shipmode_prf_0#2710, l_shipinstruct_prf#2692 AS l_shipinstruct_prf_0#2711, l_quantity_prf#2693 AS l_quantity_prf_0#2712, l_receiptdate_prf#2694 AS l_receiptdate_prf_0#2713, l_linenumber_prf#2695 AS l_linenumber_prf_0#2714, l_tax_prf#2696 AS l_tax_prf_0#2715, l_shipdate_prf#2697 AS l_shipdate_prf_0#2716, l_extendedprice_prf#2698 AS l_extendedprice_prf_0#2717, l_partkey_prf#2699 AS l_partkey_prf_0#2718, l_discount_prf#2700 AS l_discount_prf_0#2719, l_partkey_and_l_suppkey_prf#2701 AS l_partkey_and_l_suppkey_prf_0#2720, l_commitdate_prf#2702 AS l_commitdate_prf_0#2721, l_suppkey_prf#2703 AS l_suppkey_prf_0#2722, l_orderkey_prf#2704 AS l_orderkey_prf_0#2723]
         :     :  :  :  +- Relation[l_returnflag_prf#2686,l_orderkey_and_l_linenumber_prf#2687,l_comment_prf#2688,l_linestatus_prf#2689,rid#2690,l_shipmode_prf#2691,l_shipinstruct_prf#2692,l_quantity_prf#2693,l_receiptdate_prf#2694,l_linenumber_prf#2695,l_tax_prf#2696,l_shipdate_prf#2697,l_extendedprice_prf#2698,l_partkey_prf#2699,l_discount_prf#2700,l_partkey_and_l_suppkey_prf#2701,l_commitdate_prf#2702,l_suppkey_prf#2703,l_orderkey_prf#2704] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#2744]
         :     :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#2743]
         :     :  :        :  +- Relation[l_returnflag_prf#2724,l_orderkey_and_l_linenumber_prf#2725,l_comment_prf#2726,l_linestatus_prf#2727,rid#2728,l_shipmode_prf#2729,l_shipinstruct_prf#2730,l_quantity_prf#2731,l_receiptdate_prf#2732,l_linenumber_prf#2733,l_tax_prf#2734,l_shipdate_prf#2735,l_extendedprice_prf#2736,l_partkey_prf#2737,l_discount_prf#2738,l_partkey_and_l_suppkey_prf#2739,l_commitdate_prf#2740,l_suppkey_prf#2741,l_orderkey_prf#2742] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [o_shippriority_prf#2745 AS o_shippriority_prf_1#2755, rid#2746 AS rid_1#2756, o_orderdate_prf#2747 AS o_orderdate_prf_1#2757, o_custkey_prf#2748 AS o_custkey_prf_1#2758, o_orderpriority_prf#2749 AS o_orderpriority_prf_1#2759, o_clerk_prf#2750 AS o_clerk_prf_1#2760, o_orderstatus_prf#2751 AS o_orderstatus_prf_1#2761, o_totalprice_prf#2752 AS o_totalprice_prf_1#2762, o_orderkey_prf#2753 AS o_orderkey_prf_1#2763, o_comment_prf#2754 AS o_comment_prf_1#2764]
         :     :     :  +- Relation[o_shippriority_prf#2745,rid#2746,o_orderdate_prf#2747,o_custkey_prf#2748,o_orderpriority_prf#2749,o_clerk_prf#2750,o_orderstatus_prf#2751,o_totalprice_prf#2752,o_orderkey_prf#2753,o_comment_prf#2754] JDBCRelation(orders_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2765]
         :     :        +- DexRidFilter orders~o_orderstatus~F
         :     :           +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2767 AS c_acctbal_prf_2#2776, rid#2768 AS rid_2#2777, c_name_prf#2769 AS c_name_prf_2#2778, c_nationkey_prf#2770 AS c_nationkey_prf_2#2779, c_custkey_prf#2771 AS c_custkey_prf_2#2780, c_comment_prf#2772 AS c_comment_prf_2#2781, c_address_prf#2773 AS c_address_prf_2#2782, c_mktsegment_prf#2774 AS c_mktsegment_prf_2#2783, c_phone_prf#2775 AS c_phone_prf_2#2784]
            +- Relation[c_acctbal_prf#2767,rid#2768,c_name_prf#2769,c_nationkey_prf#2770,c_custkey_prf#2771,c_comment_prf#2772,c_address_prf#2773,c_mktsegment_prf#2774,c_phone_prf#2775] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 193232ms

fs1c=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/17 00:27:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:27:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2868L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_orderkey#306L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 00:27:35 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:27:35 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:27:35 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:27:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2868L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [p_comment_prf#2870 AS p_comment_prf_0#2880, p_name_prf#2871 AS p_name_prf_0#2881, rid#2872 AS rid_0#2882, p_type_prf#2873 AS p_type_prf_0#2883, p_retailprice_prf#2874 AS p_retailprice_prf_0#2884, p_mfgr_prf#2875 AS p_mfgr_prf_0#2885, p_container_prf#2876 AS p_container_prf_0#2886, p_brand_prf#2877 AS p_brand_prf_0#2887, p_size_prf#2878 AS p_size_prf_0#2888, p_partkey_prf#2879 AS p_partkey_prf_0#2889]
         :  :  :  :  +- Relation[p_comment_prf#2870,p_name_prf#2871,rid#2872,p_type_prf#2873,p_retailprice_prf#2874,p_mfgr_prf#2875,p_container_prf#2876,p_brand_prf#2877,p_size_prf#2878,p_partkey_prf#2879] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#2901]
         :  :  :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#2900]
         :  :  :        :  +- Relation[p_comment_prf#2890,p_name_prf#2891,rid#2892,p_type_prf#2893,p_retailprice_prf#2894,p_mfgr_prf#2895,p_container_prf#2896,p_brand_prf#2897,p_size_prf#2898,p_partkey_prf#2899] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#2902 AS l_returnflag_prf_1#2921, l_orderkey_and_l_linenumber_prf#2903 AS l_orderkey_and_l_linenumber_prf_1#2922, l_comment_prf#2904 AS l_comment_prf_1#2923, l_linestatus_prf#2905 AS l_linestatus_prf_1#2924, rid#2906 AS rid_1#2925, l_shipmode_prf#2907 AS l_shipmode_prf_1#2926, l_shipinstruct_prf#2908 AS l_shipinstruct_prf_1#2927, l_quantity_prf#2909 AS l_quantity_prf_1#2928, l_receiptdate_prf#2910 AS l_receiptdate_prf_1#2929, l_linenumber_prf#2911 AS l_linenumber_prf_1#2930, l_tax_prf#2912 AS l_tax_prf_1#2931, l_shipdate_prf#2913 AS l_shipdate_prf_1#2932, l_extendedprice_prf#2914 AS l_extendedprice_prf_1#2933, l_partkey_prf#2915 AS l_partkey_prf_1#2934, l_discount_prf#2916 AS l_discount_prf_1#2935, l_partkey_and_l_suppkey_prf#2917 AS l_partkey_and_l_suppkey_prf_1#2936, l_commitdate_prf#2918 AS l_commitdate_prf_1#2937, l_suppkey_prf#2919 AS l_suppkey_prf_1#2938, l_orderkey_prf#2920 AS l_orderkey_prf_1#2939]
         :  :     +- Relation[l_returnflag_prf#2902,l_orderkey_and_l_linenumber_prf#2903,l_comment_prf#2904,l_linestatus_prf#2905,rid#2906,l_shipmode_prf#2907,l_shipinstruct_prf#2908,l_quantity_prf#2909,l_receiptdate_prf#2910,l_linenumber_prf#2911,l_tax_prf#2912,l_shipdate_prf#2913,l_extendedprice_prf#2914,l_partkey_prf#2915,l_discount_prf#2916,l_partkey_and_l_suppkey_prf#2917,l_commitdate_prf#2918,l_suppkey_prf#2919,l_orderkey_prf#2920] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2136) AS rid_3#2960]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2959]
         :        :  +- Relation[l_returnflag_prf#2940,l_orderkey_and_l_linenumber_prf#2941,l_comment_prf#2942,l_linestatus_prf#2943,rid#2944,l_shipmode_prf#2945,l_shipinstruct_prf#2946,l_quantity_prf#2947,l_receiptdate_prf#2948,l_linenumber_prf#2949,l_tax_prf#2950,l_shipdate_prf#2951,l_extendedprice_prf#2952,l_partkey_prf#2953,l_discount_prf#2954,l_partkey_and_l_suppkey_prf#2955,l_commitdate_prf#2956,l_suppkey_prf#2957,l_orderkey_prf#2958] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_2, 'rid_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2136) AS rid_3#2980]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_2#2971: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [c_acctbal_prf#2961 AS c_acctbal_prf_2#2970, rid#2962 AS rid_2#2971, c_name_prf#2963 AS c_name_prf_2#2972, c_nationkey_prf#2964 AS c_nationkey_prf_2#2973, c_custkey_prf#2965 AS c_custkey_prf_2#2974, c_comment_prf#2966 AS c_comment_prf_2#2975, c_address_prf#2967 AS c_address_prf_2#2976, c_mktsegment_prf#2968 AS c_mktsegment_prf_2#2977, c_phone_prf#2969 AS c_phone_prf_2#2978]
            :     :  :  +- Relation[c_acctbal_prf#2961,rid#2962,c_name_prf#2963,c_nationkey_prf#2964,c_custkey_prf#2965,c_comment_prf#2966,c_address_prf#2967,c_mktsegment_prf#2968,c_phone_prf#2969] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#2979]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2981 AS o_shippriority_prf_3#2991, rid#2982 AS rid_3#2992, o_orderdate_prf#2983 AS o_orderdate_prf_3#2993, o_custkey_prf#2984 AS o_custkey_prf_3#2994, o_orderpriority_prf#2985 AS o_orderpriority_prf_3#2995, o_clerk_prf#2986 AS o_clerk_prf_3#2996, o_orderstatus_prf#2987 AS o_orderstatus_prf_3#2997, o_totalprice_prf#2988 AS o_totalprice_prf_3#2998, o_orderkey_prf#2989 AS o_orderkey_prf_3#2999, o_comment_prf#2990 AS o_comment_prf_3#3000]
               +- Relation[o_shippriority_prf#2981,rid#2982,o_orderdate_prf#2983,o_custkey_prf#2984,o_orderpriority_prf#2985,o_clerk_prf#2986,o_orderstatus_prf#2987,o_totalprice_prf#2988,o_orderkey_prf#2989,o_comment_prf#2990] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 173014ms

fr1d=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/17 00:30:28 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:30:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3085L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 00:30:28 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:30:28 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:30:28 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:30:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3085L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#3127]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#3106]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3097: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [c_acctbal_prf#3087 AS c_acctbal_prf_0#3096, rid#3088 AS rid_0#3097, c_name_prf#3089 AS c_name_prf_0#3098, c_nationkey_prf#3090 AS c_nationkey_prf_0#3099, c_custkey_prf#3091 AS c_custkey_prf_0#3100, c_comment_prf#3092 AS c_comment_prf_0#3101, c_address_prf#3093 AS c_address_prf_0#3102, c_mktsegment_prf#3094 AS c_mktsegment_prf_0#3103, c_phone_prf#3095 AS c_phone_prf_0#3104]
         :     :  :     :  :  +- Relation[c_acctbal_prf#3087,rid#3088,c_name_prf#3089,c_nationkey_prf#3090,c_custkey_prf#3091,c_comment_prf#3092,c_address_prf#3093,c_mktsegment_prf#3094,c_phone_prf#3095] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3105]
         :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :        +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#3107 AS o_shippriority_prf_1#3117, rid#3108 AS rid_1#3118, o_orderdate_prf#3109 AS o_orderdate_prf_1#3119, o_custkey_prf#3110 AS o_custkey_prf_1#3120, o_orderpriority_prf#3111 AS o_orderpriority_prf_1#3121, o_clerk_prf#3112 AS o_clerk_prf_1#3122, o_orderstatus_prf#3113 AS o_orderstatus_prf_1#3123, o_totalprice_prf#3114 AS o_totalprice_prf_1#3124, o_orderkey_prf#3115 AS o_orderkey_prf_1#3125, o_comment_prf#3116 AS o_comment_prf_1#3126]
         :     :     +- Relation[o_shippriority_prf#3107,rid#3108,o_orderdate_prf#3109,o_custkey_prf#3110,o_orderpriority_prf#3111,o_clerk_prf#3112,o_orderstatus_prf#3113,o_totalprice_prf#3114,o_orderkey_prf#3115,o_comment_prf#3116] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3128 AS l_returnflag_prf_2#3147, l_orderkey_and_l_linenumber_prf#3129 AS l_orderkey_and_l_linenumber_prf_2#3148, l_comment_prf#3130 AS l_comment_prf_2#3149, l_linestatus_prf#3131 AS l_linestatus_prf_2#3150, rid#3132 AS rid_2#3151, l_shipmode_prf#3133 AS l_shipmode_prf_2#3152, l_shipinstruct_prf#3134 AS l_shipinstruct_prf_2#3153, l_quantity_prf#3135 AS l_quantity_prf_2#3154, l_receiptdate_prf#3136 AS l_receiptdate_prf_2#3155, l_linenumber_prf#3137 AS l_linenumber_prf_2#3156, l_tax_prf#3138 AS l_tax_prf_2#3157, l_shipdate_prf#3139 AS l_shipdate_prf_2#3158, l_extendedprice_prf#3140 AS l_extendedprice_prf_2#3159, l_partkey_prf#3141 AS l_partkey_prf_2#3160, l_discount_prf#3142 AS l_discount_prf_2#3161, l_partkey_and_l_suppkey_prf#3143 AS l_partkey_and_l_suppkey_prf_2#3162, l_commitdate_prf#3144 AS l_commitdate_prf_2#3163, l_suppkey_prf#3145 AS l_suppkey_prf_2#3164, l_orderkey_prf#3146 AS l_orderkey_prf_2#3165]
            +- Relation[l_returnflag_prf#3128,l_orderkey_and_l_linenumber_prf#3129,l_comment_prf#3130,l_linestatus_prf#3131,rid#3132,l_shipmode_prf#3133,l_shipinstruct_prf#3134,l_quantity_prf#3135,l_receiptdate_prf#3136,l_linenumber_prf#3137,l_tax_prf#3138,l_shipdate_prf#3139,l_extendedprice_prf#3140,l_partkey_prf#3141,l_discount_prf#3142,l_partkey_and_l_suppkey_prf#3143,l_commitdate_prf#3144,l_suppkey_prf#3145,l_orderkey_prf#3146] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 32806ms

fq1d=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 00:31:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:31:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3244L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :     :- Project [n_nationkey#108L]
               :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
               :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 00:31:01 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:31:01 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:31:01 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:31:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3244L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#3246 AS l_returnflag_prf_0#3265, l_orderkey_and_l_linenumber_prf#3247 AS l_orderkey_and_l_linenumber_prf_0#3266, l_comment_prf#3248 AS l_comment_prf_0#3267, l_linestatus_prf#3249 AS l_linestatus_prf_0#3268, rid#3250 AS rid_0#3269, l_shipmode_prf#3251 AS l_shipmode_prf_0#3270, l_shipinstruct_prf#3252 AS l_shipinstruct_prf_0#3271, l_quantity_prf#3253 AS l_quantity_prf_0#3272, l_receiptdate_prf#3254 AS l_receiptdate_prf_0#3273, l_linenumber_prf#3255 AS l_linenumber_prf_0#3274, l_tax_prf#3256 AS l_tax_prf_0#3275, l_shipdate_prf#3257 AS l_shipdate_prf_0#3276, l_extendedprice_prf#3258 AS l_extendedprice_prf_0#3277, l_partkey_prf#3259 AS l_partkey_prf_0#3278, l_discount_prf#3260 AS l_discount_prf_0#3279, l_partkey_and_l_suppkey_prf#3261 AS l_partkey_and_l_suppkey_prf_0#3280, l_commitdate_prf#3262 AS l_commitdate_prf_0#3281, l_suppkey_prf#3263 AS l_suppkey_prf_0#3282, l_orderkey_prf#3264 AS l_orderkey_prf_0#3283]
         :  :  +- Relation[l_returnflag_prf#3246,l_orderkey_and_l_linenumber_prf#3247,l_comment_prf#3248,l_linestatus_prf#3249,rid#3250,l_shipmode_prf#3251,l_shipinstruct_prf#3252,l_quantity_prf#3253,l_receiptdate_prf#3254,l_linenumber_prf#3255,l_tax_prf#3256,l_shipdate_prf#3257,l_extendedprice_prf#3258,l_partkey_prf#3259,l_discount_prf#3260,l_partkey_and_l_suppkey_prf#3261,l_commitdate_prf#3262,l_suppkey_prf#3263,l_orderkey_prf#3264] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2136) AS rid_3#3304]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3303]
         :        :  +- Relation[l_returnflag_prf#3284,l_orderkey_and_l_linenumber_prf#3285,l_comment_prf#3286,l_linestatus_prf#3287,rid#3288,l_shipmode_prf#3289,l_shipinstruct_prf#3290,l_quantity_prf#3291,l_receiptdate_prf#3292,l_linenumber_prf#3293,l_tax_prf#3294,l_shipdate_prf#3295,l_extendedprice_prf#3296,l_partkey_prf#3297,l_discount_prf#3298,l_partkey_and_l_suppkey_prf#3299,l_commitdate_prf#3300,l_suppkey_prf#3301,l_orderkey_prf#3302] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, 'rid_2, 'c_acctbal_prf_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2136) AS rid_3#3335]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_2
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#3316]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_1#3310: string
            :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :     :  :- Project [rid#3305 AS rid_1#3310, n_regionkey_prf#3306 AS n_regionkey_prf_1#3311, n_nationkey_prf#3307 AS n_nationkey_prf_1#3312, n_name_prf#3308 AS n_name_prf_1#3313, n_comment_prf#3309 AS n_comment_prf_1#3314]
            :     :  :     :  :  +- Relation[rid#3305,n_regionkey_prf#3306,n_nationkey_prf#3307,n_name_prf#3308,n_comment_prf#3309] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3315]
            :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :  :     :        +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [c_acctbal_prf#3317 AS c_acctbal_prf_2#3326, rid#3318 AS rid_2#3327, c_name_prf#3319 AS c_name_prf_2#3328, c_nationkey_prf#3320 AS c_nationkey_prf_2#3329, c_custkey_prf#3321 AS c_custkey_prf_2#3330, c_comment_prf#3322 AS c_comment_prf_2#3331, c_address_prf#3323 AS c_address_prf_2#3332, c_mktsegment_prf#3324 AS c_mktsegment_prf_2#3333, c_phone_prf#3325 AS c_phone_prf_2#3334]
            :     :     +- Relation[c_acctbal_prf#3317,rid#3318,c_name_prf#3319,c_nationkey_prf#3320,c_custkey_prf#3321,c_comment_prf#3322,c_address_prf#3323,c_mktsegment_prf#3324,c_phone_prf#3325] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3336 AS o_shippriority_prf_3#3346, rid#3337 AS rid_3#3347, o_orderdate_prf#3338 AS o_orderdate_prf_3#3348, o_custkey_prf#3339 AS o_custkey_prf_3#3349, o_orderpriority_prf#3340 AS o_orderpriority_prf_3#3350, o_clerk_prf#3341 AS o_clerk_prf_3#3351, o_orderstatus_prf#3342 AS o_orderstatus_prf_3#3352, o_totalprice_prf#3343 AS o_totalprice_prf_3#3353, o_orderkey_prf#3344 AS o_orderkey_prf_3#3354, o_comment_prf#3345 AS o_comment_prf_3#3355]
               +- Relation[o_shippriority_prf#3336,rid#3337,o_orderdate_prf#3338,o_custkey_prf#3339,o_orderpriority_prf#3340,o_clerk_prf#3341,o_orderstatus_prf#3342,o_totalprice_prf#3343,o_orderkey_prf#3344,o_comment_prf#3345] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 74487ms

ft3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and (p_size = 15 and s_suppkey = l_suppkey)
19/10/17 00:32:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:32:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3434L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 00:32:16 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:32:16 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:32:16 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:32:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3434L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#3436 AS s_phone_prf_0#3444, rid#3437 AS rid_0#3445, s_address_prf#3438 AS s_address_prf_0#3446, s_nationkey_prf#3439 AS s_nationkey_prf_0#3447, s_suppkey_prf#3440 AS s_suppkey_prf_0#3448, s_name_prf#3441 AS s_name_prf_0#3449, s_acctbal_prf#3442 AS s_acctbal_prf_0#3450, s_comment_prf#3443 AS s_comment_prf_0#3451]
         :  :  +- Relation[s_phone_prf#3436,rid#3437,s_address_prf#3438,s_nationkey_prf#3439,s_suppkey_prf#3440,s_name_prf#3441,s_acctbal_prf#3442,s_comment_prf#3443] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2136) AS rid_2#3461]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3460]
         :        :  +- Relation[s_phone_prf#3452,rid#3453,s_address_prf#3454,s_nationkey_prf#3455,s_suppkey_prf#3456,s_name_prf#3457,s_acctbal_prf#3458,s_comment_prf#3459] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#3483]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#3474: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#3462 AS p_comment_prf_1#3472, p_name_prf#3463 AS p_name_prf_1#3473, rid#3464 AS rid_1#3474, p_type_prf#3465 AS p_type_prf_1#3475, p_retailprice_prf#3466 AS p_retailprice_prf_1#3476, p_mfgr_prf#3467 AS p_mfgr_prf_1#3477, p_container_prf#3468 AS p_container_prf_1#3478, p_brand_prf#3469 AS p_brand_prf_1#3479, p_size_prf#3470 AS p_size_prf_1#3480, p_partkey_prf#3471 AS p_partkey_prf_1#3481]
            :     :  :  +- Relation[p_comment_prf#3462,p_name_prf#3463,rid#3464,p_type_prf#3465,p_retailprice_prf#3466,p_mfgr_prf#3467,p_container_prf#3468,p_brand_prf#3469,p_size_prf#3470,p_partkey_prf#3471] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3482]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3484 AS l_returnflag_prf_2#3503, l_orderkey_and_l_linenumber_prf#3485 AS l_orderkey_and_l_linenumber_prf_2#3504, l_comment_prf#3486 AS l_comment_prf_2#3505, l_linestatus_prf#3487 AS l_linestatus_prf_2#3506, rid#3488 AS rid_2#3507, l_shipmode_prf#3489 AS l_shipmode_prf_2#3508, l_shipinstruct_prf#3490 AS l_shipinstruct_prf_2#3509, l_quantity_prf#3491 AS l_quantity_prf_2#3510, l_receiptdate_prf#3492 AS l_receiptdate_prf_2#3511, l_linenumber_prf#3493 AS l_linenumber_prf_2#3512, l_tax_prf#3494 AS l_tax_prf_2#3513, l_shipdate_prf#3495 AS l_shipdate_prf_2#3514, l_extendedprice_prf#3496 AS l_extendedprice_prf_2#3515, l_partkey_prf#3497 AS l_partkey_prf_2#3516, l_discount_prf#3498 AS l_discount_prf_2#3517, l_partkey_and_l_suppkey_prf#3499 AS l_partkey_and_l_suppkey_prf_2#3518, l_commitdate_prf#3500 AS l_commitdate_prf_2#3519, l_suppkey_prf#3501 AS l_suppkey_prf_2#3520, l_orderkey_prf#3502 AS l_orderkey_prf_2#3521]
               +- Relation[l_returnflag_prf#3484,l_orderkey_and_l_linenumber_prf#3485,l_comment_prf#3486,l_linestatus_prf#3487,rid#3488,l_shipmode_prf#3489,l_shipinstruct_prf#3490,l_quantity_prf#3491,l_receiptdate_prf#3492,l_linenumber_prf#3493,l_tax_prf#3494,l_shipdate_prf#3495,l_extendedprice_prf#3496,l_partkey_prf#3497,l_discount_prf#3498,l_partkey_and_l_suppkey_prf#3499,l_commitdate_prf#3500,l_suppkey_prf#3501,l_orderkey_prf#3502] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 55714ms

ft2b=
select * from part, partsupp, supplier where p_size = 15 and p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/17 00:33:11 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:33:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3583L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 00:33:11 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 00:33:11 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 00:33:11 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 00:33:11 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:33:11 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:33:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3583L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#3621]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#3606]
         :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#3597: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [p_comment_prf#3585 AS p_comment_prf_0#3595, p_name_prf#3586 AS p_name_prf_0#3596, rid#3587 AS rid_0#3597, p_type_prf#3588 AS p_type_prf_0#3598, p_retailprice_prf#3589 AS p_retailprice_prf_0#3599, p_mfgr_prf#3590 AS p_mfgr_prf_0#3600, p_container_prf#3591 AS p_container_prf_0#3601, p_brand_prf#3592 AS p_brand_prf_0#3602, p_size_prf#3593 AS p_size_prf_0#3603, p_partkey_prf#3594 AS p_partkey_prf_0#3604]
         :     :  :     :  :  +- Relation[p_comment_prf#3585,p_name_prf#3586,rid#3587,p_type_prf#3588,p_retailprice_prf#3589,p_mfgr_prf#3590,p_container_prf#3591,p_brand_prf#3592,p_size_prf#3593,p_partkey_prf#3594] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3605]
         :     :  :     :     +- DexRidFilter part~p_size~15
         :     :  :     :        +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#3607 AS ps_partkey_and_ps_suppkey_prf_1#3614, rid#3608 AS rid_1#3615, ps_availqty_prf#3609 AS ps_availqty_prf_1#3616, ps_comment_prf#3610 AS ps_comment_prf_1#3617, ps_partkey_prf#3611 AS ps_partkey_prf_1#3618, ps_supplycost_prf#3612 AS ps_supplycost_prf_1#3619, ps_suppkey_prf#3613 AS ps_suppkey_prf_1#3620]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#3607,rid#3608,ps_availqty_prf#3609,ps_comment_prf#3610,ps_partkey_prf#3611,ps_supplycost_prf#3612,ps_suppkey_prf#3613] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3622 AS s_phone_prf_2#3630, rid#3623 AS rid_2#3631, s_address_prf#3624 AS s_address_prf_2#3632, s_nationkey_prf#3625 AS s_nationkey_prf_2#3633, s_suppkey_prf#3626 AS s_suppkey_prf_2#3634, s_name_prf#3627 AS s_name_prf_2#3635, s_acctbal_prf#3628 AS s_acctbal_prf_2#3636, s_comment_prf#3629 AS s_comment_prf_2#3637]
            +- Relation[s_phone_prf#3622,rid#3623,s_address_prf#3624,s_nationkey_prf#3625,s_suppkey_prf#3626,s_name_prf#3627,s_acctbal_prf#3628,s_comment_prf#3629] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 921ms

ft2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and (p_size = 15 and s_suppkey = ps_suppkey)
19/10/17 00:33:12 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:33:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3687L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/17 00:33:12 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:33:12 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:33:12 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 00:33:12 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:33:12 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 00:33:12 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 00:33:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3687L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#3689 AS s_phone_prf_0#3697, rid#3690 AS rid_0#3698, s_address_prf#3691 AS s_address_prf_0#3699, s_nationkey_prf#3692 AS s_nationkey_prf_0#3700, s_suppkey_prf#3693 AS s_suppkey_prf_0#3701, s_name_prf#3694 AS s_name_prf_0#3702, s_acctbal_prf#3695 AS s_acctbal_prf_0#3703, s_comment_prf#3696 AS s_comment_prf_0#3704]
         :  :  +- Relation[s_phone_prf#3689,rid#3690,s_address_prf#3691,s_nationkey_prf#3692,s_suppkey_prf#3693,s_name_prf#3694,s_acctbal_prf#3695,s_comment_prf#3696] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2136) AS rid_2#3714]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3713]
         :        :  +- Relation[s_phone_prf#3705,rid#3706,s_address_prf#3707,s_nationkey_prf#3708,s_suppkey_prf#3709,s_name_prf#3710,s_acctbal_prf#3711,s_comment_prf#3712] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#3736]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#3727: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#3715 AS p_comment_prf_1#3725, p_name_prf#3716 AS p_name_prf_1#3726, rid#3717 AS rid_1#3727, p_type_prf#3718 AS p_type_prf_1#3728, p_retailprice_prf#3719 AS p_retailprice_prf_1#3729, p_mfgr_prf#3720 AS p_mfgr_prf_1#3730, p_container_prf#3721 AS p_container_prf_1#3731, p_brand_prf#3722 AS p_brand_prf_1#3732, p_size_prf#3723 AS p_size_prf_1#3733, p_partkey_prf#3724 AS p_partkey_prf_1#3734]
            :     :  :  +- Relation[p_comment_prf#3715,p_name_prf#3716,rid#3717,p_type_prf#3718,p_retailprice_prf#3719,p_mfgr_prf#3720,p_container_prf#3721,p_brand_prf#3722,p_size_prf#3723,p_partkey_prf#3724] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3735]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#3737 AS ps_partkey_and_ps_suppkey_prf_2#3744, rid#3738 AS rid_2#3745, ps_availqty_prf#3739 AS ps_availqty_prf_2#3746, ps_comment_prf#3740 AS ps_comment_prf_2#3747, ps_partkey_prf#3741 AS ps_partkey_prf_2#3748, ps_supplycost_prf#3742 AS ps_supplycost_prf_2#3749, ps_suppkey_prf#3743 AS ps_suppkey_prf_2#3750]
               +- Relation[ps_partkey_and_ps_suppkey_prf#3737,rid#3738,ps_availqty_prf#3739,ps_comment_prf#3740,ps_partkey_prf#3741,ps_supplycost_prf#3742,ps_suppkey_prf#3743] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 7053ms

fr2b=
select * from lineitem, orders, customer where o_custkey = c_custkey and o_orderstatus = 'F' and l_orderkey = o_orderkey
19/10/17 00:33:19 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:33:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3812L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 00:33:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3812L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#3814 AS l_returnflag_prf_0#3833, l_orderkey_and_l_linenumber_prf#3815 AS l_orderkey_and_l_linenumber_prf_0#3834, l_comment_prf#3816 AS l_comment_prf_0#3835, l_linestatus_prf#3817 AS l_linestatus_prf_0#3836, rid#3818 AS rid_0#3837, l_shipmode_prf#3819 AS l_shipmode_prf_0#3838, l_shipinstruct_prf#3820 AS l_shipinstruct_prf_0#3839, l_quantity_prf#3821 AS l_quantity_prf_0#3840, l_receiptdate_prf#3822 AS l_receiptdate_prf_0#3841, l_linenumber_prf#3823 AS l_linenumber_prf_0#3842, l_tax_prf#3824 AS l_tax_prf_0#3843, l_shipdate_prf#3825 AS l_shipdate_prf_0#3844, l_extendedprice_prf#3826 AS l_extendedprice_prf_0#3845, l_partkey_prf#3827 AS l_partkey_prf_0#3846, l_discount_prf#3828 AS l_discount_prf_0#3847, l_partkey_and_l_suppkey_prf#3829 AS l_partkey_and_l_suppkey_prf_0#3848, l_commitdate_prf#3830 AS l_commitdate_prf_0#3849, l_suppkey_prf#3831 AS l_suppkey_prf_0#3850, l_orderkey_prf#3832 AS l_orderkey_prf_0#3851]
         :  :  +- Relation[l_returnflag_prf#3814,l_orderkey_and_l_linenumber_prf#3815,l_comment_prf#3816,l_linestatus_prf#3817,rid#3818,l_shipmode_prf#3819,l_shipinstruct_prf#3820,l_quantity_prf#3821,l_receiptdate_prf#3822,l_linenumber_prf#3823,l_tax_prf#3824,l_shipdate_prf#3825,l_extendedprice_prf#3826,l_partkey_prf#3827,l_discount_prf#3828,l_partkey_and_l_suppkey_prf#3829,l_commitdate_prf#3830,l_suppkey_prf#3831,l_orderkey_prf#3832] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#3872]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3871]
         :        :  +- Relation[l_returnflag_prf#3852,l_orderkey_and_l_linenumber_prf#3853,l_comment_prf#3854,l_linestatus_prf#3855,rid#3856,l_shipmode_prf#3857,l_shipinstruct_prf#3858,l_quantity_prf#3859,l_receiptdate_prf#3860,l_linenumber_prf#3861,l_tax_prf#3862,l_shipdate_prf#3863,l_extendedprice_prf#3864,l_partkey_prf#3865,l_discount_prf#3866,l_partkey_and_l_suppkey_prf#3867,l_commitdate_prf#3868,l_suppkey_prf#3869,l_orderkey_prf#3870] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#3894]
            :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#3884: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#3873 AS o_shippriority_prf_1#3883, rid#3874 AS rid_1#3884, o_orderdate_prf#3875 AS o_orderdate_prf_1#3885, o_custkey_prf#3876 AS o_custkey_prf_1#3886, o_orderpriority_prf#3877 AS o_orderpriority_prf_1#3887, o_clerk_prf#3878 AS o_clerk_prf_1#3888, o_orderstatus_prf#3879 AS o_orderstatus_prf_1#3889, o_totalprice_prf#3880 AS o_totalprice_prf_1#3890, o_orderkey_prf#3881 AS o_orderkey_prf_1#3891, o_comment_prf#3882 AS o_comment_prf_1#3892]
            :     :  :  +- Relation[o_shippriority_prf#3873,rid#3874,o_orderdate_prf#3875,o_custkey_prf#3876,o_orderpriority_prf#3877,o_clerk_prf#3878,o_orderstatus_prf#3879,o_totalprice_prf#3880,o_orderkey_prf#3881,o_comment_prf#3882] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3893]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#3895 AS c_acctbal_prf_2#3904, rid#3896 AS rid_2#3905, c_name_prf#3897 AS c_name_prf_2#3906, c_nationkey_prf#3898 AS c_nationkey_prf_2#3907, c_custkey_prf#3899 AS c_custkey_prf_2#3908, c_comment_prf#3900 AS c_comment_prf_2#3909, c_address_prf#3901 AS c_address_prf_2#3910, c_mktsegment_prf#3902 AS c_mktsegment_prf_2#3911, c_phone_prf#3903 AS c_phone_prf_2#3912]
               +- Relation[c_acctbal_prf#3895,rid#3896,c_name_prf#3897,c_nationkey_prf#3898,c_custkey_prf#3899,c_comment_prf#3900,c_address_prf#3901,c_mktsegment_prf#3902,c_phone_prf#3903] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 108126ms

fr1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey and c_mktsegment = 'BUILDING'
19/10/17 00:35:08 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:35:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3987L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 00:35:08 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:35:08 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:35:08 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:35:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3987L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [l_returnflag_prf#3989 AS l_returnflag_prf_0#4008, l_orderkey_and_l_linenumber_prf#3990 AS l_orderkey_and_l_linenumber_prf_0#4009, l_comment_prf#3991 AS l_comment_prf_0#4010, l_linestatus_prf#3992 AS l_linestatus_prf_0#4011, rid#3993 AS rid_0#4012, l_shipmode_prf#3994 AS l_shipmode_prf_0#4013, l_shipinstruct_prf#3995 AS l_shipinstruct_prf_0#4014, l_quantity_prf#3996 AS l_quantity_prf_0#4015, l_receiptdate_prf#3997 AS l_receiptdate_prf_0#4016, l_linenumber_prf#3998 AS l_linenumber_prf_0#4017, l_tax_prf#3999 AS l_tax_prf_0#4018, l_shipdate_prf#4000 AS l_shipdate_prf_0#4019, l_extendedprice_prf#4001 AS l_extendedprice_prf_0#4020, l_partkey_prf#4002 AS l_partkey_prf_0#4021, l_discount_prf#4003 AS l_discount_prf_0#4022, l_partkey_and_l_suppkey_prf#4004 AS l_partkey_and_l_suppkey_prf_0#4023, l_commitdate_prf#4005 AS l_commitdate_prf_0#4024, l_suppkey_prf#4006 AS l_suppkey_prf_0#4025, l_orderkey_prf#4007 AS l_orderkey_prf_0#4026]
         :  :  :  :  +- Relation[l_returnflag_prf#3989,l_orderkey_and_l_linenumber_prf#3990,l_comment_prf#3991,l_linestatus_prf#3992,rid#3993,l_shipmode_prf#3994,l_shipinstruct_prf#3995,l_quantity_prf#3996,l_receiptdate_prf#3997,l_linenumber_prf#3998,l_tax_prf#3999,l_shipdate_prf#4000,l_extendedprice_prf#4001,l_partkey_prf#4002,l_discount_prf#4003,l_partkey_and_l_suppkey_prf#4004,l_commitdate_prf#4005,l_suppkey_prf#4006,l_orderkey_prf#4007] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#4047]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#4046]
         :  :  :        :  +- Relation[l_returnflag_prf#4027,l_orderkey_and_l_linenumber_prf#4028,l_comment_prf#4029,l_linestatus_prf#4030,rid#4031,l_shipmode_prf#4032,l_shipinstruct_prf#4033,l_quantity_prf#4034,l_receiptdate_prf#4035,l_linenumber_prf#4036,l_tax_prf#4037,l_shipdate_prf#4038,l_extendedprice_prf#4039,l_partkey_prf#4040,l_discount_prf#4041,l_partkey_and_l_suppkey_prf#4042,l_commitdate_prf#4043,l_suppkey_prf#4044,l_orderkey_prf#4045] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#4048 AS o_shippriority_prf_1#4058, rid#4049 AS rid_1#4059, o_orderdate_prf#4050 AS o_orderdate_prf_1#4060, o_custkey_prf#4051 AS o_custkey_prf_1#4061, o_orderpriority_prf#4052 AS o_orderpriority_prf_1#4062, o_clerk_prf#4053 AS o_clerk_prf_1#4063, o_orderstatus_prf#4054 AS o_orderstatus_prf_1#4064, o_totalprice_prf#4055 AS o_totalprice_prf_1#4065, o_orderkey_prf#4056 AS o_orderkey_prf_1#4066, o_comment_prf#4057 AS o_comment_prf_1#4067]
         :  :     +- Relation[o_shippriority_prf#4048,rid#4049,o_orderdate_prf#4050,o_custkey_prf#4051,o_orderpriority_prf#4052,o_clerk_prf#4053,o_orderstatus_prf#4054,o_totalprice_prf#4055,o_orderkey_prf#4056,o_comment_prf#4057] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#4079]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4078]
         :        :  +- Relation[o_shippriority_prf#4068,rid#4069,o_orderdate_prf#4070,o_custkey_prf#4071,o_orderpriority_prf#4072,o_clerk_prf#4073,o_orderstatus_prf#4074,o_totalprice_prf#4075,o_orderkey_prf#4076,o_comment_prf#4077] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_2))
            :- Project [c_acctbal_prf#4080 AS c_acctbal_prf_2#4089, rid#4081 AS rid_2#4090, c_name_prf#4082 AS c_name_prf_2#4091, c_nationkey_prf#4083 AS c_nationkey_prf_2#4092, c_custkey_prf#4084 AS c_custkey_prf_2#4093, c_comment_prf#4085 AS c_comment_prf_2#4094, c_address_prf#4086 AS c_address_prf_2#4095, c_mktsegment_prf#4087 AS c_mktsegment_prf_2#4096, c_phone_prf#4088 AS c_phone_prf_2#4097]
            :  +- Relation[c_acctbal_prf#4080,rid#4081,c_name_prf#4082,c_nationkey_prf#4083,c_custkey_prf#4084,c_comment_prf#4085,c_address_prf#4086,c_mktsegment_prf#4087,c_phone_prf#4088] JDBCRelation(customer_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#4098]
               +- DexRidFilter customer~c_mktsegment~BUILDING
                  +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 121450ms

ft3b=
select * from part, lineitem, supplier where p_size = 15 and p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/17 00:37:09 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:37:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4172L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 00:37:09 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:37:09 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:37:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4172L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#4195]
         :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#4186: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [p_comment_prf#4174 AS p_comment_prf_0#4184, p_name_prf#4175 AS p_name_prf_0#4185, rid#4176 AS rid_0#4186, p_type_prf#4177 AS p_type_prf_0#4187, p_retailprice_prf#4178 AS p_retailprice_prf_0#4188, p_mfgr_prf#4179 AS p_mfgr_prf_0#4189, p_container_prf#4180 AS p_container_prf_0#4190, p_brand_prf#4181 AS p_brand_prf_0#4191, p_size_prf#4182 AS p_size_prf_0#4192, p_partkey_prf#4183 AS p_partkey_prf_0#4193]
         :     :  :     :  :  +- Relation[p_comment_prf#4174,p_name_prf#4175,rid#4176,p_type_prf#4177,p_retailprice_prf#4178,p_mfgr_prf#4179,p_container_prf#4180,p_brand_prf#4181,p_size_prf#4182,p_partkey_prf#4183] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4194]
         :     :  :     :     +- DexRidFilter part~p_size~15
         :     :  :     :        +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#4196 AS l_returnflag_prf_1#4215, l_orderkey_and_l_linenumber_prf#4197 AS l_orderkey_and_l_linenumber_prf_1#4216, l_comment_prf#4198 AS l_comment_prf_1#4217, l_linestatus_prf#4199 AS l_linestatus_prf_1#4218, rid#4200 AS rid_1#4219, l_shipmode_prf#4201 AS l_shipmode_prf_1#4220, l_shipinstruct_prf#4202 AS l_shipinstruct_prf_1#4221, l_quantity_prf#4203 AS l_quantity_prf_1#4222, l_receiptdate_prf#4204 AS l_receiptdate_prf_1#4223, l_linenumber_prf#4205 AS l_linenumber_prf_1#4224, l_tax_prf#4206 AS l_tax_prf_1#4225, l_shipdate_prf#4207 AS l_shipdate_prf_1#4226, l_extendedprice_prf#4208 AS l_extendedprice_prf_1#4227, l_partkey_prf#4209 AS l_partkey_prf_1#4228, l_discount_prf#4210 AS l_discount_prf_1#4229, l_partkey_and_l_suppkey_prf#4211 AS l_partkey_and_l_suppkey_prf_1#4230, l_commitdate_prf#4212 AS l_commitdate_prf_1#4231, l_suppkey_prf#4213 AS l_suppkey_prf_1#4232, l_orderkey_prf#4214 AS l_orderkey_prf_1#4233]
         :     :     +- Relation[l_returnflag_prf#4196,l_orderkey_and_l_linenumber_prf#4197,l_comment_prf#4198,l_linestatus_prf#4199,rid#4200,l_shipmode_prf#4201,l_shipinstruct_prf#4202,l_quantity_prf#4203,l_receiptdate_prf#4204,l_linenumber_prf#4205,l_tax_prf#4206,l_shipdate_prf#4207,l_extendedprice_prf#4208,l_partkey_prf#4209,l_discount_prf#4210,l_partkey_and_l_suppkey_prf#4211,l_commitdate_prf#4212,l_suppkey_prf#4213,l_orderkey_prf#4214] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4235 AS s_phone_prf_2#4243, rid#4236 AS rid_2#4244, s_address_prf#4237 AS s_address_prf_2#4245, s_nationkey_prf#4238 AS s_nationkey_prf_2#4246, s_suppkey_prf#4239 AS s_suppkey_prf_2#4247, s_name_prf#4240 AS s_name_prf_2#4248, s_acctbal_prf#4241 AS s_acctbal_prf_2#4249, s_comment_prf#4242 AS s_comment_prf_2#4250]
            +- Relation[s_phone_prf#4235,rid#4236,s_address_prf#4237,s_nationkey_prf#4238,s_suppkey_prf#4239,s_name_prf#4240,s_acctbal_prf#4241,s_comment_prf#4242] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 6174ms

fq1f=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 00:37:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:37:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4328L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/17 00:37:15 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:37:15 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:37:15 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:37:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4328L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- Project [l_returnflag_prf#4330 AS l_returnflag_prf_0#4349, l_orderkey_and_l_linenumber_prf#4331 AS l_orderkey_and_l_linenumber_prf_0#4350, l_comment_prf#4332 AS l_comment_prf_0#4351, l_linestatus_prf#4333 AS l_linestatus_prf_0#4352, rid#4334 AS rid_0#4353, l_shipmode_prf#4335 AS l_shipmode_prf_0#4354, l_shipinstruct_prf#4336 AS l_shipinstruct_prf_0#4355, l_quantity_prf#4337 AS l_quantity_prf_0#4356, l_receiptdate_prf#4338 AS l_receiptdate_prf_0#4357, l_linenumber_prf#4339 AS l_linenumber_prf_0#4358, l_tax_prf#4340 AS l_tax_prf_0#4359, l_shipdate_prf#4341 AS l_shipdate_prf_0#4360, l_extendedprice_prf#4342 AS l_extendedprice_prf_0#4361, l_partkey_prf#4343 AS l_partkey_prf_0#4362, l_discount_prf#4344 AS l_discount_prf_0#4363, l_partkey_and_l_suppkey_prf#4345 AS l_partkey_and_l_suppkey_prf_0#4364, l_commitdate_prf#4346 AS l_commitdate_prf_0#4365, l_suppkey_prf#4347 AS l_suppkey_prf_0#4366, l_orderkey_prf#4348 AS l_orderkey_prf_0#4367]
         :  :  :  :  :  :  +- Relation[l_returnflag_prf#4330,l_orderkey_and_l_linenumber_prf#4331,l_comment_prf#4332,l_linestatus_prf#4333,rid#4334,l_shipmode_prf#4335,l_shipinstruct_prf#4336,l_quantity_prf#4337,l_receiptdate_prf#4338,l_linenumber_prf#4339,l_tax_prf#4340,l_shipdate_prf#4341,l_extendedprice_prf#4342,l_partkey_prf#4343,l_discount_prf#4344,l_partkey_and_l_suppkey_prf#4345,l_commitdate_prf#4346,l_suppkey_prf#4347,l_orderkey_prf#4348] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#4388]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :  :  :        :- 'Project ['rid AS rid_0#4387]
         :  :  :  :  :        :  +- Relation[l_returnflag_prf#4368,l_orderkey_and_l_linenumber_prf#4369,l_comment_prf#4370,l_linestatus_prf#4371,rid#4372,l_shipmode_prf#4373,l_shipinstruct_prf#4374,l_quantity_prf#4375,l_receiptdate_prf#4376,l_linenumber_prf#4377,l_tax_prf#4378,l_shipdate_prf#4379,l_extendedprice_prf#4380,l_partkey_prf#4381,l_discount_prf#4382,l_partkey_and_l_suppkey_prf#4383,l_commitdate_prf#4384,l_suppkey_prf#4385,l_orderkey_prf#4386] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [o_shippriority_prf#4389 AS o_shippriority_prf_1#4399, rid#4390 AS rid_1#4400, o_orderdate_prf#4391 AS o_orderdate_prf_1#4401, o_custkey_prf#4392 AS o_custkey_prf_1#4402, o_orderpriority_prf#4393 AS o_orderpriority_prf_1#4403, o_clerk_prf#4394 AS o_clerk_prf_1#4404, o_orderstatus_prf#4395 AS o_orderstatus_prf_1#4405, o_totalprice_prf#4396 AS o_totalprice_prf_1#4406, o_orderkey_prf#4397 AS o_orderkey_prf_1#4407, o_comment_prf#4398 AS o_comment_prf_1#4408]
         :  :  :  :     +- Relation[o_shippriority_prf#4389,rid#4390,o_orderdate_prf#4391,o_custkey_prf#4392,o_orderpriority_prf#4393,o_clerk_prf#4394,o_orderstatus_prf#4395,o_totalprice_prf#4396,o_orderkey_prf#4397,o_comment_prf#4398] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#4420]
         :  :  :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :  :  :        :- 'Project ['rid AS rid_1#4419]
         :  :  :        :  +- Relation[o_shippriority_prf#4409,rid#4410,o_orderdate_prf#4411,o_custkey_prf#4412,o_orderpriority_prf#4413,o_clerk_prf#4414,o_orderstatus_prf#4415,o_totalprice_prf#4416,o_orderkey_prf#4417,o_comment_prf#4418] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#4421 AS c_acctbal_prf_2#4430, rid#4422 AS rid_2#4431, c_name_prf#4423 AS c_name_prf_2#4432, c_nationkey_prf#4424 AS c_nationkey_prf_2#4433, c_custkey_prf#4425 AS c_custkey_prf_2#4434, c_comment_prf#4426 AS c_comment_prf_2#4435, c_address_prf#4427 AS c_address_prf_2#4436, c_mktsegment_prf#4428 AS c_mktsegment_prf_2#4437, c_phone_prf#4429 AS c_phone_prf_2#4438]
         :  :     +- Relation[c_acctbal_prf#4421,rid#4422,c_name_prf#4423,c_nationkey_prf#4424,c_custkey_prf#4425,c_comment_prf#4426,c_address_prf#4427,c_mktsegment_prf#4428,c_phone_prf#4429] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2136) AS rid_3#4449]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#4448]
         :        :  +- Relation[c_acctbal_prf#4439,rid#4440,c_name_prf#4441,c_nationkey_prf#4442,c_custkey_prf#4443,c_comment_prf#4444,c_address_prf#4445,c_mktsegment_prf#4446,c_phone_prf#4447] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_3))
            :- Project [rid#4450 AS rid_3#4455, n_regionkey_prf#4451 AS n_regionkey_prf_3#4456, n_nationkey_prf#4452 AS n_nationkey_prf_3#4457, n_name_prf#4453 AS n_name_prf_3#4458, n_comment_prf#4454 AS n_comment_prf_3#4459]
            :  +- Relation[rid#4450,n_regionkey_prf#4451,n_nationkey_prf#4452,n_name_prf#4453,n_comment_prf#4454] JDBCRelation(nation_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#4460]
               +- DexRidFilter nation~n_name~FRANCE
                  +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 167791ms

ft1b=
select * from nation, supplier, customer where n_name = 'FRANCE' and n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/17 00:40:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:40:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4526L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 00:40:03 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:40:03 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:40:03 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:40:03 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:40:03 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:40:03 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:40:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4526L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#4556]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#4539]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#4533: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#4528 AS rid_0#4533, n_regionkey_prf#4529 AS n_regionkey_prf_0#4534, n_nationkey_prf#4530 AS n_nationkey_prf_0#4535, n_name_prf#4531 AS n_name_prf_0#4536, n_comment_prf#4532 AS n_comment_prf_0#4537]
         :     :  :     :  :  +- Relation[rid#4528,n_regionkey_prf#4529,n_nationkey_prf#4530,n_name_prf#4531,n_comment_prf#4532] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4538]
         :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :        +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#4540 AS s_phone_prf_1#4548, rid#4541 AS rid_1#4549, s_address_prf#4542 AS s_address_prf_1#4550, s_nationkey_prf#4543 AS s_nationkey_prf_1#4551, s_suppkey_prf#4544 AS s_suppkey_prf_1#4552, s_name_prf#4545 AS s_name_prf_1#4553, s_acctbal_prf#4546 AS s_acctbal_prf_1#4554, s_comment_prf#4547 AS s_comment_prf_1#4555]
         :     :     +- Relation[s_phone_prf#4540,rid#4541,s_address_prf#4542,s_nationkey_prf#4543,s_suppkey_prf#4544,s_name_prf#4545,s_acctbal_prf#4546,s_comment_prf#4547] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4557 AS c_acctbal_prf_2#4566, rid#4558 AS rid_2#4567, c_name_prf#4559 AS c_name_prf_2#4568, c_nationkey_prf#4560 AS c_nationkey_prf_2#4569, c_custkey_prf#4561 AS c_custkey_prf_2#4570, c_comment_prf#4562 AS c_comment_prf_2#4571, c_address_prf#4563 AS c_address_prf_2#4572, c_mktsegment_prf#4564 AS c_mktsegment_prf_2#4573, c_phone_prf#4565 AS c_phone_prf_2#4574]
            +- Relation[c_acctbal_prf#4557,rid#4558,c_name_prf#4559,c_nationkey_prf#4560,c_custkey_prf#4561,c_comment_prf#4562,c_address_prf#4563,c_mktsegment_prf#4564,c_phone_prf#4565] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 30007ms

fq1c=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 00:40:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:40:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4637L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [c_nationkey#293L, o_orderkey#342L]
               :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :     :- Project [c_custkey#290L, c_nationkey#293L]
               :     :  +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
               :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               :     +- Project [o_orderkey#342L, o_custkey#343L]
               :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 00:40:33 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:40:33 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:40:33 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:40:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4637L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#4650]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#4644: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [rid#4639 AS rid_0#4644, n_regionkey_prf#4640 AS n_regionkey_prf_0#4645, n_nationkey_prf#4641 AS n_nationkey_prf_0#4646, n_name_prf#4642 AS n_name_prf_0#4647, n_comment_prf#4643 AS n_comment_prf_0#4648]
         :     :  :  +- Relation[rid#4639,n_regionkey_prf#4640,n_nationkey_prf#4641,n_name_prf#4642,n_comment_prf#4643] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4649]
         :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :        +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join NaturalJoin(Inner)
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- Project [c_acctbal_prf#4651 AS c_acctbal_prf_1#4660, rid#4652 AS rid_1#4661, c_name_prf#4653 AS c_name_prf_1#4662, c_nationkey_prf#4654 AS c_nationkey_prf_1#4663, c_custkey_prf#4655 AS c_custkey_prf_1#4664, c_comment_prf#4656 AS c_comment_prf_1#4665, c_address_prf#4657 AS c_address_prf_1#4666, c_mktsegment_prf#4658 AS c_mktsegment_prf_1#4667, c_phone_prf#4659 AS c_phone_prf_1#4668]
            :  :  :  :  +- Relation[c_acctbal_prf#4651,rid#4652,c_name_prf#4653,c_nationkey_prf#4654,c_custkey_prf#4655,c_comment_prf#4656,c_address_prf#4657,c_mktsegment_prf#4658,c_phone_prf#4659] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#4679]
            :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
            :  :  :        :- 'Project ['rid AS rid_1#4678]
            :  :  :        :  +- Relation[c_acctbal_prf#4669,rid#4670,c_name_prf#4671,c_nationkey_prf#4672,c_custkey_prf#4673,c_comment_prf#4674,c_address_prf#4675,c_mktsegment_prf#4676,c_phone_prf#4677] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
            :  :  +- Project [o_shippriority_prf#4680 AS o_shippriority_prf_2#4690, rid#4681 AS rid_2#4691, o_orderdate_prf#4682 AS o_orderdate_prf_2#4692, o_custkey_prf#4683 AS o_custkey_prf_2#4693, o_orderpriority_prf#4684 AS o_orderpriority_prf_2#4694, o_clerk_prf#4685 AS o_clerk_prf_2#4695, o_orderstatus_prf#4686 AS o_orderstatus_prf_2#4696, o_totalprice_prf#4687 AS o_totalprice_prf_2#4697, o_orderkey_prf#4688 AS o_orderkey_prf_2#4698, o_comment_prf#4689 AS o_comment_prf_2#4699]
            :  :     +- Relation[o_shippriority_prf#4680,rid#4681,o_orderdate_prf#4682,o_custkey_prf#4683,o_orderpriority_prf#4684,o_clerk_prf#4685,o_orderstatus_prf#4686,o_totalprice_prf#4687,o_orderkey_prf#4688,o_comment_prf#4689] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2136) AS rid_3#4711]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#4710]
            :        :  +- Relation[o_shippriority_prf#4700,rid#4701,o_orderdate_prf#4702,o_custkey_prf#4703,o_orderpriority_prf#4704,o_clerk_prf#4705,o_orderstatus_prf#4706,o_totalprice_prf#4707,o_orderkey_prf#4708,o_comment_prf#4709] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4712 AS l_returnflag_prf_3#4731, l_orderkey_and_l_linenumber_prf#4713 AS l_orderkey_and_l_linenumber_prf_3#4732, l_comment_prf#4714 AS l_comment_prf_3#4733, l_linestatus_prf#4715 AS l_linestatus_prf_3#4734, rid#4716 AS rid_3#4735, l_shipmode_prf#4717 AS l_shipmode_prf_3#4736, l_shipinstruct_prf#4718 AS l_shipinstruct_prf_3#4737, l_quantity_prf#4719 AS l_quantity_prf_3#4738, l_receiptdate_prf#4720 AS l_receiptdate_prf_3#4739, l_linenumber_prf#4721 AS l_linenumber_prf_3#4740, l_tax_prf#4722 AS l_tax_prf_3#4741, l_shipdate_prf#4723 AS l_shipdate_prf_3#4742, l_extendedprice_prf#4724 AS l_extendedprice_prf_3#4743, l_partkey_prf#4725 AS l_partkey_prf_3#4744, l_discount_prf#4726 AS l_discount_prf_3#4745, l_partkey_and_l_suppkey_prf#4727 AS l_partkey_and_l_suppkey_prf_3#4746, l_commitdate_prf#4728 AS l_commitdate_prf_3#4747, l_suppkey_prf#4729 AS l_suppkey_prf_3#4748, l_orderkey_prf#4730 AS l_orderkey_prf_3#4749]
               +- Relation[l_returnflag_prf#4712,l_orderkey_and_l_linenumber_prf#4713,l_comment_prf#4714,l_linestatus_prf#4715,rid#4716,l_shipmode_prf#4717,l_shipinstruct_prf#4718,l_quantity_prf#4719,l_receiptdate_prf#4720,l_linenumber_prf#4721,l_tax_prf#4722,l_shipdate_prf#4723,l_extendedprice_prf#4724,l_partkey_prf#4725,l_discount_prf#4726,l_partkey_and_l_suppkey_prf#4727,l_commitdate_prf#4728,l_suppkey_prf#4729,l_orderkey_prf#4730] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 163187ms

ft1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_name = 'FRANCE' and n_nationkey = c_nationkey
19/10/17 00:43:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:43:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4815L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 00:43:16 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:43:16 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:43:16 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:43:16 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:43:16 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:43:16 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:43:16 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:43:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4815L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#4854]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [s_phone_prf#4817 AS s_phone_prf_0#4825, rid#4818 AS rid_0#4826, s_address_prf#4819 AS s_address_prf_0#4827, s_nationkey_prf#4820 AS s_nationkey_prf_0#4828, s_suppkey_prf#4821 AS s_suppkey_prf_0#4829, s_name_prf#4822 AS s_name_prf_0#4830, s_acctbal_prf#4823 AS s_acctbal_prf_0#4831, s_comment_prf#4824 AS s_comment_prf_0#4832]
         :     :  :  :  +- Relation[s_phone_prf#4817,rid#4818,s_address_prf#4819,s_nationkey_prf#4820,s_suppkey_prf#4821,s_name_prf#4822,s_acctbal_prf#4823,s_comment_prf#4824] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#4842]
         :     :  :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#4841]
         :     :  :        :  +- Relation[s_phone_prf#4833,rid#4834,s_address_prf#4835,s_nationkey_prf#4836,s_suppkey_prf#4837,s_name_prf#4838,s_acctbal_prf#4839,s_comment_prf#4840] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [rid#4843 AS rid_1#4848, n_regionkey_prf#4844 AS n_regionkey_prf_1#4849, n_nationkey_prf#4845 AS n_nationkey_prf_1#4850, n_name_prf#4846 AS n_name_prf_1#4851, n_comment_prf#4847 AS n_comment_prf_1#4852]
         :     :     :  +- Relation[rid#4843,n_regionkey_prf#4844,n_nationkey_prf#4845,n_name_prf#4846,n_comment_prf#4847] JDBCRelation(nation_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4853]
         :     :        +- DexRidFilter nation~n_name~FRANCE
         :     :           +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4855 AS c_acctbal_prf_2#4864, rid#4856 AS rid_2#4865, c_name_prf#4857 AS c_name_prf_2#4866, c_nationkey_prf#4858 AS c_nationkey_prf_2#4867, c_custkey_prf#4859 AS c_custkey_prf_2#4868, c_comment_prf#4860 AS c_comment_prf_2#4869, c_address_prf#4861 AS c_address_prf_2#4870, c_mktsegment_prf#4862 AS c_mktsegment_prf_2#4871, c_phone_prf#4863 AS c_phone_prf_2#4872]
            +- Relation[c_acctbal_prf#4855,rid#4856,c_name_prf#4857,c_nationkey_prf#4858,c_custkey_prf#4859,c_comment_prf#4860,c_address_prf#4861,c_mktsegment_prf#4862,c_phone_prf#4863] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 48047ms

fr2f=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/17 00:44:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:44:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4931L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_orderkey#342L, o_custkey#343L]
         :     :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L]
         :        +- Filter isnotnull(c_custkey#290L)
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 00:44:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4931L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#4973]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#4954]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_0#4944: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [o_shippriority_prf#4933 AS o_shippriority_prf_0#4943, rid#4934 AS rid_0#4944, o_orderdate_prf#4935 AS o_orderdate_prf_0#4945, o_custkey_prf#4936 AS o_custkey_prf_0#4946, o_orderpriority_prf#4937 AS o_orderpriority_prf_0#4947, o_clerk_prf#4938 AS o_clerk_prf_0#4948, o_orderstatus_prf#4939 AS o_orderstatus_prf_0#4949, o_totalprice_prf#4940 AS o_totalprice_prf_0#4950, o_orderkey_prf#4941 AS o_orderkey_prf_0#4951, o_comment_prf#4942 AS o_comment_prf_0#4952]
         :     :  :     :  :  +- Relation[o_shippriority_prf#4933,rid#4934,o_orderdate_prf#4935,o_custkey_prf#4936,o_orderpriority_prf#4937,o_clerk_prf#4938,o_orderstatus_prf#4939,o_totalprice_prf#4940,o_orderkey_prf#4941,o_comment_prf#4942] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4953]
         :     :  :     :     +- DexRidFilter orders~o_orderstatus~F
         :     :  :     :        +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#4955 AS c_acctbal_prf_1#4964, rid#4956 AS rid_1#4965, c_name_prf#4957 AS c_name_prf_1#4966, c_nationkey_prf#4958 AS c_nationkey_prf_1#4967, c_custkey_prf#4959 AS c_custkey_prf_1#4968, c_comment_prf#4960 AS c_comment_prf_1#4969, c_address_prf#4961 AS c_address_prf_1#4970, c_mktsegment_prf#4962 AS c_mktsegment_prf_1#4971, c_phone_prf#4963 AS c_phone_prf_1#4972]
         :     :     +- Relation[c_acctbal_prf#4955,rid#4956,c_name_prf#4957,c_nationkey_prf#4958,c_custkey_prf#4959,c_comment_prf#4960,c_address_prf#4961,c_mktsegment_prf#4962,c_phone_prf#4963] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4974 AS l_returnflag_prf_2#4993, l_orderkey_and_l_linenumber_prf#4975 AS l_orderkey_and_l_linenumber_prf_2#4994, l_comment_prf#4976 AS l_comment_prf_2#4995, l_linestatus_prf#4977 AS l_linestatus_prf_2#4996, rid#4978 AS rid_2#4997, l_shipmode_prf#4979 AS l_shipmode_prf_2#4998, l_shipinstruct_prf#4980 AS l_shipinstruct_prf_2#4999, l_quantity_prf#4981 AS l_quantity_prf_2#5000, l_receiptdate_prf#4982 AS l_receiptdate_prf_2#5001, l_linenumber_prf#4983 AS l_linenumber_prf_2#5002, l_tax_prf#4984 AS l_tax_prf_2#5003, l_shipdate_prf#4985 AS l_shipdate_prf_2#5004, l_extendedprice_prf#4986 AS l_extendedprice_prf_2#5005, l_partkey_prf#4987 AS l_partkey_prf_2#5006, l_discount_prf#4988 AS l_discount_prf_2#5007, l_partkey_and_l_suppkey_prf#4989 AS l_partkey_and_l_suppkey_prf_2#5008, l_commitdate_prf#4990 AS l_commitdate_prf_2#5009, l_suppkey_prf#4991 AS l_suppkey_prf_2#5010, l_orderkey_prf#4992 AS l_orderkey_prf_2#5011]
            +- Relation[l_returnflag_prf#4974,l_orderkey_and_l_linenumber_prf#4975,l_comment_prf#4976,l_linestatus_prf#4977,rid#4978,l_shipmode_prf#4979,l_shipinstruct_prf#4980,l_quantity_prf#4981,l_receiptdate_prf#4982,l_linenumber_prf#4983,l_tax_prf#4984,l_shipdate_prf#4985,l_extendedprice_prf#4986,l_partkey_prf#4987,l_discount_prf#4988,l_partkey_and_l_suppkey_prf#4989,l_commitdate_prf#4990,l_suppkey_prf#4991,l_orderkey_prf#4992] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 83047ms

ft1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/17 00:45:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:45:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5072L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/17 00:45:27 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:45:27 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:45:27 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:45:27 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:45:27 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:45:27 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:45:27 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:45:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5072L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#5074 AS c_acctbal_prf_0#5083, rid#5075 AS rid_0#5084, c_name_prf#5076 AS c_name_prf_0#5085, c_nationkey_prf#5077 AS c_nationkey_prf_0#5086, c_custkey_prf#5078 AS c_custkey_prf_0#5087, c_comment_prf#5079 AS c_comment_prf_0#5088, c_address_prf#5080 AS c_address_prf_0#5089, c_mktsegment_prf#5081 AS c_mktsegment_prf_0#5090, c_phone_prf#5082 AS c_phone_prf_0#5091]
         :  :  +- Relation[c_acctbal_prf#5074,rid#5075,c_name_prf#5076,c_nationkey_prf#5077,c_custkey_prf#5078,c_comment_prf#5079,c_address_prf#5080,c_mktsegment_prf#5081,c_phone_prf#5082] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2136) AS rid_2#5102]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5101]
         :        :  +- Relation[c_acctbal_prf#5092,rid#5093,c_name_prf#5094,c_nationkey_prf#5095,c_custkey_prf#5096,c_comment_prf#5097,c_address_prf#5098,c_mktsegment_prf#5099,c_phone_prf#5100] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [s_phone_prf#5103 AS s_phone_prf_1#5111, rid#5104 AS rid_1#5112, s_address_prf#5105 AS s_address_prf_1#5113, s_nationkey_prf#5106 AS s_nationkey_prf_1#5114, s_suppkey_prf#5107 AS s_suppkey_prf_1#5115, s_name_prf#5108 AS s_name_prf_1#5116, s_acctbal_prf#5109 AS s_acctbal_prf_1#5117, s_comment_prf#5110 AS s_comment_prf_1#5118]
            :  :  +- Relation[s_phone_prf#5103,rid#5104,s_address_prf#5105,s_nationkey_prf#5106,s_suppkey_prf#5107,s_name_prf#5108,s_acctbal_prf#5109,s_comment_prf#5110] JDBCRelation(supplier_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#5128]
            :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#5127]
            :        :  +- Relation[s_phone_prf#5119,rid#5120,s_address_prf#5121,s_nationkey_prf#5122,s_suppkey_prf#5123,s_name_prf#5124,s_acctbal_prf#5125,s_comment_prf#5126] JDBCRelation(supplier_prf) [numPartitions=1]
            :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [rid#5129 AS rid_2#5134, n_regionkey_prf#5130 AS n_regionkey_prf_2#5135, n_nationkey_prf#5131 AS n_nationkey_prf_2#5136, n_name_prf#5132 AS n_name_prf_2#5137, n_comment_prf#5133 AS n_comment_prf_2#5138]
               :  +- Relation[rid#5129,n_regionkey_prf#5130,n_nationkey_prf#5131,n_name_prf#5132,n_comment_prf#5133] JDBCRelation(nation_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#5139]
                  +- DexRidFilter nation~n_name~FRANCE
                     +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 33151ms

fs1a=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/17 00:46:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:46:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5207L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [c_custkey#290L]
         :     :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L]
         :        +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/17 00:46:00 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:46:00 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:46:00 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:46:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5207L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, 'rid_2, 'l_returnflag_prf_2, 'l_orderkey_and_l_linenumber_prf_2, 'l_comment_prf_2, 'l_linestatus_prf_2, ... 15 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#5249]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#5228]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#5219: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [c_acctbal_prf#5209 AS c_acctbal_prf_0#5218, rid#5210 AS rid_0#5219, c_name_prf#5211 AS c_name_prf_0#5220, c_nationkey_prf#5212 AS c_nationkey_prf_0#5221, c_custkey_prf#5213 AS c_custkey_prf_0#5222, c_comment_prf#5214 AS c_comment_prf_0#5223, c_address_prf#5215 AS c_address_prf_0#5224, c_mktsegment_prf#5216 AS c_mktsegment_prf_0#5225, c_phone_prf#5217 AS c_phone_prf_0#5226]
         :     :  :     :  :     :  :  +- Relation[c_acctbal_prf#5209,rid#5210,c_name_prf#5211,c_nationkey_prf#5212,c_custkey_prf#5213,c_comment_prf#5214,c_address_prf#5215,c_mktsegment_prf#5216,c_phone_prf#5217] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5227]
         :     :  :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :  :     :        +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [o_shippriority_prf#5229 AS o_shippriority_prf_1#5239, rid#5230 AS rid_1#5240, o_orderdate_prf#5231 AS o_orderdate_prf_1#5241, o_custkey_prf#5232 AS o_custkey_prf_1#5242, o_orderpriority_prf#5233 AS o_orderpriority_prf_1#5243, o_clerk_prf#5234 AS o_clerk_prf_1#5244, o_orderstatus_prf#5235 AS o_orderstatus_prf_1#5245, o_totalprice_prf#5236 AS o_totalprice_prf_1#5246, o_orderkey_prf#5237 AS o_orderkey_prf_1#5247, o_comment_prf#5238 AS o_comment_prf_1#5248]
         :     :  :     :     +- Relation[o_shippriority_prf#5229,rid#5230,o_orderdate_prf#5231,o_custkey_prf#5232,o_orderpriority_prf#5233,o_clerk_prf#5234,o_orderstatus_prf#5235,o_totalprice_prf#5236,o_orderkey_prf#5237,o_comment_prf#5238] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#5250 AS l_returnflag_prf_2#5269, l_orderkey_and_l_linenumber_prf#5251 AS l_orderkey_and_l_linenumber_prf_2#5270, l_comment_prf#5252 AS l_comment_prf_2#5271, l_linestatus_prf#5253 AS l_linestatus_prf_2#5272, rid#5254 AS rid_2#5273, l_shipmode_prf#5255 AS l_shipmode_prf_2#5274, l_shipinstruct_prf#5256 AS l_shipinstruct_prf_2#5275, l_quantity_prf#5257 AS l_quantity_prf_2#5276, l_receiptdate_prf#5258 AS l_receiptdate_prf_2#5277, l_linenumber_prf#5259 AS l_linenumber_prf_2#5278, l_tax_prf#5260 AS l_tax_prf_2#5279, l_shipdate_prf#5261 AS l_shipdate_prf_2#5280, l_extendedprice_prf#5262 AS l_extendedprice_prf_2#5281, l_partkey_prf#5263 AS l_partkey_prf_2#5282, l_discount_prf#5264 AS l_discount_prf_2#5283, l_partkey_and_l_suppkey_prf#5265 AS l_partkey_and_l_suppkey_prf_2#5284, l_commitdate_prf#5266 AS l_commitdate_prf_2#5285, l_suppkey_prf#5267 AS l_suppkey_prf_2#5286, l_orderkey_prf#5268 AS l_orderkey_prf_2#5287]
         :     :     +- Relation[l_returnflag_prf#5250,l_orderkey_and_l_linenumber_prf#5251,l_comment_prf#5252,l_linestatus_prf#5253,rid#5254,l_shipmode_prf#5255,l_shipinstruct_prf#5256,l_quantity_prf#5257,l_receiptdate_prf#5258,l_linenumber_prf#5259,l_tax_prf#5260,l_shipdate_prf#5261,l_extendedprice_prf#5262,l_partkey_prf#5263,l_discount_prf#5264,l_partkey_and_l_suppkey_prf#5265,l_commitdate_prf#5266,l_suppkey_prf#5267,l_orderkey_prf#5268] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#5289 AS p_comment_prf_3#5299, p_name_prf#5290 AS p_name_prf_3#5300, rid#5291 AS rid_3#5301, p_type_prf#5292 AS p_type_prf_3#5302, p_retailprice_prf#5293 AS p_retailprice_prf_3#5303, p_mfgr_prf#5294 AS p_mfgr_prf_3#5304, p_container_prf#5295 AS p_container_prf_3#5305, p_brand_prf#5296 AS p_brand_prf_3#5306, p_size_prf#5297 AS p_size_prf_3#5307, p_partkey_prf#5298 AS p_partkey_prf_3#5308]
            +- Relation[p_comment_prf#5289,p_name_prf#5290,rid#5291,p_type_prf#5292,p_retailprice_prf#5293,p_mfgr_prf#5294,p_container_prf#5295,p_brand_prf#5296,p_size_prf#5297,p_partkey_prf#5298] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 108022ms

ft1d=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/17 00:47:48 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:47:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5379L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_nationkey#21L]
                  +- Filter isnotnull(s_nationkey#21L)
                     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 00:47:48 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:47:48 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:47:48 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:47:48 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:47:48 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:47:48 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:47:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5379L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#5381 AS c_acctbal_prf_0#5390, rid#5382 AS rid_0#5391, c_name_prf#5383 AS c_name_prf_0#5392, c_nationkey_prf#5384 AS c_nationkey_prf_0#5393, c_custkey_prf#5385 AS c_custkey_prf_0#5394, c_comment_prf#5386 AS c_comment_prf_0#5395, c_address_prf#5387 AS c_address_prf_0#5396, c_mktsegment_prf#5388 AS c_mktsegment_prf_0#5397, c_phone_prf#5389 AS c_phone_prf_0#5398]
         :  :  +- Relation[c_acctbal_prf#5381,rid#5382,c_name_prf#5383,c_nationkey_prf#5384,c_custkey_prf#5385,c_comment_prf#5386,c_address_prf#5387,c_mktsegment_prf#5388,c_phone_prf#5389] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#5409]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5408]
         :        :  +- Relation[c_acctbal_prf#5399,rid#5400,c_name_prf#5401,c_nationkey_prf#5402,c_custkey_prf#5403,c_comment_prf#5404,c_address_prf#5405,c_mktsegment_prf#5406,c_phone_prf#5407] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#5421]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_1#5415: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [rid#5410 AS rid_1#5415, n_regionkey_prf#5411 AS n_regionkey_prf_1#5416, n_nationkey_prf#5412 AS n_nationkey_prf_1#5417, n_name_prf#5413 AS n_name_prf_1#5418, n_comment_prf#5414 AS n_comment_prf_1#5419]
            :     :  :  +- Relation[rid#5410,n_regionkey_prf#5411,n_nationkey_prf#5412,n_name_prf#5413,n_comment_prf#5414] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5420]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [s_phone_prf#5422 AS s_phone_prf_2#5430, rid#5423 AS rid_2#5431, s_address_prf#5424 AS s_address_prf_2#5432, s_nationkey_prf#5425 AS s_nationkey_prf_2#5433, s_suppkey_prf#5426 AS s_suppkey_prf_2#5434, s_name_prf#5427 AS s_name_prf_2#5435, s_acctbal_prf#5428 AS s_acctbal_prf_2#5436, s_comment_prf#5429 AS s_comment_prf_2#5437]
               +- Relation[s_phone_prf#5422,rid#5423,s_address_prf#5424,s_nationkey_prf#5425,s_suppkey_prf#5426,s_name_prf#5427,s_acctbal_prf#5428,s_comment_prf#5429] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 24254ms

ft2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and p_size = 15 and ps_suppkey = s_suppkey
19/10/17 00:48:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:48:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5484L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 00:48:13 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 00:48:13 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 00:48:13 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 00:48:13 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/17 00:48:13 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:48:13 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:48:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5484L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#5530]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, rid_0#5494: string
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [ps_partkey_and_ps_suppkey_prf#5486 AS ps_partkey_and_ps_suppkey_prf_0#5493, rid#5487 AS rid_0#5494, ps_availqty_prf#5488 AS ps_availqty_prf_0#5495, ps_comment_prf#5489 AS ps_comment_prf_0#5496, ps_partkey_prf#5490 AS ps_partkey_prf_0#5497, ps_supplycost_prf#5491 AS ps_supplycost_prf_0#5498, ps_suppkey_prf#5492 AS ps_suppkey_prf_0#5499]
         :     :  :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#5486,rid#5487,ps_availqty_prf#5488,ps_comment_prf#5489,ps_partkey_prf#5490,ps_supplycost_prf#5491,ps_suppkey_prf#5492] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#5508]
         :     :  :     +- 'DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#5507]
         :     :  :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#5500,rid#5501,ps_availqty_prf#5502,ps_comment_prf#5503,ps_partkey_prf#5504,ps_supplycost_prf#5505,ps_suppkey_prf#5506] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [p_comment_prf#5509 AS p_comment_prf_1#5519, p_name_prf#5510 AS p_name_prf_1#5520, rid#5511 AS rid_1#5521, p_type_prf#5512 AS p_type_prf_1#5522, p_retailprice_prf#5513 AS p_retailprice_prf_1#5523, p_mfgr_prf#5514 AS p_mfgr_prf_1#5524, p_container_prf#5515 AS p_container_prf_1#5525, p_brand_prf#5516 AS p_brand_prf_1#5526, p_size_prf#5517 AS p_size_prf_1#5527, p_partkey_prf#5518 AS p_partkey_prf_1#5528]
         :     :     :  +- Relation[p_comment_prf#5509,p_name_prf#5510,rid#5511,p_type_prf#5512,p_retailprice_prf#5513,p_mfgr_prf#5514,p_container_prf#5515,p_brand_prf#5516,p_size_prf#5517,p_partkey_prf#5518] JDBCRelation(part_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5529]
         :     :        +- DexRidFilter part~p_size~15
         :     :           +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5531 AS s_phone_prf_2#5539, rid#5532 AS rid_2#5540, s_address_prf#5533 AS s_address_prf_2#5541, s_nationkey_prf#5534 AS s_nationkey_prf_2#5542, s_suppkey_prf#5535 AS s_suppkey_prf_2#5543, s_name_prf#5536 AS s_name_prf_2#5544, s_acctbal_prf#5537 AS s_acctbal_prf_2#5545, s_comment_prf#5538 AS s_comment_prf_2#5546]
            +- Relation[s_phone_prf#5531,rid#5532,s_address_prf#5533,s_nationkey_prf#5534,s_suppkey_prf#5535,s_name_prf#5536,s_acctbal_prf#5537,s_comment_prf#5538] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 49024ms

fq1e=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 00:49:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:49:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5612L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [c_custkey#290L, c_nationkey#293L]
                  +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/17 00:49:02 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:49:02 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:49:02 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:49:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5612L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [l_returnflag_prf#5614 AS l_returnflag_prf_0#5633, l_orderkey_and_l_linenumber_prf#5615 AS l_orderkey_and_l_linenumber_prf_0#5634, l_comment_prf#5616 AS l_comment_prf_0#5635, l_linestatus_prf#5617 AS l_linestatus_prf_0#5636, rid#5618 AS rid_0#5637, l_shipmode_prf#5619 AS l_shipmode_prf_0#5638, l_shipinstruct_prf#5620 AS l_shipinstruct_prf_0#5639, l_quantity_prf#5621 AS l_quantity_prf_0#5640, l_receiptdate_prf#5622 AS l_receiptdate_prf_0#5641, l_linenumber_prf#5623 AS l_linenumber_prf_0#5642, l_tax_prf#5624 AS l_tax_prf_0#5643, l_shipdate_prf#5625 AS l_shipdate_prf_0#5644, l_extendedprice_prf#5626 AS l_extendedprice_prf_0#5645, l_partkey_prf#5627 AS l_partkey_prf_0#5646, l_discount_prf#5628 AS l_discount_prf_0#5647, l_partkey_and_l_suppkey_prf#5629 AS l_partkey_and_l_suppkey_prf_0#5648, l_commitdate_prf#5630 AS l_commitdate_prf_0#5649, l_suppkey_prf#5631 AS l_suppkey_prf_0#5650, l_orderkey_prf#5632 AS l_orderkey_prf_0#5651]
         :  :  :  :  +- Relation[l_returnflag_prf#5614,l_orderkey_and_l_linenumber_prf#5615,l_comment_prf#5616,l_linestatus_prf#5617,rid#5618,l_shipmode_prf#5619,l_shipinstruct_prf#5620,l_quantity_prf#5621,l_receiptdate_prf#5622,l_linenumber_prf#5623,l_tax_prf#5624,l_shipdate_prf#5625,l_extendedprice_prf#5626,l_partkey_prf#5627,l_discount_prf#5628,l_partkey_and_l_suppkey_prf#5629,l_commitdate_prf#5630,l_suppkey_prf#5631,l_orderkey_prf#5632] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#5672]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#5671]
         :  :  :        :  +- Relation[l_returnflag_prf#5652,l_orderkey_and_l_linenumber_prf#5653,l_comment_prf#5654,l_linestatus_prf#5655,rid#5656,l_shipmode_prf#5657,l_shipinstruct_prf#5658,l_quantity_prf#5659,l_receiptdate_prf#5660,l_linenumber_prf#5661,l_tax_prf#5662,l_shipdate_prf#5663,l_extendedprice_prf#5664,l_partkey_prf#5665,l_discount_prf#5666,l_partkey_and_l_suppkey_prf#5667,l_commitdate_prf#5668,l_suppkey_prf#5669,l_orderkey_prf#5670] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#5673 AS o_shippriority_prf_1#5683, rid#5674 AS rid_1#5684, o_orderdate_prf#5675 AS o_orderdate_prf_1#5685, o_custkey_prf#5676 AS o_custkey_prf_1#5686, o_orderpriority_prf#5677 AS o_orderpriority_prf_1#5687, o_clerk_prf#5678 AS o_clerk_prf_1#5688, o_orderstatus_prf#5679 AS o_orderstatus_prf_1#5689, o_totalprice_prf#5680 AS o_totalprice_prf_1#5690, o_orderkey_prf#5681 AS o_orderkey_prf_1#5691, o_comment_prf#5682 AS o_comment_prf_1#5692]
         :  :     +- Relation[o_shippriority_prf#5673,rid#5674,o_orderdate_prf#5675,o_custkey_prf#5676,o_orderpriority_prf#5677,o_clerk_prf#5678,o_orderstatus_prf#5679,o_totalprice_prf#5680,o_orderkey_prf#5681,o_comment_prf#5682] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2136) AS rid_3#5704]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5703]
         :        :  +- Relation[o_shippriority_prf#5693,rid#5694,o_orderdate_prf#5695,o_custkey_prf#5696,o_orderpriority_prf#5697,o_clerk_prf#5698,o_orderstatus_prf#5699,o_totalprice_prf#5700,o_orderkey_prf#5701,o_comment_prf#5702] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_2, 'n_regionkey_prf_2, 'n_nationkey_prf_2, 'n_name_prf_2, 'n_comment_prf_2, dexdecrypt('value_dec_key, value#2136) AS rid_3#5716]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_2#5710: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [rid#5705 AS rid_2#5710, n_regionkey_prf#5706 AS n_regionkey_prf_2#5711, n_nationkey_prf#5707 AS n_nationkey_prf_2#5712, n_name_prf#5708 AS n_name_prf_2#5713, n_comment_prf#5709 AS n_comment_prf_2#5714]
            :     :  :  +- Relation[rid#5705,n_regionkey_prf#5706,n_nationkey_prf#5707,n_name_prf#5708,n_comment_prf#5709] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#5715]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#5717 AS c_acctbal_prf_3#5726, rid#5718 AS rid_3#5727, c_name_prf#5719 AS c_name_prf_3#5728, c_nationkey_prf#5720 AS c_nationkey_prf_3#5729, c_custkey_prf#5721 AS c_custkey_prf_3#5730, c_comment_prf#5722 AS c_comment_prf_3#5731, c_address_prf#5723 AS c_address_prf_3#5732, c_mktsegment_prf#5724 AS c_mktsegment_prf_3#5733, c_phone_prf#5725 AS c_phone_prf_3#5734]
               +- Relation[c_acctbal_prf#5717,rid#5718,c_name_prf#5719,c_nationkey_prf#5720,c_custkey_prf#5721,c_comment_prf#5722,c_address_prf#5723,c_mktsegment_prf#5724,c_phone_prf#5725] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 164870ms

fr2d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderstatus = 'F' and o_orderkey = l_orderkey
19/10/17 00:51:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:51:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5814L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 00:51:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5814L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#5866]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [c_acctbal_prf#5816 AS c_acctbal_prf_0#5825, rid#5817 AS rid_0#5826, c_name_prf#5818 AS c_name_prf_0#5827, c_nationkey_prf#5819 AS c_nationkey_prf_0#5828, c_custkey_prf#5820 AS c_custkey_prf_0#5829, c_comment_prf#5821 AS c_comment_prf_0#5830, c_address_prf#5822 AS c_address_prf_0#5831, c_mktsegment_prf#5823 AS c_mktsegment_prf_0#5832, c_phone_prf#5824 AS c_phone_prf_0#5833]
         :     :  :  :  +- Relation[c_acctbal_prf#5816,rid#5817,c_name_prf#5818,c_nationkey_prf#5819,c_custkey_prf#5820,c_comment_prf#5821,c_address_prf#5822,c_mktsegment_prf#5823,c_phone_prf#5824] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#5844]
         :     :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#5843]
         :     :  :        :  +- Relation[c_acctbal_prf#5834,rid#5835,c_name_prf#5836,c_nationkey_prf#5837,c_custkey_prf#5838,c_comment_prf#5839,c_address_prf#5840,c_mktsegment_prf#5841,c_phone_prf#5842] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [o_shippriority_prf#5845 AS o_shippriority_prf_1#5855, rid#5846 AS rid_1#5856, o_orderdate_prf#5847 AS o_orderdate_prf_1#5857, o_custkey_prf#5848 AS o_custkey_prf_1#5858, o_orderpriority_prf#5849 AS o_orderpriority_prf_1#5859, o_clerk_prf#5850 AS o_clerk_prf_1#5860, o_orderstatus_prf#5851 AS o_orderstatus_prf_1#5861, o_totalprice_prf#5852 AS o_totalprice_prf_1#5862, o_orderkey_prf#5853 AS o_orderkey_prf_1#5863, o_comment_prf#5854 AS o_comment_prf_1#5864]
         :     :     :  +- Relation[o_shippriority_prf#5845,rid#5846,o_orderdate_prf#5847,o_custkey_prf#5848,o_orderpriority_prf#5849,o_clerk_prf#5850,o_orderstatus_prf#5851,o_totalprice_prf#5852,o_orderkey_prf#5853,o_comment_prf#5854] JDBCRelation(orders_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5865]
         :     :        +- DexRidFilter orders~o_orderstatus~F
         :     :           +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5867 AS l_returnflag_prf_2#5886, l_orderkey_and_l_linenumber_prf#5868 AS l_orderkey_and_l_linenumber_prf_2#5887, l_comment_prf#5869 AS l_comment_prf_2#5888, l_linestatus_prf#5870 AS l_linestatus_prf_2#5889, rid#5871 AS rid_2#5890, l_shipmode_prf#5872 AS l_shipmode_prf_2#5891, l_shipinstruct_prf#5873 AS l_shipinstruct_prf_2#5892, l_quantity_prf#5874 AS l_quantity_prf_2#5893, l_receiptdate_prf#5875 AS l_receiptdate_prf_2#5894, l_linenumber_prf#5876 AS l_linenumber_prf_2#5895, l_tax_prf#5877 AS l_tax_prf_2#5896, l_shipdate_prf#5878 AS l_shipdate_prf_2#5897, l_extendedprice_prf#5879 AS l_extendedprice_prf_2#5898, l_partkey_prf#5880 AS l_partkey_prf_2#5899, l_discount_prf#5881 AS l_discount_prf_2#5900, l_partkey_and_l_suppkey_prf#5882 AS l_partkey_and_l_suppkey_prf_2#5901, l_commitdate_prf#5883 AS l_commitdate_prf_2#5902, l_suppkey_prf#5884 AS l_suppkey_prf_2#5903, l_orderkey_prf#5885 AS l_orderkey_prf_2#5904]
            +- Relation[l_returnflag_prf#5867,l_orderkey_and_l_linenumber_prf#5868,l_comment_prf#5869,l_linestatus_prf#5870,rid#5871,l_shipmode_prf#5872,l_shipinstruct_prf#5873,l_quantity_prf#5874,l_receiptdate_prf#5875,l_linenumber_prf#5876,l_tax_prf#5877,l_shipdate_prf#5878,l_extendedprice_prf#5879,l_partkey_prf#5880,l_discount_prf#5881,l_partkey_and_l_suppkey_prf#5882,l_commitdate_prf#5883,l_suppkey_prf#5884,l_orderkey_prf#5885] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 107190ms

ft3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and p_size = 15 and l_suppkey = s_suppkey
19/10/17 00:53:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:53:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5978L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/17 00:53:34 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:53:34 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/17 00:53:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5978L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, rid_0#6003: string
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [l_returnflag_prf#5980 AS l_returnflag_prf_0#5999, l_orderkey_and_l_linenumber_prf#5981 AS l_orderkey_and_l_linenumber_prf_0#6000, l_comment_prf#5982 AS l_comment_prf_0#6001, l_linestatus_prf#5983 AS l_linestatus_prf_0#6002, rid#5984 AS rid_0#6003, l_shipmode_prf#5985 AS l_shipmode_prf_0#6004, l_shipinstruct_prf#5986 AS l_shipinstruct_prf_0#6005, l_quantity_prf#5987 AS l_quantity_prf_0#6006, l_receiptdate_prf#5988 AS l_receiptdate_prf_0#6007, l_linenumber_prf#5989 AS l_linenumber_prf_0#6008, l_tax_prf#5990 AS l_tax_prf_0#6009, l_shipdate_prf#5991 AS l_shipdate_prf_0#6010, l_extendedprice_prf#5992 AS l_extendedprice_prf_0#6011, l_partkey_prf#5993 AS l_partkey_prf_0#6012, l_discount_prf#5994 AS l_discount_prf_0#6013, l_partkey_and_l_suppkey_prf#5995 AS l_partkey_and_l_suppkey_prf_0#6014, l_commitdate_prf#5996 AS l_commitdate_prf_0#6015, l_suppkey_prf#5997 AS l_suppkey_prf_0#6016, l_orderkey_prf#5998 AS l_orderkey_prf_0#6017]
         :     :  :  :  +- Relation[l_returnflag_prf#5980,l_orderkey_and_l_linenumber_prf#5981,l_comment_prf#5982,l_linestatus_prf#5983,rid#5984,l_shipmode_prf#5985,l_shipinstruct_prf#5986,l_quantity_prf#5987,l_receiptdate_prf#5988,l_linenumber_prf#5989,l_tax_prf#5990,l_shipdate_prf#5991,l_extendedprice_prf#5992,l_partkey_prf#5993,l_discount_prf#5994,l_partkey_and_l_suppkey_prf#5995,l_commitdate_prf#5996,l_suppkey_prf#5997,l_orderkey_prf#5998] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#6038]
         :     :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#6037]
         :     :  :        :  +- Relation[l_returnflag_prf#6018,l_orderkey_and_l_linenumber_prf#6019,l_comment_prf#6020,l_linestatus_prf#6021,rid#6022,l_shipmode_prf#6023,l_shipinstruct_prf#6024,l_quantity_prf#6025,l_receiptdate_prf#6026,l_linenumber_prf#6027,l_tax_prf#6028,l_shipdate_prf#6029,l_extendedprice_prf#6030,l_partkey_prf#6031,l_discount_prf#6032,l_partkey_and_l_suppkey_prf#6033,l_commitdate_prf#6034,l_suppkey_prf#6035,l_orderkey_prf#6036] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [p_comment_prf#6039 AS p_comment_prf_1#6049, p_name_prf#6040 AS p_name_prf_1#6050, rid#6041 AS rid_1#6051, p_type_prf#6042 AS p_type_prf_1#6052, p_retailprice_prf#6043 AS p_retailprice_prf_1#6053, p_mfgr_prf#6044 AS p_mfgr_prf_1#6054, p_container_prf#6045 AS p_container_prf_1#6055, p_brand_prf#6046 AS p_brand_prf_1#6056, p_size_prf#6047 AS p_size_prf_1#6057, p_partkey_prf#6048 AS p_partkey_prf_1#6058]
         :     :     :  +- Relation[p_comment_prf#6039,p_name_prf#6040,rid#6041,p_type_prf#6042,p_retailprice_prf#6043,p_mfgr_prf#6044,p_container_prf#6045,p_brand_prf#6046,p_size_prf#6047,p_partkey_prf#6048] JDBCRelation(part_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6059]
         :     :        +- DexRidFilter part~p_size~15
         :     :           +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#6061 AS s_phone_prf_2#6069, rid#6062 AS rid_2#6070, s_address_prf#6063 AS s_address_prf_2#6071, s_nationkey_prf#6064 AS s_nationkey_prf_2#6072, s_suppkey_prf#6065 AS s_suppkey_prf_2#6073, s_name_prf#6066 AS s_name_prf_2#6074, s_acctbal_prf#6067 AS s_acctbal_prf_2#6075, s_comment_prf#6068 AS s_comment_prf_2#6076]
            +- Relation[s_phone_prf#6061,rid#6062,s_address_prf#6063,s_nationkey_prf#6064,s_suppkey_prf#6065,s_name_prf#6066,s_acctbal_prf#6067,s_comment_prf#6068] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 96454ms

fq1b=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/17 00:55:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:55:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6154L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 00:55:10 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:55:10 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:55:10 WARN DexPlanner: InMemoryFileIndex=nation
19/10/17 00:55:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6154L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#6186]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#6167]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#6161: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#6156 AS rid_0#6161, n_regionkey_prf#6157 AS n_regionkey_prf_0#6162, n_nationkey_prf#6158 AS n_nationkey_prf_0#6163, n_name_prf#6159 AS n_name_prf_0#6164, n_comment_prf#6160 AS n_comment_prf_0#6165]
         :     :  :     :  :  +- Relation[rid#6156,n_regionkey_prf#6157,n_nationkey_prf#6158,n_name_prf#6159,n_comment_prf#6160] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#6166]
         :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :        +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#6168 AS c_acctbal_prf_1#6177, rid#6169 AS rid_1#6178, c_name_prf#6170 AS c_name_prf_1#6179, c_nationkey_prf#6171 AS c_nationkey_prf_1#6180, c_custkey_prf#6172 AS c_custkey_prf_1#6181, c_comment_prf#6173 AS c_comment_prf_1#6182, c_address_prf#6174 AS c_address_prf_1#6183, c_mktsegment_prf#6175 AS c_mktsegment_prf_1#6184, c_phone_prf#6176 AS c_phone_prf_1#6185]
         :     :     +- Relation[c_acctbal_prf#6168,rid#6169,c_name_prf#6170,c_nationkey_prf#6171,c_custkey_prf#6172,c_comment_prf#6173,c_address_prf#6174,c_mktsegment_prf#6175,c_phone_prf#6176] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- Project [o_shippriority_prf#6187 AS o_shippriority_prf_2#6197, rid#6188 AS rid_2#6198, o_orderdate_prf#6189 AS o_orderdate_prf_2#6199, o_custkey_prf#6190 AS o_custkey_prf_2#6200, o_orderpriority_prf#6191 AS o_orderpriority_prf_2#6201, o_clerk_prf#6192 AS o_clerk_prf_2#6202, o_orderstatus_prf#6193 AS o_orderstatus_prf_2#6203, o_totalprice_prf#6194 AS o_totalprice_prf_2#6204, o_orderkey_prf#6195 AS o_orderkey_prf_2#6205, o_comment_prf#6196 AS o_comment_prf_2#6206]
            :  :  +- Relation[o_shippriority_prf#6187,rid#6188,o_orderdate_prf#6189,o_custkey_prf#6190,o_orderpriority_prf#6191,o_clerk_prf#6192,o_orderstatus_prf#6193,o_totalprice_prf#6194,o_orderkey_prf#6195,o_comment_prf#6196] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2136) AS rid_3#6218]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#6217]
            :        :  +- Relation[o_shippriority_prf#6207,rid#6208,o_orderdate_prf#6209,o_custkey_prf#6210,o_orderpriority_prf#6211,o_clerk_prf#6212,o_orderstatus_prf#6213,o_totalprice_prf#6214,o_orderkey_prf#6215,o_comment_prf#6216] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#6219 AS l_returnflag_prf_3#6238, l_orderkey_and_l_linenumber_prf#6220 AS l_orderkey_and_l_linenumber_prf_3#6239, l_comment_prf#6221 AS l_comment_prf_3#6240, l_linestatus_prf#6222 AS l_linestatus_prf_3#6241, rid#6223 AS rid_3#6242, l_shipmode_prf#6224 AS l_shipmode_prf_3#6243, l_shipinstruct_prf#6225 AS l_shipinstruct_prf_3#6244, l_quantity_prf#6226 AS l_quantity_prf_3#6245, l_receiptdate_prf#6227 AS l_receiptdate_prf_3#6246, l_linenumber_prf#6228 AS l_linenumber_prf_3#6247, l_tax_prf#6229 AS l_tax_prf_3#6248, l_shipdate_prf#6230 AS l_shipdate_prf_3#6249, l_extendedprice_prf#6231 AS l_extendedprice_prf_3#6250, l_partkey_prf#6232 AS l_partkey_prf_3#6251, l_discount_prf#6233 AS l_discount_prf_3#6252, l_partkey_and_l_suppkey_prf#6234 AS l_partkey_and_l_suppkey_prf_3#6253, l_commitdate_prf#6235 AS l_commitdate_prf_3#6254, l_suppkey_prf#6236 AS l_suppkey_prf_3#6255, l_orderkey_prf#6237 AS l_orderkey_prf_3#6256]
               +- Relation[l_returnflag_prf#6219,l_orderkey_and_l_linenumber_prf#6220,l_comment_prf#6221,l_linestatus_prf#6222,rid#6223,l_shipmode_prf#6224,l_shipinstruct_prf#6225,l_quantity_prf#6226,l_receiptdate_prf#6227,l_linenumber_prf#6228,l_tax_prf#6229,l_shipdate_prf#6230,l_extendedprice_prf#6231,l_partkey_prf#6232,l_discount_prf#6233,l_partkey_and_l_suppkey_prf#6234,l_commitdate_prf#6235,l_suppkey_prf#6236,l_orderkey_prf#6237] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 140279ms

fr1e=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and (o_orderkey = l_orderkey and c_custkey = o_custkey)
19/10/17 00:57:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 00:57:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6336L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 00:57:30 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:57:30 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:57:30 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 00:57:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6336L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#6357]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#6348: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [c_acctbal_prf#6338 AS c_acctbal_prf_0#6347, rid#6339 AS rid_0#6348, c_name_prf#6340 AS c_name_prf_0#6349, c_nationkey_prf#6341 AS c_nationkey_prf_0#6350, c_custkey_prf#6342 AS c_custkey_prf_0#6351, c_comment_prf#6343 AS c_comment_prf_0#6352, c_address_prf#6344 AS c_address_prf_0#6353, c_mktsegment_prf#6345 AS c_mktsegment_prf_0#6354, c_phone_prf#6346 AS c_phone_prf_0#6355]
         :     :  :  +- Relation[c_acctbal_prf#6338,rid#6339,c_name_prf#6340,c_nationkey_prf#6341,c_custkey_prf#6342,c_comment_prf#6343,c_address_prf#6344,c_mktsegment_prf#6345,c_phone_prf#6346] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#6356]
         :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :        +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [o_shippriority_prf#6358 AS o_shippriority_prf_1#6368, rid#6359 AS rid_1#6369, o_orderdate_prf#6360 AS o_orderdate_prf_1#6370, o_custkey_prf#6361 AS o_custkey_prf_1#6371, o_orderpriority_prf#6362 AS o_orderpriority_prf_1#6372, o_clerk_prf#6363 AS o_clerk_prf_1#6373, o_orderstatus_prf#6364 AS o_orderstatus_prf_1#6374, o_totalprice_prf#6365 AS o_totalprice_prf_1#6375, o_orderkey_prf#6366 AS o_orderkey_prf_1#6376, o_comment_prf#6367 AS o_comment_prf_1#6377]
            :  :  +- Relation[o_shippriority_prf#6358,rid#6359,o_orderdate_prf#6360,o_custkey_prf#6361,o_orderpriority_prf#6362,o_clerk_prf#6363,o_orderstatus_prf#6364,o_totalprice_prf#6365,o_orderkey_prf#6366,o_comment_prf#6367] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#6389]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#6388]
            :        :  +- Relation[o_shippriority_prf#6378,rid#6379,o_orderdate_prf#6380,o_custkey_prf#6381,o_orderpriority_prf#6382,o_clerk_prf#6383,o_orderstatus_prf#6384,o_totalprice_prf#6385,o_orderkey_prf#6386,o_comment_prf#6387] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#6390 AS l_returnflag_prf_2#6409, l_orderkey_and_l_linenumber_prf#6391 AS l_orderkey_and_l_linenumber_prf_2#6410, l_comment_prf#6392 AS l_comment_prf_2#6411, l_linestatus_prf#6393 AS l_linestatus_prf_2#6412, rid#6394 AS rid_2#6413, l_shipmode_prf#6395 AS l_shipmode_prf_2#6414, l_shipinstruct_prf#6396 AS l_shipinstruct_prf_2#6415, l_quantity_prf#6397 AS l_quantity_prf_2#6416, l_receiptdate_prf#6398 AS l_receiptdate_prf_2#6417, l_linenumber_prf#6399 AS l_linenumber_prf_2#6418, l_tax_prf#6400 AS l_tax_prf_2#6419, l_shipdate_prf#6401 AS l_shipdate_prf_2#6420, l_extendedprice_prf#6402 AS l_extendedprice_prf_2#6421, l_partkey_prf#6403 AS l_partkey_prf_2#6422, l_discount_prf#6404 AS l_discount_prf_2#6423, l_partkey_and_l_suppkey_prf#6405 AS l_partkey_and_l_suppkey_prf_2#6424, l_commitdate_prf#6406 AS l_commitdate_prf_2#6425, l_suppkey_prf#6407 AS l_suppkey_prf_2#6426, l_orderkey_prf#6408 AS l_orderkey_prf_2#6427]
               +- Relation[l_returnflag_prf#6390,l_orderkey_and_l_linenumber_prf#6391,l_comment_prf#6392,l_linestatus_prf#6393,rid#6394,l_shipmode_prf#6395,l_shipinstruct_prf#6396,l_quantity_prf#6397,l_receiptdate_prf#6398,l_linenumber_prf#6399,l_tax_prf#6400,l_shipdate_prf#6401,l_extendedprice_prf#6402,l_partkey_prf#6403,l_discount_prf#6404,l_partkey_and_l_suppkey_prf#6405,l_commitdate_prf#6406,l_suppkey_prf#6407,l_orderkey_prf#6408] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 152521ms

fr2e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/17 01:00:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:00:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6502L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/17 01:00:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6502L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#6504 AS c_acctbal_prf_0#6513, rid#6505 AS rid_0#6514, c_name_prf#6506 AS c_name_prf_0#6515, c_nationkey_prf#6507 AS c_nationkey_prf_0#6516, c_custkey_prf#6508 AS c_custkey_prf_0#6517, c_comment_prf#6509 AS c_comment_prf_0#6518, c_address_prf#6510 AS c_address_prf_0#6519, c_mktsegment_prf#6511 AS c_mktsegment_prf_0#6520, c_phone_prf#6512 AS c_phone_prf_0#6521]
         :  :  +- Relation[c_acctbal_prf#6504,rid#6505,c_name_prf#6506,c_nationkey_prf#6507,c_custkey_prf#6508,c_comment_prf#6509,c_address_prf#6510,c_mktsegment_prf#6511,c_phone_prf#6512] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2136) AS rid_1#6532]
         :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#6531]
         :        :  +- Relation[c_acctbal_prf#6522,rid#6523,c_name_prf#6524,c_nationkey_prf#6525,c_custkey_prf#6526,c_comment_prf#6527,c_address_prf#6528,c_mktsegment_prf#6529,c_phone_prf#6530] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#6554]
            :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#6544: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#6533 AS o_shippriority_prf_1#6543, rid#6534 AS rid_1#6544, o_orderdate_prf#6535 AS o_orderdate_prf_1#6545, o_custkey_prf#6536 AS o_custkey_prf_1#6546, o_orderpriority_prf#6537 AS o_orderpriority_prf_1#6547, o_clerk_prf#6538 AS o_clerk_prf_1#6548, o_orderstatus_prf#6539 AS o_orderstatus_prf_1#6549, o_totalprice_prf#6540 AS o_totalprice_prf_1#6550, o_orderkey_prf#6541 AS o_orderkey_prf_1#6551, o_comment_prf#6542 AS o_comment_prf_1#6552]
            :     :  :  +- Relation[o_shippriority_prf#6533,rid#6534,o_orderdate_prf#6535,o_custkey_prf#6536,o_orderpriority_prf#6537,o_clerk_prf#6538,o_orderstatus_prf#6539,o_totalprice_prf#6540,o_orderkey_prf#6541,o_comment_prf#6542] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6553]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#6555 AS l_returnflag_prf_2#6574, l_orderkey_and_l_linenumber_prf#6556 AS l_orderkey_and_l_linenumber_prf_2#6575, l_comment_prf#6557 AS l_comment_prf_2#6576, l_linestatus_prf#6558 AS l_linestatus_prf_2#6577, rid#6559 AS rid_2#6578, l_shipmode_prf#6560 AS l_shipmode_prf_2#6579, l_shipinstruct_prf#6561 AS l_shipinstruct_prf_2#6580, l_quantity_prf#6562 AS l_quantity_prf_2#6581, l_receiptdate_prf#6563 AS l_receiptdate_prf_2#6582, l_linenumber_prf#6564 AS l_linenumber_prf_2#6583, l_tax_prf#6565 AS l_tax_prf_2#6584, l_shipdate_prf#6566 AS l_shipdate_prf_2#6585, l_extendedprice_prf#6567 AS l_extendedprice_prf_2#6586, l_partkey_prf#6568 AS l_partkey_prf_2#6587, l_discount_prf#6569 AS l_discount_prf_2#6588, l_partkey_and_l_suppkey_prf#6570 AS l_partkey_and_l_suppkey_prf_2#6589, l_commitdate_prf#6571 AS l_commitdate_prf_2#6590, l_suppkey_prf#6572 AS l_suppkey_prf_2#6591, l_orderkey_prf#6573 AS l_orderkey_prf_2#6592]
               +- Relation[l_returnflag_prf#6555,l_orderkey_and_l_linenumber_prf#6556,l_comment_prf#6557,l_linestatus_prf#6558,rid#6559,l_shipmode_prf#6560,l_shipinstruct_prf#6561,l_quantity_prf#6562,l_receiptdate_prf#6563,l_linenumber_prf#6564,l_tax_prf#6565,l_shipdate_prf#6566,l_extendedprice_prf#6567,l_partkey_prf#6568,l_discount_prf#6569,l_partkey_and_l_suppkey_prf#6570,l_commitdate_prf#6571,l_suppkey_prf#6572,l_orderkey_prf#6573] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 95631ms

fr1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and (c_mktsegment = 'BUILDING' and l_orderkey = o_orderkey)
19/10/17 01:01:39 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/17 01:01:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6667L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/17 01:01:39 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:01:39 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:01:39 WARN DexPlanner: InMemoryFileIndex=customer
19/10/17 01:01:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6667L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#6669 AS l_returnflag_prf_0#6688, l_orderkey_and_l_linenumber_prf#6670 AS l_orderkey_and_l_linenumber_prf_0#6689, l_comment_prf#6671 AS l_comment_prf_0#6690, l_linestatus_prf#6672 AS l_linestatus_prf_0#6691, rid#6673 AS rid_0#6692, l_shipmode_prf#6674 AS l_shipmode_prf_0#6693, l_shipinstruct_prf#6675 AS l_shipinstruct_prf_0#6694, l_quantity_prf#6676 AS l_quantity_prf_0#6695, l_receiptdate_prf#6677 AS l_receiptdate_prf_0#6696, l_linenumber_prf#6678 AS l_linenumber_prf_0#6697, l_tax_prf#6679 AS l_tax_prf_0#6698, l_shipdate_prf#6680 AS l_shipdate_prf_0#6699, l_extendedprice_prf#6681 AS l_extendedprice_prf_0#6700, l_partkey_prf#6682 AS l_partkey_prf_0#6701, l_discount_prf#6683 AS l_discount_prf_0#6702, l_partkey_and_l_suppkey_prf#6684 AS l_partkey_and_l_suppkey_prf_0#6703, l_commitdate_prf#6685 AS l_commitdate_prf_0#6704, l_suppkey_prf#6686 AS l_suppkey_prf_0#6705, l_orderkey_prf#6687 AS l_orderkey_prf_0#6706]
         :  :  +- Relation[l_returnflag_prf#6669,l_orderkey_and_l_linenumber_prf#6670,l_comment_prf#6671,l_linestatus_prf#6672,rid#6673,l_shipmode_prf#6674,l_shipinstruct_prf#6675,l_quantity_prf#6676,l_receiptdate_prf#6677,l_linenumber_prf#6678,l_tax_prf#6679,l_shipdate_prf#6680,l_extendedprice_prf#6681,l_partkey_prf#6682,l_discount_prf#6683,l_partkey_and_l_suppkey_prf#6684,l_commitdate_prf#6685,l_suppkey_prf#6686,l_orderkey_prf#6687] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2136) AS rid_2#6727]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#6726]
         :        :  +- Relation[l_returnflag_prf#6707,l_orderkey_and_l_linenumber_prf#6708,l_comment_prf#6709,l_linestatus_prf#6710,rid#6711,l_shipmode_prf#6712,l_shipinstruct_prf#6713,l_quantity_prf#6714,l_receiptdate_prf#6715,l_linenumber_prf#6716,l_tax_prf#6717,l_shipdate_prf#6718,l_extendedprice_prf#6719,l_partkey_prf#6720,l_discount_prf#6721,l_partkey_and_l_suppkey_prf#6722,l_commitdate_prf#6723,l_suppkey_prf#6724,l_orderkey_prf#6725] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2136) AS rid_2#6747]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#6738: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [c_acctbal_prf#6728 AS c_acctbal_prf_1#6737, rid#6729 AS rid_1#6738, c_name_prf#6730 AS c_name_prf_1#6739, c_nationkey_prf#6731 AS c_nationkey_prf_1#6740, c_custkey_prf#6732 AS c_custkey_prf_1#6741, c_comment_prf#6733 AS c_comment_prf_1#6742, c_address_prf#6734 AS c_address_prf_1#6743, c_mktsegment_prf#6735 AS c_mktsegment_prf_1#6744, c_phone_prf#6736 AS c_phone_prf_1#6745]
            :     :  :  +- Relation[c_acctbal_prf#6728,rid#6729,c_name_prf#6730,c_nationkey_prf#6731,c_custkey_prf#6732,c_comment_prf#6733,c_address_prf#6734,c_mktsegment_prf#6735,c_phone_prf#6736] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6746]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#2215,value#2216] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2135,value#2136] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#6748 AS o_shippriority_prf_2#6758, rid#6749 AS rid_2#6759, o_orderdate_prf#6750 AS o_orderdate_prf_2#6760, o_custkey_prf#6751 AS o_custkey_prf_2#6761, o_orderpriority_prf#6752 AS o_orderpriority_prf_2#6762, o_clerk_prf#6753 AS o_clerk_prf_2#6763, o_orderstatus_prf#6754 AS o_orderstatus_prf_2#6764, o_totalprice_prf#6755 AS o_totalprice_prf_2#6765, o_orderkey_prf#6756 AS o_orderkey_prf_2#6766, o_comment_prf#6757 AS o_comment_prf_2#6767]
               +- Relation[o_shippriority_prf#6748,rid#6749,o_orderdate_prf#6750,o_custkey_prf#6751,o_orderpriority_prf#6752,o_clerk_prf#6753,o_orderstatus_prf#6754,o_totalprice_prf#6755,o_orderkey_prf#6756,o_comment_prf#6757] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 83024ms
query=fq1a, count=246415, duration=31059
query=fq1b, count=246415, duration=140279
query=fq1c, count=246415, duration=163187
query=fq1d, count=246415, duration=74487
query=fq1e, count=246415, duration=164870
query=fq1f, count=246415, duration=167791
query=fr1a, count=1214743, duration=121450
query=fr1b, count=1214743, duration=120786
query=fr1c, count=1214743, duration=83024
query=fr1d, count=1214743, duration=32806
query=fr1e, count=1214743, duration=152521
query=fr2a, count=2901744, duration=193232
query=fr2b, count=2901744, duration=108126
query=fr2d, count=2901744, duration=107190
query=fr2e, count=2901744, duration=95631
query=fr2f, count=2901744, duration=83047
query=fs1a, count=1214743, duration=108022
query=fs1b, count=1214743, duration=173204
query=fs1c, count=1214743, duration=173014
query=ft1a, count=2452200, duration=48047
query=ft1b, count=2452200, duration=30007
query=ft1c, count=2452200, duration=33151
query=ft1d, count=2452200, duration=24254
query=ft2a, count=15628, duration=49024
query=ft2b, count=15628, duration=921
query=ft2c, count=15628, duration=7053
query=ft3a, count=117754, duration=96454
query=ft3b, count=117754, duration=6174
query=ft3c, count=117754, duration=55714
