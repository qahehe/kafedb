19/10/15 00:20:06 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7183ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Tue Oct 15 00:20:09 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Tue Oct 15 00:20:10 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Tue Oct 15 00:20:10 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Tue Oct 15 00:20:10 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Tue Oct 15 00:20:10 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Tue Oct 15 00:20:13 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Tue Oct 15 00:20:15 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Tue Oct 15 00:20:15 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/15 00:20:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:20:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1504L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 00:20:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1504L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#1526]
         :  :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#1516: string
         :  :  :     :- Project [c_acctbal_prf#1506 AS c_acctbal_prf_0#1515, rid#1507 AS rid_0#1516, c_name_prf#1508 AS c_name_prf_0#1517, c_nationkey_prf#1509 AS c_nationkey_prf_0#1518, c_custkey_prf#1510 AS c_custkey_prf_0#1519, c_comment_prf#1511 AS c_comment_prf_0#1520, c_address_prf#1512 AS c_address_prf_0#1521, c_mktsegment_prf#1513 AS c_mktsegment_prf_0#1522, c_phone_prf#1514 AS c_phone_prf_0#1523]
         :  :  :     :  +- Relation[c_acctbal_prf#1506,rid#1507,c_name_prf#1508,c_nationkey_prf#1509,c_custkey_prf#1510,c_comment_prf#1511,c_address_prf#1512,c_mktsegment_prf#1513,c_phone_prf#1514] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#1527 AS o_shippriority_prf_1#1537, rid#1528 AS rid_1#1538, o_orderdate_prf#1529 AS o_orderdate_prf_1#1539, o_custkey_prf#1530 AS o_custkey_prf_1#1540, o_orderpriority_prf#1531 AS o_orderpriority_prf_1#1541, o_clerk_prf#1532 AS o_clerk_prf_1#1542, o_orderstatus_prf#1533 AS o_orderstatus_prf_1#1543, o_totalprice_prf#1534 AS o_totalprice_prf_1#1544, o_orderkey_prf#1535 AS o_orderkey_prf_1#1545, o_comment_prf#1536 AS o_comment_prf_1#1546]
         :  :     +- Relation[o_shippriority_prf#1527,rid#1528,o_orderdate_prf#1529,o_custkey_prf#1530,o_orderpriority_prf#1531,o_clerk_prf#1532,o_orderstatus_prf#1533,o_totalprice_prf#1534,o_orderkey_prf#1535,o_comment_prf#1536] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#1558]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#1557]
         :        :  +- Relation[o_shippriority_prf#1547,rid#1548,o_orderdate_prf#1549,o_custkey_prf#1550,o_orderpriority_prf#1551,o_clerk_prf#1552,o_orderstatus_prf#1553,o_totalprice_prf#1554,o_orderkey_prf#1555,o_comment_prf#1556] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1559 AS l_returnflag_prf_2#1578, l_orderkey_and_l_linenumber_prf#1560 AS l_orderkey_and_l_linenumber_prf_2#1579, l_comment_prf#1561 AS l_comment_prf_2#1580, l_linestatus_prf#1562 AS l_linestatus_prf_2#1581, rid#1563 AS rid_2#1582, l_shipmode_prf#1564 AS l_shipmode_prf_2#1583, l_shipinstruct_prf#1565 AS l_shipinstruct_prf_2#1584, l_quantity_prf#1566 AS l_quantity_prf_2#1585, l_receiptdate_prf#1567 AS l_receiptdate_prf_2#1586, l_linenumber_prf#1568 AS l_linenumber_prf_2#1587, l_tax_prf#1569 AS l_tax_prf_2#1588, l_shipdate_prf#1570 AS l_shipdate_prf_2#1589, l_extendedprice_prf#1571 AS l_extendedprice_prf_2#1590, l_partkey_prf#1572 AS l_partkey_prf_2#1591, l_discount_prf#1573 AS l_discount_prf_2#1592, l_partkey_and_l_suppkey_prf#1574 AS l_partkey_and_l_suppkey_prf_2#1593, l_commitdate_prf#1575 AS l_commitdate_prf_2#1594, l_suppkey_prf#1576 AS l_suppkey_prf_2#1595, l_orderkey_prf#1577 AS l_orderkey_prf_2#1596]
            +- Relation[l_returnflag_prf#1559,l_orderkey_and_l_linenumber_prf#1560,l_comment_prf#1561,l_linestatus_prf#1562,rid#1563,l_shipmode_prf#1564,l_shipinstruct_prf#1565,l_quantity_prf#1566,l_receiptdate_prf#1567,l_linenumber_prf#1568,l_tax_prf#1569,l_shipdate_prf#1570,l_extendedprice_prf#1571,l_partkey_prf#1572,l_discount_prf#1573,l_partkey_and_l_suppkey_prf#1574,l_commitdate_prf#1575,l_suppkey_prf#1576,l_orderkey_prf#1577] JDBCRelation(lineitem_prf) [numPartitions=1]

19/10/15 00:20:16 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=6001215
Elapsed time: 231676ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/15 00:24:08 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:24:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1661L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 00:24:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1661L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#1679]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#1672: string
         :     :- Project [s_phone_prf#1663 AS s_phone_prf_0#1671, rid#1664 AS rid_0#1672, s_address_prf#1665 AS s_address_prf_0#1673, s_nationkey_prf#1666 AS s_nationkey_prf_0#1674, s_suppkey_prf#1667 AS s_suppkey_prf_0#1675, s_name_prf#1668 AS s_name_prf_0#1676, s_acctbal_prf#1669 AS s_acctbal_prf_0#1677, s_comment_prf#1670 AS s_comment_prf_0#1678]
         :     :  +- Relation[s_phone_prf#1663,rid#1664,s_address_prf#1665,s_nationkey_prf#1666,s_suppkey_prf#1667,s_name_prf#1668,s_acctbal_prf#1669,s_comment_prf#1670] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1680 AS l_returnflag_prf_1#1699, l_orderkey_and_l_linenumber_prf#1681 AS l_orderkey_and_l_linenumber_prf_1#1700, l_comment_prf#1682 AS l_comment_prf_1#1701, l_linestatus_prf#1683 AS l_linestatus_prf_1#1702, rid#1684 AS rid_1#1703, l_shipmode_prf#1685 AS l_shipmode_prf_1#1704, l_shipinstruct_prf#1686 AS l_shipinstruct_prf_1#1705, l_quantity_prf#1687 AS l_quantity_prf_1#1706, l_receiptdate_prf#1688 AS l_receiptdate_prf_1#1707, l_linenumber_prf#1689 AS l_linenumber_prf_1#1708, l_tax_prf#1690 AS l_tax_prf_1#1709, l_shipdate_prf#1691 AS l_shipdate_prf_1#1710, l_extendedprice_prf#1692 AS l_extendedprice_prf_1#1711, l_partkey_prf#1693 AS l_partkey_prf_1#1712, l_discount_prf#1694 AS l_discount_prf_1#1713, l_partkey_and_l_suppkey_prf#1695 AS l_partkey_and_l_suppkey_prf_1#1714, l_commitdate_prf#1696 AS l_commitdate_prf_1#1715, l_suppkey_prf#1697 AS l_suppkey_prf_1#1716, l_orderkey_prf#1698 AS l_orderkey_prf_1#1717]
            +- Relation[l_returnflag_prf#1680,l_orderkey_and_l_linenumber_prf#1681,l_comment_prf#1682,l_linestatus_prf#1683,rid#1684,l_shipmode_prf#1685,l_shipinstruct_prf#1686,l_quantity_prf#1687,l_receiptdate_prf#1688,l_linenumber_prf#1689,l_tax_prf#1690,l_shipdate_prf#1691,l_extendedprice_prf#1692,l_partkey_prf#1693,l_discount_prf#1694,l_partkey_and_l_suppkey_prf#1695,l_commitdate_prf#1696,l_suppkey_prf#1697,l_orderkey_prf#1698] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 86240ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/15 00:25:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:25:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1769L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/15 00:25:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1769L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_2#1787]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#1780: string
         :     :- Project [s_phone_prf#1771 AS s_phone_prf_0#1779, rid#1772 AS rid_0#1780, s_address_prf#1773 AS s_address_prf_0#1781, s_nationkey_prf#1774 AS s_nationkey_prf_0#1782, s_suppkey_prf#1775 AS s_suppkey_prf_0#1783, s_name_prf#1776 AS s_name_prf_0#1784, s_acctbal_prf#1777 AS s_acctbal_prf_0#1785, s_comment_prf#1778 AS s_comment_prf_0#1786]
         :     :  +- Relation[s_phone_prf#1771,rid#1772,s_address_prf#1773,s_nationkey_prf#1774,s_suppkey_prf#1775,s_name_prf#1776,s_acctbal_prf#1777,s_comment_prf#1778] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#1808]
            :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#1800: string
            :     :- Project [p_comment_prf#1788 AS p_comment_prf_1#1798, p_name_prf#1789 AS p_name_prf_1#1799, rid#1790 AS rid_1#1800, p_type_prf#1791 AS p_type_prf_1#1801, p_retailprice_prf#1792 AS p_retailprice_prf_1#1802, p_mfgr_prf#1793 AS p_mfgr_prf_1#1803, p_container_prf#1794 AS p_container_prf_1#1804, p_brand_prf#1795 AS p_brand_prf_1#1805, p_size_prf#1796 AS p_size_prf_1#1806, p_partkey_prf#1797 AS p_partkey_prf_1#1807]
            :     :  +- Relation[p_comment_prf#1788,p_name_prf#1789,rid#1790,p_type_prf#1791,p_retailprice_prf#1792,p_mfgr_prf#1793,p_container_prf#1794,p_brand_prf#1795,p_size_prf#1796,p_partkey_prf#1797] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#1809 AS ps_partkey_and_ps_suppkey_prf_2#1816, rid#1810 AS rid_2#1817, ps_availqty_prf#1811 AS ps_availqty_prf_2#1818, ps_comment_prf#1812 AS ps_comment_prf_2#1819, ps_partkey_prf#1813 AS ps_partkey_prf_2#1820, ps_supplycost_prf#1814 AS ps_supplycost_prf_2#1821, ps_suppkey_prf#1815 AS ps_suppkey_prf_2#1822]
               +- Relation[ps_partkey_and_ps_suppkey_prf#1809,rid#1810,ps_availqty_prf#1811,ps_comment_prf#1812,ps_partkey_prf#1813,ps_supplycost_prf#1814,ps_suppkey_prf#1815] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 42785ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/15 00:26:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:26:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1883L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 00:26:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1883L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#1901]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#1894: string
         :     :- Project [s_phone_prf#1885 AS s_phone_prf_0#1893, rid#1886 AS rid_0#1894, s_address_prf#1887 AS s_address_prf_0#1895, s_nationkey_prf#1888 AS s_nationkey_prf_0#1896, s_suppkey_prf#1889 AS s_suppkey_prf_0#1897, s_name_prf#1890 AS s_name_prf_0#1898, s_acctbal_prf#1891 AS s_acctbal_prf_0#1899, s_comment_prf#1892 AS s_comment_prf_0#1900]
         :     :  +- Relation[s_phone_prf#1885,rid#1886,s_address_prf#1887,s_nationkey_prf#1888,s_suppkey_prf#1889,s_name_prf#1890,s_acctbal_prf#1891,s_comment_prf#1892] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#1940]
            :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_1#1925: string
            :     :- Project [l_returnflag_prf#1902 AS l_returnflag_prf_1#1921, l_orderkey_and_l_linenumber_prf#1903 AS l_orderkey_and_l_linenumber_prf_1#1922, l_comment_prf#1904 AS l_comment_prf_1#1923, l_linestatus_prf#1905 AS l_linestatus_prf_1#1924, rid#1906 AS rid_1#1925, l_shipmode_prf#1907 AS l_shipmode_prf_1#1926, l_shipinstruct_prf#1908 AS l_shipinstruct_prf_1#1927, l_quantity_prf#1909 AS l_quantity_prf_1#1928, l_receiptdate_prf#1910 AS l_receiptdate_prf_1#1929, l_linenumber_prf#1911 AS l_linenumber_prf_1#1930, l_tax_prf#1912 AS l_tax_prf_1#1931, l_shipdate_prf#1913 AS l_shipdate_prf_1#1932, l_extendedprice_prf#1914 AS l_extendedprice_prf_1#1933, l_partkey_prf#1915 AS l_partkey_prf_1#1934, l_discount_prf#1916 AS l_discount_prf_1#1935, l_partkey_and_l_suppkey_prf#1917 AS l_partkey_and_l_suppkey_prf_1#1936, l_commitdate_prf#1918 AS l_commitdate_prf_1#1937, l_suppkey_prf#1919 AS l_suppkey_prf_1#1938, l_orderkey_prf#1920 AS l_orderkey_prf_1#1939]
            :     :  +- Relation[l_returnflag_prf#1902,l_orderkey_and_l_linenumber_prf#1903,l_comment_prf#1904,l_linestatus_prf#1905,rid#1906,l_shipmode_prf#1907,l_shipinstruct_prf#1908,l_quantity_prf#1909,l_receiptdate_prf#1910,l_linenumber_prf#1911,l_tax_prf#1912,l_shipdate_prf#1913,l_extendedprice_prf#1914,l_partkey_prf#1915,l_discount_prf#1916,l_partkey_and_l_suppkey_prf#1917,l_commitdate_prf#1918,l_suppkey_prf#1919,l_orderkey_prf#1920] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#1941 AS p_comment_prf_2#1951, p_name_prf#1942 AS p_name_prf_2#1952, rid#1943 AS rid_2#1953, p_type_prf#1944 AS p_type_prf_2#1954, p_retailprice_prf#1945 AS p_retailprice_prf_2#1955, p_mfgr_prf#1946 AS p_mfgr_prf_2#1956, p_container_prf#1947 AS p_container_prf_2#1957, p_brand_prf#1948 AS p_brand_prf_2#1958, p_size_prf#1949 AS p_size_prf_2#1959, p_partkey_prf#1950 AS p_partkey_prf_2#1960]
               +- Relation[p_comment_prf#1941,p_name_prf#1942,rid#1943,p_type_prf#1944,p_retailprice_prf#1945,p_mfgr_prf#1946,p_container_prf#1947,p_brand_prf#1948,p_size_prf#1949,p_partkey_prf#1950] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 187129ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/15 00:29:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:29:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2018L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 00:29:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2018L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#2038]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2030: string
         :     :- Project [c_acctbal_prf#2020 AS c_acctbal_prf_0#2029, rid#2021 AS rid_0#2030, c_name_prf#2022 AS c_name_prf_0#2031, c_nationkey_prf#2023 AS c_nationkey_prf_0#2032, c_custkey_prf#2024 AS c_custkey_prf_0#2033, c_comment_prf#2025 AS c_comment_prf_0#2034, c_address_prf#2026 AS c_address_prf_0#2035, c_mktsegment_prf#2027 AS c_mktsegment_prf_0#2036, c_phone_prf#2028 AS c_phone_prf_0#2037]
         :     :  +- Relation[c_acctbal_prf#2020,rid#2021,c_name_prf#2022,c_nationkey_prf#2023,c_custkey_prf#2024,c_comment_prf#2025,c_address_prf#2026,c_mktsegment_prf#2027,c_phone_prf#2028] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2039 AS o_shippriority_prf_1#2049, rid#2040 AS rid_1#2050, o_orderdate_prf#2041 AS o_orderdate_prf_1#2051, o_custkey_prf#2042 AS o_custkey_prf_1#2052, o_orderpriority_prf#2043 AS o_orderpriority_prf_1#2053, o_clerk_prf#2044 AS o_clerk_prf_1#2054, o_orderstatus_prf#2045 AS o_orderstatus_prf_1#2055, o_totalprice_prf#2046 AS o_totalprice_prf_1#2056, o_orderkey_prf#2047 AS o_orderkey_prf_1#2057, o_comment_prf#2048 AS o_comment_prf_1#2058]
            +- Relation[o_shippriority_prf#2039,rid#2040,o_orderdate_prf#2041,o_custkey_prf#2042,o_orderpriority_prf#2043,o_clerk_prf#2044,o_orderstatus_prf#2045,o_totalprice_prf#2046,o_orderkey_prf#2047,o_comment_prf#2048] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1500000
Elapsed time: 40077ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/15 00:30:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:30:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2092L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 00:30:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2092L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#2104]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#2099: string
         :     :- Project [rid#2094 AS rid_0#2099, n_regionkey_prf#2095 AS n_regionkey_prf_0#2100, n_nationkey_prf#2096 AS n_nationkey_prf_0#2101, n_name_prf#2097 AS n_name_prf_0#2102, n_comment_prf#2098 AS n_comment_prf_0#2103]
         :     :  +- Relation[rid#2094,n_regionkey_prf#2095,n_nationkey_prf#2096,n_name_prf#2097,n_comment_prf#2098] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2105 AS s_phone_prf_1#2113, rid#2106 AS rid_1#2114, s_address_prf#2107 AS s_address_prf_1#2115, s_nationkey_prf#2108 AS s_nationkey_prf_1#2116, s_suppkey_prf#2109 AS s_suppkey_prf_1#2117, s_name_prf#2110 AS s_name_prf_1#2118, s_acctbal_prf#2111 AS s_acctbal_prf_1#2119, s_comment_prf#2112 AS s_comment_prf_1#2120]
            +- Relation[s_phone_prf#2105,rid#2106,s_address_prf#2107,s_nationkey_prf#2108,s_suppkey_prf#2109,s_name_prf#2110,s_acctbal_prf#2111,s_comment_prf#2112] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=10000
Elapsed time: 192ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/15 00:30:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:30:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2144L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/15 00:30:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2144L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#2154]
         :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#2153: string
         :     :- Project [r_regionkey_prf#2146 AS r_regionkey_prf_0#2150, r_name_prf#2147 AS r_name_prf_0#2151, r_comment_prf#2148 AS r_comment_prf_0#2152, rid#2149 AS rid_0#2153]
         :     :  +- Relation[r_regionkey_prf#2146,r_name_prf#2147,r_comment_prf#2148,rid#2149] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#2155 AS rid_1#2160, n_regionkey_prf#2156 AS n_regionkey_prf_1#2161, n_nationkey_prf#2157 AS n_nationkey_prf_1#2162, n_name_prf#2158 AS n_name_prf_1#2163, n_comment_prf#2159 AS n_comment_prf_1#2164]
            +- Relation[rid#2155,n_regionkey_prf#2156,n_nationkey_prf#2157,n_name_prf#2158,n_comment_prf#2159] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=25
Elapsed time: 67ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/15 00:30:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:30:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2210L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 00:30:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2210L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_2#2230]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2222: string
         :     :- Project [c_acctbal_prf#2212 AS c_acctbal_prf_0#2221, rid#2213 AS rid_0#2222, c_name_prf#2214 AS c_name_prf_0#2223, c_nationkey_prf#2215 AS c_nationkey_prf_0#2224, c_custkey_prf#2216 AS c_custkey_prf_0#2225, c_comment_prf#2217 AS c_comment_prf_0#2226, c_address_prf#2218 AS c_address_prf_0#2227, c_mktsegment_prf#2219 AS c_mktsegment_prf_0#2228, c_phone_prf#2220 AS c_phone_prf_0#2229]
         :     :  +- Relation[c_acctbal_prf#2212,rid#2213,c_name_prf#2214,c_nationkey_prf#2215,c_custkey_prf#2216,c_comment_prf#2217,c_address_prf#2218,c_mktsegment_prf#2219,c_phone_prf#2220] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#2269]
            :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_1#2254: string
            :     :- Project [l_returnflag_prf#2231 AS l_returnflag_prf_1#2250, l_orderkey_and_l_linenumber_prf#2232 AS l_orderkey_and_l_linenumber_prf_1#2251, l_comment_prf#2233 AS l_comment_prf_1#2252, l_linestatus_prf#2234 AS l_linestatus_prf_1#2253, rid#2235 AS rid_1#2254, l_shipmode_prf#2236 AS l_shipmode_prf_1#2255, l_shipinstruct_prf#2237 AS l_shipinstruct_prf_1#2256, l_quantity_prf#2238 AS l_quantity_prf_1#2257, l_receiptdate_prf#2239 AS l_receiptdate_prf_1#2258, l_linenumber_prf#2240 AS l_linenumber_prf_1#2259, l_tax_prf#2241 AS l_tax_prf_1#2260, l_shipdate_prf#2242 AS l_shipdate_prf_1#2261, l_extendedprice_prf#2243 AS l_extendedprice_prf_1#2262, l_partkey_prf#2244 AS l_partkey_prf_1#2263, l_discount_prf#2245 AS l_discount_prf_1#2264, l_partkey_and_l_suppkey_prf#2246 AS l_partkey_and_l_suppkey_prf_1#2265, l_commitdate_prf#2247 AS l_commitdate_prf_1#2266, l_suppkey_prf#2248 AS l_suppkey_prf_1#2267, l_orderkey_prf#2249 AS l_orderkey_prf_1#2268]
            :     :  +- Relation[l_returnflag_prf#2231,l_orderkey_and_l_linenumber_prf#2232,l_comment_prf#2233,l_linestatus_prf#2234,rid#2235,l_shipmode_prf#2236,l_shipinstruct_prf#2237,l_quantity_prf#2238,l_receiptdate_prf#2239,l_linenumber_prf#2240,l_tax_prf#2241,l_shipdate_prf#2242,l_extendedprice_prf#2243,l_partkey_prf#2244,l_discount_prf#2245,l_partkey_and_l_suppkey_prf#2246,l_commitdate_prf#2247,l_suppkey_prf#2248,l_orderkey_prf#2249] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2270 AS o_shippriority_prf_2#2280, rid#2271 AS rid_2#2281, o_orderdate_prf#2272 AS o_orderdate_prf_2#2282, o_custkey_prf#2273 AS o_custkey_prf_2#2283, o_orderpriority_prf#2274 AS o_orderpriority_prf_2#2284, o_clerk_prf#2275 AS o_clerk_prf_2#2285, o_orderstatus_prf#2276 AS o_orderstatus_prf_2#2286, o_totalprice_prf#2277 AS o_totalprice_prf_2#2287, o_orderkey_prf#2278 AS o_orderkey_prf_2#2288, o_comment_prf#2279 AS o_comment_prf_2#2289]
               +- Relation[o_shippriority_prf#2270,rid#2271,o_orderdate_prf#2272,o_custkey_prf#2273,o_orderpriority_prf#2274,o_clerk_prf#2275,o_orderstatus_prf#2276,o_totalprice_prf#2277,o_orderkey_prf#2278,o_comment_prf#2279] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 157490ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/15 00:32:42 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:32:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2363L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 00:32:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2363L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#2385]
         :  :  :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2377: string
         :  :  :     :- Project [p_comment_prf#2365 AS p_comment_prf_0#2375, p_name_prf#2366 AS p_name_prf_0#2376, rid#2367 AS rid_0#2377, p_type_prf#2368 AS p_type_prf_0#2378, p_retailprice_prf#2369 AS p_retailprice_prf_0#2379, p_mfgr_prf#2370 AS p_mfgr_prf_0#2380, p_container_prf#2371 AS p_container_prf_0#2381, p_brand_prf#2372 AS p_brand_prf_0#2382, p_size_prf#2373 AS p_size_prf_0#2383, p_partkey_prf#2374 AS p_partkey_prf_0#2384]
         :  :  :     :  +- Relation[p_comment_prf#2365,p_name_prf#2366,rid#2367,p_type_prf#2368,p_retailprice_prf#2369,p_mfgr_prf#2370,p_container_prf#2371,p_brand_prf#2372,p_size_prf#2373,p_partkey_prf#2374] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#2386 AS l_returnflag_prf_1#2405, l_orderkey_and_l_linenumber_prf#2387 AS l_orderkey_and_l_linenumber_prf_1#2406, l_comment_prf#2388 AS l_comment_prf_1#2407, l_linestatus_prf#2389 AS l_linestatus_prf_1#2408, rid#2390 AS rid_1#2409, l_shipmode_prf#2391 AS l_shipmode_prf_1#2410, l_shipinstruct_prf#2392 AS l_shipinstruct_prf_1#2411, l_quantity_prf#2393 AS l_quantity_prf_1#2412, l_receiptdate_prf#2394 AS l_receiptdate_prf_1#2413, l_linenumber_prf#2395 AS l_linenumber_prf_1#2414, l_tax_prf#2396 AS l_tax_prf_1#2415, l_shipdate_prf#2397 AS l_shipdate_prf_1#2416, l_extendedprice_prf#2398 AS l_extendedprice_prf_1#2417, l_partkey_prf#2399 AS l_partkey_prf_1#2418, l_discount_prf#2400 AS l_discount_prf_1#2419, l_partkey_and_l_suppkey_prf#2401 AS l_partkey_and_l_suppkey_prf_1#2420, l_commitdate_prf#2402 AS l_commitdate_prf_1#2421, l_suppkey_prf#2403 AS l_suppkey_prf_1#2422, l_orderkey_prf#2404 AS l_orderkey_prf_1#2423]
         :  :     +- Relation[l_returnflag_prf#2386,l_orderkey_and_l_linenumber_prf#2387,l_comment_prf#2388,l_linestatus_prf#2389,rid#2390,l_shipmode_prf#2391,l_shipinstruct_prf#2392,l_quantity_prf#2393,l_receiptdate_prf#2394,l_linenumber_prf#2395,l_tax_prf#2396,l_shipdate_prf#2397,l_extendedprice_prf#2398,l_partkey_prf#2399,l_discount_prf#2400,l_partkey_and_l_suppkey_prf#2401,l_commitdate_prf#2402,l_suppkey_prf#2403,l_orderkey_prf#2404] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#2444]
         :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2443]
         :        :  +- Relation[l_returnflag_prf#2424,l_orderkey_and_l_linenumber_prf#2425,l_comment_prf#2426,l_linestatus_prf#2427,rid#2428,l_shipmode_prf#2429,l_shipinstruct_prf#2430,l_quantity_prf#2431,l_receiptdate_prf#2432,l_linenumber_prf#2433,l_tax_prf#2434,l_shipdate_prf#2435,l_extendedprice_prf#2436,l_partkey_prf#2437,l_discount_prf#2438,l_partkey_and_l_suppkey_prf#2439,l_commitdate_prf#2440,l_suppkey_prf#2441,l_orderkey_prf#2442] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2445 AS s_phone_prf_2#2453, rid#2446 AS rid_2#2454, s_address_prf#2447 AS s_address_prf_2#2455, s_nationkey_prf#2448 AS s_nationkey_prf_2#2456, s_suppkey_prf#2449 AS s_suppkey_prf_2#2457, s_name_prf#2450 AS s_name_prf_2#2458, s_acctbal_prf#2451 AS s_acctbal_prf_2#2459, s_comment_prf#2452 AS s_comment_prf_2#2460]
            +- Relation[s_phone_prf#2445,rid#2446,s_address_prf#2447,s_nationkey_prf#2448,s_suppkey_prf#2449,s_name_prf#2450,s_acctbal_prf#2451,s_comment_prf#2452] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 195564ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/15 00:35:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:35:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2520L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/15 00:35:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2520L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_2#2540]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#2532: string
         :     :- Project [c_acctbal_prf#2522 AS c_acctbal_prf_0#2531, rid#2523 AS rid_0#2532, c_name_prf#2524 AS c_name_prf_0#2533, c_nationkey_prf#2525 AS c_nationkey_prf_0#2534, c_custkey_prf#2526 AS c_custkey_prf_0#2535, c_comment_prf#2527 AS c_comment_prf_0#2536, c_address_prf#2528 AS c_address_prf_0#2537, c_mktsegment_prf#2529 AS c_mktsegment_prf_0#2538, c_phone_prf#2530 AS c_phone_prf_0#2539]
         :     :  +- Relation[c_acctbal_prf#2522,rid#2523,c_name_prf#2524,c_nationkey_prf#2525,c_custkey_prf#2526,c_comment_prf#2527,c_address_prf#2528,c_mktsegment_prf#2529,c_phone_prf#2530] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#2557]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#2550: string
            :     :- Project [s_phone_prf#2541 AS s_phone_prf_1#2549, rid#2542 AS rid_1#2550, s_address_prf#2543 AS s_address_prf_1#2551, s_nationkey_prf#2544 AS s_nationkey_prf_1#2552, s_suppkey_prf#2545 AS s_suppkey_prf_1#2553, s_name_prf#2546 AS s_name_prf_1#2554, s_acctbal_prf#2547 AS s_acctbal_prf_1#2555, s_comment_prf#2548 AS s_comment_prf_1#2556]
            :     :  +- Relation[s_phone_prf#2541,rid#2542,s_address_prf#2543,s_nationkey_prf#2544,s_suppkey_prf#2545,s_name_prf#2546,s_acctbal_prf#2547,s_comment_prf#2548] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [rid#2558 AS rid_2#2563, n_regionkey_prf#2559 AS n_regionkey_prf_2#2564, n_nationkey_prf#2560 AS n_nationkey_prf_2#2565, n_name_prf#2561 AS n_name_prf_2#2566, n_comment_prf#2562 AS n_comment_prf_2#2567]
               +- Relation[rid#2558,n_regionkey_prf#2559,n_nationkey_prf#2560,n_name_prf#2561,n_comment_prf#2562] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 66362ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/15 00:37:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:37:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2605L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/15 00:37:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2605L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#2617]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#2612: string
         :     :- Project [rid#2607 AS rid_0#2612, n_regionkey_prf#2608 AS n_regionkey_prf_0#2613, n_nationkey_prf#2609 AS n_nationkey_prf_0#2614, n_name_prf#2610 AS n_name_prf_0#2615, n_comment_prf#2611 AS n_comment_prf_0#2616]
         :     :  +- Relation[rid#2607,n_regionkey_prf#2608,n_nationkey_prf#2609,n_name_prf#2610,n_comment_prf#2611] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2618 AS c_acctbal_prf_1#2627, rid#2619 AS rid_1#2628, c_name_prf#2620 AS c_name_prf_1#2629, c_nationkey_prf#2621 AS c_nationkey_prf_1#2630, c_custkey_prf#2622 AS c_custkey_prf_1#2631, c_comment_prf#2623 AS c_comment_prf_1#2632, c_address_prf#2624 AS c_address_prf_1#2633, c_mktsegment_prf#2625 AS c_mktsegment_prf_1#2634, c_phone_prf#2626 AS c_phone_prf_1#2635]
            +- Relation[c_acctbal_prf#2618,rid#2619,c_name_prf#2620,c_nationkey_prf#2621,c_custkey_prf#2622,c_comment_prf#2623,c_address_prf#2624,c_mktsegment_prf#2625,c_phone_prf#2626] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=150000
Elapsed time: 1929ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/15 00:37:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:37:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2685L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 00:37:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2685L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_2#2703]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#2696: string
         :     :- Project [s_phone_prf#2687 AS s_phone_prf_0#2695, rid#2688 AS rid_0#2696, s_address_prf#2689 AS s_address_prf_0#2697, s_nationkey_prf#2690 AS s_nationkey_prf_0#2698, s_suppkey_prf#2691 AS s_suppkey_prf_0#2699, s_name_prf#2692 AS s_name_prf_0#2700, s_acctbal_prf#2693 AS s_acctbal_prf_0#2701, s_comment_prf#2694 AS s_comment_prf_0#2702]
         :     :  +- Relation[s_phone_prf#2687,rid#2688,s_address_prf#2689,s_nationkey_prf#2690,s_suppkey_prf#2691,s_name_prf#2692,s_acctbal_prf#2693,s_comment_prf#2694] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#2724]
            :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#2716: string
            :     :- Project [p_comment_prf#2704 AS p_comment_prf_1#2714, p_name_prf#2705 AS p_name_prf_1#2715, rid#2706 AS rid_1#2716, p_type_prf#2707 AS p_type_prf_1#2717, p_retailprice_prf#2708 AS p_retailprice_prf_1#2718, p_mfgr_prf#2709 AS p_mfgr_prf_1#2719, p_container_prf#2710 AS p_container_prf_1#2720, p_brand_prf#2711 AS p_brand_prf_1#2721, p_size_prf#2712 AS p_size_prf_1#2722, p_partkey_prf#2713 AS p_partkey_prf_1#2723]
            :     :  +- Relation[p_comment_prf#2704,p_name_prf#2705,rid#2706,p_type_prf#2707,p_retailprice_prf#2708,p_mfgr_prf#2709,p_container_prf#2710,p_brand_prf#2711,p_size_prf#2712,p_partkey_prf#2713] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2725 AS l_returnflag_prf_2#2744, l_orderkey_and_l_linenumber_prf#2726 AS l_orderkey_and_l_linenumber_prf_2#2745, l_comment_prf#2727 AS l_comment_prf_2#2746, l_linestatus_prf#2728 AS l_linestatus_prf_2#2747, rid#2729 AS rid_2#2748, l_shipmode_prf#2730 AS l_shipmode_prf_2#2749, l_shipinstruct_prf#2731 AS l_shipinstruct_prf_2#2750, l_quantity_prf#2732 AS l_quantity_prf_2#2751, l_receiptdate_prf#2733 AS l_receiptdate_prf_2#2752, l_linenumber_prf#2734 AS l_linenumber_prf_2#2753, l_tax_prf#2735 AS l_tax_prf_2#2754, l_shipdate_prf#2736 AS l_shipdate_prf_2#2755, l_extendedprice_prf#2737 AS l_extendedprice_prf_2#2756, l_partkey_prf#2738 AS l_partkey_prf_2#2757, l_discount_prf#2739 AS l_discount_prf_2#2758, l_partkey_and_l_suppkey_prf#2740 AS l_partkey_and_l_suppkey_prf_2#2759, l_commitdate_prf#2741 AS l_commitdate_prf_2#2760, l_suppkey_prf#2742 AS l_suppkey_prf_2#2761, l_orderkey_prf#2743 AS l_orderkey_prf_2#2762]
               +- Relation[l_returnflag_prf#2725,l_orderkey_and_l_linenumber_prf#2726,l_comment_prf#2727,l_linestatus_prf#2728,rid#2729,l_shipmode_prf#2730,l_shipinstruct_prf#2731,l_quantity_prf#2732,l_receiptdate_prf#2733,l_linenumber_prf#2734,l_tax_prf#2735,l_shipdate_prf#2736,l_extendedprice_prf#2737,l_partkey_prf#2738,l_discount_prf#2739,l_partkey_and_l_suppkey_prf#2740,l_commitdate_prf#2741,l_suppkey_prf#2742,l_orderkey_prf#2743] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 187761ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/15 00:40:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:40:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2828L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 00:40:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2828L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#2871]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2853: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#2830 AS l_returnflag_prf_0#2849, l_orderkey_and_l_linenumber_prf#2831 AS l_orderkey_and_l_linenumber_prf_0#2850, l_comment_prf#2832 AS l_comment_prf_0#2851, l_linestatus_prf#2833 AS l_linestatus_prf_0#2852, rid#2834 AS rid_0#2853, l_shipmode_prf#2835 AS l_shipmode_prf_0#2854, l_shipinstruct_prf#2836 AS l_shipinstruct_prf_0#2855, l_quantity_prf#2837 AS l_quantity_prf_0#2856, l_receiptdate_prf#2838 AS l_receiptdate_prf_0#2857, l_linenumber_prf#2839 AS l_linenumber_prf_0#2858, l_tax_prf#2840 AS l_tax_prf_0#2859, l_shipdate_prf#2841 AS l_shipdate_prf_0#2860, l_extendedprice_prf#2842 AS l_extendedprice_prf_0#2861, l_partkey_prf#2843 AS l_partkey_prf_0#2862, l_discount_prf#2844 AS l_discount_prf_0#2863, l_partkey_and_l_suppkey_prf#2845 AS l_partkey_and_l_suppkey_prf_0#2864, l_commitdate_prf#2846 AS l_commitdate_prf_0#2865, l_suppkey_prf#2847 AS l_suppkey_prf_0#2866, l_orderkey_prf#2848 AS l_orderkey_prf_0#2867]
         :     :  :  +- Relation[l_returnflag_prf#2830,l_orderkey_and_l_linenumber_prf#2831,l_comment_prf#2832,l_linestatus_prf#2833,rid#2834,l_shipmode_prf#2835,l_shipinstruct_prf#2836,l_quantity_prf#2837,l_receiptdate_prf#2838,l_linenumber_prf#2839,l_tax_prf#2840,l_shipdate_prf#2841,l_extendedprice_prf#2842,l_partkey_prf#2843,l_discount_prf#2844,l_partkey_and_l_suppkey_prf#2845,l_commitdate_prf#2846,l_suppkey_prf#2847,l_orderkey_prf#2848] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2870]
         :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :        +- Relation[label#2868,value#2869] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2872 AS o_shippriority_prf_1#2882, rid#2873 AS rid_1#2883, o_orderdate_prf#2874 AS o_orderdate_prf_1#2884, o_custkey_prf#2875 AS o_custkey_prf_1#2885, o_orderpriority_prf#2876 AS o_orderpriority_prf_1#2886, o_clerk_prf#2877 AS o_clerk_prf_1#2887, o_orderstatus_prf#2878 AS o_orderstatus_prf_1#2888, o_totalprice_prf#2879 AS o_totalprice_prf_1#2889, o_orderkey_prf#2880 AS o_orderkey_prf_1#2890, o_comment_prf#2881 AS o_comment_prf_1#2891]
            +- Relation[o_shippriority_prf#2872,rid#2873,o_orderdate_prf#2874,o_custkey_prf#2875,o_orderpriority_prf#2876,o_clerk_prf#2877,o_orderstatus_prf#2878,o_totalprice_prf#2879,o_orderkey_prf#2880,o_comment_prf#2881] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 54751ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/15 00:41:08 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:41:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2957L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/15 00:41:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2957L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#2997]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2982: string
         :     :- Project [l_returnflag_prf#2959 AS l_returnflag_prf_0#2978, l_orderkey_and_l_linenumber_prf#2960 AS l_orderkey_and_l_linenumber_prf_0#2979, l_comment_prf#2961 AS l_comment_prf_0#2980, l_linestatus_prf#2962 AS l_linestatus_prf_0#2981, rid#2963 AS rid_0#2982, l_shipmode_prf#2964 AS l_shipmode_prf_0#2983, l_shipinstruct_prf#2965 AS l_shipinstruct_prf_0#2984, l_quantity_prf#2966 AS l_quantity_prf_0#2985, l_receiptdate_prf#2967 AS l_receiptdate_prf_0#2986, l_linenumber_prf#2968 AS l_linenumber_prf_0#2987, l_tax_prf#2969 AS l_tax_prf_0#2988, l_shipdate_prf#2970 AS l_shipdate_prf_0#2989, l_extendedprice_prf#2971 AS l_extendedprice_prf_0#2990, l_partkey_prf#2972 AS l_partkey_prf_0#2991, l_discount_prf#2973 AS l_discount_prf_0#2992, l_partkey_and_l_suppkey_prf#2974 AS l_partkey_and_l_suppkey_prf_0#2993, l_commitdate_prf#2975 AS l_commitdate_prf_0#2994, l_suppkey_prf#2976 AS l_suppkey_prf_0#2995, l_orderkey_prf#2977 AS l_orderkey_prf_0#2996]
         :     :  +- Relation[l_returnflag_prf#2959,l_orderkey_and_l_linenumber_prf#2960,l_comment_prf#2961,l_linestatus_prf#2962,rid#2963,l_shipmode_prf#2964,l_shipinstruct_prf#2965,l_quantity_prf#2966,l_receiptdate_prf#2967,l_linenumber_prf#2968,l_tax_prf#2969,l_shipdate_prf#2970,l_extendedprice_prf#2971,l_partkey_prf#2972,l_discount_prf#2973,l_partkey_and_l_suppkey_prf#2974,l_commitdate_prf#2975,l_suppkey_prf#2976,l_orderkey_prf#2977] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#3018]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#3009: string
            :     :- Project [o_shippriority_prf#2998 AS o_shippriority_prf_1#3008, rid#2999 AS rid_1#3009, o_orderdate_prf#3000 AS o_orderdate_prf_1#3010, o_custkey_prf#3001 AS o_custkey_prf_1#3011, o_orderpriority_prf#3002 AS o_orderpriority_prf_1#3012, o_clerk_prf#3003 AS o_clerk_prf_1#3013, o_orderstatus_prf#3004 AS o_orderstatus_prf_1#3014, o_totalprice_prf#3005 AS o_totalprice_prf_1#3015, o_orderkey_prf#3006 AS o_orderkey_prf_1#3016, o_comment_prf#3007 AS o_comment_prf_1#3017]
            :     :  +- Relation[o_shippriority_prf#2998,rid#2999,o_orderdate_prf#3000,o_custkey_prf#3001,o_orderpriority_prf#3002,o_clerk_prf#3003,o_orderstatus_prf#3004,o_totalprice_prf#3005,o_orderkey_prf#3006,o_comment_prf#3007] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#3019 AS c_acctbal_prf_2#3028, rid#3020 AS rid_2#3029, c_name_prf#3021 AS c_name_prf_2#3030, c_nationkey_prf#3022 AS c_nationkey_prf_2#3031, c_custkey_prf#3023 AS c_custkey_prf_2#3032, c_comment_prf#3024 AS c_comment_prf_2#3033, c_address_prf#3025 AS c_address_prf_2#3034, c_mktsegment_prf#3026 AS c_mktsegment_prf_2#3035, c_phone_prf#3027 AS c_phone_prf_2#3036]
               +- Relation[c_acctbal_prf#3019,rid#3020,c_name_prf#3021,c_nationkey_prf#3022,c_custkey_prf#3023,c_comment_prf#3024,c_address_prf#3025,c_mktsegment_prf#3026,c_phone_prf#3027] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 147991ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/15 00:43:36 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:43:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3103L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 00:43:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3103L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#3143]
         :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#3128: string
         :     :- Project [l_returnflag_prf#3105 AS l_returnflag_prf_0#3124, l_orderkey_and_l_linenumber_prf#3106 AS l_orderkey_and_l_linenumber_prf_0#3125, l_comment_prf#3107 AS l_comment_prf_0#3126, l_linestatus_prf#3108 AS l_linestatus_prf_0#3127, rid#3109 AS rid_0#3128, l_shipmode_prf#3110 AS l_shipmode_prf_0#3129, l_shipinstruct_prf#3111 AS l_shipinstruct_prf_0#3130, l_quantity_prf#3112 AS l_quantity_prf_0#3131, l_receiptdate_prf#3113 AS l_receiptdate_prf_0#3132, l_linenumber_prf#3114 AS l_linenumber_prf_0#3133, l_tax_prf#3115 AS l_tax_prf_0#3134, l_shipdate_prf#3116 AS l_shipdate_prf_0#3135, l_extendedprice_prf#3117 AS l_extendedprice_prf_0#3136, l_partkey_prf#3118 AS l_partkey_prf_0#3137, l_discount_prf#3119 AS l_discount_prf_0#3138, l_partkey_and_l_suppkey_prf#3120 AS l_partkey_and_l_suppkey_prf_0#3139, l_commitdate_prf#3121 AS l_commitdate_prf_0#3140, l_suppkey_prf#3122 AS l_suppkey_prf_0#3141, l_orderkey_prf#3123 AS l_orderkey_prf_0#3142]
         :     :  +- Relation[l_returnflag_prf#3105,l_orderkey_and_l_linenumber_prf#3106,l_comment_prf#3107,l_linestatus_prf#3108,rid#3109,l_shipmode_prf#3110,l_shipinstruct_prf#3111,l_quantity_prf#3112,l_receiptdate_prf#3113,l_linenumber_prf#3114,l_tax_prf#3115,l_shipdate_prf#3116,l_extendedprice_prf#3117,l_partkey_prf#3118,l_discount_prf#3119,l_partkey_and_l_suppkey_prf#3120,l_commitdate_prf#3121,l_suppkey_prf#3122,l_orderkey_prf#3123] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#3144 AS p_comment_prf_1#3154, p_name_prf#3145 AS p_name_prf_1#3155, rid#3146 AS rid_1#3156, p_type_prf#3147 AS p_type_prf_1#3157, p_retailprice_prf#3148 AS p_retailprice_prf_1#3158, p_mfgr_prf#3149 AS p_mfgr_prf_1#3159, p_container_prf#3150 AS p_container_prf_1#3160, p_brand_prf#3151 AS p_brand_prf_1#3161, p_size_prf#3152 AS p_size_prf_1#3162, p_partkey_prf#3153 AS p_partkey_prf_1#3163]
            +- Relation[p_comment_prf#3144,p_name_prf#3145,rid#3146,p_type_prf#3147,p_retailprice_prf#3148,p_mfgr_prf#3149,p_container_prf#3150,p_brand_prf#3151,p_size_prf#3152,p_partkey_prf#3153] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 117769ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/15 00:45:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:45:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3221L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 00:45:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3221L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#3243]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#3234: string
         :     :- Project [o_shippriority_prf#3223 AS o_shippriority_prf_0#3233, rid#3224 AS rid_0#3234, o_orderdate_prf#3225 AS o_orderdate_prf_0#3235, o_custkey_prf#3226 AS o_custkey_prf_0#3236, o_orderpriority_prf#3227 AS o_orderpriority_prf_0#3237, o_clerk_prf#3228 AS o_clerk_prf_0#3238, o_orderstatus_prf#3229 AS o_orderstatus_prf_0#3239, o_totalprice_prf#3230 AS o_totalprice_prf_0#3240, o_orderkey_prf#3231 AS o_orderkey_prf_0#3241, o_comment_prf#3232 AS o_comment_prf_0#3242]
         :     :  +- Relation[o_shippriority_prf#3223,rid#3224,o_orderdate_prf#3225,o_custkey_prf#3226,o_orderpriority_prf#3227,o_clerk_prf#3228,o_orderstatus_prf#3229,o_totalprice_prf#3230,o_orderkey_prf#3231,o_comment_prf#3232] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#3244 AS l_returnflag_prf_1#3263, l_orderkey_and_l_linenumber_prf#3245 AS l_orderkey_and_l_linenumber_prf_1#3264, l_comment_prf#3246 AS l_comment_prf_1#3265, l_linestatus_prf#3247 AS l_linestatus_prf_1#3266, rid#3248 AS rid_1#3267, l_shipmode_prf#3249 AS l_shipmode_prf_1#3268, l_shipinstruct_prf#3250 AS l_shipinstruct_prf_1#3269, l_quantity_prf#3251 AS l_quantity_prf_1#3270, l_receiptdate_prf#3252 AS l_receiptdate_prf_1#3271, l_linenumber_prf#3253 AS l_linenumber_prf_1#3272, l_tax_prf#3254 AS l_tax_prf_1#3273, l_shipdate_prf#3255 AS l_shipdate_prf_1#3274, l_extendedprice_prf#3256 AS l_extendedprice_prf_1#3275, l_partkey_prf#3257 AS l_partkey_prf_1#3276, l_discount_prf#3258 AS l_discount_prf_1#3277, l_partkey_and_l_suppkey_prf#3259 AS l_partkey_and_l_suppkey_prf_1#3278, l_commitdate_prf#3260 AS l_commitdate_prf_1#3279, l_suppkey_prf#3261 AS l_suppkey_prf_1#3280, l_orderkey_prf#3262 AS l_orderkey_prf_1#3281]
            :  +- Relation[l_returnflag_prf#3244,l_orderkey_and_l_linenumber_prf#3245,l_comment_prf#3246,l_linestatus_prf#3247,rid#3248,l_shipmode_prf#3249,l_shipinstruct_prf#3250,l_quantity_prf#3251,l_receiptdate_prf#3252,l_linenumber_prf#3253,l_tax_prf#3254,l_shipdate_prf#3255,l_extendedprice_prf#3256,l_partkey_prf#3257,l_discount_prf#3258,l_partkey_and_l_suppkey_prf#3259,l_commitdate_prf#3260,l_suppkey_prf#3261,l_orderkey_prf#3262] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3282]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#2868,value#2869] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 196903ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/15 00:48:51 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:48:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3331L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 00:48:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3331L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#3333 AS l_returnflag_prf_0#3352, l_orderkey_and_l_linenumber_prf#3334 AS l_orderkey_and_l_linenumber_prf_0#3353, l_comment_prf#3335 AS l_comment_prf_0#3354, l_linestatus_prf#3336 AS l_linestatus_prf_0#3355, rid#3337 AS rid_0#3356, l_shipmode_prf#3338 AS l_shipmode_prf_0#3357, l_shipinstruct_prf#3339 AS l_shipinstruct_prf_0#3358, l_quantity_prf#3340 AS l_quantity_prf_0#3359, l_receiptdate_prf#3341 AS l_receiptdate_prf_0#3360, l_linenumber_prf#3342 AS l_linenumber_prf_0#3361, l_tax_prf#3343 AS l_tax_prf_0#3362, l_shipdate_prf#3344 AS l_shipdate_prf_0#3363, l_extendedprice_prf#3345 AS l_extendedprice_prf_0#3364, l_partkey_prf#3346 AS l_partkey_prf_0#3365, l_discount_prf#3347 AS l_discount_prf_0#3366, l_partkey_and_l_suppkey_prf#3348 AS l_partkey_and_l_suppkey_prf_0#3367, l_commitdate_prf#3349 AS l_commitdate_prf_0#3368, l_suppkey_prf#3350 AS l_suppkey_prf_0#3369, l_orderkey_prf#3351 AS l_orderkey_prf_0#3370]
         :  +- Relation[l_returnflag_prf#3333,l_orderkey_and_l_linenumber_prf#3334,l_comment_prf#3335,l_linestatus_prf#3336,rid#3337,l_shipmode_prf#3338,l_shipinstruct_prf#3339,l_quantity_prf#3340,l_receiptdate_prf#3341,l_linenumber_prf#3342,l_tax_prf#3343,l_shipdate_prf#3344,l_extendedprice_prf#3345,l_partkey_prf#3346,l_discount_prf#3347,l_partkey_and_l_suppkey_prf#3348,l_commitdate_prf#3349,l_suppkey_prf#3350,l_orderkey_prf#3351] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3371]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#2868,value#2869] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 13686ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/15 00:49:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:49:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3427L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/15 00:49:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3427L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#3467]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3452: string
         :  :  :     :- Project [l_returnflag_prf#3429 AS l_returnflag_prf_0#3448, l_orderkey_and_l_linenumber_prf#3430 AS l_orderkey_and_l_linenumber_prf_0#3449, l_comment_prf#3431 AS l_comment_prf_0#3450, l_linestatus_prf#3432 AS l_linestatus_prf_0#3451, rid#3433 AS rid_0#3452, l_shipmode_prf#3434 AS l_shipmode_prf_0#3453, l_shipinstruct_prf#3435 AS l_shipinstruct_prf_0#3454, l_quantity_prf#3436 AS l_quantity_prf_0#3455, l_receiptdate_prf#3437 AS l_receiptdate_prf_0#3456, l_linenumber_prf#3438 AS l_linenumber_prf_0#3457, l_tax_prf#3439 AS l_tax_prf_0#3458, l_shipdate_prf#3440 AS l_shipdate_prf_0#3459, l_extendedprice_prf#3441 AS l_extendedprice_prf_0#3460, l_partkey_prf#3442 AS l_partkey_prf_0#3461, l_discount_prf#3443 AS l_discount_prf_0#3462, l_partkey_and_l_suppkey_prf#3444 AS l_partkey_and_l_suppkey_prf_0#3463, l_commitdate_prf#3445 AS l_commitdate_prf_0#3464, l_suppkey_prf#3446 AS l_suppkey_prf_0#3465, l_orderkey_prf#3447 AS l_orderkey_prf_0#3466]
         :  :  :     :  +- Relation[l_returnflag_prf#3429,l_orderkey_and_l_linenumber_prf#3430,l_comment_prf#3431,l_linestatus_prf#3432,rid#3433,l_shipmode_prf#3434,l_shipinstruct_prf#3435,l_quantity_prf#3436,l_receiptdate_prf#3437,l_linenumber_prf#3438,l_tax_prf#3439,l_shipdate_prf#3440,l_extendedprice_prf#3441,l_partkey_prf#3442,l_discount_prf#3443,l_partkey_and_l_suppkey_prf#3444,l_commitdate_prf#3445,l_suppkey_prf#3446,l_orderkey_prf#3447] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#3468 AS o_shippriority_prf_1#3478, rid#3469 AS rid_1#3479, o_orderdate_prf#3470 AS o_orderdate_prf_1#3480, o_custkey_prf#3471 AS o_custkey_prf_1#3481, o_orderpriority_prf#3472 AS o_orderpriority_prf_1#3482, o_clerk_prf#3473 AS o_clerk_prf_1#3483, o_orderstatus_prf#3474 AS o_orderstatus_prf_1#3484, o_totalprice_prf#3475 AS o_totalprice_prf_1#3485, o_orderkey_prf#3476 AS o_orderkey_prf_1#3486, o_comment_prf#3477 AS o_comment_prf_1#3487]
         :  :     +- Relation[o_shippriority_prf#3468,rid#3469,o_orderdate_prf#3470,o_custkey_prf#3471,o_orderpriority_prf#3472,o_clerk_prf#3473,o_orderstatus_prf#3474,o_totalprice_prf#3475,o_orderkey_prf#3476,o_comment_prf#3477] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#3499]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3498]
         :        :  +- Relation[o_shippriority_prf#3488,rid#3489,o_orderdate_prf#3490,o_custkey_prf#3491,o_orderpriority_prf#3492,o_clerk_prf#3493,o_orderstatus_prf#3494,o_totalprice_prf#3495,o_orderkey_prf#3496,o_comment_prf#3497] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3500 AS c_acctbal_prf_2#3509, rid#3501 AS rid_2#3510, c_name_prf#3502 AS c_name_prf_2#3511, c_nationkey_prf#3503 AS c_nationkey_prf_2#3512, c_custkey_prf#3504 AS c_custkey_prf_2#3513, c_comment_prf#3505 AS c_comment_prf_2#3514, c_address_prf#3506 AS c_address_prf_2#3515, c_mktsegment_prf#3507 AS c_mktsegment_prf_2#3516, c_phone_prf#3508 AS c_phone_prf_2#3517]
            +- Relation[c_acctbal_prf#3500,rid#3501,c_name_prf#3502,c_nationkey_prf#3503,c_custkey_prf#3504,c_comment_prf#3505,c_address_prf#3506,c_mktsegment_prf#3507,c_phone_prf#3508] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 169480ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/15 00:51:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:51:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3578L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/15 00:51:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3578L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#3590]
         :  :  :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#3585: string
         :  :  :     :- Project [rid#3580 AS rid_0#3585, n_regionkey_prf#3581 AS n_regionkey_prf_0#3586, n_nationkey_prf#3582 AS n_nationkey_prf_0#3587, n_name_prf#3583 AS n_name_prf_0#3588, n_comment_prf#3584 AS n_comment_prf_0#3589]
         :  :  :     :  +- Relation[rid#3580,n_regionkey_prf#3581,n_nationkey_prf#3582,n_name_prf#3583,n_comment_prf#3584] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#3591 AS s_phone_prf_1#3599, rid#3592 AS rid_1#3600, s_address_prf#3593 AS s_address_prf_1#3601, s_nationkey_prf#3594 AS s_nationkey_prf_1#3602, s_suppkey_prf#3595 AS s_suppkey_prf_1#3603, s_name_prf#3596 AS s_name_prf_1#3604, s_acctbal_prf#3597 AS s_acctbal_prf_1#3605, s_comment_prf#3598 AS s_comment_prf_1#3606]
         :  :     +- Relation[s_phone_prf#3591,rid#3592,s_address_prf#3593,s_nationkey_prf#3594,s_suppkey_prf#3595,s_name_prf#3596,s_acctbal_prf#3597,s_comment_prf#3598] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1525) AS rid_2#3613]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3612]
         :        :  +- Relation[rid#3607,n_regionkey_prf#3608,n_nationkey_prf#3609,n_name_prf#3610,n_comment_prf#3611] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3614 AS c_acctbal_prf_2#3623, rid#3615 AS rid_2#3624, c_name_prf#3616 AS c_name_prf_2#3625, c_nationkey_prf#3617 AS c_nationkey_prf_2#3626, c_custkey_prf#3618 AS c_custkey_prf_2#3627, c_comment_prf#3619 AS c_comment_prf_2#3628, c_address_prf#3620 AS c_address_prf_2#3629, c_mktsegment_prf#3621 AS c_mktsegment_prf_2#3630, c_phone_prf#3622 AS c_phone_prf_2#3631]
            +- Relation[c_acctbal_prf#3614,rid#3615,c_name_prf#3616,c_nationkey_prf#3617,c_custkey_prf#3618,c_comment_prf#3619,c_address_prf#3620,c_mktsegment_prf#3621,c_phone_prf#3622] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 20028ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/15 00:52:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:52:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3690L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 00:52:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3690L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#3710]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3702: string
         :     :- Project [c_acctbal_prf#3692 AS c_acctbal_prf_0#3701, rid#3693 AS rid_0#3702, c_name_prf#3694 AS c_name_prf_0#3703, c_nationkey_prf#3695 AS c_nationkey_prf_0#3704, c_custkey_prf#3696 AS c_custkey_prf_0#3705, c_comment_prf#3697 AS c_comment_prf_0#3706, c_address_prf#3698 AS c_address_prf_0#3707, c_mktsegment_prf#3699 AS c_mktsegment_prf_0#3708, c_phone_prf#3700 AS c_phone_prf_0#3709]
         :     :  +- Relation[c_acctbal_prf#3692,rid#3693,c_name_prf#3694,c_nationkey_prf#3695,c_custkey_prf#3696,c_comment_prf#3697,c_address_prf#3698,c_mktsegment_prf#3699,c_phone_prf#3700] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#3731]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#3722: string
            :     :- Project [o_shippriority_prf#3711 AS o_shippriority_prf_1#3721, rid#3712 AS rid_1#3722, o_orderdate_prf#3713 AS o_orderdate_prf_1#3723, o_custkey_prf#3714 AS o_custkey_prf_1#3724, o_orderpriority_prf#3715 AS o_orderpriority_prf_1#3725, o_clerk_prf#3716 AS o_clerk_prf_1#3726, o_orderstatus_prf#3717 AS o_orderstatus_prf_1#3727, o_totalprice_prf#3718 AS o_totalprice_prf_1#3728, o_orderkey_prf#3719 AS o_orderkey_prf_1#3729, o_comment_prf#3720 AS o_comment_prf_1#3730]
            :     :  +- Relation[o_shippriority_prf#3711,rid#3712,o_orderdate_prf#3713,o_custkey_prf#3714,o_orderpriority_prf#3715,o_clerk_prf#3716,o_orderstatus_prf#3717,o_totalprice_prf#3718,o_orderkey_prf#3719,o_comment_prf#3720] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3732 AS l_returnflag_prf_2#3751, l_orderkey_and_l_linenumber_prf#3733 AS l_orderkey_and_l_linenumber_prf_2#3752, l_comment_prf#3734 AS l_comment_prf_2#3753, l_linestatus_prf#3735 AS l_linestatus_prf_2#3754, rid#3736 AS rid_2#3755, l_shipmode_prf#3737 AS l_shipmode_prf_2#3756, l_shipinstruct_prf#3738 AS l_shipinstruct_prf_2#3757, l_quantity_prf#3739 AS l_quantity_prf_2#3758, l_receiptdate_prf#3740 AS l_receiptdate_prf_2#3759, l_linenumber_prf#3741 AS l_linenumber_prf_2#3760, l_tax_prf#3742 AS l_tax_prf_2#3761, l_shipdate_prf#3743 AS l_shipdate_prf_2#3762, l_extendedprice_prf#3744 AS l_extendedprice_prf_2#3763, l_partkey_prf#3745 AS l_partkey_prf_2#3764, l_discount_prf#3746 AS l_discount_prf_2#3765, l_partkey_and_l_suppkey_prf#3747 AS l_partkey_and_l_suppkey_prf_2#3766, l_commitdate_prf#3748 AS l_commitdate_prf_2#3767, l_suppkey_prf#3749 AS l_suppkey_prf_2#3768, l_orderkey_prf#3750 AS l_orderkey_prf_2#3769]
               +- Relation[l_returnflag_prf#3732,l_orderkey_and_l_linenumber_prf#3733,l_comment_prf#3734,l_linestatus_prf#3735,rid#3736,l_shipmode_prf#3737,l_shipinstruct_prf#3738,l_quantity_prf#3739,l_receiptdate_prf#3740,l_linenumber_prf#3741,l_tax_prf#3742,l_shipdate_prf#3743,l_extendedprice_prf#3744,l_partkey_prf#3745,l_discount_prf#3746,l_partkey_and_l_suppkey_prf#3747,l_commitdate_prf#3748,l_suppkey_prf#3749,l_orderkey_prf#3750] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 236140ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/15 00:56:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:56:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3832L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 00:56:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3832L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#3854]
         :  :  :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#3846: string
         :  :  :     :- Project [p_comment_prf#3834 AS p_comment_prf_0#3844, p_name_prf#3835 AS p_name_prf_0#3845, rid#3836 AS rid_0#3846, p_type_prf#3837 AS p_type_prf_0#3847, p_retailprice_prf#3838 AS p_retailprice_prf_0#3848, p_mfgr_prf#3839 AS p_mfgr_prf_0#3849, p_container_prf#3840 AS p_container_prf_0#3850, p_brand_prf#3841 AS p_brand_prf_0#3851, p_size_prf#3842 AS p_size_prf_0#3852, p_partkey_prf#3843 AS p_partkey_prf_0#3853]
         :  :  :     :  +- Relation[p_comment_prf#3834,p_name_prf#3835,rid#3836,p_type_prf#3837,p_retailprice_prf#3838,p_mfgr_prf#3839,p_container_prf#3840,p_brand_prf#3841,p_size_prf#3842,p_partkey_prf#3843] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#3855 AS ps_partkey_and_ps_suppkey_prf_1#3862, rid#3856 AS rid_1#3863, ps_availqty_prf#3857 AS ps_availqty_prf_1#3864, ps_comment_prf#3858 AS ps_comment_prf_1#3865, ps_partkey_prf#3859 AS ps_partkey_prf_1#3866, ps_supplycost_prf#3860 AS ps_supplycost_prf_1#3867, ps_suppkey_prf#3861 AS ps_suppkey_prf_1#3868]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#3855,rid#3856,ps_availqty_prf#3857,ps_comment_prf#3858,ps_partkey_prf#3859,ps_supplycost_prf#3860,ps_suppkey_prf#3861] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#3877]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3876]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#3869,rid#3870,ps_availqty_prf#3871,ps_comment_prf#3872,ps_partkey_prf#3873,ps_supplycost_prf#3874,ps_suppkey_prf#3875] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3878 AS s_phone_prf_2#3886, rid#3879 AS rid_2#3887, s_address_prf#3880 AS s_address_prf_2#3888, s_nationkey_prf#3881 AS s_nationkey_prf_2#3889, s_suppkey_prf#3882 AS s_suppkey_prf_2#3890, s_name_prf#3883 AS s_name_prf_2#3891, s_acctbal_prf#3884 AS s_acctbal_prf_2#3892, s_comment_prf#3885 AS s_comment_prf_2#3893]
            +- Relation[s_phone_prf#3878,rid#3879,s_address_prf#3880,s_nationkey_prf#3881,s_suppkey_prf#3882,s_name_prf#3883,s_acctbal_prf#3884,s_comment_prf#3885] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 84243ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/15 00:57:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 00:57:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3947L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 00:57:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3947L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#3969]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#3960: string
         :     :- Project [o_shippriority_prf#3949 AS o_shippriority_prf_0#3959, rid#3950 AS rid_0#3960, o_orderdate_prf#3951 AS o_orderdate_prf_0#3961, o_custkey_prf#3952 AS o_custkey_prf_0#3962, o_orderpriority_prf#3953 AS o_orderpriority_prf_0#3963, o_clerk_prf#3954 AS o_clerk_prf_0#3964, o_orderstatus_prf#3955 AS o_orderstatus_prf_0#3965, o_totalprice_prf#3956 AS o_totalprice_prf_0#3966, o_orderkey_prf#3957 AS o_orderkey_prf_0#3967, o_comment_prf#3958 AS o_comment_prf_0#3968]
         :     :  +- Relation[o_shippriority_prf#3949,rid#3950,o_orderdate_prf#3951,o_custkey_prf#3952,o_orderpriority_prf#3953,o_clerk_prf#3954,o_orderstatus_prf#3955,o_totalprice_prf#3956,o_orderkey_prf#3957,o_comment_prf#3958] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3970 AS l_returnflag_prf_1#3989, l_orderkey_and_l_linenumber_prf#3971 AS l_orderkey_and_l_linenumber_prf_1#3990, l_comment_prf#3972 AS l_comment_prf_1#3991, l_linestatus_prf#3973 AS l_linestatus_prf_1#3992, rid#3974 AS rid_1#3993, l_shipmode_prf#3975 AS l_shipmode_prf_1#3994, l_shipinstruct_prf#3976 AS l_shipinstruct_prf_1#3995, l_quantity_prf#3977 AS l_quantity_prf_1#3996, l_receiptdate_prf#3978 AS l_receiptdate_prf_1#3997, l_linenumber_prf#3979 AS l_linenumber_prf_1#3998, l_tax_prf#3980 AS l_tax_prf_1#3999, l_shipdate_prf#3981 AS l_shipdate_prf_1#4000, l_extendedprice_prf#3982 AS l_extendedprice_prf_1#4001, l_partkey_prf#3983 AS l_partkey_prf_1#4002, l_discount_prf#3984 AS l_discount_prf_1#4003, l_partkey_and_l_suppkey_prf#3985 AS l_partkey_and_l_suppkey_prf_1#4004, l_commitdate_prf#3986 AS l_commitdate_prf_1#4005, l_suppkey_prf#3987 AS l_suppkey_prf_1#4006, l_orderkey_prf#3988 AS l_orderkey_prf_1#4007]
            +- Relation[l_returnflag_prf#3970,l_orderkey_and_l_linenumber_prf#3971,l_comment_prf#3972,l_linestatus_prf#3973,rid#3974,l_shipmode_prf#3975,l_shipinstruct_prf#3976,l_quantity_prf#3977,l_receiptdate_prf#3978,l_linenumber_prf#3979,l_tax_prf#3980,l_shipdate_prf#3981,l_extendedprice_prf#3982,l_partkey_prf#3983,l_discount_prf#3984,l_partkey_and_l_suppkey_prf#3985,l_commitdate_prf#3986,l_suppkey_prf#3987,l_orderkey_prf#3988] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 194657ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/15 01:00:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:00:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4061L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 01:00:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4061L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#4077]
         :  :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#4071: string
         :  :  :     :- Project [ps_partkey_and_ps_suppkey_prf#4063 AS ps_partkey_and_ps_suppkey_prf_0#4070, rid#4064 AS rid_0#4071, ps_availqty_prf#4065 AS ps_availqty_prf_0#4072, ps_comment_prf#4066 AS ps_comment_prf_0#4073, ps_partkey_prf#4067 AS ps_partkey_prf_0#4074, ps_supplycost_prf#4068 AS ps_supplycost_prf_0#4075, ps_suppkey_prf#4069 AS ps_suppkey_prf_0#4076]
         :  :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#4063,rid#4064,ps_availqty_prf#4065,ps_comment_prf#4066,ps_partkey_prf#4067,ps_supplycost_prf#4068,ps_suppkey_prf#4069] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#4078 AS p_comment_prf_1#4088, p_name_prf#4079 AS p_name_prf_1#4089, rid#4080 AS rid_1#4090, p_type_prf#4081 AS p_type_prf_1#4091, p_retailprice_prf#4082 AS p_retailprice_prf_1#4092, p_mfgr_prf#4083 AS p_mfgr_prf_1#4093, p_container_prf#4084 AS p_container_prf_1#4094, p_brand_prf#4085 AS p_brand_prf_1#4095, p_size_prf#4086 AS p_size_prf_1#4096, p_partkey_prf#4087 AS p_partkey_prf_1#4097]
         :  :     +- Relation[p_comment_prf#4078,p_name_prf#4079,rid#4080,p_type_prf#4081,p_retailprice_prf#4082,p_mfgr_prf#4083,p_container_prf#4084,p_brand_prf#4085,p_size_prf#4086,p_partkey_prf#4087] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1525) AS rid_2#4106]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4105]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#4098,rid#4099,ps_availqty_prf#4100,ps_comment_prf#4101,ps_partkey_prf#4102,ps_supplycost_prf#4103,ps_suppkey_prf#4104] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4107 AS s_phone_prf_2#4115, rid#4108 AS rid_2#4116, s_address_prf#4109 AS s_address_prf_2#4117, s_nationkey_prf#4110 AS s_nationkey_prf_2#4118, s_suppkey_prf#4111 AS s_suppkey_prf_2#4119, s_name_prf#4112 AS s_name_prf_2#4120, s_acctbal_prf#4113 AS s_acctbal_prf_2#4121, s_comment_prf#4114 AS s_comment_prf_2#4122]
            +- Relation[s_phone_prf#4107,rid#4108,s_address_prf#4109,s_nationkey_prf#4110,s_suppkey_prf#4111,s_name_prf#4112,s_acctbal_prf#4113,s_comment_prf#4114] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 104794ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/15 01:02:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:02:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4160L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 01:02:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4160L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#4162 AS p_comment_prf_0#4172, p_name_prf#4163 AS p_name_prf_0#4173, rid#4164 AS rid_0#4174, p_type_prf#4165 AS p_type_prf_0#4175, p_retailprice_prf#4166 AS p_retailprice_prf_0#4176, p_mfgr_prf#4167 AS p_mfgr_prf_0#4177, p_container_prf#4168 AS p_container_prf_0#4178, p_brand_prf#4169 AS p_brand_prf_0#4179, p_size_prf#4170 AS p_size_prf_0#4180, p_partkey_prf#4171 AS p_partkey_prf_0#4181]
         :  +- Relation[p_comment_prf#4162,p_name_prf#4163,rid#4164,p_type_prf#4165,p_retailprice_prf#4166,p_mfgr_prf#4167,p_container_prf#4168,p_brand_prf#4169,p_size_prf#4170,p_partkey_prf#4171] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4182]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#2868,value#2869] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1451
Elapsed time: 83ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/15 01:02:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:02:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4210L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/15 01:02:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4210L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#4232]
         :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4224: string
         :     :- Project [p_comment_prf#4212 AS p_comment_prf_0#4222, p_name_prf#4213 AS p_name_prf_0#4223, rid#4214 AS rid_0#4224, p_type_prf#4215 AS p_type_prf_0#4225, p_retailprice_prf#4216 AS p_retailprice_prf_0#4226, p_mfgr_prf#4217 AS p_mfgr_prf_0#4227, p_container_prf#4218 AS p_container_prf_0#4228, p_brand_prf#4219 AS p_brand_prf_0#4229, p_size_prf#4220 AS p_size_prf_0#4230, p_partkey_prf#4221 AS p_partkey_prf_0#4231]
         :     :  +- Relation[p_comment_prf#4212,p_name_prf#4213,rid#4214,p_type_prf#4215,p_retailprice_prf#4216,p_mfgr_prf#4217,p_container_prf#4218,p_brand_prf#4219,p_size_prf#4220,p_partkey_prf#4221] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4233 AS ps_partkey_and_ps_suppkey_prf_1#4240, rid#4234 AS rid_1#4241, ps_availqty_prf#4235 AS ps_availqty_prf_1#4242, ps_comment_prf#4236 AS ps_comment_prf_1#4243, ps_partkey_prf#4237 AS ps_partkey_prf_1#4244, ps_supplycost_prf#4238 AS ps_supplycost_prf_1#4245, ps_suppkey_prf#4239 AS ps_suppkey_prf_1#4246]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4233,rid#4234,ps_availqty_prf#4235,ps_comment_prf#4236,ps_partkey_prf#4237,ps_supplycost_prf#4238,ps_suppkey_prf#4239] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 31875ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/15 01:03:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:03:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4288L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 01:03:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4288L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#4304]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, rid_0#4298: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#4290 AS ps_partkey_and_ps_suppkey_prf_0#4297, rid#4291 AS rid_0#4298, ps_availqty_prf#4292 AS ps_availqty_prf_0#4299, ps_comment_prf#4293 AS ps_comment_prf_0#4300, ps_partkey_prf#4294 AS ps_partkey_prf_0#4301, ps_supplycost_prf#4295 AS ps_supplycost_prf_0#4302, ps_suppkey_prf#4296 AS ps_suppkey_prf_0#4303]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#4290,rid#4291,ps_availqty_prf#4292,ps_comment_prf#4293,ps_partkey_prf#4294,ps_supplycost_prf#4295,ps_suppkey_prf#4296] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4305 AS l_returnflag_prf_1#4324, l_orderkey_and_l_linenumber_prf#4306 AS l_orderkey_and_l_linenumber_prf_1#4325, l_comment_prf#4307 AS l_comment_prf_1#4326, l_linestatus_prf#4308 AS l_linestatus_prf_1#4327, rid#4309 AS rid_1#4328, l_shipmode_prf#4310 AS l_shipmode_prf_1#4329, l_shipinstruct_prf#4311 AS l_shipinstruct_prf_1#4330, l_quantity_prf#4312 AS l_quantity_prf_1#4331, l_receiptdate_prf#4313 AS l_receiptdate_prf_1#4332, l_linenumber_prf#4314 AS l_linenumber_prf_1#4333, l_tax_prf#4315 AS l_tax_prf_1#4334, l_shipdate_prf#4316 AS l_shipdate_prf_1#4335, l_extendedprice_prf#4317 AS l_extendedprice_prf_1#4336, l_partkey_prf#4318 AS l_partkey_prf_1#4337, l_discount_prf#4319 AS l_discount_prf_1#4338, l_partkey_and_l_suppkey_prf#4320 AS l_partkey_and_l_suppkey_prf_1#4339, l_commitdate_prf#4321 AS l_commitdate_prf_1#4340, l_suppkey_prf#4322 AS l_suppkey_prf_1#4341, l_orderkey_prf#4323 AS l_orderkey_prf_1#4342]
            +- Relation[l_returnflag_prf#4305,l_orderkey_and_l_linenumber_prf#4306,l_comment_prf#4307,l_linestatus_prf#4308,rid#4309,l_shipmode_prf#4310,l_shipinstruct_prf#4311,l_quantity_prf#4312,l_receiptdate_prf#4313,l_linenumber_prf#4314,l_tax_prf#4315,l_shipdate_prf#4316,l_extendedprice_prf#4317,l_partkey_prf#4318,l_discount_prf#4319,l_partkey_and_l_suppkey_prf#4320,l_commitdate_prf#4321,l_suppkey_prf#4322,l_orderkey_prf#4323] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 116561ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/15 01:05:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:05:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4376L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/15 01:05:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4376L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#4378 AS rid_0#4383, n_regionkey_prf#4379 AS n_regionkey_prf_0#4384, n_nationkey_prf#4380 AS n_nationkey_prf_0#4385, n_name_prf#4381 AS n_name_prf_0#4386, n_comment_prf#4382 AS n_comment_prf_0#4387]
         :  +- Relation[rid#4378,n_regionkey_prf#4379,n_nationkey_prf#4380,n_name_prf#4381,n_comment_prf#4382] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4388]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#2868,value#2869] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 200ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/15 01:05:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:05:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4430L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 01:05:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4430L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_2#4470]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4455: string
         :     :- Project [l_returnflag_prf#4432 AS l_returnflag_prf_0#4451, l_orderkey_and_l_linenumber_prf#4433 AS l_orderkey_and_l_linenumber_prf_0#4452, l_comment_prf#4434 AS l_comment_prf_0#4453, l_linestatus_prf#4435 AS l_linestatus_prf_0#4454, rid#4436 AS rid_0#4455, l_shipmode_prf#4437 AS l_shipmode_prf_0#4456, l_shipinstruct_prf#4438 AS l_shipinstruct_prf_0#4457, l_quantity_prf#4439 AS l_quantity_prf_0#4458, l_receiptdate_prf#4440 AS l_receiptdate_prf_0#4459, l_linenumber_prf#4441 AS l_linenumber_prf_0#4460, l_tax_prf#4442 AS l_tax_prf_0#4461, l_shipdate_prf#4443 AS l_shipdate_prf_0#4462, l_extendedprice_prf#4444 AS l_extendedprice_prf_0#4463, l_partkey_prf#4445 AS l_partkey_prf_0#4464, l_discount_prf#4446 AS l_discount_prf_0#4465, l_partkey_and_l_suppkey_prf#4447 AS l_partkey_and_l_suppkey_prf_0#4466, l_commitdate_prf#4448 AS l_commitdate_prf_0#4467, l_suppkey_prf#4449 AS l_suppkey_prf_0#4468, l_orderkey_prf#4450 AS l_orderkey_prf_0#4469]
         :     :  +- Relation[l_returnflag_prf#4432,l_orderkey_and_l_linenumber_prf#4433,l_comment_prf#4434,l_linestatus_prf#4435,rid#4436,l_shipmode_prf#4437,l_shipinstruct_prf#4438,l_quantity_prf#4439,l_receiptdate_prf#4440,l_linenumber_prf#4441,l_tax_prf#4442,l_shipdate_prf#4443,l_extendedprice_prf#4444,l_partkey_prf#4445,l_discount_prf#4446,l_partkey_and_l_suppkey_prf#4447,l_commitdate_prf#4448,l_suppkey_prf#4449,l_orderkey_prf#4450] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#4489]
            :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#4481: string
            :     :- Project [c_acctbal_prf#4471 AS c_acctbal_prf_1#4480, rid#4472 AS rid_1#4481, c_name_prf#4473 AS c_name_prf_1#4482, c_nationkey_prf#4474 AS c_nationkey_prf_1#4483, c_custkey_prf#4475 AS c_custkey_prf_1#4484, c_comment_prf#4476 AS c_comment_prf_1#4485, c_address_prf#4477 AS c_address_prf_1#4486, c_mktsegment_prf#4478 AS c_mktsegment_prf_1#4487, c_phone_prf#4479 AS c_phone_prf_1#4488]
            :     :  +- Relation[c_acctbal_prf#4471,rid#4472,c_name_prf#4473,c_nationkey_prf#4474,c_custkey_prf#4475,c_comment_prf#4476,c_address_prf#4477,c_mktsegment_prf#4478,c_phone_prf#4479] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4490 AS o_shippriority_prf_2#4500, rid#4491 AS rid_2#4501, o_orderdate_prf#4492 AS o_orderdate_prf_2#4502, o_custkey_prf#4493 AS o_custkey_prf_2#4503, o_orderpriority_prf#4494 AS o_orderpriority_prf_2#4504, o_clerk_prf#4495 AS o_clerk_prf_2#4505, o_orderstatus_prf#4496 AS o_orderstatus_prf_2#4506, o_totalprice_prf#4497 AS o_totalprice_prf_2#4507, o_orderkey_prf#4498 AS o_orderkey_prf_2#4508, o_comment_prf#4499 AS o_comment_prf_2#4509]
               +- Relation[o_shippriority_prf#4490,rid#4491,o_orderdate_prf#4492,o_custkey_prf#4493,o_orderpriority_prf#4494,o_clerk_prf#4495,o_orderstatus_prf#4496,o_totalprice_prf#4497,o_orderkey_prf#4498,o_comment_prf#4499] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 157562ms

f2=
select * from part where p_size = 15
19/10/15 01:07:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:07:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4560L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 01:07:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4560L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#4562 AS p_comment_prf_0#4572, p_name_prf#4563 AS p_name_prf_0#4573, rid#4564 AS rid_0#4574, p_type_prf#4565 AS p_type_prf_0#4575, p_retailprice_prf#4566 AS p_retailprice_prf_0#4576, p_mfgr_prf#4567 AS p_mfgr_prf_0#4577, p_container_prf#4568 AS p_container_prf_0#4578, p_brand_prf#4569 AS p_brand_prf_0#4579, p_size_prf#4570 AS p_size_prf_0#4580, p_partkey_prf#4571 AS p_partkey_prf_0#4581]
         :  +- Relation[p_comment_prf#4562,p_name_prf#4563,rid#4564,p_type_prf#4565,p_retailprice_prf#4566,p_mfgr_prf#4567,p_container_prf#4568,p_brand_prf#4569,p_size_prf#4570,p_partkey_prf#4571] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4582]
            +- DexRidFilter part~p_size~15
               +- Relation[label#2868,value#2869] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3907
Elapsed time: 130ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/15 01:07:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:07:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4617L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 01:07:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4617L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#4635]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#4628: string
         :     :- Project [s_phone_prf#4619 AS s_phone_prf_0#4627, rid#4620 AS rid_0#4628, s_address_prf#4621 AS s_address_prf_0#4629, s_nationkey_prf#4622 AS s_nationkey_prf_0#4630, s_suppkey_prf#4623 AS s_suppkey_prf_0#4631, s_name_prf#4624 AS s_name_prf_0#4632, s_acctbal_prf#4625 AS s_acctbal_prf_0#4633, s_comment_prf#4626 AS s_comment_prf_0#4634]
         :     :  +- Relation[s_phone_prf#4619,rid#4620,s_address_prf#4621,s_nationkey_prf#4622,s_suppkey_prf#4623,s_name_prf#4624,s_acctbal_prf#4625,s_comment_prf#4626] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#4650]
            :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_1#4644: string
            :     :- Project [ps_partkey_and_ps_suppkey_prf#4636 AS ps_partkey_and_ps_suppkey_prf_1#4643, rid#4637 AS rid_1#4644, ps_availqty_prf#4638 AS ps_availqty_prf_1#4645, ps_comment_prf#4639 AS ps_comment_prf_1#4646, ps_partkey_prf#4640 AS ps_partkey_prf_1#4647, ps_supplycost_prf#4641 AS ps_supplycost_prf_1#4648, ps_suppkey_prf#4642 AS ps_suppkey_prf_1#4649]
            :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#4636,rid#4637,ps_availqty_prf#4638,ps_comment_prf#4639,ps_partkey_prf#4640,ps_supplycost_prf#4641,ps_suppkey_prf#4642] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#4651 AS p_comment_prf_2#4661, p_name_prf#4652 AS p_name_prf_2#4662, rid#4653 AS rid_2#4663, p_type_prf#4654 AS p_type_prf_2#4664, p_retailprice_prf#4655 AS p_retailprice_prf_2#4665, p_mfgr_prf#4656 AS p_mfgr_prf_2#4666, p_container_prf#4657 AS p_container_prf_2#4667, p_brand_prf#4658 AS p_brand_prf_2#4668, p_size_prf#4659 AS p_size_prf_2#4669, p_partkey_prf#4660 AS p_partkey_prf_2#4670]
               +- Relation[p_comment_prf#4651,p_name_prf#4652,rid#4653,p_type_prf#4654,p_retailprice_prf#4655,p_mfgr_prf#4656,p_container_prf#4657,p_brand_prf#4658,p_size_prf#4659,p_partkey_prf#4660] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 61588ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/15 01:08:42 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:08:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4724L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 01:08:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4724L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#4746]
         :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#4738: string
         :     :- Project [p_comment_prf#4726 AS p_comment_prf_0#4736, p_name_prf#4727 AS p_name_prf_0#4737, rid#4728 AS rid_0#4738, p_type_prf#4729 AS p_type_prf_0#4739, p_retailprice_prf#4730 AS p_retailprice_prf_0#4740, p_mfgr_prf#4731 AS p_mfgr_prf_0#4741, p_container_prf#4732 AS p_container_prf_0#4742, p_brand_prf#4733 AS p_brand_prf_0#4743, p_size_prf#4734 AS p_size_prf_0#4744, p_partkey_prf#4735 AS p_partkey_prf_0#4745]
         :     :  +- Relation[p_comment_prf#4726,p_name_prf#4727,rid#4728,p_type_prf#4729,p_retailprice_prf#4730,p_mfgr_prf#4731,p_container_prf#4732,p_brand_prf#4733,p_size_prf#4734,p_partkey_prf#4735] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4747 AS l_returnflag_prf_1#4766, l_orderkey_and_l_linenumber_prf#4748 AS l_orderkey_and_l_linenumber_prf_1#4767, l_comment_prf#4749 AS l_comment_prf_1#4768, l_linestatus_prf#4750 AS l_linestatus_prf_1#4769, rid#4751 AS rid_1#4770, l_shipmode_prf#4752 AS l_shipmode_prf_1#4771, l_shipinstruct_prf#4753 AS l_shipinstruct_prf_1#4772, l_quantity_prf#4754 AS l_quantity_prf_1#4773, l_receiptdate_prf#4755 AS l_receiptdate_prf_1#4774, l_linenumber_prf#4756 AS l_linenumber_prf_1#4775, l_tax_prf#4757 AS l_tax_prf_1#4776, l_shipdate_prf#4758 AS l_shipdate_prf_1#4777, l_extendedprice_prf#4759 AS l_extendedprice_prf_1#4778, l_partkey_prf#4760 AS l_partkey_prf_1#4779, l_discount_prf#4761 AS l_discount_prf_1#4780, l_partkey_and_l_suppkey_prf#4762 AS l_partkey_and_l_suppkey_prf_1#4781, l_commitdate_prf#4763 AS l_commitdate_prf_1#4782, l_suppkey_prf#4764 AS l_suppkey_prf_1#4783, l_orderkey_prf#4765 AS l_orderkey_prf_1#4784]
            +- Relation[l_returnflag_prf#4747,l_orderkey_and_l_linenumber_prf#4748,l_comment_prf#4749,l_linestatus_prf#4750,rid#4751,l_shipmode_prf#4752,l_shipinstruct_prf#4753,l_quantity_prf#4754,l_receiptdate_prf#4755,l_linenumber_prf#4756,l_tax_prf#4757,l_shipdate_prf#4758,l_extendedprice_prf#4759,l_partkey_prf#4760,l_discount_prf#4761,l_partkey_and_l_suppkey_prf#4762,l_commitdate_prf#4763,l_suppkey_prf#4764,l_orderkey_prf#4765] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 94025ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/15 01:10:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:10:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4849L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 01:10:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4849L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#4889]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#4874: string
         :  :  :     :- Project [l_returnflag_prf#4851 AS l_returnflag_prf_0#4870, l_orderkey_and_l_linenumber_prf#4852 AS l_orderkey_and_l_linenumber_prf_0#4871, l_comment_prf#4853 AS l_comment_prf_0#4872, l_linestatus_prf#4854 AS l_linestatus_prf_0#4873, rid#4855 AS rid_0#4874, l_shipmode_prf#4856 AS l_shipmode_prf_0#4875, l_shipinstruct_prf#4857 AS l_shipinstruct_prf_0#4876, l_quantity_prf#4858 AS l_quantity_prf_0#4877, l_receiptdate_prf#4859 AS l_receiptdate_prf_0#4878, l_linenumber_prf#4860 AS l_linenumber_prf_0#4879, l_tax_prf#4861 AS l_tax_prf_0#4880, l_shipdate_prf#4862 AS l_shipdate_prf_0#4881, l_extendedprice_prf#4863 AS l_extendedprice_prf_0#4882, l_partkey_prf#4864 AS l_partkey_prf_0#4883, l_discount_prf#4865 AS l_discount_prf_0#4884, l_partkey_and_l_suppkey_prf#4866 AS l_partkey_and_l_suppkey_prf_0#4885, l_commitdate_prf#4867 AS l_commitdate_prf_0#4886, l_suppkey_prf#4868 AS l_suppkey_prf_0#4887, l_orderkey_prf#4869 AS l_orderkey_prf_0#4888]
         :  :  :     :  +- Relation[l_returnflag_prf#4851,l_orderkey_and_l_linenumber_prf#4852,l_comment_prf#4853,l_linestatus_prf#4854,rid#4855,l_shipmode_prf#4856,l_shipinstruct_prf#4857,l_quantity_prf#4858,l_receiptdate_prf#4859,l_linenumber_prf#4860,l_tax_prf#4861,l_shipdate_prf#4862,l_extendedprice_prf#4863,l_partkey_prf#4864,l_discount_prf#4865,l_partkey_and_l_suppkey_prf#4866,l_commitdate_prf#4867,l_suppkey_prf#4868,l_orderkey_prf#4869] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#4890 AS p_comment_prf_1#4900, p_name_prf#4891 AS p_name_prf_1#4901, rid#4892 AS rid_1#4902, p_type_prf#4893 AS p_type_prf_1#4903, p_retailprice_prf#4894 AS p_retailprice_prf_1#4904, p_mfgr_prf#4895 AS p_mfgr_prf_1#4905, p_container_prf#4896 AS p_container_prf_1#4906, p_brand_prf#4897 AS p_brand_prf_1#4907, p_size_prf#4898 AS p_size_prf_1#4908, p_partkey_prf#4899 AS p_partkey_prf_1#4909]
         :  :     +- Relation[p_comment_prf#4890,p_name_prf#4891,rid#4892,p_type_prf#4893,p_retailprice_prf#4894,p_mfgr_prf#4895,p_container_prf#4896,p_brand_prf#4897,p_size_prf#4898,p_partkey_prf#4899] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1525) AS rid_2#4930]
         :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4929]
         :        :  +- Relation[l_returnflag_prf#4910,l_orderkey_and_l_linenumber_prf#4911,l_comment_prf#4912,l_linestatus_prf#4913,rid#4914,l_shipmode_prf#4915,l_shipinstruct_prf#4916,l_quantity_prf#4917,l_receiptdate_prf#4918,l_linenumber_prf#4919,l_tax_prf#4920,l_shipdate_prf#4921,l_extendedprice_prf#4922,l_partkey_prf#4923,l_discount_prf#4924,l_partkey_and_l_suppkey_prf#4925,l_commitdate_prf#4926,l_suppkey_prf#4927,l_orderkey_prf#4928] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4931 AS s_phone_prf_2#4939, rid#4932 AS rid_2#4940, s_address_prf#4933 AS s_address_prf_2#4941, s_nationkey_prf#4934 AS s_nationkey_prf_2#4942, s_suppkey_prf#4935 AS s_suppkey_prf_2#4943, s_name_prf#4936 AS s_name_prf_2#4944, s_acctbal_prf#4937 AS s_acctbal_prf_2#4945, s_comment_prf#4938 AS s_comment_prf_2#4946]
            +- Relation[s_phone_prf#4931,rid#4932,s_address_prf#4933,s_nationkey_prf#4934,s_suppkey_prf#4935,s_name_prf#4936,s_acctbal_prf#4937,s_comment_prf#4938] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 223394ms

f1=
select * from region where r_name = 'EUROPE'
19/10/15 01:13:59 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:13:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4990L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/15 01:13:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4990L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#4992 AS r_regionkey_prf_0#4996, r_name_prf#4993 AS r_name_prf_0#4997, r_comment_prf#4994 AS r_comment_prf_0#4998, rid#4995 AS rid_0#4999]
         :  +- Relation[r_regionkey_prf#4992,r_name_prf#4993,r_comment_prf#4994,rid#4995] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5000]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#2868,value#2869] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 55ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/15 01:13:59 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:13:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5020L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/15 01:13:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5020L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#5038]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#5031: string
         :     :- Project [s_phone_prf#5022 AS s_phone_prf_0#5030, rid#5023 AS rid_0#5031, s_address_prf#5024 AS s_address_prf_0#5032, s_nationkey_prf#5025 AS s_nationkey_prf_0#5033, s_suppkey_prf#5026 AS s_suppkey_prf_0#5034, s_name_prf#5027 AS s_name_prf_0#5035, s_acctbal_prf#5028 AS s_acctbal_prf_0#5036, s_comment_prf#5029 AS s_comment_prf_0#5037]
         :     :  +- Relation[s_phone_prf#5022,rid#5023,s_address_prf#5024,s_nationkey_prf#5025,s_suppkey_prf#5026,s_name_prf#5027,s_acctbal_prf#5028,s_comment_prf#5029] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#5039 AS ps_partkey_and_ps_suppkey_prf_1#5046, rid#5040 AS rid_1#5047, ps_availqty_prf#5041 AS ps_availqty_prf_1#5048, ps_comment_prf#5042 AS ps_comment_prf_1#5049, ps_partkey_prf#5043 AS ps_partkey_prf_1#5050, ps_supplycost_prf#5044 AS ps_supplycost_prf_1#5051, ps_suppkey_prf#5045 AS ps_suppkey_prf_1#5052]
            +- Relation[ps_partkey_and_ps_suppkey_prf#5039,rid#5040,ps_availqty_prf#5041,ps_comment_prf#5042,ps_partkey_prf#5043,ps_supplycost_prf#5044,ps_suppkey_prf#5045] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 10931ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/15 01:14:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:14:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5085L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/15 01:14:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5085L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#5108]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#5099: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#5087 AS p_comment_prf_0#5097, p_name_prf#5088 AS p_name_prf_0#5098, rid#5089 AS rid_0#5099, p_type_prf#5090 AS p_type_prf_0#5100, p_retailprice_prf#5091 AS p_retailprice_prf_0#5101, p_mfgr_prf#5092 AS p_mfgr_prf_0#5102, p_container_prf#5093 AS p_container_prf_0#5103, p_brand_prf#5094 AS p_brand_prf_0#5104, p_size_prf#5095 AS p_size_prf_0#5105, p_partkey_prf#5096 AS p_partkey_prf_0#5106]
         :     :  :  +- Relation[p_comment_prf#5087,p_name_prf#5088,rid#5089,p_type_prf#5090,p_retailprice_prf#5091,p_mfgr_prf#5092,p_container_prf#5093,p_brand_prf#5094,p_size_prf#5095,p_partkey_prf#5096] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5107]
         :     :     +- DexRidFilter part~p_size~15
         :     :        +- Relation[label#2868,value#2869] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#5109 AS ps_partkey_and_ps_suppkey_prf_1#5116, rid#5110 AS rid_1#5117, ps_availqty_prf#5111 AS ps_availqty_prf_1#5118, ps_comment_prf#5112 AS ps_comment_prf_1#5119, ps_partkey_prf#5113 AS ps_partkey_prf_1#5120, ps_supplycost_prf#5114 AS ps_supplycost_prf_1#5121, ps_suppkey_prf#5115 AS ps_suppkey_prf_1#5122]
            +- Relation[ps_partkey_and_ps_suppkey_prf#5109,rid#5110,ps_availqty_prf#5111,ps_comment_prf#5112,ps_partkey_prf#5113,ps_supplycost_prf#5114,ps_suppkey_prf#5115] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 393ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/15 01:14:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:14:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5168L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 01:14:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5168L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#5208]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#5193: string
         :     :- Project [l_returnflag_prf#5170 AS l_returnflag_prf_0#5189, l_orderkey_and_l_linenumber_prf#5171 AS l_orderkey_and_l_linenumber_prf_0#5190, l_comment_prf#5172 AS l_comment_prf_0#5191, l_linestatus_prf#5173 AS l_linestatus_prf_0#5192, rid#5174 AS rid_0#5193, l_shipmode_prf#5175 AS l_shipmode_prf_0#5194, l_shipinstruct_prf#5176 AS l_shipinstruct_prf_0#5195, l_quantity_prf#5177 AS l_quantity_prf_0#5196, l_receiptdate_prf#5178 AS l_receiptdate_prf_0#5197, l_linenumber_prf#5179 AS l_linenumber_prf_0#5198, l_tax_prf#5180 AS l_tax_prf_0#5199, l_shipdate_prf#5181 AS l_shipdate_prf_0#5200, l_extendedprice_prf#5182 AS l_extendedprice_prf_0#5201, l_partkey_prf#5183 AS l_partkey_prf_0#5202, l_discount_prf#5184 AS l_discount_prf_0#5203, l_partkey_and_l_suppkey_prf#5185 AS l_partkey_and_l_suppkey_prf_0#5204, l_commitdate_prf#5186 AS l_commitdate_prf_0#5205, l_suppkey_prf#5187 AS l_suppkey_prf_0#5206, l_orderkey_prf#5188 AS l_orderkey_prf_0#5207]
         :     :  +- Relation[l_returnflag_prf#5170,l_orderkey_and_l_linenumber_prf#5171,l_comment_prf#5172,l_linestatus_prf#5173,rid#5174,l_shipmode_prf#5175,l_shipinstruct_prf#5176,l_quantity_prf#5177,l_receiptdate_prf#5178,l_linenumber_prf#5179,l_tax_prf#5180,l_shipdate_prf#5181,l_extendedprice_prf#5182,l_partkey_prf#5183,l_discount_prf#5184,l_partkey_and_l_suppkey_prf#5185,l_commitdate_prf#5186,l_suppkey_prf#5187,l_orderkey_prf#5188] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#5209 AS o_shippriority_prf_1#5219, rid#5210 AS rid_1#5220, o_orderdate_prf#5211 AS o_orderdate_prf_1#5221, o_custkey_prf#5212 AS o_custkey_prf_1#5222, o_orderpriority_prf#5213 AS o_orderpriority_prf_1#5223, o_clerk_prf#5214 AS o_clerk_prf_1#5224, o_orderstatus_prf#5215 AS o_orderstatus_prf_1#5225, o_totalprice_prf#5216 AS o_totalprice_prf_1#5226, o_orderkey_prf#5217 AS o_orderkey_prf_1#5227, o_comment_prf#5218 AS o_comment_prf_1#5228]
            +- Relation[o_shippriority_prf#5209,rid#5210,o_orderdate_prf#5211,o_custkey_prf#5212,o_orderpriority_prf#5213,o_clerk_prf#5214,o_orderstatus_prf#5215,o_totalprice_prf#5216,o_orderkey_prf#5217,o_comment_prf#5218] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 114238ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/15 01:16:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:16:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5280L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/15 01:16:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5280L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#5298]
         :  :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#5291: string
         :  :  :     :- Project [s_phone_prf#5282 AS s_phone_prf_0#5290, rid#5283 AS rid_0#5291, s_address_prf#5284 AS s_address_prf_0#5292, s_nationkey_prf#5285 AS s_nationkey_prf_0#5293, s_suppkey_prf#5286 AS s_suppkey_prf_0#5294, s_name_prf#5287 AS s_name_prf_0#5295, s_acctbal_prf#5288 AS s_acctbal_prf_0#5296, s_comment_prf#5289 AS s_comment_prf_0#5297]
         :  :  :     :  +- Relation[s_phone_prf#5282,rid#5283,s_address_prf#5284,s_nationkey_prf#5285,s_suppkey_prf#5286,s_name_prf#5287,s_acctbal_prf#5288,s_comment_prf#5289] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [rid#5299 AS rid_1#5304, n_regionkey_prf#5300 AS n_regionkey_prf_1#5305, n_nationkey_prf#5301 AS n_nationkey_prf_1#5306, n_name_prf#5302 AS n_name_prf_1#5307, n_comment_prf#5303 AS n_comment_prf_1#5308]
         :  :     +- Relation[rid#5299,n_regionkey_prf#5300,n_nationkey_prf#5301,n_name_prf#5302,n_comment_prf#5303] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#5315]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5314]
         :        :  +- Relation[rid#5309,n_regionkey_prf#5310,n_nationkey_prf#5311,n_name_prf#5312,n_comment_prf#5313] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#5316 AS c_acctbal_prf_2#5325, rid#5317 AS rid_2#5326, c_name_prf#5318 AS c_name_prf_2#5327, c_nationkey_prf#5319 AS c_nationkey_prf_2#5328, c_custkey_prf#5320 AS c_custkey_prf_2#5329, c_comment_prf#5321 AS c_comment_prf_2#5330, c_address_prf#5322 AS c_address_prf_2#5331, c_mktsegment_prf#5323 AS c_mktsegment_prf_2#5332, c_phone_prf#5324 AS c_phone_prf_2#5333]
            +- Relation[c_acctbal_prf#5316,rid#5317,c_name_prf#5318,c_nationkey_prf#5319,c_custkey_prf#5320,c_comment_prf#5321,c_address_prf#5322,c_mktsegment_prf#5323,c_phone_prf#5324] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 46424ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/15 01:16:51 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:16:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5373L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 01:16:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5373L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#5389]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#5383: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#5375 AS ps_partkey_and_ps_suppkey_prf_0#5382, rid#5376 AS rid_0#5383, ps_availqty_prf#5377 AS ps_availqty_prf_0#5384, ps_comment_prf#5378 AS ps_comment_prf_0#5385, ps_partkey_prf#5379 AS ps_partkey_prf_0#5386, ps_supplycost_prf#5380 AS ps_supplycost_prf_0#5387, ps_suppkey_prf#5381 AS ps_suppkey_prf_0#5388]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#5375,rid#5376,ps_availqty_prf#5377,ps_comment_prf#5378,ps_partkey_prf#5379,ps_supplycost_prf#5380,ps_suppkey_prf#5381] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#5390 AS p_comment_prf_1#5400, p_name_prf#5391 AS p_name_prf_1#5401, rid#5392 AS rid_1#5402, p_type_prf#5393 AS p_type_prf_1#5403, p_retailprice_prf#5394 AS p_retailprice_prf_1#5404, p_mfgr_prf#5395 AS p_mfgr_prf_1#5405, p_container_prf#5396 AS p_container_prf_1#5406, p_brand_prf#5397 AS p_brand_prf_1#5407, p_size_prf#5398 AS p_size_prf_1#5408, p_partkey_prf#5399 AS p_partkey_prf_1#5409]
            :  +- Relation[p_comment_prf#5390,p_name_prf#5391,rid#5392,p_type_prf#5393,p_retailprice_prf#5394,p_mfgr_prf#5395,p_container_prf#5396,p_brand_prf#5397,p_size_prf#5398,p_partkey_prf#5399] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5410]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#2868,value#2869] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 50004ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/15 01:17:41 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:17:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5447L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 01:17:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5447L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#5449 AS l_returnflag_prf_0#5468, l_orderkey_and_l_linenumber_prf#5450 AS l_orderkey_and_l_linenumber_prf_0#5469, l_comment_prf#5451 AS l_comment_prf_0#5470, l_linestatus_prf#5452 AS l_linestatus_prf_0#5471, rid#5453 AS rid_0#5472, l_shipmode_prf#5454 AS l_shipmode_prf_0#5473, l_shipinstruct_prf#5455 AS l_shipinstruct_prf_0#5474, l_quantity_prf#5456 AS l_quantity_prf_0#5475, l_receiptdate_prf#5457 AS l_receiptdate_prf_0#5476, l_linenumber_prf#5458 AS l_linenumber_prf_0#5477, l_tax_prf#5459 AS l_tax_prf_0#5478, l_shipdate_prf#5460 AS l_shipdate_prf_0#5479, l_extendedprice_prf#5461 AS l_extendedprice_prf_0#5480, l_partkey_prf#5462 AS l_partkey_prf_0#5481, l_discount_prf#5463 AS l_discount_prf_0#5482, l_partkey_and_l_suppkey_prf#5464 AS l_partkey_and_l_suppkey_prf_0#5483, l_commitdate_prf#5465 AS l_commitdate_prf_0#5484, l_suppkey_prf#5466 AS l_suppkey_prf_0#5485, l_orderkey_prf#5467 AS l_orderkey_prf_0#5486]
         :  +- Relation[l_returnflag_prf#5449,l_orderkey_and_l_linenumber_prf#5450,l_comment_prf#5451,l_linestatus_prf#5452,rid#5453,l_shipmode_prf#5454,l_shipinstruct_prf#5455,l_quantity_prf#5456,l_receiptdate_prf#5457,l_linenumber_prf#5458,l_tax_prf#5459,l_shipdate_prf#5460,l_extendedprice_prf#5461,l_partkey_prf#5462,l_discount_prf#5463,l_partkey_and_l_suppkey_prf#5464,l_commitdate_prf#5465,l_suppkey_prf#5466,l_orderkey_prf#5467] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5487]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#2868,value#2869] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 23429ms
query=b1a, count=15628, duration=393
query=b1b, count=15628, duration=50004
query=b2a, count=1478870, duration=196903
query=b2b, count=1478870, duration=54751
query=f1, count=1, duration=55
query=f2, count=3907, duration=130
query=f3, count=1451, duration=83
query=f4, count=1, duration=200
query=f5, count=1478870, duration=23429
query=f6, count=857401, duration=13686
query=j1, count=800000, duration=31875
query=j10, count=6001215, duration=86240
query=j2, count=800000, duration=10931
query=j3, count=25, duration=67
query=j4, count=150000, duration=1929
query=j5, count=10000, duration=192
query=j6, count=6001215, duration=116561
query=j7, count=1500000, duration=40077
query=j8, count=6001215, duration=194657
query=j8b, count=6001215, duration=114238
query=j9, count=6001215, duration=94025
query=j9b, count=6001215, duration=117769
query=r1a, count=6001215, duration=169480
query=r1b, count=6001215, duration=147991
query=r1c, count=6001215, duration=157562
query=r1d, count=6001215, duration=231676
query=r1e, count=6001215, duration=236140
query=r1f, count=6001215, duration=157490
query=t1a, count=60000414, duration=46424
query=t1b, count=60000414, duration=20028
query=t1c, count=60000414, duration=66362
query=t2a, count=800000, duration=104794
query=t2b, count=800000, duration=84243
query=t2c, count=800000, duration=42785
query=t2d, count=800000, duration=61588
query=t3a, count=6001215, duration=223394
query=t3b, count=6001215, duration=195564
query=t3c, count=6001215, duration=187761
query=t3d, count=6001215, duration=187129
