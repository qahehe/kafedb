19/10/16 20:37:09 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7138ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Wed Oct 16 20:37:11 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Wed Oct 16 20:37:12 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Wed Oct 16 20:37:12 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Wed Oct 16 20:37:12 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Wed Oct 16 20:37:12 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Wed Oct 16 20:37:15 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Wed Oct 16 20:37:17 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Wed Oct 16 20:37:17 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



fq1f=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 20:37:18 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 20:37:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2097L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/16 20:37:18 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:37:18 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:37:18 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:37:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2097L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- Project [l_returnflag_prf#2099 AS l_returnflag_prf_0#2118, l_orderkey_and_l_linenumber_prf#2100 AS l_orderkey_and_l_linenumber_prf_0#2119, l_comment_prf#2101 AS l_comment_prf_0#2120, l_linestatus_prf#2102 AS l_linestatus_prf_0#2121, rid#2103 AS rid_0#2122, l_shipmode_prf#2104 AS l_shipmode_prf_0#2123, l_shipinstruct_prf#2105 AS l_shipinstruct_prf_0#2124, l_quantity_prf#2106 AS l_quantity_prf_0#2125, l_receiptdate_prf#2107 AS l_receiptdate_prf_0#2126, l_linenumber_prf#2108 AS l_linenumber_prf_0#2127, l_tax_prf#2109 AS l_tax_prf_0#2128, l_shipdate_prf#2110 AS l_shipdate_prf_0#2129, l_extendedprice_prf#2111 AS l_extendedprice_prf_0#2130, l_partkey_prf#2112 AS l_partkey_prf_0#2131, l_discount_prf#2113 AS l_discount_prf_0#2132, l_partkey_and_l_suppkey_prf#2114 AS l_partkey_and_l_suppkey_prf_0#2133, l_commitdate_prf#2115 AS l_commitdate_prf_0#2134, l_suppkey_prf#2116 AS l_suppkey_prf_0#2135, l_orderkey_prf#2117 AS l_orderkey_prf_0#2136]
         :  :  :  :  :  :  +- Relation[l_returnflag_prf#2099,l_orderkey_and_l_linenumber_prf#2100,l_comment_prf#2101,l_linestatus_prf#2102,rid#2103,l_shipmode_prf#2104,l_shipinstruct_prf#2105,l_quantity_prf#2106,l_receiptdate_prf#2107,l_linenumber_prf#2108,l_tax_prf#2109,l_shipdate_prf#2110,l_extendedprice_prf#2111,l_partkey_prf#2112,l_discount_prf#2113,l_partkey_and_l_suppkey_prf#2114,l_commitdate_prf#2115,l_suppkey_prf#2116,l_orderkey_prf#2117] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#2159]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :  :  :        :- 'Project ['rid AS rid_0#2156]
         :  :  :  :  :        :  +- Relation[l_returnflag_prf#2137,l_orderkey_and_l_linenumber_prf#2138,l_comment_prf#2139,l_linestatus_prf#2140,rid#2141,l_shipmode_prf#2142,l_shipinstruct_prf#2143,l_quantity_prf#2144,l_receiptdate_prf#2145,l_linenumber_prf#2146,l_tax_prf#2147,l_shipdate_prf#2148,l_extendedprice_prf#2149,l_partkey_prf#2150,l_discount_prf#2151,l_partkey_and_l_suppkey_prf#2152,l_commitdate_prf#2153,l_suppkey_prf#2154,l_orderkey_prf#2155] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [o_shippriority_prf#2160 AS o_shippriority_prf_1#2170, rid#2161 AS rid_1#2171, o_orderdate_prf#2162 AS o_orderdate_prf_1#2172, o_custkey_prf#2163 AS o_custkey_prf_1#2173, o_orderpriority_prf#2164 AS o_orderpriority_prf_1#2174, o_clerk_prf#2165 AS o_clerk_prf_1#2175, o_orderstatus_prf#2166 AS o_orderstatus_prf_1#2176, o_totalprice_prf#2167 AS o_totalprice_prf_1#2177, o_orderkey_prf#2168 AS o_orderkey_prf_1#2178, o_comment_prf#2169 AS o_comment_prf_1#2179]
         :  :  :  :     +- Relation[o_shippriority_prf#2160,rid#2161,o_orderdate_prf#2162,o_custkey_prf#2163,o_orderpriority_prf#2164,o_clerk_prf#2165,o_orderstatus_prf#2166,o_totalprice_prf#2167,o_orderkey_prf#2168,o_comment_prf#2169] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#2191]
         :  :  :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :  :  :        :- 'Project ['rid AS rid_1#2190]
         :  :  :        :  +- Relation[o_shippriority_prf#2180,rid#2181,o_orderdate_prf#2182,o_custkey_prf#2183,o_orderpriority_prf#2184,o_clerk_prf#2185,o_orderstatus_prf#2186,o_totalprice_prf#2187,o_orderkey_prf#2188,o_comment_prf#2189] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#2192 AS c_acctbal_prf_2#2201, rid#2193 AS rid_2#2202, c_name_prf#2194 AS c_name_prf_2#2203, c_nationkey_prf#2195 AS c_nationkey_prf_2#2204, c_custkey_prf#2196 AS c_custkey_prf_2#2205, c_comment_prf#2197 AS c_comment_prf_2#2206, c_address_prf#2198 AS c_address_prf_2#2207, c_mktsegment_prf#2199 AS c_mktsegment_prf_2#2208, c_phone_prf#2200 AS c_phone_prf_2#2209]
         :  :     +- Relation[c_acctbal_prf#2192,rid#2193,c_name_prf#2194,c_nationkey_prf#2195,c_custkey_prf#2196,c_comment_prf#2197,c_address_prf#2198,c_mktsegment_prf#2199,c_phone_prf#2200] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2158) AS rid_3#2220]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#2219]
         :        :  +- Relation[c_acctbal_prf#2210,rid#2211,c_name_prf#2212,c_nationkey_prf#2213,c_custkey_prf#2214,c_comment_prf#2215,c_address_prf#2216,c_mktsegment_prf#2217,c_phone_prf#2218] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_3))
            :- Project [rid#2221 AS rid_3#2226, n_regionkey_prf#2222 AS n_regionkey_prf_3#2227, n_nationkey_prf#2223 AS n_nationkey_prf_3#2228, n_name_prf#2224 AS n_name_prf_3#2229, n_comment_prf#2225 AS n_comment_prf_3#2230]
            :  +- Relation[rid#2221,n_regionkey_prf#2222,n_nationkey_prf#2223,n_name_prf#2224,n_comment_prf#2225] JDBCRelation(nation_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#2233]
               +- DexRidFilter nation~n_name~FRANCE
                  +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]

19/10/16 20:37:19 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=246415
Elapsed time: 173665ms

ft1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_name = 'FRANCE' and n_nationkey = c_nationkey
19/10/16 20:40:12 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 20:40:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2299L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 20:40:12 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 20:40:12 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 20:40:12 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:40:12 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 20:40:12 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:40:12 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:40:12 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:40:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2299L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#2338]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [s_phone_prf#2301 AS s_phone_prf_0#2309, rid#2302 AS rid_0#2310, s_address_prf#2303 AS s_address_prf_0#2311, s_nationkey_prf#2304 AS s_nationkey_prf_0#2312, s_suppkey_prf#2305 AS s_suppkey_prf_0#2313, s_name_prf#2306 AS s_name_prf_0#2314, s_acctbal_prf#2307 AS s_acctbal_prf_0#2315, s_comment_prf#2308 AS s_comment_prf_0#2316]
         :     :  :  :  +- Relation[s_phone_prf#2301,rid#2302,s_address_prf#2303,s_nationkey_prf#2304,s_suppkey_prf#2305,s_name_prf#2306,s_acctbal_prf#2307,s_comment_prf#2308] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#2326]
         :     :  :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#2325]
         :     :  :        :  +- Relation[s_phone_prf#2317,rid#2318,s_address_prf#2319,s_nationkey_prf#2320,s_suppkey_prf#2321,s_name_prf#2322,s_acctbal_prf#2323,s_comment_prf#2324] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [rid#2327 AS rid_1#2332, n_regionkey_prf#2328 AS n_regionkey_prf_1#2333, n_nationkey_prf#2329 AS n_nationkey_prf_1#2334, n_name_prf#2330 AS n_name_prf_1#2335, n_comment_prf#2331 AS n_comment_prf_1#2336]
         :     :     :  +- Relation[rid#2327,n_regionkey_prf#2328,n_nationkey_prf#2329,n_name_prf#2330,n_comment_prf#2331] JDBCRelation(nation_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2337]
         :     :        +- DexRidFilter nation~n_name~FRANCE
         :     :           +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2339 AS c_acctbal_prf_2#2348, rid#2340 AS rid_2#2349, c_name_prf#2341 AS c_name_prf_2#2350, c_nationkey_prf#2342 AS c_nationkey_prf_2#2351, c_custkey_prf#2343 AS c_custkey_prf_2#2352, c_comment_prf#2344 AS c_comment_prf_2#2353, c_address_prf#2345 AS c_address_prf_2#2354, c_mktsegment_prf#2346 AS c_mktsegment_prf_2#2355, c_phone_prf#2347 AS c_phone_prf_2#2356]
            +- Relation[c_acctbal_prf#2339,rid#2340,c_name_prf#2341,c_nationkey_prf#2342,c_custkey_prf#2343,c_comment_prf#2344,c_address_prf#2345,c_mktsegment_prf#2346,c_phone_prf#2347] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 47750ms

ft2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and (p_size = 15 and s_suppkey = ps_suppkey)
19/10/16 20:41:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 20:41:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2403L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/16 20:41:00 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 20:41:00 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 20:41:00 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 20:41:00 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 20:41:00 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 20:41:00 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 20:41:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2403L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#2405 AS s_phone_prf_0#2413, rid#2406 AS rid_0#2414, s_address_prf#2407 AS s_address_prf_0#2415, s_nationkey_prf#2408 AS s_nationkey_prf_0#2416, s_suppkey_prf#2409 AS s_suppkey_prf_0#2417, s_name_prf#2410 AS s_name_prf_0#2418, s_acctbal_prf#2411 AS s_acctbal_prf_0#2419, s_comment_prf#2412 AS s_comment_prf_0#2420]
         :  :  +- Relation[s_phone_prf#2405,rid#2406,s_address_prf#2407,s_nationkey_prf#2408,s_suppkey_prf#2409,s_name_prf#2410,s_acctbal_prf#2411,s_comment_prf#2412] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2158) AS rid_2#2430]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2429]
         :        :  +- Relation[s_phone_prf#2421,rid#2422,s_address_prf#2423,s_nationkey_prf#2424,s_suppkey_prf#2425,s_name_prf#2426,s_acctbal_prf#2427,s_comment_prf#2428] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#2452]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#2443: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#2431 AS p_comment_prf_1#2441, p_name_prf#2432 AS p_name_prf_1#2442, rid#2433 AS rid_1#2443, p_type_prf#2434 AS p_type_prf_1#2444, p_retailprice_prf#2435 AS p_retailprice_prf_1#2445, p_mfgr_prf#2436 AS p_mfgr_prf_1#2446, p_container_prf#2437 AS p_container_prf_1#2447, p_brand_prf#2438 AS p_brand_prf_1#2448, p_size_prf#2439 AS p_size_prf_1#2449, p_partkey_prf#2440 AS p_partkey_prf_1#2450]
            :     :  :  +- Relation[p_comment_prf#2431,p_name_prf#2432,rid#2433,p_type_prf#2434,p_retailprice_prf#2435,p_mfgr_prf#2436,p_container_prf#2437,p_brand_prf#2438,p_size_prf#2439,p_partkey_prf#2440] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2451]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#2453 AS ps_partkey_and_ps_suppkey_prf_2#2460, rid#2454 AS rid_2#2461, ps_availqty_prf#2455 AS ps_availqty_prf_2#2462, ps_comment_prf#2456 AS ps_comment_prf_2#2463, ps_partkey_prf#2457 AS ps_partkey_prf_2#2464, ps_supplycost_prf#2458 AS ps_supplycost_prf_2#2465, ps_suppkey_prf#2459 AS ps_suppkey_prf_2#2466]
               +- Relation[ps_partkey_and_ps_suppkey_prf#2453,rid#2454,ps_availqty_prf#2455,ps_comment_prf#2456,ps_partkey_prf#2457,ps_supplycost_prf#2458,ps_suppkey_prf#2459] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 7218ms

ft1b=
select * from nation, supplier, customer where n_name = 'FRANCE' and n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/16 20:41:07 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 20:41:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2514L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 20:41:07 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:41:07 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:41:07 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:41:07 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 20:41:07 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 20:41:07 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:41:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2514L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#2544]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#2527]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#2521: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#2516 AS rid_0#2521, n_regionkey_prf#2517 AS n_regionkey_prf_0#2522, n_nationkey_prf#2518 AS n_nationkey_prf_0#2523, n_name_prf#2519 AS n_name_prf_0#2524, n_comment_prf#2520 AS n_comment_prf_0#2525]
         :     :  :     :  :  +- Relation[rid#2516,n_regionkey_prf#2517,n_nationkey_prf#2518,n_name_prf#2519,n_comment_prf#2520] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2526]
         :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :        +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#2528 AS s_phone_prf_1#2536, rid#2529 AS rid_1#2537, s_address_prf#2530 AS s_address_prf_1#2538, s_nationkey_prf#2531 AS s_nationkey_prf_1#2539, s_suppkey_prf#2532 AS s_suppkey_prf_1#2540, s_name_prf#2533 AS s_name_prf_1#2541, s_acctbal_prf#2534 AS s_acctbal_prf_1#2542, s_comment_prf#2535 AS s_comment_prf_1#2543]
         :     :     +- Relation[s_phone_prf#2528,rid#2529,s_address_prf#2530,s_nationkey_prf#2531,s_suppkey_prf#2532,s_name_prf#2533,s_acctbal_prf#2534,s_comment_prf#2535] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2545 AS c_acctbal_prf_2#2554, rid#2546 AS rid_2#2555, c_name_prf#2547 AS c_name_prf_2#2556, c_nationkey_prf#2548 AS c_nationkey_prf_2#2557, c_custkey_prf#2549 AS c_custkey_prf_2#2558, c_comment_prf#2550 AS c_comment_prf_2#2559, c_address_prf#2551 AS c_address_prf_2#2560, c_mktsegment_prf#2552 AS c_mktsegment_prf_2#2561, c_phone_prf#2553 AS c_phone_prf_2#2562]
            +- Relation[c_acctbal_prf#2545,rid#2546,c_name_prf#2547,c_nationkey_prf#2548,c_custkey_prf#2549,c_comment_prf#2550,c_address_prf#2551,c_mktsegment_prf#2552,c_phone_prf#2553] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 30032ms

ft1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/16 20:41:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 20:41:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2607L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/16 20:41:37 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:41:37 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 20:41:37 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 20:41:37 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:41:37 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 20:41:37 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:41:37 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:41:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2607L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#2609 AS c_acctbal_prf_0#2618, rid#2610 AS rid_0#2619, c_name_prf#2611 AS c_name_prf_0#2620, c_nationkey_prf#2612 AS c_nationkey_prf_0#2621, c_custkey_prf#2613 AS c_custkey_prf_0#2622, c_comment_prf#2614 AS c_comment_prf_0#2623, c_address_prf#2615 AS c_address_prf_0#2624, c_mktsegment_prf#2616 AS c_mktsegment_prf_0#2625, c_phone_prf#2617 AS c_phone_prf_0#2626]
         :  :  +- Relation[c_acctbal_prf#2609,rid#2610,c_name_prf#2611,c_nationkey_prf#2612,c_custkey_prf#2613,c_comment_prf#2614,c_address_prf#2615,c_mktsegment_prf#2616,c_phone_prf#2617] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2158) AS rid_2#2637]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2636]
         :        :  +- Relation[c_acctbal_prf#2627,rid#2628,c_name_prf#2629,c_nationkey_prf#2630,c_custkey_prf#2631,c_comment_prf#2632,c_address_prf#2633,c_mktsegment_prf#2634,c_phone_prf#2635] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [s_phone_prf#2638 AS s_phone_prf_1#2646, rid#2639 AS rid_1#2647, s_address_prf#2640 AS s_address_prf_1#2648, s_nationkey_prf#2641 AS s_nationkey_prf_1#2649, s_suppkey_prf#2642 AS s_suppkey_prf_1#2650, s_name_prf#2643 AS s_name_prf_1#2651, s_acctbal_prf#2644 AS s_acctbal_prf_1#2652, s_comment_prf#2645 AS s_comment_prf_1#2653]
            :  :  +- Relation[s_phone_prf#2638,rid#2639,s_address_prf#2640,s_nationkey_prf#2641,s_suppkey_prf#2642,s_name_prf#2643,s_acctbal_prf#2644,s_comment_prf#2645] JDBCRelation(supplier_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#2663]
            :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#2662]
            :        :  +- Relation[s_phone_prf#2654,rid#2655,s_address_prf#2656,s_nationkey_prf#2657,s_suppkey_prf#2658,s_name_prf#2659,s_acctbal_prf#2660,s_comment_prf#2661] JDBCRelation(supplier_prf) [numPartitions=1]
            :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [rid#2664 AS rid_2#2669, n_regionkey_prf#2665 AS n_regionkey_prf_2#2670, n_nationkey_prf#2666 AS n_nationkey_prf_2#2671, n_name_prf#2667 AS n_name_prf_2#2672, n_comment_prf#2668 AS n_comment_prf_2#2673]
               :  +- Relation[rid#2664,n_regionkey_prf#2665,n_nationkey_prf#2666,n_name_prf#2667,n_comment_prf#2668] JDBCRelation(nation_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#2674]
                  +- DexRidFilter nation~n_name~FRANCE
                     +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 33320ms

fr2e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/16 20:42:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 20:42:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2733L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 20:42:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2733L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#2735 AS c_acctbal_prf_0#2744, rid#2736 AS rid_0#2745, c_name_prf#2737 AS c_name_prf_0#2746, c_nationkey_prf#2738 AS c_nationkey_prf_0#2747, c_custkey_prf#2739 AS c_custkey_prf_0#2748, c_comment_prf#2740 AS c_comment_prf_0#2749, c_address_prf#2741 AS c_address_prf_0#2750, c_mktsegment_prf#2742 AS c_mktsegment_prf_0#2751, c_phone_prf#2743 AS c_phone_prf_0#2752]
         :  :  +- Relation[c_acctbal_prf#2735,rid#2736,c_name_prf#2737,c_nationkey_prf#2738,c_custkey_prf#2739,c_comment_prf#2740,c_address_prf#2741,c_mktsegment_prf#2742,c_phone_prf#2743] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#2763]
         :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2762]
         :        :  +- Relation[c_acctbal_prf#2753,rid#2754,c_name_prf#2755,c_nationkey_prf#2756,c_custkey_prf#2757,c_comment_prf#2758,c_address_prf#2759,c_mktsegment_prf#2760,c_phone_prf#2761] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#2785]
            :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#2775: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#2764 AS o_shippriority_prf_1#2774, rid#2765 AS rid_1#2775, o_orderdate_prf#2766 AS o_orderdate_prf_1#2776, o_custkey_prf#2767 AS o_custkey_prf_1#2777, o_orderpriority_prf#2768 AS o_orderpriority_prf_1#2778, o_clerk_prf#2769 AS o_clerk_prf_1#2779, o_orderstatus_prf#2770 AS o_orderstatus_prf_1#2780, o_totalprice_prf#2771 AS o_totalprice_prf_1#2781, o_orderkey_prf#2772 AS o_orderkey_prf_1#2782, o_comment_prf#2773 AS o_comment_prf_1#2783]
            :     :  :  +- Relation[o_shippriority_prf#2764,rid#2765,o_orderdate_prf#2766,o_custkey_prf#2767,o_orderpriority_prf#2768,o_clerk_prf#2769,o_orderstatus_prf#2770,o_totalprice_prf#2771,o_orderkey_prf#2772,o_comment_prf#2773] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2784]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2786 AS l_returnflag_prf_2#2805, l_orderkey_and_l_linenumber_prf#2787 AS l_orderkey_and_l_linenumber_prf_2#2806, l_comment_prf#2788 AS l_comment_prf_2#2807, l_linestatus_prf#2789 AS l_linestatus_prf_2#2808, rid#2790 AS rid_2#2809, l_shipmode_prf#2791 AS l_shipmode_prf_2#2810, l_shipinstruct_prf#2792 AS l_shipinstruct_prf_2#2811, l_quantity_prf#2793 AS l_quantity_prf_2#2812, l_receiptdate_prf#2794 AS l_receiptdate_prf_2#2813, l_linenumber_prf#2795 AS l_linenumber_prf_2#2814, l_tax_prf#2796 AS l_tax_prf_2#2815, l_shipdate_prf#2797 AS l_shipdate_prf_2#2816, l_extendedprice_prf#2798 AS l_extendedprice_prf_2#2817, l_partkey_prf#2799 AS l_partkey_prf_2#2818, l_discount_prf#2800 AS l_discount_prf_2#2819, l_partkey_and_l_suppkey_prf#2801 AS l_partkey_and_l_suppkey_prf_2#2820, l_commitdate_prf#2802 AS l_commitdate_prf_2#2821, l_suppkey_prf#2803 AS l_suppkey_prf_2#2822, l_orderkey_prf#2804 AS l_orderkey_prf_2#2823]
               +- Relation[l_returnflag_prf#2786,l_orderkey_and_l_linenumber_prf#2787,l_comment_prf#2788,l_linestatus_prf#2789,rid#2790,l_shipmode_prf#2791,l_shipinstruct_prf#2792,l_quantity_prf#2793,l_receiptdate_prf#2794,l_linenumber_prf#2795,l_tax_prf#2796,l_shipdate_prf#2797,l_extendedprice_prf#2798,l_partkey_prf#2799,l_discount_prf#2800,l_partkey_and_l_suppkey_prf#2801,l_commitdate_prf#2802,l_suppkey_prf#2803,l_orderkey_prf#2804] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 96932ms

fq1b=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 20:43:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 20:43:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2902L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 20:43:47 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:43:47 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:43:47 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:43:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2902L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#2934]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#2915]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#2909: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#2904 AS rid_0#2909, n_regionkey_prf#2905 AS n_regionkey_prf_0#2910, n_nationkey_prf#2906 AS n_nationkey_prf_0#2911, n_name_prf#2907 AS n_name_prf_0#2912, n_comment_prf#2908 AS n_comment_prf_0#2913]
         :     :  :     :  :  +- Relation[rid#2904,n_regionkey_prf#2905,n_nationkey_prf#2906,n_name_prf#2907,n_comment_prf#2908] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2914]
         :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :        +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#2916 AS c_acctbal_prf_1#2925, rid#2917 AS rid_1#2926, c_name_prf#2918 AS c_name_prf_1#2927, c_nationkey_prf#2919 AS c_nationkey_prf_1#2928, c_custkey_prf#2920 AS c_custkey_prf_1#2929, c_comment_prf#2921 AS c_comment_prf_1#2930, c_address_prf#2922 AS c_address_prf_1#2931, c_mktsegment_prf#2923 AS c_mktsegment_prf_1#2932, c_phone_prf#2924 AS c_phone_prf_1#2933]
         :     :     +- Relation[c_acctbal_prf#2916,rid#2917,c_name_prf#2918,c_nationkey_prf#2919,c_custkey_prf#2920,c_comment_prf#2921,c_address_prf#2922,c_mktsegment_prf#2923,c_phone_prf#2924] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- Project [o_shippriority_prf#2935 AS o_shippriority_prf_2#2945, rid#2936 AS rid_2#2946, o_orderdate_prf#2937 AS o_orderdate_prf_2#2947, o_custkey_prf#2938 AS o_custkey_prf_2#2948, o_orderpriority_prf#2939 AS o_orderpriority_prf_2#2949, o_clerk_prf#2940 AS o_clerk_prf_2#2950, o_orderstatus_prf#2941 AS o_orderstatus_prf_2#2951, o_totalprice_prf#2942 AS o_totalprice_prf_2#2952, o_orderkey_prf#2943 AS o_orderkey_prf_2#2953, o_comment_prf#2944 AS o_comment_prf_2#2954]
            :  :  +- Relation[o_shippriority_prf#2935,rid#2936,o_orderdate_prf#2937,o_custkey_prf#2938,o_orderpriority_prf#2939,o_clerk_prf#2940,o_orderstatus_prf#2941,o_totalprice_prf#2942,o_orderkey_prf#2943,o_comment_prf#2944] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2158) AS rid_3#2966]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#2965]
            :        :  +- Relation[o_shippriority_prf#2955,rid#2956,o_orderdate_prf#2957,o_custkey_prf#2958,o_orderpriority_prf#2959,o_clerk_prf#2960,o_orderstatus_prf#2961,o_totalprice_prf#2962,o_orderkey_prf#2963,o_comment_prf#2964] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2967 AS l_returnflag_prf_3#2986, l_orderkey_and_l_linenumber_prf#2968 AS l_orderkey_and_l_linenumber_prf_3#2987, l_comment_prf#2969 AS l_comment_prf_3#2988, l_linestatus_prf#2970 AS l_linestatus_prf_3#2989, rid#2971 AS rid_3#2990, l_shipmode_prf#2972 AS l_shipmode_prf_3#2991, l_shipinstruct_prf#2973 AS l_shipinstruct_prf_3#2992, l_quantity_prf#2974 AS l_quantity_prf_3#2993, l_receiptdate_prf#2975 AS l_receiptdate_prf_3#2994, l_linenumber_prf#2976 AS l_linenumber_prf_3#2995, l_tax_prf#2977 AS l_tax_prf_3#2996, l_shipdate_prf#2978 AS l_shipdate_prf_3#2997, l_extendedprice_prf#2979 AS l_extendedprice_prf_3#2998, l_partkey_prf#2980 AS l_partkey_prf_3#2999, l_discount_prf#2981 AS l_discount_prf_3#3000, l_partkey_and_l_suppkey_prf#2982 AS l_partkey_and_l_suppkey_prf_3#3001, l_commitdate_prf#2983 AS l_commitdate_prf_3#3002, l_suppkey_prf#2984 AS l_suppkey_prf_3#3003, l_orderkey_prf#2985 AS l_orderkey_prf_3#3004]
               +- Relation[l_returnflag_prf#2967,l_orderkey_and_l_linenumber_prf#2968,l_comment_prf#2969,l_linestatus_prf#2970,rid#2971,l_shipmode_prf#2972,l_shipinstruct_prf#2973,l_quantity_prf#2974,l_receiptdate_prf#2975,l_linenumber_prf#2976,l_tax_prf#2977,l_shipdate_prf#2978,l_extendedprice_prf#2979,l_partkey_prf#2980,l_discount_prf#2981,l_partkey_and_l_suppkey_prf#2982,l_commitdate_prf#2983,l_suppkey_prf#2984,l_orderkey_prf#2985] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 140720ms

fr1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey and c_mktsegment = 'BUILDING'
19/10/16 20:46:08 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 20:46:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3084L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 20:46:08 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 20:46:08 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 20:46:08 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 20:46:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3084L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [l_returnflag_prf#3086 AS l_returnflag_prf_0#3105, l_orderkey_and_l_linenumber_prf#3087 AS l_orderkey_and_l_linenumber_prf_0#3106, l_comment_prf#3088 AS l_comment_prf_0#3107, l_linestatus_prf#3089 AS l_linestatus_prf_0#3108, rid#3090 AS rid_0#3109, l_shipmode_prf#3091 AS l_shipmode_prf_0#3110, l_shipinstruct_prf#3092 AS l_shipinstruct_prf_0#3111, l_quantity_prf#3093 AS l_quantity_prf_0#3112, l_receiptdate_prf#3094 AS l_receiptdate_prf_0#3113, l_linenumber_prf#3095 AS l_linenumber_prf_0#3114, l_tax_prf#3096 AS l_tax_prf_0#3115, l_shipdate_prf#3097 AS l_shipdate_prf_0#3116, l_extendedprice_prf#3098 AS l_extendedprice_prf_0#3117, l_partkey_prf#3099 AS l_partkey_prf_0#3118, l_discount_prf#3100 AS l_discount_prf_0#3119, l_partkey_and_l_suppkey_prf#3101 AS l_partkey_and_l_suppkey_prf_0#3120, l_commitdate_prf#3102 AS l_commitdate_prf_0#3121, l_suppkey_prf#3103 AS l_suppkey_prf_0#3122, l_orderkey_prf#3104 AS l_orderkey_prf_0#3123]
         :  :  :  :  +- Relation[l_returnflag_prf#3086,l_orderkey_and_l_linenumber_prf#3087,l_comment_prf#3088,l_linestatus_prf#3089,rid#3090,l_shipmode_prf#3091,l_shipinstruct_prf#3092,l_quantity_prf#3093,l_receiptdate_prf#3094,l_linenumber_prf#3095,l_tax_prf#3096,l_shipdate_prf#3097,l_extendedprice_prf#3098,l_partkey_prf#3099,l_discount_prf#3100,l_partkey_and_l_suppkey_prf#3101,l_commitdate_prf#3102,l_suppkey_prf#3103,l_orderkey_prf#3104] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#3144]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#3143]
         :  :  :        :  +- Relation[l_returnflag_prf#3124,l_orderkey_and_l_linenumber_prf#3125,l_comment_prf#3126,l_linestatus_prf#3127,rid#3128,l_shipmode_prf#3129,l_shipinstruct_prf#3130,l_quantity_prf#3131,l_receiptdate_prf#3132,l_linenumber_prf#3133,l_tax_prf#3134,l_shipdate_prf#3135,l_extendedprice_prf#3136,l_partkey_prf#3137,l_discount_prf#3138,l_partkey_and_l_suppkey_prf#3139,l_commitdate_prf#3140,l_suppkey_prf#3141,l_orderkey_prf#3142] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#3145 AS o_shippriority_prf_1#3155, rid#3146 AS rid_1#3156, o_orderdate_prf#3147 AS o_orderdate_prf_1#3157, o_custkey_prf#3148 AS o_custkey_prf_1#3158, o_orderpriority_prf#3149 AS o_orderpriority_prf_1#3159, o_clerk_prf#3150 AS o_clerk_prf_1#3160, o_orderstatus_prf#3151 AS o_orderstatus_prf_1#3161, o_totalprice_prf#3152 AS o_totalprice_prf_1#3162, o_orderkey_prf#3153 AS o_orderkey_prf_1#3163, o_comment_prf#3154 AS o_comment_prf_1#3164]
         :  :     +- Relation[o_shippriority_prf#3145,rid#3146,o_orderdate_prf#3147,o_custkey_prf#3148,o_orderpriority_prf#3149,o_clerk_prf#3150,o_orderstatus_prf#3151,o_totalprice_prf#3152,o_orderkey_prf#3153,o_comment_prf#3154] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#3176]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3175]
         :        :  +- Relation[o_shippriority_prf#3165,rid#3166,o_orderdate_prf#3167,o_custkey_prf#3168,o_orderpriority_prf#3169,o_clerk_prf#3170,o_orderstatus_prf#3171,o_totalprice_prf#3172,o_orderkey_prf#3173,o_comment_prf#3174] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_2))
            :- Project [c_acctbal_prf#3177 AS c_acctbal_prf_2#3186, rid#3178 AS rid_2#3187, c_name_prf#3179 AS c_name_prf_2#3188, c_nationkey_prf#3180 AS c_nationkey_prf_2#3189, c_custkey_prf#3181 AS c_custkey_prf_2#3190, c_comment_prf#3182 AS c_comment_prf_2#3191, c_address_prf#3183 AS c_address_prf_2#3192, c_mktsegment_prf#3184 AS c_mktsegment_prf_2#3193, c_phone_prf#3185 AS c_phone_prf_2#3194]
            :  +- Relation[c_acctbal_prf#3177,rid#3178,c_name_prf#3179,c_nationkey_prf#3180,c_custkey_prf#3181,c_comment_prf#3182,c_address_prf#3183,c_mktsegment_prf#3184,c_phone_prf#3185] JDBCRelation(customer_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#3195]
               +- DexRidFilter customer~c_mktsegment~BUILDING
                  +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 120922ms

fs1a=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/16 20:48:09 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 20:48:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3279L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [c_custkey#290L]
         :     :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L]
         :        +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/16 20:48:09 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 20:48:09 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 20:48:09 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 20:48:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3279L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, 'rid_2, 'l_returnflag_prf_2, 'l_orderkey_and_l_linenumber_prf_2, 'l_comment_prf_2, 'l_linestatus_prf_2, ... 15 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#3321]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#3300]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3291: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [c_acctbal_prf#3281 AS c_acctbal_prf_0#3290, rid#3282 AS rid_0#3291, c_name_prf#3283 AS c_name_prf_0#3292, c_nationkey_prf#3284 AS c_nationkey_prf_0#3293, c_custkey_prf#3285 AS c_custkey_prf_0#3294, c_comment_prf#3286 AS c_comment_prf_0#3295, c_address_prf#3287 AS c_address_prf_0#3296, c_mktsegment_prf#3288 AS c_mktsegment_prf_0#3297, c_phone_prf#3289 AS c_phone_prf_0#3298]
         :     :  :     :  :     :  :  +- Relation[c_acctbal_prf#3281,rid#3282,c_name_prf#3283,c_nationkey_prf#3284,c_custkey_prf#3285,c_comment_prf#3286,c_address_prf#3287,c_mktsegment_prf#3288,c_phone_prf#3289] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3299]
         :     :  :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :  :     :        +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [o_shippriority_prf#3301 AS o_shippriority_prf_1#3311, rid#3302 AS rid_1#3312, o_orderdate_prf#3303 AS o_orderdate_prf_1#3313, o_custkey_prf#3304 AS o_custkey_prf_1#3314, o_orderpriority_prf#3305 AS o_orderpriority_prf_1#3315, o_clerk_prf#3306 AS o_clerk_prf_1#3316, o_orderstatus_prf#3307 AS o_orderstatus_prf_1#3317, o_totalprice_prf#3308 AS o_totalprice_prf_1#3318, o_orderkey_prf#3309 AS o_orderkey_prf_1#3319, o_comment_prf#3310 AS o_comment_prf_1#3320]
         :     :  :     :     +- Relation[o_shippriority_prf#3301,rid#3302,o_orderdate_prf#3303,o_custkey_prf#3304,o_orderpriority_prf#3305,o_clerk_prf#3306,o_orderstatus_prf#3307,o_totalprice_prf#3308,o_orderkey_prf#3309,o_comment_prf#3310] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#3322 AS l_returnflag_prf_2#3341, l_orderkey_and_l_linenumber_prf#3323 AS l_orderkey_and_l_linenumber_prf_2#3342, l_comment_prf#3324 AS l_comment_prf_2#3343, l_linestatus_prf#3325 AS l_linestatus_prf_2#3344, rid#3326 AS rid_2#3345, l_shipmode_prf#3327 AS l_shipmode_prf_2#3346, l_shipinstruct_prf#3328 AS l_shipinstruct_prf_2#3347, l_quantity_prf#3329 AS l_quantity_prf_2#3348, l_receiptdate_prf#3330 AS l_receiptdate_prf_2#3349, l_linenumber_prf#3331 AS l_linenumber_prf_2#3350, l_tax_prf#3332 AS l_tax_prf_2#3351, l_shipdate_prf#3333 AS l_shipdate_prf_2#3352, l_extendedprice_prf#3334 AS l_extendedprice_prf_2#3353, l_partkey_prf#3335 AS l_partkey_prf_2#3354, l_discount_prf#3336 AS l_discount_prf_2#3355, l_partkey_and_l_suppkey_prf#3337 AS l_partkey_and_l_suppkey_prf_2#3356, l_commitdate_prf#3338 AS l_commitdate_prf_2#3357, l_suppkey_prf#3339 AS l_suppkey_prf_2#3358, l_orderkey_prf#3340 AS l_orderkey_prf_2#3359]
         :     :     +- Relation[l_returnflag_prf#3322,l_orderkey_and_l_linenumber_prf#3323,l_comment_prf#3324,l_linestatus_prf#3325,rid#3326,l_shipmode_prf#3327,l_shipinstruct_prf#3328,l_quantity_prf#3329,l_receiptdate_prf#3330,l_linenumber_prf#3331,l_tax_prf#3332,l_shipdate_prf#3333,l_extendedprice_prf#3334,l_partkey_prf#3335,l_discount_prf#3336,l_partkey_and_l_suppkey_prf#3337,l_commitdate_prf#3338,l_suppkey_prf#3339,l_orderkey_prf#3340] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#3361 AS p_comment_prf_3#3371, p_name_prf#3362 AS p_name_prf_3#3372, rid#3363 AS rid_3#3373, p_type_prf#3364 AS p_type_prf_3#3374, p_retailprice_prf#3365 AS p_retailprice_prf_3#3375, p_mfgr_prf#3366 AS p_mfgr_prf_3#3376, p_container_prf#3367 AS p_container_prf_3#3377, p_brand_prf#3368 AS p_brand_prf_3#3378, p_size_prf#3369 AS p_size_prf_3#3379, p_partkey_prf#3370 AS p_partkey_prf_3#3380]
            +- Relation[p_comment_prf#3361,p_name_prf#3362,rid#3363,p_type_prf#3364,p_retailprice_prf#3365,p_mfgr_prf#3366,p_container_prf#3367,p_brand_prf#3368,p_size_prf#3369,p_partkey_prf#3370] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 108382ms

ft1d=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/16 20:49:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 20:49:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3451L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_nationkey#21L]
                  +- Filter isnotnull(s_nationkey#21L)
                     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 20:49:57 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:49:57 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:49:57 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:49:57 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:49:57 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 20:49:57 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 20:49:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3451L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#3453 AS c_acctbal_prf_0#3462, rid#3454 AS rid_0#3463, c_name_prf#3455 AS c_name_prf_0#3464, c_nationkey_prf#3456 AS c_nationkey_prf_0#3465, c_custkey_prf#3457 AS c_custkey_prf_0#3466, c_comment_prf#3458 AS c_comment_prf_0#3467, c_address_prf#3459 AS c_address_prf_0#3468, c_mktsegment_prf#3460 AS c_mktsegment_prf_0#3469, c_phone_prf#3461 AS c_phone_prf_0#3470]
         :  :  +- Relation[c_acctbal_prf#3453,rid#3454,c_name_prf#3455,c_nationkey_prf#3456,c_custkey_prf#3457,c_comment_prf#3458,c_address_prf#3459,c_mktsegment_prf#3460,c_phone_prf#3461] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#3481]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3480]
         :        :  +- Relation[c_acctbal_prf#3471,rid#3472,c_name_prf#3473,c_nationkey_prf#3474,c_custkey_prf#3475,c_comment_prf#3476,c_address_prf#3477,c_mktsegment_prf#3478,c_phone_prf#3479] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#3493]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_1#3487: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [rid#3482 AS rid_1#3487, n_regionkey_prf#3483 AS n_regionkey_prf_1#3488, n_nationkey_prf#3484 AS n_nationkey_prf_1#3489, n_name_prf#3485 AS n_name_prf_1#3490, n_comment_prf#3486 AS n_comment_prf_1#3491]
            :     :  :  +- Relation[rid#3482,n_regionkey_prf#3483,n_nationkey_prf#3484,n_name_prf#3485,n_comment_prf#3486] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3492]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [s_phone_prf#3494 AS s_phone_prf_2#3502, rid#3495 AS rid_2#3503, s_address_prf#3496 AS s_address_prf_2#3504, s_nationkey_prf#3497 AS s_nationkey_prf_2#3505, s_suppkey_prf#3498 AS s_suppkey_prf_2#3506, s_name_prf#3499 AS s_name_prf_2#3507, s_acctbal_prf#3500 AS s_acctbal_prf_2#3508, s_comment_prf#3501 AS s_comment_prf_2#3509]
               +- Relation[s_phone_prf#3494,rid#3495,s_address_prf#3496,s_nationkey_prf#3497,s_suppkey_prf#3498,s_name_prf#3499,s_acctbal_prf#3500,s_comment_prf#3501] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 24089ms

ft3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and p_size = 15 and l_suppkey = s_suppkey
19/10/16 20:50:21 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 20:50:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3567L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 20:50:21 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 20:50:21 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 20:50:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3567L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, rid_0#3592: string
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [l_returnflag_prf#3569 AS l_returnflag_prf_0#3588, l_orderkey_and_l_linenumber_prf#3570 AS l_orderkey_and_l_linenumber_prf_0#3589, l_comment_prf#3571 AS l_comment_prf_0#3590, l_linestatus_prf#3572 AS l_linestatus_prf_0#3591, rid#3573 AS rid_0#3592, l_shipmode_prf#3574 AS l_shipmode_prf_0#3593, l_shipinstruct_prf#3575 AS l_shipinstruct_prf_0#3594, l_quantity_prf#3576 AS l_quantity_prf_0#3595, l_receiptdate_prf#3577 AS l_receiptdate_prf_0#3596, l_linenumber_prf#3578 AS l_linenumber_prf_0#3597, l_tax_prf#3579 AS l_tax_prf_0#3598, l_shipdate_prf#3580 AS l_shipdate_prf_0#3599, l_extendedprice_prf#3581 AS l_extendedprice_prf_0#3600, l_partkey_prf#3582 AS l_partkey_prf_0#3601, l_discount_prf#3583 AS l_discount_prf_0#3602, l_partkey_and_l_suppkey_prf#3584 AS l_partkey_and_l_suppkey_prf_0#3603, l_commitdate_prf#3585 AS l_commitdate_prf_0#3604, l_suppkey_prf#3586 AS l_suppkey_prf_0#3605, l_orderkey_prf#3587 AS l_orderkey_prf_0#3606]
         :     :  :  :  +- Relation[l_returnflag_prf#3569,l_orderkey_and_l_linenumber_prf#3570,l_comment_prf#3571,l_linestatus_prf#3572,rid#3573,l_shipmode_prf#3574,l_shipinstruct_prf#3575,l_quantity_prf#3576,l_receiptdate_prf#3577,l_linenumber_prf#3578,l_tax_prf#3579,l_shipdate_prf#3580,l_extendedprice_prf#3581,l_partkey_prf#3582,l_discount_prf#3583,l_partkey_and_l_suppkey_prf#3584,l_commitdate_prf#3585,l_suppkey_prf#3586,l_orderkey_prf#3587] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#3627]
         :     :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#3626]
         :     :  :        :  +- Relation[l_returnflag_prf#3607,l_orderkey_and_l_linenumber_prf#3608,l_comment_prf#3609,l_linestatus_prf#3610,rid#3611,l_shipmode_prf#3612,l_shipinstruct_prf#3613,l_quantity_prf#3614,l_receiptdate_prf#3615,l_linenumber_prf#3616,l_tax_prf#3617,l_shipdate_prf#3618,l_extendedprice_prf#3619,l_partkey_prf#3620,l_discount_prf#3621,l_partkey_and_l_suppkey_prf#3622,l_commitdate_prf#3623,l_suppkey_prf#3624,l_orderkey_prf#3625] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [p_comment_prf#3628 AS p_comment_prf_1#3638, p_name_prf#3629 AS p_name_prf_1#3639, rid#3630 AS rid_1#3640, p_type_prf#3631 AS p_type_prf_1#3641, p_retailprice_prf#3632 AS p_retailprice_prf_1#3642, p_mfgr_prf#3633 AS p_mfgr_prf_1#3643, p_container_prf#3634 AS p_container_prf_1#3644, p_brand_prf#3635 AS p_brand_prf_1#3645, p_size_prf#3636 AS p_size_prf_1#3646, p_partkey_prf#3637 AS p_partkey_prf_1#3647]
         :     :     :  +- Relation[p_comment_prf#3628,p_name_prf#3629,rid#3630,p_type_prf#3631,p_retailprice_prf#3632,p_mfgr_prf#3633,p_container_prf#3634,p_brand_prf#3635,p_size_prf#3636,p_partkey_prf#3637] JDBCRelation(part_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3648]
         :     :        +- DexRidFilter part~p_size~15
         :     :           +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3650 AS s_phone_prf_2#3658, rid#3651 AS rid_2#3659, s_address_prf#3652 AS s_address_prf_2#3660, s_nationkey_prf#3653 AS s_nationkey_prf_2#3661, s_suppkey_prf#3654 AS s_suppkey_prf_2#3662, s_name_prf#3655 AS s_name_prf_2#3663, s_acctbal_prf#3656 AS s_acctbal_prf_2#3664, s_comment_prf#3657 AS s_comment_prf_2#3665]
            +- Relation[s_phone_prf#3650,rid#3651,s_address_prf#3652,s_nationkey_prf#3653,s_suppkey_prf#3654,s_name_prf#3655,s_acctbal_prf#3656,s_comment_prf#3657] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 96349ms

fq1d=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 20:51:58 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 20:51:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3743L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :     :- Project [n_nationkey#108L]
               :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
               :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 20:51:58 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:51:58 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:51:58 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:51:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3743L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#3745 AS l_returnflag_prf_0#3764, l_orderkey_and_l_linenumber_prf#3746 AS l_orderkey_and_l_linenumber_prf_0#3765, l_comment_prf#3747 AS l_comment_prf_0#3766, l_linestatus_prf#3748 AS l_linestatus_prf_0#3767, rid#3749 AS rid_0#3768, l_shipmode_prf#3750 AS l_shipmode_prf_0#3769, l_shipinstruct_prf#3751 AS l_shipinstruct_prf_0#3770, l_quantity_prf#3752 AS l_quantity_prf_0#3771, l_receiptdate_prf#3753 AS l_receiptdate_prf_0#3772, l_linenumber_prf#3754 AS l_linenumber_prf_0#3773, l_tax_prf#3755 AS l_tax_prf_0#3774, l_shipdate_prf#3756 AS l_shipdate_prf_0#3775, l_extendedprice_prf#3757 AS l_extendedprice_prf_0#3776, l_partkey_prf#3758 AS l_partkey_prf_0#3777, l_discount_prf#3759 AS l_discount_prf_0#3778, l_partkey_and_l_suppkey_prf#3760 AS l_partkey_and_l_suppkey_prf_0#3779, l_commitdate_prf#3761 AS l_commitdate_prf_0#3780, l_suppkey_prf#3762 AS l_suppkey_prf_0#3781, l_orderkey_prf#3763 AS l_orderkey_prf_0#3782]
         :  :  +- Relation[l_returnflag_prf#3745,l_orderkey_and_l_linenumber_prf#3746,l_comment_prf#3747,l_linestatus_prf#3748,rid#3749,l_shipmode_prf#3750,l_shipinstruct_prf#3751,l_quantity_prf#3752,l_receiptdate_prf#3753,l_linenumber_prf#3754,l_tax_prf#3755,l_shipdate_prf#3756,l_extendedprice_prf#3757,l_partkey_prf#3758,l_discount_prf#3759,l_partkey_and_l_suppkey_prf#3760,l_commitdate_prf#3761,l_suppkey_prf#3762,l_orderkey_prf#3763] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2158) AS rid_3#3803]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3802]
         :        :  +- Relation[l_returnflag_prf#3783,l_orderkey_and_l_linenumber_prf#3784,l_comment_prf#3785,l_linestatus_prf#3786,rid#3787,l_shipmode_prf#3788,l_shipinstruct_prf#3789,l_quantity_prf#3790,l_receiptdate_prf#3791,l_linenumber_prf#3792,l_tax_prf#3793,l_shipdate_prf#3794,l_extendedprice_prf#3795,l_partkey_prf#3796,l_discount_prf#3797,l_partkey_and_l_suppkey_prf#3798,l_commitdate_prf#3799,l_suppkey_prf#3800,l_orderkey_prf#3801] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, 'rid_2, 'c_acctbal_prf_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2158) AS rid_3#3834]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_2
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#3815]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_1#3809: string
            :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :     :  :- Project [rid#3804 AS rid_1#3809, n_regionkey_prf#3805 AS n_regionkey_prf_1#3810, n_nationkey_prf#3806 AS n_nationkey_prf_1#3811, n_name_prf#3807 AS n_name_prf_1#3812, n_comment_prf#3808 AS n_comment_prf_1#3813]
            :     :  :     :  :  +- Relation[rid#3804,n_regionkey_prf#3805,n_nationkey_prf#3806,n_name_prf#3807,n_comment_prf#3808] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3814]
            :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :  :     :        +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [c_acctbal_prf#3816 AS c_acctbal_prf_2#3825, rid#3817 AS rid_2#3826, c_name_prf#3818 AS c_name_prf_2#3827, c_nationkey_prf#3819 AS c_nationkey_prf_2#3828, c_custkey_prf#3820 AS c_custkey_prf_2#3829, c_comment_prf#3821 AS c_comment_prf_2#3830, c_address_prf#3822 AS c_address_prf_2#3831, c_mktsegment_prf#3823 AS c_mktsegment_prf_2#3832, c_phone_prf#3824 AS c_phone_prf_2#3833]
            :     :     +- Relation[c_acctbal_prf#3816,rid#3817,c_name_prf#3818,c_nationkey_prf#3819,c_custkey_prf#3820,c_comment_prf#3821,c_address_prf#3822,c_mktsegment_prf#3823,c_phone_prf#3824] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3835 AS o_shippriority_prf_3#3845, rid#3836 AS rid_3#3846, o_orderdate_prf#3837 AS o_orderdate_prf_3#3847, o_custkey_prf#3838 AS o_custkey_prf_3#3848, o_orderpriority_prf#3839 AS o_orderpriority_prf_3#3849, o_clerk_prf#3840 AS o_clerk_prf_3#3850, o_orderstatus_prf#3841 AS o_orderstatus_prf_3#3851, o_totalprice_prf#3842 AS o_totalprice_prf_3#3852, o_orderkey_prf#3843 AS o_orderkey_prf_3#3853, o_comment_prf#3844 AS o_comment_prf_3#3854]
               +- Relation[o_shippriority_prf#3835,rid#3836,o_orderdate_prf#3837,o_custkey_prf#3838,o_orderpriority_prf#3839,o_clerk_prf#3840,o_orderstatus_prf#3841,o_totalprice_prf#3842,o_orderkey_prf#3843,o_comment_prf#3844] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 74498ms

fr2b=
select * from lineitem, orders, customer where o_custkey = c_custkey and o_orderstatus = 'F' and l_orderkey = o_orderkey
19/10/16 20:53:12 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 20:53:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3934L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 20:53:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3934L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#3936 AS l_returnflag_prf_0#3955, l_orderkey_and_l_linenumber_prf#3937 AS l_orderkey_and_l_linenumber_prf_0#3956, l_comment_prf#3938 AS l_comment_prf_0#3957, l_linestatus_prf#3939 AS l_linestatus_prf_0#3958, rid#3940 AS rid_0#3959, l_shipmode_prf#3941 AS l_shipmode_prf_0#3960, l_shipinstruct_prf#3942 AS l_shipinstruct_prf_0#3961, l_quantity_prf#3943 AS l_quantity_prf_0#3962, l_receiptdate_prf#3944 AS l_receiptdate_prf_0#3963, l_linenumber_prf#3945 AS l_linenumber_prf_0#3964, l_tax_prf#3946 AS l_tax_prf_0#3965, l_shipdate_prf#3947 AS l_shipdate_prf_0#3966, l_extendedprice_prf#3948 AS l_extendedprice_prf_0#3967, l_partkey_prf#3949 AS l_partkey_prf_0#3968, l_discount_prf#3950 AS l_discount_prf_0#3969, l_partkey_and_l_suppkey_prf#3951 AS l_partkey_and_l_suppkey_prf_0#3970, l_commitdate_prf#3952 AS l_commitdate_prf_0#3971, l_suppkey_prf#3953 AS l_suppkey_prf_0#3972, l_orderkey_prf#3954 AS l_orderkey_prf_0#3973]
         :  :  +- Relation[l_returnflag_prf#3936,l_orderkey_and_l_linenumber_prf#3937,l_comment_prf#3938,l_linestatus_prf#3939,rid#3940,l_shipmode_prf#3941,l_shipinstruct_prf#3942,l_quantity_prf#3943,l_receiptdate_prf#3944,l_linenumber_prf#3945,l_tax_prf#3946,l_shipdate_prf#3947,l_extendedprice_prf#3948,l_partkey_prf#3949,l_discount_prf#3950,l_partkey_and_l_suppkey_prf#3951,l_commitdate_prf#3952,l_suppkey_prf#3953,l_orderkey_prf#3954] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#3994]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3993]
         :        :  +- Relation[l_returnflag_prf#3974,l_orderkey_and_l_linenumber_prf#3975,l_comment_prf#3976,l_linestatus_prf#3977,rid#3978,l_shipmode_prf#3979,l_shipinstruct_prf#3980,l_quantity_prf#3981,l_receiptdate_prf#3982,l_linenumber_prf#3983,l_tax_prf#3984,l_shipdate_prf#3985,l_extendedprice_prf#3986,l_partkey_prf#3987,l_discount_prf#3988,l_partkey_and_l_suppkey_prf#3989,l_commitdate_prf#3990,l_suppkey_prf#3991,l_orderkey_prf#3992] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#4016]
            :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#4006: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#3995 AS o_shippriority_prf_1#4005, rid#3996 AS rid_1#4006, o_orderdate_prf#3997 AS o_orderdate_prf_1#4007, o_custkey_prf#3998 AS o_custkey_prf_1#4008, o_orderpriority_prf#3999 AS o_orderpriority_prf_1#4009, o_clerk_prf#4000 AS o_clerk_prf_1#4010, o_orderstatus_prf#4001 AS o_orderstatus_prf_1#4011, o_totalprice_prf#4002 AS o_totalprice_prf_1#4012, o_orderkey_prf#4003 AS o_orderkey_prf_1#4013, o_comment_prf#4004 AS o_comment_prf_1#4014]
            :     :  :  +- Relation[o_shippriority_prf#3995,rid#3996,o_orderdate_prf#3997,o_custkey_prf#3998,o_orderpriority_prf#3999,o_clerk_prf#4000,o_orderstatus_prf#4001,o_totalprice_prf#4002,o_orderkey_prf#4003,o_comment_prf#4004] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4015]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4017 AS c_acctbal_prf_2#4026, rid#4018 AS rid_2#4027, c_name_prf#4019 AS c_name_prf_2#4028, c_nationkey_prf#4020 AS c_nationkey_prf_2#4029, c_custkey_prf#4021 AS c_custkey_prf_2#4030, c_comment_prf#4022 AS c_comment_prf_2#4031, c_address_prf#4023 AS c_address_prf_2#4032, c_mktsegment_prf#4024 AS c_mktsegment_prf_2#4033, c_phone_prf#4025 AS c_phone_prf_2#4034]
               +- Relation[c_acctbal_prf#4017,rid#4018,c_name_prf#4019,c_nationkey_prf#4020,c_custkey_prf#4021,c_comment_prf#4022,c_address_prf#4023,c_mktsegment_prf#4024,c_phone_prf#4025] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 105315ms

fr1e=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and (o_orderkey = l_orderkey and c_custkey = o_custkey)
19/10/16 20:54:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 20:54:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4109L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 20:54:57 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 20:54:57 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 20:54:57 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 20:54:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4109L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#4130]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4121: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [c_acctbal_prf#4111 AS c_acctbal_prf_0#4120, rid#4112 AS rid_0#4121, c_name_prf#4113 AS c_name_prf_0#4122, c_nationkey_prf#4114 AS c_nationkey_prf_0#4123, c_custkey_prf#4115 AS c_custkey_prf_0#4124, c_comment_prf#4116 AS c_comment_prf_0#4125, c_address_prf#4117 AS c_address_prf_0#4126, c_mktsegment_prf#4118 AS c_mktsegment_prf_0#4127, c_phone_prf#4119 AS c_phone_prf_0#4128]
         :     :  :  +- Relation[c_acctbal_prf#4111,rid#4112,c_name_prf#4113,c_nationkey_prf#4114,c_custkey_prf#4115,c_comment_prf#4116,c_address_prf#4117,c_mktsegment_prf#4118,c_phone_prf#4119] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4129]
         :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :        +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [o_shippriority_prf#4131 AS o_shippriority_prf_1#4141, rid#4132 AS rid_1#4142, o_orderdate_prf#4133 AS o_orderdate_prf_1#4143, o_custkey_prf#4134 AS o_custkey_prf_1#4144, o_orderpriority_prf#4135 AS o_orderpriority_prf_1#4145, o_clerk_prf#4136 AS o_clerk_prf_1#4146, o_orderstatus_prf#4137 AS o_orderstatus_prf_1#4147, o_totalprice_prf#4138 AS o_totalprice_prf_1#4148, o_orderkey_prf#4139 AS o_orderkey_prf_1#4149, o_comment_prf#4140 AS o_comment_prf_1#4150]
            :  :  +- Relation[o_shippriority_prf#4131,rid#4132,o_orderdate_prf#4133,o_custkey_prf#4134,o_orderpriority_prf#4135,o_clerk_prf#4136,o_orderstatus_prf#4137,o_totalprice_prf#4138,o_orderkey_prf#4139,o_comment_prf#4140] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#4162]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#4161]
            :        :  +- Relation[o_shippriority_prf#4151,rid#4152,o_orderdate_prf#4153,o_custkey_prf#4154,o_orderpriority_prf#4155,o_clerk_prf#4156,o_orderstatus_prf#4157,o_totalprice_prf#4158,o_orderkey_prf#4159,o_comment_prf#4160] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4163 AS l_returnflag_prf_2#4182, l_orderkey_and_l_linenumber_prf#4164 AS l_orderkey_and_l_linenumber_prf_2#4183, l_comment_prf#4165 AS l_comment_prf_2#4184, l_linestatus_prf#4166 AS l_linestatus_prf_2#4185, rid#4167 AS rid_2#4186, l_shipmode_prf#4168 AS l_shipmode_prf_2#4187, l_shipinstruct_prf#4169 AS l_shipinstruct_prf_2#4188, l_quantity_prf#4170 AS l_quantity_prf_2#4189, l_receiptdate_prf#4171 AS l_receiptdate_prf_2#4190, l_linenumber_prf#4172 AS l_linenumber_prf_2#4191, l_tax_prf#4173 AS l_tax_prf_2#4192, l_shipdate_prf#4174 AS l_shipdate_prf_2#4193, l_extendedprice_prf#4175 AS l_extendedprice_prf_2#4194, l_partkey_prf#4176 AS l_partkey_prf_2#4195, l_discount_prf#4177 AS l_discount_prf_2#4196, l_partkey_and_l_suppkey_prf#4178 AS l_partkey_and_l_suppkey_prf_2#4197, l_commitdate_prf#4179 AS l_commitdate_prf_2#4198, l_suppkey_prf#4180 AS l_suppkey_prf_2#4199, l_orderkey_prf#4181 AS l_orderkey_prf_2#4200]
               +- Relation[l_returnflag_prf#4163,l_orderkey_and_l_linenumber_prf#4164,l_comment_prf#4165,l_linestatus_prf#4166,rid#4167,l_shipmode_prf#4168,l_shipinstruct_prf#4169,l_quantity_prf#4170,l_receiptdate_prf#4171,l_linenumber_prf#4172,l_tax_prf#4173,l_shipdate_prf#4174,l_extendedprice_prf#4175,l_partkey_prf#4176,l_discount_prf#4177,l_partkey_and_l_suppkey_prf#4178,l_commitdate_prf#4179,l_suppkey_prf#4180,l_orderkey_prf#4181] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 152475ms

fq1a=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 20:57:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 20:57:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4279L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :     :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 20:57:30 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:57:30 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:57:30 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:57:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4279L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, 'rid_2, 'o_shippriority_prf_2, 'o_orderdate_prf_2, 'o_custkey_prf_2, 'o_orderpriority_prf_2, 'o_clerk_prf_2, 'o_orderstatus_prf_2, 'o_totalprice_prf_2, 'o_orderkey_prf_2, 'o_comment_prf_2, dexdecrypt('value_dec_key, value#2158) AS rid_3#4332]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#4311]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#4292]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#4286: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [rid#4281 AS rid_0#4286, n_regionkey_prf#4282 AS n_regionkey_prf_0#4287, n_nationkey_prf#4283 AS n_nationkey_prf_0#4288, n_name_prf#4284 AS n_name_prf_0#4289, n_comment_prf#4285 AS n_comment_prf_0#4290]
         :     :  :     :  :     :  :  +- Relation[rid#4281,n_regionkey_prf#4282,n_nationkey_prf#4283,n_name_prf#4284,n_comment_prf#4285] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4291]
         :     :  :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :  :     :        +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [c_acctbal_prf#4293 AS c_acctbal_prf_1#4302, rid#4294 AS rid_1#4303, c_name_prf#4295 AS c_name_prf_1#4304, c_nationkey_prf#4296 AS c_nationkey_prf_1#4305, c_custkey_prf#4297 AS c_custkey_prf_1#4306, c_comment_prf#4298 AS c_comment_prf_1#4307, c_address_prf#4299 AS c_address_prf_1#4308, c_mktsegment_prf#4300 AS c_mktsegment_prf_1#4309, c_phone_prf#4301 AS c_phone_prf_1#4310]
         :     :  :     :     +- Relation[c_acctbal_prf#4293,rid#4294,c_name_prf#4295,c_nationkey_prf#4296,c_custkey_prf#4297,c_comment_prf#4298,c_address_prf#4299,c_mktsegment_prf#4300,c_phone_prf#4301] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#4312 AS o_shippriority_prf_2#4322, rid#4313 AS rid_2#4323, o_orderdate_prf#4314 AS o_orderdate_prf_2#4324, o_custkey_prf#4315 AS o_custkey_prf_2#4325, o_orderpriority_prf#4316 AS o_orderpriority_prf_2#4326, o_clerk_prf#4317 AS o_clerk_prf_2#4327, o_orderstatus_prf#4318 AS o_orderstatus_prf_2#4328, o_totalprice_prf#4319 AS o_totalprice_prf_2#4329, o_orderkey_prf#4320 AS o_orderkey_prf_2#4330, o_comment_prf#4321 AS o_comment_prf_2#4331]
         :     :     +- Relation[o_shippriority_prf#4312,rid#4313,o_orderdate_prf#4314,o_custkey_prf#4315,o_orderpriority_prf#4316,o_clerk_prf#4317,o_orderstatus_prf#4318,o_totalprice_prf#4319,o_orderkey_prf#4320,o_comment_prf#4321] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4333 AS l_returnflag_prf_3#4352, l_orderkey_and_l_linenumber_prf#4334 AS l_orderkey_and_l_linenumber_prf_3#4353, l_comment_prf#4335 AS l_comment_prf_3#4354, l_linestatus_prf#4336 AS l_linestatus_prf_3#4355, rid#4337 AS rid_3#4356, l_shipmode_prf#4338 AS l_shipmode_prf_3#4357, l_shipinstruct_prf#4339 AS l_shipinstruct_prf_3#4358, l_quantity_prf#4340 AS l_quantity_prf_3#4359, l_receiptdate_prf#4341 AS l_receiptdate_prf_3#4360, l_linenumber_prf#4342 AS l_linenumber_prf_3#4361, l_tax_prf#4343 AS l_tax_prf_3#4362, l_shipdate_prf#4344 AS l_shipdate_prf_3#4363, l_extendedprice_prf#4345 AS l_extendedprice_prf_3#4364, l_partkey_prf#4346 AS l_partkey_prf_3#4365, l_discount_prf#4347 AS l_discount_prf_3#4366, l_partkey_and_l_suppkey_prf#4348 AS l_partkey_and_l_suppkey_prf_3#4367, l_commitdate_prf#4349 AS l_commitdate_prf_3#4368, l_suppkey_prf#4350 AS l_suppkey_prf_3#4369, l_orderkey_prf#4351 AS l_orderkey_prf_3#4370]
            +- Relation[l_returnflag_prf#4333,l_orderkey_and_l_linenumber_prf#4334,l_comment_prf#4335,l_linestatus_prf#4336,rid#4337,l_shipmode_prf#4338,l_shipinstruct_prf#4339,l_quantity_prf#4340,l_receiptdate_prf#4341,l_linenumber_prf#4342,l_tax_prf#4343,l_shipdate_prf#4344,l_extendedprice_prf#4345,l_partkey_prf#4346,l_discount_prf#4347,l_partkey_and_l_suppkey_prf#4348,l_commitdate_prf#4349,l_suppkey_prf#4350,l_orderkey_prf#4351] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 30949ms

fr2f=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/16 20:58:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 20:58:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4450L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_orderkey#342L, o_custkey#343L]
         :     :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L]
         :        +- Filter isnotnull(c_custkey#290L)
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 20:58:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4450L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#4492]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#4473]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_0#4463: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [o_shippriority_prf#4452 AS o_shippriority_prf_0#4462, rid#4453 AS rid_0#4463, o_orderdate_prf#4454 AS o_orderdate_prf_0#4464, o_custkey_prf#4455 AS o_custkey_prf_0#4465, o_orderpriority_prf#4456 AS o_orderpriority_prf_0#4466, o_clerk_prf#4457 AS o_clerk_prf_0#4467, o_orderstatus_prf#4458 AS o_orderstatus_prf_0#4468, o_totalprice_prf#4459 AS o_totalprice_prf_0#4469, o_orderkey_prf#4460 AS o_orderkey_prf_0#4470, o_comment_prf#4461 AS o_comment_prf_0#4471]
         :     :  :     :  :  +- Relation[o_shippriority_prf#4452,rid#4453,o_orderdate_prf#4454,o_custkey_prf#4455,o_orderpriority_prf#4456,o_clerk_prf#4457,o_orderstatus_prf#4458,o_totalprice_prf#4459,o_orderkey_prf#4460,o_comment_prf#4461] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4472]
         :     :  :     :     +- DexRidFilter orders~o_orderstatus~F
         :     :  :     :        +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#4474 AS c_acctbal_prf_1#4483, rid#4475 AS rid_1#4484, c_name_prf#4476 AS c_name_prf_1#4485, c_nationkey_prf#4477 AS c_nationkey_prf_1#4486, c_custkey_prf#4478 AS c_custkey_prf_1#4487, c_comment_prf#4479 AS c_comment_prf_1#4488, c_address_prf#4480 AS c_address_prf_1#4489, c_mktsegment_prf#4481 AS c_mktsegment_prf_1#4490, c_phone_prf#4482 AS c_phone_prf_1#4491]
         :     :     +- Relation[c_acctbal_prf#4474,rid#4475,c_name_prf#4476,c_nationkey_prf#4477,c_custkey_prf#4478,c_comment_prf#4479,c_address_prf#4480,c_mktsegment_prf#4481,c_phone_prf#4482] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4493 AS l_returnflag_prf_2#4512, l_orderkey_and_l_linenumber_prf#4494 AS l_orderkey_and_l_linenumber_prf_2#4513, l_comment_prf#4495 AS l_comment_prf_2#4514, l_linestatus_prf#4496 AS l_linestatus_prf_2#4515, rid#4497 AS rid_2#4516, l_shipmode_prf#4498 AS l_shipmode_prf_2#4517, l_shipinstruct_prf#4499 AS l_shipinstruct_prf_2#4518, l_quantity_prf#4500 AS l_quantity_prf_2#4519, l_receiptdate_prf#4501 AS l_receiptdate_prf_2#4520, l_linenumber_prf#4502 AS l_linenumber_prf_2#4521, l_tax_prf#4503 AS l_tax_prf_2#4522, l_shipdate_prf#4504 AS l_shipdate_prf_2#4523, l_extendedprice_prf#4505 AS l_extendedprice_prf_2#4524, l_partkey_prf#4506 AS l_partkey_prf_2#4525, l_discount_prf#4507 AS l_discount_prf_2#4526, l_partkey_and_l_suppkey_prf#4508 AS l_partkey_and_l_suppkey_prf_2#4527, l_commitdate_prf#4509 AS l_commitdate_prf_2#4528, l_suppkey_prf#4510 AS l_suppkey_prf_2#4529, l_orderkey_prf#4511 AS l_orderkey_prf_2#4530]
            +- Relation[l_returnflag_prf#4493,l_orderkey_and_l_linenumber_prf#4494,l_comment_prf#4495,l_linestatus_prf#4496,rid#4497,l_shipmode_prf#4498,l_shipinstruct_prf#4499,l_quantity_prf#4500,l_receiptdate_prf#4501,l_linenumber_prf#4502,l_tax_prf#4503,l_shipdate_prf#4504,l_extendedprice_prf#4505,l_partkey_prf#4506,l_discount_prf#4507,l_partkey_and_l_suppkey_prf#4508,l_commitdate_prf#4509,l_suppkey_prf#4510,l_orderkey_prf#4511] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 83293ms

fq1e=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 20:59:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 20:59:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4609L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [c_custkey#290L, c_nationkey#293L]
                  +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 20:59:24 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:59:24 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:59:24 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 20:59:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4609L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [l_returnflag_prf#4611 AS l_returnflag_prf_0#4630, l_orderkey_and_l_linenumber_prf#4612 AS l_orderkey_and_l_linenumber_prf_0#4631, l_comment_prf#4613 AS l_comment_prf_0#4632, l_linestatus_prf#4614 AS l_linestatus_prf_0#4633, rid#4615 AS rid_0#4634, l_shipmode_prf#4616 AS l_shipmode_prf_0#4635, l_shipinstruct_prf#4617 AS l_shipinstruct_prf_0#4636, l_quantity_prf#4618 AS l_quantity_prf_0#4637, l_receiptdate_prf#4619 AS l_receiptdate_prf_0#4638, l_linenumber_prf#4620 AS l_linenumber_prf_0#4639, l_tax_prf#4621 AS l_tax_prf_0#4640, l_shipdate_prf#4622 AS l_shipdate_prf_0#4641, l_extendedprice_prf#4623 AS l_extendedprice_prf_0#4642, l_partkey_prf#4624 AS l_partkey_prf_0#4643, l_discount_prf#4625 AS l_discount_prf_0#4644, l_partkey_and_l_suppkey_prf#4626 AS l_partkey_and_l_suppkey_prf_0#4645, l_commitdate_prf#4627 AS l_commitdate_prf_0#4646, l_suppkey_prf#4628 AS l_suppkey_prf_0#4647, l_orderkey_prf#4629 AS l_orderkey_prf_0#4648]
         :  :  :  :  +- Relation[l_returnflag_prf#4611,l_orderkey_and_l_linenumber_prf#4612,l_comment_prf#4613,l_linestatus_prf#4614,rid#4615,l_shipmode_prf#4616,l_shipinstruct_prf#4617,l_quantity_prf#4618,l_receiptdate_prf#4619,l_linenumber_prf#4620,l_tax_prf#4621,l_shipdate_prf#4622,l_extendedprice_prf#4623,l_partkey_prf#4624,l_discount_prf#4625,l_partkey_and_l_suppkey_prf#4626,l_commitdate_prf#4627,l_suppkey_prf#4628,l_orderkey_prf#4629] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#4669]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#4668]
         :  :  :        :  +- Relation[l_returnflag_prf#4649,l_orderkey_and_l_linenumber_prf#4650,l_comment_prf#4651,l_linestatus_prf#4652,rid#4653,l_shipmode_prf#4654,l_shipinstruct_prf#4655,l_quantity_prf#4656,l_receiptdate_prf#4657,l_linenumber_prf#4658,l_tax_prf#4659,l_shipdate_prf#4660,l_extendedprice_prf#4661,l_partkey_prf#4662,l_discount_prf#4663,l_partkey_and_l_suppkey_prf#4664,l_commitdate_prf#4665,l_suppkey_prf#4666,l_orderkey_prf#4667] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#4670 AS o_shippriority_prf_1#4680, rid#4671 AS rid_1#4681, o_orderdate_prf#4672 AS o_orderdate_prf_1#4682, o_custkey_prf#4673 AS o_custkey_prf_1#4683, o_orderpriority_prf#4674 AS o_orderpriority_prf_1#4684, o_clerk_prf#4675 AS o_clerk_prf_1#4685, o_orderstatus_prf#4676 AS o_orderstatus_prf_1#4686, o_totalprice_prf#4677 AS o_totalprice_prf_1#4687, o_orderkey_prf#4678 AS o_orderkey_prf_1#4688, o_comment_prf#4679 AS o_comment_prf_1#4689]
         :  :     +- Relation[o_shippriority_prf#4670,rid#4671,o_orderdate_prf#4672,o_custkey_prf#4673,o_orderpriority_prf#4674,o_clerk_prf#4675,o_orderstatus_prf#4676,o_totalprice_prf#4677,o_orderkey_prf#4678,o_comment_prf#4679] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2158) AS rid_3#4701]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4700]
         :        :  +- Relation[o_shippriority_prf#4690,rid#4691,o_orderdate_prf#4692,o_custkey_prf#4693,o_orderpriority_prf#4694,o_clerk_prf#4695,o_orderstatus_prf#4696,o_totalprice_prf#4697,o_orderkey_prf#4698,o_comment_prf#4699] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_2, 'n_regionkey_prf_2, 'n_nationkey_prf_2, 'n_name_prf_2, 'n_comment_prf_2, dexdecrypt('value_dec_key, value#2158) AS rid_3#4713]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_2#4707: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [rid#4702 AS rid_2#4707, n_regionkey_prf#4703 AS n_regionkey_prf_2#4708, n_nationkey_prf#4704 AS n_nationkey_prf_2#4709, n_name_prf#4705 AS n_name_prf_2#4710, n_comment_prf#4706 AS n_comment_prf_2#4711]
            :     :  :  +- Relation[rid#4702,n_regionkey_prf#4703,n_nationkey_prf#4704,n_name_prf#4705,n_comment_prf#4706] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#4712]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4714 AS c_acctbal_prf_3#4723, rid#4715 AS rid_3#4724, c_name_prf#4716 AS c_name_prf_3#4725, c_nationkey_prf#4717 AS c_nationkey_prf_3#4726, c_custkey_prf#4718 AS c_custkey_prf_3#4727, c_comment_prf#4719 AS c_comment_prf_3#4728, c_address_prf#4720 AS c_address_prf_3#4729, c_mktsegment_prf#4721 AS c_mktsegment_prf_3#4730, c_phone_prf#4722 AS c_phone_prf_3#4731]
               +- Relation[c_acctbal_prf#4714,rid#4715,c_name_prf#4716,c_nationkey_prf#4717,c_custkey_prf#4718,c_comment_prf#4719,c_address_prf#4720,c_mktsegment_prf#4721,c_phone_prf#4722] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 164971ms

ft2b=
select * from part, partsupp, supplier where p_size = 15 and p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/16 21:02:09 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:02:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4799L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 21:02:09 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 21:02:09 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 21:02:09 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 21:02:09 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:02:09 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:02:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4799L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#4837]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#4822]
         :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4813: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [p_comment_prf#4801 AS p_comment_prf_0#4811, p_name_prf#4802 AS p_name_prf_0#4812, rid#4803 AS rid_0#4813, p_type_prf#4804 AS p_type_prf_0#4814, p_retailprice_prf#4805 AS p_retailprice_prf_0#4815, p_mfgr_prf#4806 AS p_mfgr_prf_0#4816, p_container_prf#4807 AS p_container_prf_0#4817, p_brand_prf#4808 AS p_brand_prf_0#4818, p_size_prf#4809 AS p_size_prf_0#4819, p_partkey_prf#4810 AS p_partkey_prf_0#4820]
         :     :  :     :  :  +- Relation[p_comment_prf#4801,p_name_prf#4802,rid#4803,p_type_prf#4804,p_retailprice_prf#4805,p_mfgr_prf#4806,p_container_prf#4807,p_brand_prf#4808,p_size_prf#4809,p_partkey_prf#4810] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4821]
         :     :  :     :     +- DexRidFilter part~p_size~15
         :     :  :     :        +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#4823 AS ps_partkey_and_ps_suppkey_prf_1#4830, rid#4824 AS rid_1#4831, ps_availqty_prf#4825 AS ps_availqty_prf_1#4832, ps_comment_prf#4826 AS ps_comment_prf_1#4833, ps_partkey_prf#4827 AS ps_partkey_prf_1#4834, ps_supplycost_prf#4828 AS ps_supplycost_prf_1#4835, ps_suppkey_prf#4829 AS ps_suppkey_prf_1#4836]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#4823,rid#4824,ps_availqty_prf#4825,ps_comment_prf#4826,ps_partkey_prf#4827,ps_supplycost_prf#4828,ps_suppkey_prf#4829] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4838 AS s_phone_prf_2#4846, rid#4839 AS rid_2#4847, s_address_prf#4840 AS s_address_prf_2#4848, s_nationkey_prf#4841 AS s_nationkey_prf_2#4849, s_suppkey_prf#4842 AS s_suppkey_prf_2#4850, s_name_prf#4843 AS s_name_prf_2#4851, s_acctbal_prf#4844 AS s_acctbal_prf_2#4852, s_comment_prf#4845 AS s_comment_prf_2#4853]
            +- Relation[s_phone_prf#4838,rid#4839,s_address_prf#4840,s_nationkey_prf#4841,s_suppkey_prf#4842,s_name_prf#4843,s_acctbal_prf#4844,s_comment_prf#4845] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 965ms

ft3b=
select * from part, lineitem, supplier where p_size = 15 and p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/16 21:02:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:02:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4914L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 21:02:10 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:02:10 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:02:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4914L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#4937]
         :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#4928: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [p_comment_prf#4916 AS p_comment_prf_0#4926, p_name_prf#4917 AS p_name_prf_0#4927, rid#4918 AS rid_0#4928, p_type_prf#4919 AS p_type_prf_0#4929, p_retailprice_prf#4920 AS p_retailprice_prf_0#4930, p_mfgr_prf#4921 AS p_mfgr_prf_0#4931, p_container_prf#4922 AS p_container_prf_0#4932, p_brand_prf#4923 AS p_brand_prf_0#4933, p_size_prf#4924 AS p_size_prf_0#4934, p_partkey_prf#4925 AS p_partkey_prf_0#4935]
         :     :  :     :  :  +- Relation[p_comment_prf#4916,p_name_prf#4917,rid#4918,p_type_prf#4919,p_retailprice_prf#4920,p_mfgr_prf#4921,p_container_prf#4922,p_brand_prf#4923,p_size_prf#4924,p_partkey_prf#4925] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4936]
         :     :  :     :     +- DexRidFilter part~p_size~15
         :     :  :     :        +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#4938 AS l_returnflag_prf_1#4957, l_orderkey_and_l_linenumber_prf#4939 AS l_orderkey_and_l_linenumber_prf_1#4958, l_comment_prf#4940 AS l_comment_prf_1#4959, l_linestatus_prf#4941 AS l_linestatus_prf_1#4960, rid#4942 AS rid_1#4961, l_shipmode_prf#4943 AS l_shipmode_prf_1#4962, l_shipinstruct_prf#4944 AS l_shipinstruct_prf_1#4963, l_quantity_prf#4945 AS l_quantity_prf_1#4964, l_receiptdate_prf#4946 AS l_receiptdate_prf_1#4965, l_linenumber_prf#4947 AS l_linenumber_prf_1#4966, l_tax_prf#4948 AS l_tax_prf_1#4967, l_shipdate_prf#4949 AS l_shipdate_prf_1#4968, l_extendedprice_prf#4950 AS l_extendedprice_prf_1#4969, l_partkey_prf#4951 AS l_partkey_prf_1#4970, l_discount_prf#4952 AS l_discount_prf_1#4971, l_partkey_and_l_suppkey_prf#4953 AS l_partkey_and_l_suppkey_prf_1#4972, l_commitdate_prf#4954 AS l_commitdate_prf_1#4973, l_suppkey_prf#4955 AS l_suppkey_prf_1#4974, l_orderkey_prf#4956 AS l_orderkey_prf_1#4975]
         :     :     +- Relation[l_returnflag_prf#4938,l_orderkey_and_l_linenumber_prf#4939,l_comment_prf#4940,l_linestatus_prf#4941,rid#4942,l_shipmode_prf#4943,l_shipinstruct_prf#4944,l_quantity_prf#4945,l_receiptdate_prf#4946,l_linenumber_prf#4947,l_tax_prf#4948,l_shipdate_prf#4949,l_extendedprice_prf#4950,l_partkey_prf#4951,l_discount_prf#4952,l_partkey_and_l_suppkey_prf#4953,l_commitdate_prf#4954,l_suppkey_prf#4955,l_orderkey_prf#4956] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4977 AS s_phone_prf_2#4985, rid#4978 AS rid_2#4986, s_address_prf#4979 AS s_address_prf_2#4987, s_nationkey_prf#4980 AS s_nationkey_prf_2#4988, s_suppkey_prf#4981 AS s_suppkey_prf_2#4989, s_name_prf#4982 AS s_name_prf_2#4990, s_acctbal_prf#4983 AS s_acctbal_prf_2#4991, s_comment_prf#4984 AS s_comment_prf_2#4992]
            +- Relation[s_phone_prf#4977,rid#4978,s_address_prf#4979,s_nationkey_prf#4980,s_suppkey_prf#4981,s_name_prf#4982,s_acctbal_prf#4983,s_comment_prf#4984] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 6211ms

fr2d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderstatus = 'F' and o_orderkey = l_orderkey
19/10/16 21:02:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:02:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5066L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 21:02:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5066L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#5118]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [c_acctbal_prf#5068 AS c_acctbal_prf_0#5077, rid#5069 AS rid_0#5078, c_name_prf#5070 AS c_name_prf_0#5079, c_nationkey_prf#5071 AS c_nationkey_prf_0#5080, c_custkey_prf#5072 AS c_custkey_prf_0#5081, c_comment_prf#5073 AS c_comment_prf_0#5082, c_address_prf#5074 AS c_address_prf_0#5083, c_mktsegment_prf#5075 AS c_mktsegment_prf_0#5084, c_phone_prf#5076 AS c_phone_prf_0#5085]
         :     :  :  :  +- Relation[c_acctbal_prf#5068,rid#5069,c_name_prf#5070,c_nationkey_prf#5071,c_custkey_prf#5072,c_comment_prf#5073,c_address_prf#5074,c_mktsegment_prf#5075,c_phone_prf#5076] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#5096]
         :     :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#5095]
         :     :  :        :  +- Relation[c_acctbal_prf#5086,rid#5087,c_name_prf#5088,c_nationkey_prf#5089,c_custkey_prf#5090,c_comment_prf#5091,c_address_prf#5092,c_mktsegment_prf#5093,c_phone_prf#5094] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [o_shippriority_prf#5097 AS o_shippriority_prf_1#5107, rid#5098 AS rid_1#5108, o_orderdate_prf#5099 AS o_orderdate_prf_1#5109, o_custkey_prf#5100 AS o_custkey_prf_1#5110, o_orderpriority_prf#5101 AS o_orderpriority_prf_1#5111, o_clerk_prf#5102 AS o_clerk_prf_1#5112, o_orderstatus_prf#5103 AS o_orderstatus_prf_1#5113, o_totalprice_prf#5104 AS o_totalprice_prf_1#5114, o_orderkey_prf#5105 AS o_orderkey_prf_1#5115, o_comment_prf#5106 AS o_comment_prf_1#5116]
         :     :     :  +- Relation[o_shippriority_prf#5097,rid#5098,o_orderdate_prf#5099,o_custkey_prf#5100,o_orderpriority_prf#5101,o_clerk_prf#5102,o_orderstatus_prf#5103,o_totalprice_prf#5104,o_orderkey_prf#5105,o_comment_prf#5106] JDBCRelation(orders_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5117]
         :     :        +- DexRidFilter orders~o_orderstatus~F
         :     :           +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5119 AS l_returnflag_prf_2#5138, l_orderkey_and_l_linenumber_prf#5120 AS l_orderkey_and_l_linenumber_prf_2#5139, l_comment_prf#5121 AS l_comment_prf_2#5140, l_linestatus_prf#5122 AS l_linestatus_prf_2#5141, rid#5123 AS rid_2#5142, l_shipmode_prf#5124 AS l_shipmode_prf_2#5143, l_shipinstruct_prf#5125 AS l_shipinstruct_prf_2#5144, l_quantity_prf#5126 AS l_quantity_prf_2#5145, l_receiptdate_prf#5127 AS l_receiptdate_prf_2#5146, l_linenumber_prf#5128 AS l_linenumber_prf_2#5147, l_tax_prf#5129 AS l_tax_prf_2#5148, l_shipdate_prf#5130 AS l_shipdate_prf_2#5149, l_extendedprice_prf#5131 AS l_extendedprice_prf_2#5150, l_partkey_prf#5132 AS l_partkey_prf_2#5151, l_discount_prf#5133 AS l_discount_prf_2#5152, l_partkey_and_l_suppkey_prf#5134 AS l_partkey_and_l_suppkey_prf_2#5153, l_commitdate_prf#5135 AS l_commitdate_prf_2#5154, l_suppkey_prf#5136 AS l_suppkey_prf_2#5155, l_orderkey_prf#5137 AS l_orderkey_prf_2#5156]
            +- Relation[l_returnflag_prf#5119,l_orderkey_and_l_linenumber_prf#5120,l_comment_prf#5121,l_linestatus_prf#5122,rid#5123,l_shipmode_prf#5124,l_shipinstruct_prf#5125,l_quantity_prf#5126,l_receiptdate_prf#5127,l_linenumber_prf#5128,l_tax_prf#5129,l_shipdate_prf#5130,l_extendedprice_prf#5131,l_partkey_prf#5132,l_discount_prf#5133,l_partkey_and_l_suppkey_prf#5134,l_commitdate_prf#5135,l_suppkey_prf#5136,l_orderkey_prf#5137] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 108218ms

fr1d=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/16 21:04:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:04:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5231L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 21:04:05 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:04:05 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:04:05 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:04:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5231L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#5273]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#5252]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#5243: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [c_acctbal_prf#5233 AS c_acctbal_prf_0#5242, rid#5234 AS rid_0#5243, c_name_prf#5235 AS c_name_prf_0#5244, c_nationkey_prf#5236 AS c_nationkey_prf_0#5245, c_custkey_prf#5237 AS c_custkey_prf_0#5246, c_comment_prf#5238 AS c_comment_prf_0#5247, c_address_prf#5239 AS c_address_prf_0#5248, c_mktsegment_prf#5240 AS c_mktsegment_prf_0#5249, c_phone_prf#5241 AS c_phone_prf_0#5250]
         :     :  :     :  :  +- Relation[c_acctbal_prf#5233,rid#5234,c_name_prf#5235,c_nationkey_prf#5236,c_custkey_prf#5237,c_comment_prf#5238,c_address_prf#5239,c_mktsegment_prf#5240,c_phone_prf#5241] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5251]
         :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :        +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#5253 AS o_shippriority_prf_1#5263, rid#5254 AS rid_1#5264, o_orderdate_prf#5255 AS o_orderdate_prf_1#5265, o_custkey_prf#5256 AS o_custkey_prf_1#5266, o_orderpriority_prf#5257 AS o_orderpriority_prf_1#5267, o_clerk_prf#5258 AS o_clerk_prf_1#5268, o_orderstatus_prf#5259 AS o_orderstatus_prf_1#5269, o_totalprice_prf#5260 AS o_totalprice_prf_1#5270, o_orderkey_prf#5261 AS o_orderkey_prf_1#5271, o_comment_prf#5262 AS o_comment_prf_1#5272]
         :     :     +- Relation[o_shippriority_prf#5253,rid#5254,o_orderdate_prf#5255,o_custkey_prf#5256,o_orderpriority_prf#5257,o_clerk_prf#5258,o_orderstatus_prf#5259,o_totalprice_prf#5260,o_orderkey_prf#5261,o_comment_prf#5262] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5274 AS l_returnflag_prf_2#5293, l_orderkey_and_l_linenumber_prf#5275 AS l_orderkey_and_l_linenumber_prf_2#5294, l_comment_prf#5276 AS l_comment_prf_2#5295, l_linestatus_prf#5277 AS l_linestatus_prf_2#5296, rid#5278 AS rid_2#5297, l_shipmode_prf#5279 AS l_shipmode_prf_2#5298, l_shipinstruct_prf#5280 AS l_shipinstruct_prf_2#5299, l_quantity_prf#5281 AS l_quantity_prf_2#5300, l_receiptdate_prf#5282 AS l_receiptdate_prf_2#5301, l_linenumber_prf#5283 AS l_linenumber_prf_2#5302, l_tax_prf#5284 AS l_tax_prf_2#5303, l_shipdate_prf#5285 AS l_shipdate_prf_2#5304, l_extendedprice_prf#5286 AS l_extendedprice_prf_2#5305, l_partkey_prf#5287 AS l_partkey_prf_2#5306, l_discount_prf#5288 AS l_discount_prf_2#5307, l_partkey_and_l_suppkey_prf#5289 AS l_partkey_and_l_suppkey_prf_2#5308, l_commitdate_prf#5290 AS l_commitdate_prf_2#5309, l_suppkey_prf#5291 AS l_suppkey_prf_2#5310, l_orderkey_prf#5292 AS l_orderkey_prf_2#5311]
            +- Relation[l_returnflag_prf#5274,l_orderkey_and_l_linenumber_prf#5275,l_comment_prf#5276,l_linestatus_prf#5277,rid#5278,l_shipmode_prf#5279,l_shipinstruct_prf#5280,l_quantity_prf#5281,l_receiptdate_prf#5282,l_linenumber_prf#5283,l_tax_prf#5284,l_shipdate_prf#5285,l_extendedprice_prf#5286,l_partkey_prf#5287,l_discount_prf#5288,l_partkey_and_l_suppkey_prf#5289,l_commitdate_prf#5290,l_suppkey_prf#5291,l_orderkey_prf#5292] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 32901ms

ft2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and p_size = 15 and ps_suppkey = s_suppkey
19/10/16 21:04:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:04:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5374L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 21:04:37 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 21:04:37 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 21:04:37 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 21:04:37 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 21:04:37 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:04:37 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:04:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5374L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#5420]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, rid_0#5384: string
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [ps_partkey_and_ps_suppkey_prf#5376 AS ps_partkey_and_ps_suppkey_prf_0#5383, rid#5377 AS rid_0#5384, ps_availqty_prf#5378 AS ps_availqty_prf_0#5385, ps_comment_prf#5379 AS ps_comment_prf_0#5386, ps_partkey_prf#5380 AS ps_partkey_prf_0#5387, ps_supplycost_prf#5381 AS ps_supplycost_prf_0#5388, ps_suppkey_prf#5382 AS ps_suppkey_prf_0#5389]
         :     :  :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#5376,rid#5377,ps_availqty_prf#5378,ps_comment_prf#5379,ps_partkey_prf#5380,ps_supplycost_prf#5381,ps_suppkey_prf#5382] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#5398]
         :     :  :     +- 'DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#5397]
         :     :  :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#5390,rid#5391,ps_availqty_prf#5392,ps_comment_prf#5393,ps_partkey_prf#5394,ps_supplycost_prf#5395,ps_suppkey_prf#5396] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [p_comment_prf#5399 AS p_comment_prf_1#5409, p_name_prf#5400 AS p_name_prf_1#5410, rid#5401 AS rid_1#5411, p_type_prf#5402 AS p_type_prf_1#5412, p_retailprice_prf#5403 AS p_retailprice_prf_1#5413, p_mfgr_prf#5404 AS p_mfgr_prf_1#5414, p_container_prf#5405 AS p_container_prf_1#5415, p_brand_prf#5406 AS p_brand_prf_1#5416, p_size_prf#5407 AS p_size_prf_1#5417, p_partkey_prf#5408 AS p_partkey_prf_1#5418]
         :     :     :  +- Relation[p_comment_prf#5399,p_name_prf#5400,rid#5401,p_type_prf#5402,p_retailprice_prf#5403,p_mfgr_prf#5404,p_container_prf#5405,p_brand_prf#5406,p_size_prf#5407,p_partkey_prf#5408] JDBCRelation(part_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5419]
         :     :        +- DexRidFilter part~p_size~15
         :     :           +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5421 AS s_phone_prf_2#5429, rid#5422 AS rid_2#5430, s_address_prf#5423 AS s_address_prf_2#5431, s_nationkey_prf#5424 AS s_nationkey_prf_2#5432, s_suppkey_prf#5425 AS s_suppkey_prf_2#5433, s_name_prf#5426 AS s_name_prf_2#5434, s_acctbal_prf#5427 AS s_acctbal_prf_2#5435, s_comment_prf#5428 AS s_comment_prf_2#5436]
            +- Relation[s_phone_prf#5421,rid#5422,s_address_prf#5423,s_nationkey_prf#5424,s_suppkey_prf#5425,s_name_prf#5426,s_acctbal_prf#5427,s_comment_prf#5428] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 49838ms

fs1b=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/16 21:05:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:05:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5507L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L, l_partkey#307L]
               :  +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L]
                  +- Join Inner, (c_custkey#290L = o_custkey#343L)
                     :- Project [c_custkey#290L]
                     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
                     +- Project [o_orderkey#342L, o_custkey#343L]
                        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 21:05:27 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:05:27 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:05:27 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:05:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5507L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [p_comment_prf#5509 AS p_comment_prf_0#5519, p_name_prf#5510 AS p_name_prf_0#5520, rid#5511 AS rid_0#5521, p_type_prf#5512 AS p_type_prf_0#5522, p_retailprice_prf#5513 AS p_retailprice_prf_0#5523, p_mfgr_prf#5514 AS p_mfgr_prf_0#5524, p_container_prf#5515 AS p_container_prf_0#5525, p_brand_prf#5516 AS p_brand_prf_0#5526, p_size_prf#5517 AS p_size_prf_0#5527, p_partkey_prf#5518 AS p_partkey_prf_0#5528]
         :  :  +- Relation[p_comment_prf#5509,p_name_prf#5510,rid#5511,p_type_prf#5512,p_retailprice_prf#5513,p_mfgr_prf#5514,p_container_prf#5515,p_brand_prf#5516,p_size_prf#5517,p_partkey_prf#5518] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#5540]
         :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5539]
         :        :  +- Relation[p_comment_prf#5529,p_name_prf#5530,rid#5531,p_type_prf#5532,p_retailprice_prf#5533,p_mfgr_prf#5534,p_container_prf#5535,p_brand_prf#5536,p_size_prf#5537,p_partkey_prf#5538] JDBCRelation(part_prf) [numPartitions=1]
         :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [l_returnflag_prf#5541 AS l_returnflag_prf_1#5560, l_orderkey_and_l_linenumber_prf#5542 AS l_orderkey_and_l_linenumber_prf_1#5561, l_comment_prf#5543 AS l_comment_prf_1#5562, l_linestatus_prf#5544 AS l_linestatus_prf_1#5563, rid#5545 AS rid_1#5564, l_shipmode_prf#5546 AS l_shipmode_prf_1#5565, l_shipinstruct_prf#5547 AS l_shipinstruct_prf_1#5566, l_quantity_prf#5548 AS l_quantity_prf_1#5567, l_receiptdate_prf#5549 AS l_receiptdate_prf_1#5568, l_linenumber_prf#5550 AS l_linenumber_prf_1#5569, l_tax_prf#5551 AS l_tax_prf_1#5570, l_shipdate_prf#5552 AS l_shipdate_prf_1#5571, l_extendedprice_prf#5553 AS l_extendedprice_prf_1#5572, l_partkey_prf#5554 AS l_partkey_prf_1#5573, l_discount_prf#5555 AS l_discount_prf_1#5574, l_partkey_and_l_suppkey_prf#5556 AS l_partkey_and_l_suppkey_prf_1#5575, l_commitdate_prf#5557 AS l_commitdate_prf_1#5576, l_suppkey_prf#5558 AS l_suppkey_prf_1#5577, l_orderkey_prf#5559 AS l_orderkey_prf_1#5578]
            :  :  +- Relation[l_returnflag_prf#5541,l_orderkey_and_l_linenumber_prf#5542,l_comment_prf#5543,l_linestatus_prf#5544,rid#5545,l_shipmode_prf#5546,l_shipinstruct_prf#5547,l_quantity_prf#5548,l_receiptdate_prf#5549,l_linenumber_prf#5550,l_tax_prf#5551,l_shipdate_prf#5552,l_extendedprice_prf#5553,l_partkey_prf#5554,l_discount_prf#5555,l_partkey_and_l_suppkey_prf#5556,l_commitdate_prf#5557,l_suppkey_prf#5558,l_orderkey_prf#5559] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2158) AS rid_3#5599]
            :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#5598]
            :        :  +- Relation[l_returnflag_prf#5579,l_orderkey_and_l_linenumber_prf#5580,l_comment_prf#5581,l_linestatus_prf#5582,rid#5583,l_shipmode_prf#5584,l_shipinstruct_prf#5585,l_quantity_prf#5586,l_receiptdate_prf#5587,l_linenumber_prf#5588,l_tax_prf#5589,l_shipdate_prf#5590,l_extendedprice_prf#5591,l_partkey_prf#5592,l_discount_prf#5593,l_partkey_and_l_suppkey_prf#5594,l_commitdate_prf#5595,l_suppkey_prf#5596,l_orderkey_prf#5597] JDBCRelation(lineitem_prf) [numPartitions=1]
            :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join NaturalJoin(Inner)
               :- 'Project ['c_acctbal_prf_2, 'rid_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2158) AS rid_3#5619]
               :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_2#5610: string
               :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :     :  :- Project [c_acctbal_prf#5600 AS c_acctbal_prf_2#5609, rid#5601 AS rid_2#5610, c_name_prf#5602 AS c_name_prf_2#5611, c_nationkey_prf#5603 AS c_nationkey_prf_2#5612, c_custkey_prf#5604 AS c_custkey_prf_2#5613, c_comment_prf#5605 AS c_comment_prf_2#5614, c_address_prf#5606 AS c_address_prf_2#5615, c_mktsegment_prf#5607 AS c_mktsegment_prf_2#5616, c_phone_prf#5608 AS c_phone_prf_2#5617]
               :     :  :  +- Relation[c_acctbal_prf#5600,rid#5601,c_name_prf#5602,c_nationkey_prf#5603,c_custkey_prf#5604,c_comment_prf#5605,c_address_prf#5606,c_mktsegment_prf#5607,c_phone_prf#5608] JDBCRelation(customer_prf) [numPartitions=1]
               :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#5618]
               :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
               :     :        +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
               :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
               +- Project [o_shippriority_prf#5620 AS o_shippriority_prf_3#5630, rid#5621 AS rid_3#5631, o_orderdate_prf#5622 AS o_orderdate_prf_3#5632, o_custkey_prf#5623 AS o_custkey_prf_3#5633, o_orderpriority_prf#5624 AS o_orderpriority_prf_3#5634, o_clerk_prf#5625 AS o_clerk_prf_3#5635, o_orderstatus_prf#5626 AS o_orderstatus_prf_3#5636, o_totalprice_prf#5627 AS o_totalprice_prf_3#5637, o_orderkey_prf#5628 AS o_orderkey_prf_3#5638, o_comment_prf#5629 AS o_comment_prf_3#5639]
                  +- Relation[o_shippriority_prf#5620,rid#5621,o_orderdate_prf#5622,o_custkey_prf#5623,o_orderpriority_prf#5624,o_clerk_prf#5625,o_orderstatus_prf#5626,o_totalprice_prf#5627,o_orderkey_prf#5628,o_comment_prf#5629] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 172947ms

fq1c=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 21:08:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:08:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5728L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [c_nationkey#293L, o_orderkey#342L]
               :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :     :- Project [c_custkey#290L, c_nationkey#293L]
               :     :  +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
               :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               :     +- Project [o_orderkey#342L, o_custkey#343L]
               :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 21:08:20 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:08:20 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:08:20 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 21:08:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5728L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#5741]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#5735: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [rid#5730 AS rid_0#5735, n_regionkey_prf#5731 AS n_regionkey_prf_0#5736, n_nationkey_prf#5732 AS n_nationkey_prf_0#5737, n_name_prf#5733 AS n_name_prf_0#5738, n_comment_prf#5734 AS n_comment_prf_0#5739]
         :     :  :  +- Relation[rid#5730,n_regionkey_prf#5731,n_nationkey_prf#5732,n_name_prf#5733,n_comment_prf#5734] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5740]
         :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :        +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join NaturalJoin(Inner)
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- Project [c_acctbal_prf#5742 AS c_acctbal_prf_1#5751, rid#5743 AS rid_1#5752, c_name_prf#5744 AS c_name_prf_1#5753, c_nationkey_prf#5745 AS c_nationkey_prf_1#5754, c_custkey_prf#5746 AS c_custkey_prf_1#5755, c_comment_prf#5747 AS c_comment_prf_1#5756, c_address_prf#5748 AS c_address_prf_1#5757, c_mktsegment_prf#5749 AS c_mktsegment_prf_1#5758, c_phone_prf#5750 AS c_phone_prf_1#5759]
            :  :  :  :  +- Relation[c_acctbal_prf#5742,rid#5743,c_name_prf#5744,c_nationkey_prf#5745,c_custkey_prf#5746,c_comment_prf#5747,c_address_prf#5748,c_mktsegment_prf#5749,c_phone_prf#5750] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#5770]
            :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
            :  :  :        :- 'Project ['rid AS rid_1#5769]
            :  :  :        :  +- Relation[c_acctbal_prf#5760,rid#5761,c_name_prf#5762,c_nationkey_prf#5763,c_custkey_prf#5764,c_comment_prf#5765,c_address_prf#5766,c_mktsegment_prf#5767,c_phone_prf#5768] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
            :  :  +- Project [o_shippriority_prf#5771 AS o_shippriority_prf_2#5781, rid#5772 AS rid_2#5782, o_orderdate_prf#5773 AS o_orderdate_prf_2#5783, o_custkey_prf#5774 AS o_custkey_prf_2#5784, o_orderpriority_prf#5775 AS o_orderpriority_prf_2#5785, o_clerk_prf#5776 AS o_clerk_prf_2#5786, o_orderstatus_prf#5777 AS o_orderstatus_prf_2#5787, o_totalprice_prf#5778 AS o_totalprice_prf_2#5788, o_orderkey_prf#5779 AS o_orderkey_prf_2#5789, o_comment_prf#5780 AS o_comment_prf_2#5790]
            :  :     +- Relation[o_shippriority_prf#5771,rid#5772,o_orderdate_prf#5773,o_custkey_prf#5774,o_orderpriority_prf#5775,o_clerk_prf#5776,o_orderstatus_prf#5777,o_totalprice_prf#5778,o_orderkey_prf#5779,o_comment_prf#5780] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2158) AS rid_3#5802]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#5801]
            :        :  +- Relation[o_shippriority_prf#5791,rid#5792,o_orderdate_prf#5793,o_custkey_prf#5794,o_orderpriority_prf#5795,o_clerk_prf#5796,o_orderstatus_prf#5797,o_totalprice_prf#5798,o_orderkey_prf#5799,o_comment_prf#5800] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#5803 AS l_returnflag_prf_3#5822, l_orderkey_and_l_linenumber_prf#5804 AS l_orderkey_and_l_linenumber_prf_3#5823, l_comment_prf#5805 AS l_comment_prf_3#5824, l_linestatus_prf#5806 AS l_linestatus_prf_3#5825, rid#5807 AS rid_3#5826, l_shipmode_prf#5808 AS l_shipmode_prf_3#5827, l_shipinstruct_prf#5809 AS l_shipinstruct_prf_3#5828, l_quantity_prf#5810 AS l_quantity_prf_3#5829, l_receiptdate_prf#5811 AS l_receiptdate_prf_3#5830, l_linenumber_prf#5812 AS l_linenumber_prf_3#5831, l_tax_prf#5813 AS l_tax_prf_3#5832, l_shipdate_prf#5814 AS l_shipdate_prf_3#5833, l_extendedprice_prf#5815 AS l_extendedprice_prf_3#5834, l_partkey_prf#5816 AS l_partkey_prf_3#5835, l_discount_prf#5817 AS l_discount_prf_3#5836, l_partkey_and_l_suppkey_prf#5818 AS l_partkey_and_l_suppkey_prf_3#5837, l_commitdate_prf#5819 AS l_commitdate_prf_3#5838, l_suppkey_prf#5820 AS l_suppkey_prf_3#5839, l_orderkey_prf#5821 AS l_orderkey_prf_3#5840]
               +- Relation[l_returnflag_prf#5803,l_orderkey_and_l_linenumber_prf#5804,l_comment_prf#5805,l_linestatus_prf#5806,rid#5807,l_shipmode_prf#5808,l_shipinstruct_prf#5809,l_quantity_prf#5810,l_receiptdate_prf#5811,l_linenumber_prf#5812,l_tax_prf#5813,l_shipdate_prf#5814,l_extendedprice_prf#5815,l_partkey_prf#5816,l_discount_prf#5817,l_partkey_and_l_suppkey_prf#5818,l_commitdate_prf#5819,l_suppkey_prf#5820,l_orderkey_prf#5821] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 164636ms

fr2a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_orderstatus = 'F' and o_custkey = c_custkey
19/10/16 21:11:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:11:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5920L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 21:11:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5920L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [l_returnflag_prf#5922 AS l_returnflag_prf_0#5941, l_orderkey_and_l_linenumber_prf#5923 AS l_orderkey_and_l_linenumber_prf_0#5942, l_comment_prf#5924 AS l_comment_prf_0#5943, l_linestatus_prf#5925 AS l_linestatus_prf_0#5944, rid#5926 AS rid_0#5945, l_shipmode_prf#5927 AS l_shipmode_prf_0#5946, l_shipinstruct_prf#5928 AS l_shipinstruct_prf_0#5947, l_quantity_prf#5929 AS l_quantity_prf_0#5948, l_receiptdate_prf#5930 AS l_receiptdate_prf_0#5949, l_linenumber_prf#5931 AS l_linenumber_prf_0#5950, l_tax_prf#5932 AS l_tax_prf_0#5951, l_shipdate_prf#5933 AS l_shipdate_prf_0#5952, l_extendedprice_prf#5934 AS l_extendedprice_prf_0#5953, l_partkey_prf#5935 AS l_partkey_prf_0#5954, l_discount_prf#5936 AS l_discount_prf_0#5955, l_partkey_and_l_suppkey_prf#5937 AS l_partkey_and_l_suppkey_prf_0#5956, l_commitdate_prf#5938 AS l_commitdate_prf_0#5957, l_suppkey_prf#5939 AS l_suppkey_prf_0#5958, l_orderkey_prf#5940 AS l_orderkey_prf_0#5959]
         :     :  :  :  +- Relation[l_returnflag_prf#5922,l_orderkey_and_l_linenumber_prf#5923,l_comment_prf#5924,l_linestatus_prf#5925,rid#5926,l_shipmode_prf#5927,l_shipinstruct_prf#5928,l_quantity_prf#5929,l_receiptdate_prf#5930,l_linenumber_prf#5931,l_tax_prf#5932,l_shipdate_prf#5933,l_extendedprice_prf#5934,l_partkey_prf#5935,l_discount_prf#5936,l_partkey_and_l_suppkey_prf#5937,l_commitdate_prf#5938,l_suppkey_prf#5939,l_orderkey_prf#5940] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#5980]
         :     :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#5979]
         :     :  :        :  +- Relation[l_returnflag_prf#5960,l_orderkey_and_l_linenumber_prf#5961,l_comment_prf#5962,l_linestatus_prf#5963,rid#5964,l_shipmode_prf#5965,l_shipinstruct_prf#5966,l_quantity_prf#5967,l_receiptdate_prf#5968,l_linenumber_prf#5969,l_tax_prf#5970,l_shipdate_prf#5971,l_extendedprice_prf#5972,l_partkey_prf#5973,l_discount_prf#5974,l_partkey_and_l_suppkey_prf#5975,l_commitdate_prf#5976,l_suppkey_prf#5977,l_orderkey_prf#5978] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [o_shippriority_prf#5981 AS o_shippriority_prf_1#5991, rid#5982 AS rid_1#5992, o_orderdate_prf#5983 AS o_orderdate_prf_1#5993, o_custkey_prf#5984 AS o_custkey_prf_1#5994, o_orderpriority_prf#5985 AS o_orderpriority_prf_1#5995, o_clerk_prf#5986 AS o_clerk_prf_1#5996, o_orderstatus_prf#5987 AS o_orderstatus_prf_1#5997, o_totalprice_prf#5988 AS o_totalprice_prf_1#5998, o_orderkey_prf#5989 AS o_orderkey_prf_1#5999, o_comment_prf#5990 AS o_comment_prf_1#6000]
         :     :     :  +- Relation[o_shippriority_prf#5981,rid#5982,o_orderdate_prf#5983,o_custkey_prf#5984,o_orderpriority_prf#5985,o_clerk_prf#5986,o_orderstatus_prf#5987,o_totalprice_prf#5988,o_orderkey_prf#5989,o_comment_prf#5990] JDBCRelation(orders_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6001]
         :     :        +- DexRidFilter orders~o_orderstatus~F
         :     :           +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#6003 AS c_acctbal_prf_2#6012, rid#6004 AS rid_2#6013, c_name_prf#6005 AS c_name_prf_2#6014, c_nationkey_prf#6006 AS c_nationkey_prf_2#6015, c_custkey_prf#6007 AS c_custkey_prf_2#6016, c_comment_prf#6008 AS c_comment_prf_2#6017, c_address_prf#6009 AS c_address_prf_2#6018, c_mktsegment_prf#6010 AS c_mktsegment_prf_2#6019, c_phone_prf#6011 AS c_phone_prf_2#6020]
            +- Relation[c_acctbal_prf#6003,rid#6004,c_name_prf#6005,c_nationkey_prf#6006,c_custkey_prf#6007,c_comment_prf#6008,c_address_prf#6009,c_mktsegment_prf#6010,c_phone_prf#6011] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 194888ms

fs1c=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/16 21:14:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:14:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6104L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_orderkey#306L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 21:14:20 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:14:20 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:14:20 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:14:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6104L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [p_comment_prf#6106 AS p_comment_prf_0#6116, p_name_prf#6107 AS p_name_prf_0#6117, rid#6108 AS rid_0#6118, p_type_prf#6109 AS p_type_prf_0#6119, p_retailprice_prf#6110 AS p_retailprice_prf_0#6120, p_mfgr_prf#6111 AS p_mfgr_prf_0#6121, p_container_prf#6112 AS p_container_prf_0#6122, p_brand_prf#6113 AS p_brand_prf_0#6123, p_size_prf#6114 AS p_size_prf_0#6124, p_partkey_prf#6115 AS p_partkey_prf_0#6125]
         :  :  :  :  +- Relation[p_comment_prf#6106,p_name_prf#6107,rid#6108,p_type_prf#6109,p_retailprice_prf#6110,p_mfgr_prf#6111,p_container_prf#6112,p_brand_prf#6113,p_size_prf#6114,p_partkey_prf#6115] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#6137]
         :  :  :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#6136]
         :  :  :        :  +- Relation[p_comment_prf#6126,p_name_prf#6127,rid#6128,p_type_prf#6129,p_retailprice_prf#6130,p_mfgr_prf#6131,p_container_prf#6132,p_brand_prf#6133,p_size_prf#6134,p_partkey_prf#6135] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#6138 AS l_returnflag_prf_1#6157, l_orderkey_and_l_linenumber_prf#6139 AS l_orderkey_and_l_linenumber_prf_1#6158, l_comment_prf#6140 AS l_comment_prf_1#6159, l_linestatus_prf#6141 AS l_linestatus_prf_1#6160, rid#6142 AS rid_1#6161, l_shipmode_prf#6143 AS l_shipmode_prf_1#6162, l_shipinstruct_prf#6144 AS l_shipinstruct_prf_1#6163, l_quantity_prf#6145 AS l_quantity_prf_1#6164, l_receiptdate_prf#6146 AS l_receiptdate_prf_1#6165, l_linenumber_prf#6147 AS l_linenumber_prf_1#6166, l_tax_prf#6148 AS l_tax_prf_1#6167, l_shipdate_prf#6149 AS l_shipdate_prf_1#6168, l_extendedprice_prf#6150 AS l_extendedprice_prf_1#6169, l_partkey_prf#6151 AS l_partkey_prf_1#6170, l_discount_prf#6152 AS l_discount_prf_1#6171, l_partkey_and_l_suppkey_prf#6153 AS l_partkey_and_l_suppkey_prf_1#6172, l_commitdate_prf#6154 AS l_commitdate_prf_1#6173, l_suppkey_prf#6155 AS l_suppkey_prf_1#6174, l_orderkey_prf#6156 AS l_orderkey_prf_1#6175]
         :  :     +- Relation[l_returnflag_prf#6138,l_orderkey_and_l_linenumber_prf#6139,l_comment_prf#6140,l_linestatus_prf#6141,rid#6142,l_shipmode_prf#6143,l_shipinstruct_prf#6144,l_quantity_prf#6145,l_receiptdate_prf#6146,l_linenumber_prf#6147,l_tax_prf#6148,l_shipdate_prf#6149,l_extendedprice_prf#6150,l_partkey_prf#6151,l_discount_prf#6152,l_partkey_and_l_suppkey_prf#6153,l_commitdate_prf#6154,l_suppkey_prf#6155,l_orderkey_prf#6156] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2158) AS rid_3#6196]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#6195]
         :        :  +- Relation[l_returnflag_prf#6176,l_orderkey_and_l_linenumber_prf#6177,l_comment_prf#6178,l_linestatus_prf#6179,rid#6180,l_shipmode_prf#6181,l_shipinstruct_prf#6182,l_quantity_prf#6183,l_receiptdate_prf#6184,l_linenumber_prf#6185,l_tax_prf#6186,l_shipdate_prf#6187,l_extendedprice_prf#6188,l_partkey_prf#6189,l_discount_prf#6190,l_partkey_and_l_suppkey_prf#6191,l_commitdate_prf#6192,l_suppkey_prf#6193,l_orderkey_prf#6194] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_2, 'rid_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2158) AS rid_3#6216]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_2#6207: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [c_acctbal_prf#6197 AS c_acctbal_prf_2#6206, rid#6198 AS rid_2#6207, c_name_prf#6199 AS c_name_prf_2#6208, c_nationkey_prf#6200 AS c_nationkey_prf_2#6209, c_custkey_prf#6201 AS c_custkey_prf_2#6210, c_comment_prf#6202 AS c_comment_prf_2#6211, c_address_prf#6203 AS c_address_prf_2#6212, c_mktsegment_prf#6204 AS c_mktsegment_prf_2#6213, c_phone_prf#6205 AS c_phone_prf_2#6214]
            :     :  :  +- Relation[c_acctbal_prf#6197,rid#6198,c_name_prf#6199,c_nationkey_prf#6200,c_custkey_prf#6201,c_comment_prf#6202,c_address_prf#6203,c_mktsegment_prf#6204,c_phone_prf#6205] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#6215]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#6217 AS o_shippriority_prf_3#6227, rid#6218 AS rid_3#6228, o_orderdate_prf#6219 AS o_orderdate_prf_3#6229, o_custkey_prf#6220 AS o_custkey_prf_3#6230, o_orderpriority_prf#6221 AS o_orderpriority_prf_3#6231, o_clerk_prf#6222 AS o_clerk_prf_3#6232, o_orderstatus_prf#6223 AS o_orderstatus_prf_3#6233, o_totalprice_prf#6224 AS o_totalprice_prf_3#6234, o_orderkey_prf#6225 AS o_orderkey_prf_3#6235, o_comment_prf#6226 AS o_comment_prf_3#6236]
               +- Relation[o_shippriority_prf#6217,rid#6218,o_orderdate_prf#6219,o_custkey_prf#6220,o_orderpriority_prf#6221,o_clerk_prf#6222,o_orderstatus_prf#6223,o_totalprice_prf#6224,o_orderkey_prf#6225,o_comment_prf#6226] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 173485ms

ft3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and (p_size = 15 and s_suppkey = l_suppkey)
19/10/16 21:17:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:17:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6320L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 21:17:13 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:17:13 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:17:13 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 21:17:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6320L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#6322 AS s_phone_prf_0#6330, rid#6323 AS rid_0#6331, s_address_prf#6324 AS s_address_prf_0#6332, s_nationkey_prf#6325 AS s_nationkey_prf_0#6333, s_suppkey_prf#6326 AS s_suppkey_prf_0#6334, s_name_prf#6327 AS s_name_prf_0#6335, s_acctbal_prf#6328 AS s_acctbal_prf_0#6336, s_comment_prf#6329 AS s_comment_prf_0#6337]
         :  :  +- Relation[s_phone_prf#6322,rid#6323,s_address_prf#6324,s_nationkey_prf#6325,s_suppkey_prf#6326,s_name_prf#6327,s_acctbal_prf#6328,s_comment_prf#6329] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2158) AS rid_2#6347]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#6346]
         :        :  +- Relation[s_phone_prf#6338,rid#6339,s_address_prf#6340,s_nationkey_prf#6341,s_suppkey_prf#6342,s_name_prf#6343,s_acctbal_prf#6344,s_comment_prf#6345] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#6369]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#6360: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#6348 AS p_comment_prf_1#6358, p_name_prf#6349 AS p_name_prf_1#6359, rid#6350 AS rid_1#6360, p_type_prf#6351 AS p_type_prf_1#6361, p_retailprice_prf#6352 AS p_retailprice_prf_1#6362, p_mfgr_prf#6353 AS p_mfgr_prf_1#6363, p_container_prf#6354 AS p_container_prf_1#6364, p_brand_prf#6355 AS p_brand_prf_1#6365, p_size_prf#6356 AS p_size_prf_1#6366, p_partkey_prf#6357 AS p_partkey_prf_1#6367]
            :     :  :  +- Relation[p_comment_prf#6348,p_name_prf#6349,rid#6350,p_type_prf#6351,p_retailprice_prf#6352,p_mfgr_prf#6353,p_container_prf#6354,p_brand_prf#6355,p_size_prf#6356,p_partkey_prf#6357] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6368]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#6370 AS l_returnflag_prf_2#6389, l_orderkey_and_l_linenumber_prf#6371 AS l_orderkey_and_l_linenumber_prf_2#6390, l_comment_prf#6372 AS l_comment_prf_2#6391, l_linestatus_prf#6373 AS l_linestatus_prf_2#6392, rid#6374 AS rid_2#6393, l_shipmode_prf#6375 AS l_shipmode_prf_2#6394, l_shipinstruct_prf#6376 AS l_shipinstruct_prf_2#6395, l_quantity_prf#6377 AS l_quantity_prf_2#6396, l_receiptdate_prf#6378 AS l_receiptdate_prf_2#6397, l_linenumber_prf#6379 AS l_linenumber_prf_2#6398, l_tax_prf#6380 AS l_tax_prf_2#6399, l_shipdate_prf#6381 AS l_shipdate_prf_2#6400, l_extendedprice_prf#6382 AS l_extendedprice_prf_2#6401, l_partkey_prf#6383 AS l_partkey_prf_2#6402, l_discount_prf#6384 AS l_discount_prf_2#6403, l_partkey_and_l_suppkey_prf#6385 AS l_partkey_and_l_suppkey_prf_2#6404, l_commitdate_prf#6386 AS l_commitdate_prf_2#6405, l_suppkey_prf#6387 AS l_suppkey_prf_2#6406, l_orderkey_prf#6388 AS l_orderkey_prf_2#6407]
               +- Relation[l_returnflag_prf#6370,l_orderkey_and_l_linenumber_prf#6371,l_comment_prf#6372,l_linestatus_prf#6373,rid#6374,l_shipmode_prf#6375,l_shipinstruct_prf#6376,l_quantity_prf#6377,l_receiptdate_prf#6378,l_linenumber_prf#6379,l_tax_prf#6380,l_shipdate_prf#6381,l_extendedprice_prf#6382,l_partkey_prf#6383,l_discount_prf#6384,l_partkey_and_l_suppkey_prf#6385,l_commitdate_prf#6386,l_suppkey_prf#6387,l_orderkey_prf#6388] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 55766ms

fr1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and (l_orderkey = o_orderkey and c_mktsegment = 'BUILDING')
19/10/16 21:18:09 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:18:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6481L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 21:18:09 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:18:09 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:18:09 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:18:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6481L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#6483 AS l_returnflag_prf_0#6502, l_orderkey_and_l_linenumber_prf#6484 AS l_orderkey_and_l_linenumber_prf_0#6503, l_comment_prf#6485 AS l_comment_prf_0#6504, l_linestatus_prf#6486 AS l_linestatus_prf_0#6505, rid#6487 AS rid_0#6506, l_shipmode_prf#6488 AS l_shipmode_prf_0#6507, l_shipinstruct_prf#6489 AS l_shipinstruct_prf_0#6508, l_quantity_prf#6490 AS l_quantity_prf_0#6509, l_receiptdate_prf#6491 AS l_receiptdate_prf_0#6510, l_linenumber_prf#6492 AS l_linenumber_prf_0#6511, l_tax_prf#6493 AS l_tax_prf_0#6512, l_shipdate_prf#6494 AS l_shipdate_prf_0#6513, l_extendedprice_prf#6495 AS l_extendedprice_prf_0#6514, l_partkey_prf#6496 AS l_partkey_prf_0#6515, l_discount_prf#6497 AS l_discount_prf_0#6516, l_partkey_and_l_suppkey_prf#6498 AS l_partkey_and_l_suppkey_prf_0#6517, l_commitdate_prf#6499 AS l_commitdate_prf_0#6518, l_suppkey_prf#6500 AS l_suppkey_prf_0#6519, l_orderkey_prf#6501 AS l_orderkey_prf_0#6520]
         :  :  +- Relation[l_returnflag_prf#6483,l_orderkey_and_l_linenumber_prf#6484,l_comment_prf#6485,l_linestatus_prf#6486,rid#6487,l_shipmode_prf#6488,l_shipinstruct_prf#6489,l_quantity_prf#6490,l_receiptdate_prf#6491,l_linenumber_prf#6492,l_tax_prf#6493,l_shipdate_prf#6494,l_extendedprice_prf#6495,l_partkey_prf#6496,l_discount_prf#6497,l_partkey_and_l_suppkey_prf#6498,l_commitdate_prf#6499,l_suppkey_prf#6500,l_orderkey_prf#6501] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2158) AS rid_1#6541]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#6540]
         :        :  +- Relation[l_returnflag_prf#6521,l_orderkey_and_l_linenumber_prf#6522,l_comment_prf#6523,l_linestatus_prf#6524,rid#6525,l_shipmode_prf#6526,l_shipinstruct_prf#6527,l_quantity_prf#6528,l_receiptdate_prf#6529,l_linenumber_prf#6530,l_tax_prf#6531,l_shipdate_prf#6532,l_extendedprice_prf#6533,l_partkey_prf#6534,l_discount_prf#6535,l_partkey_and_l_suppkey_prf#6536,l_commitdate_prf#6537,l_suppkey_prf#6538,l_orderkey_prf#6539] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [o_shippriority_prf#6542 AS o_shippriority_prf_1#6552, rid#6543 AS rid_1#6553, o_orderdate_prf#6544 AS o_orderdate_prf_1#6554, o_custkey_prf#6545 AS o_custkey_prf_1#6555, o_orderpriority_prf#6546 AS o_orderpriority_prf_1#6556, o_clerk_prf#6547 AS o_clerk_prf_1#6557, o_orderstatus_prf#6548 AS o_orderstatus_prf_1#6558, o_totalprice_prf#6549 AS o_totalprice_prf_1#6559, o_orderkey_prf#6550 AS o_orderkey_prf_1#6560, o_comment_prf#6551 AS o_comment_prf_1#6561]
            :  :  +- Relation[o_shippriority_prf#6542,rid#6543,o_orderdate_prf#6544,o_custkey_prf#6545,o_orderpriority_prf#6546,o_clerk_prf#6547,o_orderstatus_prf#6548,o_totalprice_prf#6549,o_orderkey_prf#6550,o_comment_prf#6551] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#6573]
            :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#6572]
            :        :  +- Relation[o_shippriority_prf#6562,rid#6563,o_orderdate_prf#6564,o_custkey_prf#6565,o_orderpriority_prf#6566,o_clerk_prf#6567,o_orderstatus_prf#6568,o_totalprice_prf#6569,o_orderkey_prf#6570,o_comment_prf#6571] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [c_acctbal_prf#6574 AS c_acctbal_prf_2#6583, rid#6575 AS rid_2#6584, c_name_prf#6576 AS c_name_prf_2#6585, c_nationkey_prf#6577 AS c_nationkey_prf_2#6586, c_custkey_prf#6578 AS c_custkey_prf_2#6587, c_comment_prf#6579 AS c_comment_prf_2#6588, c_address_prf#6580 AS c_address_prf_2#6589, c_mktsegment_prf#6581 AS c_mktsegment_prf_2#6590, c_phone_prf#6582 AS c_phone_prf_2#6591]
               :  +- Relation[c_acctbal_prf#6574,rid#6575,c_name_prf#6576,c_nationkey_prf#6577,c_custkey_prf#6578,c_comment_prf#6579,c_address_prf#6580,c_mktsegment_prf#6581,c_phone_prf#6582] JDBCRelation(customer_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#6592]
                  +- DexRidFilter customer~c_mktsegment~BUILDING
                     +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 121330ms

fr1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and (c_mktsegment = 'BUILDING' and l_orderkey = o_orderkey)
19/10/16 21:20:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 21:20:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6667L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 21:20:10 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:20:10 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:20:10 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 21:20:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6667L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#6669 AS l_returnflag_prf_0#6688, l_orderkey_and_l_linenumber_prf#6670 AS l_orderkey_and_l_linenumber_prf_0#6689, l_comment_prf#6671 AS l_comment_prf_0#6690, l_linestatus_prf#6672 AS l_linestatus_prf_0#6691, rid#6673 AS rid_0#6692, l_shipmode_prf#6674 AS l_shipmode_prf_0#6693, l_shipinstruct_prf#6675 AS l_shipinstruct_prf_0#6694, l_quantity_prf#6676 AS l_quantity_prf_0#6695, l_receiptdate_prf#6677 AS l_receiptdate_prf_0#6696, l_linenumber_prf#6678 AS l_linenumber_prf_0#6697, l_tax_prf#6679 AS l_tax_prf_0#6698, l_shipdate_prf#6680 AS l_shipdate_prf_0#6699, l_extendedprice_prf#6681 AS l_extendedprice_prf_0#6700, l_partkey_prf#6682 AS l_partkey_prf_0#6701, l_discount_prf#6683 AS l_discount_prf_0#6702, l_partkey_and_l_suppkey_prf#6684 AS l_partkey_and_l_suppkey_prf_0#6703, l_commitdate_prf#6685 AS l_commitdate_prf_0#6704, l_suppkey_prf#6686 AS l_suppkey_prf_0#6705, l_orderkey_prf#6687 AS l_orderkey_prf_0#6706]
         :  :  +- Relation[l_returnflag_prf#6669,l_orderkey_and_l_linenumber_prf#6670,l_comment_prf#6671,l_linestatus_prf#6672,rid#6673,l_shipmode_prf#6674,l_shipinstruct_prf#6675,l_quantity_prf#6676,l_receiptdate_prf#6677,l_linenumber_prf#6678,l_tax_prf#6679,l_shipdate_prf#6680,l_extendedprice_prf#6681,l_partkey_prf#6682,l_discount_prf#6683,l_partkey_and_l_suppkey_prf#6684,l_commitdate_prf#6685,l_suppkey_prf#6686,l_orderkey_prf#6687] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2158) AS rid_2#6727]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#6726]
         :        :  +- Relation[l_returnflag_prf#6707,l_orderkey_and_l_linenumber_prf#6708,l_comment_prf#6709,l_linestatus_prf#6710,rid#6711,l_shipmode_prf#6712,l_shipinstruct_prf#6713,l_quantity_prf#6714,l_receiptdate_prf#6715,l_linenumber_prf#6716,l_tax_prf#6717,l_shipdate_prf#6718,l_extendedprice_prf#6719,l_partkey_prf#6720,l_discount_prf#6721,l_partkey_and_l_suppkey_prf#6722,l_commitdate_prf#6723,l_suppkey_prf#6724,l_orderkey_prf#6725] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2158) AS rid_2#6747]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#6738: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [c_acctbal_prf#6728 AS c_acctbal_prf_1#6737, rid#6729 AS rid_1#6738, c_name_prf#6730 AS c_name_prf_1#6739, c_nationkey_prf#6731 AS c_nationkey_prf_1#6740, c_custkey_prf#6732 AS c_custkey_prf_1#6741, c_comment_prf#6733 AS c_comment_prf_1#6742, c_address_prf#6734 AS c_address_prf_1#6743, c_mktsegment_prf#6735 AS c_mktsegment_prf_1#6744, c_phone_prf#6736 AS c_phone_prf_1#6745]
            :     :  :  +- Relation[c_acctbal_prf#6728,rid#6729,c_name_prf#6730,c_nationkey_prf#6731,c_custkey_prf#6732,c_comment_prf#6733,c_address_prf#6734,c_mktsegment_prf#6735,c_phone_prf#6736] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6746]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#2231,value#2232] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2157,value#2158] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#6748 AS o_shippriority_prf_2#6758, rid#6749 AS rid_2#6759, o_orderdate_prf#6750 AS o_orderdate_prf_2#6760, o_custkey_prf#6751 AS o_custkey_prf_2#6761, o_orderpriority_prf#6752 AS o_orderpriority_prf_2#6762, o_clerk_prf#6753 AS o_clerk_prf_2#6763, o_orderstatus_prf#6754 AS o_orderstatus_prf_2#6764, o_totalprice_prf#6755 AS o_totalprice_prf_2#6765, o_orderkey_prf#6756 AS o_orderkey_prf_2#6766, o_comment_prf#6757 AS o_comment_prf_2#6767]
               +- Relation[o_shippriority_prf#6748,rid#6749,o_orderdate_prf#6750,o_custkey_prf#6751,o_orderpriority_prf#6752,o_clerk_prf#6753,o_orderstatus_prf#6754,o_totalprice_prf#6755,o_orderkey_prf#6756,o_comment_prf#6757] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 83065ms
query=fq1a, count=246415, duration=30949
query=fq1b, count=246415, duration=140720
query=fq1c, count=246415, duration=164636
query=fq1d, count=246415, duration=74498
query=fq1e, count=246415, duration=164971
query=fq1f, count=246415, duration=173665
query=fr1a, count=1214743, duration=120922
query=fr1b, count=1214743, duration=121330
query=fr1c, count=1214743, duration=83065
query=fr1d, count=1214743, duration=32901
query=fr1e, count=1214743, duration=152475
query=fr2a, count=2901744, duration=194888
query=fr2b, count=2901744, duration=105315
query=fr2d, count=2901744, duration=108218
query=fr2e, count=2901744, duration=96932
query=fr2f, count=2901744, duration=83293
query=fs1a, count=1214743, duration=108382
query=fs1b, count=1214743, duration=172947
query=fs1c, count=1214743, duration=173485
query=ft1a, count=2452200, duration=47750
query=ft1b, count=2452200, duration=30032
query=ft1c, count=2452200, duration=33320
query=ft1d, count=2452200, duration=24089
query=ft2a, count=15628, duration=49838
query=ft2b, count=15628, duration=965
query=ft2c, count=15628, duration=7218
query=ft3a, count=117754, duration=96349
query=ft3b, count=117754, duration=6211
query=ft3c, count=117754, duration=55766
