19/10/16 08:09:22 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7144ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Wed Oct 16 08:09:24 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Wed Oct 16 08:09:25 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Wed Oct 16 08:09:25 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Wed Oct 16 08:09:25 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Wed Oct 16 08:09:25 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Wed Oct 16 08:09:28 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Wed Oct 16 08:09:30 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Wed Oct 16 08:09:30 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



fq1c=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 08:09:31 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:09:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1799L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [c_nationkey#293L, o_orderkey#342L]
               :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :     :- Project [c_custkey#290L, c_nationkey#293L]
               :     :  +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
               :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               :     +- Project [o_orderkey#342L, o_custkey#343L]
               :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 08:09:31 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:09:31 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:09:31 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:09:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1799L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_1#1816]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#1806: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [rid#1801 AS rid_0#1806, n_regionkey_prf#1802 AS n_regionkey_prf_0#1807, n_nationkey_prf#1803 AS n_nationkey_prf_0#1808, n_name_prf#1804 AS n_name_prf_0#1809, n_comment_prf#1805 AS n_comment_prf_0#1810]
         :     :  :  +- Relation[rid#1801,n_regionkey_prf#1802,n_nationkey_prf#1803,n_name_prf#1804,n_comment_prf#1805] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1813]
         :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :        +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join NaturalJoin(Inner)
            :  :  :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1815) AS rid_2#1835]
            :  :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#1827: string
            :  :  :     :- Project [c_acctbal_prf#1817 AS c_acctbal_prf_1#1826, rid#1818 AS rid_1#1827, c_name_prf#1819 AS c_name_prf_1#1828, c_nationkey_prf#1820 AS c_nationkey_prf_1#1829, c_custkey_prf#1821 AS c_custkey_prf_1#1830, c_comment_prf#1822 AS c_comment_prf_1#1831, c_address_prf#1823 AS c_address_prf_1#1832, c_mktsegment_prf#1824 AS c_mktsegment_prf_1#1833, c_phone_prf#1825 AS c_phone_prf_1#1834]
            :  :  :     :  +- Relation[c_acctbal_prf#1817,rid#1818,c_name_prf#1819,c_nationkey_prf#1820,c_custkey_prf#1821,c_comment_prf#1822,c_address_prf#1823,c_mktsegment_prf#1824,c_phone_prf#1825] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
            :  :  +- Project [o_shippriority_prf#1836 AS o_shippriority_prf_2#1846, rid#1837 AS rid_2#1847, o_orderdate_prf#1838 AS o_orderdate_prf_2#1848, o_custkey_prf#1839 AS o_custkey_prf_2#1849, o_orderpriority_prf#1840 AS o_orderpriority_prf_2#1850, o_clerk_prf#1841 AS o_clerk_prf_2#1851, o_orderstatus_prf#1842 AS o_orderstatus_prf_2#1852, o_totalprice_prf#1843 AS o_totalprice_prf_2#1853, o_orderkey_prf#1844 AS o_orderkey_prf_2#1854, o_comment_prf#1845 AS o_comment_prf_2#1855]
            :  :     +- Relation[o_shippriority_prf#1836,rid#1837,o_orderdate_prf#1838,o_custkey_prf#1839,o_orderpriority_prf#1840,o_clerk_prf#1841,o_orderstatus_prf#1842,o_totalprice_prf#1843,o_orderkey_prf#1844,o_comment_prf#1845] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1815) AS rid_3#1867]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#1866]
            :        :  +- Relation[o_shippriority_prf#1856,rid#1857,o_orderdate_prf#1858,o_custkey_prf#1859,o_orderpriority_prf#1860,o_clerk_prf#1861,o_orderstatus_prf#1862,o_totalprice_prf#1863,o_orderkey_prf#1864,o_comment_prf#1865] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#1868 AS l_returnflag_prf_3#1887, l_orderkey_and_l_linenumber_prf#1869 AS l_orderkey_and_l_linenumber_prf_3#1888, l_comment_prf#1870 AS l_comment_prf_3#1889, l_linestatus_prf#1871 AS l_linestatus_prf_3#1890, rid#1872 AS rid_3#1891, l_shipmode_prf#1873 AS l_shipmode_prf_3#1892, l_shipinstruct_prf#1874 AS l_shipinstruct_prf_3#1893, l_quantity_prf#1875 AS l_quantity_prf_3#1894, l_receiptdate_prf#1876 AS l_receiptdate_prf_3#1895, l_linenumber_prf#1877 AS l_linenumber_prf_3#1896, l_tax_prf#1878 AS l_tax_prf_3#1897, l_shipdate_prf#1879 AS l_shipdate_prf_3#1898, l_extendedprice_prf#1880 AS l_extendedprice_prf_3#1899, l_partkey_prf#1881 AS l_partkey_prf_3#1900, l_discount_prf#1882 AS l_discount_prf_3#1901, l_partkey_and_l_suppkey_prf#1883 AS l_partkey_and_l_suppkey_prf_3#1902, l_commitdate_prf#1884 AS l_commitdate_prf_3#1903, l_suppkey_prf#1885 AS l_suppkey_prf_3#1904, l_orderkey_prf#1886 AS l_orderkey_prf_3#1905]
               +- Relation[l_returnflag_prf#1868,l_orderkey_and_l_linenumber_prf#1869,l_comment_prf#1870,l_linestatus_prf#1871,rid#1872,l_shipmode_prf#1873,l_shipinstruct_prf#1874,l_quantity_prf#1875,l_receiptdate_prf#1876,l_linenumber_prf#1877,l_tax_prf#1878,l_shipdate_prf#1879,l_extendedprice_prf#1880,l_partkey_prf#1881,l_discount_prf#1882,l_partkey_and_l_suppkey_prf#1883,l_commitdate_prf#1884,l_suppkey_prf#1885,l_orderkey_prf#1886] JDBCRelation(lineitem_prf) [numPartitions=1]

19/10/16 08:09:31 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=246415
Elapsed time: 232578ms

ft3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and p_size = 15 and l_suppkey = s_suppkey
19/10/16 08:13:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:13:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1984L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 08:13:24 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 08:13:24 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 08:13:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1984L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_1#2024]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#2009: string
         :  :  :     :- Project [l_returnflag_prf#1986 AS l_returnflag_prf_0#2005, l_orderkey_and_l_linenumber_prf#1987 AS l_orderkey_and_l_linenumber_prf_0#2006, l_comment_prf#1988 AS l_comment_prf_0#2007, l_linestatus_prf#1989 AS l_linestatus_prf_0#2008, rid#1990 AS rid_0#2009, l_shipmode_prf#1991 AS l_shipmode_prf_0#2010, l_shipinstruct_prf#1992 AS l_shipinstruct_prf_0#2011, l_quantity_prf#1993 AS l_quantity_prf_0#2012, l_receiptdate_prf#1994 AS l_receiptdate_prf_0#2013, l_linenumber_prf#1995 AS l_linenumber_prf_0#2014, l_tax_prf#1996 AS l_tax_prf_0#2015, l_shipdate_prf#1997 AS l_shipdate_prf_0#2016, l_extendedprice_prf#1998 AS l_extendedprice_prf_0#2017, l_partkey_prf#1999 AS l_partkey_prf_0#2018, l_discount_prf#2000 AS l_discount_prf_0#2019, l_partkey_and_l_suppkey_prf#2001 AS l_partkey_and_l_suppkey_prf_0#2020, l_commitdate_prf#2002 AS l_commitdate_prf_0#2021, l_suppkey_prf#2003 AS l_suppkey_prf_0#2022, l_orderkey_prf#2004 AS l_orderkey_prf_0#2023]
         :  :  :     :  +- Relation[l_returnflag_prf#1986,l_orderkey_and_l_linenumber_prf#1987,l_comment_prf#1988,l_linestatus_prf#1989,rid#1990,l_shipmode_prf#1991,l_shipinstruct_prf#1992,l_quantity_prf#1993,l_receiptdate_prf#1994,l_linenumber_prf#1995,l_tax_prf#1996,l_shipdate_prf#1997,l_extendedprice_prf#1998,l_partkey_prf#1999,l_discount_prf#2000,l_partkey_and_l_suppkey_prf#2001,l_commitdate_prf#2002,l_suppkey_prf#2003,l_orderkey_prf#2004] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#2025 AS p_comment_prf_1#2035, p_name_prf#2026 AS p_name_prf_1#2036, rid#2027 AS rid_1#2037, p_type_prf#2028 AS p_type_prf_1#2038, p_retailprice_prf#2029 AS p_retailprice_prf_1#2039, p_mfgr_prf#2030 AS p_mfgr_prf_1#2040, p_container_prf#2031 AS p_container_prf_1#2041, p_brand_prf#2032 AS p_brand_prf_1#2042, p_size_prf#2033 AS p_size_prf_1#2043, p_partkey_prf#2034 AS p_partkey_prf_1#2044]
         :  :     +- Relation[p_comment_prf#2025,p_name_prf#2026,rid#2027,p_type_prf#2028,p_retailprice_prf#2029,p_mfgr_prf#2030,p_container_prf#2031,p_brand_prf#2032,p_size_prf#2033,p_partkey_prf#2034] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1815) AS rid_2#2065]
         :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2064]
         :        :  +- Relation[l_returnflag_prf#2045,l_orderkey_and_l_linenumber_prf#2046,l_comment_prf#2047,l_linestatus_prf#2048,rid#2049,l_shipmode_prf#2050,l_shipinstruct_prf#2051,l_quantity_prf#2052,l_receiptdate_prf#2053,l_linenumber_prf#2054,l_tax_prf#2055,l_shipdate_prf#2056,l_extendedprice_prf#2057,l_partkey_prf#2058,l_discount_prf#2059,l_partkey_and_l_suppkey_prf#2060,l_commitdate_prf#2061,l_suppkey_prf#2062,l_orderkey_prf#2063] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2066 AS s_phone_prf_2#2074, rid#2067 AS rid_2#2075, s_address_prf#2068 AS s_address_prf_2#2076, s_nationkey_prf#2069 AS s_nationkey_prf_2#2077, s_suppkey_prf#2070 AS s_suppkey_prf_2#2078, s_name_prf#2071 AS s_name_prf_2#2079, s_acctbal_prf#2072 AS s_acctbal_prf_2#2080, s_comment_prf#2073 AS s_comment_prf_2#2081]
            +- Relation[s_phone_prf#2066,rid#2067,s_address_prf#2068,s_nationkey_prf#2069,s_suppkey_prf#2070,s_name_prf#2071,s_acctbal_prf#2072,s_comment_prf#2073] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 220884ms

fr1d=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/16 08:17:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:17:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2155L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 08:17:05 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 08:17:05 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 08:17:05 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 08:17:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2155L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_1#2176]
         :  :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2167: string
         :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :     :  :- Project [c_acctbal_prf#2157 AS c_acctbal_prf_0#2166, rid#2158 AS rid_0#2167, c_name_prf#2159 AS c_name_prf_0#2168, c_nationkey_prf#2160 AS c_nationkey_prf_0#2169, c_custkey_prf#2161 AS c_custkey_prf_0#2170, c_comment_prf#2162 AS c_comment_prf_0#2171, c_address_prf#2163 AS c_address_prf_0#2172, c_mktsegment_prf#2164 AS c_mktsegment_prf_0#2173, c_phone_prf#2165 AS c_phone_prf_0#2174]
         :  :  :     :  :  +- Relation[c_acctbal_prf#2157,rid#2158,c_name_prf#2159,c_nationkey_prf#2160,c_custkey_prf#2161,c_comment_prf#2162,c_address_prf#2163,c_mktsegment_prf#2164,c_phone_prf#2165] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2175]
         :  :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :  :  :     :        +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#2177 AS o_shippriority_prf_1#2187, rid#2178 AS rid_1#2188, o_orderdate_prf#2179 AS o_orderdate_prf_1#2189, o_custkey_prf#2180 AS o_custkey_prf_1#2190, o_orderpriority_prf#2181 AS o_orderpriority_prf_1#2191, o_clerk_prf#2182 AS o_clerk_prf_1#2192, o_orderstatus_prf#2183 AS o_orderstatus_prf_1#2193, o_totalprice_prf#2184 AS o_totalprice_prf_1#2194, o_orderkey_prf#2185 AS o_orderkey_prf_1#2195, o_comment_prf#2186 AS o_comment_prf_1#2196]
         :  :     +- Relation[o_shippriority_prf#2177,rid#2178,o_orderdate_prf#2179,o_custkey_prf#2180,o_orderpriority_prf#2181,o_clerk_prf#2182,o_orderstatus_prf#2183,o_totalprice_prf#2184,o_orderkey_prf#2185,o_comment_prf#2186] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1815) AS rid_2#2208]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2207]
         :        :  +- Relation[o_shippriority_prf#2197,rid#2198,o_orderdate_prf#2199,o_custkey_prf#2200,o_orderpriority_prf#2201,o_clerk_prf#2202,o_orderstatus_prf#2203,o_totalprice_prf#2204,o_orderkey_prf#2205,o_comment_prf#2206] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2209 AS l_returnflag_prf_2#2228, l_orderkey_and_l_linenumber_prf#2210 AS l_orderkey_and_l_linenumber_prf_2#2229, l_comment_prf#2211 AS l_comment_prf_2#2230, l_linestatus_prf#2212 AS l_linestatus_prf_2#2231, rid#2213 AS rid_2#2232, l_shipmode_prf#2214 AS l_shipmode_prf_2#2233, l_shipinstruct_prf#2215 AS l_shipinstruct_prf_2#2234, l_quantity_prf#2216 AS l_quantity_prf_2#2235, l_receiptdate_prf#2217 AS l_receiptdate_prf_2#2236, l_linenumber_prf#2218 AS l_linenumber_prf_2#2237, l_tax_prf#2219 AS l_tax_prf_2#2238, l_shipdate_prf#2220 AS l_shipdate_prf_2#2239, l_extendedprice_prf#2221 AS l_extendedprice_prf_2#2240, l_partkey_prf#2222 AS l_partkey_prf_2#2241, l_discount_prf#2223 AS l_discount_prf_2#2242, l_partkey_and_l_suppkey_prf#2224 AS l_partkey_and_l_suppkey_prf_2#2243, l_commitdate_prf#2225 AS l_commitdate_prf_2#2244, l_suppkey_prf#2226 AS l_suppkey_prf_2#2245, l_orderkey_prf#2227 AS l_orderkey_prf_2#2246]
            +- Relation[l_returnflag_prf#2209,l_orderkey_and_l_linenumber_prf#2210,l_comment_prf#2211,l_linestatus_prf#2212,rid#2213,l_shipmode_prf#2214,l_shipinstruct_prf#2215,l_quantity_prf#2216,l_receiptdate_prf#2217,l_linenumber_prf#2218,l_tax_prf#2219,l_shipdate_prf#2220,l_extendedprice_prf#2221,l_partkey_prf#2222,l_discount_prf#2223,l_partkey_and_l_suppkey_prf#2224,l_commitdate_prf#2225,l_suppkey_prf#2226,l_orderkey_prf#2227] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 152087ms

fq1a=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 08:19:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:19:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2325L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :     :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 08:19:37 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:19:37 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:19:37 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:19:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2325L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_1#2338]
         :  :  :  :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#2332: string
         :  :  :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :     :  :- Project [rid#2327 AS rid_0#2332, n_regionkey_prf#2328 AS n_regionkey_prf_0#2333, n_nationkey_prf#2329 AS n_nationkey_prf_0#2334, n_name_prf#2330 AS n_name_prf_0#2335, n_comment_prf#2331 AS n_comment_prf_0#2336]
         :  :  :  :  :     :  :  +- Relation[rid#2327,n_regionkey_prf#2328,n_nationkey_prf#2329,n_name_prf#2330,n_comment_prf#2331] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2337]
         :  :  :  :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :  :  :  :  :     :        +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :  :  :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [c_acctbal_prf#2339 AS c_acctbal_prf_1#2348, rid#2340 AS rid_1#2349, c_name_prf#2341 AS c_name_prf_1#2350, c_nationkey_prf#2342 AS c_nationkey_prf_1#2351, c_custkey_prf#2343 AS c_custkey_prf_1#2352, c_comment_prf#2344 AS c_comment_prf_1#2353, c_address_prf#2345 AS c_address_prf_1#2354, c_mktsegment_prf#2346 AS c_mktsegment_prf_1#2355, c_phone_prf#2347 AS c_phone_prf_1#2356]
         :  :  :  :     +- Relation[c_acctbal_prf#2339,rid#2340,c_name_prf#2341,c_nationkey_prf#2342,c_custkey_prf#2343,c_comment_prf#2344,c_address_prf#2345,c_mktsegment_prf#2346,c_phone_prf#2347] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1815) AS rid_2#2367]
         :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :  :  :        :- 'Project ['rid AS rid_1#2366]
         :  :  :        :  +- Relation[c_acctbal_prf#2357,rid#2358,c_name_prf#2359,c_nationkey_prf#2360,c_custkey_prf#2361,c_comment_prf#2362,c_address_prf#2363,c_mktsegment_prf#2364,c_phone_prf#2365] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :        +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#2368 AS o_shippriority_prf_2#2378, rid#2369 AS rid_2#2379, o_orderdate_prf#2370 AS o_orderdate_prf_2#2380, o_custkey_prf#2371 AS o_custkey_prf_2#2381, o_orderpriority_prf#2372 AS o_orderpriority_prf_2#2382, o_clerk_prf#2373 AS o_clerk_prf_2#2383, o_orderstatus_prf#2374 AS o_orderstatus_prf_2#2384, o_totalprice_prf#2375 AS o_totalprice_prf_2#2385, o_orderkey_prf#2376 AS o_orderkey_prf_2#2386, o_comment_prf#2377 AS o_comment_prf_2#2387]
         :  :     +- Relation[o_shippriority_prf#2368,rid#2369,o_orderdate_prf#2370,o_custkey_prf#2371,o_orderpriority_prf#2372,o_clerk_prf#2373,o_orderstatus_prf#2374,o_totalprice_prf#2375,o_orderkey_prf#2376,o_comment_prf#2377] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1815) AS rid_3#2399]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#2398]
         :        :  +- Relation[o_shippriority_prf#2388,rid#2389,o_orderdate_prf#2390,o_custkey_prf#2391,o_orderpriority_prf#2392,o_clerk_prf#2393,o_orderstatus_prf#2394,o_totalprice_prf#2395,o_orderkey_prf#2396,o_comment_prf#2397] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2400 AS l_returnflag_prf_3#2419, l_orderkey_and_l_linenumber_prf#2401 AS l_orderkey_and_l_linenumber_prf_3#2420, l_comment_prf#2402 AS l_comment_prf_3#2421, l_linestatus_prf#2403 AS l_linestatus_prf_3#2422, rid#2404 AS rid_3#2423, l_shipmode_prf#2405 AS l_shipmode_prf_3#2424, l_shipinstruct_prf#2406 AS l_shipinstruct_prf_3#2425, l_quantity_prf#2407 AS l_quantity_prf_3#2426, l_receiptdate_prf#2408 AS l_receiptdate_prf_3#2427, l_linenumber_prf#2409 AS l_linenumber_prf_3#2428, l_tax_prf#2410 AS l_tax_prf_3#2429, l_shipdate_prf#2411 AS l_shipdate_prf_3#2430, l_extendedprice_prf#2412 AS l_extendedprice_prf_3#2431, l_partkey_prf#2413 AS l_partkey_prf_3#2432, l_discount_prf#2414 AS l_discount_prf_3#2433, l_partkey_and_l_suppkey_prf#2415 AS l_partkey_and_l_suppkey_prf_3#2434, l_commitdate_prf#2416 AS l_commitdate_prf_3#2435, l_suppkey_prf#2417 AS l_suppkey_prf_3#2436, l_orderkey_prf#2418 AS l_orderkey_prf_3#2437]
            +- Relation[l_returnflag_prf#2400,l_orderkey_and_l_linenumber_prf#2401,l_comment_prf#2402,l_linestatus_prf#2403,rid#2404,l_shipmode_prf#2405,l_shipinstruct_prf#2406,l_quantity_prf#2407,l_receiptdate_prf#2408,l_linenumber_prf#2409,l_tax_prf#2410,l_shipdate_prf#2411,l_extendedprice_prf#2412,l_partkey_prf#2413,l_discount_prf#2414,l_partkey_and_l_suppkey_prf#2415,l_commitdate_prf#2416,l_suppkey_prf#2417,l_orderkey_prf#2418] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 163595ms

ft2b=
select * from part, partsupp, supplier where p_size = 15 and p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/16 08:22:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:22:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2505L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 08:22:20 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 08:22:20 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 08:22:20 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 08:22:20 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 08:22:20 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 08:22:20 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 08:22:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2505L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_1#2528]
         :  :  :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2519: string
         :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :     :  :- Project [p_comment_prf#2507 AS p_comment_prf_0#2517, p_name_prf#2508 AS p_name_prf_0#2518, rid#2509 AS rid_0#2519, p_type_prf#2510 AS p_type_prf_0#2520, p_retailprice_prf#2511 AS p_retailprice_prf_0#2521, p_mfgr_prf#2512 AS p_mfgr_prf_0#2522, p_container_prf#2513 AS p_container_prf_0#2523, p_brand_prf#2514 AS p_brand_prf_0#2524, p_size_prf#2515 AS p_size_prf_0#2525, p_partkey_prf#2516 AS p_partkey_prf_0#2526]
         :  :  :     :  :  +- Relation[p_comment_prf#2507,p_name_prf#2508,rid#2509,p_type_prf#2510,p_retailprice_prf#2511,p_mfgr_prf#2512,p_container_prf#2513,p_brand_prf#2514,p_size_prf#2515,p_partkey_prf#2516] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2527]
         :  :  :     :     +- DexRidFilter part~p_size~15
         :  :  :     :        +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#2529 AS ps_partkey_and_ps_suppkey_prf_1#2536, rid#2530 AS rid_1#2537, ps_availqty_prf#2531 AS ps_availqty_prf_1#2538, ps_comment_prf#2532 AS ps_comment_prf_1#2539, ps_partkey_prf#2533 AS ps_partkey_prf_1#2540, ps_supplycost_prf#2534 AS ps_supplycost_prf_1#2541, ps_suppkey_prf#2535 AS ps_suppkey_prf_1#2542]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#2529,rid#2530,ps_availqty_prf#2531,ps_comment_prf#2532,ps_partkey_prf#2533,ps_supplycost_prf#2534,ps_suppkey_prf#2535] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1815) AS rid_2#2551]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2550]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#2543,rid#2544,ps_availqty_prf#2545,ps_comment_prf#2546,ps_partkey_prf#2547,ps_supplycost_prf#2548,ps_suppkey_prf#2549] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2552 AS s_phone_prf_2#2560, rid#2553 AS rid_2#2561, s_address_prf#2554 AS s_address_prf_2#2562, s_nationkey_prf#2555 AS s_nationkey_prf_2#2563, s_suppkey_prf#2556 AS s_suppkey_prf_2#2564, s_name_prf#2557 AS s_name_prf_2#2565, s_acctbal_prf#2558 AS s_acctbal_prf_2#2566, s_comment_prf#2559 AS s_comment_prf_2#2567]
            +- Relation[s_phone_prf#2552,rid#2553,s_address_prf#2554,s_nationkey_prf#2555,s_suppkey_prf#2556,s_name_prf#2557,s_acctbal_prf#2558,s_comment_prf#2559] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 46239ms

ft2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and (p_size = 15 and s_suppkey = ps_suppkey)
19/10/16 08:23:07 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:23:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2617L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/16 08:23:07 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 08:23:07 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 08:23:07 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 08:23:07 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 08:23:07 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 08:23:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2617L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_2#2635]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#2628: string
         :     :- Project [s_phone_prf#2619 AS s_phone_prf_0#2627, rid#2620 AS rid_0#2628, s_address_prf#2621 AS s_address_prf_0#2629, s_nationkey_prf#2622 AS s_nationkey_prf_0#2630, s_suppkey_prf#2623 AS s_suppkey_prf_0#2631, s_name_prf#2624 AS s_name_prf_0#2632, s_acctbal_prf#2625 AS s_acctbal_prf_0#2633, s_comment_prf#2626 AS s_comment_prf_0#2634]
         :     :  +- Relation[s_phone_prf#2619,rid#2620,s_address_prf#2621,s_nationkey_prf#2622,s_suppkey_prf#2623,s_name_prf#2624,s_acctbal_prf#2625,s_comment_prf#2626] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1815) AS rid_2#2657]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#2648: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#2636 AS p_comment_prf_1#2646, p_name_prf#2637 AS p_name_prf_1#2647, rid#2638 AS rid_1#2648, p_type_prf#2639 AS p_type_prf_1#2649, p_retailprice_prf#2640 AS p_retailprice_prf_1#2650, p_mfgr_prf#2641 AS p_mfgr_prf_1#2651, p_container_prf#2642 AS p_container_prf_1#2652, p_brand_prf#2643 AS p_brand_prf_1#2653, p_size_prf#2644 AS p_size_prf_1#2654, p_partkey_prf#2645 AS p_partkey_prf_1#2655]
            :     :  :  +- Relation[p_comment_prf#2636,p_name_prf#2637,rid#2638,p_type_prf#2639,p_retailprice_prf#2640,p_mfgr_prf#2641,p_container_prf#2642,p_brand_prf#2643,p_size_prf#2644,p_partkey_prf#2645] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2656]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#2658 AS ps_partkey_and_ps_suppkey_prf_2#2665, rid#2659 AS rid_2#2666, ps_availqty_prf#2660 AS ps_availqty_prf_2#2667, ps_comment_prf#2661 AS ps_comment_prf_2#2668, ps_partkey_prf#2662 AS ps_partkey_prf_2#2669, ps_supplycost_prf#2663 AS ps_supplycost_prf_2#2670, ps_suppkey_prf#2664 AS ps_suppkey_prf_2#2671]
               +- Relation[ps_partkey_and_ps_suppkey_prf#2658,rid#2659,ps_availqty_prf#2660,ps_comment_prf#2661,ps_partkey_prf#2662,ps_supplycost_prf#2663,ps_suppkey_prf#2664] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 7590ms

ft1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_name = 'FRANCE' and n_nationkey = c_nationkey
19/10/16 08:23:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:23:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2719L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 08:23:14 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 08:23:14 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 08:23:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:23:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:23:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:23:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:23:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:23:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2719L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_1#2737]
         :  :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#2730: string
         :  :  :     :- Project [s_phone_prf#2721 AS s_phone_prf_0#2729, rid#2722 AS rid_0#2730, s_address_prf#2723 AS s_address_prf_0#2731, s_nationkey_prf#2724 AS s_nationkey_prf_0#2732, s_suppkey_prf#2725 AS s_suppkey_prf_0#2733, s_name_prf#2726 AS s_name_prf_0#2734, s_acctbal_prf#2727 AS s_acctbal_prf_0#2735, s_comment_prf#2728 AS s_comment_prf_0#2736]
         :  :  :     :  +- Relation[s_phone_prf#2721,rid#2722,s_address_prf#2723,s_nationkey_prf#2724,s_suppkey_prf#2725,s_name_prf#2726,s_acctbal_prf#2727,s_comment_prf#2728] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :     :- Project [rid#2738 AS rid_1#2743, n_regionkey_prf#2739 AS n_regionkey_prf_1#2744, n_nationkey_prf#2740 AS n_nationkey_prf_1#2745, n_name_prf#2741 AS n_name_prf_1#2746, n_comment_prf#2742 AS n_comment_prf_1#2747]
         :  :     :  +- Relation[rid#2738,n_regionkey_prf#2739,n_nationkey_prf#2740,n_name_prf#2741,n_comment_prf#2742] JDBCRelation(nation_prf) [numPartitions=1]
         :  :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2748]
         :  :        +- DexRidFilter nation~n_name~FRANCE
         :  :           +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1815) AS rid_2#2755]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2754]
         :        :  +- Relation[rid#2749,n_regionkey_prf#2750,n_nationkey_prf#2751,n_name_prf#2752,n_comment_prf#2753] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2756 AS c_acctbal_prf_2#2765, rid#2757 AS rid_2#2766, c_name_prf#2758 AS c_name_prf_2#2767, c_nationkey_prf#2759 AS c_nationkey_prf_2#2768, c_custkey_prf#2760 AS c_custkey_prf_2#2769, c_comment_prf#2761 AS c_comment_prf_2#2770, c_address_prf#2762 AS c_address_prf_2#2771, c_mktsegment_prf#2763 AS c_mktsegment_prf_2#2772, c_phone_prf#2764 AS c_phone_prf_2#2773]
            +- Relation[c_acctbal_prf#2756,rid#2757,c_name_prf#2758,c_nationkey_prf#2759,c_custkey_prf#2760,c_comment_prf#2761,c_address_prf#2762,c_mktsegment_prf#2763,c_phone_prf#2764] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 1488ms

fr1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and (c_mktsegment = 'BUILDING' and l_orderkey = o_orderkey)
19/10/16 08:23:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:23:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2832L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 08:23:16 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 08:23:16 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 08:23:16 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 08:23:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2832L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_2#2872]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2857: string
         :     :- Project [l_returnflag_prf#2834 AS l_returnflag_prf_0#2853, l_orderkey_and_l_linenumber_prf#2835 AS l_orderkey_and_l_linenumber_prf_0#2854, l_comment_prf#2836 AS l_comment_prf_0#2855, l_linestatus_prf#2837 AS l_linestatus_prf_0#2856, rid#2838 AS rid_0#2857, l_shipmode_prf#2839 AS l_shipmode_prf_0#2858, l_shipinstruct_prf#2840 AS l_shipinstruct_prf_0#2859, l_quantity_prf#2841 AS l_quantity_prf_0#2860, l_receiptdate_prf#2842 AS l_receiptdate_prf_0#2861, l_linenumber_prf#2843 AS l_linenumber_prf_0#2862, l_tax_prf#2844 AS l_tax_prf_0#2863, l_shipdate_prf#2845 AS l_shipdate_prf_0#2864, l_extendedprice_prf#2846 AS l_extendedprice_prf_0#2865, l_partkey_prf#2847 AS l_partkey_prf_0#2866, l_discount_prf#2848 AS l_discount_prf_0#2867, l_partkey_and_l_suppkey_prf#2849 AS l_partkey_and_l_suppkey_prf_0#2868, l_commitdate_prf#2850 AS l_commitdate_prf_0#2869, l_suppkey_prf#2851 AS l_suppkey_prf_0#2870, l_orderkey_prf#2852 AS l_orderkey_prf_0#2871]
         :     :  +- Relation[l_returnflag_prf#2834,l_orderkey_and_l_linenumber_prf#2835,l_comment_prf#2836,l_linestatus_prf#2837,rid#2838,l_shipmode_prf#2839,l_shipinstruct_prf#2840,l_quantity_prf#2841,l_receiptdate_prf#2842,l_linenumber_prf#2843,l_tax_prf#2844,l_shipdate_prf#2845,l_extendedprice_prf#2846,l_partkey_prf#2847,l_discount_prf#2848,l_partkey_and_l_suppkey_prf#2849,l_commitdate_prf#2850,l_suppkey_prf#2851,l_orderkey_prf#2852] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1815) AS rid_2#2892]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#2883: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [c_acctbal_prf#2873 AS c_acctbal_prf_1#2882, rid#2874 AS rid_1#2883, c_name_prf#2875 AS c_name_prf_1#2884, c_nationkey_prf#2876 AS c_nationkey_prf_1#2885, c_custkey_prf#2877 AS c_custkey_prf_1#2886, c_comment_prf#2878 AS c_comment_prf_1#2887, c_address_prf#2879 AS c_address_prf_1#2888, c_mktsegment_prf#2880 AS c_mktsegment_prf_1#2889, c_phone_prf#2881 AS c_phone_prf_1#2890]
            :     :  :  +- Relation[c_acctbal_prf#2873,rid#2874,c_name_prf#2875,c_nationkey_prf#2876,c_custkey_prf#2877,c_comment_prf#2878,c_address_prf#2879,c_mktsegment_prf#2880,c_phone_prf#2881] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2891]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2893 AS o_shippriority_prf_2#2903, rid#2894 AS rid_2#2904, o_orderdate_prf#2895 AS o_orderdate_prf_2#2905, o_custkey_prf#2896 AS o_custkey_prf_2#2906, o_orderpriority_prf#2897 AS o_orderpriority_prf_2#2907, o_clerk_prf#2898 AS o_clerk_prf_2#2908, o_orderstatus_prf#2899 AS o_orderstatus_prf_2#2909, o_totalprice_prf#2900 AS o_totalprice_prf_2#2910, o_orderkey_prf#2901 AS o_orderkey_prf_2#2911, o_comment_prf#2902 AS o_comment_prf_2#2912]
               +- Relation[o_shippriority_prf#2893,rid#2894,o_orderdate_prf#2895,o_custkey_prf#2896,o_orderpriority_prf#2897,o_clerk_prf#2898,o_orderstatus_prf#2899,o_totalprice_prf#2900,o_orderkey_prf#2901,o_comment_prf#2902] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 99356ms

ft2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and p_size = 15 and ps_suppkey = s_suppkey
19/10/16 08:24:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:24:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2975L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 08:24:55 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 08:24:55 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 08:24:55 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 08:24:55 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 08:24:55 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 08:24:55 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 08:24:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2975L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_1#2991]
         :  :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#2985: string
         :  :  :     :- Project [ps_partkey_and_ps_suppkey_prf#2977 AS ps_partkey_and_ps_suppkey_prf_0#2984, rid#2978 AS rid_0#2985, ps_availqty_prf#2979 AS ps_availqty_prf_0#2986, ps_comment_prf#2980 AS ps_comment_prf_0#2987, ps_partkey_prf#2981 AS ps_partkey_prf_0#2988, ps_supplycost_prf#2982 AS ps_supplycost_prf_0#2989, ps_suppkey_prf#2983 AS ps_suppkey_prf_0#2990]
         :  :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2977,rid#2978,ps_availqty_prf#2979,ps_comment_prf#2980,ps_partkey_prf#2981,ps_supplycost_prf#2982,ps_suppkey_prf#2983] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :     :- Project [p_comment_prf#2992 AS p_comment_prf_1#3002, p_name_prf#2993 AS p_name_prf_1#3003, rid#2994 AS rid_1#3004, p_type_prf#2995 AS p_type_prf_1#3005, p_retailprice_prf#2996 AS p_retailprice_prf_1#3006, p_mfgr_prf#2997 AS p_mfgr_prf_1#3007, p_container_prf#2998 AS p_container_prf_1#3008, p_brand_prf#2999 AS p_brand_prf_1#3009, p_size_prf#3000 AS p_size_prf_1#3010, p_partkey_prf#3001 AS p_partkey_prf_1#3011]
         :  :     :  +- Relation[p_comment_prf#2992,p_name_prf#2993,rid#2994,p_type_prf#2995,p_retailprice_prf#2996,p_mfgr_prf#2997,p_container_prf#2998,p_brand_prf#2999,p_size_prf#3000,p_partkey_prf#3001] JDBCRelation(part_prf) [numPartitions=1]
         :  :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3012]
         :  :        +- DexRidFilter part~p_size~15
         :  :           +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1815) AS rid_2#3021]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3020]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#3013,rid#3014,ps_availqty_prf#3015,ps_comment_prf#3016,ps_partkey_prf#3017,ps_supplycost_prf#3018,ps_suppkey_prf#3019] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3022 AS s_phone_prf_2#3030, rid#3023 AS rid_2#3031, s_address_prf#3024 AS s_address_prf_2#3032, s_nationkey_prf#3025 AS s_nationkey_prf_2#3033, s_suppkey_prf#3026 AS s_suppkey_prf_2#3034, s_name_prf#3027 AS s_name_prf_2#3035, s_acctbal_prf#3028 AS s_acctbal_prf_2#3036, s_comment_prf#3029 AS s_comment_prf_2#3037]
            +- Relation[s_phone_prf#3022,rid#3023,s_address_prf#3024,s_nationkey_prf#3025,s_suppkey_prf#3026,s_name_prf#3027,s_acctbal_prf#3028,s_comment_prf#3029] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 102278ms

fr2d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderstatus = 'F' and o_orderkey = l_orderkey
19/10/16 08:26:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:26:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3099L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 08:26:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3099L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_1#3119]
         :  :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3111: string
         :  :  :     :- Project [c_acctbal_prf#3101 AS c_acctbal_prf_0#3110, rid#3102 AS rid_0#3111, c_name_prf#3103 AS c_name_prf_0#3112, c_nationkey_prf#3104 AS c_nationkey_prf_0#3113, c_custkey_prf#3105 AS c_custkey_prf_0#3114, c_comment_prf#3106 AS c_comment_prf_0#3115, c_address_prf#3107 AS c_address_prf_0#3116, c_mktsegment_prf#3108 AS c_mktsegment_prf_0#3117, c_phone_prf#3109 AS c_phone_prf_0#3118]
         :  :  :     :  +- Relation[c_acctbal_prf#3101,rid#3102,c_name_prf#3103,c_nationkey_prf#3104,c_custkey_prf#3105,c_comment_prf#3106,c_address_prf#3107,c_mktsegment_prf#3108,c_phone_prf#3109] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :     :- Project [o_shippriority_prf#3120 AS o_shippriority_prf_1#3130, rid#3121 AS rid_1#3131, o_orderdate_prf#3122 AS o_orderdate_prf_1#3132, o_custkey_prf#3123 AS o_custkey_prf_1#3133, o_orderpriority_prf#3124 AS o_orderpriority_prf_1#3134, o_clerk_prf#3125 AS o_clerk_prf_1#3135, o_orderstatus_prf#3126 AS o_orderstatus_prf_1#3136, o_totalprice_prf#3127 AS o_totalprice_prf_1#3137, o_orderkey_prf#3128 AS o_orderkey_prf_1#3138, o_comment_prf#3129 AS o_comment_prf_1#3139]
         :  :     :  +- Relation[o_shippriority_prf#3120,rid#3121,o_orderdate_prf#3122,o_custkey_prf#3123,o_orderpriority_prf#3124,o_clerk_prf#3125,o_orderstatus_prf#3126,o_totalprice_prf#3127,o_orderkey_prf#3128,o_comment_prf#3129] JDBCRelation(orders_prf) [numPartitions=1]
         :  :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3140]
         :  :        +- DexRidFilter orders~o_orderstatus~F
         :  :           +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1815) AS rid_2#3152]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3151]
         :        :  +- Relation[o_shippriority_prf#3141,rid#3142,o_orderdate_prf#3143,o_custkey_prf#3144,o_orderpriority_prf#3145,o_clerk_prf#3146,o_orderstatus_prf#3147,o_totalprice_prf#3148,o_orderkey_prf#3149,o_comment_prf#3150] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3153 AS l_returnflag_prf_2#3172, l_orderkey_and_l_linenumber_prf#3154 AS l_orderkey_and_l_linenumber_prf_2#3173, l_comment_prf#3155 AS l_comment_prf_2#3174, l_linestatus_prf#3156 AS l_linestatus_prf_2#3175, rid#3157 AS rid_2#3176, l_shipmode_prf#3158 AS l_shipmode_prf_2#3177, l_shipinstruct_prf#3159 AS l_shipinstruct_prf_2#3178, l_quantity_prf#3160 AS l_quantity_prf_2#3179, l_receiptdate_prf#3161 AS l_receiptdate_prf_2#3180, l_linenumber_prf#3162 AS l_linenumber_prf_2#3181, l_tax_prf#3163 AS l_tax_prf_2#3182, l_shipdate_prf#3164 AS l_shipdate_prf_2#3183, l_extendedprice_prf#3165 AS l_extendedprice_prf_2#3184, l_partkey_prf#3166 AS l_partkey_prf_2#3185, l_discount_prf#3167 AS l_discount_prf_2#3186, l_partkey_and_l_suppkey_prf#3168 AS l_partkey_and_l_suppkey_prf_2#3187, l_commitdate_prf#3169 AS l_commitdate_prf_2#3188, l_suppkey_prf#3170 AS l_suppkey_prf_2#3189, l_orderkey_prf#3171 AS l_orderkey_prf_2#3190]
            +- Relation[l_returnflag_prf#3153,l_orderkey_and_l_linenumber_prf#3154,l_comment_prf#3155,l_linestatus_prf#3156,rid#3157,l_shipmode_prf#3158,l_shipinstruct_prf#3159,l_quantity_prf#3160,l_receiptdate_prf#3161,l_linenumber_prf#3162,l_tax_prf#3163,l_shipdate_prf#3164,l_extendedprice_prf#3165,l_partkey_prf#3166,l_discount_prf#3167,l_partkey_and_l_suppkey_prf#3168,l_commitdate_prf#3169,l_suppkey_prf#3170,l_orderkey_prf#3171] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 207017ms

fq1e=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 08:30:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:30:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3269L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [c_custkey#290L, c_nationkey#293L]
                  +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 08:30:04 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:30:04 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:30:04 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:30:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3269L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_1#3309]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3294: string
         :  :  :     :- Project [l_returnflag_prf#3271 AS l_returnflag_prf_0#3290, l_orderkey_and_l_linenumber_prf#3272 AS l_orderkey_and_l_linenumber_prf_0#3291, l_comment_prf#3273 AS l_comment_prf_0#3292, l_linestatus_prf#3274 AS l_linestatus_prf_0#3293, rid#3275 AS rid_0#3294, l_shipmode_prf#3276 AS l_shipmode_prf_0#3295, l_shipinstruct_prf#3277 AS l_shipinstruct_prf_0#3296, l_quantity_prf#3278 AS l_quantity_prf_0#3297, l_receiptdate_prf#3279 AS l_receiptdate_prf_0#3298, l_linenumber_prf#3280 AS l_linenumber_prf_0#3299, l_tax_prf#3281 AS l_tax_prf_0#3300, l_shipdate_prf#3282 AS l_shipdate_prf_0#3301, l_extendedprice_prf#3283 AS l_extendedprice_prf_0#3302, l_partkey_prf#3284 AS l_partkey_prf_0#3303, l_discount_prf#3285 AS l_discount_prf_0#3304, l_partkey_and_l_suppkey_prf#3286 AS l_partkey_and_l_suppkey_prf_0#3305, l_commitdate_prf#3287 AS l_commitdate_prf_0#3306, l_suppkey_prf#3288 AS l_suppkey_prf_0#3307, l_orderkey_prf#3289 AS l_orderkey_prf_0#3308]
         :  :  :     :  +- Relation[l_returnflag_prf#3271,l_orderkey_and_l_linenumber_prf#3272,l_comment_prf#3273,l_linestatus_prf#3274,rid#3275,l_shipmode_prf#3276,l_shipinstruct_prf#3277,l_quantity_prf#3278,l_receiptdate_prf#3279,l_linenumber_prf#3280,l_tax_prf#3281,l_shipdate_prf#3282,l_extendedprice_prf#3283,l_partkey_prf#3284,l_discount_prf#3285,l_partkey_and_l_suppkey_prf#3286,l_commitdate_prf#3287,l_suppkey_prf#3288,l_orderkey_prf#3289] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#3310 AS o_shippriority_prf_1#3320, rid#3311 AS rid_1#3321, o_orderdate_prf#3312 AS o_orderdate_prf_1#3322, o_custkey_prf#3313 AS o_custkey_prf_1#3323, o_orderpriority_prf#3314 AS o_orderpriority_prf_1#3324, o_clerk_prf#3315 AS o_clerk_prf_1#3325, o_orderstatus_prf#3316 AS o_orderstatus_prf_1#3326, o_totalprice_prf#3317 AS o_totalprice_prf_1#3327, o_orderkey_prf#3318 AS o_orderkey_prf_1#3328, o_comment_prf#3319 AS o_comment_prf_1#3329]
         :  :     +- Relation[o_shippriority_prf#3310,rid#3311,o_orderdate_prf#3312,o_custkey_prf#3313,o_orderpriority_prf#3314,o_clerk_prf#3315,o_orderstatus_prf#3316,o_totalprice_prf#3317,o_orderkey_prf#3318,o_comment_prf#3319] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1815) AS rid_3#3341]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3340]
         :        :  +- Relation[o_shippriority_prf#3330,rid#3331,o_orderdate_prf#3332,o_custkey_prf#3333,o_orderpriority_prf#3334,o_clerk_prf#3335,o_orderstatus_prf#3336,o_totalprice_prf#3337,o_orderkey_prf#3338,o_comment_prf#3339] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_2, 'n_regionkey_prf_2, 'n_nationkey_prf_2, 'n_name_prf_2, 'n_comment_prf_2, dexdecrypt('value_dec_key, value#1815) AS rid_3#3353]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_2#3347: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [rid#3342 AS rid_2#3347, n_regionkey_prf#3343 AS n_regionkey_prf_2#3348, n_nationkey_prf#3344 AS n_nationkey_prf_2#3349, n_name_prf#3345 AS n_name_prf_2#3350, n_comment_prf#3346 AS n_comment_prf_2#3351]
            :     :  :  +- Relation[rid#3342,n_regionkey_prf#3343,n_nationkey_prf#3344,n_name_prf#3345,n_comment_prf#3346] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#3352]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#3354 AS c_acctbal_prf_3#3363, rid#3355 AS rid_3#3364, c_name_prf#3356 AS c_name_prf_3#3365, c_nationkey_prf#3357 AS c_nationkey_prf_3#3366, c_custkey_prf#3358 AS c_custkey_prf_3#3367, c_comment_prf#3359 AS c_comment_prf_3#3368, c_address_prf#3360 AS c_address_prf_3#3369, c_mktsegment_prf#3361 AS c_mktsegment_prf_3#3370, c_phone_prf#3362 AS c_phone_prf_3#3371]
               +- Relation[c_acctbal_prf#3354,rid#3355,c_name_prf#3356,c_nationkey_prf#3357,c_custkey_prf#3358,c_comment_prf#3359,c_address_prf#3360,c_mktsegment_prf#3361,c_phone_prf#3362] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 181530ms

fr2a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_orderstatus = 'F' and o_custkey = c_custkey
19/10/16 08:33:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:33:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3451L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 08:33:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3451L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_1#3491]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3476: string
         :  :  :     :- Project [l_returnflag_prf#3453 AS l_returnflag_prf_0#3472, l_orderkey_and_l_linenumber_prf#3454 AS l_orderkey_and_l_linenumber_prf_0#3473, l_comment_prf#3455 AS l_comment_prf_0#3474, l_linestatus_prf#3456 AS l_linestatus_prf_0#3475, rid#3457 AS rid_0#3476, l_shipmode_prf#3458 AS l_shipmode_prf_0#3477, l_shipinstruct_prf#3459 AS l_shipinstruct_prf_0#3478, l_quantity_prf#3460 AS l_quantity_prf_0#3479, l_receiptdate_prf#3461 AS l_receiptdate_prf_0#3480, l_linenumber_prf#3462 AS l_linenumber_prf_0#3481, l_tax_prf#3463 AS l_tax_prf_0#3482, l_shipdate_prf#3464 AS l_shipdate_prf_0#3483, l_extendedprice_prf#3465 AS l_extendedprice_prf_0#3484, l_partkey_prf#3466 AS l_partkey_prf_0#3485, l_discount_prf#3467 AS l_discount_prf_0#3486, l_partkey_and_l_suppkey_prf#3468 AS l_partkey_and_l_suppkey_prf_0#3487, l_commitdate_prf#3469 AS l_commitdate_prf_0#3488, l_suppkey_prf#3470 AS l_suppkey_prf_0#3489, l_orderkey_prf#3471 AS l_orderkey_prf_0#3490]
         :  :  :     :  +- Relation[l_returnflag_prf#3453,l_orderkey_and_l_linenumber_prf#3454,l_comment_prf#3455,l_linestatus_prf#3456,rid#3457,l_shipmode_prf#3458,l_shipinstruct_prf#3459,l_quantity_prf#3460,l_receiptdate_prf#3461,l_linenumber_prf#3462,l_tax_prf#3463,l_shipdate_prf#3464,l_extendedprice_prf#3465,l_partkey_prf#3466,l_discount_prf#3467,l_partkey_and_l_suppkey_prf#3468,l_commitdate_prf#3469,l_suppkey_prf#3470,l_orderkey_prf#3471] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :     :- Project [o_shippriority_prf#3492 AS o_shippriority_prf_1#3502, rid#3493 AS rid_1#3503, o_orderdate_prf#3494 AS o_orderdate_prf_1#3504, o_custkey_prf#3495 AS o_custkey_prf_1#3505, o_orderpriority_prf#3496 AS o_orderpriority_prf_1#3506, o_clerk_prf#3497 AS o_clerk_prf_1#3507, o_orderstatus_prf#3498 AS o_orderstatus_prf_1#3508, o_totalprice_prf#3499 AS o_totalprice_prf_1#3509, o_orderkey_prf#3500 AS o_orderkey_prf_1#3510, o_comment_prf#3501 AS o_comment_prf_1#3511]
         :  :     :  +- Relation[o_shippriority_prf#3492,rid#3493,o_orderdate_prf#3494,o_custkey_prf#3495,o_orderpriority_prf#3496,o_clerk_prf#3497,o_orderstatus_prf#3498,o_totalprice_prf#3499,o_orderkey_prf#3500,o_comment_prf#3501] JDBCRelation(orders_prf) [numPartitions=1]
         :  :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3512]
         :  :        +- DexRidFilter orders~o_orderstatus~F
         :  :           +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1815) AS rid_2#3524]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3523]
         :        :  +- Relation[o_shippriority_prf#3513,rid#3514,o_orderdate_prf#3515,o_custkey_prf#3516,o_orderpriority_prf#3517,o_clerk_prf#3518,o_orderstatus_prf#3519,o_totalprice_prf#3520,o_orderkey_prf#3521,o_comment_prf#3522] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3525 AS c_acctbal_prf_2#3534, rid#3526 AS rid_2#3535, c_name_prf#3527 AS c_name_prf_2#3536, c_nationkey_prf#3528 AS c_nationkey_prf_2#3537, c_custkey_prf#3529 AS c_custkey_prf_2#3538, c_comment_prf#3530 AS c_comment_prf_2#3539, c_address_prf#3531 AS c_address_prf_2#3540, c_mktsegment_prf#3532 AS c_mktsegment_prf_2#3541, c_phone_prf#3533 AS c_phone_prf_2#3542]
            +- Relation[c_acctbal_prf#3525,rid#3526,c_name_prf#3527,c_nationkey_prf#3528,c_custkey_prf#3529,c_comment_prf#3530,c_address_prf#3531,c_mktsegment_prf#3532,c_phone_prf#3533] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 174284ms

fr2f=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/16 08:36:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:36:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3617L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_orderkey#342L, o_custkey#343L]
         :     :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L]
         :        +- Filter isnotnull(c_custkey#290L)
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 08:36:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3617L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_1#3640]
         :  :  :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_0#3630: string
         :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :     :  :- Project [o_shippriority_prf#3619 AS o_shippriority_prf_0#3629, rid#3620 AS rid_0#3630, o_orderdate_prf#3621 AS o_orderdate_prf_0#3631, o_custkey_prf#3622 AS o_custkey_prf_0#3632, o_orderpriority_prf#3623 AS o_orderpriority_prf_0#3633, o_clerk_prf#3624 AS o_clerk_prf_0#3634, o_orderstatus_prf#3625 AS o_orderstatus_prf_0#3635, o_totalprice_prf#3626 AS o_totalprice_prf_0#3636, o_orderkey_prf#3627 AS o_orderkey_prf_0#3637, o_comment_prf#3628 AS o_comment_prf_0#3638]
         :  :  :     :  :  +- Relation[o_shippriority_prf#3619,rid#3620,o_orderdate_prf#3621,o_custkey_prf#3622,o_orderpriority_prf#3623,o_clerk_prf#3624,o_orderstatus_prf#3625,o_totalprice_prf#3626,o_orderkey_prf#3627,o_comment_prf#3628] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3639]
         :  :  :     :     +- DexRidFilter orders~o_orderstatus~F
         :  :  :     :        +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#3641 AS c_acctbal_prf_1#3650, rid#3642 AS rid_1#3651, c_name_prf#3643 AS c_name_prf_1#3652, c_nationkey_prf#3644 AS c_nationkey_prf_1#3653, c_custkey_prf#3645 AS c_custkey_prf_1#3654, c_comment_prf#3646 AS c_comment_prf_1#3655, c_address_prf#3647 AS c_address_prf_1#3656, c_mktsegment_prf#3648 AS c_mktsegment_prf_1#3657, c_phone_prf#3649 AS c_phone_prf_1#3658]
         :  :     +- Relation[c_acctbal_prf#3641,rid#3642,c_name_prf#3643,c_nationkey_prf#3644,c_custkey_prf#3645,c_comment_prf#3646,c_address_prf#3647,c_mktsegment_prf#3648,c_phone_prf#3649] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1815) AS rid_2#3670]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3669]
         :        :  +- Relation[o_shippriority_prf#3659,rid#3660,o_orderdate_prf#3661,o_custkey_prf#3662,o_orderpriority_prf#3663,o_clerk_prf#3664,o_orderstatus_prf#3665,o_totalprice_prf#3666,o_orderkey_prf#3667,o_comment_prf#3668] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3671 AS l_returnflag_prf_2#3690, l_orderkey_and_l_linenumber_prf#3672 AS l_orderkey_and_l_linenumber_prf_2#3691, l_comment_prf#3673 AS l_comment_prf_2#3692, l_linestatus_prf#3674 AS l_linestatus_prf_2#3693, rid#3675 AS rid_2#3694, l_shipmode_prf#3676 AS l_shipmode_prf_2#3695, l_shipinstruct_prf#3677 AS l_shipinstruct_prf_2#3696, l_quantity_prf#3678 AS l_quantity_prf_2#3697, l_receiptdate_prf#3679 AS l_receiptdate_prf_2#3698, l_linenumber_prf#3680 AS l_linenumber_prf_2#3699, l_tax_prf#3681 AS l_tax_prf_2#3700, l_shipdate_prf#3682 AS l_shipdate_prf_2#3701, l_extendedprice_prf#3683 AS l_extendedprice_prf_2#3702, l_partkey_prf#3684 AS l_partkey_prf_2#3703, l_discount_prf#3685 AS l_discount_prf_2#3704, l_partkey_and_l_suppkey_prf#3686 AS l_partkey_and_l_suppkey_prf_2#3705, l_commitdate_prf#3687 AS l_commitdate_prf_2#3706, l_suppkey_prf#3688 AS l_suppkey_prf_2#3707, l_orderkey_prf#3689 AS l_orderkey_prf_2#3708]
            +- Relation[l_returnflag_prf#3671,l_orderkey_and_l_linenumber_prf#3672,l_comment_prf#3673,l_linestatus_prf#3674,rid#3675,l_shipmode_prf#3676,l_shipinstruct_prf#3677,l_quantity_prf#3678,l_receiptdate_prf#3679,l_linenumber_prf#3680,l_tax_prf#3681,l_shipdate_prf#3682,l_extendedprice_prf#3683,l_partkey_prf#3684,l_discount_prf#3685,l_partkey_and_l_suppkey_prf#3686,l_commitdate_prf#3687,l_suppkey_prf#3688,l_orderkey_prf#3689] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 216511ms

fq1b=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 08:39:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:39:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3787L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 08:39:37 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:39:37 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:39:37 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:39:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3787L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_1#3800]
         :  :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#3794: string
         :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :     :  :- Project [rid#3789 AS rid_0#3794, n_regionkey_prf#3790 AS n_regionkey_prf_0#3795, n_nationkey_prf#3791 AS n_nationkey_prf_0#3796, n_name_prf#3792 AS n_name_prf_0#3797, n_comment_prf#3793 AS n_comment_prf_0#3798]
         :  :  :     :  :  +- Relation[rid#3789,n_regionkey_prf#3790,n_nationkey_prf#3791,n_name_prf#3792,n_comment_prf#3793] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3799]
         :  :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :  :  :     :        +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#3801 AS c_acctbal_prf_1#3810, rid#3802 AS rid_1#3811, c_name_prf#3803 AS c_name_prf_1#3812, c_nationkey_prf#3804 AS c_nationkey_prf_1#3813, c_custkey_prf#3805 AS c_custkey_prf_1#3814, c_comment_prf#3806 AS c_comment_prf_1#3815, c_address_prf#3807 AS c_address_prf_1#3816, c_mktsegment_prf#3808 AS c_mktsegment_prf_1#3817, c_phone_prf#3809 AS c_phone_prf_1#3818]
         :  :     +- Relation[c_acctbal_prf#3801,rid#3802,c_name_prf#3803,c_nationkey_prf#3804,c_custkey_prf#3805,c_comment_prf#3806,c_address_prf#3807,c_mktsegment_prf#3808,c_phone_prf#3809] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1815) AS rid_2#3829]
         :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3828]
         :        :  +- Relation[c_acctbal_prf#3819,rid#3820,c_name_prf#3821,c_nationkey_prf#3822,c_custkey_prf#3823,c_comment_prf#3824,c_address_prf#3825,c_mktsegment_prf#3826,c_phone_prf#3827] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_2, 'rid_2, 'o_orderdate_prf_2, 'o_custkey_prf_2, 'o_orderpriority_prf_2, 'o_clerk_prf_2, 'o_orderstatus_prf_2, 'o_totalprice_prf_2, 'o_orderkey_prf_2, 'o_comment_prf_2, dexdecrypt('value_dec_key, value#1815) AS rid_3#3850]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_2#3841: string
            :     :- Project [o_shippriority_prf#3830 AS o_shippriority_prf_2#3840, rid#3831 AS rid_2#3841, o_orderdate_prf#3832 AS o_orderdate_prf_2#3842, o_custkey_prf#3833 AS o_custkey_prf_2#3843, o_orderpriority_prf#3834 AS o_orderpriority_prf_2#3844, o_clerk_prf#3835 AS o_clerk_prf_2#3845, o_orderstatus_prf#3836 AS o_orderstatus_prf_2#3846, o_totalprice_prf#3837 AS o_totalprice_prf_2#3847, o_orderkey_prf#3838 AS o_orderkey_prf_2#3848, o_comment_prf#3839 AS o_comment_prf_2#3849]
            :     :  +- Relation[o_shippriority_prf#3830,rid#3831,o_orderdate_prf#3832,o_custkey_prf#3833,o_orderpriority_prf#3834,o_clerk_prf#3835,o_orderstatus_prf#3836,o_totalprice_prf#3837,o_orderkey_prf#3838,o_comment_prf#3839] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3851 AS l_returnflag_prf_3#3870, l_orderkey_and_l_linenumber_prf#3852 AS l_orderkey_and_l_linenumber_prf_3#3871, l_comment_prf#3853 AS l_comment_prf_3#3872, l_linestatus_prf#3854 AS l_linestatus_prf_3#3873, rid#3855 AS rid_3#3874, l_shipmode_prf#3856 AS l_shipmode_prf_3#3875, l_shipinstruct_prf#3857 AS l_shipinstruct_prf_3#3876, l_quantity_prf#3858 AS l_quantity_prf_3#3877, l_receiptdate_prf#3859 AS l_receiptdate_prf_3#3878, l_linenumber_prf#3860 AS l_linenumber_prf_3#3879, l_tax_prf#3861 AS l_tax_prf_3#3880, l_shipdate_prf#3862 AS l_shipdate_prf_3#3881, l_extendedprice_prf#3863 AS l_extendedprice_prf_3#3882, l_partkey_prf#3864 AS l_partkey_prf_3#3883, l_discount_prf#3865 AS l_discount_prf_3#3884, l_partkey_and_l_suppkey_prf#3866 AS l_partkey_and_l_suppkey_prf_3#3885, l_commitdate_prf#3867 AS l_commitdate_prf_3#3886, l_suppkey_prf#3868 AS l_suppkey_prf_3#3887, l_orderkey_prf#3869 AS l_orderkey_prf_3#3888]
               +- Relation[l_returnflag_prf#3851,l_orderkey_and_l_linenumber_prf#3852,l_comment_prf#3853,l_linestatus_prf#3854,rid#3855,l_shipmode_prf#3856,l_shipinstruct_prf#3857,l_quantity_prf#3858,l_receiptdate_prf#3859,l_linenumber_prf#3860,l_tax_prf#3861,l_shipdate_prf#3862,l_extendedprice_prf#3863,l_partkey_prf#3864,l_discount_prf#3865,l_partkey_and_l_suppkey_prf#3866,l_commitdate_prf#3867,l_suppkey_prf#3868,l_orderkey_prf#3869] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 226491ms

fr2e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/16 08:43:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:43:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3968L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 08:43:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3968L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_1#3988]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3980: string
         :     :- Project [c_acctbal_prf#3970 AS c_acctbal_prf_0#3979, rid#3971 AS rid_0#3980, c_name_prf#3972 AS c_name_prf_0#3981, c_nationkey_prf#3973 AS c_nationkey_prf_0#3982, c_custkey_prf#3974 AS c_custkey_prf_0#3983, c_comment_prf#3975 AS c_comment_prf_0#3984, c_address_prf#3976 AS c_address_prf_0#3985, c_mktsegment_prf#3977 AS c_mktsegment_prf_0#3986, c_phone_prf#3978 AS c_phone_prf_0#3987]
         :     :  +- Relation[c_acctbal_prf#3970,rid#3971,c_name_prf#3972,c_nationkey_prf#3973,c_custkey_prf#3974,c_comment_prf#3975,c_address_prf#3976,c_mktsegment_prf#3977,c_phone_prf#3978] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1815) AS rid_2#4010]
            :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#4000: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#3989 AS o_shippriority_prf_1#3999, rid#3990 AS rid_1#4000, o_orderdate_prf#3991 AS o_orderdate_prf_1#4001, o_custkey_prf#3992 AS o_custkey_prf_1#4002, o_orderpriority_prf#3993 AS o_orderpriority_prf_1#4003, o_clerk_prf#3994 AS o_clerk_prf_1#4004, o_orderstatus_prf#3995 AS o_orderstatus_prf_1#4005, o_totalprice_prf#3996 AS o_totalprice_prf_1#4006, o_orderkey_prf#3997 AS o_orderkey_prf_1#4007, o_comment_prf#3998 AS o_comment_prf_1#4008]
            :     :  :  +- Relation[o_shippriority_prf#3989,rid#3990,o_orderdate_prf#3991,o_custkey_prf#3992,o_orderpriority_prf#3993,o_clerk_prf#3994,o_orderstatus_prf#3995,o_totalprice_prf#3996,o_orderkey_prf#3997,o_comment_prf#3998] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4009]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4011 AS l_returnflag_prf_2#4030, l_orderkey_and_l_linenumber_prf#4012 AS l_orderkey_and_l_linenumber_prf_2#4031, l_comment_prf#4013 AS l_comment_prf_2#4032, l_linestatus_prf#4014 AS l_linestatus_prf_2#4033, rid#4015 AS rid_2#4034, l_shipmode_prf#4016 AS l_shipmode_prf_2#4035, l_shipinstruct_prf#4017 AS l_shipinstruct_prf_2#4036, l_quantity_prf#4018 AS l_quantity_prf_2#4037, l_receiptdate_prf#4019 AS l_receiptdate_prf_2#4038, l_linenumber_prf#4020 AS l_linenumber_prf_2#4039, l_tax_prf#4021 AS l_tax_prf_2#4040, l_shipdate_prf#4022 AS l_shipdate_prf_2#4041, l_extendedprice_prf#4023 AS l_extendedprice_prf_2#4042, l_partkey_prf#4024 AS l_partkey_prf_2#4043, l_discount_prf#4025 AS l_discount_prf_2#4044, l_partkey_and_l_suppkey_prf#4026 AS l_partkey_and_l_suppkey_prf_2#4045, l_commitdate_prf#4027 AS l_commitdate_prf_2#4046, l_suppkey_prf#4028 AS l_suppkey_prf_2#4047, l_orderkey_prf#4029 AS l_orderkey_prf_2#4048]
               +- Relation[l_returnflag_prf#4011,l_orderkey_and_l_linenumber_prf#4012,l_comment_prf#4013,l_linestatus_prf#4014,rid#4015,l_shipmode_prf#4016,l_shipinstruct_prf#4017,l_quantity_prf#4018,l_receiptdate_prf#4019,l_linenumber_prf#4020,l_tax_prf#4021,l_shipdate_prf#4022,l_extendedprice_prf#4023,l_partkey_prf#4024,l_discount_prf#4025,l_partkey_and_l_suppkey_prf#4026,l_commitdate_prf#4027,l_suppkey_prf#4028,l_orderkey_prf#4029] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 98106ms

fr2b=
select * from lineitem, orders, customer where o_custkey = c_custkey and o_orderstatus = 'F' and l_orderkey = o_orderkey
19/10/16 08:45:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:45:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4123L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 08:45:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4123L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_1#4163]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4148: string
         :     :- Project [l_returnflag_prf#4125 AS l_returnflag_prf_0#4144, l_orderkey_and_l_linenumber_prf#4126 AS l_orderkey_and_l_linenumber_prf_0#4145, l_comment_prf#4127 AS l_comment_prf_0#4146, l_linestatus_prf#4128 AS l_linestatus_prf_0#4147, rid#4129 AS rid_0#4148, l_shipmode_prf#4130 AS l_shipmode_prf_0#4149, l_shipinstruct_prf#4131 AS l_shipinstruct_prf_0#4150, l_quantity_prf#4132 AS l_quantity_prf_0#4151, l_receiptdate_prf#4133 AS l_receiptdate_prf_0#4152, l_linenumber_prf#4134 AS l_linenumber_prf_0#4153, l_tax_prf#4135 AS l_tax_prf_0#4154, l_shipdate_prf#4136 AS l_shipdate_prf_0#4155, l_extendedprice_prf#4137 AS l_extendedprice_prf_0#4156, l_partkey_prf#4138 AS l_partkey_prf_0#4157, l_discount_prf#4139 AS l_discount_prf_0#4158, l_partkey_and_l_suppkey_prf#4140 AS l_partkey_and_l_suppkey_prf_0#4159, l_commitdate_prf#4141 AS l_commitdate_prf_0#4160, l_suppkey_prf#4142 AS l_suppkey_prf_0#4161, l_orderkey_prf#4143 AS l_orderkey_prf_0#4162]
         :     :  +- Relation[l_returnflag_prf#4125,l_orderkey_and_l_linenumber_prf#4126,l_comment_prf#4127,l_linestatus_prf#4128,rid#4129,l_shipmode_prf#4130,l_shipinstruct_prf#4131,l_quantity_prf#4132,l_receiptdate_prf#4133,l_linenumber_prf#4134,l_tax_prf#4135,l_shipdate_prf#4136,l_extendedprice_prf#4137,l_partkey_prf#4138,l_discount_prf#4139,l_partkey_and_l_suppkey_prf#4140,l_commitdate_prf#4141,l_suppkey_prf#4142,l_orderkey_prf#4143] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1815) AS rid_2#4185]
            :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#4175: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#4164 AS o_shippriority_prf_1#4174, rid#4165 AS rid_1#4175, o_orderdate_prf#4166 AS o_orderdate_prf_1#4176, o_custkey_prf#4167 AS o_custkey_prf_1#4177, o_orderpriority_prf#4168 AS o_orderpriority_prf_1#4178, o_clerk_prf#4169 AS o_clerk_prf_1#4179, o_orderstatus_prf#4170 AS o_orderstatus_prf_1#4180, o_totalprice_prf#4171 AS o_totalprice_prf_1#4181, o_orderkey_prf#4172 AS o_orderkey_prf_1#4182, o_comment_prf#4173 AS o_comment_prf_1#4183]
            :     :  :  +- Relation[o_shippriority_prf#4164,rid#4165,o_orderdate_prf#4166,o_custkey_prf#4167,o_orderpriority_prf#4168,o_clerk_prf#4169,o_orderstatus_prf#4170,o_totalprice_prf#4171,o_orderkey_prf#4172,o_comment_prf#4173] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4184]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4186 AS c_acctbal_prf_2#4195, rid#4187 AS rid_2#4196, c_name_prf#4188 AS c_name_prf_2#4197, c_nationkey_prf#4189 AS c_nationkey_prf_2#4198, c_custkey_prf#4190 AS c_custkey_prf_2#4199, c_comment_prf#4191 AS c_comment_prf_2#4200, c_address_prf#4192 AS c_address_prf_2#4201, c_mktsegment_prf#4193 AS c_mktsegment_prf_2#4202, c_phone_prf#4194 AS c_phone_prf_2#4203]
               +- Relation[c_acctbal_prf#4186,rid#4187,c_name_prf#4188,c_nationkey_prf#4189,c_custkey_prf#4190,c_comment_prf#4191,c_address_prf#4192,c_mktsegment_prf#4193,c_phone_prf#4194] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 121310ms

ft1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/16 08:47:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:47:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4264L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/16 08:47:03 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:47:03 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 08:47:03 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 08:47:03 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:47:03 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:47:03 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:47:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4264L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_2#4284]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#4276: string
         :     :- Project [c_acctbal_prf#4266 AS c_acctbal_prf_0#4275, rid#4267 AS rid_0#4276, c_name_prf#4268 AS c_name_prf_0#4277, c_nationkey_prf#4269 AS c_nationkey_prf_0#4278, c_custkey_prf#4270 AS c_custkey_prf_0#4279, c_comment_prf#4271 AS c_comment_prf_0#4280, c_address_prf#4272 AS c_address_prf_0#4281, c_mktsegment_prf#4273 AS c_mktsegment_prf_0#4282, c_phone_prf#4274 AS c_phone_prf_0#4283]
         :     :  +- Relation[c_acctbal_prf#4266,rid#4267,c_name_prf#4268,c_nationkey_prf#4269,c_custkey_prf#4270,c_comment_prf#4271,c_address_prf#4272,c_mktsegment_prf#4273,c_phone_prf#4274] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1815) AS rid_2#4301]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#4294: string
            :     :- Project [s_phone_prf#4285 AS s_phone_prf_1#4293, rid#4286 AS rid_1#4294, s_address_prf#4287 AS s_address_prf_1#4295, s_nationkey_prf#4288 AS s_nationkey_prf_1#4296, s_suppkey_prf#4289 AS s_suppkey_prf_1#4297, s_name_prf#4290 AS s_name_prf_1#4298, s_acctbal_prf#4291 AS s_acctbal_prf_1#4299, s_comment_prf#4292 AS s_comment_prf_1#4300]
            :     :  +- Relation[s_phone_prf#4285,rid#4286,s_address_prf#4287,s_nationkey_prf#4288,s_suppkey_prf#4289,s_name_prf#4290,s_acctbal_prf#4291,s_comment_prf#4292] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [rid#4302 AS rid_2#4307, n_regionkey_prf#4303 AS n_regionkey_prf_2#4308, n_nationkey_prf#4304 AS n_nationkey_prf_2#4309, n_name_prf#4305 AS n_name_prf_2#4310, n_comment_prf#4306 AS n_comment_prf_2#4311]
               :  +- Relation[rid#4302,n_regionkey_prf#4303,n_nationkey_prf#4304,n_name_prf#4305,n_comment_prf#4306] JDBCRelation(nation_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#4312]
                  +- DexRidFilter nation~n_name~FRANCE
                     +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 33545ms

ft3b=
select * from part, lineitem, supplier where p_size = 15 and p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/16 08:47:36 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:47:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4370L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 08:47:36 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 08:47:36 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 08:47:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4370L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_1#4393]
         :  :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#4384: string
         :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :     :  :- Project [p_comment_prf#4372 AS p_comment_prf_0#4382, p_name_prf#4373 AS p_name_prf_0#4383, rid#4374 AS rid_0#4384, p_type_prf#4375 AS p_type_prf_0#4385, p_retailprice_prf#4376 AS p_retailprice_prf_0#4386, p_mfgr_prf#4377 AS p_mfgr_prf_0#4387, p_container_prf#4378 AS p_container_prf_0#4388, p_brand_prf#4379 AS p_brand_prf_0#4389, p_size_prf#4380 AS p_size_prf_0#4390, p_partkey_prf#4381 AS p_partkey_prf_0#4391]
         :  :  :     :  :  +- Relation[p_comment_prf#4372,p_name_prf#4373,rid#4374,p_type_prf#4375,p_retailprice_prf#4376,p_mfgr_prf#4377,p_container_prf#4378,p_brand_prf#4379,p_size_prf#4380,p_partkey_prf#4381] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4392]
         :  :  :     :     +- DexRidFilter part~p_size~15
         :  :  :     :        +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#4394 AS l_returnflag_prf_1#4413, l_orderkey_and_l_linenumber_prf#4395 AS l_orderkey_and_l_linenumber_prf_1#4414, l_comment_prf#4396 AS l_comment_prf_1#4415, l_linestatus_prf#4397 AS l_linestatus_prf_1#4416, rid#4398 AS rid_1#4417, l_shipmode_prf#4399 AS l_shipmode_prf_1#4418, l_shipinstruct_prf#4400 AS l_shipinstruct_prf_1#4419, l_quantity_prf#4401 AS l_quantity_prf_1#4420, l_receiptdate_prf#4402 AS l_receiptdate_prf_1#4421, l_linenumber_prf#4403 AS l_linenumber_prf_1#4422, l_tax_prf#4404 AS l_tax_prf_1#4423, l_shipdate_prf#4405 AS l_shipdate_prf_1#4424, l_extendedprice_prf#4406 AS l_extendedprice_prf_1#4425, l_partkey_prf#4407 AS l_partkey_prf_1#4426, l_discount_prf#4408 AS l_discount_prf_1#4427, l_partkey_and_l_suppkey_prf#4409 AS l_partkey_and_l_suppkey_prf_1#4428, l_commitdate_prf#4410 AS l_commitdate_prf_1#4429, l_suppkey_prf#4411 AS l_suppkey_prf_1#4430, l_orderkey_prf#4412 AS l_orderkey_prf_1#4431]
         :  :     +- Relation[l_returnflag_prf#4394,l_orderkey_and_l_linenumber_prf#4395,l_comment_prf#4396,l_linestatus_prf#4397,rid#4398,l_shipmode_prf#4399,l_shipinstruct_prf#4400,l_quantity_prf#4401,l_receiptdate_prf#4402,l_linenumber_prf#4403,l_tax_prf#4404,l_shipdate_prf#4405,l_extendedprice_prf#4406,l_partkey_prf#4407,l_discount_prf#4408,l_partkey_and_l_suppkey_prf#4409,l_commitdate_prf#4410,l_suppkey_prf#4411,l_orderkey_prf#4412] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1815) AS rid_2#4452]
         :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4451]
         :        :  +- Relation[l_returnflag_prf#4432,l_orderkey_and_l_linenumber_prf#4433,l_comment_prf#4434,l_linestatus_prf#4435,rid#4436,l_shipmode_prf#4437,l_shipinstruct_prf#4438,l_quantity_prf#4439,l_receiptdate_prf#4440,l_linenumber_prf#4441,l_tax_prf#4442,l_shipdate_prf#4443,l_extendedprice_prf#4444,l_partkey_prf#4445,l_discount_prf#4446,l_partkey_and_l_suppkey_prf#4447,l_commitdate_prf#4448,l_suppkey_prf#4449,l_orderkey_prf#4450] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4453 AS s_phone_prf_2#4461, rid#4454 AS rid_2#4462, s_address_prf#4455 AS s_address_prf_2#4463, s_nationkey_prf#4456 AS s_nationkey_prf_2#4464, s_suppkey_prf#4457 AS s_suppkey_prf_2#4465, s_name_prf#4458 AS s_name_prf_2#4466, s_acctbal_prf#4459 AS s_acctbal_prf_2#4467, s_comment_prf#4460 AS s_comment_prf_2#4468]
            +- Relation[s_phone_prf#4453,rid#4454,s_address_prf#4455,s_nationkey_prf#4456,s_suppkey_prf#4457,s_name_prf#4458,s_acctbal_prf#4459,s_comment_prf#4460] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 52934ms

fr1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and (l_orderkey = o_orderkey and c_mktsegment = 'BUILDING')
19/10/16 08:48:29 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:48:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4542L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 08:48:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 08:48:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 08:48:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 08:48:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4542L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_1#4582]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4567: string
         :     :- Project [l_returnflag_prf#4544 AS l_returnflag_prf_0#4563, l_orderkey_and_l_linenumber_prf#4545 AS l_orderkey_and_l_linenumber_prf_0#4564, l_comment_prf#4546 AS l_comment_prf_0#4565, l_linestatus_prf#4547 AS l_linestatus_prf_0#4566, rid#4548 AS rid_0#4567, l_shipmode_prf#4549 AS l_shipmode_prf_0#4568, l_shipinstruct_prf#4550 AS l_shipinstruct_prf_0#4569, l_quantity_prf#4551 AS l_quantity_prf_0#4570, l_receiptdate_prf#4552 AS l_receiptdate_prf_0#4571, l_linenumber_prf#4553 AS l_linenumber_prf_0#4572, l_tax_prf#4554 AS l_tax_prf_0#4573, l_shipdate_prf#4555 AS l_shipdate_prf_0#4574, l_extendedprice_prf#4556 AS l_extendedprice_prf_0#4575, l_partkey_prf#4557 AS l_partkey_prf_0#4576, l_discount_prf#4558 AS l_discount_prf_0#4577, l_partkey_and_l_suppkey_prf#4559 AS l_partkey_and_l_suppkey_prf_0#4578, l_commitdate_prf#4560 AS l_commitdate_prf_0#4579, l_suppkey_prf#4561 AS l_suppkey_prf_0#4580, l_orderkey_prf#4562 AS l_orderkey_prf_0#4581]
         :     :  +- Relation[l_returnflag_prf#4544,l_orderkey_and_l_linenumber_prf#4545,l_comment_prf#4546,l_linestatus_prf#4547,rid#4548,l_shipmode_prf#4549,l_shipinstruct_prf#4550,l_quantity_prf#4551,l_receiptdate_prf#4552,l_linenumber_prf#4553,l_tax_prf#4554,l_shipdate_prf#4555,l_extendedprice_prf#4556,l_partkey_prf#4557,l_discount_prf#4558,l_partkey_and_l_suppkey_prf#4559,l_commitdate_prf#4560,l_suppkey_prf#4561,l_orderkey_prf#4562] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1815) AS rid_2#4603]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#4594: string
            :     :- Project [o_shippriority_prf#4583 AS o_shippriority_prf_1#4593, rid#4584 AS rid_1#4594, o_orderdate_prf#4585 AS o_orderdate_prf_1#4595, o_custkey_prf#4586 AS o_custkey_prf_1#4596, o_orderpriority_prf#4587 AS o_orderpriority_prf_1#4597, o_clerk_prf#4588 AS o_clerk_prf_1#4598, o_orderstatus_prf#4589 AS o_orderstatus_prf_1#4599, o_totalprice_prf#4590 AS o_totalprice_prf_1#4600, o_orderkey_prf#4591 AS o_orderkey_prf_1#4601, o_comment_prf#4592 AS o_comment_prf_1#4602]
            :     :  +- Relation[o_shippriority_prf#4583,rid#4584,o_orderdate_prf#4585,o_custkey_prf#4586,o_orderpriority_prf#4587,o_clerk_prf#4588,o_orderstatus_prf#4589,o_totalprice_prf#4590,o_orderkey_prf#4591,o_comment_prf#4592] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [c_acctbal_prf#4604 AS c_acctbal_prf_2#4613, rid#4605 AS rid_2#4614, c_name_prf#4606 AS c_name_prf_2#4615, c_nationkey_prf#4607 AS c_nationkey_prf_2#4616, c_custkey_prf#4608 AS c_custkey_prf_2#4617, c_comment_prf#4609 AS c_comment_prf_2#4618, c_address_prf#4610 AS c_address_prf_2#4619, c_mktsegment_prf#4611 AS c_mktsegment_prf_2#4620, c_phone_prf#4612 AS c_phone_prf_2#4621]
               :  +- Relation[c_acctbal_prf#4604,rid#4605,c_name_prf#4606,c_nationkey_prf#4607,c_custkey_prf#4608,c_comment_prf#4609,c_address_prf#4610,c_mktsegment_prf#4611,c_phone_prf#4612] JDBCRelation(customer_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#4622]
                  +- DexRidFilter customer~c_mktsegment~BUILDING
                     +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 143145ms

fq1f=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 08:50:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:50:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4701L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/16 08:50:52 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:50:52 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:50:52 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:50:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4701L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_1#4741]
         :  :  :  :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4726: string
         :  :  :  :  :     :- Project [l_returnflag_prf#4703 AS l_returnflag_prf_0#4722, l_orderkey_and_l_linenumber_prf#4704 AS l_orderkey_and_l_linenumber_prf_0#4723, l_comment_prf#4705 AS l_comment_prf_0#4724, l_linestatus_prf#4706 AS l_linestatus_prf_0#4725, rid#4707 AS rid_0#4726, l_shipmode_prf#4708 AS l_shipmode_prf_0#4727, l_shipinstruct_prf#4709 AS l_shipinstruct_prf_0#4728, l_quantity_prf#4710 AS l_quantity_prf_0#4729, l_receiptdate_prf#4711 AS l_receiptdate_prf_0#4730, l_linenumber_prf#4712 AS l_linenumber_prf_0#4731, l_tax_prf#4713 AS l_tax_prf_0#4732, l_shipdate_prf#4714 AS l_shipdate_prf_0#4733, l_extendedprice_prf#4715 AS l_extendedprice_prf_0#4734, l_partkey_prf#4716 AS l_partkey_prf_0#4735, l_discount_prf#4717 AS l_discount_prf_0#4736, l_partkey_and_l_suppkey_prf#4718 AS l_partkey_and_l_suppkey_prf_0#4737, l_commitdate_prf#4719 AS l_commitdate_prf_0#4738, l_suppkey_prf#4720 AS l_suppkey_prf_0#4739, l_orderkey_prf#4721 AS l_orderkey_prf_0#4740]
         :  :  :  :  :     :  +- Relation[l_returnflag_prf#4703,l_orderkey_and_l_linenumber_prf#4704,l_comment_prf#4705,l_linestatus_prf#4706,rid#4707,l_shipmode_prf#4708,l_shipinstruct_prf#4709,l_quantity_prf#4710,l_receiptdate_prf#4711,l_linenumber_prf#4712,l_tax_prf#4713,l_shipdate_prf#4714,l_extendedprice_prf#4715,l_partkey_prf#4716,l_discount_prf#4717,l_partkey_and_l_suppkey_prf#4718,l_commitdate_prf#4719,l_suppkey_prf#4720,l_orderkey_prf#4721] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [o_shippriority_prf#4742 AS o_shippriority_prf_1#4752, rid#4743 AS rid_1#4753, o_orderdate_prf#4744 AS o_orderdate_prf_1#4754, o_custkey_prf#4745 AS o_custkey_prf_1#4755, o_orderpriority_prf#4746 AS o_orderpriority_prf_1#4756, o_clerk_prf#4747 AS o_clerk_prf_1#4757, o_orderstatus_prf#4748 AS o_orderstatus_prf_1#4758, o_totalprice_prf#4749 AS o_totalprice_prf_1#4759, o_orderkey_prf#4750 AS o_orderkey_prf_1#4760, o_comment_prf#4751 AS o_comment_prf_1#4761]
         :  :  :  :     +- Relation[o_shippriority_prf#4742,rid#4743,o_orderdate_prf#4744,o_custkey_prf#4745,o_orderpriority_prf#4746,o_clerk_prf#4747,o_orderstatus_prf#4748,o_totalprice_prf#4749,o_orderkey_prf#4750,o_comment_prf#4751] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1815) AS rid_2#4773]
         :  :  :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :  :  :        :- 'Project ['rid AS rid_1#4772]
         :  :  :        :  +- Relation[o_shippriority_prf#4762,rid#4763,o_orderdate_prf#4764,o_custkey_prf#4765,o_orderpriority_prf#4766,o_clerk_prf#4767,o_orderstatus_prf#4768,o_totalprice_prf#4769,o_orderkey_prf#4770,o_comment_prf#4771] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :        +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#4774 AS c_acctbal_prf_2#4783, rid#4775 AS rid_2#4784, c_name_prf#4776 AS c_name_prf_2#4785, c_nationkey_prf#4777 AS c_nationkey_prf_2#4786, c_custkey_prf#4778 AS c_custkey_prf_2#4787, c_comment_prf#4779 AS c_comment_prf_2#4788, c_address_prf#4780 AS c_address_prf_2#4789, c_mktsegment_prf#4781 AS c_mktsegment_prf_2#4790, c_phone_prf#4782 AS c_phone_prf_2#4791]
         :  :     +- Relation[c_acctbal_prf#4774,rid#4775,c_name_prf#4776,c_nationkey_prf#4777,c_custkey_prf#4778,c_comment_prf#4779,c_address_prf#4780,c_mktsegment_prf#4781,c_phone_prf#4782] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1815) AS rid_3#4802]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#4801]
         :        :  +- Relation[c_acctbal_prf#4792,rid#4793,c_name_prf#4794,c_nationkey_prf#4795,c_custkey_prf#4796,c_comment_prf#4797,c_address_prf#4798,c_mktsegment_prf#4799,c_phone_prf#4800] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_3))
            :- Project [rid#4803 AS rid_3#4808, n_regionkey_prf#4804 AS n_regionkey_prf_3#4809, n_nationkey_prf#4805 AS n_nationkey_prf_3#4810, n_name_prf#4806 AS n_name_prf_3#4811, n_comment_prf#4807 AS n_comment_prf_3#4812]
            :  +- Relation[rid#4803,n_regionkey_prf#4804,n_nationkey_prf#4805,n_name_prf#4806,n_comment_prf#4807] JDBCRelation(nation_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#4813]
               +- DexRidFilter nation~n_name~FRANCE
                  +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 184093ms

fq1d=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 08:53:56 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:53:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4897L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_orderkey#342L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :     :- Project [n_nationkey#108L]
               :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
               :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L]
                  +- Filter isnotnull(o_orderkey#342L)
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 08:53:56 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:53:56 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:53:56 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 08:53:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4897L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_3#4937]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4922: string
         :     :- Project [l_returnflag_prf#4899 AS l_returnflag_prf_0#4918, l_orderkey_and_l_linenumber_prf#4900 AS l_orderkey_and_l_linenumber_prf_0#4919, l_comment_prf#4901 AS l_comment_prf_0#4920, l_linestatus_prf#4902 AS l_linestatus_prf_0#4921, rid#4903 AS rid_0#4922, l_shipmode_prf#4904 AS l_shipmode_prf_0#4923, l_shipinstruct_prf#4905 AS l_shipinstruct_prf_0#4924, l_quantity_prf#4906 AS l_quantity_prf_0#4925, l_receiptdate_prf#4907 AS l_receiptdate_prf_0#4926, l_linenumber_prf#4908 AS l_linenumber_prf_0#4927, l_tax_prf#4909 AS l_tax_prf_0#4928, l_shipdate_prf#4910 AS l_shipdate_prf_0#4929, l_extendedprice_prf#4911 AS l_extendedprice_prf_0#4930, l_partkey_prf#4912 AS l_partkey_prf_0#4931, l_discount_prf#4913 AS l_discount_prf_0#4932, l_partkey_and_l_suppkey_prf#4914 AS l_partkey_and_l_suppkey_prf_0#4933, l_commitdate_prf#4915 AS l_commitdate_prf_0#4934, l_suppkey_prf#4916 AS l_suppkey_prf_0#4935, l_orderkey_prf#4917 AS l_orderkey_prf_0#4936]
         :     :  +- Relation[l_returnflag_prf#4899,l_orderkey_and_l_linenumber_prf#4900,l_comment_prf#4901,l_linestatus_prf#4902,rid#4903,l_shipmode_prf#4904,l_shipinstruct_prf#4905,l_quantity_prf#4906,l_receiptdate_prf#4907,l_linenumber_prf#4908,l_tax_prf#4909,l_shipdate_prf#4910,l_extendedprice_prf#4911,l_partkey_prf#4912,l_discount_prf#4913,l_partkey_and_l_suppkey_prf#4914,l_commitdate_prf#4915,l_suppkey_prf#4916,l_orderkey_prf#4917] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join NaturalJoin(Inner)
            :  :  :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#1815) AS rid_2#4949]
            :  :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_1#4943: string
            :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :  :     :  :- Project [rid#4938 AS rid_1#4943, n_regionkey_prf#4939 AS n_regionkey_prf_1#4944, n_nationkey_prf#4940 AS n_nationkey_prf_1#4945, n_name_prf#4941 AS n_name_prf_1#4946, n_comment_prf#4942 AS n_comment_prf_1#4947]
            :  :  :     :  :  +- Relation[rid#4938,n_regionkey_prf#4939,n_nationkey_prf#4940,n_name_prf#4941,n_comment_prf#4942] JDBCRelation(nation_prf) [numPartitions=1]
            :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4948]
            :  :  :     :     +- DexRidFilter nation~n_name~FRANCE
            :  :  :     :        +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]
            :  :  :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
            :  :  +- Project [c_acctbal_prf#4950 AS c_acctbal_prf_2#4959, rid#4951 AS rid_2#4960, c_name_prf#4952 AS c_name_prf_2#4961, c_nationkey_prf#4953 AS c_nationkey_prf_2#4962, c_custkey_prf#4954 AS c_custkey_prf_2#4963, c_comment_prf#4955 AS c_comment_prf_2#4964, c_address_prf#4956 AS c_address_prf_2#4965, c_mktsegment_prf#4957 AS c_mktsegment_prf_2#4966, c_phone_prf#4958 AS c_phone_prf_2#4967]
            :  :     +- Relation[c_acctbal_prf#4950,rid#4951,c_name_prf#4952,c_nationkey_prf#4953,c_custkey_prf#4954,c_comment_prf#4955,c_address_prf#4956,c_mktsegment_prf#4957,c_phone_prf#4958] JDBCRelation(customer_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1815) AS rid_3#4978]
            :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#4977]
            :        :  +- Relation[c_acctbal_prf#4968,rid#4969,c_name_prf#4970,c_nationkey_prf#4971,c_custkey_prf#4972,c_comment_prf#4973,c_address_prf#4974,c_mktsegment_prf#4975,c_phone_prf#4976] JDBCRelation(customer_prf) [numPartitions=1]
            :        +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4979 AS o_shippriority_prf_3#4989, rid#4980 AS rid_3#4990, o_orderdate_prf#4981 AS o_orderdate_prf_3#4991, o_custkey_prf#4982 AS o_custkey_prf_3#4992, o_orderpriority_prf#4983 AS o_orderpriority_prf_3#4993, o_clerk_prf#4984 AS o_clerk_prf_3#4994, o_orderstatus_prf#4985 AS o_orderstatus_prf_3#4995, o_totalprice_prf#4986 AS o_totalprice_prf_3#4996, o_orderkey_prf#4987 AS o_orderkey_prf_3#4997, o_comment_prf#4988 AS o_comment_prf_3#4998]
               +- Relation[o_shippriority_prf#4979,rid#4980,o_orderdate_prf#4981,o_custkey_prf#4982,o_orderpriority_prf#4983,o_clerk_prf#4984,o_orderstatus_prf#4985,o_totalprice_prf#4986,o_orderkey_prf#4987,o_comment_prf#4988] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=0
Elapsed time: 1026ms

ft3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and (p_size = 15 and s_suppkey = l_suppkey)
19/10/16 08:53:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:53:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5077L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 08:53:57 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 08:53:57 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 08:53:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5077L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_2#5095]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#5088: string
         :     :- Project [s_phone_prf#5079 AS s_phone_prf_0#5087, rid#5080 AS rid_0#5088, s_address_prf#5081 AS s_address_prf_0#5089, s_nationkey_prf#5082 AS s_nationkey_prf_0#5090, s_suppkey_prf#5083 AS s_suppkey_prf_0#5091, s_name_prf#5084 AS s_name_prf_0#5092, s_acctbal_prf#5085 AS s_acctbal_prf_0#5093, s_comment_prf#5086 AS s_comment_prf_0#5094]
         :     :  +- Relation[s_phone_prf#5079,rid#5080,s_address_prf#5081,s_nationkey_prf#5082,s_suppkey_prf#5083,s_name_prf#5084,s_acctbal_prf#5085,s_comment_prf#5086] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1815) AS rid_2#5117]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#5108: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#5096 AS p_comment_prf_1#5106, p_name_prf#5097 AS p_name_prf_1#5107, rid#5098 AS rid_1#5108, p_type_prf#5099 AS p_type_prf_1#5109, p_retailprice_prf#5100 AS p_retailprice_prf_1#5110, p_mfgr_prf#5101 AS p_mfgr_prf_1#5111, p_container_prf#5102 AS p_container_prf_1#5112, p_brand_prf#5103 AS p_brand_prf_1#5113, p_size_prf#5104 AS p_size_prf_1#5114, p_partkey_prf#5105 AS p_partkey_prf_1#5115]
            :     :  :  +- Relation[p_comment_prf#5096,p_name_prf#5097,rid#5098,p_type_prf#5099,p_retailprice_prf#5100,p_mfgr_prf#5101,p_container_prf#5102,p_brand_prf#5103,p_size_prf#5104,p_partkey_prf#5105] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5116]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#5118 AS l_returnflag_prf_2#5137, l_orderkey_and_l_linenumber_prf#5119 AS l_orderkey_and_l_linenumber_prf_2#5138, l_comment_prf#5120 AS l_comment_prf_2#5139, l_linestatus_prf#5121 AS l_linestatus_prf_2#5140, rid#5122 AS rid_2#5141, l_shipmode_prf#5123 AS l_shipmode_prf_2#5142, l_shipinstruct_prf#5124 AS l_shipinstruct_prf_2#5143, l_quantity_prf#5125 AS l_quantity_prf_2#5144, l_receiptdate_prf#5126 AS l_receiptdate_prf_2#5145, l_linenumber_prf#5127 AS l_linenumber_prf_2#5146, l_tax_prf#5128 AS l_tax_prf_2#5147, l_shipdate_prf#5129 AS l_shipdate_prf_2#5148, l_extendedprice_prf#5130 AS l_extendedprice_prf_2#5149, l_partkey_prf#5131 AS l_partkey_prf_2#5150, l_discount_prf#5132 AS l_discount_prf_2#5151, l_partkey_and_l_suppkey_prf#5133 AS l_partkey_and_l_suppkey_prf_2#5152, l_commitdate_prf#5134 AS l_commitdate_prf_2#5153, l_suppkey_prf#5135 AS l_suppkey_prf_2#5154, l_orderkey_prf#5136 AS l_orderkey_prf_2#5155]
               +- Relation[l_returnflag_prf#5118,l_orderkey_and_l_linenumber_prf#5119,l_comment_prf#5120,l_linestatus_prf#5121,rid#5122,l_shipmode_prf#5123,l_shipinstruct_prf#5124,l_quantity_prf#5125,l_receiptdate_prf#5126,l_linenumber_prf#5127,l_tax_prf#5128,l_shipdate_prf#5129,l_extendedprice_prf#5130,l_partkey_prf#5131,l_discount_prf#5132,l_partkey_and_l_suppkey_prf#5133,l_commitdate_prf#5134,l_suppkey_prf#5135,l_orderkey_prf#5136] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 59822ms

fr1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey and c_mktsegment = 'BUILDING'
19/10/16 08:54:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:54:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5229L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 08:54:57 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 08:54:57 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 08:54:57 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 08:54:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5229L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_1#5269]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#5254: string
         :  :  :     :- Project [l_returnflag_prf#5231 AS l_returnflag_prf_0#5250, l_orderkey_and_l_linenumber_prf#5232 AS l_orderkey_and_l_linenumber_prf_0#5251, l_comment_prf#5233 AS l_comment_prf_0#5252, l_linestatus_prf#5234 AS l_linestatus_prf_0#5253, rid#5235 AS rid_0#5254, l_shipmode_prf#5236 AS l_shipmode_prf_0#5255, l_shipinstruct_prf#5237 AS l_shipinstruct_prf_0#5256, l_quantity_prf#5238 AS l_quantity_prf_0#5257, l_receiptdate_prf#5239 AS l_receiptdate_prf_0#5258, l_linenumber_prf#5240 AS l_linenumber_prf_0#5259, l_tax_prf#5241 AS l_tax_prf_0#5260, l_shipdate_prf#5242 AS l_shipdate_prf_0#5261, l_extendedprice_prf#5243 AS l_extendedprice_prf_0#5262, l_partkey_prf#5244 AS l_partkey_prf_0#5263, l_discount_prf#5245 AS l_discount_prf_0#5264, l_partkey_and_l_suppkey_prf#5246 AS l_partkey_and_l_suppkey_prf_0#5265, l_commitdate_prf#5247 AS l_commitdate_prf_0#5266, l_suppkey_prf#5248 AS l_suppkey_prf_0#5267, l_orderkey_prf#5249 AS l_orderkey_prf_0#5268]
         :  :  :     :  +- Relation[l_returnflag_prf#5231,l_orderkey_and_l_linenumber_prf#5232,l_comment_prf#5233,l_linestatus_prf#5234,rid#5235,l_shipmode_prf#5236,l_shipinstruct_prf#5237,l_quantity_prf#5238,l_receiptdate_prf#5239,l_linenumber_prf#5240,l_tax_prf#5241,l_shipdate_prf#5242,l_extendedprice_prf#5243,l_partkey_prf#5244,l_discount_prf#5245,l_partkey_and_l_suppkey_prf#5246,l_commitdate_prf#5247,l_suppkey_prf#5248,l_orderkey_prf#5249] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#5270 AS o_shippriority_prf_1#5280, rid#5271 AS rid_1#5281, o_orderdate_prf#5272 AS o_orderdate_prf_1#5282, o_custkey_prf#5273 AS o_custkey_prf_1#5283, o_orderpriority_prf#5274 AS o_orderpriority_prf_1#5284, o_clerk_prf#5275 AS o_clerk_prf_1#5285, o_orderstatus_prf#5276 AS o_orderstatus_prf_1#5286, o_totalprice_prf#5277 AS o_totalprice_prf_1#5287, o_orderkey_prf#5278 AS o_orderkey_prf_1#5288, o_comment_prf#5279 AS o_comment_prf_1#5289]
         :  :     +- Relation[o_shippriority_prf#5270,rid#5271,o_orderdate_prf#5272,o_custkey_prf#5273,o_orderpriority_prf#5274,o_clerk_prf#5275,o_orderstatus_prf#5276,o_totalprice_prf#5277,o_orderkey_prf#5278,o_comment_prf#5279] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1815) AS rid_2#5301]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5300]
         :        :  +- Relation[o_shippriority_prf#5290,rid#5291,o_orderdate_prf#5292,o_custkey_prf#5293,o_orderpriority_prf#5294,o_clerk_prf#5295,o_orderstatus_prf#5296,o_totalprice_prf#5297,o_orderkey_prf#5298,o_comment_prf#5299] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_2))
            :- Project [c_acctbal_prf#5302 AS c_acctbal_prf_2#5311, rid#5303 AS rid_2#5312, c_name_prf#5304 AS c_name_prf_2#5313, c_nationkey_prf#5305 AS c_nationkey_prf_2#5314, c_custkey_prf#5306 AS c_custkey_prf_2#5315, c_comment_prf#5307 AS c_comment_prf_2#5316, c_address_prf#5308 AS c_address_prf_2#5317, c_mktsegment_prf#5309 AS c_mktsegment_prf_2#5318, c_phone_prf#5310 AS c_phone_prf_2#5319]
            :  +- Relation[c_acctbal_prf#5302,rid#5303,c_name_prf#5304,c_nationkey_prf#5305,c_custkey_prf#5306,c_comment_prf#5307,c_address_prf#5308,c_mktsegment_prf#5309,c_phone_prf#5310] JDBCRelation(customer_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#5320]
               +- DexRidFilter customer~c_mktsegment~BUILDING
                  +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 139514ms

fr1e=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and (o_orderkey = l_orderkey and c_custkey = o_custkey)
19/10/16 08:57:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 08:57:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5395L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 08:57:17 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 08:57:17 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 08:57:17 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 08:57:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5395L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_1#5416]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#5407: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [c_acctbal_prf#5397 AS c_acctbal_prf_0#5406, rid#5398 AS rid_0#5407, c_name_prf#5399 AS c_name_prf_0#5408, c_nationkey_prf#5400 AS c_nationkey_prf_0#5409, c_custkey_prf#5401 AS c_custkey_prf_0#5410, c_comment_prf#5402 AS c_comment_prf_0#5411, c_address_prf#5403 AS c_address_prf_0#5412, c_mktsegment_prf#5404 AS c_mktsegment_prf_0#5413, c_phone_prf#5405 AS c_phone_prf_0#5414]
         :     :  :  +- Relation[c_acctbal_prf#5397,rid#5398,c_name_prf#5399,c_nationkey_prf#5400,c_custkey_prf#5401,c_comment_prf#5402,c_address_prf#5403,c_mktsegment_prf#5404,c_phone_prf#5405] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5415]
         :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :        +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1815) AS rid_2#5437]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#5428: string
            :     :- Project [o_shippriority_prf#5417 AS o_shippriority_prf_1#5427, rid#5418 AS rid_1#5428, o_orderdate_prf#5419 AS o_orderdate_prf_1#5429, o_custkey_prf#5420 AS o_custkey_prf_1#5430, o_orderpriority_prf#5421 AS o_orderpriority_prf_1#5431, o_clerk_prf#5422 AS o_clerk_prf_1#5432, o_orderstatus_prf#5423 AS o_orderstatus_prf_1#5433, o_totalprice_prf#5424 AS o_totalprice_prf_1#5434, o_orderkey_prf#5425 AS o_orderkey_prf_1#5435, o_comment_prf#5426 AS o_comment_prf_1#5436]
            :     :  +- Relation[o_shippriority_prf#5417,rid#5418,o_orderdate_prf#5419,o_custkey_prf#5420,o_orderpriority_prf#5421,o_clerk_prf#5422,o_orderstatus_prf#5423,o_totalprice_prf#5424,o_orderkey_prf#5425,o_comment_prf#5426] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#5438 AS l_returnflag_prf_2#5457, l_orderkey_and_l_linenumber_prf#5439 AS l_orderkey_and_l_linenumber_prf_2#5458, l_comment_prf#5440 AS l_comment_prf_2#5459, l_linestatus_prf#5441 AS l_linestatus_prf_2#5460, rid#5442 AS rid_2#5461, l_shipmode_prf#5443 AS l_shipmode_prf_2#5462, l_shipinstruct_prf#5444 AS l_shipinstruct_prf_2#5463, l_quantity_prf#5445 AS l_quantity_prf_2#5464, l_receiptdate_prf#5446 AS l_receiptdate_prf_2#5465, l_linenumber_prf#5447 AS l_linenumber_prf_2#5466, l_tax_prf#5448 AS l_tax_prf_2#5467, l_shipdate_prf#5449 AS l_shipdate_prf_2#5468, l_extendedprice_prf#5450 AS l_extendedprice_prf_2#5469, l_partkey_prf#5451 AS l_partkey_prf_2#5470, l_discount_prf#5452 AS l_discount_prf_2#5471, l_partkey_and_l_suppkey_prf#5453 AS l_partkey_and_l_suppkey_prf_2#5472, l_commitdate_prf#5454 AS l_commitdate_prf_2#5473, l_suppkey_prf#5455 AS l_suppkey_prf_2#5474, l_orderkey_prf#5456 AS l_orderkey_prf_2#5475]
               +- Relation[l_returnflag_prf#5438,l_orderkey_and_l_linenumber_prf#5439,l_comment_prf#5440,l_linestatus_prf#5441,rid#5442,l_shipmode_prf#5443,l_shipinstruct_prf#5444,l_quantity_prf#5445,l_receiptdate_prf#5446,l_linenumber_prf#5447,l_tax_prf#5448,l_shipdate_prf#5449,l_extendedprice_prf#5450,l_partkey_prf#5451,l_discount_prf#5452,l_partkey_and_l_suppkey_prf#5453,l_commitdate_prf#5454,l_suppkey_prf#5455,l_orderkey_prf#5456] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 203767ms

ft1b=
select * from nation, supplier, customer where n_name = 'FRANCE' and n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/16 09:00:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 09:00:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5536L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 09:00:40 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 09:00:40 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 09:00:40 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 09:00:40 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 09:00:40 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 09:00:40 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 09:00:40 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 09:00:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5536L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1815) AS rid_1#5549]
         :  :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#5543: string
         :  :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :     :  :- Project [rid#5538 AS rid_0#5543, n_regionkey_prf#5539 AS n_regionkey_prf_0#5544, n_nationkey_prf#5540 AS n_nationkey_prf_0#5545, n_name_prf#5541 AS n_name_prf_0#5546, n_comment_prf#5542 AS n_comment_prf_0#5547]
         :  :  :     :  :  +- Relation[rid#5538,n_regionkey_prf#5539,n_nationkey_prf#5540,n_name_prf#5541,n_comment_prf#5542] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5548]
         :  :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :  :  :     :        +- Relation[label#1811,value#1812] JDBCRelation(t_filter) [numPartitions=1]
         :  :  :     +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#5550 AS s_phone_prf_1#5558, rid#5551 AS rid_1#5559, s_address_prf#5552 AS s_address_prf_1#5560, s_nationkey_prf#5553 AS s_nationkey_prf_1#5561, s_suppkey_prf#5554 AS s_suppkey_prf_1#5562, s_name_prf#5555 AS s_name_prf_1#5563, s_acctbal_prf#5556 AS s_acctbal_prf_1#5564, s_comment_prf#5557 AS s_comment_prf_1#5565]
         :  :     +- Relation[s_phone_prf#5550,rid#5551,s_address_prf#5552,s_nationkey_prf#5553,s_suppkey_prf#5554,s_name_prf#5555,s_acctbal_prf#5556,s_comment_prf#5557] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1815) AS rid_2#5572]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5571]
         :        :  +- Relation[rid#5566,n_regionkey_prf#5567,n_nationkey_prf#5568,n_name_prf#5569,n_comment_prf#5570] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#1814,value#1815] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#5573 AS c_acctbal_prf_2#5582, rid#5574 AS rid_2#5583, c_name_prf#5575 AS c_name_prf_2#5584, c_nationkey_prf#5576 AS c_nationkey_prf_2#5585, c_custkey_prf#5577 AS c_custkey_prf_2#5586, c_comment_prf#5578 AS c_comment_prf_2#5587, c_address_prf#5579 AS c_address_prf_2#5588, c_mktsegment_prf#5580 AS c_mktsegment_prf_2#5589, c_phone_prf#5581 AS c_phone_prf_2#5590]
            +- Relation[c_acctbal_prf#5573,rid#5574,c_name_prf#5575,c_nationkey_prf#5576,c_custkey_prf#5577,c_comment_prf#5578,c_address_prf#5579,c_mktsegment_prf#5580,c_phone_prf#5581] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 2671ms
query=fq1a, count=246415, duration=163595
query=fq1b, count=246415, duration=226491
query=fq1c, count=246415, duration=232578
query=fq1d, count=0, duration=1026
query=fq1e, count=246415, duration=181530
query=fq1f, count=246415, duration=184093
query=fr1a, count=1214743, duration=139514
query=fr1b, count=1214743, duration=143145
query=fr1c, count=1214743, duration=99356
query=fr1d, count=1214743, duration=152087
query=fr1e, count=1214743, duration=203767
query=fr2a, count=2901744, duration=174284
query=fr2b, count=2901744, duration=121310
query=fr2d, count=2901744, duration=207017
query=fr2e, count=2901744, duration=98106
query=fr2f, count=2901744, duration=216511
query=ft1a, count=2452200, duration=1488
query=ft1b, count=2452200, duration=2671
query=ft1c, count=2452200, duration=33545
query=ft2a, count=15628, duration=102278
query=ft2b, count=15628, duration=46239
query=ft2c, count=15628, duration=7590
query=ft3a, count=6001215, duration=220884
query=ft3b, count=117754, duration=52934
query=ft3c, count=117754, duration=59822
