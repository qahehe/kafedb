19/10/16 22:50:05 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7156ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Wed Oct 16 22:50:07 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Wed Oct 16 22:50:08 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Wed Oct 16 22:50:09 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Wed Oct 16 22:50:09 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Wed Oct 16 22:50:09 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Wed Oct 16 22:50:11 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Wed Oct 16 22:50:14 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Wed Oct 16 22:50:14 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



fr2b=
select * from lineitem, orders, customer where o_custkey = c_custkey and o_orderstatus = 'F' and l_orderkey = o_orderkey
19/10/16 22:50:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:50:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2093L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 22:50:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2093L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#2095 AS l_returnflag_prf_0#2114, l_orderkey_and_l_linenumber_prf#2096 AS l_orderkey_and_l_linenumber_prf_0#2115, l_comment_prf#2097 AS l_comment_prf_0#2116, l_linestatus_prf#2098 AS l_linestatus_prf_0#2117, rid#2099 AS rid_0#2118, l_shipmode_prf#2100 AS l_shipmode_prf_0#2119, l_shipinstruct_prf#2101 AS l_shipinstruct_prf_0#2120, l_quantity_prf#2102 AS l_quantity_prf_0#2121, l_receiptdate_prf#2103 AS l_receiptdate_prf_0#2122, l_linenumber_prf#2104 AS l_linenumber_prf_0#2123, l_tax_prf#2105 AS l_tax_prf_0#2124, l_shipdate_prf#2106 AS l_shipdate_prf_0#2125, l_extendedprice_prf#2107 AS l_extendedprice_prf_0#2126, l_partkey_prf#2108 AS l_partkey_prf_0#2127, l_discount_prf#2109 AS l_discount_prf_0#2128, l_partkey_and_l_suppkey_prf#2110 AS l_partkey_and_l_suppkey_prf_0#2129, l_commitdate_prf#2111 AS l_commitdate_prf_0#2130, l_suppkey_prf#2112 AS l_suppkey_prf_0#2131, l_orderkey_prf#2113 AS l_orderkey_prf_0#2132]
         :  :  +- Relation[l_returnflag_prf#2095,l_orderkey_and_l_linenumber_prf#2096,l_comment_prf#2097,l_linestatus_prf#2098,rid#2099,l_shipmode_prf#2100,l_shipinstruct_prf#2101,l_quantity_prf#2102,l_receiptdate_prf#2103,l_linenumber_prf#2104,l_tax_prf#2105,l_shipdate_prf#2106,l_extendedprice_prf#2107,l_partkey_prf#2108,l_discount_prf#2109,l_partkey_and_l_suppkey_prf#2110,l_commitdate_prf#2111,l_suppkey_prf#2112,l_orderkey_prf#2113] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#2155]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2152]
         :        :  +- Relation[l_returnflag_prf#2133,l_orderkey_and_l_linenumber_prf#2134,l_comment_prf#2135,l_linestatus_prf#2136,rid#2137,l_shipmode_prf#2138,l_shipinstruct_prf#2139,l_quantity_prf#2140,l_receiptdate_prf#2141,l_linenumber_prf#2142,l_tax_prf#2143,l_shipdate_prf#2144,l_extendedprice_prf#2145,l_partkey_prf#2146,l_discount_prf#2147,l_partkey_and_l_suppkey_prf#2148,l_commitdate_prf#2149,l_suppkey_prf#2150,l_orderkey_prf#2151] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#2179]
            :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#2167: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#2156 AS o_shippriority_prf_1#2166, rid#2157 AS rid_1#2167, o_orderdate_prf#2158 AS o_orderdate_prf_1#2168, o_custkey_prf#2159 AS o_custkey_prf_1#2169, o_orderpriority_prf#2160 AS o_orderpriority_prf_1#2170, o_clerk_prf#2161 AS o_clerk_prf_1#2171, o_orderstatus_prf#2162 AS o_orderstatus_prf_1#2172, o_totalprice_prf#2163 AS o_totalprice_prf_1#2173, o_orderkey_prf#2164 AS o_orderkey_prf_1#2174, o_comment_prf#2165 AS o_comment_prf_1#2175]
            :     :  :  +- Relation[o_shippriority_prf#2156,rid#2157,o_orderdate_prf#2158,o_custkey_prf#2159,o_orderpriority_prf#2160,o_clerk_prf#2161,o_orderstatus_prf#2162,o_totalprice_prf#2163,o_orderkey_prf#2164,o_comment_prf#2165] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2178]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#2180 AS c_acctbal_prf_2#2189, rid#2181 AS rid_2#2190, c_name_prf#2182 AS c_name_prf_2#2191, c_nationkey_prf#2183 AS c_nationkey_prf_2#2192, c_custkey_prf#2184 AS c_custkey_prf_2#2193, c_comment_prf#2185 AS c_comment_prf_2#2194, c_address_prf#2186 AS c_address_prf_2#2195, c_mktsegment_prf#2187 AS c_mktsegment_prf_2#2196, c_phone_prf#2188 AS c_phone_prf_2#2197]
               +- Relation[c_acctbal_prf#2180,rid#2181,c_name_prf#2182,c_nationkey_prf#2183,c_custkey_prf#2184,c_comment_prf#2185,c_address_prf#2186,c_mktsegment_prf#2187,c_phone_prf#2188] JDBCRelation(customer_prf) [numPartitions=1]

19/10/16 22:50:15 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=2901744
Elapsed time: 106263ms

fs1a=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/16 22:52:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:52:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2281L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [c_custkey#290L]
         :     :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L]
         :        +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/16 22:52:01 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:52:01 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:52:01 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:52:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2281L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, 'rid_2, 'l_returnflag_prf_2, 'l_orderkey_and_l_linenumber_prf_2, 'l_comment_prf_2, 'l_linestatus_prf_2, ... 15 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#2323]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#2302]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2293: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [c_acctbal_prf#2283 AS c_acctbal_prf_0#2292, rid#2284 AS rid_0#2293, c_name_prf#2285 AS c_name_prf_0#2294, c_nationkey_prf#2286 AS c_nationkey_prf_0#2295, c_custkey_prf#2287 AS c_custkey_prf_0#2296, c_comment_prf#2288 AS c_comment_prf_0#2297, c_address_prf#2289 AS c_address_prf_0#2298, c_mktsegment_prf#2290 AS c_mktsegment_prf_0#2299, c_phone_prf#2291 AS c_phone_prf_0#2300]
         :     :  :     :  :     :  :  +- Relation[c_acctbal_prf#2283,rid#2284,c_name_prf#2285,c_nationkey_prf#2286,c_custkey_prf#2287,c_comment_prf#2288,c_address_prf#2289,c_mktsegment_prf#2290,c_phone_prf#2291] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2301]
         :     :  :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :  :     :        +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [o_shippriority_prf#2303 AS o_shippriority_prf_1#2313, rid#2304 AS rid_1#2314, o_orderdate_prf#2305 AS o_orderdate_prf_1#2315, o_custkey_prf#2306 AS o_custkey_prf_1#2316, o_orderpriority_prf#2307 AS o_orderpriority_prf_1#2317, o_clerk_prf#2308 AS o_clerk_prf_1#2318, o_orderstatus_prf#2309 AS o_orderstatus_prf_1#2319, o_totalprice_prf#2310 AS o_totalprice_prf_1#2320, o_orderkey_prf#2311 AS o_orderkey_prf_1#2321, o_comment_prf#2312 AS o_comment_prf_1#2322]
         :     :  :     :     +- Relation[o_shippriority_prf#2303,rid#2304,o_orderdate_prf#2305,o_custkey_prf#2306,o_orderpriority_prf#2307,o_clerk_prf#2308,o_orderstatus_prf#2309,o_totalprice_prf#2310,o_orderkey_prf#2311,o_comment_prf#2312] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#2324 AS l_returnflag_prf_2#2343, l_orderkey_and_l_linenumber_prf#2325 AS l_orderkey_and_l_linenumber_prf_2#2344, l_comment_prf#2326 AS l_comment_prf_2#2345, l_linestatus_prf#2327 AS l_linestatus_prf_2#2346, rid#2328 AS rid_2#2347, l_shipmode_prf#2329 AS l_shipmode_prf_2#2348, l_shipinstruct_prf#2330 AS l_shipinstruct_prf_2#2349, l_quantity_prf#2331 AS l_quantity_prf_2#2350, l_receiptdate_prf#2332 AS l_receiptdate_prf_2#2351, l_linenumber_prf#2333 AS l_linenumber_prf_2#2352, l_tax_prf#2334 AS l_tax_prf_2#2353, l_shipdate_prf#2335 AS l_shipdate_prf_2#2354, l_extendedprice_prf#2336 AS l_extendedprice_prf_2#2355, l_partkey_prf#2337 AS l_partkey_prf_2#2356, l_discount_prf#2338 AS l_discount_prf_2#2357, l_partkey_and_l_suppkey_prf#2339 AS l_partkey_and_l_suppkey_prf_2#2358, l_commitdate_prf#2340 AS l_commitdate_prf_2#2359, l_suppkey_prf#2341 AS l_suppkey_prf_2#2360, l_orderkey_prf#2342 AS l_orderkey_prf_2#2361]
         :     :     +- Relation[l_returnflag_prf#2324,l_orderkey_and_l_linenumber_prf#2325,l_comment_prf#2326,l_linestatus_prf#2327,rid#2328,l_shipmode_prf#2329,l_shipinstruct_prf#2330,l_quantity_prf#2331,l_receiptdate_prf#2332,l_linenumber_prf#2333,l_tax_prf#2334,l_shipdate_prf#2335,l_extendedprice_prf#2336,l_partkey_prf#2337,l_discount_prf#2338,l_partkey_and_l_suppkey_prf#2339,l_commitdate_prf#2340,l_suppkey_prf#2341,l_orderkey_prf#2342] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#2363 AS p_comment_prf_3#2373, p_name_prf#2364 AS p_name_prf_3#2374, rid#2365 AS rid_3#2375, p_type_prf#2366 AS p_type_prf_3#2376, p_retailprice_prf#2367 AS p_retailprice_prf_3#2377, p_mfgr_prf#2368 AS p_mfgr_prf_3#2378, p_container_prf#2369 AS p_container_prf_3#2379, p_brand_prf#2370 AS p_brand_prf_3#2380, p_size_prf#2371 AS p_size_prf_3#2381, p_partkey_prf#2372 AS p_partkey_prf_3#2382]
            +- Relation[p_comment_prf#2363,p_name_prf#2364,rid#2365,p_type_prf#2366,p_retailprice_prf#2367,p_mfgr_prf#2368,p_container_prf#2369,p_brand_prf#2370,p_size_prf#2371,p_partkey_prf#2372] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 108244ms

ft3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and p_size = 15 and l_suppkey = s_suppkey
19/10/16 22:53:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:53:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2466L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 22:53:49 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:53:49 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:53:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2466L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, rid_0#2491: string
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [l_returnflag_prf#2468 AS l_returnflag_prf_0#2487, l_orderkey_and_l_linenumber_prf#2469 AS l_orderkey_and_l_linenumber_prf_0#2488, l_comment_prf#2470 AS l_comment_prf_0#2489, l_linestatus_prf#2471 AS l_linestatus_prf_0#2490, rid#2472 AS rid_0#2491, l_shipmode_prf#2473 AS l_shipmode_prf_0#2492, l_shipinstruct_prf#2474 AS l_shipinstruct_prf_0#2493, l_quantity_prf#2475 AS l_quantity_prf_0#2494, l_receiptdate_prf#2476 AS l_receiptdate_prf_0#2495, l_linenumber_prf#2477 AS l_linenumber_prf_0#2496, l_tax_prf#2478 AS l_tax_prf_0#2497, l_shipdate_prf#2479 AS l_shipdate_prf_0#2498, l_extendedprice_prf#2480 AS l_extendedprice_prf_0#2499, l_partkey_prf#2481 AS l_partkey_prf_0#2500, l_discount_prf#2482 AS l_discount_prf_0#2501, l_partkey_and_l_suppkey_prf#2483 AS l_partkey_and_l_suppkey_prf_0#2502, l_commitdate_prf#2484 AS l_commitdate_prf_0#2503, l_suppkey_prf#2485 AS l_suppkey_prf_0#2504, l_orderkey_prf#2486 AS l_orderkey_prf_0#2505]
         :     :  :  :  +- Relation[l_returnflag_prf#2468,l_orderkey_and_l_linenumber_prf#2469,l_comment_prf#2470,l_linestatus_prf#2471,rid#2472,l_shipmode_prf#2473,l_shipinstruct_prf#2474,l_quantity_prf#2475,l_receiptdate_prf#2476,l_linenumber_prf#2477,l_tax_prf#2478,l_shipdate_prf#2479,l_extendedprice_prf#2480,l_partkey_prf#2481,l_discount_prf#2482,l_partkey_and_l_suppkey_prf#2483,l_commitdate_prf#2484,l_suppkey_prf#2485,l_orderkey_prf#2486] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#2526]
         :     :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#2525]
         :     :  :        :  +- Relation[l_returnflag_prf#2506,l_orderkey_and_l_linenumber_prf#2507,l_comment_prf#2508,l_linestatus_prf#2509,rid#2510,l_shipmode_prf#2511,l_shipinstruct_prf#2512,l_quantity_prf#2513,l_receiptdate_prf#2514,l_linenumber_prf#2515,l_tax_prf#2516,l_shipdate_prf#2517,l_extendedprice_prf#2518,l_partkey_prf#2519,l_discount_prf#2520,l_partkey_and_l_suppkey_prf#2521,l_commitdate_prf#2522,l_suppkey_prf#2523,l_orderkey_prf#2524] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [p_comment_prf#2527 AS p_comment_prf_1#2537, p_name_prf#2528 AS p_name_prf_1#2538, rid#2529 AS rid_1#2539, p_type_prf#2530 AS p_type_prf_1#2540, p_retailprice_prf#2531 AS p_retailprice_prf_1#2541, p_mfgr_prf#2532 AS p_mfgr_prf_1#2542, p_container_prf#2533 AS p_container_prf_1#2543, p_brand_prf#2534 AS p_brand_prf_1#2544, p_size_prf#2535 AS p_size_prf_1#2545, p_partkey_prf#2536 AS p_partkey_prf_1#2546]
         :     :     :  +- Relation[p_comment_prf#2527,p_name_prf#2528,rid#2529,p_type_prf#2530,p_retailprice_prf#2531,p_mfgr_prf#2532,p_container_prf#2533,p_brand_prf#2534,p_size_prf#2535,p_partkey_prf#2536] JDBCRelation(part_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2547]
         :     :        +- DexRidFilter part~p_size~15
         :     :           +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2549 AS s_phone_prf_2#2557, rid#2550 AS rid_2#2558, s_address_prf#2551 AS s_address_prf_2#2559, s_nationkey_prf#2552 AS s_nationkey_prf_2#2560, s_suppkey_prf#2553 AS s_suppkey_prf_2#2561, s_name_prf#2554 AS s_name_prf_2#2562, s_acctbal_prf#2555 AS s_acctbal_prf_2#2563, s_comment_prf#2556 AS s_comment_prf_2#2564]
            +- Relation[s_phone_prf#2549,rid#2550,s_address_prf#2551,s_nationkey_prf#2552,s_suppkey_prf#2553,s_name_prf#2554,s_acctbal_prf#2555,s_comment_prf#2556] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 95973ms

fs1b=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/16 22:55:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:55:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2647L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L, l_partkey#307L]
               :  +- Filter (isnotnull(l_orderkey#306L) && isnotnull(l_partkey#307L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L]
                  +- Join Inner, (c_custkey#290L = o_custkey#343L)
                     :- Project [c_custkey#290L]
                     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
                     +- Project [o_orderkey#342L, o_custkey#343L]
                        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 22:55:25 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:55:25 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:55:25 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 22:55:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2647L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [p_comment_prf#2649 AS p_comment_prf_0#2659, p_name_prf#2650 AS p_name_prf_0#2660, rid#2651 AS rid_0#2661, p_type_prf#2652 AS p_type_prf_0#2662, p_retailprice_prf#2653 AS p_retailprice_prf_0#2663, p_mfgr_prf#2654 AS p_mfgr_prf_0#2664, p_container_prf#2655 AS p_container_prf_0#2665, p_brand_prf#2656 AS p_brand_prf_0#2666, p_size_prf#2657 AS p_size_prf_0#2667, p_partkey_prf#2658 AS p_partkey_prf_0#2668]
         :  :  +- Relation[p_comment_prf#2649,p_name_prf#2650,rid#2651,p_type_prf#2652,p_retailprice_prf#2653,p_mfgr_prf#2654,p_container_prf#2655,p_brand_prf#2656,p_size_prf#2657,p_partkey_prf#2658] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#2680]
         :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2679]
         :        :  +- Relation[p_comment_prf#2669,p_name_prf#2670,rid#2671,p_type_prf#2672,p_retailprice_prf#2673,p_mfgr_prf#2674,p_container_prf#2675,p_brand_prf#2676,p_size_prf#2677,p_partkey_prf#2678] JDBCRelation(part_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [l_returnflag_prf#2681 AS l_returnflag_prf_1#2700, l_orderkey_and_l_linenumber_prf#2682 AS l_orderkey_and_l_linenumber_prf_1#2701, l_comment_prf#2683 AS l_comment_prf_1#2702, l_linestatus_prf#2684 AS l_linestatus_prf_1#2703, rid#2685 AS rid_1#2704, l_shipmode_prf#2686 AS l_shipmode_prf_1#2705, l_shipinstruct_prf#2687 AS l_shipinstruct_prf_1#2706, l_quantity_prf#2688 AS l_quantity_prf_1#2707, l_receiptdate_prf#2689 AS l_receiptdate_prf_1#2708, l_linenumber_prf#2690 AS l_linenumber_prf_1#2709, l_tax_prf#2691 AS l_tax_prf_1#2710, l_shipdate_prf#2692 AS l_shipdate_prf_1#2711, l_extendedprice_prf#2693 AS l_extendedprice_prf_1#2712, l_partkey_prf#2694 AS l_partkey_prf_1#2713, l_discount_prf#2695 AS l_discount_prf_1#2714, l_partkey_and_l_suppkey_prf#2696 AS l_partkey_and_l_suppkey_prf_1#2715, l_commitdate_prf#2697 AS l_commitdate_prf_1#2716, l_suppkey_prf#2698 AS l_suppkey_prf_1#2717, l_orderkey_prf#2699 AS l_orderkey_prf_1#2718]
            :  :  +- Relation[l_returnflag_prf#2681,l_orderkey_and_l_linenumber_prf#2682,l_comment_prf#2683,l_linestatus_prf#2684,rid#2685,l_shipmode_prf#2686,l_shipinstruct_prf#2687,l_quantity_prf#2688,l_receiptdate_prf#2689,l_linenumber_prf#2690,l_tax_prf#2691,l_shipdate_prf#2692,l_extendedprice_prf#2693,l_partkey_prf#2694,l_discount_prf#2695,l_partkey_and_l_suppkey_prf#2696,l_commitdate_prf#2697,l_suppkey_prf#2698,l_orderkey_prf#2699] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2154) AS rid_3#2739]
            :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#2738]
            :        :  +- Relation[l_returnflag_prf#2719,l_orderkey_and_l_linenumber_prf#2720,l_comment_prf#2721,l_linestatus_prf#2722,rid#2723,l_shipmode_prf#2724,l_shipinstruct_prf#2725,l_quantity_prf#2726,l_receiptdate_prf#2727,l_linenumber_prf#2728,l_tax_prf#2729,l_shipdate_prf#2730,l_extendedprice_prf#2731,l_partkey_prf#2732,l_discount_prf#2733,l_partkey_and_l_suppkey_prf#2734,l_commitdate_prf#2735,l_suppkey_prf#2736,l_orderkey_prf#2737] JDBCRelation(lineitem_prf) [numPartitions=1]
            :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join NaturalJoin(Inner)
               :- 'Project ['c_acctbal_prf_2, 'rid_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2154) AS rid_3#2759]
               :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_2#2750: string
               :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :     :  :- Project [c_acctbal_prf#2740 AS c_acctbal_prf_2#2749, rid#2741 AS rid_2#2750, c_name_prf#2742 AS c_name_prf_2#2751, c_nationkey_prf#2743 AS c_nationkey_prf_2#2752, c_custkey_prf#2744 AS c_custkey_prf_2#2753, c_comment_prf#2745 AS c_comment_prf_2#2754, c_address_prf#2746 AS c_address_prf_2#2755, c_mktsegment_prf#2747 AS c_mktsegment_prf_2#2756, c_phone_prf#2748 AS c_phone_prf_2#2757]
               :     :  :  +- Relation[c_acctbal_prf#2740,rid#2741,c_name_prf#2742,c_nationkey_prf#2743,c_custkey_prf#2744,c_comment_prf#2745,c_address_prf#2746,c_mktsegment_prf#2747,c_phone_prf#2748] JDBCRelation(customer_prf) [numPartitions=1]
               :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#2758]
               :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
               :     :        +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
               :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
               +- Project [o_shippriority_prf#2760 AS o_shippriority_prf_3#2770, rid#2761 AS rid_3#2771, o_orderdate_prf#2762 AS o_orderdate_prf_3#2772, o_custkey_prf#2763 AS o_custkey_prf_3#2773, o_orderpriority_prf#2764 AS o_orderpriority_prf_3#2774, o_clerk_prf#2765 AS o_clerk_prf_3#2775, o_orderstatus_prf#2766 AS o_orderstatus_prf_3#2776, o_totalprice_prf#2767 AS o_totalprice_prf_3#2777, o_orderkey_prf#2768 AS o_orderkey_prf_3#2778, o_comment_prf#2769 AS o_comment_prf_3#2779]
                  +- Relation[o_shippriority_prf#2760,rid#2761,o_orderdate_prf#2762,o_custkey_prf#2763,o_orderpriority_prf#2764,o_clerk_prf#2765,o_orderstatus_prf#2766,o_totalprice_prf#2767,o_orderkey_prf#2768,o_comment_prf#2769] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 172733ms

ft1d=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/16 22:58:18 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:58:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2850L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_nationkey#21L]
                  +- Filter isnotnull(s_nationkey#21L)
                     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 22:58:18 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:58:18 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:58:18 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:58:18 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:58:18 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:58:18 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:58:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2850L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#2852 AS c_acctbal_prf_0#2861, rid#2853 AS rid_0#2862, c_name_prf#2854 AS c_name_prf_0#2863, c_nationkey_prf#2855 AS c_nationkey_prf_0#2864, c_custkey_prf#2856 AS c_custkey_prf_0#2865, c_comment_prf#2857 AS c_comment_prf_0#2866, c_address_prf#2858 AS c_address_prf_0#2867, c_mktsegment_prf#2859 AS c_mktsegment_prf_0#2868, c_phone_prf#2860 AS c_phone_prf_0#2869]
         :  :  +- Relation[c_acctbal_prf#2852,rid#2853,c_name_prf#2854,c_nationkey_prf#2855,c_custkey_prf#2856,c_comment_prf#2857,c_address_prf#2858,c_mktsegment_prf#2859,c_phone_prf#2860] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#2880]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2879]
         :        :  +- Relation[c_acctbal_prf#2870,rid#2871,c_name_prf#2872,c_nationkey_prf#2873,c_custkey_prf#2874,c_comment_prf#2875,c_address_prf#2876,c_mktsegment_prf#2877,c_phone_prf#2878] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#2892]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_1#2886: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [rid#2881 AS rid_1#2886, n_regionkey_prf#2882 AS n_regionkey_prf_1#2887, n_nationkey_prf#2883 AS n_nationkey_prf_1#2888, n_name_prf#2884 AS n_name_prf_1#2889, n_comment_prf#2885 AS n_comment_prf_1#2890]
            :     :  :  +- Relation[rid#2881,n_regionkey_prf#2882,n_nationkey_prf#2883,n_name_prf#2884,n_comment_prf#2885] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2891]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [s_phone_prf#2893 AS s_phone_prf_2#2901, rid#2894 AS rid_2#2902, s_address_prf#2895 AS s_address_prf_2#2903, s_nationkey_prf#2896 AS s_nationkey_prf_2#2904, s_suppkey_prf#2897 AS s_suppkey_prf_2#2905, s_name_prf#2898 AS s_name_prf_2#2906, s_acctbal_prf#2899 AS s_acctbal_prf_2#2907, s_comment_prf#2900 AS s_comment_prf_2#2908]
               +- Relation[s_phone_prf#2893,rid#2894,s_address_prf#2895,s_nationkey_prf#2896,s_suppkey_prf#2897,s_name_prf#2898,s_acctbal_prf#2899,s_comment_prf#2900] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 24197ms

fq1a=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 22:58:42 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:58:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2971L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :     :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 22:58:42 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:58:42 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:58:42 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:58:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2971L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, 'rid_2, 'o_shippriority_prf_2, 'o_orderdate_prf_2, 'o_custkey_prf_2, 'o_orderpriority_prf_2, 'o_clerk_prf_2, 'o_orderstatus_prf_2, 'o_totalprice_prf_2, 'o_orderkey_prf_2, 'o_comment_prf_2, dexdecrypt('value_dec_key, value#2154) AS rid_3#3024]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#3003]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#2984]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#2978: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [rid#2973 AS rid_0#2978, n_regionkey_prf#2974 AS n_regionkey_prf_0#2979, n_nationkey_prf#2975 AS n_nationkey_prf_0#2980, n_name_prf#2976 AS n_name_prf_0#2981, n_comment_prf#2977 AS n_comment_prf_0#2982]
         :     :  :     :  :     :  :  +- Relation[rid#2973,n_regionkey_prf#2974,n_nationkey_prf#2975,n_name_prf#2976,n_comment_prf#2977] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2983]
         :     :  :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :  :     :        +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [c_acctbal_prf#2985 AS c_acctbal_prf_1#2994, rid#2986 AS rid_1#2995, c_name_prf#2987 AS c_name_prf_1#2996, c_nationkey_prf#2988 AS c_nationkey_prf_1#2997, c_custkey_prf#2989 AS c_custkey_prf_1#2998, c_comment_prf#2990 AS c_comment_prf_1#2999, c_address_prf#2991 AS c_address_prf_1#3000, c_mktsegment_prf#2992 AS c_mktsegment_prf_1#3001, c_phone_prf#2993 AS c_phone_prf_1#3002]
         :     :  :     :     +- Relation[c_acctbal_prf#2985,rid#2986,c_name_prf#2987,c_nationkey_prf#2988,c_custkey_prf#2989,c_comment_prf#2990,c_address_prf#2991,c_mktsegment_prf#2992,c_phone_prf#2993] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#3004 AS o_shippriority_prf_2#3014, rid#3005 AS rid_2#3015, o_orderdate_prf#3006 AS o_orderdate_prf_2#3016, o_custkey_prf#3007 AS o_custkey_prf_2#3017, o_orderpriority_prf#3008 AS o_orderpriority_prf_2#3018, o_clerk_prf#3009 AS o_clerk_prf_2#3019, o_orderstatus_prf#3010 AS o_orderstatus_prf_2#3020, o_totalprice_prf#3011 AS o_totalprice_prf_2#3021, o_orderkey_prf#3012 AS o_orderkey_prf_2#3022, o_comment_prf#3013 AS o_comment_prf_2#3023]
         :     :     +- Relation[o_shippriority_prf#3004,rid#3005,o_orderdate_prf#3006,o_custkey_prf#3007,o_orderpriority_prf#3008,o_clerk_prf#3009,o_orderstatus_prf#3010,o_totalprice_prf#3011,o_orderkey_prf#3012,o_comment_prf#3013] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3025 AS l_returnflag_prf_3#3044, l_orderkey_and_l_linenumber_prf#3026 AS l_orderkey_and_l_linenumber_prf_3#3045, l_comment_prf#3027 AS l_comment_prf_3#3046, l_linestatus_prf#3028 AS l_linestatus_prf_3#3047, rid#3029 AS rid_3#3048, l_shipmode_prf#3030 AS l_shipmode_prf_3#3049, l_shipinstruct_prf#3031 AS l_shipinstruct_prf_3#3050, l_quantity_prf#3032 AS l_quantity_prf_3#3051, l_receiptdate_prf#3033 AS l_receiptdate_prf_3#3052, l_linenumber_prf#3034 AS l_linenumber_prf_3#3053, l_tax_prf#3035 AS l_tax_prf_3#3054, l_shipdate_prf#3036 AS l_shipdate_prf_3#3055, l_extendedprice_prf#3037 AS l_extendedprice_prf_3#3056, l_partkey_prf#3038 AS l_partkey_prf_3#3057, l_discount_prf#3039 AS l_discount_prf_3#3058, l_partkey_and_l_suppkey_prf#3040 AS l_partkey_and_l_suppkey_prf_3#3059, l_commitdate_prf#3041 AS l_commitdate_prf_3#3060, l_suppkey_prf#3042 AS l_suppkey_prf_3#3061, l_orderkey_prf#3043 AS l_orderkey_prf_3#3062]
            +- Relation[l_returnflag_prf#3025,l_orderkey_and_l_linenumber_prf#3026,l_comment_prf#3027,l_linestatus_prf#3028,rid#3029,l_shipmode_prf#3030,l_shipinstruct_prf#3031,l_quantity_prf#3032,l_receiptdate_prf#3033,l_linenumber_prf#3034,l_tax_prf#3035,l_shipdate_prf#3036,l_extendedprice_prf#3037,l_partkey_prf#3038,l_discount_prf#3039,l_partkey_and_l_suppkey_prf#3040,l_commitdate_prf#3041,l_suppkey_prf#3042,l_orderkey_prf#3043] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 31049ms

ft1b=
select * from nation, supplier, customer where n_name = 'FRANCE' and n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/16 22:59:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:59:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3128L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 22:59:13 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:59:13 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:59:13 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:59:13 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:59:13 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:59:13 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:59:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3128L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#3158]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#3141]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#3135: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#3130 AS rid_0#3135, n_regionkey_prf#3131 AS n_regionkey_prf_0#3136, n_nationkey_prf#3132 AS n_nationkey_prf_0#3137, n_name_prf#3133 AS n_name_prf_0#3138, n_comment_prf#3134 AS n_comment_prf_0#3139]
         :     :  :     :  :  +- Relation[rid#3130,n_regionkey_prf#3131,n_nationkey_prf#3132,n_name_prf#3133,n_comment_prf#3134] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3140]
         :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :        +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#3142 AS s_phone_prf_1#3150, rid#3143 AS rid_1#3151, s_address_prf#3144 AS s_address_prf_1#3152, s_nationkey_prf#3145 AS s_nationkey_prf_1#3153, s_suppkey_prf#3146 AS s_suppkey_prf_1#3154, s_name_prf#3147 AS s_name_prf_1#3155, s_acctbal_prf#3148 AS s_acctbal_prf_1#3156, s_comment_prf#3149 AS s_comment_prf_1#3157]
         :     :     +- Relation[s_phone_prf#3142,rid#3143,s_address_prf#3144,s_nationkey_prf#3145,s_suppkey_prf#3146,s_name_prf#3147,s_acctbal_prf#3148,s_comment_prf#3149] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3159 AS c_acctbal_prf_2#3168, rid#3160 AS rid_2#3169, c_name_prf#3161 AS c_name_prf_2#3170, c_nationkey_prf#3162 AS c_nationkey_prf_2#3171, c_custkey_prf#3163 AS c_custkey_prf_2#3172, c_comment_prf#3164 AS c_comment_prf_2#3173, c_address_prf#3165 AS c_address_prf_2#3174, c_mktsegment_prf#3166 AS c_mktsegment_prf_2#3175, c_phone_prf#3167 AS c_phone_prf_2#3176]
            +- Relation[c_acctbal_prf#3159,rid#3160,c_name_prf#3161,c_nationkey_prf#3162,c_custkey_prf#3163,c_comment_prf#3164,c_address_prf#3165,c_mktsegment_prf#3166,c_phone_prf#3167] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 30049ms

ft2b=
select * from part, partsupp, supplier where p_size = 15 and p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/16 22:59:43 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:59:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3223L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 22:59:43 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 22:59:43 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 22:59:43 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 22:59:43 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:59:43 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:59:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3223L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#3261]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#3246]
         :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#3237: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [p_comment_prf#3225 AS p_comment_prf_0#3235, p_name_prf#3226 AS p_name_prf_0#3236, rid#3227 AS rid_0#3237, p_type_prf#3228 AS p_type_prf_0#3238, p_retailprice_prf#3229 AS p_retailprice_prf_0#3239, p_mfgr_prf#3230 AS p_mfgr_prf_0#3240, p_container_prf#3231 AS p_container_prf_0#3241, p_brand_prf#3232 AS p_brand_prf_0#3242, p_size_prf#3233 AS p_size_prf_0#3243, p_partkey_prf#3234 AS p_partkey_prf_0#3244]
         :     :  :     :  :  +- Relation[p_comment_prf#3225,p_name_prf#3226,rid#3227,p_type_prf#3228,p_retailprice_prf#3229,p_mfgr_prf#3230,p_container_prf#3231,p_brand_prf#3232,p_size_prf#3233,p_partkey_prf#3234] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3245]
         :     :  :     :     +- DexRidFilter part~p_size~15
         :     :  :     :        +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#3247 AS ps_partkey_and_ps_suppkey_prf_1#3254, rid#3248 AS rid_1#3255, ps_availqty_prf#3249 AS ps_availqty_prf_1#3256, ps_comment_prf#3250 AS ps_comment_prf_1#3257, ps_partkey_prf#3251 AS ps_partkey_prf_1#3258, ps_supplycost_prf#3252 AS ps_supplycost_prf_1#3259, ps_suppkey_prf#3253 AS ps_suppkey_prf_1#3260]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#3247,rid#3248,ps_availqty_prf#3249,ps_comment_prf#3250,ps_partkey_prf#3251,ps_supplycost_prf#3252,ps_suppkey_prf#3253] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3262 AS s_phone_prf_2#3270, rid#3263 AS rid_2#3271, s_address_prf#3264 AS s_address_prf_2#3272, s_nationkey_prf#3265 AS s_nationkey_prf_2#3273, s_suppkey_prf#3266 AS s_suppkey_prf_2#3274, s_name_prf#3267 AS s_name_prf_2#3275, s_acctbal_prf#3268 AS s_acctbal_prf_2#3276, s_comment_prf#3269 AS s_comment_prf_2#3277]
            +- Relation[s_phone_prf#3262,rid#3263,s_address_prf#3264,s_nationkey_prf#3265,s_suppkey_prf#3266,s_name_prf#3267,s_acctbal_prf#3268,s_comment_prf#3269] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 918ms

ft1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_name = 'FRANCE' and n_nationkey = c_nationkey
19/10/16 22:59:44 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 22:59:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3325L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 22:59:44 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:59:44 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:59:44 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:59:44 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 22:59:44 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:59:44 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:59:44 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 22:59:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3325L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#3364]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [s_phone_prf#3327 AS s_phone_prf_0#3335, rid#3328 AS rid_0#3336, s_address_prf#3329 AS s_address_prf_0#3337, s_nationkey_prf#3330 AS s_nationkey_prf_0#3338, s_suppkey_prf#3331 AS s_suppkey_prf_0#3339, s_name_prf#3332 AS s_name_prf_0#3340, s_acctbal_prf#3333 AS s_acctbal_prf_0#3341, s_comment_prf#3334 AS s_comment_prf_0#3342]
         :     :  :  :  +- Relation[s_phone_prf#3327,rid#3328,s_address_prf#3329,s_nationkey_prf#3330,s_suppkey_prf#3331,s_name_prf#3332,s_acctbal_prf#3333,s_comment_prf#3334] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#3352]
         :     :  :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#3351]
         :     :  :        :  +- Relation[s_phone_prf#3343,rid#3344,s_address_prf#3345,s_nationkey_prf#3346,s_suppkey_prf#3347,s_name_prf#3348,s_acctbal_prf#3349,s_comment_prf#3350] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [rid#3353 AS rid_1#3358, n_regionkey_prf#3354 AS n_regionkey_prf_1#3359, n_nationkey_prf#3355 AS n_nationkey_prf_1#3360, n_name_prf#3356 AS n_name_prf_1#3361, n_comment_prf#3357 AS n_comment_prf_1#3362]
         :     :     :  +- Relation[rid#3353,n_regionkey_prf#3354,n_nationkey_prf#3355,n_name_prf#3356,n_comment_prf#3357] JDBCRelation(nation_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3363]
         :     :        +- DexRidFilter nation~n_name~FRANCE
         :     :           +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3365 AS c_acctbal_prf_2#3374, rid#3366 AS rid_2#3375, c_name_prf#3367 AS c_name_prf_2#3376, c_nationkey_prf#3368 AS c_nationkey_prf_2#3377, c_custkey_prf#3369 AS c_custkey_prf_2#3378, c_comment_prf#3370 AS c_comment_prf_2#3379, c_address_prf#3371 AS c_address_prf_2#3380, c_mktsegment_prf#3372 AS c_mktsegment_prf_2#3381, c_phone_prf#3373 AS c_phone_prf_2#3382]
            +- Relation[c_acctbal_prf#3365,rid#3366,c_name_prf#3367,c_nationkey_prf#3368,c_custkey_prf#3369,c_comment_prf#3370,c_address_prf#3371,c_mktsegment_prf#3372,c_phone_prf#3373] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 47676ms

fq1e=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 23:00:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:00:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3445L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :- Project [n_nationkey#108L]
               :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [c_custkey#290L, c_nationkey#293L]
                  +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 23:00:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:00:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:00:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:00:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3445L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [l_returnflag_prf#3447 AS l_returnflag_prf_0#3466, l_orderkey_and_l_linenumber_prf#3448 AS l_orderkey_and_l_linenumber_prf_0#3467, l_comment_prf#3449 AS l_comment_prf_0#3468, l_linestatus_prf#3450 AS l_linestatus_prf_0#3469, rid#3451 AS rid_0#3470, l_shipmode_prf#3452 AS l_shipmode_prf_0#3471, l_shipinstruct_prf#3453 AS l_shipinstruct_prf_0#3472, l_quantity_prf#3454 AS l_quantity_prf_0#3473, l_receiptdate_prf#3455 AS l_receiptdate_prf_0#3474, l_linenumber_prf#3456 AS l_linenumber_prf_0#3475, l_tax_prf#3457 AS l_tax_prf_0#3476, l_shipdate_prf#3458 AS l_shipdate_prf_0#3477, l_extendedprice_prf#3459 AS l_extendedprice_prf_0#3478, l_partkey_prf#3460 AS l_partkey_prf_0#3479, l_discount_prf#3461 AS l_discount_prf_0#3480, l_partkey_and_l_suppkey_prf#3462 AS l_partkey_and_l_suppkey_prf_0#3481, l_commitdate_prf#3463 AS l_commitdate_prf_0#3482, l_suppkey_prf#3464 AS l_suppkey_prf_0#3483, l_orderkey_prf#3465 AS l_orderkey_prf_0#3484]
         :  :  :  :  +- Relation[l_returnflag_prf#3447,l_orderkey_and_l_linenumber_prf#3448,l_comment_prf#3449,l_linestatus_prf#3450,rid#3451,l_shipmode_prf#3452,l_shipinstruct_prf#3453,l_quantity_prf#3454,l_receiptdate_prf#3455,l_linenumber_prf#3456,l_tax_prf#3457,l_shipdate_prf#3458,l_extendedprice_prf#3459,l_partkey_prf#3460,l_discount_prf#3461,l_partkey_and_l_suppkey_prf#3462,l_commitdate_prf#3463,l_suppkey_prf#3464,l_orderkey_prf#3465] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#3505]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#3504]
         :  :  :        :  +- Relation[l_returnflag_prf#3485,l_orderkey_and_l_linenumber_prf#3486,l_comment_prf#3487,l_linestatus_prf#3488,rid#3489,l_shipmode_prf#3490,l_shipinstruct_prf#3491,l_quantity_prf#3492,l_receiptdate_prf#3493,l_linenumber_prf#3494,l_tax_prf#3495,l_shipdate_prf#3496,l_extendedprice_prf#3497,l_partkey_prf#3498,l_discount_prf#3499,l_partkey_and_l_suppkey_prf#3500,l_commitdate_prf#3501,l_suppkey_prf#3502,l_orderkey_prf#3503] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#3506 AS o_shippriority_prf_1#3516, rid#3507 AS rid_1#3517, o_orderdate_prf#3508 AS o_orderdate_prf_1#3518, o_custkey_prf#3509 AS o_custkey_prf_1#3519, o_orderpriority_prf#3510 AS o_orderpriority_prf_1#3520, o_clerk_prf#3511 AS o_clerk_prf_1#3521, o_orderstatus_prf#3512 AS o_orderstatus_prf_1#3522, o_totalprice_prf#3513 AS o_totalprice_prf_1#3523, o_orderkey_prf#3514 AS o_orderkey_prf_1#3524, o_comment_prf#3515 AS o_comment_prf_1#3525]
         :  :     +- Relation[o_shippriority_prf#3506,rid#3507,o_orderdate_prf#3508,o_custkey_prf#3509,o_orderpriority_prf#3510,o_clerk_prf#3511,o_orderstatus_prf#3512,o_totalprice_prf#3513,o_orderkey_prf#3514,o_comment_prf#3515] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2154) AS rid_3#3537]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3536]
         :        :  +- Relation[o_shippriority_prf#3526,rid#3527,o_orderdate_prf#3528,o_custkey_prf#3529,o_orderpriority_prf#3530,o_clerk_prf#3531,o_orderstatus_prf#3532,o_totalprice_prf#3533,o_orderkey_prf#3534,o_comment_prf#3535] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_2, 'n_regionkey_prf_2, 'n_nationkey_prf_2, 'n_name_prf_2, 'n_comment_prf_2, dexdecrypt('value_dec_key, value#2154) AS rid_3#3549]
            :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_2#3543: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [rid#3538 AS rid_2#3543, n_regionkey_prf#3539 AS n_regionkey_prf_2#3544, n_nationkey_prf#3540 AS n_nationkey_prf_2#3545, n_name_prf#3541 AS n_name_prf_2#3546, n_comment_prf#3542 AS n_comment_prf_2#3547]
            :     :  :  +- Relation[rid#3538,n_regionkey_prf#3539,n_nationkey_prf#3540,n_name_prf#3541,n_comment_prf#3542] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#3548]
            :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :        +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#3550 AS c_acctbal_prf_3#3559, rid#3551 AS rid_3#3560, c_name_prf#3552 AS c_name_prf_3#3561, c_nationkey_prf#3553 AS c_nationkey_prf_3#3562, c_custkey_prf#3554 AS c_custkey_prf_3#3563, c_comment_prf#3555 AS c_comment_prf_3#3564, c_address_prf#3556 AS c_address_prf_3#3565, c_mktsegment_prf#3557 AS c_mktsegment_prf_3#3566, c_phone_prf#3558 AS c_phone_prf_3#3567]
               +- Relation[c_acctbal_prf#3550,rid#3551,c_name_prf#3552,c_nationkey_prf#3553,c_custkey_prf#3554,c_comment_prf#3555,c_address_prf#3556,c_mktsegment_prf#3557,c_phone_prf#3558] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 165542ms

fr2a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_orderstatus = 'F' and o_custkey = c_custkey
19/10/16 23:03:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:03:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3647L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 23:03:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3647L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [l_returnflag_prf#3649 AS l_returnflag_prf_0#3668, l_orderkey_and_l_linenumber_prf#3650 AS l_orderkey_and_l_linenumber_prf_0#3669, l_comment_prf#3651 AS l_comment_prf_0#3670, l_linestatus_prf#3652 AS l_linestatus_prf_0#3671, rid#3653 AS rid_0#3672, l_shipmode_prf#3654 AS l_shipmode_prf_0#3673, l_shipinstruct_prf#3655 AS l_shipinstruct_prf_0#3674, l_quantity_prf#3656 AS l_quantity_prf_0#3675, l_receiptdate_prf#3657 AS l_receiptdate_prf_0#3676, l_linenumber_prf#3658 AS l_linenumber_prf_0#3677, l_tax_prf#3659 AS l_tax_prf_0#3678, l_shipdate_prf#3660 AS l_shipdate_prf_0#3679, l_extendedprice_prf#3661 AS l_extendedprice_prf_0#3680, l_partkey_prf#3662 AS l_partkey_prf_0#3681, l_discount_prf#3663 AS l_discount_prf_0#3682, l_partkey_and_l_suppkey_prf#3664 AS l_partkey_and_l_suppkey_prf_0#3683, l_commitdate_prf#3665 AS l_commitdate_prf_0#3684, l_suppkey_prf#3666 AS l_suppkey_prf_0#3685, l_orderkey_prf#3667 AS l_orderkey_prf_0#3686]
         :     :  :  :  +- Relation[l_returnflag_prf#3649,l_orderkey_and_l_linenumber_prf#3650,l_comment_prf#3651,l_linestatus_prf#3652,rid#3653,l_shipmode_prf#3654,l_shipinstruct_prf#3655,l_quantity_prf#3656,l_receiptdate_prf#3657,l_linenumber_prf#3658,l_tax_prf#3659,l_shipdate_prf#3660,l_extendedprice_prf#3661,l_partkey_prf#3662,l_discount_prf#3663,l_partkey_and_l_suppkey_prf#3664,l_commitdate_prf#3665,l_suppkey_prf#3666,l_orderkey_prf#3667] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#3707]
         :     :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#3706]
         :     :  :        :  +- Relation[l_returnflag_prf#3687,l_orderkey_and_l_linenumber_prf#3688,l_comment_prf#3689,l_linestatus_prf#3690,rid#3691,l_shipmode_prf#3692,l_shipinstruct_prf#3693,l_quantity_prf#3694,l_receiptdate_prf#3695,l_linenumber_prf#3696,l_tax_prf#3697,l_shipdate_prf#3698,l_extendedprice_prf#3699,l_partkey_prf#3700,l_discount_prf#3701,l_partkey_and_l_suppkey_prf#3702,l_commitdate_prf#3703,l_suppkey_prf#3704,l_orderkey_prf#3705] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [o_shippriority_prf#3708 AS o_shippriority_prf_1#3718, rid#3709 AS rid_1#3719, o_orderdate_prf#3710 AS o_orderdate_prf_1#3720, o_custkey_prf#3711 AS o_custkey_prf_1#3721, o_orderpriority_prf#3712 AS o_orderpriority_prf_1#3722, o_clerk_prf#3713 AS o_clerk_prf_1#3723, o_orderstatus_prf#3714 AS o_orderstatus_prf_1#3724, o_totalprice_prf#3715 AS o_totalprice_prf_1#3725, o_orderkey_prf#3716 AS o_orderkey_prf_1#3726, o_comment_prf#3717 AS o_comment_prf_1#3727]
         :     :     :  +- Relation[o_shippriority_prf#3708,rid#3709,o_orderdate_prf#3710,o_custkey_prf#3711,o_orderpriority_prf#3712,o_clerk_prf#3713,o_orderstatus_prf#3714,o_totalprice_prf#3715,o_orderkey_prf#3716,o_comment_prf#3717] JDBCRelation(orders_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3728]
         :     :        +- DexRidFilter orders~o_orderstatus~F
         :     :           +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3730 AS c_acctbal_prf_2#3739, rid#3731 AS rid_2#3740, c_name_prf#3732 AS c_name_prf_2#3741, c_nationkey_prf#3733 AS c_nationkey_prf_2#3742, c_custkey_prf#3734 AS c_custkey_prf_2#3743, c_comment_prf#3735 AS c_comment_prf_2#3744, c_address_prf#3736 AS c_address_prf_2#3745, c_mktsegment_prf#3737 AS c_mktsegment_prf_2#3746, c_phone_prf#3738 AS c_phone_prf_2#3747]
            +- Relation[c_acctbal_prf#3730,rid#3731,c_name_prf#3732,c_nationkey_prf#3733,c_custkey_prf#3734,c_comment_prf#3735,c_address_prf#3736,c_mktsegment_prf#3737,c_phone_prf#3738] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 194329ms

fq1b=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 23:06:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:06:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3826L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 23:06:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:06:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:06:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:06:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3826L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#3858]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#3839]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#3833: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#3828 AS rid_0#3833, n_regionkey_prf#3829 AS n_regionkey_prf_0#3834, n_nationkey_prf#3830 AS n_nationkey_prf_0#3835, n_name_prf#3831 AS n_name_prf_0#3836, n_comment_prf#3832 AS n_comment_prf_0#3837]
         :     :  :     :  :  +- Relation[rid#3828,n_regionkey_prf#3829,n_nationkey_prf#3830,n_name_prf#3831,n_comment_prf#3832] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3838]
         :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :        +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#3840 AS c_acctbal_prf_1#3849, rid#3841 AS rid_1#3850, c_name_prf#3842 AS c_name_prf_1#3851, c_nationkey_prf#3843 AS c_nationkey_prf_1#3852, c_custkey_prf#3844 AS c_custkey_prf_1#3853, c_comment_prf#3845 AS c_comment_prf_1#3854, c_address_prf#3846 AS c_address_prf_1#3855, c_mktsegment_prf#3847 AS c_mktsegment_prf_1#3856, c_phone_prf#3848 AS c_phone_prf_1#3857]
         :     :     +- Relation[c_acctbal_prf#3840,rid#3841,c_name_prf#3842,c_nationkey_prf#3843,c_custkey_prf#3844,c_comment_prf#3845,c_address_prf#3846,c_mktsegment_prf#3847,c_phone_prf#3848] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- Project [o_shippriority_prf#3859 AS o_shippriority_prf_2#3869, rid#3860 AS rid_2#3870, o_orderdate_prf#3861 AS o_orderdate_prf_2#3871, o_custkey_prf#3862 AS o_custkey_prf_2#3872, o_orderpriority_prf#3863 AS o_orderpriority_prf_2#3873, o_clerk_prf#3864 AS o_clerk_prf_2#3874, o_orderstatus_prf#3865 AS o_orderstatus_prf_2#3875, o_totalprice_prf#3866 AS o_totalprice_prf_2#3876, o_orderkey_prf#3867 AS o_orderkey_prf_2#3877, o_comment_prf#3868 AS o_comment_prf_2#3878]
            :  :  +- Relation[o_shippriority_prf#3859,rid#3860,o_orderdate_prf#3861,o_custkey_prf#3862,o_orderpriority_prf#3863,o_clerk_prf#3864,o_orderstatus_prf#3865,o_totalprice_prf#3866,o_orderkey_prf#3867,o_comment_prf#3868] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2154) AS rid_3#3890]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#3889]
            :        :  +- Relation[o_shippriority_prf#3879,rid#3880,o_orderdate_prf#3881,o_custkey_prf#3882,o_orderpriority_prf#3883,o_clerk_prf#3884,o_orderstatus_prf#3885,o_totalprice_prf#3886,o_orderkey_prf#3887,o_comment_prf#3888] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3891 AS l_returnflag_prf_3#3910, l_orderkey_and_l_linenumber_prf#3892 AS l_orderkey_and_l_linenumber_prf_3#3911, l_comment_prf#3893 AS l_comment_prf_3#3912, l_linestatus_prf#3894 AS l_linestatus_prf_3#3913, rid#3895 AS rid_3#3914, l_shipmode_prf#3896 AS l_shipmode_prf_3#3915, l_shipinstruct_prf#3897 AS l_shipinstruct_prf_3#3916, l_quantity_prf#3898 AS l_quantity_prf_3#3917, l_receiptdate_prf#3899 AS l_receiptdate_prf_3#3918, l_linenumber_prf#3900 AS l_linenumber_prf_3#3919, l_tax_prf#3901 AS l_tax_prf_3#3920, l_shipdate_prf#3902 AS l_shipdate_prf_3#3921, l_extendedprice_prf#3903 AS l_extendedprice_prf_3#3922, l_partkey_prf#3904 AS l_partkey_prf_3#3923, l_discount_prf#3905 AS l_discount_prf_3#3924, l_partkey_and_l_suppkey_prf#3906 AS l_partkey_and_l_suppkey_prf_3#3925, l_commitdate_prf#3907 AS l_commitdate_prf_3#3926, l_suppkey_prf#3908 AS l_suppkey_prf_3#3927, l_orderkey_prf#3909 AS l_orderkey_prf_3#3928]
               +- Relation[l_returnflag_prf#3891,l_orderkey_and_l_linenumber_prf#3892,l_comment_prf#3893,l_linestatus_prf#3894,rid#3895,l_shipmode_prf#3896,l_shipinstruct_prf#3897,l_quantity_prf#3898,l_receiptdate_prf#3899,l_linenumber_prf#3900,l_tax_prf#3901,l_shipdate_prf#3902,l_extendedprice_prf#3903,l_partkey_prf#3904,l_discount_prf#3905,l_partkey_and_l_suppkey_prf#3906,l_commitdate_prf#3907,l_suppkey_prf#3908,l_orderkey_prf#3909] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 140562ms

fq1d=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 23:08:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:08:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4012L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
               :     :- Project [n_nationkey#108L]
               :     :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Filter (isnotnull(c_nationkey#293L) && isnotnull(c_custkey#290L))
               :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 23:08:52 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:08:52 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:08:52 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:08:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4012L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#4014 AS l_returnflag_prf_0#4033, l_orderkey_and_l_linenumber_prf#4015 AS l_orderkey_and_l_linenumber_prf_0#4034, l_comment_prf#4016 AS l_comment_prf_0#4035, l_linestatus_prf#4017 AS l_linestatus_prf_0#4036, rid#4018 AS rid_0#4037, l_shipmode_prf#4019 AS l_shipmode_prf_0#4038, l_shipinstruct_prf#4020 AS l_shipinstruct_prf_0#4039, l_quantity_prf#4021 AS l_quantity_prf_0#4040, l_receiptdate_prf#4022 AS l_receiptdate_prf_0#4041, l_linenumber_prf#4023 AS l_linenumber_prf_0#4042, l_tax_prf#4024 AS l_tax_prf_0#4043, l_shipdate_prf#4025 AS l_shipdate_prf_0#4044, l_extendedprice_prf#4026 AS l_extendedprice_prf_0#4045, l_partkey_prf#4027 AS l_partkey_prf_0#4046, l_discount_prf#4028 AS l_discount_prf_0#4047, l_partkey_and_l_suppkey_prf#4029 AS l_partkey_and_l_suppkey_prf_0#4048, l_commitdate_prf#4030 AS l_commitdate_prf_0#4049, l_suppkey_prf#4031 AS l_suppkey_prf_0#4050, l_orderkey_prf#4032 AS l_orderkey_prf_0#4051]
         :  :  +- Relation[l_returnflag_prf#4014,l_orderkey_and_l_linenumber_prf#4015,l_comment_prf#4016,l_linestatus_prf#4017,rid#4018,l_shipmode_prf#4019,l_shipinstruct_prf#4020,l_quantity_prf#4021,l_receiptdate_prf#4022,l_linenumber_prf#4023,l_tax_prf#4024,l_shipdate_prf#4025,l_extendedprice_prf#4026,l_partkey_prf#4027,l_discount_prf#4028,l_partkey_and_l_suppkey_prf#4029,l_commitdate_prf#4030,l_suppkey_prf#4031,l_orderkey_prf#4032] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_3#4072]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4071]
         :        :  +- Relation[l_returnflag_prf#4052,l_orderkey_and_l_linenumber_prf#4053,l_comment_prf#4054,l_linestatus_prf#4055,rid#4056,l_shipmode_prf#4057,l_shipinstruct_prf#4058,l_quantity_prf#4059,l_receiptdate_prf#4060,l_linenumber_prf#4061,l_tax_prf#4062,l_shipdate_prf#4063,l_extendedprice_prf#4064,l_partkey_prf#4065,l_discount_prf#4066,l_partkey_and_l_suppkey_prf#4067,l_commitdate_prf#4068,l_suppkey_prf#4069,l_orderkey_prf#4070] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, 'rid_2, 'c_acctbal_prf_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2154) AS rid_3#4103]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_2
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#4084]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_1#4078: string
            :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :     :  :- Project [rid#4073 AS rid_1#4078, n_regionkey_prf#4074 AS n_regionkey_prf_1#4079, n_nationkey_prf#4075 AS n_nationkey_prf_1#4080, n_name_prf#4076 AS n_name_prf_1#4081, n_comment_prf#4077 AS n_comment_prf_1#4082]
            :     :  :     :  :  +- Relation[rid#4073,n_regionkey_prf#4074,n_nationkey_prf#4075,n_name_prf#4076,n_comment_prf#4077] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4083]
            :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
            :     :  :     :        +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [c_acctbal_prf#4085 AS c_acctbal_prf_2#4094, rid#4086 AS rid_2#4095, c_name_prf#4087 AS c_name_prf_2#4096, c_nationkey_prf#4088 AS c_nationkey_prf_2#4097, c_custkey_prf#4089 AS c_custkey_prf_2#4098, c_comment_prf#4090 AS c_comment_prf_2#4099, c_address_prf#4091 AS c_address_prf_2#4100, c_mktsegment_prf#4092 AS c_mktsegment_prf_2#4101, c_phone_prf#4093 AS c_phone_prf_2#4102]
            :     :     +- Relation[c_acctbal_prf#4085,rid#4086,c_name_prf#4087,c_nationkey_prf#4088,c_custkey_prf#4089,c_comment_prf#4090,c_address_prf#4091,c_mktsegment_prf#4092,c_phone_prf#4093] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4104 AS o_shippriority_prf_3#4114, rid#4105 AS rid_3#4115, o_orderdate_prf#4106 AS o_orderdate_prf_3#4116, o_custkey_prf#4107 AS o_custkey_prf_3#4117, o_orderpriority_prf#4108 AS o_orderpriority_prf_3#4118, o_clerk_prf#4109 AS o_clerk_prf_3#4119, o_orderstatus_prf#4110 AS o_orderstatus_prf_3#4120, o_totalprice_prf#4111 AS o_totalprice_prf_3#4121, o_orderkey_prf#4112 AS o_orderkey_prf_3#4122, o_comment_prf#4113 AS o_comment_prf_3#4123]
               +- Relation[o_shippriority_prf#4104,rid#4105,o_orderdate_prf#4106,o_custkey_prf#4107,o_orderpriority_prf#4108,o_clerk_prf#4109,o_orderstatus_prf#4110,o_totalprice_prf#4111,o_orderkey_prf#4112,o_comment_prf#4113] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 74471ms

ft1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey and n_name = 'FRANCE'
19/10/16 23:10:07 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:10:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4189L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/16 23:10:07 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:10:07 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:10:07 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:10:07 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:10:07 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:10:07 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:10:07 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:10:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4189L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#4191 AS c_acctbal_prf_0#4200, rid#4192 AS rid_0#4201, c_name_prf#4193 AS c_name_prf_0#4202, c_nationkey_prf#4194 AS c_nationkey_prf_0#4203, c_custkey_prf#4195 AS c_custkey_prf_0#4204, c_comment_prf#4196 AS c_comment_prf_0#4205, c_address_prf#4197 AS c_address_prf_0#4206, c_mktsegment_prf#4198 AS c_mktsegment_prf_0#4207, c_phone_prf#4199 AS c_phone_prf_0#4208]
         :  :  +- Relation[c_acctbal_prf#4191,rid#4192,c_name_prf#4193,c_nationkey_prf#4194,c_custkey_prf#4195,c_comment_prf#4196,c_address_prf#4197,c_mktsegment_prf#4198,c_phone_prf#4199] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_2#4219]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4218]
         :        :  +- Relation[c_acctbal_prf#4209,rid#4210,c_name_prf#4211,c_nationkey_prf#4212,c_custkey_prf#4213,c_comment_prf#4214,c_address_prf#4215,c_mktsegment_prf#4216,c_phone_prf#4217] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [s_phone_prf#4220 AS s_phone_prf_1#4228, rid#4221 AS rid_1#4229, s_address_prf#4222 AS s_address_prf_1#4230, s_nationkey_prf#4223 AS s_nationkey_prf_1#4231, s_suppkey_prf#4224 AS s_suppkey_prf_1#4232, s_name_prf#4225 AS s_name_prf_1#4233, s_acctbal_prf#4226 AS s_acctbal_prf_1#4234, s_comment_prf#4227 AS s_comment_prf_1#4235]
            :  :  +- Relation[s_phone_prf#4220,rid#4221,s_address_prf#4222,s_nationkey_prf#4223,s_suppkey_prf#4224,s_name_prf#4225,s_acctbal_prf#4226,s_comment_prf#4227] JDBCRelation(supplier_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#4245]
            :     +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#4244]
            :        :  +- Relation[s_phone_prf#4236,rid#4237,s_address_prf#4238,s_nationkey_prf#4239,s_suppkey_prf#4240,s_name_prf#4241,s_acctbal_prf#4242,s_comment_prf#4243] JDBCRelation(supplier_prf) [numPartitions=1]
            :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [rid#4246 AS rid_2#4251, n_regionkey_prf#4247 AS n_regionkey_prf_2#4252, n_nationkey_prf#4248 AS n_nationkey_prf_2#4253, n_name_prf#4249 AS n_name_prf_2#4254, n_comment_prf#4250 AS n_comment_prf_2#4255]
               :  +- Relation[rid#4246,n_regionkey_prf#4247,n_nationkey_prf#4248,n_name_prf#4249,n_comment_prf#4250] JDBCRelation(nation_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#4256]
                  +- DexRidFilter nation~n_name~FRANCE
                     +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=2452200
Elapsed time: 33134ms

fr1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey and c_mktsegment = 'BUILDING'
19/10/16 23:10:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:10:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4315L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 23:10:40 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:10:40 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:10:40 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:10:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4315L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [l_returnflag_prf#4317 AS l_returnflag_prf_0#4336, l_orderkey_and_l_linenumber_prf#4318 AS l_orderkey_and_l_linenumber_prf_0#4337, l_comment_prf#4319 AS l_comment_prf_0#4338, l_linestatus_prf#4320 AS l_linestatus_prf_0#4339, rid#4321 AS rid_0#4340, l_shipmode_prf#4322 AS l_shipmode_prf_0#4341, l_shipinstruct_prf#4323 AS l_shipinstruct_prf_0#4342, l_quantity_prf#4324 AS l_quantity_prf_0#4343, l_receiptdate_prf#4325 AS l_receiptdate_prf_0#4344, l_linenumber_prf#4326 AS l_linenumber_prf_0#4345, l_tax_prf#4327 AS l_tax_prf_0#4346, l_shipdate_prf#4328 AS l_shipdate_prf_0#4347, l_extendedprice_prf#4329 AS l_extendedprice_prf_0#4348, l_partkey_prf#4330 AS l_partkey_prf_0#4349, l_discount_prf#4331 AS l_discount_prf_0#4350, l_partkey_and_l_suppkey_prf#4332 AS l_partkey_and_l_suppkey_prf_0#4351, l_commitdate_prf#4333 AS l_commitdate_prf_0#4352, l_suppkey_prf#4334 AS l_suppkey_prf_0#4353, l_orderkey_prf#4335 AS l_orderkey_prf_0#4354]
         :  :  :  :  +- Relation[l_returnflag_prf#4317,l_orderkey_and_l_linenumber_prf#4318,l_comment_prf#4319,l_linestatus_prf#4320,rid#4321,l_shipmode_prf#4322,l_shipinstruct_prf#4323,l_quantity_prf#4324,l_receiptdate_prf#4325,l_linenumber_prf#4326,l_tax_prf#4327,l_shipdate_prf#4328,l_extendedprice_prf#4329,l_partkey_prf#4330,l_discount_prf#4331,l_partkey_and_l_suppkey_prf#4332,l_commitdate_prf#4333,l_suppkey_prf#4334,l_orderkey_prf#4335] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#4375]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#4374]
         :  :  :        :  +- Relation[l_returnflag_prf#4355,l_orderkey_and_l_linenumber_prf#4356,l_comment_prf#4357,l_linestatus_prf#4358,rid#4359,l_shipmode_prf#4360,l_shipinstruct_prf#4361,l_quantity_prf#4362,l_receiptdate_prf#4363,l_linenumber_prf#4364,l_tax_prf#4365,l_shipdate_prf#4366,l_extendedprice_prf#4367,l_partkey_prf#4368,l_discount_prf#4369,l_partkey_and_l_suppkey_prf#4370,l_commitdate_prf#4371,l_suppkey_prf#4372,l_orderkey_prf#4373] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#4376 AS o_shippriority_prf_1#4386, rid#4377 AS rid_1#4387, o_orderdate_prf#4378 AS o_orderdate_prf_1#4388, o_custkey_prf#4379 AS o_custkey_prf_1#4389, o_orderpriority_prf#4380 AS o_orderpriority_prf_1#4390, o_clerk_prf#4381 AS o_clerk_prf_1#4391, o_orderstatus_prf#4382 AS o_orderstatus_prf_1#4392, o_totalprice_prf#4383 AS o_totalprice_prf_1#4393, o_orderkey_prf#4384 AS o_orderkey_prf_1#4394, o_comment_prf#4385 AS o_comment_prf_1#4395]
         :  :     +- Relation[o_shippriority_prf#4376,rid#4377,o_orderdate_prf#4378,o_custkey_prf#4379,o_orderpriority_prf#4380,o_clerk_prf#4381,o_orderstatus_prf#4382,o_totalprice_prf#4383,o_orderkey_prf#4384,o_comment_prf#4385] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#4407]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4406]
         :        :  +- Relation[o_shippriority_prf#4396,rid#4397,o_orderdate_prf#4398,o_custkey_prf#4399,o_orderpriority_prf#4400,o_clerk_prf#4401,o_orderstatus_prf#4402,o_totalprice_prf#4403,o_orderkey_prf#4404,o_comment_prf#4405] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_2))
            :- Project [c_acctbal_prf#4408 AS c_acctbal_prf_2#4417, rid#4409 AS rid_2#4418, c_name_prf#4410 AS c_name_prf_2#4419, c_nationkey_prf#4411 AS c_nationkey_prf_2#4420, c_custkey_prf#4412 AS c_custkey_prf_2#4421, c_comment_prf#4413 AS c_comment_prf_2#4422, c_address_prf#4414 AS c_address_prf_2#4423, c_mktsegment_prf#4415 AS c_mktsegment_prf_2#4424, c_phone_prf#4416 AS c_phone_prf_2#4425]
            :  +- Relation[c_acctbal_prf#4408,rid#4409,c_name_prf#4410,c_nationkey_prf#4411,c_custkey_prf#4412,c_comment_prf#4413,c_address_prf#4414,c_mktsegment_prf#4415,c_phone_prf#4416] JDBCRelation(customer_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#4426]
               +- DexRidFilter customer~c_mktsegment~BUILDING
                  +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 121462ms

fr1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and (c_mktsegment = 'BUILDING' and l_orderkey = o_orderkey)
19/10/16 23:12:41 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:12:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4501L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 23:12:41 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:12:41 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:12:41 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:12:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4501L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#4503 AS l_returnflag_prf_0#4522, l_orderkey_and_l_linenumber_prf#4504 AS l_orderkey_and_l_linenumber_prf_0#4523, l_comment_prf#4505 AS l_comment_prf_0#4524, l_linestatus_prf#4506 AS l_linestatus_prf_0#4525, rid#4507 AS rid_0#4526, l_shipmode_prf#4508 AS l_shipmode_prf_0#4527, l_shipinstruct_prf#4509 AS l_shipinstruct_prf_0#4528, l_quantity_prf#4510 AS l_quantity_prf_0#4529, l_receiptdate_prf#4511 AS l_receiptdate_prf_0#4530, l_linenumber_prf#4512 AS l_linenumber_prf_0#4531, l_tax_prf#4513 AS l_tax_prf_0#4532, l_shipdate_prf#4514 AS l_shipdate_prf_0#4533, l_extendedprice_prf#4515 AS l_extendedprice_prf_0#4534, l_partkey_prf#4516 AS l_partkey_prf_0#4535, l_discount_prf#4517 AS l_discount_prf_0#4536, l_partkey_and_l_suppkey_prf#4518 AS l_partkey_and_l_suppkey_prf_0#4537, l_commitdate_prf#4519 AS l_commitdate_prf_0#4538, l_suppkey_prf#4520 AS l_suppkey_prf_0#4539, l_orderkey_prf#4521 AS l_orderkey_prf_0#4540]
         :  :  +- Relation[l_returnflag_prf#4503,l_orderkey_and_l_linenumber_prf#4504,l_comment_prf#4505,l_linestatus_prf#4506,rid#4507,l_shipmode_prf#4508,l_shipinstruct_prf#4509,l_quantity_prf#4510,l_receiptdate_prf#4511,l_linenumber_prf#4512,l_tax_prf#4513,l_shipdate_prf#4514,l_extendedprice_prf#4515,l_partkey_prf#4516,l_discount_prf#4517,l_partkey_and_l_suppkey_prf#4518,l_commitdate_prf#4519,l_suppkey_prf#4520,l_orderkey_prf#4521] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_2#4561]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4560]
         :        :  +- Relation[l_returnflag_prf#4541,l_orderkey_and_l_linenumber_prf#4542,l_comment_prf#4543,l_linestatus_prf#4544,rid#4545,l_shipmode_prf#4546,l_shipinstruct_prf#4547,l_quantity_prf#4548,l_receiptdate_prf#4549,l_linenumber_prf#4550,l_tax_prf#4551,l_shipdate_prf#4552,l_extendedprice_prf#4553,l_partkey_prf#4554,l_discount_prf#4555,l_partkey_and_l_suppkey_prf#4556,l_commitdate_prf#4557,l_suppkey_prf#4558,l_orderkey_prf#4559] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#4581]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#4572: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [c_acctbal_prf#4562 AS c_acctbal_prf_1#4571, rid#4563 AS rid_1#4572, c_name_prf#4564 AS c_name_prf_1#4573, c_nationkey_prf#4565 AS c_nationkey_prf_1#4574, c_custkey_prf#4566 AS c_custkey_prf_1#4575, c_comment_prf#4567 AS c_comment_prf_1#4576, c_address_prf#4568 AS c_address_prf_1#4577, c_mktsegment_prf#4569 AS c_mktsegment_prf_1#4578, c_phone_prf#4570 AS c_phone_prf_1#4579]
            :     :  :  +- Relation[c_acctbal_prf#4562,rid#4563,c_name_prf#4564,c_nationkey_prf#4565,c_custkey_prf#4566,c_comment_prf#4567,c_address_prf#4568,c_mktsegment_prf#4569,c_phone_prf#4570] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4580]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4582 AS o_shippriority_prf_2#4592, rid#4583 AS rid_2#4593, o_orderdate_prf#4584 AS o_orderdate_prf_2#4594, o_custkey_prf#4585 AS o_custkey_prf_2#4595, o_orderpriority_prf#4586 AS o_orderpriority_prf_2#4596, o_clerk_prf#4587 AS o_clerk_prf_2#4597, o_orderstatus_prf#4588 AS o_orderstatus_prf_2#4598, o_totalprice_prf#4589 AS o_totalprice_prf_2#4599, o_orderkey_prf#4590 AS o_orderkey_prf_2#4600, o_comment_prf#4591 AS o_comment_prf_2#4601]
               +- Relation[o_shippriority_prf#4582,rid#4583,o_orderdate_prf#4584,o_custkey_prf#4585,o_orderpriority_prf#4586,o_clerk_prf#4587,o_orderstatus_prf#4588,o_totalprice_prf#4589,o_orderkey_prf#4590,o_comment_prf#4591] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 82914ms

fr2f=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/16 23:14:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:14:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4676L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_orderkey#342L, o_custkey#343L]
         :     :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L]
         :        +- Filter isnotnull(c_custkey#290L)
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 23:14:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4676L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, 'rid_1, 'c_acctbal_prf_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#4718]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#4699]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_0#4689: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [o_shippriority_prf#4678 AS o_shippriority_prf_0#4688, rid#4679 AS rid_0#4689, o_orderdate_prf#4680 AS o_orderdate_prf_0#4690, o_custkey_prf#4681 AS o_custkey_prf_0#4691, o_orderpriority_prf#4682 AS o_orderpriority_prf_0#4692, o_clerk_prf#4683 AS o_clerk_prf_0#4693, o_orderstatus_prf#4684 AS o_orderstatus_prf_0#4694, o_totalprice_prf#4685 AS o_totalprice_prf_0#4695, o_orderkey_prf#4686 AS o_orderkey_prf_0#4696, o_comment_prf#4687 AS o_comment_prf_0#4697]
         :     :  :     :  :  +- Relation[o_shippriority_prf#4678,rid#4679,o_orderdate_prf#4680,o_custkey_prf#4681,o_orderpriority_prf#4682,o_clerk_prf#4683,o_orderstatus_prf#4684,o_totalprice_prf#4685,o_orderkey_prf#4686,o_comment_prf#4687] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4698]
         :     :  :     :     +- DexRidFilter orders~o_orderstatus~F
         :     :  :     :        +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#4700 AS c_acctbal_prf_1#4709, rid#4701 AS rid_1#4710, c_name_prf#4702 AS c_name_prf_1#4711, c_nationkey_prf#4703 AS c_nationkey_prf_1#4712, c_custkey_prf#4704 AS c_custkey_prf_1#4713, c_comment_prf#4705 AS c_comment_prf_1#4714, c_address_prf#4706 AS c_address_prf_1#4715, c_mktsegment_prf#4707 AS c_mktsegment_prf_1#4716, c_phone_prf#4708 AS c_phone_prf_1#4717]
         :     :     +- Relation[c_acctbal_prf#4700,rid#4701,c_name_prf#4702,c_nationkey_prf#4703,c_custkey_prf#4704,c_comment_prf#4705,c_address_prf#4706,c_mktsegment_prf#4707,c_phone_prf#4708] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4719 AS l_returnflag_prf_2#4738, l_orderkey_and_l_linenumber_prf#4720 AS l_orderkey_and_l_linenumber_prf_2#4739, l_comment_prf#4721 AS l_comment_prf_2#4740, l_linestatus_prf#4722 AS l_linestatus_prf_2#4741, rid#4723 AS rid_2#4742, l_shipmode_prf#4724 AS l_shipmode_prf_2#4743, l_shipinstruct_prf#4725 AS l_shipinstruct_prf_2#4744, l_quantity_prf#4726 AS l_quantity_prf_2#4745, l_receiptdate_prf#4727 AS l_receiptdate_prf_2#4746, l_linenumber_prf#4728 AS l_linenumber_prf_2#4747, l_tax_prf#4729 AS l_tax_prf_2#4748, l_shipdate_prf#4730 AS l_shipdate_prf_2#4749, l_extendedprice_prf#4731 AS l_extendedprice_prf_2#4750, l_partkey_prf#4732 AS l_partkey_prf_2#4751, l_discount_prf#4733 AS l_discount_prf_2#4752, l_partkey_and_l_suppkey_prf#4734 AS l_partkey_and_l_suppkey_prf_2#4753, l_commitdate_prf#4735 AS l_commitdate_prf_2#4754, l_suppkey_prf#4736 AS l_suppkey_prf_2#4755, l_orderkey_prf#4737 AS l_orderkey_prf_2#4756]
            +- Relation[l_returnflag_prf#4719,l_orderkey_and_l_linenumber_prf#4720,l_comment_prf#4721,l_linestatus_prf#4722,rid#4723,l_shipmode_prf#4724,l_shipinstruct_prf#4725,l_quantity_prf#4726,l_receiptdate_prf#4727,l_linenumber_prf#4728,l_tax_prf#4729,l_shipdate_prf#4730,l_extendedprice_prf#4731,l_partkey_prf#4732,l_discount_prf#4733,l_partkey_and_l_suppkey_prf#4734,l_commitdate_prf#4735,l_suppkey_prf#4736,l_orderkey_prf#4737] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 83191ms

fr1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and (l_orderkey = o_orderkey and c_mktsegment = 'BUILDING')
19/10/16 23:15:28 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:15:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4831L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/16 23:15:28 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:15:28 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:15:28 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:15:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4831L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#4833 AS l_returnflag_prf_0#4852, l_orderkey_and_l_linenumber_prf#4834 AS l_orderkey_and_l_linenumber_prf_0#4853, l_comment_prf#4835 AS l_comment_prf_0#4854, l_linestatus_prf#4836 AS l_linestatus_prf_0#4855, rid#4837 AS rid_0#4856, l_shipmode_prf#4838 AS l_shipmode_prf_0#4857, l_shipinstruct_prf#4839 AS l_shipinstruct_prf_0#4858, l_quantity_prf#4840 AS l_quantity_prf_0#4859, l_receiptdate_prf#4841 AS l_receiptdate_prf_0#4860, l_linenumber_prf#4842 AS l_linenumber_prf_0#4861, l_tax_prf#4843 AS l_tax_prf_0#4862, l_shipdate_prf#4844 AS l_shipdate_prf_0#4863, l_extendedprice_prf#4845 AS l_extendedprice_prf_0#4864, l_partkey_prf#4846 AS l_partkey_prf_0#4865, l_discount_prf#4847 AS l_discount_prf_0#4866, l_partkey_and_l_suppkey_prf#4848 AS l_partkey_and_l_suppkey_prf_0#4867, l_commitdate_prf#4849 AS l_commitdate_prf_0#4868, l_suppkey_prf#4850 AS l_suppkey_prf_0#4869, l_orderkey_prf#4851 AS l_orderkey_prf_0#4870]
         :  :  +- Relation[l_returnflag_prf#4833,l_orderkey_and_l_linenumber_prf#4834,l_comment_prf#4835,l_linestatus_prf#4836,rid#4837,l_shipmode_prf#4838,l_shipinstruct_prf#4839,l_quantity_prf#4840,l_receiptdate_prf#4841,l_linenumber_prf#4842,l_tax_prf#4843,l_shipdate_prf#4844,l_extendedprice_prf#4845,l_partkey_prf#4846,l_discount_prf#4847,l_partkey_and_l_suppkey_prf#4848,l_commitdate_prf#4849,l_suppkey_prf#4850,l_orderkey_prf#4851] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#4891]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4890]
         :        :  +- Relation[l_returnflag_prf#4871,l_orderkey_and_l_linenumber_prf#4872,l_comment_prf#4873,l_linestatus_prf#4874,rid#4875,l_shipmode_prf#4876,l_shipinstruct_prf#4877,l_quantity_prf#4878,l_receiptdate_prf#4879,l_linenumber_prf#4880,l_tax_prf#4881,l_shipdate_prf#4882,l_extendedprice_prf#4883,l_partkey_prf#4884,l_discount_prf#4885,l_partkey_and_l_suppkey_prf#4886,l_commitdate_prf#4887,l_suppkey_prf#4888,l_orderkey_prf#4889] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [o_shippriority_prf#4892 AS o_shippriority_prf_1#4902, rid#4893 AS rid_1#4903, o_orderdate_prf#4894 AS o_orderdate_prf_1#4904, o_custkey_prf#4895 AS o_custkey_prf_1#4905, o_orderpriority_prf#4896 AS o_orderpriority_prf_1#4906, o_clerk_prf#4897 AS o_clerk_prf_1#4907, o_orderstatus_prf#4898 AS o_orderstatus_prf_1#4908, o_totalprice_prf#4899 AS o_totalprice_prf_1#4909, o_orderkey_prf#4900 AS o_orderkey_prf_1#4910, o_comment_prf#4901 AS o_comment_prf_1#4911]
            :  :  +- Relation[o_shippriority_prf#4892,rid#4893,o_orderdate_prf#4894,o_custkey_prf#4895,o_orderpriority_prf#4896,o_clerk_prf#4897,o_orderstatus_prf#4898,o_totalprice_prf#4899,o_orderkey_prf#4900,o_comment_prf#4901] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#4923]
            :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#4922]
            :        :  +- Relation[o_shippriority_prf#4912,rid#4913,o_orderdate_prf#4914,o_custkey_prf#4915,o_orderpriority_prf#4916,o_clerk_prf#4917,o_orderstatus_prf#4918,o_totalprice_prf#4919,o_orderkey_prf#4920,o_comment_prf#4921] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- 'Join UsingJoin(LeftSemi,List(rid_2))
               :- Project [c_acctbal_prf#4924 AS c_acctbal_prf_2#4933, rid#4925 AS rid_2#4934, c_name_prf#4926 AS c_name_prf_2#4935, c_nationkey_prf#4927 AS c_nationkey_prf_2#4936, c_custkey_prf#4928 AS c_custkey_prf_2#4937, c_comment_prf#4929 AS c_comment_prf_2#4938, c_address_prf#4930 AS c_address_prf_2#4939, c_mktsegment_prf#4931 AS c_mktsegment_prf_2#4940, c_phone_prf#4932 AS c_phone_prf_2#4941]
               :  +- Relation[c_acctbal_prf#4924,rid#4925,c_name_prf#4926,c_nationkey_prf#4927,c_custkey_prf#4928,c_comment_prf#4929,c_address_prf#4930,c_mktsegment_prf#4931,c_phone_prf#4932] JDBCRelation(customer_prf) [numPartitions=1]
               +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#4942]
                  +- DexRidFilter customer~c_mktsegment~BUILDING
                     +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 121185ms

fr1e=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and (o_orderkey = l_orderkey and c_custkey = o_custkey)
19/10/16 23:17:29 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:17:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5017L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 23:17:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:17:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:17:29 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:17:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5017L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#5038]
         :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#5029: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [c_acctbal_prf#5019 AS c_acctbal_prf_0#5028, rid#5020 AS rid_0#5029, c_name_prf#5021 AS c_name_prf_0#5030, c_nationkey_prf#5022 AS c_nationkey_prf_0#5031, c_custkey_prf#5023 AS c_custkey_prf_0#5032, c_comment_prf#5024 AS c_comment_prf_0#5033, c_address_prf#5025 AS c_address_prf_0#5034, c_mktsegment_prf#5026 AS c_mktsegment_prf_0#5035, c_phone_prf#5027 AS c_phone_prf_0#5036]
         :     :  :  +- Relation[c_acctbal_prf#5019,rid#5020,c_name_prf#5021,c_nationkey_prf#5022,c_custkey_prf#5023,c_comment_prf#5024,c_address_prf#5025,c_mktsegment_prf#5026,c_phone_prf#5027] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5037]
         :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :        +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- Project [o_shippriority_prf#5039 AS o_shippriority_prf_1#5049, rid#5040 AS rid_1#5050, o_orderdate_prf#5041 AS o_orderdate_prf_1#5051, o_custkey_prf#5042 AS o_custkey_prf_1#5052, o_orderpriority_prf#5043 AS o_orderpriority_prf_1#5053, o_clerk_prf#5044 AS o_clerk_prf_1#5054, o_orderstatus_prf#5045 AS o_orderstatus_prf_1#5055, o_totalprice_prf#5046 AS o_totalprice_prf_1#5056, o_orderkey_prf#5047 AS o_orderkey_prf_1#5057, o_comment_prf#5048 AS o_comment_prf_1#5058]
            :  :  +- Relation[o_shippriority_prf#5039,rid#5040,o_orderdate_prf#5041,o_custkey_prf#5042,o_orderpriority_prf#5043,o_clerk_prf#5044,o_orderstatus_prf#5045,o_totalprice_prf#5046,o_orderkey_prf#5047,o_comment_prf#5048] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#5070]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
            :        :- 'Project ['rid AS rid_1#5069]
            :        :  +- Relation[o_shippriority_prf#5059,rid#5060,o_orderdate_prf#5061,o_custkey_prf#5062,o_orderpriority_prf#5063,o_clerk_prf#5064,o_orderstatus_prf#5065,o_totalprice_prf#5066,o_orderkey_prf#5067,o_comment_prf#5068] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#5071 AS l_returnflag_prf_2#5090, l_orderkey_and_l_linenumber_prf#5072 AS l_orderkey_and_l_linenumber_prf_2#5091, l_comment_prf#5073 AS l_comment_prf_2#5092, l_linestatus_prf#5074 AS l_linestatus_prf_2#5093, rid#5075 AS rid_2#5094, l_shipmode_prf#5076 AS l_shipmode_prf_2#5095, l_shipinstruct_prf#5077 AS l_shipinstruct_prf_2#5096, l_quantity_prf#5078 AS l_quantity_prf_2#5097, l_receiptdate_prf#5079 AS l_receiptdate_prf_2#5098, l_linenumber_prf#5080 AS l_linenumber_prf_2#5099, l_tax_prf#5081 AS l_tax_prf_2#5100, l_shipdate_prf#5082 AS l_shipdate_prf_2#5101, l_extendedprice_prf#5083 AS l_extendedprice_prf_2#5102, l_partkey_prf#5084 AS l_partkey_prf_2#5103, l_discount_prf#5085 AS l_discount_prf_2#5104, l_partkey_and_l_suppkey_prf#5086 AS l_partkey_and_l_suppkey_prf_2#5105, l_commitdate_prf#5087 AS l_commitdate_prf_2#5106, l_suppkey_prf#5088 AS l_suppkey_prf_2#5107, l_orderkey_prf#5089 AS l_orderkey_prf_2#5108]
               +- Relation[l_returnflag_prf#5071,l_orderkey_and_l_linenumber_prf#5072,l_comment_prf#5073,l_linestatus_prf#5074,rid#5075,l_shipmode_prf#5076,l_shipinstruct_prf#5077,l_quantity_prf#5078,l_receiptdate_prf#5079,l_linenumber_prf#5080,l_tax_prf#5081,l_shipdate_prf#5082,l_extendedprice_prf#5083,l_partkey_prf#5084,l_discount_prf#5085,l_partkey_and_l_suppkey_prf#5086,l_commitdate_prf#5087,l_suppkey_prf#5088,l_orderkey_prf#5089] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 153075ms

fs1c=

select *
from
  customer, orders, lineitem, part
where
  c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey and l_partkey = p_partkey
        
19/10/16 23:20:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:20:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5192L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_orderkey#306L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/16 23:20:02 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:20:02 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:20:02 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:20:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5192L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [p_comment_prf#5194 AS p_comment_prf_0#5204, p_name_prf#5195 AS p_name_prf_0#5205, rid#5196 AS rid_0#5206, p_type_prf#5197 AS p_type_prf_0#5207, p_retailprice_prf#5198 AS p_retailprice_prf_0#5208, p_mfgr_prf#5199 AS p_mfgr_prf_0#5209, p_container_prf#5200 AS p_container_prf_0#5210, p_brand_prf#5201 AS p_brand_prf_0#5211, p_size_prf#5202 AS p_size_prf_0#5212, p_partkey_prf#5203 AS p_partkey_prf_0#5213]
         :  :  :  :  +- Relation[p_comment_prf#5194,p_name_prf#5195,rid#5196,p_type_prf#5197,p_retailprice_prf#5198,p_mfgr_prf#5199,p_container_prf#5200,p_brand_prf#5201,p_size_prf#5202,p_partkey_prf#5203] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#5225]
         :  :  :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#5224]
         :  :  :        :  +- Relation[p_comment_prf#5214,p_name_prf#5215,rid#5216,p_type_prf#5217,p_retailprice_prf#5218,p_mfgr_prf#5219,p_container_prf#5220,p_brand_prf#5221,p_size_prf#5222,p_partkey_prf#5223] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#5226 AS l_returnflag_prf_1#5245, l_orderkey_and_l_linenumber_prf#5227 AS l_orderkey_and_l_linenumber_prf_1#5246, l_comment_prf#5228 AS l_comment_prf_1#5247, l_linestatus_prf#5229 AS l_linestatus_prf_1#5248, rid#5230 AS rid_1#5249, l_shipmode_prf#5231 AS l_shipmode_prf_1#5250, l_shipinstruct_prf#5232 AS l_shipinstruct_prf_1#5251, l_quantity_prf#5233 AS l_quantity_prf_1#5252, l_receiptdate_prf#5234 AS l_receiptdate_prf_1#5253, l_linenumber_prf#5235 AS l_linenumber_prf_1#5254, l_tax_prf#5236 AS l_tax_prf_1#5255, l_shipdate_prf#5237 AS l_shipdate_prf_1#5256, l_extendedprice_prf#5238 AS l_extendedprice_prf_1#5257, l_partkey_prf#5239 AS l_partkey_prf_1#5258, l_discount_prf#5240 AS l_discount_prf_1#5259, l_partkey_and_l_suppkey_prf#5241 AS l_partkey_and_l_suppkey_prf_1#5260, l_commitdate_prf#5242 AS l_commitdate_prf_1#5261, l_suppkey_prf#5243 AS l_suppkey_prf_1#5262, l_orderkey_prf#5244 AS l_orderkey_prf_1#5263]
         :  :     +- Relation[l_returnflag_prf#5226,l_orderkey_and_l_linenumber_prf#5227,l_comment_prf#5228,l_linestatus_prf#5229,rid#5230,l_shipmode_prf#5231,l_shipinstruct_prf#5232,l_quantity_prf#5233,l_receiptdate_prf#5234,l_linenumber_prf#5235,l_tax_prf#5236,l_shipdate_prf#5237,l_extendedprice_prf#5238,l_partkey_prf#5239,l_discount_prf#5240,l_partkey_and_l_suppkey_prf#5241,l_commitdate_prf#5242,l_suppkey_prf#5243,l_orderkey_prf#5244] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2154) AS rid_3#5284]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5283]
         :        :  +- Relation[l_returnflag_prf#5264,l_orderkey_and_l_linenumber_prf#5265,l_comment_prf#5266,l_linestatus_prf#5267,rid#5268,l_shipmode_prf#5269,l_shipinstruct_prf#5270,l_quantity_prf#5271,l_receiptdate_prf#5272,l_linenumber_prf#5273,l_tax_prf#5274,l_shipdate_prf#5275,l_extendedprice_prf#5276,l_partkey_prf#5277,l_discount_prf#5278,l_partkey_and_l_suppkey_prf#5279,l_commitdate_prf#5280,l_suppkey_prf#5281,l_orderkey_prf#5282] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_2, 'rid_2, 'c_name_prf_2, 'c_nationkey_prf_2, 'c_custkey_prf_2, 'c_comment_prf_2, 'c_address_prf_2, 'c_mktsegment_prf_2, 'c_phone_prf_2, dexdecrypt('value_dec_key, value#2154) AS rid_3#5304]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_2#5295: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
            :     :  :- Project [c_acctbal_prf#5285 AS c_acctbal_prf_2#5294, rid#5286 AS rid_2#5295, c_name_prf#5287 AS c_name_prf_2#5296, c_nationkey_prf#5288 AS c_nationkey_prf_2#5297, c_custkey_prf#5289 AS c_custkey_prf_2#5298, c_comment_prf#5290 AS c_comment_prf_2#5299, c_address_prf#5291 AS c_address_prf_2#5300, c_mktsegment_prf#5292 AS c_mktsegment_prf_2#5301, c_phone_prf#5293 AS c_phone_prf_2#5302]
            :     :  :  +- Relation[c_acctbal_prf#5285,rid#5286,c_name_prf#5287,c_nationkey_prf#5288,c_custkey_prf#5289,c_comment_prf#5290,c_address_prf#5291,c_mktsegment_prf#5292,c_phone_prf#5293] JDBCRelation(customer_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#5303]
            :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
            :     :        +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#5305 AS o_shippriority_prf_3#5315, rid#5306 AS rid_3#5316, o_orderdate_prf#5307 AS o_orderdate_prf_3#5317, o_custkey_prf#5308 AS o_custkey_prf_3#5318, o_orderpriority_prf#5309 AS o_orderpriority_prf_3#5319, o_clerk_prf#5310 AS o_clerk_prf_3#5320, o_orderstatus_prf#5311 AS o_orderstatus_prf_3#5321, o_totalprice_prf#5312 AS o_totalprice_prf_3#5322, o_orderkey_prf#5313 AS o_orderkey_prf_3#5323, o_comment_prf#5314 AS o_comment_prf_3#5324]
               +- Relation[o_shippriority_prf#5305,rid#5306,o_orderdate_prf#5307,o_custkey_prf#5308,o_orderpriority_prf#5309,o_clerk_prf#5310,o_orderstatus_prf#5311,o_totalprice_prf#5312,o_orderkey_prf#5313,o_comment_prf#5314] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 172634ms

ft2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and (p_size = 15 and s_suppkey = ps_suppkey)
19/10/16 23:22:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:22:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5397L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/16 23:22:54 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:22:54 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:22:54 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 23:22:54 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:22:54 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 23:22:54 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 23:22:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5397L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#5399 AS s_phone_prf_0#5407, rid#5400 AS rid_0#5408, s_address_prf#5401 AS s_address_prf_0#5409, s_nationkey_prf#5402 AS s_nationkey_prf_0#5410, s_suppkey_prf#5403 AS s_suppkey_prf_0#5411, s_name_prf#5404 AS s_name_prf_0#5412, s_acctbal_prf#5405 AS s_acctbal_prf_0#5413, s_comment_prf#5406 AS s_comment_prf_0#5414]
         :  :  +- Relation[s_phone_prf#5399,rid#5400,s_address_prf#5401,s_nationkey_prf#5402,s_suppkey_prf#5403,s_name_prf#5404,s_acctbal_prf#5405,s_comment_prf#5406] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_2#5424]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5423]
         :        :  +- Relation[s_phone_prf#5415,rid#5416,s_address_prf#5417,s_nationkey_prf#5418,s_suppkey_prf#5419,s_name_prf#5420,s_acctbal_prf#5421,s_comment_prf#5422] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#5446]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#5437: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#5425 AS p_comment_prf_1#5435, p_name_prf#5426 AS p_name_prf_1#5436, rid#5427 AS rid_1#5437, p_type_prf#5428 AS p_type_prf_1#5438, p_retailprice_prf#5429 AS p_retailprice_prf_1#5439, p_mfgr_prf#5430 AS p_mfgr_prf_1#5440, p_container_prf#5431 AS p_container_prf_1#5441, p_brand_prf#5432 AS p_brand_prf_1#5442, p_size_prf#5433 AS p_size_prf_1#5443, p_partkey_prf#5434 AS p_partkey_prf_1#5444]
            :     :  :  +- Relation[p_comment_prf#5425,p_name_prf#5426,rid#5427,p_type_prf#5428,p_retailprice_prf#5429,p_mfgr_prf#5430,p_container_prf#5431,p_brand_prf#5432,p_size_prf#5433,p_partkey_prf#5434] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5445]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#5447 AS ps_partkey_and_ps_suppkey_prf_2#5454, rid#5448 AS rid_2#5455, ps_availqty_prf#5449 AS ps_availqty_prf_2#5456, ps_comment_prf#5450 AS ps_comment_prf_2#5457, ps_partkey_prf#5451 AS ps_partkey_prf_2#5458, ps_supplycost_prf#5452 AS ps_supplycost_prf_2#5459, ps_suppkey_prf#5453 AS ps_suppkey_prf_2#5460]
               +- Relation[ps_partkey_and_ps_suppkey_prf#5447,rid#5448,ps_availqty_prf#5449,ps_comment_prf#5450,ps_partkey_prf#5451,ps_supplycost_prf#5452,ps_suppkey_prf#5453] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 7022ms

fr1d=
select * from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/16 23:23:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:23:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5522L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter ((isnotnull(c_mktsegment#297) && (c_mktsegment#297 = BUILDING)) && isnotnull(c_custkey#290L))
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 23:23:01 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:23:01 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:23:01 WARN DexPlanner: InMemoryFileIndex=customer
19/10/16 23:23:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5522L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#5564]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#5543]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#5534: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [c_acctbal_prf#5524 AS c_acctbal_prf_0#5533, rid#5525 AS rid_0#5534, c_name_prf#5526 AS c_name_prf_0#5535, c_nationkey_prf#5527 AS c_nationkey_prf_0#5536, c_custkey_prf#5528 AS c_custkey_prf_0#5537, c_comment_prf#5529 AS c_comment_prf_0#5538, c_address_prf#5530 AS c_address_prf_0#5539, c_mktsegment_prf#5531 AS c_mktsegment_prf_0#5540, c_phone_prf#5532 AS c_phone_prf_0#5541]
         :     :  :     :  :  +- Relation[c_acctbal_prf#5524,rid#5525,c_name_prf#5526,c_nationkey_prf#5527,c_custkey_prf#5528,c_comment_prf#5529,c_address_prf#5530,c_mktsegment_prf#5531,c_phone_prf#5532] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5542]
         :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :        +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#5544 AS o_shippriority_prf_1#5554, rid#5545 AS rid_1#5555, o_orderdate_prf#5546 AS o_orderdate_prf_1#5556, o_custkey_prf#5547 AS o_custkey_prf_1#5557, o_orderpriority_prf#5548 AS o_orderpriority_prf_1#5558, o_clerk_prf#5549 AS o_clerk_prf_1#5559, o_orderstatus_prf#5550 AS o_orderstatus_prf_1#5560, o_totalprice_prf#5551 AS o_totalprice_prf_1#5561, o_orderkey_prf#5552 AS o_orderkey_prf_1#5562, o_comment_prf#5553 AS o_comment_prf_1#5563]
         :     :     +- Relation[o_shippriority_prf#5544,rid#5545,o_orderdate_prf#5546,o_custkey_prf#5547,o_orderpriority_prf#5548,o_clerk_prf#5549,o_orderstatus_prf#5550,o_totalprice_prf#5551,o_orderkey_prf#5552,o_comment_prf#5553] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5565 AS l_returnflag_prf_2#5584, l_orderkey_and_l_linenumber_prf#5566 AS l_orderkey_and_l_linenumber_prf_2#5585, l_comment_prf#5567 AS l_comment_prf_2#5586, l_linestatus_prf#5568 AS l_linestatus_prf_2#5587, rid#5569 AS rid_2#5588, l_shipmode_prf#5570 AS l_shipmode_prf_2#5589, l_shipinstruct_prf#5571 AS l_shipinstruct_prf_2#5590, l_quantity_prf#5572 AS l_quantity_prf_2#5591, l_receiptdate_prf#5573 AS l_receiptdate_prf_2#5592, l_linenumber_prf#5574 AS l_linenumber_prf_2#5593, l_tax_prf#5575 AS l_tax_prf_2#5594, l_shipdate_prf#5576 AS l_shipdate_prf_2#5595, l_extendedprice_prf#5577 AS l_extendedprice_prf_2#5596, l_partkey_prf#5578 AS l_partkey_prf_2#5597, l_discount_prf#5579 AS l_discount_prf_2#5598, l_partkey_and_l_suppkey_prf#5580 AS l_partkey_and_l_suppkey_prf_2#5599, l_commitdate_prf#5581 AS l_commitdate_prf_2#5600, l_suppkey_prf#5582 AS l_suppkey_prf_2#5601, l_orderkey_prf#5583 AS l_orderkey_prf_2#5602]
            +- Relation[l_returnflag_prf#5565,l_orderkey_and_l_linenumber_prf#5566,l_comment_prf#5567,l_linestatus_prf#5568,rid#5569,l_shipmode_prf#5570,l_shipinstruct_prf#5571,l_quantity_prf#5572,l_receiptdate_prf#5573,l_linenumber_prf#5574,l_tax_prf#5575,l_shipdate_prf#5576,l_extendedprice_prf#5577,l_partkey_prf#5578,l_discount_prf#5579,l_partkey_and_l_suppkey_prf#5580,l_commitdate_prf#5581,l_suppkey_prf#5582,l_orderkey_prf#5583] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 32759ms

ft2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and p_size = 15 and ps_suppkey = s_suppkey
19/10/16 23:23:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:23:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5665L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 23:23:34 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 23:23:34 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 23:23:34 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 23:23:34 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/16 23:23:34 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:23:34 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:23:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5665L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#5711]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, rid_0#5675: string
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [ps_partkey_and_ps_suppkey_prf#5667 AS ps_partkey_and_ps_suppkey_prf_0#5674, rid#5668 AS rid_0#5675, ps_availqty_prf#5669 AS ps_availqty_prf_0#5676, ps_comment_prf#5670 AS ps_comment_prf_0#5677, ps_partkey_prf#5671 AS ps_partkey_prf_0#5678, ps_supplycost_prf#5672 AS ps_supplycost_prf_0#5679, ps_suppkey_prf#5673 AS ps_suppkey_prf_0#5680]
         :     :  :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#5667,rid#5668,ps_availqty_prf#5669,ps_comment_prf#5670,ps_partkey_prf#5671,ps_supplycost_prf#5672,ps_suppkey_prf#5673] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#5689]
         :     :  :     +- 'DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#5688]
         :     :  :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#5681,rid#5682,ps_availqty_prf#5683,ps_comment_prf#5684,ps_partkey_prf#5685,ps_supplycost_prf#5686,ps_suppkey_prf#5687] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [p_comment_prf#5690 AS p_comment_prf_1#5700, p_name_prf#5691 AS p_name_prf_1#5701, rid#5692 AS rid_1#5702, p_type_prf#5693 AS p_type_prf_1#5703, p_retailprice_prf#5694 AS p_retailprice_prf_1#5704, p_mfgr_prf#5695 AS p_mfgr_prf_1#5705, p_container_prf#5696 AS p_container_prf_1#5706, p_brand_prf#5697 AS p_brand_prf_1#5707, p_size_prf#5698 AS p_size_prf_1#5708, p_partkey_prf#5699 AS p_partkey_prf_1#5709]
         :     :     :  +- Relation[p_comment_prf#5690,p_name_prf#5691,rid#5692,p_type_prf#5693,p_retailprice_prf#5694,p_mfgr_prf#5695,p_container_prf#5696,p_brand_prf#5697,p_size_prf#5698,p_partkey_prf#5699] JDBCRelation(part_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5710]
         :     :        +- DexRidFilter part~p_size~15
         :     :           +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5712 AS s_phone_prf_2#5720, rid#5713 AS rid_2#5721, s_address_prf#5714 AS s_address_prf_2#5722, s_nationkey_prf#5715 AS s_nationkey_prf_2#5723, s_suppkey_prf#5716 AS s_suppkey_prf_2#5724, s_name_prf#5717 AS s_name_prf_2#5725, s_acctbal_prf#5718 AS s_acctbal_prf_2#5726, s_comment_prf#5719 AS s_comment_prf_2#5727]
            +- Relation[s_phone_prf#5712,rid#5713,s_address_prf#5714,s_nationkey_prf#5715,s_suppkey_prf#5716,s_name_prf#5717,s_acctbal_prf#5718,s_comment_prf#5719] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 48975ms

fq1c=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 23:24:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:24:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5793L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [c_nationkey#293L, o_orderkey#342L]
               :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :     :- Project [c_custkey#290L, c_nationkey#293L]
               :     :  +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
               :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               :     +- Project [o_orderkey#342L, o_custkey#343L]
               :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 23:24:23 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:24:23 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:24:23 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:24:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5793L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#5806]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#5800: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [rid#5795 AS rid_0#5800, n_regionkey_prf#5796 AS n_regionkey_prf_0#5801, n_nationkey_prf#5797 AS n_nationkey_prf_0#5802, n_name_prf#5798 AS n_name_prf_0#5803, n_comment_prf#5799 AS n_comment_prf_0#5804]
         :     :  :  +- Relation[rid#5795,n_regionkey_prf#5796,n_nationkey_prf#5797,n_name_prf#5798,n_comment_prf#5799] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5805]
         :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :        +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join NaturalJoin(Inner)
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- Project [c_acctbal_prf#5807 AS c_acctbal_prf_1#5816, rid#5808 AS rid_1#5817, c_name_prf#5809 AS c_name_prf_1#5818, c_nationkey_prf#5810 AS c_nationkey_prf_1#5819, c_custkey_prf#5811 AS c_custkey_prf_1#5820, c_comment_prf#5812 AS c_comment_prf_1#5821, c_address_prf#5813 AS c_address_prf_1#5822, c_mktsegment_prf#5814 AS c_mktsegment_prf_1#5823, c_phone_prf#5815 AS c_phone_prf_1#5824]
            :  :  :  :  +- Relation[c_acctbal_prf#5807,rid#5808,c_name_prf#5809,c_nationkey_prf#5810,c_custkey_prf#5811,c_comment_prf#5812,c_address_prf#5813,c_mktsegment_prf#5814,c_phone_prf#5815] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#5835]
            :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_1
            :  :  :        :- 'Project ['rid AS rid_1#5834]
            :  :  :        :  +- Relation[c_acctbal_prf#5825,rid#5826,c_name_prf#5827,c_nationkey_prf#5828,c_custkey_prf#5829,c_comment_prf#5830,c_address_prf#5831,c_mktsegment_prf#5832,c_phone_prf#5833] JDBCRelation(customer_prf) [numPartitions=1]
            :  :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            :  :  +- Project [o_shippriority_prf#5836 AS o_shippriority_prf_2#5846, rid#5837 AS rid_2#5847, o_orderdate_prf#5838 AS o_orderdate_prf_2#5848, o_custkey_prf#5839 AS o_custkey_prf_2#5849, o_orderpriority_prf#5840 AS o_orderpriority_prf_2#5850, o_clerk_prf#5841 AS o_clerk_prf_2#5851, o_orderstatus_prf#5842 AS o_orderstatus_prf_2#5852, o_totalprice_prf#5843 AS o_totalprice_prf_2#5853, o_orderkey_prf#5844 AS o_orderkey_prf_2#5854, o_comment_prf#5845 AS o_comment_prf_2#5855]
            :  :     +- Relation[o_shippriority_prf#5836,rid#5837,o_orderdate_prf#5838,o_custkey_prf#5839,o_orderpriority_prf#5840,o_clerk_prf#5841,o_orderstatus_prf#5842,o_totalprice_prf#5843,o_orderkey_prf#5844,o_comment_prf#5845] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2154) AS rid_3#5867]
            :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_2
            :        :- 'Project ['rid AS rid_2#5866]
            :        :  +- Relation[o_shippriority_prf#5856,rid#5857,o_orderdate_prf#5858,o_custkey_prf#5859,o_orderpriority_prf#5860,o_clerk_prf#5861,o_orderstatus_prf#5862,o_totalprice_prf#5863,o_orderkey_prf#5864,o_comment_prf#5865] JDBCRelation(orders_prf) [numPartitions=1]
            :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#5868 AS l_returnflag_prf_3#5887, l_orderkey_and_l_linenumber_prf#5869 AS l_orderkey_and_l_linenumber_prf_3#5888, l_comment_prf#5870 AS l_comment_prf_3#5889, l_linestatus_prf#5871 AS l_linestatus_prf_3#5890, rid#5872 AS rid_3#5891, l_shipmode_prf#5873 AS l_shipmode_prf_3#5892, l_shipinstruct_prf#5874 AS l_shipinstruct_prf_3#5893, l_quantity_prf#5875 AS l_quantity_prf_3#5894, l_receiptdate_prf#5876 AS l_receiptdate_prf_3#5895, l_linenumber_prf#5877 AS l_linenumber_prf_3#5896, l_tax_prf#5878 AS l_tax_prf_3#5897, l_shipdate_prf#5879 AS l_shipdate_prf_3#5898, l_extendedprice_prf#5880 AS l_extendedprice_prf_3#5899, l_partkey_prf#5881 AS l_partkey_prf_3#5900, l_discount_prf#5882 AS l_discount_prf_3#5901, l_partkey_and_l_suppkey_prf#5883 AS l_partkey_and_l_suppkey_prf_3#5902, l_commitdate_prf#5884 AS l_commitdate_prf_3#5903, l_suppkey_prf#5885 AS l_suppkey_prf_3#5904, l_orderkey_prf#5886 AS l_orderkey_prf_3#5905]
               +- Relation[l_returnflag_prf#5868,l_orderkey_and_l_linenumber_prf#5869,l_comment_prf#5870,l_linestatus_prf#5871,rid#5872,l_shipmode_prf#5873,l_shipinstruct_prf#5874,l_quantity_prf#5875,l_receiptdate_prf#5876,l_linenumber_prf#5877,l_tax_prf#5878,l_shipdate_prf#5879,l_extendedprice_prf#5880,l_partkey_prf#5881,l_discount_prf#5882,l_partkey_and_l_suppkey_prf#5883,l_commitdate_prf#5884,l_suppkey_prf#5885,l_orderkey_prf#5886] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 163825ms

fr2e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and o_orderstatus = 'F' and c_custkey = o_custkey
19/10/16 23:27:07 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:27:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5985L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_orderkey#342L)) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 23:27:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5985L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [c_acctbal_prf#5987 AS c_acctbal_prf_0#5996, rid#5988 AS rid_0#5997, c_name_prf#5989 AS c_name_prf_0#5998, c_nationkey_prf#5990 AS c_nationkey_prf_0#5999, c_custkey_prf#5991 AS c_custkey_prf_0#6000, c_comment_prf#5992 AS c_comment_prf_0#6001, c_address_prf#5993 AS c_address_prf_0#6002, c_mktsegment_prf#5994 AS c_mktsegment_prf_0#6003, c_phone_prf#5995 AS c_phone_prf_0#6004]
         :  :  +- Relation[c_acctbal_prf#5987,rid#5988,c_name_prf#5989,c_nationkey_prf#5990,c_custkey_prf#5991,c_comment_prf#5992,c_address_prf#5993,c_mktsegment_prf#5994,c_phone_prf#5995] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#6015]
         :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#6014]
         :        :  +- Relation[c_acctbal_prf#6005,rid#6006,c_name_prf#6007,c_nationkey_prf#6008,c_custkey_prf#6009,c_comment_prf#6010,c_address_prf#6011,c_mktsegment_prf#6012,c_phone_prf#6013] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#6037]
            :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#6027: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [o_shippriority_prf#6016 AS o_shippriority_prf_1#6026, rid#6017 AS rid_1#6027, o_orderdate_prf#6018 AS o_orderdate_prf_1#6028, o_custkey_prf#6019 AS o_custkey_prf_1#6029, o_orderpriority_prf#6020 AS o_orderpriority_prf_1#6030, o_clerk_prf#6021 AS o_clerk_prf_1#6031, o_orderstatus_prf#6022 AS o_orderstatus_prf_1#6032, o_totalprice_prf#6023 AS o_totalprice_prf_1#6033, o_orderkey_prf#6024 AS o_orderkey_prf_1#6034, o_comment_prf#6025 AS o_comment_prf_1#6035]
            :     :  :  +- Relation[o_shippriority_prf#6016,rid#6017,o_orderdate_prf#6018,o_custkey_prf#6019,o_orderpriority_prf#6020,o_clerk_prf#6021,o_orderstatus_prf#6022,o_totalprice_prf#6023,o_orderkey_prf#6024,o_comment_prf#6025] JDBCRelation(orders_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6036]
            :     :     +- DexRidFilter orders~o_orderstatus~F
            :     :        +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#6038 AS l_returnflag_prf_2#6057, l_orderkey_and_l_linenumber_prf#6039 AS l_orderkey_and_l_linenumber_prf_2#6058, l_comment_prf#6040 AS l_comment_prf_2#6059, l_linestatus_prf#6041 AS l_linestatus_prf_2#6060, rid#6042 AS rid_2#6061, l_shipmode_prf#6043 AS l_shipmode_prf_2#6062, l_shipinstruct_prf#6044 AS l_shipinstruct_prf_2#6063, l_quantity_prf#6045 AS l_quantity_prf_2#6064, l_receiptdate_prf#6046 AS l_receiptdate_prf_2#6065, l_linenumber_prf#6047 AS l_linenumber_prf_2#6066, l_tax_prf#6048 AS l_tax_prf_2#6067, l_shipdate_prf#6049 AS l_shipdate_prf_2#6068, l_extendedprice_prf#6050 AS l_extendedprice_prf_2#6069, l_partkey_prf#6051 AS l_partkey_prf_2#6070, l_discount_prf#6052 AS l_discount_prf_2#6071, l_partkey_and_l_suppkey_prf#6053 AS l_partkey_and_l_suppkey_prf_2#6072, l_commitdate_prf#6054 AS l_commitdate_prf_2#6073, l_suppkey_prf#6055 AS l_suppkey_prf_2#6074, l_orderkey_prf#6056 AS l_orderkey_prf_2#6075]
               +- Relation[l_returnflag_prf#6038,l_orderkey_and_l_linenumber_prf#6039,l_comment_prf#6040,l_linestatus_prf#6041,rid#6042,l_shipmode_prf#6043,l_shipinstruct_prf#6044,l_quantity_prf#6045,l_receiptdate_prf#6046,l_linenumber_prf#6047,l_tax_prf#6048,l_shipdate_prf#6049,l_extendedprice_prf#6050,l_partkey_prf#6051,l_discount_prf#6052,l_partkey_and_l_suppkey_prf#6053,l_commitdate_prf#6054,l_suppkey_prf#6055,l_orderkey_prf#6056] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 96208ms

ft3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and (p_size = 15 and s_suppkey = l_suppkey)
19/10/16 23:28:43 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:28:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6149L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 23:28:43 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:28:43 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:28:43 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:28:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6149L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#6151 AS s_phone_prf_0#6159, rid#6152 AS rid_0#6160, s_address_prf#6153 AS s_address_prf_0#6161, s_nationkey_prf#6154 AS s_nationkey_prf_0#6162, s_suppkey_prf#6155 AS s_suppkey_prf_0#6163, s_name_prf#6156 AS s_name_prf_0#6164, s_acctbal_prf#6157 AS s_acctbal_prf_0#6165, s_comment_prf#6158 AS s_comment_prf_0#6166]
         :  :  +- Relation[s_phone_prf#6151,rid#6152,s_address_prf#6153,s_nationkey_prf#6154,s_suppkey_prf#6155,s_name_prf#6156,s_acctbal_prf#6157,s_comment_prf#6158] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_2#6176]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#6175]
         :        :  +- Relation[s_phone_prf#6167,rid#6168,s_address_prf#6169,s_nationkey_prf#6170,s_suppkey_prf#6171,s_name_prf#6172,s_acctbal_prf#6173,s_comment_prf#6174] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#6198]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#6189: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :     :  :- Project [p_comment_prf#6177 AS p_comment_prf_1#6187, p_name_prf#6178 AS p_name_prf_1#6188, rid#6179 AS rid_1#6189, p_type_prf#6180 AS p_type_prf_1#6190, p_retailprice_prf#6181 AS p_retailprice_prf_1#6191, p_mfgr_prf#6182 AS p_mfgr_prf_1#6192, p_container_prf#6183 AS p_container_prf_1#6193, p_brand_prf#6184 AS p_brand_prf_1#6194, p_size_prf#6185 AS p_size_prf_1#6195, p_partkey_prf#6186 AS p_partkey_prf_1#6196]
            :     :  :  +- Relation[p_comment_prf#6177,p_name_prf#6178,rid#6179,p_type_prf#6180,p_retailprice_prf#6181,p_mfgr_prf#6182,p_container_prf#6183,p_brand_prf#6184,p_size_prf#6185,p_partkey_prf#6186] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6197]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#6199 AS l_returnflag_prf_2#6218, l_orderkey_and_l_linenumber_prf#6200 AS l_orderkey_and_l_linenumber_prf_2#6219, l_comment_prf#6201 AS l_comment_prf_2#6220, l_linestatus_prf#6202 AS l_linestatus_prf_2#6221, rid#6203 AS rid_2#6222, l_shipmode_prf#6204 AS l_shipmode_prf_2#6223, l_shipinstruct_prf#6205 AS l_shipinstruct_prf_2#6224, l_quantity_prf#6206 AS l_quantity_prf_2#6225, l_receiptdate_prf#6207 AS l_receiptdate_prf_2#6226, l_linenumber_prf#6208 AS l_linenumber_prf_2#6227, l_tax_prf#6209 AS l_tax_prf_2#6228, l_shipdate_prf#6210 AS l_shipdate_prf_2#6229, l_extendedprice_prf#6211 AS l_extendedprice_prf_2#6230, l_partkey_prf#6212 AS l_partkey_prf_2#6231, l_discount_prf#6213 AS l_discount_prf_2#6232, l_partkey_and_l_suppkey_prf#6214 AS l_partkey_and_l_suppkey_prf_2#6233, l_commitdate_prf#6215 AS l_commitdate_prf_2#6234, l_suppkey_prf#6216 AS l_suppkey_prf_2#6235, l_orderkey_prf#6217 AS l_orderkey_prf_2#6236]
               +- Relation[l_returnflag_prf#6199,l_orderkey_and_l_linenumber_prf#6200,l_comment_prf#6201,l_linestatus_prf#6202,rid#6203,l_shipmode_prf#6204,l_shipinstruct_prf#6205,l_quantity_prf#6206,l_receiptdate_prf#6207,l_linenumber_prf#6208,l_tax_prf#6209,l_shipdate_prf#6210,l_extendedprice_prf#6211,l_partkey_prf#6212,l_discount_prf#6213,l_partkey_and_l_suppkey_prf#6214,l_commitdate_prf#6215,l_suppkey_prf#6216,l_orderkey_prf#6217] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 55687ms

fr2d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderstatus = 'F' and o_orderkey = l_orderkey
19/10/16 23:29:39 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:29:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6310L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (((isnotnull(o_orderstatus#344) && (o_orderstatus#344 = F)) && isnotnull(o_custkey#343L)) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/16 23:29:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6310L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#6362]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :- Project [c_acctbal_prf#6312 AS c_acctbal_prf_0#6321, rid#6313 AS rid_0#6322, c_name_prf#6314 AS c_name_prf_0#6323, c_nationkey_prf#6315 AS c_nationkey_prf_0#6324, c_custkey_prf#6316 AS c_custkey_prf_0#6325, c_comment_prf#6317 AS c_comment_prf_0#6326, c_address_prf#6318 AS c_address_prf_0#6327, c_mktsegment_prf#6319 AS c_mktsegment_prf_0#6328, c_phone_prf#6320 AS c_phone_prf_0#6329]
         :     :  :  :  +- Relation[c_acctbal_prf#6312,rid#6313,c_name_prf#6314,c_nationkey_prf#6315,c_custkey_prf#6316,c_comment_prf#6317,c_address_prf#6318,c_mktsegment_prf#6319,c_phone_prf#6320] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#6340]
         :     :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :     :  :        :- 'Project ['rid AS rid_0#6339]
         :     :  :        :  +- Relation[c_acctbal_prf#6330,rid#6331,c_name_prf#6332,c_nationkey_prf#6333,c_custkey_prf#6334,c_comment_prf#6335,c_address_prf#6336,c_mktsegment_prf#6337,c_phone_prf#6338] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :     :     :- Project [o_shippriority_prf#6341 AS o_shippriority_prf_1#6351, rid#6342 AS rid_1#6352, o_orderdate_prf#6343 AS o_orderdate_prf_1#6353, o_custkey_prf#6344 AS o_custkey_prf_1#6354, o_orderpriority_prf#6345 AS o_orderpriority_prf_1#6355, o_clerk_prf#6346 AS o_clerk_prf_1#6356, o_orderstatus_prf#6347 AS o_orderstatus_prf_1#6357, o_totalprice_prf#6348 AS o_totalprice_prf_1#6358, o_orderkey_prf#6349 AS o_orderkey_prf_1#6359, o_comment_prf#6350 AS o_comment_prf_1#6360]
         :     :     :  +- Relation[o_shippriority_prf#6341,rid#6342,o_orderdate_prf#6343,o_custkey_prf#6344,o_orderpriority_prf#6345,o_clerk_prf#6346,o_orderstatus_prf#6347,o_totalprice_prf#6348,o_orderkey_prf#6349,o_comment_prf#6350] JDBCRelation(orders_prf) [numPartitions=1]
         :     :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#6361]
         :     :        +- DexRidFilter orders~o_orderstatus~F
         :     :           +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#6363 AS l_returnflag_prf_2#6382, l_orderkey_and_l_linenumber_prf#6364 AS l_orderkey_and_l_linenumber_prf_2#6383, l_comment_prf#6365 AS l_comment_prf_2#6384, l_linestatus_prf#6366 AS l_linestatus_prf_2#6385, rid#6367 AS rid_2#6386, l_shipmode_prf#6368 AS l_shipmode_prf_2#6387, l_shipinstruct_prf#6369 AS l_shipinstruct_prf_2#6388, l_quantity_prf#6370 AS l_quantity_prf_2#6389, l_receiptdate_prf#6371 AS l_receiptdate_prf_2#6390, l_linenumber_prf#6372 AS l_linenumber_prf_2#6391, l_tax_prf#6373 AS l_tax_prf_2#6392, l_shipdate_prf#6374 AS l_shipdate_prf_2#6393, l_extendedprice_prf#6375 AS l_extendedprice_prf_2#6394, l_partkey_prf#6376 AS l_partkey_prf_2#6395, l_discount_prf#6377 AS l_discount_prf_2#6396, l_partkey_and_l_suppkey_prf#6378 AS l_partkey_and_l_suppkey_prf_2#6397, l_commitdate_prf#6379 AS l_commitdate_prf_2#6398, l_suppkey_prf#6380 AS l_suppkey_prf_2#6399, l_orderkey_prf#6381 AS l_orderkey_prf_2#6400]
            +- Relation[l_returnflag_prf#6363,l_orderkey_and_l_linenumber_prf#6364,l_comment_prf#6365,l_linestatus_prf#6366,rid#6367,l_shipmode_prf#6368,l_shipinstruct_prf#6369,l_quantity_prf#6370,l_receiptdate_prf#6371,l_linenumber_prf#6372,l_tax_prf#6373,l_shipdate_prf#6374,l_extendedprice_prf#6375,l_partkey_prf#6376,l_discount_prf#6377,l_partkey_and_l_suppkey_prf#6378,l_commitdate_prf#6379,l_suppkey_prf#6380,l_orderkey_prf#6381] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=2901744
Elapsed time: 107915ms

ft3b=
select * from part, lineitem, supplier where p_size = 15 and p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/16 23:31:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:31:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6474L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/16 23:31:27 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:31:27 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/16 23:31:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6474L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#6497]
         :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#6488: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [p_comment_prf#6476 AS p_comment_prf_0#6486, p_name_prf#6477 AS p_name_prf_0#6487, rid#6478 AS rid_0#6488, p_type_prf#6479 AS p_type_prf_0#6489, p_retailprice_prf#6480 AS p_retailprice_prf_0#6490, p_mfgr_prf#6481 AS p_mfgr_prf_0#6491, p_container_prf#6482 AS p_container_prf_0#6492, p_brand_prf#6483 AS p_brand_prf_0#6493, p_size_prf#6484 AS p_size_prf_0#6494, p_partkey_prf#6485 AS p_partkey_prf_0#6495]
         :     :  :     :  :  +- Relation[p_comment_prf#6476,p_name_prf#6477,rid#6478,p_type_prf#6479,p_retailprice_prf#6480,p_mfgr_prf#6481,p_container_prf#6482,p_brand_prf#6483,p_size_prf#6484,p_partkey_prf#6485] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#6496]
         :     :  :     :     +- DexRidFilter part~p_size~15
         :     :  :     :        +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#6498 AS l_returnflag_prf_1#6517, l_orderkey_and_l_linenumber_prf#6499 AS l_orderkey_and_l_linenumber_prf_1#6518, l_comment_prf#6500 AS l_comment_prf_1#6519, l_linestatus_prf#6501 AS l_linestatus_prf_1#6520, rid#6502 AS rid_1#6521, l_shipmode_prf#6503 AS l_shipmode_prf_1#6522, l_shipinstruct_prf#6504 AS l_shipinstruct_prf_1#6523, l_quantity_prf#6505 AS l_quantity_prf_1#6524, l_receiptdate_prf#6506 AS l_receiptdate_prf_1#6525, l_linenumber_prf#6507 AS l_linenumber_prf_1#6526, l_tax_prf#6508 AS l_tax_prf_1#6527, l_shipdate_prf#6509 AS l_shipdate_prf_1#6528, l_extendedprice_prf#6510 AS l_extendedprice_prf_1#6529, l_partkey_prf#6511 AS l_partkey_prf_1#6530, l_discount_prf#6512 AS l_discount_prf_1#6531, l_partkey_and_l_suppkey_prf#6513 AS l_partkey_and_l_suppkey_prf_1#6532, l_commitdate_prf#6514 AS l_commitdate_prf_1#6533, l_suppkey_prf#6515 AS l_suppkey_prf_1#6534, l_orderkey_prf#6516 AS l_orderkey_prf_1#6535]
         :     :     +- Relation[l_returnflag_prf#6498,l_orderkey_and_l_linenumber_prf#6499,l_comment_prf#6500,l_linestatus_prf#6501,rid#6502,l_shipmode_prf#6503,l_shipinstruct_prf#6504,l_quantity_prf#6505,l_receiptdate_prf#6506,l_linenumber_prf#6507,l_tax_prf#6508,l_shipdate_prf#6509,l_extendedprice_prf#6510,l_partkey_prf#6511,l_discount_prf#6512,l_partkey_and_l_suppkey_prf#6513,l_commitdate_prf#6514,l_suppkey_prf#6515,l_orderkey_prf#6516] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#6537 AS s_phone_prf_2#6545, rid#6538 AS rid_2#6546, s_address_prf#6539 AS s_address_prf_2#6547, s_nationkey_prf#6540 AS s_nationkey_prf_2#6548, s_suppkey_prf#6541 AS s_suppkey_prf_2#6549, s_name_prf#6542 AS s_name_prf_2#6550, s_acctbal_prf#6543 AS s_acctbal_prf_2#6551, s_comment_prf#6544 AS s_comment_prf_2#6552]
            +- Relation[s_phone_prf#6537,rid#6538,s_address_prf#6539,s_nationkey_prf#6540,s_suppkey_prf#6541,s_name_prf#6542,s_acctbal_prf#6543,s_comment_prf#6544] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=117754
Elapsed time: 6168ms

fq1f=

select *
from nation, customer, orders, lineitem
where
  n_name = 'FRANCE' and n_nationkey = c_nationkey and c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/16 23:31:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/16 23:31:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6630L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :     :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Filter (isnotnull(c_custkey#290L) && isnotnull(c_nationkey#293L))
         :           +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Filter ((isnotnull(n_name#109) && (n_name#109 = FRANCE)) && isnotnull(n_nationkey#108L))
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/16 23:31:33 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:31:33 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:31:33 WARN DexPlanner: InMemoryFileIndex=nation
19/10/16 23:31:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6630L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- Project [l_returnflag_prf#6632 AS l_returnflag_prf_0#6651, l_orderkey_and_l_linenumber_prf#6633 AS l_orderkey_and_l_linenumber_prf_0#6652, l_comment_prf#6634 AS l_comment_prf_0#6653, l_linestatus_prf#6635 AS l_linestatus_prf_0#6654, rid#6636 AS rid_0#6655, l_shipmode_prf#6637 AS l_shipmode_prf_0#6656, l_shipinstruct_prf#6638 AS l_shipinstruct_prf_0#6657, l_quantity_prf#6639 AS l_quantity_prf_0#6658, l_receiptdate_prf#6640 AS l_receiptdate_prf_0#6659, l_linenumber_prf#6641 AS l_linenumber_prf_0#6660, l_tax_prf#6642 AS l_tax_prf_0#6661, l_shipdate_prf#6643 AS l_shipdate_prf_0#6662, l_extendedprice_prf#6644 AS l_extendedprice_prf_0#6663, l_partkey_prf#6645 AS l_partkey_prf_0#6664, l_discount_prf#6646 AS l_discount_prf_0#6665, l_partkey_and_l_suppkey_prf#6647 AS l_partkey_and_l_suppkey_prf_0#6666, l_commitdate_prf#6648 AS l_commitdate_prf_0#6667, l_suppkey_prf#6649 AS l_suppkey_prf_0#6668, l_orderkey_prf#6650 AS l_orderkey_prf_0#6669]
         :  :  :  :  :  :  +- Relation[l_returnflag_prf#6632,l_orderkey_and_l_linenumber_prf#6633,l_comment_prf#6634,l_linestatus_prf#6635,rid#6636,l_shipmode_prf#6637,l_shipinstruct_prf#6638,l_quantity_prf#6639,l_receiptdate_prf#6640,l_linenumber_prf#6641,l_tax_prf#6642,l_shipdate_prf#6643,l_extendedprice_prf#6644,l_partkey_prf#6645,l_discount_prf#6646,l_partkey_and_l_suppkey_prf#6647,l_commitdate_prf#6648,l_suppkey_prf#6649,l_orderkey_prf#6650] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2154) AS rid_1#6690]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :  :  :  :  :        :- 'Project ['rid AS rid_0#6689]
         :  :  :  :  :        :  +- Relation[l_returnflag_prf#6670,l_orderkey_and_l_linenumber_prf#6671,l_comment_prf#6672,l_linestatus_prf#6673,rid#6674,l_shipmode_prf#6675,l_shipinstruct_prf#6676,l_quantity_prf#6677,l_receiptdate_prf#6678,l_linenumber_prf#6679,l_tax_prf#6680,l_shipdate_prf#6681,l_extendedprice_prf#6682,l_partkey_prf#6683,l_discount_prf#6684,l_partkey_and_l_suppkey_prf#6685,l_commitdate_prf#6686,l_suppkey_prf#6687,l_orderkey_prf#6688] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [o_shippriority_prf#6691 AS o_shippriority_prf_1#6701, rid#6692 AS rid_1#6702, o_orderdate_prf#6693 AS o_orderdate_prf_1#6703, o_custkey_prf#6694 AS o_custkey_prf_1#6704, o_orderpriority_prf#6695 AS o_orderpriority_prf_1#6705, o_clerk_prf#6696 AS o_clerk_prf_1#6706, o_orderstatus_prf#6697 AS o_orderstatus_prf_1#6707, o_totalprice_prf#6698 AS o_totalprice_prf_1#6708, o_orderkey_prf#6699 AS o_orderkey_prf_1#6709, o_comment_prf#6700 AS o_comment_prf_1#6710]
         :  :  :  :     +- Relation[o_shippriority_prf#6691,rid#6692,o_orderdate_prf#6693,o_custkey_prf#6694,o_orderpriority_prf#6695,o_clerk_prf#6696,o_orderstatus_prf#6697,o_totalprice_prf#6698,o_orderkey_prf#6699,o_comment_prf#6700] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2154) AS rid_2#6722]
         :  :  :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :  :  :        :- 'Project ['rid AS rid_1#6721]
         :  :  :        :  +- Relation[o_shippriority_prf#6711,rid#6712,o_orderdate_prf#6713,o_custkey_prf#6714,o_orderpriority_prf#6715,o_clerk_prf#6716,o_orderstatus_prf#6717,o_totalprice_prf#6718,o_orderkey_prf#6719,o_comment_prf#6720] JDBCRelation(orders_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [c_acctbal_prf#6723 AS c_acctbal_prf_2#6732, rid#6724 AS rid_2#6733, c_name_prf#6725 AS c_name_prf_2#6734, c_nationkey_prf#6726 AS c_nationkey_prf_2#6735, c_custkey_prf#6727 AS c_custkey_prf_2#6736, c_comment_prf#6728 AS c_comment_prf_2#6737, c_address_prf#6729 AS c_address_prf_2#6738, c_mktsegment_prf#6730 AS c_mktsegment_prf_2#6739, c_phone_prf#6731 AS c_phone_prf_2#6740]
         :  :     +- Relation[c_acctbal_prf#6723,rid#6724,c_name_prf#6725,c_nationkey_prf#6726,c_custkey_prf#6727,c_comment_prf#6728,c_address_prf#6729,c_mktsegment_prf#6730,c_phone_prf#6731] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2154) AS rid_3#6751]
         :     +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#6750]
         :        :  +- Relation[c_acctbal_prf#6741,rid#6742,c_name_prf#6743,c_nationkey_prf#6744,c_custkey_prf#6745,c_comment_prf#6746,c_address_prf#6747,c_mktsegment_prf#6748,c_phone_prf#6749] JDBCRelation(customer_prf) [numPartitions=1]
         :        +- Relation[label#2153,value#2154] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_3))
            :- Project [rid#6752 AS rid_3#6757, n_regionkey_prf#6753 AS n_regionkey_prf_3#6758, n_nationkey_prf#6754 AS n_nationkey_prf_3#6759, n_name_prf#6755 AS n_name_prf_3#6760, n_comment_prf#6756 AS n_comment_prf_3#6761]
            :  +- Relation[rid#6752,n_regionkey_prf#6753,n_nationkey_prf#6754,n_name_prf#6755,n_comment_prf#6756] JDBCRelation(nation_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#6762]
               +- DexRidFilter nation~n_name~FRANCE
                  +- Relation[label#2176,value#2177] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=246415
Elapsed time: 168967ms
query=fq1a, count=246415, duration=31049
query=fq1b, count=246415, duration=140562
query=fq1c, count=246415, duration=163825
query=fq1d, count=246415, duration=74471
query=fq1e, count=246415, duration=165542
query=fq1f, count=246415, duration=168967
query=fr1a, count=1214743, duration=121462
query=fr1b, count=1214743, duration=121185
query=fr1c, count=1214743, duration=82914
query=fr1d, count=1214743, duration=32759
query=fr1e, count=1214743, duration=153075
query=fr2a, count=2901744, duration=194329
query=fr2b, count=2901744, duration=106263
query=fr2d, count=2901744, duration=107915
query=fr2e, count=2901744, duration=96208
query=fr2f, count=2901744, duration=83191
query=fs1a, count=1214743, duration=108244
query=fs1b, count=1214743, duration=172733
query=fs1c, count=1214743, duration=172634
query=ft1a, count=2452200, duration=47676
query=ft1b, count=2452200, duration=30049
query=ft1c, count=2452200, duration=33134
query=ft1d, count=2452200, duration=24197
query=ft2a, count=15628, duration=48975
query=ft2b, count=15628, duration=918
query=ft2c, count=15628, duration=7022
query=ft3a, count=117754, duration=95973
query=ft3b, count=117754, duration=6168
query=ft3c, count=117754, duration=55687
