19/10/14 20:27:36 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7126ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Mon Oct 14 20:27:39 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Mon Oct 14 20:27:40 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Mon Oct 14 20:27:40 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Mon Oct 14 20:27:40 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Mon Oct 14 20:27:40 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Mon Oct 14 20:27:42 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Mon Oct 14 20:27:45 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Mon Oct 14 20:27:45 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/14 20:27:46 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:27:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1503L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 20:27:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1503L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#1523]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#1514: string
         :     :- Project [s_phone_prf#1505 AS s_phone_prf_0#1513, rid#1506 AS rid_0#1514, s_address_prf#1507 AS s_address_prf_0#1515, s_nationkey_prf#1508 AS s_nationkey_prf_0#1516, s_suppkey_prf#1509 AS s_suppkey_prf_0#1517, s_name_prf#1510 AS s_name_prf_0#1518, s_acctbal_prf#1511 AS s_acctbal_prf_0#1519, s_comment_prf#1512 AS s_comment_prf_0#1520]
         :     :  +- Relation[s_phone_prf#1505,rid#1506,s_address_prf#1507,s_nationkey_prf#1508,s_suppkey_prf#1509,s_name_prf#1510,s_acctbal_prf#1511,s_comment_prf#1512] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#1562]
            :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_1#1547: string
            :     :- Project [l_returnflag_prf#1524 AS l_returnflag_prf_1#1543, l_orderkey_and_l_linenumber_prf#1525 AS l_orderkey_and_l_linenumber_prf_1#1544, l_comment_prf#1526 AS l_comment_prf_1#1545, l_linestatus_prf#1527 AS l_linestatus_prf_1#1546, rid#1528 AS rid_1#1547, l_shipmode_prf#1529 AS l_shipmode_prf_1#1548, l_shipinstruct_prf#1530 AS l_shipinstruct_prf_1#1549, l_quantity_prf#1531 AS l_quantity_prf_1#1550, l_receiptdate_prf#1532 AS l_receiptdate_prf_1#1551, l_linenumber_prf#1533 AS l_linenumber_prf_1#1552, l_tax_prf#1534 AS l_tax_prf_1#1553, l_shipdate_prf#1535 AS l_shipdate_prf_1#1554, l_extendedprice_prf#1536 AS l_extendedprice_prf_1#1555, l_partkey_prf#1537 AS l_partkey_prf_1#1556, l_discount_prf#1538 AS l_discount_prf_1#1557, l_partkey_and_l_suppkey_prf#1539 AS l_partkey_and_l_suppkey_prf_1#1558, l_commitdate_prf#1540 AS l_commitdate_prf_1#1559, l_suppkey_prf#1541 AS l_suppkey_prf_1#1560, l_orderkey_prf#1542 AS l_orderkey_prf_1#1561]
            :     :  +- Relation[l_returnflag_prf#1524,l_orderkey_and_l_linenumber_prf#1525,l_comment_prf#1526,l_linestatus_prf#1527,rid#1528,l_shipmode_prf#1529,l_shipinstruct_prf#1530,l_quantity_prf#1531,l_receiptdate_prf#1532,l_linenumber_prf#1533,l_tax_prf#1534,l_shipdate_prf#1535,l_extendedprice_prf#1536,l_partkey_prf#1537,l_discount_prf#1538,l_partkey_and_l_suppkey_prf#1539,l_commitdate_prf#1540,l_suppkey_prf#1541,l_orderkey_prf#1542] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#1563 AS p_comment_prf_2#1573, p_name_prf#1564 AS p_name_prf_2#1574, rid#1565 AS rid_2#1575, p_type_prf#1566 AS p_type_prf_2#1576, p_retailprice_prf#1567 AS p_retailprice_prf_2#1577, p_mfgr_prf#1568 AS p_mfgr_prf_2#1578, p_container_prf#1569 AS p_container_prf_2#1579, p_brand_prf#1570 AS p_brand_prf_2#1580, p_size_prf#1571 AS p_size_prf_2#1581, p_partkey_prf#1572 AS p_partkey_prf_2#1582]
               +- Relation[p_comment_prf#1563,p_name_prf#1564,rid#1565,p_type_prf#1566,p_retailprice_prf#1567,p_mfgr_prf#1568,p_container_prf#1569,p_brand_prf#1570,p_size_prf#1571,p_partkey_prf#1572] JDBCRelation(part_prf) [numPartitions=1]

19/10/14 20:27:46 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=6001215
Elapsed time: 186930ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/14 20:30:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:30:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1656L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 20:30:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1656L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#1676]
         :  :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#1668: string
         :  :  :     :- Project [c_acctbal_prf#1658 AS c_acctbal_prf_0#1667, rid#1659 AS rid_0#1668, c_name_prf#1660 AS c_name_prf_0#1669, c_nationkey_prf#1661 AS c_nationkey_prf_0#1670, c_custkey_prf#1662 AS c_custkey_prf_0#1671, c_comment_prf#1663 AS c_comment_prf_0#1672, c_address_prf#1664 AS c_address_prf_0#1673, c_mktsegment_prf#1665 AS c_mktsegment_prf_0#1674, c_phone_prf#1666 AS c_phone_prf_0#1675]
         :  :  :     :  +- Relation[c_acctbal_prf#1658,rid#1659,c_name_prf#1660,c_nationkey_prf#1661,c_custkey_prf#1662,c_comment_prf#1663,c_address_prf#1664,c_mktsegment_prf#1665,c_phone_prf#1666] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#1677 AS o_shippriority_prf_1#1687, rid#1678 AS rid_1#1688, o_orderdate_prf#1679 AS o_orderdate_prf_1#1689, o_custkey_prf#1680 AS o_custkey_prf_1#1690, o_orderpriority_prf#1681 AS o_orderpriority_prf_1#1691, o_clerk_prf#1682 AS o_clerk_prf_1#1692, o_orderstatus_prf#1683 AS o_orderstatus_prf_1#1693, o_totalprice_prf#1684 AS o_totalprice_prf_1#1694, o_orderkey_prf#1685 AS o_orderkey_prf_1#1695, o_comment_prf#1686 AS o_comment_prf_1#1696]
         :  :     +- Relation[o_shippriority_prf#1677,rid#1678,o_orderdate_prf#1679,o_custkey_prf#1680,o_orderpriority_prf#1681,o_clerk_prf#1682,o_orderstatus_prf#1683,o_totalprice_prf#1684,o_orderkey_prf#1685,o_comment_prf#1686] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#1708]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#1707]
         :        :  +- Relation[o_shippriority_prf#1697,rid#1698,o_orderdate_prf#1699,o_custkey_prf#1700,o_orderpriority_prf#1701,o_clerk_prf#1702,o_orderstatus_prf#1703,o_totalprice_prf#1704,o_orderkey_prf#1705,o_comment_prf#1706] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1709 AS l_returnflag_prf_2#1728, l_orderkey_and_l_linenumber_prf#1710 AS l_orderkey_and_l_linenumber_prf_2#1729, l_comment_prf#1711 AS l_comment_prf_2#1730, l_linestatus_prf#1712 AS l_linestatus_prf_2#1731, rid#1713 AS rid_2#1732, l_shipmode_prf#1714 AS l_shipmode_prf_2#1733, l_shipinstruct_prf#1715 AS l_shipinstruct_prf_2#1734, l_quantity_prf#1716 AS l_quantity_prf_2#1735, l_receiptdate_prf#1717 AS l_receiptdate_prf_2#1736, l_linenumber_prf#1718 AS l_linenumber_prf_2#1737, l_tax_prf#1719 AS l_tax_prf_2#1738, l_shipdate_prf#1720 AS l_shipdate_prf_2#1739, l_extendedprice_prf#1721 AS l_extendedprice_prf_2#1740, l_partkey_prf#1722 AS l_partkey_prf_2#1741, l_discount_prf#1723 AS l_discount_prf_2#1742, l_partkey_and_l_suppkey_prf#1724 AS l_partkey_and_l_suppkey_prf_2#1743, l_commitdate_prf#1725 AS l_commitdate_prf_2#1744, l_suppkey_prf#1726 AS l_suppkey_prf_2#1745, l_orderkey_prf#1727 AS l_orderkey_prf_2#1746]
            +- Relation[l_returnflag_prf#1709,l_orderkey_and_l_linenumber_prf#1710,l_comment_prf#1711,l_linestatus_prf#1712,rid#1713,l_shipmode_prf#1714,l_shipinstruct_prf#1715,l_quantity_prf#1716,l_receiptdate_prf#1717,l_linenumber_prf#1718,l_tax_prf#1719,l_shipdate_prf#1720,l_extendedprice_prf#1721,l_partkey_prf#1722,l_discount_prf#1723,l_partkey_and_l_suppkey_prf#1724,l_commitdate_prf#1725,l_suppkey_prf#1726,l_orderkey_prf#1727] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 233373ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/14 20:34:46 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:34:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1802L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 20:34:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1802L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#1827]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#1816: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#1804 AS p_comment_prf_0#1814, p_name_prf#1805 AS p_name_prf_0#1815, rid#1806 AS rid_0#1816, p_type_prf#1807 AS p_type_prf_0#1817, p_retailprice_prf#1808 AS p_retailprice_prf_0#1818, p_mfgr_prf#1809 AS p_mfgr_prf_0#1819, p_container_prf#1810 AS p_container_prf_0#1820, p_brand_prf#1811 AS p_brand_prf_0#1821, p_size_prf#1812 AS p_size_prf_0#1822, p_partkey_prf#1813 AS p_partkey_prf_0#1823]
         :     :  :  +- Relation[p_comment_prf#1804,p_name_prf#1805,rid#1806,p_type_prf#1807,p_retailprice_prf#1808,p_mfgr_prf#1809,p_container_prf#1810,p_brand_prf#1811,p_size_prf#1812,p_partkey_prf#1813] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1826]
         :     :     +- DexRidFilter part~p_size~15
         :     :        +- Relation[label#1824,value#1825] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#1828 AS ps_partkey_and_ps_suppkey_prf_1#1835, rid#1829 AS rid_1#1836, ps_availqty_prf#1830 AS ps_availqty_prf_1#1837, ps_comment_prf#1831 AS ps_comment_prf_1#1838, ps_partkey_prf#1832 AS ps_partkey_prf_1#1839, ps_supplycost_prf#1833 AS ps_supplycost_prf_1#1840, ps_suppkey_prf#1834 AS ps_suppkey_prf_1#1841]
            +- Relation[ps_partkey_and_ps_suppkey_prf#1828,rid#1829,ps_availqty_prf#1830,ps_comment_prf#1831,ps_partkey_prf#1832,ps_supplycost_prf#1833,ps_suppkey_prf#1834] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 426ms

f1=
select * from region where r_name = 'EUROPE'
19/10/14 20:34:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:34:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1865L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/14 20:34:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1865L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#1867 AS r_regionkey_prf_0#1871, r_name_prf#1868 AS r_name_prf_0#1872, r_comment_prf#1869 AS r_comment_prf_0#1873, rid#1870 AS rid_0#1874]
         :  +- Relation[r_regionkey_prf#1867,r_name_prf#1868,r_comment_prf#1869,rid#1870] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1875]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1824,value#1825] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 54ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/14 20:34:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:34:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1908L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 20:34:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1908L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#1930]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#1921: string
         :     :- Project [o_shippriority_prf#1910 AS o_shippriority_prf_0#1920, rid#1911 AS rid_0#1921, o_orderdate_prf#1912 AS o_orderdate_prf_0#1922, o_custkey_prf#1913 AS o_custkey_prf_0#1923, o_orderpriority_prf#1914 AS o_orderpriority_prf_0#1924, o_clerk_prf#1915 AS o_clerk_prf_0#1925, o_orderstatus_prf#1916 AS o_orderstatus_prf_0#1926, o_totalprice_prf#1917 AS o_totalprice_prf_0#1927, o_orderkey_prf#1918 AS o_orderkey_prf_0#1928, o_comment_prf#1919 AS o_comment_prf_0#1929]
         :     :  +- Relation[o_shippriority_prf#1910,rid#1911,o_orderdate_prf#1912,o_custkey_prf#1913,o_orderpriority_prf#1914,o_clerk_prf#1915,o_orderstatus_prf#1916,o_totalprice_prf#1917,o_orderkey_prf#1918,o_comment_prf#1919] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1931 AS l_returnflag_prf_1#1950, l_orderkey_and_l_linenumber_prf#1932 AS l_orderkey_and_l_linenumber_prf_1#1951, l_comment_prf#1933 AS l_comment_prf_1#1952, l_linestatus_prf#1934 AS l_linestatus_prf_1#1953, rid#1935 AS rid_1#1954, l_shipmode_prf#1936 AS l_shipmode_prf_1#1955, l_shipinstruct_prf#1937 AS l_shipinstruct_prf_1#1956, l_quantity_prf#1938 AS l_quantity_prf_1#1957, l_receiptdate_prf#1939 AS l_receiptdate_prf_1#1958, l_linenumber_prf#1940 AS l_linenumber_prf_1#1959, l_tax_prf#1941 AS l_tax_prf_1#1960, l_shipdate_prf#1942 AS l_shipdate_prf_1#1961, l_extendedprice_prf#1943 AS l_extendedprice_prf_1#1962, l_partkey_prf#1944 AS l_partkey_prf_1#1963, l_discount_prf#1945 AS l_discount_prf_1#1964, l_partkey_and_l_suppkey_prf#1946 AS l_partkey_and_l_suppkey_prf_1#1965, l_commitdate_prf#1947 AS l_commitdate_prf_1#1966, l_suppkey_prf#1948 AS l_suppkey_prf_1#1967, l_orderkey_prf#1949 AS l_orderkey_prf_1#1968]
            +- Relation[l_returnflag_prf#1931,l_orderkey_and_l_linenumber_prf#1932,l_comment_prf#1933,l_linestatus_prf#1934,rid#1935,l_shipmode_prf#1936,l_shipinstruct_prf#1937,l_quantity_prf#1938,l_receiptdate_prf#1939,l_linenumber_prf#1940,l_tax_prf#1941,l_shipdate_prf#1942,l_extendedprice_prf#1943,l_partkey_prf#1944,l_discount_prf#1945,l_partkey_and_l_suppkey_prf#1946,l_commitdate_prf#1947,l_suppkey_prf#1948,l_orderkey_prf#1949] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 194616ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/14 20:38:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:38:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2034L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 20:38:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2034L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_2#2054]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2046: string
         :     :- Project [c_acctbal_prf#2036 AS c_acctbal_prf_0#2045, rid#2037 AS rid_0#2046, c_name_prf#2038 AS c_name_prf_0#2047, c_nationkey_prf#2039 AS c_nationkey_prf_0#2048, c_custkey_prf#2040 AS c_custkey_prf_0#2049, c_comment_prf#2041 AS c_comment_prf_0#2050, c_address_prf#2042 AS c_address_prf_0#2051, c_mktsegment_prf#2043 AS c_mktsegment_prf_0#2052, c_phone_prf#2044 AS c_phone_prf_0#2053]
         :     :  +- Relation[c_acctbal_prf#2036,rid#2037,c_name_prf#2038,c_nationkey_prf#2039,c_custkey_prf#2040,c_comment_prf#2041,c_address_prf#2042,c_mktsegment_prf#2043,c_phone_prf#2044] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#2093]
            :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_1#2078: string
            :     :- Project [l_returnflag_prf#2055 AS l_returnflag_prf_1#2074, l_orderkey_and_l_linenumber_prf#2056 AS l_orderkey_and_l_linenumber_prf_1#2075, l_comment_prf#2057 AS l_comment_prf_1#2076, l_linestatus_prf#2058 AS l_linestatus_prf_1#2077, rid#2059 AS rid_1#2078, l_shipmode_prf#2060 AS l_shipmode_prf_1#2079, l_shipinstruct_prf#2061 AS l_shipinstruct_prf_1#2080, l_quantity_prf#2062 AS l_quantity_prf_1#2081, l_receiptdate_prf#2063 AS l_receiptdate_prf_1#2082, l_linenumber_prf#2064 AS l_linenumber_prf_1#2083, l_tax_prf#2065 AS l_tax_prf_1#2084, l_shipdate_prf#2066 AS l_shipdate_prf_1#2085, l_extendedprice_prf#2067 AS l_extendedprice_prf_1#2086, l_partkey_prf#2068 AS l_partkey_prf_1#2087, l_discount_prf#2069 AS l_discount_prf_1#2088, l_partkey_and_l_suppkey_prf#2070 AS l_partkey_and_l_suppkey_prf_1#2089, l_commitdate_prf#2071 AS l_commitdate_prf_1#2090, l_suppkey_prf#2072 AS l_suppkey_prf_1#2091, l_orderkey_prf#2073 AS l_orderkey_prf_1#2092]
            :     :  +- Relation[l_returnflag_prf#2055,l_orderkey_and_l_linenumber_prf#2056,l_comment_prf#2057,l_linestatus_prf#2058,rid#2059,l_shipmode_prf#2060,l_shipinstruct_prf#2061,l_quantity_prf#2062,l_receiptdate_prf#2063,l_linenumber_prf#2064,l_tax_prf#2065,l_shipdate_prf#2066,l_extendedprice_prf#2067,l_partkey_prf#2068,l_discount_prf#2069,l_partkey_and_l_suppkey_prf#2070,l_commitdate_prf#2071,l_suppkey_prf#2072,l_orderkey_prf#2073] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2094 AS o_shippriority_prf_2#2104, rid#2095 AS rid_2#2105, o_orderdate_prf#2096 AS o_orderdate_prf_2#2106, o_custkey_prf#2097 AS o_custkey_prf_2#2107, o_orderpriority_prf#2098 AS o_orderpriority_prf_2#2108, o_clerk_prf#2099 AS o_clerk_prf_2#2109, o_orderstatus_prf#2100 AS o_orderstatus_prf_2#2110, o_totalprice_prf#2101 AS o_totalprice_prf_2#2111, o_orderkey_prf#2102 AS o_orderkey_prf_2#2112, o_comment_prf#2103 AS o_comment_prf_2#2113]
               +- Relation[o_shippriority_prf#2094,rid#2095,o_orderdate_prf#2096,o_custkey_prf#2097,o_orderpriority_prf#2098,o_clerk_prf#2099,o_orderstatus_prf#2100,o_totalprice_prf#2101,o_orderkey_prf#2102,o_comment_prf#2103] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 157267ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/14 20:40:39 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:40:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2174L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 20:40:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2174L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#2192]
         :  :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#2185: string
         :  :  :     :- Project [s_phone_prf#2176 AS s_phone_prf_0#2184, rid#2177 AS rid_0#2185, s_address_prf#2178 AS s_address_prf_0#2186, s_nationkey_prf#2179 AS s_nationkey_prf_0#2187, s_suppkey_prf#2180 AS s_suppkey_prf_0#2188, s_name_prf#2181 AS s_name_prf_0#2189, s_acctbal_prf#2182 AS s_acctbal_prf_0#2190, s_comment_prf#2183 AS s_comment_prf_0#2191]
         :  :  :     :  +- Relation[s_phone_prf#2176,rid#2177,s_address_prf#2178,s_nationkey_prf#2179,s_suppkey_prf#2180,s_name_prf#2181,s_acctbal_prf#2182,s_comment_prf#2183] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [rid#2193 AS rid_1#2198, n_regionkey_prf#2194 AS n_regionkey_prf_1#2199, n_nationkey_prf#2195 AS n_nationkey_prf_1#2200, n_name_prf#2196 AS n_name_prf_1#2201, n_comment_prf#2197 AS n_comment_prf_1#2202]
         :  :     +- Relation[rid#2193,n_regionkey_prf#2194,n_nationkey_prf#2195,n_name_prf#2196,n_comment_prf#2197] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#2209]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2208]
         :        :  +- Relation[rid#2203,n_regionkey_prf#2204,n_nationkey_prf#2205,n_name_prf#2206,n_comment_prf#2207] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2210 AS c_acctbal_prf_2#2219, rid#2211 AS rid_2#2220, c_name_prf#2212 AS c_name_prf_2#2221, c_nationkey_prf#2213 AS c_nationkey_prf_2#2222, c_custkey_prf#2214 AS c_custkey_prf_2#2223, c_comment_prf#2215 AS c_comment_prf_2#2224, c_address_prf#2216 AS c_address_prf_2#2225, c_mktsegment_prf#2217 AS c_mktsegment_prf_2#2226, c_phone_prf#2218 AS c_phone_prf_2#2227]
            +- Relation[c_acctbal_prf#2210,rid#2211,c_name_prf#2212,c_nationkey_prf#2213,c_custkey_prf#2214,c_comment_prf#2215,c_address_prf#2216,c_mktsegment_prf#2217,c_phone_prf#2218] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 45378ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/14 20:41:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:41:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2272L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 20:41:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2272L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#2284]
         :  :  :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#2279: string
         :  :  :     :- Project [rid#2274 AS rid_0#2279, n_regionkey_prf#2275 AS n_regionkey_prf_0#2280, n_nationkey_prf#2276 AS n_nationkey_prf_0#2281, n_name_prf#2277 AS n_name_prf_0#2282, n_comment_prf#2278 AS n_comment_prf_0#2283]
         :  :  :     :  +- Relation[rid#2274,n_regionkey_prf#2275,n_nationkey_prf#2276,n_name_prf#2277,n_comment_prf#2278] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#2285 AS s_phone_prf_1#2293, rid#2286 AS rid_1#2294, s_address_prf#2287 AS s_address_prf_1#2295, s_nationkey_prf#2288 AS s_nationkey_prf_1#2296, s_suppkey_prf#2289 AS s_suppkey_prf_1#2297, s_name_prf#2290 AS s_name_prf_1#2298, s_acctbal_prf#2291 AS s_acctbal_prf_1#2299, s_comment_prf#2292 AS s_comment_prf_1#2300]
         :  :     +- Relation[s_phone_prf#2285,rid#2286,s_address_prf#2287,s_nationkey_prf#2288,s_suppkey_prf#2289,s_name_prf#2290,s_acctbal_prf#2291,s_comment_prf#2292] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1522) AS rid_2#2307]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2306]
         :        :  +- Relation[rid#2301,n_regionkey_prf#2302,n_nationkey_prf#2303,n_name_prf#2304,n_comment_prf#2305] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2308 AS c_acctbal_prf_2#2317, rid#2309 AS rid_2#2318, c_name_prf#2310 AS c_name_prf_2#2319, c_nationkey_prf#2311 AS c_nationkey_prf_2#2320, c_custkey_prf#2312 AS c_custkey_prf_2#2321, c_comment_prf#2313 AS c_comment_prf_2#2322, c_address_prf#2314 AS c_address_prf_2#2323, c_mktsegment_prf#2315 AS c_mktsegment_prf_2#2324, c_phone_prf#2316 AS c_phone_prf_2#2325]
            +- Relation[c_acctbal_prf#2308,rid#2309,c_name_prf#2310,c_nationkey_prf#2311,c_custkey_prf#2312,c_comment_prf#2313,c_address_prf#2314,c_mktsegment_prf#2315,c_phone_prf#2316] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 32835ms

f2=
select * from part where p_size = 15
19/10/14 20:41:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:41:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2360L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 20:41:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2360L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#2362 AS p_comment_prf_0#2372, p_name_prf#2363 AS p_name_prf_0#2373, rid#2364 AS rid_0#2374, p_type_prf#2365 AS p_type_prf_0#2375, p_retailprice_prf#2366 AS p_retailprice_prf_0#2376, p_mfgr_prf#2367 AS p_mfgr_prf_0#2377, p_container_prf#2368 AS p_container_prf_0#2378, p_brand_prf#2369 AS p_brand_prf_0#2379, p_size_prf#2370 AS p_size_prf_0#2380, p_partkey_prf#2371 AS p_partkey_prf_0#2381]
         :  +- Relation[p_comment_prf#2362,p_name_prf#2363,rid#2364,p_type_prf#2365,p_retailprice_prf#2366,p_mfgr_prf#2367,p_container_prf#2368,p_brand_prf#2369,p_size_prf#2370,p_partkey_prf#2371] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2382]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1824,value#1825] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3907
Elapsed time: 134ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/14 20:41:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:41:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2421L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 20:41:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2421L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#2461]
         :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#2446: string
         :     :- Project [l_returnflag_prf#2423 AS l_returnflag_prf_0#2442, l_orderkey_and_l_linenumber_prf#2424 AS l_orderkey_and_l_linenumber_prf_0#2443, l_comment_prf#2425 AS l_comment_prf_0#2444, l_linestatus_prf#2426 AS l_linestatus_prf_0#2445, rid#2427 AS rid_0#2446, l_shipmode_prf#2428 AS l_shipmode_prf_0#2447, l_shipinstruct_prf#2429 AS l_shipinstruct_prf_0#2448, l_quantity_prf#2430 AS l_quantity_prf_0#2449, l_receiptdate_prf#2431 AS l_receiptdate_prf_0#2450, l_linenumber_prf#2432 AS l_linenumber_prf_0#2451, l_tax_prf#2433 AS l_tax_prf_0#2452, l_shipdate_prf#2434 AS l_shipdate_prf_0#2453, l_extendedprice_prf#2435 AS l_extendedprice_prf_0#2454, l_partkey_prf#2436 AS l_partkey_prf_0#2455, l_discount_prf#2437 AS l_discount_prf_0#2456, l_partkey_and_l_suppkey_prf#2438 AS l_partkey_and_l_suppkey_prf_0#2457, l_commitdate_prf#2439 AS l_commitdate_prf_0#2458, l_suppkey_prf#2440 AS l_suppkey_prf_0#2459, l_orderkey_prf#2441 AS l_orderkey_prf_0#2460]
         :     :  +- Relation[l_returnflag_prf#2423,l_orderkey_and_l_linenumber_prf#2424,l_comment_prf#2425,l_linestatus_prf#2426,rid#2427,l_shipmode_prf#2428,l_shipinstruct_prf#2429,l_quantity_prf#2430,l_receiptdate_prf#2431,l_linenumber_prf#2432,l_tax_prf#2433,l_shipdate_prf#2434,l_extendedprice_prf#2435,l_partkey_prf#2436,l_discount_prf#2437,l_partkey_and_l_suppkey_prf#2438,l_commitdate_prf#2439,l_suppkey_prf#2440,l_orderkey_prf#2441] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#2462 AS p_comment_prf_1#2472, p_name_prf#2463 AS p_name_prf_1#2473, rid#2464 AS rid_1#2474, p_type_prf#2465 AS p_type_prf_1#2475, p_retailprice_prf#2466 AS p_retailprice_prf_1#2476, p_mfgr_prf#2467 AS p_mfgr_prf_1#2477, p_container_prf#2468 AS p_container_prf_1#2478, p_brand_prf#2469 AS p_brand_prf_1#2479, p_size_prf#2470 AS p_size_prf_1#2480, p_partkey_prf#2471 AS p_partkey_prf_1#2481]
            +- Relation[p_comment_prf#2462,p_name_prf#2463,rid#2464,p_type_prf#2465,p_retailprice_prf#2466,p_mfgr_prf#2467,p_container_prf#2468,p_brand_prf#2469,p_size_prf#2470,p_partkey_prf#2471] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 117662ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/14 20:43:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:43:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2518L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 20:43:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2518L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#2520 AS rid_0#2525, n_regionkey_prf#2521 AS n_regionkey_prf_0#2526, n_nationkey_prf#2522 AS n_nationkey_prf_0#2527, n_name_prf#2523 AS n_name_prf_0#2528, n_comment_prf#2524 AS n_comment_prf_0#2529]
         :  +- Relation[rid#2520,n_regionkey_prf#2521,n_nationkey_prf#2522,n_name_prf#2523,n_comment_prf#2524] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2530]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1824,value#1825] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 55ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/14 20:43:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:43:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2564L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 20:43:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2564L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#2604]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2589: string
         :     :- Project [l_returnflag_prf#2566 AS l_returnflag_prf_0#2585, l_orderkey_and_l_linenumber_prf#2567 AS l_orderkey_and_l_linenumber_prf_0#2586, l_comment_prf#2568 AS l_comment_prf_0#2587, l_linestatus_prf#2569 AS l_linestatus_prf_0#2588, rid#2570 AS rid_0#2589, l_shipmode_prf#2571 AS l_shipmode_prf_0#2590, l_shipinstruct_prf#2572 AS l_shipinstruct_prf_0#2591, l_quantity_prf#2573 AS l_quantity_prf_0#2592, l_receiptdate_prf#2574 AS l_receiptdate_prf_0#2593, l_linenumber_prf#2575 AS l_linenumber_prf_0#2594, l_tax_prf#2576 AS l_tax_prf_0#2595, l_shipdate_prf#2577 AS l_shipdate_prf_0#2596, l_extendedprice_prf#2578 AS l_extendedprice_prf_0#2597, l_partkey_prf#2579 AS l_partkey_prf_0#2598, l_discount_prf#2580 AS l_discount_prf_0#2599, l_partkey_and_l_suppkey_prf#2581 AS l_partkey_and_l_suppkey_prf_0#2600, l_commitdate_prf#2582 AS l_commitdate_prf_0#2601, l_suppkey_prf#2583 AS l_suppkey_prf_0#2602, l_orderkey_prf#2584 AS l_orderkey_prf_0#2603]
         :     :  +- Relation[l_returnflag_prf#2566,l_orderkey_and_l_linenumber_prf#2567,l_comment_prf#2568,l_linestatus_prf#2569,rid#2570,l_shipmode_prf#2571,l_shipinstruct_prf#2572,l_quantity_prf#2573,l_receiptdate_prf#2574,l_linenumber_prf#2575,l_tax_prf#2576,l_shipdate_prf#2577,l_extendedprice_prf#2578,l_partkey_prf#2579,l_discount_prf#2580,l_partkey_and_l_suppkey_prf#2581,l_commitdate_prf#2582,l_suppkey_prf#2583,l_orderkey_prf#2584] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2605 AS o_shippriority_prf_1#2615, rid#2606 AS rid_1#2616, o_orderdate_prf#2607 AS o_orderdate_prf_1#2617, o_custkey_prf#2608 AS o_custkey_prf_1#2618, o_orderpriority_prf#2609 AS o_orderpriority_prf_1#2619, o_clerk_prf#2610 AS o_clerk_prf_1#2620, o_orderstatus_prf#2611 AS o_orderstatus_prf_1#2621, o_totalprice_prf#2612 AS o_totalprice_prf_1#2622, o_orderkey_prf#2613 AS o_orderkey_prf_1#2623, o_comment_prf#2614 AS o_comment_prf_1#2624]
            +- Relation[o_shippriority_prf#2605,rid#2606,o_orderdate_prf#2607,o_custkey_prf#2608,o_orderpriority_prf#2609,o_clerk_prf#2610,o_orderstatus_prf#2611,o_totalprice_prf#2612,o_orderkey_prf#2613,o_comment_prf#2614] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 114247ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/14 20:45:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:45:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2673L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 20:45:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2673L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#2675 AS l_returnflag_prf_0#2694, l_orderkey_and_l_linenumber_prf#2676 AS l_orderkey_and_l_linenumber_prf_0#2695, l_comment_prf#2677 AS l_comment_prf_0#2696, l_linestatus_prf#2678 AS l_linestatus_prf_0#2697, rid#2679 AS rid_0#2698, l_shipmode_prf#2680 AS l_shipmode_prf_0#2699, l_shipinstruct_prf#2681 AS l_shipinstruct_prf_0#2700, l_quantity_prf#2682 AS l_quantity_prf_0#2701, l_receiptdate_prf#2683 AS l_receiptdate_prf_0#2702, l_linenumber_prf#2684 AS l_linenumber_prf_0#2703, l_tax_prf#2685 AS l_tax_prf_0#2704, l_shipdate_prf#2686 AS l_shipdate_prf_0#2705, l_extendedprice_prf#2687 AS l_extendedprice_prf_0#2706, l_partkey_prf#2688 AS l_partkey_prf_0#2707, l_discount_prf#2689 AS l_discount_prf_0#2708, l_partkey_and_l_suppkey_prf#2690 AS l_partkey_and_l_suppkey_prf_0#2709, l_commitdate_prf#2691 AS l_commitdate_prf_0#2710, l_suppkey_prf#2692 AS l_suppkey_prf_0#2711, l_orderkey_prf#2693 AS l_orderkey_prf_0#2712]
         :  +- Relation[l_returnflag_prf#2675,l_orderkey_and_l_linenumber_prf#2676,l_comment_prf#2677,l_linestatus_prf#2678,rid#2679,l_shipmode_prf#2680,l_shipinstruct_prf#2681,l_quantity_prf#2682,l_receiptdate_prf#2683,l_linenumber_prf#2684,l_tax_prf#2685,l_shipdate_prf#2686,l_extendedprice_prf#2687,l_partkey_prf#2688,l_discount_prf#2689,l_partkey_and_l_suppkey_prf#2690,l_commitdate_prf#2691,l_suppkey_prf#2692,l_orderkey_prf#2693] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2713]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1824,value#1825] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 13697ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/14 20:46:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:46:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2769L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 20:46:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2769L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#2809]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2794: string
         :     :- Project [l_returnflag_prf#2771 AS l_returnflag_prf_0#2790, l_orderkey_and_l_linenumber_prf#2772 AS l_orderkey_and_l_linenumber_prf_0#2791, l_comment_prf#2773 AS l_comment_prf_0#2792, l_linestatus_prf#2774 AS l_linestatus_prf_0#2793, rid#2775 AS rid_0#2794, l_shipmode_prf#2776 AS l_shipmode_prf_0#2795, l_shipinstruct_prf#2777 AS l_shipinstruct_prf_0#2796, l_quantity_prf#2778 AS l_quantity_prf_0#2797, l_receiptdate_prf#2779 AS l_receiptdate_prf_0#2798, l_linenumber_prf#2780 AS l_linenumber_prf_0#2799, l_tax_prf#2781 AS l_tax_prf_0#2800, l_shipdate_prf#2782 AS l_shipdate_prf_0#2801, l_extendedprice_prf#2783 AS l_extendedprice_prf_0#2802, l_partkey_prf#2784 AS l_partkey_prf_0#2803, l_discount_prf#2785 AS l_discount_prf_0#2804, l_partkey_and_l_suppkey_prf#2786 AS l_partkey_and_l_suppkey_prf_0#2805, l_commitdate_prf#2787 AS l_commitdate_prf_0#2806, l_suppkey_prf#2788 AS l_suppkey_prf_0#2807, l_orderkey_prf#2789 AS l_orderkey_prf_0#2808]
         :     :  +- Relation[l_returnflag_prf#2771,l_orderkey_and_l_linenumber_prf#2772,l_comment_prf#2773,l_linestatus_prf#2774,rid#2775,l_shipmode_prf#2776,l_shipinstruct_prf#2777,l_quantity_prf#2778,l_receiptdate_prf#2779,l_linenumber_prf#2780,l_tax_prf#2781,l_shipdate_prf#2782,l_extendedprice_prf#2783,l_partkey_prf#2784,l_discount_prf#2785,l_partkey_and_l_suppkey_prf#2786,l_commitdate_prf#2787,l_suppkey_prf#2788,l_orderkey_prf#2789] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#2830]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#2821: string
            :     :- Project [o_shippriority_prf#2810 AS o_shippriority_prf_1#2820, rid#2811 AS rid_1#2821, o_orderdate_prf#2812 AS o_orderdate_prf_1#2822, o_custkey_prf#2813 AS o_custkey_prf_1#2823, o_orderpriority_prf#2814 AS o_orderpriority_prf_1#2824, o_clerk_prf#2815 AS o_clerk_prf_1#2825, o_orderstatus_prf#2816 AS o_orderstatus_prf_1#2826, o_totalprice_prf#2817 AS o_totalprice_prf_1#2827, o_orderkey_prf#2818 AS o_orderkey_prf_1#2828, o_comment_prf#2819 AS o_comment_prf_1#2829]
            :     :  +- Relation[o_shippriority_prf#2810,rid#2811,o_orderdate_prf#2812,o_custkey_prf#2813,o_orderpriority_prf#2814,o_clerk_prf#2815,o_orderstatus_prf#2816,o_totalprice_prf#2817,o_orderkey_prf#2818,o_comment_prf#2819] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#2831 AS c_acctbal_prf_2#2840, rid#2832 AS rid_2#2841, c_name_prf#2833 AS c_name_prf_2#2842, c_nationkey_prf#2834 AS c_nationkey_prf_2#2843, c_custkey_prf#2835 AS c_custkey_prf_2#2844, c_comment_prf#2836 AS c_comment_prf_2#2845, c_address_prf#2837 AS c_address_prf_2#2846, c_mktsegment_prf#2838 AS c_mktsegment_prf_2#2847, c_phone_prf#2839 AS c_phone_prf_2#2848]
               +- Relation[c_acctbal_prf#2831,rid#2832,c_name_prf#2833,c_nationkey_prf#2834,c_custkey_prf#2835,c_comment_prf#2836,c_address_prf#2837,c_mktsegment_prf#2838,c_phone_prf#2839] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 152156ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/14 20:48:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:48:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2911L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 20:48:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2911L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#2927]
         :  :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#2921: string
         :  :  :     :- Project [ps_partkey_and_ps_suppkey_prf#2913 AS ps_partkey_and_ps_suppkey_prf_0#2920, rid#2914 AS rid_0#2921, ps_availqty_prf#2915 AS ps_availqty_prf_0#2922, ps_comment_prf#2916 AS ps_comment_prf_0#2923, ps_partkey_prf#2917 AS ps_partkey_prf_0#2924, ps_supplycost_prf#2918 AS ps_supplycost_prf_0#2925, ps_suppkey_prf#2919 AS ps_suppkey_prf_0#2926]
         :  :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2913,rid#2914,ps_availqty_prf#2915,ps_comment_prf#2916,ps_partkey_prf#2917,ps_supplycost_prf#2918,ps_suppkey_prf#2919] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#2928 AS p_comment_prf_1#2938, p_name_prf#2929 AS p_name_prf_1#2939, rid#2930 AS rid_1#2940, p_type_prf#2931 AS p_type_prf_1#2941, p_retailprice_prf#2932 AS p_retailprice_prf_1#2942, p_mfgr_prf#2933 AS p_mfgr_prf_1#2943, p_container_prf#2934 AS p_container_prf_1#2944, p_brand_prf#2935 AS p_brand_prf_1#2945, p_size_prf#2936 AS p_size_prf_1#2946, p_partkey_prf#2937 AS p_partkey_prf_1#2947]
         :  :     +- Relation[p_comment_prf#2928,p_name_prf#2929,rid#2930,p_type_prf#2931,p_retailprice_prf#2932,p_mfgr_prf#2933,p_container_prf#2934,p_brand_prf#2935,p_size_prf#2936,p_partkey_prf#2937] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1522) AS rid_2#2956]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2955]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#2948,rid#2949,ps_availqty_prf#2950,ps_comment_prf#2951,ps_partkey_prf#2952,ps_supplycost_prf#2953,ps_suppkey_prf#2954] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2957 AS s_phone_prf_2#2965, rid#2958 AS rid_2#2966, s_address_prf#2959 AS s_address_prf_2#2967, s_nationkey_prf#2960 AS s_nationkey_prf_2#2968, s_suppkey_prf#2961 AS s_suppkey_prf_2#2969, s_name_prf#2962 AS s_name_prf_2#2970, s_acctbal_prf#2963 AS s_acctbal_prf_2#2971, s_comment_prf#2964 AS s_comment_prf_2#2972]
            +- Relation[s_phone_prf#2957,rid#2958,s_address_prf#2959,s_nationkey_prf#2960,s_suppkey_prf#2961,s_name_prf#2962,s_acctbal_prf#2963,s_comment_prf#2964] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 105655ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/14 20:50:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:50:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3018L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 20:50:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3018L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#3038]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3030: string
         :     :- Project [c_acctbal_prf#3020 AS c_acctbal_prf_0#3029, rid#3021 AS rid_0#3030, c_name_prf#3022 AS c_name_prf_0#3031, c_nationkey_prf#3023 AS c_nationkey_prf_0#3032, c_custkey_prf#3024 AS c_custkey_prf_0#3033, c_comment_prf#3025 AS c_comment_prf_0#3034, c_address_prf#3026 AS c_address_prf_0#3035, c_mktsegment_prf#3027 AS c_mktsegment_prf_0#3036, c_phone_prf#3028 AS c_phone_prf_0#3037]
         :     :  +- Relation[c_acctbal_prf#3020,rid#3021,c_name_prf#3022,c_nationkey_prf#3023,c_custkey_prf#3024,c_comment_prf#3025,c_address_prf#3026,c_mktsegment_prf#3027,c_phone_prf#3028] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3039 AS o_shippriority_prf_1#3049, rid#3040 AS rid_1#3050, o_orderdate_prf#3041 AS o_orderdate_prf_1#3051, o_custkey_prf#3042 AS o_custkey_prf_1#3052, o_orderpriority_prf#3043 AS o_orderpriority_prf_1#3053, o_clerk_prf#3044 AS o_clerk_prf_1#3054, o_orderstatus_prf#3045 AS o_orderstatus_prf_1#3055, o_totalprice_prf#3046 AS o_totalprice_prf_1#3056, o_orderkey_prf#3047 AS o_orderkey_prf_1#3057, o_comment_prf#3048 AS o_comment_prf_1#3058]
            +- Relation[o_shippriority_prf#3039,rid#3040,o_orderdate_prf#3041,o_custkey_prf#3042,o_orderpriority_prf#3043,o_clerk_prf#3044,o_orderstatus_prf#3045,o_totalprice_prf#3046,o_orderkey_prf#3047,o_comment_prf#3048] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1500000
Elapsed time: 40182ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/14 20:51:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:51:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3092L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 20:51:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3092L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#3104]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#3099: string
         :     :- Project [rid#3094 AS rid_0#3099, n_regionkey_prf#3095 AS n_regionkey_prf_0#3100, n_nationkey_prf#3096 AS n_nationkey_prf_0#3101, n_name_prf#3097 AS n_name_prf_0#3102, n_comment_prf#3098 AS n_comment_prf_0#3103]
         :     :  +- Relation[rid#3094,n_regionkey_prf#3095,n_nationkey_prf#3096,n_name_prf#3097,n_comment_prf#3098] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3105 AS s_phone_prf_1#3113, rid#3106 AS rid_1#3114, s_address_prf#3107 AS s_address_prf_1#3115, s_nationkey_prf#3108 AS s_nationkey_prf_1#3116, s_suppkey_prf#3109 AS s_suppkey_prf_1#3117, s_name_prf#3110 AS s_name_prf_1#3118, s_acctbal_prf#3111 AS s_acctbal_prf_1#3119, s_comment_prf#3112 AS s_comment_prf_1#3120]
            +- Relation[s_phone_prf#3105,rid#3106,s_address_prf#3107,s_nationkey_prf#3108,s_suppkey_prf#3109,s_name_prf#3110,s_acctbal_prf#3111,s_comment_prf#3112] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=10000
Elapsed time: 190ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/14 20:51:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:51:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3151L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 20:51:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3151L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#3167]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#3161: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#3153 AS ps_partkey_and_ps_suppkey_prf_0#3160, rid#3154 AS rid_0#3161, ps_availqty_prf#3155 AS ps_availqty_prf_0#3162, ps_comment_prf#3156 AS ps_comment_prf_0#3163, ps_partkey_prf#3157 AS ps_partkey_prf_0#3164, ps_supplycost_prf#3158 AS ps_supplycost_prf_0#3165, ps_suppkey_prf#3159 AS ps_suppkey_prf_0#3166]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#3153,rid#3154,ps_availqty_prf#3155,ps_comment_prf#3156,ps_partkey_prf#3157,ps_supplycost_prf#3158,ps_suppkey_prf#3159] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#3168 AS p_comment_prf_1#3178, p_name_prf#3169 AS p_name_prf_1#3179, rid#3170 AS rid_1#3180, p_type_prf#3171 AS p_type_prf_1#3181, p_retailprice_prf#3172 AS p_retailprice_prf_1#3182, p_mfgr_prf#3173 AS p_mfgr_prf_1#3183, p_container_prf#3174 AS p_container_prf_1#3184, p_brand_prf#3175 AS p_brand_prf_1#3185, p_size_prf#3176 AS p_size_prf_1#3186, p_partkey_prf#3177 AS p_partkey_prf_1#3187]
            :  +- Relation[p_comment_prf#3168,p_name_prf#3169,rid#3170,p_type_prf#3171,p_retailprice_prf#3172,p_mfgr_prf#3173,p_container_prf#3174,p_brand_prf#3175,p_size_prf#3176,p_partkey_prf#3177] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3188]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1824,value#1825] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 49566ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/14 20:51:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:51:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3234L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 20:51:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3234L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#3275]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3259: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#3236 AS l_returnflag_prf_0#3255, l_orderkey_and_l_linenumber_prf#3237 AS l_orderkey_and_l_linenumber_prf_0#3256, l_comment_prf#3238 AS l_comment_prf_0#3257, l_linestatus_prf#3239 AS l_linestatus_prf_0#3258, rid#3240 AS rid_0#3259, l_shipmode_prf#3241 AS l_shipmode_prf_0#3260, l_shipinstruct_prf#3242 AS l_shipinstruct_prf_0#3261, l_quantity_prf#3243 AS l_quantity_prf_0#3262, l_receiptdate_prf#3244 AS l_receiptdate_prf_0#3263, l_linenumber_prf#3245 AS l_linenumber_prf_0#3264, l_tax_prf#3246 AS l_tax_prf_0#3265, l_shipdate_prf#3247 AS l_shipdate_prf_0#3266, l_extendedprice_prf#3248 AS l_extendedprice_prf_0#3267, l_partkey_prf#3249 AS l_partkey_prf_0#3268, l_discount_prf#3250 AS l_discount_prf_0#3269, l_partkey_and_l_suppkey_prf#3251 AS l_partkey_and_l_suppkey_prf_0#3270, l_commitdate_prf#3252 AS l_commitdate_prf_0#3271, l_suppkey_prf#3253 AS l_suppkey_prf_0#3272, l_orderkey_prf#3254 AS l_orderkey_prf_0#3273]
         :     :  :  +- Relation[l_returnflag_prf#3236,l_orderkey_and_l_linenumber_prf#3237,l_comment_prf#3238,l_linestatus_prf#3239,rid#3240,l_shipmode_prf#3241,l_shipinstruct_prf#3242,l_quantity_prf#3243,l_receiptdate_prf#3244,l_linenumber_prf#3245,l_tax_prf#3246,l_shipdate_prf#3247,l_extendedprice_prf#3248,l_partkey_prf#3249,l_discount_prf#3250,l_partkey_and_l_suppkey_prf#3251,l_commitdate_prf#3252,l_suppkey_prf#3253,l_orderkey_prf#3254] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3274]
         :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :        +- Relation[label#1824,value#1825] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3276 AS o_shippriority_prf_1#3286, rid#3277 AS rid_1#3287, o_orderdate_prf#3278 AS o_orderdate_prf_1#3288, o_custkey_prf#3279 AS o_custkey_prf_1#3289, o_orderpriority_prf#3280 AS o_orderpriority_prf_1#3290, o_clerk_prf#3281 AS o_clerk_prf_1#3291, o_orderstatus_prf#3282 AS o_orderstatus_prf_1#3292, o_totalprice_prf#3283 AS o_totalprice_prf_1#3293, o_orderkey_prf#3284 AS o_orderkey_prf_1#3294, o_comment_prf#3285 AS o_comment_prf_1#3295]
            +- Relation[o_shippriority_prf#3276,rid#3277,o_orderdate_prf#3278,o_custkey_prf#3279,o_orderpriority_prf#3280,o_clerk_prf#3281,o_orderstatus_prf#3282,o_totalprice_prf#3283,o_orderkey_prf#3284,o_comment_prf#3285] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 54578ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/14 20:52:45 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:52:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3361L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 20:52:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3361L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#3401]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3386: string
         :  :  :     :- Project [l_returnflag_prf#3363 AS l_returnflag_prf_0#3382, l_orderkey_and_l_linenumber_prf#3364 AS l_orderkey_and_l_linenumber_prf_0#3383, l_comment_prf#3365 AS l_comment_prf_0#3384, l_linestatus_prf#3366 AS l_linestatus_prf_0#3385, rid#3367 AS rid_0#3386, l_shipmode_prf#3368 AS l_shipmode_prf_0#3387, l_shipinstruct_prf#3369 AS l_shipinstruct_prf_0#3388, l_quantity_prf#3370 AS l_quantity_prf_0#3389, l_receiptdate_prf#3371 AS l_receiptdate_prf_0#3390, l_linenumber_prf#3372 AS l_linenumber_prf_0#3391, l_tax_prf#3373 AS l_tax_prf_0#3392, l_shipdate_prf#3374 AS l_shipdate_prf_0#3393, l_extendedprice_prf#3375 AS l_extendedprice_prf_0#3394, l_partkey_prf#3376 AS l_partkey_prf_0#3395, l_discount_prf#3377 AS l_discount_prf_0#3396, l_partkey_and_l_suppkey_prf#3378 AS l_partkey_and_l_suppkey_prf_0#3397, l_commitdate_prf#3379 AS l_commitdate_prf_0#3398, l_suppkey_prf#3380 AS l_suppkey_prf_0#3399, l_orderkey_prf#3381 AS l_orderkey_prf_0#3400]
         :  :  :     :  +- Relation[l_returnflag_prf#3363,l_orderkey_and_l_linenumber_prf#3364,l_comment_prf#3365,l_linestatus_prf#3366,rid#3367,l_shipmode_prf#3368,l_shipinstruct_prf#3369,l_quantity_prf#3370,l_receiptdate_prf#3371,l_linenumber_prf#3372,l_tax_prf#3373,l_shipdate_prf#3374,l_extendedprice_prf#3375,l_partkey_prf#3376,l_discount_prf#3377,l_partkey_and_l_suppkey_prf#3378,l_commitdate_prf#3379,l_suppkey_prf#3380,l_orderkey_prf#3381] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#3402 AS o_shippriority_prf_1#3412, rid#3403 AS rid_1#3413, o_orderdate_prf#3404 AS o_orderdate_prf_1#3414, o_custkey_prf#3405 AS o_custkey_prf_1#3415, o_orderpriority_prf#3406 AS o_orderpriority_prf_1#3416, o_clerk_prf#3407 AS o_clerk_prf_1#3417, o_orderstatus_prf#3408 AS o_orderstatus_prf_1#3418, o_totalprice_prf#3409 AS o_totalprice_prf_1#3419, o_orderkey_prf#3410 AS o_orderkey_prf_1#3420, o_comment_prf#3411 AS o_comment_prf_1#3421]
         :  :     +- Relation[o_shippriority_prf#3402,rid#3403,o_orderdate_prf#3404,o_custkey_prf#3405,o_orderpriority_prf#3406,o_clerk_prf#3407,o_orderstatus_prf#3408,o_totalprice_prf#3409,o_orderkey_prf#3410,o_comment_prf#3411] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#3433]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3432]
         :        :  +- Relation[o_shippriority_prf#3422,rid#3423,o_orderdate_prf#3424,o_custkey_prf#3425,o_orderpriority_prf#3426,o_clerk_prf#3427,o_orderstatus_prf#3428,o_totalprice_prf#3429,o_orderkey_prf#3430,o_comment_prf#3431] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3434 AS c_acctbal_prf_2#3443, rid#3435 AS rid_2#3444, c_name_prf#3436 AS c_name_prf_2#3445, c_nationkey_prf#3437 AS c_nationkey_prf_2#3446, c_custkey_prf#3438 AS c_custkey_prf_2#3447, c_comment_prf#3439 AS c_comment_prf_2#3448, c_address_prf#3440 AS c_address_prf_2#3449, c_mktsegment_prf#3441 AS c_mktsegment_prf_2#3450, c_phone_prf#3442 AS c_phone_prf_2#3451]
            +- Relation[c_acctbal_prf#3434,rid#3435,c_name_prf#3436,c_nationkey_prf#3437,c_custkey_prf#3438,c_comment_prf#3439,c_address_prf#3440,c_mktsegment_prf#3441,c_phone_prf#3442] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 169802ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/14 20:55:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:55:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3507L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 20:55:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3507L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#3529]
         :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#3521: string
         :     :- Project [p_comment_prf#3509 AS p_comment_prf_0#3519, p_name_prf#3510 AS p_name_prf_0#3520, rid#3511 AS rid_0#3521, p_type_prf#3512 AS p_type_prf_0#3522, p_retailprice_prf#3513 AS p_retailprice_prf_0#3523, p_mfgr_prf#3514 AS p_mfgr_prf_0#3524, p_container_prf#3515 AS p_container_prf_0#3525, p_brand_prf#3516 AS p_brand_prf_0#3526, p_size_prf#3517 AS p_size_prf_0#3527, p_partkey_prf#3518 AS p_partkey_prf_0#3528]
         :     :  +- Relation[p_comment_prf#3509,p_name_prf#3510,rid#3511,p_type_prf#3512,p_retailprice_prf#3513,p_mfgr_prf#3514,p_container_prf#3515,p_brand_prf#3516,p_size_prf#3517,p_partkey_prf#3518] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#3530 AS ps_partkey_and_ps_suppkey_prf_1#3537, rid#3531 AS rid_1#3538, ps_availqty_prf#3532 AS ps_availqty_prf_1#3539, ps_comment_prf#3533 AS ps_comment_prf_1#3540, ps_partkey_prf#3534 AS ps_partkey_prf_1#3541, ps_supplycost_prf#3535 AS ps_supplycost_prf_1#3542, ps_suppkey_prf#3536 AS ps_suppkey_prf_1#3543]
            +- Relation[ps_partkey_and_ps_suppkey_prf#3530,rid#3531,ps_availqty_prf#3532,ps_comment_prf#3533,ps_partkey_prf#3534,ps_supplycost_prf#3535,ps_suppkey_prf#3536] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 31599ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/14 20:56:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:56:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3597L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 20:56:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3597L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_2#3637]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3622: string
         :     :- Project [l_returnflag_prf#3599 AS l_returnflag_prf_0#3618, l_orderkey_and_l_linenumber_prf#3600 AS l_orderkey_and_l_linenumber_prf_0#3619, l_comment_prf#3601 AS l_comment_prf_0#3620, l_linestatus_prf#3602 AS l_linestatus_prf_0#3621, rid#3603 AS rid_0#3622, l_shipmode_prf#3604 AS l_shipmode_prf_0#3623, l_shipinstruct_prf#3605 AS l_shipinstruct_prf_0#3624, l_quantity_prf#3606 AS l_quantity_prf_0#3625, l_receiptdate_prf#3607 AS l_receiptdate_prf_0#3626, l_linenumber_prf#3608 AS l_linenumber_prf_0#3627, l_tax_prf#3609 AS l_tax_prf_0#3628, l_shipdate_prf#3610 AS l_shipdate_prf_0#3629, l_extendedprice_prf#3611 AS l_extendedprice_prf_0#3630, l_partkey_prf#3612 AS l_partkey_prf_0#3631, l_discount_prf#3613 AS l_discount_prf_0#3632, l_partkey_and_l_suppkey_prf#3614 AS l_partkey_and_l_suppkey_prf_0#3633, l_commitdate_prf#3615 AS l_commitdate_prf_0#3634, l_suppkey_prf#3616 AS l_suppkey_prf_0#3635, l_orderkey_prf#3617 AS l_orderkey_prf_0#3636]
         :     :  +- Relation[l_returnflag_prf#3599,l_orderkey_and_l_linenumber_prf#3600,l_comment_prf#3601,l_linestatus_prf#3602,rid#3603,l_shipmode_prf#3604,l_shipinstruct_prf#3605,l_quantity_prf#3606,l_receiptdate_prf#3607,l_linenumber_prf#3608,l_tax_prf#3609,l_shipdate_prf#3610,l_extendedprice_prf#3611,l_partkey_prf#3612,l_discount_prf#3613,l_partkey_and_l_suppkey_prf#3614,l_commitdate_prf#3615,l_suppkey_prf#3616,l_orderkey_prf#3617] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#3656]
            :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#3648: string
            :     :- Project [c_acctbal_prf#3638 AS c_acctbal_prf_1#3647, rid#3639 AS rid_1#3648, c_name_prf#3640 AS c_name_prf_1#3649, c_nationkey_prf#3641 AS c_nationkey_prf_1#3650, c_custkey_prf#3642 AS c_custkey_prf_1#3651, c_comment_prf#3643 AS c_comment_prf_1#3652, c_address_prf#3644 AS c_address_prf_1#3653, c_mktsegment_prf#3645 AS c_mktsegment_prf_1#3654, c_phone_prf#3646 AS c_phone_prf_1#3655]
            :     :  +- Relation[c_acctbal_prf#3638,rid#3639,c_name_prf#3640,c_nationkey_prf#3641,c_custkey_prf#3642,c_comment_prf#3643,c_address_prf#3644,c_mktsegment_prf#3645,c_phone_prf#3646] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3657 AS o_shippriority_prf_2#3667, rid#3658 AS rid_2#3668, o_orderdate_prf#3659 AS o_orderdate_prf_2#3669, o_custkey_prf#3660 AS o_custkey_prf_2#3670, o_orderpriority_prf#3661 AS o_orderpriority_prf_2#3671, o_clerk_prf#3662 AS o_clerk_prf_2#3672, o_orderstatus_prf#3663 AS o_orderstatus_prf_2#3673, o_totalprice_prf#3664 AS o_totalprice_prf_2#3674, o_orderkey_prf#3665 AS o_orderkey_prf_2#3675, o_comment_prf#3666 AS o_comment_prf_2#3676]
               +- Relation[o_shippriority_prf#3657,rid#3658,o_orderdate_prf#3659,o_custkey_prf#3660,o_orderpriority_prf#3661,o_clerk_prf#3662,o_orderstatus_prf#3663,o_totalprice_prf#3664,o_orderkey_prf#3665,o_comment_prf#3666] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 158380ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/14 20:58:45 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 20:58:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3743L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 20:58:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3743L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#3765]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#3756: string
         :     :- Project [o_shippriority_prf#3745 AS o_shippriority_prf_0#3755, rid#3746 AS rid_0#3756, o_orderdate_prf#3747 AS o_orderdate_prf_0#3757, o_custkey_prf#3748 AS o_custkey_prf_0#3758, o_orderpriority_prf#3749 AS o_orderpriority_prf_0#3759, o_clerk_prf#3750 AS o_clerk_prf_0#3760, o_orderstatus_prf#3751 AS o_orderstatus_prf_0#3761, o_totalprice_prf#3752 AS o_totalprice_prf_0#3762, o_orderkey_prf#3753 AS o_orderkey_prf_0#3763, o_comment_prf#3754 AS o_comment_prf_0#3764]
         :     :  +- Relation[o_shippriority_prf#3745,rid#3746,o_orderdate_prf#3747,o_custkey_prf#3748,o_orderpriority_prf#3749,o_clerk_prf#3750,o_orderstatus_prf#3751,o_totalprice_prf#3752,o_orderkey_prf#3753,o_comment_prf#3754] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#3766 AS l_returnflag_prf_1#3785, l_orderkey_and_l_linenumber_prf#3767 AS l_orderkey_and_l_linenumber_prf_1#3786, l_comment_prf#3768 AS l_comment_prf_1#3787, l_linestatus_prf#3769 AS l_linestatus_prf_1#3788, rid#3770 AS rid_1#3789, l_shipmode_prf#3771 AS l_shipmode_prf_1#3790, l_shipinstruct_prf#3772 AS l_shipinstruct_prf_1#3791, l_quantity_prf#3773 AS l_quantity_prf_1#3792, l_receiptdate_prf#3774 AS l_receiptdate_prf_1#3793, l_linenumber_prf#3775 AS l_linenumber_prf_1#3794, l_tax_prf#3776 AS l_tax_prf_1#3795, l_shipdate_prf#3777 AS l_shipdate_prf_1#3796, l_extendedprice_prf#3778 AS l_extendedprice_prf_1#3797, l_partkey_prf#3779 AS l_partkey_prf_1#3798, l_discount_prf#3780 AS l_discount_prf_1#3799, l_partkey_and_l_suppkey_prf#3781 AS l_partkey_and_l_suppkey_prf_1#3800, l_commitdate_prf#3782 AS l_commitdate_prf_1#3801, l_suppkey_prf#3783 AS l_suppkey_prf_1#3802, l_orderkey_prf#3784 AS l_orderkey_prf_1#3803]
            :  +- Relation[l_returnflag_prf#3766,l_orderkey_and_l_linenumber_prf#3767,l_comment_prf#3768,l_linestatus_prf#3769,rid#3770,l_shipmode_prf#3771,l_shipinstruct_prf#3772,l_quantity_prf#3773,l_receiptdate_prf#3774,l_linenumber_prf#3775,l_tax_prf#3776,l_shipdate_prf#3777,l_extendedprice_prf#3778,l_partkey_prf#3779,l_discount_prf#3780,l_partkey_and_l_suppkey_prf#3781,l_commitdate_prf#3782,l_suppkey_prf#3783,l_orderkey_prf#3784] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3804]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1824,value#1825] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 197373ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/14 21:02:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:02:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3870L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 21:02:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3870L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#3890]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3882: string
         :     :- Project [c_acctbal_prf#3872 AS c_acctbal_prf_0#3881, rid#3873 AS rid_0#3882, c_name_prf#3874 AS c_name_prf_0#3883, c_nationkey_prf#3875 AS c_nationkey_prf_0#3884, c_custkey_prf#3876 AS c_custkey_prf_0#3885, c_comment_prf#3877 AS c_comment_prf_0#3886, c_address_prf#3878 AS c_address_prf_0#3887, c_mktsegment_prf#3879 AS c_mktsegment_prf_0#3888, c_phone_prf#3880 AS c_phone_prf_0#3889]
         :     :  +- Relation[c_acctbal_prf#3872,rid#3873,c_name_prf#3874,c_nationkey_prf#3875,c_custkey_prf#3876,c_comment_prf#3877,c_address_prf#3878,c_mktsegment_prf#3879,c_phone_prf#3880] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#3911]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#3902: string
            :     :- Project [o_shippriority_prf#3891 AS o_shippriority_prf_1#3901, rid#3892 AS rid_1#3902, o_orderdate_prf#3893 AS o_orderdate_prf_1#3903, o_custkey_prf#3894 AS o_custkey_prf_1#3904, o_orderpriority_prf#3895 AS o_orderpriority_prf_1#3905, o_clerk_prf#3896 AS o_clerk_prf_1#3906, o_orderstatus_prf#3897 AS o_orderstatus_prf_1#3907, o_totalprice_prf#3898 AS o_totalprice_prf_1#3908, o_orderkey_prf#3899 AS o_orderkey_prf_1#3909, o_comment_prf#3900 AS o_comment_prf_1#3910]
            :     :  +- Relation[o_shippriority_prf#3891,rid#3892,o_orderdate_prf#3893,o_custkey_prf#3894,o_orderpriority_prf#3895,o_clerk_prf#3896,o_orderstatus_prf#3897,o_totalprice_prf#3898,o_orderkey_prf#3899,o_comment_prf#3900] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3912 AS l_returnflag_prf_2#3931, l_orderkey_and_l_linenumber_prf#3913 AS l_orderkey_and_l_linenumber_prf_2#3932, l_comment_prf#3914 AS l_comment_prf_2#3933, l_linestatus_prf#3915 AS l_linestatus_prf_2#3934, rid#3916 AS rid_2#3935, l_shipmode_prf#3917 AS l_shipmode_prf_2#3936, l_shipinstruct_prf#3918 AS l_shipinstruct_prf_2#3937, l_quantity_prf#3919 AS l_quantity_prf_2#3938, l_receiptdate_prf#3920 AS l_receiptdate_prf_2#3939, l_linenumber_prf#3921 AS l_linenumber_prf_2#3940, l_tax_prf#3922 AS l_tax_prf_2#3941, l_shipdate_prf#3923 AS l_shipdate_prf_2#3942, l_extendedprice_prf#3924 AS l_extendedprice_prf_2#3943, l_partkey_prf#3925 AS l_partkey_prf_2#3944, l_discount_prf#3926 AS l_discount_prf_2#3945, l_partkey_and_l_suppkey_prf#3927 AS l_partkey_and_l_suppkey_prf_2#3946, l_commitdate_prf#3928 AS l_commitdate_prf_2#3947, l_suppkey_prf#3929 AS l_suppkey_prf_2#3948, l_orderkey_prf#3930 AS l_orderkey_prf_2#3949]
               +- Relation[l_returnflag_prf#3912,l_orderkey_and_l_linenumber_prf#3913,l_comment_prf#3914,l_linestatus_prf#3915,rid#3916,l_shipmode_prf#3917,l_shipinstruct_prf#3918,l_quantity_prf#3919,l_receiptdate_prf#3920,l_linenumber_prf#3921,l_tax_prf#3922,l_shipdate_prf#3923,l_extendedprice_prf#3924,l_partkey_prf#3925,l_discount_prf#3926,l_partkey_and_l_suppkey_prf#3927,l_commitdate_prf#3928,l_suppkey_prf#3929,l_orderkey_prf#3930] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 234288ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/14 21:05:56 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:05:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4007L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 21:05:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4007L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#4009 AS l_returnflag_prf_0#4028, l_orderkey_and_l_linenumber_prf#4010 AS l_orderkey_and_l_linenumber_prf_0#4029, l_comment_prf#4011 AS l_comment_prf_0#4030, l_linestatus_prf#4012 AS l_linestatus_prf_0#4031, rid#4013 AS rid_0#4032, l_shipmode_prf#4014 AS l_shipmode_prf_0#4033, l_shipinstruct_prf#4015 AS l_shipinstruct_prf_0#4034, l_quantity_prf#4016 AS l_quantity_prf_0#4035, l_receiptdate_prf#4017 AS l_receiptdate_prf_0#4036, l_linenumber_prf#4018 AS l_linenumber_prf_0#4037, l_tax_prf#4019 AS l_tax_prf_0#4038, l_shipdate_prf#4020 AS l_shipdate_prf_0#4039, l_extendedprice_prf#4021 AS l_extendedprice_prf_0#4040, l_partkey_prf#4022 AS l_partkey_prf_0#4041, l_discount_prf#4023 AS l_discount_prf_0#4042, l_partkey_and_l_suppkey_prf#4024 AS l_partkey_and_l_suppkey_prf_0#4043, l_commitdate_prf#4025 AS l_commitdate_prf_0#4044, l_suppkey_prf#4026 AS l_suppkey_prf_0#4045, l_orderkey_prf#4027 AS l_orderkey_prf_0#4046]
         :  +- Relation[l_returnflag_prf#4009,l_orderkey_and_l_linenumber_prf#4010,l_comment_prf#4011,l_linestatus_prf#4012,rid#4013,l_shipmode_prf#4014,l_shipinstruct_prf#4015,l_quantity_prf#4016,l_receiptdate_prf#4017,l_linenumber_prf#4018,l_tax_prf#4019,l_shipdate_prf#4020,l_extendedprice_prf#4021,l_partkey_prf#4022,l_discount_prf#4023,l_partkey_and_l_suppkey_prf#4024,l_commitdate_prf#4025,l_suppkey_prf#4026,l_orderkey_prf#4027] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4047]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1824,value#1825] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 23506ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/14 21:06:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:06:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4093L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 21:06:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4093L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#4111]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#4104: string
         :     :- Project [s_phone_prf#4095 AS s_phone_prf_0#4103, rid#4096 AS rid_0#4104, s_address_prf#4097 AS s_address_prf_0#4105, s_nationkey_prf#4098 AS s_nationkey_prf_0#4106, s_suppkey_prf#4099 AS s_suppkey_prf_0#4107, s_name_prf#4100 AS s_name_prf_0#4108, s_acctbal_prf#4101 AS s_acctbal_prf_0#4109, s_comment_prf#4102 AS s_comment_prf_0#4110]
         :     :  +- Relation[s_phone_prf#4095,rid#4096,s_address_prf#4097,s_nationkey_prf#4098,s_suppkey_prf#4099,s_name_prf#4100,s_acctbal_prf#4101,s_comment_prf#4102] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4112 AS l_returnflag_prf_1#4131, l_orderkey_and_l_linenumber_prf#4113 AS l_orderkey_and_l_linenumber_prf_1#4132, l_comment_prf#4114 AS l_comment_prf_1#4133, l_linestatus_prf#4115 AS l_linestatus_prf_1#4134, rid#4116 AS rid_1#4135, l_shipmode_prf#4117 AS l_shipmode_prf_1#4136, l_shipinstruct_prf#4118 AS l_shipinstruct_prf_1#4137, l_quantity_prf#4119 AS l_quantity_prf_1#4138, l_receiptdate_prf#4120 AS l_receiptdate_prf_1#4139, l_linenumber_prf#4121 AS l_linenumber_prf_1#4140, l_tax_prf#4122 AS l_tax_prf_1#4141, l_shipdate_prf#4123 AS l_shipdate_prf_1#4142, l_extendedprice_prf#4124 AS l_extendedprice_prf_1#4143, l_partkey_prf#4125 AS l_partkey_prf_1#4144, l_discount_prf#4126 AS l_discount_prf_1#4145, l_partkey_and_l_suppkey_prf#4127 AS l_partkey_and_l_suppkey_prf_1#4146, l_commitdate_prf#4128 AS l_commitdate_prf_1#4147, l_suppkey_prf#4129 AS l_suppkey_prf_1#4148, l_orderkey_prf#4130 AS l_orderkey_prf_1#4149]
            +- Relation[l_returnflag_prf#4112,l_orderkey_and_l_linenumber_prf#4113,l_comment_prf#4114,l_linestatus_prf#4115,rid#4116,l_shipmode_prf#4117,l_shipinstruct_prf#4118,l_quantity_prf#4119,l_receiptdate_prf#4120,l_linenumber_prf#4121,l_tax_prf#4122,l_shipdate_prf#4123,l_extendedprice_prf#4124,l_partkey_prf#4125,l_discount_prf#4126,l_partkey_and_l_suppkey_prf#4127,l_commitdate_prf#4128,l_suppkey_prf#4129,l_orderkey_prf#4130] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 86310ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/14 21:07:46 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:07:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4212L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 21:07:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4212L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_2#4230]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#4223: string
         :     :- Project [s_phone_prf#4214 AS s_phone_prf_0#4222, rid#4215 AS rid_0#4223, s_address_prf#4216 AS s_address_prf_0#4224, s_nationkey_prf#4217 AS s_nationkey_prf_0#4225, s_suppkey_prf#4218 AS s_suppkey_prf_0#4226, s_name_prf#4219 AS s_name_prf_0#4227, s_acctbal_prf#4220 AS s_acctbal_prf_0#4228, s_comment_prf#4221 AS s_comment_prf_0#4229]
         :     :  +- Relation[s_phone_prf#4214,rid#4215,s_address_prf#4216,s_nationkey_prf#4217,s_suppkey_prf#4218,s_name_prf#4219,s_acctbal_prf#4220,s_comment_prf#4221] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#4251]
            :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#4243: string
            :     :- Project [p_comment_prf#4231 AS p_comment_prf_1#4241, p_name_prf#4232 AS p_name_prf_1#4242, rid#4233 AS rid_1#4243, p_type_prf#4234 AS p_type_prf_1#4244, p_retailprice_prf#4235 AS p_retailprice_prf_1#4245, p_mfgr_prf#4236 AS p_mfgr_prf_1#4246, p_container_prf#4237 AS p_container_prf_1#4247, p_brand_prf#4238 AS p_brand_prf_1#4248, p_size_prf#4239 AS p_size_prf_1#4249, p_partkey_prf#4240 AS p_partkey_prf_1#4250]
            :     :  +- Relation[p_comment_prf#4231,p_name_prf#4232,rid#4233,p_type_prf#4234,p_retailprice_prf#4235,p_mfgr_prf#4236,p_container_prf#4237,p_brand_prf#4238,p_size_prf#4239,p_partkey_prf#4240] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4252 AS l_returnflag_prf_2#4271, l_orderkey_and_l_linenumber_prf#4253 AS l_orderkey_and_l_linenumber_prf_2#4272, l_comment_prf#4254 AS l_comment_prf_2#4273, l_linestatus_prf#4255 AS l_linestatus_prf_2#4274, rid#4256 AS rid_2#4275, l_shipmode_prf#4257 AS l_shipmode_prf_2#4276, l_shipinstruct_prf#4258 AS l_shipinstruct_prf_2#4277, l_quantity_prf#4259 AS l_quantity_prf_2#4278, l_receiptdate_prf#4260 AS l_receiptdate_prf_2#4279, l_linenumber_prf#4261 AS l_linenumber_prf_2#4280, l_tax_prf#4262 AS l_tax_prf_2#4281, l_shipdate_prf#4263 AS l_shipdate_prf_2#4282, l_extendedprice_prf#4264 AS l_extendedprice_prf_2#4283, l_partkey_prf#4265 AS l_partkey_prf_2#4284, l_discount_prf#4266 AS l_discount_prf_2#4285, l_partkey_and_l_suppkey_prf#4267 AS l_partkey_and_l_suppkey_prf_2#4286, l_commitdate_prf#4268 AS l_commitdate_prf_2#4287, l_suppkey_prf#4269 AS l_suppkey_prf_2#4288, l_orderkey_prf#4270 AS l_orderkey_prf_2#4289]
               +- Relation[l_returnflag_prf#4252,l_orderkey_and_l_linenumber_prf#4253,l_comment_prf#4254,l_linestatus_prf#4255,rid#4256,l_shipmode_prf#4257,l_shipinstruct_prf#4258,l_quantity_prf#4259,l_receiptdate_prf#4260,l_linenumber_prf#4261,l_tax_prf#4262,l_shipdate_prf#4263,l_extendedprice_prf#4264,l_partkey_prf#4265,l_discount_prf#4266,l_partkey_and_l_suppkey_prf#4267,l_commitdate_prf#4268,l_suppkey_prf#4269,l_orderkey_prf#4270] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 187801ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/14 21:10:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:10:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4362L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 21:10:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4362L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#4384]
         :  :  :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#4376: string
         :  :  :     :- Project [p_comment_prf#4364 AS p_comment_prf_0#4374, p_name_prf#4365 AS p_name_prf_0#4375, rid#4366 AS rid_0#4376, p_type_prf#4367 AS p_type_prf_0#4377, p_retailprice_prf#4368 AS p_retailprice_prf_0#4378, p_mfgr_prf#4369 AS p_mfgr_prf_0#4379, p_container_prf#4370 AS p_container_prf_0#4380, p_brand_prf#4371 AS p_brand_prf_0#4381, p_size_prf#4372 AS p_size_prf_0#4382, p_partkey_prf#4373 AS p_partkey_prf_0#4383]
         :  :  :     :  +- Relation[p_comment_prf#4364,p_name_prf#4365,rid#4366,p_type_prf#4367,p_retailprice_prf#4368,p_mfgr_prf#4369,p_container_prf#4370,p_brand_prf#4371,p_size_prf#4372,p_partkey_prf#4373] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#4385 AS l_returnflag_prf_1#4404, l_orderkey_and_l_linenumber_prf#4386 AS l_orderkey_and_l_linenumber_prf_1#4405, l_comment_prf#4387 AS l_comment_prf_1#4406, l_linestatus_prf#4388 AS l_linestatus_prf_1#4407, rid#4389 AS rid_1#4408, l_shipmode_prf#4390 AS l_shipmode_prf_1#4409, l_shipinstruct_prf#4391 AS l_shipinstruct_prf_1#4410, l_quantity_prf#4392 AS l_quantity_prf_1#4411, l_receiptdate_prf#4393 AS l_receiptdate_prf_1#4412, l_linenumber_prf#4394 AS l_linenumber_prf_1#4413, l_tax_prf#4395 AS l_tax_prf_1#4414, l_shipdate_prf#4396 AS l_shipdate_prf_1#4415, l_extendedprice_prf#4397 AS l_extendedprice_prf_1#4416, l_partkey_prf#4398 AS l_partkey_prf_1#4417, l_discount_prf#4399 AS l_discount_prf_1#4418, l_partkey_and_l_suppkey_prf#4400 AS l_partkey_and_l_suppkey_prf_1#4419, l_commitdate_prf#4401 AS l_commitdate_prf_1#4420, l_suppkey_prf#4402 AS l_suppkey_prf_1#4421, l_orderkey_prf#4403 AS l_orderkey_prf_1#4422]
         :  :     +- Relation[l_returnflag_prf#4385,l_orderkey_and_l_linenumber_prf#4386,l_comment_prf#4387,l_linestatus_prf#4388,rid#4389,l_shipmode_prf#4390,l_shipinstruct_prf#4391,l_quantity_prf#4392,l_receiptdate_prf#4393,l_linenumber_prf#4394,l_tax_prf#4395,l_shipdate_prf#4396,l_extendedprice_prf#4397,l_partkey_prf#4398,l_discount_prf#4399,l_partkey_and_l_suppkey_prf#4400,l_commitdate_prf#4401,l_suppkey_prf#4402,l_orderkey_prf#4403] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#4443]
         :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4442]
         :        :  +- Relation[l_returnflag_prf#4423,l_orderkey_and_l_linenumber_prf#4424,l_comment_prf#4425,l_linestatus_prf#4426,rid#4427,l_shipmode_prf#4428,l_shipinstruct_prf#4429,l_quantity_prf#4430,l_receiptdate_prf#4431,l_linenumber_prf#4432,l_tax_prf#4433,l_shipdate_prf#4434,l_extendedprice_prf#4435,l_partkey_prf#4436,l_discount_prf#4437,l_partkey_and_l_suppkey_prf#4438,l_commitdate_prf#4439,l_suppkey_prf#4440,l_orderkey_prf#4441] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4444 AS s_phone_prf_2#4452, rid#4445 AS rid_2#4453, s_address_prf#4446 AS s_address_prf_2#4454, s_nationkey_prf#4447 AS s_nationkey_prf_2#4455, s_suppkey_prf#4448 AS s_suppkey_prf_2#4456, s_name_prf#4449 AS s_name_prf_2#4457, s_acctbal_prf#4450 AS s_acctbal_prf_2#4458, s_comment_prf#4451 AS s_comment_prf_2#4459]
            +- Relation[s_phone_prf#4444,rid#4445,s_address_prf#4446,s_nationkey_prf#4447,s_suppkey_prf#4448,s_name_prf#4449,s_acctbal_prf#4450,s_comment_prf#4451] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 195899ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/14 21:14:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:14:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4521L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 21:14:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4521L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_2#4539]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#4532: string
         :     :- Project [s_phone_prf#4523 AS s_phone_prf_0#4531, rid#4524 AS rid_0#4532, s_address_prf#4525 AS s_address_prf_0#4533, s_nationkey_prf#4526 AS s_nationkey_prf_0#4534, s_suppkey_prf#4527 AS s_suppkey_prf_0#4535, s_name_prf#4528 AS s_name_prf_0#4536, s_acctbal_prf#4529 AS s_acctbal_prf_0#4537, s_comment_prf#4530 AS s_comment_prf_0#4538]
         :     :  +- Relation[s_phone_prf#4523,rid#4524,s_address_prf#4525,s_nationkey_prf#4526,s_suppkey_prf#4527,s_name_prf#4528,s_acctbal_prf#4529,s_comment_prf#4530] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#4560]
            :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#4552: string
            :     :- Project [p_comment_prf#4540 AS p_comment_prf_1#4550, p_name_prf#4541 AS p_name_prf_1#4551, rid#4542 AS rid_1#4552, p_type_prf#4543 AS p_type_prf_1#4553, p_retailprice_prf#4544 AS p_retailprice_prf_1#4554, p_mfgr_prf#4545 AS p_mfgr_prf_1#4555, p_container_prf#4546 AS p_container_prf_1#4556, p_brand_prf#4547 AS p_brand_prf_1#4557, p_size_prf#4548 AS p_size_prf_1#4558, p_partkey_prf#4549 AS p_partkey_prf_1#4559]
            :     :  +- Relation[p_comment_prf#4540,p_name_prf#4541,rid#4542,p_type_prf#4543,p_retailprice_prf#4544,p_mfgr_prf#4545,p_container_prf#4546,p_brand_prf#4547,p_size_prf#4548,p_partkey_prf#4549] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#4561 AS ps_partkey_and_ps_suppkey_prf_2#4568, rid#4562 AS rid_2#4569, ps_availqty_prf#4563 AS ps_availqty_prf_2#4570, ps_comment_prf#4564 AS ps_comment_prf_2#4571, ps_partkey_prf#4565 AS ps_partkey_prf_2#4572, ps_supplycost_prf#4566 AS ps_supplycost_prf_2#4573, ps_suppkey_prf#4567 AS ps_suppkey_prf_2#4574]
               +- Relation[ps_partkey_and_ps_suppkey_prf#4561,rid#4562,ps_availqty_prf#4563,ps_comment_prf#4564,ps_partkey_prf#4565,ps_supplycost_prf#4566,ps_suppkey_prf#4567] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 42841ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/14 21:14:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:14:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4624L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 21:14:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4624L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#4646]
         :  :  :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4638: string
         :  :  :     :- Project [p_comment_prf#4626 AS p_comment_prf_0#4636, p_name_prf#4627 AS p_name_prf_0#4637, rid#4628 AS rid_0#4638, p_type_prf#4629 AS p_type_prf_0#4639, p_retailprice_prf#4630 AS p_retailprice_prf_0#4640, p_mfgr_prf#4631 AS p_mfgr_prf_0#4641, p_container_prf#4632 AS p_container_prf_0#4642, p_brand_prf#4633 AS p_brand_prf_0#4643, p_size_prf#4634 AS p_size_prf_0#4644, p_partkey_prf#4635 AS p_partkey_prf_0#4645]
         :  :  :     :  +- Relation[p_comment_prf#4626,p_name_prf#4627,rid#4628,p_type_prf#4629,p_retailprice_prf#4630,p_mfgr_prf#4631,p_container_prf#4632,p_brand_prf#4633,p_size_prf#4634,p_partkey_prf#4635] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#4647 AS ps_partkey_and_ps_suppkey_prf_1#4654, rid#4648 AS rid_1#4655, ps_availqty_prf#4649 AS ps_availqty_prf_1#4656, ps_comment_prf#4650 AS ps_comment_prf_1#4657, ps_partkey_prf#4651 AS ps_partkey_prf_1#4658, ps_supplycost_prf#4652 AS ps_supplycost_prf_1#4659, ps_suppkey_prf#4653 AS ps_suppkey_prf_1#4660]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#4647,rid#4648,ps_availqty_prf#4649,ps_comment_prf#4650,ps_partkey_prf#4651,ps_supplycost_prf#4652,ps_suppkey_prf#4653] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#4669]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4668]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#4661,rid#4662,ps_availqty_prf#4663,ps_comment_prf#4664,ps_partkey_prf#4665,ps_supplycost_prf#4666,ps_suppkey_prf#4667] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4670 AS s_phone_prf_2#4678, rid#4671 AS rid_2#4679, s_address_prf#4672 AS s_address_prf_2#4680, s_nationkey_prf#4673 AS s_nationkey_prf_2#4681, s_suppkey_prf#4674 AS s_suppkey_prf_2#4682, s_name_prf#4675 AS s_name_prf_2#4683, s_acctbal_prf#4676 AS s_acctbal_prf_2#4684, s_comment_prf#4677 AS s_comment_prf_2#4685]
            +- Relation[s_phone_prf#4670,rid#4671,s_address_prf#4672,s_nationkey_prf#4673,s_suppkey_prf#4674,s_name_prf#4675,s_acctbal_prf#4676,s_comment_prf#4677] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 84083ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/14 21:16:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:16:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4735L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 21:16:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4735L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#4751]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, rid_0#4745: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#4737 AS ps_partkey_and_ps_suppkey_prf_0#4744, rid#4738 AS rid_0#4745, ps_availqty_prf#4739 AS ps_availqty_prf_0#4746, ps_comment_prf#4740 AS ps_comment_prf_0#4747, ps_partkey_prf#4741 AS ps_partkey_prf_0#4748, ps_supplycost_prf#4742 AS ps_supplycost_prf_0#4749, ps_suppkey_prf#4743 AS ps_suppkey_prf_0#4750]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#4737,rid#4738,ps_availqty_prf#4739,ps_comment_prf#4740,ps_partkey_prf#4741,ps_supplycost_prf#4742,ps_suppkey_prf#4743] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4752 AS l_returnflag_prf_1#4771, l_orderkey_and_l_linenumber_prf#4753 AS l_orderkey_and_l_linenumber_prf_1#4772, l_comment_prf#4754 AS l_comment_prf_1#4773, l_linestatus_prf#4755 AS l_linestatus_prf_1#4774, rid#4756 AS rid_1#4775, l_shipmode_prf#4757 AS l_shipmode_prf_1#4776, l_shipinstruct_prf#4758 AS l_shipinstruct_prf_1#4777, l_quantity_prf#4759 AS l_quantity_prf_1#4778, l_receiptdate_prf#4760 AS l_receiptdate_prf_1#4779, l_linenumber_prf#4761 AS l_linenumber_prf_1#4780, l_tax_prf#4762 AS l_tax_prf_1#4781, l_shipdate_prf#4763 AS l_shipdate_prf_1#4782, l_extendedprice_prf#4764 AS l_extendedprice_prf_1#4783, l_partkey_prf#4765 AS l_partkey_prf_1#4784, l_discount_prf#4766 AS l_discount_prf_1#4785, l_partkey_and_l_suppkey_prf#4767 AS l_partkey_and_l_suppkey_prf_1#4786, l_commitdate_prf#4768 AS l_commitdate_prf_1#4787, l_suppkey_prf#4769 AS l_suppkey_prf_1#4788, l_orderkey_prf#4770 AS l_orderkey_prf_1#4789]
            +- Relation[l_returnflag_prf#4752,l_orderkey_and_l_linenumber_prf#4753,l_comment_prf#4754,l_linestatus_prf#4755,rid#4756,l_shipmode_prf#4757,l_shipinstruct_prf#4758,l_quantity_prf#4759,l_receiptdate_prf#4760,l_linenumber_prf#4761,l_tax_prf#4762,l_shipdate_prf#4763,l_extendedprice_prf#4764,l_partkey_prf#4765,l_discount_prf#4766,l_partkey_and_l_suppkey_prf#4767,l_commitdate_prf#4768,l_suppkey_prf#4769,l_orderkey_prf#4770] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 116106ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/14 21:18:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:18:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4826L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 21:18:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4826L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#4836]
         :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#4835: string
         :     :- Project [r_regionkey_prf#4828 AS r_regionkey_prf_0#4832, r_name_prf#4829 AS r_name_prf_0#4833, r_comment_prf#4830 AS r_comment_prf_0#4834, rid#4831 AS rid_0#4835]
         :     :  +- Relation[r_regionkey_prf#4828,r_name_prf#4829,r_comment_prf#4830,rid#4831] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#4837 AS rid_1#4842, n_regionkey_prf#4838 AS n_regionkey_prf_1#4843, n_nationkey_prf#4839 AS n_nationkey_prf_1#4844, n_name_prf#4840 AS n_name_prf_1#4845, n_comment_prf#4841 AS n_comment_prf_1#4846]
            +- Relation[rid#4837,n_regionkey_prf#4838,n_nationkey_prf#4839,n_name_prf#4840,n_comment_prf#4841] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=25
Elapsed time: 66ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/14 21:18:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:18:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4871L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 21:18:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4871L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#4883]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#4878: string
         :     :- Project [rid#4873 AS rid_0#4878, n_regionkey_prf#4874 AS n_regionkey_prf_0#4879, n_nationkey_prf#4875 AS n_nationkey_prf_0#4880, n_name_prf#4876 AS n_name_prf_0#4881, n_comment_prf#4877 AS n_comment_prf_0#4882]
         :     :  +- Relation[rid#4873,n_regionkey_prf#4874,n_nationkey_prf#4875,n_name_prf#4876,n_comment_prf#4877] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4884 AS c_acctbal_prf_1#4893, rid#4885 AS rid_1#4894, c_name_prf#4886 AS c_name_prf_1#4895, c_nationkey_prf#4887 AS c_nationkey_prf_1#4896, c_custkey_prf#4888 AS c_custkey_prf_1#4897, c_comment_prf#4889 AS c_comment_prf_1#4898, c_address_prf#4890 AS c_address_prf_1#4899, c_mktsegment_prf#4891 AS c_mktsegment_prf_1#4900, c_phone_prf#4892 AS c_phone_prf_1#4901]
            +- Relation[c_acctbal_prf#4884,rid#4885,c_name_prf#4886,c_nationkey_prf#4887,c_custkey_prf#4888,c_comment_prf#4889,c_address_prf#4890,c_mktsegment_prf#4891,c_phone_prf#4892] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=150000
Elapsed time: 1952ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/14 21:18:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:18:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4951L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 21:18:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4951L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#4991]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#4976: string
         :  :  :     :- Project [l_returnflag_prf#4953 AS l_returnflag_prf_0#4972, l_orderkey_and_l_linenumber_prf#4954 AS l_orderkey_and_l_linenumber_prf_0#4973, l_comment_prf#4955 AS l_comment_prf_0#4974, l_linestatus_prf#4956 AS l_linestatus_prf_0#4975, rid#4957 AS rid_0#4976, l_shipmode_prf#4958 AS l_shipmode_prf_0#4977, l_shipinstruct_prf#4959 AS l_shipinstruct_prf_0#4978, l_quantity_prf#4960 AS l_quantity_prf_0#4979, l_receiptdate_prf#4961 AS l_receiptdate_prf_0#4980, l_linenumber_prf#4962 AS l_linenumber_prf_0#4981, l_tax_prf#4963 AS l_tax_prf_0#4982, l_shipdate_prf#4964 AS l_shipdate_prf_0#4983, l_extendedprice_prf#4965 AS l_extendedprice_prf_0#4984, l_partkey_prf#4966 AS l_partkey_prf_0#4985, l_discount_prf#4967 AS l_discount_prf_0#4986, l_partkey_and_l_suppkey_prf#4968 AS l_partkey_and_l_suppkey_prf_0#4987, l_commitdate_prf#4969 AS l_commitdate_prf_0#4988, l_suppkey_prf#4970 AS l_suppkey_prf_0#4989, l_orderkey_prf#4971 AS l_orderkey_prf_0#4990]
         :  :  :     :  +- Relation[l_returnflag_prf#4953,l_orderkey_and_l_linenumber_prf#4954,l_comment_prf#4955,l_linestatus_prf#4956,rid#4957,l_shipmode_prf#4958,l_shipinstruct_prf#4959,l_quantity_prf#4960,l_receiptdate_prf#4961,l_linenumber_prf#4962,l_tax_prf#4963,l_shipdate_prf#4964,l_extendedprice_prf#4965,l_partkey_prf#4966,l_discount_prf#4967,l_partkey_and_l_suppkey_prf#4968,l_commitdate_prf#4969,l_suppkey_prf#4970,l_orderkey_prf#4971] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#4992 AS p_comment_prf_1#5002, p_name_prf#4993 AS p_name_prf_1#5003, rid#4994 AS rid_1#5004, p_type_prf#4995 AS p_type_prf_1#5005, p_retailprice_prf#4996 AS p_retailprice_prf_1#5006, p_mfgr_prf#4997 AS p_mfgr_prf_1#5007, p_container_prf#4998 AS p_container_prf_1#5008, p_brand_prf#4999 AS p_brand_prf_1#5009, p_size_prf#5000 AS p_size_prf_1#5010, p_partkey_prf#5001 AS p_partkey_prf_1#5011]
         :  :     +- Relation[p_comment_prf#4992,p_name_prf#4993,rid#4994,p_type_prf#4995,p_retailprice_prf#4996,p_mfgr_prf#4997,p_container_prf#4998,p_brand_prf#4999,p_size_prf#5000,p_partkey_prf#5001] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1522) AS rid_2#5032]
         :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5031]
         :        :  +- Relation[l_returnflag_prf#5012,l_orderkey_and_l_linenumber_prf#5013,l_comment_prf#5014,l_linestatus_prf#5015,rid#5016,l_shipmode_prf#5017,l_shipinstruct_prf#5018,l_quantity_prf#5019,l_receiptdate_prf#5020,l_linenumber_prf#5021,l_tax_prf#5022,l_shipdate_prf#5023,l_extendedprice_prf#5024,l_partkey_prf#5025,l_discount_prf#5026,l_partkey_and_l_suppkey_prf#5027,l_commitdate_prf#5028,l_suppkey_prf#5029,l_orderkey_prf#5030] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5033 AS s_phone_prf_2#5041, rid#5034 AS rid_2#5042, s_address_prf#5035 AS s_address_prf_2#5043, s_nationkey_prf#5036 AS s_nationkey_prf_2#5044, s_suppkey_prf#5037 AS s_suppkey_prf_2#5045, s_name_prf#5038 AS s_name_prf_2#5046, s_acctbal_prf#5039 AS s_acctbal_prf_2#5047, s_comment_prf#5040 AS s_comment_prf_2#5048]
            +- Relation[s_phone_prf#5033,rid#5034,s_address_prf#5035,s_nationkey_prf#5036,s_suppkey_prf#5037,s_name_prf#5038,s_acctbal_prf#5039,s_comment_prf#5040] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 222212ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/14 21:21:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:21:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5108L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 21:21:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5108L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_2#5128]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#5120: string
         :     :- Project [c_acctbal_prf#5110 AS c_acctbal_prf_0#5119, rid#5111 AS rid_0#5120, c_name_prf#5112 AS c_name_prf_0#5121, c_nationkey_prf#5113 AS c_nationkey_prf_0#5122, c_custkey_prf#5114 AS c_custkey_prf_0#5123, c_comment_prf#5115 AS c_comment_prf_0#5124, c_address_prf#5116 AS c_address_prf_0#5125, c_mktsegment_prf#5117 AS c_mktsegment_prf_0#5126, c_phone_prf#5118 AS c_phone_prf_0#5127]
         :     :  +- Relation[c_acctbal_prf#5110,rid#5111,c_name_prf#5112,c_nationkey_prf#5113,c_custkey_prf#5114,c_comment_prf#5115,c_address_prf#5116,c_mktsegment_prf#5117,c_phone_prf#5118] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#5145]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#5138: string
            :     :- Project [s_phone_prf#5129 AS s_phone_prf_1#5137, rid#5130 AS rid_1#5138, s_address_prf#5131 AS s_address_prf_1#5139, s_nationkey_prf#5132 AS s_nationkey_prf_1#5140, s_suppkey_prf#5133 AS s_suppkey_prf_1#5141, s_name_prf#5134 AS s_name_prf_1#5142, s_acctbal_prf#5135 AS s_acctbal_prf_1#5143, s_comment_prf#5136 AS s_comment_prf_1#5144]
            :     :  +- Relation[s_phone_prf#5129,rid#5130,s_address_prf#5131,s_nationkey_prf#5132,s_suppkey_prf#5133,s_name_prf#5134,s_acctbal_prf#5135,s_comment_prf#5136] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [rid#5146 AS rid_2#5151, n_regionkey_prf#5147 AS n_regionkey_prf_2#5152, n_nationkey_prf#5148 AS n_nationkey_prf_2#5153, n_name_prf#5149 AS n_name_prf_2#5154, n_comment_prf#5150 AS n_comment_prf_2#5155]
               +- Relation[rid#5146,n_regionkey_prf#5147,n_nationkey_prf#5148,n_name_prf#5149,n_comment_prf#5150] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 42205ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/14 21:22:39 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:22:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5193L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 21:22:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5193L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#5211]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#5204: string
         :     :- Project [s_phone_prf#5195 AS s_phone_prf_0#5203, rid#5196 AS rid_0#5204, s_address_prf#5197 AS s_address_prf_0#5205, s_nationkey_prf#5198 AS s_nationkey_prf_0#5206, s_suppkey_prf#5199 AS s_suppkey_prf_0#5207, s_name_prf#5200 AS s_name_prf_0#5208, s_acctbal_prf#5201 AS s_acctbal_prf_0#5209, s_comment_prf#5202 AS s_comment_prf_0#5210]
         :     :  +- Relation[s_phone_prf#5195,rid#5196,s_address_prf#5197,s_nationkey_prf#5198,s_suppkey_prf#5199,s_name_prf#5200,s_acctbal_prf#5201,s_comment_prf#5202] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#5212 AS ps_partkey_and_ps_suppkey_prf_1#5219, rid#5213 AS rid_1#5220, ps_availqty_prf#5214 AS ps_availqty_prf_1#5221, ps_comment_prf#5215 AS ps_comment_prf_1#5222, ps_partkey_prf#5216 AS ps_partkey_prf_1#5223, ps_supplycost_prf#5217 AS ps_supplycost_prf_1#5224, ps_suppkey_prf#5218 AS ps_suppkey_prf_1#5225]
            +- Relation[ps_partkey_and_ps_suppkey_prf#5212,rid#5213,ps_availqty_prf#5214,ps_comment_prf#5215,ps_partkey_prf#5216,ps_supplycost_prf#5217,ps_suppkey_prf#5218] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 10952ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/14 21:22:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:22:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5265L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 21:22:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5265L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#5283]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#5276: string
         :     :- Project [s_phone_prf#5267 AS s_phone_prf_0#5275, rid#5268 AS rid_0#5276, s_address_prf#5269 AS s_address_prf_0#5277, s_nationkey_prf#5270 AS s_nationkey_prf_0#5278, s_suppkey_prf#5271 AS s_suppkey_prf_0#5279, s_name_prf#5272 AS s_name_prf_0#5280, s_acctbal_prf#5273 AS s_acctbal_prf_0#5281, s_comment_prf#5274 AS s_comment_prf_0#5282]
         :     :  +- Relation[s_phone_prf#5267,rid#5268,s_address_prf#5269,s_nationkey_prf#5270,s_suppkey_prf#5271,s_name_prf#5272,s_acctbal_prf#5273,s_comment_prf#5274] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#5298]
            :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_1#5292: string
            :     :- Project [ps_partkey_and_ps_suppkey_prf#5284 AS ps_partkey_and_ps_suppkey_prf_1#5291, rid#5285 AS rid_1#5292, ps_availqty_prf#5286 AS ps_availqty_prf_1#5293, ps_comment_prf#5287 AS ps_comment_prf_1#5294, ps_partkey_prf#5288 AS ps_partkey_prf_1#5295, ps_supplycost_prf#5289 AS ps_supplycost_prf_1#5296, ps_suppkey_prf#5290 AS ps_suppkey_prf_1#5297]
            :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#5284,rid#5285,ps_availqty_prf#5286,ps_comment_prf#5287,ps_partkey_prf#5288,ps_supplycost_prf#5289,ps_suppkey_prf#5290] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#5299 AS p_comment_prf_2#5309, p_name_prf#5300 AS p_name_prf_2#5310, rid#5301 AS rid_2#5311, p_type_prf#5302 AS p_type_prf_2#5312, p_retailprice_prf#5303 AS p_retailprice_prf_2#5313, p_mfgr_prf#5304 AS p_mfgr_prf_2#5314, p_container_prf#5305 AS p_container_prf_2#5315, p_brand_prf#5306 AS p_brand_prf_2#5316, p_size_prf#5307 AS p_size_prf_2#5317, p_partkey_prf#5308 AS p_partkey_prf_2#5318]
               +- Relation[p_comment_prf#5299,p_name_prf#5300,rid#5301,p_type_prf#5302,p_retailprice_prf#5303,p_mfgr_prf#5304,p_container_prf#5305,p_brand_prf#5306,p_size_prf#5307,p_partkey_prf#5308] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 62426ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/14 21:23:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:23:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5356L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 21:23:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5356L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#5358 AS p_comment_prf_0#5368, p_name_prf#5359 AS p_name_prf_0#5369, rid#5360 AS rid_0#5370, p_type_prf#5361 AS p_type_prf_0#5371, p_retailprice_prf#5362 AS p_retailprice_prf_0#5372, p_mfgr_prf#5363 AS p_mfgr_prf_0#5373, p_container_prf#5364 AS p_container_prf_0#5374, p_brand_prf#5365 AS p_brand_prf_0#5375, p_size_prf#5366 AS p_size_prf_0#5376, p_partkey_prf#5367 AS p_partkey_prf_0#5377]
         :  +- Relation[p_comment_prf#5358,p_name_prf#5359,rid#5360,p_type_prf#5361,p_retailprice_prf#5362,p_mfgr_prf#5363,p_container_prf#5364,p_brand_prf#5365,p_size_prf#5366,p_partkey_prf#5367] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5378]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1824,value#1825] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1451
Elapsed time: 90ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/14 21:23:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:23:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5417L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 21:23:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5417L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#5439]
         :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#5431: string
         :     :- Project [p_comment_prf#5419 AS p_comment_prf_0#5429, p_name_prf#5420 AS p_name_prf_0#5430, rid#5421 AS rid_0#5431, p_type_prf#5422 AS p_type_prf_0#5432, p_retailprice_prf#5423 AS p_retailprice_prf_0#5433, p_mfgr_prf#5424 AS p_mfgr_prf_0#5434, p_container_prf#5425 AS p_container_prf_0#5435, p_brand_prf#5426 AS p_brand_prf_0#5436, p_size_prf#5427 AS p_size_prf_0#5437, p_partkey_prf#5428 AS p_partkey_prf_0#5438]
         :     :  +- Relation[p_comment_prf#5419,p_name_prf#5420,rid#5421,p_type_prf#5422,p_retailprice_prf#5423,p_mfgr_prf#5424,p_container_prf#5425,p_brand_prf#5426,p_size_prf#5427,p_partkey_prf#5428] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5440 AS l_returnflag_prf_1#5459, l_orderkey_and_l_linenumber_prf#5441 AS l_orderkey_and_l_linenumber_prf_1#5460, l_comment_prf#5442 AS l_comment_prf_1#5461, l_linestatus_prf#5443 AS l_linestatus_prf_1#5462, rid#5444 AS rid_1#5463, l_shipmode_prf#5445 AS l_shipmode_prf_1#5464, l_shipinstruct_prf#5446 AS l_shipinstruct_prf_1#5465, l_quantity_prf#5447 AS l_quantity_prf_1#5466, l_receiptdate_prf#5448 AS l_receiptdate_prf_1#5467, l_linenumber_prf#5449 AS l_linenumber_prf_1#5468, l_tax_prf#5450 AS l_tax_prf_1#5469, l_shipdate_prf#5451 AS l_shipdate_prf_1#5470, l_extendedprice_prf#5452 AS l_extendedprice_prf_1#5471, l_partkey_prf#5453 AS l_partkey_prf_1#5472, l_discount_prf#5454 AS l_discount_prf_1#5473, l_partkey_and_l_suppkey_prf#5455 AS l_partkey_and_l_suppkey_prf_1#5474, l_commitdate_prf#5456 AS l_commitdate_prf_1#5475, l_suppkey_prf#5457 AS l_suppkey_prf_1#5476, l_orderkey_prf#5458 AS l_orderkey_prf_1#5477]
            +- Relation[l_returnflag_prf#5440,l_orderkey_and_l_linenumber_prf#5441,l_comment_prf#5442,l_linestatus_prf#5443,rid#5444,l_shipmode_prf#5445,l_shipinstruct_prf#5446,l_quantity_prf#5447,l_receiptdate_prf#5448,l_linenumber_prf#5449,l_tax_prf#5450,l_shipdate_prf#5451,l_extendedprice_prf#5452,l_partkey_prf#5453,l_discount_prf#5454,l_partkey_and_l_suppkey_prf#5455,l_commitdate_prf#5456,l_suppkey_prf#5457,l_orderkey_prf#5458] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 94020ms
query=b1a, count=15628, duration=426
query=b1b, count=15628, duration=49566
query=b2a, count=1478870, duration=197373
query=b2b, count=1478870, duration=54578
query=f1, count=1, duration=54
query=f2, count=3907, duration=134
query=f3, count=1451, duration=90
query=f4, count=1, duration=55
query=f5, count=1478870, duration=23506
query=f6, count=857401, duration=13697
query=j1, count=800000, duration=31599
query=j10, count=6001215, duration=86310
query=j2, count=800000, duration=10952
query=j3, count=25, duration=66
query=j4, count=150000, duration=1952
query=j5, count=10000, duration=190
query=j6, count=6001215, duration=116106
query=j7, count=1500000, duration=40182
query=j8, count=6001215, duration=194616
query=j8b, count=6001215, duration=114247
query=j9, count=6001215, duration=94020
query=j9b, count=6001215, duration=117662
query=r1a, count=6001215, duration=169802
query=r1b, count=6001215, duration=152156
query=r1c, count=6001215, duration=158380
query=r1d, count=6001215, duration=233373
query=r1e, count=6001215, duration=234288
query=r1f, count=6001215, duration=157267
query=t1a, count=60000414, duration=45378
query=t1b, count=60000414, duration=32835
query=t1c, count=60000414, duration=42205
query=t2a, count=800000, duration=105655
query=t2b, count=800000, duration=84083
query=t2c, count=800000, duration=42841
query=t2d, count=800000, duration=62426
query=t3a, count=6001215, duration=222212
query=t3b, count=6001215, duration=195899
query=t3c, count=6001215, duration=187801
query=t3d, count=6001215, duration=186930
