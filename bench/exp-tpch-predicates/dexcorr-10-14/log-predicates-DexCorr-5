19/10/14 09:50:56 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7097ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Mon Oct 14 09:50:58 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Mon Oct 14 09:50:59 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Mon Oct 14 09:50:59 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Mon Oct 14 09:50:59 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Mon Oct 14 09:50:59 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Mon Oct 14 09:51:02 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Mon Oct 14 09:51:04 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Mon Oct 14 09:51:04 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/14 09:51:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:51:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1490L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 09:51:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1490L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_2#1512]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#1502: string
         :     :- Project [c_acctbal_prf#1492 AS c_acctbal_prf_0#1501, rid#1493 AS rid_0#1502, c_name_prf#1494 AS c_name_prf_0#1503, c_nationkey_prf#1495 AS c_nationkey_prf_0#1504, c_custkey_prf#1496 AS c_custkey_prf_0#1505, c_comment_prf#1497 AS c_comment_prf_0#1506, c_address_prf#1498 AS c_address_prf_0#1507, c_mktsegment_prf#1499 AS c_mktsegment_prf_0#1508, c_phone_prf#1500 AS c_phone_prf_0#1509]
         :     :  +- Relation[c_acctbal_prf#1492,rid#1493,c_name_prf#1494,c_nationkey_prf#1495,c_custkey_prf#1496,c_comment_prf#1497,c_address_prf#1498,c_mktsegment_prf#1499,c_phone_prf#1500] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#1529]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#1522: string
            :     :- Project [s_phone_prf#1513 AS s_phone_prf_1#1521, rid#1514 AS rid_1#1522, s_address_prf#1515 AS s_address_prf_1#1523, s_nationkey_prf#1516 AS s_nationkey_prf_1#1524, s_suppkey_prf#1517 AS s_suppkey_prf_1#1525, s_name_prf#1518 AS s_name_prf_1#1526, s_acctbal_prf#1519 AS s_acctbal_prf_1#1527, s_comment_prf#1520 AS s_comment_prf_1#1528]
            :     :  +- Relation[s_phone_prf#1513,rid#1514,s_address_prf#1515,s_nationkey_prf#1516,s_suppkey_prf#1517,s_name_prf#1518,s_acctbal_prf#1519,s_comment_prf#1520] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [rid#1530 AS rid_2#1535, n_regionkey_prf#1531 AS n_regionkey_prf_2#1536, n_nationkey_prf#1532 AS n_nationkey_prf_2#1537, n_name_prf#1533 AS n_name_prf_2#1538, n_comment_prf#1534 AS n_comment_prf_2#1539]
               +- Relation[rid#1530,n_regionkey_prf#1531,n_nationkey_prf#1532,n_name_prf#1533,n_comment_prf#1534] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 85446ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/14 09:52:31 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:52:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1597L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 09:52:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1597L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#1615]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#1608: string
         :     :- Project [s_phone_prf#1599 AS s_phone_prf_0#1607, rid#1600 AS rid_0#1608, s_address_prf#1601 AS s_address_prf_0#1609, s_nationkey_prf#1602 AS s_nationkey_prf_0#1610, s_suppkey_prf#1603 AS s_suppkey_prf_0#1611, s_name_prf#1604 AS s_name_prf_0#1612, s_acctbal_prf#1605 AS s_acctbal_prf_0#1613, s_comment_prf#1606 AS s_comment_prf_0#1614]
         :     :  +- Relation[s_phone_prf#1599,rid#1600,s_address_prf#1601,s_nationkey_prf#1602,s_suppkey_prf#1603,s_name_prf#1604,s_acctbal_prf#1605,s_comment_prf#1606] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#1654]
            :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_1#1639: string
            :     :- Project [l_returnflag_prf#1616 AS l_returnflag_prf_1#1635, l_orderkey_and_l_linenumber_prf#1617 AS l_orderkey_and_l_linenumber_prf_1#1636, l_comment_prf#1618 AS l_comment_prf_1#1637, l_linestatus_prf#1619 AS l_linestatus_prf_1#1638, rid#1620 AS rid_1#1639, l_shipmode_prf#1621 AS l_shipmode_prf_1#1640, l_shipinstruct_prf#1622 AS l_shipinstruct_prf_1#1641, l_quantity_prf#1623 AS l_quantity_prf_1#1642, l_receiptdate_prf#1624 AS l_receiptdate_prf_1#1643, l_linenumber_prf#1625 AS l_linenumber_prf_1#1644, l_tax_prf#1626 AS l_tax_prf_1#1645, l_shipdate_prf#1627 AS l_shipdate_prf_1#1646, l_extendedprice_prf#1628 AS l_extendedprice_prf_1#1647, l_partkey_prf#1629 AS l_partkey_prf_1#1648, l_discount_prf#1630 AS l_discount_prf_1#1649, l_partkey_and_l_suppkey_prf#1631 AS l_partkey_and_l_suppkey_prf_1#1650, l_commitdate_prf#1632 AS l_commitdate_prf_1#1651, l_suppkey_prf#1633 AS l_suppkey_prf_1#1652, l_orderkey_prf#1634 AS l_orderkey_prf_1#1653]
            :     :  +- Relation[l_returnflag_prf#1616,l_orderkey_and_l_linenumber_prf#1617,l_comment_prf#1618,l_linestatus_prf#1619,rid#1620,l_shipmode_prf#1621,l_shipinstruct_prf#1622,l_quantity_prf#1623,l_receiptdate_prf#1624,l_linenumber_prf#1625,l_tax_prf#1626,l_shipdate_prf#1627,l_extendedprice_prf#1628,l_partkey_prf#1629,l_discount_prf#1630,l_partkey_and_l_suppkey_prf#1631,l_commitdate_prf#1632,l_suppkey_prf#1633,l_orderkey_prf#1634] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#1655 AS p_comment_prf_2#1665, p_name_prf#1656 AS p_name_prf_2#1666, rid#1657 AS rid_2#1667, p_type_prf#1658 AS p_type_prf_2#1668, p_retailprice_prf#1659 AS p_retailprice_prf_2#1669, p_mfgr_prf#1660 AS p_mfgr_prf_2#1670, p_container_prf#1661 AS p_container_prf_2#1671, p_brand_prf#1662 AS p_brand_prf_2#1672, p_size_prf#1663 AS p_size_prf_2#1673, p_partkey_prf#1664 AS p_partkey_prf_2#1674]
               +- Relation[p_comment_prf#1655,p_name_prf#1656,rid#1657,p_type_prf#1658,p_retailprice_prf#1659,p_mfgr_prf#1660,p_container_prf#1661,p_brand_prf#1662,p_size_prf#1663,p_partkey_prf#1664] JDBCRelation(part_prf) [numPartitions=1]

19/10/14 09:52:31 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=6001215
Elapsed time: 186274ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/14 09:55:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:55:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1729L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 09:55:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1729L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#1745]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#1739: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#1731 AS ps_partkey_and_ps_suppkey_prf_0#1738, rid#1732 AS rid_0#1739, ps_availqty_prf#1733 AS ps_availqty_prf_0#1740, ps_comment_prf#1734 AS ps_comment_prf_0#1741, ps_partkey_prf#1735 AS ps_partkey_prf_0#1742, ps_supplycost_prf#1736 AS ps_supplycost_prf_0#1743, ps_suppkey_prf#1737 AS ps_suppkey_prf_0#1744]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#1731,rid#1732,ps_availqty_prf#1733,ps_comment_prf#1734,ps_partkey_prf#1735,ps_supplycost_prf#1736,ps_suppkey_prf#1737] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#1746 AS p_comment_prf_1#1756, p_name_prf#1747 AS p_name_prf_1#1757, rid#1748 AS rid_1#1758, p_type_prf#1749 AS p_type_prf_1#1759, p_retailprice_prf#1750 AS p_retailprice_prf_1#1760, p_mfgr_prf#1751 AS p_mfgr_prf_1#1761, p_container_prf#1752 AS p_container_prf_1#1762, p_brand_prf#1753 AS p_brand_prf_1#1763, p_size_prf#1754 AS p_size_prf_1#1764, p_partkey_prf#1755 AS p_partkey_prf_1#1765]
            :  +- Relation[p_comment_prf#1746,p_name_prf#1747,rid#1748,p_type_prf#1749,p_retailprice_prf#1750,p_mfgr_prf#1751,p_container_prf#1752,p_brand_prf#1753,p_size_prf#1754,p_partkey_prf#1755] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#1768]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1766,value#1767] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 49895ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/14 09:56:29 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:56:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1810L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 09:56:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1810L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#1826]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, rid_0#1820: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#1812 AS ps_partkey_and_ps_suppkey_prf_0#1819, rid#1813 AS rid_0#1820, ps_availqty_prf#1814 AS ps_availqty_prf_0#1821, ps_comment_prf#1815 AS ps_comment_prf_0#1822, ps_partkey_prf#1816 AS ps_partkey_prf_0#1823, ps_supplycost_prf#1817 AS ps_supplycost_prf_0#1824, ps_suppkey_prf#1818 AS ps_suppkey_prf_0#1825]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#1812,rid#1813,ps_availqty_prf#1814,ps_comment_prf#1815,ps_partkey_prf#1816,ps_supplycost_prf#1817,ps_suppkey_prf#1818] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1827 AS l_returnflag_prf_1#1846, l_orderkey_and_l_linenumber_prf#1828 AS l_orderkey_and_l_linenumber_prf_1#1847, l_comment_prf#1829 AS l_comment_prf_1#1848, l_linestatus_prf#1830 AS l_linestatus_prf_1#1849, rid#1831 AS rid_1#1850, l_shipmode_prf#1832 AS l_shipmode_prf_1#1851, l_shipinstruct_prf#1833 AS l_shipinstruct_prf_1#1852, l_quantity_prf#1834 AS l_quantity_prf_1#1853, l_receiptdate_prf#1835 AS l_receiptdate_prf_1#1854, l_linenumber_prf#1836 AS l_linenumber_prf_1#1855, l_tax_prf#1837 AS l_tax_prf_1#1856, l_shipdate_prf#1838 AS l_shipdate_prf_1#1857, l_extendedprice_prf#1839 AS l_extendedprice_prf_1#1858, l_partkey_prf#1840 AS l_partkey_prf_1#1859, l_discount_prf#1841 AS l_discount_prf_1#1860, l_partkey_and_l_suppkey_prf#1842 AS l_partkey_and_l_suppkey_prf_1#1861, l_commitdate_prf#1843 AS l_commitdate_prf_1#1862, l_suppkey_prf#1844 AS l_suppkey_prf_1#1863, l_orderkey_prf#1845 AS l_orderkey_prf_1#1864]
            +- Relation[l_returnflag_prf#1827,l_orderkey_and_l_linenumber_prf#1828,l_comment_prf#1829,l_linestatus_prf#1830,rid#1831,l_shipmode_prf#1832,l_shipinstruct_prf#1833,l_quantity_prf#1834,l_receiptdate_prf#1835,l_linenumber_prf#1836,l_tax_prf#1837,l_shipdate_prf#1838,l_extendedprice_prf#1839,l_partkey_prf#1840,l_discount_prf#1841,l_partkey_and_l_suppkey_prf#1842,l_commitdate_prf#1843,l_suppkey_prf#1844,l_orderkey_prf#1845] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 118641ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/14 09:58:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:58:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1926L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 09:58:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1926L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#1966]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#1951: string
         :     :  :     :- Project [l_returnflag_prf#1928 AS l_returnflag_prf_0#1947, l_orderkey_and_l_linenumber_prf#1929 AS l_orderkey_and_l_linenumber_prf_0#1948, l_comment_prf#1930 AS l_comment_prf_0#1949, l_linestatus_prf#1931 AS l_linestatus_prf_0#1950, rid#1932 AS rid_0#1951, l_shipmode_prf#1933 AS l_shipmode_prf_0#1952, l_shipinstruct_prf#1934 AS l_shipinstruct_prf_0#1953, l_quantity_prf#1935 AS l_quantity_prf_0#1954, l_receiptdate_prf#1936 AS l_receiptdate_prf_0#1955, l_linenumber_prf#1937 AS l_linenumber_prf_0#1956, l_tax_prf#1938 AS l_tax_prf_0#1957, l_shipdate_prf#1939 AS l_shipdate_prf_0#1958, l_extendedprice_prf#1940 AS l_extendedprice_prf_0#1959, l_partkey_prf#1941 AS l_partkey_prf_0#1960, l_discount_prf#1942 AS l_discount_prf_0#1961, l_partkey_and_l_suppkey_prf#1943 AS l_partkey_and_l_suppkey_prf_0#1962, l_commitdate_prf#1944 AS l_commitdate_prf_0#1963, l_suppkey_prf#1945 AS l_suppkey_prf_0#1964, l_orderkey_prf#1946 AS l_orderkey_prf_0#1965]
         :     :  :     :  +- Relation[l_returnflag_prf#1928,l_orderkey_and_l_linenumber_prf#1929,l_comment_prf#1930,l_linestatus_prf#1931,rid#1932,l_shipmode_prf#1933,l_shipinstruct_prf#1934,l_quantity_prf#1935,l_receiptdate_prf#1936,l_linenumber_prf#1937,l_tax_prf#1938,l_shipdate_prf#1939,l_extendedprice_prf#1940,l_partkey_prf#1941,l_discount_prf#1942,l_partkey_and_l_suppkey_prf#1943,l_commitdate_prf#1944,l_suppkey_prf#1945,l_orderkey_prf#1946] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#1967 AS p_comment_prf_1#1977, p_name_prf#1968 AS p_name_prf_1#1978, rid#1969 AS rid_1#1979, p_type_prf#1970 AS p_type_prf_1#1980, p_retailprice_prf#1971 AS p_retailprice_prf_1#1981, p_mfgr_prf#1972 AS p_mfgr_prf_1#1982, p_container_prf#1973 AS p_container_prf_1#1983, p_brand_prf#1974 AS p_brand_prf_1#1984, p_size_prf#1975 AS p_size_prf_1#1985, p_partkey_prf#1976 AS p_partkey_prf_1#1986]
         :     :     +- Relation[p_comment_prf#1967,p_name_prf#1968,rid#1969,p_type_prf#1970,p_retailprice_prf#1971,p_mfgr_prf#1972,p_container_prf#1973,p_brand_prf#1974,p_size_prf#1975,p_partkey_prf#1976] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#1988 AS s_phone_prf_2#1996, rid#1989 AS rid_2#1997, s_address_prf#1990 AS s_address_prf_2#1998, s_nationkey_prf#1991 AS s_nationkey_prf_2#1999, s_suppkey_prf#1992 AS s_suppkey_prf_2#2000, s_name_prf#1993 AS s_name_prf_2#2001, s_acctbal_prf#1994 AS s_acctbal_prf_2#2002, s_comment_prf#1995 AS s_comment_prf_2#2003]
            +- Relation[s_phone_prf#1988,rid#1989,s_address_prf#1990,s_nationkey_prf#1991,s_suppkey_prf#1992,s_name_prf#1993,s_acctbal_prf#1994,s_comment_prf#1995] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 263118ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/14 10:02:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:02:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2058L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 10:02:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2058L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#2081]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2072: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#2060 AS p_comment_prf_0#2070, p_name_prf#2061 AS p_name_prf_0#2071, rid#2062 AS rid_0#2072, p_type_prf#2063 AS p_type_prf_0#2073, p_retailprice_prf#2064 AS p_retailprice_prf_0#2074, p_mfgr_prf#2065 AS p_mfgr_prf_0#2075, p_container_prf#2066 AS p_container_prf_0#2076, p_brand_prf#2067 AS p_brand_prf_0#2077, p_size_prf#2068 AS p_size_prf_0#2078, p_partkey_prf#2069 AS p_partkey_prf_0#2079]
         :     :  :  +- Relation[p_comment_prf#2060,p_name_prf#2061,rid#2062,p_type_prf#2063,p_retailprice_prf#2064,p_mfgr_prf#2065,p_container_prf#2066,p_brand_prf#2067,p_size_prf#2068,p_partkey_prf#2069] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2080]
         :     :     +- DexRidFilter part~p_size~15
         :     :        +- Relation[label#1766,value#1767] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2082 AS ps_partkey_and_ps_suppkey_prf_1#2089, rid#2083 AS rid_1#2090, ps_availqty_prf#2084 AS ps_availqty_prf_1#2091, ps_comment_prf#2085 AS ps_comment_prf_1#2092, ps_partkey_prf#2086 AS ps_partkey_prf_1#2093, ps_supplycost_prf#2087 AS ps_supplycost_prf_1#2094, ps_suppkey_prf#2088 AS ps_suppkey_prf_1#2095]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2082,rid#2083,ps_availqty_prf#2084,ps_comment_prf#2085,ps_partkey_prf#2086,ps_supplycost_prf#2087,ps_suppkey_prf#2088] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 405ms

f1=
select * from region where r_name = 'EUROPE'
19/10/14 10:02:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:02:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2119L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/14 10:02:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2119L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#2121 AS r_regionkey_prf_0#2125, r_name_prf#2122 AS r_name_prf_0#2126, r_comment_prf#2123 AS r_comment_prf_0#2127, rid#2124 AS rid_0#2128]
         :  +- Relation[r_regionkey_prf#2121,r_name_prf#2122,r_comment_prf#2123,rid#2124] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2129]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1766,value#1767] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 53ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/14 10:02:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:02:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2149L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 10:02:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2149L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#2161]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#2156: string
         :     :- Project [rid#2151 AS rid_0#2156, n_regionkey_prf#2152 AS n_regionkey_prf_0#2157, n_nationkey_prf#2153 AS n_nationkey_prf_0#2158, n_name_prf#2154 AS n_name_prf_0#2159, n_comment_prf#2155 AS n_comment_prf_0#2160]
         :     :  +- Relation[rid#2151,n_regionkey_prf#2152,n_nationkey_prf#2153,n_name_prf#2154,n_comment_prf#2155] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2162 AS c_acctbal_prf_1#2171, rid#2163 AS rid_1#2172, c_name_prf#2164 AS c_name_prf_1#2173, c_nationkey_prf#2165 AS c_nationkey_prf_1#2174, c_custkey_prf#2166 AS c_custkey_prf_1#2175, c_comment_prf#2167 AS c_comment_prf_1#2176, c_address_prf#2168 AS c_address_prf_1#2177, c_mktsegment_prf#2169 AS c_mktsegment_prf_1#2178, c_phone_prf#2170 AS c_phone_prf_1#2179]
            +- Relation[c_acctbal_prf#2162,rid#2163,c_name_prf#2164,c_nationkey_prf#2165,c_custkey_prf#2166,c_comment_prf#2167,c_address_prf#2168,c_mktsegment_prf#2169,c_phone_prf#2170] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=150000
Elapsed time: 1917ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/14 10:02:51 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:02:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2204L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 10:02:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2204L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#2214]
         :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#2213: string
         :     :- Project [r_regionkey_prf#2206 AS r_regionkey_prf_0#2210, r_name_prf#2207 AS r_name_prf_0#2211, r_comment_prf#2208 AS r_comment_prf_0#2212, rid#2209 AS rid_0#2213]
         :     :  +- Relation[r_regionkey_prf#2206,r_name_prf#2207,r_comment_prf#2208,rid#2209] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#2215 AS rid_1#2220, n_regionkey_prf#2216 AS n_regionkey_prf_1#2221, n_nationkey_prf#2217 AS n_nationkey_prf_1#2222, n_name_prf#2218 AS n_name_prf_1#2223, n_comment_prf#2219 AS n_comment_prf_1#2224]
            +- Relation[rid#2215,n_regionkey_prf#2216,n_nationkey_prf#2217,n_name_prf#2218,n_comment_prf#2219] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=25
Elapsed time: 68ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/14 10:02:51 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:02:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2270L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 10:02:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2270L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#2310]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2295: string
         :     :- Project [l_returnflag_prf#2272 AS l_returnflag_prf_0#2291, l_orderkey_and_l_linenumber_prf#2273 AS l_orderkey_and_l_linenumber_prf_0#2292, l_comment_prf#2274 AS l_comment_prf_0#2293, l_linestatus_prf#2275 AS l_linestatus_prf_0#2294, rid#2276 AS rid_0#2295, l_shipmode_prf#2277 AS l_shipmode_prf_0#2296, l_shipinstruct_prf#2278 AS l_shipinstruct_prf_0#2297, l_quantity_prf#2279 AS l_quantity_prf_0#2298, l_receiptdate_prf#2280 AS l_receiptdate_prf_0#2299, l_linenumber_prf#2281 AS l_linenumber_prf_0#2300, l_tax_prf#2282 AS l_tax_prf_0#2301, l_shipdate_prf#2283 AS l_shipdate_prf_0#2302, l_extendedprice_prf#2284 AS l_extendedprice_prf_0#2303, l_partkey_prf#2285 AS l_partkey_prf_0#2304, l_discount_prf#2286 AS l_discount_prf_0#2305, l_partkey_and_l_suppkey_prf#2287 AS l_partkey_and_l_suppkey_prf_0#2306, l_commitdate_prf#2288 AS l_commitdate_prf_0#2307, l_suppkey_prf#2289 AS l_suppkey_prf_0#2308, l_orderkey_prf#2290 AS l_orderkey_prf_0#2309]
         :     :  +- Relation[l_returnflag_prf#2272,l_orderkey_and_l_linenumber_prf#2273,l_comment_prf#2274,l_linestatus_prf#2275,rid#2276,l_shipmode_prf#2277,l_shipinstruct_prf#2278,l_quantity_prf#2279,l_receiptdate_prf#2280,l_linenumber_prf#2281,l_tax_prf#2282,l_shipdate_prf#2283,l_extendedprice_prf#2284,l_partkey_prf#2285,l_discount_prf#2286,l_partkey_and_l_suppkey_prf#2287,l_commitdate_prf#2288,l_suppkey_prf#2289,l_orderkey_prf#2290] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#2331]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#2322: string
            :     :- Project [o_shippriority_prf#2311 AS o_shippriority_prf_1#2321, rid#2312 AS rid_1#2322, o_orderdate_prf#2313 AS o_orderdate_prf_1#2323, o_custkey_prf#2314 AS o_custkey_prf_1#2324, o_orderpriority_prf#2315 AS o_orderpriority_prf_1#2325, o_clerk_prf#2316 AS o_clerk_prf_1#2326, o_orderstatus_prf#2317 AS o_orderstatus_prf_1#2327, o_totalprice_prf#2318 AS o_totalprice_prf_1#2328, o_orderkey_prf#2319 AS o_orderkey_prf_1#2329, o_comment_prf#2320 AS o_comment_prf_1#2330]
            :     :  +- Relation[o_shippriority_prf#2311,rid#2312,o_orderdate_prf#2313,o_custkey_prf#2314,o_orderpriority_prf#2315,o_clerk_prf#2316,o_orderstatus_prf#2317,o_totalprice_prf#2318,o_orderkey_prf#2319,o_comment_prf#2320] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#2332 AS c_acctbal_prf_2#2341, rid#2333 AS rid_2#2342, c_name_prf#2334 AS c_name_prf_2#2343, c_nationkey_prf#2335 AS c_nationkey_prf_2#2344, c_custkey_prf#2336 AS c_custkey_prf_2#2345, c_comment_prf#2337 AS c_comment_prf_2#2346, c_address_prf#2338 AS c_address_prf_2#2347, c_mktsegment_prf#2339 AS c_mktsegment_prf_2#2348, c_phone_prf#2340 AS c_phone_prf_2#2349]
               +- Relation[c_acctbal_prf#2332,rid#2333,c_name_prf#2334,c_nationkey_prf#2335,c_custkey_prf#2336,c_comment_prf#2337,c_address_prf#2338,c_mktsegment_prf#2339,c_phone_prf#2340] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 149091ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/14 10:05:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:05:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2403L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 10:05:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2403L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#2421]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#2414: string
         :     :- Project [s_phone_prf#2405 AS s_phone_prf_0#2413, rid#2406 AS rid_0#2414, s_address_prf#2407 AS s_address_prf_0#2415, s_nationkey_prf#2408 AS s_nationkey_prf_0#2416, s_suppkey_prf#2409 AS s_suppkey_prf_0#2417, s_name_prf#2410 AS s_name_prf_0#2418, s_acctbal_prf#2411 AS s_acctbal_prf_0#2419, s_comment_prf#2412 AS s_comment_prf_0#2420]
         :     :  +- Relation[s_phone_prf#2405,rid#2406,s_address_prf#2407,s_nationkey_prf#2408,s_suppkey_prf#2409,s_name_prf#2410,s_acctbal_prf#2411,s_comment_prf#2412] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2422 AS ps_partkey_and_ps_suppkey_prf_1#2429, rid#2423 AS rid_1#2430, ps_availqty_prf#2424 AS ps_availqty_prf_1#2431, ps_comment_prf#2425 AS ps_comment_prf_1#2432, ps_partkey_prf#2426 AS ps_partkey_prf_1#2433, ps_supplycost_prf#2427 AS ps_supplycost_prf_1#2434, ps_suppkey_prf#2428 AS ps_suppkey_prf_1#2435]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2422,rid#2423,ps_availqty_prf#2424,ps_comment_prf#2425,ps_partkey_prf#2426,ps_supplycost_prf#2427,ps_suppkey_prf#2428] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 10952ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/14 10:05:31 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:05:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2479L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 10:05:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2479L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#2520]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2504: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#2481 AS l_returnflag_prf_0#2500, l_orderkey_and_l_linenumber_prf#2482 AS l_orderkey_and_l_linenumber_prf_0#2501, l_comment_prf#2483 AS l_comment_prf_0#2502, l_linestatus_prf#2484 AS l_linestatus_prf_0#2503, rid#2485 AS rid_0#2504, l_shipmode_prf#2486 AS l_shipmode_prf_0#2505, l_shipinstruct_prf#2487 AS l_shipinstruct_prf_0#2506, l_quantity_prf#2488 AS l_quantity_prf_0#2507, l_receiptdate_prf#2489 AS l_receiptdate_prf_0#2508, l_linenumber_prf#2490 AS l_linenumber_prf_0#2509, l_tax_prf#2491 AS l_tax_prf_0#2510, l_shipdate_prf#2492 AS l_shipdate_prf_0#2511, l_extendedprice_prf#2493 AS l_extendedprice_prf_0#2512, l_partkey_prf#2494 AS l_partkey_prf_0#2513, l_discount_prf#2495 AS l_discount_prf_0#2514, l_partkey_and_l_suppkey_prf#2496 AS l_partkey_and_l_suppkey_prf_0#2515, l_commitdate_prf#2497 AS l_commitdate_prf_0#2516, l_suppkey_prf#2498 AS l_suppkey_prf_0#2517, l_orderkey_prf#2499 AS l_orderkey_prf_0#2518]
         :     :  :  +- Relation[l_returnflag_prf#2481,l_orderkey_and_l_linenumber_prf#2482,l_comment_prf#2483,l_linestatus_prf#2484,rid#2485,l_shipmode_prf#2486,l_shipinstruct_prf#2487,l_quantity_prf#2488,l_receiptdate_prf#2489,l_linenumber_prf#2490,l_tax_prf#2491,l_shipdate_prf#2492,l_extendedprice_prf#2493,l_partkey_prf#2494,l_discount_prf#2495,l_partkey_and_l_suppkey_prf#2496,l_commitdate_prf#2497,l_suppkey_prf#2498,l_orderkey_prf#2499] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2519]
         :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :        +- Relation[label#1766,value#1767] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2521 AS o_shippriority_prf_1#2531, rid#2522 AS rid_1#2532, o_orderdate_prf#2523 AS o_orderdate_prf_1#2533, o_custkey_prf#2524 AS o_custkey_prf_1#2534, o_orderpriority_prf#2525 AS o_orderpriority_prf_1#2535, o_clerk_prf#2526 AS o_clerk_prf_1#2536, o_orderstatus_prf#2527 AS o_orderstatus_prf_1#2537, o_totalprice_prf#2528 AS o_totalprice_prf_1#2538, o_orderkey_prf#2529 AS o_orderkey_prf_1#2539, o_comment_prf#2530 AS o_comment_prf_1#2540]
            +- Relation[o_shippriority_prf#2521,rid#2522,o_orderdate_prf#2523,o_custkey_prf#2524,o_orderpriority_prf#2525,o_clerk_prf#2526,o_orderstatus_prf#2527,o_totalprice_prf#2528,o_orderkey_prf#2529,o_comment_prf#2530] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 54360ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/14 10:06:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:06:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2592L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 10:06:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2592L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#2621]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#2604]
         :     :  :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#2599: string
         :     :  :     :- Project [rid#2594 AS rid_0#2599, n_regionkey_prf#2595 AS n_regionkey_prf_0#2600, n_nationkey_prf#2596 AS n_nationkey_prf_0#2601, n_name_prf#2597 AS n_name_prf_0#2602, n_comment_prf#2598 AS n_comment_prf_0#2603]
         :     :  :     :  +- Relation[rid#2594,n_regionkey_prf#2595,n_nationkey_prf#2596,n_name_prf#2597,n_comment_prf#2598] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#2605 AS s_phone_prf_1#2613, rid#2606 AS rid_1#2614, s_address_prf#2607 AS s_address_prf_1#2615, s_nationkey_prf#2608 AS s_nationkey_prf_1#2616, s_suppkey_prf#2609 AS s_suppkey_prf_1#2617, s_name_prf#2610 AS s_name_prf_1#2618, s_acctbal_prf#2611 AS s_acctbal_prf_1#2619, s_comment_prf#2612 AS s_comment_prf_1#2620]
         :     :     +- Relation[s_phone_prf#2605,rid#2606,s_address_prf#2607,s_nationkey_prf#2608,s_suppkey_prf#2609,s_name_prf#2610,s_acctbal_prf#2611,s_comment_prf#2612] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2622 AS c_acctbal_prf_2#2631, rid#2623 AS rid_2#2632, c_name_prf#2624 AS c_name_prf_2#2633, c_nationkey_prf#2625 AS c_nationkey_prf_2#2634, c_custkey_prf#2626 AS c_custkey_prf_2#2635, c_comment_prf#2627 AS c_comment_prf_2#2636, c_address_prf#2628 AS c_address_prf_2#2637, c_mktsegment_prf#2629 AS c_mktsegment_prf_2#2638, c_phone_prf#2630 AS c_phone_prf_2#2639]
            +- Relation[c_acctbal_prf#2622,rid#2623,c_name_prf#2624,c_nationkey_prf#2625,c_custkey_prf#2626,c_comment_prf#2627,c_address_prf#2628,c_mktsegment_prf#2629,c_phone_prf#2630] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 767454ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/14 10:19:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:19:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2698L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 10:19:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2698L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_2#2738]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2723: string
         :     :- Project [l_returnflag_prf#2700 AS l_returnflag_prf_0#2719, l_orderkey_and_l_linenumber_prf#2701 AS l_orderkey_and_l_linenumber_prf_0#2720, l_comment_prf#2702 AS l_comment_prf_0#2721, l_linestatus_prf#2703 AS l_linestatus_prf_0#2722, rid#2704 AS rid_0#2723, l_shipmode_prf#2705 AS l_shipmode_prf_0#2724, l_shipinstruct_prf#2706 AS l_shipinstruct_prf_0#2725, l_quantity_prf#2707 AS l_quantity_prf_0#2726, l_receiptdate_prf#2708 AS l_receiptdate_prf_0#2727, l_linenumber_prf#2709 AS l_linenumber_prf_0#2728, l_tax_prf#2710 AS l_tax_prf_0#2729, l_shipdate_prf#2711 AS l_shipdate_prf_0#2730, l_extendedprice_prf#2712 AS l_extendedprice_prf_0#2731, l_partkey_prf#2713 AS l_partkey_prf_0#2732, l_discount_prf#2714 AS l_discount_prf_0#2733, l_partkey_and_l_suppkey_prf#2715 AS l_partkey_and_l_suppkey_prf_0#2734, l_commitdate_prf#2716 AS l_commitdate_prf_0#2735, l_suppkey_prf#2717 AS l_suppkey_prf_0#2736, l_orderkey_prf#2718 AS l_orderkey_prf_0#2737]
         :     :  +- Relation[l_returnflag_prf#2700,l_orderkey_and_l_linenumber_prf#2701,l_comment_prf#2702,l_linestatus_prf#2703,rid#2704,l_shipmode_prf#2705,l_shipinstruct_prf#2706,l_quantity_prf#2707,l_receiptdate_prf#2708,l_linenumber_prf#2709,l_tax_prf#2710,l_shipdate_prf#2711,l_extendedprice_prf#2712,l_partkey_prf#2713,l_discount_prf#2714,l_partkey_and_l_suppkey_prf#2715,l_commitdate_prf#2716,l_suppkey_prf#2717,l_orderkey_prf#2718] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#2757]
            :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#2749: string
            :     :- Project [c_acctbal_prf#2739 AS c_acctbal_prf_1#2748, rid#2740 AS rid_1#2749, c_name_prf#2741 AS c_name_prf_1#2750, c_nationkey_prf#2742 AS c_nationkey_prf_1#2751, c_custkey_prf#2743 AS c_custkey_prf_1#2752, c_comment_prf#2744 AS c_comment_prf_1#2753, c_address_prf#2745 AS c_address_prf_1#2754, c_mktsegment_prf#2746 AS c_mktsegment_prf_1#2755, c_phone_prf#2747 AS c_phone_prf_1#2756]
            :     :  +- Relation[c_acctbal_prf#2739,rid#2740,c_name_prf#2741,c_nationkey_prf#2742,c_custkey_prf#2743,c_comment_prf#2744,c_address_prf#2745,c_mktsegment_prf#2746,c_phone_prf#2747] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2758 AS o_shippriority_prf_2#2768, rid#2759 AS rid_2#2769, o_orderdate_prf#2760 AS o_orderdate_prf_2#2770, o_custkey_prf#2761 AS o_custkey_prf_2#2771, o_orderpriority_prf#2762 AS o_orderpriority_prf_2#2772, o_clerk_prf#2763 AS o_clerk_prf_2#2773, o_orderstatus_prf#2764 AS o_orderstatus_prf_2#2774, o_totalprice_prf#2765 AS o_totalprice_prf_2#2775, o_orderkey_prf#2766 AS o_orderkey_prf_2#2776, o_comment_prf#2767 AS o_comment_prf_2#2777]
               +- Relation[o_shippriority_prf#2758,rid#2759,o_orderdate_prf#2760,o_custkey_prf#2761,o_orderpriority_prf#2762,o_clerk_prf#2763,o_orderstatus_prf#2764,o_totalprice_prf#2765,o_orderkey_prf#2766,o_comment_prf#2767] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 157098ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/14 10:21:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:21:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2828L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 10:21:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2828L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#2830 AS p_comment_prf_0#2840, p_name_prf#2831 AS p_name_prf_0#2841, rid#2832 AS rid_0#2842, p_type_prf#2833 AS p_type_prf_0#2843, p_retailprice_prf#2834 AS p_retailprice_prf_0#2844, p_mfgr_prf#2835 AS p_mfgr_prf_0#2845, p_container_prf#2836 AS p_container_prf_0#2846, p_brand_prf#2837 AS p_brand_prf_0#2847, p_size_prf#2838 AS p_size_prf_0#2848, p_partkey_prf#2839 AS p_partkey_prf_0#2849]
         :  +- Relation[p_comment_prf#2830,p_name_prf#2831,rid#2832,p_type_prf#2833,p_retailprice_prf#2834,p_mfgr_prf#2835,p_container_prf#2836,p_brand_prf#2837,p_size_prf#2838,p_partkey_prf#2839] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2850]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1766,value#1767] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1451
Elapsed time: 91ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/14 10:21:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:21:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2880L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 10:21:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2880L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#2882 AS l_returnflag_prf_0#2901, l_orderkey_and_l_linenumber_prf#2883 AS l_orderkey_and_l_linenumber_prf_0#2902, l_comment_prf#2884 AS l_comment_prf_0#2903, l_linestatus_prf#2885 AS l_linestatus_prf_0#2904, rid#2886 AS rid_0#2905, l_shipmode_prf#2887 AS l_shipmode_prf_0#2906, l_shipinstruct_prf#2888 AS l_shipinstruct_prf_0#2907, l_quantity_prf#2889 AS l_quantity_prf_0#2908, l_receiptdate_prf#2890 AS l_receiptdate_prf_0#2909, l_linenumber_prf#2891 AS l_linenumber_prf_0#2910, l_tax_prf#2892 AS l_tax_prf_0#2911, l_shipdate_prf#2893 AS l_shipdate_prf_0#2912, l_extendedprice_prf#2894 AS l_extendedprice_prf_0#2913, l_partkey_prf#2895 AS l_partkey_prf_0#2914, l_discount_prf#2896 AS l_discount_prf_0#2915, l_partkey_and_l_suppkey_prf#2897 AS l_partkey_and_l_suppkey_prf_0#2916, l_commitdate_prf#2898 AS l_commitdate_prf_0#2917, l_suppkey_prf#2899 AS l_suppkey_prf_0#2918, l_orderkey_prf#2900 AS l_orderkey_prf_0#2919]
         :  +- Relation[l_returnflag_prf#2882,l_orderkey_and_l_linenumber_prf#2883,l_comment_prf#2884,l_linestatus_prf#2885,rid#2886,l_shipmode_prf#2887,l_shipinstruct_prf#2888,l_quantity_prf#2889,l_receiptdate_prf#2890,l_linenumber_prf#2891,l_tax_prf#2892,l_shipdate_prf#2893,l_extendedprice_prf#2894,l_partkey_prf#2895,l_discount_prf#2896,l_partkey_and_l_suppkey_prf#2897,l_commitdate_prf#2898,l_suppkey_prf#2899,l_orderkey_prf#2900] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2920]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1766,value#1767] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 13680ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/14 10:22:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:22:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2975L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 10:22:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2975L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#2997]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2989: string
         :     :  :     :- Project [p_comment_prf#2977 AS p_comment_prf_0#2987, p_name_prf#2978 AS p_name_prf_0#2988, rid#2979 AS rid_0#2989, p_type_prf#2980 AS p_type_prf_0#2990, p_retailprice_prf#2981 AS p_retailprice_prf_0#2991, p_mfgr_prf#2982 AS p_mfgr_prf_0#2992, p_container_prf#2983 AS p_container_prf_0#2993, p_brand_prf#2984 AS p_brand_prf_0#2994, p_size_prf#2985 AS p_size_prf_0#2995, p_partkey_prf#2986 AS p_partkey_prf_0#2996]
         :     :  :     :  +- Relation[p_comment_prf#2977,p_name_prf#2978,rid#2979,p_type_prf#2980,p_retailprice_prf#2981,p_mfgr_prf#2982,p_container_prf#2983,p_brand_prf#2984,p_size_prf#2985,p_partkey_prf#2986] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#2998 AS l_returnflag_prf_1#3017, l_orderkey_and_l_linenumber_prf#2999 AS l_orderkey_and_l_linenumber_prf_1#3018, l_comment_prf#3000 AS l_comment_prf_1#3019, l_linestatus_prf#3001 AS l_linestatus_prf_1#3020, rid#3002 AS rid_1#3021, l_shipmode_prf#3003 AS l_shipmode_prf_1#3022, l_shipinstruct_prf#3004 AS l_shipinstruct_prf_1#3023, l_quantity_prf#3005 AS l_quantity_prf_1#3024, l_receiptdate_prf#3006 AS l_receiptdate_prf_1#3025, l_linenumber_prf#3007 AS l_linenumber_prf_1#3026, l_tax_prf#3008 AS l_tax_prf_1#3027, l_shipdate_prf#3009 AS l_shipdate_prf_1#3028, l_extendedprice_prf#3010 AS l_extendedprice_prf_1#3029, l_partkey_prf#3011 AS l_partkey_prf_1#3030, l_discount_prf#3012 AS l_discount_prf_1#3031, l_partkey_and_l_suppkey_prf#3013 AS l_partkey_and_l_suppkey_prf_1#3032, l_commitdate_prf#3014 AS l_commitdate_prf_1#3033, l_suppkey_prf#3015 AS l_suppkey_prf_1#3034, l_orderkey_prf#3016 AS l_orderkey_prf_1#3035]
         :     :     +- Relation[l_returnflag_prf#2998,l_orderkey_and_l_linenumber_prf#2999,l_comment_prf#3000,l_linestatus_prf#3001,rid#3002,l_shipmode_prf#3003,l_shipinstruct_prf#3004,l_quantity_prf#3005,l_receiptdate_prf#3006,l_linenumber_prf#3007,l_tax_prf#3008,l_shipdate_prf#3009,l_extendedprice_prf#3010,l_partkey_prf#3011,l_discount_prf#3012,l_partkey_and_l_suppkey_prf#3013,l_commitdate_prf#3014,l_suppkey_prf#3015,l_orderkey_prf#3016] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3037 AS s_phone_prf_2#3045, rid#3038 AS rid_2#3046, s_address_prf#3039 AS s_address_prf_2#3047, s_nationkey_prf#3040 AS s_nationkey_prf_2#3048, s_suppkey_prf#3041 AS s_suppkey_prf_2#3049, s_name_prf#3042 AS s_name_prf_2#3050, s_acctbal_prf#3043 AS s_acctbal_prf_2#3051, s_comment_prf#3044 AS s_comment_prf_2#3052]
            +- Relation[s_phone_prf#3037,rid#3038,s_address_prf#3039,s_nationkey_prf#3040,s_suppkey_prf#3041,s_name_prf#3042,s_acctbal_prf#3043,s_comment_prf#3044] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 289754ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/14 10:26:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:26:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3114L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 10:26:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3114L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#3151]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3130]
         :     :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#3124: string
         :     :  :     :- Project [ps_partkey_and_ps_suppkey_prf#3116 AS ps_partkey_and_ps_suppkey_prf_0#3123, rid#3117 AS rid_0#3124, ps_availqty_prf#3118 AS ps_availqty_prf_0#3125, ps_comment_prf#3119 AS ps_comment_prf_0#3126, ps_partkey_prf#3120 AS ps_partkey_prf_0#3127, ps_supplycost_prf#3121 AS ps_supplycost_prf_0#3128, ps_suppkey_prf#3122 AS ps_suppkey_prf_0#3129]
         :     :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#3116,rid#3117,ps_availqty_prf#3118,ps_comment_prf#3119,ps_partkey_prf#3120,ps_supplycost_prf#3121,ps_suppkey_prf#3122] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#3131 AS p_comment_prf_1#3141, p_name_prf#3132 AS p_name_prf_1#3142, rid#3133 AS rid_1#3143, p_type_prf#3134 AS p_type_prf_1#3144, p_retailprice_prf#3135 AS p_retailprice_prf_1#3145, p_mfgr_prf#3136 AS p_mfgr_prf_1#3146, p_container_prf#3137 AS p_container_prf_1#3147, p_brand_prf#3138 AS p_brand_prf_1#3148, p_size_prf#3139 AS p_size_prf_1#3149, p_partkey_prf#3140 AS p_partkey_prf_1#3150]
         :     :     +- Relation[p_comment_prf#3131,p_name_prf#3132,rid#3133,p_type_prf#3134,p_retailprice_prf#3135,p_mfgr_prf#3136,p_container_prf#3137,p_brand_prf#3138,p_size_prf#3139,p_partkey_prf#3140] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3152 AS s_phone_prf_2#3160, rid#3153 AS rid_2#3161, s_address_prf#3154 AS s_address_prf_2#3162, s_nationkey_prf#3155 AS s_nationkey_prf_2#3163, s_suppkey_prf#3156 AS s_suppkey_prf_2#3164, s_name_prf#3157 AS s_name_prf_2#3165, s_acctbal_prf#3158 AS s_acctbal_prf_2#3166, s_comment_prf#3159 AS s_comment_prf_2#3167]
            +- Relation[s_phone_prf#3152,rid#3153,s_address_prf#3154,s_nationkey_prf#3155,s_suppkey_prf#3156,s_name_prf#3157,s_acctbal_prf#3158,s_comment_prf#3159] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 107196ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/14 10:28:41 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:28:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3229L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 10:28:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3229L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3269]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3254: string
         :     :  :     :- Project [l_returnflag_prf#3231 AS l_returnflag_prf_0#3250, l_orderkey_and_l_linenumber_prf#3232 AS l_orderkey_and_l_linenumber_prf_0#3251, l_comment_prf#3233 AS l_comment_prf_0#3252, l_linestatus_prf#3234 AS l_linestatus_prf_0#3253, rid#3235 AS rid_0#3254, l_shipmode_prf#3236 AS l_shipmode_prf_0#3255, l_shipinstruct_prf#3237 AS l_shipinstruct_prf_0#3256, l_quantity_prf#3238 AS l_quantity_prf_0#3257, l_receiptdate_prf#3239 AS l_receiptdate_prf_0#3258, l_linenumber_prf#3240 AS l_linenumber_prf_0#3259, l_tax_prf#3241 AS l_tax_prf_0#3260, l_shipdate_prf#3242 AS l_shipdate_prf_0#3261, l_extendedprice_prf#3243 AS l_extendedprice_prf_0#3262, l_partkey_prf#3244 AS l_partkey_prf_0#3263, l_discount_prf#3245 AS l_discount_prf_0#3264, l_partkey_and_l_suppkey_prf#3246 AS l_partkey_and_l_suppkey_prf_0#3265, l_commitdate_prf#3247 AS l_commitdate_prf_0#3266, l_suppkey_prf#3248 AS l_suppkey_prf_0#3267, l_orderkey_prf#3249 AS l_orderkey_prf_0#3268]
         :     :  :     :  +- Relation[l_returnflag_prf#3231,l_orderkey_and_l_linenumber_prf#3232,l_comment_prf#3233,l_linestatus_prf#3234,rid#3235,l_shipmode_prf#3236,l_shipinstruct_prf#3237,l_quantity_prf#3238,l_receiptdate_prf#3239,l_linenumber_prf#3240,l_tax_prf#3241,l_shipdate_prf#3242,l_extendedprice_prf#3243,l_partkey_prf#3244,l_discount_prf#3245,l_partkey_and_l_suppkey_prf#3246,l_commitdate_prf#3247,l_suppkey_prf#3248,l_orderkey_prf#3249] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#3270 AS o_shippriority_prf_1#3280, rid#3271 AS rid_1#3281, o_orderdate_prf#3272 AS o_orderdate_prf_1#3282, o_custkey_prf#3273 AS o_custkey_prf_1#3283, o_orderpriority_prf#3274 AS o_orderpriority_prf_1#3284, o_clerk_prf#3275 AS o_clerk_prf_1#3285, o_orderstatus_prf#3276 AS o_orderstatus_prf_1#3286, o_totalprice_prf#3277 AS o_totalprice_prf_1#3287, o_orderkey_prf#3278 AS o_orderkey_prf_1#3288, o_comment_prf#3279 AS o_comment_prf_1#3289]
         :     :     +- Relation[o_shippriority_prf#3270,rid#3271,o_orderdate_prf#3272,o_custkey_prf#3273,o_orderpriority_prf#3274,o_clerk_prf#3275,o_orderstatus_prf#3276,o_totalprice_prf#3277,o_orderkey_prf#3278,o_comment_prf#3279] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3291 AS c_acctbal_prf_2#3300, rid#3292 AS rid_2#3301, c_name_prf#3293 AS c_name_prf_2#3302, c_nationkey_prf#3294 AS c_nationkey_prf_2#3303, c_custkey_prf#3295 AS c_custkey_prf_2#3304, c_comment_prf#3296 AS c_comment_prf_2#3305, c_address_prf#3297 AS c_address_prf_2#3306, c_mktsegment_prf#3298 AS c_mktsegment_prf_2#3307, c_phone_prf#3299 AS c_phone_prf_2#3308]
            +- Relation[c_acctbal_prf#3291,rid#3292,c_name_prf#3293,c_nationkey_prf#3294,c_custkey_prf#3295,c_comment_prf#3296,c_address_prf#3297,c_mktsegment_prf#3298,c_phone_prf#3299] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 335317ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/14 10:34:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:34:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3383L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 10:34:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3383L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_2#3403]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3395: string
         :     :- Project [c_acctbal_prf#3385 AS c_acctbal_prf_0#3394, rid#3386 AS rid_0#3395, c_name_prf#3387 AS c_name_prf_0#3396, c_nationkey_prf#3388 AS c_nationkey_prf_0#3397, c_custkey_prf#3389 AS c_custkey_prf_0#3398, c_comment_prf#3390 AS c_comment_prf_0#3399, c_address_prf#3391 AS c_address_prf_0#3400, c_mktsegment_prf#3392 AS c_mktsegment_prf_0#3401, c_phone_prf#3393 AS c_phone_prf_0#3402]
         :     :  +- Relation[c_acctbal_prf#3385,rid#3386,c_name_prf#3387,c_nationkey_prf#3388,c_custkey_prf#3389,c_comment_prf#3390,c_address_prf#3391,c_mktsegment_prf#3392,c_phone_prf#3393] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#3442]
            :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_1#3427: string
            :     :- Project [l_returnflag_prf#3404 AS l_returnflag_prf_1#3423, l_orderkey_and_l_linenumber_prf#3405 AS l_orderkey_and_l_linenumber_prf_1#3424, l_comment_prf#3406 AS l_comment_prf_1#3425, l_linestatus_prf#3407 AS l_linestatus_prf_1#3426, rid#3408 AS rid_1#3427, l_shipmode_prf#3409 AS l_shipmode_prf_1#3428, l_shipinstruct_prf#3410 AS l_shipinstruct_prf_1#3429, l_quantity_prf#3411 AS l_quantity_prf_1#3430, l_receiptdate_prf#3412 AS l_receiptdate_prf_1#3431, l_linenumber_prf#3413 AS l_linenumber_prf_1#3432, l_tax_prf#3414 AS l_tax_prf_1#3433, l_shipdate_prf#3415 AS l_shipdate_prf_1#3434, l_extendedprice_prf#3416 AS l_extendedprice_prf_1#3435, l_partkey_prf#3417 AS l_partkey_prf_1#3436, l_discount_prf#3418 AS l_discount_prf_1#3437, l_partkey_and_l_suppkey_prf#3419 AS l_partkey_and_l_suppkey_prf_1#3438, l_commitdate_prf#3420 AS l_commitdate_prf_1#3439, l_suppkey_prf#3421 AS l_suppkey_prf_1#3440, l_orderkey_prf#3422 AS l_orderkey_prf_1#3441]
            :     :  +- Relation[l_returnflag_prf#3404,l_orderkey_and_l_linenumber_prf#3405,l_comment_prf#3406,l_linestatus_prf#3407,rid#3408,l_shipmode_prf#3409,l_shipinstruct_prf#3410,l_quantity_prf#3411,l_receiptdate_prf#3412,l_linenumber_prf#3413,l_tax_prf#3414,l_shipdate_prf#3415,l_extendedprice_prf#3416,l_partkey_prf#3417,l_discount_prf#3418,l_partkey_and_l_suppkey_prf#3419,l_commitdate_prf#3420,l_suppkey_prf#3421,l_orderkey_prf#3422] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3443 AS o_shippriority_prf_2#3453, rid#3444 AS rid_2#3454, o_orderdate_prf#3445 AS o_orderdate_prf_2#3455, o_custkey_prf#3446 AS o_custkey_prf_2#3456, o_orderpriority_prf#3447 AS o_orderpriority_prf_2#3457, o_clerk_prf#3448 AS o_clerk_prf_2#3458, o_orderstatus_prf#3449 AS o_orderstatus_prf_2#3459, o_totalprice_prf#3450 AS o_totalprice_prf_2#3460, o_orderkey_prf#3451 AS o_orderkey_prf_2#3461, o_comment_prf#3452 AS o_comment_prf_2#3462]
               +- Relation[o_shippriority_prf#3443,rid#3444,o_orderdate_prf#3445,o_custkey_prf#3446,o_orderpriority_prf#3447,o_clerk_prf#3448,o_orderstatus_prf#3449,o_totalprice_prf#3450,o_orderkey_prf#3451,o_comment_prf#3452] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 157160ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/14 10:36:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:36:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3527L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 10:36:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3527L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3545]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#3538: string
         :     :- Project [s_phone_prf#3529 AS s_phone_prf_0#3537, rid#3530 AS rid_0#3538, s_address_prf#3531 AS s_address_prf_0#3539, s_nationkey_prf#3532 AS s_nationkey_prf_0#3540, s_suppkey_prf#3533 AS s_suppkey_prf_0#3541, s_name_prf#3534 AS s_name_prf_0#3542, s_acctbal_prf#3535 AS s_acctbal_prf_0#3543, s_comment_prf#3536 AS s_comment_prf_0#3544]
         :     :  +- Relation[s_phone_prf#3529,rid#3530,s_address_prf#3531,s_nationkey_prf#3532,s_suppkey_prf#3533,s_name_prf#3534,s_acctbal_prf#3535,s_comment_prf#3536] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3546 AS l_returnflag_prf_1#3565, l_orderkey_and_l_linenumber_prf#3547 AS l_orderkey_and_l_linenumber_prf_1#3566, l_comment_prf#3548 AS l_comment_prf_1#3567, l_linestatus_prf#3549 AS l_linestatus_prf_1#3568, rid#3550 AS rid_1#3569, l_shipmode_prf#3551 AS l_shipmode_prf_1#3570, l_shipinstruct_prf#3552 AS l_shipinstruct_prf_1#3571, l_quantity_prf#3553 AS l_quantity_prf_1#3572, l_receiptdate_prf#3554 AS l_receiptdate_prf_1#3573, l_linenumber_prf#3555 AS l_linenumber_prf_1#3574, l_tax_prf#3556 AS l_tax_prf_1#3575, l_shipdate_prf#3557 AS l_shipdate_prf_1#3576, l_extendedprice_prf#3558 AS l_extendedprice_prf_1#3577, l_partkey_prf#3559 AS l_partkey_prf_1#3578, l_discount_prf#3560 AS l_discount_prf_1#3579, l_partkey_and_l_suppkey_prf#3561 AS l_partkey_and_l_suppkey_prf_1#3580, l_commitdate_prf#3562 AS l_commitdate_prf_1#3581, l_suppkey_prf#3563 AS l_suppkey_prf_1#3582, l_orderkey_prf#3564 AS l_orderkey_prf_1#3583]
            +- Relation[l_returnflag_prf#3546,l_orderkey_and_l_linenumber_prf#3547,l_comment_prf#3548,l_linestatus_prf#3549,rid#3550,l_shipmode_prf#3551,l_shipinstruct_prf#3552,l_quantity_prf#3553,l_receiptdate_prf#3554,l_linenumber_prf#3555,l_tax_prf#3556,l_shipdate_prf#3557,l_extendedprice_prf#3558,l_partkey_prf#3559,l_discount_prf#3560,l_partkey_and_l_suppkey_prf#3561,l_commitdate_prf#3562,l_suppkey_prf#3563,l_orderkey_prf#3564] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 86680ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/14 10:38:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:38:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3639L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 10:38:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3639L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3661]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#3652: string
         :     :- Project [o_shippriority_prf#3641 AS o_shippriority_prf_0#3651, rid#3642 AS rid_0#3652, o_orderdate_prf#3643 AS o_orderdate_prf_0#3653, o_custkey_prf#3644 AS o_custkey_prf_0#3654, o_orderpriority_prf#3645 AS o_orderpriority_prf_0#3655, o_clerk_prf#3646 AS o_clerk_prf_0#3656, o_orderstatus_prf#3647 AS o_orderstatus_prf_0#3657, o_totalprice_prf#3648 AS o_totalprice_prf_0#3658, o_orderkey_prf#3649 AS o_orderkey_prf_0#3659, o_comment_prf#3650 AS o_comment_prf_0#3660]
         :     :  +- Relation[o_shippriority_prf#3641,rid#3642,o_orderdate_prf#3643,o_custkey_prf#3644,o_orderpriority_prf#3645,o_clerk_prf#3646,o_orderstatus_prf#3647,o_totalprice_prf#3648,o_orderkey_prf#3649,o_comment_prf#3650] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3662 AS l_returnflag_prf_1#3681, l_orderkey_and_l_linenumber_prf#3663 AS l_orderkey_and_l_linenumber_prf_1#3682, l_comment_prf#3664 AS l_comment_prf_1#3683, l_linestatus_prf#3665 AS l_linestatus_prf_1#3684, rid#3666 AS rid_1#3685, l_shipmode_prf#3667 AS l_shipmode_prf_1#3686, l_shipinstruct_prf#3668 AS l_shipinstruct_prf_1#3687, l_quantity_prf#3669 AS l_quantity_prf_1#3688, l_receiptdate_prf#3670 AS l_receiptdate_prf_1#3689, l_linenumber_prf#3671 AS l_linenumber_prf_1#3690, l_tax_prf#3672 AS l_tax_prf_1#3691, l_shipdate_prf#3673 AS l_shipdate_prf_1#3692, l_extendedprice_prf#3674 AS l_extendedprice_prf_1#3693, l_partkey_prf#3675 AS l_partkey_prf_1#3694, l_discount_prf#3676 AS l_discount_prf_1#3695, l_partkey_and_l_suppkey_prf#3677 AS l_partkey_and_l_suppkey_prf_1#3696, l_commitdate_prf#3678 AS l_commitdate_prf_1#3697, l_suppkey_prf#3679 AS l_suppkey_prf_1#3698, l_orderkey_prf#3680 AS l_orderkey_prf_1#3699]
            +- Relation[l_returnflag_prf#3662,l_orderkey_and_l_linenumber_prf#3663,l_comment_prf#3664,l_linestatus_prf#3665,rid#3666,l_shipmode_prf#3667,l_shipinstruct_prf#3668,l_quantity_prf#3669,l_receiptdate_prf#3670,l_linenumber_prf#3671,l_tax_prf#3672,l_shipdate_prf#3673,l_extendedprice_prf#3674,l_partkey_prf#3675,l_discount_prf#3676,l_partkey_and_l_suppkey_prf#3677,l_commitdate_prf#3678,l_suppkey_prf#3679,l_orderkey_prf#3680] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 194916ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/14 10:41:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:41:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3757L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 10:41:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3757L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3797]
         :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#3782: string
         :     :- Project [l_returnflag_prf#3759 AS l_returnflag_prf_0#3778, l_orderkey_and_l_linenumber_prf#3760 AS l_orderkey_and_l_linenumber_prf_0#3779, l_comment_prf#3761 AS l_comment_prf_0#3780, l_linestatus_prf#3762 AS l_linestatus_prf_0#3781, rid#3763 AS rid_0#3782, l_shipmode_prf#3764 AS l_shipmode_prf_0#3783, l_shipinstruct_prf#3765 AS l_shipinstruct_prf_0#3784, l_quantity_prf#3766 AS l_quantity_prf_0#3785, l_receiptdate_prf#3767 AS l_receiptdate_prf_0#3786, l_linenumber_prf#3768 AS l_linenumber_prf_0#3787, l_tax_prf#3769 AS l_tax_prf_0#3788, l_shipdate_prf#3770 AS l_shipdate_prf_0#3789, l_extendedprice_prf#3771 AS l_extendedprice_prf_0#3790, l_partkey_prf#3772 AS l_partkey_prf_0#3791, l_discount_prf#3773 AS l_discount_prf_0#3792, l_partkey_and_l_suppkey_prf#3774 AS l_partkey_and_l_suppkey_prf_0#3793, l_commitdate_prf#3775 AS l_commitdate_prf_0#3794, l_suppkey_prf#3776 AS l_suppkey_prf_0#3795, l_orderkey_prf#3777 AS l_orderkey_prf_0#3796]
         :     :  +- Relation[l_returnflag_prf#3759,l_orderkey_and_l_linenumber_prf#3760,l_comment_prf#3761,l_linestatus_prf#3762,rid#3763,l_shipmode_prf#3764,l_shipinstruct_prf#3765,l_quantity_prf#3766,l_receiptdate_prf#3767,l_linenumber_prf#3768,l_tax_prf#3769,l_shipdate_prf#3770,l_extendedprice_prf#3771,l_partkey_prf#3772,l_discount_prf#3773,l_partkey_and_l_suppkey_prf#3774,l_commitdate_prf#3775,l_suppkey_prf#3776,l_orderkey_prf#3777] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#3798 AS p_comment_prf_1#3808, p_name_prf#3799 AS p_name_prf_1#3809, rid#3800 AS rid_1#3810, p_type_prf#3801 AS p_type_prf_1#3811, p_retailprice_prf#3802 AS p_retailprice_prf_1#3812, p_mfgr_prf#3803 AS p_mfgr_prf_1#3813, p_container_prf#3804 AS p_container_prf_1#3814, p_brand_prf#3805 AS p_brand_prf_1#3815, p_size_prf#3806 AS p_size_prf_1#3816, p_partkey_prf#3807 AS p_partkey_prf_1#3817]
            +- Relation[p_comment_prf#3798,p_name_prf#3799,rid#3800,p_type_prf#3801,p_retailprice_prf#3802,p_mfgr_prf#3803,p_container_prf#3804,p_brand_prf#3805,p_size_prf#3806,p_partkey_prf#3807] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 116664ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/14 10:43:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:43:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3883L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 10:43:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3883L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#3924]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3903]
         :     :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3895: string
         :     :  :     :- Project [c_acctbal_prf#3885 AS c_acctbal_prf_0#3894, rid#3886 AS rid_0#3895, c_name_prf#3887 AS c_name_prf_0#3896, c_nationkey_prf#3888 AS c_nationkey_prf_0#3897, c_custkey_prf#3889 AS c_custkey_prf_0#3898, c_comment_prf#3890 AS c_comment_prf_0#3899, c_address_prf#3891 AS c_address_prf_0#3900, c_mktsegment_prf#3892 AS c_mktsegment_prf_0#3901, c_phone_prf#3893 AS c_phone_prf_0#3902]
         :     :  :     :  +- Relation[c_acctbal_prf#3885,rid#3886,c_name_prf#3887,c_nationkey_prf#3888,c_custkey_prf#3889,c_comment_prf#3890,c_address_prf#3891,c_mktsegment_prf#3892,c_phone_prf#3893] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#3904 AS o_shippriority_prf_1#3914, rid#3905 AS rid_1#3915, o_orderdate_prf#3906 AS o_orderdate_prf_1#3916, o_custkey_prf#3907 AS o_custkey_prf_1#3917, o_orderpriority_prf#3908 AS o_orderpriority_prf_1#3918, o_clerk_prf#3909 AS o_clerk_prf_1#3919, o_orderstatus_prf#3910 AS o_orderstatus_prf_1#3920, o_totalprice_prf#3911 AS o_totalprice_prf_1#3921, o_orderkey_prf#3912 AS o_orderkey_prf_1#3922, o_comment_prf#3913 AS o_comment_prf_1#3923]
         :     :     +- Relation[o_shippriority_prf#3904,rid#3905,o_orderdate_prf#3906,o_custkey_prf#3907,o_orderpriority_prf#3908,o_clerk_prf#3909,o_orderstatus_prf#3910,o_totalprice_prf#3911,o_orderkey_prf#3912,o_comment_prf#3913] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3925 AS l_returnflag_prf_2#3944, l_orderkey_and_l_linenumber_prf#3926 AS l_orderkey_and_l_linenumber_prf_2#3945, l_comment_prf#3927 AS l_comment_prf_2#3946, l_linestatus_prf#3928 AS l_linestatus_prf_2#3947, rid#3929 AS rid_2#3948, l_shipmode_prf#3930 AS l_shipmode_prf_2#3949, l_shipinstruct_prf#3931 AS l_shipinstruct_prf_2#3950, l_quantity_prf#3932 AS l_quantity_prf_2#3951, l_receiptdate_prf#3933 AS l_receiptdate_prf_2#3952, l_linenumber_prf#3934 AS l_linenumber_prf_2#3953, l_tax_prf#3935 AS l_tax_prf_2#3954, l_shipdate_prf#3936 AS l_shipdate_prf_2#3955, l_extendedprice_prf#3937 AS l_extendedprice_prf_2#3956, l_partkey_prf#3938 AS l_partkey_prf_2#3957, l_discount_prf#3939 AS l_discount_prf_2#3958, l_partkey_and_l_suppkey_prf#3940 AS l_partkey_and_l_suppkey_prf_2#3959, l_commitdate_prf#3941 AS l_commitdate_prf_2#3960, l_suppkey_prf#3942 AS l_suppkey_prf_2#3961, l_orderkey_prf#3943 AS l_orderkey_prf_2#3962]
            +- Relation[l_returnflag_prf#3925,l_orderkey_and_l_linenumber_prf#3926,l_comment_prf#3927,l_linestatus_prf#3928,rid#3929,l_shipmode_prf#3930,l_shipinstruct_prf#3931,l_quantity_prf#3932,l_receiptdate_prf#3933,l_linenumber_prf#3934,l_tax_prf#3935,l_shipdate_prf#3936,l_extendedprice_prf#3937,l_partkey_prf#3938,l_discount_prf#3939,l_partkey_and_l_suppkey_prf#3940,l_commitdate_prf#3941,l_suppkey_prf#3942,l_orderkey_prf#3943] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 270692ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/14 10:48:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:48:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4008L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 10:48:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4008L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#4010 AS rid_0#4015, n_regionkey_prf#4011 AS n_regionkey_prf_0#4016, n_nationkey_prf#4012 AS n_nationkey_prf_0#4017, n_name_prf#4013 AS n_name_prf_0#4018, n_comment_prf#4014 AS n_comment_prf_0#4019]
         :  +- Relation[rid#4010,n_regionkey_prf#4011,n_nationkey_prf#4012,n_name_prf#4013,n_comment_prf#4014] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4020]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1766,value#1767] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 53ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/14 10:48:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:48:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4054L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 10:48:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4054L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4076]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#4067: string
         :     :- Project [o_shippriority_prf#4056 AS o_shippriority_prf_0#4066, rid#4057 AS rid_0#4067, o_orderdate_prf#4058 AS o_orderdate_prf_0#4068, o_custkey_prf#4059 AS o_custkey_prf_0#4069, o_orderpriority_prf#4060 AS o_orderpriority_prf_0#4070, o_clerk_prf#4061 AS o_clerk_prf_0#4071, o_orderstatus_prf#4062 AS o_orderstatus_prf_0#4072, o_totalprice_prf#4063 AS o_totalprice_prf_0#4073, o_orderkey_prf#4064 AS o_orderkey_prf_0#4074, o_comment_prf#4065 AS o_comment_prf_0#4075]
         :     :  +- Relation[o_shippriority_prf#4056,rid#4057,o_orderdate_prf#4058,o_custkey_prf#4059,o_orderpriority_prf#4060,o_clerk_prf#4061,o_orderstatus_prf#4062,o_totalprice_prf#4063,o_orderkey_prf#4064,o_comment_prf#4065] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#4077 AS l_returnflag_prf_1#4096, l_orderkey_and_l_linenumber_prf#4078 AS l_orderkey_and_l_linenumber_prf_1#4097, l_comment_prf#4079 AS l_comment_prf_1#4098, l_linestatus_prf#4080 AS l_linestatus_prf_1#4099, rid#4081 AS rid_1#4100, l_shipmode_prf#4082 AS l_shipmode_prf_1#4101, l_shipinstruct_prf#4083 AS l_shipinstruct_prf_1#4102, l_quantity_prf#4084 AS l_quantity_prf_1#4103, l_receiptdate_prf#4085 AS l_receiptdate_prf_1#4104, l_linenumber_prf#4086 AS l_linenumber_prf_1#4105, l_tax_prf#4087 AS l_tax_prf_1#4106, l_shipdate_prf#4088 AS l_shipdate_prf_1#4107, l_extendedprice_prf#4089 AS l_extendedprice_prf_1#4108, l_partkey_prf#4090 AS l_partkey_prf_1#4109, l_discount_prf#4091 AS l_discount_prf_1#4110, l_partkey_and_l_suppkey_prf#4092 AS l_partkey_and_l_suppkey_prf_1#4111, l_commitdate_prf#4093 AS l_commitdate_prf_1#4112, l_suppkey_prf#4094 AS l_suppkey_prf_1#4113, l_orderkey_prf#4095 AS l_orderkey_prf_1#4114]
            :  +- Relation[l_returnflag_prf#4077,l_orderkey_and_l_linenumber_prf#4078,l_comment_prf#4079,l_linestatus_prf#4080,rid#4081,l_shipmode_prf#4082,l_shipinstruct_prf#4083,l_quantity_prf#4084,l_receiptdate_prf#4085,l_linenumber_prf#4086,l_tax_prf#4087,l_shipdate_prf#4088,l_extendedprice_prf#4089,l_partkey_prf#4090,l_discount_prf#4091,l_partkey_and_l_suppkey_prf#4092,l_commitdate_prf#4093,l_suppkey_prf#4094,l_orderkey_prf#4095] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4115]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1766,value#1767] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 197140ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/14 10:51:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:51:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4180L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 10:51:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4180L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_2#4198]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#4191: string
         :     :- Project [s_phone_prf#4182 AS s_phone_prf_0#4190, rid#4183 AS rid_0#4191, s_address_prf#4184 AS s_address_prf_0#4192, s_nationkey_prf#4185 AS s_nationkey_prf_0#4193, s_suppkey_prf#4186 AS s_suppkey_prf_0#4194, s_name_prf#4187 AS s_name_prf_0#4195, s_acctbal_prf#4188 AS s_acctbal_prf_0#4196, s_comment_prf#4189 AS s_comment_prf_0#4197]
         :     :  +- Relation[s_phone_prf#4182,rid#4183,s_address_prf#4184,s_nationkey_prf#4185,s_suppkey_prf#4186,s_name_prf#4187,s_acctbal_prf#4188,s_comment_prf#4189] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#4219]
            :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#4211: string
            :     :- Project [p_comment_prf#4199 AS p_comment_prf_1#4209, p_name_prf#4200 AS p_name_prf_1#4210, rid#4201 AS rid_1#4211, p_type_prf#4202 AS p_type_prf_1#4212, p_retailprice_prf#4203 AS p_retailprice_prf_1#4213, p_mfgr_prf#4204 AS p_mfgr_prf_1#4214, p_container_prf#4205 AS p_container_prf_1#4215, p_brand_prf#4206 AS p_brand_prf_1#4216, p_size_prf#4207 AS p_size_prf_1#4217, p_partkey_prf#4208 AS p_partkey_prf_1#4218]
            :     :  +- Relation[p_comment_prf#4199,p_name_prf#4200,rid#4201,p_type_prf#4202,p_retailprice_prf#4203,p_mfgr_prf#4204,p_container_prf#4205,p_brand_prf#4206,p_size_prf#4207,p_partkey_prf#4208] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4220 AS l_returnflag_prf_2#4239, l_orderkey_and_l_linenumber_prf#4221 AS l_orderkey_and_l_linenumber_prf_2#4240, l_comment_prf#4222 AS l_comment_prf_2#4241, l_linestatus_prf#4223 AS l_linestatus_prf_2#4242, rid#4224 AS rid_2#4243, l_shipmode_prf#4225 AS l_shipmode_prf_2#4244, l_shipinstruct_prf#4226 AS l_shipinstruct_prf_2#4245, l_quantity_prf#4227 AS l_quantity_prf_2#4246, l_receiptdate_prf#4228 AS l_receiptdate_prf_2#4247, l_linenumber_prf#4229 AS l_linenumber_prf_2#4248, l_tax_prf#4230 AS l_tax_prf_2#4249, l_shipdate_prf#4231 AS l_shipdate_prf_2#4250, l_extendedprice_prf#4232 AS l_extendedprice_prf_2#4251, l_partkey_prf#4233 AS l_partkey_prf_2#4252, l_discount_prf#4234 AS l_discount_prf_2#4253, l_partkey_and_l_suppkey_prf#4235 AS l_partkey_and_l_suppkey_prf_2#4254, l_commitdate_prf#4236 AS l_commitdate_prf_2#4255, l_suppkey_prf#4237 AS l_suppkey_prf_2#4256, l_orderkey_prf#4238 AS l_orderkey_prf_2#4257]
               +- Relation[l_returnflag_prf#4220,l_orderkey_and_l_linenumber_prf#4221,l_comment_prf#4222,l_linestatus_prf#4223,rid#4224,l_shipmode_prf#4225,l_shipinstruct_prf#4226,l_quantity_prf#4227,l_receiptdate_prf#4228,l_linenumber_prf#4229,l_tax_prf#4230,l_shipdate_prf#4231,l_extendedprice_prf#4232,l_partkey_prf#4233,l_discount_prf#4234,l_partkey_and_l_suppkey_prf#4235,l_commitdate_prf#4236,l_suppkey_prf#4237,l_orderkey_prf#4238] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 187287ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/14 10:54:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:54:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4315L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 10:54:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4315L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4335]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4327: string
         :     :- Project [c_acctbal_prf#4317 AS c_acctbal_prf_0#4326, rid#4318 AS rid_0#4327, c_name_prf#4319 AS c_name_prf_0#4328, c_nationkey_prf#4320 AS c_nationkey_prf_0#4329, c_custkey_prf#4321 AS c_custkey_prf_0#4330, c_comment_prf#4322 AS c_comment_prf_0#4331, c_address_prf#4323 AS c_address_prf_0#4332, c_mktsegment_prf#4324 AS c_mktsegment_prf_0#4333, c_phone_prf#4325 AS c_phone_prf_0#4334]
         :     :  +- Relation[c_acctbal_prf#4317,rid#4318,c_name_prf#4319,c_nationkey_prf#4320,c_custkey_prf#4321,c_comment_prf#4322,c_address_prf#4323,c_mktsegment_prf#4324,c_phone_prf#4325] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4336 AS o_shippriority_prf_1#4346, rid#4337 AS rid_1#4347, o_orderdate_prf#4338 AS o_orderdate_prf_1#4348, o_custkey_prf#4339 AS o_custkey_prf_1#4349, o_orderpriority_prf#4340 AS o_orderpriority_prf_1#4350, o_clerk_prf#4341 AS o_clerk_prf_1#4351, o_orderstatus_prf#4342 AS o_orderstatus_prf_1#4352, o_totalprice_prf#4343 AS o_totalprice_prf_1#4353, o_orderkey_prf#4344 AS o_orderkey_prf_1#4354, o_comment_prf#4345 AS o_comment_prf_1#4355]
            +- Relation[o_shippriority_prf#4336,rid#4337,o_orderdate_prf#4338,o_custkey_prf#4339,o_orderpriority_prf#4340,o_clerk_prf#4341,o_orderstatus_prf#4342,o_totalprice_prf#4343,o_orderkey_prf#4344,o_comment_prf#4345] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1500000
Elapsed time: 40054ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/14 10:55:07 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:55:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4399L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 10:55:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4399L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4417]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#4410: string
         :     :- Project [s_phone_prf#4401 AS s_phone_prf_0#4409, rid#4402 AS rid_0#4410, s_address_prf#4403 AS s_address_prf_0#4411, s_nationkey_prf#4404 AS s_nationkey_prf_0#4412, s_suppkey_prf#4405 AS s_suppkey_prf_0#4413, s_name_prf#4406 AS s_name_prf_0#4414, s_acctbal_prf#4407 AS s_acctbal_prf_0#4415, s_comment_prf#4408 AS s_comment_prf_0#4416]
         :     :  +- Relation[s_phone_prf#4401,rid#4402,s_address_prf#4403,s_nationkey_prf#4404,s_suppkey_prf#4405,s_name_prf#4406,s_acctbal_prf#4407,s_comment_prf#4408] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#4432]
            :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_1#4426: string
            :     :- Project [ps_partkey_and_ps_suppkey_prf#4418 AS ps_partkey_and_ps_suppkey_prf_1#4425, rid#4419 AS rid_1#4426, ps_availqty_prf#4420 AS ps_availqty_prf_1#4427, ps_comment_prf#4421 AS ps_comment_prf_1#4428, ps_partkey_prf#4422 AS ps_partkey_prf_1#4429, ps_supplycost_prf#4423 AS ps_supplycost_prf_1#4430, ps_suppkey_prf#4424 AS ps_suppkey_prf_1#4431]
            :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#4418,rid#4419,ps_availqty_prf#4420,ps_comment_prf#4421,ps_partkey_prf#4422,ps_supplycost_prf#4423,ps_suppkey_prf#4424] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#4433 AS p_comment_prf_2#4443, p_name_prf#4434 AS p_name_prf_2#4444, rid#4435 AS rid_2#4445, p_type_prf#4436 AS p_type_prf_2#4446, p_retailprice_prf#4437 AS p_retailprice_prf_2#4447, p_mfgr_prf#4438 AS p_mfgr_prf_2#4448, p_container_prf#4439 AS p_container_prf_2#4449, p_brand_prf#4440 AS p_brand_prf_2#4450, p_size_prf#4441 AS p_size_prf_2#4451, p_partkey_prf#4442 AS p_partkey_prf_2#4452]
               +- Relation[p_comment_prf#4433,p_name_prf#4434,rid#4435,p_type_prf#4436,p_retailprice_prf#4437,p_mfgr_prf#4438,p_container_prf#4439,p_brand_prf#4440,p_size_prf#4441,p_partkey_prf#4442] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 61166ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/14 10:56:08 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:56:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4497L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 10:56:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4497L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#4499 AS l_returnflag_prf_0#4518, l_orderkey_and_l_linenumber_prf#4500 AS l_orderkey_and_l_linenumber_prf_0#4519, l_comment_prf#4501 AS l_comment_prf_0#4520, l_linestatus_prf#4502 AS l_linestatus_prf_0#4521, rid#4503 AS rid_0#4522, l_shipmode_prf#4504 AS l_shipmode_prf_0#4523, l_shipinstruct_prf#4505 AS l_shipinstruct_prf_0#4524, l_quantity_prf#4506 AS l_quantity_prf_0#4525, l_receiptdate_prf#4507 AS l_receiptdate_prf_0#4526, l_linenumber_prf#4508 AS l_linenumber_prf_0#4527, l_tax_prf#4509 AS l_tax_prf_0#4528, l_shipdate_prf#4510 AS l_shipdate_prf_0#4529, l_extendedprice_prf#4511 AS l_extendedprice_prf_0#4530, l_partkey_prf#4512 AS l_partkey_prf_0#4531, l_discount_prf#4513 AS l_discount_prf_0#4532, l_partkey_and_l_suppkey_prf#4514 AS l_partkey_and_l_suppkey_prf_0#4533, l_commitdate_prf#4515 AS l_commitdate_prf_0#4534, l_suppkey_prf#4516 AS l_suppkey_prf_0#4535, l_orderkey_prf#4517 AS l_orderkey_prf_0#4536]
         :  +- Relation[l_returnflag_prf#4499,l_orderkey_and_l_linenumber_prf#4500,l_comment_prf#4501,l_linestatus_prf#4502,rid#4503,l_shipmode_prf#4504,l_shipinstruct_prf#4505,l_quantity_prf#4506,l_receiptdate_prf#4507,l_linenumber_prf#4508,l_tax_prf#4509,l_shipdate_prf#4510,l_extendedprice_prf#4511,l_partkey_prf#4512,l_discount_prf#4513,l_partkey_and_l_suppkey_prf#4514,l_commitdate_prf#4515,l_suppkey_prf#4516,l_orderkey_prf#4517] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4537]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1766,value#1767] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 23424ms

f2=
select * from part where p_size = 15
19/10/14 10:56:31 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:56:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4569L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 10:56:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4569L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#4571 AS p_comment_prf_0#4581, p_name_prf#4572 AS p_name_prf_0#4582, rid#4573 AS rid_0#4583, p_type_prf#4574 AS p_type_prf_0#4584, p_retailprice_prf#4575 AS p_retailprice_prf_0#4585, p_mfgr_prf#4576 AS p_mfgr_prf_0#4586, p_container_prf#4577 AS p_container_prf_0#4587, p_brand_prf#4578 AS p_brand_prf_0#4588, p_size_prf#4579 AS p_size_prf_0#4589, p_partkey_prf#4580 AS p_partkey_prf_0#4590]
         :  +- Relation[p_comment_prf#4571,p_name_prf#4572,rid#4573,p_type_prf#4574,p_retailprice_prf#4575,p_mfgr_prf#4576,p_container_prf#4577,p_brand_prf#4578,p_size_prf#4579,p_partkey_prf#4580] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4591]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1766,value#1767] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3907
Elapsed time: 126ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/14 10:56:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 10:56:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4638L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 10:56:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4638L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4658]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4650: string
         :     :- Project [c_acctbal_prf#4640 AS c_acctbal_prf_0#4649, rid#4641 AS rid_0#4650, c_name_prf#4642 AS c_name_prf_0#4651, c_nationkey_prf#4643 AS c_nationkey_prf_0#4652, c_custkey_prf#4644 AS c_custkey_prf_0#4653, c_comment_prf#4645 AS c_comment_prf_0#4654, c_address_prf#4646 AS c_address_prf_0#4655, c_mktsegment_prf#4647 AS c_mktsegment_prf_0#4656, c_phone_prf#4648 AS c_phone_prf_0#4657]
         :     :  +- Relation[c_acctbal_prf#4640,rid#4641,c_name_prf#4642,c_nationkey_prf#4643,c_custkey_prf#4644,c_comment_prf#4645,c_address_prf#4646,c_mktsegment_prf#4647,c_phone_prf#4648] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#4679]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#4670: string
            :     :- Project [o_shippriority_prf#4659 AS o_shippriority_prf_1#4669, rid#4660 AS rid_1#4670, o_orderdate_prf#4661 AS o_orderdate_prf_1#4671, o_custkey_prf#4662 AS o_custkey_prf_1#4672, o_orderpriority_prf#4663 AS o_orderpriority_prf_1#4673, o_clerk_prf#4664 AS o_clerk_prf_1#4674, o_orderstatus_prf#4665 AS o_orderstatus_prf_1#4675, o_totalprice_prf#4666 AS o_totalprice_prf_1#4676, o_orderkey_prf#4667 AS o_orderkey_prf_1#4677, o_comment_prf#4668 AS o_comment_prf_1#4678]
            :     :  +- Relation[o_shippriority_prf#4659,rid#4660,o_orderdate_prf#4661,o_custkey_prf#4662,o_orderpriority_prf#4663,o_clerk_prf#4664,o_orderstatus_prf#4665,o_totalprice_prf#4666,o_orderkey_prf#4667,o_comment_prf#4668] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4680 AS l_returnflag_prf_2#4699, l_orderkey_and_l_linenumber_prf#4681 AS l_orderkey_and_l_linenumber_prf_2#4700, l_comment_prf#4682 AS l_comment_prf_2#4701, l_linestatus_prf#4683 AS l_linestatus_prf_2#4702, rid#4684 AS rid_2#4703, l_shipmode_prf#4685 AS l_shipmode_prf_2#4704, l_shipinstruct_prf#4686 AS l_shipinstruct_prf_2#4705, l_quantity_prf#4687 AS l_quantity_prf_2#4706, l_receiptdate_prf#4688 AS l_receiptdate_prf_2#4707, l_linenumber_prf#4689 AS l_linenumber_prf_2#4708, l_tax_prf#4690 AS l_tax_prf_2#4709, l_shipdate_prf#4691 AS l_shipdate_prf_2#4710, l_extendedprice_prf#4692 AS l_extendedprice_prf_2#4711, l_partkey_prf#4693 AS l_partkey_prf_2#4712, l_discount_prf#4694 AS l_discount_prf_2#4713, l_partkey_and_l_suppkey_prf#4695 AS l_partkey_and_l_suppkey_prf_2#4714, l_commitdate_prf#4696 AS l_commitdate_prf_2#4715, l_suppkey_prf#4697 AS l_suppkey_prf_2#4716, l_orderkey_prf#4698 AS l_orderkey_prf_2#4717]
               +- Relation[l_returnflag_prf#4680,l_orderkey_and_l_linenumber_prf#4681,l_comment_prf#4682,l_linestatus_prf#4683,rid#4684,l_shipmode_prf#4685,l_shipinstruct_prf#4686,l_quantity_prf#4687,l_receiptdate_prf#4688,l_linenumber_prf#4689,l_tax_prf#4690,l_shipdate_prf#4691,l_extendedprice_prf#4692,l_partkey_prf#4693,l_discount_prf#4694,l_partkey_and_l_suppkey_prf#4695,l_commitdate_prf#4696,l_suppkey_prf#4697,l_orderkey_prf#4698] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 234050ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/14 11:00:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 11:00:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4773L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 11:00:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4773L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4795]
         :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4787: string
         :     :- Project [p_comment_prf#4775 AS p_comment_prf_0#4785, p_name_prf#4776 AS p_name_prf_0#4786, rid#4777 AS rid_0#4787, p_type_prf#4778 AS p_type_prf_0#4788, p_retailprice_prf#4779 AS p_retailprice_prf_0#4789, p_mfgr_prf#4780 AS p_mfgr_prf_0#4790, p_container_prf#4781 AS p_container_prf_0#4791, p_brand_prf#4782 AS p_brand_prf_0#4792, p_size_prf#4783 AS p_size_prf_0#4793, p_partkey_prf#4784 AS p_partkey_prf_0#4794]
         :     :  +- Relation[p_comment_prf#4775,p_name_prf#4776,rid#4777,p_type_prf#4778,p_retailprice_prf#4779,p_mfgr_prf#4780,p_container_prf#4781,p_brand_prf#4782,p_size_prf#4783,p_partkey_prf#4784] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4796 AS ps_partkey_and_ps_suppkey_prf_1#4803, rid#4797 AS rid_1#4804, ps_availqty_prf#4798 AS ps_availqty_prf_1#4805, ps_comment_prf#4799 AS ps_comment_prf_1#4806, ps_partkey_prf#4800 AS ps_partkey_prf_1#4807, ps_supplycost_prf#4801 AS ps_supplycost_prf_1#4808, ps_suppkey_prf#4802 AS ps_suppkey_prf_1#4809]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4796,rid#4797,ps_availqty_prf#4798,ps_comment_prf#4799,ps_partkey_prf#4800,ps_supplycost_prf#4801,ps_suppkey_prf#4802] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 31635ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/14 11:00:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 11:00:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4851L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 11:00:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4851L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#4888]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4873]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4865: string
         :     :  :     :- Project [p_comment_prf#4853 AS p_comment_prf_0#4863, p_name_prf#4854 AS p_name_prf_0#4864, rid#4855 AS rid_0#4865, p_type_prf#4856 AS p_type_prf_0#4866, p_retailprice_prf#4857 AS p_retailprice_prf_0#4867, p_mfgr_prf#4858 AS p_mfgr_prf_0#4868, p_container_prf#4859 AS p_container_prf_0#4869, p_brand_prf#4860 AS p_brand_prf_0#4870, p_size_prf#4861 AS p_size_prf_0#4871, p_partkey_prf#4862 AS p_partkey_prf_0#4872]
         :     :  :     :  +- Relation[p_comment_prf#4853,p_name_prf#4854,rid#4855,p_type_prf#4856,p_retailprice_prf#4857,p_mfgr_prf#4858,p_container_prf#4859,p_brand_prf#4860,p_size_prf#4861,p_partkey_prf#4862] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#4874 AS ps_partkey_and_ps_suppkey_prf_1#4881, rid#4875 AS rid_1#4882, ps_availqty_prf#4876 AS ps_availqty_prf_1#4883, ps_comment_prf#4877 AS ps_comment_prf_1#4884, ps_partkey_prf#4878 AS ps_partkey_prf_1#4885, ps_supplycost_prf#4879 AS ps_supplycost_prf_1#4886, ps_suppkey_prf#4880 AS ps_suppkey_prf_1#4887]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#4874,rid#4875,ps_availqty_prf#4876,ps_comment_prf#4877,ps_partkey_prf#4878,ps_supplycost_prf#4879,ps_suppkey_prf#4880] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4889 AS s_phone_prf_2#4897, rid#4890 AS rid_2#4898, s_address_prf#4891 AS s_address_prf_2#4899, s_nationkey_prf#4892 AS s_nationkey_prf_2#4900, s_suppkey_prf#4893 AS s_suppkey_prf_2#4901, s_name_prf#4894 AS s_name_prf_2#4902, s_acctbal_prf#4895 AS s_acctbal_prf_2#4903, s_comment_prf#4896 AS s_comment_prf_2#4904]
            +- Relation[s_phone_prf#4889,rid#4890,s_address_prf#4891,s_nationkey_prf#4892,s_suppkey_prf#4893,s_name_prf#4894,s_acctbal_prf#4895,s_comment_prf#4896] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 88598ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/14 11:02:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 11:02:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4952L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 11:02:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4952L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#4981]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4970]
         :     :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#4963: string
         :     :  :     :- Project [s_phone_prf#4954 AS s_phone_prf_0#4962, rid#4955 AS rid_0#4963, s_address_prf#4956 AS s_address_prf_0#4964, s_nationkey_prf#4957 AS s_nationkey_prf_0#4965, s_suppkey_prf#4958 AS s_suppkey_prf_0#4966, s_name_prf#4959 AS s_name_prf_0#4967, s_acctbal_prf#4960 AS s_acctbal_prf_0#4968, s_comment_prf#4961 AS s_comment_prf_0#4969]
         :     :  :     :  +- Relation[s_phone_prf#4954,rid#4955,s_address_prf#4956,s_nationkey_prf#4957,s_suppkey_prf#4958,s_name_prf#4959,s_acctbal_prf#4960,s_comment_prf#4961] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [rid#4971 AS rid_1#4976, n_regionkey_prf#4972 AS n_regionkey_prf_1#4977, n_nationkey_prf#4973 AS n_nationkey_prf_1#4978, n_name_prf#4974 AS n_name_prf_1#4979, n_comment_prf#4975 AS n_comment_prf_1#4980]
         :     :     +- Relation[rid#4971,n_regionkey_prf#4972,n_nationkey_prf#4973,n_name_prf#4974,n_comment_prf#4975] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4982 AS c_acctbal_prf_2#4991, rid#4983 AS rid_2#4992, c_name_prf#4984 AS c_name_prf_2#4993, c_nationkey_prf#4985 AS c_nationkey_prf_2#4994, c_custkey_prf#4986 AS c_custkey_prf_2#4995, c_comment_prf#4987 AS c_comment_prf_2#4996, c_address_prf#4988 AS c_address_prf_2#4997, c_mktsegment_prf#4989 AS c_mktsegment_prf_2#4998, c_phone_prf#4990 AS c_phone_prf_2#4999]
            +- Relation[c_acctbal_prf#4982,rid#4983,c_name_prf#4984,c_nationkey_prf#4985,c_custkey_prf#4986,c_comment_prf#4987,c_address_prf#4988,c_mktsegment_prf#4989,c_phone_prf#4990] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 660317ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/14 11:13:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 11:13:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5046L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 11:13:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5046L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_2#5064]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#5057: string
         :     :- Project [s_phone_prf#5048 AS s_phone_prf_0#5056, rid#5049 AS rid_0#5057, s_address_prf#5050 AS s_address_prf_0#5058, s_nationkey_prf#5051 AS s_nationkey_prf_0#5059, s_suppkey_prf#5052 AS s_suppkey_prf_0#5060, s_name_prf#5053 AS s_name_prf_0#5061, s_acctbal_prf#5054 AS s_acctbal_prf_0#5062, s_comment_prf#5055 AS s_comment_prf_0#5063]
         :     :  +- Relation[s_phone_prf#5048,rid#5049,s_address_prf#5050,s_nationkey_prf#5051,s_suppkey_prf#5052,s_name_prf#5053,s_acctbal_prf#5054,s_comment_prf#5055] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#5085]
            :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#5077: string
            :     :- Project [p_comment_prf#5065 AS p_comment_prf_1#5075, p_name_prf#5066 AS p_name_prf_1#5076, rid#5067 AS rid_1#5077, p_type_prf#5068 AS p_type_prf_1#5078, p_retailprice_prf#5069 AS p_retailprice_prf_1#5079, p_mfgr_prf#5070 AS p_mfgr_prf_1#5080, p_container_prf#5071 AS p_container_prf_1#5081, p_brand_prf#5072 AS p_brand_prf_1#5082, p_size_prf#5073 AS p_size_prf_1#5083, p_partkey_prf#5074 AS p_partkey_prf_1#5084]
            :     :  +- Relation[p_comment_prf#5065,p_name_prf#5066,rid#5067,p_type_prf#5068,p_retailprice_prf#5069,p_mfgr_prf#5070,p_container_prf#5071,p_brand_prf#5072,p_size_prf#5073,p_partkey_prf#5074] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#5086 AS ps_partkey_and_ps_suppkey_prf_2#5093, rid#5087 AS rid_2#5094, ps_availqty_prf#5088 AS ps_availqty_prf_2#5095, ps_comment_prf#5089 AS ps_comment_prf_2#5096, ps_partkey_prf#5090 AS ps_partkey_prf_2#5097, ps_supplycost_prf#5091 AS ps_supplycost_prf_2#5098, ps_suppkey_prf#5092 AS ps_suppkey_prf_2#5099]
               +- Relation[ps_partkey_and_ps_suppkey_prf#5086,rid#5087,ps_availqty_prf#5088,ps_comment_prf#5089,ps_partkey_prf#5090,ps_supplycost_prf#5091,ps_suppkey_prf#5092] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 42901ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/14 11:14:09 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 11:14:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5153L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 11:14:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5153L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#5193]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#5178: string
         :     :- Project [l_returnflag_prf#5155 AS l_returnflag_prf_0#5174, l_orderkey_and_l_linenumber_prf#5156 AS l_orderkey_and_l_linenumber_prf_0#5175, l_comment_prf#5157 AS l_comment_prf_0#5176, l_linestatus_prf#5158 AS l_linestatus_prf_0#5177, rid#5159 AS rid_0#5178, l_shipmode_prf#5160 AS l_shipmode_prf_0#5179, l_shipinstruct_prf#5161 AS l_shipinstruct_prf_0#5180, l_quantity_prf#5162 AS l_quantity_prf_0#5181, l_receiptdate_prf#5163 AS l_receiptdate_prf_0#5182, l_linenumber_prf#5164 AS l_linenumber_prf_0#5183, l_tax_prf#5165 AS l_tax_prf_0#5184, l_shipdate_prf#5166 AS l_shipdate_prf_0#5185, l_extendedprice_prf#5167 AS l_extendedprice_prf_0#5186, l_partkey_prf#5168 AS l_partkey_prf_0#5187, l_discount_prf#5169 AS l_discount_prf_0#5188, l_partkey_and_l_suppkey_prf#5170 AS l_partkey_and_l_suppkey_prf_0#5189, l_commitdate_prf#5171 AS l_commitdate_prf_0#5190, l_suppkey_prf#5172 AS l_suppkey_prf_0#5191, l_orderkey_prf#5173 AS l_orderkey_prf_0#5192]
         :     :  +- Relation[l_returnflag_prf#5155,l_orderkey_and_l_linenumber_prf#5156,l_comment_prf#5157,l_linestatus_prf#5158,rid#5159,l_shipmode_prf#5160,l_shipinstruct_prf#5161,l_quantity_prf#5162,l_receiptdate_prf#5163,l_linenumber_prf#5164,l_tax_prf#5165,l_shipdate_prf#5166,l_extendedprice_prf#5167,l_partkey_prf#5168,l_discount_prf#5169,l_partkey_and_l_suppkey_prf#5170,l_commitdate_prf#5171,l_suppkey_prf#5172,l_orderkey_prf#5173] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#5194 AS o_shippriority_prf_1#5204, rid#5195 AS rid_1#5205, o_orderdate_prf#5196 AS o_orderdate_prf_1#5206, o_custkey_prf#5197 AS o_custkey_prf_1#5207, o_orderpriority_prf#5198 AS o_orderpriority_prf_1#5208, o_clerk_prf#5199 AS o_clerk_prf_1#5209, o_orderstatus_prf#5200 AS o_orderstatus_prf_1#5210, o_totalprice_prf#5201 AS o_totalprice_prf_1#5211, o_orderkey_prf#5202 AS o_orderkey_prf_1#5212, o_comment_prf#5203 AS o_comment_prf_1#5213]
            +- Relation[o_shippriority_prf#5194,rid#5195,o_orderdate_prf#5196,o_custkey_prf#5197,o_orderpriority_prf#5198,o_clerk_prf#5199,o_orderstatus_prf#5200,o_totalprice_prf#5201,o_orderkey_prf#5202,o_comment_prf#5203] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 115042ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/14 11:16:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 11:16:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5257L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 11:16:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5257L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#5269]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#5264: string
         :     :- Project [rid#5259 AS rid_0#5264, n_regionkey_prf#5260 AS n_regionkey_prf_0#5265, n_nationkey_prf#5261 AS n_nationkey_prf_0#5266, n_name_prf#5262 AS n_name_prf_0#5267, n_comment_prf#5263 AS n_comment_prf_0#5268]
         :     :  +- Relation[rid#5259,n_regionkey_prf#5260,n_nationkey_prf#5261,n_name_prf#5262,n_comment_prf#5263] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5270 AS s_phone_prf_1#5278, rid#5271 AS rid_1#5279, s_address_prf#5272 AS s_address_prf_1#5280, s_nationkey_prf#5273 AS s_nationkey_prf_1#5281, s_suppkey_prf#5274 AS s_suppkey_prf_1#5282, s_name_prf#5275 AS s_name_prf_1#5283, s_acctbal_prf#5276 AS s_acctbal_prf_1#5284, s_comment_prf#5277 AS s_comment_prf_1#5285]
            +- Relation[s_phone_prf#5270,rid#5271,s_address_prf#5272,s_nationkey_prf#5273,s_suppkey_prf#5274,s_name_prf#5275,s_acctbal_prf#5276,s_comment_prf#5277] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=10000
Elapsed time: 187ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/14 11:16:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 11:16:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5327L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 11:16:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5327L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#5349]
         :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#5341: string
         :     :- Project [p_comment_prf#5329 AS p_comment_prf_0#5339, p_name_prf#5330 AS p_name_prf_0#5340, rid#5331 AS rid_0#5341, p_type_prf#5332 AS p_type_prf_0#5342, p_retailprice_prf#5333 AS p_retailprice_prf_0#5343, p_mfgr_prf#5334 AS p_mfgr_prf_0#5344, p_container_prf#5335 AS p_container_prf_0#5345, p_brand_prf#5336 AS p_brand_prf_0#5346, p_size_prf#5337 AS p_size_prf_0#5347, p_partkey_prf#5338 AS p_partkey_prf_0#5348]
         :     :  +- Relation[p_comment_prf#5329,p_name_prf#5330,rid#5331,p_type_prf#5332,p_retailprice_prf#5333,p_mfgr_prf#5334,p_container_prf#5335,p_brand_prf#5336,p_size_prf#5337,p_partkey_prf#5338] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5350 AS l_returnflag_prf_1#5369, l_orderkey_and_l_linenumber_prf#5351 AS l_orderkey_and_l_linenumber_prf_1#5370, l_comment_prf#5352 AS l_comment_prf_1#5371, l_linestatus_prf#5353 AS l_linestatus_prf_1#5372, rid#5354 AS rid_1#5373, l_shipmode_prf#5355 AS l_shipmode_prf_1#5374, l_shipinstruct_prf#5356 AS l_shipinstruct_prf_1#5375, l_quantity_prf#5357 AS l_quantity_prf_1#5376, l_receiptdate_prf#5358 AS l_receiptdate_prf_1#5377, l_linenumber_prf#5359 AS l_linenumber_prf_1#5378, l_tax_prf#5360 AS l_tax_prf_1#5379, l_shipdate_prf#5361 AS l_shipdate_prf_1#5380, l_extendedprice_prf#5362 AS l_extendedprice_prf_1#5381, l_partkey_prf#5363 AS l_partkey_prf_1#5382, l_discount_prf#5364 AS l_discount_prf_1#5383, l_partkey_and_l_suppkey_prf#5365 AS l_partkey_and_l_suppkey_prf_1#5384, l_commitdate_prf#5366 AS l_commitdate_prf_1#5385, l_suppkey_prf#5367 AS l_suppkey_prf_1#5386, l_orderkey_prf#5368 AS l_orderkey_prf_1#5387]
            +- Relation[l_returnflag_prf#5350,l_orderkey_and_l_linenumber_prf#5351,l_comment_prf#5352,l_linestatus_prf#5353,rid#5354,l_shipmode_prf#5355,l_shipinstruct_prf#5356,l_quantity_prf#5357,l_receiptdate_prf#5358,l_linenumber_prf#5359,l_tax_prf#5360,l_shipdate_prf#5361,l_extendedprice_prf#5362,l_partkey_prf#5363,l_discount_prf#5364,l_partkey_and_l_suppkey_prf#5365,l_commitdate_prf#5366,l_suppkey_prf#5367,l_orderkey_prf#5368] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 94952ms
query=b1a, count=15628, duration=405
query=b1b, count=15628, duration=49895
query=b2a, count=1478870, duration=197140
query=b2b, count=1478870, duration=54360
query=f1, count=1, duration=53
query=f2, count=3907, duration=126
query=f3, count=1451, duration=91
query=f4, count=1, duration=53
query=f5, count=1478870, duration=23424
query=f6, count=857401, duration=13680
query=j1, count=800000, duration=31635
query=j10, count=6001215, duration=86680
query=j2, count=800000, duration=10952
query=j3, count=25, duration=68
query=j4, count=150000, duration=1917
query=j5, count=10000, duration=187
query=j6, count=6001215, duration=118641
query=j7, count=1500000, duration=40054
query=j8, count=6001215, duration=194916
query=j8b, count=6001215, duration=115042
query=j9, count=6001215, duration=94952
query=j9b, count=6001215, duration=116664
query=r1a, count=6001215, duration=335317
query=r1b, count=6001215, duration=149091
query=r1c, count=6001215, duration=157098
query=r1d, count=6001215, duration=270692
query=r1e, count=6001215, duration=234050
query=r1f, count=6001215, duration=157160
query=t1a, count=60000414, duration=660317
query=t1b, count=60000414, duration=767454
query=t1c, count=60000414, duration=85446
query=t2a, count=800000, duration=107196
query=t2b, count=800000, duration=88598
query=t2c, count=800000, duration=42901
query=t2d, count=800000, duration=61166
query=t3a, count=6001215, duration=263118
query=t3b, count=6001215, duration=289754
query=t3c, count=6001215, duration=187287
query=t3d, count=6001215, duration=186274
