19/10/14 14:10:44 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7109ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Mon Oct 14 14:10:47 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Mon Oct 14 14:10:48 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Mon Oct 14 14:10:48 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Mon Oct 14 14:10:48 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Mon Oct 14 14:10:48 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Mon Oct 14 14:10:50 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Mon Oct 14 14:10:53 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Mon Oct 14 14:10:53 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/14 14:10:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:10:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1487L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 14:10:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1487L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#1489 AS l_returnflag_prf_0#1508, l_orderkey_and_l_linenumber_prf#1490 AS l_orderkey_and_l_linenumber_prf_0#1509, l_comment_prf#1491 AS l_comment_prf_0#1510, l_linestatus_prf#1492 AS l_linestatus_prf_0#1511, rid#1493 AS rid_0#1512, l_shipmode_prf#1494 AS l_shipmode_prf_0#1513, l_shipinstruct_prf#1495 AS l_shipinstruct_prf_0#1514, l_quantity_prf#1496 AS l_quantity_prf_0#1515, l_receiptdate_prf#1497 AS l_receiptdate_prf_0#1516, l_linenumber_prf#1498 AS l_linenumber_prf_0#1517, l_tax_prf#1499 AS l_tax_prf_0#1518, l_shipdate_prf#1500 AS l_shipdate_prf_0#1519, l_extendedprice_prf#1501 AS l_extendedprice_prf_0#1520, l_partkey_prf#1502 AS l_partkey_prf_0#1521, l_discount_prf#1503 AS l_discount_prf_0#1522, l_partkey_and_l_suppkey_prf#1504 AS l_partkey_and_l_suppkey_prf_0#1523, l_commitdate_prf#1505 AS l_commitdate_prf_0#1524, l_suppkey_prf#1506 AS l_suppkey_prf_0#1525, l_orderkey_prf#1507 AS l_orderkey_prf_0#1526]
         :  +- Relation[l_returnflag_prf#1489,l_orderkey_and_l_linenumber_prf#1490,l_comment_prf#1491,l_linestatus_prf#1492,rid#1493,l_shipmode_prf#1494,l_shipinstruct_prf#1495,l_quantity_prf#1496,l_receiptdate_prf#1497,l_linenumber_prf#1498,l_tax_prf#1499,l_shipdate_prf#1500,l_extendedprice_prf#1501,l_partkey_prf#1502,l_discount_prf#1503,l_partkey_and_l_suppkey_prf#1504,l_commitdate_prf#1505,l_suppkey_prf#1506,l_orderkey_prf#1507] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1529]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 13960ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/14 14:11:08 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:11:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1571L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 14:11:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1571L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1584) AS rid_2#1602]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#1585]
         :     :  :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#1578: string
         :     :  :     :- Project [rid#1573 AS rid_0#1578, n_regionkey_prf#1574 AS n_regionkey_prf_0#1579, n_nationkey_prf#1575 AS n_nationkey_prf_0#1580, n_name_prf#1576 AS n_name_prf_0#1581, n_comment_prf#1577 AS n_comment_prf_0#1582]
         :     :  :     :  +- Relation[rid#1573,n_regionkey_prf#1574,n_nationkey_prf#1575,n_name_prf#1576,n_comment_prf#1577] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#1586 AS s_phone_prf_1#1594, rid#1587 AS rid_1#1595, s_address_prf#1588 AS s_address_prf_1#1596, s_nationkey_prf#1589 AS s_nationkey_prf_1#1597, s_suppkey_prf#1590 AS s_suppkey_prf_1#1598, s_name_prf#1591 AS s_name_prf_1#1599, s_acctbal_prf#1592 AS s_acctbal_prf_1#1600, s_comment_prf#1593 AS s_comment_prf_1#1601]
         :     :     +- Relation[s_phone_prf#1586,rid#1587,s_address_prf#1588,s_nationkey_prf#1589,s_suppkey_prf#1590,s_name_prf#1591,s_acctbal_prf#1592,s_comment_prf#1593] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#1603 AS c_acctbal_prf_2#1612, rid#1604 AS rid_2#1613, c_name_prf#1605 AS c_name_prf_2#1614, c_nationkey_prf#1606 AS c_nationkey_prf_2#1615, c_custkey_prf#1607 AS c_custkey_prf_2#1616, c_comment_prf#1608 AS c_comment_prf_2#1617, c_address_prf#1609 AS c_address_prf_2#1618, c_mktsegment_prf#1610 AS c_mktsegment_prf_2#1619, c_phone_prf#1611 AS c_phone_prf_2#1620]
            +- Relation[c_acctbal_prf#1603,rid#1604,c_name_prf#1605,c_nationkey_prf#1606,c_custkey_prf#1607,c_comment_prf#1608,c_address_prf#1609,c_mktsegment_prf#1610,c_phone_prf#1611] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 774931ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/14 14:24:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:24:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1678L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 14:24:03 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
19/10/14 14:24:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1678L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#1700]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#1692: string
         :     :  :     :- Project [p_comment_prf#1680 AS p_comment_prf_0#1690, p_name_prf#1681 AS p_name_prf_0#1691, rid#1682 AS rid_0#1692, p_type_prf#1683 AS p_type_prf_0#1693, p_retailprice_prf#1684 AS p_retailprice_prf_0#1694, p_mfgr_prf#1685 AS p_mfgr_prf_0#1695, p_container_prf#1686 AS p_container_prf_0#1696, p_brand_prf#1687 AS p_brand_prf_0#1697, p_size_prf#1688 AS p_size_prf_0#1698, p_partkey_prf#1689 AS p_partkey_prf_0#1699]
         :     :  :     :  +- Relation[p_comment_prf#1680,p_name_prf#1681,rid#1682,p_type_prf#1683,p_retailprice_prf#1684,p_mfgr_prf#1685,p_container_prf#1686,p_brand_prf#1687,p_size_prf#1688,p_partkey_prf#1689] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#1701 AS l_returnflag_prf_1#1720, l_orderkey_and_l_linenumber_prf#1702 AS l_orderkey_and_l_linenumber_prf_1#1721, l_comment_prf#1703 AS l_comment_prf_1#1722, l_linestatus_prf#1704 AS l_linestatus_prf_1#1723, rid#1705 AS rid_1#1724, l_shipmode_prf#1706 AS l_shipmode_prf_1#1725, l_shipinstruct_prf#1707 AS l_shipinstruct_prf_1#1726, l_quantity_prf#1708 AS l_quantity_prf_1#1727, l_receiptdate_prf#1709 AS l_receiptdate_prf_1#1728, l_linenumber_prf#1710 AS l_linenumber_prf_1#1729, l_tax_prf#1711 AS l_tax_prf_1#1730, l_shipdate_prf#1712 AS l_shipdate_prf_1#1731, l_extendedprice_prf#1713 AS l_extendedprice_prf_1#1732, l_partkey_prf#1714 AS l_partkey_prf_1#1733, l_discount_prf#1715 AS l_discount_prf_1#1734, l_partkey_and_l_suppkey_prf#1716 AS l_partkey_and_l_suppkey_prf_1#1735, l_commitdate_prf#1717 AS l_commitdate_prf_1#1736, l_suppkey_prf#1718 AS l_suppkey_prf_1#1737, l_orderkey_prf#1719 AS l_orderkey_prf_1#1738]
         :     :     +- Relation[l_returnflag_prf#1701,l_orderkey_and_l_linenumber_prf#1702,l_comment_prf#1703,l_linestatus_prf#1704,rid#1705,l_shipmode_prf#1706,l_shipinstruct_prf#1707,l_quantity_prf#1708,l_receiptdate_prf#1709,l_linenumber_prf#1710,l_tax_prf#1711,l_shipdate_prf#1712,l_extendedprice_prf#1713,l_partkey_prf#1714,l_discount_prf#1715,l_partkey_and_l_suppkey_prf#1716,l_commitdate_prf#1717,l_suppkey_prf#1718,l_orderkey_prf#1719] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#1740 AS s_phone_prf_2#1748, rid#1741 AS rid_2#1749, s_address_prf#1742 AS s_address_prf_2#1750, s_nationkey_prf#1743 AS s_nationkey_prf_2#1751, s_suppkey_prf#1744 AS s_suppkey_prf_2#1752, s_name_prf#1745 AS s_name_prf_2#1753, s_acctbal_prf#1746 AS s_acctbal_prf_2#1754, s_comment_prf#1747 AS s_comment_prf_2#1755]
            +- Relation[s_phone_prf#1740,rid#1741,s_address_prf#1742,s_nationkey_prf#1743,s_suppkey_prf#1744,s_name_prf#1745,s_acctbal_prf#1746,s_comment_prf#1747] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 289855ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/14 14:28:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:28:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1829L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 14:28:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1829L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_2#1869]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#1854: string
         :     :- Project [l_returnflag_prf#1831 AS l_returnflag_prf_0#1850, l_orderkey_and_l_linenumber_prf#1832 AS l_orderkey_and_l_linenumber_prf_0#1851, l_comment_prf#1833 AS l_comment_prf_0#1852, l_linestatus_prf#1834 AS l_linestatus_prf_0#1853, rid#1835 AS rid_0#1854, l_shipmode_prf#1836 AS l_shipmode_prf_0#1855, l_shipinstruct_prf#1837 AS l_shipinstruct_prf_0#1856, l_quantity_prf#1838 AS l_quantity_prf_0#1857, l_receiptdate_prf#1839 AS l_receiptdate_prf_0#1858, l_linenumber_prf#1840 AS l_linenumber_prf_0#1859, l_tax_prf#1841 AS l_tax_prf_0#1860, l_shipdate_prf#1842 AS l_shipdate_prf_0#1861, l_extendedprice_prf#1843 AS l_extendedprice_prf_0#1862, l_partkey_prf#1844 AS l_partkey_prf_0#1863, l_discount_prf#1845 AS l_discount_prf_0#1864, l_partkey_and_l_suppkey_prf#1846 AS l_partkey_and_l_suppkey_prf_0#1865, l_commitdate_prf#1847 AS l_commitdate_prf_0#1866, l_suppkey_prf#1848 AS l_suppkey_prf_0#1867, l_orderkey_prf#1849 AS l_orderkey_prf_0#1868]
         :     :  +- Relation[l_returnflag_prf#1831,l_orderkey_and_l_linenumber_prf#1832,l_comment_prf#1833,l_linestatus_prf#1834,rid#1835,l_shipmode_prf#1836,l_shipinstruct_prf#1837,l_quantity_prf#1838,l_receiptdate_prf#1839,l_linenumber_prf#1840,l_tax_prf#1841,l_shipdate_prf#1842,l_extendedprice_prf#1843,l_partkey_prf#1844,l_discount_prf#1845,l_partkey_and_l_suppkey_prf#1846,l_commitdate_prf#1847,l_suppkey_prf#1848,l_orderkey_prf#1849] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1584) AS rid_2#1888]
            :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#1880: string
            :     :- Project [c_acctbal_prf#1870 AS c_acctbal_prf_1#1879, rid#1871 AS rid_1#1880, c_name_prf#1872 AS c_name_prf_1#1881, c_nationkey_prf#1873 AS c_nationkey_prf_1#1882, c_custkey_prf#1874 AS c_custkey_prf_1#1883, c_comment_prf#1875 AS c_comment_prf_1#1884, c_address_prf#1876 AS c_address_prf_1#1885, c_mktsegment_prf#1877 AS c_mktsegment_prf_1#1886, c_phone_prf#1878 AS c_phone_prf_1#1887]
            :     :  +- Relation[c_acctbal_prf#1870,rid#1871,c_name_prf#1872,c_nationkey_prf#1873,c_custkey_prf#1874,c_comment_prf#1875,c_address_prf#1876,c_mktsegment_prf#1877,c_phone_prf#1878] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#1889 AS o_shippriority_prf_2#1899, rid#1890 AS rid_2#1900, o_orderdate_prf#1891 AS o_orderdate_prf_2#1901, o_custkey_prf#1892 AS o_custkey_prf_2#1902, o_orderpriority_prf#1893 AS o_orderpriority_prf_2#1903, o_clerk_prf#1894 AS o_clerk_prf_2#1904, o_orderstatus_prf#1895 AS o_orderstatus_prf_2#1905, o_totalprice_prf#1896 AS o_totalprice_prf_2#1906, o_orderkey_prf#1897 AS o_orderkey_prf_2#1907, o_comment_prf#1898 AS o_comment_prf_2#1908]
               +- Relation[o_shippriority_prf#1889,rid#1890,o_orderdate_prf#1891,o_custkey_prf#1892,o_orderpriority_prf#1893,o_clerk_prf#1894,o_orderstatus_prf#1895,o_totalprice_prf#1896,o_orderkey_prf#1897,o_comment_prf#1898] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 157715ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/14 14:31:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:31:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1983L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 14:31:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1983L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1584) AS rid_2#2024]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#2003]
         :     :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#1995: string
         :     :  :     :- Project [c_acctbal_prf#1985 AS c_acctbal_prf_0#1994, rid#1986 AS rid_0#1995, c_name_prf#1987 AS c_name_prf_0#1996, c_nationkey_prf#1988 AS c_nationkey_prf_0#1997, c_custkey_prf#1989 AS c_custkey_prf_0#1998, c_comment_prf#1990 AS c_comment_prf_0#1999, c_address_prf#1991 AS c_address_prf_0#2000, c_mktsegment_prf#1992 AS c_mktsegment_prf_0#2001, c_phone_prf#1993 AS c_phone_prf_0#2002]
         :     :  :     :  +- Relation[c_acctbal_prf#1985,rid#1986,c_name_prf#1987,c_nationkey_prf#1988,c_custkey_prf#1989,c_comment_prf#1990,c_address_prf#1991,c_mktsegment_prf#1992,c_phone_prf#1993] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#2004 AS o_shippriority_prf_1#2014, rid#2005 AS rid_1#2015, o_orderdate_prf#2006 AS o_orderdate_prf_1#2016, o_custkey_prf#2007 AS o_custkey_prf_1#2017, o_orderpriority_prf#2008 AS o_orderpriority_prf_1#2018, o_clerk_prf#2009 AS o_clerk_prf_1#2019, o_orderstatus_prf#2010 AS o_orderstatus_prf_1#2020, o_totalprice_prf#2011 AS o_totalprice_prf_1#2021, o_orderkey_prf#2012 AS o_orderkey_prf_1#2022, o_comment_prf#2013 AS o_comment_prf_1#2023]
         :     :     +- Relation[o_shippriority_prf#2004,rid#2005,o_orderdate_prf#2006,o_custkey_prf#2007,o_orderpriority_prf#2008,o_clerk_prf#2009,o_orderstatus_prf#2010,o_totalprice_prf#2011,o_orderkey_prf#2012,o_comment_prf#2013] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2025 AS l_returnflag_prf_2#2044, l_orderkey_and_l_linenumber_prf#2026 AS l_orderkey_and_l_linenumber_prf_2#2045, l_comment_prf#2027 AS l_comment_prf_2#2046, l_linestatus_prf#2028 AS l_linestatus_prf_2#2047, rid#2029 AS rid_2#2048, l_shipmode_prf#2030 AS l_shipmode_prf_2#2049, l_shipinstruct_prf#2031 AS l_shipinstruct_prf_2#2050, l_quantity_prf#2032 AS l_quantity_prf_2#2051, l_receiptdate_prf#2033 AS l_receiptdate_prf_2#2052, l_linenumber_prf#2034 AS l_linenumber_prf_2#2053, l_tax_prf#2035 AS l_tax_prf_2#2054, l_shipdate_prf#2036 AS l_shipdate_prf_2#2055, l_extendedprice_prf#2037 AS l_extendedprice_prf_2#2056, l_partkey_prf#2038 AS l_partkey_prf_2#2057, l_discount_prf#2039 AS l_discount_prf_2#2058, l_partkey_and_l_suppkey_prf#2040 AS l_partkey_and_l_suppkey_prf_2#2059, l_commitdate_prf#2041 AS l_commitdate_prf_2#2060, l_suppkey_prf#2042 AS l_suppkey_prf_2#2061, l_orderkey_prf#2043 AS l_orderkey_prf_2#2062]
            +- Relation[l_returnflag_prf#2025,l_orderkey_and_l_linenumber_prf#2026,l_comment_prf#2027,l_linestatus_prf#2028,rid#2029,l_shipmode_prf#2030,l_shipinstruct_prf#2031,l_quantity_prf#2032,l_receiptdate_prf#2033,l_linenumber_prf#2034,l_tax_prf#2035,l_shipdate_prf#2036,l_extendedprice_prf#2037,l_partkey_prf#2038,l_discount_prf#2039,l_partkey_and_l_suppkey_prf#2040,l_commitdate_prf#2041,l_suppkey_prf#2042,l_orderkey_prf#2043] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 269782ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/14 14:36:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:36:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2118L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 14:36:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2118L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#2134]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#2128: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#2120 AS ps_partkey_and_ps_suppkey_prf_0#2127, rid#2121 AS rid_0#2128, ps_availqty_prf#2122 AS ps_availqty_prf_0#2129, ps_comment_prf#2123 AS ps_comment_prf_0#2130, ps_partkey_prf#2124 AS ps_partkey_prf_0#2131, ps_supplycost_prf#2125 AS ps_supplycost_prf_0#2132, ps_suppkey_prf#2126 AS ps_suppkey_prf_0#2133]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2120,rid#2121,ps_availqty_prf#2122,ps_comment_prf#2123,ps_partkey_prf#2124,ps_supplycost_prf#2125,ps_suppkey_prf#2126] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#2135 AS p_comment_prf_1#2145, p_name_prf#2136 AS p_name_prf_1#2146, rid#2137 AS rid_1#2147, p_type_prf#2138 AS p_type_prf_1#2148, p_retailprice_prf#2139 AS p_retailprice_prf_1#2149, p_mfgr_prf#2140 AS p_mfgr_prf_1#2150, p_container_prf#2141 AS p_container_prf_1#2151, p_brand_prf#2142 AS p_brand_prf_1#2152, p_size_prf#2143 AS p_size_prf_1#2153, p_partkey_prf#2144 AS p_partkey_prf_1#2154]
            :  +- Relation[p_comment_prf#2135,p_name_prf#2136,rid#2137,p_type_prf#2138,p_retailprice_prf#2139,p_mfgr_prf#2140,p_container_prf#2141,p_brand_prf#2142,p_size_prf#2143,p_partkey_prf#2144] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2155]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 49382ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/14 14:36:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:36:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2192L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 14:36:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2192L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#2194 AS l_returnflag_prf_0#2213, l_orderkey_and_l_linenumber_prf#2195 AS l_orderkey_and_l_linenumber_prf_0#2214, l_comment_prf#2196 AS l_comment_prf_0#2215, l_linestatus_prf#2197 AS l_linestatus_prf_0#2216, rid#2198 AS rid_0#2217, l_shipmode_prf#2199 AS l_shipmode_prf_0#2218, l_shipinstruct_prf#2200 AS l_shipinstruct_prf_0#2219, l_quantity_prf#2201 AS l_quantity_prf_0#2220, l_receiptdate_prf#2202 AS l_receiptdate_prf_0#2221, l_linenumber_prf#2203 AS l_linenumber_prf_0#2222, l_tax_prf#2204 AS l_tax_prf_0#2223, l_shipdate_prf#2205 AS l_shipdate_prf_0#2224, l_extendedprice_prf#2206 AS l_extendedprice_prf_0#2225, l_partkey_prf#2207 AS l_partkey_prf_0#2226, l_discount_prf#2208 AS l_discount_prf_0#2227, l_partkey_and_l_suppkey_prf#2209 AS l_partkey_and_l_suppkey_prf_0#2228, l_commitdate_prf#2210 AS l_commitdate_prf_0#2229, l_suppkey_prf#2211 AS l_suppkey_prf_0#2230, l_orderkey_prf#2212 AS l_orderkey_prf_0#2231]
         :  +- Relation[l_returnflag_prf#2194,l_orderkey_and_l_linenumber_prf#2195,l_comment_prf#2196,l_linestatus_prf#2197,rid#2198,l_shipmode_prf#2199,l_shipinstruct_prf#2200,l_quantity_prf#2201,l_receiptdate_prf#2202,l_linenumber_prf#2203,l_tax_prf#2204,l_shipdate_prf#2205,l_extendedprice_prf#2206,l_partkey_prf#2207,l_discount_prf#2208,l_partkey_and_l_suppkey_prf#2209,l_commitdate_prf#2210,l_suppkey_prf#2211,l_orderkey_prf#2212] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2232]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 23419ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/14 14:37:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:37:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2288L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 14:37:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2288L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_2#2308]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2300: string
         :     :- Project [c_acctbal_prf#2290 AS c_acctbal_prf_0#2299, rid#2291 AS rid_0#2300, c_name_prf#2292 AS c_name_prf_0#2301, c_nationkey_prf#2293 AS c_nationkey_prf_0#2302, c_custkey_prf#2294 AS c_custkey_prf_0#2303, c_comment_prf#2295 AS c_comment_prf_0#2304, c_address_prf#2296 AS c_address_prf_0#2305, c_mktsegment_prf#2297 AS c_mktsegment_prf_0#2306, c_phone_prf#2298 AS c_phone_prf_0#2307]
         :     :  +- Relation[c_acctbal_prf#2290,rid#2291,c_name_prf#2292,c_nationkey_prf#2293,c_custkey_prf#2294,c_comment_prf#2295,c_address_prf#2296,c_mktsegment_prf#2297,c_phone_prf#2298] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1584) AS rid_2#2347]
            :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_1#2332: string
            :     :- Project [l_returnflag_prf#2309 AS l_returnflag_prf_1#2328, l_orderkey_and_l_linenumber_prf#2310 AS l_orderkey_and_l_linenumber_prf_1#2329, l_comment_prf#2311 AS l_comment_prf_1#2330, l_linestatus_prf#2312 AS l_linestatus_prf_1#2331, rid#2313 AS rid_1#2332, l_shipmode_prf#2314 AS l_shipmode_prf_1#2333, l_shipinstruct_prf#2315 AS l_shipinstruct_prf_1#2334, l_quantity_prf#2316 AS l_quantity_prf_1#2335, l_receiptdate_prf#2317 AS l_receiptdate_prf_1#2336, l_linenumber_prf#2318 AS l_linenumber_prf_1#2337, l_tax_prf#2319 AS l_tax_prf_1#2338, l_shipdate_prf#2320 AS l_shipdate_prf_1#2339, l_extendedprice_prf#2321 AS l_extendedprice_prf_1#2340, l_partkey_prf#2322 AS l_partkey_prf_1#2341, l_discount_prf#2323 AS l_discount_prf_1#2342, l_partkey_and_l_suppkey_prf#2324 AS l_partkey_and_l_suppkey_prf_1#2343, l_commitdate_prf#2325 AS l_commitdate_prf_1#2344, l_suppkey_prf#2326 AS l_suppkey_prf_1#2345, l_orderkey_prf#2327 AS l_orderkey_prf_1#2346]
            :     :  +- Relation[l_returnflag_prf#2309,l_orderkey_and_l_linenumber_prf#2310,l_comment_prf#2311,l_linestatus_prf#2312,rid#2313,l_shipmode_prf#2314,l_shipinstruct_prf#2315,l_quantity_prf#2316,l_receiptdate_prf#2317,l_linenumber_prf#2318,l_tax_prf#2319,l_shipdate_prf#2320,l_extendedprice_prf#2321,l_partkey_prf#2322,l_discount_prf#2323,l_partkey_and_l_suppkey_prf#2324,l_commitdate_prf#2325,l_suppkey_prf#2326,l_orderkey_prf#2327] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2348 AS o_shippriority_prf_2#2358, rid#2349 AS rid_2#2359, o_orderdate_prf#2350 AS o_orderdate_prf_2#2360, o_custkey_prf#2351 AS o_custkey_prf_2#2361, o_orderpriority_prf#2352 AS o_orderpriority_prf_2#2362, o_clerk_prf#2353 AS o_clerk_prf_2#2363, o_orderstatus_prf#2354 AS o_orderstatus_prf_2#2364, o_totalprice_prf#2355 AS o_totalprice_prf_2#2365, o_orderkey_prf#2356 AS o_orderkey_prf_2#2366, o_comment_prf#2357 AS o_comment_prf_2#2367]
               +- Relation[o_shippriority_prf#2348,rid#2349,o_orderdate_prf#2350,o_custkey_prf#2351,o_orderpriority_prf#2352,o_clerk_prf#2353,o_orderstatus_prf#2354,o_totalprice_prf#2355,o_orderkey_prf#2356,o_comment_prf#2357] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 157443ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/14 14:39:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:39:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2442L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 14:39:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2442L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#2482]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2467: string
         :     :- Project [l_returnflag_prf#2444 AS l_returnflag_prf_0#2463, l_orderkey_and_l_linenumber_prf#2445 AS l_orderkey_and_l_linenumber_prf_0#2464, l_comment_prf#2446 AS l_comment_prf_0#2465, l_linestatus_prf#2447 AS l_linestatus_prf_0#2466, rid#2448 AS rid_0#2467, l_shipmode_prf#2449 AS l_shipmode_prf_0#2468, l_shipinstruct_prf#2450 AS l_shipinstruct_prf_0#2469, l_quantity_prf#2451 AS l_quantity_prf_0#2470, l_receiptdate_prf#2452 AS l_receiptdate_prf_0#2471, l_linenumber_prf#2453 AS l_linenumber_prf_0#2472, l_tax_prf#2454 AS l_tax_prf_0#2473, l_shipdate_prf#2455 AS l_shipdate_prf_0#2474, l_extendedprice_prf#2456 AS l_extendedprice_prf_0#2475, l_partkey_prf#2457 AS l_partkey_prf_0#2476, l_discount_prf#2458 AS l_discount_prf_0#2477, l_partkey_and_l_suppkey_prf#2459 AS l_partkey_and_l_suppkey_prf_0#2478, l_commitdate_prf#2460 AS l_commitdate_prf_0#2479, l_suppkey_prf#2461 AS l_suppkey_prf_0#2480, l_orderkey_prf#2462 AS l_orderkey_prf_0#2481]
         :     :  +- Relation[l_returnflag_prf#2444,l_orderkey_and_l_linenumber_prf#2445,l_comment_prf#2446,l_linestatus_prf#2447,rid#2448,l_shipmode_prf#2449,l_shipinstruct_prf#2450,l_quantity_prf#2451,l_receiptdate_prf#2452,l_linenumber_prf#2453,l_tax_prf#2454,l_shipdate_prf#2455,l_extendedprice_prf#2456,l_partkey_prf#2457,l_discount_prf#2458,l_partkey_and_l_suppkey_prf#2459,l_commitdate_prf#2460,l_suppkey_prf#2461,l_orderkey_prf#2462] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1584) AS rid_2#2503]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#2494: string
            :     :- Project [o_shippriority_prf#2483 AS o_shippriority_prf_1#2493, rid#2484 AS rid_1#2494, o_orderdate_prf#2485 AS o_orderdate_prf_1#2495, o_custkey_prf#2486 AS o_custkey_prf_1#2496, o_orderpriority_prf#2487 AS o_orderpriority_prf_1#2497, o_clerk_prf#2488 AS o_clerk_prf_1#2498, o_orderstatus_prf#2489 AS o_orderstatus_prf_1#2499, o_totalprice_prf#2490 AS o_totalprice_prf_1#2500, o_orderkey_prf#2491 AS o_orderkey_prf_1#2501, o_comment_prf#2492 AS o_comment_prf_1#2502]
            :     :  +- Relation[o_shippriority_prf#2483,rid#2484,o_orderdate_prf#2485,o_custkey_prf#2486,o_orderpriority_prf#2487,o_clerk_prf#2488,o_orderstatus_prf#2489,o_totalprice_prf#2490,o_orderkey_prf#2491,o_comment_prf#2492] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#2504 AS c_acctbal_prf_2#2513, rid#2505 AS rid_2#2514, c_name_prf#2506 AS c_name_prf_2#2515, c_nationkey_prf#2507 AS c_nationkey_prf_2#2516, c_custkey_prf#2508 AS c_custkey_prf_2#2517, c_comment_prf#2509 AS c_comment_prf_2#2518, c_address_prf#2510 AS c_address_prf_2#2519, c_mktsegment_prf#2511 AS c_mktsegment_prf_2#2520, c_phone_prf#2512 AS c_phone_prf_2#2521]
               +- Relation[c_acctbal_prf#2504,rid#2505,c_name_prf#2506,c_nationkey_prf#2507,c_custkey_prf#2508,c_comment_prf#2509,c_address_prf#2510,c_mktsegment_prf#2511,c_phone_prf#2512] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 148597ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/14 14:42:19 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:42:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2577L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 14:42:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2577L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#2600]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2591: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#2579 AS p_comment_prf_0#2589, p_name_prf#2580 AS p_name_prf_0#2590, rid#2581 AS rid_0#2591, p_type_prf#2582 AS p_type_prf_0#2592, p_retailprice_prf#2583 AS p_retailprice_prf_0#2593, p_mfgr_prf#2584 AS p_mfgr_prf_0#2594, p_container_prf#2585 AS p_container_prf_0#2595, p_brand_prf#2586 AS p_brand_prf_0#2596, p_size_prf#2587 AS p_size_prf_0#2597, p_partkey_prf#2588 AS p_partkey_prf_0#2598]
         :     :  :  +- Relation[p_comment_prf#2579,p_name_prf#2580,rid#2581,p_type_prf#2582,p_retailprice_prf#2583,p_mfgr_prf#2584,p_container_prf#2585,p_brand_prf#2586,p_size_prf#2587,p_partkey_prf#2588] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2599]
         :     :     +- DexRidFilter part~p_size~15
         :     :        +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2601 AS ps_partkey_and_ps_suppkey_prf_1#2608, rid#2602 AS rid_1#2609, ps_availqty_prf#2603 AS ps_availqty_prf_1#2610, ps_comment_prf#2604 AS ps_comment_prf_1#2611, ps_partkey_prf#2605 AS ps_partkey_prf_1#2612, ps_supplycost_prf#2606 AS ps_supplycost_prf_1#2613, ps_suppkey_prf#2607 AS ps_suppkey_prf_1#2614]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2601,rid#2602,ps_availqty_prf#2603,ps_comment_prf#2604,ps_partkey_prf#2605,ps_supplycost_prf#2606,ps_suppkey_prf#2607] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 426ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/14 14:42:19 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:42:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2660L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 14:42:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2660L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#2701]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2685: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#2662 AS l_returnflag_prf_0#2681, l_orderkey_and_l_linenumber_prf#2663 AS l_orderkey_and_l_linenumber_prf_0#2682, l_comment_prf#2664 AS l_comment_prf_0#2683, l_linestatus_prf#2665 AS l_linestatus_prf_0#2684, rid#2666 AS rid_0#2685, l_shipmode_prf#2667 AS l_shipmode_prf_0#2686, l_shipinstruct_prf#2668 AS l_shipinstruct_prf_0#2687, l_quantity_prf#2669 AS l_quantity_prf_0#2688, l_receiptdate_prf#2670 AS l_receiptdate_prf_0#2689, l_linenumber_prf#2671 AS l_linenumber_prf_0#2690, l_tax_prf#2672 AS l_tax_prf_0#2691, l_shipdate_prf#2673 AS l_shipdate_prf_0#2692, l_extendedprice_prf#2674 AS l_extendedprice_prf_0#2693, l_partkey_prf#2675 AS l_partkey_prf_0#2694, l_discount_prf#2676 AS l_discount_prf_0#2695, l_partkey_and_l_suppkey_prf#2677 AS l_partkey_and_l_suppkey_prf_0#2696, l_commitdate_prf#2678 AS l_commitdate_prf_0#2697, l_suppkey_prf#2679 AS l_suppkey_prf_0#2698, l_orderkey_prf#2680 AS l_orderkey_prf_0#2699]
         :     :  :  +- Relation[l_returnflag_prf#2662,l_orderkey_and_l_linenumber_prf#2663,l_comment_prf#2664,l_linestatus_prf#2665,rid#2666,l_shipmode_prf#2667,l_shipinstruct_prf#2668,l_quantity_prf#2669,l_receiptdate_prf#2670,l_linenumber_prf#2671,l_tax_prf#2672,l_shipdate_prf#2673,l_extendedprice_prf#2674,l_partkey_prf#2675,l_discount_prf#2676,l_partkey_and_l_suppkey_prf#2677,l_commitdate_prf#2678,l_suppkey_prf#2679,l_orderkey_prf#2680] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2700]
         :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :        +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2702 AS o_shippriority_prf_1#2712, rid#2703 AS rid_1#2713, o_orderdate_prf#2704 AS o_orderdate_prf_1#2714, o_custkey_prf#2705 AS o_custkey_prf_1#2715, o_orderpriority_prf#2706 AS o_orderpriority_prf_1#2716, o_clerk_prf#2707 AS o_clerk_prf_1#2717, o_orderstatus_prf#2708 AS o_orderstatus_prf_1#2718, o_totalprice_prf#2709 AS o_totalprice_prf_1#2719, o_orderkey_prf#2710 AS o_orderkey_prf_1#2720, o_comment_prf#2711 AS o_comment_prf_1#2721]
            +- Relation[o_shippriority_prf#2702,rid#2703,o_orderdate_prf#2704,o_custkey_prf#2705,o_orderpriority_prf#2706,o_clerk_prf#2707,o_orderstatus_prf#2708,o_totalprice_prf#2709,o_orderkey_prf#2710,o_comment_prf#2711] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 54278ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/14 14:43:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:43:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2775L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 14:43:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2775L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#2793]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#2786: string
         :     :- Project [s_phone_prf#2777 AS s_phone_prf_0#2785, rid#2778 AS rid_0#2786, s_address_prf#2779 AS s_address_prf_0#2787, s_nationkey_prf#2780 AS s_nationkey_prf_0#2788, s_suppkey_prf#2781 AS s_suppkey_prf_0#2789, s_name_prf#2782 AS s_name_prf_0#2790, s_acctbal_prf#2783 AS s_acctbal_prf_0#2791, s_comment_prf#2784 AS s_comment_prf_0#2792]
         :     :  +- Relation[s_phone_prf#2777,rid#2778,s_address_prf#2779,s_nationkey_prf#2780,s_suppkey_prf#2781,s_name_prf#2782,s_acctbal_prf#2783,s_comment_prf#2784] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1584) AS rid_2#2808]
            :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_1#2802: string
            :     :- Project [ps_partkey_and_ps_suppkey_prf#2794 AS ps_partkey_and_ps_suppkey_prf_1#2801, rid#2795 AS rid_1#2802, ps_availqty_prf#2796 AS ps_availqty_prf_1#2803, ps_comment_prf#2797 AS ps_comment_prf_1#2804, ps_partkey_prf#2798 AS ps_partkey_prf_1#2805, ps_supplycost_prf#2799 AS ps_supplycost_prf_1#2806, ps_suppkey_prf#2800 AS ps_suppkey_prf_1#2807]
            :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2794,rid#2795,ps_availqty_prf#2796,ps_comment_prf#2797,ps_partkey_prf#2798,ps_supplycost_prf#2799,ps_suppkey_prf#2800] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#2809 AS p_comment_prf_2#2819, p_name_prf#2810 AS p_name_prf_2#2820, rid#2811 AS rid_2#2821, p_type_prf#2812 AS p_type_prf_2#2822, p_retailprice_prf#2813 AS p_retailprice_prf_2#2823, p_mfgr_prf#2814 AS p_mfgr_prf_2#2824, p_container_prf#2815 AS p_container_prf_2#2825, p_brand_prf#2816 AS p_brand_prf_2#2826, p_size_prf#2817 AS p_size_prf_2#2827, p_partkey_prf#2818 AS p_partkey_prf_2#2828]
               +- Relation[p_comment_prf#2809,p_name_prf#2810,rid#2811,p_type_prf#2812,p_retailprice_prf#2813,p_mfgr_prf#2814,p_container_prf#2815,p_brand_prf#2816,p_size_prf#2817,p_partkey_prf#2818] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 61515ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/14 14:44:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:44:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2871L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 14:44:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2871L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#2893]
         :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2885: string
         :     :- Project [p_comment_prf#2873 AS p_comment_prf_0#2883, p_name_prf#2874 AS p_name_prf_0#2884, rid#2875 AS rid_0#2885, p_type_prf#2876 AS p_type_prf_0#2886, p_retailprice_prf#2877 AS p_retailprice_prf_0#2887, p_mfgr_prf#2878 AS p_mfgr_prf_0#2888, p_container_prf#2879 AS p_container_prf_0#2889, p_brand_prf#2880 AS p_brand_prf_0#2890, p_size_prf#2881 AS p_size_prf_0#2891, p_partkey_prf#2882 AS p_partkey_prf_0#2892]
         :     :  +- Relation[p_comment_prf#2873,p_name_prf#2874,rid#2875,p_type_prf#2876,p_retailprice_prf#2877,p_mfgr_prf#2878,p_container_prf#2879,p_brand_prf#2880,p_size_prf#2881,p_partkey_prf#2882] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2894 AS ps_partkey_and_ps_suppkey_prf_1#2901, rid#2895 AS rid_1#2902, ps_availqty_prf#2896 AS ps_availqty_prf_1#2903, ps_comment_prf#2897 AS ps_comment_prf_1#2904, ps_partkey_prf#2898 AS ps_partkey_prf_1#2905, ps_supplycost_prf#2899 AS ps_supplycost_prf_1#2906, ps_suppkey_prf#2900 AS ps_suppkey_prf_1#2907]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2894,rid#2895,ps_availqty_prf#2896,ps_comment_prf#2897,ps_partkey_prf#2898,ps_supplycost_prf#2899,ps_suppkey_prf#2900] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 31668ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/14 14:44:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:44:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2961L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 14:44:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2961L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#3001]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2986: string
         :     :  :     :- Project [l_returnflag_prf#2963 AS l_returnflag_prf_0#2982, l_orderkey_and_l_linenumber_prf#2964 AS l_orderkey_and_l_linenumber_prf_0#2983, l_comment_prf#2965 AS l_comment_prf_0#2984, l_linestatus_prf#2966 AS l_linestatus_prf_0#2985, rid#2967 AS rid_0#2986, l_shipmode_prf#2968 AS l_shipmode_prf_0#2987, l_shipinstruct_prf#2969 AS l_shipinstruct_prf_0#2988, l_quantity_prf#2970 AS l_quantity_prf_0#2989, l_receiptdate_prf#2971 AS l_receiptdate_prf_0#2990, l_linenumber_prf#2972 AS l_linenumber_prf_0#2991, l_tax_prf#2973 AS l_tax_prf_0#2992, l_shipdate_prf#2974 AS l_shipdate_prf_0#2993, l_extendedprice_prf#2975 AS l_extendedprice_prf_0#2994, l_partkey_prf#2976 AS l_partkey_prf_0#2995, l_discount_prf#2977 AS l_discount_prf_0#2996, l_partkey_and_l_suppkey_prf#2978 AS l_partkey_and_l_suppkey_prf_0#2997, l_commitdate_prf#2979 AS l_commitdate_prf_0#2998, l_suppkey_prf#2980 AS l_suppkey_prf_0#2999, l_orderkey_prf#2981 AS l_orderkey_prf_0#3000]
         :     :  :     :  +- Relation[l_returnflag_prf#2963,l_orderkey_and_l_linenumber_prf#2964,l_comment_prf#2965,l_linestatus_prf#2966,rid#2967,l_shipmode_prf#2968,l_shipinstruct_prf#2969,l_quantity_prf#2970,l_receiptdate_prf#2971,l_linenumber_prf#2972,l_tax_prf#2973,l_shipdate_prf#2974,l_extendedprice_prf#2975,l_partkey_prf#2976,l_discount_prf#2977,l_partkey_and_l_suppkey_prf#2978,l_commitdate_prf#2979,l_suppkey_prf#2980,l_orderkey_prf#2981] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#3002 AS o_shippriority_prf_1#3012, rid#3003 AS rid_1#3013, o_orderdate_prf#3004 AS o_orderdate_prf_1#3014, o_custkey_prf#3005 AS o_custkey_prf_1#3015, o_orderpriority_prf#3006 AS o_orderpriority_prf_1#3016, o_clerk_prf#3007 AS o_clerk_prf_1#3017, o_orderstatus_prf#3008 AS o_orderstatus_prf_1#3018, o_totalprice_prf#3009 AS o_totalprice_prf_1#3019, o_orderkey_prf#3010 AS o_orderkey_prf_1#3020, o_comment_prf#3011 AS o_comment_prf_1#3021]
         :     :     +- Relation[o_shippriority_prf#3002,rid#3003,o_orderdate_prf#3004,o_custkey_prf#3005,o_orderpriority_prf#3006,o_clerk_prf#3007,o_orderstatus_prf#3008,o_totalprice_prf#3009,o_orderkey_prf#3010,o_comment_prf#3011] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3023 AS c_acctbal_prf_2#3032, rid#3024 AS rid_2#3033, c_name_prf#3025 AS c_name_prf_2#3034, c_nationkey_prf#3026 AS c_nationkey_prf_2#3035, c_custkey_prf#3027 AS c_custkey_prf_2#3036, c_comment_prf#3028 AS c_comment_prf_2#3037, c_address_prf#3029 AS c_address_prf_2#3038, c_mktsegment_prf#3030 AS c_mktsegment_prf_2#3039, c_phone_prf#3031 AS c_phone_prf_2#3040]
            +- Relation[c_acctbal_prf#3023,rid#3024,c_name_prf#3025,c_nationkey_prf#3026,c_custkey_prf#3027,c_comment_prf#3028,c_address_prf#3029,c_mktsegment_prf#3030,c_phone_prf#3031] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 333663ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/14 14:50:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:50:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3103L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 14:50:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3103L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#3119]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, rid_0#3113: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#3105 AS ps_partkey_and_ps_suppkey_prf_0#3112, rid#3106 AS rid_0#3113, ps_availqty_prf#3107 AS ps_availqty_prf_0#3114, ps_comment_prf#3108 AS ps_comment_prf_0#3115, ps_partkey_prf#3109 AS ps_partkey_prf_0#3116, ps_supplycost_prf#3110 AS ps_supplycost_prf_0#3117, ps_suppkey_prf#3111 AS ps_suppkey_prf_0#3118]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#3105,rid#3106,ps_availqty_prf#3107,ps_comment_prf#3108,ps_partkey_prf#3109,ps_supplycost_prf#3110,ps_suppkey_prf#3111] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3120 AS l_returnflag_prf_1#3139, l_orderkey_and_l_linenumber_prf#3121 AS l_orderkey_and_l_linenumber_prf_1#3140, l_comment_prf#3122 AS l_comment_prf_1#3141, l_linestatus_prf#3123 AS l_linestatus_prf_1#3142, rid#3124 AS rid_1#3143, l_shipmode_prf#3125 AS l_shipmode_prf_1#3144, l_shipinstruct_prf#3126 AS l_shipinstruct_prf_1#3145, l_quantity_prf#3127 AS l_quantity_prf_1#3146, l_receiptdate_prf#3128 AS l_receiptdate_prf_1#3147, l_linenumber_prf#3129 AS l_linenumber_prf_1#3148, l_tax_prf#3130 AS l_tax_prf_1#3149, l_shipdate_prf#3131 AS l_shipdate_prf_1#3150, l_extendedprice_prf#3132 AS l_extendedprice_prf_1#3151, l_partkey_prf#3133 AS l_partkey_prf_1#3152, l_discount_prf#3134 AS l_discount_prf_1#3153, l_partkey_and_l_suppkey_prf#3135 AS l_partkey_and_l_suppkey_prf_1#3154, l_commitdate_prf#3136 AS l_commitdate_prf_1#3155, l_suppkey_prf#3137 AS l_suppkey_prf_1#3156, l_orderkey_prf#3138 AS l_orderkey_prf_1#3157]
            +- Relation[l_returnflag_prf#3120,l_orderkey_and_l_linenumber_prf#3121,l_comment_prf#3122,l_linestatus_prf#3123,rid#3124,l_shipmode_prf#3125,l_shipinstruct_prf#3126,l_quantity_prf#3127,l_receiptdate_prf#3128,l_linenumber_prf#3129,l_tax_prf#3130,l_shipdate_prf#3131,l_extendedprice_prf#3132,l_partkey_prf#3133,l_discount_prf#3134,l_partkey_and_l_suppkey_prf#3135,l_commitdate_prf#3136,l_suppkey_prf#3137,l_orderkey_prf#3138] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 116750ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/14 14:52:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:52:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3212L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 14:52:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3212L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#3252]
         :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#3237: string
         :     :- Project [l_returnflag_prf#3214 AS l_returnflag_prf_0#3233, l_orderkey_and_l_linenumber_prf#3215 AS l_orderkey_and_l_linenumber_prf_0#3234, l_comment_prf#3216 AS l_comment_prf_0#3235, l_linestatus_prf#3217 AS l_linestatus_prf_0#3236, rid#3218 AS rid_0#3237, l_shipmode_prf#3219 AS l_shipmode_prf_0#3238, l_shipinstruct_prf#3220 AS l_shipinstruct_prf_0#3239, l_quantity_prf#3221 AS l_quantity_prf_0#3240, l_receiptdate_prf#3222 AS l_receiptdate_prf_0#3241, l_linenumber_prf#3223 AS l_linenumber_prf_0#3242, l_tax_prf#3224 AS l_tax_prf_0#3243, l_shipdate_prf#3225 AS l_shipdate_prf_0#3244, l_extendedprice_prf#3226 AS l_extendedprice_prf_0#3245, l_partkey_prf#3227 AS l_partkey_prf_0#3246, l_discount_prf#3228 AS l_discount_prf_0#3247, l_partkey_and_l_suppkey_prf#3229 AS l_partkey_and_l_suppkey_prf_0#3248, l_commitdate_prf#3230 AS l_commitdate_prf_0#3249, l_suppkey_prf#3231 AS l_suppkey_prf_0#3250, l_orderkey_prf#3232 AS l_orderkey_prf_0#3251]
         :     :  +- Relation[l_returnflag_prf#3214,l_orderkey_and_l_linenumber_prf#3215,l_comment_prf#3216,l_linestatus_prf#3217,rid#3218,l_shipmode_prf#3219,l_shipinstruct_prf#3220,l_quantity_prf#3221,l_receiptdate_prf#3222,l_linenumber_prf#3223,l_tax_prf#3224,l_shipdate_prf#3225,l_extendedprice_prf#3226,l_partkey_prf#3227,l_discount_prf#3228,l_partkey_and_l_suppkey_prf#3229,l_commitdate_prf#3230,l_suppkey_prf#3231,l_orderkey_prf#3232] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#3253 AS p_comment_prf_1#3263, p_name_prf#3254 AS p_name_prf_1#3264, rid#3255 AS rid_1#3265, p_type_prf#3256 AS p_type_prf_1#3266, p_retailprice_prf#3257 AS p_retailprice_prf_1#3267, p_mfgr_prf#3258 AS p_mfgr_prf_1#3268, p_container_prf#3259 AS p_container_prf_1#3269, p_brand_prf#3260 AS p_brand_prf_1#3270, p_size_prf#3261 AS p_size_prf_1#3271, p_partkey_prf#3262 AS p_partkey_prf_1#3272]
            +- Relation[p_comment_prf#3253,p_name_prf#3254,rid#3255,p_type_prf#3256,p_retailprice_prf#3257,p_mfgr_prf#3258,p_container_prf#3259,p_brand_prf#3260,p_size_prf#3261,p_partkey_prf#3262] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 117882ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/14 14:54:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:54:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3314L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 14:54:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3314L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#3316 AS p_comment_prf_0#3326, p_name_prf#3317 AS p_name_prf_0#3327, rid#3318 AS rid_0#3328, p_type_prf#3319 AS p_type_prf_0#3329, p_retailprice_prf#3320 AS p_retailprice_prf_0#3330, p_mfgr_prf#3321 AS p_mfgr_prf_0#3331, p_container_prf#3322 AS p_container_prf_0#3332, p_brand_prf#3323 AS p_brand_prf_0#3333, p_size_prf#3324 AS p_size_prf_0#3334, p_partkey_prf#3325 AS p_partkey_prf_0#3335]
         :  +- Relation[p_comment_prf#3316,p_name_prf#3317,rid#3318,p_type_prf#3319,p_retailprice_prf#3320,p_mfgr_prf#3321,p_container_prf#3322,p_brand_prf#3323,p_size_prf#3324,p_partkey_prf#3325] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3336]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1451
Elapsed time: 83ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/14 14:54:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:54:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3375L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 14:54:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3375L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#3397]
         :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3389: string
         :     :- Project [p_comment_prf#3377 AS p_comment_prf_0#3387, p_name_prf#3378 AS p_name_prf_0#3388, rid#3379 AS rid_0#3389, p_type_prf#3380 AS p_type_prf_0#3390, p_retailprice_prf#3381 AS p_retailprice_prf_0#3391, p_mfgr_prf#3382 AS p_mfgr_prf_0#3392, p_container_prf#3383 AS p_container_prf_0#3393, p_brand_prf#3384 AS p_brand_prf_0#3394, p_size_prf#3385 AS p_size_prf_0#3395, p_partkey_prf#3386 AS p_partkey_prf_0#3396]
         :     :  +- Relation[p_comment_prf#3377,p_name_prf#3378,rid#3379,p_type_prf#3380,p_retailprice_prf#3381,p_mfgr_prf#3382,p_container_prf#3383,p_brand_prf#3384,p_size_prf#3385,p_partkey_prf#3386] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3398 AS l_returnflag_prf_1#3417, l_orderkey_and_l_linenumber_prf#3399 AS l_orderkey_and_l_linenumber_prf_1#3418, l_comment_prf#3400 AS l_comment_prf_1#3419, l_linestatus_prf#3401 AS l_linestatus_prf_1#3420, rid#3402 AS rid_1#3421, l_shipmode_prf#3403 AS l_shipmode_prf_1#3422, l_shipinstruct_prf#3404 AS l_shipinstruct_prf_1#3423, l_quantity_prf#3405 AS l_quantity_prf_1#3424, l_receiptdate_prf#3406 AS l_receiptdate_prf_1#3425, l_linenumber_prf#3407 AS l_linenumber_prf_1#3426, l_tax_prf#3408 AS l_tax_prf_1#3427, l_shipdate_prf#3409 AS l_shipdate_prf_1#3428, l_extendedprice_prf#3410 AS l_extendedprice_prf_1#3429, l_partkey_prf#3411 AS l_partkey_prf_1#3430, l_discount_prf#3412 AS l_discount_prf_1#3431, l_partkey_and_l_suppkey_prf#3413 AS l_partkey_and_l_suppkey_prf_1#3432, l_commitdate_prf#3414 AS l_commitdate_prf_1#3433, l_suppkey_prf#3415 AS l_suppkey_prf_1#3434, l_orderkey_prf#3416 AS l_orderkey_prf_1#3435]
            +- Relation[l_returnflag_prf#3398,l_orderkey_and_l_linenumber_prf#3399,l_comment_prf#3400,l_linestatus_prf#3401,rid#3402,l_shipmode_prf#3403,l_shipinstruct_prf#3404,l_quantity_prf#3405,l_receiptdate_prf#3406,l_linenumber_prf#3407,l_tax_prf#3408,l_shipdate_prf#3409,l_extendedprice_prf#3410,l_partkey_prf#3411,l_discount_prf#3412,l_partkey_and_l_suppkey_prf#3413,l_commitdate_prf#3414,l_suppkey_prf#3415,l_orderkey_prf#3416] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 94583ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/14 14:55:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:55:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3491L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 14:55:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3491L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#3509]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#3502: string
         :     :- Project [s_phone_prf#3493 AS s_phone_prf_0#3501, rid#3494 AS rid_0#3502, s_address_prf#3495 AS s_address_prf_0#3503, s_nationkey_prf#3496 AS s_nationkey_prf_0#3504, s_suppkey_prf#3497 AS s_suppkey_prf_0#3505, s_name_prf#3498 AS s_name_prf_0#3506, s_acctbal_prf#3499 AS s_acctbal_prf_0#3507, s_comment_prf#3500 AS s_comment_prf_0#3508]
         :     :  +- Relation[s_phone_prf#3493,rid#3494,s_address_prf#3495,s_nationkey_prf#3496,s_suppkey_prf#3497,s_name_prf#3498,s_acctbal_prf#3499,s_comment_prf#3500] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3510 AS l_returnflag_prf_1#3529, l_orderkey_and_l_linenumber_prf#3511 AS l_orderkey_and_l_linenumber_prf_1#3530, l_comment_prf#3512 AS l_comment_prf_1#3531, l_linestatus_prf#3513 AS l_linestatus_prf_1#3532, rid#3514 AS rid_1#3533, l_shipmode_prf#3515 AS l_shipmode_prf_1#3534, l_shipinstruct_prf#3516 AS l_shipinstruct_prf_1#3535, l_quantity_prf#3517 AS l_quantity_prf_1#3536, l_receiptdate_prf#3518 AS l_receiptdate_prf_1#3537, l_linenumber_prf#3519 AS l_linenumber_prf_1#3538, l_tax_prf#3520 AS l_tax_prf_1#3539, l_shipdate_prf#3521 AS l_shipdate_prf_1#3540, l_extendedprice_prf#3522 AS l_extendedprice_prf_1#3541, l_partkey_prf#3523 AS l_partkey_prf_1#3542, l_discount_prf#3524 AS l_discount_prf_1#3543, l_partkey_and_l_suppkey_prf#3525 AS l_partkey_and_l_suppkey_prf_1#3544, l_commitdate_prf#3526 AS l_commitdate_prf_1#3545, l_suppkey_prf#3527 AS l_suppkey_prf_1#3546, l_orderkey_prf#3528 AS l_orderkey_prf_1#3547]
            +- Relation[l_returnflag_prf#3510,l_orderkey_and_l_linenumber_prf#3511,l_comment_prf#3512,l_linestatus_prf#3513,rid#3514,l_shipmode_prf#3515,l_shipinstruct_prf#3516,l_quantity_prf#3517,l_receiptdate_prf#3518,l_linenumber_prf#3519,l_tax_prf#3520,l_shipdate_prf#3521,l_extendedprice_prf#3522,l_partkey_prf#3523,l_discount_prf#3524,l_partkey_and_l_suppkey_prf#3525,l_commitdate_prf#3526,l_suppkey_prf#3527,l_orderkey_prf#3528] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 86454ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/14 14:57:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:57:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3595L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 14:57:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3595L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#3615]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3607: string
         :     :- Project [c_acctbal_prf#3597 AS c_acctbal_prf_0#3606, rid#3598 AS rid_0#3607, c_name_prf#3599 AS c_name_prf_0#3608, c_nationkey_prf#3600 AS c_nationkey_prf_0#3609, c_custkey_prf#3601 AS c_custkey_prf_0#3610, c_comment_prf#3602 AS c_comment_prf_0#3611, c_address_prf#3603 AS c_address_prf_0#3612, c_mktsegment_prf#3604 AS c_mktsegment_prf_0#3613, c_phone_prf#3605 AS c_phone_prf_0#3614]
         :     :  +- Relation[c_acctbal_prf#3597,rid#3598,c_name_prf#3599,c_nationkey_prf#3600,c_custkey_prf#3601,c_comment_prf#3602,c_address_prf#3603,c_mktsegment_prf#3604,c_phone_prf#3605] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3616 AS o_shippriority_prf_1#3626, rid#3617 AS rid_1#3627, o_orderdate_prf#3618 AS o_orderdate_prf_1#3628, o_custkey_prf#3619 AS o_custkey_prf_1#3629, o_orderpriority_prf#3620 AS o_orderpriority_prf_1#3630, o_clerk_prf#3621 AS o_clerk_prf_1#3631, o_orderstatus_prf#3622 AS o_orderstatus_prf_1#3632, o_totalprice_prf#3623 AS o_totalprice_prf_1#3633, o_orderkey_prf#3624 AS o_orderkey_prf_1#3634, o_comment_prf#3625 AS o_comment_prf_1#3635]
            +- Relation[o_shippriority_prf#3616,rid#3617,o_orderdate_prf#3618,o_custkey_prf#3619,o_orderpriority_prf#3620,o_clerk_prf#3621,o_orderstatus_prf#3622,o_totalprice_prf#3623,o_orderkey_prf#3624,o_comment_prf#3625] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1500000
Elapsed time: 40379ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/14 14:57:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:57:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3683L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 14:57:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3683L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#3723]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3708: string
         :     :- Project [l_returnflag_prf#3685 AS l_returnflag_prf_0#3704, l_orderkey_and_l_linenumber_prf#3686 AS l_orderkey_and_l_linenumber_prf_0#3705, l_comment_prf#3687 AS l_comment_prf_0#3706, l_linestatus_prf#3688 AS l_linestatus_prf_0#3707, rid#3689 AS rid_0#3708, l_shipmode_prf#3690 AS l_shipmode_prf_0#3709, l_shipinstruct_prf#3691 AS l_shipinstruct_prf_0#3710, l_quantity_prf#3692 AS l_quantity_prf_0#3711, l_receiptdate_prf#3693 AS l_receiptdate_prf_0#3712, l_linenumber_prf#3694 AS l_linenumber_prf_0#3713, l_tax_prf#3695 AS l_tax_prf_0#3714, l_shipdate_prf#3696 AS l_shipdate_prf_0#3715, l_extendedprice_prf#3697 AS l_extendedprice_prf_0#3716, l_partkey_prf#3698 AS l_partkey_prf_0#3717, l_discount_prf#3699 AS l_discount_prf_0#3718, l_partkey_and_l_suppkey_prf#3700 AS l_partkey_and_l_suppkey_prf_0#3719, l_commitdate_prf#3701 AS l_commitdate_prf_0#3720, l_suppkey_prf#3702 AS l_suppkey_prf_0#3721, l_orderkey_prf#3703 AS l_orderkey_prf_0#3722]
         :     :  +- Relation[l_returnflag_prf#3685,l_orderkey_and_l_linenumber_prf#3686,l_comment_prf#3687,l_linestatus_prf#3688,rid#3689,l_shipmode_prf#3690,l_shipinstruct_prf#3691,l_quantity_prf#3692,l_receiptdate_prf#3693,l_linenumber_prf#3694,l_tax_prf#3695,l_shipdate_prf#3696,l_extendedprice_prf#3697,l_partkey_prf#3698,l_discount_prf#3699,l_partkey_and_l_suppkey_prf#3700,l_commitdate_prf#3701,l_suppkey_prf#3702,l_orderkey_prf#3703] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3724 AS o_shippriority_prf_1#3734, rid#3725 AS rid_1#3735, o_orderdate_prf#3726 AS o_orderdate_prf_1#3736, o_custkey_prf#3727 AS o_custkey_prf_1#3737, o_orderpriority_prf#3728 AS o_orderpriority_prf_1#3738, o_clerk_prf#3729 AS o_clerk_prf_1#3739, o_orderstatus_prf#3730 AS o_orderstatus_prf_1#3740, o_totalprice_prf#3731 AS o_totalprice_prf_1#3741, o_orderkey_prf#3732 AS o_orderkey_prf_1#3742, o_comment_prf#3733 AS o_comment_prf_1#3743]
            +- Relation[o_shippriority_prf#3724,rid#3725,o_orderdate_prf#3726,o_custkey_prf#3727,o_orderpriority_prf#3728,o_clerk_prf#3729,o_orderstatus_prf#3730,o_totalprice_prf#3731,o_orderkey_prf#3732,o_comment_prf#3733] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 114223ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/14 14:59:51 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:59:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3797L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 14:59:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3797L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_2#3815]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#3808: string
         :     :- Project [s_phone_prf#3799 AS s_phone_prf_0#3807, rid#3800 AS rid_0#3808, s_address_prf#3801 AS s_address_prf_0#3809, s_nationkey_prf#3802 AS s_nationkey_prf_0#3810, s_suppkey_prf#3803 AS s_suppkey_prf_0#3811, s_name_prf#3804 AS s_name_prf_0#3812, s_acctbal_prf#3805 AS s_acctbal_prf_0#3813, s_comment_prf#3806 AS s_comment_prf_0#3814]
         :     :  +- Relation[s_phone_prf#3799,rid#3800,s_address_prf#3801,s_nationkey_prf#3802,s_suppkey_prf#3803,s_name_prf#3804,s_acctbal_prf#3805,s_comment_prf#3806] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1584) AS rid_2#3836]
            :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#3828: string
            :     :- Project [p_comment_prf#3816 AS p_comment_prf_1#3826, p_name_prf#3817 AS p_name_prf_1#3827, rid#3818 AS rid_1#3828, p_type_prf#3819 AS p_type_prf_1#3829, p_retailprice_prf#3820 AS p_retailprice_prf_1#3830, p_mfgr_prf#3821 AS p_mfgr_prf_1#3831, p_container_prf#3822 AS p_container_prf_1#3832, p_brand_prf#3823 AS p_brand_prf_1#3833, p_size_prf#3824 AS p_size_prf_1#3834, p_partkey_prf#3825 AS p_partkey_prf_1#3835]
            :     :  +- Relation[p_comment_prf#3816,p_name_prf#3817,rid#3818,p_type_prf#3819,p_retailprice_prf#3820,p_mfgr_prf#3821,p_container_prf#3822,p_brand_prf#3823,p_size_prf#3824,p_partkey_prf#3825] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#3837 AS ps_partkey_and_ps_suppkey_prf_2#3844, rid#3838 AS rid_2#3845, ps_availqty_prf#3839 AS ps_availqty_prf_2#3846, ps_comment_prf#3840 AS ps_comment_prf_2#3847, ps_partkey_prf#3841 AS ps_partkey_prf_2#3848, ps_supplycost_prf#3842 AS ps_supplycost_prf_2#3849, ps_suppkey_prf#3843 AS ps_suppkey_prf_2#3850]
               +- Relation[ps_partkey_and_ps_suppkey_prf#3837,rid#3838,ps_availqty_prf#3839,ps_comment_prf#3840,ps_partkey_prf#3841,ps_supplycost_prf#3842,ps_suppkey_prf#3843] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 42816ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/14 15:00:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 15:00:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3883L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 15:00:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3883L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#3885 AS rid_0#3890, n_regionkey_prf#3886 AS n_regionkey_prf_0#3891, n_nationkey_prf#3887 AS n_nationkey_prf_0#3892, n_name_prf#3888 AS n_name_prf_0#3893, n_comment_prf#3889 AS n_comment_prf_0#3894]
         :  +- Relation[rid#3885,n_regionkey_prf#3886,n_nationkey_prf#3887,n_name_prf#3888,n_comment_prf#3889] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3895]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 54ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/14 15:00:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 15:00:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3937L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 15:00:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3937L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#3957]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3949: string
         :     :- Project [c_acctbal_prf#3939 AS c_acctbal_prf_0#3948, rid#3940 AS rid_0#3949, c_name_prf#3941 AS c_name_prf_0#3950, c_nationkey_prf#3942 AS c_nationkey_prf_0#3951, c_custkey_prf#3943 AS c_custkey_prf_0#3952, c_comment_prf#3944 AS c_comment_prf_0#3953, c_address_prf#3945 AS c_address_prf_0#3954, c_mktsegment_prf#3946 AS c_mktsegment_prf_0#3955, c_phone_prf#3947 AS c_phone_prf_0#3956]
         :     :  +- Relation[c_acctbal_prf#3939,rid#3940,c_name_prf#3941,c_nationkey_prf#3942,c_custkey_prf#3943,c_comment_prf#3944,c_address_prf#3945,c_mktsegment_prf#3946,c_phone_prf#3947] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1584) AS rid_2#3978]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#3969: string
            :     :- Project [o_shippriority_prf#3958 AS o_shippriority_prf_1#3968, rid#3959 AS rid_1#3969, o_orderdate_prf#3960 AS o_orderdate_prf_1#3970, o_custkey_prf#3961 AS o_custkey_prf_1#3971, o_orderpriority_prf#3962 AS o_orderpriority_prf_1#3972, o_clerk_prf#3963 AS o_clerk_prf_1#3973, o_orderstatus_prf#3964 AS o_orderstatus_prf_1#3974, o_totalprice_prf#3965 AS o_totalprice_prf_1#3975, o_orderkey_prf#3966 AS o_orderkey_prf_1#3976, o_comment_prf#3967 AS o_comment_prf_1#3977]
            :     :  +- Relation[o_shippriority_prf#3958,rid#3959,o_orderdate_prf#3960,o_custkey_prf#3961,o_orderpriority_prf#3962,o_clerk_prf#3963,o_orderstatus_prf#3964,o_totalprice_prf#3965,o_orderkey_prf#3966,o_comment_prf#3967] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3979 AS l_returnflag_prf_2#3998, l_orderkey_and_l_linenumber_prf#3980 AS l_orderkey_and_l_linenumber_prf_2#3999, l_comment_prf#3981 AS l_comment_prf_2#4000, l_linestatus_prf#3982 AS l_linestatus_prf_2#4001, rid#3983 AS rid_2#4002, l_shipmode_prf#3984 AS l_shipmode_prf_2#4003, l_shipinstruct_prf#3985 AS l_shipinstruct_prf_2#4004, l_quantity_prf#3986 AS l_quantity_prf_2#4005, l_receiptdate_prf#3987 AS l_receiptdate_prf_2#4006, l_linenumber_prf#3988 AS l_linenumber_prf_2#4007, l_tax_prf#3989 AS l_tax_prf_2#4008, l_shipdate_prf#3990 AS l_shipdate_prf_2#4009, l_extendedprice_prf#3991 AS l_extendedprice_prf_2#4010, l_partkey_prf#3992 AS l_partkey_prf_2#4011, l_discount_prf#3993 AS l_discount_prf_2#4012, l_partkey_and_l_suppkey_prf#3994 AS l_partkey_and_l_suppkey_prf_2#4013, l_commitdate_prf#3995 AS l_commitdate_prf_2#4014, l_suppkey_prf#3996 AS l_suppkey_prf_2#4015, l_orderkey_prf#3997 AS l_orderkey_prf_2#4016]
               +- Relation[l_returnflag_prf#3979,l_orderkey_and_l_linenumber_prf#3980,l_comment_prf#3981,l_linestatus_prf#3982,rid#3983,l_shipmode_prf#3984,l_shipinstruct_prf#3985,l_quantity_prf#3986,l_receiptdate_prf#3987,l_linenumber_prf#3988,l_tax_prf#3989,l_shipdate_prf#3990,l_extendedprice_prf#3991,l_partkey_prf#3992,l_discount_prf#3993,l_partkey_and_l_suppkey_prf#3994,l_commitdate_prf#3995,l_suppkey_prf#3996,l_orderkey_prf#3997] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 234406ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/14 15:04:28 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 15:04:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4070L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 15:04:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4070L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#4088]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#4081: string
         :     :- Project [s_phone_prf#4072 AS s_phone_prf_0#4080, rid#4073 AS rid_0#4081, s_address_prf#4074 AS s_address_prf_0#4082, s_nationkey_prf#4075 AS s_nationkey_prf_0#4083, s_suppkey_prf#4076 AS s_suppkey_prf_0#4084, s_name_prf#4077 AS s_name_prf_0#4085, s_acctbal_prf#4078 AS s_acctbal_prf_0#4086, s_comment_prf#4079 AS s_comment_prf_0#4087]
         :     :  +- Relation[s_phone_prf#4072,rid#4073,s_address_prf#4074,s_nationkey_prf#4075,s_suppkey_prf#4076,s_name_prf#4077,s_acctbal_prf#4078,s_comment_prf#4079] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4089 AS ps_partkey_and_ps_suppkey_prf_1#4096, rid#4090 AS rid_1#4097, ps_availqty_prf#4091 AS ps_availqty_prf_1#4098, ps_comment_prf#4092 AS ps_comment_prf_1#4099, ps_partkey_prf#4093 AS ps_partkey_prf_1#4100, ps_supplycost_prf#4094 AS ps_supplycost_prf_1#4101, ps_suppkey_prf#4095 AS ps_suppkey_prf_1#4102]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4089,rid#4090,ps_availqty_prf#4091,ps_comment_prf#4092,ps_partkey_prf#4093,ps_supplycost_prf#4094,ps_suppkey_prf#4095] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 10982ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/14 15:04:39 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 15:04:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4153L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 15:04:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4153L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#4193]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#4178: string
         :     :  :     :- Project [l_returnflag_prf#4155 AS l_returnflag_prf_0#4174, l_orderkey_and_l_linenumber_prf#4156 AS l_orderkey_and_l_linenumber_prf_0#4175, l_comment_prf#4157 AS l_comment_prf_0#4176, l_linestatus_prf#4158 AS l_linestatus_prf_0#4177, rid#4159 AS rid_0#4178, l_shipmode_prf#4160 AS l_shipmode_prf_0#4179, l_shipinstruct_prf#4161 AS l_shipinstruct_prf_0#4180, l_quantity_prf#4162 AS l_quantity_prf_0#4181, l_receiptdate_prf#4163 AS l_receiptdate_prf_0#4182, l_linenumber_prf#4164 AS l_linenumber_prf_0#4183, l_tax_prf#4165 AS l_tax_prf_0#4184, l_shipdate_prf#4166 AS l_shipdate_prf_0#4185, l_extendedprice_prf#4167 AS l_extendedprice_prf_0#4186, l_partkey_prf#4168 AS l_partkey_prf_0#4187, l_discount_prf#4169 AS l_discount_prf_0#4188, l_partkey_and_l_suppkey_prf#4170 AS l_partkey_and_l_suppkey_prf_0#4189, l_commitdate_prf#4171 AS l_commitdate_prf_0#4190, l_suppkey_prf#4172 AS l_suppkey_prf_0#4191, l_orderkey_prf#4173 AS l_orderkey_prf_0#4192]
         :     :  :     :  +- Relation[l_returnflag_prf#4155,l_orderkey_and_l_linenumber_prf#4156,l_comment_prf#4157,l_linestatus_prf#4158,rid#4159,l_shipmode_prf#4160,l_shipinstruct_prf#4161,l_quantity_prf#4162,l_receiptdate_prf#4163,l_linenumber_prf#4164,l_tax_prf#4165,l_shipdate_prf#4166,l_extendedprice_prf#4167,l_partkey_prf#4168,l_discount_prf#4169,l_partkey_and_l_suppkey_prf#4170,l_commitdate_prf#4171,l_suppkey_prf#4172,l_orderkey_prf#4173] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#4194 AS p_comment_prf_1#4204, p_name_prf#4195 AS p_name_prf_1#4205, rid#4196 AS rid_1#4206, p_type_prf#4197 AS p_type_prf_1#4207, p_retailprice_prf#4198 AS p_retailprice_prf_1#4208, p_mfgr_prf#4199 AS p_mfgr_prf_1#4209, p_container_prf#4200 AS p_container_prf_1#4210, p_brand_prf#4201 AS p_brand_prf_1#4211, p_size_prf#4202 AS p_size_prf_1#4212, p_partkey_prf#4203 AS p_partkey_prf_1#4213]
         :     :     +- Relation[p_comment_prf#4194,p_name_prf#4195,rid#4196,p_type_prf#4197,p_retailprice_prf#4198,p_mfgr_prf#4199,p_container_prf#4200,p_brand_prf#4201,p_size_prf#4202,p_partkey_prf#4203] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4215 AS s_phone_prf_2#4223, rid#4216 AS rid_2#4224, s_address_prf#4217 AS s_address_prf_2#4225, s_nationkey_prf#4218 AS s_nationkey_prf_2#4226, s_suppkey_prf#4219 AS s_suppkey_prf_2#4227, s_name_prf#4220 AS s_name_prf_2#4228, s_acctbal_prf#4221 AS s_acctbal_prf_2#4229, s_comment_prf#4222 AS s_comment_prf_2#4230]
            +- Relation[s_phone_prf#4215,rid#4216,s_address_prf#4217,s_nationkey_prf#4218,s_suppkey_prf#4219,s_name_prf#4220,s_acctbal_prf#4221,s_comment_prf#4222] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 263641ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/14 15:09:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 15:09:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4283L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 15:09:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4283L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#4295]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#4290: string
         :     :- Project [rid#4285 AS rid_0#4290, n_regionkey_prf#4286 AS n_regionkey_prf_0#4291, n_nationkey_prf#4287 AS n_nationkey_prf_0#4292, n_name_prf#4288 AS n_name_prf_0#4293, n_comment_prf#4289 AS n_comment_prf_0#4294]
         :     :  +- Relation[rid#4285,n_regionkey_prf#4286,n_nationkey_prf#4287,n_name_prf#4288,n_comment_prf#4289] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4296 AS c_acctbal_prf_1#4305, rid#4297 AS rid_1#4306, c_name_prf#4298 AS c_name_prf_1#4307, c_nationkey_prf#4299 AS c_nationkey_prf_1#4308, c_custkey_prf#4300 AS c_custkey_prf_1#4309, c_comment_prf#4301 AS c_comment_prf_1#4310, c_address_prf#4302 AS c_address_prf_1#4311, c_mktsegment_prf#4303 AS c_mktsegment_prf_1#4312, c_phone_prf#4304 AS c_phone_prf_1#4313]
            +- Relation[c_acctbal_prf#4296,rid#4297,c_name_prf#4298,c_nationkey_prf#4299,c_custkey_prf#4300,c_comment_prf#4301,c_address_prf#4302,c_mktsegment_prf#4303,c_phone_prf#4304] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=150000
Elapsed time: 1934ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/14 15:09:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 15:09:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4363L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 15:09:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4363L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#4381]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#4374: string
         :     :- Project [s_phone_prf#4365 AS s_phone_prf_0#4373, rid#4366 AS rid_0#4374, s_address_prf#4367 AS s_address_prf_0#4375, s_nationkey_prf#4368 AS s_nationkey_prf_0#4376, s_suppkey_prf#4369 AS s_suppkey_prf_0#4377, s_name_prf#4370 AS s_name_prf_0#4378, s_acctbal_prf#4371 AS s_acctbal_prf_0#4379, s_comment_prf#4372 AS s_comment_prf_0#4380]
         :     :  +- Relation[s_phone_prf#4365,rid#4366,s_address_prf#4367,s_nationkey_prf#4368,s_suppkey_prf#4369,s_name_prf#4370,s_acctbal_prf#4371,s_comment_prf#4372] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1584) AS rid_2#4420]
            :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_1#4405: string
            :     :- Project [l_returnflag_prf#4382 AS l_returnflag_prf_1#4401, l_orderkey_and_l_linenumber_prf#4383 AS l_orderkey_and_l_linenumber_prf_1#4402, l_comment_prf#4384 AS l_comment_prf_1#4403, l_linestatus_prf#4385 AS l_linestatus_prf_1#4404, rid#4386 AS rid_1#4405, l_shipmode_prf#4387 AS l_shipmode_prf_1#4406, l_shipinstruct_prf#4388 AS l_shipinstruct_prf_1#4407, l_quantity_prf#4389 AS l_quantity_prf_1#4408, l_receiptdate_prf#4390 AS l_receiptdate_prf_1#4409, l_linenumber_prf#4391 AS l_linenumber_prf_1#4410, l_tax_prf#4392 AS l_tax_prf_1#4411, l_shipdate_prf#4393 AS l_shipdate_prf_1#4412, l_extendedprice_prf#4394 AS l_extendedprice_prf_1#4413, l_partkey_prf#4395 AS l_partkey_prf_1#4414, l_discount_prf#4396 AS l_discount_prf_1#4415, l_partkey_and_l_suppkey_prf#4397 AS l_partkey_and_l_suppkey_prf_1#4416, l_commitdate_prf#4398 AS l_commitdate_prf_1#4417, l_suppkey_prf#4399 AS l_suppkey_prf_1#4418, l_orderkey_prf#4400 AS l_orderkey_prf_1#4419]
            :     :  +- Relation[l_returnflag_prf#4382,l_orderkey_and_l_linenumber_prf#4383,l_comment_prf#4384,l_linestatus_prf#4385,rid#4386,l_shipmode_prf#4387,l_shipinstruct_prf#4388,l_quantity_prf#4389,l_receiptdate_prf#4390,l_linenumber_prf#4391,l_tax_prf#4392,l_shipdate_prf#4393,l_extendedprice_prf#4394,l_partkey_prf#4395,l_discount_prf#4396,l_partkey_and_l_suppkey_prf#4397,l_commitdate_prf#4398,l_suppkey_prf#4399,l_orderkey_prf#4400] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#4421 AS p_comment_prf_2#4431, p_name_prf#4422 AS p_name_prf_2#4432, rid#4423 AS rid_2#4433, p_type_prf#4424 AS p_type_prf_2#4434, p_retailprice_prf#4425 AS p_retailprice_prf_2#4435, p_mfgr_prf#4426 AS p_mfgr_prf_2#4436, p_container_prf#4427 AS p_container_prf_2#4437, p_brand_prf#4428 AS p_brand_prf_2#4438, p_size_prf#4429 AS p_size_prf_2#4439, p_partkey_prf#4430 AS p_partkey_prf_2#4440]
               +- Relation[p_comment_prf#4421,p_name_prf#4422,rid#4423,p_type_prf#4424,p_retailprice_prf#4425,p_mfgr_prf#4426,p_container_prf#4427,p_brand_prf#4428,p_size_prf#4429,p_partkey_prf#4430] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 186248ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/14 15:12:11 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 15:12:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4502L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 15:12:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4502L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1584) AS rid_2#4539]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#4518]
         :     :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#4512: string
         :     :  :     :- Project [ps_partkey_and_ps_suppkey_prf#4504 AS ps_partkey_and_ps_suppkey_prf_0#4511, rid#4505 AS rid_0#4512, ps_availqty_prf#4506 AS ps_availqty_prf_0#4513, ps_comment_prf#4507 AS ps_comment_prf_0#4514, ps_partkey_prf#4508 AS ps_partkey_prf_0#4515, ps_supplycost_prf#4509 AS ps_supplycost_prf_0#4516, ps_suppkey_prf#4510 AS ps_suppkey_prf_0#4517]
         :     :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#4504,rid#4505,ps_availqty_prf#4506,ps_comment_prf#4507,ps_partkey_prf#4508,ps_supplycost_prf#4509,ps_suppkey_prf#4510] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#4519 AS p_comment_prf_1#4529, p_name_prf#4520 AS p_name_prf_1#4530, rid#4521 AS rid_1#4531, p_type_prf#4522 AS p_type_prf_1#4532, p_retailprice_prf#4523 AS p_retailprice_prf_1#4533, p_mfgr_prf#4524 AS p_mfgr_prf_1#4534, p_container_prf#4525 AS p_container_prf_1#4535, p_brand_prf#4526 AS p_brand_prf_1#4536, p_size_prf#4527 AS p_size_prf_1#4537, p_partkey_prf#4528 AS p_partkey_prf_1#4538]
         :     :     +- Relation[p_comment_prf#4519,p_name_prf#4520,rid#4521,p_type_prf#4522,p_retailprice_prf#4523,p_mfgr_prf#4524,p_container_prf#4525,p_brand_prf#4526,p_size_prf#4527,p_partkey_prf#4528] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4540 AS s_phone_prf_2#4548, rid#4541 AS rid_2#4549, s_address_prf#4542 AS s_address_prf_2#4550, s_nationkey_prf#4543 AS s_nationkey_prf_2#4551, s_suppkey_prf#4544 AS s_suppkey_prf_2#4552, s_name_prf#4545 AS s_name_prf_2#4553, s_acctbal_prf#4546 AS s_acctbal_prf_2#4554, s_comment_prf#4547 AS s_comment_prf_2#4555]
            +- Relation[s_phone_prf#4540,rid#4541,s_address_prf#4542,s_nationkey_prf#4543,s_suppkey_prf#4544,s_name_prf#4545,s_acctbal_prf#4546,s_comment_prf#4547] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 106735ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/14 15:13:58 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 15:13:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4616L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 15:13:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4616L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_2#4634]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#4627: string
         :     :- Project [s_phone_prf#4618 AS s_phone_prf_0#4626, rid#4619 AS rid_0#4627, s_address_prf#4620 AS s_address_prf_0#4628, s_nationkey_prf#4621 AS s_nationkey_prf_0#4629, s_suppkey_prf#4622 AS s_suppkey_prf_0#4630, s_name_prf#4623 AS s_name_prf_0#4631, s_acctbal_prf#4624 AS s_acctbal_prf_0#4632, s_comment_prf#4625 AS s_comment_prf_0#4633]
         :     :  +- Relation[s_phone_prf#4618,rid#4619,s_address_prf#4620,s_nationkey_prf#4621,s_suppkey_prf#4622,s_name_prf#4623,s_acctbal_prf#4624,s_comment_prf#4625] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1584) AS rid_2#4655]
            :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#4647: string
            :     :- Project [p_comment_prf#4635 AS p_comment_prf_1#4645, p_name_prf#4636 AS p_name_prf_1#4646, rid#4637 AS rid_1#4647, p_type_prf#4638 AS p_type_prf_1#4648, p_retailprice_prf#4639 AS p_retailprice_prf_1#4649, p_mfgr_prf#4640 AS p_mfgr_prf_1#4650, p_container_prf#4641 AS p_container_prf_1#4651, p_brand_prf#4642 AS p_brand_prf_1#4652, p_size_prf#4643 AS p_size_prf_1#4653, p_partkey_prf#4644 AS p_partkey_prf_1#4654]
            :     :  +- Relation[p_comment_prf#4635,p_name_prf#4636,rid#4637,p_type_prf#4638,p_retailprice_prf#4639,p_mfgr_prf#4640,p_container_prf#4641,p_brand_prf#4642,p_size_prf#4643,p_partkey_prf#4644] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4656 AS l_returnflag_prf_2#4675, l_orderkey_and_l_linenumber_prf#4657 AS l_orderkey_and_l_linenumber_prf_2#4676, l_comment_prf#4658 AS l_comment_prf_2#4677, l_linestatus_prf#4659 AS l_linestatus_prf_2#4678, rid#4660 AS rid_2#4679, l_shipmode_prf#4661 AS l_shipmode_prf_2#4680, l_shipinstruct_prf#4662 AS l_shipinstruct_prf_2#4681, l_quantity_prf#4663 AS l_quantity_prf_2#4682, l_receiptdate_prf#4664 AS l_receiptdate_prf_2#4683, l_linenumber_prf#4665 AS l_linenumber_prf_2#4684, l_tax_prf#4666 AS l_tax_prf_2#4685, l_shipdate_prf#4667 AS l_shipdate_prf_2#4686, l_extendedprice_prf#4668 AS l_extendedprice_prf_2#4687, l_partkey_prf#4669 AS l_partkey_prf_2#4688, l_discount_prf#4670 AS l_discount_prf_2#4689, l_partkey_and_l_suppkey_prf#4671 AS l_partkey_and_l_suppkey_prf_2#4690, l_commitdate_prf#4672 AS l_commitdate_prf_2#4691, l_suppkey_prf#4673 AS l_suppkey_prf_2#4692, l_orderkey_prf#4674 AS l_orderkey_prf_2#4693]
               +- Relation[l_returnflag_prf#4656,l_orderkey_and_l_linenumber_prf#4657,l_comment_prf#4658,l_linestatus_prf#4659,rid#4660,l_shipmode_prf#4661,l_shipinstruct_prf#4662,l_quantity_prf#4663,l_receiptdate_prf#4664,l_linenumber_prf#4665,l_tax_prf#4666,l_shipdate_prf#4667,l_extendedprice_prf#4668,l_partkey_prf#4669,l_discount_prf#4670,l_partkey_and_l_suppkey_prf#4671,l_commitdate_prf#4672,l_suppkey_prf#4673,l_orderkey_prf#4674] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 187664ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/14 15:17:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 15:17:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4745L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 15:17:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4745L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#4757]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#4752: string
         :     :- Project [rid#4747 AS rid_0#4752, n_regionkey_prf#4748 AS n_regionkey_prf_0#4753, n_nationkey_prf#4749 AS n_nationkey_prf_0#4754, n_name_prf#4750 AS n_name_prf_0#4755, n_comment_prf#4751 AS n_comment_prf_0#4756]
         :     :  +- Relation[rid#4747,n_regionkey_prf#4748,n_nationkey_prf#4749,n_name_prf#4750,n_comment_prf#4751] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4758 AS s_phone_prf_1#4766, rid#4759 AS rid_1#4767, s_address_prf#4760 AS s_address_prf_1#4768, s_nationkey_prf#4761 AS s_nationkey_prf_1#4769, s_suppkey_prf#4762 AS s_suppkey_prf_1#4770, s_name_prf#4763 AS s_name_prf_1#4771, s_acctbal_prf#4764 AS s_acctbal_prf_1#4772, s_comment_prf#4765 AS s_comment_prf_1#4773]
            +- Relation[s_phone_prf#4758,rid#4759,s_address_prf#4760,s_nationkey_prf#4761,s_suppkey_prf#4762,s_name_prf#4763,s_acctbal_prf#4764,s_comment_prf#4765] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=10000
Elapsed time: 188ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/14 15:17:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 15:17:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4815L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 15:17:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4815L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#4837]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#4828: string
         :     :- Project [o_shippriority_prf#4817 AS o_shippriority_prf_0#4827, rid#4818 AS rid_0#4828, o_orderdate_prf#4819 AS o_orderdate_prf_0#4829, o_custkey_prf#4820 AS o_custkey_prf_0#4830, o_orderpriority_prf#4821 AS o_orderpriority_prf_0#4831, o_clerk_prf#4822 AS o_clerk_prf_0#4832, o_orderstatus_prf#4823 AS o_orderstatus_prf_0#4833, o_totalprice_prf#4824 AS o_totalprice_prf_0#4834, o_orderkey_prf#4825 AS o_orderkey_prf_0#4835, o_comment_prf#4826 AS o_comment_prf_0#4836]
         :     :  +- Relation[o_shippriority_prf#4817,rid#4818,o_orderdate_prf#4819,o_custkey_prf#4820,o_orderpriority_prf#4821,o_clerk_prf#4822,o_orderstatus_prf#4823,o_totalprice_prf#4824,o_orderkey_prf#4825,o_comment_prf#4826] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4838 AS l_returnflag_prf_1#4857, l_orderkey_and_l_linenumber_prf#4839 AS l_orderkey_and_l_linenumber_prf_1#4858, l_comment_prf#4840 AS l_comment_prf_1#4859, l_linestatus_prf#4841 AS l_linestatus_prf_1#4860, rid#4842 AS rid_1#4861, l_shipmode_prf#4843 AS l_shipmode_prf_1#4862, l_shipinstruct_prf#4844 AS l_shipinstruct_prf_1#4863, l_quantity_prf#4845 AS l_quantity_prf_1#4864, l_receiptdate_prf#4846 AS l_receiptdate_prf_1#4865, l_linenumber_prf#4847 AS l_linenumber_prf_1#4866, l_tax_prf#4848 AS l_tax_prf_1#4867, l_shipdate_prf#4849 AS l_shipdate_prf_1#4868, l_extendedprice_prf#4850 AS l_extendedprice_prf_1#4869, l_partkey_prf#4851 AS l_partkey_prf_1#4870, l_discount_prf#4852 AS l_discount_prf_1#4871, l_partkey_and_l_suppkey_prf#4853 AS l_partkey_and_l_suppkey_prf_1#4872, l_commitdate_prf#4854 AS l_commitdate_prf_1#4873, l_suppkey_prf#4855 AS l_suppkey_prf_1#4874, l_orderkey_prf#4856 AS l_orderkey_prf_1#4875]
            +- Relation[l_returnflag_prf#4838,l_orderkey_and_l_linenumber_prf#4839,l_comment_prf#4840,l_linestatus_prf#4841,rid#4842,l_shipmode_prf#4843,l_shipinstruct_prf#4844,l_quantity_prf#4845,l_receiptdate_prf#4846,l_linenumber_prf#4847,l_tax_prf#4848,l_shipdate_prf#4849,l_extendedprice_prf#4850,l_partkey_prf#4851,l_discount_prf#4852,l_partkey_and_l_suppkey_prf#4853,l_commitdate_prf#4854,l_suppkey_prf#4855,l_orderkey_prf#4856] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 195083ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/14 15:20:21 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 15:20:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4915L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 15:20:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4915L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#4925]
         :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#4924: string
         :     :- Project [r_regionkey_prf#4917 AS r_regionkey_prf_0#4921, r_name_prf#4918 AS r_name_prf_0#4922, r_comment_prf#4919 AS r_comment_prf_0#4923, rid#4920 AS rid_0#4924]
         :     :  +- Relation[r_regionkey_prf#4917,r_name_prf#4918,r_comment_prf#4919,rid#4920] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#4926 AS rid_1#4931, n_regionkey_prf#4927 AS n_regionkey_prf_1#4932, n_nationkey_prf#4928 AS n_nationkey_prf_1#4933, n_name_prf#4929 AS n_name_prf_1#4934, n_comment_prf#4930 AS n_comment_prf_1#4935]
            +- Relation[rid#4926,n_regionkey_prf#4927,n_nationkey_prf#4928,n_name_prf#4929,n_comment_prf#4930] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=25
Elapsed time: 66ms

f1=
select * from region where r_name = 'EUROPE'
19/10/14 15:20:21 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 15:20:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4951L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/14 15:20:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4951L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#4953 AS r_regionkey_prf_0#4957, r_name_prf#4954 AS r_name_prf_0#4958, r_comment_prf#4955 AS r_comment_prf_0#4959, rid#4956 AS rid_0#4960]
         :  +- Relation[r_regionkey_prf#4953,r_name_prf#4954,r_comment_prf#4955,rid#4956] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4961]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 51ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/14 15:20:21 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 15:20:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4988L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 15:20:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4988L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_2#5008]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#5000: string
         :     :- Project [c_acctbal_prf#4990 AS c_acctbal_prf_0#4999, rid#4991 AS rid_0#5000, c_name_prf#4992 AS c_name_prf_0#5001, c_nationkey_prf#4993 AS c_nationkey_prf_0#5002, c_custkey_prf#4994 AS c_custkey_prf_0#5003, c_comment_prf#4995 AS c_comment_prf_0#5004, c_address_prf#4996 AS c_address_prf_0#5005, c_mktsegment_prf#4997 AS c_mktsegment_prf_0#5006, c_phone_prf#4998 AS c_phone_prf_0#5007]
         :     :  +- Relation[c_acctbal_prf#4990,rid#4991,c_name_prf#4992,c_nationkey_prf#4993,c_custkey_prf#4994,c_comment_prf#4995,c_address_prf#4996,c_mktsegment_prf#4997,c_phone_prf#4998] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1584) AS rid_2#5025]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#5018: string
            :     :- Project [s_phone_prf#5009 AS s_phone_prf_1#5017, rid#5010 AS rid_1#5018, s_address_prf#5011 AS s_address_prf_1#5019, s_nationkey_prf#5012 AS s_nationkey_prf_1#5020, s_suppkey_prf#5013 AS s_suppkey_prf_1#5021, s_name_prf#5014 AS s_name_prf_1#5022, s_acctbal_prf#5015 AS s_acctbal_prf_1#5023, s_comment_prf#5016 AS s_comment_prf_1#5024]
            :     :  +- Relation[s_phone_prf#5009,rid#5010,s_address_prf#5011,s_nationkey_prf#5012,s_suppkey_prf#5013,s_name_prf#5014,s_acctbal_prf#5015,s_comment_prf#5016] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [rid#5026 AS rid_2#5031, n_regionkey_prf#5027 AS n_regionkey_prf_2#5032, n_nationkey_prf#5028 AS n_nationkey_prf_2#5033, n_name_prf#5029 AS n_name_prf_2#5034, n_comment_prf#5030 AS n_comment_prf_2#5035]
               +- Relation[rid#5026,n_regionkey_prf#5027,n_nationkey_prf#5028,n_name_prf#5029,n_comment_prf#5030] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 42703ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/14 15:21:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 15:21:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5086L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 15:21:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5086L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#5108]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#5099: string
         :     :- Project [o_shippriority_prf#5088 AS o_shippriority_prf_0#5098, rid#5089 AS rid_0#5099, o_orderdate_prf#5090 AS o_orderdate_prf_0#5100, o_custkey_prf#5091 AS o_custkey_prf_0#5101, o_orderpriority_prf#5092 AS o_orderpriority_prf_0#5102, o_clerk_prf#5093 AS o_clerk_prf_0#5103, o_orderstatus_prf#5094 AS o_orderstatus_prf_0#5104, o_totalprice_prf#5095 AS o_totalprice_prf_0#5105, o_orderkey_prf#5096 AS o_orderkey_prf_0#5106, o_comment_prf#5097 AS o_comment_prf_0#5107]
         :     :  +- Relation[o_shippriority_prf#5088,rid#5089,o_orderdate_prf#5090,o_custkey_prf#5091,o_orderpriority_prf#5092,o_clerk_prf#5093,o_orderstatus_prf#5094,o_totalprice_prf#5095,o_orderkey_prf#5096,o_comment_prf#5097] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#5109 AS l_returnflag_prf_1#5128, l_orderkey_and_l_linenumber_prf#5110 AS l_orderkey_and_l_linenumber_prf_1#5129, l_comment_prf#5111 AS l_comment_prf_1#5130, l_linestatus_prf#5112 AS l_linestatus_prf_1#5131, rid#5113 AS rid_1#5132, l_shipmode_prf#5114 AS l_shipmode_prf_1#5133, l_shipinstruct_prf#5115 AS l_shipinstruct_prf_1#5134, l_quantity_prf#5116 AS l_quantity_prf_1#5135, l_receiptdate_prf#5117 AS l_receiptdate_prf_1#5136, l_linenumber_prf#5118 AS l_linenumber_prf_1#5137, l_tax_prf#5119 AS l_tax_prf_1#5138, l_shipdate_prf#5120 AS l_shipdate_prf_1#5139, l_extendedprice_prf#5121 AS l_extendedprice_prf_1#5140, l_partkey_prf#5122 AS l_partkey_prf_1#5141, l_discount_prf#5123 AS l_discount_prf_1#5142, l_partkey_and_l_suppkey_prf#5124 AS l_partkey_and_l_suppkey_prf_1#5143, l_commitdate_prf#5125 AS l_commitdate_prf_1#5144, l_suppkey_prf#5126 AS l_suppkey_prf_1#5145, l_orderkey_prf#5127 AS l_orderkey_prf_1#5146]
            :  +- Relation[l_returnflag_prf#5109,l_orderkey_and_l_linenumber_prf#5110,l_comment_prf#5111,l_linestatus_prf#5112,rid#5113,l_shipmode_prf#5114,l_shipinstruct_prf#5115,l_quantity_prf#5116,l_receiptdate_prf#5117,l_linenumber_prf#5118,l_tax_prf#5119,l_shipdate_prf#5120,l_extendedprice_prf#5121,l_partkey_prf#5122,l_discount_prf#5123,l_partkey_and_l_suppkey_prf#5124,l_commitdate_prf#5125,l_suppkey_prf#5126,l_orderkey_prf#5127] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5147]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 197114ms

f2=
select * from part where p_size = 15
19/10/14 15:24:21 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 15:24:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5189L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 15:24:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5189L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#5191 AS p_comment_prf_0#5201, p_name_prf#5192 AS p_name_prf_0#5202, rid#5193 AS rid_0#5203, p_type_prf#5194 AS p_type_prf_0#5204, p_retailprice_prf#5195 AS p_retailprice_prf_0#5205, p_mfgr_prf#5196 AS p_mfgr_prf_0#5206, p_container_prf#5197 AS p_container_prf_0#5207, p_brand_prf#5198 AS p_brand_prf_0#5208, p_size_prf#5199 AS p_size_prf_0#5209, p_partkey_prf#5200 AS p_partkey_prf_0#5210]
         :  +- Relation[p_comment_prf#5191,p_name_prf#5192,rid#5193,p_type_prf#5194,p_retailprice_prf#5195,p_mfgr_prf#5196,p_container_prf#5197,p_brand_prf#5198,p_size_prf#5199,p_partkey_prf#5200] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5211]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3907
Elapsed time: 129ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/14 15:24:21 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 15:24:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5246L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 15:24:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5246L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1584) AS rid_2#5283]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#5268]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#5260: string
         :     :  :     :- Project [p_comment_prf#5248 AS p_comment_prf_0#5258, p_name_prf#5249 AS p_name_prf_0#5259, rid#5250 AS rid_0#5260, p_type_prf#5251 AS p_type_prf_0#5261, p_retailprice_prf#5252 AS p_retailprice_prf_0#5262, p_mfgr_prf#5253 AS p_mfgr_prf_0#5263, p_container_prf#5254 AS p_container_prf_0#5264, p_brand_prf#5255 AS p_brand_prf_0#5265, p_size_prf#5256 AS p_size_prf_0#5266, p_partkey_prf#5257 AS p_partkey_prf_0#5267]
         :     :  :     :  +- Relation[p_comment_prf#5248,p_name_prf#5249,rid#5250,p_type_prf#5251,p_retailprice_prf#5252,p_mfgr_prf#5253,p_container_prf#5254,p_brand_prf#5255,p_size_prf#5256,p_partkey_prf#5257] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#5269 AS ps_partkey_and_ps_suppkey_prf_1#5276, rid#5270 AS rid_1#5277, ps_availqty_prf#5271 AS ps_availqty_prf_1#5278, ps_comment_prf#5272 AS ps_comment_prf_1#5279, ps_partkey_prf#5273 AS ps_partkey_prf_1#5280, ps_supplycost_prf#5274 AS ps_supplycost_prf_1#5281, ps_suppkey_prf#5275 AS ps_suppkey_prf_1#5282]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#5269,rid#5270,ps_availqty_prf#5271,ps_comment_prf#5272,ps_partkey_prf#5273,ps_supplycost_prf#5274,ps_suppkey_prf#5275] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5284 AS s_phone_prf_2#5292, rid#5285 AS rid_2#5293, s_address_prf#5286 AS s_address_prf_2#5294, s_nationkey_prf#5287 AS s_nationkey_prf_2#5295, s_suppkey_prf#5288 AS s_suppkey_prf_2#5296, s_name_prf#5289 AS s_name_prf_2#5297, s_acctbal_prf#5290 AS s_acctbal_prf_2#5298, s_comment_prf#5291 AS s_comment_prf_2#5299]
            +- Relation[s_phone_prf#5284,rid#5285,s_address_prf#5286,s_nationkey_prf#5287,s_suppkey_prf#5288,s_name_prf#5289,s_acctbal_prf#5290,s_comment_prf#5291] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 88649ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/14 15:25:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 15:25:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5347L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 15:25:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5347L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#1584) AS rid_2#5376]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1584) AS rid_1#5365]
         :     :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#5358: string
         :     :  :     :- Project [s_phone_prf#5349 AS s_phone_prf_0#5357, rid#5350 AS rid_0#5358, s_address_prf#5351 AS s_address_prf_0#5359, s_nationkey_prf#5352 AS s_nationkey_prf_0#5360, s_suppkey_prf#5353 AS s_suppkey_prf_0#5361, s_name_prf#5354 AS s_name_prf_0#5362, s_acctbal_prf#5355 AS s_acctbal_prf_0#5363, s_comment_prf#5356 AS s_comment_prf_0#5364]
         :     :  :     :  +- Relation[s_phone_prf#5349,rid#5350,s_address_prf#5351,s_nationkey_prf#5352,s_suppkey_prf#5353,s_name_prf#5354,s_acctbal_prf#5355,s_comment_prf#5356] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [rid#5366 AS rid_1#5371, n_regionkey_prf#5367 AS n_regionkey_prf_1#5372, n_nationkey_prf#5368 AS n_nationkey_prf_1#5373, n_name_prf#5369 AS n_name_prf_1#5374, n_comment_prf#5370 AS n_comment_prf_1#5375]
         :     :     +- Relation[rid#5366,n_regionkey_prf#5367,n_nationkey_prf#5368,n_name_prf#5369,n_comment_prf#5370] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1583,value#1584] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#5377 AS c_acctbal_prf_2#5386, rid#5378 AS rid_2#5387, c_name_prf#5379 AS c_name_prf_2#5388, c_nationkey_prf#5380 AS c_nationkey_prf_2#5389, c_custkey_prf#5381 AS c_custkey_prf_2#5390, c_comment_prf#5382 AS c_comment_prf_2#5391, c_address_prf#5383 AS c_address_prf_2#5392, c_mktsegment_prf#5384 AS c_mktsegment_prf_2#5393, c_phone_prf#5385 AS c_phone_prf_2#5394]
            +- Relation[c_acctbal_prf#5377,rid#5378,c_name_prf#5379,c_nationkey_prf#5380,c_custkey_prf#5381,c_comment_prf#5382,c_address_prf#5383,c_mktsegment_prf#5384,c_phone_prf#5385] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 667849ms
query=b1a, count=15628, duration=426
query=b1b, count=15628, duration=49382
query=b2a, count=1478870, duration=197114
query=b2b, count=1478870, duration=54278
query=f1, count=1, duration=51
query=f2, count=3907, duration=129
query=f3, count=1451, duration=83
query=f4, count=1, duration=54
query=f5, count=1478870, duration=23419
query=f6, count=857401, duration=13960
query=j1, count=800000, duration=31668
query=j10, count=6001215, duration=86454
query=j2, count=800000, duration=10982
query=j3, count=25, duration=66
query=j4, count=150000, duration=1934
query=j5, count=10000, duration=188
query=j6, count=6001215, duration=116750
query=j7, count=1500000, duration=40379
query=j8, count=6001215, duration=195083
query=j8b, count=6001215, duration=114223
query=j9, count=6001215, duration=94583
query=j9b, count=6001215, duration=117882
query=r1a, count=6001215, duration=333663
query=r1b, count=6001215, duration=148597
query=r1c, count=6001215, duration=157715
query=r1d, count=6001215, duration=269782
query=r1e, count=6001215, duration=234406
query=r1f, count=6001215, duration=157443
query=t1a, count=60000414, duration=667849
query=t1b, count=60000414, duration=774931
query=t1c, count=60000414, duration=42703
query=t2a, count=800000, duration=106735
query=t2b, count=800000, duration=88649
query=t2c, count=800000, duration=42816
query=t2d, count=800000, duration=61515
query=t3a, count=6001215, duration=263641
query=t3b, count=6001215, duration=289855
query=t3c, count=6001215, duration=187664
query=t3d, count=6001215, duration=186248
