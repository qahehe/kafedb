19/10/14 17:03:33 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7153ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Mon Oct 14 17:03:36 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Mon Oct 14 17:03:37 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Mon Oct 14 17:03:37 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Mon Oct 14 17:03:37 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Mon Oct 14 17:03:37 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Mon Oct 14 17:03:39 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Mon Oct 14 17:03:42 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Mon Oct 14 17:03:42 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/14 17:03:43 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:03:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1494L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 17:03:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1494L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#1514]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#1505: string
         :     :- Project [s_phone_prf#1496 AS s_phone_prf_0#1504, rid#1497 AS rid_0#1505, s_address_prf#1498 AS s_address_prf_0#1506, s_nationkey_prf#1499 AS s_nationkey_prf_0#1507, s_suppkey_prf#1500 AS s_suppkey_prf_0#1508, s_name_prf#1501 AS s_name_prf_0#1509, s_acctbal_prf#1502 AS s_acctbal_prf_0#1510, s_comment_prf#1503 AS s_comment_prf_0#1511]
         :     :  +- Relation[s_phone_prf#1496,rid#1497,s_address_prf#1498,s_nationkey_prf#1499,s_suppkey_prf#1500,s_name_prf#1501,s_acctbal_prf#1502,s_comment_prf#1503] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1515 AS l_returnflag_prf_1#1534, l_orderkey_and_l_linenumber_prf#1516 AS l_orderkey_and_l_linenumber_prf_1#1535, l_comment_prf#1517 AS l_comment_prf_1#1536, l_linestatus_prf#1518 AS l_linestatus_prf_1#1537, rid#1519 AS rid_1#1538, l_shipmode_prf#1520 AS l_shipmode_prf_1#1539, l_shipinstruct_prf#1521 AS l_shipinstruct_prf_1#1540, l_quantity_prf#1522 AS l_quantity_prf_1#1541, l_receiptdate_prf#1523 AS l_receiptdate_prf_1#1542, l_linenumber_prf#1524 AS l_linenumber_prf_1#1543, l_tax_prf#1525 AS l_tax_prf_1#1544, l_shipdate_prf#1526 AS l_shipdate_prf_1#1545, l_extendedprice_prf#1527 AS l_extendedprice_prf_1#1546, l_partkey_prf#1528 AS l_partkey_prf_1#1547, l_discount_prf#1529 AS l_discount_prf_1#1548, l_partkey_and_l_suppkey_prf#1530 AS l_partkey_and_l_suppkey_prf_1#1549, l_commitdate_prf#1531 AS l_commitdate_prf_1#1550, l_suppkey_prf#1532 AS l_suppkey_prf_1#1551, l_orderkey_prf#1533 AS l_orderkey_prf_1#1552]
            +- Relation[l_returnflag_prf#1515,l_orderkey_and_l_linenumber_prf#1516,l_comment_prf#1517,l_linestatus_prf#1518,rid#1519,l_shipmode_prf#1520,l_shipinstruct_prf#1521,l_quantity_prf#1522,l_receiptdate_prf#1523,l_linenumber_prf#1524,l_tax_prf#1525,l_shipdate_prf#1526,l_extendedprice_prf#1527,l_partkey_prf#1528,l_discount_prf#1529,l_partkey_and_l_suppkey_prf#1530,l_commitdate_prf#1531,l_suppkey_prf#1532,l_orderkey_prf#1533] JDBCRelation(lineitem_prf) [numPartitions=1]

19/10/14 17:03:43 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=6001215
Elapsed time: 86489ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/14 17:05:09 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:05:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1616L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 17:05:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1616L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1513) AS rid_2#1657]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#1636]
         :     :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#1628: string
         :     :  :     :- Project [c_acctbal_prf#1618 AS c_acctbal_prf_0#1627, rid#1619 AS rid_0#1628, c_name_prf#1620 AS c_name_prf_0#1629, c_nationkey_prf#1621 AS c_nationkey_prf_0#1630, c_custkey_prf#1622 AS c_custkey_prf_0#1631, c_comment_prf#1623 AS c_comment_prf_0#1632, c_address_prf#1624 AS c_address_prf_0#1633, c_mktsegment_prf#1625 AS c_mktsegment_prf_0#1634, c_phone_prf#1626 AS c_phone_prf_0#1635]
         :     :  :     :  +- Relation[c_acctbal_prf#1618,rid#1619,c_name_prf#1620,c_nationkey_prf#1621,c_custkey_prf#1622,c_comment_prf#1623,c_address_prf#1624,c_mktsegment_prf#1625,c_phone_prf#1626] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#1637 AS o_shippriority_prf_1#1647, rid#1638 AS rid_1#1648, o_orderdate_prf#1639 AS o_orderdate_prf_1#1649, o_custkey_prf#1640 AS o_custkey_prf_1#1650, o_orderpriority_prf#1641 AS o_orderpriority_prf_1#1651, o_clerk_prf#1642 AS o_clerk_prf_1#1652, o_orderstatus_prf#1643 AS o_orderstatus_prf_1#1653, o_totalprice_prf#1644 AS o_totalprice_prf_1#1654, o_orderkey_prf#1645 AS o_orderkey_prf_1#1655, o_comment_prf#1646 AS o_comment_prf_1#1656]
         :     :     +- Relation[o_shippriority_prf#1637,rid#1638,o_orderdate_prf#1639,o_custkey_prf#1640,o_orderpriority_prf#1641,o_clerk_prf#1642,o_orderstatus_prf#1643,o_totalprice_prf#1644,o_orderkey_prf#1645,o_comment_prf#1646] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1658 AS l_returnflag_prf_2#1677, l_orderkey_and_l_linenumber_prf#1659 AS l_orderkey_and_l_linenumber_prf_2#1678, l_comment_prf#1660 AS l_comment_prf_2#1679, l_linestatus_prf#1661 AS l_linestatus_prf_2#1680, rid#1662 AS rid_2#1681, l_shipmode_prf#1663 AS l_shipmode_prf_2#1682, l_shipinstruct_prf#1664 AS l_shipinstruct_prf_2#1683, l_quantity_prf#1665 AS l_quantity_prf_2#1684, l_receiptdate_prf#1666 AS l_receiptdate_prf_2#1685, l_linenumber_prf#1667 AS l_linenumber_prf_2#1686, l_tax_prf#1668 AS l_tax_prf_2#1687, l_shipdate_prf#1669 AS l_shipdate_prf_2#1688, l_extendedprice_prf#1670 AS l_extendedprice_prf_2#1689, l_partkey_prf#1671 AS l_partkey_prf_2#1690, l_discount_prf#1672 AS l_discount_prf_2#1691, l_partkey_and_l_suppkey_prf#1673 AS l_partkey_and_l_suppkey_prf_2#1692, l_commitdate_prf#1674 AS l_commitdate_prf_2#1693, l_suppkey_prf#1675 AS l_suppkey_prf_2#1694, l_orderkey_prf#1676 AS l_orderkey_prf_2#1695]
            +- Relation[l_returnflag_prf#1658,l_orderkey_and_l_linenumber_prf#1659,l_comment_prf#1660,l_linestatus_prf#1661,rid#1662,l_shipmode_prf#1663,l_shipinstruct_prf#1664,l_quantity_prf#1665,l_receiptdate_prf#1666,l_linenumber_prf#1667,l_tax_prf#1668,l_shipdate_prf#1669,l_extendedprice_prf#1670,l_partkey_prf#1671,l_discount_prf#1672,l_partkey_and_l_suppkey_prf#1673,l_commitdate_prf#1674,l_suppkey_prf#1675,l_orderkey_prf#1676] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 270788ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/14 17:09:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:09:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1754L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 17:09:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1754L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#1774]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#1766: string
         :     :- Project [c_acctbal_prf#1756 AS c_acctbal_prf_0#1765, rid#1757 AS rid_0#1766, c_name_prf#1758 AS c_name_prf_0#1767, c_nationkey_prf#1759 AS c_nationkey_prf_0#1768, c_custkey_prf#1760 AS c_custkey_prf_0#1769, c_comment_prf#1761 AS c_comment_prf_0#1770, c_address_prf#1762 AS c_address_prf_0#1771, c_mktsegment_prf#1763 AS c_mktsegment_prf_0#1772, c_phone_prf#1764 AS c_phone_prf_0#1773]
         :     :  +- Relation[c_acctbal_prf#1756,rid#1757,c_name_prf#1758,c_nationkey_prf#1759,c_custkey_prf#1760,c_comment_prf#1761,c_address_prf#1762,c_mktsegment_prf#1763,c_phone_prf#1764] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#1775 AS o_shippriority_prf_1#1785, rid#1776 AS rid_1#1786, o_orderdate_prf#1777 AS o_orderdate_prf_1#1787, o_custkey_prf#1778 AS o_custkey_prf_1#1788, o_orderpriority_prf#1779 AS o_orderpriority_prf_1#1789, o_clerk_prf#1780 AS o_clerk_prf_1#1790, o_orderstatus_prf#1781 AS o_orderstatus_prf_1#1791, o_totalprice_prf#1782 AS o_totalprice_prf_1#1792, o_orderkey_prf#1783 AS o_orderkey_prf_1#1793, o_comment_prf#1784 AS o_comment_prf_1#1794]
            +- Relation[o_shippriority_prf#1775,rid#1776,o_orderdate_prf#1777,o_custkey_prf#1778,o_orderpriority_prf#1779,o_clerk_prf#1780,o_orderstatus_prf#1781,o_totalprice_prf#1782,o_orderkey_prf#1783,o_comment_prf#1784] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1500000
Elapsed time: 40195ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/14 17:10:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:10:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1824L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 17:10:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1824L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#1834]
         :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#1833: string
         :     :- Project [r_regionkey_prf#1826 AS r_regionkey_prf_0#1830, r_name_prf#1827 AS r_name_prf_0#1831, r_comment_prf#1828 AS r_comment_prf_0#1832, rid#1829 AS rid_0#1833]
         :     :  +- Relation[r_regionkey_prf#1826,r_name_prf#1827,r_comment_prf#1828,rid#1829] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#1835 AS rid_1#1840, n_regionkey_prf#1836 AS n_regionkey_prf_1#1841, n_nationkey_prf#1837 AS n_nationkey_prf_1#1842, n_name_prf#1838 AS n_name_prf_1#1843, n_comment_prf#1839 AS n_comment_prf_1#1844]
            +- Relation[rid#1835,n_regionkey_prf#1836,n_nationkey_prf#1837,n_name_prf#1838,n_comment_prf#1839] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=25
Elapsed time: 77ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/14 17:10:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:10:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1889L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 17:10:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1889L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#1929]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#1914: string
         :     :  :     :- Project [l_returnflag_prf#1891 AS l_returnflag_prf_0#1910, l_orderkey_and_l_linenumber_prf#1892 AS l_orderkey_and_l_linenumber_prf_0#1911, l_comment_prf#1893 AS l_comment_prf_0#1912, l_linestatus_prf#1894 AS l_linestatus_prf_0#1913, rid#1895 AS rid_0#1914, l_shipmode_prf#1896 AS l_shipmode_prf_0#1915, l_shipinstruct_prf#1897 AS l_shipinstruct_prf_0#1916, l_quantity_prf#1898 AS l_quantity_prf_0#1917, l_receiptdate_prf#1899 AS l_receiptdate_prf_0#1918, l_linenumber_prf#1900 AS l_linenumber_prf_0#1919, l_tax_prf#1901 AS l_tax_prf_0#1920, l_shipdate_prf#1902 AS l_shipdate_prf_0#1921, l_extendedprice_prf#1903 AS l_extendedprice_prf_0#1922, l_partkey_prf#1904 AS l_partkey_prf_0#1923, l_discount_prf#1905 AS l_discount_prf_0#1924, l_partkey_and_l_suppkey_prf#1906 AS l_partkey_and_l_suppkey_prf_0#1925, l_commitdate_prf#1907 AS l_commitdate_prf_0#1926, l_suppkey_prf#1908 AS l_suppkey_prf_0#1927, l_orderkey_prf#1909 AS l_orderkey_prf_0#1928]
         :     :  :     :  +- Relation[l_returnflag_prf#1891,l_orderkey_and_l_linenumber_prf#1892,l_comment_prf#1893,l_linestatus_prf#1894,rid#1895,l_shipmode_prf#1896,l_shipinstruct_prf#1897,l_quantity_prf#1898,l_receiptdate_prf#1899,l_linenumber_prf#1900,l_tax_prf#1901,l_shipdate_prf#1902,l_extendedprice_prf#1903,l_partkey_prf#1904,l_discount_prf#1905,l_partkey_and_l_suppkey_prf#1906,l_commitdate_prf#1907,l_suppkey_prf#1908,l_orderkey_prf#1909] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#1930 AS p_comment_prf_1#1940, p_name_prf#1931 AS p_name_prf_1#1941, rid#1932 AS rid_1#1942, p_type_prf#1933 AS p_type_prf_1#1943, p_retailprice_prf#1934 AS p_retailprice_prf_1#1944, p_mfgr_prf#1935 AS p_mfgr_prf_1#1945, p_container_prf#1936 AS p_container_prf_1#1946, p_brand_prf#1937 AS p_brand_prf_1#1947, p_size_prf#1938 AS p_size_prf_1#1948, p_partkey_prf#1939 AS p_partkey_prf_1#1949]
         :     :     +- Relation[p_comment_prf#1930,p_name_prf#1931,rid#1932,p_type_prf#1933,p_retailprice_prf#1934,p_mfgr_prf#1935,p_container_prf#1936,p_brand_prf#1937,p_size_prf#1938,p_partkey_prf#1939] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#1951 AS s_phone_prf_2#1959, rid#1952 AS rid_2#1960, s_address_prf#1953 AS s_address_prf_2#1961, s_nationkey_prf#1954 AS s_nationkey_prf_2#1962, s_suppkey_prf#1955 AS s_suppkey_prf_2#1963, s_name_prf#1956 AS s_name_prf_2#1964, s_acctbal_prf#1957 AS s_acctbal_prf_2#1965, s_comment_prf#1958 AS s_comment_prf_2#1966]
            +- Relation[s_phone_prf#1951,rid#1952,s_address_prf#1953,s_nationkey_prf#1954,s_suppkey_prf#1955,s_name_prf#1956,s_acctbal_prf#1957,s_comment_prf#1958] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 262193ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/14 17:14:43 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:14:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2019L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 17:14:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2019L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#2031]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#2026: string
         :     :- Project [rid#2021 AS rid_0#2026, n_regionkey_prf#2022 AS n_regionkey_prf_0#2027, n_nationkey_prf#2023 AS n_nationkey_prf_0#2028, n_name_prf#2024 AS n_name_prf_0#2029, n_comment_prf#2025 AS n_comment_prf_0#2030]
         :     :  +- Relation[rid#2021,n_regionkey_prf#2022,n_nationkey_prf#2023,n_name_prf#2024,n_comment_prf#2025] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2032 AS c_acctbal_prf_1#2041, rid#2033 AS rid_1#2042, c_name_prf#2034 AS c_name_prf_1#2043, c_nationkey_prf#2035 AS c_nationkey_prf_1#2044, c_custkey_prf#2036 AS c_custkey_prf_1#2045, c_comment_prf#2037 AS c_comment_prf_1#2046, c_address_prf#2038 AS c_address_prf_1#2047, c_mktsegment_prf#2039 AS c_mktsegment_prf_1#2048, c_phone_prf#2040 AS c_phone_prf_1#2049]
            +- Relation[c_acctbal_prf#2032,rid#2033,c_name_prf#2034,c_nationkey_prf#2035,c_custkey_prf#2036,c_comment_prf#2037,c_address_prf#2038,c_mktsegment_prf#2039,c_phone_prf#2040] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=150000
Elapsed time: 1938ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/14 17:14:45 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:14:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2071L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 17:14:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2071L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#2073 AS rid_0#2078, n_regionkey_prf#2074 AS n_regionkey_prf_0#2079, n_nationkey_prf#2075 AS n_nationkey_prf_0#2080, n_name_prf#2076 AS n_name_prf_0#2081, n_comment_prf#2077 AS n_comment_prf_0#2082]
         :  +- Relation[rid#2073,n_regionkey_prf#2074,n_nationkey_prf#2075,n_name_prf#2076,n_comment_prf#2077] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2085]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#2083,value#2084] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 64ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/14 17:14:45 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:14:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2103L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 17:14:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2103L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#2105 AS p_comment_prf_0#2115, p_name_prf#2106 AS p_name_prf_0#2116, rid#2107 AS rid_0#2117, p_type_prf#2108 AS p_type_prf_0#2118, p_retailprice_prf#2109 AS p_retailprice_prf_0#2119, p_mfgr_prf#2110 AS p_mfgr_prf_0#2120, p_container_prf#2111 AS p_container_prf_0#2121, p_brand_prf#2112 AS p_brand_prf_0#2122, p_size_prf#2113 AS p_size_prf_0#2123, p_partkey_prf#2114 AS p_partkey_prf_0#2124]
         :  +- Relation[p_comment_prf#2105,p_name_prf#2106,rid#2107,p_type_prf#2108,p_retailprice_prf#2109,p_mfgr_prf#2110,p_container_prf#2111,p_brand_prf#2112,p_size_prf#2113,p_partkey_prf#2114] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2125]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#2083,value#2084] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1451
Elapsed time: 82ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/14 17:14:45 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:14:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2171L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 17:14:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2171L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#2193]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2185: string
         :     :  :     :- Project [p_comment_prf#2173 AS p_comment_prf_0#2183, p_name_prf#2174 AS p_name_prf_0#2184, rid#2175 AS rid_0#2185, p_type_prf#2176 AS p_type_prf_0#2186, p_retailprice_prf#2177 AS p_retailprice_prf_0#2187, p_mfgr_prf#2178 AS p_mfgr_prf_0#2188, p_container_prf#2179 AS p_container_prf_0#2189, p_brand_prf#2180 AS p_brand_prf_0#2190, p_size_prf#2181 AS p_size_prf_0#2191, p_partkey_prf#2182 AS p_partkey_prf_0#2192]
         :     :  :     :  +- Relation[p_comment_prf#2173,p_name_prf#2174,rid#2175,p_type_prf#2176,p_retailprice_prf#2177,p_mfgr_prf#2178,p_container_prf#2179,p_brand_prf#2180,p_size_prf#2181,p_partkey_prf#2182] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#2194 AS l_returnflag_prf_1#2213, l_orderkey_and_l_linenumber_prf#2195 AS l_orderkey_and_l_linenumber_prf_1#2214, l_comment_prf#2196 AS l_comment_prf_1#2215, l_linestatus_prf#2197 AS l_linestatus_prf_1#2216, rid#2198 AS rid_1#2217, l_shipmode_prf#2199 AS l_shipmode_prf_1#2218, l_shipinstruct_prf#2200 AS l_shipinstruct_prf_1#2219, l_quantity_prf#2201 AS l_quantity_prf_1#2220, l_receiptdate_prf#2202 AS l_receiptdate_prf_1#2221, l_linenumber_prf#2203 AS l_linenumber_prf_1#2222, l_tax_prf#2204 AS l_tax_prf_1#2223, l_shipdate_prf#2205 AS l_shipdate_prf_1#2224, l_extendedprice_prf#2206 AS l_extendedprice_prf_1#2225, l_partkey_prf#2207 AS l_partkey_prf_1#2226, l_discount_prf#2208 AS l_discount_prf_1#2227, l_partkey_and_l_suppkey_prf#2209 AS l_partkey_and_l_suppkey_prf_1#2228, l_commitdate_prf#2210 AS l_commitdate_prf_1#2229, l_suppkey_prf#2211 AS l_suppkey_prf_1#2230, l_orderkey_prf#2212 AS l_orderkey_prf_1#2231]
         :     :     +- Relation[l_returnflag_prf#2194,l_orderkey_and_l_linenumber_prf#2195,l_comment_prf#2196,l_linestatus_prf#2197,rid#2198,l_shipmode_prf#2199,l_shipinstruct_prf#2200,l_quantity_prf#2201,l_receiptdate_prf#2202,l_linenumber_prf#2203,l_tax_prf#2204,l_shipdate_prf#2205,l_extendedprice_prf#2206,l_partkey_prf#2207,l_discount_prf#2208,l_partkey_and_l_suppkey_prf#2209,l_commitdate_prf#2210,l_suppkey_prf#2211,l_orderkey_prf#2212] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2233 AS s_phone_prf_2#2241, rid#2234 AS rid_2#2242, s_address_prf#2235 AS s_address_prf_2#2243, s_nationkey_prf#2236 AS s_nationkey_prf_2#2244, s_suppkey_prf#2237 AS s_suppkey_prf_2#2245, s_name_prf#2238 AS s_name_prf_2#2246, s_acctbal_prf#2239 AS s_acctbal_prf_2#2247, s_comment_prf#2240 AS s_comment_prf_2#2248]
            +- Relation[s_phone_prf#2233,rid#2234,s_address_prf#2235,s_nationkey_prf#2236,s_suppkey_prf#2237,s_name_prf#2238,s_acctbal_prf#2239,s_comment_prf#2240] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 291196ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/14 17:19:36 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:19:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2310L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 17:19:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2310L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1513) AS rid_2#2347]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#2326]
         :     :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#2320: string
         :     :  :     :- Project [ps_partkey_and_ps_suppkey_prf#2312 AS ps_partkey_and_ps_suppkey_prf_0#2319, rid#2313 AS rid_0#2320, ps_availqty_prf#2314 AS ps_availqty_prf_0#2321, ps_comment_prf#2315 AS ps_comment_prf_0#2322, ps_partkey_prf#2316 AS ps_partkey_prf_0#2323, ps_supplycost_prf#2317 AS ps_supplycost_prf_0#2324, ps_suppkey_prf#2318 AS ps_suppkey_prf_0#2325]
         :     :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2312,rid#2313,ps_availqty_prf#2314,ps_comment_prf#2315,ps_partkey_prf#2316,ps_supplycost_prf#2317,ps_suppkey_prf#2318] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#2327 AS p_comment_prf_1#2337, p_name_prf#2328 AS p_name_prf_1#2338, rid#2329 AS rid_1#2339, p_type_prf#2330 AS p_type_prf_1#2340, p_retailprice_prf#2331 AS p_retailprice_prf_1#2341, p_mfgr_prf#2332 AS p_mfgr_prf_1#2342, p_container_prf#2333 AS p_container_prf_1#2343, p_brand_prf#2334 AS p_brand_prf_1#2344, p_size_prf#2335 AS p_size_prf_1#2345, p_partkey_prf#2336 AS p_partkey_prf_1#2346]
         :     :     +- Relation[p_comment_prf#2327,p_name_prf#2328,rid#2329,p_type_prf#2330,p_retailprice_prf#2331,p_mfgr_prf#2332,p_container_prf#2333,p_brand_prf#2334,p_size_prf#2335,p_partkey_prf#2336] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2348 AS s_phone_prf_2#2356, rid#2349 AS rid_2#2357, s_address_prf#2350 AS s_address_prf_2#2358, s_nationkey_prf#2351 AS s_nationkey_prf_2#2359, s_suppkey_prf#2352 AS s_suppkey_prf_2#2360, s_name_prf#2353 AS s_name_prf_2#2361, s_acctbal_prf#2354 AS s_acctbal_prf_2#2362, s_comment_prf#2355 AS s_comment_prf_2#2363]
            +- Relation[s_phone_prf#2348,rid#2349,s_address_prf#2350,s_nationkey_prf#2351,s_suppkey_prf#2352,s_name_prf#2353,s_acctbal_prf#2354,s_comment_prf#2355] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 106686ms

f1=
select * from region where r_name = 'EUROPE'
19/10/14 17:21:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:21:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2395L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/14 17:21:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2395L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#2397 AS r_regionkey_prf_0#2401, r_name_prf#2398 AS r_name_prf_0#2402, r_comment_prf#2399 AS r_comment_prf_0#2403, rid#2400 AS rid_0#2404]
         :  +- Relation[r_regionkey_prf#2397,r_name_prf#2398,r_comment_prf#2399,rid#2400] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2405]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#2083,value#2084] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 56ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/14 17:21:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:21:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2427L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 17:21:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2427L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#2449]
         :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2441: string
         :     :- Project [p_comment_prf#2429 AS p_comment_prf_0#2439, p_name_prf#2430 AS p_name_prf_0#2440, rid#2431 AS rid_0#2441, p_type_prf#2432 AS p_type_prf_0#2442, p_retailprice_prf#2433 AS p_retailprice_prf_0#2443, p_mfgr_prf#2434 AS p_mfgr_prf_0#2444, p_container_prf#2435 AS p_container_prf_0#2445, p_brand_prf#2436 AS p_brand_prf_0#2446, p_size_prf#2437 AS p_size_prf_0#2447, p_partkey_prf#2438 AS p_partkey_prf_0#2448]
         :     :  +- Relation[p_comment_prf#2429,p_name_prf#2430,rid#2431,p_type_prf#2432,p_retailprice_prf#2433,p_mfgr_prf#2434,p_container_prf#2435,p_brand_prf#2436,p_size_prf#2437,p_partkey_prf#2438] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2450 AS ps_partkey_and_ps_suppkey_prf_1#2457, rid#2451 AS rid_1#2458, ps_availqty_prf#2452 AS ps_availqty_prf_1#2459, ps_comment_prf#2453 AS ps_comment_prf_1#2460, ps_partkey_prf#2454 AS ps_partkey_prf_1#2461, ps_supplycost_prf#2455 AS ps_supplycost_prf_1#2462, ps_suppkey_prf#2456 AS ps_suppkey_prf_1#2463]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2450,rid#2451,ps_availqty_prf#2452,ps_comment_prf#2453,ps_partkey_prf#2454,ps_supplycost_prf#2455,ps_suppkey_prf#2456] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 31685ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/14 17:21:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:21:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2505L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 17:21:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2505L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_2#2523]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#2516: string
         :     :- Project [s_phone_prf#2507 AS s_phone_prf_0#2515, rid#2508 AS rid_0#2516, s_address_prf#2509 AS s_address_prf_0#2517, s_nationkey_prf#2510 AS s_nationkey_prf_0#2518, s_suppkey_prf#2511 AS s_suppkey_prf_0#2519, s_name_prf#2512 AS s_name_prf_0#2520, s_acctbal_prf#2513 AS s_acctbal_prf_0#2521, s_comment_prf#2514 AS s_comment_prf_0#2522]
         :     :  +- Relation[s_phone_prf#2507,rid#2508,s_address_prf#2509,s_nationkey_prf#2510,s_suppkey_prf#2511,s_name_prf#2512,s_acctbal_prf#2513,s_comment_prf#2514] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1513) AS rid_2#2544]
            :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#2536: string
            :     :- Project [p_comment_prf#2524 AS p_comment_prf_1#2534, p_name_prf#2525 AS p_name_prf_1#2535, rid#2526 AS rid_1#2536, p_type_prf#2527 AS p_type_prf_1#2537, p_retailprice_prf#2528 AS p_retailprice_prf_1#2538, p_mfgr_prf#2529 AS p_mfgr_prf_1#2539, p_container_prf#2530 AS p_container_prf_1#2540, p_brand_prf#2531 AS p_brand_prf_1#2541, p_size_prf#2532 AS p_size_prf_1#2542, p_partkey_prf#2533 AS p_partkey_prf_1#2543]
            :     :  +- Relation[p_comment_prf#2524,p_name_prf#2525,rid#2526,p_type_prf#2527,p_retailprice_prf#2528,p_mfgr_prf#2529,p_container_prf#2530,p_brand_prf#2531,p_size_prf#2532,p_partkey_prf#2533] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#2545 AS ps_partkey_and_ps_suppkey_prf_2#2552, rid#2546 AS rid_2#2553, ps_availqty_prf#2547 AS ps_availqty_prf_2#2554, ps_comment_prf#2548 AS ps_comment_prf_2#2555, ps_partkey_prf#2549 AS ps_partkey_prf_2#2556, ps_supplycost_prf#2550 AS ps_supplycost_prf_2#2557, ps_suppkey_prf#2551 AS ps_suppkey_prf_2#2558]
               +- Relation[ps_partkey_and_ps_suppkey_prf#2545,rid#2546,ps_availqty_prf#2547,ps_comment_prf#2548,ps_partkey_prf#2549,ps_supplycost_prf#2550,ps_suppkey_prf#2551] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 42979ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/14 17:22:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:22:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2612L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 17:22:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2612L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#2634]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#2625: string
         :     :- Project [o_shippriority_prf#2614 AS o_shippriority_prf_0#2624, rid#2615 AS rid_0#2625, o_orderdate_prf#2616 AS o_orderdate_prf_0#2626, o_custkey_prf#2617 AS o_custkey_prf_0#2627, o_orderpriority_prf#2618 AS o_orderpriority_prf_0#2628, o_clerk_prf#2619 AS o_clerk_prf_0#2629, o_orderstatus_prf#2620 AS o_orderstatus_prf_0#2630, o_totalprice_prf#2621 AS o_totalprice_prf_0#2631, o_orderkey_prf#2622 AS o_orderkey_prf_0#2632, o_comment_prf#2623 AS o_comment_prf_0#2633]
         :     :  +- Relation[o_shippriority_prf#2614,rid#2615,o_orderdate_prf#2616,o_custkey_prf#2617,o_orderpriority_prf#2618,o_clerk_prf#2619,o_orderstatus_prf#2620,o_totalprice_prf#2621,o_orderkey_prf#2622,o_comment_prf#2623] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2635 AS l_returnflag_prf_1#2654, l_orderkey_and_l_linenumber_prf#2636 AS l_orderkey_and_l_linenumber_prf_1#2655, l_comment_prf#2637 AS l_comment_prf_1#2656, l_linestatus_prf#2638 AS l_linestatus_prf_1#2657, rid#2639 AS rid_1#2658, l_shipmode_prf#2640 AS l_shipmode_prf_1#2659, l_shipinstruct_prf#2641 AS l_shipinstruct_prf_1#2660, l_quantity_prf#2642 AS l_quantity_prf_1#2661, l_receiptdate_prf#2643 AS l_receiptdate_prf_1#2662, l_linenumber_prf#2644 AS l_linenumber_prf_1#2663, l_tax_prf#2645 AS l_tax_prf_1#2664, l_shipdate_prf#2646 AS l_shipdate_prf_1#2665, l_extendedprice_prf#2647 AS l_extendedprice_prf_1#2666, l_partkey_prf#2648 AS l_partkey_prf_1#2667, l_discount_prf#2649 AS l_discount_prf_1#2668, l_partkey_and_l_suppkey_prf#2650 AS l_partkey_and_l_suppkey_prf_1#2669, l_commitdate_prf#2651 AS l_commitdate_prf_1#2670, l_suppkey_prf#2652 AS l_suppkey_prf_1#2671, l_orderkey_prf#2653 AS l_orderkey_prf_1#2672]
            +- Relation[l_returnflag_prf#2635,l_orderkey_and_l_linenumber_prf#2636,l_comment_prf#2637,l_linestatus_prf#2638,rid#2639,l_shipmode_prf#2640,l_shipinstruct_prf#2641,l_quantity_prf#2642,l_receiptdate_prf#2643,l_linenumber_prf#2644,l_tax_prf#2645,l_shipdate_prf#2646,l_extendedprice_prf#2647,l_partkey_prf#2648,l_discount_prf#2649,l_partkey_and_l_suppkey_prf#2650,l_commitdate_prf#2651,l_suppkey_prf#2652,l_orderkey_prf#2653] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 194689ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/14 17:25:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:25:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2719L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 17:25:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2719L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#2742]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2733: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#2721 AS p_comment_prf_0#2731, p_name_prf#2722 AS p_name_prf_0#2732, rid#2723 AS rid_0#2733, p_type_prf#2724 AS p_type_prf_0#2734, p_retailprice_prf#2725 AS p_retailprice_prf_0#2735, p_mfgr_prf#2726 AS p_mfgr_prf_0#2736, p_container_prf#2727 AS p_container_prf_0#2737, p_brand_prf#2728 AS p_brand_prf_0#2738, p_size_prf#2729 AS p_size_prf_0#2739, p_partkey_prf#2730 AS p_partkey_prf_0#2740]
         :     :  :  +- Relation[p_comment_prf#2721,p_name_prf#2722,rid#2723,p_type_prf#2724,p_retailprice_prf#2725,p_mfgr_prf#2726,p_container_prf#2727,p_brand_prf#2728,p_size_prf#2729,p_partkey_prf#2730] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2741]
         :     :     +- DexRidFilter part~p_size~15
         :     :        +- Relation[label#2083,value#2084] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2743 AS ps_partkey_and_ps_suppkey_prf_1#2750, rid#2744 AS rid_1#2751, ps_availqty_prf#2745 AS ps_availqty_prf_1#2752, ps_comment_prf#2746 AS ps_comment_prf_1#2753, ps_partkey_prf#2747 AS ps_partkey_prf_1#2754, ps_supplycost_prf#2748 AS ps_supplycost_prf_1#2755, ps_suppkey_prf#2749 AS ps_suppkey_prf_1#2756]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2743,rid#2744,ps_availqty_prf#2745,ps_comment_prf#2746,ps_partkey_prf#2747,ps_supplycost_prf#2748,ps_suppkey_prf#2749] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 423ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/14 17:25:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:25:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2802L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 17:25:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2802L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#2824]
         :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2816: string
         :     :- Project [p_comment_prf#2804 AS p_comment_prf_0#2814, p_name_prf#2805 AS p_name_prf_0#2815, rid#2806 AS rid_0#2816, p_type_prf#2807 AS p_type_prf_0#2817, p_retailprice_prf#2808 AS p_retailprice_prf_0#2818, p_mfgr_prf#2809 AS p_mfgr_prf_0#2819, p_container_prf#2810 AS p_container_prf_0#2820, p_brand_prf#2811 AS p_brand_prf_0#2821, p_size_prf#2812 AS p_size_prf_0#2822, p_partkey_prf#2813 AS p_partkey_prf_0#2823]
         :     :  +- Relation[p_comment_prf#2804,p_name_prf#2805,rid#2806,p_type_prf#2807,p_retailprice_prf#2808,p_mfgr_prf#2809,p_container_prf#2810,p_brand_prf#2811,p_size_prf#2812,p_partkey_prf#2813] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2825 AS l_returnflag_prf_1#2844, l_orderkey_and_l_linenumber_prf#2826 AS l_orderkey_and_l_linenumber_prf_1#2845, l_comment_prf#2827 AS l_comment_prf_1#2846, l_linestatus_prf#2828 AS l_linestatus_prf_1#2847, rid#2829 AS rid_1#2848, l_shipmode_prf#2830 AS l_shipmode_prf_1#2849, l_shipinstruct_prf#2831 AS l_shipinstruct_prf_1#2850, l_quantity_prf#2832 AS l_quantity_prf_1#2851, l_receiptdate_prf#2833 AS l_receiptdate_prf_1#2852, l_linenumber_prf#2834 AS l_linenumber_prf_1#2853, l_tax_prf#2835 AS l_tax_prf_1#2854, l_shipdate_prf#2836 AS l_shipdate_prf_1#2855, l_extendedprice_prf#2837 AS l_extendedprice_prf_1#2856, l_partkey_prf#2838 AS l_partkey_prf_1#2857, l_discount_prf#2839 AS l_discount_prf_1#2858, l_partkey_and_l_suppkey_prf#2840 AS l_partkey_and_l_suppkey_prf_1#2859, l_commitdate_prf#2841 AS l_commitdate_prf_1#2860, l_suppkey_prf#2842 AS l_suppkey_prf_1#2861, l_orderkey_prf#2843 AS l_orderkey_prf_1#2862]
            +- Relation[l_returnflag_prf#2825,l_orderkey_and_l_linenumber_prf#2826,l_comment_prf#2827,l_linestatus_prf#2828,rid#2829,l_shipmode_prf#2830,l_shipinstruct_prf#2831,l_quantity_prf#2832,l_receiptdate_prf#2833,l_linenumber_prf#2834,l_tax_prf#2835,l_shipdate_prf#2836,l_extendedprice_prf#2837,l_partkey_prf#2838,l_discount_prf#2839,l_partkey_and_l_suppkey_prf#2840,l_commitdate_prf#2841,l_suppkey_prf#2842,l_orderkey_prf#2843] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 94188ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/14 17:27:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:27:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2916L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 17:27:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2916L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#2932]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, rid_0#2926: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#2918 AS ps_partkey_and_ps_suppkey_prf_0#2925, rid#2919 AS rid_0#2926, ps_availqty_prf#2920 AS ps_availqty_prf_0#2927, ps_comment_prf#2921 AS ps_comment_prf_0#2928, ps_partkey_prf#2922 AS ps_partkey_prf_0#2929, ps_supplycost_prf#2923 AS ps_supplycost_prf_0#2930, ps_suppkey_prf#2924 AS ps_suppkey_prf_0#2931]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2918,rid#2919,ps_availqty_prf#2920,ps_comment_prf#2921,ps_partkey_prf#2922,ps_supplycost_prf#2923,ps_suppkey_prf#2924] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2933 AS l_returnflag_prf_1#2952, l_orderkey_and_l_linenumber_prf#2934 AS l_orderkey_and_l_linenumber_prf_1#2953, l_comment_prf#2935 AS l_comment_prf_1#2954, l_linestatus_prf#2936 AS l_linestatus_prf_1#2955, rid#2937 AS rid_1#2956, l_shipmode_prf#2938 AS l_shipmode_prf_1#2957, l_shipinstruct_prf#2939 AS l_shipinstruct_prf_1#2958, l_quantity_prf#2940 AS l_quantity_prf_1#2959, l_receiptdate_prf#2941 AS l_receiptdate_prf_1#2960, l_linenumber_prf#2942 AS l_linenumber_prf_1#2961, l_tax_prf#2943 AS l_tax_prf_1#2962, l_shipdate_prf#2944 AS l_shipdate_prf_1#2963, l_extendedprice_prf#2945 AS l_extendedprice_prf_1#2964, l_partkey_prf#2946 AS l_partkey_prf_1#2965, l_discount_prf#2947 AS l_discount_prf_1#2966, l_partkey_and_l_suppkey_prf#2948 AS l_partkey_and_l_suppkey_prf_1#2967, l_commitdate_prf#2949 AS l_commitdate_prf_1#2968, l_suppkey_prf#2950 AS l_suppkey_prf_1#2969, l_orderkey_prf#2951 AS l_orderkey_prf_1#2970]
            +- Relation[l_returnflag_prf#2933,l_orderkey_and_l_linenumber_prf#2934,l_comment_prf#2935,l_linestatus_prf#2936,rid#2937,l_shipmode_prf#2938,l_shipinstruct_prf#2939,l_quantity_prf#2940,l_receiptdate_prf#2941,l_linenumber_prf#2942,l_tax_prf#2943,l_shipdate_prf#2944,l_extendedprice_prf#2945,l_partkey_prf#2946,l_discount_prf#2947,l_partkey_and_l_suppkey_prf#2948,l_commitdate_prf#2949,l_suppkey_prf#2950,l_orderkey_prf#2951] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 116245ms

f2=
select * from part where p_size = 15
19/10/14 17:29:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:29:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3009L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 17:29:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3009L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#3011 AS p_comment_prf_0#3021, p_name_prf#3012 AS p_name_prf_0#3022, rid#3013 AS rid_0#3023, p_type_prf#3014 AS p_type_prf_0#3024, p_retailprice_prf#3015 AS p_retailprice_prf_0#3025, p_mfgr_prf#3016 AS p_mfgr_prf_0#3026, p_container_prf#3017 AS p_container_prf_0#3027, p_brand_prf#3018 AS p_brand_prf_0#3028, p_size_prf#3019 AS p_size_prf_0#3029, p_partkey_prf#3020 AS p_partkey_prf_0#3030]
         :  +- Relation[p_comment_prf#3011,p_name_prf#3012,rid#3013,p_type_prf#3014,p_retailprice_prf#3015,p_mfgr_prf#3016,p_container_prf#3017,p_brand_prf#3018,p_size_prf#3019,p_partkey_prf#3020] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3031]
            +- DexRidFilter part~p_size~15
               +- Relation[label#2083,value#2084] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3907
Elapsed time: 129ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/14 17:29:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:29:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3078L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 17:29:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3078L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#3118]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3103: string
         :     :  :     :- Project [l_returnflag_prf#3080 AS l_returnflag_prf_0#3099, l_orderkey_and_l_linenumber_prf#3081 AS l_orderkey_and_l_linenumber_prf_0#3100, l_comment_prf#3082 AS l_comment_prf_0#3101, l_linestatus_prf#3083 AS l_linestatus_prf_0#3102, rid#3084 AS rid_0#3103, l_shipmode_prf#3085 AS l_shipmode_prf_0#3104, l_shipinstruct_prf#3086 AS l_shipinstruct_prf_0#3105, l_quantity_prf#3087 AS l_quantity_prf_0#3106, l_receiptdate_prf#3088 AS l_receiptdate_prf_0#3107, l_linenumber_prf#3089 AS l_linenumber_prf_0#3108, l_tax_prf#3090 AS l_tax_prf_0#3109, l_shipdate_prf#3091 AS l_shipdate_prf_0#3110, l_extendedprice_prf#3092 AS l_extendedprice_prf_0#3111, l_partkey_prf#3093 AS l_partkey_prf_0#3112, l_discount_prf#3094 AS l_discount_prf_0#3113, l_partkey_and_l_suppkey_prf#3095 AS l_partkey_and_l_suppkey_prf_0#3114, l_commitdate_prf#3096 AS l_commitdate_prf_0#3115, l_suppkey_prf#3097 AS l_suppkey_prf_0#3116, l_orderkey_prf#3098 AS l_orderkey_prf_0#3117]
         :     :  :     :  +- Relation[l_returnflag_prf#3080,l_orderkey_and_l_linenumber_prf#3081,l_comment_prf#3082,l_linestatus_prf#3083,rid#3084,l_shipmode_prf#3085,l_shipinstruct_prf#3086,l_quantity_prf#3087,l_receiptdate_prf#3088,l_linenumber_prf#3089,l_tax_prf#3090,l_shipdate_prf#3091,l_extendedprice_prf#3092,l_partkey_prf#3093,l_discount_prf#3094,l_partkey_and_l_suppkey_prf#3095,l_commitdate_prf#3096,l_suppkey_prf#3097,l_orderkey_prf#3098] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#3119 AS o_shippriority_prf_1#3129, rid#3120 AS rid_1#3130, o_orderdate_prf#3121 AS o_orderdate_prf_1#3131, o_custkey_prf#3122 AS o_custkey_prf_1#3132, o_orderpriority_prf#3123 AS o_orderpriority_prf_1#3133, o_clerk_prf#3124 AS o_clerk_prf_1#3134, o_orderstatus_prf#3125 AS o_orderstatus_prf_1#3135, o_totalprice_prf#3126 AS o_totalprice_prf_1#3136, o_orderkey_prf#3127 AS o_orderkey_prf_1#3137, o_comment_prf#3128 AS o_comment_prf_1#3138]
         :     :     +- Relation[o_shippriority_prf#3119,rid#3120,o_orderdate_prf#3121,o_custkey_prf#3122,o_orderpriority_prf#3123,o_clerk_prf#3124,o_orderstatus_prf#3125,o_totalprice_prf#3126,o_orderkey_prf#3127,o_comment_prf#3128] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3140 AS c_acctbal_prf_2#3149, rid#3141 AS rid_2#3150, c_name_prf#3142 AS c_name_prf_2#3151, c_nationkey_prf#3143 AS c_nationkey_prf_2#3152, c_custkey_prf#3144 AS c_custkey_prf_2#3153, c_comment_prf#3145 AS c_comment_prf_2#3154, c_address_prf#3146 AS c_address_prf_2#3155, c_mktsegment_prf#3147 AS c_mktsegment_prf_2#3156, c_phone_prf#3148 AS c_phone_prf_2#3157]
            +- Relation[c_acctbal_prf#3140,rid#3141,c_name_prf#3142,c_nationkey_prf#3143,c_custkey_prf#3144,c_comment_prf#3145,c_address_prf#3146,c_mktsegment_prf#3147,c_phone_prf#3148] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 333648ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/14 17:34:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:34:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3220L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 17:34:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3220L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#3238]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#3231: string
         :     :- Project [s_phone_prf#3222 AS s_phone_prf_0#3230, rid#3223 AS rid_0#3231, s_address_prf#3224 AS s_address_prf_0#3232, s_nationkey_prf#3225 AS s_nationkey_prf_0#3233, s_suppkey_prf#3226 AS s_suppkey_prf_0#3234, s_name_prf#3227 AS s_name_prf_0#3235, s_acctbal_prf#3228 AS s_acctbal_prf_0#3236, s_comment_prf#3229 AS s_comment_prf_0#3237]
         :     :  +- Relation[s_phone_prf#3222,rid#3223,s_address_prf#3224,s_nationkey_prf#3225,s_suppkey_prf#3226,s_name_prf#3227,s_acctbal_prf#3228,s_comment_prf#3229] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1513) AS rid_2#3253]
            :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_1#3247: string
            :     :- Project [ps_partkey_and_ps_suppkey_prf#3239 AS ps_partkey_and_ps_suppkey_prf_1#3246, rid#3240 AS rid_1#3247, ps_availqty_prf#3241 AS ps_availqty_prf_1#3248, ps_comment_prf#3242 AS ps_comment_prf_1#3249, ps_partkey_prf#3243 AS ps_partkey_prf_1#3250, ps_supplycost_prf#3244 AS ps_supplycost_prf_1#3251, ps_suppkey_prf#3245 AS ps_suppkey_prf_1#3252]
            :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#3239,rid#3240,ps_availqty_prf#3241,ps_comment_prf#3242,ps_partkey_prf#3243,ps_supplycost_prf#3244,ps_suppkey_prf#3245] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#3254 AS p_comment_prf_2#3264, p_name_prf#3255 AS p_name_prf_2#3265, rid#3256 AS rid_2#3266, p_type_prf#3257 AS p_type_prf_2#3267, p_retailprice_prf#3258 AS p_retailprice_prf_2#3268, p_mfgr_prf#3259 AS p_mfgr_prf_2#3269, p_container_prf#3260 AS p_container_prf_2#3270, p_brand_prf#3261 AS p_brand_prf_2#3271, p_size_prf#3262 AS p_size_prf_2#3272, p_partkey_prf#3263 AS p_partkey_prf_2#3273]
               +- Relation[p_comment_prf#3254,p_name_prf#3255,rid#3256,p_type_prf#3257,p_retailprice_prf#3258,p_mfgr_prf#3259,p_container_prf#3260,p_brand_prf#3261,p_size_prf#3262,p_partkey_prf#3263] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 61458ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/14 17:35:58 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:35:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3316L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 17:35:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3316L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#3332]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#3326: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#3318 AS ps_partkey_and_ps_suppkey_prf_0#3325, rid#3319 AS rid_0#3326, ps_availqty_prf#3320 AS ps_availqty_prf_0#3327, ps_comment_prf#3321 AS ps_comment_prf_0#3328, ps_partkey_prf#3322 AS ps_partkey_prf_0#3329, ps_supplycost_prf#3323 AS ps_supplycost_prf_0#3330, ps_suppkey_prf#3324 AS ps_suppkey_prf_0#3331]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#3318,rid#3319,ps_availqty_prf#3320,ps_comment_prf#3321,ps_partkey_prf#3322,ps_supplycost_prf#3323,ps_suppkey_prf#3324] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#3333 AS p_comment_prf_1#3343, p_name_prf#3334 AS p_name_prf_1#3344, rid#3335 AS rid_1#3345, p_type_prf#3336 AS p_type_prf_1#3346, p_retailprice_prf#3337 AS p_retailprice_prf_1#3347, p_mfgr_prf#3338 AS p_mfgr_prf_1#3348, p_container_prf#3339 AS p_container_prf_1#3349, p_brand_prf#3340 AS p_brand_prf_1#3350, p_size_prf#3341 AS p_size_prf_1#3351, p_partkey_prf#3342 AS p_partkey_prf_1#3352]
            :  +- Relation[p_comment_prf#3333,p_name_prf#3334,rid#3335,p_type_prf#3336,p_retailprice_prf#3337,p_mfgr_prf#3338,p_container_prf#3339,p_brand_prf#3340,p_size_prf#3341,p_partkey_prf#3342] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3353]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#2083,value#2084] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 49791ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/14 17:36:48 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:36:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3407L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 17:36:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3407L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#3447]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3432: string
         :     :- Project [l_returnflag_prf#3409 AS l_returnflag_prf_0#3428, l_orderkey_and_l_linenumber_prf#3410 AS l_orderkey_and_l_linenumber_prf_0#3429, l_comment_prf#3411 AS l_comment_prf_0#3430, l_linestatus_prf#3412 AS l_linestatus_prf_0#3431, rid#3413 AS rid_0#3432, l_shipmode_prf#3414 AS l_shipmode_prf_0#3433, l_shipinstruct_prf#3415 AS l_shipinstruct_prf_0#3434, l_quantity_prf#3416 AS l_quantity_prf_0#3435, l_receiptdate_prf#3417 AS l_receiptdate_prf_0#3436, l_linenumber_prf#3418 AS l_linenumber_prf_0#3437, l_tax_prf#3419 AS l_tax_prf_0#3438, l_shipdate_prf#3420 AS l_shipdate_prf_0#3439, l_extendedprice_prf#3421 AS l_extendedprice_prf_0#3440, l_partkey_prf#3422 AS l_partkey_prf_0#3441, l_discount_prf#3423 AS l_discount_prf_0#3442, l_partkey_and_l_suppkey_prf#3424 AS l_partkey_and_l_suppkey_prf_0#3443, l_commitdate_prf#3425 AS l_commitdate_prf_0#3444, l_suppkey_prf#3426 AS l_suppkey_prf_0#3445, l_orderkey_prf#3427 AS l_orderkey_prf_0#3446]
         :     :  +- Relation[l_returnflag_prf#3409,l_orderkey_and_l_linenumber_prf#3410,l_comment_prf#3411,l_linestatus_prf#3412,rid#3413,l_shipmode_prf#3414,l_shipinstruct_prf#3415,l_quantity_prf#3416,l_receiptdate_prf#3417,l_linenumber_prf#3418,l_tax_prf#3419,l_shipdate_prf#3420,l_extendedprice_prf#3421,l_partkey_prf#3422,l_discount_prf#3423,l_partkey_and_l_suppkey_prf#3424,l_commitdate_prf#3425,l_suppkey_prf#3426,l_orderkey_prf#3427] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1513) AS rid_2#3468]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#3459: string
            :     :- Project [o_shippriority_prf#3448 AS o_shippriority_prf_1#3458, rid#3449 AS rid_1#3459, o_orderdate_prf#3450 AS o_orderdate_prf_1#3460, o_custkey_prf#3451 AS o_custkey_prf_1#3461, o_orderpriority_prf#3452 AS o_orderpriority_prf_1#3462, o_clerk_prf#3453 AS o_clerk_prf_1#3463, o_orderstatus_prf#3454 AS o_orderstatus_prf_1#3464, o_totalprice_prf#3455 AS o_totalprice_prf_1#3465, o_orderkey_prf#3456 AS o_orderkey_prf_1#3466, o_comment_prf#3457 AS o_comment_prf_1#3467]
            :     :  +- Relation[o_shippriority_prf#3448,rid#3449,o_orderdate_prf#3450,o_custkey_prf#3451,o_orderpriority_prf#3452,o_clerk_prf#3453,o_orderstatus_prf#3454,o_totalprice_prf#3455,o_orderkey_prf#3456,o_comment_prf#3457] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#3469 AS c_acctbal_prf_2#3478, rid#3470 AS rid_2#3479, c_name_prf#3471 AS c_name_prf_2#3480, c_nationkey_prf#3472 AS c_nationkey_prf_2#3481, c_custkey_prf#3473 AS c_custkey_prf_2#3482, c_comment_prf#3474 AS c_comment_prf_2#3483, c_address_prf#3475 AS c_address_prf_2#3484, c_mktsegment_prf#3476 AS c_mktsegment_prf_2#3485, c_phone_prf#3477 AS c_phone_prf_2#3486]
               +- Relation[c_acctbal_prf#3469,rid#3470,c_name_prf#3471,c_nationkey_prf#3472,c_custkey_prf#3473,c_comment_prf#3474,c_address_prf#3475,c_mktsegment_prf#3476,c_phone_prf#3477] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 148599ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/14 17:39:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:39:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3560L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 17:39:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3560L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#3578]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#3571: string
         :     :- Project [s_phone_prf#3562 AS s_phone_prf_0#3570, rid#3563 AS rid_0#3571, s_address_prf#3564 AS s_address_prf_0#3572, s_nationkey_prf#3565 AS s_nationkey_prf_0#3573, s_suppkey_prf#3566 AS s_suppkey_prf_0#3574, s_name_prf#3567 AS s_name_prf_0#3575, s_acctbal_prf#3568 AS s_acctbal_prf_0#3576, s_comment_prf#3569 AS s_comment_prf_0#3577]
         :     :  +- Relation[s_phone_prf#3562,rid#3563,s_address_prf#3564,s_nationkey_prf#3565,s_suppkey_prf#3566,s_name_prf#3567,s_acctbal_prf#3568,s_comment_prf#3569] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1513) AS rid_2#3617]
            :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_1#3602: string
            :     :- Project [l_returnflag_prf#3579 AS l_returnflag_prf_1#3598, l_orderkey_and_l_linenumber_prf#3580 AS l_orderkey_and_l_linenumber_prf_1#3599, l_comment_prf#3581 AS l_comment_prf_1#3600, l_linestatus_prf#3582 AS l_linestatus_prf_1#3601, rid#3583 AS rid_1#3602, l_shipmode_prf#3584 AS l_shipmode_prf_1#3603, l_shipinstruct_prf#3585 AS l_shipinstruct_prf_1#3604, l_quantity_prf#3586 AS l_quantity_prf_1#3605, l_receiptdate_prf#3587 AS l_receiptdate_prf_1#3606, l_linenumber_prf#3588 AS l_linenumber_prf_1#3607, l_tax_prf#3589 AS l_tax_prf_1#3608, l_shipdate_prf#3590 AS l_shipdate_prf_1#3609, l_extendedprice_prf#3591 AS l_extendedprice_prf_1#3610, l_partkey_prf#3592 AS l_partkey_prf_1#3611, l_discount_prf#3593 AS l_discount_prf_1#3612, l_partkey_and_l_suppkey_prf#3594 AS l_partkey_and_l_suppkey_prf_1#3613, l_commitdate_prf#3595 AS l_commitdate_prf_1#3614, l_suppkey_prf#3596 AS l_suppkey_prf_1#3615, l_orderkey_prf#3597 AS l_orderkey_prf_1#3616]
            :     :  +- Relation[l_returnflag_prf#3579,l_orderkey_and_l_linenumber_prf#3580,l_comment_prf#3581,l_linestatus_prf#3582,rid#3583,l_shipmode_prf#3584,l_shipinstruct_prf#3585,l_quantity_prf#3586,l_receiptdate_prf#3587,l_linenumber_prf#3588,l_tax_prf#3589,l_shipdate_prf#3590,l_extendedprice_prf#3591,l_partkey_prf#3592,l_discount_prf#3593,l_partkey_and_l_suppkey_prf#3594,l_commitdate_prf#3595,l_suppkey_prf#3596,l_orderkey_prf#3597] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#3618 AS p_comment_prf_2#3628, p_name_prf#3619 AS p_name_prf_2#3629, rid#3620 AS rid_2#3630, p_type_prf#3621 AS p_type_prf_2#3631, p_retailprice_prf#3622 AS p_retailprice_prf_2#3632, p_mfgr_prf#3623 AS p_mfgr_prf_2#3633, p_container_prf#3624 AS p_container_prf_2#3634, p_brand_prf#3625 AS p_brand_prf_2#3635, p_size_prf#3626 AS p_size_prf_2#3636, p_partkey_prf#3627 AS p_partkey_prf_2#3637]
               +- Relation[p_comment_prf#3618,p_name_prf#3619,rid#3620,p_type_prf#3621,p_retailprice_prf#3622,p_mfgr_prf#3623,p_container_prf#3624,p_brand_prf#3625,p_size_prf#3626,p_partkey_prf#3627] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 185986ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/14 17:42:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:42:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3694L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 17:42:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3694L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#3696 AS l_returnflag_prf_0#3715, l_orderkey_and_l_linenumber_prf#3697 AS l_orderkey_and_l_linenumber_prf_0#3716, l_comment_prf#3698 AS l_comment_prf_0#3717, l_linestatus_prf#3699 AS l_linestatus_prf_0#3718, rid#3700 AS rid_0#3719, l_shipmode_prf#3701 AS l_shipmode_prf_0#3720, l_shipinstruct_prf#3702 AS l_shipinstruct_prf_0#3721, l_quantity_prf#3703 AS l_quantity_prf_0#3722, l_receiptdate_prf#3704 AS l_receiptdate_prf_0#3723, l_linenumber_prf#3705 AS l_linenumber_prf_0#3724, l_tax_prf#3706 AS l_tax_prf_0#3725, l_shipdate_prf#3707 AS l_shipdate_prf_0#3726, l_extendedprice_prf#3708 AS l_extendedprice_prf_0#3727, l_partkey_prf#3709 AS l_partkey_prf_0#3728, l_discount_prf#3710 AS l_discount_prf_0#3729, l_partkey_and_l_suppkey_prf#3711 AS l_partkey_and_l_suppkey_prf_0#3730, l_commitdate_prf#3712 AS l_commitdate_prf_0#3731, l_suppkey_prf#3713 AS l_suppkey_prf_0#3732, l_orderkey_prf#3714 AS l_orderkey_prf_0#3733]
         :  +- Relation[l_returnflag_prf#3696,l_orderkey_and_l_linenumber_prf#3697,l_comment_prf#3698,l_linestatus_prf#3699,rid#3700,l_shipmode_prf#3701,l_shipinstruct_prf#3702,l_quantity_prf#3703,l_receiptdate_prf#3704,l_linenumber_prf#3705,l_tax_prf#3706,l_shipdate_prf#3707,l_extendedprice_prf#3708,l_partkey_prf#3709,l_discount_prf#3710,l_partkey_and_l_suppkey_prf#3711,l_commitdate_prf#3712,l_suppkey_prf#3713,l_orderkey_prf#3714] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3734]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#2083,value#2084] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 13725ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/14 17:42:36 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:42:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3773L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 17:42:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3773L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#3775 AS l_returnflag_prf_0#3794, l_orderkey_and_l_linenumber_prf#3776 AS l_orderkey_and_l_linenumber_prf_0#3795, l_comment_prf#3777 AS l_comment_prf_0#3796, l_linestatus_prf#3778 AS l_linestatus_prf_0#3797, rid#3779 AS rid_0#3798, l_shipmode_prf#3780 AS l_shipmode_prf_0#3799, l_shipinstruct_prf#3781 AS l_shipinstruct_prf_0#3800, l_quantity_prf#3782 AS l_quantity_prf_0#3801, l_receiptdate_prf#3783 AS l_receiptdate_prf_0#3802, l_linenumber_prf#3784 AS l_linenumber_prf_0#3803, l_tax_prf#3785 AS l_tax_prf_0#3804, l_shipdate_prf#3786 AS l_shipdate_prf_0#3805, l_extendedprice_prf#3787 AS l_extendedprice_prf_0#3806, l_partkey_prf#3788 AS l_partkey_prf_0#3807, l_discount_prf#3789 AS l_discount_prf_0#3808, l_partkey_and_l_suppkey_prf#3790 AS l_partkey_and_l_suppkey_prf_0#3809, l_commitdate_prf#3791 AS l_commitdate_prf_0#3810, l_suppkey_prf#3792 AS l_suppkey_prf_0#3811, l_orderkey_prf#3793 AS l_orderkey_prf_0#3812]
         :  +- Relation[l_returnflag_prf#3775,l_orderkey_and_l_linenumber_prf#3776,l_comment_prf#3777,l_linestatus_prf#3778,rid#3779,l_shipmode_prf#3780,l_shipinstruct_prf#3781,l_quantity_prf#3782,l_receiptdate_prf#3783,l_linenumber_prf#3784,l_tax_prf#3785,l_shipdate_prf#3786,l_extendedprice_prf#3787,l_partkey_prf#3788,l_discount_prf#3789,l_partkey_and_l_suppkey_prf#3790,l_commitdate_prf#3791,l_suppkey_prf#3792,l_orderkey_prf#3793] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3813]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#2083,value#2084] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 23352ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/14 17:43:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:43:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3861L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 17:43:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3861L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#3902]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3886: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#3863 AS l_returnflag_prf_0#3882, l_orderkey_and_l_linenumber_prf#3864 AS l_orderkey_and_l_linenumber_prf_0#3883, l_comment_prf#3865 AS l_comment_prf_0#3884, l_linestatus_prf#3866 AS l_linestatus_prf_0#3885, rid#3867 AS rid_0#3886, l_shipmode_prf#3868 AS l_shipmode_prf_0#3887, l_shipinstruct_prf#3869 AS l_shipinstruct_prf_0#3888, l_quantity_prf#3870 AS l_quantity_prf_0#3889, l_receiptdate_prf#3871 AS l_receiptdate_prf_0#3890, l_linenumber_prf#3872 AS l_linenumber_prf_0#3891, l_tax_prf#3873 AS l_tax_prf_0#3892, l_shipdate_prf#3874 AS l_shipdate_prf_0#3893, l_extendedprice_prf#3875 AS l_extendedprice_prf_0#3894, l_partkey_prf#3876 AS l_partkey_prf_0#3895, l_discount_prf#3877 AS l_discount_prf_0#3896, l_partkey_and_l_suppkey_prf#3878 AS l_partkey_and_l_suppkey_prf_0#3897, l_commitdate_prf#3879 AS l_commitdate_prf_0#3898, l_suppkey_prf#3880 AS l_suppkey_prf_0#3899, l_orderkey_prf#3881 AS l_orderkey_prf_0#3900]
         :     :  :  +- Relation[l_returnflag_prf#3863,l_orderkey_and_l_linenumber_prf#3864,l_comment_prf#3865,l_linestatus_prf#3866,rid#3867,l_shipmode_prf#3868,l_shipinstruct_prf#3869,l_quantity_prf#3870,l_receiptdate_prf#3871,l_linenumber_prf#3872,l_tax_prf#3873,l_shipdate_prf#3874,l_extendedprice_prf#3875,l_partkey_prf#3876,l_discount_prf#3877,l_partkey_and_l_suppkey_prf#3878,l_commitdate_prf#3879,l_suppkey_prf#3880,l_orderkey_prf#3881] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3901]
         :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :        +- Relation[label#2083,value#2084] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3903 AS o_shippriority_prf_1#3913, rid#3904 AS rid_1#3914, o_orderdate_prf#3905 AS o_orderdate_prf_1#3915, o_custkey_prf#3906 AS o_custkey_prf_1#3916, o_orderpriority_prf#3907 AS o_orderpriority_prf_1#3917, o_clerk_prf#3908 AS o_clerk_prf_1#3918, o_orderstatus_prf#3909 AS o_orderstatus_prf_1#3919, o_totalprice_prf#3910 AS o_totalprice_prf_1#3920, o_orderkey_prf#3911 AS o_orderkey_prf_1#3921, o_comment_prf#3912 AS o_comment_prf_1#3922]
            +- Relation[o_shippriority_prf#3903,rid#3904,o_orderdate_prf#3905,o_custkey_prf#3906,o_orderpriority_prf#3907,o_clerk_prf#3908,o_orderstatus_prf#3909,o_totalprice_prf#3910,o_orderkey_prf#3911,o_comment_prf#3912] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 54453ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/14 17:43:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:43:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3974L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 17:43:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3974L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#1513) AS rid_2#4003]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#3992]
         :     :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#3985: string
         :     :  :     :- Project [s_phone_prf#3976 AS s_phone_prf_0#3984, rid#3977 AS rid_0#3985, s_address_prf#3978 AS s_address_prf_0#3986, s_nationkey_prf#3979 AS s_nationkey_prf_0#3987, s_suppkey_prf#3980 AS s_suppkey_prf_0#3988, s_name_prf#3981 AS s_name_prf_0#3989, s_acctbal_prf#3982 AS s_acctbal_prf_0#3990, s_comment_prf#3983 AS s_comment_prf_0#3991]
         :     :  :     :  +- Relation[s_phone_prf#3976,rid#3977,s_address_prf#3978,s_nationkey_prf#3979,s_suppkey_prf#3980,s_name_prf#3981,s_acctbal_prf#3982,s_comment_prf#3983] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [rid#3993 AS rid_1#3998, n_regionkey_prf#3994 AS n_regionkey_prf_1#3999, n_nationkey_prf#3995 AS n_nationkey_prf_1#4000, n_name_prf#3996 AS n_name_prf_1#4001, n_comment_prf#3997 AS n_comment_prf_1#4002]
         :     :     +- Relation[rid#3993,n_regionkey_prf#3994,n_nationkey_prf#3995,n_name_prf#3996,n_comment_prf#3997] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4004 AS c_acctbal_prf_2#4013, rid#4005 AS rid_2#4014, c_name_prf#4006 AS c_name_prf_2#4015, c_nationkey_prf#4007 AS c_nationkey_prf_2#4016, c_custkey_prf#4008 AS c_custkey_prf_2#4017, c_comment_prf#4009 AS c_comment_prf_2#4018, c_address_prf#4010 AS c_address_prf_2#4019, c_mktsegment_prf#4011 AS c_mktsegment_prf_2#4020, c_phone_prf#4012 AS c_phone_prf_2#4021]
            +- Relation[c_acctbal_prf#4004,rid#4005,c_name_prf#4006,c_nationkey_prf#4007,c_custkey_prf#4008,c_comment_prf#4009,c_address_prf#4010,c_mktsegment_prf#4011,c_phone_prf#4012] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 672722ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/14 17:55:07 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:55:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4072L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 17:55:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4072L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#4112]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4097: string
         :     :- Project [l_returnflag_prf#4074 AS l_returnflag_prf_0#4093, l_orderkey_and_l_linenumber_prf#4075 AS l_orderkey_and_l_linenumber_prf_0#4094, l_comment_prf#4076 AS l_comment_prf_0#4095, l_linestatus_prf#4077 AS l_linestatus_prf_0#4096, rid#4078 AS rid_0#4097, l_shipmode_prf#4079 AS l_shipmode_prf_0#4098, l_shipinstruct_prf#4080 AS l_shipinstruct_prf_0#4099, l_quantity_prf#4081 AS l_quantity_prf_0#4100, l_receiptdate_prf#4082 AS l_receiptdate_prf_0#4101, l_linenumber_prf#4083 AS l_linenumber_prf_0#4102, l_tax_prf#4084 AS l_tax_prf_0#4103, l_shipdate_prf#4085 AS l_shipdate_prf_0#4104, l_extendedprice_prf#4086 AS l_extendedprice_prf_0#4105, l_partkey_prf#4087 AS l_partkey_prf_0#4106, l_discount_prf#4088 AS l_discount_prf_0#4107, l_partkey_and_l_suppkey_prf#4089 AS l_partkey_and_l_suppkey_prf_0#4108, l_commitdate_prf#4090 AS l_commitdate_prf_0#4109, l_suppkey_prf#4091 AS l_suppkey_prf_0#4110, l_orderkey_prf#4092 AS l_orderkey_prf_0#4111]
         :     :  +- Relation[l_returnflag_prf#4074,l_orderkey_and_l_linenumber_prf#4075,l_comment_prf#4076,l_linestatus_prf#4077,rid#4078,l_shipmode_prf#4079,l_shipinstruct_prf#4080,l_quantity_prf#4081,l_receiptdate_prf#4082,l_linenumber_prf#4083,l_tax_prf#4084,l_shipdate_prf#4085,l_extendedprice_prf#4086,l_partkey_prf#4087,l_discount_prf#4088,l_partkey_and_l_suppkey_prf#4089,l_commitdate_prf#4090,l_suppkey_prf#4091,l_orderkey_prf#4092] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4113 AS o_shippriority_prf_1#4123, rid#4114 AS rid_1#4124, o_orderdate_prf#4115 AS o_orderdate_prf_1#4125, o_custkey_prf#4116 AS o_custkey_prf_1#4126, o_orderpriority_prf#4117 AS o_orderpriority_prf_1#4127, o_clerk_prf#4118 AS o_clerk_prf_1#4128, o_orderstatus_prf#4119 AS o_orderstatus_prf_1#4129, o_totalprice_prf#4120 AS o_totalprice_prf_1#4130, o_orderkey_prf#4121 AS o_orderkey_prf_1#4131, o_comment_prf#4122 AS o_comment_prf_1#4132]
            +- Relation[o_shippriority_prf#4113,rid#4114,o_orderdate_prf#4115,o_custkey_prf#4116,o_orderpriority_prf#4117,o_clerk_prf#4118,o_orderstatus_prf#4119,o_totalprice_prf#4120,o_orderkey_prf#4121,o_comment_prf#4122] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 114228ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/14 17:57:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 17:57:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4197L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 17:57:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4197L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_2#4215]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#4208: string
         :     :- Project [s_phone_prf#4199 AS s_phone_prf_0#4207, rid#4200 AS rid_0#4208, s_address_prf#4201 AS s_address_prf_0#4209, s_nationkey_prf#4202 AS s_nationkey_prf_0#4210, s_suppkey_prf#4203 AS s_suppkey_prf_0#4211, s_name_prf#4204 AS s_name_prf_0#4212, s_acctbal_prf#4205 AS s_acctbal_prf_0#4213, s_comment_prf#4206 AS s_comment_prf_0#4214]
         :     :  +- Relation[s_phone_prf#4199,rid#4200,s_address_prf#4201,s_nationkey_prf#4202,s_suppkey_prf#4203,s_name_prf#4204,s_acctbal_prf#4205,s_comment_prf#4206] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1513) AS rid_2#4236]
            :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#4228: string
            :     :- Project [p_comment_prf#4216 AS p_comment_prf_1#4226, p_name_prf#4217 AS p_name_prf_1#4227, rid#4218 AS rid_1#4228, p_type_prf#4219 AS p_type_prf_1#4229, p_retailprice_prf#4220 AS p_retailprice_prf_1#4230, p_mfgr_prf#4221 AS p_mfgr_prf_1#4231, p_container_prf#4222 AS p_container_prf_1#4232, p_brand_prf#4223 AS p_brand_prf_1#4233, p_size_prf#4224 AS p_size_prf_1#4234, p_partkey_prf#4225 AS p_partkey_prf_1#4235]
            :     :  +- Relation[p_comment_prf#4216,p_name_prf#4217,rid#4218,p_type_prf#4219,p_retailprice_prf#4220,p_mfgr_prf#4221,p_container_prf#4222,p_brand_prf#4223,p_size_prf#4224,p_partkey_prf#4225] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4237 AS l_returnflag_prf_2#4256, l_orderkey_and_l_linenumber_prf#4238 AS l_orderkey_and_l_linenumber_prf_2#4257, l_comment_prf#4239 AS l_comment_prf_2#4258, l_linestatus_prf#4240 AS l_linestatus_prf_2#4259, rid#4241 AS rid_2#4260, l_shipmode_prf#4242 AS l_shipmode_prf_2#4261, l_shipinstruct_prf#4243 AS l_shipinstruct_prf_2#4262, l_quantity_prf#4244 AS l_quantity_prf_2#4263, l_receiptdate_prf#4245 AS l_receiptdate_prf_2#4264, l_linenumber_prf#4246 AS l_linenumber_prf_2#4265, l_tax_prf#4247 AS l_tax_prf_2#4266, l_shipdate_prf#4248 AS l_shipdate_prf_2#4267, l_extendedprice_prf#4249 AS l_extendedprice_prf_2#4268, l_partkey_prf#4250 AS l_partkey_prf_2#4269, l_discount_prf#4251 AS l_discount_prf_2#4270, l_partkey_and_l_suppkey_prf#4252 AS l_partkey_and_l_suppkey_prf_2#4271, l_commitdate_prf#4253 AS l_commitdate_prf_2#4272, l_suppkey_prf#4254 AS l_suppkey_prf_2#4273, l_orderkey_prf#4255 AS l_orderkey_prf_2#4274]
               +- Relation[l_returnflag_prf#4237,l_orderkey_and_l_linenumber_prf#4238,l_comment_prf#4239,l_linestatus_prf#4240,rid#4241,l_shipmode_prf#4242,l_shipinstruct_prf#4243,l_quantity_prf#4244,l_receiptdate_prf#4245,l_linenumber_prf#4246,l_tax_prf#4247,l_shipdate_prf#4248,l_extendedprice_prf#4249,l_partkey_prf#4250,l_discount_prf#4251,l_partkey_and_l_suppkey_prf#4252,l_commitdate_prf#4253,l_suppkey_prf#4254,l_orderkey_prf#4255] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 187908ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/14 18:00:09 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 18:00:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4340L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 18:00:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4340L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#4380]
         :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#4365: string
         :     :- Project [l_returnflag_prf#4342 AS l_returnflag_prf_0#4361, l_orderkey_and_l_linenumber_prf#4343 AS l_orderkey_and_l_linenumber_prf_0#4362, l_comment_prf#4344 AS l_comment_prf_0#4363, l_linestatus_prf#4345 AS l_linestatus_prf_0#4364, rid#4346 AS rid_0#4365, l_shipmode_prf#4347 AS l_shipmode_prf_0#4366, l_shipinstruct_prf#4348 AS l_shipinstruct_prf_0#4367, l_quantity_prf#4349 AS l_quantity_prf_0#4368, l_receiptdate_prf#4350 AS l_receiptdate_prf_0#4369, l_linenumber_prf#4351 AS l_linenumber_prf_0#4370, l_tax_prf#4352 AS l_tax_prf_0#4371, l_shipdate_prf#4353 AS l_shipdate_prf_0#4372, l_extendedprice_prf#4354 AS l_extendedprice_prf_0#4373, l_partkey_prf#4355 AS l_partkey_prf_0#4374, l_discount_prf#4356 AS l_discount_prf_0#4375, l_partkey_and_l_suppkey_prf#4357 AS l_partkey_and_l_suppkey_prf_0#4376, l_commitdate_prf#4358 AS l_commitdate_prf_0#4377, l_suppkey_prf#4359 AS l_suppkey_prf_0#4378, l_orderkey_prf#4360 AS l_orderkey_prf_0#4379]
         :     :  +- Relation[l_returnflag_prf#4342,l_orderkey_and_l_linenumber_prf#4343,l_comment_prf#4344,l_linestatus_prf#4345,rid#4346,l_shipmode_prf#4347,l_shipinstruct_prf#4348,l_quantity_prf#4349,l_receiptdate_prf#4350,l_linenumber_prf#4351,l_tax_prf#4352,l_shipdate_prf#4353,l_extendedprice_prf#4354,l_partkey_prf#4355,l_discount_prf#4356,l_partkey_and_l_suppkey_prf#4357,l_commitdate_prf#4358,l_suppkey_prf#4359,l_orderkey_prf#4360] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#4381 AS p_comment_prf_1#4391, p_name_prf#4382 AS p_name_prf_1#4392, rid#4383 AS rid_1#4393, p_type_prf#4384 AS p_type_prf_1#4394, p_retailprice_prf#4385 AS p_retailprice_prf_1#4395, p_mfgr_prf#4386 AS p_mfgr_prf_1#4396, p_container_prf#4387 AS p_container_prf_1#4397, p_brand_prf#4388 AS p_brand_prf_1#4398, p_size_prf#4389 AS p_size_prf_1#4399, p_partkey_prf#4390 AS p_partkey_prf_1#4400]
            +- Relation[p_comment_prf#4381,p_name_prf#4382,rid#4383,p_type_prf#4384,p_retailprice_prf#4385,p_mfgr_prf#4386,p_container_prf#4387,p_brand_prf#4388,p_size_prf#4389,p_partkey_prf#4390] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 116814ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/14 18:02:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 18:02:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4452L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 18:02:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4452L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_2#4472]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#4464: string
         :     :- Project [c_acctbal_prf#4454 AS c_acctbal_prf_0#4463, rid#4455 AS rid_0#4464, c_name_prf#4456 AS c_name_prf_0#4465, c_nationkey_prf#4457 AS c_nationkey_prf_0#4466, c_custkey_prf#4458 AS c_custkey_prf_0#4467, c_comment_prf#4459 AS c_comment_prf_0#4468, c_address_prf#4460 AS c_address_prf_0#4469, c_mktsegment_prf#4461 AS c_mktsegment_prf_0#4470, c_phone_prf#4462 AS c_phone_prf_0#4471]
         :     :  +- Relation[c_acctbal_prf#4454,rid#4455,c_name_prf#4456,c_nationkey_prf#4457,c_custkey_prf#4458,c_comment_prf#4459,c_address_prf#4460,c_mktsegment_prf#4461,c_phone_prf#4462] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1513) AS rid_2#4489]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#4482: string
            :     :- Project [s_phone_prf#4473 AS s_phone_prf_1#4481, rid#4474 AS rid_1#4482, s_address_prf#4475 AS s_address_prf_1#4483, s_nationkey_prf#4476 AS s_nationkey_prf_1#4484, s_suppkey_prf#4477 AS s_suppkey_prf_1#4485, s_name_prf#4478 AS s_name_prf_1#4486, s_acctbal_prf#4479 AS s_acctbal_prf_1#4487, s_comment_prf#4480 AS s_comment_prf_1#4488]
            :     :  +- Relation[s_phone_prf#4473,rid#4474,s_address_prf#4475,s_nationkey_prf#4476,s_suppkey_prf#4477,s_name_prf#4478,s_acctbal_prf#4479,s_comment_prf#4480] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [rid#4490 AS rid_2#4495, n_regionkey_prf#4491 AS n_regionkey_prf_2#4496, n_nationkey_prf#4492 AS n_nationkey_prf_2#4497, n_name_prf#4493 AS n_name_prf_2#4498, n_comment_prf#4494 AS n_comment_prf_2#4499]
               +- Relation[rid#4490,n_regionkey_prf#4491,n_nationkey_prf#4492,n_name_prf#4493,n_comment_prf#4494] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 70069ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/14 18:03:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 18:03:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4537L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 18:03:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4537L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#4555]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#4548: string
         :     :- Project [s_phone_prf#4539 AS s_phone_prf_0#4547, rid#4540 AS rid_0#4548, s_address_prf#4541 AS s_address_prf_0#4549, s_nationkey_prf#4542 AS s_nationkey_prf_0#4550, s_suppkey_prf#4543 AS s_suppkey_prf_0#4551, s_name_prf#4544 AS s_name_prf_0#4552, s_acctbal_prf#4545 AS s_acctbal_prf_0#4553, s_comment_prf#4546 AS s_comment_prf_0#4554]
         :     :  +- Relation[s_phone_prf#4539,rid#4540,s_address_prf#4541,s_nationkey_prf#4542,s_suppkey_prf#4543,s_name_prf#4544,s_acctbal_prf#4545,s_comment_prf#4546] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4556 AS ps_partkey_and_ps_suppkey_prf_1#4563, rid#4557 AS rid_1#4564, ps_availqty_prf#4558 AS ps_availqty_prf_1#4565, ps_comment_prf#4559 AS ps_comment_prf_1#4566, ps_partkey_prf#4560 AS ps_partkey_prf_1#4567, ps_supplycost_prf#4561 AS ps_supplycost_prf_1#4568, ps_suppkey_prf#4562 AS ps_suppkey_prf_1#4569]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4556,rid#4557,ps_availqty_prf#4558,ps_comment_prf#4559,ps_partkey_prf#4560,ps_supplycost_prf#4561,ps_suppkey_prf#4562] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 10935ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/14 18:03:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 18:03:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4607L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 18:03:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4607L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1513) AS rid_2#4636]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#4619]
         :     :  :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#4614: string
         :     :  :     :- Project [rid#4609 AS rid_0#4614, n_regionkey_prf#4610 AS n_regionkey_prf_0#4615, n_nationkey_prf#4611 AS n_nationkey_prf_0#4616, n_name_prf#4612 AS n_name_prf_0#4617, n_comment_prf#4613 AS n_comment_prf_0#4618]
         :     :  :     :  +- Relation[rid#4609,n_regionkey_prf#4610,n_nationkey_prf#4611,n_name_prf#4612,n_comment_prf#4613] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#4620 AS s_phone_prf_1#4628, rid#4621 AS rid_1#4629, s_address_prf#4622 AS s_address_prf_1#4630, s_nationkey_prf#4623 AS s_nationkey_prf_1#4631, s_suppkey_prf#4624 AS s_suppkey_prf_1#4632, s_name_prf#4625 AS s_name_prf_1#4633, s_acctbal_prf#4626 AS s_acctbal_prf_1#4634, s_comment_prf#4627 AS s_comment_prf_1#4635]
         :     :     +- Relation[s_phone_prf#4620,rid#4621,s_address_prf#4622,s_nationkey_prf#4623,s_suppkey_prf#4624,s_name_prf#4625,s_acctbal_prf#4626,s_comment_prf#4627] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4637 AS c_acctbal_prf_2#4646, rid#4638 AS rid_2#4647, c_name_prf#4639 AS c_name_prf_2#4648, c_nationkey_prf#4640 AS c_nationkey_prf_2#4649, c_custkey_prf#4641 AS c_custkey_prf_2#4650, c_comment_prf#4642 AS c_comment_prf_2#4651, c_address_prf#4643 AS c_address_prf_2#4652, c_mktsegment_prf#4644 AS c_mktsegment_prf_2#4653, c_phone_prf#4645 AS c_phone_prf_2#4654]
            +- Relation[c_acctbal_prf#4637,rid#4638,c_name_prf#4639,c_nationkey_prf#4640,c_custkey_prf#4641,c_comment_prf#4642,c_address_prf#4643,c_mktsegment_prf#4644,c_phone_prf#4645] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 767024ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/14 18:16:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 18:16:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4713L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 18:16:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4713L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_2#4733]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4725: string
         :     :- Project [c_acctbal_prf#4715 AS c_acctbal_prf_0#4724, rid#4716 AS rid_0#4725, c_name_prf#4717 AS c_name_prf_0#4726, c_nationkey_prf#4718 AS c_nationkey_prf_0#4727, c_custkey_prf#4719 AS c_custkey_prf_0#4728, c_comment_prf#4720 AS c_comment_prf_0#4729, c_address_prf#4721 AS c_address_prf_0#4730, c_mktsegment_prf#4722 AS c_mktsegment_prf_0#4731, c_phone_prf#4723 AS c_phone_prf_0#4732]
         :     :  +- Relation[c_acctbal_prf#4715,rid#4716,c_name_prf#4717,c_nationkey_prf#4718,c_custkey_prf#4719,c_comment_prf#4720,c_address_prf#4721,c_mktsegment_prf#4722,c_phone_prf#4723] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1513) AS rid_2#4772]
            :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_1#4757: string
            :     :- Project [l_returnflag_prf#4734 AS l_returnflag_prf_1#4753, l_orderkey_and_l_linenumber_prf#4735 AS l_orderkey_and_l_linenumber_prf_1#4754, l_comment_prf#4736 AS l_comment_prf_1#4755, l_linestatus_prf#4737 AS l_linestatus_prf_1#4756, rid#4738 AS rid_1#4757, l_shipmode_prf#4739 AS l_shipmode_prf_1#4758, l_shipinstruct_prf#4740 AS l_shipinstruct_prf_1#4759, l_quantity_prf#4741 AS l_quantity_prf_1#4760, l_receiptdate_prf#4742 AS l_receiptdate_prf_1#4761, l_linenumber_prf#4743 AS l_linenumber_prf_1#4762, l_tax_prf#4744 AS l_tax_prf_1#4763, l_shipdate_prf#4745 AS l_shipdate_prf_1#4764, l_extendedprice_prf#4746 AS l_extendedprice_prf_1#4765, l_partkey_prf#4747 AS l_partkey_prf_1#4766, l_discount_prf#4748 AS l_discount_prf_1#4767, l_partkey_and_l_suppkey_prf#4749 AS l_partkey_and_l_suppkey_prf_1#4768, l_commitdate_prf#4750 AS l_commitdate_prf_1#4769, l_suppkey_prf#4751 AS l_suppkey_prf_1#4770, l_orderkey_prf#4752 AS l_orderkey_prf_1#4771]
            :     :  +- Relation[l_returnflag_prf#4734,l_orderkey_and_l_linenumber_prf#4735,l_comment_prf#4736,l_linestatus_prf#4737,rid#4738,l_shipmode_prf#4739,l_shipinstruct_prf#4740,l_quantity_prf#4741,l_receiptdate_prf#4742,l_linenumber_prf#4743,l_tax_prf#4744,l_shipdate_prf#4745,l_extendedprice_prf#4746,l_partkey_prf#4747,l_discount_prf#4748,l_partkey_and_l_suppkey_prf#4749,l_commitdate_prf#4750,l_suppkey_prf#4751,l_orderkey_prf#4752] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4773 AS o_shippriority_prf_2#4783, rid#4774 AS rid_2#4784, o_orderdate_prf#4775 AS o_orderdate_prf_2#4785, o_custkey_prf#4776 AS o_custkey_prf_2#4786, o_orderpriority_prf#4777 AS o_orderpriority_prf_2#4787, o_clerk_prf#4778 AS o_clerk_prf_2#4788, o_orderstatus_prf#4779 AS o_orderstatus_prf_2#4789, o_totalprice_prf#4780 AS o_totalprice_prf_2#4790, o_orderkey_prf#4781 AS o_orderkey_prf_2#4791, o_comment_prf#4782 AS o_comment_prf_2#4792]
               +- Relation[o_shippriority_prf#4773,rid#4774,o_orderdate_prf#4775,o_custkey_prf#4776,o_orderpriority_prf#4777,o_clerk_prf#4778,o_orderstatus_prf#4779,o_totalprice_prf#4780,o_orderkey_prf#4781,o_comment_prf#4782] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 158354ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/14 18:18:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 18:18:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4845L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 18:18:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4845L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#4857]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#4852: string
         :     :- Project [rid#4847 AS rid_0#4852, n_regionkey_prf#4848 AS n_regionkey_prf_0#4853, n_nationkey_prf#4849 AS n_nationkey_prf_0#4854, n_name_prf#4850 AS n_name_prf_0#4855, n_comment_prf#4851 AS n_comment_prf_0#4856]
         :     :  +- Relation[rid#4847,n_regionkey_prf#4848,n_nationkey_prf#4849,n_name_prf#4850,n_comment_prf#4851] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4858 AS s_phone_prf_1#4866, rid#4859 AS rid_1#4867, s_address_prf#4860 AS s_address_prf_1#4868, s_nationkey_prf#4861 AS s_nationkey_prf_1#4869, s_suppkey_prf#4862 AS s_suppkey_prf_1#4870, s_name_prf#4863 AS s_name_prf_1#4871, s_acctbal_prf#4864 AS s_acctbal_prf_1#4872, s_comment_prf#4865 AS s_comment_prf_1#4873]
            +- Relation[s_phone_prf#4858,rid#4859,s_address_prf#4860,s_nationkey_prf#4861,s_suppkey_prf#4862,s_name_prf#4863,s_acctbal_prf#4864,s_comment_prf#4865] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=10000
Elapsed time: 189ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/14 18:18:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 18:18:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4923L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 18:18:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4923L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#4943]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4935: string
         :     :- Project [c_acctbal_prf#4925 AS c_acctbal_prf_0#4934, rid#4926 AS rid_0#4935, c_name_prf#4927 AS c_name_prf_0#4936, c_nationkey_prf#4928 AS c_nationkey_prf_0#4937, c_custkey_prf#4929 AS c_custkey_prf_0#4938, c_comment_prf#4930 AS c_comment_prf_0#4939, c_address_prf#4931 AS c_address_prf_0#4940, c_mktsegment_prf#4932 AS c_mktsegment_prf_0#4941, c_phone_prf#4933 AS c_phone_prf_0#4942]
         :     :  +- Relation[c_acctbal_prf#4925,rid#4926,c_name_prf#4927,c_nationkey_prf#4928,c_custkey_prf#4929,c_comment_prf#4930,c_address_prf#4931,c_mktsegment_prf#4932,c_phone_prf#4933] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1513) AS rid_2#4964]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#4955: string
            :     :- Project [o_shippriority_prf#4944 AS o_shippriority_prf_1#4954, rid#4945 AS rid_1#4955, o_orderdate_prf#4946 AS o_orderdate_prf_1#4956, o_custkey_prf#4947 AS o_custkey_prf_1#4957, o_orderpriority_prf#4948 AS o_orderpriority_prf_1#4958, o_clerk_prf#4949 AS o_clerk_prf_1#4959, o_orderstatus_prf#4950 AS o_orderstatus_prf_1#4960, o_totalprice_prf#4951 AS o_totalprice_prf_1#4961, o_orderkey_prf#4952 AS o_orderkey_prf_1#4962, o_comment_prf#4953 AS o_comment_prf_1#4963]
            :     :  +- Relation[o_shippriority_prf#4944,rid#4945,o_orderdate_prf#4946,o_custkey_prf#4947,o_orderpriority_prf#4948,o_clerk_prf#4949,o_orderstatus_prf#4950,o_totalprice_prf#4951,o_orderkey_prf#4952,o_comment_prf#4953] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4965 AS l_returnflag_prf_2#4984, l_orderkey_and_l_linenumber_prf#4966 AS l_orderkey_and_l_linenumber_prf_2#4985, l_comment_prf#4967 AS l_comment_prf_2#4986, l_linestatus_prf#4968 AS l_linestatus_prf_2#4987, rid#4969 AS rid_2#4988, l_shipmode_prf#4970 AS l_shipmode_prf_2#4989, l_shipinstruct_prf#4971 AS l_shipinstruct_prf_2#4990, l_quantity_prf#4972 AS l_quantity_prf_2#4991, l_receiptdate_prf#4973 AS l_receiptdate_prf_2#4992, l_linenumber_prf#4974 AS l_linenumber_prf_2#4993, l_tax_prf#4975 AS l_tax_prf_2#4994, l_shipdate_prf#4976 AS l_shipdate_prf_2#4995, l_extendedprice_prf#4977 AS l_extendedprice_prf_2#4996, l_partkey_prf#4978 AS l_partkey_prf_2#4997, l_discount_prf#4979 AS l_discount_prf_2#4998, l_partkey_and_l_suppkey_prf#4980 AS l_partkey_and_l_suppkey_prf_2#4999, l_commitdate_prf#4981 AS l_commitdate_prf_2#5000, l_suppkey_prf#4982 AS l_suppkey_prf_2#5001, l_orderkey_prf#4983 AS l_orderkey_prf_2#5002]
               +- Relation[l_returnflag_prf#4965,l_orderkey_and_l_linenumber_prf#4966,l_comment_prf#4967,l_linestatus_prf#4968,rid#4969,l_shipmode_prf#4970,l_shipinstruct_prf#4971,l_quantity_prf#4972,l_receiptdate_prf#4973,l_linenumber_prf#4974,l_tax_prf#4975,l_shipdate_prf#4976,l_extendedprice_prf#4977,l_partkey_prf#4978,l_discount_prf#4979,l_partkey_and_l_suppkey_prf#4980,l_commitdate_prf#4981,l_suppkey_prf#4982,l_orderkey_prf#4983] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 235617ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/14 18:22:48 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 18:22:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5077L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 18:22:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5077L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_2#5117]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#5102: string
         :     :- Project [l_returnflag_prf#5079 AS l_returnflag_prf_0#5098, l_orderkey_and_l_linenumber_prf#5080 AS l_orderkey_and_l_linenumber_prf_0#5099, l_comment_prf#5081 AS l_comment_prf_0#5100, l_linestatus_prf#5082 AS l_linestatus_prf_0#5101, rid#5083 AS rid_0#5102, l_shipmode_prf#5084 AS l_shipmode_prf_0#5103, l_shipinstruct_prf#5085 AS l_shipinstruct_prf_0#5104, l_quantity_prf#5086 AS l_quantity_prf_0#5105, l_receiptdate_prf#5087 AS l_receiptdate_prf_0#5106, l_linenumber_prf#5088 AS l_linenumber_prf_0#5107, l_tax_prf#5089 AS l_tax_prf_0#5108, l_shipdate_prf#5090 AS l_shipdate_prf_0#5109, l_extendedprice_prf#5091 AS l_extendedprice_prf_0#5110, l_partkey_prf#5092 AS l_partkey_prf_0#5111, l_discount_prf#5093 AS l_discount_prf_0#5112, l_partkey_and_l_suppkey_prf#5094 AS l_partkey_and_l_suppkey_prf_0#5113, l_commitdate_prf#5095 AS l_commitdate_prf_0#5114, l_suppkey_prf#5096 AS l_suppkey_prf_0#5115, l_orderkey_prf#5097 AS l_orderkey_prf_0#5116]
         :     :  +- Relation[l_returnflag_prf#5079,l_orderkey_and_l_linenumber_prf#5080,l_comment_prf#5081,l_linestatus_prf#5082,rid#5083,l_shipmode_prf#5084,l_shipinstruct_prf#5085,l_quantity_prf#5086,l_receiptdate_prf#5087,l_linenumber_prf#5088,l_tax_prf#5089,l_shipdate_prf#5090,l_extendedprice_prf#5091,l_partkey_prf#5092,l_discount_prf#5093,l_partkey_and_l_suppkey_prf#5094,l_commitdate_prf#5095,l_suppkey_prf#5096,l_orderkey_prf#5097] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1513) AS rid_2#5136]
            :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#5128: string
            :     :- Project [c_acctbal_prf#5118 AS c_acctbal_prf_1#5127, rid#5119 AS rid_1#5128, c_name_prf#5120 AS c_name_prf_1#5129, c_nationkey_prf#5121 AS c_nationkey_prf_1#5130, c_custkey_prf#5122 AS c_custkey_prf_1#5131, c_comment_prf#5123 AS c_comment_prf_1#5132, c_address_prf#5124 AS c_address_prf_1#5133, c_mktsegment_prf#5125 AS c_mktsegment_prf_1#5134, c_phone_prf#5126 AS c_phone_prf_1#5135]
            :     :  +- Relation[c_acctbal_prf#5118,rid#5119,c_name_prf#5120,c_nationkey_prf#5121,c_custkey_prf#5122,c_comment_prf#5123,c_address_prf#5124,c_mktsegment_prf#5125,c_phone_prf#5126] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#5137 AS o_shippriority_prf_2#5147, rid#5138 AS rid_2#5148, o_orderdate_prf#5139 AS o_orderdate_prf_2#5149, o_custkey_prf#5140 AS o_custkey_prf_2#5150, o_orderpriority_prf#5141 AS o_orderpriority_prf_2#5151, o_clerk_prf#5142 AS o_clerk_prf_2#5152, o_orderstatus_prf#5143 AS o_orderstatus_prf_2#5153, o_totalprice_prf#5144 AS o_totalprice_prf_2#5154, o_orderkey_prf#5145 AS o_orderkey_prf_2#5155, o_comment_prf#5146 AS o_comment_prf_2#5156]
               +- Relation[o_shippriority_prf#5137,rid#5138,o_orderdate_prf#5139,o_custkey_prf#5140,o_orderpriority_prf#5141,o_clerk_prf#5142,o_orderstatus_prf#5143,o_totalprice_prf#5144,o_orderkey_prf#5145,o_comment_prf#5146] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 158789ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/14 18:25:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 18:25:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5223L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 18:25:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5223L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#5245]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#5236: string
         :     :- Project [o_shippriority_prf#5225 AS o_shippriority_prf_0#5235, rid#5226 AS rid_0#5236, o_orderdate_prf#5227 AS o_orderdate_prf_0#5237, o_custkey_prf#5228 AS o_custkey_prf_0#5238, o_orderpriority_prf#5229 AS o_orderpriority_prf_0#5239, o_clerk_prf#5230 AS o_clerk_prf_0#5240, o_orderstatus_prf#5231 AS o_orderstatus_prf_0#5241, o_totalprice_prf#5232 AS o_totalprice_prf_0#5242, o_orderkey_prf#5233 AS o_orderkey_prf_0#5243, o_comment_prf#5234 AS o_comment_prf_0#5244]
         :     :  +- Relation[o_shippriority_prf#5225,rid#5226,o_orderdate_prf#5227,o_custkey_prf#5228,o_orderpriority_prf#5229,o_clerk_prf#5230,o_orderstatus_prf#5231,o_totalprice_prf#5232,o_orderkey_prf#5233,o_comment_prf#5234] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#5246 AS l_returnflag_prf_1#5265, l_orderkey_and_l_linenumber_prf#5247 AS l_orderkey_and_l_linenumber_prf_1#5266, l_comment_prf#5248 AS l_comment_prf_1#5267, l_linestatus_prf#5249 AS l_linestatus_prf_1#5268, rid#5250 AS rid_1#5269, l_shipmode_prf#5251 AS l_shipmode_prf_1#5270, l_shipinstruct_prf#5252 AS l_shipinstruct_prf_1#5271, l_quantity_prf#5253 AS l_quantity_prf_1#5272, l_receiptdate_prf#5254 AS l_receiptdate_prf_1#5273, l_linenumber_prf#5255 AS l_linenumber_prf_1#5274, l_tax_prf#5256 AS l_tax_prf_1#5275, l_shipdate_prf#5257 AS l_shipdate_prf_1#5276, l_extendedprice_prf#5258 AS l_extendedprice_prf_1#5277, l_partkey_prf#5259 AS l_partkey_prf_1#5278, l_discount_prf#5260 AS l_discount_prf_1#5279, l_partkey_and_l_suppkey_prf#5261 AS l_partkey_and_l_suppkey_prf_1#5280, l_commitdate_prf#5262 AS l_commitdate_prf_1#5281, l_suppkey_prf#5263 AS l_suppkey_prf_1#5282, l_orderkey_prf#5264 AS l_orderkey_prf_1#5283]
            :  +- Relation[l_returnflag_prf#5246,l_orderkey_and_l_linenumber_prf#5247,l_comment_prf#5248,l_linestatus_prf#5249,rid#5250,l_shipmode_prf#5251,l_shipinstruct_prf#5252,l_quantity_prf#5253,l_receiptdate_prf#5254,l_linenumber_prf#5255,l_tax_prf#5256,l_shipdate_prf#5257,l_extendedprice_prf#5258,l_partkey_prf#5259,l_discount_prf#5260,l_partkey_and_l_suppkey_prf#5261,l_commitdate_prf#5262,l_suppkey_prf#5263,l_orderkey_prf#5264] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5284]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#2083,value#2084] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 198217ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/14 18:28:45 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 18:28:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5338L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 18:28:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5338L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1513) AS rid_2#5375]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1513) AS rid_1#5360]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#5352: string
         :     :  :     :- Project [p_comment_prf#5340 AS p_comment_prf_0#5350, p_name_prf#5341 AS p_name_prf_0#5351, rid#5342 AS rid_0#5352, p_type_prf#5343 AS p_type_prf_0#5353, p_retailprice_prf#5344 AS p_retailprice_prf_0#5354, p_mfgr_prf#5345 AS p_mfgr_prf_0#5355, p_container_prf#5346 AS p_container_prf_0#5356, p_brand_prf#5347 AS p_brand_prf_0#5357, p_size_prf#5348 AS p_size_prf_0#5358, p_partkey_prf#5349 AS p_partkey_prf_0#5359]
         :     :  :     :  +- Relation[p_comment_prf#5340,p_name_prf#5341,rid#5342,p_type_prf#5343,p_retailprice_prf#5344,p_mfgr_prf#5345,p_container_prf#5346,p_brand_prf#5347,p_size_prf#5348,p_partkey_prf#5349] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#5361 AS ps_partkey_and_ps_suppkey_prf_1#5368, rid#5362 AS rid_1#5369, ps_availqty_prf#5363 AS ps_availqty_prf_1#5370, ps_comment_prf#5364 AS ps_comment_prf_1#5371, ps_partkey_prf#5365 AS ps_partkey_prf_1#5372, ps_supplycost_prf#5366 AS ps_supplycost_prf_1#5373, ps_suppkey_prf#5367 AS ps_suppkey_prf_1#5374]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#5361,rid#5362,ps_availqty_prf#5363,ps_comment_prf#5364,ps_partkey_prf#5365,ps_supplycost_prf#5366,ps_suppkey_prf#5367] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1512,value#1513] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5376 AS s_phone_prf_2#5384, rid#5377 AS rid_2#5385, s_address_prf#5378 AS s_address_prf_2#5386, s_nationkey_prf#5379 AS s_nationkey_prf_2#5387, s_suppkey_prf#5380 AS s_suppkey_prf_2#5388, s_name_prf#5381 AS s_name_prf_2#5389, s_acctbal_prf#5382 AS s_acctbal_prf_2#5390, s_comment_prf#5383 AS s_comment_prf_2#5391]
            +- Relation[s_phone_prf#5376,rid#5377,s_address_prf#5378,s_nationkey_prf#5379,s_suppkey_prf#5380,s_name_prf#5381,s_acctbal_prf#5382,s_comment_prf#5383] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 88620ms
query=b1a, count=15628, duration=423
query=b1b, count=15628, duration=49791
query=b2a, count=1478870, duration=198217
query=b2b, count=1478870, duration=54453
query=f1, count=1, duration=56
query=f2, count=3907, duration=129
query=f3, count=1451, duration=82
query=f4, count=1, duration=64
query=f5, count=1478870, duration=23352
query=f6, count=857401, duration=13725
query=j1, count=800000, duration=31685
query=j10, count=6001215, duration=86489
query=j2, count=800000, duration=10935
query=j3, count=25, duration=77
query=j4, count=150000, duration=1938
query=j5, count=10000, duration=189
query=j6, count=6001215, duration=116245
query=j7, count=1500000, duration=40195
query=j8, count=6001215, duration=194689
query=j8b, count=6001215, duration=114228
query=j9, count=6001215, duration=94188
query=j9b, count=6001215, duration=116814
query=r1a, count=6001215, duration=333648
query=r1b, count=6001215, duration=148599
query=r1c, count=6001215, duration=158789
query=r1d, count=6001215, duration=270788
query=r1e, count=6001215, duration=235617
query=r1f, count=6001215, duration=158354
query=t1a, count=60000414, duration=672722
query=t1b, count=60000414, duration=767024
query=t1c, count=60000414, duration=70069
query=t2a, count=800000, duration=106686
query=t2b, count=800000, duration=88620
query=t2c, count=800000, duration=42979
query=t2d, count=800000, duration=61458
query=t3a, count=6001215, duration=262193
query=t3b, count=6001215, duration=291196
query=t3c, count=6001215, duration=187908
query=t3d, count=6001215, duration=185986
