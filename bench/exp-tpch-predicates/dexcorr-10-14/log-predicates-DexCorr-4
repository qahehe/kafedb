19/10/14 08:24:08 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7085ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Mon Oct 14 08:24:10 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Mon Oct 14 08:24:11 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Mon Oct 14 08:24:11 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Mon Oct 14 08:24:11 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Mon Oct 14 08:24:11 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Mon Oct 14 08:24:14 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Mon Oct 14 08:24:16 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Mon Oct 14 08:24:16 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/14 08:24:18 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 08:24:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1503L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 08:24:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1503L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_2#1523]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#1514: string
         :     :- Project [s_phone_prf#1505 AS s_phone_prf_0#1513, rid#1506 AS rid_0#1514, s_address_prf#1507 AS s_address_prf_0#1515, s_nationkey_prf#1508 AS s_nationkey_prf_0#1516, s_suppkey_prf#1509 AS s_suppkey_prf_0#1517, s_name_prf#1510 AS s_name_prf_0#1518, s_acctbal_prf#1511 AS s_acctbal_prf_0#1519, s_comment_prf#1512 AS s_comment_prf_0#1520]
         :     :  +- Relation[s_phone_prf#1505,rid#1506,s_address_prf#1507,s_nationkey_prf#1508,s_suppkey_prf#1509,s_name_prf#1510,s_acctbal_prf#1511,s_comment_prf#1512] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#1544]
            :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#1536: string
            :     :- Project [p_comment_prf#1524 AS p_comment_prf_1#1534, p_name_prf#1525 AS p_name_prf_1#1535, rid#1526 AS rid_1#1536, p_type_prf#1527 AS p_type_prf_1#1537, p_retailprice_prf#1528 AS p_retailprice_prf_1#1538, p_mfgr_prf#1529 AS p_mfgr_prf_1#1539, p_container_prf#1530 AS p_container_prf_1#1540, p_brand_prf#1531 AS p_brand_prf_1#1541, p_size_prf#1532 AS p_size_prf_1#1542, p_partkey_prf#1533 AS p_partkey_prf_1#1543]
            :     :  +- Relation[p_comment_prf#1524,p_name_prf#1525,rid#1526,p_type_prf#1527,p_retailprice_prf#1528,p_mfgr_prf#1529,p_container_prf#1530,p_brand_prf#1531,p_size_prf#1532,p_partkey_prf#1533] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#1545 AS l_returnflag_prf_2#1564, l_orderkey_and_l_linenumber_prf#1546 AS l_orderkey_and_l_linenumber_prf_2#1565, l_comment_prf#1547 AS l_comment_prf_2#1566, l_linestatus_prf#1548 AS l_linestatus_prf_2#1567, rid#1549 AS rid_2#1568, l_shipmode_prf#1550 AS l_shipmode_prf_2#1569, l_shipinstruct_prf#1551 AS l_shipinstruct_prf_2#1570, l_quantity_prf#1552 AS l_quantity_prf_2#1571, l_receiptdate_prf#1553 AS l_receiptdate_prf_2#1572, l_linenumber_prf#1554 AS l_linenumber_prf_2#1573, l_tax_prf#1555 AS l_tax_prf_2#1574, l_shipdate_prf#1556 AS l_shipdate_prf_2#1575, l_extendedprice_prf#1557 AS l_extendedprice_prf_2#1576, l_partkey_prf#1558 AS l_partkey_prf_2#1577, l_discount_prf#1559 AS l_discount_prf_2#1578, l_partkey_and_l_suppkey_prf#1560 AS l_partkey_and_l_suppkey_prf_2#1579, l_commitdate_prf#1561 AS l_commitdate_prf_2#1580, l_suppkey_prf#1562 AS l_suppkey_prf_2#1581, l_orderkey_prf#1563 AS l_orderkey_prf_2#1582]
               +- Relation[l_returnflag_prf#1545,l_orderkey_and_l_linenumber_prf#1546,l_comment_prf#1547,l_linestatus_prf#1548,rid#1549,l_shipmode_prf#1550,l_shipinstruct_prf#1551,l_quantity_prf#1552,l_receiptdate_prf#1553,l_linenumber_prf#1554,l_tax_prf#1555,l_shipdate_prf#1556,l_extendedprice_prf#1557,l_partkey_prf#1558,l_discount_prf#1559,l_partkey_and_l_suppkey_prf#1560,l_commitdate_prf#1561,l_suppkey_prf#1562,l_orderkey_prf#1563] JDBCRelation(lineitem_prf) [numPartitions=1]

19/10/14 08:24:18 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=6001215
Elapsed time: 188884ms

f2=
select * from part where p_size = 15
19/10/14 08:27:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 08:27:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1632L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 08:27:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1632L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#1634 AS p_comment_prf_0#1644, p_name_prf#1635 AS p_name_prf_0#1645, rid#1636 AS rid_0#1646, p_type_prf#1637 AS p_type_prf_0#1647, p_retailprice_prf#1638 AS p_retailprice_prf_0#1648, p_mfgr_prf#1639 AS p_mfgr_prf_0#1649, p_container_prf#1640 AS p_container_prf_0#1650, p_brand_prf#1641 AS p_brand_prf_0#1651, p_size_prf#1642 AS p_size_prf_0#1652, p_partkey_prf#1643 AS p_partkey_prf_0#1653]
         :  +- Relation[p_comment_prf#1634,p_name_prf#1635,rid#1636,p_type_prf#1637,p_retailprice_prf#1638,p_mfgr_prf#1639,p_container_prf#1640,p_brand_prf#1641,p_size_prf#1642,p_partkey_prf#1643] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1656]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1654,value#1655] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3907
Elapsed time: 150ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/14 08:27:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 08:27:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1691L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 08:27:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1691L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#1728]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#1713]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#1705: string
         :     :  :     :- Project [p_comment_prf#1693 AS p_comment_prf_0#1703, p_name_prf#1694 AS p_name_prf_0#1704, rid#1695 AS rid_0#1705, p_type_prf#1696 AS p_type_prf_0#1706, p_retailprice_prf#1697 AS p_retailprice_prf_0#1707, p_mfgr_prf#1698 AS p_mfgr_prf_0#1708, p_container_prf#1699 AS p_container_prf_0#1709, p_brand_prf#1700 AS p_brand_prf_0#1710, p_size_prf#1701 AS p_size_prf_0#1711, p_partkey_prf#1702 AS p_partkey_prf_0#1712]
         :     :  :     :  +- Relation[p_comment_prf#1693,p_name_prf#1694,rid#1695,p_type_prf#1696,p_retailprice_prf#1697,p_mfgr_prf#1698,p_container_prf#1699,p_brand_prf#1700,p_size_prf#1701,p_partkey_prf#1702] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#1714 AS ps_partkey_and_ps_suppkey_prf_1#1721, rid#1715 AS rid_1#1722, ps_availqty_prf#1716 AS ps_availqty_prf_1#1723, ps_comment_prf#1717 AS ps_comment_prf_1#1724, ps_partkey_prf#1718 AS ps_partkey_prf_1#1725, ps_supplycost_prf#1719 AS ps_supplycost_prf_1#1726, ps_suppkey_prf#1720 AS ps_suppkey_prf_1#1727]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#1714,rid#1715,ps_availqty_prf#1716,ps_comment_prf#1717,ps_partkey_prf#1718,ps_supplycost_prf#1719,ps_suppkey_prf#1720] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#1729 AS s_phone_prf_2#1737, rid#1730 AS rid_2#1738, s_address_prf#1731 AS s_address_prf_2#1739, s_nationkey_prf#1732 AS s_nationkey_prf_2#1740, s_suppkey_prf#1733 AS s_suppkey_prf_2#1741, s_name_prf#1734 AS s_name_prf_2#1742, s_acctbal_prf#1735 AS s_acctbal_prf_2#1743, s_comment_prf#1736 AS s_comment_prf_2#1744]
            +- Relation[s_phone_prf#1729,rid#1730,s_address_prf#1731,s_nationkey_prf#1732,s_suppkey_prf#1733,s_name_prf#1734,s_acctbal_prf#1735,s_comment_prf#1736] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 88307ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/14 08:28:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 08:28:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1805L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 08:28:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1805L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#1845]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#1830: string
         :     :  :     :- Project [l_returnflag_prf#1807 AS l_returnflag_prf_0#1826, l_orderkey_and_l_linenumber_prf#1808 AS l_orderkey_and_l_linenumber_prf_0#1827, l_comment_prf#1809 AS l_comment_prf_0#1828, l_linestatus_prf#1810 AS l_linestatus_prf_0#1829, rid#1811 AS rid_0#1830, l_shipmode_prf#1812 AS l_shipmode_prf_0#1831, l_shipinstruct_prf#1813 AS l_shipinstruct_prf_0#1832, l_quantity_prf#1814 AS l_quantity_prf_0#1833, l_receiptdate_prf#1815 AS l_receiptdate_prf_0#1834, l_linenumber_prf#1816 AS l_linenumber_prf_0#1835, l_tax_prf#1817 AS l_tax_prf_0#1836, l_shipdate_prf#1818 AS l_shipdate_prf_0#1837, l_extendedprice_prf#1819 AS l_extendedprice_prf_0#1838, l_partkey_prf#1820 AS l_partkey_prf_0#1839, l_discount_prf#1821 AS l_discount_prf_0#1840, l_partkey_and_l_suppkey_prf#1822 AS l_partkey_and_l_suppkey_prf_0#1841, l_commitdate_prf#1823 AS l_commitdate_prf_0#1842, l_suppkey_prf#1824 AS l_suppkey_prf_0#1843, l_orderkey_prf#1825 AS l_orderkey_prf_0#1844]
         :     :  :     :  +- Relation[l_returnflag_prf#1807,l_orderkey_and_l_linenumber_prf#1808,l_comment_prf#1809,l_linestatus_prf#1810,rid#1811,l_shipmode_prf#1812,l_shipinstruct_prf#1813,l_quantity_prf#1814,l_receiptdate_prf#1815,l_linenumber_prf#1816,l_tax_prf#1817,l_shipdate_prf#1818,l_extendedprice_prf#1819,l_partkey_prf#1820,l_discount_prf#1821,l_partkey_and_l_suppkey_prf#1822,l_commitdate_prf#1823,l_suppkey_prf#1824,l_orderkey_prf#1825] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#1846 AS p_comment_prf_1#1856, p_name_prf#1847 AS p_name_prf_1#1857, rid#1848 AS rid_1#1858, p_type_prf#1849 AS p_type_prf_1#1859, p_retailprice_prf#1850 AS p_retailprice_prf_1#1860, p_mfgr_prf#1851 AS p_mfgr_prf_1#1861, p_container_prf#1852 AS p_container_prf_1#1862, p_brand_prf#1853 AS p_brand_prf_1#1863, p_size_prf#1854 AS p_size_prf_1#1864, p_partkey_prf#1855 AS p_partkey_prf_1#1865]
         :     :     +- Relation[p_comment_prf#1846,p_name_prf#1847,rid#1848,p_type_prf#1849,p_retailprice_prf#1850,p_mfgr_prf#1851,p_container_prf#1852,p_brand_prf#1853,p_size_prf#1854,p_partkey_prf#1855] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#1867 AS s_phone_prf_2#1875, rid#1868 AS rid_2#1876, s_address_prf#1869 AS s_address_prf_2#1877, s_nationkey_prf#1870 AS s_nationkey_prf_2#1878, s_suppkey_prf#1871 AS s_suppkey_prf_2#1879, s_name_prf#1872 AS s_name_prf_2#1880, s_acctbal_prf#1873 AS s_acctbal_prf_2#1881, s_comment_prf#1874 AS s_comment_prf_2#1882]
            +- Relation[s_phone_prf#1867,rid#1868,s_address_prf#1869,s_nationkey_prf#1870,s_suppkey_prf#1871,s_name_prf#1872,s_acctbal_prf#1873,s_comment_prf#1874] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 263262ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/14 08:33:18 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 08:33:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1942L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 08:33:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1942L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#1971]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#1954]
         :     :  :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#1949: string
         :     :  :     :- Project [rid#1944 AS rid_0#1949, n_regionkey_prf#1945 AS n_regionkey_prf_0#1950, n_nationkey_prf#1946 AS n_nationkey_prf_0#1951, n_name_prf#1947 AS n_name_prf_0#1952, n_comment_prf#1948 AS n_comment_prf_0#1953]
         :     :  :     :  +- Relation[rid#1944,n_regionkey_prf#1945,n_nationkey_prf#1946,n_name_prf#1947,n_comment_prf#1948] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#1955 AS s_phone_prf_1#1963, rid#1956 AS rid_1#1964, s_address_prf#1957 AS s_address_prf_1#1965, s_nationkey_prf#1958 AS s_nationkey_prf_1#1966, s_suppkey_prf#1959 AS s_suppkey_prf_1#1967, s_name_prf#1960 AS s_name_prf_1#1968, s_acctbal_prf#1961 AS s_acctbal_prf_1#1969, s_comment_prf#1962 AS s_comment_prf_1#1970]
         :     :     +- Relation[s_phone_prf#1955,rid#1956,s_address_prf#1957,s_nationkey_prf#1958,s_suppkey_prf#1959,s_name_prf#1960,s_acctbal_prf#1961,s_comment_prf#1962] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#1972 AS c_acctbal_prf_2#1981, rid#1973 AS rid_2#1982, c_name_prf#1974 AS c_name_prf_2#1983, c_nationkey_prf#1975 AS c_nationkey_prf_2#1984, c_custkey_prf#1976 AS c_custkey_prf_2#1985, c_comment_prf#1977 AS c_comment_prf_2#1986, c_address_prf#1978 AS c_address_prf_2#1987, c_mktsegment_prf#1979 AS c_mktsegment_prf_2#1988, c_phone_prf#1980 AS c_phone_prf_2#1989]
            +- Relation[c_acctbal_prf#1972,rid#1973,c_name_prf#1974,c_nationkey_prf#1975,c_custkey_prf#1976,c_comment_prf#1977,c_address_prf#1978,c_mktsegment_prf#1979,c_phone_prf#1980] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 795696ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/14 08:46:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 08:46:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2040L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 08:46:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2040L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#2080]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2065: string
         :     :- Project [l_returnflag_prf#2042 AS l_returnflag_prf_0#2061, l_orderkey_and_l_linenumber_prf#2043 AS l_orderkey_and_l_linenumber_prf_0#2062, l_comment_prf#2044 AS l_comment_prf_0#2063, l_linestatus_prf#2045 AS l_linestatus_prf_0#2064, rid#2046 AS rid_0#2065, l_shipmode_prf#2047 AS l_shipmode_prf_0#2066, l_shipinstruct_prf#2048 AS l_shipinstruct_prf_0#2067, l_quantity_prf#2049 AS l_quantity_prf_0#2068, l_receiptdate_prf#2050 AS l_receiptdate_prf_0#2069, l_linenumber_prf#2051 AS l_linenumber_prf_0#2070, l_tax_prf#2052 AS l_tax_prf_0#2071, l_shipdate_prf#2053 AS l_shipdate_prf_0#2072, l_extendedprice_prf#2054 AS l_extendedprice_prf_0#2073, l_partkey_prf#2055 AS l_partkey_prf_0#2074, l_discount_prf#2056 AS l_discount_prf_0#2075, l_partkey_and_l_suppkey_prf#2057 AS l_partkey_and_l_suppkey_prf_0#2076, l_commitdate_prf#2058 AS l_commitdate_prf_0#2077, l_suppkey_prf#2059 AS l_suppkey_prf_0#2078, l_orderkey_prf#2060 AS l_orderkey_prf_0#2079]
         :     :  +- Relation[l_returnflag_prf#2042,l_orderkey_and_l_linenumber_prf#2043,l_comment_prf#2044,l_linestatus_prf#2045,rid#2046,l_shipmode_prf#2047,l_shipinstruct_prf#2048,l_quantity_prf#2049,l_receiptdate_prf#2050,l_linenumber_prf#2051,l_tax_prf#2052,l_shipdate_prf#2053,l_extendedprice_prf#2054,l_partkey_prf#2055,l_discount_prf#2056,l_partkey_and_l_suppkey_prf#2057,l_commitdate_prf#2058,l_suppkey_prf#2059,l_orderkey_prf#2060] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2081 AS o_shippriority_prf_1#2091, rid#2082 AS rid_1#2092, o_orderdate_prf#2083 AS o_orderdate_prf_1#2093, o_custkey_prf#2084 AS o_custkey_prf_1#2094, o_orderpriority_prf#2085 AS o_orderpriority_prf_1#2095, o_clerk_prf#2086 AS o_clerk_prf_1#2096, o_orderstatus_prf#2087 AS o_orderstatus_prf_1#2097, o_totalprice_prf#2088 AS o_totalprice_prf_1#2098, o_orderkey_prf#2089 AS o_orderkey_prf_1#2099, o_comment_prf#2090 AS o_comment_prf_1#2100]
            +- Relation[o_shippriority_prf#2081,rid#2082,o_orderdate_prf#2083,o_custkey_prf#2084,o_orderpriority_prf#2085,o_clerk_prf#2086,o_orderstatus_prf#2087,o_totalprice_prf#2088,o_orderkey_prf#2089,o_comment_prf#2090] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 114139ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/14 08:48:28 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 08:48:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2165L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 08:48:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2165L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#2183]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#2176: string
         :     :- Project [s_phone_prf#2167 AS s_phone_prf_0#2175, rid#2168 AS rid_0#2176, s_address_prf#2169 AS s_address_prf_0#2177, s_nationkey_prf#2170 AS s_nationkey_prf_0#2178, s_suppkey_prf#2171 AS s_suppkey_prf_0#2179, s_name_prf#2172 AS s_name_prf_0#2180, s_acctbal_prf#2173 AS s_acctbal_prf_0#2181, s_comment_prf#2174 AS s_comment_prf_0#2182]
         :     :  +- Relation[s_phone_prf#2167,rid#2168,s_address_prf#2169,s_nationkey_prf#2170,s_suppkey_prf#2171,s_name_prf#2172,s_acctbal_prf#2173,s_comment_prf#2174] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#2222]
            :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_1#2207: string
            :     :- Project [l_returnflag_prf#2184 AS l_returnflag_prf_1#2203, l_orderkey_and_l_linenumber_prf#2185 AS l_orderkey_and_l_linenumber_prf_1#2204, l_comment_prf#2186 AS l_comment_prf_1#2205, l_linestatus_prf#2187 AS l_linestatus_prf_1#2206, rid#2188 AS rid_1#2207, l_shipmode_prf#2189 AS l_shipmode_prf_1#2208, l_shipinstruct_prf#2190 AS l_shipinstruct_prf_1#2209, l_quantity_prf#2191 AS l_quantity_prf_1#2210, l_receiptdate_prf#2192 AS l_receiptdate_prf_1#2211, l_linenumber_prf#2193 AS l_linenumber_prf_1#2212, l_tax_prf#2194 AS l_tax_prf_1#2213, l_shipdate_prf#2195 AS l_shipdate_prf_1#2214, l_extendedprice_prf#2196 AS l_extendedprice_prf_1#2215, l_partkey_prf#2197 AS l_partkey_prf_1#2216, l_discount_prf#2198 AS l_discount_prf_1#2217, l_partkey_and_l_suppkey_prf#2199 AS l_partkey_and_l_suppkey_prf_1#2218, l_commitdate_prf#2200 AS l_commitdate_prf_1#2219, l_suppkey_prf#2201 AS l_suppkey_prf_1#2220, l_orderkey_prf#2202 AS l_orderkey_prf_1#2221]
            :     :  +- Relation[l_returnflag_prf#2184,l_orderkey_and_l_linenumber_prf#2185,l_comment_prf#2186,l_linestatus_prf#2187,rid#2188,l_shipmode_prf#2189,l_shipinstruct_prf#2190,l_quantity_prf#2191,l_receiptdate_prf#2192,l_linenumber_prf#2193,l_tax_prf#2194,l_shipdate_prf#2195,l_extendedprice_prf#2196,l_partkey_prf#2197,l_discount_prf#2198,l_partkey_and_l_suppkey_prf#2199,l_commitdate_prf#2200,l_suppkey_prf#2201,l_orderkey_prf#2202] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#2223 AS p_comment_prf_2#2233, p_name_prf#2224 AS p_name_prf_2#2234, rid#2225 AS rid_2#2235, p_type_prf#2226 AS p_type_prf_2#2236, p_retailprice_prf#2227 AS p_retailprice_prf_2#2237, p_mfgr_prf#2228 AS p_mfgr_prf_2#2238, p_container_prf#2229 AS p_container_prf_2#2239, p_brand_prf#2230 AS p_brand_prf_2#2240, p_size_prf#2231 AS p_size_prf_2#2241, p_partkey_prf#2232 AS p_partkey_prf_2#2242]
               +- Relation[p_comment_prf#2223,p_name_prf#2224,rid#2225,p_type_prf#2226,p_retailprice_prf#2227,p_mfgr_prf#2228,p_container_prf#2229,p_brand_prf#2230,p_size_prf#2231,p_partkey_prf#2232] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 186279ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/14 08:51:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 08:51:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2297L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 08:51:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2297L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#2313]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#2307: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#2299 AS ps_partkey_and_ps_suppkey_prf_0#2306, rid#2300 AS rid_0#2307, ps_availqty_prf#2301 AS ps_availqty_prf_0#2308, ps_comment_prf#2302 AS ps_comment_prf_0#2309, ps_partkey_prf#2303 AS ps_partkey_prf_0#2310, ps_supplycost_prf#2304 AS ps_supplycost_prf_0#2311, ps_suppkey_prf#2305 AS ps_suppkey_prf_0#2312]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2299,rid#2300,ps_availqty_prf#2301,ps_comment_prf#2302,ps_partkey_prf#2303,ps_supplycost_prf#2304,ps_suppkey_prf#2305] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#2314 AS p_comment_prf_1#2324, p_name_prf#2315 AS p_name_prf_1#2325, rid#2316 AS rid_1#2326, p_type_prf#2317 AS p_type_prf_1#2327, p_retailprice_prf#2318 AS p_retailprice_prf_1#2328, p_mfgr_prf#2319 AS p_mfgr_prf_1#2329, p_container_prf#2320 AS p_container_prf_1#2330, p_brand_prf#2321 AS p_brand_prf_1#2331, p_size_prf#2322 AS p_size_prf_1#2332, p_partkey_prf#2323 AS p_partkey_prf_1#2333]
            :  +- Relation[p_comment_prf#2314,p_name_prf#2315,rid#2316,p_type_prf#2317,p_retailprice_prf#2318,p_mfgr_prf#2319,p_container_prf#2320,p_brand_prf#2321,p_size_prf#2322,p_partkey_prf#2323] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2334]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1654,value#1655] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 49341ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/14 08:52:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 08:52:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2380L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 08:52:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2380L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#2420]
         :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#2405: string
         :     :- Project [l_returnflag_prf#2382 AS l_returnflag_prf_0#2401, l_orderkey_and_l_linenumber_prf#2383 AS l_orderkey_and_l_linenumber_prf_0#2402, l_comment_prf#2384 AS l_comment_prf_0#2403, l_linestatus_prf#2385 AS l_linestatus_prf_0#2404, rid#2386 AS rid_0#2405, l_shipmode_prf#2387 AS l_shipmode_prf_0#2406, l_shipinstruct_prf#2388 AS l_shipinstruct_prf_0#2407, l_quantity_prf#2389 AS l_quantity_prf_0#2408, l_receiptdate_prf#2390 AS l_receiptdate_prf_0#2409, l_linenumber_prf#2391 AS l_linenumber_prf_0#2410, l_tax_prf#2392 AS l_tax_prf_0#2411, l_shipdate_prf#2393 AS l_shipdate_prf_0#2412, l_extendedprice_prf#2394 AS l_extendedprice_prf_0#2413, l_partkey_prf#2395 AS l_partkey_prf_0#2414, l_discount_prf#2396 AS l_discount_prf_0#2415, l_partkey_and_l_suppkey_prf#2397 AS l_partkey_and_l_suppkey_prf_0#2416, l_commitdate_prf#2398 AS l_commitdate_prf_0#2417, l_suppkey_prf#2399 AS l_suppkey_prf_0#2418, l_orderkey_prf#2400 AS l_orderkey_prf_0#2419]
         :     :  +- Relation[l_returnflag_prf#2382,l_orderkey_and_l_linenumber_prf#2383,l_comment_prf#2384,l_linestatus_prf#2385,rid#2386,l_shipmode_prf#2387,l_shipinstruct_prf#2388,l_quantity_prf#2389,l_receiptdate_prf#2390,l_linenumber_prf#2391,l_tax_prf#2392,l_shipdate_prf#2393,l_extendedprice_prf#2394,l_partkey_prf#2395,l_discount_prf#2396,l_partkey_and_l_suppkey_prf#2397,l_commitdate_prf#2398,l_suppkey_prf#2399,l_orderkey_prf#2400] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#2421 AS p_comment_prf_1#2431, p_name_prf#2422 AS p_name_prf_1#2432, rid#2423 AS rid_1#2433, p_type_prf#2424 AS p_type_prf_1#2434, p_retailprice_prf#2425 AS p_retailprice_prf_1#2435, p_mfgr_prf#2426 AS p_mfgr_prf_1#2436, p_container_prf#2427 AS p_container_prf_1#2437, p_brand_prf#2428 AS p_brand_prf_1#2438, p_size_prf#2429 AS p_size_prf_1#2439, p_partkey_prf#2430 AS p_partkey_prf_1#2440]
            +- Relation[p_comment_prf#2421,p_name_prf#2422,rid#2423,p_type_prf#2424,p_retailprice_prf#2425,p_mfgr_prf#2426,p_container_prf#2427,p_brand_prf#2428,p_size_prf#2429,p_partkey_prf#2430] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 118023ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/14 08:54:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 08:54:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2494L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 08:54:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2494L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#2512]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#2505: string
         :     :- Project [s_phone_prf#2496 AS s_phone_prf_0#2504, rid#2497 AS rid_0#2505, s_address_prf#2498 AS s_address_prf_0#2506, s_nationkey_prf#2499 AS s_nationkey_prf_0#2507, s_suppkey_prf#2500 AS s_suppkey_prf_0#2508, s_name_prf#2501 AS s_name_prf_0#2509, s_acctbal_prf#2502 AS s_acctbal_prf_0#2510, s_comment_prf#2503 AS s_comment_prf_0#2511]
         :     :  +- Relation[s_phone_prf#2496,rid#2497,s_address_prf#2498,s_nationkey_prf#2499,s_suppkey_prf#2500,s_name_prf#2501,s_acctbal_prf#2502,s_comment_prf#2503] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#2527]
            :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_1#2521: string
            :     :- Project [ps_partkey_and_ps_suppkey_prf#2513 AS ps_partkey_and_ps_suppkey_prf_1#2520, rid#2514 AS rid_1#2521, ps_availqty_prf#2515 AS ps_availqty_prf_1#2522, ps_comment_prf#2516 AS ps_comment_prf_1#2523, ps_partkey_prf#2517 AS ps_partkey_prf_1#2524, ps_supplycost_prf#2518 AS ps_supplycost_prf_1#2525, ps_suppkey_prf#2519 AS ps_suppkey_prf_1#2526]
            :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2513,rid#2514,ps_availqty_prf#2515,ps_comment_prf#2516,ps_partkey_prf#2517,ps_supplycost_prf#2518,ps_suppkey_prf#2519] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#2528 AS p_comment_prf_2#2538, p_name_prf#2529 AS p_name_prf_2#2539, rid#2530 AS rid_2#2540, p_type_prf#2531 AS p_type_prf_2#2541, p_retailprice_prf#2532 AS p_retailprice_prf_2#2542, p_mfgr_prf#2533 AS p_mfgr_prf_2#2543, p_container_prf#2534 AS p_container_prf_2#2544, p_brand_prf#2535 AS p_brand_prf_2#2545, p_size_prf#2536 AS p_size_prf_2#2546, p_partkey_prf#2537 AS p_partkey_prf_2#2547]
               +- Relation[p_comment_prf#2528,p_name_prf#2529,rid#2530,p_type_prf#2531,p_retailprice_prf#2532,p_mfgr_prf#2533,p_container_prf#2534,p_brand_prf#2535,p_size_prf#2536,p_partkey_prf#2537] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 61581ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/14 08:55:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 08:55:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2590L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 08:55:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2590L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#2613]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2604: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#2592 AS p_comment_prf_0#2602, p_name_prf#2593 AS p_name_prf_0#2603, rid#2594 AS rid_0#2604, p_type_prf#2595 AS p_type_prf_0#2605, p_retailprice_prf#2596 AS p_retailprice_prf_0#2606, p_mfgr_prf#2597 AS p_mfgr_prf_0#2607, p_container_prf#2598 AS p_container_prf_0#2608, p_brand_prf#2599 AS p_brand_prf_0#2609, p_size_prf#2600 AS p_size_prf_0#2610, p_partkey_prf#2601 AS p_partkey_prf_0#2611]
         :     :  :  +- Relation[p_comment_prf#2592,p_name_prf#2593,rid#2594,p_type_prf#2595,p_retailprice_prf#2596,p_mfgr_prf#2597,p_container_prf#2598,p_brand_prf#2599,p_size_prf#2600,p_partkey_prf#2601] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2612]
         :     :     +- DexRidFilter part~p_size~15
         :     :        +- Relation[label#1654,value#1655] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2614 AS ps_partkey_and_ps_suppkey_prf_1#2621, rid#2615 AS rid_1#2622, ps_availqty_prf#2616 AS ps_availqty_prf_1#2623, ps_comment_prf#2617 AS ps_comment_prf_1#2624, ps_partkey_prf#2618 AS ps_partkey_prf_1#2625, ps_supplycost_prf#2619 AS ps_supplycost_prf_1#2626, ps_suppkey_prf#2620 AS ps_suppkey_prf_1#2627]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2614,rid#2615,ps_availqty_prf#2616,ps_comment_prf#2617,ps_partkey_prf#2618,ps_supplycost_prf#2619,ps_suppkey_prf#2620] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 402ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/14 08:55:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 08:55:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2669L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 08:55:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2669L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#2685]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, rid_0#2679: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#2671 AS ps_partkey_and_ps_suppkey_prf_0#2678, rid#2672 AS rid_0#2679, ps_availqty_prf#2673 AS ps_availqty_prf_0#2680, ps_comment_prf#2674 AS ps_comment_prf_0#2681, ps_partkey_prf#2675 AS ps_partkey_prf_0#2682, ps_supplycost_prf#2676 AS ps_supplycost_prf_0#2683, ps_suppkey_prf#2677 AS ps_suppkey_prf_0#2684]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2671,rid#2672,ps_availqty_prf#2673,ps_comment_prf#2674,ps_partkey_prf#2675,ps_supplycost_prf#2676,ps_suppkey_prf#2677] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2686 AS l_returnflag_prf_1#2705, l_orderkey_and_l_linenumber_prf#2687 AS l_orderkey_and_l_linenumber_prf_1#2706, l_comment_prf#2688 AS l_comment_prf_1#2707, l_linestatus_prf#2689 AS l_linestatus_prf_1#2708, rid#2690 AS rid_1#2709, l_shipmode_prf#2691 AS l_shipmode_prf_1#2710, l_shipinstruct_prf#2692 AS l_shipinstruct_prf_1#2711, l_quantity_prf#2693 AS l_quantity_prf_1#2712, l_receiptdate_prf#2694 AS l_receiptdate_prf_1#2713, l_linenumber_prf#2695 AS l_linenumber_prf_1#2714, l_tax_prf#2696 AS l_tax_prf_1#2715, l_shipdate_prf#2697 AS l_shipdate_prf_1#2716, l_extendedprice_prf#2698 AS l_extendedprice_prf_1#2717, l_partkey_prf#2699 AS l_partkey_prf_1#2718, l_discount_prf#2700 AS l_discount_prf_1#2719, l_partkey_and_l_suppkey_prf#2701 AS l_partkey_and_l_suppkey_prf_1#2720, l_commitdate_prf#2702 AS l_commitdate_prf_1#2721, l_suppkey_prf#2703 AS l_suppkey_prf_1#2722, l_orderkey_prf#2704 AS l_orderkey_prf_1#2723]
            +- Relation[l_returnflag_prf#2686,l_orderkey_and_l_linenumber_prf#2687,l_comment_prf#2688,l_linestatus_prf#2689,rid#2690,l_shipmode_prf#2691,l_shipinstruct_prf#2692,l_quantity_prf#2693,l_receiptdate_prf#2694,l_linenumber_prf#2695,l_tax_prf#2696,l_shipdate_prf#2697,l_extendedprice_prf#2698,l_partkey_prf#2699,l_discount_prf#2700,l_partkey_and_l_suppkey_prf#2701,l_commitdate_prf#2702,l_suppkey_prf#2703,l_orderkey_prf#2704] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 116468ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/14 08:57:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 08:57:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2765L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 08:57:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2765L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#2783]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#2776: string
         :     :- Project [s_phone_prf#2767 AS s_phone_prf_0#2775, rid#2768 AS rid_0#2776, s_address_prf#2769 AS s_address_prf_0#2777, s_nationkey_prf#2770 AS s_nationkey_prf_0#2778, s_suppkey_prf#2771 AS s_suppkey_prf_0#2779, s_name_prf#2772 AS s_name_prf_0#2780, s_acctbal_prf#2773 AS s_acctbal_prf_0#2781, s_comment_prf#2774 AS s_comment_prf_0#2782]
         :     :  +- Relation[s_phone_prf#2767,rid#2768,s_address_prf#2769,s_nationkey_prf#2770,s_suppkey_prf#2771,s_name_prf#2772,s_acctbal_prf#2773,s_comment_prf#2774] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2784 AS ps_partkey_and_ps_suppkey_prf_1#2791, rid#2785 AS rid_1#2792, ps_availqty_prf#2786 AS ps_availqty_prf_1#2793, ps_comment_prf#2787 AS ps_comment_prf_1#2794, ps_partkey_prf#2788 AS ps_partkey_prf_1#2795, ps_supplycost_prf#2789 AS ps_supplycost_prf_1#2796, ps_suppkey_prf#2790 AS ps_suppkey_prf_1#2797]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2784,rid#2785,ps_availqty_prf#2786,ps_comment_prf#2787,ps_partkey_prf#2788,ps_supplycost_prf#2789,ps_suppkey_prf#2790] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 10963ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/14 08:57:31 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 08:57:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2849L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 08:57:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2849L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_2#2889]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2874: string
         :     :- Project [l_returnflag_prf#2851 AS l_returnflag_prf_0#2870, l_orderkey_and_l_linenumber_prf#2852 AS l_orderkey_and_l_linenumber_prf_0#2871, l_comment_prf#2853 AS l_comment_prf_0#2872, l_linestatus_prf#2854 AS l_linestatus_prf_0#2873, rid#2855 AS rid_0#2874, l_shipmode_prf#2856 AS l_shipmode_prf_0#2875, l_shipinstruct_prf#2857 AS l_shipinstruct_prf_0#2876, l_quantity_prf#2858 AS l_quantity_prf_0#2877, l_receiptdate_prf#2859 AS l_receiptdate_prf_0#2878, l_linenumber_prf#2860 AS l_linenumber_prf_0#2879, l_tax_prf#2861 AS l_tax_prf_0#2880, l_shipdate_prf#2862 AS l_shipdate_prf_0#2881, l_extendedprice_prf#2863 AS l_extendedprice_prf_0#2882, l_partkey_prf#2864 AS l_partkey_prf_0#2883, l_discount_prf#2865 AS l_discount_prf_0#2884, l_partkey_and_l_suppkey_prf#2866 AS l_partkey_and_l_suppkey_prf_0#2885, l_commitdate_prf#2867 AS l_commitdate_prf_0#2886, l_suppkey_prf#2868 AS l_suppkey_prf_0#2887, l_orderkey_prf#2869 AS l_orderkey_prf_0#2888]
         :     :  +- Relation[l_returnflag_prf#2851,l_orderkey_and_l_linenumber_prf#2852,l_comment_prf#2853,l_linestatus_prf#2854,rid#2855,l_shipmode_prf#2856,l_shipinstruct_prf#2857,l_quantity_prf#2858,l_receiptdate_prf#2859,l_linenumber_prf#2860,l_tax_prf#2861,l_shipdate_prf#2862,l_extendedprice_prf#2863,l_partkey_prf#2864,l_discount_prf#2865,l_partkey_and_l_suppkey_prf#2866,l_commitdate_prf#2867,l_suppkey_prf#2868,l_orderkey_prf#2869] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#2908]
            :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#2900: string
            :     :- Project [c_acctbal_prf#2890 AS c_acctbal_prf_1#2899, rid#2891 AS rid_1#2900, c_name_prf#2892 AS c_name_prf_1#2901, c_nationkey_prf#2893 AS c_nationkey_prf_1#2902, c_custkey_prf#2894 AS c_custkey_prf_1#2903, c_comment_prf#2895 AS c_comment_prf_1#2904, c_address_prf#2896 AS c_address_prf_1#2905, c_mktsegment_prf#2897 AS c_mktsegment_prf_1#2906, c_phone_prf#2898 AS c_phone_prf_1#2907]
            :     :  +- Relation[c_acctbal_prf#2890,rid#2891,c_name_prf#2892,c_nationkey_prf#2893,c_custkey_prf#2894,c_comment_prf#2895,c_address_prf#2896,c_mktsegment_prf#2897,c_phone_prf#2898] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2909 AS o_shippriority_prf_2#2919, rid#2910 AS rid_2#2920, o_orderdate_prf#2911 AS o_orderdate_prf_2#2921, o_custkey_prf#2912 AS o_custkey_prf_2#2922, o_orderpriority_prf#2913 AS o_orderpriority_prf_2#2923, o_clerk_prf#2914 AS o_clerk_prf_2#2924, o_orderstatus_prf#2915 AS o_orderstatus_prf_2#2925, o_totalprice_prf#2916 AS o_totalprice_prf_2#2926, o_orderkey_prf#2917 AS o_orderkey_prf_2#2927, o_comment_prf#2918 AS o_comment_prf_2#2928]
               +- Relation[o_shippriority_prf#2909,rid#2910,o_orderdate_prf#2911,o_custkey_prf#2912,o_orderpriority_prf#2913,o_clerk_prf#2914,o_orderstatus_prf#2915,o_totalprice_prf#2916,o_orderkey_prf#2917,o_comment_prf#2918] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 158110ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/14 09:00:09 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:00:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2989L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 09:00:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2989L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#3018]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#3007]
         :     :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#3000: string
         :     :  :     :- Project [s_phone_prf#2991 AS s_phone_prf_0#2999, rid#2992 AS rid_0#3000, s_address_prf#2993 AS s_address_prf_0#3001, s_nationkey_prf#2994 AS s_nationkey_prf_0#3002, s_suppkey_prf#2995 AS s_suppkey_prf_0#3003, s_name_prf#2996 AS s_name_prf_0#3004, s_acctbal_prf#2997 AS s_acctbal_prf_0#3005, s_comment_prf#2998 AS s_comment_prf_0#3006]
         :     :  :     :  +- Relation[s_phone_prf#2991,rid#2992,s_address_prf#2993,s_nationkey_prf#2994,s_suppkey_prf#2995,s_name_prf#2996,s_acctbal_prf#2997,s_comment_prf#2998] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [rid#3008 AS rid_1#3013, n_regionkey_prf#3009 AS n_regionkey_prf_1#3014, n_nationkey_prf#3010 AS n_nationkey_prf_1#3015, n_name_prf#3011 AS n_name_prf_1#3016, n_comment_prf#3012 AS n_comment_prf_1#3017]
         :     :     +- Relation[rid#3008,n_regionkey_prf#3009,n_nationkey_prf#3010,n_name_prf#3011,n_comment_prf#3012] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3019 AS c_acctbal_prf_2#3028, rid#3020 AS rid_2#3029, c_name_prf#3021 AS c_name_prf_2#3030, c_nationkey_prf#3022 AS c_nationkey_prf_2#3031, c_custkey_prf#3023 AS c_custkey_prf_2#3032, c_comment_prf#3024 AS c_comment_prf_2#3033, c_address_prf#3025 AS c_address_prf_2#3034, c_mktsegment_prf#3026 AS c_mktsegment_prf_2#3035, c_phone_prf#3027 AS c_phone_prf_2#3036]
            +- Relation[c_acctbal_prf#3019,rid#3020,c_name_prf#3021,c_nationkey_prf#3022,c_custkey_prf#3023,c_comment_prf#3024,c_address_prf#3025,c_mktsegment_prf#3026,c_phone_prf#3027] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 661071ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/14 09:11:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:11:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3069L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 09:11:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3069L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#3079]
         :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#3078: string
         :     :- Project [r_regionkey_prf#3071 AS r_regionkey_prf_0#3075, r_name_prf#3072 AS r_name_prf_0#3076, r_comment_prf#3073 AS r_comment_prf_0#3077, rid#3074 AS rid_0#3078]
         :     :  +- Relation[r_regionkey_prf#3071,r_name_prf#3072,r_comment_prf#3073,rid#3074] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#3080 AS rid_1#3085, n_regionkey_prf#3081 AS n_regionkey_prf_1#3086, n_nationkey_prf#3082 AS n_nationkey_prf_1#3087, n_name_prf#3083 AS n_name_prf_1#3088, n_comment_prf#3084 AS n_comment_prf_1#3089]
            +- Relation[rid#3080,n_regionkey_prf#3081,n_nationkey_prf#3082,n_name_prf#3083,n_comment_prf#3084] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=25
Elapsed time: 69ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/14 09:11:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:11:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3121L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 09:11:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3121L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_2#3141]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#3133: string
         :     :- Project [c_acctbal_prf#3123 AS c_acctbal_prf_0#3132, rid#3124 AS rid_0#3133, c_name_prf#3125 AS c_name_prf_0#3134, c_nationkey_prf#3126 AS c_nationkey_prf_0#3135, c_custkey_prf#3127 AS c_custkey_prf_0#3136, c_comment_prf#3128 AS c_comment_prf_0#3137, c_address_prf#3129 AS c_address_prf_0#3138, c_mktsegment_prf#3130 AS c_mktsegment_prf_0#3139, c_phone_prf#3131 AS c_phone_prf_0#3140]
         :     :  +- Relation[c_acctbal_prf#3123,rid#3124,c_name_prf#3125,c_nationkey_prf#3126,c_custkey_prf#3127,c_comment_prf#3128,c_address_prf#3129,c_mktsegment_prf#3130,c_phone_prf#3131] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#3158]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#3151: string
            :     :- Project [s_phone_prf#3142 AS s_phone_prf_1#3150, rid#3143 AS rid_1#3151, s_address_prf#3144 AS s_address_prf_1#3152, s_nationkey_prf#3145 AS s_nationkey_prf_1#3153, s_suppkey_prf#3146 AS s_suppkey_prf_1#3154, s_name_prf#3147 AS s_name_prf_1#3155, s_acctbal_prf#3148 AS s_acctbal_prf_1#3156, s_comment_prf#3149 AS s_comment_prf_1#3157]
            :     :  +- Relation[s_phone_prf#3142,rid#3143,s_address_prf#3144,s_nationkey_prf#3145,s_suppkey_prf#3146,s_name_prf#3147,s_acctbal_prf#3148,s_comment_prf#3149] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [rid#3159 AS rid_2#3164, n_regionkey_prf#3160 AS n_regionkey_prf_2#3165, n_nationkey_prf#3161 AS n_nationkey_prf_2#3166, n_name_prf#3162 AS n_name_prf_2#3167, n_comment_prf#3163 AS n_comment_prf_2#3168]
               +- Relation[rid#3159,n_regionkey_prf#3160,n_nationkey_prf#3161,n_name_prf#3162,n_comment_prf#3163] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 57954ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/14 09:12:08 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:12:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3217L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 09:12:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3217L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#3235]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#3228: string
         :     :- Project [s_phone_prf#3219 AS s_phone_prf_0#3227, rid#3220 AS rid_0#3228, s_address_prf#3221 AS s_address_prf_0#3229, s_nationkey_prf#3222 AS s_nationkey_prf_0#3230, s_suppkey_prf#3223 AS s_suppkey_prf_0#3231, s_name_prf#3224 AS s_name_prf_0#3232, s_acctbal_prf#3225 AS s_acctbal_prf_0#3233, s_comment_prf#3226 AS s_comment_prf_0#3234]
         :     :  +- Relation[s_phone_prf#3219,rid#3220,s_address_prf#3221,s_nationkey_prf#3222,s_suppkey_prf#3223,s_name_prf#3224,s_acctbal_prf#3225,s_comment_prf#3226] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3236 AS l_returnflag_prf_1#3255, l_orderkey_and_l_linenumber_prf#3237 AS l_orderkey_and_l_linenumber_prf_1#3256, l_comment_prf#3238 AS l_comment_prf_1#3257, l_linestatus_prf#3239 AS l_linestatus_prf_1#3258, rid#3240 AS rid_1#3259, l_shipmode_prf#3241 AS l_shipmode_prf_1#3260, l_shipinstruct_prf#3242 AS l_shipinstruct_prf_1#3261, l_quantity_prf#3243 AS l_quantity_prf_1#3262, l_receiptdate_prf#3244 AS l_receiptdate_prf_1#3263, l_linenumber_prf#3245 AS l_linenumber_prf_1#3264, l_tax_prf#3246 AS l_tax_prf_1#3265, l_shipdate_prf#3247 AS l_shipdate_prf_1#3266, l_extendedprice_prf#3248 AS l_extendedprice_prf_1#3267, l_partkey_prf#3249 AS l_partkey_prf_1#3268, l_discount_prf#3250 AS l_discount_prf_1#3269, l_partkey_and_l_suppkey_prf#3251 AS l_partkey_and_l_suppkey_prf_1#3270, l_commitdate_prf#3252 AS l_commitdate_prf_1#3271, l_suppkey_prf#3253 AS l_suppkey_prf_1#3272, l_orderkey_prf#3254 AS l_orderkey_prf_1#3273]
            +- Relation[l_returnflag_prf#3236,l_orderkey_and_l_linenumber_prf#3237,l_comment_prf#3238,l_linestatus_prf#3239,rid#3240,l_shipmode_prf#3241,l_shipinstruct_prf#3242,l_quantity_prf#3243,l_receiptdate_prf#3244,l_linenumber_prf#3245,l_tax_prf#3246,l_shipdate_prf#3247,l_extendedprice_prf#3248,l_partkey_prf#3249,l_discount_prf#3250,l_partkey_and_l_suppkey_prf#3251,l_commitdate_prf#3252,l_suppkey_prf#3253,l_orderkey_prf#3254] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 86412ms

f1=
select * from region where r_name = 'EUROPE'
19/10/14 09:13:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:13:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3307L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/14 09:13:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3307L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#3309 AS r_regionkey_prf_0#3313, r_name_prf#3310 AS r_name_prf_0#3314, r_comment_prf#3311 AS r_comment_prf_0#3315, rid#3312 AS rid_0#3316]
         :  +- Relation[r_regionkey_prf#3309,r_name_prf#3310,r_comment_prf#3311,rid#3312] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3317]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1654,value#1655] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 53ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/14 09:13:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:13:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3358L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 09:13:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3358L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#3399]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#3378]
         :     :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3370: string
         :     :  :     :- Project [c_acctbal_prf#3360 AS c_acctbal_prf_0#3369, rid#3361 AS rid_0#3370, c_name_prf#3362 AS c_name_prf_0#3371, c_nationkey_prf#3363 AS c_nationkey_prf_0#3372, c_custkey_prf#3364 AS c_custkey_prf_0#3373, c_comment_prf#3365 AS c_comment_prf_0#3374, c_address_prf#3366 AS c_address_prf_0#3375, c_mktsegment_prf#3367 AS c_mktsegment_prf_0#3376, c_phone_prf#3368 AS c_phone_prf_0#3377]
         :     :  :     :  +- Relation[c_acctbal_prf#3360,rid#3361,c_name_prf#3362,c_nationkey_prf#3363,c_custkey_prf#3364,c_comment_prf#3365,c_address_prf#3366,c_mktsegment_prf#3367,c_phone_prf#3368] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#3379 AS o_shippriority_prf_1#3389, rid#3380 AS rid_1#3390, o_orderdate_prf#3381 AS o_orderdate_prf_1#3391, o_custkey_prf#3382 AS o_custkey_prf_1#3392, o_orderpriority_prf#3383 AS o_orderpriority_prf_1#3393, o_clerk_prf#3384 AS o_clerk_prf_1#3394, o_orderstatus_prf#3385 AS o_orderstatus_prf_1#3395, o_totalprice_prf#3386 AS o_totalprice_prf_1#3396, o_orderkey_prf#3387 AS o_orderkey_prf_1#3397, o_comment_prf#3388 AS o_comment_prf_1#3398]
         :     :     +- Relation[o_shippriority_prf#3379,rid#3380,o_orderdate_prf#3381,o_custkey_prf#3382,o_orderpriority_prf#3383,o_clerk_prf#3384,o_orderstatus_prf#3385,o_totalprice_prf#3386,o_orderkey_prf#3387,o_comment_prf#3388] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3400 AS l_returnflag_prf_2#3419, l_orderkey_and_l_linenumber_prf#3401 AS l_orderkey_and_l_linenumber_prf_2#3420, l_comment_prf#3402 AS l_comment_prf_2#3421, l_linestatus_prf#3403 AS l_linestatus_prf_2#3422, rid#3404 AS rid_2#3423, l_shipmode_prf#3405 AS l_shipmode_prf_2#3424, l_shipinstruct_prf#3406 AS l_shipinstruct_prf_2#3425, l_quantity_prf#3407 AS l_quantity_prf_2#3426, l_receiptdate_prf#3408 AS l_receiptdate_prf_2#3427, l_linenumber_prf#3409 AS l_linenumber_prf_2#3428, l_tax_prf#3410 AS l_tax_prf_2#3429, l_shipdate_prf#3411 AS l_shipdate_prf_2#3430, l_extendedprice_prf#3412 AS l_extendedprice_prf_2#3431, l_partkey_prf#3413 AS l_partkey_prf_2#3432, l_discount_prf#3414 AS l_discount_prf_2#3433, l_partkey_and_l_suppkey_prf#3415 AS l_partkey_and_l_suppkey_prf_2#3434, l_commitdate_prf#3416 AS l_commitdate_prf_2#3435, l_suppkey_prf#3417 AS l_suppkey_prf_2#3436, l_orderkey_prf#3418 AS l_orderkey_prf_2#3437]
            +- Relation[l_returnflag_prf#3400,l_orderkey_and_l_linenumber_prf#3401,l_comment_prf#3402,l_linestatus_prf#3403,rid#3404,l_shipmode_prf#3405,l_shipinstruct_prf#3406,l_quantity_prf#3407,l_receiptdate_prf#3408,l_linenumber_prf#3409,l_tax_prf#3410,l_shipdate_prf#3411,l_extendedprice_prf#3412,l_partkey_prf#3413,l_discount_prf#3414,l_partkey_and_l_suppkey_prf#3415,l_commitdate_prf#3416,l_suppkey_prf#3417,l_orderkey_prf#3418] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 270813ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/14 09:18:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:18:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3495L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 09:18:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3495L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#3497 AS l_returnflag_prf_0#3516, l_orderkey_and_l_linenumber_prf#3498 AS l_orderkey_and_l_linenumber_prf_0#3517, l_comment_prf#3499 AS l_comment_prf_0#3518, l_linestatus_prf#3500 AS l_linestatus_prf_0#3519, rid#3501 AS rid_0#3520, l_shipmode_prf#3502 AS l_shipmode_prf_0#3521, l_shipinstruct_prf#3503 AS l_shipinstruct_prf_0#3522, l_quantity_prf#3504 AS l_quantity_prf_0#3523, l_receiptdate_prf#3505 AS l_receiptdate_prf_0#3524, l_linenumber_prf#3506 AS l_linenumber_prf_0#3525, l_tax_prf#3507 AS l_tax_prf_0#3526, l_shipdate_prf#3508 AS l_shipdate_prf_0#3527, l_extendedprice_prf#3509 AS l_extendedprice_prf_0#3528, l_partkey_prf#3510 AS l_partkey_prf_0#3529, l_discount_prf#3511 AS l_discount_prf_0#3530, l_partkey_and_l_suppkey_prf#3512 AS l_partkey_and_l_suppkey_prf_0#3531, l_commitdate_prf#3513 AS l_commitdate_prf_0#3532, l_suppkey_prf#3514 AS l_suppkey_prf_0#3533, l_orderkey_prf#3515 AS l_orderkey_prf_0#3534]
         :  +- Relation[l_returnflag_prf#3497,l_orderkey_and_l_linenumber_prf#3498,l_comment_prf#3499,l_linestatus_prf#3500,rid#3501,l_shipmode_prf#3502,l_shipinstruct_prf#3503,l_quantity_prf#3504,l_receiptdate_prf#3505,l_linenumber_prf#3506,l_tax_prf#3507,l_shipdate_prf#3508,l_extendedprice_prf#3509,l_partkey_prf#3510,l_discount_prf#3511,l_partkey_and_l_suppkey_prf#3512,l_commitdate_prf#3513,l_suppkey_prf#3514,l_orderkey_prf#3515] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3535]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1654,value#1655] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 23353ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/14 09:18:29 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:18:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3590L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 09:18:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3590L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#3612]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3604: string
         :     :  :     :- Project [p_comment_prf#3592 AS p_comment_prf_0#3602, p_name_prf#3593 AS p_name_prf_0#3603, rid#3594 AS rid_0#3604, p_type_prf#3595 AS p_type_prf_0#3605, p_retailprice_prf#3596 AS p_retailprice_prf_0#3606, p_mfgr_prf#3597 AS p_mfgr_prf_0#3607, p_container_prf#3598 AS p_container_prf_0#3608, p_brand_prf#3599 AS p_brand_prf_0#3609, p_size_prf#3600 AS p_size_prf_0#3610, p_partkey_prf#3601 AS p_partkey_prf_0#3611]
         :     :  :     :  +- Relation[p_comment_prf#3592,p_name_prf#3593,rid#3594,p_type_prf#3595,p_retailprice_prf#3596,p_mfgr_prf#3597,p_container_prf#3598,p_brand_prf#3599,p_size_prf#3600,p_partkey_prf#3601] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#3613 AS l_returnflag_prf_1#3632, l_orderkey_and_l_linenumber_prf#3614 AS l_orderkey_and_l_linenumber_prf_1#3633, l_comment_prf#3615 AS l_comment_prf_1#3634, l_linestatus_prf#3616 AS l_linestatus_prf_1#3635, rid#3617 AS rid_1#3636, l_shipmode_prf#3618 AS l_shipmode_prf_1#3637, l_shipinstruct_prf#3619 AS l_shipinstruct_prf_1#3638, l_quantity_prf#3620 AS l_quantity_prf_1#3639, l_receiptdate_prf#3621 AS l_receiptdate_prf_1#3640, l_linenumber_prf#3622 AS l_linenumber_prf_1#3641, l_tax_prf#3623 AS l_tax_prf_1#3642, l_shipdate_prf#3624 AS l_shipdate_prf_1#3643, l_extendedprice_prf#3625 AS l_extendedprice_prf_1#3644, l_partkey_prf#3626 AS l_partkey_prf_1#3645, l_discount_prf#3627 AS l_discount_prf_1#3646, l_partkey_and_l_suppkey_prf#3628 AS l_partkey_and_l_suppkey_prf_1#3647, l_commitdate_prf#3629 AS l_commitdate_prf_1#3648, l_suppkey_prf#3630 AS l_suppkey_prf_1#3649, l_orderkey_prf#3631 AS l_orderkey_prf_1#3650]
         :     :     +- Relation[l_returnflag_prf#3613,l_orderkey_and_l_linenumber_prf#3614,l_comment_prf#3615,l_linestatus_prf#3616,rid#3617,l_shipmode_prf#3618,l_shipinstruct_prf#3619,l_quantity_prf#3620,l_receiptdate_prf#3621,l_linenumber_prf#3622,l_tax_prf#3623,l_shipdate_prf#3624,l_extendedprice_prf#3625,l_partkey_prf#3626,l_discount_prf#3627,l_partkey_and_l_suppkey_prf#3628,l_commitdate_prf#3629,l_suppkey_prf#3630,l_orderkey_prf#3631] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3652 AS s_phone_prf_2#3660, rid#3653 AS rid_2#3661, s_address_prf#3654 AS s_address_prf_2#3662, s_nationkey_prf#3655 AS s_nationkey_prf_2#3663, s_suppkey_prf#3656 AS s_suppkey_prf_2#3664, s_name_prf#3657 AS s_name_prf_2#3665, s_acctbal_prf#3658 AS s_acctbal_prf_2#3666, s_comment_prf#3659 AS s_comment_prf_2#3667]
            +- Relation[s_phone_prf#3652,rid#3653,s_address_prf#3654,s_nationkey_prf#3655,s_suppkey_prf#3656,s_name_prf#3657,s_acctbal_prf#3658,s_comment_prf#3659] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 288644ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/14 09:23:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:23:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3719L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 09:23:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3719L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#3731]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#3726: string
         :     :- Project [rid#3721 AS rid_0#3726, n_regionkey_prf#3722 AS n_regionkey_prf_0#3727, n_nationkey_prf#3723 AS n_nationkey_prf_0#3728, n_name_prf#3724 AS n_name_prf_0#3729, n_comment_prf#3725 AS n_comment_prf_0#3730]
         :     :  +- Relation[rid#3721,n_regionkey_prf#3722,n_nationkey_prf#3723,n_name_prf#3724,n_comment_prf#3725] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3732 AS s_phone_prf_1#3740, rid#3733 AS rid_1#3741, s_address_prf#3734 AS s_address_prf_1#3742, s_nationkey_prf#3735 AS s_nationkey_prf_1#3743, s_suppkey_prf#3736 AS s_suppkey_prf_1#3744, s_name_prf#3737 AS s_name_prf_1#3745, s_acctbal_prf#3738 AS s_acctbal_prf_1#3746, s_comment_prf#3739 AS s_comment_prf_1#3747]
            +- Relation[s_phone_prf#3732,rid#3733,s_address_prf#3734,s_nationkey_prf#3735,s_suppkey_prf#3736,s_name_prf#3737,s_acctbal_prf#3738,s_comment_prf#3739] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=10000
Elapsed time: 188ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/14 09:23:18 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:23:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3797L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 09:23:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3797L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#3817]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3809: string
         :     :- Project [c_acctbal_prf#3799 AS c_acctbal_prf_0#3808, rid#3800 AS rid_0#3809, c_name_prf#3801 AS c_name_prf_0#3810, c_nationkey_prf#3802 AS c_nationkey_prf_0#3811, c_custkey_prf#3803 AS c_custkey_prf_0#3812, c_comment_prf#3804 AS c_comment_prf_0#3813, c_address_prf#3805 AS c_address_prf_0#3814, c_mktsegment_prf#3806 AS c_mktsegment_prf_0#3815, c_phone_prf#3807 AS c_phone_prf_0#3816]
         :     :  +- Relation[c_acctbal_prf#3799,rid#3800,c_name_prf#3801,c_nationkey_prf#3802,c_custkey_prf#3803,c_comment_prf#3804,c_address_prf#3805,c_mktsegment_prf#3806,c_phone_prf#3807] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#3838]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#3829: string
            :     :- Project [o_shippriority_prf#3818 AS o_shippriority_prf_1#3828, rid#3819 AS rid_1#3829, o_orderdate_prf#3820 AS o_orderdate_prf_1#3830, o_custkey_prf#3821 AS o_custkey_prf_1#3831, o_orderpriority_prf#3822 AS o_orderpriority_prf_1#3832, o_clerk_prf#3823 AS o_clerk_prf_1#3833, o_orderstatus_prf#3824 AS o_orderstatus_prf_1#3834, o_totalprice_prf#3825 AS o_totalprice_prf_1#3835, o_orderkey_prf#3826 AS o_orderkey_prf_1#3836, o_comment_prf#3827 AS o_comment_prf_1#3837]
            :     :  +- Relation[o_shippriority_prf#3818,rid#3819,o_orderdate_prf#3820,o_custkey_prf#3821,o_orderpriority_prf#3822,o_clerk_prf#3823,o_orderstatus_prf#3824,o_totalprice_prf#3825,o_orderkey_prf#3826,o_comment_prf#3827] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3839 AS l_returnflag_prf_2#3858, l_orderkey_and_l_linenumber_prf#3840 AS l_orderkey_and_l_linenumber_prf_2#3859, l_comment_prf#3841 AS l_comment_prf_2#3860, l_linestatus_prf#3842 AS l_linestatus_prf_2#3861, rid#3843 AS rid_2#3862, l_shipmode_prf#3844 AS l_shipmode_prf_2#3863, l_shipinstruct_prf#3845 AS l_shipinstruct_prf_2#3864, l_quantity_prf#3846 AS l_quantity_prf_2#3865, l_receiptdate_prf#3847 AS l_receiptdate_prf_2#3866, l_linenumber_prf#3848 AS l_linenumber_prf_2#3867, l_tax_prf#3849 AS l_tax_prf_2#3868, l_shipdate_prf#3850 AS l_shipdate_prf_2#3869, l_extendedprice_prf#3851 AS l_extendedprice_prf_2#3870, l_partkey_prf#3852 AS l_partkey_prf_2#3871, l_discount_prf#3853 AS l_discount_prf_2#3872, l_partkey_and_l_suppkey_prf#3854 AS l_partkey_and_l_suppkey_prf_2#3873, l_commitdate_prf#3855 AS l_commitdate_prf_2#3874, l_suppkey_prf#3856 AS l_suppkey_prf_2#3875, l_orderkey_prf#3857 AS l_orderkey_prf_2#3876]
               +- Relation[l_returnflag_prf#3839,l_orderkey_and_l_linenumber_prf#3840,l_comment_prf#3841,l_linestatus_prf#3842,rid#3843,l_shipmode_prf#3844,l_shipinstruct_prf#3845,l_quantity_prf#3846,l_receiptdate_prf#3847,l_linenumber_prf#3848,l_tax_prf#3849,l_shipdate_prf#3850,l_extendedprice_prf#3851,l_partkey_prf#3852,l_discount_prf#3853,l_partkey_and_l_suppkey_prf#3854,l_commitdate_prf#3855,l_suppkey_prf#3856,l_orderkey_prf#3857] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 234829ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/14 09:27:12 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:27:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3943L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 09:27:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3943L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#3965]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#3956: string
         :     :- Project [o_shippriority_prf#3945 AS o_shippriority_prf_0#3955, rid#3946 AS rid_0#3956, o_orderdate_prf#3947 AS o_orderdate_prf_0#3957, o_custkey_prf#3948 AS o_custkey_prf_0#3958, o_orderpriority_prf#3949 AS o_orderpriority_prf_0#3959, o_clerk_prf#3950 AS o_clerk_prf_0#3960, o_orderstatus_prf#3951 AS o_orderstatus_prf_0#3961, o_totalprice_prf#3952 AS o_totalprice_prf_0#3962, o_orderkey_prf#3953 AS o_orderkey_prf_0#3963, o_comment_prf#3954 AS o_comment_prf_0#3964]
         :     :  +- Relation[o_shippriority_prf#3945,rid#3946,o_orderdate_prf#3947,o_custkey_prf#3948,o_orderpriority_prf#3949,o_clerk_prf#3950,o_orderstatus_prf#3951,o_totalprice_prf#3952,o_orderkey_prf#3953,o_comment_prf#3954] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#3966 AS l_returnflag_prf_1#3985, l_orderkey_and_l_linenumber_prf#3967 AS l_orderkey_and_l_linenumber_prf_1#3986, l_comment_prf#3968 AS l_comment_prf_1#3987, l_linestatus_prf#3969 AS l_linestatus_prf_1#3988, rid#3970 AS rid_1#3989, l_shipmode_prf#3971 AS l_shipmode_prf_1#3990, l_shipinstruct_prf#3972 AS l_shipinstruct_prf_1#3991, l_quantity_prf#3973 AS l_quantity_prf_1#3992, l_receiptdate_prf#3974 AS l_receiptdate_prf_1#3993, l_linenumber_prf#3975 AS l_linenumber_prf_1#3994, l_tax_prf#3976 AS l_tax_prf_1#3995, l_shipdate_prf#3977 AS l_shipdate_prf_1#3996, l_extendedprice_prf#3978 AS l_extendedprice_prf_1#3997, l_partkey_prf#3979 AS l_partkey_prf_1#3998, l_discount_prf#3980 AS l_discount_prf_1#3999, l_partkey_and_l_suppkey_prf#3981 AS l_partkey_and_l_suppkey_prf_1#4000, l_commitdate_prf#3982 AS l_commitdate_prf_1#4001, l_suppkey_prf#3983 AS l_suppkey_prf_1#4002, l_orderkey_prf#3984 AS l_orderkey_prf_1#4003]
            :  +- Relation[l_returnflag_prf#3966,l_orderkey_and_l_linenumber_prf#3967,l_comment_prf#3968,l_linestatus_prf#3969,rid#3970,l_shipmode_prf#3971,l_shipinstruct_prf#3972,l_quantity_prf#3973,l_receiptdate_prf#3974,l_linenumber_prf#3975,l_tax_prf#3976,l_shipdate_prf#3977,l_extendedprice_prf#3978,l_partkey_prf#3979,l_discount_prf#3980,l_partkey_and_l_suppkey_prf#3981,l_commitdate_prf#3982,l_suppkey_prf#3983,l_orderkey_prf#3984] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4004]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1654,value#1655] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 197266ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/14 09:30:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:30:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4058L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 09:30:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4058L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_2#4076]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#4069: string
         :     :- Project [s_phone_prf#4060 AS s_phone_prf_0#4068, rid#4061 AS rid_0#4069, s_address_prf#4062 AS s_address_prf_0#4070, s_nationkey_prf#4063 AS s_nationkey_prf_0#4071, s_suppkey_prf#4064 AS s_suppkey_prf_0#4072, s_name_prf#4065 AS s_name_prf_0#4073, s_acctbal_prf#4066 AS s_acctbal_prf_0#4074, s_comment_prf#4067 AS s_comment_prf_0#4075]
         :     :  +- Relation[s_phone_prf#4060,rid#4061,s_address_prf#4062,s_nationkey_prf#4063,s_suppkey_prf#4064,s_name_prf#4065,s_acctbal_prf#4066,s_comment_prf#4067] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#4097]
            :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#4089: string
            :     :- Project [p_comment_prf#4077 AS p_comment_prf_1#4087, p_name_prf#4078 AS p_name_prf_1#4088, rid#4079 AS rid_1#4089, p_type_prf#4080 AS p_type_prf_1#4090, p_retailprice_prf#4081 AS p_retailprice_prf_1#4091, p_mfgr_prf#4082 AS p_mfgr_prf_1#4092, p_container_prf#4083 AS p_container_prf_1#4093, p_brand_prf#4084 AS p_brand_prf_1#4094, p_size_prf#4085 AS p_size_prf_1#4095, p_partkey_prf#4086 AS p_partkey_prf_1#4096]
            :     :  +- Relation[p_comment_prf#4077,p_name_prf#4078,rid#4079,p_type_prf#4080,p_retailprice_prf#4081,p_mfgr_prf#4082,p_container_prf#4083,p_brand_prf#4084,p_size_prf#4085,p_partkey_prf#4086] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#4098 AS ps_partkey_and_ps_suppkey_prf_2#4105, rid#4099 AS rid_2#4106, ps_availqty_prf#4100 AS ps_availqty_prf_2#4107, ps_comment_prf#4101 AS ps_comment_prf_2#4108, ps_partkey_prf#4102 AS ps_partkey_prf_2#4109, ps_supplycost_prf#4103 AS ps_supplycost_prf_2#4110, ps_suppkey_prf#4104 AS ps_suppkey_prf_2#4111]
               +- Relation[ps_partkey_and_ps_suppkey_prf#4098,rid#4099,ps_availqty_prf#4100,ps_comment_prf#4101,ps_partkey_prf#4102,ps_supplycost_prf#4103,ps_suppkey_prf#4104] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 42972ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/14 09:31:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:31:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4157L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 09:31:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4157L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#4177]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4169: string
         :     :- Project [c_acctbal_prf#4159 AS c_acctbal_prf_0#4168, rid#4160 AS rid_0#4169, c_name_prf#4161 AS c_name_prf_0#4170, c_nationkey_prf#4162 AS c_nationkey_prf_0#4171, c_custkey_prf#4163 AS c_custkey_prf_0#4172, c_comment_prf#4164 AS c_comment_prf_0#4173, c_address_prf#4165 AS c_address_prf_0#4174, c_mktsegment_prf#4166 AS c_mktsegment_prf_0#4175, c_phone_prf#4167 AS c_phone_prf_0#4176]
         :     :  +- Relation[c_acctbal_prf#4159,rid#4160,c_name_prf#4161,c_nationkey_prf#4162,c_custkey_prf#4163,c_comment_prf#4164,c_address_prf#4165,c_mktsegment_prf#4166,c_phone_prf#4167] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4178 AS o_shippriority_prf_1#4188, rid#4179 AS rid_1#4189, o_orderdate_prf#4180 AS o_orderdate_prf_1#4190, o_custkey_prf#4181 AS o_custkey_prf_1#4191, o_orderpriority_prf#4182 AS o_orderpriority_prf_1#4192, o_clerk_prf#4183 AS o_clerk_prf_1#4193, o_orderstatus_prf#4184 AS o_orderstatus_prf_1#4194, o_totalprice_prf#4185 AS o_totalprice_prf_1#4195, o_orderkey_prf#4186 AS o_orderkey_prf_1#4196, o_comment_prf#4187 AS o_comment_prf_1#4197]
            +- Relation[o_shippriority_prf#4178,rid#4179,o_orderdate_prf#4180,o_custkey_prf#4181,o_orderpriority_prf#4182,o_clerk_prf#4183,o_orderstatus_prf#4184,o_totalprice_prf#4185,o_orderkey_prf#4186,o_comment_prf#4187] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1500000
Elapsed time: 40198ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/14 09:31:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:31:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4245L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 09:31:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4245L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#4286]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4270: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#4247 AS l_returnflag_prf_0#4266, l_orderkey_and_l_linenumber_prf#4248 AS l_orderkey_and_l_linenumber_prf_0#4267, l_comment_prf#4249 AS l_comment_prf_0#4268, l_linestatus_prf#4250 AS l_linestatus_prf_0#4269, rid#4251 AS rid_0#4270, l_shipmode_prf#4252 AS l_shipmode_prf_0#4271, l_shipinstruct_prf#4253 AS l_shipinstruct_prf_0#4272, l_quantity_prf#4254 AS l_quantity_prf_0#4273, l_receiptdate_prf#4255 AS l_receiptdate_prf_0#4274, l_linenumber_prf#4256 AS l_linenumber_prf_0#4275, l_tax_prf#4257 AS l_tax_prf_0#4276, l_shipdate_prf#4258 AS l_shipdate_prf_0#4277, l_extendedprice_prf#4259 AS l_extendedprice_prf_0#4278, l_partkey_prf#4260 AS l_partkey_prf_0#4279, l_discount_prf#4261 AS l_discount_prf_0#4280, l_partkey_and_l_suppkey_prf#4262 AS l_partkey_and_l_suppkey_prf_0#4281, l_commitdate_prf#4263 AS l_commitdate_prf_0#4282, l_suppkey_prf#4264 AS l_suppkey_prf_0#4283, l_orderkey_prf#4265 AS l_orderkey_prf_0#4284]
         :     :  :  +- Relation[l_returnflag_prf#4247,l_orderkey_and_l_linenumber_prf#4248,l_comment_prf#4249,l_linestatus_prf#4250,rid#4251,l_shipmode_prf#4252,l_shipinstruct_prf#4253,l_quantity_prf#4254,l_receiptdate_prf#4255,l_linenumber_prf#4256,l_tax_prf#4257,l_shipdate_prf#4258,l_extendedprice_prf#4259,l_partkey_prf#4260,l_discount_prf#4261,l_partkey_and_l_suppkey_prf#4262,l_commitdate_prf#4263,l_suppkey_prf#4264,l_orderkey_prf#4265] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4285]
         :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :        +- Relation[label#1654,value#1655] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4287 AS o_shippriority_prf_1#4297, rid#4288 AS rid_1#4298, o_orderdate_prf#4289 AS o_orderdate_prf_1#4299, o_custkey_prf#4290 AS o_custkey_prf_1#4300, o_orderpriority_prf#4291 AS o_orderpriority_prf_1#4301, o_clerk_prf#4292 AS o_clerk_prf_1#4302, o_orderstatus_prf#4293 AS o_orderstatus_prf_1#4303, o_totalprice_prf#4294 AS o_totalprice_prf_1#4304, o_orderkey_prf#4295 AS o_orderkey_prf_1#4305, o_comment_prf#4296 AS o_comment_prf_1#4306]
            +- Relation[o_shippriority_prf#4287,rid#4288,o_orderdate_prf#4289,o_custkey_prf#4290,o_orderpriority_prf#4291,o_clerk_prf#4292,o_orderstatus_prf#4293,o_totalprice_prf#4294,o_orderkey_prf#4295,o_comment_prf#4296] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 54472ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/14 09:32:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:32:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4348L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 09:32:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4348L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#4350 AS p_comment_prf_0#4360, p_name_prf#4351 AS p_name_prf_0#4361, rid#4352 AS rid_0#4362, p_type_prf#4353 AS p_type_prf_0#4363, p_retailprice_prf#4354 AS p_retailprice_prf_0#4364, p_mfgr_prf#4355 AS p_mfgr_prf_0#4365, p_container_prf#4356 AS p_container_prf_0#4366, p_brand_prf#4357 AS p_brand_prf_0#4367, p_size_prf#4358 AS p_size_prf_0#4368, p_partkey_prf#4359 AS p_partkey_prf_0#4369]
         :  +- Relation[p_comment_prf#4350,p_name_prf#4351,rid#4352,p_type_prf#4353,p_retailprice_prf#4354,p_mfgr_prf#4355,p_container_prf#4356,p_brand_prf#4357,p_size_prf#4358,p_partkey_prf#4359] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4370]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1654,value#1655] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1451
Elapsed time: 83ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/14 09:32:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:32:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4405L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 09:32:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4405L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#4442]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#4421]
         :     :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#4415: string
         :     :  :     :- Project [ps_partkey_and_ps_suppkey_prf#4407 AS ps_partkey_and_ps_suppkey_prf_0#4414, rid#4408 AS rid_0#4415, ps_availqty_prf#4409 AS ps_availqty_prf_0#4416, ps_comment_prf#4410 AS ps_comment_prf_0#4417, ps_partkey_prf#4411 AS ps_partkey_prf_0#4418, ps_supplycost_prf#4412 AS ps_supplycost_prf_0#4419, ps_suppkey_prf#4413 AS ps_suppkey_prf_0#4420]
         :     :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#4407,rid#4408,ps_availqty_prf#4409,ps_comment_prf#4410,ps_partkey_prf#4411,ps_supplycost_prf#4412,ps_suppkey_prf#4413] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#4422 AS p_comment_prf_1#4432, p_name_prf#4423 AS p_name_prf_1#4433, rid#4424 AS rid_1#4434, p_type_prf#4425 AS p_type_prf_1#4435, p_retailprice_prf#4426 AS p_retailprice_prf_1#4436, p_mfgr_prf#4427 AS p_mfgr_prf_1#4437, p_container_prf#4428 AS p_container_prf_1#4438, p_brand_prf#4429 AS p_brand_prf_1#4439, p_size_prf#4430 AS p_size_prf_1#4440, p_partkey_prf#4431 AS p_partkey_prf_1#4441]
         :     :     +- Relation[p_comment_prf#4422,p_name_prf#4423,rid#4424,p_type_prf#4425,p_retailprice_prf#4426,p_mfgr_prf#4427,p_container_prf#4428,p_brand_prf#4429,p_size_prf#4430,p_partkey_prf#4431] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4443 AS s_phone_prf_2#4451, rid#4444 AS rid_2#4452, s_address_prf#4445 AS s_address_prf_2#4453, s_nationkey_prf#4446 AS s_nationkey_prf_2#4454, s_suppkey_prf#4447 AS s_suppkey_prf_2#4455, s_name_prf#4448 AS s_name_prf_2#4456, s_acctbal_prf#4449 AS s_acctbal_prf_2#4457, s_comment_prf#4450 AS s_comment_prf_2#4458]
            +- Relation[s_phone_prf#4443,rid#4444,s_address_prf#4445,s_nationkey_prf#4446,s_suppkey_prf#4447,s_name_prf#4448,s_acctbal_prf#4449,s_comment_prf#4450] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 107529ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/14 09:34:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:34:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4520L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 09:34:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4520L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_2#4540]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4532: string
         :     :- Project [c_acctbal_prf#4522 AS c_acctbal_prf_0#4531, rid#4523 AS rid_0#4532, c_name_prf#4524 AS c_name_prf_0#4533, c_nationkey_prf#4525 AS c_nationkey_prf_0#4534, c_custkey_prf#4526 AS c_custkey_prf_0#4535, c_comment_prf#4527 AS c_comment_prf_0#4536, c_address_prf#4528 AS c_address_prf_0#4537, c_mktsegment_prf#4529 AS c_mktsegment_prf_0#4538, c_phone_prf#4530 AS c_phone_prf_0#4539]
         :     :  +- Relation[c_acctbal_prf#4522,rid#4523,c_name_prf#4524,c_nationkey_prf#4525,c_custkey_prf#4526,c_comment_prf#4527,c_address_prf#4528,c_mktsegment_prf#4529,c_phone_prf#4530] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#4579]
            :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_1#4564: string
            :     :- Project [l_returnflag_prf#4541 AS l_returnflag_prf_1#4560, l_orderkey_and_l_linenumber_prf#4542 AS l_orderkey_and_l_linenumber_prf_1#4561, l_comment_prf#4543 AS l_comment_prf_1#4562, l_linestatus_prf#4544 AS l_linestatus_prf_1#4563, rid#4545 AS rid_1#4564, l_shipmode_prf#4546 AS l_shipmode_prf_1#4565, l_shipinstruct_prf#4547 AS l_shipinstruct_prf_1#4566, l_quantity_prf#4548 AS l_quantity_prf_1#4567, l_receiptdate_prf#4549 AS l_receiptdate_prf_1#4568, l_linenumber_prf#4550 AS l_linenumber_prf_1#4569, l_tax_prf#4551 AS l_tax_prf_1#4570, l_shipdate_prf#4552 AS l_shipdate_prf_1#4571, l_extendedprice_prf#4553 AS l_extendedprice_prf_1#4572, l_partkey_prf#4554 AS l_partkey_prf_1#4573, l_discount_prf#4555 AS l_discount_prf_1#4574, l_partkey_and_l_suppkey_prf#4556 AS l_partkey_and_l_suppkey_prf_1#4575, l_commitdate_prf#4557 AS l_commitdate_prf_1#4576, l_suppkey_prf#4558 AS l_suppkey_prf_1#4577, l_orderkey_prf#4559 AS l_orderkey_prf_1#4578]
            :     :  +- Relation[l_returnflag_prf#4541,l_orderkey_and_l_linenumber_prf#4542,l_comment_prf#4543,l_linestatus_prf#4544,rid#4545,l_shipmode_prf#4546,l_shipinstruct_prf#4547,l_quantity_prf#4548,l_receiptdate_prf#4549,l_linenumber_prf#4550,l_tax_prf#4551,l_shipdate_prf#4552,l_extendedprice_prf#4553,l_partkey_prf#4554,l_discount_prf#4555,l_partkey_and_l_suppkey_prf#4556,l_commitdate_prf#4557,l_suppkey_prf#4558,l_orderkey_prf#4559] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4580 AS o_shippriority_prf_2#4590, rid#4581 AS rid_2#4591, o_orderdate_prf#4582 AS o_orderdate_prf_2#4592, o_custkey_prf#4583 AS o_custkey_prf_2#4593, o_orderpriority_prf#4584 AS o_orderpriority_prf_2#4594, o_clerk_prf#4585 AS o_clerk_prf_2#4595, o_orderstatus_prf#4586 AS o_orderstatus_prf_2#4596, o_totalprice_prf#4587 AS o_totalprice_prf_2#4597, o_orderkey_prf#4588 AS o_orderkey_prf_2#4598, o_comment_prf#4589 AS o_comment_prf_2#4599]
               +- Relation[o_shippriority_prf#4580,rid#4581,o_orderdate_prf#4582,o_custkey_prf#4583,o_orderpriority_prf#4584,o_clerk_prf#4585,o_orderstatus_prf#4586,o_totalprice_prf#4587,o_orderkey_prf#4588,o_comment_prf#4589] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 157504ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/14 09:37:12 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:37:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4657L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 09:37:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4657L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#4659 AS l_returnflag_prf_0#4678, l_orderkey_and_l_linenumber_prf#4660 AS l_orderkey_and_l_linenumber_prf_0#4679, l_comment_prf#4661 AS l_comment_prf_0#4680, l_linestatus_prf#4662 AS l_linestatus_prf_0#4681, rid#4663 AS rid_0#4682, l_shipmode_prf#4664 AS l_shipmode_prf_0#4683, l_shipinstruct_prf#4665 AS l_shipinstruct_prf_0#4684, l_quantity_prf#4666 AS l_quantity_prf_0#4685, l_receiptdate_prf#4667 AS l_receiptdate_prf_0#4686, l_linenumber_prf#4668 AS l_linenumber_prf_0#4687, l_tax_prf#4669 AS l_tax_prf_0#4688, l_shipdate_prf#4670 AS l_shipdate_prf_0#4689, l_extendedprice_prf#4671 AS l_extendedprice_prf_0#4690, l_partkey_prf#4672 AS l_partkey_prf_0#4691, l_discount_prf#4673 AS l_discount_prf_0#4692, l_partkey_and_l_suppkey_prf#4674 AS l_partkey_and_l_suppkey_prf_0#4693, l_commitdate_prf#4675 AS l_commitdate_prf_0#4694, l_suppkey_prf#4676 AS l_suppkey_prf_0#4695, l_orderkey_prf#4677 AS l_orderkey_prf_0#4696]
         :  +- Relation[l_returnflag_prf#4659,l_orderkey_and_l_linenumber_prf#4660,l_comment_prf#4661,l_linestatus_prf#4662,rid#4663,l_shipmode_prf#4664,l_shipinstruct_prf#4665,l_quantity_prf#4666,l_receiptdate_prf#4667,l_linenumber_prf#4668,l_tax_prf#4669,l_shipdate_prf#4670,l_extendedprice_prf#4671,l_partkey_prf#4672,l_discount_prf#4673,l_partkey_and_l_suppkey_prf#4674,l_commitdate_prf#4675,l_suppkey_prf#4676,l_orderkey_prf#4677] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4697]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1654,value#1655] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 13670ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/14 09:37:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:37:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4732L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 09:37:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4732L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#4744]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#4739: string
         :     :- Project [rid#4734 AS rid_0#4739, n_regionkey_prf#4735 AS n_regionkey_prf_0#4740, n_nationkey_prf#4736 AS n_nationkey_prf_0#4741, n_name_prf#4737 AS n_name_prf_0#4742, n_comment_prf#4738 AS n_comment_prf_0#4743]
         :     :  +- Relation[rid#4734,n_regionkey_prf#4735,n_nationkey_prf#4736,n_name_prf#4737,n_comment_prf#4738] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4745 AS c_acctbal_prf_1#4754, rid#4746 AS rid_1#4755, c_name_prf#4747 AS c_name_prf_1#4756, c_nationkey_prf#4748 AS c_nationkey_prf_1#4757, c_custkey_prf#4749 AS c_custkey_prf_1#4758, c_comment_prf#4750 AS c_comment_prf_1#4759, c_address_prf#4751 AS c_address_prf_1#4760, c_mktsegment_prf#4752 AS c_mktsegment_prf_1#4761, c_phone_prf#4753 AS c_phone_prf_1#4762]
            +- Relation[c_acctbal_prf#4745,rid#4746,c_name_prf#4747,c_nationkey_prf#4748,c_custkey_prf#4749,c_comment_prf#4750,c_address_prf#4751,c_mktsegment_prf#4752,c_phone_prf#4753] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=150000
Elapsed time: 1936ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/14 09:37:28 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:37:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4805L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 09:37:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4805L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#4827]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#4818: string
         :     :- Project [o_shippriority_prf#4807 AS o_shippriority_prf_0#4817, rid#4808 AS rid_0#4818, o_orderdate_prf#4809 AS o_orderdate_prf_0#4819, o_custkey_prf#4810 AS o_custkey_prf_0#4820, o_orderpriority_prf#4811 AS o_orderpriority_prf_0#4821, o_clerk_prf#4812 AS o_clerk_prf_0#4822, o_orderstatus_prf#4813 AS o_orderstatus_prf_0#4823, o_totalprice_prf#4814 AS o_totalprice_prf_0#4824, o_orderkey_prf#4815 AS o_orderkey_prf_0#4825, o_comment_prf#4816 AS o_comment_prf_0#4826]
         :     :  +- Relation[o_shippriority_prf#4807,rid#4808,o_orderdate_prf#4809,o_custkey_prf#4810,o_orderpriority_prf#4811,o_clerk_prf#4812,o_orderstatus_prf#4813,o_totalprice_prf#4814,o_orderkey_prf#4815,o_comment_prf#4816] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4828 AS l_returnflag_prf_1#4847, l_orderkey_and_l_linenumber_prf#4829 AS l_orderkey_and_l_linenumber_prf_1#4848, l_comment_prf#4830 AS l_comment_prf_1#4849, l_linestatus_prf#4831 AS l_linestatus_prf_1#4850, rid#4832 AS rid_1#4851, l_shipmode_prf#4833 AS l_shipmode_prf_1#4852, l_shipinstruct_prf#4834 AS l_shipinstruct_prf_1#4853, l_quantity_prf#4835 AS l_quantity_prf_1#4854, l_receiptdate_prf#4836 AS l_receiptdate_prf_1#4855, l_linenumber_prf#4837 AS l_linenumber_prf_1#4856, l_tax_prf#4838 AS l_tax_prf_1#4857, l_shipdate_prf#4839 AS l_shipdate_prf_1#4858, l_extendedprice_prf#4840 AS l_extendedprice_prf_1#4859, l_partkey_prf#4841 AS l_partkey_prf_1#4860, l_discount_prf#4842 AS l_discount_prf_1#4861, l_partkey_and_l_suppkey_prf#4843 AS l_partkey_and_l_suppkey_prf_1#4862, l_commitdate_prf#4844 AS l_commitdate_prf_1#4863, l_suppkey_prf#4845 AS l_suppkey_prf_1#4864, l_orderkey_prf#4846 AS l_orderkey_prf_1#4865]
            +- Relation[l_returnflag_prf#4828,l_orderkey_and_l_linenumber_prf#4829,l_comment_prf#4830,l_linestatus_prf#4831,rid#4832,l_shipmode_prf#4833,l_shipinstruct_prf#4834,l_quantity_prf#4835,l_receiptdate_prf#4836,l_linenumber_prf#4837,l_tax_prf#4838,l_shipdate_prf#4839,l_extendedprice_prf#4840,l_partkey_prf#4841,l_discount_prf#4842,l_partkey_and_l_suppkey_prf#4843,l_commitdate_prf#4844,l_suppkey_prf#4845,l_orderkey_prf#4846] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 195544ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/14 09:40:44 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:40:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4931L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 09:40:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4931L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#4971]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4956: string
         :     :- Project [l_returnflag_prf#4933 AS l_returnflag_prf_0#4952, l_orderkey_and_l_linenumber_prf#4934 AS l_orderkey_and_l_linenumber_prf_0#4953, l_comment_prf#4935 AS l_comment_prf_0#4954, l_linestatus_prf#4936 AS l_linestatus_prf_0#4955, rid#4937 AS rid_0#4956, l_shipmode_prf#4938 AS l_shipmode_prf_0#4957, l_shipinstruct_prf#4939 AS l_shipinstruct_prf_0#4958, l_quantity_prf#4940 AS l_quantity_prf_0#4959, l_receiptdate_prf#4941 AS l_receiptdate_prf_0#4960, l_linenumber_prf#4942 AS l_linenumber_prf_0#4961, l_tax_prf#4943 AS l_tax_prf_0#4962, l_shipdate_prf#4944 AS l_shipdate_prf_0#4963, l_extendedprice_prf#4945 AS l_extendedprice_prf_0#4964, l_partkey_prf#4946 AS l_partkey_prf_0#4965, l_discount_prf#4947 AS l_discount_prf_0#4966, l_partkey_and_l_suppkey_prf#4948 AS l_partkey_and_l_suppkey_prf_0#4967, l_commitdate_prf#4949 AS l_commitdate_prf_0#4968, l_suppkey_prf#4950 AS l_suppkey_prf_0#4969, l_orderkey_prf#4951 AS l_orderkey_prf_0#4970]
         :     :  +- Relation[l_returnflag_prf#4933,l_orderkey_and_l_linenumber_prf#4934,l_comment_prf#4935,l_linestatus_prf#4936,rid#4937,l_shipmode_prf#4938,l_shipinstruct_prf#4939,l_quantity_prf#4940,l_receiptdate_prf#4941,l_linenumber_prf#4942,l_tax_prf#4943,l_shipdate_prf#4944,l_extendedprice_prf#4945,l_partkey_prf#4946,l_discount_prf#4947,l_partkey_and_l_suppkey_prf#4948,l_commitdate_prf#4949,l_suppkey_prf#4950,l_orderkey_prf#4951] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1522) AS rid_2#4992]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#4983: string
            :     :- Project [o_shippriority_prf#4972 AS o_shippriority_prf_1#4982, rid#4973 AS rid_1#4983, o_orderdate_prf#4974 AS o_orderdate_prf_1#4984, o_custkey_prf#4975 AS o_custkey_prf_1#4985, o_orderpriority_prf#4976 AS o_orderpriority_prf_1#4986, o_clerk_prf#4977 AS o_clerk_prf_1#4987, o_orderstatus_prf#4978 AS o_orderstatus_prf_1#4988, o_totalprice_prf#4979 AS o_totalprice_prf_1#4989, o_orderkey_prf#4980 AS o_orderkey_prf_1#4990, o_comment_prf#4981 AS o_comment_prf_1#4991]
            :     :  +- Relation[o_shippriority_prf#4972,rid#4973,o_orderdate_prf#4974,o_custkey_prf#4975,o_orderpriority_prf#4976,o_clerk_prf#4977,o_orderstatus_prf#4978,o_totalprice_prf#4979,o_orderkey_prf#4980,o_comment_prf#4981] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4993 AS c_acctbal_prf_2#5002, rid#4994 AS rid_2#5003, c_name_prf#4995 AS c_name_prf_2#5004, c_nationkey_prf#4996 AS c_nationkey_prf_2#5005, c_custkey_prf#4997 AS c_custkey_prf_2#5006, c_comment_prf#4998 AS c_comment_prf_2#5007, c_address_prf#4999 AS c_address_prf_2#5008, c_mktsegment_prf#5000 AS c_mktsegment_prf_2#5009, c_phone_prf#5001 AS c_phone_prf_2#5010]
               +- Relation[c_acctbal_prf#4993,rid#4994,c_name_prf#4995,c_nationkey_prf#4996,c_custkey_prf#4997,c_comment_prf#4998,c_address_prf#4999,c_mktsegment_prf#5000,c_phone_prf#5001] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 149505ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/14 09:43:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:43:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5077L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 09:43:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5077L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#5099]
         :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#5091: string
         :     :- Project [p_comment_prf#5079 AS p_comment_prf_0#5089, p_name_prf#5080 AS p_name_prf_0#5090, rid#5081 AS rid_0#5091, p_type_prf#5082 AS p_type_prf_0#5092, p_retailprice_prf#5083 AS p_retailprice_prf_0#5093, p_mfgr_prf#5084 AS p_mfgr_prf_0#5094, p_container_prf#5085 AS p_container_prf_0#5095, p_brand_prf#5086 AS p_brand_prf_0#5096, p_size_prf#5087 AS p_size_prf_0#5097, p_partkey_prf#5088 AS p_partkey_prf_0#5098]
         :     :  +- Relation[p_comment_prf#5079,p_name_prf#5080,rid#5081,p_type_prf#5082,p_retailprice_prf#5083,p_mfgr_prf#5084,p_container_prf#5085,p_brand_prf#5086,p_size_prf#5087,p_partkey_prf#5088] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5100 AS l_returnflag_prf_1#5119, l_orderkey_and_l_linenumber_prf#5101 AS l_orderkey_and_l_linenumber_prf_1#5120, l_comment_prf#5102 AS l_comment_prf_1#5121, l_linestatus_prf#5103 AS l_linestatus_prf_1#5122, rid#5104 AS rid_1#5123, l_shipmode_prf#5105 AS l_shipmode_prf_1#5124, l_shipinstruct_prf#5106 AS l_shipinstruct_prf_1#5125, l_quantity_prf#5107 AS l_quantity_prf_1#5126, l_receiptdate_prf#5108 AS l_receiptdate_prf_1#5127, l_linenumber_prf#5109 AS l_linenumber_prf_1#5128, l_tax_prf#5110 AS l_tax_prf_1#5129, l_shipdate_prf#5111 AS l_shipdate_prf_1#5130, l_extendedprice_prf#5112 AS l_extendedprice_prf_1#5131, l_partkey_prf#5113 AS l_partkey_prf_1#5132, l_discount_prf#5114 AS l_discount_prf_1#5133, l_partkey_and_l_suppkey_prf#5115 AS l_partkey_and_l_suppkey_prf_1#5134, l_commitdate_prf#5116 AS l_commitdate_prf_1#5135, l_suppkey_prf#5117 AS l_suppkey_prf_1#5136, l_orderkey_prf#5118 AS l_orderkey_prf_1#5137]
            +- Relation[l_returnflag_prf#5100,l_orderkey_and_l_linenumber_prf#5101,l_comment_prf#5102,l_linestatus_prf#5103,rid#5104,l_shipmode_prf#5105,l_shipinstruct_prf#5106,l_quantity_prf#5107,l_receiptdate_prf#5108,l_linenumber_prf#5109,l_tax_prf#5110,l_shipdate_prf#5111,l_extendedprice_prf#5112,l_partkey_prf#5113,l_discount_prf#5114,l_partkey_and_l_suppkey_prf#5115,l_commitdate_prf#5116,l_suppkey_prf#5117,l_orderkey_prf#5118] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 94295ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/14 09:44:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:44:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5174L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 09:44:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5174L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#5176 AS rid_0#5181, n_regionkey_prf#5177 AS n_regionkey_prf_0#5182, n_nationkey_prf#5178 AS n_nationkey_prf_0#5183, n_name_prf#5179 AS n_name_prf_0#5184, n_comment_prf#5180 AS n_comment_prf_0#5185]
         :  +- Relation[rid#5176,n_regionkey_prf#5177,n_nationkey_prf#5178,n_name_prf#5179,n_comment_prf#5180] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5186]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1654,value#1655] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 52ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/14 09:44:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:44:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5228L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 09:44:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5228L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#5268]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#5253: string
         :     :  :     :- Project [l_returnflag_prf#5230 AS l_returnflag_prf_0#5249, l_orderkey_and_l_linenumber_prf#5231 AS l_orderkey_and_l_linenumber_prf_0#5250, l_comment_prf#5232 AS l_comment_prf_0#5251, l_linestatus_prf#5233 AS l_linestatus_prf_0#5252, rid#5234 AS rid_0#5253, l_shipmode_prf#5235 AS l_shipmode_prf_0#5254, l_shipinstruct_prf#5236 AS l_shipinstruct_prf_0#5255, l_quantity_prf#5237 AS l_quantity_prf_0#5256, l_receiptdate_prf#5238 AS l_receiptdate_prf_0#5257, l_linenumber_prf#5239 AS l_linenumber_prf_0#5258, l_tax_prf#5240 AS l_tax_prf_0#5259, l_shipdate_prf#5241 AS l_shipdate_prf_0#5260, l_extendedprice_prf#5242 AS l_extendedprice_prf_0#5261, l_partkey_prf#5243 AS l_partkey_prf_0#5262, l_discount_prf#5244 AS l_discount_prf_0#5263, l_partkey_and_l_suppkey_prf#5245 AS l_partkey_and_l_suppkey_prf_0#5264, l_commitdate_prf#5246 AS l_commitdate_prf_0#5265, l_suppkey_prf#5247 AS l_suppkey_prf_0#5266, l_orderkey_prf#5248 AS l_orderkey_prf_0#5267]
         :     :  :     :  +- Relation[l_returnflag_prf#5230,l_orderkey_and_l_linenumber_prf#5231,l_comment_prf#5232,l_linestatus_prf#5233,rid#5234,l_shipmode_prf#5235,l_shipinstruct_prf#5236,l_quantity_prf#5237,l_receiptdate_prf#5238,l_linenumber_prf#5239,l_tax_prf#5240,l_shipdate_prf#5241,l_extendedprice_prf#5242,l_partkey_prf#5243,l_discount_prf#5244,l_partkey_and_l_suppkey_prf#5245,l_commitdate_prf#5246,l_suppkey_prf#5247,l_orderkey_prf#5248] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#5269 AS o_shippriority_prf_1#5279, rid#5270 AS rid_1#5280, o_orderdate_prf#5271 AS o_orderdate_prf_1#5281, o_custkey_prf#5272 AS o_custkey_prf_1#5282, o_orderpriority_prf#5273 AS o_orderpriority_prf_1#5283, o_clerk_prf#5274 AS o_clerk_prf_1#5284, o_orderstatus_prf#5275 AS o_orderstatus_prf_1#5285, o_totalprice_prf#5276 AS o_totalprice_prf_1#5286, o_orderkey_prf#5277 AS o_orderkey_prf_1#5287, o_comment_prf#5278 AS o_comment_prf_1#5288]
         :     :     +- Relation[o_shippriority_prf#5269,rid#5270,o_orderdate_prf#5271,o_custkey_prf#5272,o_orderpriority_prf#5273,o_clerk_prf#5274,o_orderstatus_prf#5275,o_totalprice_prf#5276,o_orderkey_prf#5277,o_comment_prf#5278] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#5290 AS c_acctbal_prf_2#5299, rid#5291 AS rid_2#5300, c_name_prf#5292 AS c_name_prf_2#5301, c_nationkey_prf#5293 AS c_nationkey_prf_2#5302, c_custkey_prf#5294 AS c_custkey_prf_2#5303, c_comment_prf#5295 AS c_comment_prf_2#5304, c_address_prf#5296 AS c_address_prf_2#5305, c_mktsegment_prf#5297 AS c_mktsegment_prf_2#5306, c_phone_prf#5298 AS c_phone_prf_2#5307]
            +- Relation[c_acctbal_prf#5290,rid#5291,c_name_prf#5292,c_nationkey_prf#5293,c_custkey_prf#5294,c_comment_prf#5295,c_address_prf#5296,c_mktsegment_prf#5297,c_phone_prf#5298] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 335483ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/14 09:50:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 09:50:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5363L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 09:50:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5363L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1522) AS rid_1#5385]
         :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#5377: string
         :     :- Project [p_comment_prf#5365 AS p_comment_prf_0#5375, p_name_prf#5366 AS p_name_prf_0#5376, rid#5367 AS rid_0#5377, p_type_prf#5368 AS p_type_prf_0#5378, p_retailprice_prf#5369 AS p_retailprice_prf_0#5379, p_mfgr_prf#5370 AS p_mfgr_prf_0#5380, p_container_prf#5371 AS p_container_prf_0#5381, p_brand_prf#5372 AS p_brand_prf_0#5382, p_size_prf#5373 AS p_size_prf_0#5383, p_partkey_prf#5374 AS p_partkey_prf_0#5384]
         :     :  +- Relation[p_comment_prf#5365,p_name_prf#5366,rid#5367,p_type_prf#5368,p_retailprice_prf#5369,p_mfgr_prf#5370,p_container_prf#5371,p_brand_prf#5372,p_size_prf#5373,p_partkey_prf#5374] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1521,value#1522] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#5386 AS ps_partkey_and_ps_suppkey_prf_1#5393, rid#5387 AS rid_1#5394, ps_availqty_prf#5388 AS ps_availqty_prf_1#5395, ps_comment_prf#5389 AS ps_comment_prf_1#5396, ps_partkey_prf#5390 AS ps_partkey_prf_1#5397, ps_supplycost_prf#5391 AS ps_supplycost_prf_1#5398, ps_suppkey_prf#5392 AS ps_suppkey_prf_1#5399]
            +- Relation[ps_partkey_and_ps_suppkey_prf#5386,rid#5387,ps_availqty_prf#5388,ps_comment_prf#5389,ps_partkey_prf#5390,ps_supplycost_prf#5391,ps_suppkey_prf#5392] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 31787ms
query=b1a, count=15628, duration=402
query=b1b, count=15628, duration=49341
query=b2a, count=1478870, duration=197266
query=b2b, count=1478870, duration=54472
query=f1, count=1, duration=53
query=f2, count=3907, duration=150
query=f3, count=1451, duration=83
query=f4, count=1, duration=52
query=f5, count=1478870, duration=23353
query=f6, count=857401, duration=13670
query=j1, count=800000, duration=31787
query=j10, count=6001215, duration=86412
query=j2, count=800000, duration=10963
query=j3, count=25, duration=69
query=j4, count=150000, duration=1936
query=j5, count=10000, duration=188
query=j6, count=6001215, duration=116468
query=j7, count=1500000, duration=40198
query=j8, count=6001215, duration=195544
query=j8b, count=6001215, duration=114139
query=j9, count=6001215, duration=94295
query=j9b, count=6001215, duration=118023
query=r1a, count=6001215, duration=335483
query=r1b, count=6001215, duration=149505
query=r1c, count=6001215, duration=158110
query=r1d, count=6001215, duration=270813
query=r1e, count=6001215, duration=234829
query=r1f, count=6001215, duration=157504
query=t1a, count=60000414, duration=661071
query=t1b, count=60000414, duration=795696
query=t1c, count=60000414, duration=57954
query=t2a, count=800000, duration=107529
query=t2b, count=800000, duration=88307
query=t2c, count=800000, duration=42972
query=t2d, count=800000, duration=61581
query=t3a, count=6001215, duration=263262
query=t3b, count=6001215, duration=288644
query=t3c, count=6001215, duration=188884
query=t3d, count=6001215, duration=186279
