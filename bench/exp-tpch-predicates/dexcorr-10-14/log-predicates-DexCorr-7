19/10/14 12:43:52 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7123ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Mon Oct 14 12:43:54 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Mon Oct 14 12:43:55 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Mon Oct 14 12:43:56 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Mon Oct 14 12:43:56 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Mon Oct 14 12:43:56 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Mon Oct 14 12:43:58 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Mon Oct 14 12:44:00 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Mon Oct 14 12:44:01 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/14 12:44:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 12:44:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1492L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 12:44:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1492L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1515) AS rid_2#1531]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#1516]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#1506: string
         :     :  :     :- Project [p_comment_prf#1494 AS p_comment_prf_0#1504, p_name_prf#1495 AS p_name_prf_0#1505, rid#1496 AS rid_0#1506, p_type_prf#1497 AS p_type_prf_0#1507, p_retailprice_prf#1498 AS p_retailprice_prf_0#1508, p_mfgr_prf#1499 AS p_mfgr_prf_0#1509, p_container_prf#1500 AS p_container_prf_0#1510, p_brand_prf#1501 AS p_brand_prf_0#1511, p_size_prf#1502 AS p_size_prf_0#1512, p_partkey_prf#1503 AS p_partkey_prf_0#1513]
         :     :  :     :  +- Relation[p_comment_prf#1494,p_name_prf#1495,rid#1496,p_type_prf#1497,p_retailprice_prf#1498,p_mfgr_prf#1499,p_container_prf#1500,p_brand_prf#1501,p_size_prf#1502,p_partkey_prf#1503] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#1517 AS ps_partkey_and_ps_suppkey_prf_1#1524, rid#1518 AS rid_1#1525, ps_availqty_prf#1519 AS ps_availqty_prf_1#1526, ps_comment_prf#1520 AS ps_comment_prf_1#1527, ps_partkey_prf#1521 AS ps_partkey_prf_1#1528, ps_supplycost_prf#1522 AS ps_supplycost_prf_1#1529, ps_suppkey_prf#1523 AS ps_suppkey_prf_1#1530]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#1517,rid#1518,ps_availqty_prf#1519,ps_comment_prf#1520,ps_partkey_prf#1521,ps_supplycost_prf#1522,ps_suppkey_prf#1523] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#1532 AS s_phone_prf_2#1540, rid#1533 AS rid_2#1541, s_address_prf#1534 AS s_address_prf_2#1542, s_nationkey_prf#1535 AS s_nationkey_prf_2#1543, s_suppkey_prf#1536 AS s_suppkey_prf_2#1544, s_name_prf#1537 AS s_name_prf_2#1545, s_acctbal_prf#1538 AS s_acctbal_prf_2#1546, s_comment_prf#1539 AS s_comment_prf_2#1547]
            +- Relation[s_phone_prf#1532,rid#1533,s_address_prf#1534,s_nationkey_prf#1535,s_suppkey_prf#1536,s_name_prf#1537,s_acctbal_prf#1538,s_comment_prf#1539] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 88063ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/14 12:45:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 12:45:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1588L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 12:45:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1588L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#1606]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#1599: string
         :     :- Project [s_phone_prf#1590 AS s_phone_prf_0#1598, rid#1591 AS rid_0#1599, s_address_prf#1592 AS s_address_prf_0#1600, s_nationkey_prf#1593 AS s_nationkey_prf_0#1601, s_suppkey_prf#1594 AS s_suppkey_prf_0#1602, s_name_prf#1595 AS s_name_prf_0#1603, s_acctbal_prf#1596 AS s_acctbal_prf_0#1604, s_comment_prf#1597 AS s_comment_prf_0#1605]
         :     :  +- Relation[s_phone_prf#1590,rid#1591,s_address_prf#1592,s_nationkey_prf#1593,s_suppkey_prf#1594,s_name_prf#1595,s_acctbal_prf#1596,s_comment_prf#1597] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#1607 AS ps_partkey_and_ps_suppkey_prf_1#1614, rid#1608 AS rid_1#1615, ps_availqty_prf#1609 AS ps_availqty_prf_1#1616, ps_comment_prf#1610 AS ps_comment_prf_1#1617, ps_partkey_prf#1611 AS ps_partkey_prf_1#1618, ps_supplycost_prf#1612 AS ps_supplycost_prf_1#1619, ps_suppkey_prf#1613 AS ps_suppkey_prf_1#1620]
            +- Relation[ps_partkey_and_ps_suppkey_prf#1607,rid#1608,ps_availqty_prf#1609,ps_comment_prf#1610,ps_partkey_prf#1611,ps_supplycost_prf#1612,ps_suppkey_prf#1613] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 10964ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/14 12:45:41 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 12:45:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1653L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 12:45:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1653L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#1675]
         :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#1667: string
         :     :- Project [p_comment_prf#1655 AS p_comment_prf_0#1665, p_name_prf#1656 AS p_name_prf_0#1666, rid#1657 AS rid_0#1667, p_type_prf#1658 AS p_type_prf_0#1668, p_retailprice_prf#1659 AS p_retailprice_prf_0#1669, p_mfgr_prf#1660 AS p_mfgr_prf_0#1670, p_container_prf#1661 AS p_container_prf_0#1671, p_brand_prf#1662 AS p_brand_prf_0#1672, p_size_prf#1663 AS p_size_prf_0#1673, p_partkey_prf#1664 AS p_partkey_prf_0#1674]
         :     :  +- Relation[p_comment_prf#1655,p_name_prf#1656,rid#1657,p_type_prf#1658,p_retailprice_prf#1659,p_mfgr_prf#1660,p_container_prf#1661,p_brand_prf#1662,p_size_prf#1663,p_partkey_prf#1664] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#1676 AS ps_partkey_and_ps_suppkey_prf_1#1683, rid#1677 AS rid_1#1684, ps_availqty_prf#1678 AS ps_availqty_prf_1#1685, ps_comment_prf#1679 AS ps_comment_prf_1#1686, ps_partkey_prf#1680 AS ps_partkey_prf_1#1687, ps_supplycost_prf#1681 AS ps_supplycost_prf_1#1688, ps_suppkey_prf#1682 AS ps_suppkey_prf_1#1689]
            +- Relation[ps_partkey_and_ps_suppkey_prf#1676,rid#1677,ps_availqty_prf#1678,ps_comment_prf#1679,ps_partkey_prf#1680,ps_supplycost_prf#1681,ps_suppkey_prf#1682] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 31586ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/14 12:46:12 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 12:46:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1743L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 12:46:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1743L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_2#1783]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#1768: string
         :     :- Project [l_returnflag_prf#1745 AS l_returnflag_prf_0#1764, l_orderkey_and_l_linenumber_prf#1746 AS l_orderkey_and_l_linenumber_prf_0#1765, l_comment_prf#1747 AS l_comment_prf_0#1766, l_linestatus_prf#1748 AS l_linestatus_prf_0#1767, rid#1749 AS rid_0#1768, l_shipmode_prf#1750 AS l_shipmode_prf_0#1769, l_shipinstruct_prf#1751 AS l_shipinstruct_prf_0#1770, l_quantity_prf#1752 AS l_quantity_prf_0#1771, l_receiptdate_prf#1753 AS l_receiptdate_prf_0#1772, l_linenumber_prf#1754 AS l_linenumber_prf_0#1773, l_tax_prf#1755 AS l_tax_prf_0#1774, l_shipdate_prf#1756 AS l_shipdate_prf_0#1775, l_extendedprice_prf#1757 AS l_extendedprice_prf_0#1776, l_partkey_prf#1758 AS l_partkey_prf_0#1777, l_discount_prf#1759 AS l_discount_prf_0#1778, l_partkey_and_l_suppkey_prf#1760 AS l_partkey_and_l_suppkey_prf_0#1779, l_commitdate_prf#1761 AS l_commitdate_prf_0#1780, l_suppkey_prf#1762 AS l_suppkey_prf_0#1781, l_orderkey_prf#1763 AS l_orderkey_prf_0#1782]
         :     :  +- Relation[l_returnflag_prf#1745,l_orderkey_and_l_linenumber_prf#1746,l_comment_prf#1747,l_linestatus_prf#1748,rid#1749,l_shipmode_prf#1750,l_shipinstruct_prf#1751,l_quantity_prf#1752,l_receiptdate_prf#1753,l_linenumber_prf#1754,l_tax_prf#1755,l_shipdate_prf#1756,l_extendedprice_prf#1757,l_partkey_prf#1758,l_discount_prf#1759,l_partkey_and_l_suppkey_prf#1760,l_commitdate_prf#1761,l_suppkey_prf#1762,l_orderkey_prf#1763] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1515) AS rid_2#1802]
            :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#1794: string
            :     :- Project [c_acctbal_prf#1784 AS c_acctbal_prf_1#1793, rid#1785 AS rid_1#1794, c_name_prf#1786 AS c_name_prf_1#1795, c_nationkey_prf#1787 AS c_nationkey_prf_1#1796, c_custkey_prf#1788 AS c_custkey_prf_1#1797, c_comment_prf#1789 AS c_comment_prf_1#1798, c_address_prf#1790 AS c_address_prf_1#1799, c_mktsegment_prf#1791 AS c_mktsegment_prf_1#1800, c_phone_prf#1792 AS c_phone_prf_1#1801]
            :     :  +- Relation[c_acctbal_prf#1784,rid#1785,c_name_prf#1786,c_nationkey_prf#1787,c_custkey_prf#1788,c_comment_prf#1789,c_address_prf#1790,c_mktsegment_prf#1791,c_phone_prf#1792] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#1803 AS o_shippriority_prf_2#1813, rid#1804 AS rid_2#1814, o_orderdate_prf#1805 AS o_orderdate_prf_2#1815, o_custkey_prf#1806 AS o_custkey_prf_2#1816, o_orderpriority_prf#1807 AS o_orderpriority_prf_2#1817, o_clerk_prf#1808 AS o_clerk_prf_2#1818, o_orderstatus_prf#1809 AS o_orderstatus_prf_2#1819, o_totalprice_prf#1810 AS o_totalprice_prf_2#1820, o_orderkey_prf#1811 AS o_orderkey_prf_2#1821, o_comment_prf#1812 AS o_comment_prf_2#1822]
               +- Relation[o_shippriority_prf#1803,rid#1804,o_orderdate_prf#1805,o_custkey_prf#1806,o_orderpriority_prf#1807,o_clerk_prf#1808,o_orderstatus_prf#1809,o_totalprice_prf#1810,o_orderkey_prf#1811,o_comment_prf#1812] JDBCRelation(orders_prf) [numPartitions=1]

19/10/14 12:46:12 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=6001215
Elapsed time: 157892ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/14 12:48:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 12:48:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1883L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 12:48:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1883L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_2#1903]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#1895: string
         :     :- Project [c_acctbal_prf#1885 AS c_acctbal_prf_0#1894, rid#1886 AS rid_0#1895, c_name_prf#1887 AS c_name_prf_0#1896, c_nationkey_prf#1888 AS c_nationkey_prf_0#1897, c_custkey_prf#1889 AS c_custkey_prf_0#1898, c_comment_prf#1890 AS c_comment_prf_0#1899, c_address_prf#1891 AS c_address_prf_0#1900, c_mktsegment_prf#1892 AS c_mktsegment_prf_0#1901, c_phone_prf#1893 AS c_phone_prf_0#1902]
         :     :  +- Relation[c_acctbal_prf#1885,rid#1886,c_name_prf#1887,c_nationkey_prf#1888,c_custkey_prf#1889,c_comment_prf#1890,c_address_prf#1891,c_mktsegment_prf#1892,c_phone_prf#1893] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1515) AS rid_2#1920]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#1913: string
            :     :- Project [s_phone_prf#1904 AS s_phone_prf_1#1912, rid#1905 AS rid_1#1913, s_address_prf#1906 AS s_address_prf_1#1914, s_nationkey_prf#1907 AS s_nationkey_prf_1#1915, s_suppkey_prf#1908 AS s_suppkey_prf_1#1916, s_name_prf#1909 AS s_name_prf_1#1917, s_acctbal_prf#1910 AS s_acctbal_prf_1#1918, s_comment_prf#1911 AS s_comment_prf_1#1919]
            :     :  +- Relation[s_phone_prf#1904,rid#1905,s_address_prf#1906,s_nationkey_prf#1907,s_suppkey_prf#1908,s_name_prf#1909,s_acctbal_prf#1910,s_comment_prf#1911] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [rid#1921 AS rid_2#1926, n_regionkey_prf#1922 AS n_regionkey_prf_2#1927, n_nationkey_prf#1923 AS n_nationkey_prf_2#1928, n_name_prf#1924 AS n_name_prf_2#1929, n_comment_prf#1925 AS n_comment_prf_2#1930]
               +- Relation[rid#1921,n_regionkey_prf#1922,n_nationkey_prf#1923,n_name_prf#1924,n_comment_prf#1925] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 59168ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/14 12:49:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 12:49:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1967L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 12:49:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1967L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#1979]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#1974: string
         :     :- Project [rid#1969 AS rid_0#1974, n_regionkey_prf#1970 AS n_regionkey_prf_0#1975, n_nationkey_prf#1971 AS n_nationkey_prf_0#1976, n_name_prf#1972 AS n_name_prf_0#1977, n_comment_prf#1973 AS n_comment_prf_0#1978]
         :     :  +- Relation[rid#1969,n_regionkey_prf#1970,n_nationkey_prf#1971,n_name_prf#1972,n_comment_prf#1973] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#1980 AS s_phone_prf_1#1988, rid#1981 AS rid_1#1989, s_address_prf#1982 AS s_address_prf_1#1990, s_nationkey_prf#1983 AS s_nationkey_prf_1#1991, s_suppkey_prf#1984 AS s_suppkey_prf_1#1992, s_name_prf#1985 AS s_name_prf_1#1993, s_acctbal_prf#1986 AS s_acctbal_prf_1#1994, s_comment_prf#1987 AS s_comment_prf_1#1995]
            +- Relation[s_phone_prf#1980,rid#1981,s_address_prf#1982,s_nationkey_prf#1983,s_suppkey_prf#1984,s_name_prf#1985,s_acctbal_prf#1986,s_comment_prf#1987] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=10000
Elapsed time: 197ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/14 12:49:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 12:49:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2037L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 12:49:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2037L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#2059]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#2050: string
         :     :- Project [o_shippriority_prf#2039 AS o_shippriority_prf_0#2049, rid#2040 AS rid_0#2050, o_orderdate_prf#2041 AS o_orderdate_prf_0#2051, o_custkey_prf#2042 AS o_custkey_prf_0#2052, o_orderpriority_prf#2043 AS o_orderpriority_prf_0#2053, o_clerk_prf#2044 AS o_clerk_prf_0#2054, o_orderstatus_prf#2045 AS o_orderstatus_prf_0#2055, o_totalprice_prf#2046 AS o_totalprice_prf_0#2056, o_orderkey_prf#2047 AS o_orderkey_prf_0#2057, o_comment_prf#2048 AS o_comment_prf_0#2058]
         :     :  +- Relation[o_shippriority_prf#2039,rid#2040,o_orderdate_prf#2041,o_custkey_prf#2042,o_orderpriority_prf#2043,o_clerk_prf#2044,o_orderstatus_prf#2045,o_totalprice_prf#2046,o_orderkey_prf#2047,o_comment_prf#2048] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2060 AS l_returnflag_prf_1#2079, l_orderkey_and_l_linenumber_prf#2061 AS l_orderkey_and_l_linenumber_prf_1#2080, l_comment_prf#2062 AS l_comment_prf_1#2081, l_linestatus_prf#2063 AS l_linestatus_prf_1#2082, rid#2064 AS rid_1#2083, l_shipmode_prf#2065 AS l_shipmode_prf_1#2084, l_shipinstruct_prf#2066 AS l_shipinstruct_prf_1#2085, l_quantity_prf#2067 AS l_quantity_prf_1#2086, l_receiptdate_prf#2068 AS l_receiptdate_prf_1#2087, l_linenumber_prf#2069 AS l_linenumber_prf_1#2088, l_tax_prf#2070 AS l_tax_prf_1#2089, l_shipdate_prf#2071 AS l_shipdate_prf_1#2090, l_extendedprice_prf#2072 AS l_extendedprice_prf_1#2091, l_partkey_prf#2073 AS l_partkey_prf_1#2092, l_discount_prf#2074 AS l_discount_prf_1#2093, l_partkey_and_l_suppkey_prf#2075 AS l_partkey_and_l_suppkey_prf_1#2094, l_commitdate_prf#2076 AS l_commitdate_prf_1#2095, l_suppkey_prf#2077 AS l_suppkey_prf_1#2096, l_orderkey_prf#2078 AS l_orderkey_prf_1#2097]
            +- Relation[l_returnflag_prf#2060,l_orderkey_and_l_linenumber_prf#2061,l_comment_prf#2062,l_linestatus_prf#2063,rid#2064,l_shipmode_prf#2065,l_shipinstruct_prf#2066,l_quantity_prf#2067,l_receiptdate_prf#2068,l_linenumber_prf#2069,l_tax_prf#2070,l_shipdate_prf#2071,l_extendedprice_prf#2072,l_partkey_prf#2073,l_discount_prf#2074,l_partkey_and_l_suppkey_prf#2075,l_commitdate_prf#2076,l_suppkey_prf#2077,l_orderkey_prf#2078] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 195364ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/14 12:53:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 12:53:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2144L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 12:53:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2144L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#2169]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2158: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#2146 AS p_comment_prf_0#2156, p_name_prf#2147 AS p_name_prf_0#2157, rid#2148 AS rid_0#2158, p_type_prf#2149 AS p_type_prf_0#2159, p_retailprice_prf#2150 AS p_retailprice_prf_0#2160, p_mfgr_prf#2151 AS p_mfgr_prf_0#2161, p_container_prf#2152 AS p_container_prf_0#2162, p_brand_prf#2153 AS p_brand_prf_0#2163, p_size_prf#2154 AS p_size_prf_0#2164, p_partkey_prf#2155 AS p_partkey_prf_0#2165]
         :     :  :  +- Relation[p_comment_prf#2146,p_name_prf#2147,rid#2148,p_type_prf#2149,p_retailprice_prf#2150,p_mfgr_prf#2151,p_container_prf#2152,p_brand_prf#2153,p_size_prf#2154,p_partkey_prf#2155] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2168]
         :     :     +- DexRidFilter part~p_size~15
         :     :        +- Relation[label#2166,value#2167] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2170 AS ps_partkey_and_ps_suppkey_prf_1#2177, rid#2171 AS rid_1#2178, ps_availqty_prf#2172 AS ps_availqty_prf_1#2179, ps_comment_prf#2173 AS ps_comment_prf_1#2180, ps_partkey_prf#2174 AS ps_partkey_prf_1#2181, ps_supplycost_prf#2175 AS ps_supplycost_prf_1#2182, ps_suppkey_prf#2176 AS ps_suppkey_prf_1#2183]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2170,rid#2171,ps_availqty_prf#2172,ps_comment_prf#2173,ps_partkey_prf#2174,ps_supplycost_prf#2175,ps_suppkey_prf#2176] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 433ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/14 12:53:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 12:53:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2213L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 12:53:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2213L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#2215 AS p_comment_prf_0#2225, p_name_prf#2216 AS p_name_prf_0#2226, rid#2217 AS rid_0#2227, p_type_prf#2218 AS p_type_prf_0#2228, p_retailprice_prf#2219 AS p_retailprice_prf_0#2229, p_mfgr_prf#2220 AS p_mfgr_prf_0#2230, p_container_prf#2221 AS p_container_prf_0#2231, p_brand_prf#2222 AS p_brand_prf_0#2232, p_size_prf#2223 AS p_size_prf_0#2233, p_partkey_prf#2224 AS p_partkey_prf_0#2234]
         :  +- Relation[p_comment_prf#2215,p_name_prf#2216,rid#2217,p_type_prf#2218,p_retailprice_prf#2219,p_mfgr_prf#2220,p_container_prf#2221,p_brand_prf#2222,p_size_prf#2223,p_partkey_prf#2224] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2235]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#2166,value#2167] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1451
Elapsed time: 85ms

f2=
select * from part where p_size = 15
19/10/14 12:53:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 12:53:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2258L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 12:53:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2258L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#2260 AS p_comment_prf_0#2270, p_name_prf#2261 AS p_name_prf_0#2271, rid#2262 AS rid_0#2272, p_type_prf#2263 AS p_type_prf_0#2273, p_retailprice_prf#2264 AS p_retailprice_prf_0#2274, p_mfgr_prf#2265 AS p_mfgr_prf_0#2275, p_container_prf#2266 AS p_container_prf_0#2276, p_brand_prf#2267 AS p_brand_prf_0#2277, p_size_prf#2268 AS p_size_prf_0#2278, p_partkey_prf#2269 AS p_partkey_prf_0#2279]
         :  +- Relation[p_comment_prf#2260,p_name_prf#2261,rid#2262,p_type_prf#2263,p_retailprice_prf#2264,p_mfgr_prf#2265,p_container_prf#2266,p_brand_prf#2267,p_size_prf#2268,p_partkey_prf#2269] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2280]
            +- DexRidFilter part~p_size~15
               +- Relation[label#2166,value#2167] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3907
Elapsed time: 128ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/14 12:53:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 12:53:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2327L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 12:53:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2327L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#2367]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2352: string
         :     :  :     :- Project [l_returnflag_prf#2329 AS l_returnflag_prf_0#2348, l_orderkey_and_l_linenumber_prf#2330 AS l_orderkey_and_l_linenumber_prf_0#2349, l_comment_prf#2331 AS l_comment_prf_0#2350, l_linestatus_prf#2332 AS l_linestatus_prf_0#2351, rid#2333 AS rid_0#2352, l_shipmode_prf#2334 AS l_shipmode_prf_0#2353, l_shipinstruct_prf#2335 AS l_shipinstruct_prf_0#2354, l_quantity_prf#2336 AS l_quantity_prf_0#2355, l_receiptdate_prf#2337 AS l_receiptdate_prf_0#2356, l_linenumber_prf#2338 AS l_linenumber_prf_0#2357, l_tax_prf#2339 AS l_tax_prf_0#2358, l_shipdate_prf#2340 AS l_shipdate_prf_0#2359, l_extendedprice_prf#2341 AS l_extendedprice_prf_0#2360, l_partkey_prf#2342 AS l_partkey_prf_0#2361, l_discount_prf#2343 AS l_discount_prf_0#2362, l_partkey_and_l_suppkey_prf#2344 AS l_partkey_and_l_suppkey_prf_0#2363, l_commitdate_prf#2345 AS l_commitdate_prf_0#2364, l_suppkey_prf#2346 AS l_suppkey_prf_0#2365, l_orderkey_prf#2347 AS l_orderkey_prf_0#2366]
         :     :  :     :  +- Relation[l_returnflag_prf#2329,l_orderkey_and_l_linenumber_prf#2330,l_comment_prf#2331,l_linestatus_prf#2332,rid#2333,l_shipmode_prf#2334,l_shipinstruct_prf#2335,l_quantity_prf#2336,l_receiptdate_prf#2337,l_linenumber_prf#2338,l_tax_prf#2339,l_shipdate_prf#2340,l_extendedprice_prf#2341,l_partkey_prf#2342,l_discount_prf#2343,l_partkey_and_l_suppkey_prf#2344,l_commitdate_prf#2345,l_suppkey_prf#2346,l_orderkey_prf#2347] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#2368 AS o_shippriority_prf_1#2378, rid#2369 AS rid_1#2379, o_orderdate_prf#2370 AS o_orderdate_prf_1#2380, o_custkey_prf#2371 AS o_custkey_prf_1#2381, o_orderpriority_prf#2372 AS o_orderpriority_prf_1#2382, o_clerk_prf#2373 AS o_clerk_prf_1#2383, o_orderstatus_prf#2374 AS o_orderstatus_prf_1#2384, o_totalprice_prf#2375 AS o_totalprice_prf_1#2385, o_orderkey_prf#2376 AS o_orderkey_prf_1#2386, o_comment_prf#2377 AS o_comment_prf_1#2387]
         :     :     +- Relation[o_shippriority_prf#2368,rid#2369,o_orderdate_prf#2370,o_custkey_prf#2371,o_orderpriority_prf#2372,o_clerk_prf#2373,o_orderstatus_prf#2374,o_totalprice_prf#2375,o_orderkey_prf#2376,o_comment_prf#2377] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2389 AS c_acctbal_prf_2#2398, rid#2390 AS rid_2#2399, c_name_prf#2391 AS c_name_prf_2#2400, c_nationkey_prf#2392 AS c_nationkey_prf_2#2401, c_custkey_prf#2393 AS c_custkey_prf_2#2402, c_comment_prf#2394 AS c_comment_prf_2#2403, c_address_prf#2395 AS c_address_prf_2#2404, c_mktsegment_prf#2396 AS c_mktsegment_prf_2#2405, c_phone_prf#2397 AS c_phone_prf_2#2406]
            +- Relation[c_acctbal_prf#2389,rid#2390,c_name_prf#2391,c_nationkey_prf#2392,c_custkey_prf#2393,c_comment_prf#2394,c_address_prf#2395,c_mktsegment_prf#2396,c_phone_prf#2397] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 336133ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/14 12:58:42 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 12:58:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2460L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 12:58:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2460L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#2472]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#2467: string
         :     :- Project [rid#2462 AS rid_0#2467, n_regionkey_prf#2463 AS n_regionkey_prf_0#2468, n_nationkey_prf#2464 AS n_nationkey_prf_0#2469, n_name_prf#2465 AS n_name_prf_0#2470, n_comment_prf#2466 AS n_comment_prf_0#2471]
         :     :  +- Relation[rid#2462,n_regionkey_prf#2463,n_nationkey_prf#2464,n_name_prf#2465,n_comment_prf#2466] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2473 AS c_acctbal_prf_1#2482, rid#2474 AS rid_1#2483, c_name_prf#2475 AS c_name_prf_1#2484, c_nationkey_prf#2476 AS c_nationkey_prf_1#2485, c_custkey_prf#2477 AS c_custkey_prf_1#2486, c_comment_prf#2478 AS c_comment_prf_1#2487, c_address_prf#2479 AS c_address_prf_1#2488, c_mktsegment_prf#2480 AS c_mktsegment_prf_1#2489, c_phone_prf#2481 AS c_phone_prf_1#2490]
            +- Relation[c_acctbal_prf#2473,rid#2474,c_name_prf#2475,c_nationkey_prf#2476,c_custkey_prf#2477,c_comment_prf#2478,c_address_prf#2479,c_mktsegment_prf#2480,c_phone_prf#2481] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=150000
Elapsed time: 1950ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/14 12:58:44 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 12:58:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2540L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 12:58:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2540L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#2562]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2554: string
         :     :  :     :- Project [p_comment_prf#2542 AS p_comment_prf_0#2552, p_name_prf#2543 AS p_name_prf_0#2553, rid#2544 AS rid_0#2554, p_type_prf#2545 AS p_type_prf_0#2555, p_retailprice_prf#2546 AS p_retailprice_prf_0#2556, p_mfgr_prf#2547 AS p_mfgr_prf_0#2557, p_container_prf#2548 AS p_container_prf_0#2558, p_brand_prf#2549 AS p_brand_prf_0#2559, p_size_prf#2550 AS p_size_prf_0#2560, p_partkey_prf#2551 AS p_partkey_prf_0#2561]
         :     :  :     :  +- Relation[p_comment_prf#2542,p_name_prf#2543,rid#2544,p_type_prf#2545,p_retailprice_prf#2546,p_mfgr_prf#2547,p_container_prf#2548,p_brand_prf#2549,p_size_prf#2550,p_partkey_prf#2551] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#2563 AS l_returnflag_prf_1#2582, l_orderkey_and_l_linenumber_prf#2564 AS l_orderkey_and_l_linenumber_prf_1#2583, l_comment_prf#2565 AS l_comment_prf_1#2584, l_linestatus_prf#2566 AS l_linestatus_prf_1#2585, rid#2567 AS rid_1#2586, l_shipmode_prf#2568 AS l_shipmode_prf_1#2587, l_shipinstruct_prf#2569 AS l_shipinstruct_prf_1#2588, l_quantity_prf#2570 AS l_quantity_prf_1#2589, l_receiptdate_prf#2571 AS l_receiptdate_prf_1#2590, l_linenumber_prf#2572 AS l_linenumber_prf_1#2591, l_tax_prf#2573 AS l_tax_prf_1#2592, l_shipdate_prf#2574 AS l_shipdate_prf_1#2593, l_extendedprice_prf#2575 AS l_extendedprice_prf_1#2594, l_partkey_prf#2576 AS l_partkey_prf_1#2595, l_discount_prf#2577 AS l_discount_prf_1#2596, l_partkey_and_l_suppkey_prf#2578 AS l_partkey_and_l_suppkey_prf_1#2597, l_commitdate_prf#2579 AS l_commitdate_prf_1#2598, l_suppkey_prf#2580 AS l_suppkey_prf_1#2599, l_orderkey_prf#2581 AS l_orderkey_prf_1#2600]
         :     :     +- Relation[l_returnflag_prf#2563,l_orderkey_and_l_linenumber_prf#2564,l_comment_prf#2565,l_linestatus_prf#2566,rid#2567,l_shipmode_prf#2568,l_shipinstruct_prf#2569,l_quantity_prf#2570,l_receiptdate_prf#2571,l_linenumber_prf#2572,l_tax_prf#2573,l_shipdate_prf#2574,l_extendedprice_prf#2575,l_partkey_prf#2576,l_discount_prf#2577,l_partkey_and_l_suppkey_prf#2578,l_commitdate_prf#2579,l_suppkey_prf#2580,l_orderkey_prf#2581] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2602 AS s_phone_prf_2#2610, rid#2603 AS rid_2#2611, s_address_prf#2604 AS s_address_prf_2#2612, s_nationkey_prf#2605 AS s_nationkey_prf_2#2613, s_suppkey_prf#2606 AS s_suppkey_prf_2#2614, s_name_prf#2607 AS s_name_prf_2#2615, s_acctbal_prf#2608 AS s_acctbal_prf_2#2616, s_comment_prf#2609 AS s_comment_prf_2#2617]
            +- Relation[s_phone_prf#2602,rid#2603,s_address_prf#2604,s_nationkey_prf#2605,s_suppkey_prf#2606,s_name_prf#2607,s_acctbal_prf#2608,s_comment_prf#2609] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 289590ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/14 13:03:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 13:03:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2672L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 13:03:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2672L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#2688]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#2682: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#2674 AS ps_partkey_and_ps_suppkey_prf_0#2681, rid#2675 AS rid_0#2682, ps_availqty_prf#2676 AS ps_availqty_prf_0#2683, ps_comment_prf#2677 AS ps_comment_prf_0#2684, ps_partkey_prf#2678 AS ps_partkey_prf_0#2685, ps_supplycost_prf#2679 AS ps_supplycost_prf_0#2686, ps_suppkey_prf#2680 AS ps_suppkey_prf_0#2687]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2674,rid#2675,ps_availqty_prf#2676,ps_comment_prf#2677,ps_partkey_prf#2678,ps_supplycost_prf#2679,ps_suppkey_prf#2680] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#2689 AS p_comment_prf_1#2699, p_name_prf#2690 AS p_name_prf_1#2700, rid#2691 AS rid_1#2701, p_type_prf#2692 AS p_type_prf_1#2702, p_retailprice_prf#2693 AS p_retailprice_prf_1#2703, p_mfgr_prf#2694 AS p_mfgr_prf_1#2704, p_container_prf#2695 AS p_container_prf_1#2705, p_brand_prf#2696 AS p_brand_prf_1#2706, p_size_prf#2697 AS p_size_prf_1#2707, p_partkey_prf#2698 AS p_partkey_prf_1#2708]
            :  +- Relation[p_comment_prf#2689,p_name_prf#2690,rid#2691,p_type_prf#2692,p_retailprice_prf#2693,p_mfgr_prf#2694,p_container_prf#2695,p_brand_prf#2696,p_size_prf#2697,p_partkey_prf#2698] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2709]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#2166,value#2167] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 49686ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/14 13:04:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 13:04:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2762L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 13:04:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2762L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#2780]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#2773: string
         :     :- Project [s_phone_prf#2764 AS s_phone_prf_0#2772, rid#2765 AS rid_0#2773, s_address_prf#2766 AS s_address_prf_0#2774, s_nationkey_prf#2767 AS s_nationkey_prf_0#2775, s_suppkey_prf#2768 AS s_suppkey_prf_0#2776, s_name_prf#2769 AS s_name_prf_0#2777, s_acctbal_prf#2770 AS s_acctbal_prf_0#2778, s_comment_prf#2771 AS s_comment_prf_0#2779]
         :     :  +- Relation[s_phone_prf#2764,rid#2765,s_address_prf#2766,s_nationkey_prf#2767,s_suppkey_prf#2768,s_name_prf#2769,s_acctbal_prf#2770,s_comment_prf#2771] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1515) AS rid_2#2819]
            :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_1#2804: string
            :     :- Project [l_returnflag_prf#2781 AS l_returnflag_prf_1#2800, l_orderkey_and_l_linenumber_prf#2782 AS l_orderkey_and_l_linenumber_prf_1#2801, l_comment_prf#2783 AS l_comment_prf_1#2802, l_linestatus_prf#2784 AS l_linestatus_prf_1#2803, rid#2785 AS rid_1#2804, l_shipmode_prf#2786 AS l_shipmode_prf_1#2805, l_shipinstruct_prf#2787 AS l_shipinstruct_prf_1#2806, l_quantity_prf#2788 AS l_quantity_prf_1#2807, l_receiptdate_prf#2789 AS l_receiptdate_prf_1#2808, l_linenumber_prf#2790 AS l_linenumber_prf_1#2809, l_tax_prf#2791 AS l_tax_prf_1#2810, l_shipdate_prf#2792 AS l_shipdate_prf_1#2811, l_extendedprice_prf#2793 AS l_extendedprice_prf_1#2812, l_partkey_prf#2794 AS l_partkey_prf_1#2813, l_discount_prf#2795 AS l_discount_prf_1#2814, l_partkey_and_l_suppkey_prf#2796 AS l_partkey_and_l_suppkey_prf_1#2815, l_commitdate_prf#2797 AS l_commitdate_prf_1#2816, l_suppkey_prf#2798 AS l_suppkey_prf_1#2817, l_orderkey_prf#2799 AS l_orderkey_prf_1#2818]
            :     :  +- Relation[l_returnflag_prf#2781,l_orderkey_and_l_linenumber_prf#2782,l_comment_prf#2783,l_linestatus_prf#2784,rid#2785,l_shipmode_prf#2786,l_shipinstruct_prf#2787,l_quantity_prf#2788,l_receiptdate_prf#2789,l_linenumber_prf#2790,l_tax_prf#2791,l_shipdate_prf#2792,l_extendedprice_prf#2793,l_partkey_prf#2794,l_discount_prf#2795,l_partkey_and_l_suppkey_prf#2796,l_commitdate_prf#2797,l_suppkey_prf#2798,l_orderkey_prf#2799] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#2820 AS p_comment_prf_2#2830, p_name_prf#2821 AS p_name_prf_2#2831, rid#2822 AS rid_2#2832, p_type_prf#2823 AS p_type_prf_2#2833, p_retailprice_prf#2824 AS p_retailprice_prf_2#2834, p_mfgr_prf#2825 AS p_mfgr_prf_2#2835, p_container_prf#2826 AS p_container_prf_2#2836, p_brand_prf#2827 AS p_brand_prf_2#2837, p_size_prf#2828 AS p_size_prf_2#2838, p_partkey_prf#2829 AS p_partkey_prf_2#2839]
               +- Relation[p_comment_prf#2820,p_name_prf#2821,rid#2822,p_type_prf#2823,p_retailprice_prf#2824,p_mfgr_prf#2825,p_container_prf#2826,p_brand_prf#2827,p_size_prf#2828,p_partkey_prf#2829] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 186562ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/14 13:07:29 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 13:07:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2901L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 13:07:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2901L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1515) AS rid_2#2938]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#2917]
         :     :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#2911: string
         :     :  :     :- Project [ps_partkey_and_ps_suppkey_prf#2903 AS ps_partkey_and_ps_suppkey_prf_0#2910, rid#2904 AS rid_0#2911, ps_availqty_prf#2905 AS ps_availqty_prf_0#2912, ps_comment_prf#2906 AS ps_comment_prf_0#2913, ps_partkey_prf#2907 AS ps_partkey_prf_0#2914, ps_supplycost_prf#2908 AS ps_supplycost_prf_0#2915, ps_suppkey_prf#2909 AS ps_suppkey_prf_0#2916]
         :     :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2903,rid#2904,ps_availqty_prf#2905,ps_comment_prf#2906,ps_partkey_prf#2907,ps_supplycost_prf#2908,ps_suppkey_prf#2909] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#2918 AS p_comment_prf_1#2928, p_name_prf#2919 AS p_name_prf_1#2929, rid#2920 AS rid_1#2930, p_type_prf#2921 AS p_type_prf_1#2931, p_retailprice_prf#2922 AS p_retailprice_prf_1#2932, p_mfgr_prf#2923 AS p_mfgr_prf_1#2933, p_container_prf#2924 AS p_container_prf_1#2934, p_brand_prf#2925 AS p_brand_prf_1#2935, p_size_prf#2926 AS p_size_prf_1#2936, p_partkey_prf#2927 AS p_partkey_prf_1#2937]
         :     :     +- Relation[p_comment_prf#2918,p_name_prf#2919,rid#2920,p_type_prf#2921,p_retailprice_prf#2922,p_mfgr_prf#2923,p_container_prf#2924,p_brand_prf#2925,p_size_prf#2926,p_partkey_prf#2927] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2939 AS s_phone_prf_2#2947, rid#2940 AS rid_2#2948, s_address_prf#2941 AS s_address_prf_2#2949, s_nationkey_prf#2942 AS s_nationkey_prf_2#2950, s_suppkey_prf#2943 AS s_suppkey_prf_2#2951, s_name_prf#2944 AS s_name_prf_2#2952, s_acctbal_prf#2945 AS s_acctbal_prf_2#2953, s_comment_prf#2946 AS s_comment_prf_2#2954]
            +- Relation[s_phone_prf#2939,rid#2940,s_address_prf#2941,s_nationkey_prf#2942,s_suppkey_prf#2943,s_name_prf#2944,s_acctbal_prf#2945,s_comment_prf#2946] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 106566ms

f1=
select * from region where r_name = 'EUROPE'
19/10/14 13:09:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 13:09:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2986L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/14 13:09:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2986L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#2988 AS r_regionkey_prf_0#2992, r_name_prf#2989 AS r_name_prf_0#2993, r_comment_prf#2990 AS r_comment_prf_0#2994, rid#2991 AS rid_0#2995]
         :  +- Relation[r_regionkey_prf#2988,r_name_prf#2989,r_comment_prf#2990,rid#2991] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2996]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#2166,value#2167] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 54ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/14 13:09:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 13:09:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3011L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 13:09:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3011L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#3021]
         :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#3020: string
         :     :- Project [r_regionkey_prf#3013 AS r_regionkey_prf_0#3017, r_name_prf#3014 AS r_name_prf_0#3018, r_comment_prf#3015 AS r_comment_prf_0#3019, rid#3016 AS rid_0#3020]
         :     :  +- Relation[r_regionkey_prf#3013,r_name_prf#3014,r_comment_prf#3015,rid#3016] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#3022 AS rid_1#3027, n_regionkey_prf#3023 AS n_regionkey_prf_1#3028, n_nationkey_prf#3024 AS n_nationkey_prf_1#3029, n_name_prf#3025 AS n_name_prf_1#3030, n_comment_prf#3026 AS n_comment_prf_1#3031]
            +- Relation[rid#3022,n_regionkey_prf#3023,n_nationkey_prf#3024,n_name_prf#3025,n_comment_prf#3026] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=25
Elapsed time: 68ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/14 13:09:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 13:09:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3077L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 13:09:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3077L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1515) AS rid_2#3118]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#3097]
         :     :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3089: string
         :     :  :     :- Project [c_acctbal_prf#3079 AS c_acctbal_prf_0#3088, rid#3080 AS rid_0#3089, c_name_prf#3081 AS c_name_prf_0#3090, c_nationkey_prf#3082 AS c_nationkey_prf_0#3091, c_custkey_prf#3083 AS c_custkey_prf_0#3092, c_comment_prf#3084 AS c_comment_prf_0#3093, c_address_prf#3085 AS c_address_prf_0#3094, c_mktsegment_prf#3086 AS c_mktsegment_prf_0#3095, c_phone_prf#3087 AS c_phone_prf_0#3096]
         :     :  :     :  +- Relation[c_acctbal_prf#3079,rid#3080,c_name_prf#3081,c_nationkey_prf#3082,c_custkey_prf#3083,c_comment_prf#3084,c_address_prf#3085,c_mktsegment_prf#3086,c_phone_prf#3087] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#3098 AS o_shippriority_prf_1#3108, rid#3099 AS rid_1#3109, o_orderdate_prf#3100 AS o_orderdate_prf_1#3110, o_custkey_prf#3101 AS o_custkey_prf_1#3111, o_orderpriority_prf#3102 AS o_orderpriority_prf_1#3112, o_clerk_prf#3103 AS o_clerk_prf_1#3113, o_orderstatus_prf#3104 AS o_orderstatus_prf_1#3114, o_totalprice_prf#3105 AS o_totalprice_prf_1#3115, o_orderkey_prf#3106 AS o_orderkey_prf_1#3116, o_comment_prf#3107 AS o_comment_prf_1#3117]
         :     :     +- Relation[o_shippriority_prf#3098,rid#3099,o_orderdate_prf#3100,o_custkey_prf#3101,o_orderpriority_prf#3102,o_clerk_prf#3103,o_orderstatus_prf#3104,o_totalprice_prf#3105,o_orderkey_prf#3106,o_comment_prf#3107] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3119 AS l_returnflag_prf_2#3138, l_orderkey_and_l_linenumber_prf#3120 AS l_orderkey_and_l_linenumber_prf_2#3139, l_comment_prf#3121 AS l_comment_prf_2#3140, l_linestatus_prf#3122 AS l_linestatus_prf_2#3141, rid#3123 AS rid_2#3142, l_shipmode_prf#3124 AS l_shipmode_prf_2#3143, l_shipinstruct_prf#3125 AS l_shipinstruct_prf_2#3144, l_quantity_prf#3126 AS l_quantity_prf_2#3145, l_receiptdate_prf#3127 AS l_receiptdate_prf_2#3146, l_linenumber_prf#3128 AS l_linenumber_prf_2#3147, l_tax_prf#3129 AS l_tax_prf_2#3148, l_shipdate_prf#3130 AS l_shipdate_prf_2#3149, l_extendedprice_prf#3131 AS l_extendedprice_prf_2#3150, l_partkey_prf#3132 AS l_partkey_prf_2#3151, l_discount_prf#3133 AS l_discount_prf_2#3152, l_partkey_and_l_suppkey_prf#3134 AS l_partkey_and_l_suppkey_prf_2#3153, l_commitdate_prf#3135 AS l_commitdate_prf_2#3154, l_suppkey_prf#3136 AS l_suppkey_prf_2#3155, l_orderkey_prf#3137 AS l_orderkey_prf_2#3156]
            +- Relation[l_returnflag_prf#3119,l_orderkey_and_l_linenumber_prf#3120,l_comment_prf#3121,l_linestatus_prf#3122,rid#3123,l_shipmode_prf#3124,l_shipinstruct_prf#3125,l_quantity_prf#3126,l_receiptdate_prf#3127,l_linenumber_prf#3128,l_tax_prf#3129,l_shipdate_prf#3130,l_extendedprice_prf#3131,l_partkey_prf#3132,l_discount_prf#3133,l_partkey_and_l_suppkey_prf#3134,l_commitdate_prf#3135,l_suppkey_prf#3136,l_orderkey_prf#3137] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 270431ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/14 13:13:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 13:13:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3217L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 13:13:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3217L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#1515) AS rid_2#3246]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#3235]
         :     :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#3228: string
         :     :  :     :- Project [s_phone_prf#3219 AS s_phone_prf_0#3227, rid#3220 AS rid_0#3228, s_address_prf#3221 AS s_address_prf_0#3229, s_nationkey_prf#3222 AS s_nationkey_prf_0#3230, s_suppkey_prf#3223 AS s_suppkey_prf_0#3231, s_name_prf#3224 AS s_name_prf_0#3232, s_acctbal_prf#3225 AS s_acctbal_prf_0#3233, s_comment_prf#3226 AS s_comment_prf_0#3234]
         :     :  :     :  +- Relation[s_phone_prf#3219,rid#3220,s_address_prf#3221,s_nationkey_prf#3222,s_suppkey_prf#3223,s_name_prf#3224,s_acctbal_prf#3225,s_comment_prf#3226] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [rid#3236 AS rid_1#3241, n_regionkey_prf#3237 AS n_regionkey_prf_1#3242, n_nationkey_prf#3238 AS n_nationkey_prf_1#3243, n_name_prf#3239 AS n_name_prf_1#3244, n_comment_prf#3240 AS n_comment_prf_1#3245]
         :     :     +- Relation[rid#3236,n_regionkey_prf#3237,n_nationkey_prf#3238,n_name_prf#3239,n_comment_prf#3240] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3247 AS c_acctbal_prf_2#3256, rid#3248 AS rid_2#3257, c_name_prf#3249 AS c_name_prf_2#3258, c_nationkey_prf#3250 AS c_nationkey_prf_2#3259, c_custkey_prf#3251 AS c_custkey_prf_2#3260, c_comment_prf#3252 AS c_comment_prf_2#3261, c_address_prf#3253 AS c_address_prf_2#3262, c_mktsegment_prf#3254 AS c_mktsegment_prf_2#3263, c_phone_prf#3255 AS c_phone_prf_2#3264]
            +- Relation[c_acctbal_prf#3247,rid#3248,c_name_prf#3249,c_nationkey_prf#3250,c_custkey_prf#3251,c_comment_prf#3252,c_address_prf#3253,c_mktsegment_prf#3254,c_phone_prf#3255] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 686397ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/14 13:25:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 13:25:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3294L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 13:25:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3294L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#3296 AS rid_0#3301, n_regionkey_prf#3297 AS n_regionkey_prf_0#3302, n_nationkey_prf#3298 AS n_nationkey_prf_0#3303, n_name_prf#3299 AS n_name_prf_0#3304, n_comment_prf#3300 AS n_comment_prf_0#3305]
         :  +- Relation[rid#3296,n_regionkey_prf#3297,n_nationkey_prf#3298,n_name_prf#3299,n_comment_prf#3300] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3306]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#2166,value#2167] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 57ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/14 13:25:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 13:25:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3348L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 13:25:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3348L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_2#3368]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3360: string
         :     :- Project [c_acctbal_prf#3350 AS c_acctbal_prf_0#3359, rid#3351 AS rid_0#3360, c_name_prf#3352 AS c_name_prf_0#3361, c_nationkey_prf#3353 AS c_nationkey_prf_0#3362, c_custkey_prf#3354 AS c_custkey_prf_0#3363, c_comment_prf#3355 AS c_comment_prf_0#3364, c_address_prf#3356 AS c_address_prf_0#3365, c_mktsegment_prf#3357 AS c_mktsegment_prf_0#3366, c_phone_prf#3358 AS c_phone_prf_0#3367]
         :     :  +- Relation[c_acctbal_prf#3350,rid#3351,c_name_prf#3352,c_nationkey_prf#3353,c_custkey_prf#3354,c_comment_prf#3355,c_address_prf#3356,c_mktsegment_prf#3357,c_phone_prf#3358] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1515) AS rid_2#3407]
            :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_1#3392: string
            :     :- Project [l_returnflag_prf#3369 AS l_returnflag_prf_1#3388, l_orderkey_and_l_linenumber_prf#3370 AS l_orderkey_and_l_linenumber_prf_1#3389, l_comment_prf#3371 AS l_comment_prf_1#3390, l_linestatus_prf#3372 AS l_linestatus_prf_1#3391, rid#3373 AS rid_1#3392, l_shipmode_prf#3374 AS l_shipmode_prf_1#3393, l_shipinstruct_prf#3375 AS l_shipinstruct_prf_1#3394, l_quantity_prf#3376 AS l_quantity_prf_1#3395, l_receiptdate_prf#3377 AS l_receiptdate_prf_1#3396, l_linenumber_prf#3378 AS l_linenumber_prf_1#3397, l_tax_prf#3379 AS l_tax_prf_1#3398, l_shipdate_prf#3380 AS l_shipdate_prf_1#3399, l_extendedprice_prf#3381 AS l_extendedprice_prf_1#3400, l_partkey_prf#3382 AS l_partkey_prf_1#3401, l_discount_prf#3383 AS l_discount_prf_1#3402, l_partkey_and_l_suppkey_prf#3384 AS l_partkey_and_l_suppkey_prf_1#3403, l_commitdate_prf#3385 AS l_commitdate_prf_1#3404, l_suppkey_prf#3386 AS l_suppkey_prf_1#3405, l_orderkey_prf#3387 AS l_orderkey_prf_1#3406]
            :     :  +- Relation[l_returnflag_prf#3369,l_orderkey_and_l_linenumber_prf#3370,l_comment_prf#3371,l_linestatus_prf#3372,rid#3373,l_shipmode_prf#3374,l_shipinstruct_prf#3375,l_quantity_prf#3376,l_receiptdate_prf#3377,l_linenumber_prf#3378,l_tax_prf#3379,l_shipdate_prf#3380,l_extendedprice_prf#3381,l_partkey_prf#3382,l_discount_prf#3383,l_partkey_and_l_suppkey_prf#3384,l_commitdate_prf#3385,l_suppkey_prf#3386,l_orderkey_prf#3387] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3408 AS o_shippriority_prf_2#3418, rid#3409 AS rid_2#3419, o_orderdate_prf#3410 AS o_orderdate_prf_2#3420, o_custkey_prf#3411 AS o_custkey_prf_2#3421, o_orderpriority_prf#3412 AS o_orderpriority_prf_2#3422, o_clerk_prf#3413 AS o_clerk_prf_2#3423, o_orderstatus_prf#3414 AS o_orderstatus_prf_2#3424, o_totalprice_prf#3415 AS o_totalprice_prf_2#3425, o_orderkey_prf#3416 AS o_orderkey_prf_2#3426, o_comment_prf#3417 AS o_comment_prf_2#3427]
               +- Relation[o_shippriority_prf#3408,rid#3409,o_orderdate_prf#3410,o_custkey_prf#3411,o_orderpriority_prf#3412,o_clerk_prf#3413,o_orderstatus_prf#3414,o_totalprice_prf#3415,o_orderkey_prf#3416,o_comment_prf#3417] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 157042ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/14 13:27:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 13:27:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3485L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 13:27:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3485L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#3487 AS l_returnflag_prf_0#3506, l_orderkey_and_l_linenumber_prf#3488 AS l_orderkey_and_l_linenumber_prf_0#3507, l_comment_prf#3489 AS l_comment_prf_0#3508, l_linestatus_prf#3490 AS l_linestatus_prf_0#3509, rid#3491 AS rid_0#3510, l_shipmode_prf#3492 AS l_shipmode_prf_0#3511, l_shipinstruct_prf#3493 AS l_shipinstruct_prf_0#3512, l_quantity_prf#3494 AS l_quantity_prf_0#3513, l_receiptdate_prf#3495 AS l_receiptdate_prf_0#3514, l_linenumber_prf#3496 AS l_linenumber_prf_0#3515, l_tax_prf#3497 AS l_tax_prf_0#3516, l_shipdate_prf#3498 AS l_shipdate_prf_0#3517, l_extendedprice_prf#3499 AS l_extendedprice_prf_0#3518, l_partkey_prf#3500 AS l_partkey_prf_0#3519, l_discount_prf#3501 AS l_discount_prf_0#3520, l_partkey_and_l_suppkey_prf#3502 AS l_partkey_and_l_suppkey_prf_0#3521, l_commitdate_prf#3503 AS l_commitdate_prf_0#3522, l_suppkey_prf#3504 AS l_suppkey_prf_0#3523, l_orderkey_prf#3505 AS l_orderkey_prf_0#3524]
         :  +- Relation[l_returnflag_prf#3487,l_orderkey_and_l_linenumber_prf#3488,l_comment_prf#3489,l_linestatus_prf#3490,rid#3491,l_shipmode_prf#3492,l_shipinstruct_prf#3493,l_quantity_prf#3494,l_receiptdate_prf#3495,l_linenumber_prf#3496,l_tax_prf#3497,l_shipdate_prf#3498,l_extendedprice_prf#3499,l_partkey_prf#3500,l_discount_prf#3501,l_partkey_and_l_suppkey_prf#3502,l_commitdate_prf#3503,l_suppkey_prf#3504,l_orderkey_prf#3505] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3525]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#2166,value#2167] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 14365ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/14 13:28:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 13:28:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3573L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 13:28:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3573L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#3595]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#3586: string
         :     :- Project [o_shippriority_prf#3575 AS o_shippriority_prf_0#3585, rid#3576 AS rid_0#3586, o_orderdate_prf#3577 AS o_orderdate_prf_0#3587, o_custkey_prf#3578 AS o_custkey_prf_0#3588, o_orderpriority_prf#3579 AS o_orderpriority_prf_0#3589, o_clerk_prf#3580 AS o_clerk_prf_0#3590, o_orderstatus_prf#3581 AS o_orderstatus_prf_0#3591, o_totalprice_prf#3582 AS o_totalprice_prf_0#3592, o_orderkey_prf#3583 AS o_orderkey_prf_0#3593, o_comment_prf#3584 AS o_comment_prf_0#3594]
         :     :  +- Relation[o_shippriority_prf#3575,rid#3576,o_orderdate_prf#3577,o_custkey_prf#3578,o_orderpriority_prf#3579,o_clerk_prf#3580,o_orderstatus_prf#3581,o_totalprice_prf#3582,o_orderkey_prf#3583,o_comment_prf#3584] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#3596 AS l_returnflag_prf_1#3615, l_orderkey_and_l_linenumber_prf#3597 AS l_orderkey_and_l_linenumber_prf_1#3616, l_comment_prf#3598 AS l_comment_prf_1#3617, l_linestatus_prf#3599 AS l_linestatus_prf_1#3618, rid#3600 AS rid_1#3619, l_shipmode_prf#3601 AS l_shipmode_prf_1#3620, l_shipinstruct_prf#3602 AS l_shipinstruct_prf_1#3621, l_quantity_prf#3603 AS l_quantity_prf_1#3622, l_receiptdate_prf#3604 AS l_receiptdate_prf_1#3623, l_linenumber_prf#3605 AS l_linenumber_prf_1#3624, l_tax_prf#3606 AS l_tax_prf_1#3625, l_shipdate_prf#3607 AS l_shipdate_prf_1#3626, l_extendedprice_prf#3608 AS l_extendedprice_prf_1#3627, l_partkey_prf#3609 AS l_partkey_prf_1#3628, l_discount_prf#3610 AS l_discount_prf_1#3629, l_partkey_and_l_suppkey_prf#3611 AS l_partkey_and_l_suppkey_prf_1#3630, l_commitdate_prf#3612 AS l_commitdate_prf_1#3631, l_suppkey_prf#3613 AS l_suppkey_prf_1#3632, l_orderkey_prf#3614 AS l_orderkey_prf_1#3633]
            :  +- Relation[l_returnflag_prf#3596,l_orderkey_and_l_linenumber_prf#3597,l_comment_prf#3598,l_linestatus_prf#3599,rid#3600,l_shipmode_prf#3601,l_shipinstruct_prf#3602,l_quantity_prf#3603,l_receiptdate_prf#3604,l_linenumber_prf#3605,l_tax_prf#3606,l_shipdate_prf#3607,l_extendedprice_prf#3608,l_partkey_prf#3609,l_discount_prf#3610,l_partkey_and_l_suppkey_prf#3611,l_commitdate_prf#3612,l_suppkey_prf#3613,l_orderkey_prf#3614] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3634]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#2166,value#2167] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 197788ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/14 13:31:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 13:31:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3692L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 13:31:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3692L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#3732]
         :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#3717: string
         :     :- Project [l_returnflag_prf#3694 AS l_returnflag_prf_0#3713, l_orderkey_and_l_linenumber_prf#3695 AS l_orderkey_and_l_linenumber_prf_0#3714, l_comment_prf#3696 AS l_comment_prf_0#3715, l_linestatus_prf#3697 AS l_linestatus_prf_0#3716, rid#3698 AS rid_0#3717, l_shipmode_prf#3699 AS l_shipmode_prf_0#3718, l_shipinstruct_prf#3700 AS l_shipinstruct_prf_0#3719, l_quantity_prf#3701 AS l_quantity_prf_0#3720, l_receiptdate_prf#3702 AS l_receiptdate_prf_0#3721, l_linenumber_prf#3703 AS l_linenumber_prf_0#3722, l_tax_prf#3704 AS l_tax_prf_0#3723, l_shipdate_prf#3705 AS l_shipdate_prf_0#3724, l_extendedprice_prf#3706 AS l_extendedprice_prf_0#3725, l_partkey_prf#3707 AS l_partkey_prf_0#3726, l_discount_prf#3708 AS l_discount_prf_0#3727, l_partkey_and_l_suppkey_prf#3709 AS l_partkey_and_l_suppkey_prf_0#3728, l_commitdate_prf#3710 AS l_commitdate_prf_0#3729, l_suppkey_prf#3711 AS l_suppkey_prf_0#3730, l_orderkey_prf#3712 AS l_orderkey_prf_0#3731]
         :     :  +- Relation[l_returnflag_prf#3694,l_orderkey_and_l_linenumber_prf#3695,l_comment_prf#3696,l_linestatus_prf#3697,rid#3698,l_shipmode_prf#3699,l_shipinstruct_prf#3700,l_quantity_prf#3701,l_receiptdate_prf#3702,l_linenumber_prf#3703,l_tax_prf#3704,l_shipdate_prf#3705,l_extendedprice_prf#3706,l_partkey_prf#3707,l_discount_prf#3708,l_partkey_and_l_suppkey_prf#3709,l_commitdate_prf#3710,l_suppkey_prf#3711,l_orderkey_prf#3712] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#3733 AS p_comment_prf_1#3743, p_name_prf#3734 AS p_name_prf_1#3744, rid#3735 AS rid_1#3745, p_type_prf#3736 AS p_type_prf_1#3746, p_retailprice_prf#3737 AS p_retailprice_prf_1#3747, p_mfgr_prf#3738 AS p_mfgr_prf_1#3748, p_container_prf#3739 AS p_container_prf_1#3749, p_brand_prf#3740 AS p_brand_prf_1#3750, p_size_prf#3741 AS p_size_prf_1#3751, p_partkey_prf#3742 AS p_partkey_prf_1#3752]
            +- Relation[p_comment_prf#3733,p_name_prf#3734,rid#3735,p_type_prf#3736,p_retailprice_prf#3737,p_mfgr_prf#3738,p_container_prf#3739,p_brand_prf#3740,p_size_prf#3741,p_partkey_prf#3742] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 116987ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/14 13:33:19 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 13:33:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3806L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 13:33:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3806L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#3822]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, rid_0#3816: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#3808 AS ps_partkey_and_ps_suppkey_prf_0#3815, rid#3809 AS rid_0#3816, ps_availqty_prf#3810 AS ps_availqty_prf_0#3817, ps_comment_prf#3811 AS ps_comment_prf_0#3818, ps_partkey_prf#3812 AS ps_partkey_prf_0#3819, ps_supplycost_prf#3813 AS ps_supplycost_prf_0#3820, ps_suppkey_prf#3814 AS ps_suppkey_prf_0#3821]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#3808,rid#3809,ps_availqty_prf#3810,ps_comment_prf#3811,ps_partkey_prf#3812,ps_supplycost_prf#3813,ps_suppkey_prf#3814] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3823 AS l_returnflag_prf_1#3842, l_orderkey_and_l_linenumber_prf#3824 AS l_orderkey_and_l_linenumber_prf_1#3843, l_comment_prf#3825 AS l_comment_prf_1#3844, l_linestatus_prf#3826 AS l_linestatus_prf_1#3845, rid#3827 AS rid_1#3846, l_shipmode_prf#3828 AS l_shipmode_prf_1#3847, l_shipinstruct_prf#3829 AS l_shipinstruct_prf_1#3848, l_quantity_prf#3830 AS l_quantity_prf_1#3849, l_receiptdate_prf#3831 AS l_receiptdate_prf_1#3850, l_linenumber_prf#3832 AS l_linenumber_prf_1#3851, l_tax_prf#3833 AS l_tax_prf_1#3852, l_shipdate_prf#3834 AS l_shipdate_prf_1#3853, l_extendedprice_prf#3835 AS l_extendedprice_prf_1#3854, l_partkey_prf#3836 AS l_partkey_prf_1#3855, l_discount_prf#3837 AS l_discount_prf_1#3856, l_partkey_and_l_suppkey_prf#3838 AS l_partkey_and_l_suppkey_prf_1#3857, l_commitdate_prf#3839 AS l_commitdate_prf_1#3858, l_suppkey_prf#3840 AS l_suppkey_prf_1#3859, l_orderkey_prf#3841 AS l_orderkey_prf_1#3860]
            +- Relation[l_returnflag_prf#3823,l_orderkey_and_l_linenumber_prf#3824,l_comment_prf#3825,l_linestatus_prf#3826,rid#3827,l_shipmode_prf#3828,l_shipinstruct_prf#3829,l_quantity_prf#3830,l_receiptdate_prf#3831,l_linenumber_prf#3832,l_tax_prf#3833,l_shipdate_prf#3834,l_extendedprice_prf#3835,l_partkey_prf#3836,l_discount_prf#3837,l_partkey_and_l_suppkey_prf#3838,l_commitdate_prf#3839,l_suppkey_prf#3840,l_orderkey_prf#3841] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 116618ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/14 13:35:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 13:35:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3913L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 13:35:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3913L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#3931]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#3924: string
         :     :- Project [s_phone_prf#3915 AS s_phone_prf_0#3923, rid#3916 AS rid_0#3924, s_address_prf#3917 AS s_address_prf_0#3925, s_nationkey_prf#3918 AS s_nationkey_prf_0#3926, s_suppkey_prf#3919 AS s_suppkey_prf_0#3927, s_name_prf#3920 AS s_name_prf_0#3928, s_acctbal_prf#3921 AS s_acctbal_prf_0#3929, s_comment_prf#3922 AS s_comment_prf_0#3930]
         :     :  +- Relation[s_phone_prf#3915,rid#3916,s_address_prf#3917,s_nationkey_prf#3918,s_suppkey_prf#3919,s_name_prf#3920,s_acctbal_prf#3921,s_comment_prf#3922] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3932 AS l_returnflag_prf_1#3951, l_orderkey_and_l_linenumber_prf#3933 AS l_orderkey_and_l_linenumber_prf_1#3952, l_comment_prf#3934 AS l_comment_prf_1#3953, l_linestatus_prf#3935 AS l_linestatus_prf_1#3954, rid#3936 AS rid_1#3955, l_shipmode_prf#3937 AS l_shipmode_prf_1#3956, l_shipinstruct_prf#3938 AS l_shipinstruct_prf_1#3957, l_quantity_prf#3939 AS l_quantity_prf_1#3958, l_receiptdate_prf#3940 AS l_receiptdate_prf_1#3959, l_linenumber_prf#3941 AS l_linenumber_prf_1#3960, l_tax_prf#3942 AS l_tax_prf_1#3961, l_shipdate_prf#3943 AS l_shipdate_prf_1#3962, l_extendedprice_prf#3944 AS l_extendedprice_prf_1#3963, l_partkey_prf#3945 AS l_partkey_prf_1#3964, l_discount_prf#3946 AS l_discount_prf_1#3965, l_partkey_and_l_suppkey_prf#3947 AS l_partkey_and_l_suppkey_prf_1#3966, l_commitdate_prf#3948 AS l_commitdate_prf_1#3967, l_suppkey_prf#3949 AS l_suppkey_prf_1#3968, l_orderkey_prf#3950 AS l_orderkey_prf_1#3969]
            +- Relation[l_returnflag_prf#3932,l_orderkey_and_l_linenumber_prf#3933,l_comment_prf#3934,l_linestatus_prf#3935,rid#3936,l_shipmode_prf#3937,l_shipinstruct_prf#3938,l_quantity_prf#3939,l_receiptdate_prf#3940,l_linenumber_prf#3941,l_tax_prf#3942,l_shipdate_prf#3943,l_extendedprice_prf#3944,l_partkey_prf#3945,l_discount_prf#3946,l_partkey_and_l_suppkey_prf#3947,l_commitdate_prf#3948,l_suppkey_prf#3949,l_orderkey_prf#3950] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 86663ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/14 13:36:43 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 13:36:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4019L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 13:36:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4019L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1515) AS rid_2#4048]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#4031]
         :     :  :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#4026: string
         :     :  :     :- Project [rid#4021 AS rid_0#4026, n_regionkey_prf#4022 AS n_regionkey_prf_0#4027, n_nationkey_prf#4023 AS n_nationkey_prf_0#4028, n_name_prf#4024 AS n_name_prf_0#4029, n_comment_prf#4025 AS n_comment_prf_0#4030]
         :     :  :     :  +- Relation[rid#4021,n_regionkey_prf#4022,n_nationkey_prf#4023,n_name_prf#4024,n_comment_prf#4025] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#4032 AS s_phone_prf_1#4040, rid#4033 AS rid_1#4041, s_address_prf#4034 AS s_address_prf_1#4042, s_nationkey_prf#4035 AS s_nationkey_prf_1#4043, s_suppkey_prf#4036 AS s_suppkey_prf_1#4044, s_name_prf#4037 AS s_name_prf_1#4045, s_acctbal_prf#4038 AS s_acctbal_prf_1#4046, s_comment_prf#4039 AS s_comment_prf_1#4047]
         :     :     +- Relation[s_phone_prf#4032,rid#4033,s_address_prf#4034,s_nationkey_prf#4035,s_suppkey_prf#4036,s_name_prf#4037,s_acctbal_prf#4038,s_comment_prf#4039] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4049 AS c_acctbal_prf_2#4058, rid#4050 AS rid_2#4059, c_name_prf#4051 AS c_name_prf_2#4060, c_nationkey_prf#4052 AS c_nationkey_prf_2#4061, c_custkey_prf#4053 AS c_custkey_prf_2#4062, c_comment_prf#4054 AS c_comment_prf_2#4063, c_address_prf#4055 AS c_address_prf_2#4064, c_mktsegment_prf#4056 AS c_mktsegment_prf_2#4065, c_phone_prf#4057 AS c_phone_prf_2#4066]
            +- Relation[c_acctbal_prf#4049,rid#4050,c_name_prf#4051,c_nationkey_prf#4052,c_custkey_prf#4053,c_comment_prf#4054,c_address_prf#4055,c_mktsegment_prf#4056,c_phone_prf#4057] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 776406ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/14 13:49:39 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 13:49:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4117L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 13:49:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4117L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#4157]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4142: string
         :     :- Project [l_returnflag_prf#4119 AS l_returnflag_prf_0#4138, l_orderkey_and_l_linenumber_prf#4120 AS l_orderkey_and_l_linenumber_prf_0#4139, l_comment_prf#4121 AS l_comment_prf_0#4140, l_linestatus_prf#4122 AS l_linestatus_prf_0#4141, rid#4123 AS rid_0#4142, l_shipmode_prf#4124 AS l_shipmode_prf_0#4143, l_shipinstruct_prf#4125 AS l_shipinstruct_prf_0#4144, l_quantity_prf#4126 AS l_quantity_prf_0#4145, l_receiptdate_prf#4127 AS l_receiptdate_prf_0#4146, l_linenumber_prf#4128 AS l_linenumber_prf_0#4147, l_tax_prf#4129 AS l_tax_prf_0#4148, l_shipdate_prf#4130 AS l_shipdate_prf_0#4149, l_extendedprice_prf#4131 AS l_extendedprice_prf_0#4150, l_partkey_prf#4132 AS l_partkey_prf_0#4151, l_discount_prf#4133 AS l_discount_prf_0#4152, l_partkey_and_l_suppkey_prf#4134 AS l_partkey_and_l_suppkey_prf_0#4153, l_commitdate_prf#4135 AS l_commitdate_prf_0#4154, l_suppkey_prf#4136 AS l_suppkey_prf_0#4155, l_orderkey_prf#4137 AS l_orderkey_prf_0#4156]
         :     :  +- Relation[l_returnflag_prf#4119,l_orderkey_and_l_linenumber_prf#4120,l_comment_prf#4121,l_linestatus_prf#4122,rid#4123,l_shipmode_prf#4124,l_shipinstruct_prf#4125,l_quantity_prf#4126,l_receiptdate_prf#4127,l_linenumber_prf#4128,l_tax_prf#4129,l_shipdate_prf#4130,l_extendedprice_prf#4131,l_partkey_prf#4132,l_discount_prf#4133,l_partkey_and_l_suppkey_prf#4134,l_commitdate_prf#4135,l_suppkey_prf#4136,l_orderkey_prf#4137] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4158 AS o_shippriority_prf_1#4168, rid#4159 AS rid_1#4169, o_orderdate_prf#4160 AS o_orderdate_prf_1#4170, o_custkey_prf#4161 AS o_custkey_prf_1#4171, o_orderpriority_prf#4162 AS o_orderpriority_prf_1#4172, o_clerk_prf#4163 AS o_clerk_prf_1#4173, o_orderstatus_prf#4164 AS o_orderstatus_prf_1#4174, o_totalprice_prf#4165 AS o_totalprice_prf_1#4175, o_orderkey_prf#4166 AS o_orderkey_prf_1#4176, o_comment_prf#4167 AS o_comment_prf_1#4177]
            +- Relation[o_shippriority_prf#4158,rid#4159,o_orderdate_prf#4160,o_custkey_prf#4161,o_orderpriority_prf#4162,o_clerk_prf#4163,o_orderstatus_prf#4164,o_totalprice_prf#4165,o_orderkey_prf#4166,o_comment_prf#4167] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 114266ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/14 13:51:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 13:51:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4227L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 13:51:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4227L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#4247]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4239: string
         :     :- Project [c_acctbal_prf#4229 AS c_acctbal_prf_0#4238, rid#4230 AS rid_0#4239, c_name_prf#4231 AS c_name_prf_0#4240, c_nationkey_prf#4232 AS c_nationkey_prf_0#4241, c_custkey_prf#4233 AS c_custkey_prf_0#4242, c_comment_prf#4234 AS c_comment_prf_0#4243, c_address_prf#4235 AS c_address_prf_0#4244, c_mktsegment_prf#4236 AS c_mktsegment_prf_0#4245, c_phone_prf#4237 AS c_phone_prf_0#4246]
         :     :  +- Relation[c_acctbal_prf#4229,rid#4230,c_name_prf#4231,c_nationkey_prf#4232,c_custkey_prf#4233,c_comment_prf#4234,c_address_prf#4235,c_mktsegment_prf#4236,c_phone_prf#4237] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4248 AS o_shippriority_prf_1#4258, rid#4249 AS rid_1#4259, o_orderdate_prf#4250 AS o_orderdate_prf_1#4260, o_custkey_prf#4251 AS o_custkey_prf_1#4261, o_orderpriority_prf#4252 AS o_orderpriority_prf_1#4262, o_clerk_prf#4253 AS o_clerk_prf_1#4263, o_orderstatus_prf#4254 AS o_orderstatus_prf_1#4264, o_totalprice_prf#4255 AS o_totalprice_prf_1#4265, o_orderkey_prf#4256 AS o_orderkey_prf_1#4266, o_comment_prf#4257 AS o_comment_prf_1#4267]
            +- Relation[o_shippriority_prf#4248,rid#4249,o_orderdate_prf#4250,o_custkey_prf#4251,o_orderpriority_prf#4252,o_clerk_prf#4253,o_orderstatus_prf#4254,o_totalprice_prf#4255,o_orderkey_prf#4256,o_comment_prf#4257] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1500000
Elapsed time: 40262ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/14 13:52:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 13:52:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4322L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 13:52:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4322L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#4362]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#4347: string
         :     :  :     :- Project [l_returnflag_prf#4324 AS l_returnflag_prf_0#4343, l_orderkey_and_l_linenumber_prf#4325 AS l_orderkey_and_l_linenumber_prf_0#4344, l_comment_prf#4326 AS l_comment_prf_0#4345, l_linestatus_prf#4327 AS l_linestatus_prf_0#4346, rid#4328 AS rid_0#4347, l_shipmode_prf#4329 AS l_shipmode_prf_0#4348, l_shipinstruct_prf#4330 AS l_shipinstruct_prf_0#4349, l_quantity_prf#4331 AS l_quantity_prf_0#4350, l_receiptdate_prf#4332 AS l_receiptdate_prf_0#4351, l_linenumber_prf#4333 AS l_linenumber_prf_0#4352, l_tax_prf#4334 AS l_tax_prf_0#4353, l_shipdate_prf#4335 AS l_shipdate_prf_0#4354, l_extendedprice_prf#4336 AS l_extendedprice_prf_0#4355, l_partkey_prf#4337 AS l_partkey_prf_0#4356, l_discount_prf#4338 AS l_discount_prf_0#4357, l_partkey_and_l_suppkey_prf#4339 AS l_partkey_and_l_suppkey_prf_0#4358, l_commitdate_prf#4340 AS l_commitdate_prf_0#4359, l_suppkey_prf#4341 AS l_suppkey_prf_0#4360, l_orderkey_prf#4342 AS l_orderkey_prf_0#4361]
         :     :  :     :  +- Relation[l_returnflag_prf#4324,l_orderkey_and_l_linenumber_prf#4325,l_comment_prf#4326,l_linestatus_prf#4327,rid#4328,l_shipmode_prf#4329,l_shipinstruct_prf#4330,l_quantity_prf#4331,l_receiptdate_prf#4332,l_linenumber_prf#4333,l_tax_prf#4334,l_shipdate_prf#4335,l_extendedprice_prf#4336,l_partkey_prf#4337,l_discount_prf#4338,l_partkey_and_l_suppkey_prf#4339,l_commitdate_prf#4340,l_suppkey_prf#4341,l_orderkey_prf#4342] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#4363 AS p_comment_prf_1#4373, p_name_prf#4364 AS p_name_prf_1#4374, rid#4365 AS rid_1#4375, p_type_prf#4366 AS p_type_prf_1#4376, p_retailprice_prf#4367 AS p_retailprice_prf_1#4377, p_mfgr_prf#4368 AS p_mfgr_prf_1#4378, p_container_prf#4369 AS p_container_prf_1#4379, p_brand_prf#4370 AS p_brand_prf_1#4380, p_size_prf#4371 AS p_size_prf_1#4381, p_partkey_prf#4372 AS p_partkey_prf_1#4382]
         :     :     +- Relation[p_comment_prf#4363,p_name_prf#4364,rid#4365,p_type_prf#4366,p_retailprice_prf#4367,p_mfgr_prf#4368,p_container_prf#4369,p_brand_prf#4370,p_size_prf#4371,p_partkey_prf#4372] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4384 AS s_phone_prf_2#4392, rid#4385 AS rid_2#4393, s_address_prf#4386 AS s_address_prf_2#4394, s_nationkey_prf#4387 AS s_nationkey_prf_2#4395, s_suppkey_prf#4388 AS s_suppkey_prf_2#4396, s_name_prf#4389 AS s_name_prf_2#4397, s_acctbal_prf#4390 AS s_acctbal_prf_2#4398, s_comment_prf#4391 AS s_comment_prf_2#4399]
            +- Relation[s_phone_prf#4384,rid#4385,s_address_prf#4386,s_nationkey_prf#4387,s_suppkey_prf#4388,s_name_prf#4389,s_acctbal_prf#4390,s_comment_prf#4391] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 263854ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/14 13:56:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 13:56:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4465L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 13:56:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4465L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#4506]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4490: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#4467 AS l_returnflag_prf_0#4486, l_orderkey_and_l_linenumber_prf#4468 AS l_orderkey_and_l_linenumber_prf_0#4487, l_comment_prf#4469 AS l_comment_prf_0#4488, l_linestatus_prf#4470 AS l_linestatus_prf_0#4489, rid#4471 AS rid_0#4490, l_shipmode_prf#4472 AS l_shipmode_prf_0#4491, l_shipinstruct_prf#4473 AS l_shipinstruct_prf_0#4492, l_quantity_prf#4474 AS l_quantity_prf_0#4493, l_receiptdate_prf#4475 AS l_receiptdate_prf_0#4494, l_linenumber_prf#4476 AS l_linenumber_prf_0#4495, l_tax_prf#4477 AS l_tax_prf_0#4496, l_shipdate_prf#4478 AS l_shipdate_prf_0#4497, l_extendedprice_prf#4479 AS l_extendedprice_prf_0#4498, l_partkey_prf#4480 AS l_partkey_prf_0#4499, l_discount_prf#4481 AS l_discount_prf_0#4500, l_partkey_and_l_suppkey_prf#4482 AS l_partkey_and_l_suppkey_prf_0#4501, l_commitdate_prf#4483 AS l_commitdate_prf_0#4502, l_suppkey_prf#4484 AS l_suppkey_prf_0#4503, l_orderkey_prf#4485 AS l_orderkey_prf_0#4504]
         :     :  :  +- Relation[l_returnflag_prf#4467,l_orderkey_and_l_linenumber_prf#4468,l_comment_prf#4469,l_linestatus_prf#4470,rid#4471,l_shipmode_prf#4472,l_shipinstruct_prf#4473,l_quantity_prf#4474,l_receiptdate_prf#4475,l_linenumber_prf#4476,l_tax_prf#4477,l_shipdate_prf#4478,l_extendedprice_prf#4479,l_partkey_prf#4480,l_discount_prf#4481,l_partkey_and_l_suppkey_prf#4482,l_commitdate_prf#4483,l_suppkey_prf#4484,l_orderkey_prf#4485] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4505]
         :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :        +- Relation[label#2166,value#2167] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4507 AS o_shippriority_prf_1#4517, rid#4508 AS rid_1#4518, o_orderdate_prf#4509 AS o_orderdate_prf_1#4519, o_custkey_prf#4510 AS o_custkey_prf_1#4520, o_orderpriority_prf#4511 AS o_orderpriority_prf_1#4521, o_clerk_prf#4512 AS o_clerk_prf_1#4522, o_orderstatus_prf#4513 AS o_orderstatus_prf_1#4523, o_totalprice_prf#4514 AS o_totalprice_prf_1#4524, o_orderkey_prf#4515 AS o_orderkey_prf_1#4525, o_comment_prf#4516 AS o_comment_prf_1#4526]
            +- Relation[o_shippriority_prf#4507,rid#4508,o_orderdate_prf#4509,o_custkey_prf#4510,o_orderpriority_prf#4511,o_clerk_prf#4512,o_orderstatus_prf#4513,o_totalprice_prf#4514,o_orderkey_prf#4515,o_comment_prf#4516] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 54428ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/14 13:57:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 13:57:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4592L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 13:57:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4592L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#4612]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4604: string
         :     :- Project [c_acctbal_prf#4594 AS c_acctbal_prf_0#4603, rid#4595 AS rid_0#4604, c_name_prf#4596 AS c_name_prf_0#4605, c_nationkey_prf#4597 AS c_nationkey_prf_0#4606, c_custkey_prf#4598 AS c_custkey_prf_0#4607, c_comment_prf#4599 AS c_comment_prf_0#4608, c_address_prf#4600 AS c_address_prf_0#4609, c_mktsegment_prf#4601 AS c_mktsegment_prf_0#4610, c_phone_prf#4602 AS c_phone_prf_0#4611]
         :     :  +- Relation[c_acctbal_prf#4594,rid#4595,c_name_prf#4596,c_nationkey_prf#4597,c_custkey_prf#4598,c_comment_prf#4599,c_address_prf#4600,c_mktsegment_prf#4601,c_phone_prf#4602] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1515) AS rid_2#4633]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#4624: string
            :     :- Project [o_shippriority_prf#4613 AS o_shippriority_prf_1#4623, rid#4614 AS rid_1#4624, o_orderdate_prf#4615 AS o_orderdate_prf_1#4625, o_custkey_prf#4616 AS o_custkey_prf_1#4626, o_orderpriority_prf#4617 AS o_orderpriority_prf_1#4627, o_clerk_prf#4618 AS o_clerk_prf_1#4628, o_orderstatus_prf#4619 AS o_orderstatus_prf_1#4629, o_totalprice_prf#4620 AS o_totalprice_prf_1#4630, o_orderkey_prf#4621 AS o_orderkey_prf_1#4631, o_comment_prf#4622 AS o_comment_prf_1#4632]
            :     :  +- Relation[o_shippriority_prf#4613,rid#4614,o_orderdate_prf#4615,o_custkey_prf#4616,o_orderpriority_prf#4617,o_clerk_prf#4618,o_orderstatus_prf#4619,o_totalprice_prf#4620,o_orderkey_prf#4621,o_comment_prf#4622] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4634 AS l_returnflag_prf_2#4653, l_orderkey_and_l_linenumber_prf#4635 AS l_orderkey_and_l_linenumber_prf_2#4654, l_comment_prf#4636 AS l_comment_prf_2#4655, l_linestatus_prf#4637 AS l_linestatus_prf_2#4656, rid#4638 AS rid_2#4657, l_shipmode_prf#4639 AS l_shipmode_prf_2#4658, l_shipinstruct_prf#4640 AS l_shipinstruct_prf_2#4659, l_quantity_prf#4641 AS l_quantity_prf_2#4660, l_receiptdate_prf#4642 AS l_receiptdate_prf_2#4661, l_linenumber_prf#4643 AS l_linenumber_prf_2#4662, l_tax_prf#4644 AS l_tax_prf_2#4663, l_shipdate_prf#4645 AS l_shipdate_prf_2#4664, l_extendedprice_prf#4646 AS l_extendedprice_prf_2#4665, l_partkey_prf#4647 AS l_partkey_prf_2#4666, l_discount_prf#4648 AS l_discount_prf_2#4667, l_partkey_and_l_suppkey_prf#4649 AS l_partkey_and_l_suppkey_prf_2#4668, l_commitdate_prf#4650 AS l_commitdate_prf_2#4669, l_suppkey_prf#4651 AS l_suppkey_prf_2#4670, l_orderkey_prf#4652 AS l_orderkey_prf_2#4671]
               +- Relation[l_returnflag_prf#4634,l_orderkey_and_l_linenumber_prf#4635,l_comment_prf#4636,l_linestatus_prf#4637,rid#4638,l_shipmode_prf#4639,l_shipinstruct_prf#4640,l_quantity_prf#4641,l_receiptdate_prf#4642,l_linenumber_prf#4643,l_tax_prf#4644,l_shipdate_prf#4645,l_extendedprice_prf#4646,l_partkey_prf#4647,l_discount_prf#4648,l_partkey_and_l_suppkey_prf#4649,l_commitdate_prf#4650,l_suppkey_prf#4651,l_orderkey_prf#4652] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 233716ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/14 14:01:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:01:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4734L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 14:01:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4734L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#4752]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#4745: string
         :     :- Project [s_phone_prf#4736 AS s_phone_prf_0#4744, rid#4737 AS rid_0#4745, s_address_prf#4738 AS s_address_prf_0#4746, s_nationkey_prf#4739 AS s_nationkey_prf_0#4747, s_suppkey_prf#4740 AS s_suppkey_prf_0#4748, s_name_prf#4741 AS s_name_prf_0#4749, s_acctbal_prf#4742 AS s_acctbal_prf_0#4750, s_comment_prf#4743 AS s_comment_prf_0#4751]
         :     :  +- Relation[s_phone_prf#4736,rid#4737,s_address_prf#4738,s_nationkey_prf#4739,s_suppkey_prf#4740,s_name_prf#4741,s_acctbal_prf#4742,s_comment_prf#4743] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1515) AS rid_2#4767]
            :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_1#4761: string
            :     :- Project [ps_partkey_and_ps_suppkey_prf#4753 AS ps_partkey_and_ps_suppkey_prf_1#4760, rid#4754 AS rid_1#4761, ps_availqty_prf#4755 AS ps_availqty_prf_1#4762, ps_comment_prf#4756 AS ps_comment_prf_1#4763, ps_partkey_prf#4757 AS ps_partkey_prf_1#4764, ps_supplycost_prf#4758 AS ps_supplycost_prf_1#4765, ps_suppkey_prf#4759 AS ps_suppkey_prf_1#4766]
            :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#4753,rid#4754,ps_availqty_prf#4755,ps_comment_prf#4756,ps_partkey_prf#4757,ps_supplycost_prf#4758,ps_suppkey_prf#4759] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#4768 AS p_comment_prf_2#4778, p_name_prf#4769 AS p_name_prf_2#4779, rid#4770 AS rid_2#4780, p_type_prf#4771 AS p_type_prf_2#4781, p_retailprice_prf#4772 AS p_retailprice_prf_2#4782, p_mfgr_prf#4773 AS p_mfgr_prf_2#4783, p_container_prf#4774 AS p_container_prf_2#4784, p_brand_prf#4775 AS p_brand_prf_2#4785, p_size_prf#4776 AS p_size_prf_2#4786, p_partkey_prf#4777 AS p_partkey_prf_2#4787]
               +- Relation[p_comment_prf#4768,p_name_prf#4769,rid#4770,p_type_prf#4771,p_retailprice_prf#4772,p_mfgr_prf#4773,p_container_prf#4774,p_brand_prf#4775,p_size_prf#4776,p_partkey_prf#4777] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 61347ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/14 14:02:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:02:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4849L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 14:02:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4849L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#4889]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4874: string
         :     :- Project [l_returnflag_prf#4851 AS l_returnflag_prf_0#4870, l_orderkey_and_l_linenumber_prf#4852 AS l_orderkey_and_l_linenumber_prf_0#4871, l_comment_prf#4853 AS l_comment_prf_0#4872, l_linestatus_prf#4854 AS l_linestatus_prf_0#4873, rid#4855 AS rid_0#4874, l_shipmode_prf#4856 AS l_shipmode_prf_0#4875, l_shipinstruct_prf#4857 AS l_shipinstruct_prf_0#4876, l_quantity_prf#4858 AS l_quantity_prf_0#4877, l_receiptdate_prf#4859 AS l_receiptdate_prf_0#4878, l_linenumber_prf#4860 AS l_linenumber_prf_0#4879, l_tax_prf#4861 AS l_tax_prf_0#4880, l_shipdate_prf#4862 AS l_shipdate_prf_0#4881, l_extendedprice_prf#4863 AS l_extendedprice_prf_0#4882, l_partkey_prf#4864 AS l_partkey_prf_0#4883, l_discount_prf#4865 AS l_discount_prf_0#4884, l_partkey_and_l_suppkey_prf#4866 AS l_partkey_and_l_suppkey_prf_0#4885, l_commitdate_prf#4867 AS l_commitdate_prf_0#4886, l_suppkey_prf#4868 AS l_suppkey_prf_0#4887, l_orderkey_prf#4869 AS l_orderkey_prf_0#4888]
         :     :  +- Relation[l_returnflag_prf#4851,l_orderkey_and_l_linenumber_prf#4852,l_comment_prf#4853,l_linestatus_prf#4854,rid#4855,l_shipmode_prf#4856,l_shipinstruct_prf#4857,l_quantity_prf#4858,l_receiptdate_prf#4859,l_linenumber_prf#4860,l_tax_prf#4861,l_shipdate_prf#4862,l_extendedprice_prf#4863,l_partkey_prf#4864,l_discount_prf#4865,l_partkey_and_l_suppkey_prf#4866,l_commitdate_prf#4867,l_suppkey_prf#4868,l_orderkey_prf#4869] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1515) AS rid_2#4910]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#4901: string
            :     :- Project [o_shippriority_prf#4890 AS o_shippriority_prf_1#4900, rid#4891 AS rid_1#4901, o_orderdate_prf#4892 AS o_orderdate_prf_1#4902, o_custkey_prf#4893 AS o_custkey_prf_1#4903, o_orderpriority_prf#4894 AS o_orderpriority_prf_1#4904, o_clerk_prf#4895 AS o_clerk_prf_1#4905, o_orderstatus_prf#4896 AS o_orderstatus_prf_1#4906, o_totalprice_prf#4897 AS o_totalprice_prf_1#4907, o_orderkey_prf#4898 AS o_orderkey_prf_1#4908, o_comment_prf#4899 AS o_comment_prf_1#4909]
            :     :  +- Relation[o_shippriority_prf#4890,rid#4891,o_orderdate_prf#4892,o_custkey_prf#4893,o_orderpriority_prf#4894,o_clerk_prf#4895,o_orderstatus_prf#4896,o_totalprice_prf#4897,o_orderkey_prf#4898,o_comment_prf#4899] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4911 AS c_acctbal_prf_2#4920, rid#4912 AS rid_2#4921, c_name_prf#4913 AS c_name_prf_2#4922, c_nationkey_prf#4914 AS c_nationkey_prf_2#4923, c_custkey_prf#4915 AS c_custkey_prf_2#4924, c_comment_prf#4916 AS c_comment_prf_2#4925, c_address_prf#4917 AS c_address_prf_2#4926, c_mktsegment_prf#4918 AS c_mktsegment_prf_2#4927, c_phone_prf#4919 AS c_phone_prf_2#4928]
               +- Relation[c_acctbal_prf#4911,rid#4912,c_name_prf#4913,c_nationkey_prf#4914,c_custkey_prf#4915,c_comment_prf#4916,c_address_prf#4917,c_mktsegment_prf#4918,c_phone_prf#4919] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 147897ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/14 14:04:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:04:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5002L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 14:04:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5002L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_2#5020]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#5013: string
         :     :- Project [s_phone_prf#5004 AS s_phone_prf_0#5012, rid#5005 AS rid_0#5013, s_address_prf#5006 AS s_address_prf_0#5014, s_nationkey_prf#5007 AS s_nationkey_prf_0#5015, s_suppkey_prf#5008 AS s_suppkey_prf_0#5016, s_name_prf#5009 AS s_name_prf_0#5017, s_acctbal_prf#5010 AS s_acctbal_prf_0#5018, s_comment_prf#5011 AS s_comment_prf_0#5019]
         :     :  +- Relation[s_phone_prf#5004,rid#5005,s_address_prf#5006,s_nationkey_prf#5007,s_suppkey_prf#5008,s_name_prf#5009,s_acctbal_prf#5010,s_comment_prf#5011] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1515) AS rid_2#5041]
            :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#5033: string
            :     :- Project [p_comment_prf#5021 AS p_comment_prf_1#5031, p_name_prf#5022 AS p_name_prf_1#5032, rid#5023 AS rid_1#5033, p_type_prf#5024 AS p_type_prf_1#5034, p_retailprice_prf#5025 AS p_retailprice_prf_1#5035, p_mfgr_prf#5026 AS p_mfgr_prf_1#5036, p_container_prf#5027 AS p_container_prf_1#5037, p_brand_prf#5028 AS p_brand_prf_1#5038, p_size_prf#5029 AS p_size_prf_1#5039, p_partkey_prf#5030 AS p_partkey_prf_1#5040]
            :     :  +- Relation[p_comment_prf#5021,p_name_prf#5022,rid#5023,p_type_prf#5024,p_retailprice_prf#5025,p_mfgr_prf#5026,p_container_prf#5027,p_brand_prf#5028,p_size_prf#5029,p_partkey_prf#5030] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#5042 AS l_returnflag_prf_2#5061, l_orderkey_and_l_linenumber_prf#5043 AS l_orderkey_and_l_linenumber_prf_2#5062, l_comment_prf#5044 AS l_comment_prf_2#5063, l_linestatus_prf#5045 AS l_linestatus_prf_2#5064, rid#5046 AS rid_2#5065, l_shipmode_prf#5047 AS l_shipmode_prf_2#5066, l_shipinstruct_prf#5048 AS l_shipinstruct_prf_2#5067, l_quantity_prf#5049 AS l_quantity_prf_2#5068, l_receiptdate_prf#5050 AS l_receiptdate_prf_2#5069, l_linenumber_prf#5051 AS l_linenumber_prf_2#5070, l_tax_prf#5052 AS l_tax_prf_2#5071, l_shipdate_prf#5053 AS l_shipdate_prf_2#5072, l_extendedprice_prf#5054 AS l_extendedprice_prf_2#5073, l_partkey_prf#5055 AS l_partkey_prf_2#5074, l_discount_prf#5056 AS l_discount_prf_2#5075, l_partkey_and_l_suppkey_prf#5057 AS l_partkey_and_l_suppkey_prf_2#5076, l_commitdate_prf#5058 AS l_commitdate_prf_2#5077, l_suppkey_prf#5059 AS l_suppkey_prf_2#5078, l_orderkey_prf#5060 AS l_orderkey_prf_2#5079]
               +- Relation[l_returnflag_prf#5042,l_orderkey_and_l_linenumber_prf#5043,l_comment_prf#5044,l_linestatus_prf#5045,rid#5046,l_shipmode_prf#5047,l_shipinstruct_prf#5048,l_quantity_prf#5049,l_receiptdate_prf#5050,l_linenumber_prf#5051,l_tax_prf#5052,l_shipdate_prf#5053,l_extendedprice_prf#5054,l_partkey_prf#5055,l_discount_prf#5056,l_partkey_and_l_suppkey_prf#5057,l_commitdate_prf#5058,l_suppkey_prf#5059,l_orderkey_prf#5060] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 188137ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/14 14:08:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:08:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5141L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 14:08:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5141L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_2#5159]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#5152: string
         :     :- Project [s_phone_prf#5143 AS s_phone_prf_0#5151, rid#5144 AS rid_0#5152, s_address_prf#5145 AS s_address_prf_0#5153, s_nationkey_prf#5146 AS s_nationkey_prf_0#5154, s_suppkey_prf#5147 AS s_suppkey_prf_0#5155, s_name_prf#5148 AS s_name_prf_0#5156, s_acctbal_prf#5149 AS s_acctbal_prf_0#5157, s_comment_prf#5150 AS s_comment_prf_0#5158]
         :     :  +- Relation[s_phone_prf#5143,rid#5144,s_address_prf#5145,s_nationkey_prf#5146,s_suppkey_prf#5147,s_name_prf#5148,s_acctbal_prf#5149,s_comment_prf#5150] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1515) AS rid_2#5180]
            :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#5172: string
            :     :- Project [p_comment_prf#5160 AS p_comment_prf_1#5170, p_name_prf#5161 AS p_name_prf_1#5171, rid#5162 AS rid_1#5172, p_type_prf#5163 AS p_type_prf_1#5173, p_retailprice_prf#5164 AS p_retailprice_prf_1#5174, p_mfgr_prf#5165 AS p_mfgr_prf_1#5175, p_container_prf#5166 AS p_container_prf_1#5176, p_brand_prf#5167 AS p_brand_prf_1#5177, p_size_prf#5168 AS p_size_prf_1#5178, p_partkey_prf#5169 AS p_partkey_prf_1#5179]
            :     :  +- Relation[p_comment_prf#5160,p_name_prf#5161,rid#5162,p_type_prf#5163,p_retailprice_prf#5164,p_mfgr_prf#5165,p_container_prf#5166,p_brand_prf#5167,p_size_prf#5168,p_partkey_prf#5169] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#5181 AS ps_partkey_and_ps_suppkey_prf_2#5188, rid#5182 AS rid_2#5189, ps_availqty_prf#5183 AS ps_availqty_prf_2#5190, ps_comment_prf#5184 AS ps_comment_prf_2#5191, ps_partkey_prf#5185 AS ps_partkey_prf_2#5192, ps_supplycost_prf#5186 AS ps_supplycost_prf_2#5193, ps_suppkey_prf#5187 AS ps_suppkey_prf_2#5194]
               +- Relation[ps_partkey_and_ps_suppkey_prf#5181,rid#5182,ps_availqty_prf#5183,ps_comment_prf#5184,ps_partkey_prf#5185,ps_supplycost_prf#5186,ps_suppkey_prf#5187] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 43016ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/14 14:08:46 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:08:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5248L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 14:08:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5248L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1515) AS rid_1#5270]
         :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#5262: string
         :     :- Project [p_comment_prf#5250 AS p_comment_prf_0#5260, p_name_prf#5251 AS p_name_prf_0#5261, rid#5252 AS rid_0#5262, p_type_prf#5253 AS p_type_prf_0#5263, p_retailprice_prf#5254 AS p_retailprice_prf_0#5264, p_mfgr_prf#5255 AS p_mfgr_prf_0#5265, p_container_prf#5256 AS p_container_prf_0#5266, p_brand_prf#5257 AS p_brand_prf_0#5267, p_size_prf#5258 AS p_size_prf_0#5268, p_partkey_prf#5259 AS p_partkey_prf_0#5269]
         :     :  +- Relation[p_comment_prf#5250,p_name_prf#5251,rid#5252,p_type_prf#5253,p_retailprice_prf#5254,p_mfgr_prf#5255,p_container_prf#5256,p_brand_prf#5257,p_size_prf#5258,p_partkey_prf#5259] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1514,value#1515] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5271 AS l_returnflag_prf_1#5290, l_orderkey_and_l_linenumber_prf#5272 AS l_orderkey_and_l_linenumber_prf_1#5291, l_comment_prf#5273 AS l_comment_prf_1#5292, l_linestatus_prf#5274 AS l_linestatus_prf_1#5293, rid#5275 AS rid_1#5294, l_shipmode_prf#5276 AS l_shipmode_prf_1#5295, l_shipinstruct_prf#5277 AS l_shipinstruct_prf_1#5296, l_quantity_prf#5278 AS l_quantity_prf_1#5297, l_receiptdate_prf#5279 AS l_receiptdate_prf_1#5298, l_linenumber_prf#5280 AS l_linenumber_prf_1#5299, l_tax_prf#5281 AS l_tax_prf_1#5300, l_shipdate_prf#5282 AS l_shipdate_prf_1#5301, l_extendedprice_prf#5283 AS l_extendedprice_prf_1#5302, l_partkey_prf#5284 AS l_partkey_prf_1#5303, l_discount_prf#5285 AS l_discount_prf_1#5304, l_partkey_and_l_suppkey_prf#5286 AS l_partkey_and_l_suppkey_prf_1#5305, l_commitdate_prf#5287 AS l_commitdate_prf_1#5306, l_suppkey_prf#5288 AS l_suppkey_prf_1#5307, l_orderkey_prf#5289 AS l_orderkey_prf_1#5308]
            +- Relation[l_returnflag_prf#5271,l_orderkey_and_l_linenumber_prf#5272,l_comment_prf#5273,l_linestatus_prf#5274,rid#5275,l_shipmode_prf#5276,l_shipinstruct_prf#5277,l_quantity_prf#5278,l_receiptdate_prf#5279,l_linenumber_prf#5280,l_tax_prf#5281,l_shipdate_prf#5282,l_extendedprice_prf#5283,l_partkey_prf#5284,l_discount_prf#5285,l_partkey_and_l_suppkey_prf#5286,l_commitdate_prf#5287,l_suppkey_prf#5288,l_orderkey_prf#5289] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 94044ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/14 14:10:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 14:10:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5357L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 14:10:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5357L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#5359 AS l_returnflag_prf_0#5378, l_orderkey_and_l_linenumber_prf#5360 AS l_orderkey_and_l_linenumber_prf_0#5379, l_comment_prf#5361 AS l_comment_prf_0#5380, l_linestatus_prf#5362 AS l_linestatus_prf_0#5381, rid#5363 AS rid_0#5382, l_shipmode_prf#5364 AS l_shipmode_prf_0#5383, l_shipinstruct_prf#5365 AS l_shipinstruct_prf_0#5384, l_quantity_prf#5366 AS l_quantity_prf_0#5385, l_receiptdate_prf#5367 AS l_receiptdate_prf_0#5386, l_linenumber_prf#5368 AS l_linenumber_prf_0#5387, l_tax_prf#5369 AS l_tax_prf_0#5388, l_shipdate_prf#5370 AS l_shipdate_prf_0#5389, l_extendedprice_prf#5371 AS l_extendedprice_prf_0#5390, l_partkey_prf#5372 AS l_partkey_prf_0#5391, l_discount_prf#5373 AS l_discount_prf_0#5392, l_partkey_and_l_suppkey_prf#5374 AS l_partkey_and_l_suppkey_prf_0#5393, l_commitdate_prf#5375 AS l_commitdate_prf_0#5394, l_suppkey_prf#5376 AS l_suppkey_prf_0#5395, l_orderkey_prf#5377 AS l_orderkey_prf_0#5396]
         :  +- Relation[l_returnflag_prf#5359,l_orderkey_and_l_linenumber_prf#5360,l_comment_prf#5361,l_linestatus_prf#5362,rid#5363,l_shipmode_prf#5364,l_shipinstruct_prf#5365,l_quantity_prf#5366,l_receiptdate_prf#5367,l_linenumber_prf#5368,l_tax_prf#5369,l_shipdate_prf#5370,l_extendedprice_prf#5371,l_partkey_prf#5372,l_discount_prf#5373,l_partkey_and_l_suppkey_prf#5374,l_commitdate_prf#5375,l_suppkey_prf#5376,l_orderkey_prf#5377] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5397]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#2166,value#2167] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 23405ms
query=b1a, count=15628, duration=433
query=b1b, count=15628, duration=49686
query=b2a, count=1478870, duration=197788
query=b2b, count=1478870, duration=54428
query=f1, count=1, duration=54
query=f2, count=3907, duration=128
query=f3, count=1451, duration=85
query=f4, count=1, duration=57
query=f5, count=1478870, duration=23405
query=f6, count=857401, duration=14365
query=j1, count=800000, duration=31586
query=j10, count=6001215, duration=86663
query=j2, count=800000, duration=10964
query=j3, count=25, duration=68
query=j4, count=150000, duration=1950
query=j5, count=10000, duration=197
query=j6, count=6001215, duration=116618
query=j7, count=1500000, duration=40262
query=j8, count=6001215, duration=195364
query=j8b, count=6001215, duration=114266
query=j9, count=6001215, duration=94044
query=j9b, count=6001215, duration=116987
query=r1a, count=6001215, duration=336133
query=r1b, count=6001215, duration=147897
query=r1c, count=6001215, duration=157892
query=r1d, count=6001215, duration=270431
query=r1e, count=6001215, duration=233716
query=r1f, count=6001215, duration=157042
query=t1a, count=60000414, duration=686397
query=t1b, count=60000414, duration=776406
query=t1c, count=60000414, duration=59168
query=t2a, count=800000, duration=106566
query=t2b, count=800000, duration=88063
query=t2c, count=800000, duration=43016
query=t2d, count=800000, duration=61347
query=t3a, count=6001215, duration=263854
query=t3b, count=6001215, duration=289590
query=t3c, count=6001215, duration=188137
query=t3d, count=6001215, duration=186562
