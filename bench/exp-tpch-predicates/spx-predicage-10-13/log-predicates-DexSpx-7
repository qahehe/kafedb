19/10/12 13:14:26 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7167ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Oct 12 13:14:28 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Oct 12 13:14:29 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Oct 12 13:14:29 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Oct 12 13:14:29 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Oct 12 13:14:30 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Oct 12 13:14:32 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Oct 12 13:14:34 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Oct 12 13:14:34 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/12 13:14:36 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:14:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1478L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 13:14:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1478L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [r_regionkey_prf#1480 AS r_regionkey_prf_0#1484, r_name_prf#1481 AS r_name_prf_0#1485, r_comment_prf#1482 AS r_comment_prf_0#1486, rid#1483 AS rid_0#1487]
         :  :  +- Relation[r_regionkey_prf#1480,r_name_prf#1481,r_comment_prf#1482,rid#1483] JDBCRelation(region_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1491, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1492]
         :     +- SpxRidUncorrelatedJoin nation~n_regionkey~region~r_regionkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [rid#1493 AS rid_1#1498, n_regionkey_prf#1494 AS n_regionkey_prf_1#1499, n_nationkey_prf#1495 AS n_nationkey_prf_1#1500, n_name_prf#1496 AS n_name_prf_1#1501, n_comment_prf#1497 AS n_comment_prf_1#1502]
            +- Relation[rid#1493,n_regionkey_prf#1494,n_nationkey_prf#1495,n_name_prf#1496,n_comment_prf#1497] JDBCRelation(nation_prf) [numPartitions=1]

DexSpx$ result size=25
Elapsed time: 256ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/12 13:14:36 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:14:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1547L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 13:14:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1547L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#1549 AS s_phone_prf_0#1557, rid#1550 AS rid_0#1558, s_address_prf#1551 AS s_address_prf_0#1559, s_nationkey_prf#1552 AS s_nationkey_prf_0#1560, s_suppkey_prf#1553 AS s_suppkey_prf_0#1561, s_name_prf#1554 AS s_name_prf_0#1562, s_acctbal_prf#1555 AS s_acctbal_prf_0#1563, s_comment_prf#1556 AS s_comment_prf_0#1564]
         :  :  +- Relation[s_phone_prf#1549,rid#1550,s_address_prf#1551,s_nationkey_prf#1552,s_suppkey_prf#1553,s_name_prf#1554,s_acctbal_prf#1555,s_comment_prf#1556] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1565, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1566]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [l_returnflag_prf#1567 AS l_returnflag_prf_1#1586, l_orderkey_and_l_linenumber_prf#1568 AS l_orderkey_and_l_linenumber_prf_1#1587, l_comment_prf#1569 AS l_comment_prf_1#1588, l_linestatus_prf#1570 AS l_linestatus_prf_1#1589, rid#1571 AS rid_1#1590, l_shipmode_prf#1572 AS l_shipmode_prf_1#1591, l_shipinstruct_prf#1573 AS l_shipinstruct_prf_1#1592, l_quantity_prf#1574 AS l_quantity_prf_1#1593, l_receiptdate_prf#1575 AS l_receiptdate_prf_1#1594, l_linenumber_prf#1576 AS l_linenumber_prf_1#1595, l_tax_prf#1577 AS l_tax_prf_1#1596, l_shipdate_prf#1578 AS l_shipdate_prf_1#1597, l_extendedprice_prf#1579 AS l_extendedprice_prf_1#1598, l_partkey_prf#1580 AS l_partkey_prf_1#1599, l_discount_prf#1581 AS l_discount_prf_1#1600, l_partkey_and_l_suppkey_prf#1582 AS l_partkey_and_l_suppkey_prf_1#1601, l_commitdate_prf#1583 AS l_commitdate_prf_1#1602, l_suppkey_prf#1584 AS l_suppkey_prf_1#1603, l_orderkey_prf#1585 AS l_orderkey_prf_1#1604]
            :  :  +- Relation[l_returnflag_prf#1567,l_orderkey_and_l_linenumber_prf#1568,l_comment_prf#1569,l_linestatus_prf#1570,rid#1571,l_shipmode_prf#1572,l_shipinstruct_prf#1573,l_quantity_prf#1574,l_receiptdate_prf#1575,l_linenumber_prf#1576,l_tax_prf#1577,l_shipdate_prf#1578,l_extendedprice_prf#1579,l_partkey_prf#1580,l_discount_prf#1581,l_partkey_and_l_suppkey_prf#1582,l_commitdate_prf#1583,l_suppkey_prf#1584,l_orderkey_prf#1585] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1605, dexdecrypt('value_dec_key, 'value_right) AS rid_2#1606]
            :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
            :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [p_comment_prf#1607 AS p_comment_prf_2#1617, p_name_prf#1608 AS p_name_prf_2#1618, rid#1609 AS rid_2#1619, p_type_prf#1610 AS p_type_prf_2#1620, p_retailprice_prf#1611 AS p_retailprice_prf_2#1621, p_mfgr_prf#1612 AS p_mfgr_prf_2#1622, p_container_prf#1613 AS p_container_prf_2#1623, p_brand_prf#1614 AS p_brand_prf_2#1624, p_size_prf#1615 AS p_size_prf_2#1625, p_partkey_prf#1616 AS p_partkey_prf_2#1626]
               +- Relation[p_comment_prf#1607,p_name_prf#1608,rid#1609,p_type_prf#1610,p_retailprice_prf#1611,p_mfgr_prf#1612,p_container_prf#1613,p_brand_prf#1614,p_size_prf#1615,p_partkey_prf#1616] JDBCRelation(part_prf) [numPartitions=1]

19/10/12 13:14:36 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexSpx$ result size=6001215
Elapsed time: 200759ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/12 13:17:57 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:17:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1692L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 13:17:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1692L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [o_shippriority_prf#1694 AS o_shippriority_prf_0#1704, rid#1695 AS rid_0#1705, o_orderdate_prf#1696 AS o_orderdate_prf_0#1706, o_custkey_prf#1697 AS o_custkey_prf_0#1707, o_orderpriority_prf#1698 AS o_orderpriority_prf_0#1708, o_clerk_prf#1699 AS o_clerk_prf_0#1709, o_orderstatus_prf#1700 AS o_orderstatus_prf_0#1710, o_totalprice_prf#1701 AS o_totalprice_prf_0#1711, o_orderkey_prf#1702 AS o_orderkey_prf_0#1712, o_comment_prf#1703 AS o_comment_prf_0#1713]
         :  :  +- Relation[o_shippriority_prf#1694,rid#1695,o_orderdate_prf#1696,o_custkey_prf#1697,o_orderpriority_prf#1698,o_clerk_prf#1699,o_orderstatus_prf#1700,o_totalprice_prf#1701,o_orderkey_prf#1702,o_comment_prf#1703] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1714, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1715]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1716 AS l_returnflag_prf_1#1735, l_orderkey_and_l_linenumber_prf#1717 AS l_orderkey_and_l_linenumber_prf_1#1736, l_comment_prf#1718 AS l_comment_prf_1#1737, l_linestatus_prf#1719 AS l_linestatus_prf_1#1738, rid#1720 AS rid_1#1739, l_shipmode_prf#1721 AS l_shipmode_prf_1#1740, l_shipinstruct_prf#1722 AS l_shipinstruct_prf_1#1741, l_quantity_prf#1723 AS l_quantity_prf_1#1742, l_receiptdate_prf#1724 AS l_receiptdate_prf_1#1743, l_linenumber_prf#1725 AS l_linenumber_prf_1#1744, l_tax_prf#1726 AS l_tax_prf_1#1745, l_shipdate_prf#1727 AS l_shipdate_prf_1#1746, l_extendedprice_prf#1728 AS l_extendedprice_prf_1#1747, l_partkey_prf#1729 AS l_partkey_prf_1#1748, l_discount_prf#1730 AS l_discount_prf_1#1749, l_partkey_and_l_suppkey_prf#1731 AS l_partkey_and_l_suppkey_prf_1#1750, l_commitdate_prf#1732 AS l_commitdate_prf_1#1751, l_suppkey_prf#1733 AS l_suppkey_prf_1#1752, l_orderkey_prf#1734 AS l_orderkey_prf_1#1753]
            +- Relation[l_returnflag_prf#1716,l_orderkey_and_l_linenumber_prf#1717,l_comment_prf#1718,l_linestatus_prf#1719,rid#1720,l_shipmode_prf#1721,l_shipinstruct_prf#1722,l_quantity_prf#1723,l_receiptdate_prf#1724,l_linenumber_prf#1725,l_tax_prf#1726,l_shipdate_prf#1727,l_extendedprice_prf#1728,l_partkey_prf#1729,l_discount_prf#1730,l_partkey_and_l_suppkey_prf#1731,l_commitdate_prf#1732,l_suppkey_prf#1733,l_orderkey_prf#1734] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 107262ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/12 13:19:44 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:19:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1811L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 13:19:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1811L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [l_returnflag_prf#1813 AS l_returnflag_prf_0#1832, l_orderkey_and_l_linenumber_prf#1814 AS l_orderkey_and_l_linenumber_prf_0#1833, l_comment_prf#1815 AS l_comment_prf_0#1834, l_linestatus_prf#1816 AS l_linestatus_prf_0#1835, rid#1817 AS rid_0#1836, l_shipmode_prf#1818 AS l_shipmode_prf_0#1837, l_shipinstruct_prf#1819 AS l_shipinstruct_prf_0#1838, l_quantity_prf#1820 AS l_quantity_prf_0#1839, l_receiptdate_prf#1821 AS l_receiptdate_prf_0#1840, l_linenumber_prf#1822 AS l_linenumber_prf_0#1841, l_tax_prf#1823 AS l_tax_prf_0#1842, l_shipdate_prf#1824 AS l_shipdate_prf_0#1843, l_extendedprice_prf#1825 AS l_extendedprice_prf_0#1844, l_partkey_prf#1826 AS l_partkey_prf_0#1845, l_discount_prf#1827 AS l_discount_prf_0#1846, l_partkey_and_l_suppkey_prf#1828 AS l_partkey_and_l_suppkey_prf_0#1847, l_commitdate_prf#1829 AS l_commitdate_prf_0#1848, l_suppkey_prf#1830 AS l_suppkey_prf_0#1849, l_orderkey_prf#1831 AS l_orderkey_prf_0#1850]
         :  :  :  +- Relation[l_returnflag_prf#1813,l_orderkey_and_l_linenumber_prf#1814,l_comment_prf#1815,l_linestatus_prf#1816,rid#1817,l_shipmode_prf#1818,l_shipinstruct_prf#1819,l_quantity_prf#1820,l_receiptdate_prf#1821,l_linenumber_prf#1822,l_tax_prf#1823,l_shipdate_prf#1824,l_extendedprice_prf#1825,l_partkey_prf#1826,l_discount_prf#1827,l_partkey_and_l_suppkey_prf#1828,l_commitdate_prf#1829,l_suppkey_prf#1830,l_orderkey_prf#1831] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1853]
         :  :     +- DexRidFilter lineitem~l_returnflag~R
         :  :        +- Relation[label#1851,value#1852] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1854, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1855]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#1856 AS o_shippriority_prf_1#1866, rid#1857 AS rid_1#1867, o_orderdate_prf#1858 AS o_orderdate_prf_1#1868, o_custkey_prf#1859 AS o_custkey_prf_1#1869, o_orderpriority_prf#1860 AS o_orderpriority_prf_1#1870, o_clerk_prf#1861 AS o_clerk_prf_1#1871, o_orderstatus_prf#1862 AS o_orderstatus_prf_1#1872, o_totalprice_prf#1863 AS o_totalprice_prf_1#1873, o_orderkey_prf#1864 AS o_orderkey_prf_1#1874, o_comment_prf#1865 AS o_comment_prf_1#1875]
            +- Relation[o_shippriority_prf#1856,rid#1857,o_orderdate_prf#1858,o_custkey_prf#1859,o_orderpriority_prf#1860,o_clerk_prf#1861,o_orderstatus_prf#1862,o_totalprice_prf#1863,o_orderkey_prf#1864,o_comment_prf#1865] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 97594ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/12 13:21:21 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:21:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1929L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 13:21:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1929L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [ps_partkey_and_ps_suppkey_prf#1931 AS ps_partkey_and_ps_suppkey_prf_0#1938, rid#1932 AS rid_0#1939, ps_availqty_prf#1933 AS ps_availqty_prf_0#1940, ps_comment_prf#1934 AS ps_comment_prf_0#1941, ps_partkey_prf#1935 AS ps_partkey_prf_0#1942, ps_supplycost_prf#1936 AS ps_supplycost_prf_0#1943, ps_suppkey_prf#1937 AS ps_suppkey_prf_0#1944]
         :  :  :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#1931,rid#1932,ps_availqty_prf#1933,ps_comment_prf#1934,ps_partkey_prf#1935,ps_supplycost_prf#1936,ps_suppkey_prf#1937] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1945, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1946]
         :  :  :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :  :  :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#1947 AS p_comment_prf_1#1957, p_name_prf#1948 AS p_name_prf_1#1958, rid#1949 AS rid_1#1959, p_type_prf#1950 AS p_type_prf_1#1960, p_retailprice_prf#1951 AS p_retailprice_prf_1#1961, p_mfgr_prf#1952 AS p_mfgr_prf_1#1962, p_container_prf#1953 AS p_container_prf_1#1963, p_brand_prf#1954 AS p_brand_prf_1#1964, p_size_prf#1955 AS p_size_prf_1#1965, p_partkey_prf#1956 AS p_partkey_prf_1#1966]
         :  :     +- Relation[p_comment_prf#1947,p_name_prf#1948,rid#1949,p_type_prf#1950,p_retailprice_prf#1951,p_mfgr_prf#1952,p_container_prf#1953,p_brand_prf#1954,p_size_prf#1955,p_partkey_prf#1956] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1967, dexdecrypt('value_dec_key, 'value_right) AS rid_2#1968]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#1969 AS s_phone_prf_2#1977, rid#1970 AS rid_2#1978, s_address_prf#1971 AS s_address_prf_2#1979, s_nationkey_prf#1972 AS s_nationkey_prf_2#1980, s_suppkey_prf#1973 AS s_suppkey_prf_2#1981, s_name_prf#1974 AS s_name_prf_2#1982, s_acctbal_prf#1975 AS s_acctbal_prf_2#1983, s_comment_prf#1976 AS s_comment_prf_2#1984]
            +- Relation[s_phone_prf#1969,rid#1970,s_address_prf#1971,s_nationkey_prf#1972,s_suppkey_prf#1973,s_name_prf#1974,s_acctbal_prf#1975,s_comment_prf#1976] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26062ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/12 13:21:47 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:21:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2034L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 13:21:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2034L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#2036 AS s_phone_prf_0#2044, rid#2037 AS rid_0#2045, s_address_prf#2038 AS s_address_prf_0#2046, s_nationkey_prf#2039 AS s_nationkey_prf_0#2047, s_suppkey_prf#2040 AS s_suppkey_prf_0#2048, s_name_prf#2041 AS s_name_prf_0#2049, s_acctbal_prf#2042 AS s_acctbal_prf_0#2050, s_comment_prf#2043 AS s_comment_prf_0#2051]
         :  :  +- Relation[s_phone_prf#2036,rid#2037,s_address_prf#2038,s_nationkey_prf#2039,s_suppkey_prf#2040,s_name_prf#2041,s_acctbal_prf#2042,s_comment_prf#2043] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2052, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2053]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [p_comment_prf#2054 AS p_comment_prf_1#2064, p_name_prf#2055 AS p_name_prf_1#2065, rid#2056 AS rid_1#2066, p_type_prf#2057 AS p_type_prf_1#2067, p_retailprice_prf#2058 AS p_retailprice_prf_1#2068, p_mfgr_prf#2059 AS p_mfgr_prf_1#2069, p_container_prf#2060 AS p_container_prf_1#2070, p_brand_prf#2061 AS p_brand_prf_1#2071, p_size_prf#2062 AS p_size_prf_1#2072, p_partkey_prf#2063 AS p_partkey_prf_1#2073]
            :  :  +- Relation[p_comment_prf#2054,p_name_prf#2055,rid#2056,p_type_prf#2057,p_retailprice_prf#2058,p_mfgr_prf#2059,p_container_prf#2060,p_brand_prf#2061,p_size_prf#2062,p_partkey_prf#2063] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2074, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2075]
            :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
            :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#2076 AS ps_partkey_and_ps_suppkey_prf_2#2083, rid#2077 AS rid_2#2084, ps_availqty_prf#2078 AS ps_availqty_prf_2#2085, ps_comment_prf#2079 AS ps_comment_prf_2#2086, ps_partkey_prf#2080 AS ps_partkey_prf_2#2087, ps_supplycost_prf#2081 AS ps_supplycost_prf_2#2088, ps_suppkey_prf#2082 AS ps_suppkey_prf_2#2089]
               +- Relation[ps_partkey_and_ps_suppkey_prf#2076,rid#2077,ps_availqty_prf#2078,ps_comment_prf#2079,ps_partkey_prf#2080,ps_supplycost_prf#2081,ps_suppkey_prf#2082] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26185ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/12 13:22:14 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:22:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2151L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 13:22:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2151L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#2153 AS l_returnflag_prf_0#2172, l_orderkey_and_l_linenumber_prf#2154 AS l_orderkey_and_l_linenumber_prf_0#2173, l_comment_prf#2155 AS l_comment_prf_0#2174, l_linestatus_prf#2156 AS l_linestatus_prf_0#2175, rid#2157 AS rid_0#2176, l_shipmode_prf#2158 AS l_shipmode_prf_0#2177, l_shipinstruct_prf#2159 AS l_shipinstruct_prf_0#2178, l_quantity_prf#2160 AS l_quantity_prf_0#2179, l_receiptdate_prf#2161 AS l_receiptdate_prf_0#2180, l_linenumber_prf#2162 AS l_linenumber_prf_0#2181, l_tax_prf#2163 AS l_tax_prf_0#2182, l_shipdate_prf#2164 AS l_shipdate_prf_0#2183, l_extendedprice_prf#2165 AS l_extendedprice_prf_0#2184, l_partkey_prf#2166 AS l_partkey_prf_0#2185, l_discount_prf#2167 AS l_discount_prf_0#2186, l_partkey_and_l_suppkey_prf#2168 AS l_partkey_and_l_suppkey_prf_0#2187, l_commitdate_prf#2169 AS l_commitdate_prf_0#2188, l_suppkey_prf#2170 AS l_suppkey_prf_0#2189, l_orderkey_prf#2171 AS l_orderkey_prf_0#2190]
         :  :  +- Relation[l_returnflag_prf#2153,l_orderkey_and_l_linenumber_prf#2154,l_comment_prf#2155,l_linestatus_prf#2156,rid#2157,l_shipmode_prf#2158,l_shipinstruct_prf#2159,l_quantity_prf#2160,l_receiptdate_prf#2161,l_linenumber_prf#2162,l_tax_prf#2163,l_shipdate_prf#2164,l_extendedprice_prf#2165,l_partkey_prf#2166,l_discount_prf#2167,l_partkey_and_l_suppkey_prf#2168,l_commitdate_prf#2169,l_suppkey_prf#2170,l_orderkey_prf#2171] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2191, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2192]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [c_acctbal_prf#2193 AS c_acctbal_prf_1#2202, rid#2194 AS rid_1#2203, c_name_prf#2195 AS c_name_prf_1#2204, c_nationkey_prf#2196 AS c_nationkey_prf_1#2205, c_custkey_prf#2197 AS c_custkey_prf_1#2206, c_comment_prf#2198 AS c_comment_prf_1#2207, c_address_prf#2199 AS c_address_prf_1#2208, c_mktsegment_prf#2200 AS c_mktsegment_prf_1#2209, c_phone_prf#2201 AS c_phone_prf_1#2210]
            :  :  +- Relation[c_acctbal_prf#2193,rid#2194,c_name_prf#2195,c_nationkey_prf#2196,c_custkey_prf#2197,c_comment_prf#2198,c_address_prf#2199,c_mktsegment_prf#2200,c_phone_prf#2201] JDBCRelation(customer_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2211, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2212]
            :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
            :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2213 AS o_shippriority_prf_2#2223, rid#2214 AS rid_2#2224, o_orderdate_prf#2215 AS o_orderdate_prf_2#2225, o_custkey_prf#2216 AS o_custkey_prf_2#2226, o_orderpriority_prf#2217 AS o_orderpriority_prf_2#2227, o_clerk_prf#2218 AS o_clerk_prf_2#2228, o_orderstatus_prf#2219 AS o_orderstatus_prf_2#2229, o_totalprice_prf#2220 AS o_totalprice_prf_2#2230, o_orderkey_prf#2221 AS o_orderkey_prf_2#2231, o_comment_prf#2222 AS o_comment_prf_2#2232]
               +- Relation[o_shippriority_prf#2213,rid#2214,o_orderdate_prf#2215,o_custkey_prf#2216,o_orderpriority_prf#2217,o_clerk_prf#2218,o_orderstatus_prf#2219,o_totalprice_prf#2220,o_orderkey_prf#2221,o_comment_prf#2222] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 182083ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/12 13:25:16 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:25:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2299L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 13:25:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2299L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [o_shippriority_prf#2301 AS o_shippriority_prf_0#2311, rid#2302 AS rid_0#2312, o_orderdate_prf#2303 AS o_orderdate_prf_0#2313, o_custkey_prf#2304 AS o_custkey_prf_0#2314, o_orderpriority_prf#2305 AS o_orderpriority_prf_0#2315, o_clerk_prf#2306 AS o_clerk_prf_0#2316, o_orderstatus_prf#2307 AS o_orderstatus_prf_0#2317, o_totalprice_prf#2308 AS o_totalprice_prf_0#2318, o_orderkey_prf#2309 AS o_orderkey_prf_0#2319, o_comment_prf#2310 AS o_comment_prf_0#2320]
         :  :  +- Relation[o_shippriority_prf#2301,rid#2302,o_orderdate_prf#2303,o_custkey_prf#2304,o_orderpriority_prf#2305,o_clerk_prf#2306,o_orderstatus_prf#2307,o_totalprice_prf#2308,o_orderkey_prf#2309,o_comment_prf#2310] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2321, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2322]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#2323 AS l_returnflag_prf_1#2342, l_orderkey_and_l_linenumber_prf#2324 AS l_orderkey_and_l_linenumber_prf_1#2343, l_comment_prf#2325 AS l_comment_prf_1#2344, l_linestatus_prf#2326 AS l_linestatus_prf_1#2345, rid#2327 AS rid_1#2346, l_shipmode_prf#2328 AS l_shipmode_prf_1#2347, l_shipinstruct_prf#2329 AS l_shipinstruct_prf_1#2348, l_quantity_prf#2330 AS l_quantity_prf_1#2349, l_receiptdate_prf#2331 AS l_receiptdate_prf_1#2350, l_linenumber_prf#2332 AS l_linenumber_prf_1#2351, l_tax_prf#2333 AS l_tax_prf_1#2352, l_shipdate_prf#2334 AS l_shipdate_prf_1#2353, l_extendedprice_prf#2335 AS l_extendedprice_prf_1#2354, l_partkey_prf#2336 AS l_partkey_prf_1#2355, l_discount_prf#2337 AS l_discount_prf_1#2356, l_partkey_and_l_suppkey_prf#2338 AS l_partkey_and_l_suppkey_prf_1#2357, l_commitdate_prf#2339 AS l_commitdate_prf_1#2358, l_suppkey_prf#2340 AS l_suppkey_prf_1#2359, l_orderkey_prf#2341 AS l_orderkey_prf_1#2360]
            :  +- Relation[l_returnflag_prf#2323,l_orderkey_and_l_linenumber_prf#2324,l_comment_prf#2325,l_linestatus_prf#2326,rid#2327,l_shipmode_prf#2328,l_shipinstruct_prf#2329,l_quantity_prf#2330,l_receiptdate_prf#2331,l_linenumber_prf#2332,l_tax_prf#2333,l_shipdate_prf#2334,l_extendedprice_prf#2335,l_partkey_prf#2336,l_discount_prf#2337,l_partkey_and_l_suppkey_prf#2338,l_commitdate_prf#2339,l_suppkey_prf#2340,l_orderkey_prf#2341] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2361]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1851,value#1852] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 97738ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/12 13:26:53 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:26:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2413L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 13:26:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2413L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#2415 AS c_acctbal_prf_0#2424, rid#2416 AS rid_0#2425, c_name_prf#2417 AS c_name_prf_0#2426, c_nationkey_prf#2418 AS c_nationkey_prf_0#2427, c_custkey_prf#2419 AS c_custkey_prf_0#2428, c_comment_prf#2420 AS c_comment_prf_0#2429, c_address_prf#2421 AS c_address_prf_0#2430, c_mktsegment_prf#2422 AS c_mktsegment_prf_0#2431, c_phone_prf#2423 AS c_phone_prf_0#2432]
         :  :  +- Relation[c_acctbal_prf#2415,rid#2416,c_name_prf#2417,c_nationkey_prf#2418,c_custkey_prf#2419,c_comment_prf#2420,c_address_prf#2421,c_mktsegment_prf#2422,c_phone_prf#2423] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2433, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2434]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [s_phone_prf#2435 AS s_phone_prf_1#2443, rid#2436 AS rid_1#2444, s_address_prf#2437 AS s_address_prf_1#2445, s_nationkey_prf#2438 AS s_nationkey_prf_1#2446, s_suppkey_prf#2439 AS s_suppkey_prf_1#2447, s_name_prf#2440 AS s_name_prf_1#2448, s_acctbal_prf#2441 AS s_acctbal_prf_1#2449, s_comment_prf#2442 AS s_comment_prf_1#2450]
            :  :  +- Relation[s_phone_prf#2435,rid#2436,s_address_prf#2437,s_nationkey_prf#2438,s_suppkey_prf#2439,s_name_prf#2440,s_acctbal_prf#2441,s_comment_prf#2442] JDBCRelation(supplier_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2451, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2452]
            :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
            :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [rid#2453 AS rid_2#2458, n_regionkey_prf#2454 AS n_regionkey_prf_2#2459, n_nationkey_prf#2455 AS n_nationkey_prf_2#2460, n_name_prf#2456 AS n_name_prf_2#2461, n_comment_prf#2457 AS n_comment_prf_2#2462]
               +- Relation[rid#2453,n_regionkey_prf#2454,n_nationkey_prf#2455,n_name_prf#2456,n_comment_prf#2457] JDBCRelation(nation_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 926809ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/12 13:42:20 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:42:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2500L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 13:42:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2500L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [rid#2502 AS rid_0#2507, n_regionkey_prf#2503 AS n_regionkey_prf_0#2508, n_nationkey_prf#2504 AS n_nationkey_prf_0#2509, n_name_prf#2505 AS n_name_prf_0#2510, n_comment_prf#2506 AS n_comment_prf_0#2511]
         :  :  +- Relation[rid#2502,n_regionkey_prf#2503,n_nationkey_prf#2504,n_name_prf#2505,n_comment_prf#2506] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2512, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2513]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2514 AS c_acctbal_prf_1#2523, rid#2515 AS rid_1#2524, c_name_prf#2516 AS c_name_prf_1#2525, c_nationkey_prf#2517 AS c_nationkey_prf_1#2526, c_custkey_prf#2518 AS c_custkey_prf_1#2527, c_comment_prf#2519 AS c_comment_prf_1#2528, c_address_prf#2520 AS c_address_prf_1#2529, c_mktsegment_prf#2521 AS c_mktsegment_prf_1#2530, c_phone_prf#2522 AS c_phone_prf_1#2531]
            +- Relation[c_acctbal_prf#2514,rid#2515,c_name_prf#2516,c_nationkey_prf#2517,c_custkey_prf#2518,c_comment_prf#2519,c_address_prf#2520,c_mktsegment_prf#2521,c_phone_prf#2522] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=150000
Elapsed time: 2539ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/12 13:42:23 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:42:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2563L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 13:42:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2563L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [p_comment_prf#2565 AS p_comment_prf_0#2575, p_name_prf#2566 AS p_name_prf_0#2576, rid#2567 AS rid_0#2577, p_type_prf#2568 AS p_type_prf_0#2578, p_retailprice_prf#2569 AS p_retailprice_prf_0#2579, p_mfgr_prf#2570 AS p_mfgr_prf_0#2580, p_container_prf#2571 AS p_container_prf_0#2581, p_brand_prf#2572 AS p_brand_prf_0#2582, p_size_prf#2573 AS p_size_prf_0#2583, p_partkey_prf#2574 AS p_partkey_prf_0#2584]
         :  :  :  +- Relation[p_comment_prf#2565,p_name_prf#2566,rid#2567,p_type_prf#2568,p_retailprice_prf#2569,p_mfgr_prf#2570,p_container_prf#2571,p_brand_prf#2572,p_size_prf#2573,p_partkey_prf#2574] JDBCRelation(part_prf) [numPartitions=1]
         :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2585]
         :  :     +- DexRidFilter part~p_size~15
         :  :        +- Relation[label#1851,value#1852] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2586, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2587]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2588 AS ps_partkey_and_ps_suppkey_prf_1#2595, rid#2589 AS rid_1#2596, ps_availqty_prf#2590 AS ps_availqty_prf_1#2597, ps_comment_prf#2591 AS ps_comment_prf_1#2598, ps_partkey_prf#2592 AS ps_partkey_prf_1#2599, ps_supplycost_prf#2593 AS ps_supplycost_prf_1#2600, ps_suppkey_prf#2594 AS ps_suppkey_prf_1#2601]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2588,rid#2589,ps_availqty_prf#2590,ps_comment_prf#2591,ps_partkey_prf#2592,ps_supplycost_prf#2593,ps_suppkey_prf#2594] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=15628
Elapsed time: 7767ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/12 13:42:31 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:42:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2647L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 13:42:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2647L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [p_comment_prf#2649 AS p_comment_prf_0#2659, p_name_prf#2650 AS p_name_prf_0#2660, rid#2651 AS rid_0#2661, p_type_prf#2652 AS p_type_prf_0#2662, p_retailprice_prf#2653 AS p_retailprice_prf_0#2663, p_mfgr_prf#2654 AS p_mfgr_prf_0#2664, p_container_prf#2655 AS p_container_prf_0#2665, p_brand_prf#2656 AS p_brand_prf_0#2666, p_size_prf#2657 AS p_size_prf_0#2667, p_partkey_prf#2658 AS p_partkey_prf_0#2668]
         :  :  +- Relation[p_comment_prf#2649,p_name_prf#2650,rid#2651,p_type_prf#2652,p_retailprice_prf#2653,p_mfgr_prf#2654,p_container_prf#2655,p_brand_prf#2656,p_size_prf#2657,p_partkey_prf#2658] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2669, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2670]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2671 AS l_returnflag_prf_1#2690, l_orderkey_and_l_linenumber_prf#2672 AS l_orderkey_and_l_linenumber_prf_1#2691, l_comment_prf#2673 AS l_comment_prf_1#2692, l_linestatus_prf#2674 AS l_linestatus_prf_1#2693, rid#2675 AS rid_1#2694, l_shipmode_prf#2676 AS l_shipmode_prf_1#2695, l_shipinstruct_prf#2677 AS l_shipinstruct_prf_1#2696, l_quantity_prf#2678 AS l_quantity_prf_1#2697, l_receiptdate_prf#2679 AS l_receiptdate_prf_1#2698, l_linenumber_prf#2680 AS l_linenumber_prf_1#2699, l_tax_prf#2681 AS l_tax_prf_1#2700, l_shipdate_prf#2682 AS l_shipdate_prf_1#2701, l_extendedprice_prf#2683 AS l_extendedprice_prf_1#2702, l_partkey_prf#2684 AS l_partkey_prf_1#2703, l_discount_prf#2685 AS l_discount_prf_1#2704, l_partkey_and_l_suppkey_prf#2686 AS l_partkey_and_l_suppkey_prf_1#2705, l_commitdate_prf#2687 AS l_commitdate_prf_1#2706, l_suppkey_prf#2688 AS l_suppkey_prf_1#2707, l_orderkey_prf#2689 AS l_orderkey_prf_1#2708]
            +- Relation[l_returnflag_prf#2671,l_orderkey_and_l_linenumber_prf#2672,l_comment_prf#2673,l_linestatus_prf#2674,rid#2675,l_shipmode_prf#2676,l_shipinstruct_prf#2677,l_quantity_prf#2678,l_receiptdate_prf#2679,l_linenumber_prf#2680,l_tax_prf#2681,l_shipdate_prf#2682,l_extendedprice_prf#2683,l_partkey_prf#2684,l_discount_prf#2685,l_partkey_and_l_suppkey_prf#2686,l_commitdate_prf#2687,l_suppkey_prf#2688,l_orderkey_prf#2689] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 94935ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/12 13:44:06 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:44:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2764L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 13:44:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2764L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#2766 AS s_phone_prf_0#2774, rid#2767 AS rid_0#2775, s_address_prf#2768 AS s_address_prf_0#2776, s_nationkey_prf#2769 AS s_nationkey_prf_0#2777, s_suppkey_prf#2770 AS s_suppkey_prf_0#2778, s_name_prf#2771 AS s_name_prf_0#2779, s_acctbal_prf#2772 AS s_acctbal_prf_0#2780, s_comment_prf#2773 AS s_comment_prf_0#2781]
         :  :  +- Relation[s_phone_prf#2766,rid#2767,s_address_prf#2768,s_nationkey_prf#2769,s_suppkey_prf#2770,s_name_prf#2771,s_acctbal_prf#2772,s_comment_prf#2773] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2782, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2783]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2784 AS l_returnflag_prf_1#2803, l_orderkey_and_l_linenumber_prf#2785 AS l_orderkey_and_l_linenumber_prf_1#2804, l_comment_prf#2786 AS l_comment_prf_1#2805, l_linestatus_prf#2787 AS l_linestatus_prf_1#2806, rid#2788 AS rid_1#2807, l_shipmode_prf#2789 AS l_shipmode_prf_1#2808, l_shipinstruct_prf#2790 AS l_shipinstruct_prf_1#2809, l_quantity_prf#2791 AS l_quantity_prf_1#2810, l_receiptdate_prf#2792 AS l_receiptdate_prf_1#2811, l_linenumber_prf#2793 AS l_linenumber_prf_1#2812, l_tax_prf#2794 AS l_tax_prf_1#2813, l_shipdate_prf#2795 AS l_shipdate_prf_1#2814, l_extendedprice_prf#2796 AS l_extendedprice_prf_1#2815, l_partkey_prf#2797 AS l_partkey_prf_1#2816, l_discount_prf#2798 AS l_discount_prf_1#2817, l_partkey_and_l_suppkey_prf#2799 AS l_partkey_and_l_suppkey_prf_1#2818, l_commitdate_prf#2800 AS l_commitdate_prf_1#2819, l_suppkey_prf#2801 AS l_suppkey_prf_1#2820, l_orderkey_prf#2802 AS l_orderkey_prf_1#2821]
            +- Relation[l_returnflag_prf#2784,l_orderkey_and_l_linenumber_prf#2785,l_comment_prf#2786,l_linestatus_prf#2787,rid#2788,l_shipmode_prf#2789,l_shipinstruct_prf#2790,l_quantity_prf#2791,l_receiptdate_prf#2792,l_linenumber_prf#2793,l_tax_prf#2794,l_shipdate_prf#2795,l_extendedprice_prf#2796,l_partkey_prf#2797,l_discount_prf#2798,l_partkey_and_l_suppkey_prf#2799,l_commitdate_prf#2800,l_suppkey_prf#2801,l_orderkey_prf#2802] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 90074ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/12 13:45:36 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:45:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2884L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 13:45:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2884L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [l_returnflag_prf#2886 AS l_returnflag_prf_0#2905, l_orderkey_and_l_linenumber_prf#2887 AS l_orderkey_and_l_linenumber_prf_0#2906, l_comment_prf#2888 AS l_comment_prf_0#2907, l_linestatus_prf#2889 AS l_linestatus_prf_0#2908, rid#2890 AS rid_0#2909, l_shipmode_prf#2891 AS l_shipmode_prf_0#2910, l_shipinstruct_prf#2892 AS l_shipinstruct_prf_0#2911, l_quantity_prf#2893 AS l_quantity_prf_0#2912, l_receiptdate_prf#2894 AS l_receiptdate_prf_0#2913, l_linenumber_prf#2895 AS l_linenumber_prf_0#2914, l_tax_prf#2896 AS l_tax_prf_0#2915, l_shipdate_prf#2897 AS l_shipdate_prf_0#2916, l_extendedprice_prf#2898 AS l_extendedprice_prf_0#2917, l_partkey_prf#2899 AS l_partkey_prf_0#2918, l_discount_prf#2900 AS l_discount_prf_0#2919, l_partkey_and_l_suppkey_prf#2901 AS l_partkey_and_l_suppkey_prf_0#2920, l_commitdate_prf#2902 AS l_commitdate_prf_0#2921, l_suppkey_prf#2903 AS l_suppkey_prf_0#2922, l_orderkey_prf#2904 AS l_orderkey_prf_0#2923]
         :  :  :  :  +- Relation[l_returnflag_prf#2886,l_orderkey_and_l_linenumber_prf#2887,l_comment_prf#2888,l_linestatus_prf#2889,rid#2890,l_shipmode_prf#2891,l_shipinstruct_prf#2892,l_quantity_prf#2893,l_receiptdate_prf#2894,l_linenumber_prf#2895,l_tax_prf#2896,l_shipdate_prf#2897,l_extendedprice_prf#2898,l_partkey_prf#2899,l_discount_prf#2900,l_partkey_and_l_suppkey_prf#2901,l_commitdate_prf#2902,l_suppkey_prf#2903,l_orderkey_prf#2904] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2924, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2925]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :  :  :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#2926 AS p_comment_prf_1#2936, p_name_prf#2927 AS p_name_prf_1#2937, rid#2928 AS rid_1#2938, p_type_prf#2929 AS p_type_prf_1#2939, p_retailprice_prf#2930 AS p_retailprice_prf_1#2940, p_mfgr_prf#2931 AS p_mfgr_prf_1#2941, p_container_prf#2932 AS p_container_prf_1#2942, p_brand_prf#2933 AS p_brand_prf_1#2943, p_size_prf#2934 AS p_size_prf_1#2944, p_partkey_prf#2935 AS p_partkey_prf_1#2945]
         :  :     +- Relation[p_comment_prf#2926,p_name_prf#2927,rid#2928,p_type_prf#2929,p_retailprice_prf#2930,p_mfgr_prf#2931,p_container_prf#2932,p_brand_prf#2933,p_size_prf#2934,p_partkey_prf#2935] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2946, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2947]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#2948 AS s_phone_prf_2#2956, rid#2949 AS rid_2#2957, s_address_prf#2950 AS s_address_prf_2#2958, s_nationkey_prf#2951 AS s_nationkey_prf_2#2959, s_suppkey_prf#2952 AS s_suppkey_prf_2#2960, s_name_prf#2953 AS s_name_prf_2#2961, s_acctbal_prf#2954 AS s_acctbal_prf_2#2962, s_comment_prf#2955 AS s_comment_prf_2#2963]
            +- Relation[s_phone_prf#2948,rid#2949,s_address_prf#2950,s_nationkey_prf#2951,s_suppkey_prf#2952,s_name_prf#2953,s_acctbal_prf#2954,s_comment_prf#2955] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 200696ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/12 13:48:56 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:48:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3023L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 13:48:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3023L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [rid#3025 AS rid_0#3030, n_regionkey_prf#3026 AS n_regionkey_prf_0#3031, n_nationkey_prf#3027 AS n_nationkey_prf_0#3032, n_name_prf#3028 AS n_name_prf_0#3033, n_comment_prf#3029 AS n_comment_prf_0#3034]
         :  :  :  :  +- Relation[rid#3025,n_regionkey_prf#3026,n_nationkey_prf#3027,n_name_prf#3028,n_comment_prf#3029] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3035, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3036]
         :  :  :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :  :  :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#3037 AS s_phone_prf_1#3045, rid#3038 AS rid_1#3046, s_address_prf#3039 AS s_address_prf_1#3047, s_nationkey_prf#3040 AS s_nationkey_prf_1#3048, s_suppkey_prf#3041 AS s_suppkey_prf_1#3049, s_name_prf#3042 AS s_name_prf_1#3050, s_acctbal_prf#3043 AS s_acctbal_prf_1#3051, s_comment_prf#3044 AS s_comment_prf_1#3052]
         :  :     +- Relation[s_phone_prf#3037,rid#3038,s_address_prf#3039,s_nationkey_prf#3040,s_suppkey_prf#3041,s_name_prf#3042,s_acctbal_prf#3043,s_comment_prf#3044] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3053, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3054]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3055 AS c_acctbal_prf_2#3064, rid#3056 AS rid_2#3065, c_name_prf#3057 AS c_name_prf_2#3066, c_nationkey_prf#3058 AS c_nationkey_prf_2#3067, c_custkey_prf#3059 AS c_custkey_prf_2#3068, c_comment_prf#3060 AS c_comment_prf_2#3069, c_address_prf#3061 AS c_address_prf_2#3070, c_mktsegment_prf#3062 AS c_mktsegment_prf_2#3071, c_phone_prf#3063 AS c_phone_prf_2#3072]
            +- Relation[c_acctbal_prf#3055,rid#3056,c_name_prf#3057,c_nationkey_prf#3058,c_custkey_prf#3059,c_comment_prf#3060,c_address_prf#3061,c_mktsegment_prf#3062,c_phone_prf#3063] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 880352ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/12 14:03:37 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:03:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3131L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 14:03:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3131L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [l_returnflag_prf#3133 AS l_returnflag_prf_0#3152, l_orderkey_and_l_linenumber_prf#3134 AS l_orderkey_and_l_linenumber_prf_0#3153, l_comment_prf#3135 AS l_comment_prf_0#3154, l_linestatus_prf#3136 AS l_linestatus_prf_0#3155, rid#3137 AS rid_0#3156, l_shipmode_prf#3138 AS l_shipmode_prf_0#3157, l_shipinstruct_prf#3139 AS l_shipinstruct_prf_0#3158, l_quantity_prf#3140 AS l_quantity_prf_0#3159, l_receiptdate_prf#3141 AS l_receiptdate_prf_0#3160, l_linenumber_prf#3142 AS l_linenumber_prf_0#3161, l_tax_prf#3143 AS l_tax_prf_0#3162, l_shipdate_prf#3144 AS l_shipdate_prf_0#3163, l_extendedprice_prf#3145 AS l_extendedprice_prf_0#3164, l_partkey_prf#3146 AS l_partkey_prf_0#3165, l_discount_prf#3147 AS l_discount_prf_0#3166, l_partkey_and_l_suppkey_prf#3148 AS l_partkey_and_l_suppkey_prf_0#3167, l_commitdate_prf#3149 AS l_commitdate_prf_0#3168, l_suppkey_prf#3150 AS l_suppkey_prf_0#3169, l_orderkey_prf#3151 AS l_orderkey_prf_0#3170]
         :  :  :  :  +- Relation[l_returnflag_prf#3133,l_orderkey_and_l_linenumber_prf#3134,l_comment_prf#3135,l_linestatus_prf#3136,rid#3137,l_shipmode_prf#3138,l_shipinstruct_prf#3139,l_quantity_prf#3140,l_receiptdate_prf#3141,l_linenumber_prf#3142,l_tax_prf#3143,l_shipdate_prf#3144,l_extendedprice_prf#3145,l_partkey_prf#3146,l_discount_prf#3147,l_partkey_and_l_suppkey_prf#3148,l_commitdate_prf#3149,l_suppkey_prf#3150,l_orderkey_prf#3151] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3171, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3172]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :  :  :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#3173 AS o_shippriority_prf_1#3183, rid#3174 AS rid_1#3184, o_orderdate_prf#3175 AS o_orderdate_prf_1#3185, o_custkey_prf#3176 AS o_custkey_prf_1#3186, o_orderpriority_prf#3177 AS o_orderpriority_prf_1#3187, o_clerk_prf#3178 AS o_clerk_prf_1#3188, o_orderstatus_prf#3179 AS o_orderstatus_prf_1#3189, o_totalprice_prf#3180 AS o_totalprice_prf_1#3190, o_orderkey_prf#3181 AS o_orderkey_prf_1#3191, o_comment_prf#3182 AS o_comment_prf_1#3192]
         :  :     +- Relation[o_shippriority_prf#3173,rid#3174,o_orderdate_prf#3175,o_custkey_prf#3176,o_orderpriority_prf#3177,o_clerk_prf#3178,o_orderstatus_prf#3179,o_totalprice_prf#3180,o_orderkey_prf#3181,o_comment_prf#3182] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3193, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3194]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3195 AS c_acctbal_prf_2#3204, rid#3196 AS rid_2#3205, c_name_prf#3197 AS c_name_prf_2#3206, c_nationkey_prf#3198 AS c_nationkey_prf_2#3207, c_custkey_prf#3199 AS c_custkey_prf_2#3208, c_comment_prf#3200 AS c_comment_prf_2#3209, c_address_prf#3201 AS c_address_prf_2#3210, c_mktsegment_prf#3202 AS c_mktsegment_prf_2#3211, c_phone_prf#3203 AS c_phone_prf_2#3212]
            +- Relation[c_acctbal_prf#3195,rid#3196,c_name_prf#3197,c_nationkey_prf#3198,c_custkey_prf#3199,c_comment_prf#3200,c_address_prf#3201,c_mktsegment_prf#3202,c_phone_prf#3203] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 182784ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/12 14:06:39 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:06:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3286L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 14:06:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3286L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [p_comment_prf#3288 AS p_comment_prf_0#3298, p_name_prf#3289 AS p_name_prf_0#3299, rid#3290 AS rid_0#3300, p_type_prf#3291 AS p_type_prf_0#3301, p_retailprice_prf#3292 AS p_retailprice_prf_0#3302, p_mfgr_prf#3293 AS p_mfgr_prf_0#3303, p_container_prf#3294 AS p_container_prf_0#3304, p_brand_prf#3295 AS p_brand_prf_0#3305, p_size_prf#3296 AS p_size_prf_0#3306, p_partkey_prf#3297 AS p_partkey_prf_0#3307]
         :  :  :  :  +- Relation[p_comment_prf#3288,p_name_prf#3289,rid#3290,p_type_prf#3291,p_retailprice_prf#3292,p_mfgr_prf#3293,p_container_prf#3294,p_brand_prf#3295,p_size_prf#3296,p_partkey_prf#3297] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3308, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3309]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :  :  :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#3310 AS l_returnflag_prf_1#3329, l_orderkey_and_l_linenumber_prf#3311 AS l_orderkey_and_l_linenumber_prf_1#3330, l_comment_prf#3312 AS l_comment_prf_1#3331, l_linestatus_prf#3313 AS l_linestatus_prf_1#3332, rid#3314 AS rid_1#3333, l_shipmode_prf#3315 AS l_shipmode_prf_1#3334, l_shipinstruct_prf#3316 AS l_shipinstruct_prf_1#3335, l_quantity_prf#3317 AS l_quantity_prf_1#3336, l_receiptdate_prf#3318 AS l_receiptdate_prf_1#3337, l_linenumber_prf#3319 AS l_linenumber_prf_1#3338, l_tax_prf#3320 AS l_tax_prf_1#3339, l_shipdate_prf#3321 AS l_shipdate_prf_1#3340, l_extendedprice_prf#3322 AS l_extendedprice_prf_1#3341, l_partkey_prf#3323 AS l_partkey_prf_1#3342, l_discount_prf#3324 AS l_discount_prf_1#3343, l_partkey_and_l_suppkey_prf#3325 AS l_partkey_and_l_suppkey_prf_1#3344, l_commitdate_prf#3326 AS l_commitdate_prf_1#3345, l_suppkey_prf#3327 AS l_suppkey_prf_1#3346, l_orderkey_prf#3328 AS l_orderkey_prf_1#3347]
         :  :     +- Relation[l_returnflag_prf#3310,l_orderkey_and_l_linenumber_prf#3311,l_comment_prf#3312,l_linestatus_prf#3313,rid#3314,l_shipmode_prf#3315,l_shipinstruct_prf#3316,l_quantity_prf#3317,l_receiptdate_prf#3318,l_linenumber_prf#3319,l_tax_prf#3320,l_shipdate_prf#3321,l_extendedprice_prf#3322,l_partkey_prf#3323,l_discount_prf#3324,l_partkey_and_l_suppkey_prf#3325,l_commitdate_prf#3326,l_suppkey_prf#3327,l_orderkey_prf#3328] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3348, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3349]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#3350 AS s_phone_prf_2#3358, rid#3351 AS rid_2#3359, s_address_prf#3352 AS s_address_prf_2#3360, s_nationkey_prf#3353 AS s_nationkey_prf_2#3361, s_suppkey_prf#3354 AS s_suppkey_prf_2#3362, s_name_prf#3355 AS s_name_prf_2#3363, s_acctbal_prf#3356 AS s_acctbal_prf_2#3364, s_comment_prf#3357 AS s_comment_prf_2#3365]
            +- Relation[s_phone_prf#3350,rid#3351,s_address_prf#3352,s_nationkey_prf#3353,s_suppkey_prf#3354,s_name_prf#3355,s_acctbal_prf#3356,s_comment_prf#3357] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201980ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/12 14:10:01 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:10:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3439L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 14:10:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3439L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#3441 AS c_acctbal_prf_0#3450, rid#3442 AS rid_0#3451, c_name_prf#3443 AS c_name_prf_0#3452, c_nationkey_prf#3444 AS c_nationkey_prf_0#3453, c_custkey_prf#3445 AS c_custkey_prf_0#3454, c_comment_prf#3446 AS c_comment_prf_0#3455, c_address_prf#3447 AS c_address_prf_0#3456, c_mktsegment_prf#3448 AS c_mktsegment_prf_0#3457, c_phone_prf#3449 AS c_phone_prf_0#3458]
         :  :  +- Relation[c_acctbal_prf#3441,rid#3442,c_name_prf#3443,c_nationkey_prf#3444,c_custkey_prf#3445,c_comment_prf#3446,c_address_prf#3447,c_mktsegment_prf#3448,c_phone_prf#3449] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3459, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3460]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [o_shippriority_prf#3461 AS o_shippriority_prf_1#3471, rid#3462 AS rid_1#3472, o_orderdate_prf#3463 AS o_orderdate_prf_1#3473, o_custkey_prf#3464 AS o_custkey_prf_1#3474, o_orderpriority_prf#3465 AS o_orderpriority_prf_1#3475, o_clerk_prf#3466 AS o_clerk_prf_1#3476, o_orderstatus_prf#3467 AS o_orderstatus_prf_1#3477, o_totalprice_prf#3468 AS o_totalprice_prf_1#3478, o_orderkey_prf#3469 AS o_orderkey_prf_1#3479, o_comment_prf#3470 AS o_comment_prf_1#3480]
            :  :  +- Relation[o_shippriority_prf#3461,rid#3462,o_orderdate_prf#3463,o_custkey_prf#3464,o_orderpriority_prf#3465,o_clerk_prf#3466,o_orderstatus_prf#3467,o_totalprice_prf#3468,o_orderkey_prf#3469,o_comment_prf#3470] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3481, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3482]
            :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
            :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3483 AS l_returnflag_prf_2#3502, l_orderkey_and_l_linenumber_prf#3484 AS l_orderkey_and_l_linenumber_prf_2#3503, l_comment_prf#3485 AS l_comment_prf_2#3504, l_linestatus_prf#3486 AS l_linestatus_prf_2#3505, rid#3487 AS rid_2#3506, l_shipmode_prf#3488 AS l_shipmode_prf_2#3507, l_shipinstruct_prf#3489 AS l_shipinstruct_prf_2#3508, l_quantity_prf#3490 AS l_quantity_prf_2#3509, l_receiptdate_prf#3491 AS l_receiptdate_prf_2#3510, l_linenumber_prf#3492 AS l_linenumber_prf_2#3511, l_tax_prf#3493 AS l_tax_prf_2#3512, l_shipdate_prf#3494 AS l_shipdate_prf_2#3513, l_extendedprice_prf#3495 AS l_extendedprice_prf_2#3514, l_partkey_prf#3496 AS l_partkey_prf_2#3515, l_discount_prf#3497 AS l_discount_prf_2#3516, l_partkey_and_l_suppkey_prf#3498 AS l_partkey_and_l_suppkey_prf_2#3517, l_commitdate_prf#3499 AS l_commitdate_prf_2#3518, l_suppkey_prf#3500 AS l_suppkey_prf_2#3519, l_orderkey_prf#3501 AS l_orderkey_prf_2#3520]
               +- Relation[l_returnflag_prf#3483,l_orderkey_and_l_linenumber_prf#3484,l_comment_prf#3485,l_linestatus_prf#3486,rid#3487,l_shipmode_prf#3488,l_shipinstruct_prf#3489,l_quantity_prf#3490,l_receiptdate_prf#3491,l_linenumber_prf#3492,l_tax_prf#3493,l_shipdate_prf#3494,l_extendedprice_prf#3495,l_partkey_prf#3496,l_discount_prf#3497,l_partkey_and_l_suppkey_prf#3498,l_commitdate_prf#3499,l_suppkey_prf#3500,l_orderkey_prf#3501] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 169845ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/12 14:12:51 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:12:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3574L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 14:12:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3574L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#3576 AS s_phone_prf_0#3584, rid#3577 AS rid_0#3585, s_address_prf#3578 AS s_address_prf_0#3586, s_nationkey_prf#3579 AS s_nationkey_prf_0#3587, s_suppkey_prf#3580 AS s_suppkey_prf_0#3588, s_name_prf#3581 AS s_name_prf_0#3589, s_acctbal_prf#3582 AS s_acctbal_prf_0#3590, s_comment_prf#3583 AS s_comment_prf_0#3591]
         :  :  +- Relation[s_phone_prf#3576,rid#3577,s_address_prf#3578,s_nationkey_prf#3579,s_suppkey_prf#3580,s_name_prf#3581,s_acctbal_prf#3582,s_comment_prf#3583] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3592, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3593]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#3594 AS ps_partkey_and_ps_suppkey_prf_1#3601, rid#3595 AS rid_1#3602, ps_availqty_prf#3596 AS ps_availqty_prf_1#3603, ps_comment_prf#3597 AS ps_comment_prf_1#3604, ps_partkey_prf#3598 AS ps_partkey_prf_1#3605, ps_supplycost_prf#3599 AS ps_supplycost_prf_1#3606, ps_suppkey_prf#3600 AS ps_suppkey_prf_1#3607]
            +- Relation[ps_partkey_and_ps_suppkey_prf#3594,rid#3595,ps_availqty_prf#3596,ps_comment_prf#3597,ps_partkey_prf#3598,ps_supplycost_prf#3599,ps_suppkey_prf#3600] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 11689ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/12 14:13:03 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:13:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3647L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 14:13:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3647L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [ps_partkey_and_ps_suppkey_prf#3649 AS ps_partkey_and_ps_suppkey_prf_0#3656, rid#3650 AS rid_0#3657, ps_availqty_prf#3651 AS ps_availqty_prf_0#3658, ps_comment_prf#3652 AS ps_comment_prf_0#3659, ps_partkey_prf#3653 AS ps_partkey_prf_0#3660, ps_supplycost_prf#3654 AS ps_supplycost_prf_0#3661, ps_suppkey_prf#3655 AS ps_suppkey_prf_0#3662]
         :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#3649,rid#3650,ps_availqty_prf#3651,ps_comment_prf#3652,ps_partkey_prf#3653,ps_supplycost_prf#3654,ps_suppkey_prf#3655] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3663, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3664]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey_and_l_suppkey~partsupp~ps_partkey_and_ps_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3665 AS l_returnflag_prf_1#3684, l_orderkey_and_l_linenumber_prf#3666 AS l_orderkey_and_l_linenumber_prf_1#3685, l_comment_prf#3667 AS l_comment_prf_1#3686, l_linestatus_prf#3668 AS l_linestatus_prf_1#3687, rid#3669 AS rid_1#3688, l_shipmode_prf#3670 AS l_shipmode_prf_1#3689, l_shipinstruct_prf#3671 AS l_shipinstruct_prf_1#3690, l_quantity_prf#3672 AS l_quantity_prf_1#3691, l_receiptdate_prf#3673 AS l_receiptdate_prf_1#3692, l_linenumber_prf#3674 AS l_linenumber_prf_1#3693, l_tax_prf#3675 AS l_tax_prf_1#3694, l_shipdate_prf#3676 AS l_shipdate_prf_1#3695, l_extendedprice_prf#3677 AS l_extendedprice_prf_1#3696, l_partkey_prf#3678 AS l_partkey_prf_1#3697, l_discount_prf#3679 AS l_discount_prf_1#3698, l_partkey_and_l_suppkey_prf#3680 AS l_partkey_and_l_suppkey_prf_1#3699, l_commitdate_prf#3681 AS l_commitdate_prf_1#3700, l_suppkey_prf#3682 AS l_suppkey_prf_1#3701, l_orderkey_prf#3683 AS l_orderkey_prf_1#3702]
            +- Relation[l_returnflag_prf#3665,l_orderkey_and_l_linenumber_prf#3666,l_comment_prf#3667,l_linestatus_prf#3668,rid#3669,l_shipmode_prf#3670,l_shipinstruct_prf#3671,l_quantity_prf#3672,l_receiptdate_prf#3673,l_linenumber_prf#3674,l_tax_prf#3675,l_shipdate_prf#3676,l_extendedprice_prf#3677,l_partkey_prf#3678,l_discount_prf#3679,l_partkey_and_l_suppkey_prf#3680,l_commitdate_prf#3681,l_suppkey_prf#3682,l_orderkey_prf#3683] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 105336ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/12 14:14:48 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:14:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3765L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 14:14:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3765L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#3767 AS l_returnflag_prf_0#3786, l_orderkey_and_l_linenumber_prf#3768 AS l_orderkey_and_l_linenumber_prf_0#3787, l_comment_prf#3769 AS l_comment_prf_0#3788, l_linestatus_prf#3770 AS l_linestatus_prf_0#3789, rid#3771 AS rid_0#3790, l_shipmode_prf#3772 AS l_shipmode_prf_0#3791, l_shipinstruct_prf#3773 AS l_shipinstruct_prf_0#3792, l_quantity_prf#3774 AS l_quantity_prf_0#3793, l_receiptdate_prf#3775 AS l_receiptdate_prf_0#3794, l_linenumber_prf#3776 AS l_linenumber_prf_0#3795, l_tax_prf#3777 AS l_tax_prf_0#3796, l_shipdate_prf#3778 AS l_shipdate_prf_0#3797, l_extendedprice_prf#3779 AS l_extendedprice_prf_0#3798, l_partkey_prf#3780 AS l_partkey_prf_0#3799, l_discount_prf#3781 AS l_discount_prf_0#3800, l_partkey_and_l_suppkey_prf#3782 AS l_partkey_and_l_suppkey_prf_0#3801, l_commitdate_prf#3783 AS l_commitdate_prf_0#3802, l_suppkey_prf#3784 AS l_suppkey_prf_0#3803, l_orderkey_prf#3785 AS l_orderkey_prf_0#3804]
         :  :  +- Relation[l_returnflag_prf#3767,l_orderkey_and_l_linenumber_prf#3768,l_comment_prf#3769,l_linestatus_prf#3770,rid#3771,l_shipmode_prf#3772,l_shipinstruct_prf#3773,l_quantity_prf#3774,l_receiptdate_prf#3775,l_linenumber_prf#3776,l_tax_prf#3777,l_shipdate_prf#3778,l_extendedprice_prf#3779,l_partkey_prf#3780,l_discount_prf#3781,l_partkey_and_l_suppkey_prf#3782,l_commitdate_prf#3783,l_suppkey_prf#3784,l_orderkey_prf#3785] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3805, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3806]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [o_shippriority_prf#3807 AS o_shippriority_prf_1#3817, rid#3808 AS rid_1#3818, o_orderdate_prf#3809 AS o_orderdate_prf_1#3819, o_custkey_prf#3810 AS o_custkey_prf_1#3820, o_orderpriority_prf#3811 AS o_orderpriority_prf_1#3821, o_clerk_prf#3812 AS o_clerk_prf_1#3822, o_orderstatus_prf#3813 AS o_orderstatus_prf_1#3823, o_totalprice_prf#3814 AS o_totalprice_prf_1#3824, o_orderkey_prf#3815 AS o_orderkey_prf_1#3825, o_comment_prf#3816 AS o_comment_prf_1#3826]
            :  :  +- Relation[o_shippriority_prf#3807,rid#3808,o_orderdate_prf#3809,o_custkey_prf#3810,o_orderpriority_prf#3811,o_clerk_prf#3812,o_orderstatus_prf#3813,o_totalprice_prf#3814,o_orderkey_prf#3815,o_comment_prf#3816] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3827, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3828]
            :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
            :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#3829 AS c_acctbal_prf_2#3838, rid#3830 AS rid_2#3839, c_name_prf#3831 AS c_name_prf_2#3840, c_nationkey_prf#3832 AS c_nationkey_prf_2#3841, c_custkey_prf#3833 AS c_custkey_prf_2#3842, c_comment_prf#3834 AS c_comment_prf_2#3843, c_address_prf#3835 AS c_address_prf_2#3844, c_mktsegment_prf#3836 AS c_mktsegment_prf_2#3845, c_phone_prf#3837 AS c_phone_prf_2#3846]
               +- Relation[c_acctbal_prf#3829,rid#3830,c_name_prf#3831,c_nationkey_prf#3832,c_custkey_prf#3833,c_comment_prf#3834,c_address_prf#3835,c_mktsegment_prf#3836,c_phone_prf#3837] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 182679ms

f2=
select * from part where p_size = 15
19/10/12 14:17:51 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:17:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3897L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 14:17:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3897L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#3899 AS p_comment_prf_0#3909, p_name_prf#3900 AS p_name_prf_0#3910, rid#3901 AS rid_0#3911, p_type_prf#3902 AS p_type_prf_0#3912, p_retailprice_prf#3903 AS p_retailprice_prf_0#3913, p_mfgr_prf#3904 AS p_mfgr_prf_0#3914, p_container_prf#3905 AS p_container_prf_0#3915, p_brand_prf#3906 AS p_brand_prf_0#3916, p_size_prf#3907 AS p_size_prf_0#3917, p_partkey_prf#3908 AS p_partkey_prf_0#3918]
         :  +- Relation[p_comment_prf#3899,p_name_prf#3900,rid#3901,p_type_prf#3902,p_retailprice_prf#3903,p_mfgr_prf#3904,p_container_prf#3905,p_brand_prf#3906,p_size_prf#3907,p_partkey_prf#3908] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3919]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1851,value#1852] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=3907
Elapsed time: 123ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/12 14:17:51 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:17:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3937L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 14:17:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3937L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#3939 AS rid_0#3944, n_regionkey_prf#3940 AS n_regionkey_prf_0#3945, n_nationkey_prf#3941 AS n_nationkey_prf_0#3946, n_name_prf#3942 AS n_name_prf_0#3947, n_comment_prf#3943 AS n_comment_prf_0#3948]
         :  +- Relation[rid#3939,n_regionkey_prf#3940,n_nationkey_prf#3941,n_name_prf#3942,n_comment_prf#3943] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3949]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1851,value#1852] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1
Elapsed time: 50ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/12 14:17:51 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:17:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3972L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 14:17:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3972L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [ps_partkey_and_ps_suppkey_prf#3974 AS ps_partkey_and_ps_suppkey_prf_0#3981, rid#3975 AS rid_0#3982, ps_availqty_prf#3976 AS ps_availqty_prf_0#3983, ps_comment_prf#3977 AS ps_comment_prf_0#3984, ps_partkey_prf#3978 AS ps_partkey_prf_0#3985, ps_supplycost_prf#3979 AS ps_supplycost_prf_0#3986, ps_suppkey_prf#3980 AS ps_suppkey_prf_0#3987]
         :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#3974,rid#3975,ps_availqty_prf#3976,ps_comment_prf#3977,ps_partkey_prf#3978,ps_supplycost_prf#3979,ps_suppkey_prf#3980] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3988, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3989]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#3990 AS p_comment_prf_1#4000, p_name_prf#3991 AS p_name_prf_1#4001, rid#3992 AS rid_1#4002, p_type_prf#3993 AS p_type_prf_1#4003, p_retailprice_prf#3994 AS p_retailprice_prf_1#4004, p_mfgr_prf#3995 AS p_mfgr_prf_1#4005, p_container_prf#3996 AS p_container_prf_1#4006, p_brand_prf#3997 AS p_brand_prf_1#4007, p_size_prf#3998 AS p_size_prf_1#4008, p_partkey_prf#3999 AS p_partkey_prf_1#4009]
            :  +- Relation[p_comment_prf#3990,p_name_prf#3991,rid#3992,p_type_prf#3993,p_retailprice_prf#3994,p_mfgr_prf#3995,p_container_prf#3996,p_brand_prf#3997,p_size_prf#3998,p_partkey_prf#3999] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4010]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1851,value#1852] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=15628
Elapsed time: 7766ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/12 14:17:59 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:17:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4045L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 14:17:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4045L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [p_comment_prf#4047 AS p_comment_prf_0#4057, p_name_prf#4048 AS p_name_prf_0#4058, rid#4049 AS rid_0#4059, p_type_prf#4050 AS p_type_prf_0#4060, p_retailprice_prf#4051 AS p_retailprice_prf_0#4061, p_mfgr_prf#4052 AS p_mfgr_prf_0#4062, p_container_prf#4053 AS p_container_prf_0#4063, p_brand_prf#4054 AS p_brand_prf_0#4064, p_size_prf#4055 AS p_size_prf_0#4065, p_partkey_prf#4056 AS p_partkey_prf_0#4066]
         :  :  +- Relation[p_comment_prf#4047,p_name_prf#4048,rid#4049,p_type_prf#4050,p_retailprice_prf#4051,p_mfgr_prf#4052,p_container_prf#4053,p_brand_prf#4054,p_size_prf#4055,p_partkey_prf#4056] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4067, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4068]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4069 AS ps_partkey_and_ps_suppkey_prf_1#4076, rid#4070 AS rid_1#4077, ps_availqty_prf#4071 AS ps_availqty_prf_1#4078, ps_comment_prf#4072 AS ps_comment_prf_1#4079, ps_partkey_prf#4073 AS ps_partkey_prf_1#4080, ps_supplycost_prf#4074 AS ps_supplycost_prf_1#4081, ps_suppkey_prf#4075 AS ps_suppkey_prf_1#4082]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4069,rid#4070,ps_availqty_prf#4071,ps_comment_prf#4072,ps_partkey_prf#4073,ps_supplycost_prf#4074,ps_suppkey_prf#4075] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 12130ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/12 14:18:11 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:18:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4122L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 14:18:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4122L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [s_phone_prf#4124 AS s_phone_prf_0#4132, rid#4125 AS rid_0#4133, s_address_prf#4126 AS s_address_prf_0#4134, s_nationkey_prf#4127 AS s_nationkey_prf_0#4135, s_suppkey_prf#4128 AS s_suppkey_prf_0#4136, s_name_prf#4129 AS s_name_prf_0#4137, s_acctbal_prf#4130 AS s_acctbal_prf_0#4138, s_comment_prf#4131 AS s_comment_prf_0#4139]
         :  :  :  :  +- Relation[s_phone_prf#4124,rid#4125,s_address_prf#4126,s_nationkey_prf#4127,s_suppkey_prf#4128,s_name_prf#4129,s_acctbal_prf#4130,s_comment_prf#4131] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4140, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4141]
         :  :  :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :  :  :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [rid#4142 AS rid_1#4147, n_regionkey_prf#4143 AS n_regionkey_prf_1#4148, n_nationkey_prf#4144 AS n_nationkey_prf_1#4149, n_name_prf#4145 AS n_name_prf_1#4150, n_comment_prf#4146 AS n_comment_prf_1#4151]
         :  :     +- Relation[rid#4142,n_regionkey_prf#4143,n_nationkey_prf#4144,n_name_prf#4145,n_comment_prf#4146] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4152, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4153]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4154 AS c_acctbal_prf_2#4163, rid#4155 AS rid_2#4164, c_name_prf#4156 AS c_name_prf_2#4165, c_nationkey_prf#4157 AS c_nationkey_prf_2#4166, c_custkey_prf#4158 AS c_custkey_prf_2#4167, c_comment_prf#4159 AS c_comment_prf_2#4168, c_address_prf#4160 AS c_address_prf_2#4169, c_mktsegment_prf#4161 AS c_mktsegment_prf_2#4170, c_phone_prf#4162 AS c_phone_prf_2#4171]
            +- Relation[c_acctbal_prf#4154,rid#4155,c_name_prf#4156,c_nationkey_prf#4157,c_custkey_prf#4158,c_comment_prf#4159,c_address_prf#4160,c_mktsegment_prf#4161,c_phone_prf#4162] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 900787ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/12 14:33:12 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:33:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4206L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 14:33:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4206L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#4208 AS p_comment_prf_0#4218, p_name_prf#4209 AS p_name_prf_0#4219, rid#4210 AS rid_0#4220, p_type_prf#4211 AS p_type_prf_0#4221, p_retailprice_prf#4212 AS p_retailprice_prf_0#4222, p_mfgr_prf#4213 AS p_mfgr_prf_0#4223, p_container_prf#4214 AS p_container_prf_0#4224, p_brand_prf#4215 AS p_brand_prf_0#4225, p_size_prf#4216 AS p_size_prf_0#4226, p_partkey_prf#4217 AS p_partkey_prf_0#4227]
         :  +- Relation[p_comment_prf#4208,p_name_prf#4209,rid#4210,p_type_prf#4211,p_retailprice_prf#4212,p_mfgr_prf#4213,p_container_prf#4214,p_brand_prf#4215,p_size_prf#4216,p_partkey_prf#4217] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4228]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1851,value#1852] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1451
Elapsed time: 83ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/12 14:33:12 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:33:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4275L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 14:33:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4275L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#4277 AS c_acctbal_prf_0#4286, rid#4278 AS rid_0#4287, c_name_prf#4279 AS c_name_prf_0#4288, c_nationkey_prf#4280 AS c_nationkey_prf_0#4289, c_custkey_prf#4281 AS c_custkey_prf_0#4290, c_comment_prf#4282 AS c_comment_prf_0#4291, c_address_prf#4283 AS c_address_prf_0#4292, c_mktsegment_prf#4284 AS c_mktsegment_prf_0#4293, c_phone_prf#4285 AS c_phone_prf_0#4294]
         :  :  +- Relation[c_acctbal_prf#4277,rid#4278,c_name_prf#4279,c_nationkey_prf#4280,c_custkey_prf#4281,c_comment_prf#4282,c_address_prf#4283,c_mktsegment_prf#4284,c_phone_prf#4285] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4295, dexdecrypt('value_dec_key, 'value_right) AS rid_2#4296]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [l_returnflag_prf#4297 AS l_returnflag_prf_1#4316, l_orderkey_and_l_linenumber_prf#4298 AS l_orderkey_and_l_linenumber_prf_1#4317, l_comment_prf#4299 AS l_comment_prf_1#4318, l_linestatus_prf#4300 AS l_linestatus_prf_1#4319, rid#4301 AS rid_1#4320, l_shipmode_prf#4302 AS l_shipmode_prf_1#4321, l_shipinstruct_prf#4303 AS l_shipinstruct_prf_1#4322, l_quantity_prf#4304 AS l_quantity_prf_1#4323, l_receiptdate_prf#4305 AS l_receiptdate_prf_1#4324, l_linenumber_prf#4306 AS l_linenumber_prf_1#4325, l_tax_prf#4307 AS l_tax_prf_1#4326, l_shipdate_prf#4308 AS l_shipdate_prf_1#4327, l_extendedprice_prf#4309 AS l_extendedprice_prf_1#4328, l_partkey_prf#4310 AS l_partkey_prf_1#4329, l_discount_prf#4311 AS l_discount_prf_1#4330, l_partkey_and_l_suppkey_prf#4312 AS l_partkey_and_l_suppkey_prf_1#4331, l_commitdate_prf#4313 AS l_commitdate_prf_1#4332, l_suppkey_prf#4314 AS l_suppkey_prf_1#4333, l_orderkey_prf#4315 AS l_orderkey_prf_1#4334]
            :  :  +- Relation[l_returnflag_prf#4297,l_orderkey_and_l_linenumber_prf#4298,l_comment_prf#4299,l_linestatus_prf#4300,rid#4301,l_shipmode_prf#4302,l_shipinstruct_prf#4303,l_quantity_prf#4304,l_receiptdate_prf#4305,l_linenumber_prf#4306,l_tax_prf#4307,l_shipdate_prf#4308,l_extendedprice_prf#4309,l_partkey_prf#4310,l_discount_prf#4311,l_partkey_and_l_suppkey_prf#4312,l_commitdate_prf#4313,l_suppkey_prf#4314,l_orderkey_prf#4315] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4335, dexdecrypt('value_dec_key, 'value_right) AS rid_2#4336]
            :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
            :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4337 AS o_shippriority_prf_2#4347, rid#4338 AS rid_2#4348, o_orderdate_prf#4339 AS o_orderdate_prf_2#4349, o_custkey_prf#4340 AS o_custkey_prf_2#4350, o_orderpriority_prf#4341 AS o_orderpriority_prf_2#4351, o_clerk_prf#4342 AS o_clerk_prf_2#4352, o_orderstatus_prf#4343 AS o_orderstatus_prf_2#4353, o_totalprice_prf#4344 AS o_totalprice_prf_2#4354, o_orderkey_prf#4345 AS o_orderkey_prf_2#4355, o_comment_prf#4346 AS o_comment_prf_2#4356]
               +- Relation[o_shippriority_prf#4337,rid#4338,o_orderdate_prf#4339,o_custkey_prf#4340,o_orderpriority_prf#4341,o_clerk_prf#4342,o_orderstatus_prf#4343,o_totalprice_prf#4344,o_orderkey_prf#4345,o_comment_prf#4346] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 142675ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/12 14:35:35 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:35:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4414L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 14:35:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4414L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#4416 AS l_returnflag_prf_0#4435, l_orderkey_and_l_linenumber_prf#4417 AS l_orderkey_and_l_linenumber_prf_0#4436, l_comment_prf#4418 AS l_comment_prf_0#4437, l_linestatus_prf#4419 AS l_linestatus_prf_0#4438, rid#4420 AS rid_0#4439, l_shipmode_prf#4421 AS l_shipmode_prf_0#4440, l_shipinstruct_prf#4422 AS l_shipinstruct_prf_0#4441, l_quantity_prf#4423 AS l_quantity_prf_0#4442, l_receiptdate_prf#4424 AS l_receiptdate_prf_0#4443, l_linenumber_prf#4425 AS l_linenumber_prf_0#4444, l_tax_prf#4426 AS l_tax_prf_0#4445, l_shipdate_prf#4427 AS l_shipdate_prf_0#4446, l_extendedprice_prf#4428 AS l_extendedprice_prf_0#4447, l_partkey_prf#4429 AS l_partkey_prf_0#4448, l_discount_prf#4430 AS l_discount_prf_0#4449, l_partkey_and_l_suppkey_prf#4431 AS l_partkey_and_l_suppkey_prf_0#4450, l_commitdate_prf#4432 AS l_commitdate_prf_0#4451, l_suppkey_prf#4433 AS l_suppkey_prf_0#4452, l_orderkey_prf#4434 AS l_orderkey_prf_0#4453]
         :  +- Relation[l_returnflag_prf#4416,l_orderkey_and_l_linenumber_prf#4417,l_comment_prf#4418,l_linestatus_prf#4419,rid#4420,l_shipmode_prf#4421,l_shipinstruct_prf#4422,l_quantity_prf#4423,l_receiptdate_prf#4424,l_linenumber_prf#4425,l_tax_prf#4426,l_shipdate_prf#4427,l_extendedprice_prf#4428,l_partkey_prf#4429,l_discount_prf#4430,l_partkey_and_l_suppkey_prf#4431,l_commitdate_prf#4432,l_suppkey_prf#4433,l_orderkey_prf#4434] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4454]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1851,value#1852] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 23480ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/12 14:35:58 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:35:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4493L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 14:35:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4493L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#4495 AS l_returnflag_prf_0#4514, l_orderkey_and_l_linenumber_prf#4496 AS l_orderkey_and_l_linenumber_prf_0#4515, l_comment_prf#4497 AS l_comment_prf_0#4516, l_linestatus_prf#4498 AS l_linestatus_prf_0#4517, rid#4499 AS rid_0#4518, l_shipmode_prf#4500 AS l_shipmode_prf_0#4519, l_shipinstruct_prf#4501 AS l_shipinstruct_prf_0#4520, l_quantity_prf#4502 AS l_quantity_prf_0#4521, l_receiptdate_prf#4503 AS l_receiptdate_prf_0#4522, l_linenumber_prf#4504 AS l_linenumber_prf_0#4523, l_tax_prf#4505 AS l_tax_prf_0#4524, l_shipdate_prf#4506 AS l_shipdate_prf_0#4525, l_extendedprice_prf#4507 AS l_extendedprice_prf_0#4526, l_partkey_prf#4508 AS l_partkey_prf_0#4527, l_discount_prf#4509 AS l_discount_prf_0#4528, l_partkey_and_l_suppkey_prf#4510 AS l_partkey_and_l_suppkey_prf_0#4529, l_commitdate_prf#4511 AS l_commitdate_prf_0#4530, l_suppkey_prf#4512 AS l_suppkey_prf_0#4531, l_orderkey_prf#4513 AS l_orderkey_prf_0#4532]
         :  +- Relation[l_returnflag_prf#4495,l_orderkey_and_l_linenumber_prf#4496,l_comment_prf#4497,l_linestatus_prf#4498,rid#4499,l_shipmode_prf#4500,l_shipinstruct_prf#4501,l_quantity_prf#4502,l_receiptdate_prf#4503,l_linenumber_prf#4504,l_tax_prf#4505,l_shipdate_prf#4506,l_extendedprice_prf#4507,l_partkey_prf#4508,l_discount_prf#4509,l_partkey_and_l_suppkey_prf#4510,l_commitdate_prf#4511,l_suppkey_prf#4512,l_orderkey_prf#4513] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4533]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1851,value#1852] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=857401
Elapsed time: 13703ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/12 14:36:12 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:36:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4581L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 14:36:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4581L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#4583 AS l_returnflag_prf_0#4602, l_orderkey_and_l_linenumber_prf#4584 AS l_orderkey_and_l_linenumber_prf_0#4603, l_comment_prf#4585 AS l_comment_prf_0#4604, l_linestatus_prf#4586 AS l_linestatus_prf_0#4605, rid#4587 AS rid_0#4606, l_shipmode_prf#4588 AS l_shipmode_prf_0#4607, l_shipinstruct_prf#4589 AS l_shipinstruct_prf_0#4608, l_quantity_prf#4590 AS l_quantity_prf_0#4609, l_receiptdate_prf#4591 AS l_receiptdate_prf_0#4610, l_linenumber_prf#4592 AS l_linenumber_prf_0#4611, l_tax_prf#4593 AS l_tax_prf_0#4612, l_shipdate_prf#4594 AS l_shipdate_prf_0#4613, l_extendedprice_prf#4595 AS l_extendedprice_prf_0#4614, l_partkey_prf#4596 AS l_partkey_prf_0#4615, l_discount_prf#4597 AS l_discount_prf_0#4616, l_partkey_and_l_suppkey_prf#4598 AS l_partkey_and_l_suppkey_prf_0#4617, l_commitdate_prf#4599 AS l_commitdate_prf_0#4618, l_suppkey_prf#4600 AS l_suppkey_prf_0#4619, l_orderkey_prf#4601 AS l_orderkey_prf_0#4620]
         :  :  +- Relation[l_returnflag_prf#4583,l_orderkey_and_l_linenumber_prf#4584,l_comment_prf#4585,l_linestatus_prf#4586,rid#4587,l_shipmode_prf#4588,l_shipinstruct_prf#4589,l_quantity_prf#4590,l_receiptdate_prf#4591,l_linenumber_prf#4592,l_tax_prf#4593,l_shipdate_prf#4594,l_extendedprice_prf#4595,l_partkey_prf#4596,l_discount_prf#4597,l_partkey_and_l_suppkey_prf#4598,l_commitdate_prf#4599,l_suppkey_prf#4600,l_orderkey_prf#4601] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4621, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4622]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [p_comment_prf#4623 AS p_comment_prf_1#4633, p_name_prf#4624 AS p_name_prf_1#4634, rid#4625 AS rid_1#4635, p_type_prf#4626 AS p_type_prf_1#4636, p_retailprice_prf#4627 AS p_retailprice_prf_1#4637, p_mfgr_prf#4628 AS p_mfgr_prf_1#4638, p_container_prf#4629 AS p_container_prf_1#4639, p_brand_prf#4630 AS p_brand_prf_1#4640, p_size_prf#4631 AS p_size_prf_1#4641, p_partkey_prf#4632 AS p_partkey_prf_1#4642]
            +- Relation[p_comment_prf#4623,p_name_prf#4624,rid#4625,p_type_prf#4626,p_retailprice_prf#4627,p_mfgr_prf#4628,p_container_prf#4629,p_brand_prf#4630,p_size_prf#4631,p_partkey_prf#4632] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 95070ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/12 14:37:47 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:37:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4708L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 14:37:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4708L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [c_acctbal_prf#4710 AS c_acctbal_prf_0#4719, rid#4711 AS rid_0#4720, c_name_prf#4712 AS c_name_prf_0#4721, c_nationkey_prf#4713 AS c_nationkey_prf_0#4722, c_custkey_prf#4714 AS c_custkey_prf_0#4723, c_comment_prf#4715 AS c_comment_prf_0#4724, c_address_prf#4716 AS c_address_prf_0#4725, c_mktsegment_prf#4717 AS c_mktsegment_prf_0#4726, c_phone_prf#4718 AS c_phone_prf_0#4727]
         :  :  :  :  +- Relation[c_acctbal_prf#4710,rid#4711,c_name_prf#4712,c_nationkey_prf#4713,c_custkey_prf#4714,c_comment_prf#4715,c_address_prf#4716,c_mktsegment_prf#4717,c_phone_prf#4718] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4728, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4729]
         :  :  :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :  :  :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#4730 AS o_shippriority_prf_1#4740, rid#4731 AS rid_1#4741, o_orderdate_prf#4732 AS o_orderdate_prf_1#4742, o_custkey_prf#4733 AS o_custkey_prf_1#4743, o_orderpriority_prf#4734 AS o_orderpriority_prf_1#4744, o_clerk_prf#4735 AS o_clerk_prf_1#4745, o_orderstatus_prf#4736 AS o_orderstatus_prf_1#4746, o_totalprice_prf#4737 AS o_totalprice_prf_1#4747, o_orderkey_prf#4738 AS o_orderkey_prf_1#4748, o_comment_prf#4739 AS o_comment_prf_1#4749]
         :  :     +- Relation[o_shippriority_prf#4730,rid#4731,o_orderdate_prf#4732,o_custkey_prf#4733,o_orderpriority_prf#4734,o_clerk_prf#4735,o_orderstatus_prf#4736,o_totalprice_prf#4737,o_orderkey_prf#4738,o_comment_prf#4739] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4750, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4751]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4752 AS l_returnflag_prf_2#4771, l_orderkey_and_l_linenumber_prf#4753 AS l_orderkey_and_l_linenumber_prf_2#4772, l_comment_prf#4754 AS l_comment_prf_2#4773, l_linestatus_prf#4755 AS l_linestatus_prf_2#4774, rid#4756 AS rid_2#4775, l_shipmode_prf#4757 AS l_shipmode_prf_2#4776, l_shipinstruct_prf#4758 AS l_shipinstruct_prf_2#4777, l_quantity_prf#4759 AS l_quantity_prf_2#4778, l_receiptdate_prf#4760 AS l_receiptdate_prf_2#4779, l_linenumber_prf#4761 AS l_linenumber_prf_2#4780, l_tax_prf#4762 AS l_tax_prf_2#4781, l_shipdate_prf#4763 AS l_shipdate_prf_2#4782, l_extendedprice_prf#4764 AS l_extendedprice_prf_2#4783, l_partkey_prf#4765 AS l_partkey_prf_2#4784, l_discount_prf#4766 AS l_discount_prf_2#4785, l_partkey_and_l_suppkey_prf#4767 AS l_partkey_and_l_suppkey_prf_2#4786, l_commitdate_prf#4768 AS l_commitdate_prf_2#4787, l_suppkey_prf#4769 AS l_suppkey_prf_2#4788, l_orderkey_prf#4770 AS l_orderkey_prf_2#4789]
            +- Relation[l_returnflag_prf#4752,l_orderkey_and_l_linenumber_prf#4753,l_comment_prf#4754,l_linestatus_prf#4755,rid#4756,l_shipmode_prf#4757,l_shipinstruct_prf#4758,l_quantity_prf#4759,l_receiptdate_prf#4760,l_linenumber_prf#4761,l_tax_prf#4762,l_shipdate_prf#4763,l_extendedprice_prf#4764,l_partkey_prf#4765,l_discount_prf#4766,l_partkey_and_l_suppkey_prf#4767,l_commitdate_prf#4768,l_suppkey_prf#4769,l_orderkey_prf#4770] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 169171ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/12 14:40:36 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:40:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4856L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 14:40:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4856L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#4858 AS l_returnflag_prf_0#4877, l_orderkey_and_l_linenumber_prf#4859 AS l_orderkey_and_l_linenumber_prf_0#4878, l_comment_prf#4860 AS l_comment_prf_0#4879, l_linestatus_prf#4861 AS l_linestatus_prf_0#4880, rid#4862 AS rid_0#4881, l_shipmode_prf#4863 AS l_shipmode_prf_0#4882, l_shipinstruct_prf#4864 AS l_shipinstruct_prf_0#4883, l_quantity_prf#4865 AS l_quantity_prf_0#4884, l_receiptdate_prf#4866 AS l_receiptdate_prf_0#4885, l_linenumber_prf#4867 AS l_linenumber_prf_0#4886, l_tax_prf#4868 AS l_tax_prf_0#4887, l_shipdate_prf#4869 AS l_shipdate_prf_0#4888, l_extendedprice_prf#4870 AS l_extendedprice_prf_0#4889, l_partkey_prf#4871 AS l_partkey_prf_0#4890, l_discount_prf#4872 AS l_discount_prf_0#4891, l_partkey_and_l_suppkey_prf#4873 AS l_partkey_and_l_suppkey_prf_0#4892, l_commitdate_prf#4874 AS l_commitdate_prf_0#4893, l_suppkey_prf#4875 AS l_suppkey_prf_0#4894, l_orderkey_prf#4876 AS l_orderkey_prf_0#4895]
         :  :  +- Relation[l_returnflag_prf#4858,l_orderkey_and_l_linenumber_prf#4859,l_comment_prf#4860,l_linestatus_prf#4861,rid#4862,l_shipmode_prf#4863,l_shipinstruct_prf#4864,l_quantity_prf#4865,l_receiptdate_prf#4866,l_linenumber_prf#4867,l_tax_prf#4868,l_shipdate_prf#4869,l_extendedprice_prf#4870,l_partkey_prf#4871,l_discount_prf#4872,l_partkey_and_l_suppkey_prf#4873,l_commitdate_prf#4874,l_suppkey_prf#4875,l_orderkey_prf#4876] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4896, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4897]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4898 AS o_shippriority_prf_1#4908, rid#4899 AS rid_1#4909, o_orderdate_prf#4900 AS o_orderdate_prf_1#4910, o_custkey_prf#4901 AS o_custkey_prf_1#4911, o_orderpriority_prf#4902 AS o_orderpriority_prf_1#4912, o_clerk_prf#4903 AS o_clerk_prf_1#4913, o_orderstatus_prf#4904 AS o_orderstatus_prf_1#4914, o_totalprice_prf#4905 AS o_totalprice_prf_1#4915, o_orderkey_prf#4906 AS o_orderkey_prf_1#4916, o_comment_prf#4907 AS o_comment_prf_1#4917]
            +- Relation[o_shippriority_prf#4898,rid#4899,o_orderdate_prf#4900,o_custkey_prf#4901,o_orderpriority_prf#4902,o_clerk_prf#4903,o_orderstatus_prf#4904,o_totalprice_prf#4905,o_orderkey_prf#4906,o_comment_prf#4907] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 106868ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/12 14:42:23 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:42:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4982L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 14:42:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4982L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4984 AS s_phone_prf_0#4992, rid#4985 AS rid_0#4993, s_address_prf#4986 AS s_address_prf_0#4994, s_nationkey_prf#4987 AS s_nationkey_prf_0#4995, s_suppkey_prf#4988 AS s_suppkey_prf_0#4996, s_name_prf#4989 AS s_name_prf_0#4997, s_acctbal_prf#4990 AS s_acctbal_prf_0#4998, s_comment_prf#4991 AS s_comment_prf_0#4999]
         :  :  +- Relation[s_phone_prf#4984,rid#4985,s_address_prf#4986,s_nationkey_prf#4987,s_suppkey_prf#4988,s_name_prf#4989,s_acctbal_prf#4990,s_comment_prf#4991] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#5000, dexdecrypt('value_dec_key, 'value_right) AS rid_0#5001]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [p_comment_prf#5002 AS p_comment_prf_1#5012, p_name_prf#5003 AS p_name_prf_1#5013, rid#5004 AS rid_1#5014, p_type_prf#5005 AS p_type_prf_1#5015, p_retailprice_prf#5006 AS p_retailprice_prf_1#5016, p_mfgr_prf#5007 AS p_mfgr_prf_1#5017, p_container_prf#5008 AS p_container_prf_1#5018, p_brand_prf#5009 AS p_brand_prf_1#5019, p_size_prf#5010 AS p_size_prf_1#5020, p_partkey_prf#5011 AS p_partkey_prf_1#5021]
            :  :  +- Relation[p_comment_prf#5002,p_name_prf#5003,rid#5004,p_type_prf#5005,p_retailprice_prf#5006,p_mfgr_prf#5007,p_container_prf#5008,p_brand_prf#5009,p_size_prf#5010,p_partkey_prf#5011] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#5022, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5023]
            :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
            :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#5024 AS l_returnflag_prf_2#5043, l_orderkey_and_l_linenumber_prf#5025 AS l_orderkey_and_l_linenumber_prf_2#5044, l_comment_prf#5026 AS l_comment_prf_2#5045, l_linestatus_prf#5027 AS l_linestatus_prf_2#5046, rid#5028 AS rid_2#5047, l_shipmode_prf#5029 AS l_shipmode_prf_2#5048, l_shipinstruct_prf#5030 AS l_shipinstruct_prf_2#5049, l_quantity_prf#5031 AS l_quantity_prf_2#5050, l_receiptdate_prf#5032 AS l_receiptdate_prf_2#5051, l_linenumber_prf#5033 AS l_linenumber_prf_2#5052, l_tax_prf#5034 AS l_tax_prf_2#5053, l_shipdate_prf#5035 AS l_shipdate_prf_2#5054, l_extendedprice_prf#5036 AS l_extendedprice_prf_2#5055, l_partkey_prf#5037 AS l_partkey_prf_2#5056, l_discount_prf#5038 AS l_discount_prf_2#5057, l_partkey_and_l_suppkey_prf#5039 AS l_partkey_and_l_suppkey_prf_2#5058, l_commitdate_prf#5040 AS l_commitdate_prf_2#5059, l_suppkey_prf#5041 AS l_suppkey_prf_2#5060, l_orderkey_prf#5042 AS l_orderkey_prf_2#5061]
               +- Relation[l_returnflag_prf#5024,l_orderkey_and_l_linenumber_prf#5025,l_comment_prf#5026,l_linestatus_prf#5027,rid#5028,l_shipmode_prf#5029,l_shipinstruct_prf#5030,l_quantity_prf#5031,l_receiptdate_prf#5032,l_linenumber_prf#5033,l_tax_prf#5034,l_shipdate_prf#5035,l_extendedprice_prf#5036,l_partkey_prf#5037,l_discount_prf#5038,l_partkey_and_l_suppkey_prf#5039,l_commitdate_prf#5040,l_suppkey_prf#5041,l_orderkey_prf#5042] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201424ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/12 14:45:44 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:45:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5113L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 14:45:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5113L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [rid#5115 AS rid_0#5120, n_regionkey_prf#5116 AS n_regionkey_prf_0#5121, n_nationkey_prf#5117 AS n_nationkey_prf_0#5122, n_name_prf#5118 AS n_name_prf_0#5123, n_comment_prf#5119 AS n_comment_prf_0#5124]
         :  :  +- Relation[rid#5115,n_regionkey_prf#5116,n_nationkey_prf#5117,n_name_prf#5118,n_comment_prf#5119] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5125, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5126]
         :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#5127 AS s_phone_prf_1#5135, rid#5128 AS rid_1#5136, s_address_prf#5129 AS s_address_prf_1#5137, s_nationkey_prf#5130 AS s_nationkey_prf_1#5138, s_suppkey_prf#5131 AS s_suppkey_prf_1#5139, s_name_prf#5132 AS s_name_prf_1#5140, s_acctbal_prf#5133 AS s_acctbal_prf_1#5141, s_comment_prf#5134 AS s_comment_prf_1#5142]
            +- Relation[s_phone_prf#5127,rid#5128,s_address_prf#5129,s_nationkey_prf#5130,s_suppkey_prf#5131,s_name_prf#5132,s_acctbal_prf#5133,s_comment_prf#5134] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=10000
Elapsed time: 230ms

f1=
select * from region where r_name = 'EUROPE'
19/10/12 14:45:45 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:45:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5162L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/12 14:45:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5162L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#5164 AS r_regionkey_prf_0#5168, r_name_prf#5165 AS r_name_prf_0#5169, r_comment_prf#5166 AS r_comment_prf_0#5170, rid#5167 AS rid_0#5171]
         :  +- Relation[r_regionkey_prf#5164,r_name_prf#5165,r_comment_prf#5166,rid#5167] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5172]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1851,value#1852] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1
Elapsed time: 48ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/12 14:45:45 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:45:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5197L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 14:45:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5197L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#5199 AS c_acctbal_prf_0#5208, rid#5200 AS rid_0#5209, c_name_prf#5201 AS c_name_prf_0#5210, c_nationkey_prf#5202 AS c_nationkey_prf_0#5211, c_custkey_prf#5203 AS c_custkey_prf_0#5212, c_comment_prf#5204 AS c_comment_prf_0#5213, c_address_prf#5205 AS c_address_prf_0#5214, c_mktsegment_prf#5206 AS c_mktsegment_prf_0#5215, c_phone_prf#5207 AS c_phone_prf_0#5216]
         :  :  +- Relation[c_acctbal_prf#5199,rid#5200,c_name_prf#5201,c_nationkey_prf#5202,c_custkey_prf#5203,c_comment_prf#5204,c_address_prf#5205,c_mktsegment_prf#5206,c_phone_prf#5207] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5217, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5218]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#5219 AS o_shippriority_prf_1#5229, rid#5220 AS rid_1#5230, o_orderdate_prf#5221 AS o_orderdate_prf_1#5231, o_custkey_prf#5222 AS o_custkey_prf_1#5232, o_orderpriority_prf#5223 AS o_orderpriority_prf_1#5233, o_clerk_prf#5224 AS o_clerk_prf_1#5234, o_orderstatus_prf#5225 AS o_orderstatus_prf_1#5235, o_totalprice_prf#5226 AS o_totalprice_prf_1#5236, o_orderkey_prf#5227 AS o_orderkey_prf_1#5237, o_comment_prf#5228 AS o_comment_prf_1#5238]
            +- Relation[o_shippriority_prf#5219,rid#5220,o_orderdate_prf#5221,o_custkey_prf#5222,o_orderpriority_prf#5223,o_clerk_prf#5224,o_orderstatus_prf#5225,o_totalprice_prf#5226,o_orderkey_prf#5227,o_comment_prf#5228] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=1500000
Elapsed time: 23584ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/12 14:46:08 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:46:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5282L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 14:46:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5282L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [p_comment_prf#5284 AS p_comment_prf_0#5294, p_name_prf#5285 AS p_name_prf_0#5295, rid#5286 AS rid_0#5296, p_type_prf#5287 AS p_type_prf_0#5297, p_retailprice_prf#5288 AS p_retailprice_prf_0#5298, p_mfgr_prf#5289 AS p_mfgr_prf_0#5299, p_container_prf#5290 AS p_container_prf_0#5300, p_brand_prf#5291 AS p_brand_prf_0#5301, p_size_prf#5292 AS p_size_prf_0#5302, p_partkey_prf#5293 AS p_partkey_prf_0#5303]
         :  :  :  :  +- Relation[p_comment_prf#5284,p_name_prf#5285,rid#5286,p_type_prf#5287,p_retailprice_prf#5288,p_mfgr_prf#5289,p_container_prf#5290,p_brand_prf#5291,p_size_prf#5292,p_partkey_prf#5293] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5304, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5305]
         :  :  :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :  :  :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#5306 AS ps_partkey_and_ps_suppkey_prf_1#5313, rid#5307 AS rid_1#5314, ps_availqty_prf#5308 AS ps_availqty_prf_1#5315, ps_comment_prf#5309 AS ps_comment_prf_1#5316, ps_partkey_prf#5310 AS ps_partkey_prf_1#5317, ps_supplycost_prf#5311 AS ps_supplycost_prf_1#5318, ps_suppkey_prf#5312 AS ps_suppkey_prf_1#5319]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#5306,rid#5307,ps_availqty_prf#5308,ps_comment_prf#5309,ps_partkey_prf#5310,ps_supplycost_prf#5311,ps_suppkey_prf#5312] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#5320, dexdecrypt('value_dec_key, 'value_right) AS rid_2#5321]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#5322 AS s_phone_prf_2#5330, rid#5323 AS rid_2#5331, s_address_prf#5324 AS s_address_prf_2#5332, s_nationkey_prf#5325 AS s_nationkey_prf_2#5333, s_suppkey_prf#5326 AS s_suppkey_prf_2#5334, s_name_prf#5327 AS s_name_prf_2#5335, s_acctbal_prf#5328 AS s_acctbal_prf_2#5336, s_comment_prf#5329 AS s_comment_prf_2#5337]
            +- Relation[s_phone_prf#5322,rid#5323,s_address_prf#5324,s_nationkey_prf#5325,s_suppkey_prf#5326,s_name_prf#5327,s_acctbal_prf#5328,s_comment_prf#5329] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26069ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/12 14:46:34 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:46:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5387L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 14:46:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5387L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#5389 AS s_phone_prf_0#5397, rid#5390 AS rid_0#5398, s_address_prf#5391 AS s_address_prf_0#5399, s_nationkey_prf#5392 AS s_nationkey_prf_0#5400, s_suppkey_prf#5393 AS s_suppkey_prf_0#5401, s_name_prf#5394 AS s_name_prf_0#5402, s_acctbal_prf#5395 AS s_acctbal_prf_0#5403, s_comment_prf#5396 AS s_comment_prf_0#5404]
         :  :  +- Relation[s_phone_prf#5389,rid#5390,s_address_prf#5391,s_nationkey_prf#5392,s_suppkey_prf#5393,s_name_prf#5394,s_acctbal_prf#5395,s_comment_prf#5396] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#5405, dexdecrypt('value_dec_key, 'value_right) AS rid_0#5406]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [ps_partkey_and_ps_suppkey_prf#5407 AS ps_partkey_and_ps_suppkey_prf_1#5414, rid#5408 AS rid_1#5415, ps_availqty_prf#5409 AS ps_availqty_prf_1#5416, ps_comment_prf#5410 AS ps_comment_prf_1#5417, ps_partkey_prf#5411 AS ps_partkey_prf_1#5418, ps_supplycost_prf#5412 AS ps_supplycost_prf_1#5419, ps_suppkey_prf#5413 AS ps_suppkey_prf_1#5420]
            :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#5407,rid#5408,ps_availqty_prf#5409,ps_comment_prf#5410,ps_partkey_prf#5411,ps_supplycost_prf#5412,ps_suppkey_prf#5413] JDBCRelation(partsupp_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#5421, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5422]
            :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
            :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [p_comment_prf#5423 AS p_comment_prf_2#5433, p_name_prf#5424 AS p_name_prf_2#5434, rid#5425 AS rid_2#5435, p_type_prf#5426 AS p_type_prf_2#5436, p_retailprice_prf#5427 AS p_retailprice_prf_2#5437, p_mfgr_prf#5428 AS p_mfgr_prf_2#5438, p_container_prf#5429 AS p_container_prf_2#5439, p_brand_prf#5430 AS p_brand_prf_2#5440, p_size_prf#5431 AS p_size_prf_2#5441, p_partkey_prf#5432 AS p_partkey_prf_2#5442]
               +- Relation[p_comment_prf#5423,p_name_prf#5424,rid#5425,p_type_prf#5426,p_retailprice_prf#5427,p_mfgr_prf#5428,p_container_prf#5429,p_brand_prf#5430,p_size_prf#5431,p_partkey_prf#5432] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26208ms
query=b1a, count=15628, duration=7767
query=b1b, count=15628, duration=7766
query=b2a, count=1478870, duration=97738
query=b2b, count=1478870, duration=97594
query=f1, count=1, duration=48
query=f2, count=3907, duration=123
query=f3, count=1451, duration=83
query=f4, count=1, duration=50
query=f5, count=1478870, duration=23480
query=f6, count=857401, duration=13703
query=j1, count=800000, duration=12130
query=j10, count=6001215, duration=90074
query=j2, count=800000, duration=11689
query=j3, count=25, duration=256
query=j4, count=150000, duration=2539
query=j5, count=10000, duration=230
query=j6, count=6001215, duration=105336
query=j7, count=1500000, duration=23584
query=j8, count=6001215, duration=107262
query=j8b, count=6001215, duration=106868
query=j9, count=6001215, duration=94935
query=j9b, count=6001215, duration=95070
query=r1a, count=6001215, duration=182784
query=r1b, count=6001215, duration=182679
query=r1c, count=6001215, duration=182083
query=r1d, count=6001215, duration=169171
query=r1e, count=6001215, duration=169845
query=r1f, count=6001215, duration=142675
query=t1a, count=60000414, duration=900787
query=t1b, count=60000414, duration=880352
query=t1c, count=60000414, duration=926809
query=t2a, count=800000, duration=26062
query=t2b, count=800000, duration=26069
query=t2c, count=800000, duration=26185
query=t2d, count=800000, duration=26208
query=t3a, count=6001215, duration=200696
query=t3b, count=6001215, duration=201980
query=t3c, count=6001215, duration=201424
query=t3d, count=6001215, duration=200759
