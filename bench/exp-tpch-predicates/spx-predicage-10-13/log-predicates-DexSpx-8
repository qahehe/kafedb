19/10/12 14:47:01 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7014ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Oct 12 14:47:04 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Oct 12 14:47:05 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Oct 12 14:47:05 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Oct 12 14:47:05 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Oct 12 14:47:05 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Oct 12 14:47:07 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Oct 12 14:47:10 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Oct 12 14:47:10 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/12 14:47:11 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:47:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1478L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 14:47:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1478L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [r_regionkey_prf#1480 AS r_regionkey_prf_0#1484, r_name_prf#1481 AS r_name_prf_0#1485, r_comment_prf#1482 AS r_comment_prf_0#1486, rid#1483 AS rid_0#1487]
         :  :  +- Relation[r_regionkey_prf#1480,r_name_prf#1481,r_comment_prf#1482,rid#1483] JDBCRelation(region_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1491, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1492]
         :     +- SpxRidUncorrelatedJoin nation~n_regionkey~region~r_regionkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [rid#1493 AS rid_1#1498, n_regionkey_prf#1494 AS n_regionkey_prf_1#1499, n_nationkey_prf#1495 AS n_nationkey_prf_1#1500, n_name_prf#1496 AS n_name_prf_1#1501, n_comment_prf#1497 AS n_comment_prf_1#1502]
            +- Relation[rid#1493,n_regionkey_prf#1494,n_nationkey_prf#1495,n_name_prf#1496,n_comment_prf#1497] JDBCRelation(nation_prf) [numPartitions=1]

DexSpx$ result size=25
Elapsed time: 251ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/12 14:47:11 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:47:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1547L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 14:47:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1547L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [l_returnflag_prf#1549 AS l_returnflag_prf_0#1568, l_orderkey_and_l_linenumber_prf#1550 AS l_orderkey_and_l_linenumber_prf_0#1569, l_comment_prf#1551 AS l_comment_prf_0#1570, l_linestatus_prf#1552 AS l_linestatus_prf_0#1571, rid#1553 AS rid_0#1572, l_shipmode_prf#1554 AS l_shipmode_prf_0#1573, l_shipinstruct_prf#1555 AS l_shipinstruct_prf_0#1574, l_quantity_prf#1556 AS l_quantity_prf_0#1575, l_receiptdate_prf#1557 AS l_receiptdate_prf_0#1576, l_linenumber_prf#1558 AS l_linenumber_prf_0#1577, l_tax_prf#1559 AS l_tax_prf_0#1578, l_shipdate_prf#1560 AS l_shipdate_prf_0#1579, l_extendedprice_prf#1561 AS l_extendedprice_prf_0#1580, l_partkey_prf#1562 AS l_partkey_prf_0#1581, l_discount_prf#1563 AS l_discount_prf_0#1582, l_partkey_and_l_suppkey_prf#1564 AS l_partkey_and_l_suppkey_prf_0#1583, l_commitdate_prf#1565 AS l_commitdate_prf_0#1584, l_suppkey_prf#1566 AS l_suppkey_prf_0#1585, l_orderkey_prf#1567 AS l_orderkey_prf_0#1586]
         :  :  :  :  +- Relation[l_returnflag_prf#1549,l_orderkey_and_l_linenumber_prf#1550,l_comment_prf#1551,l_linestatus_prf#1552,rid#1553,l_shipmode_prf#1554,l_shipinstruct_prf#1555,l_quantity_prf#1556,l_receiptdate_prf#1557,l_linenumber_prf#1558,l_tax_prf#1559,l_shipdate_prf#1560,l_extendedprice_prf#1561,l_partkey_prf#1562,l_discount_prf#1563,l_partkey_and_l_suppkey_prf#1564,l_commitdate_prf#1565,l_suppkey_prf#1566,l_orderkey_prf#1567] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1587, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1588]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :  :  :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#1589 AS p_comment_prf_1#1599, p_name_prf#1590 AS p_name_prf_1#1600, rid#1591 AS rid_1#1601, p_type_prf#1592 AS p_type_prf_1#1602, p_retailprice_prf#1593 AS p_retailprice_prf_1#1603, p_mfgr_prf#1594 AS p_mfgr_prf_1#1604, p_container_prf#1595 AS p_container_prf_1#1605, p_brand_prf#1596 AS p_brand_prf_1#1606, p_size_prf#1597 AS p_size_prf_1#1607, p_partkey_prf#1598 AS p_partkey_prf_1#1608]
         :  :     +- Relation[p_comment_prf#1589,p_name_prf#1590,rid#1591,p_type_prf#1592,p_retailprice_prf#1593,p_mfgr_prf#1594,p_container_prf#1595,p_brand_prf#1596,p_size_prf#1597,p_partkey_prf#1598] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1609, dexdecrypt('value_dec_key, 'value_right) AS rid_2#1610]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#1611 AS s_phone_prf_2#1619, rid#1612 AS rid_2#1620, s_address_prf#1613 AS s_address_prf_2#1621, s_nationkey_prf#1614 AS s_nationkey_prf_2#1622, s_suppkey_prf#1615 AS s_suppkey_prf_2#1623, s_name_prf#1616 AS s_name_prf_2#1624, s_acctbal_prf#1617 AS s_acctbal_prf_2#1625, s_comment_prf#1618 AS s_comment_prf_2#1626]
            +- Relation[s_phone_prf#1611,rid#1612,s_address_prf#1613,s_nationkey_prf#1614,s_suppkey_prf#1615,s_name_prf#1616,s_acctbal_prf#1617,s_comment_prf#1618] JDBCRelation(supplier_prf) [numPartitions=1]

19/10/12 14:47:11 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexSpx$ result size=6001215
Elapsed time: 202320ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/12 14:50:33 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:50:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1681L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 14:50:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1681L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [ps_partkey_and_ps_suppkey_prf#1683 AS ps_partkey_and_ps_suppkey_prf_0#1690, rid#1684 AS rid_0#1691, ps_availqty_prf#1685 AS ps_availqty_prf_0#1692, ps_comment_prf#1686 AS ps_comment_prf_0#1693, ps_partkey_prf#1687 AS ps_partkey_prf_0#1694, ps_supplycost_prf#1688 AS ps_supplycost_prf_0#1695, ps_suppkey_prf#1689 AS ps_suppkey_prf_0#1696]
         :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#1683,rid#1684,ps_availqty_prf#1685,ps_comment_prf#1686,ps_partkey_prf#1687,ps_supplycost_prf#1688,ps_suppkey_prf#1689] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1697, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1698]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#1699 AS p_comment_prf_1#1709, p_name_prf#1700 AS p_name_prf_1#1710, rid#1701 AS rid_1#1711, p_type_prf#1702 AS p_type_prf_1#1712, p_retailprice_prf#1703 AS p_retailprice_prf_1#1713, p_mfgr_prf#1704 AS p_mfgr_prf_1#1714, p_container_prf#1705 AS p_container_prf_1#1715, p_brand_prf#1706 AS p_brand_prf_1#1716, p_size_prf#1707 AS p_size_prf_1#1717, p_partkey_prf#1708 AS p_partkey_prf_1#1718]
            :  +- Relation[p_comment_prf#1699,p_name_prf#1700,rid#1701,p_type_prf#1702,p_retailprice_prf#1703,p_mfgr_prf#1704,p_container_prf#1705,p_brand_prf#1706,p_size_prf#1707,p_partkey_prf#1708] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#1721]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1719,value#1720] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=15628
Elapsed time: 7733ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/12 14:50:41 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 14:50:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1761L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 14:50:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1761L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [s_phone_prf#1763 AS s_phone_prf_0#1771, rid#1764 AS rid_0#1772, s_address_prf#1765 AS s_address_prf_0#1773, s_nationkey_prf#1766 AS s_nationkey_prf_0#1774, s_suppkey_prf#1767 AS s_suppkey_prf_0#1775, s_name_prf#1768 AS s_name_prf_0#1776, s_acctbal_prf#1769 AS s_acctbal_prf_0#1777, s_comment_prf#1770 AS s_comment_prf_0#1778]
         :  :  :  :  +- Relation[s_phone_prf#1763,rid#1764,s_address_prf#1765,s_nationkey_prf#1766,s_suppkey_prf#1767,s_name_prf#1768,s_acctbal_prf#1769,s_comment_prf#1770] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1779, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1780]
         :  :  :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :  :  :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [rid#1781 AS rid_1#1786, n_regionkey_prf#1782 AS n_regionkey_prf_1#1787, n_nationkey_prf#1783 AS n_nationkey_prf_1#1788, n_name_prf#1784 AS n_name_prf_1#1789, n_comment_prf#1785 AS n_comment_prf_1#1790]
         :  :     +- Relation[rid#1781,n_regionkey_prf#1782,n_nationkey_prf#1783,n_name_prf#1784,n_comment_prf#1785] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#1791, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1792]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#1793 AS c_acctbal_prf_2#1802, rid#1794 AS rid_2#1803, c_name_prf#1795 AS c_name_prf_2#1804, c_nationkey_prf#1796 AS c_nationkey_prf_2#1805, c_custkey_prf#1797 AS c_custkey_prf_2#1806, c_comment_prf#1798 AS c_comment_prf_2#1807, c_address_prf#1799 AS c_address_prf_2#1808, c_mktsegment_prf#1800 AS c_mktsegment_prf_2#1809, c_phone_prf#1801 AS c_phone_prf_2#1810]
            +- Relation[c_acctbal_prf#1793,rid#1794,c_name_prf#1795,c_nationkey_prf#1796,c_custkey_prf#1797,c_comment_prf#1798,c_address_prf#1799,c_mktsegment_prf#1800,c_phone_prf#1801] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 887962ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/12 15:05:29 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:05:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1852L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 15:05:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1852L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#1854 AS l_returnflag_prf_0#1873, l_orderkey_and_l_linenumber_prf#1855 AS l_orderkey_and_l_linenumber_prf_0#1874, l_comment_prf#1856 AS l_comment_prf_0#1875, l_linestatus_prf#1857 AS l_linestatus_prf_0#1876, rid#1858 AS rid_0#1877, l_shipmode_prf#1859 AS l_shipmode_prf_0#1878, l_shipinstruct_prf#1860 AS l_shipinstruct_prf_0#1879, l_quantity_prf#1861 AS l_quantity_prf_0#1880, l_receiptdate_prf#1862 AS l_receiptdate_prf_0#1881, l_linenumber_prf#1863 AS l_linenumber_prf_0#1882, l_tax_prf#1864 AS l_tax_prf_0#1883, l_shipdate_prf#1865 AS l_shipdate_prf_0#1884, l_extendedprice_prf#1866 AS l_extendedprice_prf_0#1885, l_partkey_prf#1867 AS l_partkey_prf_0#1886, l_discount_prf#1868 AS l_discount_prf_0#1887, l_partkey_and_l_suppkey_prf#1869 AS l_partkey_and_l_suppkey_prf_0#1888, l_commitdate_prf#1870 AS l_commitdate_prf_0#1889, l_suppkey_prf#1871 AS l_suppkey_prf_0#1890, l_orderkey_prf#1872 AS l_orderkey_prf_0#1891]
         :  +- Relation[l_returnflag_prf#1854,l_orderkey_and_l_linenumber_prf#1855,l_comment_prf#1856,l_linestatus_prf#1857,rid#1858,l_shipmode_prf#1859,l_shipinstruct_prf#1860,l_quantity_prf#1861,l_receiptdate_prf#1862,l_linenumber_prf#1863,l_tax_prf#1864,l_shipdate_prf#1865,l_extendedprice_prf#1866,l_partkey_prf#1867,l_discount_prf#1868,l_partkey_and_l_suppkey_prf#1869,l_commitdate_prf#1870,l_suppkey_prf#1871,l_orderkey_prf#1872] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1892]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1719,value#1720] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=857401
Elapsed time: 13658ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/12 15:05:43 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:05:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1924L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 15:05:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1924L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#1926 AS p_comment_prf_0#1936, p_name_prf#1927 AS p_name_prf_0#1937, rid#1928 AS rid_0#1938, p_type_prf#1929 AS p_type_prf_0#1939, p_retailprice_prf#1930 AS p_retailprice_prf_0#1940, p_mfgr_prf#1931 AS p_mfgr_prf_0#1941, p_container_prf#1932 AS p_container_prf_0#1942, p_brand_prf#1933 AS p_brand_prf_0#1943, p_size_prf#1934 AS p_size_prf_0#1944, p_partkey_prf#1935 AS p_partkey_prf_0#1945]
         :  +- Relation[p_comment_prf#1926,p_name_prf#1927,rid#1928,p_type_prf#1929,p_retailprice_prf#1930,p_mfgr_prf#1931,p_container_prf#1932,p_brand_prf#1933,p_size_prf#1934,p_partkey_prf#1935] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1946]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1719,value#1720] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1451
Elapsed time: 87ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/12 15:05:43 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:05:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1981L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 15:05:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1981L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#1983 AS s_phone_prf_0#1991, rid#1984 AS rid_0#1992, s_address_prf#1985 AS s_address_prf_0#1993, s_nationkey_prf#1986 AS s_nationkey_prf_0#1994, s_suppkey_prf#1987 AS s_suppkey_prf_0#1995, s_name_prf#1988 AS s_name_prf_0#1996, s_acctbal_prf#1989 AS s_acctbal_prf_0#1997, s_comment_prf#1990 AS s_comment_prf_0#1998]
         :  :  +- Relation[s_phone_prf#1983,rid#1984,s_address_prf#1985,s_nationkey_prf#1986,s_suppkey_prf#1987,s_name_prf#1988,s_acctbal_prf#1989,s_comment_prf#1990] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#1999, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2000]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [p_comment_prf#2001 AS p_comment_prf_1#2011, p_name_prf#2002 AS p_name_prf_1#2012, rid#2003 AS rid_1#2013, p_type_prf#2004 AS p_type_prf_1#2014, p_retailprice_prf#2005 AS p_retailprice_prf_1#2015, p_mfgr_prf#2006 AS p_mfgr_prf_1#2016, p_container_prf#2007 AS p_container_prf_1#2017, p_brand_prf#2008 AS p_brand_prf_1#2018, p_size_prf#2009 AS p_size_prf_1#2019, p_partkey_prf#2010 AS p_partkey_prf_1#2020]
            :  :  +- Relation[p_comment_prf#2001,p_name_prf#2002,rid#2003,p_type_prf#2004,p_retailprice_prf#2005,p_mfgr_prf#2006,p_container_prf#2007,p_brand_prf#2008,p_size_prf#2009,p_partkey_prf#2010] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2021, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2022]
            :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
            :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#2023 AS ps_partkey_and_ps_suppkey_prf_2#2030, rid#2024 AS rid_2#2031, ps_availqty_prf#2025 AS ps_availqty_prf_2#2032, ps_comment_prf#2026 AS ps_comment_prf_2#2033, ps_partkey_prf#2027 AS ps_partkey_prf_2#2034, ps_supplycost_prf#2028 AS ps_supplycost_prf_2#2035, ps_suppkey_prf#2029 AS ps_suppkey_prf_2#2036]
               +- Relation[ps_partkey_and_ps_suppkey_prf#2023,rid#2024,ps_availqty_prf#2025,ps_comment_prf#2026,ps_partkey_prf#2027,ps_supplycost_prf#2028,ps_suppkey_prf#2029] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26195ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/12 15:06:09 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:06:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2097L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 15:06:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2097L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#2099 AS s_phone_prf_0#2107, rid#2100 AS rid_0#2108, s_address_prf#2101 AS s_address_prf_0#2109, s_nationkey_prf#2102 AS s_nationkey_prf_0#2110, s_suppkey_prf#2103 AS s_suppkey_prf_0#2111, s_name_prf#2104 AS s_name_prf_0#2112, s_acctbal_prf#2105 AS s_acctbal_prf_0#2113, s_comment_prf#2106 AS s_comment_prf_0#2114]
         :  :  +- Relation[s_phone_prf#2099,rid#2100,s_address_prf#2101,s_nationkey_prf#2102,s_suppkey_prf#2103,s_name_prf#2104,s_acctbal_prf#2105,s_comment_prf#2106] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2115, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2116]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [l_returnflag_prf#2117 AS l_returnflag_prf_1#2136, l_orderkey_and_l_linenumber_prf#2118 AS l_orderkey_and_l_linenumber_prf_1#2137, l_comment_prf#2119 AS l_comment_prf_1#2138, l_linestatus_prf#2120 AS l_linestatus_prf_1#2139, rid#2121 AS rid_1#2140, l_shipmode_prf#2122 AS l_shipmode_prf_1#2141, l_shipinstruct_prf#2123 AS l_shipinstruct_prf_1#2142, l_quantity_prf#2124 AS l_quantity_prf_1#2143, l_receiptdate_prf#2125 AS l_receiptdate_prf_1#2144, l_linenumber_prf#2126 AS l_linenumber_prf_1#2145, l_tax_prf#2127 AS l_tax_prf_1#2146, l_shipdate_prf#2128 AS l_shipdate_prf_1#2147, l_extendedprice_prf#2129 AS l_extendedprice_prf_1#2148, l_partkey_prf#2130 AS l_partkey_prf_1#2149, l_discount_prf#2131 AS l_discount_prf_1#2150, l_partkey_and_l_suppkey_prf#2132 AS l_partkey_and_l_suppkey_prf_1#2151, l_commitdate_prf#2133 AS l_commitdate_prf_1#2152, l_suppkey_prf#2134 AS l_suppkey_prf_1#2153, l_orderkey_prf#2135 AS l_orderkey_prf_1#2154]
            :  :  +- Relation[l_returnflag_prf#2117,l_orderkey_and_l_linenumber_prf#2118,l_comment_prf#2119,l_linestatus_prf#2120,rid#2121,l_shipmode_prf#2122,l_shipinstruct_prf#2123,l_quantity_prf#2124,l_receiptdate_prf#2125,l_linenumber_prf#2126,l_tax_prf#2127,l_shipdate_prf#2128,l_extendedprice_prf#2129,l_partkey_prf#2130,l_discount_prf#2131,l_partkey_and_l_suppkey_prf#2132,l_commitdate_prf#2133,l_suppkey_prf#2134,l_orderkey_prf#2135] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2155, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2156]
            :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
            :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [p_comment_prf#2157 AS p_comment_prf_2#2167, p_name_prf#2158 AS p_name_prf_2#2168, rid#2159 AS rid_2#2169, p_type_prf#2160 AS p_type_prf_2#2170, p_retailprice_prf#2161 AS p_retailprice_prf_2#2171, p_mfgr_prf#2162 AS p_mfgr_prf_2#2172, p_container_prf#2163 AS p_container_prf_2#2173, p_brand_prf#2164 AS p_brand_prf_2#2174, p_size_prf#2165 AS p_size_prf_2#2175, p_partkey_prf#2166 AS p_partkey_prf_2#2176]
               +- Relation[p_comment_prf#2157,p_name_prf#2158,rid#2159,p_type_prf#2160,p_retailprice_prf#2161,p_mfgr_prf#2162,p_container_prf#2163,p_brand_prf#2164,p_size_prf#2165,p_partkey_prf#2166] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 202561ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/12 15:09:32 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:09:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2249L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 15:09:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2249L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [p_comment_prf#2251 AS p_comment_prf_0#2261, p_name_prf#2252 AS p_name_prf_0#2262, rid#2253 AS rid_0#2263, p_type_prf#2254 AS p_type_prf_0#2264, p_retailprice_prf#2255 AS p_retailprice_prf_0#2265, p_mfgr_prf#2256 AS p_mfgr_prf_0#2266, p_container_prf#2257 AS p_container_prf_0#2267, p_brand_prf#2258 AS p_brand_prf_0#2268, p_size_prf#2259 AS p_size_prf_0#2269, p_partkey_prf#2260 AS p_partkey_prf_0#2270]
         :  :  :  :  +- Relation[p_comment_prf#2251,p_name_prf#2252,rid#2253,p_type_prf#2254,p_retailprice_prf#2255,p_mfgr_prf#2256,p_container_prf#2257,p_brand_prf#2258,p_size_prf#2259,p_partkey_prf#2260] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2271, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2272]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :  :  :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#2273 AS l_returnflag_prf_1#2292, l_orderkey_and_l_linenumber_prf#2274 AS l_orderkey_and_l_linenumber_prf_1#2293, l_comment_prf#2275 AS l_comment_prf_1#2294, l_linestatus_prf#2276 AS l_linestatus_prf_1#2295, rid#2277 AS rid_1#2296, l_shipmode_prf#2278 AS l_shipmode_prf_1#2297, l_shipinstruct_prf#2279 AS l_shipinstruct_prf_1#2298, l_quantity_prf#2280 AS l_quantity_prf_1#2299, l_receiptdate_prf#2281 AS l_receiptdate_prf_1#2300, l_linenumber_prf#2282 AS l_linenumber_prf_1#2301, l_tax_prf#2283 AS l_tax_prf_1#2302, l_shipdate_prf#2284 AS l_shipdate_prf_1#2303, l_extendedprice_prf#2285 AS l_extendedprice_prf_1#2304, l_partkey_prf#2286 AS l_partkey_prf_1#2305, l_discount_prf#2287 AS l_discount_prf_1#2306, l_partkey_and_l_suppkey_prf#2288 AS l_partkey_and_l_suppkey_prf_1#2307, l_commitdate_prf#2289 AS l_commitdate_prf_1#2308, l_suppkey_prf#2290 AS l_suppkey_prf_1#2309, l_orderkey_prf#2291 AS l_orderkey_prf_1#2310]
         :  :     +- Relation[l_returnflag_prf#2273,l_orderkey_and_l_linenumber_prf#2274,l_comment_prf#2275,l_linestatus_prf#2276,rid#2277,l_shipmode_prf#2278,l_shipinstruct_prf#2279,l_quantity_prf#2280,l_receiptdate_prf#2281,l_linenumber_prf#2282,l_tax_prf#2283,l_shipdate_prf#2284,l_extendedprice_prf#2285,l_partkey_prf#2286,l_discount_prf#2287,l_partkey_and_l_suppkey_prf#2288,l_commitdate_prf#2289,l_suppkey_prf#2290,l_orderkey_prf#2291] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2311, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2312]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#2313 AS s_phone_prf_2#2321, rid#2314 AS rid_2#2322, s_address_prf#2315 AS s_address_prf_2#2323, s_nationkey_prf#2316 AS s_nationkey_prf_2#2324, s_suppkey_prf#2317 AS s_suppkey_prf_2#2325, s_name_prf#2318 AS s_name_prf_2#2326, s_acctbal_prf#2319 AS s_acctbal_prf_2#2327, s_comment_prf#2320 AS s_comment_prf_2#2328]
            +- Relation[s_phone_prf#2313,rid#2314,s_address_prf#2315,s_nationkey_prf#2316,s_suppkey_prf#2317,s_name_prf#2318,s_acctbal_prf#2319,s_comment_prf#2320] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201434ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/12 15:12:53 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:12:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2394L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 15:12:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2394L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [p_comment_prf#2396 AS p_comment_prf_0#2406, p_name_prf#2397 AS p_name_prf_0#2407, rid#2398 AS rid_0#2408, p_type_prf#2399 AS p_type_prf_0#2409, p_retailprice_prf#2400 AS p_retailprice_prf_0#2410, p_mfgr_prf#2401 AS p_mfgr_prf_0#2411, p_container_prf#2402 AS p_container_prf_0#2412, p_brand_prf#2403 AS p_brand_prf_0#2413, p_size_prf#2404 AS p_size_prf_0#2414, p_partkey_prf#2405 AS p_partkey_prf_0#2415]
         :  :  +- Relation[p_comment_prf#2396,p_name_prf#2397,rid#2398,p_type_prf#2399,p_retailprice_prf#2400,p_mfgr_prf#2401,p_container_prf#2402,p_brand_prf#2403,p_size_prf#2404,p_partkey_prf#2405] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2416, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2417]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2418 AS l_returnflag_prf_1#2437, l_orderkey_and_l_linenumber_prf#2419 AS l_orderkey_and_l_linenumber_prf_1#2438, l_comment_prf#2420 AS l_comment_prf_1#2439, l_linestatus_prf#2421 AS l_linestatus_prf_1#2440, rid#2422 AS rid_1#2441, l_shipmode_prf#2423 AS l_shipmode_prf_1#2442, l_shipinstruct_prf#2424 AS l_shipinstruct_prf_1#2443, l_quantity_prf#2425 AS l_quantity_prf_1#2444, l_receiptdate_prf#2426 AS l_receiptdate_prf_1#2445, l_linenumber_prf#2427 AS l_linenumber_prf_1#2446, l_tax_prf#2428 AS l_tax_prf_1#2447, l_shipdate_prf#2429 AS l_shipdate_prf_1#2448, l_extendedprice_prf#2430 AS l_extendedprice_prf_1#2449, l_partkey_prf#2431 AS l_partkey_prf_1#2450, l_discount_prf#2432 AS l_discount_prf_1#2451, l_partkey_and_l_suppkey_prf#2433 AS l_partkey_and_l_suppkey_prf_1#2452, l_commitdate_prf#2434 AS l_commitdate_prf_1#2453, l_suppkey_prf#2435 AS l_suppkey_prf_1#2454, l_orderkey_prf#2436 AS l_orderkey_prf_1#2455]
            +- Relation[l_returnflag_prf#2418,l_orderkey_and_l_linenumber_prf#2419,l_comment_prf#2420,l_linestatus_prf#2421,rid#2422,l_shipmode_prf#2423,l_shipinstruct_prf#2424,l_quantity_prf#2425,l_receiptdate_prf#2426,l_linenumber_prf#2427,l_tax_prf#2428,l_shipdate_prf#2429,l_extendedprice_prf#2430,l_partkey_prf#2431,l_discount_prf#2432,l_partkey_and_l_suppkey_prf#2433,l_commitdate_prf#2434,l_suppkey_prf#2435,l_orderkey_prf#2436] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 95637ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/12 15:14:29 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:14:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2509L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 15:14:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2509L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [ps_partkey_and_ps_suppkey_prf#2511 AS ps_partkey_and_ps_suppkey_prf_0#2518, rid#2512 AS rid_0#2519, ps_availqty_prf#2513 AS ps_availqty_prf_0#2520, ps_comment_prf#2514 AS ps_comment_prf_0#2521, ps_partkey_prf#2515 AS ps_partkey_prf_0#2522, ps_supplycost_prf#2516 AS ps_supplycost_prf_0#2523, ps_suppkey_prf#2517 AS ps_suppkey_prf_0#2524]
         :  :  :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#2511,rid#2512,ps_availqty_prf#2513,ps_comment_prf#2514,ps_partkey_prf#2515,ps_supplycost_prf#2516,ps_suppkey_prf#2517] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2525, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2526]
         :  :  :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :  :  :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#2527 AS p_comment_prf_1#2537, p_name_prf#2528 AS p_name_prf_1#2538, rid#2529 AS rid_1#2539, p_type_prf#2530 AS p_type_prf_1#2540, p_retailprice_prf#2531 AS p_retailprice_prf_1#2541, p_mfgr_prf#2532 AS p_mfgr_prf_1#2542, p_container_prf#2533 AS p_container_prf_1#2543, p_brand_prf#2534 AS p_brand_prf_1#2544, p_size_prf#2535 AS p_size_prf_1#2545, p_partkey_prf#2536 AS p_partkey_prf_1#2546]
         :  :     +- Relation[p_comment_prf#2527,p_name_prf#2528,rid#2529,p_type_prf#2530,p_retailprice_prf#2531,p_mfgr_prf#2532,p_container_prf#2533,p_brand_prf#2534,p_size_prf#2535,p_partkey_prf#2536] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2547, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2548]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#2549 AS s_phone_prf_2#2557, rid#2550 AS rid_2#2558, s_address_prf#2551 AS s_address_prf_2#2559, s_nationkey_prf#2552 AS s_nationkey_prf_2#2560, s_suppkey_prf#2553 AS s_suppkey_prf_2#2561, s_name_prf#2554 AS s_name_prf_2#2562, s_acctbal_prf#2555 AS s_acctbal_prf_2#2563, s_comment_prf#2556 AS s_comment_prf_2#2564]
            +- Relation[s_phone_prf#2549,rid#2550,s_address_prf#2551,s_nationkey_prf#2552,s_suppkey_prf#2553,s_name_prf#2554,s_acctbal_prf#2555,s_comment_prf#2556] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26061ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/12 15:14:55 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:14:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2616L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 15:14:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2616L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#2618 AS s_phone_prf_0#2626, rid#2619 AS rid_0#2627, s_address_prf#2620 AS s_address_prf_0#2628, s_nationkey_prf#2621 AS s_nationkey_prf_0#2629, s_suppkey_prf#2622 AS s_suppkey_prf_0#2630, s_name_prf#2623 AS s_name_prf_0#2631, s_acctbal_prf#2624 AS s_acctbal_prf_0#2632, s_comment_prf#2625 AS s_comment_prf_0#2633]
         :  :  +- Relation[s_phone_prf#2618,rid#2619,s_address_prf#2620,s_nationkey_prf#2621,s_suppkey_prf#2622,s_name_prf#2623,s_acctbal_prf#2624,s_comment_prf#2625] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2634, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2635]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2636 AS l_returnflag_prf_1#2655, l_orderkey_and_l_linenumber_prf#2637 AS l_orderkey_and_l_linenumber_prf_1#2656, l_comment_prf#2638 AS l_comment_prf_1#2657, l_linestatus_prf#2639 AS l_linestatus_prf_1#2658, rid#2640 AS rid_1#2659, l_shipmode_prf#2641 AS l_shipmode_prf_1#2660, l_shipinstruct_prf#2642 AS l_shipinstruct_prf_1#2661, l_quantity_prf#2643 AS l_quantity_prf_1#2662, l_receiptdate_prf#2644 AS l_receiptdate_prf_1#2663, l_linenumber_prf#2645 AS l_linenumber_prf_1#2664, l_tax_prf#2646 AS l_tax_prf_1#2665, l_shipdate_prf#2647 AS l_shipdate_prf_1#2666, l_extendedprice_prf#2648 AS l_extendedprice_prf_1#2667, l_partkey_prf#2649 AS l_partkey_prf_1#2668, l_discount_prf#2650 AS l_discount_prf_1#2669, l_partkey_and_l_suppkey_prf#2651 AS l_partkey_and_l_suppkey_prf_1#2670, l_commitdate_prf#2652 AS l_commitdate_prf_1#2671, l_suppkey_prf#2653 AS l_suppkey_prf_1#2672, l_orderkey_prf#2654 AS l_orderkey_prf_1#2673]
            +- Relation[l_returnflag_prf#2636,l_orderkey_and_l_linenumber_prf#2637,l_comment_prf#2638,l_linestatus_prf#2639,rid#2640,l_shipmode_prf#2641,l_shipinstruct_prf#2642,l_quantity_prf#2643,l_receiptdate_prf#2644,l_linenumber_prf#2645,l_tax_prf#2646,l_shipdate_prf#2647,l_extendedprice_prf#2648,l_partkey_prf#2649,l_discount_prf#2650,l_partkey_and_l_suppkey_prf#2651,l_commitdate_prf#2652,l_suppkey_prf#2653,l_orderkey_prf#2654] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 88914ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/12 15:16:24 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:16:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2737L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 15:16:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2737L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#2739 AS c_acctbal_prf_0#2748, rid#2740 AS rid_0#2749, c_name_prf#2741 AS c_name_prf_0#2750, c_nationkey_prf#2742 AS c_nationkey_prf_0#2751, c_custkey_prf#2743 AS c_custkey_prf_0#2752, c_comment_prf#2744 AS c_comment_prf_0#2753, c_address_prf#2745 AS c_address_prf_0#2754, c_mktsegment_prf#2746 AS c_mktsegment_prf_0#2755, c_phone_prf#2747 AS c_phone_prf_0#2756]
         :  :  +- Relation[c_acctbal_prf#2739,rid#2740,c_name_prf#2741,c_nationkey_prf#2742,c_custkey_prf#2743,c_comment_prf#2744,c_address_prf#2745,c_mktsegment_prf#2746,c_phone_prf#2747] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2757, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2758]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [o_shippriority_prf#2759 AS o_shippriority_prf_1#2769, rid#2760 AS rid_1#2770, o_orderdate_prf#2761 AS o_orderdate_prf_1#2771, o_custkey_prf#2762 AS o_custkey_prf_1#2772, o_orderpriority_prf#2763 AS o_orderpriority_prf_1#2773, o_clerk_prf#2764 AS o_clerk_prf_1#2774, o_orderstatus_prf#2765 AS o_orderstatus_prf_1#2775, o_totalprice_prf#2766 AS o_totalprice_prf_1#2776, o_orderkey_prf#2767 AS o_orderkey_prf_1#2777, o_comment_prf#2768 AS o_comment_prf_1#2778]
            :  :  +- Relation[o_shippriority_prf#2759,rid#2760,o_orderdate_prf#2761,o_custkey_prf#2762,o_orderpriority_prf#2763,o_clerk_prf#2764,o_orderstatus_prf#2765,o_totalprice_prf#2766,o_orderkey_prf#2767,o_comment_prf#2768] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2779, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2780]
            :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
            :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2781 AS l_returnflag_prf_2#2800, l_orderkey_and_l_linenumber_prf#2782 AS l_orderkey_and_l_linenumber_prf_2#2801, l_comment_prf#2783 AS l_comment_prf_2#2802, l_linestatus_prf#2784 AS l_linestatus_prf_2#2803, rid#2785 AS rid_2#2804, l_shipmode_prf#2786 AS l_shipmode_prf_2#2805, l_shipinstruct_prf#2787 AS l_shipinstruct_prf_2#2806, l_quantity_prf#2788 AS l_quantity_prf_2#2807, l_receiptdate_prf#2789 AS l_receiptdate_prf_2#2808, l_linenumber_prf#2790 AS l_linenumber_prf_2#2809, l_tax_prf#2791 AS l_tax_prf_2#2810, l_shipdate_prf#2792 AS l_shipdate_prf_2#2811, l_extendedprice_prf#2793 AS l_extendedprice_prf_2#2812, l_partkey_prf#2794 AS l_partkey_prf_2#2813, l_discount_prf#2795 AS l_discount_prf_2#2814, l_partkey_and_l_suppkey_prf#2796 AS l_partkey_and_l_suppkey_prf_2#2815, l_commitdate_prf#2797 AS l_commitdate_prf_2#2816, l_suppkey_prf#2798 AS l_suppkey_prf_2#2817, l_orderkey_prf#2799 AS l_orderkey_prf_2#2818]
               +- Relation[l_returnflag_prf#2781,l_orderkey_and_l_linenumber_prf#2782,l_comment_prf#2783,l_linestatus_prf#2784,rid#2785,l_shipmode_prf#2786,l_shipinstruct_prf#2787,l_quantity_prf#2788,l_receiptdate_prf#2789,l_linenumber_prf#2790,l_tax_prf#2791,l_shipdate_prf#2792,l_extendedprice_prf#2793,l_partkey_prf#2794,l_discount_prf#2795,l_partkey_and_l_suppkey_prf#2796,l_commitdate_prf#2797,l_suppkey_prf#2798,l_orderkey_prf#2799] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 169065ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/12 15:19:13 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:19:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2885L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 15:19:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2885L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#2887 AS l_returnflag_prf_0#2906, l_orderkey_and_l_linenumber_prf#2888 AS l_orderkey_and_l_linenumber_prf_0#2907, l_comment_prf#2889 AS l_comment_prf_0#2908, l_linestatus_prf#2890 AS l_linestatus_prf_0#2909, rid#2891 AS rid_0#2910, l_shipmode_prf#2892 AS l_shipmode_prf_0#2911, l_shipinstruct_prf#2893 AS l_shipinstruct_prf_0#2912, l_quantity_prf#2894 AS l_quantity_prf_0#2913, l_receiptdate_prf#2895 AS l_receiptdate_prf_0#2914, l_linenumber_prf#2896 AS l_linenumber_prf_0#2915, l_tax_prf#2897 AS l_tax_prf_0#2916, l_shipdate_prf#2898 AS l_shipdate_prf_0#2917, l_extendedprice_prf#2899 AS l_extendedprice_prf_0#2918, l_partkey_prf#2900 AS l_partkey_prf_0#2919, l_discount_prf#2901 AS l_discount_prf_0#2920, l_partkey_and_l_suppkey_prf#2902 AS l_partkey_and_l_suppkey_prf_0#2921, l_commitdate_prf#2903 AS l_commitdate_prf_0#2922, l_suppkey_prf#2904 AS l_suppkey_prf_0#2923, l_orderkey_prf#2905 AS l_orderkey_prf_0#2924]
         :  :  +- Relation[l_returnflag_prf#2887,l_orderkey_and_l_linenumber_prf#2888,l_comment_prf#2889,l_linestatus_prf#2890,rid#2891,l_shipmode_prf#2892,l_shipinstruct_prf#2893,l_quantity_prf#2894,l_receiptdate_prf#2895,l_linenumber_prf#2896,l_tax_prf#2897,l_shipdate_prf#2898,l_extendedprice_prf#2899,l_partkey_prf#2900,l_discount_prf#2901,l_partkey_and_l_suppkey_prf#2902,l_commitdate_prf#2903,l_suppkey_prf#2904,l_orderkey_prf#2905] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2925, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2926]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2927 AS o_shippriority_prf_1#2937, rid#2928 AS rid_1#2938, o_orderdate_prf#2929 AS o_orderdate_prf_1#2939, o_custkey_prf#2930 AS o_custkey_prf_1#2940, o_orderpriority_prf#2931 AS o_orderpriority_prf_1#2941, o_clerk_prf#2932 AS o_clerk_prf_1#2942, o_orderstatus_prf#2933 AS o_orderstatus_prf_1#2943, o_totalprice_prf#2934 AS o_totalprice_prf_1#2944, o_orderkey_prf#2935 AS o_orderkey_prf_1#2945, o_comment_prf#2936 AS o_comment_prf_1#2946]
            +- Relation[o_shippriority_prf#2927,rid#2928,o_orderdate_prf#2929,o_custkey_prf#2930,o_orderpriority_prf#2931,o_clerk_prf#2932,o_orderstatus_prf#2933,o_totalprice_prf#2934,o_orderkey_prf#2935,o_comment_prf#2936] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 106767ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/12 15:21:00 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:21:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3004L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 15:21:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3004L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [o_shippriority_prf#3006 AS o_shippriority_prf_0#3016, rid#3007 AS rid_0#3017, o_orderdate_prf#3008 AS o_orderdate_prf_0#3018, o_custkey_prf#3009 AS o_custkey_prf_0#3019, o_orderpriority_prf#3010 AS o_orderpriority_prf_0#3020, o_clerk_prf#3011 AS o_clerk_prf_0#3021, o_orderstatus_prf#3012 AS o_orderstatus_prf_0#3022, o_totalprice_prf#3013 AS o_totalprice_prf_0#3023, o_orderkey_prf#3014 AS o_orderkey_prf_0#3024, o_comment_prf#3015 AS o_comment_prf_0#3025]
         :  :  +- Relation[o_shippriority_prf#3006,rid#3007,o_orderdate_prf#3008,o_custkey_prf#3009,o_orderpriority_prf#3010,o_clerk_prf#3011,o_orderstatus_prf#3012,o_totalprice_prf#3013,o_orderkey_prf#3014,o_comment_prf#3015] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3026, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3027]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#3028 AS l_returnflag_prf_1#3047, l_orderkey_and_l_linenumber_prf#3029 AS l_orderkey_and_l_linenumber_prf_1#3048, l_comment_prf#3030 AS l_comment_prf_1#3049, l_linestatus_prf#3031 AS l_linestatus_prf_1#3050, rid#3032 AS rid_1#3051, l_shipmode_prf#3033 AS l_shipmode_prf_1#3052, l_shipinstruct_prf#3034 AS l_shipinstruct_prf_1#3053, l_quantity_prf#3035 AS l_quantity_prf_1#3054, l_receiptdate_prf#3036 AS l_receiptdate_prf_1#3055, l_linenumber_prf#3037 AS l_linenumber_prf_1#3056, l_tax_prf#3038 AS l_tax_prf_1#3057, l_shipdate_prf#3039 AS l_shipdate_prf_1#3058, l_extendedprice_prf#3040 AS l_extendedprice_prf_1#3059, l_partkey_prf#3041 AS l_partkey_prf_1#3060, l_discount_prf#3042 AS l_discount_prf_1#3061, l_partkey_and_l_suppkey_prf#3043 AS l_partkey_and_l_suppkey_prf_1#3062, l_commitdate_prf#3044 AS l_commitdate_prf_1#3063, l_suppkey_prf#3045 AS l_suppkey_prf_1#3064, l_orderkey_prf#3046 AS l_orderkey_prf_1#3065]
            :  +- Relation[l_returnflag_prf#3028,l_orderkey_and_l_linenumber_prf#3029,l_comment_prf#3030,l_linestatus_prf#3031,rid#3032,l_shipmode_prf#3033,l_shipinstruct_prf#3034,l_quantity_prf#3035,l_receiptdate_prf#3036,l_linenumber_prf#3037,l_tax_prf#3038,l_shipdate_prf#3039,l_extendedprice_prf#3040,l_partkey_prf#3041,l_discount_prf#3042,l_partkey_and_l_suppkey_prf#3043,l_commitdate_prf#3044,l_suppkey_prf#3045,l_orderkey_prf#3046] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3066]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1719,value#1720] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 98417ms

f2=
select * from part where p_size = 15
19/10/12 15:22:38 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:22:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3108L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 15:22:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3108L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#3110 AS p_comment_prf_0#3120, p_name_prf#3111 AS p_name_prf_0#3121, rid#3112 AS rid_0#3122, p_type_prf#3113 AS p_type_prf_0#3123, p_retailprice_prf#3114 AS p_retailprice_prf_0#3124, p_mfgr_prf#3115 AS p_mfgr_prf_0#3125, p_container_prf#3116 AS p_container_prf_0#3126, p_brand_prf#3117 AS p_brand_prf_0#3127, p_size_prf#3118 AS p_size_prf_0#3128, p_partkey_prf#3119 AS p_partkey_prf_0#3129]
         :  +- Relation[p_comment_prf#3110,p_name_prf#3111,rid#3112,p_type_prf#3113,p_retailprice_prf#3114,p_mfgr_prf#3115,p_container_prf#3116,p_brand_prf#3117,p_size_prf#3118,p_partkey_prf#3119] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3130]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1719,value#1720] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=3907
Elapsed time: 123ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/12 15:22:38 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:22:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3163L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 15:22:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3163L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#3165 AS c_acctbal_prf_0#3174, rid#3166 AS rid_0#3175, c_name_prf#3167 AS c_name_prf_0#3176, c_nationkey_prf#3168 AS c_nationkey_prf_0#3177, c_custkey_prf#3169 AS c_custkey_prf_0#3178, c_comment_prf#3170 AS c_comment_prf_0#3179, c_address_prf#3171 AS c_address_prf_0#3180, c_mktsegment_prf#3172 AS c_mktsegment_prf_0#3181, c_phone_prf#3173 AS c_phone_prf_0#3182]
         :  :  +- Relation[c_acctbal_prf#3165,rid#3166,c_name_prf#3167,c_nationkey_prf#3168,c_custkey_prf#3169,c_comment_prf#3170,c_address_prf#3171,c_mktsegment_prf#3172,c_phone_prf#3173] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3183, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3184]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [s_phone_prf#3185 AS s_phone_prf_1#3193, rid#3186 AS rid_1#3194, s_address_prf#3187 AS s_address_prf_1#3195, s_nationkey_prf#3188 AS s_nationkey_prf_1#3196, s_suppkey_prf#3189 AS s_suppkey_prf_1#3197, s_name_prf#3190 AS s_name_prf_1#3198, s_acctbal_prf#3191 AS s_acctbal_prf_1#3199, s_comment_prf#3192 AS s_comment_prf_1#3200]
            :  :  +- Relation[s_phone_prf#3185,rid#3186,s_address_prf#3187,s_nationkey_prf#3188,s_suppkey_prf#3189,s_name_prf#3190,s_acctbal_prf#3191,s_comment_prf#3192] JDBCRelation(supplier_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3201, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3202]
            :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
            :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [rid#3203 AS rid_2#3208, n_regionkey_prf#3204 AS n_regionkey_prf_2#3209, n_nationkey_prf#3205 AS n_nationkey_prf_2#3210, n_name_prf#3206 AS n_name_prf_2#3211, n_comment_prf#3207 AS n_comment_prf_2#3212]
               +- Relation[rid#3203,n_regionkey_prf#3204,n_nationkey_prf#3205,n_name_prf#3206,n_comment_prf#3207] JDBCRelation(nation_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 902171ms

f1=
select * from region where r_name = 'EUROPE'
19/10/12 15:37:40 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:37:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3241L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/12 15:37:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3241L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#3243 AS r_regionkey_prf_0#3247, r_name_prf#3244 AS r_name_prf_0#3248, r_comment_prf#3245 AS r_comment_prf_0#3249, rid#3246 AS rid_0#3250]
         :  +- Relation[r_regionkey_prf#3243,r_name_prf#3244,r_comment_prf#3245,rid#3246] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3251]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1719,value#1720] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1
Elapsed time: 51ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/12 15:37:40 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:37:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3291L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 15:37:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3291L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#3293 AS s_phone_prf_0#3301, rid#3294 AS rid_0#3302, s_address_prf#3295 AS s_address_prf_0#3303, s_nationkey_prf#3296 AS s_nationkey_prf_0#3304, s_suppkey_prf#3297 AS s_suppkey_prf_0#3305, s_name_prf#3298 AS s_name_prf_0#3306, s_acctbal_prf#3299 AS s_acctbal_prf_0#3307, s_comment_prf#3300 AS s_comment_prf_0#3308]
         :  :  +- Relation[s_phone_prf#3293,rid#3294,s_address_prf#3295,s_nationkey_prf#3296,s_suppkey_prf#3297,s_name_prf#3298,s_acctbal_prf#3299,s_comment_prf#3300] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3309, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3310]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [p_comment_prf#3311 AS p_comment_prf_1#3321, p_name_prf#3312 AS p_name_prf_1#3322, rid#3313 AS rid_1#3323, p_type_prf#3314 AS p_type_prf_1#3324, p_retailprice_prf#3315 AS p_retailprice_prf_1#3325, p_mfgr_prf#3316 AS p_mfgr_prf_1#3326, p_container_prf#3317 AS p_container_prf_1#3327, p_brand_prf#3318 AS p_brand_prf_1#3328, p_size_prf#3319 AS p_size_prf_1#3329, p_partkey_prf#3320 AS p_partkey_prf_1#3330]
            :  :  +- Relation[p_comment_prf#3311,p_name_prf#3312,rid#3313,p_type_prf#3314,p_retailprice_prf#3315,p_mfgr_prf#3316,p_container_prf#3317,p_brand_prf#3318,p_size_prf#3319,p_partkey_prf#3320] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3331, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3332]
            :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
            :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3333 AS l_returnflag_prf_2#3352, l_orderkey_and_l_linenumber_prf#3334 AS l_orderkey_and_l_linenumber_prf_2#3353, l_comment_prf#3335 AS l_comment_prf_2#3354, l_linestatus_prf#3336 AS l_linestatus_prf_2#3355, rid#3337 AS rid_2#3356, l_shipmode_prf#3338 AS l_shipmode_prf_2#3357, l_shipinstruct_prf#3339 AS l_shipinstruct_prf_2#3358, l_quantity_prf#3340 AS l_quantity_prf_2#3359, l_receiptdate_prf#3341 AS l_receiptdate_prf_2#3360, l_linenumber_prf#3342 AS l_linenumber_prf_2#3361, l_tax_prf#3343 AS l_tax_prf_2#3362, l_shipdate_prf#3344 AS l_shipdate_prf_2#3363, l_extendedprice_prf#3345 AS l_extendedprice_prf_2#3364, l_partkey_prf#3346 AS l_partkey_prf_2#3365, l_discount_prf#3347 AS l_discount_prf_2#3366, l_partkey_and_l_suppkey_prf#3348 AS l_partkey_and_l_suppkey_prf_2#3367, l_commitdate_prf#3349 AS l_commitdate_prf_2#3368, l_suppkey_prf#3350 AS l_suppkey_prf_2#3369, l_orderkey_prf#3351 AS l_orderkey_prf_2#3370]
               +- Relation[l_returnflag_prf#3333,l_orderkey_and_l_linenumber_prf#3334,l_comment_prf#3335,l_linestatus_prf#3336,rid#3337,l_shipmode_prf#3338,l_shipinstruct_prf#3339,l_quantity_prf#3340,l_receiptdate_prf#3341,l_linenumber_prf#3342,l_tax_prf#3343,l_shipdate_prf#3344,l_extendedprice_prf#3345,l_partkey_prf#3346,l_discount_prf#3347,l_partkey_and_l_suppkey_prf#3348,l_commitdate_prf#3349,l_suppkey_prf#3350,l_orderkey_prf#3351] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201544ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/12 15:41:02 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:41:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3432L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 15:41:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3432L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [ps_partkey_and_ps_suppkey_prf#3434 AS ps_partkey_and_ps_suppkey_prf_0#3441, rid#3435 AS rid_0#3442, ps_availqty_prf#3436 AS ps_availqty_prf_0#3443, ps_comment_prf#3437 AS ps_comment_prf_0#3444, ps_partkey_prf#3438 AS ps_partkey_prf_0#3445, ps_supplycost_prf#3439 AS ps_supplycost_prf_0#3446, ps_suppkey_prf#3440 AS ps_suppkey_prf_0#3447]
         :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#3434,rid#3435,ps_availqty_prf#3436,ps_comment_prf#3437,ps_partkey_prf#3438,ps_supplycost_prf#3439,ps_suppkey_prf#3440] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3448, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3449]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey_and_l_suppkey~partsupp~ps_partkey_and_ps_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3450 AS l_returnflag_prf_1#3469, l_orderkey_and_l_linenumber_prf#3451 AS l_orderkey_and_l_linenumber_prf_1#3470, l_comment_prf#3452 AS l_comment_prf_1#3471, l_linestatus_prf#3453 AS l_linestatus_prf_1#3472, rid#3454 AS rid_1#3473, l_shipmode_prf#3455 AS l_shipmode_prf_1#3474, l_shipinstruct_prf#3456 AS l_shipinstruct_prf_1#3475, l_quantity_prf#3457 AS l_quantity_prf_1#3476, l_receiptdate_prf#3458 AS l_receiptdate_prf_1#3477, l_linenumber_prf#3459 AS l_linenumber_prf_1#3478, l_tax_prf#3460 AS l_tax_prf_1#3479, l_shipdate_prf#3461 AS l_shipdate_prf_1#3480, l_extendedprice_prf#3462 AS l_extendedprice_prf_1#3481, l_partkey_prf#3463 AS l_partkey_prf_1#3482, l_discount_prf#3464 AS l_discount_prf_1#3483, l_partkey_and_l_suppkey_prf#3465 AS l_partkey_and_l_suppkey_prf_1#3484, l_commitdate_prf#3466 AS l_commitdate_prf_1#3485, l_suppkey_prf#3467 AS l_suppkey_prf_1#3486, l_orderkey_prf#3468 AS l_orderkey_prf_1#3487]
            +- Relation[l_returnflag_prf#3450,l_orderkey_and_l_linenumber_prf#3451,l_comment_prf#3452,l_linestatus_prf#3453,rid#3454,l_shipmode_prf#3455,l_shipinstruct_prf#3456,l_quantity_prf#3457,l_receiptdate_prf#3458,l_linenumber_prf#3459,l_tax_prf#3460,l_shipdate_prf#3461,l_extendedprice_prf#3462,l_partkey_prf#3463,l_discount_prf#3464,l_partkey_and_l_suppkey_prf#3465,l_commitdate_prf#3466,l_suppkey_prf#3467,l_orderkey_prf#3468] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 105222ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/12 15:42:47 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:42:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3550L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 15:42:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3550L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [l_returnflag_prf#3552 AS l_returnflag_prf_0#3571, l_orderkey_and_l_linenumber_prf#3553 AS l_orderkey_and_l_linenumber_prf_0#3572, l_comment_prf#3554 AS l_comment_prf_0#3573, l_linestatus_prf#3555 AS l_linestatus_prf_0#3574, rid#3556 AS rid_0#3575, l_shipmode_prf#3557 AS l_shipmode_prf_0#3576, l_shipinstruct_prf#3558 AS l_shipinstruct_prf_0#3577, l_quantity_prf#3559 AS l_quantity_prf_0#3578, l_receiptdate_prf#3560 AS l_receiptdate_prf_0#3579, l_linenumber_prf#3561 AS l_linenumber_prf_0#3580, l_tax_prf#3562 AS l_tax_prf_0#3581, l_shipdate_prf#3563 AS l_shipdate_prf_0#3582, l_extendedprice_prf#3564 AS l_extendedprice_prf_0#3583, l_partkey_prf#3565 AS l_partkey_prf_0#3584, l_discount_prf#3566 AS l_discount_prf_0#3585, l_partkey_and_l_suppkey_prf#3567 AS l_partkey_and_l_suppkey_prf_0#3586, l_commitdate_prf#3568 AS l_commitdate_prf_0#3587, l_suppkey_prf#3569 AS l_suppkey_prf_0#3588, l_orderkey_prf#3570 AS l_orderkey_prf_0#3589]
         :  :  :  :  +- Relation[l_returnflag_prf#3552,l_orderkey_and_l_linenumber_prf#3553,l_comment_prf#3554,l_linestatus_prf#3555,rid#3556,l_shipmode_prf#3557,l_shipinstruct_prf#3558,l_quantity_prf#3559,l_receiptdate_prf#3560,l_linenumber_prf#3561,l_tax_prf#3562,l_shipdate_prf#3563,l_extendedprice_prf#3564,l_partkey_prf#3565,l_discount_prf#3566,l_partkey_and_l_suppkey_prf#3567,l_commitdate_prf#3568,l_suppkey_prf#3569,l_orderkey_prf#3570] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3590, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3591]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :  :  :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#3592 AS o_shippriority_prf_1#3602, rid#3593 AS rid_1#3603, o_orderdate_prf#3594 AS o_orderdate_prf_1#3604, o_custkey_prf#3595 AS o_custkey_prf_1#3605, o_orderpriority_prf#3596 AS o_orderpriority_prf_1#3606, o_clerk_prf#3597 AS o_clerk_prf_1#3607, o_orderstatus_prf#3598 AS o_orderstatus_prf_1#3608, o_totalprice_prf#3599 AS o_totalprice_prf_1#3609, o_orderkey_prf#3600 AS o_orderkey_prf_1#3610, o_comment_prf#3601 AS o_comment_prf_1#3611]
         :  :     +- Relation[o_shippriority_prf#3592,rid#3593,o_orderdate_prf#3594,o_custkey_prf#3595,o_orderpriority_prf#3596,o_clerk_prf#3597,o_orderstatus_prf#3598,o_totalprice_prf#3599,o_orderkey_prf#3600,o_comment_prf#3601] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3612, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3613]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3614 AS c_acctbal_prf_2#3623, rid#3615 AS rid_2#3624, c_name_prf#3616 AS c_name_prf_2#3625, c_nationkey_prf#3617 AS c_nationkey_prf_2#3626, c_custkey_prf#3618 AS c_custkey_prf_2#3627, c_comment_prf#3619 AS c_comment_prf_2#3628, c_address_prf#3620 AS c_address_prf_2#3629, c_mktsegment_prf#3621 AS c_mktsegment_prf_2#3630, c_phone_prf#3622 AS c_phone_prf_2#3631]
            +- Relation[c_acctbal_prf#3614,rid#3615,c_name_prf#3616,c_nationkey_prf#3617,c_custkey_prf#3618,c_comment_prf#3619,c_address_prf#3620,c_mktsegment_prf#3621,c_phone_prf#3622] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 183717ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/12 15:45:51 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:45:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3677L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 15:45:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3677L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#3679 AS rid_0#3684, n_regionkey_prf#3680 AS n_regionkey_prf_0#3685, n_nationkey_prf#3681 AS n_nationkey_prf_0#3686, n_name_prf#3682 AS n_name_prf_0#3687, n_comment_prf#3683 AS n_comment_prf_0#3688]
         :  +- Relation[rid#3679,n_regionkey_prf#3680,n_nationkey_prf#3681,n_name_prf#3682,n_comment_prf#3683] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3689]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1719,value#1720] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1
Elapsed time: 55ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/12 15:45:51 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:45:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3719L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 15:45:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3719L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [p_comment_prf#3721 AS p_comment_prf_0#3731, p_name_prf#3722 AS p_name_prf_0#3732, rid#3723 AS rid_0#3733, p_type_prf#3724 AS p_type_prf_0#3734, p_retailprice_prf#3725 AS p_retailprice_prf_0#3735, p_mfgr_prf#3726 AS p_mfgr_prf_0#3736, p_container_prf#3727 AS p_container_prf_0#3737, p_brand_prf#3728 AS p_brand_prf_0#3738, p_size_prf#3729 AS p_size_prf_0#3739, p_partkey_prf#3730 AS p_partkey_prf_0#3740]
         :  :  :  :  +- Relation[p_comment_prf#3721,p_name_prf#3722,rid#3723,p_type_prf#3724,p_retailprice_prf#3725,p_mfgr_prf#3726,p_container_prf#3727,p_brand_prf#3728,p_size_prf#3729,p_partkey_prf#3730] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3741, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3742]
         :  :  :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :  :  :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#3743 AS ps_partkey_and_ps_suppkey_prf_1#3750, rid#3744 AS rid_1#3751, ps_availqty_prf#3745 AS ps_availqty_prf_1#3752, ps_comment_prf#3746 AS ps_comment_prf_1#3753, ps_partkey_prf#3747 AS ps_partkey_prf_1#3754, ps_supplycost_prf#3748 AS ps_supplycost_prf_1#3755, ps_suppkey_prf#3749 AS ps_suppkey_prf_1#3756]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#3743,rid#3744,ps_availqty_prf#3745,ps_comment_prf#3746,ps_partkey_prf#3747,ps_supplycost_prf#3748,ps_suppkey_prf#3749] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3757, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3758]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#3759 AS s_phone_prf_2#3767, rid#3760 AS rid_2#3768, s_address_prf#3761 AS s_address_prf_2#3769, s_nationkey_prf#3762 AS s_nationkey_prf_2#3770, s_suppkey_prf#3763 AS s_suppkey_prf_2#3771, s_name_prf#3764 AS s_name_prf_2#3772, s_acctbal_prf#3765 AS s_acctbal_prf_2#3773, s_comment_prf#3766 AS s_comment_prf_2#3774]
            +- Relation[s_phone_prf#3759,rid#3760,s_address_prf#3761,s_nationkey_prf#3762,s_suppkey_prf#3763,s_name_prf#3764,s_acctbal_prf#3765,s_comment_prf#3766] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26100ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/12 15:46:17 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:46:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3817L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 15:46:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3817L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [p_comment_prf#3819 AS p_comment_prf_0#3829, p_name_prf#3820 AS p_name_prf_0#3830, rid#3821 AS rid_0#3831, p_type_prf#3822 AS p_type_prf_0#3832, p_retailprice_prf#3823 AS p_retailprice_prf_0#3833, p_mfgr_prf#3824 AS p_mfgr_prf_0#3834, p_container_prf#3825 AS p_container_prf_0#3835, p_brand_prf#3826 AS p_brand_prf_0#3836, p_size_prf#3827 AS p_size_prf_0#3837, p_partkey_prf#3828 AS p_partkey_prf_0#3838]
         :  :  :  +- Relation[p_comment_prf#3819,p_name_prf#3820,rid#3821,p_type_prf#3822,p_retailprice_prf#3823,p_mfgr_prf#3824,p_container_prf#3825,p_brand_prf#3826,p_size_prf#3827,p_partkey_prf#3828] JDBCRelation(part_prf) [numPartitions=1]
         :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3839]
         :  :     +- DexRidFilter part~p_size~15
         :  :        +- Relation[label#1719,value#1720] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3840, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3841]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#3842 AS ps_partkey_and_ps_suppkey_prf_1#3849, rid#3843 AS rid_1#3850, ps_availqty_prf#3844 AS ps_availqty_prf_1#3851, ps_comment_prf#3845 AS ps_comment_prf_1#3852, ps_partkey_prf#3846 AS ps_partkey_prf_1#3853, ps_supplycost_prf#3847 AS ps_supplycost_prf_1#3854, ps_suppkey_prf#3848 AS ps_suppkey_prf_1#3855]
            +- Relation[ps_partkey_and_ps_suppkey_prf#3842,rid#3843,ps_availqty_prf#3844,ps_comment_prf#3845,ps_partkey_prf#3846,ps_supplycost_prf#3847,ps_suppkey_prf#3848] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=15628
Elapsed time: 7773ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/12 15:46:25 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 15:46:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3895L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 15:46:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3895L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [rid#3897 AS rid_0#3902, n_regionkey_prf#3898 AS n_regionkey_prf_0#3903, n_nationkey_prf#3899 AS n_nationkey_prf_0#3904, n_name_prf#3900 AS n_name_prf_0#3905, n_comment_prf#3901 AS n_comment_prf_0#3906]
         :  :  :  :  +- Relation[rid#3897,n_regionkey_prf#3898,n_nationkey_prf#3899,n_name_prf#3900,n_comment_prf#3901] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3907, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3908]
         :  :  :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :  :  :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#3909 AS s_phone_prf_1#3917, rid#3910 AS rid_1#3918, s_address_prf#3911 AS s_address_prf_1#3919, s_nationkey_prf#3912 AS s_nationkey_prf_1#3920, s_suppkey_prf#3913 AS s_suppkey_prf_1#3921, s_name_prf#3914 AS s_name_prf_1#3922, s_acctbal_prf#3915 AS s_acctbal_prf_1#3923, s_comment_prf#3916 AS s_comment_prf_1#3924]
         :  :     +- Relation[s_phone_prf#3909,rid#3910,s_address_prf#3911,s_nationkey_prf#3912,s_suppkey_prf#3913,s_name_prf#3914,s_acctbal_prf#3915,s_comment_prf#3916] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3925, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3926]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3927 AS c_acctbal_prf_2#3936, rid#3928 AS rid_2#3937, c_name_prf#3929 AS c_name_prf_2#3938, c_nationkey_prf#3930 AS c_nationkey_prf_2#3939, c_custkey_prf#3931 AS c_custkey_prf_2#3940, c_comment_prf#3932 AS c_comment_prf_2#3941, c_address_prf#3933 AS c_address_prf_2#3942, c_mktsegment_prf#3934 AS c_mktsegment_prf_2#3943, c_phone_prf#3935 AS c_phone_prf_2#3944]
            +- Relation[c_acctbal_prf#3927,rid#3928,c_name_prf#3929,c_nationkey_prf#3930,c_custkey_prf#3931,c_comment_prf#3932,c_address_prf#3933,c_mktsegment_prf#3934,c_phone_prf#3935] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 882374ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/12 16:01:07 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:01:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4003L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 16:01:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4003L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [c_acctbal_prf#4005 AS c_acctbal_prf_0#4014, rid#4006 AS rid_0#4015, c_name_prf#4007 AS c_name_prf_0#4016, c_nationkey_prf#4008 AS c_nationkey_prf_0#4017, c_custkey_prf#4009 AS c_custkey_prf_0#4018, c_comment_prf#4010 AS c_comment_prf_0#4019, c_address_prf#4011 AS c_address_prf_0#4020, c_mktsegment_prf#4012 AS c_mktsegment_prf_0#4021, c_phone_prf#4013 AS c_phone_prf_0#4022]
         :  :  :  :  +- Relation[c_acctbal_prf#4005,rid#4006,c_name_prf#4007,c_nationkey_prf#4008,c_custkey_prf#4009,c_comment_prf#4010,c_address_prf#4011,c_mktsegment_prf#4012,c_phone_prf#4013] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4023, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4024]
         :  :  :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :  :  :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#4025 AS o_shippriority_prf_1#4035, rid#4026 AS rid_1#4036, o_orderdate_prf#4027 AS o_orderdate_prf_1#4037, o_custkey_prf#4028 AS o_custkey_prf_1#4038, o_orderpriority_prf#4029 AS o_orderpriority_prf_1#4039, o_clerk_prf#4030 AS o_clerk_prf_1#4040, o_orderstatus_prf#4031 AS o_orderstatus_prf_1#4041, o_totalprice_prf#4032 AS o_totalprice_prf_1#4042, o_orderkey_prf#4033 AS o_orderkey_prf_1#4043, o_comment_prf#4034 AS o_comment_prf_1#4044]
         :  :     +- Relation[o_shippriority_prf#4025,rid#4026,o_orderdate_prf#4027,o_custkey_prf#4028,o_orderpriority_prf#4029,o_clerk_prf#4030,o_orderstatus_prf#4031,o_totalprice_prf#4032,o_orderkey_prf#4033,o_comment_prf#4034] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4045, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4046]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4047 AS l_returnflag_prf_2#4066, l_orderkey_and_l_linenumber_prf#4048 AS l_orderkey_and_l_linenumber_prf_2#4067, l_comment_prf#4049 AS l_comment_prf_2#4068, l_linestatus_prf#4050 AS l_linestatus_prf_2#4069, rid#4051 AS rid_2#4070, l_shipmode_prf#4052 AS l_shipmode_prf_2#4071, l_shipinstruct_prf#4053 AS l_shipinstruct_prf_2#4072, l_quantity_prf#4054 AS l_quantity_prf_2#4073, l_receiptdate_prf#4055 AS l_receiptdate_prf_2#4074, l_linenumber_prf#4056 AS l_linenumber_prf_2#4075, l_tax_prf#4057 AS l_tax_prf_2#4076, l_shipdate_prf#4058 AS l_shipdate_prf_2#4077, l_extendedprice_prf#4059 AS l_extendedprice_prf_2#4078, l_partkey_prf#4060 AS l_partkey_prf_2#4079, l_discount_prf#4061 AS l_discount_prf_2#4080, l_partkey_and_l_suppkey_prf#4062 AS l_partkey_and_l_suppkey_prf_2#4081, l_commitdate_prf#4063 AS l_commitdate_prf_2#4082, l_suppkey_prf#4064 AS l_suppkey_prf_2#4083, l_orderkey_prf#4065 AS l_orderkey_prf_2#4084]
            +- Relation[l_returnflag_prf#4047,l_orderkey_and_l_linenumber_prf#4048,l_comment_prf#4049,l_linestatus_prf#4050,rid#4051,l_shipmode_prf#4052,l_shipinstruct_prf#4053,l_quantity_prf#4054,l_receiptdate_prf#4055,l_linenumber_prf#4056,l_tax_prf#4057,l_shipdate_prf#4058,l_extendedprice_prf#4059,l_partkey_prf#4060,l_discount_prf#4061,l_partkey_and_l_suppkey_prf#4062,l_commitdate_prf#4063,l_suppkey_prf#4064,l_orderkey_prf#4065] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 168519ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/12 16:03:56 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:03:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4138L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 16:03:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4138L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4140 AS s_phone_prf_0#4148, rid#4141 AS rid_0#4149, s_address_prf#4142 AS s_address_prf_0#4150, s_nationkey_prf#4143 AS s_nationkey_prf_0#4151, s_suppkey_prf#4144 AS s_suppkey_prf_0#4152, s_name_prf#4145 AS s_name_prf_0#4153, s_acctbal_prf#4146 AS s_acctbal_prf_0#4154, s_comment_prf#4147 AS s_comment_prf_0#4155]
         :  :  +- Relation[s_phone_prf#4140,rid#4141,s_address_prf#4142,s_nationkey_prf#4143,s_suppkey_prf#4144,s_name_prf#4145,s_acctbal_prf#4146,s_comment_prf#4147] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4156, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4157]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4158 AS ps_partkey_and_ps_suppkey_prf_1#4165, rid#4159 AS rid_1#4166, ps_availqty_prf#4160 AS ps_availqty_prf_1#4167, ps_comment_prf#4161 AS ps_comment_prf_1#4168, ps_partkey_prf#4162 AS ps_partkey_prf_1#4169, ps_supplycost_prf#4163 AS ps_supplycost_prf_1#4170, ps_suppkey_prf#4164 AS ps_suppkey_prf_1#4171]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4158,rid#4159,ps_availqty_prf#4160,ps_comment_prf#4161,ps_partkey_prf#4162,ps_supplycost_prf#4163,ps_suppkey_prf#4164] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 12456ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/12 16:04:08 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:04:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4204L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 16:04:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4204L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [p_comment_prf#4206 AS p_comment_prf_0#4216, p_name_prf#4207 AS p_name_prf_0#4217, rid#4208 AS rid_0#4218, p_type_prf#4209 AS p_type_prf_0#4219, p_retailprice_prf#4210 AS p_retailprice_prf_0#4220, p_mfgr_prf#4211 AS p_mfgr_prf_0#4221, p_container_prf#4212 AS p_container_prf_0#4222, p_brand_prf#4213 AS p_brand_prf_0#4223, p_size_prf#4214 AS p_size_prf_0#4224, p_partkey_prf#4215 AS p_partkey_prf_0#4225]
         :  :  +- Relation[p_comment_prf#4206,p_name_prf#4207,rid#4208,p_type_prf#4209,p_retailprice_prf#4210,p_mfgr_prf#4211,p_container_prf#4212,p_brand_prf#4213,p_size_prf#4214,p_partkey_prf#4215] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4226, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4227]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4228 AS ps_partkey_and_ps_suppkey_prf_1#4235, rid#4229 AS rid_1#4236, ps_availqty_prf#4230 AS ps_availqty_prf_1#4237, ps_comment_prf#4231 AS ps_comment_prf_1#4238, ps_partkey_prf#4232 AS ps_partkey_prf_1#4239, ps_supplycost_prf#4233 AS ps_supplycost_prf_1#4240, ps_suppkey_prf#4234 AS ps_suppkey_prf_1#4241]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4228,rid#4229,ps_availqty_prf#4230,ps_comment_prf#4231,ps_partkey_prf#4232,ps_supplycost_prf#4233,ps_suppkey_prf#4234] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 12115ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/12 16:04:20 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:04:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4287L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 16:04:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4287L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [o_shippriority_prf#4289 AS o_shippriority_prf_0#4299, rid#4290 AS rid_0#4300, o_orderdate_prf#4291 AS o_orderdate_prf_0#4301, o_custkey_prf#4292 AS o_custkey_prf_0#4302, o_orderpriority_prf#4293 AS o_orderpriority_prf_0#4303, o_clerk_prf#4294 AS o_clerk_prf_0#4304, o_orderstatus_prf#4295 AS o_orderstatus_prf_0#4305, o_totalprice_prf#4296 AS o_totalprice_prf_0#4306, o_orderkey_prf#4297 AS o_orderkey_prf_0#4307, o_comment_prf#4298 AS o_comment_prf_0#4308]
         :  :  +- Relation[o_shippriority_prf#4289,rid#4290,o_orderdate_prf#4291,o_custkey_prf#4292,o_orderpriority_prf#4293,o_clerk_prf#4294,o_orderstatus_prf#4295,o_totalprice_prf#4296,o_orderkey_prf#4297,o_comment_prf#4298] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4309, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4310]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4311 AS l_returnflag_prf_1#4330, l_orderkey_and_l_linenumber_prf#4312 AS l_orderkey_and_l_linenumber_prf_1#4331, l_comment_prf#4313 AS l_comment_prf_1#4332, l_linestatus_prf#4314 AS l_linestatus_prf_1#4333, rid#4315 AS rid_1#4334, l_shipmode_prf#4316 AS l_shipmode_prf_1#4335, l_shipinstruct_prf#4317 AS l_shipinstruct_prf_1#4336, l_quantity_prf#4318 AS l_quantity_prf_1#4337, l_receiptdate_prf#4319 AS l_receiptdate_prf_1#4338, l_linenumber_prf#4320 AS l_linenumber_prf_1#4339, l_tax_prf#4321 AS l_tax_prf_1#4340, l_shipdate_prf#4322 AS l_shipdate_prf_1#4341, l_extendedprice_prf#4323 AS l_extendedprice_prf_1#4342, l_partkey_prf#4324 AS l_partkey_prf_1#4343, l_discount_prf#4325 AS l_discount_prf_1#4344, l_partkey_and_l_suppkey_prf#4326 AS l_partkey_and_l_suppkey_prf_1#4345, l_commitdate_prf#4327 AS l_commitdate_prf_1#4346, l_suppkey_prf#4328 AS l_suppkey_prf_1#4347, l_orderkey_prf#4329 AS l_orderkey_prf_1#4348]
            +- Relation[l_returnflag_prf#4311,l_orderkey_and_l_linenumber_prf#4312,l_comment_prf#4313,l_linestatus_prf#4314,rid#4315,l_shipmode_prf#4316,l_shipinstruct_prf#4317,l_quantity_prf#4318,l_receiptdate_prf#4319,l_linenumber_prf#4320,l_tax_prf#4321,l_shipdate_prf#4322,l_extendedprice_prf#4323,l_partkey_prf#4324,l_discount_prf#4325,l_partkey_and_l_suppkey_prf#4326,l_commitdate_prf#4327,l_suppkey_prf#4328,l_orderkey_prf#4329] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 106893ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/12 16:06:07 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:06:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4393L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 16:06:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4393L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [rid#4395 AS rid_0#4400, n_regionkey_prf#4396 AS n_regionkey_prf_0#4401, n_nationkey_prf#4397 AS n_nationkey_prf_0#4402, n_name_prf#4398 AS n_name_prf_0#4403, n_comment_prf#4399 AS n_comment_prf_0#4404]
         :  :  +- Relation[rid#4395,n_regionkey_prf#4396,n_nationkey_prf#4397,n_name_prf#4398,n_comment_prf#4399] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4405, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4406]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4407 AS c_acctbal_prf_1#4416, rid#4408 AS rid_1#4417, c_name_prf#4409 AS c_name_prf_1#4418, c_nationkey_prf#4410 AS c_nationkey_prf_1#4419, c_custkey_prf#4411 AS c_custkey_prf_1#4420, c_comment_prf#4412 AS c_comment_prf_1#4421, c_address_prf#4413 AS c_address_prf_1#4422, c_mktsegment_prf#4414 AS c_mktsegment_prf_1#4423, c_phone_prf#4415 AS c_phone_prf_1#4424]
            +- Relation[c_acctbal_prf#4407,rid#4408,c_name_prf#4409,c_nationkey_prf#4410,c_custkey_prf#4411,c_comment_prf#4412,c_address_prf#4413,c_mktsegment_prf#4414,c_phone_prf#4415] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=150000
Elapsed time: 2519ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/12 16:06:10 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:06:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4459L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 16:06:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4459L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#4461 AS c_acctbal_prf_0#4470, rid#4462 AS rid_0#4471, c_name_prf#4463 AS c_name_prf_0#4472, c_nationkey_prf#4464 AS c_nationkey_prf_0#4473, c_custkey_prf#4465 AS c_custkey_prf_0#4474, c_comment_prf#4466 AS c_comment_prf_0#4475, c_address_prf#4467 AS c_address_prf_0#4476, c_mktsegment_prf#4468 AS c_mktsegment_prf_0#4477, c_phone_prf#4469 AS c_phone_prf_0#4478]
         :  :  +- Relation[c_acctbal_prf#4461,rid#4462,c_name_prf#4463,c_nationkey_prf#4464,c_custkey_prf#4465,c_comment_prf#4466,c_address_prf#4467,c_mktsegment_prf#4468,c_phone_prf#4469] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4479, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4480]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4481 AS o_shippriority_prf_1#4491, rid#4482 AS rid_1#4492, o_orderdate_prf#4483 AS o_orderdate_prf_1#4493, o_custkey_prf#4484 AS o_custkey_prf_1#4494, o_orderpriority_prf#4485 AS o_orderpriority_prf_1#4495, o_clerk_prf#4486 AS o_clerk_prf_1#4496, o_orderstatus_prf#4487 AS o_orderstatus_prf_1#4497, o_totalprice_prf#4488 AS o_totalprice_prf_1#4498, o_orderkey_prf#4489 AS o_orderkey_prf_1#4499, o_comment_prf#4490 AS o_comment_prf_1#4500]
            +- Relation[o_shippriority_prf#4481,rid#4482,o_orderdate_prf#4483,o_custkey_prf#4484,o_orderpriority_prf#4485,o_clerk_prf#4486,o_orderstatus_prf#4487,o_totalprice_prf#4488,o_orderkey_prf#4489,o_comment_prf#4490] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=1500000
Elapsed time: 23618ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/12 16:06:33 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:06:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4548L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 16:06:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4548L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#4550 AS l_returnflag_prf_0#4569, l_orderkey_and_l_linenumber_prf#4551 AS l_orderkey_and_l_linenumber_prf_0#4570, l_comment_prf#4552 AS l_comment_prf_0#4571, l_linestatus_prf#4553 AS l_linestatus_prf_0#4572, rid#4554 AS rid_0#4573, l_shipmode_prf#4555 AS l_shipmode_prf_0#4574, l_shipinstruct_prf#4556 AS l_shipinstruct_prf_0#4575, l_quantity_prf#4557 AS l_quantity_prf_0#4576, l_receiptdate_prf#4558 AS l_receiptdate_prf_0#4577, l_linenumber_prf#4559 AS l_linenumber_prf_0#4578, l_tax_prf#4560 AS l_tax_prf_0#4579, l_shipdate_prf#4561 AS l_shipdate_prf_0#4580, l_extendedprice_prf#4562 AS l_extendedprice_prf_0#4581, l_partkey_prf#4563 AS l_partkey_prf_0#4582, l_discount_prf#4564 AS l_discount_prf_0#4583, l_partkey_and_l_suppkey_prf#4565 AS l_partkey_and_l_suppkey_prf_0#4584, l_commitdate_prf#4566 AS l_commitdate_prf_0#4585, l_suppkey_prf#4567 AS l_suppkey_prf_0#4586, l_orderkey_prf#4568 AS l_orderkey_prf_0#4587]
         :  :  +- Relation[l_returnflag_prf#4550,l_orderkey_and_l_linenumber_prf#4551,l_comment_prf#4552,l_linestatus_prf#4553,rid#4554,l_shipmode_prf#4555,l_shipinstruct_prf#4556,l_quantity_prf#4557,l_receiptdate_prf#4558,l_linenumber_prf#4559,l_tax_prf#4560,l_shipdate_prf#4561,l_extendedprice_prf#4562,l_partkey_prf#4563,l_discount_prf#4564,l_partkey_and_l_suppkey_prf#4565,l_commitdate_prf#4566,l_suppkey_prf#4567,l_orderkey_prf#4568] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4588, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4589]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [p_comment_prf#4590 AS p_comment_prf_1#4600, p_name_prf#4591 AS p_name_prf_1#4601, rid#4592 AS rid_1#4602, p_type_prf#4593 AS p_type_prf_1#4603, p_retailprice_prf#4594 AS p_retailprice_prf_1#4604, p_mfgr_prf#4595 AS p_mfgr_prf_1#4605, p_container_prf#4596 AS p_container_prf_1#4606, p_brand_prf#4597 AS p_brand_prf_1#4607, p_size_prf#4598 AS p_size_prf_1#4608, p_partkey_prf#4599 AS p_partkey_prf_1#4609]
            +- Relation[p_comment_prf#4590,p_name_prf#4591,rid#4592,p_type_prf#4593,p_retailprice_prf#4594,p_mfgr_prf#4595,p_container_prf#4596,p_brand_prf#4597,p_size_prf#4598,p_partkey_prf#4599] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 94873ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/12 16:08:08 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:08:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4663L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 16:08:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4663L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4665 AS s_phone_prf_0#4673, rid#4666 AS rid_0#4674, s_address_prf#4667 AS s_address_prf_0#4675, s_nationkey_prf#4668 AS s_nationkey_prf_0#4676, s_suppkey_prf#4669 AS s_suppkey_prf_0#4677, s_name_prf#4670 AS s_name_prf_0#4678, s_acctbal_prf#4671 AS s_acctbal_prf_0#4679, s_comment_prf#4672 AS s_comment_prf_0#4680]
         :  :  +- Relation[s_phone_prf#4665,rid#4666,s_address_prf#4667,s_nationkey_prf#4668,s_suppkey_prf#4669,s_name_prf#4670,s_acctbal_prf#4671,s_comment_prf#4672] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4681, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4682]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [ps_partkey_and_ps_suppkey_prf#4683 AS ps_partkey_and_ps_suppkey_prf_1#4690, rid#4684 AS rid_1#4691, ps_availqty_prf#4685 AS ps_availqty_prf_1#4692, ps_comment_prf#4686 AS ps_comment_prf_1#4693, ps_partkey_prf#4687 AS ps_partkey_prf_1#4694, ps_supplycost_prf#4688 AS ps_supplycost_prf_1#4695, ps_suppkey_prf#4689 AS ps_suppkey_prf_1#4696]
            :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#4683,rid#4684,ps_availqty_prf#4685,ps_comment_prf#4686,ps_partkey_prf#4687,ps_supplycost_prf#4688,ps_suppkey_prf#4689] JDBCRelation(partsupp_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4697, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4698]
            :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
            :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [p_comment_prf#4699 AS p_comment_prf_2#4709, p_name_prf#4700 AS p_name_prf_2#4710, rid#4701 AS rid_2#4711, p_type_prf#4702 AS p_type_prf_2#4712, p_retailprice_prf#4703 AS p_retailprice_prf_2#4713, p_mfgr_prf#4704 AS p_mfgr_prf_2#4714, p_container_prf#4705 AS p_container_prf_2#4715, p_brand_prf#4706 AS p_brand_prf_2#4716, p_size_prf#4707 AS p_size_prf_2#4717, p_partkey_prf#4708 AS p_partkey_prf_2#4718]
               +- Relation[p_comment_prf#4699,p_name_prf#4700,rid#4701,p_type_prf#4702,p_retailprice_prf#4703,p_mfgr_prf#4704,p_container_prf#4705,p_brand_prf#4706,p_size_prf#4707,p_partkey_prf#4708] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26086ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/12 16:08:34 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:08:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4780L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 16:08:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4780L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#4782 AS c_acctbal_prf_0#4791, rid#4783 AS rid_0#4792, c_name_prf#4784 AS c_name_prf_0#4793, c_nationkey_prf#4785 AS c_nationkey_prf_0#4794, c_custkey_prf#4786 AS c_custkey_prf_0#4795, c_comment_prf#4787 AS c_comment_prf_0#4796, c_address_prf#4788 AS c_address_prf_0#4797, c_mktsegment_prf#4789 AS c_mktsegment_prf_0#4798, c_phone_prf#4790 AS c_phone_prf_0#4799]
         :  :  +- Relation[c_acctbal_prf#4782,rid#4783,c_name_prf#4784,c_nationkey_prf#4785,c_custkey_prf#4786,c_comment_prf#4787,c_address_prf#4788,c_mktsegment_prf#4789,c_phone_prf#4790] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4800, dexdecrypt('value_dec_key, 'value_right) AS rid_2#4801]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [l_returnflag_prf#4802 AS l_returnflag_prf_1#4821, l_orderkey_and_l_linenumber_prf#4803 AS l_orderkey_and_l_linenumber_prf_1#4822, l_comment_prf#4804 AS l_comment_prf_1#4823, l_linestatus_prf#4805 AS l_linestatus_prf_1#4824, rid#4806 AS rid_1#4825, l_shipmode_prf#4807 AS l_shipmode_prf_1#4826, l_shipinstruct_prf#4808 AS l_shipinstruct_prf_1#4827, l_quantity_prf#4809 AS l_quantity_prf_1#4828, l_receiptdate_prf#4810 AS l_receiptdate_prf_1#4829, l_linenumber_prf#4811 AS l_linenumber_prf_1#4830, l_tax_prf#4812 AS l_tax_prf_1#4831, l_shipdate_prf#4813 AS l_shipdate_prf_1#4832, l_extendedprice_prf#4814 AS l_extendedprice_prf_1#4833, l_partkey_prf#4815 AS l_partkey_prf_1#4834, l_discount_prf#4816 AS l_discount_prf_1#4835, l_partkey_and_l_suppkey_prf#4817 AS l_partkey_and_l_suppkey_prf_1#4836, l_commitdate_prf#4818 AS l_commitdate_prf_1#4837, l_suppkey_prf#4819 AS l_suppkey_prf_1#4838, l_orderkey_prf#4820 AS l_orderkey_prf_1#4839]
            :  :  +- Relation[l_returnflag_prf#4802,l_orderkey_and_l_linenumber_prf#4803,l_comment_prf#4804,l_linestatus_prf#4805,rid#4806,l_shipmode_prf#4807,l_shipinstruct_prf#4808,l_quantity_prf#4809,l_receiptdate_prf#4810,l_linenumber_prf#4811,l_tax_prf#4812,l_shipdate_prf#4813,l_extendedprice_prf#4814,l_partkey_prf#4815,l_discount_prf#4816,l_partkey_and_l_suppkey_prf#4817,l_commitdate_prf#4818,l_suppkey_prf#4819,l_orderkey_prf#4820] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4840, dexdecrypt('value_dec_key, 'value_right) AS rid_2#4841]
            :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
            :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4842 AS o_shippriority_prf_2#4852, rid#4843 AS rid_2#4853, o_orderdate_prf#4844 AS o_orderdate_prf_2#4854, o_custkey_prf#4845 AS o_custkey_prf_2#4855, o_orderpriority_prf#4846 AS o_orderpriority_prf_2#4856, o_clerk_prf#4847 AS o_clerk_prf_2#4857, o_orderstatus_prf#4848 AS o_orderstatus_prf_2#4858, o_totalprice_prf#4849 AS o_totalprice_prf_2#4859, o_orderkey_prf#4850 AS o_orderkey_prf_2#4860, o_comment_prf#4851 AS o_comment_prf_2#4861]
               +- Relation[o_shippriority_prf#4842,rid#4843,o_orderdate_prf#4844,o_custkey_prf#4845,o_orderpriority_prf#4846,o_clerk_prf#4847,o_orderstatus_prf#4848,o_totalprice_prf#4849,o_orderkey_prf#4850,o_comment_prf#4851] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 142270ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/12 16:10:56 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:10:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4928L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 16:10:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4928L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [l_returnflag_prf#4930 AS l_returnflag_prf_0#4949, l_orderkey_and_l_linenumber_prf#4931 AS l_orderkey_and_l_linenumber_prf_0#4950, l_comment_prf#4932 AS l_comment_prf_0#4951, l_linestatus_prf#4933 AS l_linestatus_prf_0#4952, rid#4934 AS rid_0#4953, l_shipmode_prf#4935 AS l_shipmode_prf_0#4954, l_shipinstruct_prf#4936 AS l_shipinstruct_prf_0#4955, l_quantity_prf#4937 AS l_quantity_prf_0#4956, l_receiptdate_prf#4938 AS l_receiptdate_prf_0#4957, l_linenumber_prf#4939 AS l_linenumber_prf_0#4958, l_tax_prf#4940 AS l_tax_prf_0#4959, l_shipdate_prf#4941 AS l_shipdate_prf_0#4960, l_extendedprice_prf#4942 AS l_extendedprice_prf_0#4961, l_partkey_prf#4943 AS l_partkey_prf_0#4962, l_discount_prf#4944 AS l_discount_prf_0#4963, l_partkey_and_l_suppkey_prf#4945 AS l_partkey_and_l_suppkey_prf_0#4964, l_commitdate_prf#4946 AS l_commitdate_prf_0#4965, l_suppkey_prf#4947 AS l_suppkey_prf_0#4966, l_orderkey_prf#4948 AS l_orderkey_prf_0#4967]
         :  :  :  +- Relation[l_returnflag_prf#4930,l_orderkey_and_l_linenumber_prf#4931,l_comment_prf#4932,l_linestatus_prf#4933,rid#4934,l_shipmode_prf#4935,l_shipinstruct_prf#4936,l_quantity_prf#4937,l_receiptdate_prf#4938,l_linenumber_prf#4939,l_tax_prf#4940,l_shipdate_prf#4941,l_extendedprice_prf#4942,l_partkey_prf#4943,l_discount_prf#4944,l_partkey_and_l_suppkey_prf#4945,l_commitdate_prf#4946,l_suppkey_prf#4947,l_orderkey_prf#4948] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4968]
         :  :     +- DexRidFilter lineitem~l_returnflag~R
         :  :        +- Relation[label#1719,value#1720] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4969, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4970]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4971 AS o_shippriority_prf_1#4981, rid#4972 AS rid_1#4982, o_orderdate_prf#4973 AS o_orderdate_prf_1#4983, o_custkey_prf#4974 AS o_custkey_prf_1#4984, o_orderpriority_prf#4975 AS o_orderpriority_prf_1#4985, o_clerk_prf#4976 AS o_clerk_prf_1#4986, o_orderstatus_prf#4977 AS o_orderstatus_prf_1#4987, o_totalprice_prf#4978 AS o_totalprice_prf_1#4988, o_orderkey_prf#4979 AS o_orderkey_prf_1#4989, o_comment_prf#4980 AS o_comment_prf_1#4990]
            +- Relation[o_shippriority_prf#4971,rid#4972,o_orderdate_prf#4973,o_custkey_prf#4974,o_orderpriority_prf#4975,o_clerk_prf#4976,o_orderstatus_prf#4977,o_totalprice_prf#4978,o_orderkey_prf#4979,o_comment_prf#4980] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 97520ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/12 16:12:34 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:12:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5039L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 16:12:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5039L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#5041 AS l_returnflag_prf_0#5060, l_orderkey_and_l_linenumber_prf#5042 AS l_orderkey_and_l_linenumber_prf_0#5061, l_comment_prf#5043 AS l_comment_prf_0#5062, l_linestatus_prf#5044 AS l_linestatus_prf_0#5063, rid#5045 AS rid_0#5064, l_shipmode_prf#5046 AS l_shipmode_prf_0#5065, l_shipinstruct_prf#5047 AS l_shipinstruct_prf_0#5066, l_quantity_prf#5048 AS l_quantity_prf_0#5067, l_receiptdate_prf#5049 AS l_receiptdate_prf_0#5068, l_linenumber_prf#5050 AS l_linenumber_prf_0#5069, l_tax_prf#5051 AS l_tax_prf_0#5070, l_shipdate_prf#5052 AS l_shipdate_prf_0#5071, l_extendedprice_prf#5053 AS l_extendedprice_prf_0#5072, l_partkey_prf#5054 AS l_partkey_prf_0#5073, l_discount_prf#5055 AS l_discount_prf_0#5074, l_partkey_and_l_suppkey_prf#5056 AS l_partkey_and_l_suppkey_prf_0#5075, l_commitdate_prf#5057 AS l_commitdate_prf_0#5076, l_suppkey_prf#5058 AS l_suppkey_prf_0#5077, l_orderkey_prf#5059 AS l_orderkey_prf_0#5078]
         :  +- Relation[l_returnflag_prf#5041,l_orderkey_and_l_linenumber_prf#5042,l_comment_prf#5043,l_linestatus_prf#5044,rid#5045,l_shipmode_prf#5046,l_shipinstruct_prf#5047,l_quantity_prf#5048,l_receiptdate_prf#5049,l_linenumber_prf#5050,l_tax_prf#5051,l_shipdate_prf#5052,l_extendedprice_prf#5053,l_partkey_prf#5054,l_discount_prf#5055,l_partkey_and_l_suppkey_prf#5056,l_commitdate_prf#5057,l_suppkey_prf#5058,l_orderkey_prf#5059] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5079]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1719,value#1720] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 23210ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/12 16:12:57 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:12:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5113L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 16:12:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5113L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [rid#5115 AS rid_0#5120, n_regionkey_prf#5116 AS n_regionkey_prf_0#5121, n_nationkey_prf#5117 AS n_nationkey_prf_0#5122, n_name_prf#5118 AS n_name_prf_0#5123, n_comment_prf#5119 AS n_comment_prf_0#5124]
         :  :  +- Relation[rid#5115,n_regionkey_prf#5116,n_nationkey_prf#5117,n_name_prf#5118,n_comment_prf#5119] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5125, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5126]
         :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#5127 AS s_phone_prf_1#5135, rid#5128 AS rid_1#5136, s_address_prf#5129 AS s_address_prf_1#5137, s_nationkey_prf#5130 AS s_nationkey_prf_1#5138, s_suppkey_prf#5131 AS s_suppkey_prf_1#5139, s_name_prf#5132 AS s_name_prf_1#5140, s_acctbal_prf#5133 AS s_acctbal_prf_1#5141, s_comment_prf#5134 AS s_comment_prf_1#5142]
            +- Relation[s_phone_prf#5127,rid#5128,s_address_prf#5129,s_nationkey_prf#5130,s_suppkey_prf#5131,s_name_prf#5132,s_acctbal_prf#5133,s_comment_prf#5134] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=10000
Elapsed time: 223ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/12 16:12:57 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:12:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5192L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 16:12:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5192L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#5194 AS l_returnflag_prf_0#5213, l_orderkey_and_l_linenumber_prf#5195 AS l_orderkey_and_l_linenumber_prf_0#5214, l_comment_prf#5196 AS l_comment_prf_0#5215, l_linestatus_prf#5197 AS l_linestatus_prf_0#5216, rid#5198 AS rid_0#5217, l_shipmode_prf#5199 AS l_shipmode_prf_0#5218, l_shipinstruct_prf#5200 AS l_shipinstruct_prf_0#5219, l_quantity_prf#5201 AS l_quantity_prf_0#5220, l_receiptdate_prf#5202 AS l_receiptdate_prf_0#5221, l_linenumber_prf#5203 AS l_linenumber_prf_0#5222, l_tax_prf#5204 AS l_tax_prf_0#5223, l_shipdate_prf#5205 AS l_shipdate_prf_0#5224, l_extendedprice_prf#5206 AS l_extendedprice_prf_0#5225, l_partkey_prf#5207 AS l_partkey_prf_0#5226, l_discount_prf#5208 AS l_discount_prf_0#5227, l_partkey_and_l_suppkey_prf#5209 AS l_partkey_and_l_suppkey_prf_0#5228, l_commitdate_prf#5210 AS l_commitdate_prf_0#5229, l_suppkey_prf#5211 AS l_suppkey_prf_0#5230, l_orderkey_prf#5212 AS l_orderkey_prf_0#5231]
         :  :  +- Relation[l_returnflag_prf#5194,l_orderkey_and_l_linenumber_prf#5195,l_comment_prf#5196,l_linestatus_prf#5197,rid#5198,l_shipmode_prf#5199,l_shipinstruct_prf#5200,l_quantity_prf#5201,l_receiptdate_prf#5202,l_linenumber_prf#5203,l_tax_prf#5204,l_shipdate_prf#5205,l_extendedprice_prf#5206,l_partkey_prf#5207,l_discount_prf#5208,l_partkey_and_l_suppkey_prf#5209,l_commitdate_prf#5210,l_suppkey_prf#5211,l_orderkey_prf#5212] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5232, dexdecrypt('value_dec_key, 'value_right) AS rid_2#5233]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [c_acctbal_prf#5234 AS c_acctbal_prf_1#5243, rid#5235 AS rid_1#5244, c_name_prf#5236 AS c_name_prf_1#5245, c_nationkey_prf#5237 AS c_nationkey_prf_1#5246, c_custkey_prf#5238 AS c_custkey_prf_1#5247, c_comment_prf#5239 AS c_comment_prf_1#5248, c_address_prf#5240 AS c_address_prf_1#5249, c_mktsegment_prf#5241 AS c_mktsegment_prf_1#5250, c_phone_prf#5242 AS c_phone_prf_1#5251]
            :  :  +- Relation[c_acctbal_prf#5234,rid#5235,c_name_prf#5236,c_nationkey_prf#5237,c_custkey_prf#5238,c_comment_prf#5239,c_address_prf#5240,c_mktsegment_prf#5241,c_phone_prf#5242] JDBCRelation(customer_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#5252, dexdecrypt('value_dec_key, 'value_right) AS rid_2#5253]
            :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
            :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#5254 AS o_shippriority_prf_2#5264, rid#5255 AS rid_2#5265, o_orderdate_prf#5256 AS o_orderdate_prf_2#5266, o_custkey_prf#5257 AS o_custkey_prf_2#5267, o_orderpriority_prf#5258 AS o_orderpriority_prf_2#5268, o_clerk_prf#5259 AS o_clerk_prf_2#5269, o_orderstatus_prf#5260 AS o_orderstatus_prf_2#5270, o_totalprice_prf#5261 AS o_totalprice_prf_2#5271, o_orderkey_prf#5262 AS o_orderkey_prf_2#5272, o_comment_prf#5263 AS o_comment_prf_2#5273]
               +- Relation[o_shippriority_prf#5254,rid#5255,o_orderdate_prf#5256,o_custkey_prf#5257,o_orderpriority_prf#5258,o_clerk_prf#5259,o_orderstatus_prf#5260,o_totalprice_prf#5261,o_orderkey_prf#5262,o_comment_prf#5263] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 181924ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/12 16:15:59 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:15:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5348L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 16:15:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5348L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#5350 AS l_returnflag_prf_0#5369, l_orderkey_and_l_linenumber_prf#5351 AS l_orderkey_and_l_linenumber_prf_0#5370, l_comment_prf#5352 AS l_comment_prf_0#5371, l_linestatus_prf#5353 AS l_linestatus_prf_0#5372, rid#5354 AS rid_0#5373, l_shipmode_prf#5355 AS l_shipmode_prf_0#5374, l_shipinstruct_prf#5356 AS l_shipinstruct_prf_0#5375, l_quantity_prf#5357 AS l_quantity_prf_0#5376, l_receiptdate_prf#5358 AS l_receiptdate_prf_0#5377, l_linenumber_prf#5359 AS l_linenumber_prf_0#5378, l_tax_prf#5360 AS l_tax_prf_0#5379, l_shipdate_prf#5361 AS l_shipdate_prf_0#5380, l_extendedprice_prf#5362 AS l_extendedprice_prf_0#5381, l_partkey_prf#5363 AS l_partkey_prf_0#5382, l_discount_prf#5364 AS l_discount_prf_0#5383, l_partkey_and_l_suppkey_prf#5365 AS l_partkey_and_l_suppkey_prf_0#5384, l_commitdate_prf#5366 AS l_commitdate_prf_0#5385, l_suppkey_prf#5367 AS l_suppkey_prf_0#5386, l_orderkey_prf#5368 AS l_orderkey_prf_0#5387]
         :  :  +- Relation[l_returnflag_prf#5350,l_orderkey_and_l_linenumber_prf#5351,l_comment_prf#5352,l_linestatus_prf#5353,rid#5354,l_shipmode_prf#5355,l_shipinstruct_prf#5356,l_quantity_prf#5357,l_receiptdate_prf#5358,l_linenumber_prf#5359,l_tax_prf#5360,l_shipdate_prf#5361,l_extendedprice_prf#5362,l_partkey_prf#5363,l_discount_prf#5364,l_partkey_and_l_suppkey_prf#5365,l_commitdate_prf#5366,l_suppkey_prf#5367,l_orderkey_prf#5368] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5388, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5389]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [o_shippriority_prf#5390 AS o_shippriority_prf_1#5400, rid#5391 AS rid_1#5401, o_orderdate_prf#5392 AS o_orderdate_prf_1#5402, o_custkey_prf#5393 AS o_custkey_prf_1#5403, o_orderpriority_prf#5394 AS o_orderpriority_prf_1#5404, o_clerk_prf#5395 AS o_clerk_prf_1#5405, o_orderstatus_prf#5396 AS o_orderstatus_prf_1#5406, o_totalprice_prf#5397 AS o_totalprice_prf_1#5407, o_orderkey_prf#5398 AS o_orderkey_prf_1#5408, o_comment_prf#5399 AS o_comment_prf_1#5409]
            :  :  +- Relation[o_shippriority_prf#5390,rid#5391,o_orderdate_prf#5392,o_custkey_prf#5393,o_orderpriority_prf#5394,o_clerk_prf#5395,o_orderstatus_prf#5396,o_totalprice_prf#5397,o_orderkey_prf#5398,o_comment_prf#5399] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#5410, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5411]
            :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
            :        +- Relation[label#1488,value_left#1489,value_right#1490] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#5412 AS c_acctbal_prf_2#5421, rid#5413 AS rid_2#5422, c_name_prf#5414 AS c_name_prf_2#5423, c_nationkey_prf#5415 AS c_nationkey_prf_2#5424, c_custkey_prf#5416 AS c_custkey_prf_2#5425, c_comment_prf#5417 AS c_comment_prf_2#5426, c_address_prf#5418 AS c_address_prf_2#5427, c_mktsegment_prf#5419 AS c_mktsegment_prf_2#5428, c_phone_prf#5420 AS c_phone_prf_2#5429]
               +- Relation[c_acctbal_prf#5412,rid#5413,c_name_prf#5414,c_nationkey_prf#5415,c_custkey_prf#5416,c_comment_prf#5417,c_address_prf#5418,c_mktsegment_prf#5419,c_phone_prf#5420] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 183214ms
query=b1a, count=15628, duration=7773
query=b1b, count=15628, duration=7733
query=b2a, count=1478870, duration=98417
query=b2b, count=1478870, duration=97520
query=f1, count=1, duration=51
query=f2, count=3907, duration=123
query=f3, count=1451, duration=87
query=f4, count=1, duration=55
query=f5, count=1478870, duration=23210
query=f6, count=857401, duration=13658
query=j1, count=800000, duration=12115
query=j10, count=6001215, duration=88914
query=j2, count=800000, duration=12456
query=j3, count=25, duration=251
query=j4, count=150000, duration=2519
query=j5, count=10000, duration=223
query=j6, count=6001215, duration=105222
query=j7, count=1500000, duration=23618
query=j8, count=6001215, duration=106893
query=j8b, count=6001215, duration=106767
query=j9, count=6001215, duration=95637
query=j9b, count=6001215, duration=94873
query=r1a, count=6001215, duration=183717
query=r1b, count=6001215, duration=183214
query=r1c, count=6001215, duration=181924
query=r1d, count=6001215, duration=168519
query=r1e, count=6001215, duration=169065
query=r1f, count=6001215, duration=142270
query=t1a, count=60000414, duration=887962
query=t1b, count=60000414, duration=882374
query=t1c, count=60000414, duration=902171
query=t2a, count=800000, duration=26061
query=t2b, count=800000, duration=26100
query=t2c, count=800000, duration=26195
query=t2d, count=800000, duration=26086
query=t3a, count=6001215, duration=202320
query=t3b, count=6001215, duration=201434
query=t3c, count=6001215, duration=201544
query=t3d, count=6001215, duration=202561
