19/10/12 07:04:59 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7020ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Oct 12 07:05:01 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Oct 12 07:05:02 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Oct 12 07:05:02 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Oct 12 07:05:02 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Oct 12 07:05:02 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Oct 12 07:05:05 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Oct 12 07:05:07 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Oct 12 07:05:07 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



f1=
select * from region where r_name = 'EUROPE'
19/10/12 07:05:08 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:05:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1474L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/12 07:05:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1474L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#1476 AS r_regionkey_prf_0#1480, r_name_prf#1477 AS r_name_prf_0#1481, r_comment_prf#1478 AS r_comment_prf_0#1482, rid#1479 AS rid_0#1483]
         :  +- Relation[r_regionkey_prf#1476,r_name_prf#1477,r_comment_prf#1478,rid#1479] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1486]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1484,value#1485] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1
Elapsed time: 211ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/12 07:05:08 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:05:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1513L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 07:05:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1513L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [rid#1515 AS rid_0#1520, n_regionkey_prf#1516 AS n_regionkey_prf_0#1521, n_nationkey_prf#1517 AS n_nationkey_prf_0#1522, n_name_prf#1518 AS n_name_prf_0#1523, n_comment_prf#1519 AS n_comment_prf_0#1524]
         :  :  :  :  +- Relation[rid#1515,n_regionkey_prf#1516,n_nationkey_prf#1517,n_name_prf#1518,n_comment_prf#1519] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1528, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1529]
         :  :  :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :  :  :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#1530 AS s_phone_prf_1#1538, rid#1531 AS rid_1#1539, s_address_prf#1532 AS s_address_prf_1#1540, s_nationkey_prf#1533 AS s_nationkey_prf_1#1541, s_suppkey_prf#1534 AS s_suppkey_prf_1#1542, s_name_prf#1535 AS s_name_prf_1#1543, s_acctbal_prf#1536 AS s_acctbal_prf_1#1544, s_comment_prf#1537 AS s_comment_prf_1#1545]
         :  :     +- Relation[s_phone_prf#1530,rid#1531,s_address_prf#1532,s_nationkey_prf#1533,s_suppkey_prf#1534,s_name_prf#1535,s_acctbal_prf#1536,s_comment_prf#1537] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#1546, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1547]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#1548 AS c_acctbal_prf_2#1557, rid#1549 AS rid_2#1558, c_name_prf#1550 AS c_name_prf_2#1559, c_nationkey_prf#1551 AS c_nationkey_prf_2#1560, c_custkey_prf#1552 AS c_custkey_prf_2#1561, c_comment_prf#1553 AS c_comment_prf_2#1562, c_address_prf#1554 AS c_address_prf_2#1563, c_mktsegment_prf#1555 AS c_mktsegment_prf_2#1564, c_phone_prf#1556 AS c_phone_prf_2#1565]
            +- Relation[c_acctbal_prf#1548,rid#1549,c_name_prf#1550,c_nationkey_prf#1551,c_custkey_prf#1552,c_comment_prf#1553,c_address_prf#1554,c_mktsegment_prf#1555,c_phone_prf#1556] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 887669ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/12 07:19:56 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:19:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1623L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 07:19:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1623L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [p_comment_prf#1625 AS p_comment_prf_0#1635, p_name_prf#1626 AS p_name_prf_0#1636, rid#1627 AS rid_0#1637, p_type_prf#1628 AS p_type_prf_0#1638, p_retailprice_prf#1629 AS p_retailprice_prf_0#1639, p_mfgr_prf#1630 AS p_mfgr_prf_0#1640, p_container_prf#1631 AS p_container_prf_0#1641, p_brand_prf#1632 AS p_brand_prf_0#1642, p_size_prf#1633 AS p_size_prf_0#1643, p_partkey_prf#1634 AS p_partkey_prf_0#1644]
         :  :  :  :  +- Relation[p_comment_prf#1625,p_name_prf#1626,rid#1627,p_type_prf#1628,p_retailprice_prf#1629,p_mfgr_prf#1630,p_container_prf#1631,p_brand_prf#1632,p_size_prf#1633,p_partkey_prf#1634] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1645, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1646]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :  :  :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#1647 AS l_returnflag_prf_1#1666, l_orderkey_and_l_linenumber_prf#1648 AS l_orderkey_and_l_linenumber_prf_1#1667, l_comment_prf#1649 AS l_comment_prf_1#1668, l_linestatus_prf#1650 AS l_linestatus_prf_1#1669, rid#1651 AS rid_1#1670, l_shipmode_prf#1652 AS l_shipmode_prf_1#1671, l_shipinstruct_prf#1653 AS l_shipinstruct_prf_1#1672, l_quantity_prf#1654 AS l_quantity_prf_1#1673, l_receiptdate_prf#1655 AS l_receiptdate_prf_1#1674, l_linenumber_prf#1656 AS l_linenumber_prf_1#1675, l_tax_prf#1657 AS l_tax_prf_1#1676, l_shipdate_prf#1658 AS l_shipdate_prf_1#1677, l_extendedprice_prf#1659 AS l_extendedprice_prf_1#1678, l_partkey_prf#1660 AS l_partkey_prf_1#1679, l_discount_prf#1661 AS l_discount_prf_1#1680, l_partkey_and_l_suppkey_prf#1662 AS l_partkey_and_l_suppkey_prf_1#1681, l_commitdate_prf#1663 AS l_commitdate_prf_1#1682, l_suppkey_prf#1664 AS l_suppkey_prf_1#1683, l_orderkey_prf#1665 AS l_orderkey_prf_1#1684]
         :  :     +- Relation[l_returnflag_prf#1647,l_orderkey_and_l_linenumber_prf#1648,l_comment_prf#1649,l_linestatus_prf#1650,rid#1651,l_shipmode_prf#1652,l_shipinstruct_prf#1653,l_quantity_prf#1654,l_receiptdate_prf#1655,l_linenumber_prf#1656,l_tax_prf#1657,l_shipdate_prf#1658,l_extendedprice_prf#1659,l_partkey_prf#1660,l_discount_prf#1661,l_partkey_and_l_suppkey_prf#1662,l_commitdate_prf#1663,l_suppkey_prf#1664,l_orderkey_prf#1665] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1685, dexdecrypt('value_dec_key, 'value_right) AS rid_2#1686]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#1687 AS s_phone_prf_2#1695, rid#1688 AS rid_2#1696, s_address_prf#1689 AS s_address_prf_2#1697, s_nationkey_prf#1690 AS s_nationkey_prf_2#1698, s_suppkey_prf#1691 AS s_suppkey_prf_2#1699, s_name_prf#1692 AS s_name_prf_2#1700, s_acctbal_prf#1693 AS s_acctbal_prf_2#1701, s_comment_prf#1694 AS s_comment_prf_2#1702]
            +- Relation[s_phone_prf#1687,rid#1688,s_address_prf#1689,s_nationkey_prf#1690,s_suppkey_prf#1691,s_name_prf#1692,s_acctbal_prf#1693,s_comment_prf#1694] JDBCRelation(supplier_prf) [numPartitions=1]

19/10/12 07:19:56 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexSpx$ result size=6001215
Elapsed time: 201214ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/12 07:23:18 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:23:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1768L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 07:23:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1768L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [o_shippriority_prf#1770 AS o_shippriority_prf_0#1780, rid#1771 AS rid_0#1781, o_orderdate_prf#1772 AS o_orderdate_prf_0#1782, o_custkey_prf#1773 AS o_custkey_prf_0#1783, o_orderpriority_prf#1774 AS o_orderpriority_prf_0#1784, o_clerk_prf#1775 AS o_clerk_prf_0#1785, o_orderstatus_prf#1776 AS o_orderstatus_prf_0#1786, o_totalprice_prf#1777 AS o_totalprice_prf_0#1787, o_orderkey_prf#1778 AS o_orderkey_prf_0#1788, o_comment_prf#1779 AS o_comment_prf_0#1789]
         :  :  +- Relation[o_shippriority_prf#1770,rid#1771,o_orderdate_prf#1772,o_custkey_prf#1773,o_orderpriority_prf#1774,o_clerk_prf#1775,o_orderstatus_prf#1776,o_totalprice_prf#1777,o_orderkey_prf#1778,o_comment_prf#1779] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1790, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1791]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1792 AS l_returnflag_prf_1#1811, l_orderkey_and_l_linenumber_prf#1793 AS l_orderkey_and_l_linenumber_prf_1#1812, l_comment_prf#1794 AS l_comment_prf_1#1813, l_linestatus_prf#1795 AS l_linestatus_prf_1#1814, rid#1796 AS rid_1#1815, l_shipmode_prf#1797 AS l_shipmode_prf_1#1816, l_shipinstruct_prf#1798 AS l_shipinstruct_prf_1#1817, l_quantity_prf#1799 AS l_quantity_prf_1#1818, l_receiptdate_prf#1800 AS l_receiptdate_prf_1#1819, l_linenumber_prf#1801 AS l_linenumber_prf_1#1820, l_tax_prf#1802 AS l_tax_prf_1#1821, l_shipdate_prf#1803 AS l_shipdate_prf_1#1822, l_extendedprice_prf#1804 AS l_extendedprice_prf_1#1823, l_partkey_prf#1805 AS l_partkey_prf_1#1824, l_discount_prf#1806 AS l_discount_prf_1#1825, l_partkey_and_l_suppkey_prf#1807 AS l_partkey_and_l_suppkey_prf_1#1826, l_commitdate_prf#1808 AS l_commitdate_prf_1#1827, l_suppkey_prf#1809 AS l_suppkey_prf_1#1828, l_orderkey_prf#1810 AS l_orderkey_prf_1#1829]
            +- Relation[l_returnflag_prf#1792,l_orderkey_and_l_linenumber_prf#1793,l_comment_prf#1794,l_linestatus_prf#1795,rid#1796,l_shipmode_prf#1797,l_shipinstruct_prf#1798,l_quantity_prf#1799,l_receiptdate_prf#1800,l_linenumber_prf#1801,l_tax_prf#1802,l_shipdate_prf#1803,l_extendedprice_prf#1804,l_partkey_prf#1805,l_discount_prf#1806,l_partkey_and_l_suppkey_prf#1807,l_commitdate_prf#1808,l_suppkey_prf#1809,l_orderkey_prf#1810] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 107988ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/12 07:25:05 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:25:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1883L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 07:25:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1883L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#1885 AS s_phone_prf_0#1893, rid#1886 AS rid_0#1894, s_address_prf#1887 AS s_address_prf_0#1895, s_nationkey_prf#1888 AS s_nationkey_prf_0#1896, s_suppkey_prf#1889 AS s_suppkey_prf_0#1897, s_name_prf#1890 AS s_name_prf_0#1898, s_acctbal_prf#1891 AS s_acctbal_prf_0#1899, s_comment_prf#1892 AS s_comment_prf_0#1900]
         :  :  +- Relation[s_phone_prf#1885,rid#1886,s_address_prf#1887,s_nationkey_prf#1888,s_suppkey_prf#1889,s_name_prf#1890,s_acctbal_prf#1891,s_comment_prf#1892] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#1901, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1902]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [p_comment_prf#1903 AS p_comment_prf_1#1913, p_name_prf#1904 AS p_name_prf_1#1914, rid#1905 AS rid_1#1915, p_type_prf#1906 AS p_type_prf_1#1916, p_retailprice_prf#1907 AS p_retailprice_prf_1#1917, p_mfgr_prf#1908 AS p_mfgr_prf_1#1918, p_container_prf#1909 AS p_container_prf_1#1919, p_brand_prf#1910 AS p_brand_prf_1#1920, p_size_prf#1911 AS p_size_prf_1#1921, p_partkey_prf#1912 AS p_partkey_prf_1#1922]
            :  :  +- Relation[p_comment_prf#1903,p_name_prf#1904,rid#1905,p_type_prf#1906,p_retailprice_prf#1907,p_mfgr_prf#1908,p_container_prf#1909,p_brand_prf#1910,p_size_prf#1911,p_partkey_prf#1912] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1923, dexdecrypt('value_dec_key, 'value_right) AS rid_2#1924]
            :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
            :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#1925 AS ps_partkey_and_ps_suppkey_prf_2#1932, rid#1926 AS rid_2#1933, ps_availqty_prf#1927 AS ps_availqty_prf_2#1934, ps_comment_prf#1928 AS ps_comment_prf_2#1935, ps_partkey_prf#1929 AS ps_partkey_prf_2#1936, ps_supplycost_prf#1930 AS ps_supplycost_prf_2#1937, ps_suppkey_prf#1931 AS ps_suppkey_prf_2#1938]
               +- Relation[ps_partkey_and_ps_suppkey_prf#1925,rid#1926,ps_availqty_prf#1927,ps_comment_prf#1928,ps_partkey_prf#1929,ps_supplycost_prf#1930,ps_suppkey_prf#1931] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26169ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/12 07:25:31 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:25:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1992L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 07:25:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1992L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [o_shippriority_prf#1994 AS o_shippriority_prf_0#2004, rid#1995 AS rid_0#2005, o_orderdate_prf#1996 AS o_orderdate_prf_0#2006, o_custkey_prf#1997 AS o_custkey_prf_0#2007, o_orderpriority_prf#1998 AS o_orderpriority_prf_0#2008, o_clerk_prf#1999 AS o_clerk_prf_0#2009, o_orderstatus_prf#2000 AS o_orderstatus_prf_0#2010, o_totalprice_prf#2001 AS o_totalprice_prf_0#2011, o_orderkey_prf#2002 AS o_orderkey_prf_0#2012, o_comment_prf#2003 AS o_comment_prf_0#2013]
         :  :  +- Relation[o_shippriority_prf#1994,rid#1995,o_orderdate_prf#1996,o_custkey_prf#1997,o_orderpriority_prf#1998,o_clerk_prf#1999,o_orderstatus_prf#2000,o_totalprice_prf#2001,o_orderkey_prf#2002,o_comment_prf#2003] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2014, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2015]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#2016 AS l_returnflag_prf_1#2035, l_orderkey_and_l_linenumber_prf#2017 AS l_orderkey_and_l_linenumber_prf_1#2036, l_comment_prf#2018 AS l_comment_prf_1#2037, l_linestatus_prf#2019 AS l_linestatus_prf_1#2038, rid#2020 AS rid_1#2039, l_shipmode_prf#2021 AS l_shipmode_prf_1#2040, l_shipinstruct_prf#2022 AS l_shipinstruct_prf_1#2041, l_quantity_prf#2023 AS l_quantity_prf_1#2042, l_receiptdate_prf#2024 AS l_receiptdate_prf_1#2043, l_linenumber_prf#2025 AS l_linenumber_prf_1#2044, l_tax_prf#2026 AS l_tax_prf_1#2045, l_shipdate_prf#2027 AS l_shipdate_prf_1#2046, l_extendedprice_prf#2028 AS l_extendedprice_prf_1#2047, l_partkey_prf#2029 AS l_partkey_prf_1#2048, l_discount_prf#2030 AS l_discount_prf_1#2049, l_partkey_and_l_suppkey_prf#2031 AS l_partkey_and_l_suppkey_prf_1#2050, l_commitdate_prf#2032 AS l_commitdate_prf_1#2051, l_suppkey_prf#2033 AS l_suppkey_prf_1#2052, l_orderkey_prf#2034 AS l_orderkey_prf_1#2053]
            :  +- Relation[l_returnflag_prf#2016,l_orderkey_and_l_linenumber_prf#2017,l_comment_prf#2018,l_linestatus_prf#2019,rid#2020,l_shipmode_prf#2021,l_shipinstruct_prf#2022,l_quantity_prf#2023,l_receiptdate_prf#2024,l_linenumber_prf#2025,l_tax_prf#2026,l_shipdate_prf#2027,l_extendedprice_prf#2028,l_partkey_prf#2029,l_discount_prf#2030,l_partkey_and_l_suppkey_prf#2031,l_commitdate_prf#2032,l_suppkey_prf#2033,l_orderkey_prf#2034] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2054]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1484,value#1485] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 97726ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/12 07:27:09 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:27:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2099L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 07:27:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2099L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [rid#2101 AS rid_0#2106, n_regionkey_prf#2102 AS n_regionkey_prf_0#2107, n_nationkey_prf#2103 AS n_nationkey_prf_0#2108, n_name_prf#2104 AS n_name_prf_0#2109, n_comment_prf#2105 AS n_comment_prf_0#2110]
         :  :  +- Relation[rid#2101,n_regionkey_prf#2102,n_nationkey_prf#2103,n_name_prf#2104,n_comment_prf#2105] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2111, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2112]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2113 AS c_acctbal_prf_1#2122, rid#2114 AS rid_1#2123, c_name_prf#2115 AS c_name_prf_1#2124, c_nationkey_prf#2116 AS c_nationkey_prf_1#2125, c_custkey_prf#2117 AS c_custkey_prf_1#2126, c_comment_prf#2118 AS c_comment_prf_1#2127, c_address_prf#2119 AS c_address_prf_1#2128, c_mktsegment_prf#2120 AS c_mktsegment_prf_1#2129, c_phone_prf#2121 AS c_phone_prf_1#2130]
            +- Relation[c_acctbal_prf#2113,rid#2114,c_name_prf#2115,c_nationkey_prf#2116,c_custkey_prf#2117,c_comment_prf#2118,c_address_prf#2119,c_mktsegment_prf#2120,c_phone_prf#2121] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=150000
Elapsed time: 2540ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/12 07:27:11 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:27:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2162L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 07:27:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2162L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [p_comment_prf#2164 AS p_comment_prf_0#2174, p_name_prf#2165 AS p_name_prf_0#2175, rid#2166 AS rid_0#2176, p_type_prf#2167 AS p_type_prf_0#2177, p_retailprice_prf#2168 AS p_retailprice_prf_0#2178, p_mfgr_prf#2169 AS p_mfgr_prf_0#2179, p_container_prf#2170 AS p_container_prf_0#2180, p_brand_prf#2171 AS p_brand_prf_0#2181, p_size_prf#2172 AS p_size_prf_0#2182, p_partkey_prf#2173 AS p_partkey_prf_0#2183]
         :  :  :  +- Relation[p_comment_prf#2164,p_name_prf#2165,rid#2166,p_type_prf#2167,p_retailprice_prf#2168,p_mfgr_prf#2169,p_container_prf#2170,p_brand_prf#2171,p_size_prf#2172,p_partkey_prf#2173] JDBCRelation(part_prf) [numPartitions=1]
         :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2184]
         :  :     +- DexRidFilter part~p_size~15
         :  :        +- Relation[label#1484,value#1485] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2185, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2186]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2187 AS ps_partkey_and_ps_suppkey_prf_1#2194, rid#2188 AS rid_1#2195, ps_availqty_prf#2189 AS ps_availqty_prf_1#2196, ps_comment_prf#2190 AS ps_comment_prf_1#2197, ps_partkey_prf#2191 AS ps_partkey_prf_1#2198, ps_supplycost_prf#2192 AS ps_supplycost_prf_1#2199, ps_suppkey_prf#2193 AS ps_suppkey_prf_1#2200]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2187,rid#2188,ps_availqty_prf#2189,ps_comment_prf#2190,ps_partkey_prf#2191,ps_supplycost_prf#2192,ps_suppkey_prf#2193] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=15628
Elapsed time: 7821ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/12 07:27:22 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:27:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2235L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 07:27:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2235L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [p_comment_prf#2237 AS p_comment_prf_0#2247, p_name_prf#2238 AS p_name_prf_0#2248, rid#2239 AS rid_0#2249, p_type_prf#2240 AS p_type_prf_0#2250, p_retailprice_prf#2241 AS p_retailprice_prf_0#2251, p_mfgr_prf#2242 AS p_mfgr_prf_0#2252, p_container_prf#2243 AS p_container_prf_0#2253, p_brand_prf#2244 AS p_brand_prf_0#2254, p_size_prf#2245 AS p_size_prf_0#2255, p_partkey_prf#2246 AS p_partkey_prf_0#2256]
         :  :  +- Relation[p_comment_prf#2237,p_name_prf#2238,rid#2239,p_type_prf#2240,p_retailprice_prf#2241,p_mfgr_prf#2242,p_container_prf#2243,p_brand_prf#2244,p_size_prf#2245,p_partkey_prf#2246] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2257, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2258]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2259 AS ps_partkey_and_ps_suppkey_prf_1#2266, rid#2260 AS rid_1#2267, ps_availqty_prf#2261 AS ps_availqty_prf_1#2268, ps_comment_prf#2262 AS ps_comment_prf_1#2269, ps_partkey_prf#2263 AS ps_partkey_prf_1#2270, ps_supplycost_prf#2264 AS ps_supplycost_prf_1#2271, ps_suppkey_prf#2265 AS ps_suppkey_prf_1#2272]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2259,rid#2260,ps_availqty_prf#2261,ps_comment_prf#2262,ps_partkey_prf#2263,ps_supplycost_prf#2264,ps_suppkey_prf#2265] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 14709ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/12 07:27:34 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:27:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2318L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 07:27:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2318L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [l_returnflag_prf#2320 AS l_returnflag_prf_0#2339, l_orderkey_and_l_linenumber_prf#2321 AS l_orderkey_and_l_linenumber_prf_0#2340, l_comment_prf#2322 AS l_comment_prf_0#2341, l_linestatus_prf#2323 AS l_linestatus_prf_0#2342, rid#2324 AS rid_0#2343, l_shipmode_prf#2325 AS l_shipmode_prf_0#2344, l_shipinstruct_prf#2326 AS l_shipinstruct_prf_0#2345, l_quantity_prf#2327 AS l_quantity_prf_0#2346, l_receiptdate_prf#2328 AS l_receiptdate_prf_0#2347, l_linenumber_prf#2329 AS l_linenumber_prf_0#2348, l_tax_prf#2330 AS l_tax_prf_0#2349, l_shipdate_prf#2331 AS l_shipdate_prf_0#2350, l_extendedprice_prf#2332 AS l_extendedprice_prf_0#2351, l_partkey_prf#2333 AS l_partkey_prf_0#2352, l_discount_prf#2334 AS l_discount_prf_0#2353, l_partkey_and_l_suppkey_prf#2335 AS l_partkey_and_l_suppkey_prf_0#2354, l_commitdate_prf#2336 AS l_commitdate_prf_0#2355, l_suppkey_prf#2337 AS l_suppkey_prf_0#2356, l_orderkey_prf#2338 AS l_orderkey_prf_0#2357]
         :  :  :  +- Relation[l_returnflag_prf#2320,l_orderkey_and_l_linenumber_prf#2321,l_comment_prf#2322,l_linestatus_prf#2323,rid#2324,l_shipmode_prf#2325,l_shipinstruct_prf#2326,l_quantity_prf#2327,l_receiptdate_prf#2328,l_linenumber_prf#2329,l_tax_prf#2330,l_shipdate_prf#2331,l_extendedprice_prf#2332,l_partkey_prf#2333,l_discount_prf#2334,l_partkey_and_l_suppkey_prf#2335,l_commitdate_prf#2336,l_suppkey_prf#2337,l_orderkey_prf#2338] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2358]
         :  :     +- DexRidFilter lineitem~l_returnflag~R
         :  :        +- Relation[label#1484,value#1485] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2359, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2360]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2361 AS o_shippriority_prf_1#2371, rid#2362 AS rid_1#2372, o_orderdate_prf#2363 AS o_orderdate_prf_1#2373, o_custkey_prf#2364 AS o_custkey_prf_1#2374, o_orderpriority_prf#2365 AS o_orderpriority_prf_1#2375, o_clerk_prf#2366 AS o_clerk_prf_1#2376, o_orderstatus_prf#2367 AS o_orderstatus_prf_1#2377, o_totalprice_prf#2368 AS o_totalprice_prf_1#2378, o_orderkey_prf#2369 AS o_orderkey_prf_1#2379, o_comment_prf#2370 AS o_comment_prf_1#2380]
            +- Relation[o_shippriority_prf#2361,rid#2362,o_orderdate_prf#2363,o_custkey_prf#2364,o_orderpriority_prf#2365,o_clerk_prf#2366,o_orderstatus_prf#2367,o_totalprice_prf#2368,o_orderkey_prf#2369,o_comment_prf#2370] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 97398ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/12 07:29:11 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:29:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2438L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 07:29:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2438L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#2440 AS l_returnflag_prf_0#2459, l_orderkey_and_l_linenumber_prf#2441 AS l_orderkey_and_l_linenumber_prf_0#2460, l_comment_prf#2442 AS l_comment_prf_0#2461, l_linestatus_prf#2443 AS l_linestatus_prf_0#2462, rid#2444 AS rid_0#2463, l_shipmode_prf#2445 AS l_shipmode_prf_0#2464, l_shipinstruct_prf#2446 AS l_shipinstruct_prf_0#2465, l_quantity_prf#2447 AS l_quantity_prf_0#2466, l_receiptdate_prf#2448 AS l_receiptdate_prf_0#2467, l_linenumber_prf#2449 AS l_linenumber_prf_0#2468, l_tax_prf#2450 AS l_tax_prf_0#2469, l_shipdate_prf#2451 AS l_shipdate_prf_0#2470, l_extendedprice_prf#2452 AS l_extendedprice_prf_0#2471, l_partkey_prf#2453 AS l_partkey_prf_0#2472, l_discount_prf#2454 AS l_discount_prf_0#2473, l_partkey_and_l_suppkey_prf#2455 AS l_partkey_and_l_suppkey_prf_0#2474, l_commitdate_prf#2456 AS l_commitdate_prf_0#2475, l_suppkey_prf#2457 AS l_suppkey_prf_0#2476, l_orderkey_prf#2458 AS l_orderkey_prf_0#2477]
         :  :  +- Relation[l_returnflag_prf#2440,l_orderkey_and_l_linenumber_prf#2441,l_comment_prf#2442,l_linestatus_prf#2443,rid#2444,l_shipmode_prf#2445,l_shipinstruct_prf#2446,l_quantity_prf#2447,l_receiptdate_prf#2448,l_linenumber_prf#2449,l_tax_prf#2450,l_shipdate_prf#2451,l_extendedprice_prf#2452,l_partkey_prf#2453,l_discount_prf#2454,l_partkey_and_l_suppkey_prf#2455,l_commitdate_prf#2456,l_suppkey_prf#2457,l_orderkey_prf#2458] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2478, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2479]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [p_comment_prf#2480 AS p_comment_prf_1#2490, p_name_prf#2481 AS p_name_prf_1#2491, rid#2482 AS rid_1#2492, p_type_prf#2483 AS p_type_prf_1#2493, p_retailprice_prf#2484 AS p_retailprice_prf_1#2494, p_mfgr_prf#2485 AS p_mfgr_prf_1#2495, p_container_prf#2486 AS p_container_prf_1#2496, p_brand_prf#2487 AS p_brand_prf_1#2497, p_size_prf#2488 AS p_size_prf_1#2498, p_partkey_prf#2489 AS p_partkey_prf_1#2499]
            +- Relation[p_comment_prf#2480,p_name_prf#2481,rid#2482,p_type_prf#2483,p_retailprice_prf#2484,p_mfgr_prf#2485,p_container_prf#2486,p_brand_prf#2487,p_size_prf#2488,p_partkey_prf#2489] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 95326ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/12 07:30:47 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:30:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2564L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 07:30:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2564L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#2566 AS s_phone_prf_0#2574, rid#2567 AS rid_0#2575, s_address_prf#2568 AS s_address_prf_0#2576, s_nationkey_prf#2569 AS s_nationkey_prf_0#2577, s_suppkey_prf#2570 AS s_suppkey_prf_0#2578, s_name_prf#2571 AS s_name_prf_0#2579, s_acctbal_prf#2572 AS s_acctbal_prf_0#2580, s_comment_prf#2573 AS s_comment_prf_0#2581]
         :  :  +- Relation[s_phone_prf#2566,rid#2567,s_address_prf#2568,s_nationkey_prf#2569,s_suppkey_prf#2570,s_name_prf#2571,s_acctbal_prf#2572,s_comment_prf#2573] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2582, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2583]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [p_comment_prf#2584 AS p_comment_prf_1#2594, p_name_prf#2585 AS p_name_prf_1#2595, rid#2586 AS rid_1#2596, p_type_prf#2587 AS p_type_prf_1#2597, p_retailprice_prf#2588 AS p_retailprice_prf_1#2598, p_mfgr_prf#2589 AS p_mfgr_prf_1#2599, p_container_prf#2590 AS p_container_prf_1#2600, p_brand_prf#2591 AS p_brand_prf_1#2601, p_size_prf#2592 AS p_size_prf_1#2602, p_partkey_prf#2593 AS p_partkey_prf_1#2603]
            :  :  +- Relation[p_comment_prf#2584,p_name_prf#2585,rid#2586,p_type_prf#2587,p_retailprice_prf#2588,p_mfgr_prf#2589,p_container_prf#2590,p_brand_prf#2591,p_size_prf#2592,p_partkey_prf#2593] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2604, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2605]
            :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
            :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2606 AS l_returnflag_prf_2#2625, l_orderkey_and_l_linenumber_prf#2607 AS l_orderkey_and_l_linenumber_prf_2#2626, l_comment_prf#2608 AS l_comment_prf_2#2627, l_linestatus_prf#2609 AS l_linestatus_prf_2#2628, rid#2610 AS rid_2#2629, l_shipmode_prf#2611 AS l_shipmode_prf_2#2630, l_shipinstruct_prf#2612 AS l_shipinstruct_prf_2#2631, l_quantity_prf#2613 AS l_quantity_prf_2#2632, l_receiptdate_prf#2614 AS l_receiptdate_prf_2#2633, l_linenumber_prf#2615 AS l_linenumber_prf_2#2634, l_tax_prf#2616 AS l_tax_prf_2#2635, l_shipdate_prf#2617 AS l_shipdate_prf_2#2636, l_extendedprice_prf#2618 AS l_extendedprice_prf_2#2637, l_partkey_prf#2619 AS l_partkey_prf_2#2638, l_discount_prf#2620 AS l_discount_prf_2#2639, l_partkey_and_l_suppkey_prf#2621 AS l_partkey_and_l_suppkey_prf_2#2640, l_commitdate_prf#2622 AS l_commitdate_prf_2#2641, l_suppkey_prf#2623 AS l_suppkey_prf_2#2642, l_orderkey_prf#2624 AS l_orderkey_prf_2#2643]
               +- Relation[l_returnflag_prf#2606,l_orderkey_and_l_linenumber_prf#2607,l_comment_prf#2608,l_linestatus_prf#2609,rid#2610,l_shipmode_prf#2611,l_shipinstruct_prf#2612,l_quantity_prf#2613,l_receiptdate_prf#2614,l_linenumber_prf#2615,l_tax_prf#2616,l_shipdate_prf#2617,l_extendedprice_prf#2618,l_partkey_prf#2619,l_discount_prf#2620,l_partkey_and_l_suppkey_prf#2621,l_commitdate_prf#2622,l_suppkey_prf#2623,l_orderkey_prf#2624] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201537ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/12 07:34:08 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:34:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2717L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 07:34:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2717L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#2719 AS c_acctbal_prf_0#2728, rid#2720 AS rid_0#2729, c_name_prf#2721 AS c_name_prf_0#2730, c_nationkey_prf#2722 AS c_nationkey_prf_0#2731, c_custkey_prf#2723 AS c_custkey_prf_0#2732, c_comment_prf#2724 AS c_comment_prf_0#2733, c_address_prf#2725 AS c_address_prf_0#2734, c_mktsegment_prf#2726 AS c_mktsegment_prf_0#2735, c_phone_prf#2727 AS c_phone_prf_0#2736]
         :  :  +- Relation[c_acctbal_prf#2719,rid#2720,c_name_prf#2721,c_nationkey_prf#2722,c_custkey_prf#2723,c_comment_prf#2724,c_address_prf#2725,c_mktsegment_prf#2726,c_phone_prf#2727] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2737, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2738]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [l_returnflag_prf#2739 AS l_returnflag_prf_1#2758, l_orderkey_and_l_linenumber_prf#2740 AS l_orderkey_and_l_linenumber_prf_1#2759, l_comment_prf#2741 AS l_comment_prf_1#2760, l_linestatus_prf#2742 AS l_linestatus_prf_1#2761, rid#2743 AS rid_1#2762, l_shipmode_prf#2744 AS l_shipmode_prf_1#2763, l_shipinstruct_prf#2745 AS l_shipinstruct_prf_1#2764, l_quantity_prf#2746 AS l_quantity_prf_1#2765, l_receiptdate_prf#2747 AS l_receiptdate_prf_1#2766, l_linenumber_prf#2748 AS l_linenumber_prf_1#2767, l_tax_prf#2749 AS l_tax_prf_1#2768, l_shipdate_prf#2750 AS l_shipdate_prf_1#2769, l_extendedprice_prf#2751 AS l_extendedprice_prf_1#2770, l_partkey_prf#2752 AS l_partkey_prf_1#2771, l_discount_prf#2753 AS l_discount_prf_1#2772, l_partkey_and_l_suppkey_prf#2754 AS l_partkey_and_l_suppkey_prf_1#2773, l_commitdate_prf#2755 AS l_commitdate_prf_1#2774, l_suppkey_prf#2756 AS l_suppkey_prf_1#2775, l_orderkey_prf#2757 AS l_orderkey_prf_1#2776]
            :  :  +- Relation[l_returnflag_prf#2739,l_orderkey_and_l_linenumber_prf#2740,l_comment_prf#2741,l_linestatus_prf#2742,rid#2743,l_shipmode_prf#2744,l_shipinstruct_prf#2745,l_quantity_prf#2746,l_receiptdate_prf#2747,l_linenumber_prf#2748,l_tax_prf#2749,l_shipdate_prf#2750,l_extendedprice_prf#2751,l_partkey_prf#2752,l_discount_prf#2753,l_partkey_and_l_suppkey_prf#2754,l_commitdate_prf#2755,l_suppkey_prf#2756,l_orderkey_prf#2757] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2777, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2778]
            :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
            :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2779 AS o_shippriority_prf_2#2789, rid#2780 AS rid_2#2790, o_orderdate_prf#2781 AS o_orderdate_prf_2#2791, o_custkey_prf#2782 AS o_custkey_prf_2#2792, o_orderpriority_prf#2783 AS o_orderpriority_prf_2#2793, o_clerk_prf#2784 AS o_clerk_prf_2#2794, o_orderstatus_prf#2785 AS o_orderstatus_prf_2#2795, o_totalprice_prf#2786 AS o_totalprice_prf_2#2796, o_orderkey_prf#2787 AS o_orderkey_prf_2#2797, o_comment_prf#2788 AS o_comment_prf_2#2798]
               +- Relation[o_shippriority_prf#2779,rid#2780,o_orderdate_prf#2781,o_custkey_prf#2782,o_orderpriority_prf#2783,o_clerk_prf#2784,o_orderstatus_prf#2785,o_totalprice_prf#2786,o_orderkey_prf#2787,o_comment_prf#2788] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 143826ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/12 07:36:32 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:36:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2865L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 07:36:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2865L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#2867 AS l_returnflag_prf_0#2886, l_orderkey_and_l_linenumber_prf#2868 AS l_orderkey_and_l_linenumber_prf_0#2887, l_comment_prf#2869 AS l_comment_prf_0#2888, l_linestatus_prf#2870 AS l_linestatus_prf_0#2889, rid#2871 AS rid_0#2890, l_shipmode_prf#2872 AS l_shipmode_prf_0#2891, l_shipinstruct_prf#2873 AS l_shipinstruct_prf_0#2892, l_quantity_prf#2874 AS l_quantity_prf_0#2893, l_receiptdate_prf#2875 AS l_receiptdate_prf_0#2894, l_linenumber_prf#2876 AS l_linenumber_prf_0#2895, l_tax_prf#2877 AS l_tax_prf_0#2896, l_shipdate_prf#2878 AS l_shipdate_prf_0#2897, l_extendedprice_prf#2879 AS l_extendedprice_prf_0#2898, l_partkey_prf#2880 AS l_partkey_prf_0#2899, l_discount_prf#2881 AS l_discount_prf_0#2900, l_partkey_and_l_suppkey_prf#2882 AS l_partkey_and_l_suppkey_prf_0#2901, l_commitdate_prf#2883 AS l_commitdate_prf_0#2902, l_suppkey_prf#2884 AS l_suppkey_prf_0#2903, l_orderkey_prf#2885 AS l_orderkey_prf_0#2904]
         :  :  +- Relation[l_returnflag_prf#2867,l_orderkey_and_l_linenumber_prf#2868,l_comment_prf#2869,l_linestatus_prf#2870,rid#2871,l_shipmode_prf#2872,l_shipinstruct_prf#2873,l_quantity_prf#2874,l_receiptdate_prf#2875,l_linenumber_prf#2876,l_tax_prf#2877,l_shipdate_prf#2878,l_extendedprice_prf#2879,l_partkey_prf#2880,l_discount_prf#2881,l_partkey_and_l_suppkey_prf#2882,l_commitdate_prf#2883,l_suppkey_prf#2884,l_orderkey_prf#2885] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2905, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2906]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2907 AS o_shippriority_prf_1#2917, rid#2908 AS rid_1#2918, o_orderdate_prf#2909 AS o_orderdate_prf_1#2919, o_custkey_prf#2910 AS o_custkey_prf_1#2920, o_orderpriority_prf#2911 AS o_orderpriority_prf_1#2921, o_clerk_prf#2912 AS o_clerk_prf_1#2922, o_orderstatus_prf#2913 AS o_orderstatus_prf_1#2923, o_totalprice_prf#2914 AS o_totalprice_prf_1#2924, o_orderkey_prf#2915 AS o_orderkey_prf_1#2925, o_comment_prf#2916 AS o_comment_prf_1#2926]
            +- Relation[o_shippriority_prf#2907,rid#2908,o_orderdate_prf#2909,o_custkey_prf#2910,o_orderpriority_prf#2911,o_clerk_prf#2912,o_orderstatus_prf#2913,o_totalprice_prf#2914,o_orderkey_prf#2915,o_comment_prf#2916] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 107160ms

f2=
select * from part where p_size = 15
19/10/12 07:38:19 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:38:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2968L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 07:38:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2968L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#2970 AS p_comment_prf_0#2980, p_name_prf#2971 AS p_name_prf_0#2981, rid#2972 AS rid_0#2982, p_type_prf#2973 AS p_type_prf_0#2983, p_retailprice_prf#2974 AS p_retailprice_prf_0#2984, p_mfgr_prf#2975 AS p_mfgr_prf_0#2985, p_container_prf#2976 AS p_container_prf_0#2986, p_brand_prf#2977 AS p_brand_prf_0#2987, p_size_prf#2978 AS p_size_prf_0#2988, p_partkey_prf#2979 AS p_partkey_prf_0#2989]
         :  +- Relation[p_comment_prf#2970,p_name_prf#2971,rid#2972,p_type_prf#2973,p_retailprice_prf#2974,p_mfgr_prf#2975,p_container_prf#2976,p_brand_prf#2977,p_size_prf#2978,p_partkey_prf#2979] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2990]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1484,value#1485] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=3907
Elapsed time: 124ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/12 07:38:19 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:38:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3029L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 07:38:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3029L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [p_comment_prf#3031 AS p_comment_prf_0#3041, p_name_prf#3032 AS p_name_prf_0#3042, rid#3033 AS rid_0#3043, p_type_prf#3034 AS p_type_prf_0#3044, p_retailprice_prf#3035 AS p_retailprice_prf_0#3045, p_mfgr_prf#3036 AS p_mfgr_prf_0#3046, p_container_prf#3037 AS p_container_prf_0#3047, p_brand_prf#3038 AS p_brand_prf_0#3048, p_size_prf#3039 AS p_size_prf_0#3049, p_partkey_prf#3040 AS p_partkey_prf_0#3050]
         :  :  +- Relation[p_comment_prf#3031,p_name_prf#3032,rid#3033,p_type_prf#3034,p_retailprice_prf#3035,p_mfgr_prf#3036,p_container_prf#3037,p_brand_prf#3038,p_size_prf#3039,p_partkey_prf#3040] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3051, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3052]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3053 AS l_returnflag_prf_1#3072, l_orderkey_and_l_linenumber_prf#3054 AS l_orderkey_and_l_linenumber_prf_1#3073, l_comment_prf#3055 AS l_comment_prf_1#3074, l_linestatus_prf#3056 AS l_linestatus_prf_1#3075, rid#3057 AS rid_1#3076, l_shipmode_prf#3058 AS l_shipmode_prf_1#3077, l_shipinstruct_prf#3059 AS l_shipinstruct_prf_1#3078, l_quantity_prf#3060 AS l_quantity_prf_1#3079, l_receiptdate_prf#3061 AS l_receiptdate_prf_1#3080, l_linenumber_prf#3062 AS l_linenumber_prf_1#3081, l_tax_prf#3063 AS l_tax_prf_1#3082, l_shipdate_prf#3064 AS l_shipdate_prf_1#3083, l_extendedprice_prf#3065 AS l_extendedprice_prf_1#3084, l_partkey_prf#3066 AS l_partkey_prf_1#3085, l_discount_prf#3067 AS l_discount_prf_1#3086, l_partkey_and_l_suppkey_prf#3068 AS l_partkey_and_l_suppkey_prf_1#3087, l_commitdate_prf#3069 AS l_commitdate_prf_1#3088, l_suppkey_prf#3070 AS l_suppkey_prf_1#3089, l_orderkey_prf#3071 AS l_orderkey_prf_1#3090]
            +- Relation[l_returnflag_prf#3053,l_orderkey_and_l_linenumber_prf#3054,l_comment_prf#3055,l_linestatus_prf#3056,rid#3057,l_shipmode_prf#3058,l_shipinstruct_prf#3059,l_quantity_prf#3060,l_receiptdate_prf#3061,l_linenumber_prf#3062,l_tax_prf#3063,l_shipdate_prf#3064,l_extendedprice_prf#3065,l_partkey_prf#3066,l_discount_prf#3067,l_partkey_and_l_suppkey_prf#3068,l_commitdate_prf#3069,l_suppkey_prf#3070,l_orderkey_prf#3071] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 94943ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/12 07:39:54 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:39:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3144L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 07:39:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3144L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [ps_partkey_and_ps_suppkey_prf#3146 AS ps_partkey_and_ps_suppkey_prf_0#3153, rid#3147 AS rid_0#3154, ps_availqty_prf#3148 AS ps_availqty_prf_0#3155, ps_comment_prf#3149 AS ps_comment_prf_0#3156, ps_partkey_prf#3150 AS ps_partkey_prf_0#3157, ps_supplycost_prf#3151 AS ps_supplycost_prf_0#3158, ps_suppkey_prf#3152 AS ps_suppkey_prf_0#3159]
         :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#3146,rid#3147,ps_availqty_prf#3148,ps_comment_prf#3149,ps_partkey_prf#3150,ps_supplycost_prf#3151,ps_suppkey_prf#3152] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3160, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3161]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey_and_l_suppkey~partsupp~ps_partkey_and_ps_suppkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3162 AS l_returnflag_prf_1#3181, l_orderkey_and_l_linenumber_prf#3163 AS l_orderkey_and_l_linenumber_prf_1#3182, l_comment_prf#3164 AS l_comment_prf_1#3183, l_linestatus_prf#3165 AS l_linestatus_prf_1#3184, rid#3166 AS rid_1#3185, l_shipmode_prf#3167 AS l_shipmode_prf_1#3186, l_shipinstruct_prf#3168 AS l_shipinstruct_prf_1#3187, l_quantity_prf#3169 AS l_quantity_prf_1#3188, l_receiptdate_prf#3170 AS l_receiptdate_prf_1#3189, l_linenumber_prf#3171 AS l_linenumber_prf_1#3190, l_tax_prf#3172 AS l_tax_prf_1#3191, l_shipdate_prf#3173 AS l_shipdate_prf_1#3192, l_extendedprice_prf#3174 AS l_extendedprice_prf_1#3193, l_partkey_prf#3175 AS l_partkey_prf_1#3194, l_discount_prf#3176 AS l_discount_prf_1#3195, l_partkey_and_l_suppkey_prf#3177 AS l_partkey_and_l_suppkey_prf_1#3196, l_commitdate_prf#3178 AS l_commitdate_prf_1#3197, l_suppkey_prf#3179 AS l_suppkey_prf_1#3198, l_orderkey_prf#3180 AS l_orderkey_prf_1#3199]
            +- Relation[l_returnflag_prf#3162,l_orderkey_and_l_linenumber_prf#3163,l_comment_prf#3164,l_linestatus_prf#3165,rid#3166,l_shipmode_prf#3167,l_shipinstruct_prf#3168,l_quantity_prf#3169,l_receiptdate_prf#3170,l_linenumber_prf#3171,l_tax_prf#3172,l_shipdate_prf#3173,l_extendedprice_prf#3174,l_partkey_prf#3175,l_discount_prf#3176,l_partkey_and_l_suppkey_prf#3177,l_commitdate_prf#3178,l_suppkey_prf#3179,l_orderkey_prf#3180] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 105365ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/12 07:41:40 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:41:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3262L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 07:41:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3262L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [c_acctbal_prf#3264 AS c_acctbal_prf_0#3273, rid#3265 AS rid_0#3274, c_name_prf#3266 AS c_name_prf_0#3275, c_nationkey_prf#3267 AS c_nationkey_prf_0#3276, c_custkey_prf#3268 AS c_custkey_prf_0#3277, c_comment_prf#3269 AS c_comment_prf_0#3278, c_address_prf#3270 AS c_address_prf_0#3279, c_mktsegment_prf#3271 AS c_mktsegment_prf_0#3280, c_phone_prf#3272 AS c_phone_prf_0#3281]
         :  :  :  :  +- Relation[c_acctbal_prf#3264,rid#3265,c_name_prf#3266,c_nationkey_prf#3267,c_custkey_prf#3268,c_comment_prf#3269,c_address_prf#3270,c_mktsegment_prf#3271,c_phone_prf#3272] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3282, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3283]
         :  :  :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :  :  :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#3284 AS o_shippriority_prf_1#3294, rid#3285 AS rid_1#3295, o_orderdate_prf#3286 AS o_orderdate_prf_1#3296, o_custkey_prf#3287 AS o_custkey_prf_1#3297, o_orderpriority_prf#3288 AS o_orderpriority_prf_1#3298, o_clerk_prf#3289 AS o_clerk_prf_1#3299, o_orderstatus_prf#3290 AS o_orderstatus_prf_1#3300, o_totalprice_prf#3291 AS o_totalprice_prf_1#3301, o_orderkey_prf#3292 AS o_orderkey_prf_1#3302, o_comment_prf#3293 AS o_comment_prf_1#3303]
         :  :     +- Relation[o_shippriority_prf#3284,rid#3285,o_orderdate_prf#3286,o_custkey_prf#3287,o_orderpriority_prf#3288,o_clerk_prf#3289,o_orderstatus_prf#3290,o_totalprice_prf#3291,o_orderkey_prf#3292,o_comment_prf#3293] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3304, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3305]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3306 AS l_returnflag_prf_2#3325, l_orderkey_and_l_linenumber_prf#3307 AS l_orderkey_and_l_linenumber_prf_2#3326, l_comment_prf#3308 AS l_comment_prf_2#3327, l_linestatus_prf#3309 AS l_linestatus_prf_2#3328, rid#3310 AS rid_2#3329, l_shipmode_prf#3311 AS l_shipmode_prf_2#3330, l_shipinstruct_prf#3312 AS l_shipinstruct_prf_2#3331, l_quantity_prf#3313 AS l_quantity_prf_2#3332, l_receiptdate_prf#3314 AS l_receiptdate_prf_2#3333, l_linenumber_prf#3315 AS l_linenumber_prf_2#3334, l_tax_prf#3316 AS l_tax_prf_2#3335, l_shipdate_prf#3317 AS l_shipdate_prf_2#3336, l_extendedprice_prf#3318 AS l_extendedprice_prf_2#3337, l_partkey_prf#3319 AS l_partkey_prf_2#3338, l_discount_prf#3320 AS l_discount_prf_2#3339, l_partkey_and_l_suppkey_prf#3321 AS l_partkey_and_l_suppkey_prf_2#3340, l_commitdate_prf#3322 AS l_commitdate_prf_2#3341, l_suppkey_prf#3323 AS l_suppkey_prf_2#3342, l_orderkey_prf#3324 AS l_orderkey_prf_2#3343]
            +- Relation[l_returnflag_prf#3306,l_orderkey_and_l_linenumber_prf#3307,l_comment_prf#3308,l_linestatus_prf#3309,rid#3310,l_shipmode_prf#3311,l_shipinstruct_prf#3312,l_quantity_prf#3313,l_receiptdate_prf#3314,l_linenumber_prf#3315,l_tax_prf#3316,l_shipdate_prf#3317,l_extendedprice_prf#3318,l_partkey_prf#3319,l_discount_prf#3320,l_partkey_and_l_suppkey_prf#3321,l_commitdate_prf#3322,l_suppkey_prf#3323,l_orderkey_prf#3324] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 168886ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/12 07:44:29 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:44:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3408L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 07:44:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3408L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#3410 AS s_phone_prf_0#3418, rid#3411 AS rid_0#3419, s_address_prf#3412 AS s_address_prf_0#3420, s_nationkey_prf#3413 AS s_nationkey_prf_0#3421, s_suppkey_prf#3414 AS s_suppkey_prf_0#3422, s_name_prf#3415 AS s_name_prf_0#3423, s_acctbal_prf#3416 AS s_acctbal_prf_0#3424, s_comment_prf#3417 AS s_comment_prf_0#3425]
         :  :  +- Relation[s_phone_prf#3410,rid#3411,s_address_prf#3412,s_nationkey_prf#3413,s_suppkey_prf#3414,s_name_prf#3415,s_acctbal_prf#3416,s_comment_prf#3417] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3426, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3427]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3428 AS l_returnflag_prf_1#3447, l_orderkey_and_l_linenumber_prf#3429 AS l_orderkey_and_l_linenumber_prf_1#3448, l_comment_prf#3430 AS l_comment_prf_1#3449, l_linestatus_prf#3431 AS l_linestatus_prf_1#3450, rid#3432 AS rid_1#3451, l_shipmode_prf#3433 AS l_shipmode_prf_1#3452, l_shipinstruct_prf#3434 AS l_shipinstruct_prf_1#3453, l_quantity_prf#3435 AS l_quantity_prf_1#3454, l_receiptdate_prf#3436 AS l_receiptdate_prf_1#3455, l_linenumber_prf#3437 AS l_linenumber_prf_1#3456, l_tax_prf#3438 AS l_tax_prf_1#3457, l_shipdate_prf#3439 AS l_shipdate_prf_1#3458, l_extendedprice_prf#3440 AS l_extendedprice_prf_1#3459, l_partkey_prf#3441 AS l_partkey_prf_1#3460, l_discount_prf#3442 AS l_discount_prf_1#3461, l_partkey_and_l_suppkey_prf#3443 AS l_partkey_and_l_suppkey_prf_1#3462, l_commitdate_prf#3444 AS l_commitdate_prf_1#3463, l_suppkey_prf#3445 AS l_suppkey_prf_1#3464, l_orderkey_prf#3446 AS l_orderkey_prf_1#3465]
            +- Relation[l_returnflag_prf#3428,l_orderkey_and_l_linenumber_prf#3429,l_comment_prf#3430,l_linestatus_prf#3431,rid#3432,l_shipmode_prf#3433,l_shipinstruct_prf#3434,l_quantity_prf#3435,l_receiptdate_prf#3436,l_linenumber_prf#3437,l_tax_prf#3438,l_shipdate_prf#3439,l_extendedprice_prf#3440,l_partkey_prf#3441,l_discount_prf#3442,l_partkey_and_l_suppkey_prf#3443,l_commitdate_prf#3444,l_suppkey_prf#3445,l_orderkey_prf#3446] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 89103ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/12 07:45:58 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:45:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3510L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 07:45:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3510L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [ps_partkey_and_ps_suppkey_prf#3512 AS ps_partkey_and_ps_suppkey_prf_0#3519, rid#3513 AS rid_0#3520, ps_availqty_prf#3514 AS ps_availqty_prf_0#3521, ps_comment_prf#3515 AS ps_comment_prf_0#3522, ps_partkey_prf#3516 AS ps_partkey_prf_0#3523, ps_supplycost_prf#3517 AS ps_supplycost_prf_0#3524, ps_suppkey_prf#3518 AS ps_suppkey_prf_0#3525]
         :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#3512,rid#3513,ps_availqty_prf#3514,ps_comment_prf#3515,ps_partkey_prf#3516,ps_supplycost_prf#3517,ps_suppkey_prf#3518] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3526, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3527]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#3528 AS p_comment_prf_1#3538, p_name_prf#3529 AS p_name_prf_1#3539, rid#3530 AS rid_1#3540, p_type_prf#3531 AS p_type_prf_1#3541, p_retailprice_prf#3532 AS p_retailprice_prf_1#3542, p_mfgr_prf#3533 AS p_mfgr_prf_1#3543, p_container_prf#3534 AS p_container_prf_1#3544, p_brand_prf#3535 AS p_brand_prf_1#3545, p_size_prf#3536 AS p_size_prf_1#3546, p_partkey_prf#3537 AS p_partkey_prf_1#3547]
            :  +- Relation[p_comment_prf#3528,p_name_prf#3529,rid#3530,p_type_prf#3531,p_retailprice_prf#3532,p_mfgr_prf#3533,p_container_prf#3534,p_brand_prf#3535,p_size_prf#3536,p_partkey_prf#3537] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3548]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1484,value#1485] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=15628
Elapsed time: 7776ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/12 07:46:05 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:46:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3602L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 07:46:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3602L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [l_returnflag_prf#3604 AS l_returnflag_prf_0#3623, l_orderkey_and_l_linenumber_prf#3605 AS l_orderkey_and_l_linenumber_prf_0#3624, l_comment_prf#3606 AS l_comment_prf_0#3625, l_linestatus_prf#3607 AS l_linestatus_prf_0#3626, rid#3608 AS rid_0#3627, l_shipmode_prf#3609 AS l_shipmode_prf_0#3628, l_shipinstruct_prf#3610 AS l_shipinstruct_prf_0#3629, l_quantity_prf#3611 AS l_quantity_prf_0#3630, l_receiptdate_prf#3612 AS l_receiptdate_prf_0#3631, l_linenumber_prf#3613 AS l_linenumber_prf_0#3632, l_tax_prf#3614 AS l_tax_prf_0#3633, l_shipdate_prf#3615 AS l_shipdate_prf_0#3634, l_extendedprice_prf#3616 AS l_extendedprice_prf_0#3635, l_partkey_prf#3617 AS l_partkey_prf_0#3636, l_discount_prf#3618 AS l_discount_prf_0#3637, l_partkey_and_l_suppkey_prf#3619 AS l_partkey_and_l_suppkey_prf_0#3638, l_commitdate_prf#3620 AS l_commitdate_prf_0#3639, l_suppkey_prf#3621 AS l_suppkey_prf_0#3640, l_orderkey_prf#3622 AS l_orderkey_prf_0#3641]
         :  :  :  :  +- Relation[l_returnflag_prf#3604,l_orderkey_and_l_linenumber_prf#3605,l_comment_prf#3606,l_linestatus_prf#3607,rid#3608,l_shipmode_prf#3609,l_shipinstruct_prf#3610,l_quantity_prf#3611,l_receiptdate_prf#3612,l_linenumber_prf#3613,l_tax_prf#3614,l_shipdate_prf#3615,l_extendedprice_prf#3616,l_partkey_prf#3617,l_discount_prf#3618,l_partkey_and_l_suppkey_prf#3619,l_commitdate_prf#3620,l_suppkey_prf#3621,l_orderkey_prf#3622] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3642, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3643]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :  :  :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#3644 AS o_shippriority_prf_1#3654, rid#3645 AS rid_1#3655, o_orderdate_prf#3646 AS o_orderdate_prf_1#3656, o_custkey_prf#3647 AS o_custkey_prf_1#3657, o_orderpriority_prf#3648 AS o_orderpriority_prf_1#3658, o_clerk_prf#3649 AS o_clerk_prf_1#3659, o_orderstatus_prf#3650 AS o_orderstatus_prf_1#3660, o_totalprice_prf#3651 AS o_totalprice_prf_1#3661, o_orderkey_prf#3652 AS o_orderkey_prf_1#3662, o_comment_prf#3653 AS o_comment_prf_1#3663]
         :  :     +- Relation[o_shippriority_prf#3644,rid#3645,o_orderdate_prf#3646,o_custkey_prf#3647,o_orderpriority_prf#3648,o_clerk_prf#3649,o_orderstatus_prf#3650,o_totalprice_prf#3651,o_orderkey_prf#3652,o_comment_prf#3653] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3664, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3665]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3666 AS c_acctbal_prf_2#3675, rid#3667 AS rid_2#3676, c_name_prf#3668 AS c_name_prf_2#3677, c_nationkey_prf#3669 AS c_nationkey_prf_2#3678, c_custkey_prf#3670 AS c_custkey_prf_2#3679, c_comment_prf#3671 AS c_comment_prf_2#3680, c_address_prf#3672 AS c_address_prf_2#3681, c_mktsegment_prf#3673 AS c_mktsegment_prf_2#3682, c_phone_prf#3674 AS c_phone_prf_2#3683]
            +- Relation[c_acctbal_prf#3666,rid#3667,c_name_prf#3668,c_nationkey_prf#3669,c_custkey_prf#3670,c_comment_prf#3671,c_address_prf#3672,c_mktsegment_prf#3673,c_phone_prf#3674] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 182924ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/12 07:49:08 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:49:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3746L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 07:49:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3746L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [ps_partkey_and_ps_suppkey_prf#3748 AS ps_partkey_and_ps_suppkey_prf_0#3755, rid#3749 AS rid_0#3756, ps_availqty_prf#3750 AS ps_availqty_prf_0#3757, ps_comment_prf#3751 AS ps_comment_prf_0#3758, ps_partkey_prf#3752 AS ps_partkey_prf_0#3759, ps_supplycost_prf#3753 AS ps_supplycost_prf_0#3760, ps_suppkey_prf#3754 AS ps_suppkey_prf_0#3761]
         :  :  :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#3748,rid#3749,ps_availqty_prf#3750,ps_comment_prf#3751,ps_partkey_prf#3752,ps_supplycost_prf#3753,ps_suppkey_prf#3754] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3762, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3763]
         :  :  :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :  :  :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#3764 AS p_comment_prf_1#3774, p_name_prf#3765 AS p_name_prf_1#3775, rid#3766 AS rid_1#3776, p_type_prf#3767 AS p_type_prf_1#3777, p_retailprice_prf#3768 AS p_retailprice_prf_1#3778, p_mfgr_prf#3769 AS p_mfgr_prf_1#3779, p_container_prf#3770 AS p_container_prf_1#3780, p_brand_prf#3771 AS p_brand_prf_1#3781, p_size_prf#3772 AS p_size_prf_1#3782, p_partkey_prf#3773 AS p_partkey_prf_1#3783]
         :  :     +- Relation[p_comment_prf#3764,p_name_prf#3765,rid#3766,p_type_prf#3767,p_retailprice_prf#3768,p_mfgr_prf#3769,p_container_prf#3770,p_brand_prf#3771,p_size_prf#3772,p_partkey_prf#3773] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3784, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3785]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#3786 AS s_phone_prf_2#3794, rid#3787 AS rid_2#3795, s_address_prf#3788 AS s_address_prf_2#3796, s_nationkey_prf#3789 AS s_nationkey_prf_2#3797, s_suppkey_prf#3790 AS s_suppkey_prf_2#3798, s_name_prf#3791 AS s_name_prf_2#3799, s_acctbal_prf#3792 AS s_acctbal_prf_2#3800, s_comment_prf#3793 AS s_comment_prf_2#3801]
            +- Relation[s_phone_prf#3786,rid#3787,s_address_prf#3788,s_nationkey_prf#3789,s_suppkey_prf#3790,s_name_prf#3791,s_acctbal_prf#3792,s_comment_prf#3793] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26158ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/12 07:49:35 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:49:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3846L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 07:49:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3846L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#3848 AS l_returnflag_prf_0#3867, l_orderkey_and_l_linenumber_prf#3849 AS l_orderkey_and_l_linenumber_prf_0#3868, l_comment_prf#3850 AS l_comment_prf_0#3869, l_linestatus_prf#3851 AS l_linestatus_prf_0#3870, rid#3852 AS rid_0#3871, l_shipmode_prf#3853 AS l_shipmode_prf_0#3872, l_shipinstruct_prf#3854 AS l_shipinstruct_prf_0#3873, l_quantity_prf#3855 AS l_quantity_prf_0#3874, l_receiptdate_prf#3856 AS l_receiptdate_prf_0#3875, l_linenumber_prf#3857 AS l_linenumber_prf_0#3876, l_tax_prf#3858 AS l_tax_prf_0#3877, l_shipdate_prf#3859 AS l_shipdate_prf_0#3878, l_extendedprice_prf#3860 AS l_extendedprice_prf_0#3879, l_partkey_prf#3861 AS l_partkey_prf_0#3880, l_discount_prf#3862 AS l_discount_prf_0#3881, l_partkey_and_l_suppkey_prf#3863 AS l_partkey_and_l_suppkey_prf_0#3882, l_commitdate_prf#3864 AS l_commitdate_prf_0#3883, l_suppkey_prf#3865 AS l_suppkey_prf_0#3884, l_orderkey_prf#3866 AS l_orderkey_prf_0#3885]
         :  +- Relation[l_returnflag_prf#3848,l_orderkey_and_l_linenumber_prf#3849,l_comment_prf#3850,l_linestatus_prf#3851,rid#3852,l_shipmode_prf#3853,l_shipinstruct_prf#3854,l_quantity_prf#3855,l_receiptdate_prf#3856,l_linenumber_prf#3857,l_tax_prf#3858,l_shipdate_prf#3859,l_extendedprice_prf#3860,l_partkey_prf#3861,l_discount_prf#3862,l_partkey_and_l_suppkey_prf#3863,l_commitdate_prf#3864,l_suppkey_prf#3865,l_orderkey_prf#3866] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3886]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1484,value#1485] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=857401
Elapsed time: 13653ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/12 07:49:48 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:49:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3926L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 07:49:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3926L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#3928 AS c_acctbal_prf_0#3937, rid#3929 AS rid_0#3938, c_name_prf#3930 AS c_name_prf_0#3939, c_nationkey_prf#3931 AS c_nationkey_prf_0#3940, c_custkey_prf#3932 AS c_custkey_prf_0#3941, c_comment_prf#3933 AS c_comment_prf_0#3942, c_address_prf#3934 AS c_address_prf_0#3943, c_mktsegment_prf#3935 AS c_mktsegment_prf_0#3944, c_phone_prf#3936 AS c_phone_prf_0#3945]
         :  :  +- Relation[c_acctbal_prf#3928,rid#3929,c_name_prf#3930,c_nationkey_prf#3931,c_custkey_prf#3932,c_comment_prf#3933,c_address_prf#3934,c_mktsegment_prf#3935,c_phone_prf#3936] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3946, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3947]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3948 AS o_shippriority_prf_1#3958, rid#3949 AS rid_1#3959, o_orderdate_prf#3950 AS o_orderdate_prf_1#3960, o_custkey_prf#3951 AS o_custkey_prf_1#3961, o_orderpriority_prf#3952 AS o_orderpriority_prf_1#3962, o_clerk_prf#3953 AS o_clerk_prf_1#3963, o_orderstatus_prf#3954 AS o_orderstatus_prf_1#3964, o_totalprice_prf#3955 AS o_totalprice_prf_1#3965, o_orderkey_prf#3956 AS o_orderkey_prf_1#3966, o_comment_prf#3957 AS o_comment_prf_1#3967]
            +- Relation[o_shippriority_prf#3948,rid#3949,o_orderdate_prf#3950,o_custkey_prf#3951,o_orderpriority_prf#3952,o_clerk_prf#3953,o_orderstatus_prf#3954,o_totalprice_prf#3955,o_orderkey_prf#3956,o_comment_prf#3957] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=1500000
Elapsed time: 23647ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/12 07:50:12 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:50:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3997L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 07:50:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3997L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [r_regionkey_prf#3999 AS r_regionkey_prf_0#4003, r_name_prf#4000 AS r_name_prf_0#4004, r_comment_prf#4001 AS r_comment_prf_0#4005, rid#4002 AS rid_0#4006]
         :  :  +- Relation[r_regionkey_prf#3999,r_name_prf#4000,r_comment_prf#4001,rid#4002] JDBCRelation(region_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4007, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4008]
         :     +- SpxRidUncorrelatedJoin nation~n_regionkey~region~r_regionkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [rid#4009 AS rid_1#4014, n_regionkey_prf#4010 AS n_regionkey_prf_1#4015, n_nationkey_prf#4011 AS n_nationkey_prf_1#4016, n_name_prf#4012 AS n_name_prf_1#4017, n_comment_prf#4013 AS n_comment_prf_1#4018]
            +- Relation[rid#4009,n_regionkey_prf#4010,n_nationkey_prf#4011,n_name_prf#4012,n_comment_prf#4013] JDBCRelation(nation_prf) [numPartitions=1]

DexSpx$ result size=25
Elapsed time: 65ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/12 07:50:12 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:50:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4052L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 07:50:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4052L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4054 AS s_phone_prf_0#4062, rid#4055 AS rid_0#4063, s_address_prf#4056 AS s_address_prf_0#4064, s_nationkey_prf#4057 AS s_nationkey_prf_0#4065, s_suppkey_prf#4058 AS s_suppkey_prf_0#4066, s_name_prf#4059 AS s_name_prf_0#4067, s_acctbal_prf#4060 AS s_acctbal_prf_0#4068, s_comment_prf#4061 AS s_comment_prf_0#4069]
         :  :  +- Relation[s_phone_prf#4054,rid#4055,s_address_prf#4056,s_nationkey_prf#4057,s_suppkey_prf#4058,s_name_prf#4059,s_acctbal_prf#4060,s_comment_prf#4061] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4070, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4071]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [ps_partkey_and_ps_suppkey_prf#4072 AS ps_partkey_and_ps_suppkey_prf_1#4079, rid#4073 AS rid_1#4080, ps_availqty_prf#4074 AS ps_availqty_prf_1#4081, ps_comment_prf#4075 AS ps_comment_prf_1#4082, ps_partkey_prf#4076 AS ps_partkey_prf_1#4083, ps_supplycost_prf#4077 AS ps_supplycost_prf_1#4084, ps_suppkey_prf#4078 AS ps_suppkey_prf_1#4085]
            :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#4072,rid#4073,ps_availqty_prf#4074,ps_comment_prf#4075,ps_partkey_prf#4076,ps_supplycost_prf#4077,ps_suppkey_prf#4078] JDBCRelation(partsupp_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4086, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4087]
            :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
            :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [p_comment_prf#4088 AS p_comment_prf_2#4098, p_name_prf#4089 AS p_name_prf_2#4099, rid#4090 AS rid_2#4100, p_type_prf#4091 AS p_type_prf_2#4101, p_retailprice_prf#4092 AS p_retailprice_prf_2#4102, p_mfgr_prf#4093 AS p_mfgr_prf_2#4103, p_container_prf#4094 AS p_container_prf_2#4104, p_brand_prf#4095 AS p_brand_prf_2#4105, p_size_prf#4096 AS p_size_prf_2#4106, p_partkey_prf#4097 AS p_partkey_prf_2#4107]
               +- Relation[p_comment_prf#4088,p_name_prf#4089,rid#4090,p_type_prf#4091,p_retailprice_prf#4092,p_mfgr_prf#4093,p_container_prf#4094,p_brand_prf#4095,p_size_prf#4096,p_partkey_prf#4097] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26117ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/12 07:50:38 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:50:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4169L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 07:50:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4169L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#4171 AS c_acctbal_prf_0#4180, rid#4172 AS rid_0#4181, c_name_prf#4173 AS c_name_prf_0#4182, c_nationkey_prf#4174 AS c_nationkey_prf_0#4183, c_custkey_prf#4175 AS c_custkey_prf_0#4184, c_comment_prf#4176 AS c_comment_prf_0#4185, c_address_prf#4177 AS c_address_prf_0#4186, c_mktsegment_prf#4178 AS c_mktsegment_prf_0#4187, c_phone_prf#4179 AS c_phone_prf_0#4188]
         :  :  +- Relation[c_acctbal_prf#4171,rid#4172,c_name_prf#4173,c_nationkey_prf#4174,c_custkey_prf#4175,c_comment_prf#4176,c_address_prf#4177,c_mktsegment_prf#4178,c_phone_prf#4179] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4189, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4190]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [o_shippriority_prf#4191 AS o_shippriority_prf_1#4201, rid#4192 AS rid_1#4202, o_orderdate_prf#4193 AS o_orderdate_prf_1#4203, o_custkey_prf#4194 AS o_custkey_prf_1#4204, o_orderpriority_prf#4195 AS o_orderpriority_prf_1#4205, o_clerk_prf#4196 AS o_clerk_prf_1#4206, o_orderstatus_prf#4197 AS o_orderstatus_prf_1#4207, o_totalprice_prf#4198 AS o_totalprice_prf_1#4208, o_orderkey_prf#4199 AS o_orderkey_prf_1#4209, o_comment_prf#4200 AS o_comment_prf_1#4210]
            :  :  +- Relation[o_shippriority_prf#4191,rid#4192,o_orderdate_prf#4193,o_custkey_prf#4194,o_orderpriority_prf#4195,o_clerk_prf#4196,o_orderstatus_prf#4197,o_totalprice_prf#4198,o_orderkey_prf#4199,o_comment_prf#4200] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4211, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4212]
            :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
            :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4213 AS l_returnflag_prf_2#4232, l_orderkey_and_l_linenumber_prf#4214 AS l_orderkey_and_l_linenumber_prf_2#4233, l_comment_prf#4215 AS l_comment_prf_2#4234, l_linestatus_prf#4216 AS l_linestatus_prf_2#4235, rid#4217 AS rid_2#4236, l_shipmode_prf#4218 AS l_shipmode_prf_2#4237, l_shipinstruct_prf#4219 AS l_shipinstruct_prf_2#4238, l_quantity_prf#4220 AS l_quantity_prf_2#4239, l_receiptdate_prf#4221 AS l_receiptdate_prf_2#4240, l_linenumber_prf#4222 AS l_linenumber_prf_2#4241, l_tax_prf#4223 AS l_tax_prf_2#4242, l_shipdate_prf#4224 AS l_shipdate_prf_2#4243, l_extendedprice_prf#4225 AS l_extendedprice_prf_2#4244, l_partkey_prf#4226 AS l_partkey_prf_2#4245, l_discount_prf#4227 AS l_discount_prf_2#4246, l_partkey_and_l_suppkey_prf#4228 AS l_partkey_and_l_suppkey_prf_2#4247, l_commitdate_prf#4229 AS l_commitdate_prf_2#4248, l_suppkey_prf#4230 AS l_suppkey_prf_2#4249, l_orderkey_prf#4231 AS l_orderkey_prf_2#4250]
               +- Relation[l_returnflag_prf#4213,l_orderkey_and_l_linenumber_prf#4214,l_comment_prf#4215,l_linestatus_prf#4216,rid#4217,l_shipmode_prf#4218,l_shipinstruct_prf#4219,l_quantity_prf#4220,l_receiptdate_prf#4221,l_linenumber_prf#4222,l_tax_prf#4223,l_shipdate_prf#4224,l_extendedprice_prf#4225,l_partkey_prf#4226,l_discount_prf#4227,l_partkey_and_l_suppkey_prf#4228,l_commitdate_prf#4229,l_suppkey_prf#4230,l_orderkey_prf#4231] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 169839ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/12 07:53:28 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:53:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4296L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 07:53:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4296L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#4298 AS rid_0#4303, n_regionkey_prf#4299 AS n_regionkey_prf_0#4304, n_nationkey_prf#4300 AS n_nationkey_prf_0#4305, n_name_prf#4301 AS n_name_prf_0#4306, n_comment_prf#4302 AS n_comment_prf_0#4307]
         :  +- Relation[rid#4298,n_regionkey_prf#4299,n_nationkey_prf#4300,n_name_prf#4301,n_comment_prf#4302] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4308]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1484,value#1485] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1
Elapsed time: 53ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/12 07:53:28 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:53:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4350L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 07:53:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4350L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#4352 AS l_returnflag_prf_0#4371, l_orderkey_and_l_linenumber_prf#4353 AS l_orderkey_and_l_linenumber_prf_0#4372, l_comment_prf#4354 AS l_comment_prf_0#4373, l_linestatus_prf#4355 AS l_linestatus_prf_0#4374, rid#4356 AS rid_0#4375, l_shipmode_prf#4357 AS l_shipmode_prf_0#4376, l_shipinstruct_prf#4358 AS l_shipinstruct_prf_0#4377, l_quantity_prf#4359 AS l_quantity_prf_0#4378, l_receiptdate_prf#4360 AS l_receiptdate_prf_0#4379, l_linenumber_prf#4361 AS l_linenumber_prf_0#4380, l_tax_prf#4362 AS l_tax_prf_0#4381, l_shipdate_prf#4363 AS l_shipdate_prf_0#4382, l_extendedprice_prf#4364 AS l_extendedprice_prf_0#4383, l_partkey_prf#4365 AS l_partkey_prf_0#4384, l_discount_prf#4366 AS l_discount_prf_0#4385, l_partkey_and_l_suppkey_prf#4367 AS l_partkey_and_l_suppkey_prf_0#4386, l_commitdate_prf#4368 AS l_commitdate_prf_0#4387, l_suppkey_prf#4369 AS l_suppkey_prf_0#4388, l_orderkey_prf#4370 AS l_orderkey_prf_0#4389]
         :  :  +- Relation[l_returnflag_prf#4352,l_orderkey_and_l_linenumber_prf#4353,l_comment_prf#4354,l_linestatus_prf#4355,rid#4356,l_shipmode_prf#4357,l_shipinstruct_prf#4358,l_quantity_prf#4359,l_receiptdate_prf#4360,l_linenumber_prf#4361,l_tax_prf#4362,l_shipdate_prf#4363,l_extendedprice_prf#4364,l_partkey_prf#4365,l_discount_prf#4366,l_partkey_and_l_suppkey_prf#4367,l_commitdate_prf#4368,l_suppkey_prf#4369,l_orderkey_prf#4370] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4390, dexdecrypt('value_dec_key, 'value_right) AS rid_2#4391]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [c_acctbal_prf#4392 AS c_acctbal_prf_1#4401, rid#4393 AS rid_1#4402, c_name_prf#4394 AS c_name_prf_1#4403, c_nationkey_prf#4395 AS c_nationkey_prf_1#4404, c_custkey_prf#4396 AS c_custkey_prf_1#4405, c_comment_prf#4397 AS c_comment_prf_1#4406, c_address_prf#4398 AS c_address_prf_1#4407, c_mktsegment_prf#4399 AS c_mktsegment_prf_1#4408, c_phone_prf#4400 AS c_phone_prf_1#4409]
            :  :  +- Relation[c_acctbal_prf#4392,rid#4393,c_name_prf#4394,c_nationkey_prf#4395,c_custkey_prf#4396,c_comment_prf#4397,c_address_prf#4398,c_mktsegment_prf#4399,c_phone_prf#4400] JDBCRelation(customer_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4410, dexdecrypt('value_dec_key, 'value_right) AS rid_2#4411]
            :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
            :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4412 AS o_shippriority_prf_2#4422, rid#4413 AS rid_2#4423, o_orderdate_prf#4414 AS o_orderdate_prf_2#4424, o_custkey_prf#4415 AS o_custkey_prf_2#4425, o_orderpriority_prf#4416 AS o_orderpriority_prf_2#4426, o_clerk_prf#4417 AS o_clerk_prf_2#4427, o_orderstatus_prf#4418 AS o_orderstatus_prf_2#4428, o_totalprice_prf#4419 AS o_totalprice_prf_2#4429, o_orderkey_prf#4420 AS o_orderkey_prf_2#4430, o_comment_prf#4421 AS o_comment_prf_2#4431]
               +- Relation[o_shippriority_prf#4412,rid#4413,o_orderdate_prf#4414,o_custkey_prf#4415,o_orderpriority_prf#4416,o_clerk_prf#4417,o_orderstatus_prf#4418,o_totalprice_prf#4419,o_orderkey_prf#4420,o_comment_prf#4421] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 181735ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/12 07:56:30 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:56:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4485L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 07:56:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4485L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4487 AS s_phone_prf_0#4495, rid#4488 AS rid_0#4496, s_address_prf#4489 AS s_address_prf_0#4497, s_nationkey_prf#4490 AS s_nationkey_prf_0#4498, s_suppkey_prf#4491 AS s_suppkey_prf_0#4499, s_name_prf#4492 AS s_name_prf_0#4500, s_acctbal_prf#4493 AS s_acctbal_prf_0#4501, s_comment_prf#4494 AS s_comment_prf_0#4502]
         :  :  +- Relation[s_phone_prf#4487,rid#4488,s_address_prf#4489,s_nationkey_prf#4490,s_suppkey_prf#4491,s_name_prf#4492,s_acctbal_prf#4493,s_comment_prf#4494] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4503, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4504]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4505 AS ps_partkey_and_ps_suppkey_prf_1#4512, rid#4506 AS rid_1#4513, ps_availqty_prf#4507 AS ps_availqty_prf_1#4514, ps_comment_prf#4508 AS ps_comment_prf_1#4515, ps_partkey_prf#4509 AS ps_partkey_prf_1#4516, ps_supplycost_prf#4510 AS ps_supplycost_prf_1#4517, ps_suppkey_prf#4511 AS ps_suppkey_prf_1#4518]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4505,rid#4506,ps_availqty_prf#4507,ps_comment_prf#4508,ps_partkey_prf#4509,ps_supplycost_prf#4510,ps_suppkey_prf#4511] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 11682ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/12 07:56:41 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:56:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4570L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 07:56:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4570L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#4572 AS l_returnflag_prf_0#4591, l_orderkey_and_l_linenumber_prf#4573 AS l_orderkey_and_l_linenumber_prf_0#4592, l_comment_prf#4574 AS l_comment_prf_0#4593, l_linestatus_prf#4575 AS l_linestatus_prf_0#4594, rid#4576 AS rid_0#4595, l_shipmode_prf#4577 AS l_shipmode_prf_0#4596, l_shipinstruct_prf#4578 AS l_shipinstruct_prf_0#4597, l_quantity_prf#4579 AS l_quantity_prf_0#4598, l_receiptdate_prf#4580 AS l_receiptdate_prf_0#4599, l_linenumber_prf#4581 AS l_linenumber_prf_0#4600, l_tax_prf#4582 AS l_tax_prf_0#4601, l_shipdate_prf#4583 AS l_shipdate_prf_0#4602, l_extendedprice_prf#4584 AS l_extendedprice_prf_0#4603, l_partkey_prf#4585 AS l_partkey_prf_0#4604, l_discount_prf#4586 AS l_discount_prf_0#4605, l_partkey_and_l_suppkey_prf#4587 AS l_partkey_and_l_suppkey_prf_0#4606, l_commitdate_prf#4588 AS l_commitdate_prf_0#4607, l_suppkey_prf#4589 AS l_suppkey_prf_0#4608, l_orderkey_prf#4590 AS l_orderkey_prf_0#4609]
         :  :  +- Relation[l_returnflag_prf#4572,l_orderkey_and_l_linenumber_prf#4573,l_comment_prf#4574,l_linestatus_prf#4575,rid#4576,l_shipmode_prf#4577,l_shipinstruct_prf#4578,l_quantity_prf#4579,l_receiptdate_prf#4580,l_linenumber_prf#4581,l_tax_prf#4582,l_shipdate_prf#4583,l_extendedprice_prf#4584,l_partkey_prf#4585,l_discount_prf#4586,l_partkey_and_l_suppkey_prf#4587,l_commitdate_prf#4588,l_suppkey_prf#4589,l_orderkey_prf#4590] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4610, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4611]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [o_shippriority_prf#4612 AS o_shippriority_prf_1#4622, rid#4613 AS rid_1#4623, o_orderdate_prf#4614 AS o_orderdate_prf_1#4624, o_custkey_prf#4615 AS o_custkey_prf_1#4625, o_orderpriority_prf#4616 AS o_orderpriority_prf_1#4626, o_clerk_prf#4617 AS o_clerk_prf_1#4627, o_orderstatus_prf#4618 AS o_orderstatus_prf_1#4628, o_totalprice_prf#4619 AS o_totalprice_prf_1#4629, o_orderkey_prf#4620 AS o_orderkey_prf_1#4630, o_comment_prf#4621 AS o_comment_prf_1#4631]
            :  :  +- Relation[o_shippriority_prf#4612,rid#4613,o_orderdate_prf#4614,o_custkey_prf#4615,o_orderpriority_prf#4616,o_clerk_prf#4617,o_orderstatus_prf#4618,o_totalprice_prf#4619,o_orderkey_prf#4620,o_comment_prf#4621] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4632, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4633]
            :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
            :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4634 AS c_acctbal_prf_2#4643, rid#4635 AS rid_2#4644, c_name_prf#4636 AS c_name_prf_2#4645, c_nationkey_prf#4637 AS c_nationkey_prf_2#4646, c_custkey_prf#4638 AS c_custkey_prf_2#4647, c_comment_prf#4639 AS c_comment_prf_2#4648, c_address_prf#4640 AS c_address_prf_2#4649, c_mktsegment_prf#4641 AS c_mktsegment_prf_2#4650, c_phone_prf#4642 AS c_phone_prf_2#4651]
               +- Relation[c_acctbal_prf#4634,rid#4635,c_name_prf#4636,c_nationkey_prf#4637,c_custkey_prf#4638,c_comment_prf#4639,c_address_prf#4640,c_mktsegment_prf#4641,c_phone_prf#4642] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 183302ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/12 07:59:45 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:59:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4704L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 07:59:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4704L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [rid#4706 AS rid_0#4711, n_regionkey_prf#4707 AS n_regionkey_prf_0#4712, n_nationkey_prf#4708 AS n_nationkey_prf_0#4713, n_name_prf#4709 AS n_name_prf_0#4714, n_comment_prf#4710 AS n_comment_prf_0#4715]
         :  :  +- Relation[rid#4706,n_regionkey_prf#4707,n_nationkey_prf#4708,n_name_prf#4709,n_comment_prf#4710] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4716, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4717]
         :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#4718 AS s_phone_prf_1#4726, rid#4719 AS rid_1#4727, s_address_prf#4720 AS s_address_prf_1#4728, s_nationkey_prf#4721 AS s_nationkey_prf_1#4729, s_suppkey_prf#4722 AS s_suppkey_prf_1#4730, s_name_prf#4723 AS s_name_prf_1#4731, s_acctbal_prf#4724 AS s_acctbal_prf_1#4732, s_comment_prf#4725 AS s_comment_prf_1#4733]
            +- Relation[s_phone_prf#4718,rid#4719,s_address_prf#4720,s_nationkey_prf#4721,s_suppkey_prf#4722,s_name_prf#4723,s_acctbal_prf#4724,s_comment_prf#4725] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=10000
Elapsed time: 225ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/12 07:59:45 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:59:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4769L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 07:59:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4769L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [s_phone_prf#4771 AS s_phone_prf_0#4779, rid#4772 AS rid_0#4780, s_address_prf#4773 AS s_address_prf_0#4781, s_nationkey_prf#4774 AS s_nationkey_prf_0#4782, s_suppkey_prf#4775 AS s_suppkey_prf_0#4783, s_name_prf#4776 AS s_name_prf_0#4784, s_acctbal_prf#4777 AS s_acctbal_prf_0#4785, s_comment_prf#4778 AS s_comment_prf_0#4786]
         :  :  :  :  +- Relation[s_phone_prf#4771,rid#4772,s_address_prf#4773,s_nationkey_prf#4774,s_suppkey_prf#4775,s_name_prf#4776,s_acctbal_prf#4777,s_comment_prf#4778] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4787, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4788]
         :  :  :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :  :  :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [rid#4789 AS rid_1#4794, n_regionkey_prf#4790 AS n_regionkey_prf_1#4795, n_nationkey_prf#4791 AS n_nationkey_prf_1#4796, n_name_prf#4792 AS n_name_prf_1#4797, n_comment_prf#4793 AS n_comment_prf_1#4798]
         :  :     +- Relation[rid#4789,n_regionkey_prf#4790,n_nationkey_prf#4791,n_name_prf#4792,n_comment_prf#4793] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4799, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4800]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4801 AS c_acctbal_prf_2#4810, rid#4802 AS rid_2#4811, c_name_prf#4803 AS c_name_prf_2#4812, c_nationkey_prf#4804 AS c_nationkey_prf_2#4813, c_custkey_prf#4805 AS c_custkey_prf_2#4814, c_comment_prf#4806 AS c_comment_prf_2#4815, c_address_prf#4807 AS c_address_prf_2#4816, c_mktsegment_prf#4808 AS c_mktsegment_prf_2#4817, c_phone_prf#4809 AS c_phone_prf_2#4818]
            +- Relation[c_acctbal_prf#4801,rid#4802,c_name_prf#4803,c_nationkey_prf#4804,c_custkey_prf#4805,c_comment_prf#4806,c_address_prf#4807,c_mktsegment_prf#4808,c_phone_prf#4809] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 881372ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/12 08:14:26 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 08:14:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4853L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 08:14:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4853L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#4855 AS p_comment_prf_0#4865, p_name_prf#4856 AS p_name_prf_0#4866, rid#4857 AS rid_0#4867, p_type_prf#4858 AS p_type_prf_0#4868, p_retailprice_prf#4859 AS p_retailprice_prf_0#4869, p_mfgr_prf#4860 AS p_mfgr_prf_0#4870, p_container_prf#4861 AS p_container_prf_0#4871, p_brand_prf#4862 AS p_brand_prf_0#4872, p_size_prf#4863 AS p_size_prf_0#4873, p_partkey_prf#4864 AS p_partkey_prf_0#4874]
         :  +- Relation[p_comment_prf#4855,p_name_prf#4856,rid#4857,p_type_prf#4858,p_retailprice_prf#4859,p_mfgr_prf#4860,p_container_prf#4861,p_brand_prf#4862,p_size_prf#4863,p_partkey_prf#4864] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4875]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1484,value#1485] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1451
Elapsed time: 83ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/12 08:14:26 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 08:14:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4921L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 08:14:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4921L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [l_returnflag_prf#4923 AS l_returnflag_prf_0#4942, l_orderkey_and_l_linenumber_prf#4924 AS l_orderkey_and_l_linenumber_prf_0#4943, l_comment_prf#4925 AS l_comment_prf_0#4944, l_linestatus_prf#4926 AS l_linestatus_prf_0#4945, rid#4927 AS rid_0#4946, l_shipmode_prf#4928 AS l_shipmode_prf_0#4947, l_shipinstruct_prf#4929 AS l_shipinstruct_prf_0#4948, l_quantity_prf#4930 AS l_quantity_prf_0#4949, l_receiptdate_prf#4931 AS l_receiptdate_prf_0#4950, l_linenumber_prf#4932 AS l_linenumber_prf_0#4951, l_tax_prf#4933 AS l_tax_prf_0#4952, l_shipdate_prf#4934 AS l_shipdate_prf_0#4953, l_extendedprice_prf#4935 AS l_extendedprice_prf_0#4954, l_partkey_prf#4936 AS l_partkey_prf_0#4955, l_discount_prf#4937 AS l_discount_prf_0#4956, l_partkey_and_l_suppkey_prf#4938 AS l_partkey_and_l_suppkey_prf_0#4957, l_commitdate_prf#4939 AS l_commitdate_prf_0#4958, l_suppkey_prf#4940 AS l_suppkey_prf_0#4959, l_orderkey_prf#4941 AS l_orderkey_prf_0#4960]
         :  :  :  :  +- Relation[l_returnflag_prf#4923,l_orderkey_and_l_linenumber_prf#4924,l_comment_prf#4925,l_linestatus_prf#4926,rid#4927,l_shipmode_prf#4928,l_shipinstruct_prf#4929,l_quantity_prf#4930,l_receiptdate_prf#4931,l_linenumber_prf#4932,l_tax_prf#4933,l_shipdate_prf#4934,l_extendedprice_prf#4935,l_partkey_prf#4936,l_discount_prf#4937,l_partkey_and_l_suppkey_prf#4938,l_commitdate_prf#4939,l_suppkey_prf#4940,l_orderkey_prf#4941] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4961, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4962]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :  :  :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#4963 AS p_comment_prf_1#4973, p_name_prf#4964 AS p_name_prf_1#4974, rid#4965 AS rid_1#4975, p_type_prf#4966 AS p_type_prf_1#4976, p_retailprice_prf#4967 AS p_retailprice_prf_1#4977, p_mfgr_prf#4968 AS p_mfgr_prf_1#4978, p_container_prf#4969 AS p_container_prf_1#4979, p_brand_prf#4970 AS p_brand_prf_1#4980, p_size_prf#4971 AS p_size_prf_1#4981, p_partkey_prf#4972 AS p_partkey_prf_1#4982]
         :  :     +- Relation[p_comment_prf#4963,p_name_prf#4964,rid#4965,p_type_prf#4966,p_retailprice_prf#4967,p_mfgr_prf#4968,p_container_prf#4969,p_brand_prf#4970,p_size_prf#4971,p_partkey_prf#4972] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4983, dexdecrypt('value_dec_key, 'value_right) AS rid_2#4984]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#4985 AS s_phone_prf_2#4993, rid#4986 AS rid_2#4994, s_address_prf#4987 AS s_address_prf_2#4995, s_nationkey_prf#4988 AS s_nationkey_prf_2#4996, s_suppkey_prf#4989 AS s_suppkey_prf_2#4997, s_name_prf#4990 AS s_name_prf_2#4998, s_acctbal_prf#4991 AS s_acctbal_prf_2#4999, s_comment_prf#4992 AS s_comment_prf_2#5000]
            +- Relation[s_phone_prf#4985,rid#4986,s_address_prf#4987,s_nationkey_prf#4988,s_suppkey_prf#4989,s_name_prf#4990,s_acctbal_prf#4991,s_comment_prf#4992] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201238ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/12 08:17:48 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 08:17:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5073L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 08:17:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5073L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#5075 AS s_phone_prf_0#5083, rid#5076 AS rid_0#5084, s_address_prf#5077 AS s_address_prf_0#5085, s_nationkey_prf#5078 AS s_nationkey_prf_0#5086, s_suppkey_prf#5079 AS s_suppkey_prf_0#5087, s_name_prf#5080 AS s_name_prf_0#5088, s_acctbal_prf#5081 AS s_acctbal_prf_0#5089, s_comment_prf#5082 AS s_comment_prf_0#5090]
         :  :  +- Relation[s_phone_prf#5075,rid#5076,s_address_prf#5077,s_nationkey_prf#5078,s_suppkey_prf#5079,s_name_prf#5080,s_acctbal_prf#5081,s_comment_prf#5082] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#5091, dexdecrypt('value_dec_key, 'value_right) AS rid_0#5092]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [l_returnflag_prf#5093 AS l_returnflag_prf_1#5112, l_orderkey_and_l_linenumber_prf#5094 AS l_orderkey_and_l_linenumber_prf_1#5113, l_comment_prf#5095 AS l_comment_prf_1#5114, l_linestatus_prf#5096 AS l_linestatus_prf_1#5115, rid#5097 AS rid_1#5116, l_shipmode_prf#5098 AS l_shipmode_prf_1#5117, l_shipinstruct_prf#5099 AS l_shipinstruct_prf_1#5118, l_quantity_prf#5100 AS l_quantity_prf_1#5119, l_receiptdate_prf#5101 AS l_receiptdate_prf_1#5120, l_linenumber_prf#5102 AS l_linenumber_prf_1#5121, l_tax_prf#5103 AS l_tax_prf_1#5122, l_shipdate_prf#5104 AS l_shipdate_prf_1#5123, l_extendedprice_prf#5105 AS l_extendedprice_prf_1#5124, l_partkey_prf#5106 AS l_partkey_prf_1#5125, l_discount_prf#5107 AS l_discount_prf_1#5126, l_partkey_and_l_suppkey_prf#5108 AS l_partkey_and_l_suppkey_prf_1#5127, l_commitdate_prf#5109 AS l_commitdate_prf_1#5128, l_suppkey_prf#5110 AS l_suppkey_prf_1#5129, l_orderkey_prf#5111 AS l_orderkey_prf_1#5130]
            :  :  +- Relation[l_returnflag_prf#5093,l_orderkey_and_l_linenumber_prf#5094,l_comment_prf#5095,l_linestatus_prf#5096,rid#5097,l_shipmode_prf#5098,l_shipinstruct_prf#5099,l_quantity_prf#5100,l_receiptdate_prf#5101,l_linenumber_prf#5102,l_tax_prf#5103,l_shipdate_prf#5104,l_extendedprice_prf#5105,l_partkey_prf#5106,l_discount_prf#5107,l_partkey_and_l_suppkey_prf#5108,l_commitdate_prf#5109,l_suppkey_prf#5110,l_orderkey_prf#5111] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#5131, dexdecrypt('value_dec_key, 'value_right) AS rid_2#5132]
            :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
            :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [p_comment_prf#5133 AS p_comment_prf_2#5143, p_name_prf#5134 AS p_name_prf_2#5144, rid#5135 AS rid_2#5145, p_type_prf#5136 AS p_type_prf_2#5146, p_retailprice_prf#5137 AS p_retailprice_prf_2#5147, p_mfgr_prf#5138 AS p_mfgr_prf_2#5148, p_container_prf#5139 AS p_container_prf_2#5149, p_brand_prf#5140 AS p_brand_prf_2#5150, p_size_prf#5141 AS p_size_prf_2#5151, p_partkey_prf#5142 AS p_partkey_prf_2#5152]
               +- Relation[p_comment_prf#5133,p_name_prf#5134,rid#5135,p_type_prf#5136,p_retailprice_prf#5137,p_mfgr_prf#5138,p_container_prf#5139,p_brand_prf#5140,p_size_prf#5141,p_partkey_prf#5142] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 200767ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/12 08:21:08 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 08:21:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5214L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 08:21:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5214L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [p_comment_prf#5216 AS p_comment_prf_0#5226, p_name_prf#5217 AS p_name_prf_0#5227, rid#5218 AS rid_0#5228, p_type_prf#5219 AS p_type_prf_0#5229, p_retailprice_prf#5220 AS p_retailprice_prf_0#5230, p_mfgr_prf#5221 AS p_mfgr_prf_0#5231, p_container_prf#5222 AS p_container_prf_0#5232, p_brand_prf#5223 AS p_brand_prf_0#5233, p_size_prf#5224 AS p_size_prf_0#5234, p_partkey_prf#5225 AS p_partkey_prf_0#5235]
         :  :  :  :  +- Relation[p_comment_prf#5216,p_name_prf#5217,rid#5218,p_type_prf#5219,p_retailprice_prf#5220,p_mfgr_prf#5221,p_container_prf#5222,p_brand_prf#5223,p_size_prf#5224,p_partkey_prf#5225] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5236, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5237]
         :  :  :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :  :  :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#5238 AS ps_partkey_and_ps_suppkey_prf_1#5245, rid#5239 AS rid_1#5246, ps_availqty_prf#5240 AS ps_availqty_prf_1#5247, ps_comment_prf#5241 AS ps_comment_prf_1#5248, ps_partkey_prf#5242 AS ps_partkey_prf_1#5249, ps_supplycost_prf#5243 AS ps_supplycost_prf_1#5250, ps_suppkey_prf#5244 AS ps_suppkey_prf_1#5251]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#5238,rid#5239,ps_availqty_prf#5240,ps_comment_prf#5241,ps_partkey_prf#5242,ps_supplycost_prf#5243,ps_suppkey_prf#5244] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#5252, dexdecrypt('value_dec_key, 'value_right) AS rid_2#5253]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#5254 AS s_phone_prf_2#5262, rid#5255 AS rid_2#5263, s_address_prf#5256 AS s_address_prf_2#5264, s_nationkey_prf#5257 AS s_nationkey_prf_2#5265, s_suppkey_prf#5258 AS s_suppkey_prf_2#5266, s_name_prf#5259 AS s_name_prf_2#5267, s_acctbal_prf#5260 AS s_acctbal_prf_2#5268, s_comment_prf#5261 AS s_comment_prf_2#5269]
            +- Relation[s_phone_prf#5254,rid#5255,s_address_prf#5256,s_nationkey_prf#5257,s_suppkey_prf#5258,s_name_prf#5259,s_acctbal_prf#5260,s_comment_prf#5261] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26135ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/12 08:21:34 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 08:21:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5314L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 08:21:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5314L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#5316 AS l_returnflag_prf_0#5335, l_orderkey_and_l_linenumber_prf#5317 AS l_orderkey_and_l_linenumber_prf_0#5336, l_comment_prf#5318 AS l_comment_prf_0#5337, l_linestatus_prf#5319 AS l_linestatus_prf_0#5338, rid#5320 AS rid_0#5339, l_shipmode_prf#5321 AS l_shipmode_prf_0#5340, l_shipinstruct_prf#5322 AS l_shipinstruct_prf_0#5341, l_quantity_prf#5323 AS l_quantity_prf_0#5342, l_receiptdate_prf#5324 AS l_receiptdate_prf_0#5343, l_linenumber_prf#5325 AS l_linenumber_prf_0#5344, l_tax_prf#5326 AS l_tax_prf_0#5345, l_shipdate_prf#5327 AS l_shipdate_prf_0#5346, l_extendedprice_prf#5328 AS l_extendedprice_prf_0#5347, l_partkey_prf#5329 AS l_partkey_prf_0#5348, l_discount_prf#5330 AS l_discount_prf_0#5349, l_partkey_and_l_suppkey_prf#5331 AS l_partkey_and_l_suppkey_prf_0#5350, l_commitdate_prf#5332 AS l_commitdate_prf_0#5351, l_suppkey_prf#5333 AS l_suppkey_prf_0#5352, l_orderkey_prf#5334 AS l_orderkey_prf_0#5353]
         :  +- Relation[l_returnflag_prf#5316,l_orderkey_and_l_linenumber_prf#5317,l_comment_prf#5318,l_linestatus_prf#5319,rid#5320,l_shipmode_prf#5321,l_shipinstruct_prf#5322,l_quantity_prf#5323,l_receiptdate_prf#5324,l_linenumber_prf#5325,l_tax_prf#5326,l_shipdate_prf#5327,l_extendedprice_prf#5328,l_partkey_prf#5329,l_discount_prf#5330,l_partkey_and_l_suppkey_prf#5331,l_commitdate_prf#5332,l_suppkey_prf#5333,l_orderkey_prf#5334] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5354]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1484,value#1485] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 23426ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/12 08:21:58 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 08:21:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5396L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 08:21:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5396L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#5398 AS c_acctbal_prf_0#5407, rid#5399 AS rid_0#5408, c_name_prf#5400 AS c_name_prf_0#5409, c_nationkey_prf#5401 AS c_nationkey_prf_0#5410, c_custkey_prf#5402 AS c_custkey_prf_0#5411, c_comment_prf#5403 AS c_comment_prf_0#5412, c_address_prf#5404 AS c_address_prf_0#5413, c_mktsegment_prf#5405 AS c_mktsegment_prf_0#5414, c_phone_prf#5406 AS c_phone_prf_0#5415]
         :  :  +- Relation[c_acctbal_prf#5398,rid#5399,c_name_prf#5400,c_nationkey_prf#5401,c_custkey_prf#5402,c_comment_prf#5403,c_address_prf#5404,c_mktsegment_prf#5405,c_phone_prf#5406] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5416, dexdecrypt('value_dec_key, 'value_right) AS rid_2#5417]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [s_phone_prf#5418 AS s_phone_prf_1#5426, rid#5419 AS rid_1#5427, s_address_prf#5420 AS s_address_prf_1#5428, s_nationkey_prf#5421 AS s_nationkey_prf_1#5429, s_suppkey_prf#5422 AS s_suppkey_prf_1#5430, s_name_prf#5423 AS s_name_prf_1#5431, s_acctbal_prf#5424 AS s_acctbal_prf_1#5432, s_comment_prf#5425 AS s_comment_prf_1#5433]
            :  :  +- Relation[s_phone_prf#5418,rid#5419,s_address_prf#5420,s_nationkey_prf#5421,s_suppkey_prf#5422,s_name_prf#5423,s_acctbal_prf#5424,s_comment_prf#5425] JDBCRelation(supplier_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#5434, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5435]
            :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
            :        +- Relation[label#1525,value_left#1526,value_right#1527] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [rid#5436 AS rid_2#5441, n_regionkey_prf#5437 AS n_regionkey_prf_2#5442, n_nationkey_prf#5438 AS n_nationkey_prf_2#5443, n_name_prf#5439 AS n_name_prf_2#5444, n_comment_prf#5440 AS n_comment_prf_2#5445]
               +- Relation[rid#5436,n_regionkey_prf#5437,n_nationkey_prf#5438,n_name_prf#5439,n_comment_prf#5440] JDBCRelation(nation_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 922261ms
query=b1a, count=15628, duration=7821
query=b1b, count=15628, duration=7776
query=b2a, count=1478870, duration=97726
query=b2b, count=1478870, duration=97398
query=f1, count=1, duration=211
query=f2, count=3907, duration=124
query=f3, count=1451, duration=83
query=f4, count=1, duration=53
query=f5, count=1478870, duration=23426
query=f6, count=857401, duration=13653
query=j1, count=800000, duration=14709
query=j10, count=6001215, duration=89103
query=j2, count=800000, duration=11682
query=j3, count=25, duration=65
query=j4, count=150000, duration=2540
query=j5, count=10000, duration=225
query=j6, count=6001215, duration=105365
query=j7, count=1500000, duration=23647
query=j8, count=6001215, duration=107988
query=j8b, count=6001215, duration=107160
query=j9, count=6001215, duration=94943
query=j9b, count=6001215, duration=95326
query=r1a, count=6001215, duration=182924
query=r1b, count=6001215, duration=183302
query=r1c, count=6001215, duration=181735
query=r1d, count=6001215, duration=168886
query=r1e, count=6001215, duration=169839
query=r1f, count=6001215, duration=143826
query=t1a, count=60000414, duration=881372
query=t1b, count=60000414, duration=887669
query=t1c, count=60000414, duration=922261
query=t2a, count=800000, duration=26158
query=t2b, count=800000, duration=26135
query=t2c, count=800000, duration=26169
query=t2d, count=800000, duration=26117
query=t3a, count=6001215, duration=201238
query=t3b, count=6001215, duration=201214
query=t3c, count=6001215, duration=201537
query=t3d, count=6001215, duration=200767
