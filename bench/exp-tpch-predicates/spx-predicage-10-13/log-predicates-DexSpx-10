19/10/12 17:52:20 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7117ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Oct 12 17:52:22 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Oct 12 17:52:23 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Oct 12 17:52:23 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Oct 12 17:52:23 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Oct 12 17:52:24 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Oct 12 17:52:26 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Oct 12 17:52:28 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Oct 12 17:52:28 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/12 17:52:30 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:52:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1485L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 17:52:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1485L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [p_comment_prf#1487 AS p_comment_prf_0#1497, p_name_prf#1488 AS p_name_prf_0#1498, rid#1489 AS rid_0#1499, p_type_prf#1490 AS p_type_prf_0#1500, p_retailprice_prf#1491 AS p_retailprice_prf_0#1501, p_mfgr_prf#1492 AS p_mfgr_prf_0#1502, p_container_prf#1493 AS p_container_prf_0#1503, p_brand_prf#1494 AS p_brand_prf_0#1504, p_size_prf#1495 AS p_size_prf_0#1505, p_partkey_prf#1496 AS p_partkey_prf_0#1506]
         :  :  +- Relation[p_comment_prf#1487,p_name_prf#1488,rid#1489,p_type_prf#1490,p_retailprice_prf#1491,p_mfgr_prf#1492,p_container_prf#1493,p_brand_prf#1494,p_size_prf#1495,p_partkey_prf#1496] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1510, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1511]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#1512 AS ps_partkey_and_ps_suppkey_prf_1#1519, rid#1513 AS rid_1#1520, ps_availqty_prf#1514 AS ps_availqty_prf_1#1521, ps_comment_prf#1515 AS ps_comment_prf_1#1522, ps_partkey_prf#1516 AS ps_partkey_prf_1#1523, ps_supplycost_prf#1517 AS ps_supplycost_prf_1#1524, ps_suppkey_prf#1518 AS ps_suppkey_prf_1#1525]
            +- Relation[ps_partkey_and_ps_suppkey_prf#1512,rid#1513,ps_availqty_prf#1514,ps_comment_prf#1515,ps_partkey_prf#1516,ps_supplycost_prf#1517,ps_suppkey_prf#1518] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 12369ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/12 17:52:42 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:52:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1562L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 17:52:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1562L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#1564 AS l_returnflag_prf_0#1583, l_orderkey_and_l_linenumber_prf#1565 AS l_orderkey_and_l_linenumber_prf_0#1584, l_comment_prf#1566 AS l_comment_prf_0#1585, l_linestatus_prf#1567 AS l_linestatus_prf_0#1586, rid#1568 AS rid_0#1587, l_shipmode_prf#1569 AS l_shipmode_prf_0#1588, l_shipinstruct_prf#1570 AS l_shipinstruct_prf_0#1589, l_quantity_prf#1571 AS l_quantity_prf_0#1590, l_receiptdate_prf#1572 AS l_receiptdate_prf_0#1591, l_linenumber_prf#1573 AS l_linenumber_prf_0#1592, l_tax_prf#1574 AS l_tax_prf_0#1593, l_shipdate_prf#1575 AS l_shipdate_prf_0#1594, l_extendedprice_prf#1576 AS l_extendedprice_prf_0#1595, l_partkey_prf#1577 AS l_partkey_prf_0#1596, l_discount_prf#1578 AS l_discount_prf_0#1597, l_partkey_and_l_suppkey_prf#1579 AS l_partkey_and_l_suppkey_prf_0#1598, l_commitdate_prf#1580 AS l_commitdate_prf_0#1599, l_suppkey_prf#1581 AS l_suppkey_prf_0#1600, l_orderkey_prf#1582 AS l_orderkey_prf_0#1601]
         :  +- Relation[l_returnflag_prf#1564,l_orderkey_and_l_linenumber_prf#1565,l_comment_prf#1566,l_linestatus_prf#1567,rid#1568,l_shipmode_prf#1569,l_shipinstruct_prf#1570,l_quantity_prf#1571,l_receiptdate_prf#1572,l_linenumber_prf#1573,l_tax_prf#1574,l_shipdate_prf#1575,l_extendedprice_prf#1576,l_partkey_prf#1577,l_discount_prf#1578,l_partkey_and_l_suppkey_prf#1579,l_commitdate_prf#1580,l_suppkey_prf#1581,l_orderkey_prf#1582] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1604]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1602,value#1603] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 23334ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/12 17:53:05 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:53:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1631L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 17:53:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1631L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#1633 AS rid_0#1638, n_regionkey_prf#1634 AS n_regionkey_prf_0#1639, n_nationkey_prf#1635 AS n_nationkey_prf_0#1640, n_name_prf#1636 AS n_name_prf_0#1641, n_comment_prf#1637 AS n_comment_prf_0#1642]
         :  +- Relation[rid#1633,n_regionkey_prf#1634,n_nationkey_prf#1635,n_name_prf#1636,n_comment_prf#1637] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1643]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1602,value#1603] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1
Elapsed time: 61ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/12 17:53:05 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:53:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1677L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 17:53:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1677L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#1679 AS l_returnflag_prf_0#1698, l_orderkey_and_l_linenumber_prf#1680 AS l_orderkey_and_l_linenumber_prf_0#1699, l_comment_prf#1681 AS l_comment_prf_0#1700, l_linestatus_prf#1682 AS l_linestatus_prf_0#1701, rid#1683 AS rid_0#1702, l_shipmode_prf#1684 AS l_shipmode_prf_0#1703, l_shipinstruct_prf#1685 AS l_shipinstruct_prf_0#1704, l_quantity_prf#1686 AS l_quantity_prf_0#1705, l_receiptdate_prf#1687 AS l_receiptdate_prf_0#1706, l_linenumber_prf#1688 AS l_linenumber_prf_0#1707, l_tax_prf#1689 AS l_tax_prf_0#1708, l_shipdate_prf#1690 AS l_shipdate_prf_0#1709, l_extendedprice_prf#1691 AS l_extendedprice_prf_0#1710, l_partkey_prf#1692 AS l_partkey_prf_0#1711, l_discount_prf#1693 AS l_discount_prf_0#1712, l_partkey_and_l_suppkey_prf#1694 AS l_partkey_and_l_suppkey_prf_0#1713, l_commitdate_prf#1695 AS l_commitdate_prf_0#1714, l_suppkey_prf#1696 AS l_suppkey_prf_0#1715, l_orderkey_prf#1697 AS l_orderkey_prf_0#1716]
         :  :  +- Relation[l_returnflag_prf#1679,l_orderkey_and_l_linenumber_prf#1680,l_comment_prf#1681,l_linestatus_prf#1682,rid#1683,l_shipmode_prf#1684,l_shipinstruct_prf#1685,l_quantity_prf#1686,l_receiptdate_prf#1687,l_linenumber_prf#1688,l_tax_prf#1689,l_shipdate_prf#1690,l_extendedprice_prf#1691,l_partkey_prf#1692,l_discount_prf#1693,l_partkey_and_l_suppkey_prf#1694,l_commitdate_prf#1695,l_suppkey_prf#1696,l_orderkey_prf#1697] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1717, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1718]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#1719 AS o_shippriority_prf_1#1729, rid#1720 AS rid_1#1730, o_orderdate_prf#1721 AS o_orderdate_prf_1#1731, o_custkey_prf#1722 AS o_custkey_prf_1#1732, o_orderpriority_prf#1723 AS o_orderpriority_prf_1#1733, o_clerk_prf#1724 AS o_clerk_prf_1#1734, o_orderstatus_prf#1725 AS o_orderstatus_prf_1#1735, o_totalprice_prf#1726 AS o_totalprice_prf_1#1736, o_orderkey_prf#1727 AS o_orderkey_prf_1#1737, o_comment_prf#1728 AS o_comment_prf_1#1738]
            +- Relation[o_shippriority_prf#1719,rid#1720,o_orderdate_prf#1721,o_custkey_prf#1722,o_orderpriority_prf#1723,o_clerk_prf#1724,o_orderstatus_prf#1725,o_totalprice_prf#1726,o_orderkey_prf#1727,o_comment_prf#1728] JDBCRelation(orders_prf) [numPartitions=1]

19/10/12 17:53:05 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexSpx$ result size=6001215
Elapsed time: 107436ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/12 17:54:53 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:54:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1785L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 17:54:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1785L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [ps_partkey_and_ps_suppkey_prf#1787 AS ps_partkey_and_ps_suppkey_prf_0#1794, rid#1788 AS rid_0#1795, ps_availqty_prf#1789 AS ps_availqty_prf_0#1796, ps_comment_prf#1790 AS ps_comment_prf_0#1797, ps_partkey_prf#1791 AS ps_partkey_prf_0#1798, ps_supplycost_prf#1792 AS ps_supplycost_prf_0#1799, ps_suppkey_prf#1793 AS ps_suppkey_prf_0#1800]
         :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#1787,rid#1788,ps_availqty_prf#1789,ps_comment_prf#1790,ps_partkey_prf#1791,ps_supplycost_prf#1792,ps_suppkey_prf#1793] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1801, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1802]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#1803 AS p_comment_prf_1#1813, p_name_prf#1804 AS p_name_prf_1#1814, rid#1805 AS rid_1#1815, p_type_prf#1806 AS p_type_prf_1#1816, p_retailprice_prf#1807 AS p_retailprice_prf_1#1817, p_mfgr_prf#1808 AS p_mfgr_prf_1#1818, p_container_prf#1809 AS p_container_prf_1#1819, p_brand_prf#1810 AS p_brand_prf_1#1820, p_size_prf#1811 AS p_size_prf_1#1821, p_partkey_prf#1812 AS p_partkey_prf_1#1822]
            :  +- Relation[p_comment_prf#1803,p_name_prf#1804,rid#1805,p_type_prf#1806,p_retailprice_prf#1807,p_mfgr_prf#1808,p_container_prf#1809,p_brand_prf#1810,p_size_prf#1811,p_partkey_prf#1812] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#1823]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1602,value#1603] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=15628
Elapsed time: 7725ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/12 17:55:00 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:55:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1876L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 17:55:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1876L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [l_returnflag_prf#1878 AS l_returnflag_prf_0#1897, l_orderkey_and_l_linenumber_prf#1879 AS l_orderkey_and_l_linenumber_prf_0#1898, l_comment_prf#1880 AS l_comment_prf_0#1899, l_linestatus_prf#1881 AS l_linestatus_prf_0#1900, rid#1882 AS rid_0#1901, l_shipmode_prf#1883 AS l_shipmode_prf_0#1902, l_shipinstruct_prf#1884 AS l_shipinstruct_prf_0#1903, l_quantity_prf#1885 AS l_quantity_prf_0#1904, l_receiptdate_prf#1886 AS l_receiptdate_prf_0#1905, l_linenumber_prf#1887 AS l_linenumber_prf_0#1906, l_tax_prf#1888 AS l_tax_prf_0#1907, l_shipdate_prf#1889 AS l_shipdate_prf_0#1908, l_extendedprice_prf#1890 AS l_extendedprice_prf_0#1909, l_partkey_prf#1891 AS l_partkey_prf_0#1910, l_discount_prf#1892 AS l_discount_prf_0#1911, l_partkey_and_l_suppkey_prf#1893 AS l_partkey_and_l_suppkey_prf_0#1912, l_commitdate_prf#1894 AS l_commitdate_prf_0#1913, l_suppkey_prf#1895 AS l_suppkey_prf_0#1914, l_orderkey_prf#1896 AS l_orderkey_prf_0#1915]
         :  :  :  :  +- Relation[l_returnflag_prf#1878,l_orderkey_and_l_linenumber_prf#1879,l_comment_prf#1880,l_linestatus_prf#1881,rid#1882,l_shipmode_prf#1883,l_shipinstruct_prf#1884,l_quantity_prf#1885,l_receiptdate_prf#1886,l_linenumber_prf#1887,l_tax_prf#1888,l_shipdate_prf#1889,l_extendedprice_prf#1890,l_partkey_prf#1891,l_discount_prf#1892,l_partkey_and_l_suppkey_prf#1893,l_commitdate_prf#1894,l_suppkey_prf#1895,l_orderkey_prf#1896] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1916, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1917]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :  :  :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#1918 AS p_comment_prf_1#1928, p_name_prf#1919 AS p_name_prf_1#1929, rid#1920 AS rid_1#1930, p_type_prf#1921 AS p_type_prf_1#1931, p_retailprice_prf#1922 AS p_retailprice_prf_1#1932, p_mfgr_prf#1923 AS p_mfgr_prf_1#1933, p_container_prf#1924 AS p_container_prf_1#1934, p_brand_prf#1925 AS p_brand_prf_1#1935, p_size_prf#1926 AS p_size_prf_1#1936, p_partkey_prf#1927 AS p_partkey_prf_1#1937]
         :  :     +- Relation[p_comment_prf#1918,p_name_prf#1919,rid#1920,p_type_prf#1921,p_retailprice_prf#1922,p_mfgr_prf#1923,p_container_prf#1924,p_brand_prf#1925,p_size_prf#1926,p_partkey_prf#1927] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1938, dexdecrypt('value_dec_key, 'value_right) AS rid_2#1939]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#1940 AS s_phone_prf_2#1948, rid#1941 AS rid_2#1949, s_address_prf#1942 AS s_address_prf_2#1950, s_nationkey_prf#1943 AS s_nationkey_prf_2#1951, s_suppkey_prf#1944 AS s_suppkey_prf_2#1952, s_name_prf#1945 AS s_name_prf_2#1953, s_acctbal_prf#1946 AS s_acctbal_prf_2#1954, s_comment_prf#1947 AS s_comment_prf_2#1955]
            +- Relation[s_phone_prf#1940,rid#1941,s_address_prf#1942,s_nationkey_prf#1943,s_suppkey_prf#1944,s_name_prf#1945,s_acctbal_prf#1946,s_comment_prf#1947] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201571ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/12 17:58:22 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:58:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2017L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 17:58:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2017L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [ps_partkey_and_ps_suppkey_prf#2019 AS ps_partkey_and_ps_suppkey_prf_0#2026, rid#2020 AS rid_0#2027, ps_availqty_prf#2021 AS ps_availqty_prf_0#2028, ps_comment_prf#2022 AS ps_comment_prf_0#2029, ps_partkey_prf#2023 AS ps_partkey_prf_0#2030, ps_supplycost_prf#2024 AS ps_supplycost_prf_0#2031, ps_suppkey_prf#2025 AS ps_suppkey_prf_0#2032]
         :  :  :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#2019,rid#2020,ps_availqty_prf#2021,ps_comment_prf#2022,ps_partkey_prf#2023,ps_supplycost_prf#2024,ps_suppkey_prf#2025] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2033, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2034]
         :  :  :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :  :  :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#2035 AS p_comment_prf_1#2045, p_name_prf#2036 AS p_name_prf_1#2046, rid#2037 AS rid_1#2047, p_type_prf#2038 AS p_type_prf_1#2048, p_retailprice_prf#2039 AS p_retailprice_prf_1#2049, p_mfgr_prf#2040 AS p_mfgr_prf_1#2050, p_container_prf#2041 AS p_container_prf_1#2051, p_brand_prf#2042 AS p_brand_prf_1#2052, p_size_prf#2043 AS p_size_prf_1#2053, p_partkey_prf#2044 AS p_partkey_prf_1#2054]
         :  :     +- Relation[p_comment_prf#2035,p_name_prf#2036,rid#2037,p_type_prf#2038,p_retailprice_prf#2039,p_mfgr_prf#2040,p_container_prf#2041,p_brand_prf#2042,p_size_prf#2043,p_partkey_prf#2044] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2055, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2056]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#2057 AS s_phone_prf_2#2065, rid#2058 AS rid_2#2066, s_address_prf#2059 AS s_address_prf_2#2067, s_nationkey_prf#2060 AS s_nationkey_prf_2#2068, s_suppkey_prf#2061 AS s_suppkey_prf_2#2069, s_name_prf#2062 AS s_name_prf_2#2070, s_acctbal_prf#2063 AS s_acctbal_prf_2#2071, s_comment_prf#2064 AS s_comment_prf_2#2072]
            +- Relation[s_phone_prf#2057,rid#2058,s_address_prf#2059,s_nationkey_prf#2060,s_suppkey_prf#2061,s_name_prf#2062,s_acctbal_prf#2063,s_comment_prf#2064] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26111ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/12 17:58:48 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:58:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2133L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 17:58:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2133L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#2135 AS s_phone_prf_0#2143, rid#2136 AS rid_0#2144, s_address_prf#2137 AS s_address_prf_0#2145, s_nationkey_prf#2138 AS s_nationkey_prf_0#2146, s_suppkey_prf#2139 AS s_suppkey_prf_0#2147, s_name_prf#2140 AS s_name_prf_0#2148, s_acctbal_prf#2141 AS s_acctbal_prf_0#2149, s_comment_prf#2142 AS s_comment_prf_0#2150]
         :  :  +- Relation[s_phone_prf#2135,rid#2136,s_address_prf#2137,s_nationkey_prf#2138,s_suppkey_prf#2139,s_name_prf#2140,s_acctbal_prf#2141,s_comment_prf#2142] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2151, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2152]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [l_returnflag_prf#2153 AS l_returnflag_prf_1#2172, l_orderkey_and_l_linenumber_prf#2154 AS l_orderkey_and_l_linenumber_prf_1#2173, l_comment_prf#2155 AS l_comment_prf_1#2174, l_linestatus_prf#2156 AS l_linestatus_prf_1#2175, rid#2157 AS rid_1#2176, l_shipmode_prf#2158 AS l_shipmode_prf_1#2177, l_shipinstruct_prf#2159 AS l_shipinstruct_prf_1#2178, l_quantity_prf#2160 AS l_quantity_prf_1#2179, l_receiptdate_prf#2161 AS l_receiptdate_prf_1#2180, l_linenumber_prf#2162 AS l_linenumber_prf_1#2181, l_tax_prf#2163 AS l_tax_prf_1#2182, l_shipdate_prf#2164 AS l_shipdate_prf_1#2183, l_extendedprice_prf#2165 AS l_extendedprice_prf_1#2184, l_partkey_prf#2166 AS l_partkey_prf_1#2185, l_discount_prf#2167 AS l_discount_prf_1#2186, l_partkey_and_l_suppkey_prf#2168 AS l_partkey_and_l_suppkey_prf_1#2187, l_commitdate_prf#2169 AS l_commitdate_prf_1#2188, l_suppkey_prf#2170 AS l_suppkey_prf_1#2189, l_orderkey_prf#2171 AS l_orderkey_prf_1#2190]
            :  :  +- Relation[l_returnflag_prf#2153,l_orderkey_and_l_linenumber_prf#2154,l_comment_prf#2155,l_linestatus_prf#2156,rid#2157,l_shipmode_prf#2158,l_shipinstruct_prf#2159,l_quantity_prf#2160,l_receiptdate_prf#2161,l_linenumber_prf#2162,l_tax_prf#2163,l_shipdate_prf#2164,l_extendedprice_prf#2165,l_partkey_prf#2166,l_discount_prf#2167,l_partkey_and_l_suppkey_prf#2168,l_commitdate_prf#2169,l_suppkey_prf#2170,l_orderkey_prf#2171] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2191, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2192]
            :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
            :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [p_comment_prf#2193 AS p_comment_prf_2#2203, p_name_prf#2194 AS p_name_prf_2#2204, rid#2195 AS rid_2#2205, p_type_prf#2196 AS p_type_prf_2#2206, p_retailprice_prf#2197 AS p_retailprice_prf_2#2207, p_mfgr_prf#2198 AS p_mfgr_prf_2#2208, p_container_prf#2199 AS p_container_prf_2#2209, p_brand_prf#2200 AS p_brand_prf_2#2210, p_size_prf#2201 AS p_size_prf_2#2211, p_partkey_prf#2202 AS p_partkey_prf_2#2212]
               +- Relation[p_comment_prf#2193,p_name_prf#2194,rid#2195,p_type_prf#2196,p_retailprice_prf#2197,p_mfgr_prf#2198,p_container_prf#2199,p_brand_prf#2200,p_size_prf#2201,p_partkey_prf#2202] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 200859ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/12 18:02:09 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:02:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2269L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 18:02:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2269L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#2271 AS l_returnflag_prf_0#2290, l_orderkey_and_l_linenumber_prf#2272 AS l_orderkey_and_l_linenumber_prf_0#2291, l_comment_prf#2273 AS l_comment_prf_0#2292, l_linestatus_prf#2274 AS l_linestatus_prf_0#2293, rid#2275 AS rid_0#2294, l_shipmode_prf#2276 AS l_shipmode_prf_0#2295, l_shipinstruct_prf#2277 AS l_shipinstruct_prf_0#2296, l_quantity_prf#2278 AS l_quantity_prf_0#2297, l_receiptdate_prf#2279 AS l_receiptdate_prf_0#2298, l_linenumber_prf#2280 AS l_linenumber_prf_0#2299, l_tax_prf#2281 AS l_tax_prf_0#2300, l_shipdate_prf#2282 AS l_shipdate_prf_0#2301, l_extendedprice_prf#2283 AS l_extendedprice_prf_0#2302, l_partkey_prf#2284 AS l_partkey_prf_0#2303, l_discount_prf#2285 AS l_discount_prf_0#2304, l_partkey_and_l_suppkey_prf#2286 AS l_partkey_and_l_suppkey_prf_0#2305, l_commitdate_prf#2287 AS l_commitdate_prf_0#2306, l_suppkey_prf#2288 AS l_suppkey_prf_0#2307, l_orderkey_prf#2289 AS l_orderkey_prf_0#2308]
         :  +- Relation[l_returnflag_prf#2271,l_orderkey_and_l_linenumber_prf#2272,l_comment_prf#2273,l_linestatus_prf#2274,rid#2275,l_shipmode_prf#2276,l_shipinstruct_prf#2277,l_quantity_prf#2278,l_receiptdate_prf#2279,l_linenumber_prf#2280,l_tax_prf#2281,l_shipdate_prf#2282,l_extendedprice_prf#2283,l_partkey_prf#2284,l_discount_prf#2285,l_partkey_and_l_suppkey_prf#2286,l_commitdate_prf#2287,l_suppkey_prf#2288,l_orderkey_prf#2289] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2309]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1602,value#1603] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=857401
Elapsed time: 13620ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/12 18:02:23 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:02:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2357L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 18:02:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2357L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [o_shippriority_prf#2359 AS o_shippriority_prf_0#2369, rid#2360 AS rid_0#2370, o_orderdate_prf#2361 AS o_orderdate_prf_0#2371, o_custkey_prf#2362 AS o_custkey_prf_0#2372, o_orderpriority_prf#2363 AS o_orderpriority_prf_0#2373, o_clerk_prf#2364 AS o_clerk_prf_0#2374, o_orderstatus_prf#2365 AS o_orderstatus_prf_0#2375, o_totalprice_prf#2366 AS o_totalprice_prf_0#2376, o_orderkey_prf#2367 AS o_orderkey_prf_0#2377, o_comment_prf#2368 AS o_comment_prf_0#2378]
         :  :  +- Relation[o_shippriority_prf#2359,rid#2360,o_orderdate_prf#2361,o_custkey_prf#2362,o_orderpriority_prf#2363,o_clerk_prf#2364,o_orderstatus_prf#2365,o_totalprice_prf#2366,o_orderkey_prf#2367,o_comment_prf#2368] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2379, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2380]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2381 AS l_returnflag_prf_1#2400, l_orderkey_and_l_linenumber_prf#2382 AS l_orderkey_and_l_linenumber_prf_1#2401, l_comment_prf#2383 AS l_comment_prf_1#2402, l_linestatus_prf#2384 AS l_linestatus_prf_1#2403, rid#2385 AS rid_1#2404, l_shipmode_prf#2386 AS l_shipmode_prf_1#2405, l_shipinstruct_prf#2387 AS l_shipinstruct_prf_1#2406, l_quantity_prf#2388 AS l_quantity_prf_1#2407, l_receiptdate_prf#2389 AS l_receiptdate_prf_1#2408, l_linenumber_prf#2390 AS l_linenumber_prf_1#2409, l_tax_prf#2391 AS l_tax_prf_1#2410, l_shipdate_prf#2392 AS l_shipdate_prf_1#2411, l_extendedprice_prf#2393 AS l_extendedprice_prf_1#2412, l_partkey_prf#2394 AS l_partkey_prf_1#2413, l_discount_prf#2395 AS l_discount_prf_1#2414, l_partkey_and_l_suppkey_prf#2396 AS l_partkey_and_l_suppkey_prf_1#2415, l_commitdate_prf#2397 AS l_commitdate_prf_1#2416, l_suppkey_prf#2398 AS l_suppkey_prf_1#2417, l_orderkey_prf#2399 AS l_orderkey_prf_1#2418]
            +- Relation[l_returnflag_prf#2381,l_orderkey_and_l_linenumber_prf#2382,l_comment_prf#2383,l_linestatus_prf#2384,rid#2385,l_shipmode_prf#2386,l_shipinstruct_prf#2387,l_quantity_prf#2388,l_receiptdate_prf#2389,l_linenumber_prf#2390,l_tax_prf#2391,l_shipdate_prf#2392,l_extendedprice_prf#2393,l_partkey_prf#2394,l_discount_prf#2395,l_partkey_and_l_suppkey_prf#2396,l_commitdate_prf#2397,l_suppkey_prf#2398,l_orderkey_prf#2399] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 107607ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/12 18:04:10 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:04:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2484L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 18:04:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2484L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [l_returnflag_prf#2486 AS l_returnflag_prf_0#2505, l_orderkey_and_l_linenumber_prf#2487 AS l_orderkey_and_l_linenumber_prf_0#2506, l_comment_prf#2488 AS l_comment_prf_0#2507, l_linestatus_prf#2489 AS l_linestatus_prf_0#2508, rid#2490 AS rid_0#2509, l_shipmode_prf#2491 AS l_shipmode_prf_0#2510, l_shipinstruct_prf#2492 AS l_shipinstruct_prf_0#2511, l_quantity_prf#2493 AS l_quantity_prf_0#2512, l_receiptdate_prf#2494 AS l_receiptdate_prf_0#2513, l_linenumber_prf#2495 AS l_linenumber_prf_0#2514, l_tax_prf#2496 AS l_tax_prf_0#2515, l_shipdate_prf#2497 AS l_shipdate_prf_0#2516, l_extendedprice_prf#2498 AS l_extendedprice_prf_0#2517, l_partkey_prf#2499 AS l_partkey_prf_0#2518, l_discount_prf#2500 AS l_discount_prf_0#2519, l_partkey_and_l_suppkey_prf#2501 AS l_partkey_and_l_suppkey_prf_0#2520, l_commitdate_prf#2502 AS l_commitdate_prf_0#2521, l_suppkey_prf#2503 AS l_suppkey_prf_0#2522, l_orderkey_prf#2504 AS l_orderkey_prf_0#2523]
         :  :  :  :  +- Relation[l_returnflag_prf#2486,l_orderkey_and_l_linenumber_prf#2487,l_comment_prf#2488,l_linestatus_prf#2489,rid#2490,l_shipmode_prf#2491,l_shipinstruct_prf#2492,l_quantity_prf#2493,l_receiptdate_prf#2494,l_linenumber_prf#2495,l_tax_prf#2496,l_shipdate_prf#2497,l_extendedprice_prf#2498,l_partkey_prf#2499,l_discount_prf#2500,l_partkey_and_l_suppkey_prf#2501,l_commitdate_prf#2502,l_suppkey_prf#2503,l_orderkey_prf#2504] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2524, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2525]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :  :  :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#2526 AS o_shippriority_prf_1#2536, rid#2527 AS rid_1#2537, o_orderdate_prf#2528 AS o_orderdate_prf_1#2538, o_custkey_prf#2529 AS o_custkey_prf_1#2539, o_orderpriority_prf#2530 AS o_orderpriority_prf_1#2540, o_clerk_prf#2531 AS o_clerk_prf_1#2541, o_orderstatus_prf#2532 AS o_orderstatus_prf_1#2542, o_totalprice_prf#2533 AS o_totalprice_prf_1#2543, o_orderkey_prf#2534 AS o_orderkey_prf_1#2544, o_comment_prf#2535 AS o_comment_prf_1#2545]
         :  :     +- Relation[o_shippriority_prf#2526,rid#2527,o_orderdate_prf#2528,o_custkey_prf#2529,o_orderpriority_prf#2530,o_clerk_prf#2531,o_orderstatus_prf#2532,o_totalprice_prf#2533,o_orderkey_prf#2534,o_comment_prf#2535] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2546, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2547]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2548 AS c_acctbal_prf_2#2557, rid#2549 AS rid_2#2558, c_name_prf#2550 AS c_name_prf_2#2559, c_nationkey_prf#2551 AS c_nationkey_prf_2#2560, c_custkey_prf#2552 AS c_custkey_prf_2#2561, c_comment_prf#2553 AS c_comment_prf_2#2562, c_address_prf#2554 AS c_address_prf_2#2563, c_mktsegment_prf#2555 AS c_mktsegment_prf_2#2564, c_phone_prf#2556 AS c_phone_prf_2#2565]
            +- Relation[c_acctbal_prf#2548,rid#2549,c_name_prf#2550,c_nationkey_prf#2551,c_custkey_prf#2552,c_comment_prf#2553,c_address_prf#2554,c_mktsegment_prf#2555,c_phone_prf#2556] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 183120ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/12 18:07:13 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:07:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2640L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 18:07:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2640L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#2642 AS l_returnflag_prf_0#2661, l_orderkey_and_l_linenumber_prf#2643 AS l_orderkey_and_l_linenumber_prf_0#2662, l_comment_prf#2644 AS l_comment_prf_0#2663, l_linestatus_prf#2645 AS l_linestatus_prf_0#2664, rid#2646 AS rid_0#2665, l_shipmode_prf#2647 AS l_shipmode_prf_0#2666, l_shipinstruct_prf#2648 AS l_shipinstruct_prf_0#2667, l_quantity_prf#2649 AS l_quantity_prf_0#2668, l_receiptdate_prf#2650 AS l_receiptdate_prf_0#2669, l_linenumber_prf#2651 AS l_linenumber_prf_0#2670, l_tax_prf#2652 AS l_tax_prf_0#2671, l_shipdate_prf#2653 AS l_shipdate_prf_0#2672, l_extendedprice_prf#2654 AS l_extendedprice_prf_0#2673, l_partkey_prf#2655 AS l_partkey_prf_0#2674, l_discount_prf#2656 AS l_discount_prf_0#2675, l_partkey_and_l_suppkey_prf#2657 AS l_partkey_and_l_suppkey_prf_0#2676, l_commitdate_prf#2658 AS l_commitdate_prf_0#2677, l_suppkey_prf#2659 AS l_suppkey_prf_0#2678, l_orderkey_prf#2660 AS l_orderkey_prf_0#2679]
         :  :  +- Relation[l_returnflag_prf#2642,l_orderkey_and_l_linenumber_prf#2643,l_comment_prf#2644,l_linestatus_prf#2645,rid#2646,l_shipmode_prf#2647,l_shipinstruct_prf#2648,l_quantity_prf#2649,l_receiptdate_prf#2650,l_linenumber_prf#2651,l_tax_prf#2652,l_shipdate_prf#2653,l_extendedprice_prf#2654,l_partkey_prf#2655,l_discount_prf#2656,l_partkey_and_l_suppkey_prf#2657,l_commitdate_prf#2658,l_suppkey_prf#2659,l_orderkey_prf#2660] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2680, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2681]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [c_acctbal_prf#2682 AS c_acctbal_prf_1#2691, rid#2683 AS rid_1#2692, c_name_prf#2684 AS c_name_prf_1#2693, c_nationkey_prf#2685 AS c_nationkey_prf_1#2694, c_custkey_prf#2686 AS c_custkey_prf_1#2695, c_comment_prf#2687 AS c_comment_prf_1#2696, c_address_prf#2688 AS c_address_prf_1#2697, c_mktsegment_prf#2689 AS c_mktsegment_prf_1#2698, c_phone_prf#2690 AS c_phone_prf_1#2699]
            :  :  +- Relation[c_acctbal_prf#2682,rid#2683,c_name_prf#2684,c_nationkey_prf#2685,c_custkey_prf#2686,c_comment_prf#2687,c_address_prf#2688,c_mktsegment_prf#2689,c_phone_prf#2690] JDBCRelation(customer_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2700, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2701]
            :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
            :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2702 AS o_shippriority_prf_2#2712, rid#2703 AS rid_2#2713, o_orderdate_prf#2704 AS o_orderdate_prf_2#2714, o_custkey_prf#2705 AS o_custkey_prf_2#2715, o_orderpriority_prf#2706 AS o_orderpriority_prf_2#2716, o_clerk_prf#2707 AS o_clerk_prf_2#2717, o_orderstatus_prf#2708 AS o_orderstatus_prf_2#2718, o_totalprice_prf#2709 AS o_totalprice_prf_2#2719, o_orderkey_prf#2710 AS o_orderkey_prf_2#2720, o_comment_prf#2711 AS o_comment_prf_2#2721]
               +- Relation[o_shippriority_prf#2702,rid#2703,o_orderdate_prf#2704,o_custkey_prf#2705,o_orderpriority_prf#2706,o_clerk_prf#2707,o_orderstatus_prf#2708,o_totalprice_prf#2709,o_orderkey_prf#2710,o_comment_prf#2711] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 182355ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/12 18:10:16 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:10:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2777L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 18:10:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2777L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [p_comment_prf#2779 AS p_comment_prf_0#2789, p_name_prf#2780 AS p_name_prf_0#2790, rid#2781 AS rid_0#2791, p_type_prf#2782 AS p_type_prf_0#2792, p_retailprice_prf#2783 AS p_retailprice_prf_0#2793, p_mfgr_prf#2784 AS p_mfgr_prf_0#2794, p_container_prf#2785 AS p_container_prf_0#2795, p_brand_prf#2786 AS p_brand_prf_0#2796, p_size_prf#2787 AS p_size_prf_0#2797, p_partkey_prf#2788 AS p_partkey_prf_0#2798]
         :  :  :  +- Relation[p_comment_prf#2779,p_name_prf#2780,rid#2781,p_type_prf#2782,p_retailprice_prf#2783,p_mfgr_prf#2784,p_container_prf#2785,p_brand_prf#2786,p_size_prf#2787,p_partkey_prf#2788] JDBCRelation(part_prf) [numPartitions=1]
         :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2799]
         :  :     +- DexRidFilter part~p_size~15
         :  :        +- Relation[label#1602,value#1603] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2800, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2801]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2802 AS ps_partkey_and_ps_suppkey_prf_1#2809, rid#2803 AS rid_1#2810, ps_availqty_prf#2804 AS ps_availqty_prf_1#2811, ps_comment_prf#2805 AS ps_comment_prf_1#2812, ps_partkey_prf#2806 AS ps_partkey_prf_1#2813, ps_supplycost_prf#2807 AS ps_supplycost_prf_1#2814, ps_suppkey_prf#2808 AS ps_suppkey_prf_1#2815]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2802,rid#2803,ps_availqty_prf#2804,ps_comment_prf#2805,ps_partkey_prf#2806,ps_supplycost_prf#2807,ps_suppkey_prf#2808] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=15628
Elapsed time: 7722ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/12 18:10:23 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:10:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2869L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 18:10:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2869L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#2871 AS c_acctbal_prf_0#2880, rid#2872 AS rid_0#2881, c_name_prf#2873 AS c_name_prf_0#2882, c_nationkey_prf#2874 AS c_nationkey_prf_0#2883, c_custkey_prf#2875 AS c_custkey_prf_0#2884, c_comment_prf#2876 AS c_comment_prf_0#2885, c_address_prf#2877 AS c_address_prf_0#2886, c_mktsegment_prf#2878 AS c_mktsegment_prf_0#2887, c_phone_prf#2879 AS c_phone_prf_0#2888]
         :  :  +- Relation[c_acctbal_prf#2871,rid#2872,c_name_prf#2873,c_nationkey_prf#2874,c_custkey_prf#2875,c_comment_prf#2876,c_address_prf#2877,c_mktsegment_prf#2878,c_phone_prf#2879] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2889, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2890]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [l_returnflag_prf#2891 AS l_returnflag_prf_1#2910, l_orderkey_and_l_linenumber_prf#2892 AS l_orderkey_and_l_linenumber_prf_1#2911, l_comment_prf#2893 AS l_comment_prf_1#2912, l_linestatus_prf#2894 AS l_linestatus_prf_1#2913, rid#2895 AS rid_1#2914, l_shipmode_prf#2896 AS l_shipmode_prf_1#2915, l_shipinstruct_prf#2897 AS l_shipinstruct_prf_1#2916, l_quantity_prf#2898 AS l_quantity_prf_1#2917, l_receiptdate_prf#2899 AS l_receiptdate_prf_1#2918, l_linenumber_prf#2900 AS l_linenumber_prf_1#2919, l_tax_prf#2901 AS l_tax_prf_1#2920, l_shipdate_prf#2902 AS l_shipdate_prf_1#2921, l_extendedprice_prf#2903 AS l_extendedprice_prf_1#2922, l_partkey_prf#2904 AS l_partkey_prf_1#2923, l_discount_prf#2905 AS l_discount_prf_1#2924, l_partkey_and_l_suppkey_prf#2906 AS l_partkey_and_l_suppkey_prf_1#2925, l_commitdate_prf#2907 AS l_commitdate_prf_1#2926, l_suppkey_prf#2908 AS l_suppkey_prf_1#2927, l_orderkey_prf#2909 AS l_orderkey_prf_1#2928]
            :  :  +- Relation[l_returnflag_prf#2891,l_orderkey_and_l_linenumber_prf#2892,l_comment_prf#2893,l_linestatus_prf#2894,rid#2895,l_shipmode_prf#2896,l_shipinstruct_prf#2897,l_quantity_prf#2898,l_receiptdate_prf#2899,l_linenumber_prf#2900,l_tax_prf#2901,l_shipdate_prf#2902,l_extendedprice_prf#2903,l_partkey_prf#2904,l_discount_prf#2905,l_partkey_and_l_suppkey_prf#2906,l_commitdate_prf#2907,l_suppkey_prf#2908,l_orderkey_prf#2909] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2929, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2930]
            :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
            :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2931 AS o_shippriority_prf_2#2941, rid#2932 AS rid_2#2942, o_orderdate_prf#2933 AS o_orderdate_prf_2#2943, o_custkey_prf#2934 AS o_custkey_prf_2#2944, o_orderpriority_prf#2935 AS o_orderpriority_prf_2#2945, o_clerk_prf#2936 AS o_clerk_prf_2#2946, o_orderstatus_prf#2937 AS o_orderstatus_prf_2#2947, o_totalprice_prf#2938 AS o_totalprice_prf_2#2948, o_orderkey_prf#2939 AS o_orderkey_prf_2#2949, o_comment_prf#2940 AS o_comment_prf_2#2950]
               +- Relation[o_shippriority_prf#2931,rid#2932,o_orderdate_prf#2933,o_custkey_prf#2934,o_orderpriority_prf#2935,o_clerk_prf#2936,o_orderstatus_prf#2937,o_totalprice_prf#2938,o_orderkey_prf#2939,o_comment_prf#2940] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 143864ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/12 18:12:47 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:12:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3011L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 18:12:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3011L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#3013 AS c_acctbal_prf_0#3022, rid#3014 AS rid_0#3023, c_name_prf#3015 AS c_name_prf_0#3024, c_nationkey_prf#3016 AS c_nationkey_prf_0#3025, c_custkey_prf#3017 AS c_custkey_prf_0#3026, c_comment_prf#3018 AS c_comment_prf_0#3027, c_address_prf#3019 AS c_address_prf_0#3028, c_mktsegment_prf#3020 AS c_mktsegment_prf_0#3029, c_phone_prf#3021 AS c_phone_prf_0#3030]
         :  :  +- Relation[c_acctbal_prf#3013,rid#3014,c_name_prf#3015,c_nationkey_prf#3016,c_custkey_prf#3017,c_comment_prf#3018,c_address_prf#3019,c_mktsegment_prf#3020,c_phone_prf#3021] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3031, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3032]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [s_phone_prf#3033 AS s_phone_prf_1#3041, rid#3034 AS rid_1#3042, s_address_prf#3035 AS s_address_prf_1#3043, s_nationkey_prf#3036 AS s_nationkey_prf_1#3044, s_suppkey_prf#3037 AS s_suppkey_prf_1#3045, s_name_prf#3038 AS s_name_prf_1#3046, s_acctbal_prf#3039 AS s_acctbal_prf_1#3047, s_comment_prf#3040 AS s_comment_prf_1#3048]
            :  :  +- Relation[s_phone_prf#3033,rid#3034,s_address_prf#3035,s_nationkey_prf#3036,s_suppkey_prf#3037,s_name_prf#3038,s_acctbal_prf#3039,s_comment_prf#3040] JDBCRelation(supplier_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3049, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3050]
            :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
            :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [rid#3051 AS rid_2#3056, n_regionkey_prf#3052 AS n_regionkey_prf_2#3057, n_nationkey_prf#3053 AS n_nationkey_prf_2#3058, n_name_prf#3054 AS n_name_prf_2#3059, n_comment_prf#3055 AS n_comment_prf_2#3060]
               +- Relation[rid#3051,n_regionkey_prf#3052,n_nationkey_prf#3053,n_name_prf#3054,n_comment_prf#3055] JDBCRelation(nation_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 922296ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/12 18:28:10 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:28:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3111L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 18:28:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3111L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [p_comment_prf#3113 AS p_comment_prf_0#3123, p_name_prf#3114 AS p_name_prf_0#3124, rid#3115 AS rid_0#3125, p_type_prf#3116 AS p_type_prf_0#3126, p_retailprice_prf#3117 AS p_retailprice_prf_0#3127, p_mfgr_prf#3118 AS p_mfgr_prf_0#3128, p_container_prf#3119 AS p_container_prf_0#3129, p_brand_prf#3120 AS p_brand_prf_0#3130, p_size_prf#3121 AS p_size_prf_0#3131, p_partkey_prf#3122 AS p_partkey_prf_0#3132]
         :  :  +- Relation[p_comment_prf#3113,p_name_prf#3114,rid#3115,p_type_prf#3116,p_retailprice_prf#3117,p_mfgr_prf#3118,p_container_prf#3119,p_brand_prf#3120,p_size_prf#3121,p_partkey_prf#3122] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3133, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3134]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3135 AS l_returnflag_prf_1#3154, l_orderkey_and_l_linenumber_prf#3136 AS l_orderkey_and_l_linenumber_prf_1#3155, l_comment_prf#3137 AS l_comment_prf_1#3156, l_linestatus_prf#3138 AS l_linestatus_prf_1#3157, rid#3139 AS rid_1#3158, l_shipmode_prf#3140 AS l_shipmode_prf_1#3159, l_shipinstruct_prf#3141 AS l_shipinstruct_prf_1#3160, l_quantity_prf#3142 AS l_quantity_prf_1#3161, l_receiptdate_prf#3143 AS l_receiptdate_prf_1#3162, l_linenumber_prf#3144 AS l_linenumber_prf_1#3163, l_tax_prf#3145 AS l_tax_prf_1#3164, l_shipdate_prf#3146 AS l_shipdate_prf_1#3165, l_extendedprice_prf#3147 AS l_extendedprice_prf_1#3166, l_partkey_prf#3148 AS l_partkey_prf_1#3167, l_discount_prf#3149 AS l_discount_prf_1#3168, l_partkey_and_l_suppkey_prf#3150 AS l_partkey_and_l_suppkey_prf_1#3169, l_commitdate_prf#3151 AS l_commitdate_prf_1#3170, l_suppkey_prf#3152 AS l_suppkey_prf_1#3171, l_orderkey_prf#3153 AS l_orderkey_prf_1#3172]
            +- Relation[l_returnflag_prf#3135,l_orderkey_and_l_linenumber_prf#3136,l_comment_prf#3137,l_linestatus_prf#3138,rid#3139,l_shipmode_prf#3140,l_shipinstruct_prf#3141,l_quantity_prf#3142,l_receiptdate_prf#3143,l_linenumber_prf#3144,l_tax_prf#3145,l_shipdate_prf#3146,l_extendedprice_prf#3147,l_partkey_prf#3148,l_discount_prf#3149,l_partkey_and_l_suppkey_prf#3150,l_commitdate_prf#3151,l_suppkey_prf#3152,l_orderkey_prf#3153] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 94796ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/12 18:29:44 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:29:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3217L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 18:29:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3217L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#3219 AS s_phone_prf_0#3227, rid#3220 AS rid_0#3228, s_address_prf#3221 AS s_address_prf_0#3229, s_nationkey_prf#3222 AS s_nationkey_prf_0#3230, s_suppkey_prf#3223 AS s_suppkey_prf_0#3231, s_name_prf#3224 AS s_name_prf_0#3232, s_acctbal_prf#3225 AS s_acctbal_prf_0#3233, s_comment_prf#3226 AS s_comment_prf_0#3234]
         :  :  +- Relation[s_phone_prf#3219,rid#3220,s_address_prf#3221,s_nationkey_prf#3222,s_suppkey_prf#3223,s_name_prf#3224,s_acctbal_prf#3225,s_comment_prf#3226] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3235, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3236]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#3237 AS ps_partkey_and_ps_suppkey_prf_1#3244, rid#3238 AS rid_1#3245, ps_availqty_prf#3239 AS ps_availqty_prf_1#3246, ps_comment_prf#3240 AS ps_comment_prf_1#3247, ps_partkey_prf#3241 AS ps_partkey_prf_1#3248, ps_supplycost_prf#3242 AS ps_supplycost_prf_1#3249, ps_suppkey_prf#3243 AS ps_suppkey_prf_1#3250]
            +- Relation[ps_partkey_and_ps_suppkey_prf#3237,rid#3238,ps_availqty_prf#3239,ps_comment_prf#3240,ps_partkey_prf#3241,ps_supplycost_prf#3242,ps_suppkey_prf#3243] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 11656ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/12 18:29:56 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:29:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3294L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 18:29:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3294L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#3296 AS l_returnflag_prf_0#3315, l_orderkey_and_l_linenumber_prf#3297 AS l_orderkey_and_l_linenumber_prf_0#3316, l_comment_prf#3298 AS l_comment_prf_0#3317, l_linestatus_prf#3299 AS l_linestatus_prf_0#3318, rid#3300 AS rid_0#3319, l_shipmode_prf#3301 AS l_shipmode_prf_0#3320, l_shipinstruct_prf#3302 AS l_shipinstruct_prf_0#3321, l_quantity_prf#3303 AS l_quantity_prf_0#3322, l_receiptdate_prf#3304 AS l_receiptdate_prf_0#3323, l_linenumber_prf#3305 AS l_linenumber_prf_0#3324, l_tax_prf#3306 AS l_tax_prf_0#3325, l_shipdate_prf#3307 AS l_shipdate_prf_0#3326, l_extendedprice_prf#3308 AS l_extendedprice_prf_0#3327, l_partkey_prf#3309 AS l_partkey_prf_0#3328, l_discount_prf#3310 AS l_discount_prf_0#3329, l_partkey_and_l_suppkey_prf#3311 AS l_partkey_and_l_suppkey_prf_0#3330, l_commitdate_prf#3312 AS l_commitdate_prf_0#3331, l_suppkey_prf#3313 AS l_suppkey_prf_0#3332, l_orderkey_prf#3314 AS l_orderkey_prf_0#3333]
         :  :  +- Relation[l_returnflag_prf#3296,l_orderkey_and_l_linenumber_prf#3297,l_comment_prf#3298,l_linestatus_prf#3299,rid#3300,l_shipmode_prf#3301,l_shipinstruct_prf#3302,l_quantity_prf#3303,l_receiptdate_prf#3304,l_linenumber_prf#3305,l_tax_prf#3306,l_shipdate_prf#3307,l_extendedprice_prf#3308,l_partkey_prf#3309,l_discount_prf#3310,l_partkey_and_l_suppkey_prf#3311,l_commitdate_prf#3312,l_suppkey_prf#3313,l_orderkey_prf#3314] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3334, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3335]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [p_comment_prf#3336 AS p_comment_prf_1#3346, p_name_prf#3337 AS p_name_prf_1#3347, rid#3338 AS rid_1#3348, p_type_prf#3339 AS p_type_prf_1#3349, p_retailprice_prf#3340 AS p_retailprice_prf_1#3350, p_mfgr_prf#3341 AS p_mfgr_prf_1#3351, p_container_prf#3342 AS p_container_prf_1#3352, p_brand_prf#3343 AS p_brand_prf_1#3353, p_size_prf#3344 AS p_size_prf_1#3354, p_partkey_prf#3345 AS p_partkey_prf_1#3355]
            +- Relation[p_comment_prf#3336,p_name_prf#3337,rid#3338,p_type_prf#3339,p_retailprice_prf#3340,p_mfgr_prf#3341,p_container_prf#3342,p_brand_prf#3343,p_size_prf#3344,p_partkey_prf#3345] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 95960ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/12 18:31:32 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:31:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3409L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 18:31:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3409L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [p_comment_prf#3411 AS p_comment_prf_0#3421, p_name_prf#3412 AS p_name_prf_0#3422, rid#3413 AS rid_0#3423, p_type_prf#3414 AS p_type_prf_0#3424, p_retailprice_prf#3415 AS p_retailprice_prf_0#3425, p_mfgr_prf#3416 AS p_mfgr_prf_0#3426, p_container_prf#3417 AS p_container_prf_0#3427, p_brand_prf#3418 AS p_brand_prf_0#3428, p_size_prf#3419 AS p_size_prf_0#3429, p_partkey_prf#3420 AS p_partkey_prf_0#3430]
         :  :  :  :  +- Relation[p_comment_prf#3411,p_name_prf#3412,rid#3413,p_type_prf#3414,p_retailprice_prf#3415,p_mfgr_prf#3416,p_container_prf#3417,p_brand_prf#3418,p_size_prf#3419,p_partkey_prf#3420] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3431, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3432]
         :  :  :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :  :  :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#3433 AS ps_partkey_and_ps_suppkey_prf_1#3440, rid#3434 AS rid_1#3441, ps_availqty_prf#3435 AS ps_availqty_prf_1#3442, ps_comment_prf#3436 AS ps_comment_prf_1#3443, ps_partkey_prf#3437 AS ps_partkey_prf_1#3444, ps_supplycost_prf#3438 AS ps_supplycost_prf_1#3445, ps_suppkey_prf#3439 AS ps_suppkey_prf_1#3446]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#3433,rid#3434,ps_availqty_prf#3435,ps_comment_prf#3436,ps_partkey_prf#3437,ps_supplycost_prf#3438,ps_suppkey_prf#3439] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3447, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3448]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#3449 AS s_phone_prf_2#3457, rid#3450 AS rid_2#3458, s_address_prf#3451 AS s_address_prf_2#3459, s_nationkey_prf#3452 AS s_nationkey_prf_2#3460, s_suppkey_prf#3453 AS s_suppkey_prf_2#3461, s_name_prf#3454 AS s_name_prf_2#3462, s_acctbal_prf#3455 AS s_acctbal_prf_2#3463, s_comment_prf#3456 AS s_comment_prf_2#3464]
            +- Relation[s_phone_prf#3449,rid#3450,s_address_prf#3451,s_nationkey_prf#3452,s_suppkey_prf#3453,s_name_prf#3454,s_acctbal_prf#3455,s_comment_prf#3456] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26112ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/12 18:31:58 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:31:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3514L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 18:31:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3514L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#3516 AS s_phone_prf_0#3524, rid#3517 AS rid_0#3525, s_address_prf#3518 AS s_address_prf_0#3526, s_nationkey_prf#3519 AS s_nationkey_prf_0#3527, s_suppkey_prf#3520 AS s_suppkey_prf_0#3528, s_name_prf#3521 AS s_name_prf_0#3529, s_acctbal_prf#3522 AS s_acctbal_prf_0#3530, s_comment_prf#3523 AS s_comment_prf_0#3531]
         :  :  +- Relation[s_phone_prf#3516,rid#3517,s_address_prf#3518,s_nationkey_prf#3519,s_suppkey_prf#3520,s_name_prf#3521,s_acctbal_prf#3522,s_comment_prf#3523] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3532, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3533]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [ps_partkey_and_ps_suppkey_prf#3534 AS ps_partkey_and_ps_suppkey_prf_1#3541, rid#3535 AS rid_1#3542, ps_availqty_prf#3536 AS ps_availqty_prf_1#3543, ps_comment_prf#3537 AS ps_comment_prf_1#3544, ps_partkey_prf#3538 AS ps_partkey_prf_1#3545, ps_supplycost_prf#3539 AS ps_supplycost_prf_1#3546, ps_suppkey_prf#3540 AS ps_suppkey_prf_1#3547]
            :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#3534,rid#3535,ps_availqty_prf#3536,ps_comment_prf#3537,ps_partkey_prf#3538,ps_supplycost_prf#3539,ps_suppkey_prf#3540] JDBCRelation(partsupp_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3548, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3549]
            :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
            :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [p_comment_prf#3550 AS p_comment_prf_2#3560, p_name_prf#3551 AS p_name_prf_2#3561, rid#3552 AS rid_2#3562, p_type_prf#3553 AS p_type_prf_2#3563, p_retailprice_prf#3554 AS p_retailprice_prf_2#3564, p_mfgr_prf#3555 AS p_mfgr_prf_2#3565, p_container_prf#3556 AS p_container_prf_2#3566, p_brand_prf#3557 AS p_brand_prf_2#3567, p_size_prf#3558 AS p_size_prf_2#3568, p_partkey_prf#3559 AS p_partkey_prf_2#3569]
               +- Relation[p_comment_prf#3550,p_name_prf#3551,rid#3552,p_type_prf#3553,p_retailprice_prf#3554,p_mfgr_prf#3555,p_container_prf#3556,p_brand_prf#3557,p_size_prf#3558,p_partkey_prf#3559] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26148ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/12 18:32:24 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:32:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3607L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 18:32:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3607L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#3609 AS p_comment_prf_0#3619, p_name_prf#3610 AS p_name_prf_0#3620, rid#3611 AS rid_0#3621, p_type_prf#3612 AS p_type_prf_0#3622, p_retailprice_prf#3613 AS p_retailprice_prf_0#3623, p_mfgr_prf#3614 AS p_mfgr_prf_0#3624, p_container_prf#3615 AS p_container_prf_0#3625, p_brand_prf#3616 AS p_brand_prf_0#3626, p_size_prf#3617 AS p_size_prf_0#3627, p_partkey_prf#3618 AS p_partkey_prf_0#3628]
         :  +- Relation[p_comment_prf#3609,p_name_prf#3610,rid#3611,p_type_prf#3612,p_retailprice_prf#3613,p_mfgr_prf#3614,p_container_prf#3615,p_brand_prf#3616,p_size_prf#3617,p_partkey_prf#3618] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3629]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1602,value#1603] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1451
Elapsed time: 80ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/12 18:32:24 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:32:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3675L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 18:32:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3675L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [p_comment_prf#3677 AS p_comment_prf_0#3687, p_name_prf#3678 AS p_name_prf_0#3688, rid#3679 AS rid_0#3689, p_type_prf#3680 AS p_type_prf_0#3690, p_retailprice_prf#3681 AS p_retailprice_prf_0#3691, p_mfgr_prf#3682 AS p_mfgr_prf_0#3692, p_container_prf#3683 AS p_container_prf_0#3693, p_brand_prf#3684 AS p_brand_prf_0#3694, p_size_prf#3685 AS p_size_prf_0#3695, p_partkey_prf#3686 AS p_partkey_prf_0#3696]
         :  :  :  :  +- Relation[p_comment_prf#3677,p_name_prf#3678,rid#3679,p_type_prf#3680,p_retailprice_prf#3681,p_mfgr_prf#3682,p_container_prf#3683,p_brand_prf#3684,p_size_prf#3685,p_partkey_prf#3686] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3697, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3698]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :  :  :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#3699 AS l_returnflag_prf_1#3718, l_orderkey_and_l_linenumber_prf#3700 AS l_orderkey_and_l_linenumber_prf_1#3719, l_comment_prf#3701 AS l_comment_prf_1#3720, l_linestatus_prf#3702 AS l_linestatus_prf_1#3721, rid#3703 AS rid_1#3722, l_shipmode_prf#3704 AS l_shipmode_prf_1#3723, l_shipinstruct_prf#3705 AS l_shipinstruct_prf_1#3724, l_quantity_prf#3706 AS l_quantity_prf_1#3725, l_receiptdate_prf#3707 AS l_receiptdate_prf_1#3726, l_linenumber_prf#3708 AS l_linenumber_prf_1#3727, l_tax_prf#3709 AS l_tax_prf_1#3728, l_shipdate_prf#3710 AS l_shipdate_prf_1#3729, l_extendedprice_prf#3711 AS l_extendedprice_prf_1#3730, l_partkey_prf#3712 AS l_partkey_prf_1#3731, l_discount_prf#3713 AS l_discount_prf_1#3732, l_partkey_and_l_suppkey_prf#3714 AS l_partkey_and_l_suppkey_prf_1#3733, l_commitdate_prf#3715 AS l_commitdate_prf_1#3734, l_suppkey_prf#3716 AS l_suppkey_prf_1#3735, l_orderkey_prf#3717 AS l_orderkey_prf_1#3736]
         :  :     +- Relation[l_returnflag_prf#3699,l_orderkey_and_l_linenumber_prf#3700,l_comment_prf#3701,l_linestatus_prf#3702,rid#3703,l_shipmode_prf#3704,l_shipinstruct_prf#3705,l_quantity_prf#3706,l_receiptdate_prf#3707,l_linenumber_prf#3708,l_tax_prf#3709,l_shipdate_prf#3710,l_extendedprice_prf#3711,l_partkey_prf#3712,l_discount_prf#3713,l_partkey_and_l_suppkey_prf#3714,l_commitdate_prf#3715,l_suppkey_prf#3716,l_orderkey_prf#3717] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3737, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3738]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#3739 AS s_phone_prf_2#3747, rid#3740 AS rid_2#3748, s_address_prf#3741 AS s_address_prf_2#3749, s_nationkey_prf#3742 AS s_nationkey_prf_2#3750, s_suppkey_prf#3743 AS s_suppkey_prf_2#3751, s_name_prf#3744 AS s_name_prf_2#3752, s_acctbal_prf#3745 AS s_acctbal_prf_2#3753, s_comment_prf#3746 AS s_comment_prf_2#3754]
            +- Relation[s_phone_prf#3739,rid#3740,s_address_prf#3741,s_nationkey_prf#3742,s_suppkey_prf#3743,s_name_prf#3744,s_acctbal_prf#3745,s_comment_prf#3746] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201583ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/12 18:35:46 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:35:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3814L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 18:35:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3814L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [rid#3816 AS rid_0#3821, n_regionkey_prf#3817 AS n_regionkey_prf_0#3822, n_nationkey_prf#3818 AS n_nationkey_prf_0#3823, n_name_prf#3819 AS n_name_prf_0#3824, n_comment_prf#3820 AS n_comment_prf_0#3825]
         :  :  :  :  +- Relation[rid#3816,n_regionkey_prf#3817,n_nationkey_prf#3818,n_name_prf#3819,n_comment_prf#3820] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3826, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3827]
         :  :  :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :  :  :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#3828 AS s_phone_prf_1#3836, rid#3829 AS rid_1#3837, s_address_prf#3830 AS s_address_prf_1#3838, s_nationkey_prf#3831 AS s_nationkey_prf_1#3839, s_suppkey_prf#3832 AS s_suppkey_prf_1#3840, s_name_prf#3833 AS s_name_prf_1#3841, s_acctbal_prf#3834 AS s_acctbal_prf_1#3842, s_comment_prf#3835 AS s_comment_prf_1#3843]
         :  :     +- Relation[s_phone_prf#3828,rid#3829,s_address_prf#3830,s_nationkey_prf#3831,s_suppkey_prf#3832,s_name_prf#3833,s_acctbal_prf#3834,s_comment_prf#3835] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3844, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3845]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3846 AS c_acctbal_prf_2#3855, rid#3847 AS rid_2#3856, c_name_prf#3848 AS c_name_prf_2#3857, c_nationkey_prf#3849 AS c_nationkey_prf_2#3858, c_custkey_prf#3850 AS c_custkey_prf_2#3859, c_comment_prf#3851 AS c_comment_prf_2#3860, c_address_prf#3852 AS c_address_prf_2#3861, c_mktsegment_prf#3853 AS c_mktsegment_prf_2#3862, c_phone_prf#3854 AS c_phone_prf_2#3863]
            +- Relation[c_acctbal_prf#3846,rid#3847,c_name_prf#3848,c_nationkey_prf#3849,c_custkey_prf#3850,c_comment_prf#3851,c_address_prf#3852,c_mktsegment_prf#3853,c_phone_prf#3854] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 881741ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/12 18:50:28 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:50:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3906L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 18:50:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3906L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#3908 AS c_acctbal_prf_0#3917, rid#3909 AS rid_0#3918, c_name_prf#3910 AS c_name_prf_0#3919, c_nationkey_prf#3911 AS c_nationkey_prf_0#3920, c_custkey_prf#3912 AS c_custkey_prf_0#3921, c_comment_prf#3913 AS c_comment_prf_0#3922, c_address_prf#3914 AS c_address_prf_0#3923, c_mktsegment_prf#3915 AS c_mktsegment_prf_0#3924, c_phone_prf#3916 AS c_phone_prf_0#3925]
         :  :  +- Relation[c_acctbal_prf#3908,rid#3909,c_name_prf#3910,c_nationkey_prf#3911,c_custkey_prf#3912,c_comment_prf#3913,c_address_prf#3914,c_mktsegment_prf#3915,c_phone_prf#3916] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3926, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3927]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3928 AS o_shippriority_prf_1#3938, rid#3929 AS rid_1#3939, o_orderdate_prf#3930 AS o_orderdate_prf_1#3940, o_custkey_prf#3931 AS o_custkey_prf_1#3941, o_orderpriority_prf#3932 AS o_orderpriority_prf_1#3942, o_clerk_prf#3933 AS o_clerk_prf_1#3943, o_orderstatus_prf#3934 AS o_orderstatus_prf_1#3944, o_totalprice_prf#3935 AS o_totalprice_prf_1#3945, o_orderkey_prf#3936 AS o_orderkey_prf_1#3946, o_comment_prf#3937 AS o_comment_prf_1#3947]
            +- Relation[o_shippriority_prf#3928,rid#3929,o_orderdate_prf#3930,o_custkey_prf#3931,o_orderpriority_prf#3932,o_clerk_prf#3933,o_orderstatus_prf#3934,o_totalprice_prf#3935,o_orderkey_prf#3936,o_comment_prf#3937] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=1500000
Elapsed time: 23698ms

f1=
select * from region where r_name = 'EUROPE'
19/10/12 18:50:51 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:50:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3973L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/12 18:50:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3973L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#3975 AS r_regionkey_prf_0#3979, r_name_prf#3976 AS r_name_prf_0#3980, r_comment_prf#3977 AS r_comment_prf_0#3981, rid#3978 AS rid_0#3982]
         :  +- Relation[r_regionkey_prf#3975,r_name_prf#3976,r_comment_prf#3977,rid#3978] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3983]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1602,value#1603] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1
Elapsed time: 980ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/12 18:50:52 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:50:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4016L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 18:50:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4016L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [l_returnflag_prf#4018 AS l_returnflag_prf_0#4037, l_orderkey_and_l_linenumber_prf#4019 AS l_orderkey_and_l_linenumber_prf_0#4038, l_comment_prf#4020 AS l_comment_prf_0#4039, l_linestatus_prf#4021 AS l_linestatus_prf_0#4040, rid#4022 AS rid_0#4041, l_shipmode_prf#4023 AS l_shipmode_prf_0#4042, l_shipinstruct_prf#4024 AS l_shipinstruct_prf_0#4043, l_quantity_prf#4025 AS l_quantity_prf_0#4044, l_receiptdate_prf#4026 AS l_receiptdate_prf_0#4045, l_linenumber_prf#4027 AS l_linenumber_prf_0#4046, l_tax_prf#4028 AS l_tax_prf_0#4047, l_shipdate_prf#4029 AS l_shipdate_prf_0#4048, l_extendedprice_prf#4030 AS l_extendedprice_prf_0#4049, l_partkey_prf#4031 AS l_partkey_prf_0#4050, l_discount_prf#4032 AS l_discount_prf_0#4051, l_partkey_and_l_suppkey_prf#4033 AS l_partkey_and_l_suppkey_prf_0#4052, l_commitdate_prf#4034 AS l_commitdate_prf_0#4053, l_suppkey_prf#4035 AS l_suppkey_prf_0#4054, l_orderkey_prf#4036 AS l_orderkey_prf_0#4055]
         :  :  :  +- Relation[l_returnflag_prf#4018,l_orderkey_and_l_linenumber_prf#4019,l_comment_prf#4020,l_linestatus_prf#4021,rid#4022,l_shipmode_prf#4023,l_shipinstruct_prf#4024,l_quantity_prf#4025,l_receiptdate_prf#4026,l_linenumber_prf#4027,l_tax_prf#4028,l_shipdate_prf#4029,l_extendedprice_prf#4030,l_partkey_prf#4031,l_discount_prf#4032,l_partkey_and_l_suppkey_prf#4033,l_commitdate_prf#4034,l_suppkey_prf#4035,l_orderkey_prf#4036] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4056]
         :  :     +- DexRidFilter lineitem~l_returnflag~R
         :  :        +- Relation[label#1602,value#1603] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4057, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4058]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4059 AS o_shippriority_prf_1#4069, rid#4060 AS rid_1#4070, o_orderdate_prf#4061 AS o_orderdate_prf_1#4071, o_custkey_prf#4062 AS o_custkey_prf_1#4072, o_orderpriority_prf#4063 AS o_orderpriority_prf_1#4073, o_clerk_prf#4064 AS o_clerk_prf_1#4074, o_orderstatus_prf#4065 AS o_orderstatus_prf_1#4075, o_totalprice_prf#4066 AS o_totalprice_prf_1#4076, o_orderkey_prf#4067 AS o_orderkey_prf_1#4077, o_comment_prf#4068 AS o_comment_prf_1#4078]
            +- Relation[o_shippriority_prf#4059,rid#4060,o_orderdate_prf#4061,o_custkey_prf#4062,o_orderpriority_prf#4063,o_clerk_prf#4064,o_orderstatus_prf#4065,o_totalprice_prf#4066,o_orderkey_prf#4067,o_comment_prf#4068] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 97651ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/12 18:52:30 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:52:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4123L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 18:52:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4123L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [rid#4125 AS rid_0#4130, n_regionkey_prf#4126 AS n_regionkey_prf_0#4131, n_nationkey_prf#4127 AS n_nationkey_prf_0#4132, n_name_prf#4128 AS n_name_prf_0#4133, n_comment_prf#4129 AS n_comment_prf_0#4134]
         :  :  +- Relation[rid#4125,n_regionkey_prf#4126,n_nationkey_prf#4127,n_name_prf#4128,n_comment_prf#4129] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4135, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4136]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4137 AS c_acctbal_prf_1#4146, rid#4138 AS rid_1#4147, c_name_prf#4139 AS c_name_prf_1#4148, c_nationkey_prf#4140 AS c_nationkey_prf_1#4149, c_custkey_prf#4141 AS c_custkey_prf_1#4150, c_comment_prf#4142 AS c_comment_prf_1#4151, c_address_prf#4143 AS c_address_prf_1#4152, c_mktsegment_prf#4144 AS c_mktsegment_prf_1#4153, c_phone_prf#4145 AS c_phone_prf_1#4154]
            +- Relation[c_acctbal_prf#4137,rid#4138,c_name_prf#4139,c_nationkey_prf#4140,c_custkey_prf#4141,c_comment_prf#4142,c_address_prf#4143,c_mktsegment_prf#4144,c_phone_prf#4145] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=150000
Elapsed time: 2523ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/12 18:52:33 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:52:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4193L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 18:52:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4193L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4195 AS s_phone_prf_0#4203, rid#4196 AS rid_0#4204, s_address_prf#4197 AS s_address_prf_0#4205, s_nationkey_prf#4198 AS s_nationkey_prf_0#4206, s_suppkey_prf#4199 AS s_suppkey_prf_0#4207, s_name_prf#4200 AS s_name_prf_0#4208, s_acctbal_prf#4201 AS s_acctbal_prf_0#4209, s_comment_prf#4202 AS s_comment_prf_0#4210]
         :  :  +- Relation[s_phone_prf#4195,rid#4196,s_address_prf#4197,s_nationkey_prf#4198,s_suppkey_prf#4199,s_name_prf#4200,s_acctbal_prf#4201,s_comment_prf#4202] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4211, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4212]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [p_comment_prf#4213 AS p_comment_prf_1#4223, p_name_prf#4214 AS p_name_prf_1#4224, rid#4215 AS rid_1#4225, p_type_prf#4216 AS p_type_prf_1#4226, p_retailprice_prf#4217 AS p_retailprice_prf_1#4227, p_mfgr_prf#4218 AS p_mfgr_prf_1#4228, p_container_prf#4219 AS p_container_prf_1#4229, p_brand_prf#4220 AS p_brand_prf_1#4230, p_size_prf#4221 AS p_size_prf_1#4231, p_partkey_prf#4222 AS p_partkey_prf_1#4232]
            :  :  +- Relation[p_comment_prf#4213,p_name_prf#4214,rid#4215,p_type_prf#4216,p_retailprice_prf#4217,p_mfgr_prf#4218,p_container_prf#4219,p_brand_prf#4220,p_size_prf#4221,p_partkey_prf#4222] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4233, dexdecrypt('value_dec_key, 'value_right) AS rid_2#4234]
            :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
            :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#4235 AS ps_partkey_and_ps_suppkey_prf_2#4242, rid#4236 AS rid_2#4243, ps_availqty_prf#4237 AS ps_availqty_prf_2#4244, ps_comment_prf#4238 AS ps_comment_prf_2#4245, ps_partkey_prf#4239 AS ps_partkey_prf_2#4246, ps_supplycost_prf#4240 AS ps_supplycost_prf_2#4247, ps_suppkey_prf#4241 AS ps_suppkey_prf_2#4248]
               +- Relation[ps_partkey_and_ps_suppkey_prf#4235,rid#4236,ps_availqty_prf#4237,ps_comment_prf#4238,ps_partkey_prf#4239,ps_supplycost_prf#4240,ps_suppkey_prf#4241] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26237ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/12 18:52:59 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 18:52:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4296L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 18:52:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4296L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [s_phone_prf#4298 AS s_phone_prf_0#4306, rid#4299 AS rid_0#4307, s_address_prf#4300 AS s_address_prf_0#4308, s_nationkey_prf#4301 AS s_nationkey_prf_0#4309, s_suppkey_prf#4302 AS s_suppkey_prf_0#4310, s_name_prf#4303 AS s_name_prf_0#4311, s_acctbal_prf#4304 AS s_acctbal_prf_0#4312, s_comment_prf#4305 AS s_comment_prf_0#4313]
         :  :  :  :  +- Relation[s_phone_prf#4298,rid#4299,s_address_prf#4300,s_nationkey_prf#4301,s_suppkey_prf#4302,s_name_prf#4303,s_acctbal_prf#4304,s_comment_prf#4305] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4314, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4315]
         :  :  :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :  :  :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [rid#4316 AS rid_1#4321, n_regionkey_prf#4317 AS n_regionkey_prf_1#4322, n_nationkey_prf#4318 AS n_nationkey_prf_1#4323, n_name_prf#4319 AS n_name_prf_1#4324, n_comment_prf#4320 AS n_comment_prf_1#4325]
         :  :     +- Relation[rid#4316,n_regionkey_prf#4317,n_nationkey_prf#4318,n_name_prf#4319,n_comment_prf#4320] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4326, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4327]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4328 AS c_acctbal_prf_2#4337, rid#4329 AS rid_2#4338, c_name_prf#4330 AS c_name_prf_2#4339, c_nationkey_prf#4331 AS c_nationkey_prf_2#4340, c_custkey_prf#4332 AS c_custkey_prf_2#4341, c_comment_prf#4333 AS c_comment_prf_2#4342, c_address_prf#4334 AS c_address_prf_2#4343, c_mktsegment_prf#4335 AS c_mktsegment_prf_2#4344, c_phone_prf#4336 AS c_phone_prf_2#4345]
            +- Relation[c_acctbal_prf#4328,rid#4329,c_name_prf#4330,c_nationkey_prf#4331,c_custkey_prf#4332,c_comment_prf#4333,c_address_prf#4334,c_mktsegment_prf#4335,c_phone_prf#4336] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 877020ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/12 19:07:36 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 19:07:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4404L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 19:07:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4404L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [c_acctbal_prf#4406 AS c_acctbal_prf_0#4415, rid#4407 AS rid_0#4416, c_name_prf#4408 AS c_name_prf_0#4417, c_nationkey_prf#4409 AS c_nationkey_prf_0#4418, c_custkey_prf#4410 AS c_custkey_prf_0#4419, c_comment_prf#4411 AS c_comment_prf_0#4420, c_address_prf#4412 AS c_address_prf_0#4421, c_mktsegment_prf#4413 AS c_mktsegment_prf_0#4422, c_phone_prf#4414 AS c_phone_prf_0#4423]
         :  :  :  :  +- Relation[c_acctbal_prf#4406,rid#4407,c_name_prf#4408,c_nationkey_prf#4409,c_custkey_prf#4410,c_comment_prf#4411,c_address_prf#4412,c_mktsegment_prf#4413,c_phone_prf#4414] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4424, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4425]
         :  :  :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :  :  :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#4426 AS o_shippriority_prf_1#4436, rid#4427 AS rid_1#4437, o_orderdate_prf#4428 AS o_orderdate_prf_1#4438, o_custkey_prf#4429 AS o_custkey_prf_1#4439, o_orderpriority_prf#4430 AS o_orderpriority_prf_1#4440, o_clerk_prf#4431 AS o_clerk_prf_1#4441, o_orderstatus_prf#4432 AS o_orderstatus_prf_1#4442, o_totalprice_prf#4433 AS o_totalprice_prf_1#4443, o_orderkey_prf#4434 AS o_orderkey_prf_1#4444, o_comment_prf#4435 AS o_comment_prf_1#4445]
         :  :     +- Relation[o_shippriority_prf#4426,rid#4427,o_orderdate_prf#4428,o_custkey_prf#4429,o_orderpriority_prf#4430,o_clerk_prf#4431,o_orderstatus_prf#4432,o_totalprice_prf#4433,o_orderkey_prf#4434,o_comment_prf#4435] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4446, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4447]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4448 AS l_returnflag_prf_2#4467, l_orderkey_and_l_linenumber_prf#4449 AS l_orderkey_and_l_linenumber_prf_2#4468, l_comment_prf#4450 AS l_comment_prf_2#4469, l_linestatus_prf#4451 AS l_linestatus_prf_2#4470, rid#4452 AS rid_2#4471, l_shipmode_prf#4453 AS l_shipmode_prf_2#4472, l_shipinstruct_prf#4454 AS l_shipinstruct_prf_2#4473, l_quantity_prf#4455 AS l_quantity_prf_2#4474, l_receiptdate_prf#4456 AS l_receiptdate_prf_2#4475, l_linenumber_prf#4457 AS l_linenumber_prf_2#4476, l_tax_prf#4458 AS l_tax_prf_2#4477, l_shipdate_prf#4459 AS l_shipdate_prf_2#4478, l_extendedprice_prf#4460 AS l_extendedprice_prf_2#4479, l_partkey_prf#4461 AS l_partkey_prf_2#4480, l_discount_prf#4462 AS l_discount_prf_2#4481, l_partkey_and_l_suppkey_prf#4463 AS l_partkey_and_l_suppkey_prf_2#4482, l_commitdate_prf#4464 AS l_commitdate_prf_2#4483, l_suppkey_prf#4465 AS l_suppkey_prf_2#4484, l_orderkey_prf#4466 AS l_orderkey_prf_2#4485]
            +- Relation[l_returnflag_prf#4448,l_orderkey_and_l_linenumber_prf#4449,l_comment_prf#4450,l_linestatus_prf#4451,rid#4452,l_shipmode_prf#4453,l_shipinstruct_prf#4454,l_quantity_prf#4455,l_receiptdate_prf#4456,l_linenumber_prf#4457,l_tax_prf#4458,l_shipdate_prf#4459,l_extendedprice_prf#4460,l_partkey_prf#4461,l_discount_prf#4462,l_partkey_and_l_suppkey_prf#4463,l_commitdate_prf#4464,l_suppkey_prf#4465,l_orderkey_prf#4466] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 169119ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/12 19:10:25 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 19:10:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4560L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 19:10:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4560L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#4562 AS c_acctbal_prf_0#4571, rid#4563 AS rid_0#4572, c_name_prf#4564 AS c_name_prf_0#4573, c_nationkey_prf#4565 AS c_nationkey_prf_0#4574, c_custkey_prf#4566 AS c_custkey_prf_0#4575, c_comment_prf#4567 AS c_comment_prf_0#4576, c_address_prf#4568 AS c_address_prf_0#4577, c_mktsegment_prf#4569 AS c_mktsegment_prf_0#4578, c_phone_prf#4570 AS c_phone_prf_0#4579]
         :  :  +- Relation[c_acctbal_prf#4562,rid#4563,c_name_prf#4564,c_nationkey_prf#4565,c_custkey_prf#4566,c_comment_prf#4567,c_address_prf#4568,c_mktsegment_prf#4569,c_phone_prf#4570] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4580, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4581]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [o_shippriority_prf#4582 AS o_shippriority_prf_1#4592, rid#4583 AS rid_1#4593, o_orderdate_prf#4584 AS o_orderdate_prf_1#4594, o_custkey_prf#4585 AS o_custkey_prf_1#4595, o_orderpriority_prf#4586 AS o_orderpriority_prf_1#4596, o_clerk_prf#4587 AS o_clerk_prf_1#4597, o_orderstatus_prf#4588 AS o_orderstatus_prf_1#4598, o_totalprice_prf#4589 AS o_totalprice_prf_1#4599, o_orderkey_prf#4590 AS o_orderkey_prf_1#4600, o_comment_prf#4591 AS o_comment_prf_1#4601]
            :  :  +- Relation[o_shippriority_prf#4582,rid#4583,o_orderdate_prf#4584,o_custkey_prf#4585,o_orderpriority_prf#4586,o_clerk_prf#4587,o_orderstatus_prf#4588,o_totalprice_prf#4589,o_orderkey_prf#4590,o_comment_prf#4591] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4602, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4603]
            :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
            :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4604 AS l_returnflag_prf_2#4623, l_orderkey_and_l_linenumber_prf#4605 AS l_orderkey_and_l_linenumber_prf_2#4624, l_comment_prf#4606 AS l_comment_prf_2#4625, l_linestatus_prf#4607 AS l_linestatus_prf_2#4626, rid#4608 AS rid_2#4627, l_shipmode_prf#4609 AS l_shipmode_prf_2#4628, l_shipinstruct_prf#4610 AS l_shipinstruct_prf_2#4629, l_quantity_prf#4611 AS l_quantity_prf_2#4630, l_receiptdate_prf#4612 AS l_receiptdate_prf_2#4631, l_linenumber_prf#4613 AS l_linenumber_prf_2#4632, l_tax_prf#4614 AS l_tax_prf_2#4633, l_shipdate_prf#4615 AS l_shipdate_prf_2#4634, l_extendedprice_prf#4616 AS l_extendedprice_prf_2#4635, l_partkey_prf#4617 AS l_partkey_prf_2#4636, l_discount_prf#4618 AS l_discount_prf_2#4637, l_partkey_and_l_suppkey_prf#4619 AS l_partkey_and_l_suppkey_prf_2#4638, l_commitdate_prf#4620 AS l_commitdate_prf_2#4639, l_suppkey_prf#4621 AS l_suppkey_prf_2#4640, l_orderkey_prf#4622 AS l_orderkey_prf_2#4641]
               +- Relation[l_returnflag_prf#4604,l_orderkey_and_l_linenumber_prf#4605,l_comment_prf#4606,l_linestatus_prf#4607,rid#4608,l_shipmode_prf#4609,l_shipinstruct_prf#4610,l_quantity_prf#4611,l_receiptdate_prf#4612,l_linenumber_prf#4613,l_tax_prf#4614,l_shipdate_prf#4615,l_extendedprice_prf#4616,l_partkey_prf#4617,l_discount_prf#4618,l_partkey_and_l_suppkey_prf#4619,l_commitdate_prf#4620,l_suppkey_prf#4621,l_orderkey_prf#4622] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 169730ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/12 19:13:15 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 19:13:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4706L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 19:13:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4706L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4708 AS s_phone_prf_0#4716, rid#4709 AS rid_0#4717, s_address_prf#4710 AS s_address_prf_0#4718, s_nationkey_prf#4711 AS s_nationkey_prf_0#4719, s_suppkey_prf#4712 AS s_suppkey_prf_0#4720, s_name_prf#4713 AS s_name_prf_0#4721, s_acctbal_prf#4714 AS s_acctbal_prf_0#4722, s_comment_prf#4715 AS s_comment_prf_0#4723]
         :  :  +- Relation[s_phone_prf#4708,rid#4709,s_address_prf#4710,s_nationkey_prf#4711,s_suppkey_prf#4712,s_name_prf#4713,s_acctbal_prf#4714,s_comment_prf#4715] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4724, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4725]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4726 AS l_returnflag_prf_1#4745, l_orderkey_and_l_linenumber_prf#4727 AS l_orderkey_and_l_linenumber_prf_1#4746, l_comment_prf#4728 AS l_comment_prf_1#4747, l_linestatus_prf#4729 AS l_linestatus_prf_1#4748, rid#4730 AS rid_1#4749, l_shipmode_prf#4731 AS l_shipmode_prf_1#4750, l_shipinstruct_prf#4732 AS l_shipinstruct_prf_1#4751, l_quantity_prf#4733 AS l_quantity_prf_1#4752, l_receiptdate_prf#4734 AS l_receiptdate_prf_1#4753, l_linenumber_prf#4735 AS l_linenumber_prf_1#4754, l_tax_prf#4736 AS l_tax_prf_1#4755, l_shipdate_prf#4737 AS l_shipdate_prf_1#4756, l_extendedprice_prf#4738 AS l_extendedprice_prf_1#4757, l_partkey_prf#4739 AS l_partkey_prf_1#4758, l_discount_prf#4740 AS l_discount_prf_1#4759, l_partkey_and_l_suppkey_prf#4741 AS l_partkey_and_l_suppkey_prf_1#4760, l_commitdate_prf#4742 AS l_commitdate_prf_1#4761, l_suppkey_prf#4743 AS l_suppkey_prf_1#4762, l_orderkey_prf#4744 AS l_orderkey_prf_1#4763]
            +- Relation[l_returnflag_prf#4726,l_orderkey_and_l_linenumber_prf#4727,l_comment_prf#4728,l_linestatus_prf#4729,rid#4730,l_shipmode_prf#4731,l_shipinstruct_prf#4732,l_quantity_prf#4733,l_receiptdate_prf#4734,l_linenumber_prf#4735,l_tax_prf#4736,l_shipdate_prf#4737,l_extendedprice_prf#4738,l_partkey_prf#4739,l_discount_prf#4740,l_partkey_and_l_suppkey_prf#4741,l_commitdate_prf#4742,l_suppkey_prf#4743,l_orderkey_prf#4744] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 90511ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/12 19:14:45 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 19:14:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4801L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 19:14:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4801L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [r_regionkey_prf#4803 AS r_regionkey_prf_0#4807, r_name_prf#4804 AS r_name_prf_0#4808, r_comment_prf#4805 AS r_comment_prf_0#4809, rid#4806 AS rid_0#4810]
         :  :  +- Relation[r_regionkey_prf#4803,r_name_prf#4804,r_comment_prf#4805,rid#4806] JDBCRelation(region_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4811, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4812]
         :     +- SpxRidUncorrelatedJoin nation~n_regionkey~region~r_regionkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [rid#4813 AS rid_1#4818, n_regionkey_prf#4814 AS n_regionkey_prf_1#4819, n_nationkey_prf#4815 AS n_nationkey_prf_1#4820, n_name_prf#4816 AS n_name_prf_1#4821, n_comment_prf#4817 AS n_comment_prf_1#4822]
            +- Relation[rid#4813,n_regionkey_prf#4814,n_nationkey_prf#4815,n_name_prf#4816,n_comment_prf#4817] JDBCRelation(nation_prf) [numPartitions=1]

DexSpx$ result size=25
Elapsed time: 72ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/12 19:14:45 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 19:14:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4846L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 19:14:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4846L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [rid#4848 AS rid_0#4853, n_regionkey_prf#4849 AS n_regionkey_prf_0#4854, n_nationkey_prf#4850 AS n_nationkey_prf_0#4855, n_name_prf#4851 AS n_name_prf_0#4856, n_comment_prf#4852 AS n_comment_prf_0#4857]
         :  :  +- Relation[rid#4848,n_regionkey_prf#4849,n_nationkey_prf#4850,n_name_prf#4851,n_comment_prf#4852] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4858, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4859]
         :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#4860 AS s_phone_prf_1#4868, rid#4861 AS rid_1#4869, s_address_prf#4862 AS s_address_prf_1#4870, s_nationkey_prf#4863 AS s_nationkey_prf_1#4871, s_suppkey_prf#4864 AS s_suppkey_prf_1#4872, s_name_prf#4865 AS s_name_prf_1#4873, s_acctbal_prf#4866 AS s_acctbal_prf_1#4874, s_comment_prf#4867 AS s_comment_prf_1#4875]
            +- Relation[s_phone_prf#4860,rid#4861,s_address_prf#4862,s_nationkey_prf#4863,s_suppkey_prf#4864,s_name_prf#4865,s_acctbal_prf#4866,s_comment_prf#4867] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=10000
Elapsed time: 223ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/12 19:14:45 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 19:14:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4924L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 19:14:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4924L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4926 AS s_phone_prf_0#4934, rid#4927 AS rid_0#4935, s_address_prf#4928 AS s_address_prf_0#4936, s_nationkey_prf#4929 AS s_nationkey_prf_0#4937, s_suppkey_prf#4930 AS s_suppkey_prf_0#4938, s_name_prf#4931 AS s_name_prf_0#4939, s_acctbal_prf#4932 AS s_acctbal_prf_0#4940, s_comment_prf#4933 AS s_comment_prf_0#4941]
         :  :  +- Relation[s_phone_prf#4926,rid#4927,s_address_prf#4928,s_nationkey_prf#4929,s_suppkey_prf#4930,s_name_prf#4931,s_acctbal_prf#4932,s_comment_prf#4933] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4942, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4943]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [p_comment_prf#4944 AS p_comment_prf_1#4954, p_name_prf#4945 AS p_name_prf_1#4955, rid#4946 AS rid_1#4956, p_type_prf#4947 AS p_type_prf_1#4957, p_retailprice_prf#4948 AS p_retailprice_prf_1#4958, p_mfgr_prf#4949 AS p_mfgr_prf_1#4959, p_container_prf#4950 AS p_container_prf_1#4960, p_brand_prf#4951 AS p_brand_prf_1#4961, p_size_prf#4952 AS p_size_prf_1#4962, p_partkey_prf#4953 AS p_partkey_prf_1#4963]
            :  :  +- Relation[p_comment_prf#4944,p_name_prf#4945,rid#4946,p_type_prf#4947,p_retailprice_prf#4948,p_mfgr_prf#4949,p_container_prf#4950,p_brand_prf#4951,p_size_prf#4952,p_partkey_prf#4953] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4964, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4965]
            :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
            :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4966 AS l_returnflag_prf_2#4985, l_orderkey_and_l_linenumber_prf#4967 AS l_orderkey_and_l_linenumber_prf_2#4986, l_comment_prf#4968 AS l_comment_prf_2#4987, l_linestatus_prf#4969 AS l_linestatus_prf_2#4988, rid#4970 AS rid_2#4989, l_shipmode_prf#4971 AS l_shipmode_prf_2#4990, l_shipinstruct_prf#4972 AS l_shipinstruct_prf_2#4991, l_quantity_prf#4973 AS l_quantity_prf_2#4992, l_receiptdate_prf#4974 AS l_receiptdate_prf_2#4993, l_linenumber_prf#4975 AS l_linenumber_prf_2#4994, l_tax_prf#4976 AS l_tax_prf_2#4995, l_shipdate_prf#4977 AS l_shipdate_prf_2#4996, l_extendedprice_prf#4978 AS l_extendedprice_prf_2#4997, l_partkey_prf#4979 AS l_partkey_prf_2#4998, l_discount_prf#4980 AS l_discount_prf_2#4999, l_partkey_and_l_suppkey_prf#4981 AS l_partkey_and_l_suppkey_prf_2#5000, l_commitdate_prf#4982 AS l_commitdate_prf_2#5001, l_suppkey_prf#4983 AS l_suppkey_prf_2#5002, l_orderkey_prf#4984 AS l_orderkey_prf_2#5003]
               +- Relation[l_returnflag_prf#4966,l_orderkey_and_l_linenumber_prf#4967,l_comment_prf#4968,l_linestatus_prf#4969,rid#4970,l_shipmode_prf#4971,l_shipinstruct_prf#4972,l_quantity_prf#4973,l_receiptdate_prf#4974,l_linenumber_prf#4975,l_tax_prf#4976,l_shipdate_prf#4977,l_extendedprice_prf#4978,l_partkey_prf#4979,l_discount_prf#4980,l_partkey_and_l_suppkey_prf#4981,l_commitdate_prf#4982,l_suppkey_prf#4983,l_orderkey_prf#4984] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201798ms

f2=
select * from part where p_size = 15
19/10/12 19:18:07 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 19:18:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5053L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 19:18:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5053L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#5055 AS p_comment_prf_0#5065, p_name_prf#5056 AS p_name_prf_0#5066, rid#5057 AS rid_0#5067, p_type_prf#5058 AS p_type_prf_0#5068, p_retailprice_prf#5059 AS p_retailprice_prf_0#5069, p_mfgr_prf#5060 AS p_mfgr_prf_0#5070, p_container_prf#5061 AS p_container_prf_0#5071, p_brand_prf#5062 AS p_brand_prf_0#5072, p_size_prf#5063 AS p_size_prf_0#5073, p_partkey_prf#5064 AS p_partkey_prf_0#5074]
         :  +- Relation[p_comment_prf#5055,p_name_prf#5056,rid#5057,p_type_prf#5058,p_retailprice_prf#5059,p_mfgr_prf#5060,p_container_prf#5061,p_brand_prf#5062,p_size_prf#5063,p_partkey_prf#5064] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5075]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1602,value#1603] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=3907
Elapsed time: 121ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/12 19:18:07 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 19:18:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5114L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 19:18:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5114L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [o_shippriority_prf#5116 AS o_shippriority_prf_0#5126, rid#5117 AS rid_0#5127, o_orderdate_prf#5118 AS o_orderdate_prf_0#5128, o_custkey_prf#5119 AS o_custkey_prf_0#5129, o_orderpriority_prf#5120 AS o_orderpriority_prf_0#5130, o_clerk_prf#5121 AS o_clerk_prf_0#5131, o_orderstatus_prf#5122 AS o_orderstatus_prf_0#5132, o_totalprice_prf#5123 AS o_totalprice_prf_0#5133, o_orderkey_prf#5124 AS o_orderkey_prf_0#5134, o_comment_prf#5125 AS o_comment_prf_0#5135]
         :  :  +- Relation[o_shippriority_prf#5116,rid#5117,o_orderdate_prf#5118,o_custkey_prf#5119,o_orderpriority_prf#5120,o_clerk_prf#5121,o_orderstatus_prf#5122,o_totalprice_prf#5123,o_orderkey_prf#5124,o_comment_prf#5125] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#5136, dexdecrypt('value_dec_key, 'value_right) AS rid_0#5137]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#5138 AS l_returnflag_prf_1#5157, l_orderkey_and_l_linenumber_prf#5139 AS l_orderkey_and_l_linenumber_prf_1#5158, l_comment_prf#5140 AS l_comment_prf_1#5159, l_linestatus_prf#5141 AS l_linestatus_prf_1#5160, rid#5142 AS rid_1#5161, l_shipmode_prf#5143 AS l_shipmode_prf_1#5162, l_shipinstruct_prf#5144 AS l_shipinstruct_prf_1#5163, l_quantity_prf#5145 AS l_quantity_prf_1#5164, l_receiptdate_prf#5146 AS l_receiptdate_prf_1#5165, l_linenumber_prf#5147 AS l_linenumber_prf_1#5166, l_tax_prf#5148 AS l_tax_prf_1#5167, l_shipdate_prf#5149 AS l_shipdate_prf_1#5168, l_extendedprice_prf#5150 AS l_extendedprice_prf_1#5169, l_partkey_prf#5151 AS l_partkey_prf_1#5170, l_discount_prf#5152 AS l_discount_prf_1#5171, l_partkey_and_l_suppkey_prf#5153 AS l_partkey_and_l_suppkey_prf_1#5172, l_commitdate_prf#5154 AS l_commitdate_prf_1#5173, l_suppkey_prf#5155 AS l_suppkey_prf_1#5174, l_orderkey_prf#5156 AS l_orderkey_prf_1#5175]
            :  +- Relation[l_returnflag_prf#5138,l_orderkey_and_l_linenumber_prf#5139,l_comment_prf#5140,l_linestatus_prf#5141,rid#5142,l_shipmode_prf#5143,l_shipinstruct_prf#5144,l_quantity_prf#5145,l_receiptdate_prf#5146,l_linenumber_prf#5147,l_tax_prf#5148,l_shipdate_prf#5149,l_extendedprice_prf#5150,l_partkey_prf#5151,l_discount_prf#5152,l_partkey_and_l_suppkey_prf#5153,l_commitdate_prf#5154,l_suppkey_prf#5155,l_orderkey_prf#5156] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5176]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1602,value#1603] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 98791ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/12 19:19:46 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 19:19:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5230L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 19:19:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5230L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [ps_partkey_and_ps_suppkey_prf#5232 AS ps_partkey_and_ps_suppkey_prf_0#5239, rid#5233 AS rid_0#5240, ps_availqty_prf#5234 AS ps_availqty_prf_0#5241, ps_comment_prf#5235 AS ps_comment_prf_0#5242, ps_partkey_prf#5236 AS ps_partkey_prf_0#5243, ps_supplycost_prf#5237 AS ps_supplycost_prf_0#5244, ps_suppkey_prf#5238 AS ps_suppkey_prf_0#5245]
         :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#5232,rid#5233,ps_availqty_prf#5234,ps_comment_prf#5235,ps_partkey_prf#5236,ps_supplycost_prf#5237,ps_suppkey_prf#5238] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#5246, dexdecrypt('value_dec_key, 'value_right) AS rid_0#5247]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey_and_l_suppkey~partsupp~ps_partkey_and_ps_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5248 AS l_returnflag_prf_1#5267, l_orderkey_and_l_linenumber_prf#5249 AS l_orderkey_and_l_linenumber_prf_1#5268, l_comment_prf#5250 AS l_comment_prf_1#5269, l_linestatus_prf#5251 AS l_linestatus_prf_1#5270, rid#5252 AS rid_1#5271, l_shipmode_prf#5253 AS l_shipmode_prf_1#5272, l_shipinstruct_prf#5254 AS l_shipinstruct_prf_1#5273, l_quantity_prf#5255 AS l_quantity_prf_1#5274, l_receiptdate_prf#5256 AS l_receiptdate_prf_1#5275, l_linenumber_prf#5257 AS l_linenumber_prf_1#5276, l_tax_prf#5258 AS l_tax_prf_1#5277, l_shipdate_prf#5259 AS l_shipdate_prf_1#5278, l_extendedprice_prf#5260 AS l_extendedprice_prf_1#5279, l_partkey_prf#5261 AS l_partkey_prf_1#5280, l_discount_prf#5262 AS l_discount_prf_1#5281, l_partkey_and_l_suppkey_prf#5263 AS l_partkey_and_l_suppkey_prf_1#5282, l_commitdate_prf#5264 AS l_commitdate_prf_1#5283, l_suppkey_prf#5265 AS l_suppkey_prf_1#5284, l_orderkey_prf#5266 AS l_orderkey_prf_1#5285]
            +- Relation[l_returnflag_prf#5248,l_orderkey_and_l_linenumber_prf#5249,l_comment_prf#5250,l_linestatus_prf#5251,rid#5252,l_shipmode_prf#5253,l_shipinstruct_prf#5254,l_quantity_prf#5255,l_receiptdate_prf#5256,l_linenumber_prf#5257,l_tax_prf#5258,l_shipdate_prf#5259,l_extendedprice_prf#5260,l_partkey_prf#5261,l_discount_prf#5262,l_partkey_and_l_suppkey_prf#5263,l_commitdate_prf#5264,l_suppkey_prf#5265,l_orderkey_prf#5266] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 105484ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/12 19:21:32 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 19:21:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5348L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 19:21:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5348L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#5350 AS l_returnflag_prf_0#5369, l_orderkey_and_l_linenumber_prf#5351 AS l_orderkey_and_l_linenumber_prf_0#5370, l_comment_prf#5352 AS l_comment_prf_0#5371, l_linestatus_prf#5353 AS l_linestatus_prf_0#5372, rid#5354 AS rid_0#5373, l_shipmode_prf#5355 AS l_shipmode_prf_0#5374, l_shipinstruct_prf#5356 AS l_shipinstruct_prf_0#5375, l_quantity_prf#5357 AS l_quantity_prf_0#5376, l_receiptdate_prf#5358 AS l_receiptdate_prf_0#5377, l_linenumber_prf#5359 AS l_linenumber_prf_0#5378, l_tax_prf#5360 AS l_tax_prf_0#5379, l_shipdate_prf#5361 AS l_shipdate_prf_0#5380, l_extendedprice_prf#5362 AS l_extendedprice_prf_0#5381, l_partkey_prf#5363 AS l_partkey_prf_0#5382, l_discount_prf#5364 AS l_discount_prf_0#5383, l_partkey_and_l_suppkey_prf#5365 AS l_partkey_and_l_suppkey_prf_0#5384, l_commitdate_prf#5366 AS l_commitdate_prf_0#5385, l_suppkey_prf#5367 AS l_suppkey_prf_0#5386, l_orderkey_prf#5368 AS l_orderkey_prf_0#5387]
         :  :  +- Relation[l_returnflag_prf#5350,l_orderkey_and_l_linenumber_prf#5351,l_comment_prf#5352,l_linestatus_prf#5353,rid#5354,l_shipmode_prf#5355,l_shipinstruct_prf#5356,l_quantity_prf#5357,l_receiptdate_prf#5358,l_linenumber_prf#5359,l_tax_prf#5360,l_shipdate_prf#5361,l_extendedprice_prf#5362,l_partkey_prf#5363,l_discount_prf#5364,l_partkey_and_l_suppkey_prf#5365,l_commitdate_prf#5366,l_suppkey_prf#5367,l_orderkey_prf#5368] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5388, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5389]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [o_shippriority_prf#5390 AS o_shippriority_prf_1#5400, rid#5391 AS rid_1#5401, o_orderdate_prf#5392 AS o_orderdate_prf_1#5402, o_custkey_prf#5393 AS o_custkey_prf_1#5403, o_orderpriority_prf#5394 AS o_orderpriority_prf_1#5404, o_clerk_prf#5395 AS o_clerk_prf_1#5405, o_orderstatus_prf#5396 AS o_orderstatus_prf_1#5406, o_totalprice_prf#5397 AS o_totalprice_prf_1#5407, o_orderkey_prf#5398 AS o_orderkey_prf_1#5408, o_comment_prf#5399 AS o_comment_prf_1#5409]
            :  :  +- Relation[o_shippriority_prf#5390,rid#5391,o_orderdate_prf#5392,o_custkey_prf#5393,o_orderpriority_prf#5394,o_clerk_prf#5395,o_orderstatus_prf#5396,o_totalprice_prf#5397,o_orderkey_prf#5398,o_comment_prf#5399] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#5410, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5411]
            :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
            :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#5412 AS c_acctbal_prf_2#5421, rid#5413 AS rid_2#5422, c_name_prf#5414 AS c_name_prf_2#5423, c_nationkey_prf#5415 AS c_nationkey_prf_2#5424, c_custkey_prf#5416 AS c_custkey_prf_2#5425, c_comment_prf#5417 AS c_comment_prf_2#5426, c_address_prf#5418 AS c_address_prf_2#5427, c_mktsegment_prf#5419 AS c_mktsegment_prf_2#5428, c_phone_prf#5420 AS c_phone_prf_2#5429]
               +- Relation[c_acctbal_prf#5412,rid#5413,c_name_prf#5414,c_nationkey_prf#5415,c_custkey_prf#5416,c_comment_prf#5417,c_address_prf#5418,c_mktsegment_prf#5419,c_phone_prf#5420] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 182785ms
query=b1a, count=15628, duration=7722
query=b1b, count=15628, duration=7725
query=b2a, count=1478870, duration=98791
query=b2b, count=1478870, duration=97651
query=f1, count=1, duration=980
query=f2, count=3907, duration=121
query=f3, count=1451, duration=80
query=f4, count=1, duration=61
query=f5, count=1478870, duration=23334
query=f6, count=857401, duration=13620
query=j1, count=800000, duration=12369
query=j10, count=6001215, duration=90511
query=j2, count=800000, duration=11656
query=j3, count=25, duration=72
query=j4, count=150000, duration=2523
query=j5, count=10000, duration=223
query=j6, count=6001215, duration=105484
query=j7, count=1500000, duration=23698
query=j8, count=6001215, duration=107607
query=j8b, count=6001215, duration=107436
query=j9, count=6001215, duration=94796
query=j9b, count=6001215, duration=95960
query=r1a, count=6001215, duration=183120
query=r1b, count=6001215, duration=182785
query=r1c, count=6001215, duration=182355
query=r1d, count=6001215, duration=169119
query=r1e, count=6001215, duration=169730
query=r1f, count=6001215, duration=143864
query=t1a, count=60000414, duration=877020
query=t1b, count=60000414, duration=881741
query=t1c, count=60000414, duration=922296
query=t2a, count=800000, duration=26111
query=t2b, count=800000, duration=26112
query=t2c, count=800000, duration=26237
query=t2d, count=800000, duration=26148
query=t3a, count=6001215, duration=201571
query=t3b, count=6001215, duration=201583
query=t3c, count=6001215, duration=201798
query=t3d, count=6001215, duration=200859
