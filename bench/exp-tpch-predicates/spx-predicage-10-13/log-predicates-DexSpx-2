19/10/12 05:32:28 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7167ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Oct 12 05:32:30 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Oct 12 05:32:31 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Oct 12 05:32:31 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Oct 12 05:32:31 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Oct 12 05:32:31 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Oct 12 05:32:34 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Oct 12 05:32:36 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Oct 12 05:32:36 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



f2=
select * from part where p_size = 15
19/10/12 05:32:37 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:32:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1480L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 05:32:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1480L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#1482 AS p_comment_prf_0#1492, p_name_prf#1483 AS p_name_prf_0#1493, rid#1484 AS rid_0#1494, p_type_prf#1485 AS p_type_prf_0#1495, p_retailprice_prf#1486 AS p_retailprice_prf_0#1496, p_mfgr_prf#1487 AS p_mfgr_prf_0#1497, p_container_prf#1488 AS p_container_prf_0#1498, p_brand_prf#1489 AS p_brand_prf_0#1499, p_size_prf#1490 AS p_size_prf_0#1500, p_partkey_prf#1491 AS p_partkey_prf_0#1501]
         :  +- Relation[p_comment_prf#1482,p_name_prf#1483,rid#1484,p_type_prf#1485,p_retailprice_prf#1486,p_mfgr_prf#1487,p_container_prf#1488,p_brand_prf#1489,p_size_prf#1490,p_partkey_prf#1491] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1504]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1502,value#1503] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=3907
Elapsed time: 292ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/12 05:32:37 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:32:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1539L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 05:32:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1539L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [p_comment_prf#1541 AS p_comment_prf_0#1551, p_name_prf#1542 AS p_name_prf_0#1552, rid#1543 AS rid_0#1553, p_type_prf#1544 AS p_type_prf_0#1554, p_retailprice_prf#1545 AS p_retailprice_prf_0#1555, p_mfgr_prf#1546 AS p_mfgr_prf_0#1556, p_container_prf#1547 AS p_container_prf_0#1557, p_brand_prf#1548 AS p_brand_prf_0#1558, p_size_prf#1549 AS p_size_prf_0#1559, p_partkey_prf#1550 AS p_partkey_prf_0#1560]
         :  :  :  :  +- Relation[p_comment_prf#1541,p_name_prf#1542,rid#1543,p_type_prf#1544,p_retailprice_prf#1545,p_mfgr_prf#1546,p_container_prf#1547,p_brand_prf#1548,p_size_prf#1549,p_partkey_prf#1550] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1564, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1565]
         :  :  :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :  :  :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#1566 AS ps_partkey_and_ps_suppkey_prf_1#1573, rid#1567 AS rid_1#1574, ps_availqty_prf#1568 AS ps_availqty_prf_1#1575, ps_comment_prf#1569 AS ps_comment_prf_1#1576, ps_partkey_prf#1570 AS ps_partkey_prf_1#1577, ps_supplycost_prf#1571 AS ps_supplycost_prf_1#1578, ps_suppkey_prf#1572 AS ps_suppkey_prf_1#1579]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#1566,rid#1567,ps_availqty_prf#1568,ps_comment_prf#1569,ps_partkey_prf#1570,ps_supplycost_prf#1571,ps_suppkey_prf#1572] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1580, dexdecrypt('value_dec_key, 'value_right) AS rid_2#1581]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#1582 AS s_phone_prf_2#1590, rid#1583 AS rid_2#1591, s_address_prf#1584 AS s_address_prf_2#1592, s_nationkey_prf#1585 AS s_nationkey_prf_2#1593, s_suppkey_prf#1586 AS s_suppkey_prf_2#1594, s_name_prf#1587 AS s_name_prf_2#1595, s_acctbal_prf#1588 AS s_acctbal_prf_2#1596, s_comment_prf#1589 AS s_comment_prf_2#1597]
            +- Relation[s_phone_prf#1582,rid#1583,s_address_prf#1584,s_nationkey_prf#1585,s_suppkey_prf#1586,s_name_prf#1587,s_acctbal_prf#1588,s_comment_prf#1589] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26136ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/12 05:33:04 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:33:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1647L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 05:33:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1647L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [ps_partkey_and_ps_suppkey_prf#1649 AS ps_partkey_and_ps_suppkey_prf_0#1656, rid#1650 AS rid_0#1657, ps_availqty_prf#1651 AS ps_availqty_prf_0#1658, ps_comment_prf#1652 AS ps_comment_prf_0#1659, ps_partkey_prf#1653 AS ps_partkey_prf_0#1660, ps_supplycost_prf#1654 AS ps_supplycost_prf_0#1661, ps_suppkey_prf#1655 AS ps_suppkey_prf_0#1662]
         :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#1649,rid#1650,ps_availqty_prf#1651,ps_comment_prf#1652,ps_partkey_prf#1653,ps_supplycost_prf#1654,ps_suppkey_prf#1655] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1663, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1664]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey_and_l_suppkey~partsupp~ps_partkey_and_ps_suppkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1665 AS l_returnflag_prf_1#1684, l_orderkey_and_l_linenumber_prf#1666 AS l_orderkey_and_l_linenumber_prf_1#1685, l_comment_prf#1667 AS l_comment_prf_1#1686, l_linestatus_prf#1668 AS l_linestatus_prf_1#1687, rid#1669 AS rid_1#1688, l_shipmode_prf#1670 AS l_shipmode_prf_1#1689, l_shipinstruct_prf#1671 AS l_shipinstruct_prf_1#1690, l_quantity_prf#1672 AS l_quantity_prf_1#1691, l_receiptdate_prf#1673 AS l_receiptdate_prf_1#1692, l_linenumber_prf#1674 AS l_linenumber_prf_1#1693, l_tax_prf#1675 AS l_tax_prf_1#1694, l_shipdate_prf#1676 AS l_shipdate_prf_1#1695, l_extendedprice_prf#1677 AS l_extendedprice_prf_1#1696, l_partkey_prf#1678 AS l_partkey_prf_1#1697, l_discount_prf#1679 AS l_discount_prf_1#1698, l_partkey_and_l_suppkey_prf#1680 AS l_partkey_and_l_suppkey_prf_1#1699, l_commitdate_prf#1681 AS l_commitdate_prf_1#1700, l_suppkey_prf#1682 AS l_suppkey_prf_1#1701, l_orderkey_prf#1683 AS l_orderkey_prf_1#1702]
            +- Relation[l_returnflag_prf#1665,l_orderkey_and_l_linenumber_prf#1666,l_comment_prf#1667,l_linestatus_prf#1668,rid#1669,l_shipmode_prf#1670,l_shipinstruct_prf#1671,l_quantity_prf#1672,l_receiptdate_prf#1673,l_linenumber_prf#1674,l_tax_prf#1675,l_shipdate_prf#1676,l_extendedprice_prf#1677,l_partkey_prf#1678,l_discount_prf#1679,l_partkey_and_l_suppkey_prf#1680,l_commitdate_prf#1681,l_suppkey_prf#1682,l_orderkey_prf#1683] JDBCRelation(lineitem_prf) [numPartitions=1]

19/10/12 05:33:04 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexSpx$ result size=6001215
Elapsed time: 106419ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/12 05:34:50 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:34:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1748L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 05:34:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1748L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#1750 AS l_returnflag_prf_0#1769, l_orderkey_and_l_linenumber_prf#1751 AS l_orderkey_and_l_linenumber_prf_0#1770, l_comment_prf#1752 AS l_comment_prf_0#1771, l_linestatus_prf#1753 AS l_linestatus_prf_0#1772, rid#1754 AS rid_0#1773, l_shipmode_prf#1755 AS l_shipmode_prf_0#1774, l_shipinstruct_prf#1756 AS l_shipinstruct_prf_0#1775, l_quantity_prf#1757 AS l_quantity_prf_0#1776, l_receiptdate_prf#1758 AS l_receiptdate_prf_0#1777, l_linenumber_prf#1759 AS l_linenumber_prf_0#1778, l_tax_prf#1760 AS l_tax_prf_0#1779, l_shipdate_prf#1761 AS l_shipdate_prf_0#1780, l_extendedprice_prf#1762 AS l_extendedprice_prf_0#1781, l_partkey_prf#1763 AS l_partkey_prf_0#1782, l_discount_prf#1764 AS l_discount_prf_0#1783, l_partkey_and_l_suppkey_prf#1765 AS l_partkey_and_l_suppkey_prf_0#1784, l_commitdate_prf#1766 AS l_commitdate_prf_0#1785, l_suppkey_prf#1767 AS l_suppkey_prf_0#1786, l_orderkey_prf#1768 AS l_orderkey_prf_0#1787]
         :  +- Relation[l_returnflag_prf#1750,l_orderkey_and_l_linenumber_prf#1751,l_comment_prf#1752,l_linestatus_prf#1753,rid#1754,l_shipmode_prf#1755,l_shipinstruct_prf#1756,l_quantity_prf#1757,l_receiptdate_prf#1758,l_linenumber_prf#1759,l_tax_prf#1760,l_shipdate_prf#1761,l_extendedprice_prf#1762,l_partkey_prf#1763,l_discount_prf#1764,l_partkey_and_l_suppkey_prf#1765,l_commitdate_prf#1766,l_suppkey_prf#1767,l_orderkey_prf#1768] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1788]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1502,value#1503] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=857401
Elapsed time: 13632ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/12 05:35:04 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:35:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1844L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 05:35:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1844L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#1846 AS c_acctbal_prf_0#1855, rid#1847 AS rid_0#1856, c_name_prf#1848 AS c_name_prf_0#1857, c_nationkey_prf#1849 AS c_nationkey_prf_0#1858, c_custkey_prf#1850 AS c_custkey_prf_0#1859, c_comment_prf#1851 AS c_comment_prf_0#1860, c_address_prf#1852 AS c_address_prf_0#1861, c_mktsegment_prf#1853 AS c_mktsegment_prf_0#1862, c_phone_prf#1854 AS c_phone_prf_0#1863]
         :  :  +- Relation[c_acctbal_prf#1846,rid#1847,c_name_prf#1848,c_nationkey_prf#1849,c_custkey_prf#1850,c_comment_prf#1851,c_address_prf#1852,c_mktsegment_prf#1853,c_phone_prf#1854] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1864, dexdecrypt('value_dec_key, 'value_right) AS rid_2#1865]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [l_returnflag_prf#1866 AS l_returnflag_prf_1#1885, l_orderkey_and_l_linenumber_prf#1867 AS l_orderkey_and_l_linenumber_prf_1#1886, l_comment_prf#1868 AS l_comment_prf_1#1887, l_linestatus_prf#1869 AS l_linestatus_prf_1#1888, rid#1870 AS rid_1#1889, l_shipmode_prf#1871 AS l_shipmode_prf_1#1890, l_shipinstruct_prf#1872 AS l_shipinstruct_prf_1#1891, l_quantity_prf#1873 AS l_quantity_prf_1#1892, l_receiptdate_prf#1874 AS l_receiptdate_prf_1#1893, l_linenumber_prf#1875 AS l_linenumber_prf_1#1894, l_tax_prf#1876 AS l_tax_prf_1#1895, l_shipdate_prf#1877 AS l_shipdate_prf_1#1896, l_extendedprice_prf#1878 AS l_extendedprice_prf_1#1897, l_partkey_prf#1879 AS l_partkey_prf_1#1898, l_discount_prf#1880 AS l_discount_prf_1#1899, l_partkey_and_l_suppkey_prf#1881 AS l_partkey_and_l_suppkey_prf_1#1900, l_commitdate_prf#1882 AS l_commitdate_prf_1#1901, l_suppkey_prf#1883 AS l_suppkey_prf_1#1902, l_orderkey_prf#1884 AS l_orderkey_prf_1#1903]
            :  :  +- Relation[l_returnflag_prf#1866,l_orderkey_and_l_linenumber_prf#1867,l_comment_prf#1868,l_linestatus_prf#1869,rid#1870,l_shipmode_prf#1871,l_shipinstruct_prf#1872,l_quantity_prf#1873,l_receiptdate_prf#1874,l_linenumber_prf#1875,l_tax_prf#1876,l_shipdate_prf#1877,l_extendedprice_prf#1878,l_partkey_prf#1879,l_discount_prf#1880,l_partkey_and_l_suppkey_prf#1881,l_commitdate_prf#1882,l_suppkey_prf#1883,l_orderkey_prf#1884] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1904, dexdecrypt('value_dec_key, 'value_right) AS rid_2#1905]
            :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
            :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#1906 AS o_shippriority_prf_2#1916, rid#1907 AS rid_2#1917, o_orderdate_prf#1908 AS o_orderdate_prf_2#1918, o_custkey_prf#1909 AS o_custkey_prf_2#1919, o_orderpriority_prf#1910 AS o_orderpriority_prf_2#1920, o_clerk_prf#1911 AS o_clerk_prf_2#1921, o_orderstatus_prf#1912 AS o_orderstatus_prf_2#1922, o_totalprice_prf#1913 AS o_totalprice_prf_2#1923, o_orderkey_prf#1914 AS o_orderkey_prf_2#1924, o_comment_prf#1915 AS o_comment_prf_2#1925]
               +- Relation[o_shippriority_prf#1906,rid#1907,o_orderdate_prf#1908,o_custkey_prf#1909,o_orderpriority_prf#1910,o_clerk_prf#1911,o_orderstatus_prf#1912,o_totalprice_prf#1913,o_orderkey_prf#1914,o_comment_prf#1915] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 143093ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/12 05:37:27 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:37:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1981L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 05:37:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1981L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [p_comment_prf#1983 AS p_comment_prf_0#1993, p_name_prf#1984 AS p_name_prf_0#1994, rid#1985 AS rid_0#1995, p_type_prf#1986 AS p_type_prf_0#1996, p_retailprice_prf#1987 AS p_retailprice_prf_0#1997, p_mfgr_prf#1988 AS p_mfgr_prf_0#1998, p_container_prf#1989 AS p_container_prf_0#1999, p_brand_prf#1990 AS p_brand_prf_0#2000, p_size_prf#1991 AS p_size_prf_0#2001, p_partkey_prf#1992 AS p_partkey_prf_0#2002]
         :  :  +- Relation[p_comment_prf#1983,p_name_prf#1984,rid#1985,p_type_prf#1986,p_retailprice_prf#1987,p_mfgr_prf#1988,p_container_prf#1989,p_brand_prf#1990,p_size_prf#1991,p_partkey_prf#1992] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2003, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2004]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2005 AS ps_partkey_and_ps_suppkey_prf_1#2012, rid#2006 AS rid_1#2013, ps_availqty_prf#2007 AS ps_availqty_prf_1#2014, ps_comment_prf#2008 AS ps_comment_prf_1#2015, ps_partkey_prf#2009 AS ps_partkey_prf_1#2016, ps_supplycost_prf#2010 AS ps_supplycost_prf_1#2017, ps_suppkey_prf#2011 AS ps_suppkey_prf_1#2018]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2005,rid#2006,ps_availqty_prf#2007,ps_comment_prf#2008,ps_partkey_prf#2009,ps_supplycost_prf#2010,ps_suppkey_prf#2011] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 12239ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/12 05:37:39 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:37:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2071L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 05:37:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2071L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#2073 AS s_phone_prf_0#2081, rid#2074 AS rid_0#2082, s_address_prf#2075 AS s_address_prf_0#2083, s_nationkey_prf#2076 AS s_nationkey_prf_0#2084, s_suppkey_prf#2077 AS s_suppkey_prf_0#2085, s_name_prf#2078 AS s_name_prf_0#2086, s_acctbal_prf#2079 AS s_acctbal_prf_0#2087, s_comment_prf#2080 AS s_comment_prf_0#2088]
         :  :  +- Relation[s_phone_prf#2073,rid#2074,s_address_prf#2075,s_nationkey_prf#2076,s_suppkey_prf#2077,s_name_prf#2078,s_acctbal_prf#2079,s_comment_prf#2080] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2089, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2090]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [l_returnflag_prf#2091 AS l_returnflag_prf_1#2110, l_orderkey_and_l_linenumber_prf#2092 AS l_orderkey_and_l_linenumber_prf_1#2111, l_comment_prf#2093 AS l_comment_prf_1#2112, l_linestatus_prf#2094 AS l_linestatus_prf_1#2113, rid#2095 AS rid_1#2114, l_shipmode_prf#2096 AS l_shipmode_prf_1#2115, l_shipinstruct_prf#2097 AS l_shipinstruct_prf_1#2116, l_quantity_prf#2098 AS l_quantity_prf_1#2117, l_receiptdate_prf#2099 AS l_receiptdate_prf_1#2118, l_linenumber_prf#2100 AS l_linenumber_prf_1#2119, l_tax_prf#2101 AS l_tax_prf_1#2120, l_shipdate_prf#2102 AS l_shipdate_prf_1#2121, l_extendedprice_prf#2103 AS l_extendedprice_prf_1#2122, l_partkey_prf#2104 AS l_partkey_prf_1#2123, l_discount_prf#2105 AS l_discount_prf_1#2124, l_partkey_and_l_suppkey_prf#2106 AS l_partkey_and_l_suppkey_prf_1#2125, l_commitdate_prf#2107 AS l_commitdate_prf_1#2126, l_suppkey_prf#2108 AS l_suppkey_prf_1#2127, l_orderkey_prf#2109 AS l_orderkey_prf_1#2128]
            :  :  +- Relation[l_returnflag_prf#2091,l_orderkey_and_l_linenumber_prf#2092,l_comment_prf#2093,l_linestatus_prf#2094,rid#2095,l_shipmode_prf#2096,l_shipinstruct_prf#2097,l_quantity_prf#2098,l_receiptdate_prf#2099,l_linenumber_prf#2100,l_tax_prf#2101,l_shipdate_prf#2102,l_extendedprice_prf#2103,l_partkey_prf#2104,l_discount_prf#2105,l_partkey_and_l_suppkey_prf#2106,l_commitdate_prf#2107,l_suppkey_prf#2108,l_orderkey_prf#2109] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2129, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2130]
            :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
            :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [p_comment_prf#2131 AS p_comment_prf_2#2141, p_name_prf#2132 AS p_name_prf_2#2142, rid#2133 AS rid_2#2143, p_type_prf#2134 AS p_type_prf_2#2144, p_retailprice_prf#2135 AS p_retailprice_prf_2#2145, p_mfgr_prf#2136 AS p_mfgr_prf_2#2146, p_container_prf#2137 AS p_container_prf_2#2147, p_brand_prf#2138 AS p_brand_prf_2#2148, p_size_prf#2139 AS p_size_prf_2#2149, p_partkey_prf#2140 AS p_partkey_prf_2#2150]
               +- Relation[p_comment_prf#2131,p_name_prf#2132,rid#2133,p_type_prf#2134,p_retailprice_prf#2135,p_mfgr_prf#2136,p_container_prf#2137,p_brand_prf#2138,p_size_prf#2139,p_partkey_prf#2140] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 202110ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/12 05:41:01 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:41:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2212L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 05:41:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2212L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#2214 AS s_phone_prf_0#2222, rid#2215 AS rid_0#2223, s_address_prf#2216 AS s_address_prf_0#2224, s_nationkey_prf#2217 AS s_nationkey_prf_0#2225, s_suppkey_prf#2218 AS s_suppkey_prf_0#2226, s_name_prf#2219 AS s_name_prf_0#2227, s_acctbal_prf#2220 AS s_acctbal_prf_0#2228, s_comment_prf#2221 AS s_comment_prf_0#2229]
         :  :  +- Relation[s_phone_prf#2214,rid#2215,s_address_prf#2216,s_nationkey_prf#2217,s_suppkey_prf#2218,s_name_prf#2219,s_acctbal_prf#2220,s_comment_prf#2221] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2230, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2231]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [ps_partkey_and_ps_suppkey_prf#2232 AS ps_partkey_and_ps_suppkey_prf_1#2239, rid#2233 AS rid_1#2240, ps_availqty_prf#2234 AS ps_availqty_prf_1#2241, ps_comment_prf#2235 AS ps_comment_prf_1#2242, ps_partkey_prf#2236 AS ps_partkey_prf_1#2243, ps_supplycost_prf#2237 AS ps_supplycost_prf_1#2244, ps_suppkey_prf#2238 AS ps_suppkey_prf_1#2245]
            :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#2232,rid#2233,ps_availqty_prf#2234,ps_comment_prf#2235,ps_partkey_prf#2236,ps_supplycost_prf#2237,ps_suppkey_prf#2238] JDBCRelation(partsupp_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2246, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2247]
            :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
            :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [p_comment_prf#2248 AS p_comment_prf_2#2258, p_name_prf#2249 AS p_name_prf_2#2259, rid#2250 AS rid_2#2260, p_type_prf#2251 AS p_type_prf_2#2261, p_retailprice_prf#2252 AS p_retailprice_prf_2#2262, p_mfgr_prf#2253 AS p_mfgr_prf_2#2263, p_container_prf#2254 AS p_container_prf_2#2264, p_brand_prf#2255 AS p_brand_prf_2#2265, p_size_prf#2256 AS p_size_prf_2#2266, p_partkey_prf#2257 AS p_partkey_prf_2#2267]
               +- Relation[p_comment_prf#2248,p_name_prf#2249,rid#2250,p_type_prf#2251,p_retailprice_prf#2252,p_mfgr_prf#2253,p_container_prf#2254,p_brand_prf#2255,p_size_prf#2256,p_partkey_prf#2257] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26137ms

f1=
select * from region where r_name = 'EUROPE'
19/10/12 05:41:27 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:41:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2299L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/12 05:41:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2299L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#2301 AS r_regionkey_prf_0#2305, r_name_prf#2302 AS r_name_prf_0#2306, r_comment_prf#2303 AS r_comment_prf_0#2307, rid#2304 AS rid_0#2308]
         :  +- Relation[r_regionkey_prf#2301,r_name_prf#2302,r_comment_prf#2303,rid#2304] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2309]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1502,value#1503] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1
Elapsed time: 54ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/12 05:41:27 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:41:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2336L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 05:41:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2336L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [rid#2338 AS rid_0#2343, n_regionkey_prf#2339 AS n_regionkey_prf_0#2344, n_nationkey_prf#2340 AS n_nationkey_prf_0#2345, n_name_prf#2341 AS n_name_prf_0#2346, n_comment_prf#2342 AS n_comment_prf_0#2347]
         :  :  :  :  +- Relation[rid#2338,n_regionkey_prf#2339,n_nationkey_prf#2340,n_name_prf#2341,n_comment_prf#2342] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2348, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2349]
         :  :  :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :  :  :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#2350 AS s_phone_prf_1#2358, rid#2351 AS rid_1#2359, s_address_prf#2352 AS s_address_prf_1#2360, s_nationkey_prf#2353 AS s_nationkey_prf_1#2361, s_suppkey_prf#2354 AS s_suppkey_prf_1#2362, s_name_prf#2355 AS s_name_prf_1#2363, s_acctbal_prf#2356 AS s_acctbal_prf_1#2364, s_comment_prf#2357 AS s_comment_prf_1#2365]
         :  :     +- Relation[s_phone_prf#2350,rid#2351,s_address_prf#2352,s_nationkey_prf#2353,s_suppkey_prf#2354,s_name_prf#2355,s_acctbal_prf#2356,s_comment_prf#2357] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2366, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2367]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2368 AS c_acctbal_prf_2#2377, rid#2369 AS rid_2#2378, c_name_prf#2370 AS c_name_prf_2#2379, c_nationkey_prf#2371 AS c_nationkey_prf_2#2380, c_custkey_prf#2372 AS c_custkey_prf_2#2381, c_comment_prf#2373 AS c_comment_prf_2#2382, c_address_prf#2374 AS c_address_prf_2#2383, c_mktsegment_prf#2375 AS c_mktsegment_prf_2#2384, c_phone_prf#2376 AS c_phone_prf_2#2385]
            +- Relation[c_acctbal_prf#2368,rid#2369,c_name_prf#2370,c_nationkey_prf#2371,c_custkey_prf#2372,c_comment_prf#2373,c_address_prf#2374,c_mktsegment_prf#2375,c_phone_prf#2376] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 894682ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/12 05:56:22 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:56:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2443L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 05:56:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2443L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [p_comment_prf#2445 AS p_comment_prf_0#2455, p_name_prf#2446 AS p_name_prf_0#2456, rid#2447 AS rid_0#2457, p_type_prf#2448 AS p_type_prf_0#2458, p_retailprice_prf#2449 AS p_retailprice_prf_0#2459, p_mfgr_prf#2450 AS p_mfgr_prf_0#2460, p_container_prf#2451 AS p_container_prf_0#2461, p_brand_prf#2452 AS p_brand_prf_0#2462, p_size_prf#2453 AS p_size_prf_0#2463, p_partkey_prf#2454 AS p_partkey_prf_0#2464]
         :  :  :  :  +- Relation[p_comment_prf#2445,p_name_prf#2446,rid#2447,p_type_prf#2448,p_retailprice_prf#2449,p_mfgr_prf#2450,p_container_prf#2451,p_brand_prf#2452,p_size_prf#2453,p_partkey_prf#2454] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2465, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2466]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :  :  :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#2467 AS l_returnflag_prf_1#2486, l_orderkey_and_l_linenumber_prf#2468 AS l_orderkey_and_l_linenumber_prf_1#2487, l_comment_prf#2469 AS l_comment_prf_1#2488, l_linestatus_prf#2470 AS l_linestatus_prf_1#2489, rid#2471 AS rid_1#2490, l_shipmode_prf#2472 AS l_shipmode_prf_1#2491, l_shipinstruct_prf#2473 AS l_shipinstruct_prf_1#2492, l_quantity_prf#2474 AS l_quantity_prf_1#2493, l_receiptdate_prf#2475 AS l_receiptdate_prf_1#2494, l_linenumber_prf#2476 AS l_linenumber_prf_1#2495, l_tax_prf#2477 AS l_tax_prf_1#2496, l_shipdate_prf#2478 AS l_shipdate_prf_1#2497, l_extendedprice_prf#2479 AS l_extendedprice_prf_1#2498, l_partkey_prf#2480 AS l_partkey_prf_1#2499, l_discount_prf#2481 AS l_discount_prf_1#2500, l_partkey_and_l_suppkey_prf#2482 AS l_partkey_and_l_suppkey_prf_1#2501, l_commitdate_prf#2483 AS l_commitdate_prf_1#2502, l_suppkey_prf#2484 AS l_suppkey_prf_1#2503, l_orderkey_prf#2485 AS l_orderkey_prf_1#2504]
         :  :     +- Relation[l_returnflag_prf#2467,l_orderkey_and_l_linenumber_prf#2468,l_comment_prf#2469,l_linestatus_prf#2470,rid#2471,l_shipmode_prf#2472,l_shipinstruct_prf#2473,l_quantity_prf#2474,l_receiptdate_prf#2475,l_linenumber_prf#2476,l_tax_prf#2477,l_shipdate_prf#2478,l_extendedprice_prf#2479,l_partkey_prf#2480,l_discount_prf#2481,l_partkey_and_l_suppkey_prf#2482,l_commitdate_prf#2483,l_suppkey_prf#2484,l_orderkey_prf#2485] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2505, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2506]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#2507 AS s_phone_prf_2#2515, rid#2508 AS rid_2#2516, s_address_prf#2509 AS s_address_prf_2#2517, s_nationkey_prf#2510 AS s_nationkey_prf_2#2518, s_suppkey_prf#2511 AS s_suppkey_prf_2#2519, s_name_prf#2512 AS s_name_prf_2#2520, s_acctbal_prf#2513 AS s_acctbal_prf_2#2521, s_comment_prf#2514 AS s_comment_prf_2#2522]
            +- Relation[s_phone_prf#2507,rid#2508,s_address_prf#2509,s_nationkey_prf#2510,s_suppkey_prf#2511,s_name_prf#2512,s_acctbal_prf#2513,s_comment_prf#2514] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201748ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/12 05:59:44 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:59:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2596L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 05:59:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2596L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#2598 AS c_acctbal_prf_0#2607, rid#2599 AS rid_0#2608, c_name_prf#2600 AS c_name_prf_0#2609, c_nationkey_prf#2601 AS c_nationkey_prf_0#2610, c_custkey_prf#2602 AS c_custkey_prf_0#2611, c_comment_prf#2603 AS c_comment_prf_0#2612, c_address_prf#2604 AS c_address_prf_0#2613, c_mktsegment_prf#2605 AS c_mktsegment_prf_0#2614, c_phone_prf#2606 AS c_phone_prf_0#2615]
         :  :  +- Relation[c_acctbal_prf#2598,rid#2599,c_name_prf#2600,c_nationkey_prf#2601,c_custkey_prf#2602,c_comment_prf#2603,c_address_prf#2604,c_mktsegment_prf#2605,c_phone_prf#2606] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2616, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2617]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [o_shippriority_prf#2618 AS o_shippriority_prf_1#2628, rid#2619 AS rid_1#2629, o_orderdate_prf#2620 AS o_orderdate_prf_1#2630, o_custkey_prf#2621 AS o_custkey_prf_1#2631, o_orderpriority_prf#2622 AS o_orderpriority_prf_1#2632, o_clerk_prf#2623 AS o_clerk_prf_1#2633, o_orderstatus_prf#2624 AS o_orderstatus_prf_1#2634, o_totalprice_prf#2625 AS o_totalprice_prf_1#2635, o_orderkey_prf#2626 AS o_orderkey_prf_1#2636, o_comment_prf#2627 AS o_comment_prf_1#2637]
            :  :  +- Relation[o_shippriority_prf#2618,rid#2619,o_orderdate_prf#2620,o_custkey_prf#2621,o_orderpriority_prf#2622,o_clerk_prf#2623,o_orderstatus_prf#2624,o_totalprice_prf#2625,o_orderkey_prf#2626,o_comment_prf#2627] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2638, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2639]
            :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
            :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2640 AS l_returnflag_prf_2#2659, l_orderkey_and_l_linenumber_prf#2641 AS l_orderkey_and_l_linenumber_prf_2#2660, l_comment_prf#2642 AS l_comment_prf_2#2661, l_linestatus_prf#2643 AS l_linestatus_prf_2#2662, rid#2644 AS rid_2#2663, l_shipmode_prf#2645 AS l_shipmode_prf_2#2664, l_shipinstruct_prf#2646 AS l_shipinstruct_prf_2#2665, l_quantity_prf#2647 AS l_quantity_prf_2#2666, l_receiptdate_prf#2648 AS l_receiptdate_prf_2#2667, l_linenumber_prf#2649 AS l_linenumber_prf_2#2668, l_tax_prf#2650 AS l_tax_prf_2#2669, l_shipdate_prf#2651 AS l_shipdate_prf_2#2670, l_extendedprice_prf#2652 AS l_extendedprice_prf_2#2671, l_partkey_prf#2653 AS l_partkey_prf_2#2672, l_discount_prf#2654 AS l_discount_prf_2#2673, l_partkey_and_l_suppkey_prf#2655 AS l_partkey_and_l_suppkey_prf_2#2674, l_commitdate_prf#2656 AS l_commitdate_prf_2#2675, l_suppkey_prf#2657 AS l_suppkey_prf_2#2676, l_orderkey_prf#2658 AS l_orderkey_prf_2#2677]
               +- Relation[l_returnflag_prf#2640,l_orderkey_and_l_linenumber_prf#2641,l_comment_prf#2642,l_linestatus_prf#2643,rid#2644,l_shipmode_prf#2645,l_shipinstruct_prf#2646,l_quantity_prf#2647,l_receiptdate_prf#2648,l_linenumber_prf#2649,l_tax_prf#2650,l_shipdate_prf#2651,l_extendedprice_prf#2652,l_partkey_prf#2653,l_discount_prf#2654,l_partkey_and_l_suppkey_prf#2655,l_commitdate_prf#2656,l_suppkey_prf#2657,l_orderkey_prf#2658] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 170915ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/12 06:02:35 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:02:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2731L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 06:02:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2731L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [rid#2733 AS rid_0#2738, n_regionkey_prf#2734 AS n_regionkey_prf_0#2739, n_nationkey_prf#2735 AS n_nationkey_prf_0#2740, n_name_prf#2736 AS n_name_prf_0#2741, n_comment_prf#2737 AS n_comment_prf_0#2742]
         :  :  +- Relation[rid#2733,n_regionkey_prf#2734,n_nationkey_prf#2735,n_name_prf#2736,n_comment_prf#2737] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2743, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2744]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2745 AS c_acctbal_prf_1#2754, rid#2746 AS rid_1#2755, c_name_prf#2747 AS c_name_prf_1#2756, c_nationkey_prf#2748 AS c_nationkey_prf_1#2757, c_custkey_prf#2749 AS c_custkey_prf_1#2758, c_comment_prf#2750 AS c_comment_prf_1#2759, c_address_prf#2751 AS c_address_prf_1#2760, c_mktsegment_prf#2752 AS c_mktsegment_prf_1#2761, c_phone_prf#2753 AS c_phone_prf_1#2762]
            +- Relation[c_acctbal_prf#2745,rid#2746,c_name_prf#2747,c_nationkey_prf#2748,c_custkey_prf#2749,c_comment_prf#2750,c_address_prf#2751,c_mktsegment_prf#2752,c_phone_prf#2753] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=150000
Elapsed time: 2538ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/12 06:02:37 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:02:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2801L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 06:02:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2801L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [ps_partkey_and_ps_suppkey_prf#2803 AS ps_partkey_and_ps_suppkey_prf_0#2810, rid#2804 AS rid_0#2811, ps_availqty_prf#2805 AS ps_availqty_prf_0#2812, ps_comment_prf#2806 AS ps_comment_prf_0#2813, ps_partkey_prf#2807 AS ps_partkey_prf_0#2814, ps_supplycost_prf#2808 AS ps_supplycost_prf_0#2815, ps_suppkey_prf#2809 AS ps_suppkey_prf_0#2816]
         :  :  :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#2803,rid#2804,ps_availqty_prf#2805,ps_comment_prf#2806,ps_partkey_prf#2807,ps_supplycost_prf#2808,ps_suppkey_prf#2809] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2817, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2818]
         :  :  :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :  :  :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#2819 AS p_comment_prf_1#2829, p_name_prf#2820 AS p_name_prf_1#2830, rid#2821 AS rid_1#2831, p_type_prf#2822 AS p_type_prf_1#2832, p_retailprice_prf#2823 AS p_retailprice_prf_1#2833, p_mfgr_prf#2824 AS p_mfgr_prf_1#2834, p_container_prf#2825 AS p_container_prf_1#2835, p_brand_prf#2826 AS p_brand_prf_1#2836, p_size_prf#2827 AS p_size_prf_1#2837, p_partkey_prf#2828 AS p_partkey_prf_1#2838]
         :  :     +- Relation[p_comment_prf#2819,p_name_prf#2820,rid#2821,p_type_prf#2822,p_retailprice_prf#2823,p_mfgr_prf#2824,p_container_prf#2825,p_brand_prf#2826,p_size_prf#2827,p_partkey_prf#2828] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2839, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2840]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#2841 AS s_phone_prf_2#2849, rid#2842 AS rid_2#2850, s_address_prf#2843 AS s_address_prf_2#2851, s_nationkey_prf#2844 AS s_nationkey_prf_2#2852, s_suppkey_prf#2845 AS s_suppkey_prf_2#2853, s_name_prf#2846 AS s_name_prf_2#2854, s_acctbal_prf#2847 AS s_acctbal_prf_2#2855, s_comment_prf#2848 AS s_comment_prf_2#2856]
            +- Relation[s_phone_prf#2841,rid#2842,s_address_prf#2843,s_nationkey_prf#2844,s_suppkey_prf#2845,s_name_prf#2846,s_acctbal_prf#2847,s_comment_prf#2848] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26319ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/12 06:03:03 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:03:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2910L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 06:03:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2910L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [o_shippriority_prf#2912 AS o_shippriority_prf_0#2922, rid#2913 AS rid_0#2923, o_orderdate_prf#2914 AS o_orderdate_prf_0#2924, o_custkey_prf#2915 AS o_custkey_prf_0#2925, o_orderpriority_prf#2916 AS o_orderpriority_prf_0#2926, o_clerk_prf#2917 AS o_clerk_prf_0#2927, o_orderstatus_prf#2918 AS o_orderstatus_prf_0#2928, o_totalprice_prf#2919 AS o_totalprice_prf_0#2929, o_orderkey_prf#2920 AS o_orderkey_prf_0#2930, o_comment_prf#2921 AS o_comment_prf_0#2931]
         :  :  +- Relation[o_shippriority_prf#2912,rid#2913,o_orderdate_prf#2914,o_custkey_prf#2915,o_orderpriority_prf#2916,o_clerk_prf#2917,o_orderstatus_prf#2918,o_totalprice_prf#2919,o_orderkey_prf#2920,o_comment_prf#2921] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2932, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2933]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#2934 AS l_returnflag_prf_1#2953, l_orderkey_and_l_linenumber_prf#2935 AS l_orderkey_and_l_linenumber_prf_1#2954, l_comment_prf#2936 AS l_comment_prf_1#2955, l_linestatus_prf#2937 AS l_linestatus_prf_1#2956, rid#2938 AS rid_1#2957, l_shipmode_prf#2939 AS l_shipmode_prf_1#2958, l_shipinstruct_prf#2940 AS l_shipinstruct_prf_1#2959, l_quantity_prf#2941 AS l_quantity_prf_1#2960, l_receiptdate_prf#2942 AS l_receiptdate_prf_1#2961, l_linenumber_prf#2943 AS l_linenumber_prf_1#2962, l_tax_prf#2944 AS l_tax_prf_1#2963, l_shipdate_prf#2945 AS l_shipdate_prf_1#2964, l_extendedprice_prf#2946 AS l_extendedprice_prf_1#2965, l_partkey_prf#2947 AS l_partkey_prf_1#2966, l_discount_prf#2948 AS l_discount_prf_1#2967, l_partkey_and_l_suppkey_prf#2949 AS l_partkey_and_l_suppkey_prf_1#2968, l_commitdate_prf#2950 AS l_commitdate_prf_1#2969, l_suppkey_prf#2951 AS l_suppkey_prf_1#2970, l_orderkey_prf#2952 AS l_orderkey_prf_1#2971]
            :  +- Relation[l_returnflag_prf#2934,l_orderkey_and_l_linenumber_prf#2935,l_comment_prf#2936,l_linestatus_prf#2937,rid#2938,l_shipmode_prf#2939,l_shipinstruct_prf#2940,l_quantity_prf#2941,l_receiptdate_prf#2942,l_linenumber_prf#2943,l_tax_prf#2944,l_shipdate_prf#2945,l_extendedprice_prf#2946,l_partkey_prf#2947,l_discount_prf#2948,l_partkey_and_l_suppkey_prf#2949,l_commitdate_prf#2950,l_suppkey_prf#2951,l_orderkey_prf#2952] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2972]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1502,value#1503] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 98762ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/12 06:04:42 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:04:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3030L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 06:04:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3030L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#3032 AS l_returnflag_prf_0#3051, l_orderkey_and_l_linenumber_prf#3033 AS l_orderkey_and_l_linenumber_prf_0#3052, l_comment_prf#3034 AS l_comment_prf_0#3053, l_linestatus_prf#3035 AS l_linestatus_prf_0#3054, rid#3036 AS rid_0#3055, l_shipmode_prf#3037 AS l_shipmode_prf_0#3056, l_shipinstruct_prf#3038 AS l_shipinstruct_prf_0#3057, l_quantity_prf#3039 AS l_quantity_prf_0#3058, l_receiptdate_prf#3040 AS l_receiptdate_prf_0#3059, l_linenumber_prf#3041 AS l_linenumber_prf_0#3060, l_tax_prf#3042 AS l_tax_prf_0#3061, l_shipdate_prf#3043 AS l_shipdate_prf_0#3062, l_extendedprice_prf#3044 AS l_extendedprice_prf_0#3063, l_partkey_prf#3045 AS l_partkey_prf_0#3064, l_discount_prf#3046 AS l_discount_prf_0#3065, l_partkey_and_l_suppkey_prf#3047 AS l_partkey_and_l_suppkey_prf_0#3066, l_commitdate_prf#3048 AS l_commitdate_prf_0#3067, l_suppkey_prf#3049 AS l_suppkey_prf_0#3068, l_orderkey_prf#3050 AS l_orderkey_prf_0#3069]
         :  :  +- Relation[l_returnflag_prf#3032,l_orderkey_and_l_linenumber_prf#3033,l_comment_prf#3034,l_linestatus_prf#3035,rid#3036,l_shipmode_prf#3037,l_shipinstruct_prf#3038,l_quantity_prf#3039,l_receiptdate_prf#3040,l_linenumber_prf#3041,l_tax_prf#3042,l_shipdate_prf#3043,l_extendedprice_prf#3044,l_partkey_prf#3045,l_discount_prf#3046,l_partkey_and_l_suppkey_prf#3047,l_commitdate_prf#3048,l_suppkey_prf#3049,l_orderkey_prf#3050] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3070, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3071]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [p_comment_prf#3072 AS p_comment_prf_1#3082, p_name_prf#3073 AS p_name_prf_1#3083, rid#3074 AS rid_1#3084, p_type_prf#3075 AS p_type_prf_1#3085, p_retailprice_prf#3076 AS p_retailprice_prf_1#3086, p_mfgr_prf#3077 AS p_mfgr_prf_1#3087, p_container_prf#3078 AS p_container_prf_1#3088, p_brand_prf#3079 AS p_brand_prf_1#3089, p_size_prf#3080 AS p_size_prf_1#3090, p_partkey_prf#3081 AS p_partkey_prf_1#3091]
            +- Relation[p_comment_prf#3072,p_name_prf#3073,rid#3074,p_type_prf#3075,p_retailprice_prf#3076,p_mfgr_prf#3077,p_container_prf#3078,p_brand_prf#3079,p_size_prf#3080,p_partkey_prf#3081] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 94894ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/12 06:06:17 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:06:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3157L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 06:06:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3157L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [l_returnflag_prf#3159 AS l_returnflag_prf_0#3178, l_orderkey_and_l_linenumber_prf#3160 AS l_orderkey_and_l_linenumber_prf_0#3179, l_comment_prf#3161 AS l_comment_prf_0#3180, l_linestatus_prf#3162 AS l_linestatus_prf_0#3181, rid#3163 AS rid_0#3182, l_shipmode_prf#3164 AS l_shipmode_prf_0#3183, l_shipinstruct_prf#3165 AS l_shipinstruct_prf_0#3184, l_quantity_prf#3166 AS l_quantity_prf_0#3185, l_receiptdate_prf#3167 AS l_receiptdate_prf_0#3186, l_linenumber_prf#3168 AS l_linenumber_prf_0#3187, l_tax_prf#3169 AS l_tax_prf_0#3188, l_shipdate_prf#3170 AS l_shipdate_prf_0#3189, l_extendedprice_prf#3171 AS l_extendedprice_prf_0#3190, l_partkey_prf#3172 AS l_partkey_prf_0#3191, l_discount_prf#3173 AS l_discount_prf_0#3192, l_partkey_and_l_suppkey_prf#3174 AS l_partkey_and_l_suppkey_prf_0#3193, l_commitdate_prf#3175 AS l_commitdate_prf_0#3194, l_suppkey_prf#3176 AS l_suppkey_prf_0#3195, l_orderkey_prf#3177 AS l_orderkey_prf_0#3196]
         :  :  :  :  +- Relation[l_returnflag_prf#3159,l_orderkey_and_l_linenumber_prf#3160,l_comment_prf#3161,l_linestatus_prf#3162,rid#3163,l_shipmode_prf#3164,l_shipinstruct_prf#3165,l_quantity_prf#3166,l_receiptdate_prf#3167,l_linenumber_prf#3168,l_tax_prf#3169,l_shipdate_prf#3170,l_extendedprice_prf#3171,l_partkey_prf#3172,l_discount_prf#3173,l_partkey_and_l_suppkey_prf#3174,l_commitdate_prf#3175,l_suppkey_prf#3176,l_orderkey_prf#3177] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3197, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3198]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :  :  :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#3199 AS o_shippriority_prf_1#3209, rid#3200 AS rid_1#3210, o_orderdate_prf#3201 AS o_orderdate_prf_1#3211, o_custkey_prf#3202 AS o_custkey_prf_1#3212, o_orderpriority_prf#3203 AS o_orderpriority_prf_1#3213, o_clerk_prf#3204 AS o_clerk_prf_1#3214, o_orderstatus_prf#3205 AS o_orderstatus_prf_1#3215, o_totalprice_prf#3206 AS o_totalprice_prf_1#3216, o_orderkey_prf#3207 AS o_orderkey_prf_1#3217, o_comment_prf#3208 AS o_comment_prf_1#3218]
         :  :     +- Relation[o_shippriority_prf#3199,rid#3200,o_orderdate_prf#3201,o_custkey_prf#3202,o_orderpriority_prf#3203,o_clerk_prf#3204,o_orderstatus_prf#3205,o_totalprice_prf#3206,o_orderkey_prf#3207,o_comment_prf#3208] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3219, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3220]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3221 AS c_acctbal_prf_2#3230, rid#3222 AS rid_2#3231, c_name_prf#3223 AS c_name_prf_2#3232, c_nationkey_prf#3224 AS c_nationkey_prf_2#3233, c_custkey_prf#3225 AS c_custkey_prf_2#3234, c_comment_prf#3226 AS c_comment_prf_2#3235, c_address_prf#3227 AS c_address_prf_2#3236, c_mktsegment_prf#3228 AS c_mktsegment_prf_2#3237, c_phone_prf#3229 AS c_phone_prf_2#3238]
            +- Relation[c_acctbal_prf#3221,rid#3222,c_name_prf#3223,c_nationkey_prf#3224,c_custkey_prf#3225,c_comment_prf#3226,c_address_prf#3227,c_mktsegment_prf#3228,c_phone_prf#3229] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 183121ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/12 06:09:20 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:09:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3305L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 06:09:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3305L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [p_comment_prf#3307 AS p_comment_prf_0#3317, p_name_prf#3308 AS p_name_prf_0#3318, rid#3309 AS rid_0#3319, p_type_prf#3310 AS p_type_prf_0#3320, p_retailprice_prf#3311 AS p_retailprice_prf_0#3321, p_mfgr_prf#3312 AS p_mfgr_prf_0#3322, p_container_prf#3313 AS p_container_prf_0#3323, p_brand_prf#3314 AS p_brand_prf_0#3324, p_size_prf#3315 AS p_size_prf_0#3325, p_partkey_prf#3316 AS p_partkey_prf_0#3326]
         :  :  +- Relation[p_comment_prf#3307,p_name_prf#3308,rid#3309,p_type_prf#3310,p_retailprice_prf#3311,p_mfgr_prf#3312,p_container_prf#3313,p_brand_prf#3314,p_size_prf#3315,p_partkey_prf#3316] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3327, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3328]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3329 AS l_returnflag_prf_1#3348, l_orderkey_and_l_linenumber_prf#3330 AS l_orderkey_and_l_linenumber_prf_1#3349, l_comment_prf#3331 AS l_comment_prf_1#3350, l_linestatus_prf#3332 AS l_linestatus_prf_1#3351, rid#3333 AS rid_1#3352, l_shipmode_prf#3334 AS l_shipmode_prf_1#3353, l_shipinstruct_prf#3335 AS l_shipinstruct_prf_1#3354, l_quantity_prf#3336 AS l_quantity_prf_1#3355, l_receiptdate_prf#3337 AS l_receiptdate_prf_1#3356, l_linenumber_prf#3338 AS l_linenumber_prf_1#3357, l_tax_prf#3339 AS l_tax_prf_1#3358, l_shipdate_prf#3340 AS l_shipdate_prf_1#3359, l_extendedprice_prf#3341 AS l_extendedprice_prf_1#3360, l_partkey_prf#3342 AS l_partkey_prf_1#3361, l_discount_prf#3343 AS l_discount_prf_1#3362, l_partkey_and_l_suppkey_prf#3344 AS l_partkey_and_l_suppkey_prf_1#3363, l_commitdate_prf#3345 AS l_commitdate_prf_1#3364, l_suppkey_prf#3346 AS l_suppkey_prf_1#3365, l_orderkey_prf#3347 AS l_orderkey_prf_1#3366]
            +- Relation[l_returnflag_prf#3329,l_orderkey_and_l_linenumber_prf#3330,l_comment_prf#3331,l_linestatus_prf#3332,rid#3333,l_shipmode_prf#3334,l_shipinstruct_prf#3335,l_quantity_prf#3336,l_receiptdate_prf#3337,l_linenumber_prf#3338,l_tax_prf#3339,l_shipdate_prf#3340,l_extendedprice_prf#3341,l_partkey_prf#3342,l_discount_prf#3343,l_partkey_and_l_suppkey_prf#3344,l_commitdate_prf#3345,l_suppkey_prf#3346,l_orderkey_prf#3347] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 94982ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/12 06:10:55 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:10:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3432L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 06:10:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3432L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#3434 AS l_returnflag_prf_0#3453, l_orderkey_and_l_linenumber_prf#3435 AS l_orderkey_and_l_linenumber_prf_0#3454, l_comment_prf#3436 AS l_comment_prf_0#3455, l_linestatus_prf#3437 AS l_linestatus_prf_0#3456, rid#3438 AS rid_0#3457, l_shipmode_prf#3439 AS l_shipmode_prf_0#3458, l_shipinstruct_prf#3440 AS l_shipinstruct_prf_0#3459, l_quantity_prf#3441 AS l_quantity_prf_0#3460, l_receiptdate_prf#3442 AS l_receiptdate_prf_0#3461, l_linenumber_prf#3443 AS l_linenumber_prf_0#3462, l_tax_prf#3444 AS l_tax_prf_0#3463, l_shipdate_prf#3445 AS l_shipdate_prf_0#3464, l_extendedprice_prf#3446 AS l_extendedprice_prf_0#3465, l_partkey_prf#3447 AS l_partkey_prf_0#3466, l_discount_prf#3448 AS l_discount_prf_0#3467, l_partkey_and_l_suppkey_prf#3449 AS l_partkey_and_l_suppkey_prf_0#3468, l_commitdate_prf#3450 AS l_commitdate_prf_0#3469, l_suppkey_prf#3451 AS l_suppkey_prf_0#3470, l_orderkey_prf#3452 AS l_orderkey_prf_0#3471]
         :  :  +- Relation[l_returnflag_prf#3434,l_orderkey_and_l_linenumber_prf#3435,l_comment_prf#3436,l_linestatus_prf#3437,rid#3438,l_shipmode_prf#3439,l_shipinstruct_prf#3440,l_quantity_prf#3441,l_receiptdate_prf#3442,l_linenumber_prf#3443,l_tax_prf#3444,l_shipdate_prf#3445,l_extendedprice_prf#3446,l_partkey_prf#3447,l_discount_prf#3448,l_partkey_and_l_suppkey_prf#3449,l_commitdate_prf#3450,l_suppkey_prf#3451,l_orderkey_prf#3452] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3472, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3473]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [o_shippriority_prf#3474 AS o_shippriority_prf_1#3484, rid#3475 AS rid_1#3485, o_orderdate_prf#3476 AS o_orderdate_prf_1#3486, o_custkey_prf#3477 AS o_custkey_prf_1#3487, o_orderpriority_prf#3478 AS o_orderpriority_prf_1#3488, o_clerk_prf#3479 AS o_clerk_prf_1#3489, o_orderstatus_prf#3480 AS o_orderstatus_prf_1#3490, o_totalprice_prf#3481 AS o_totalprice_prf_1#3491, o_orderkey_prf#3482 AS o_orderkey_prf_1#3492, o_comment_prf#3483 AS o_comment_prf_1#3493]
            :  :  +- Relation[o_shippriority_prf#3474,rid#3475,o_orderdate_prf#3476,o_custkey_prf#3477,o_orderpriority_prf#3478,o_clerk_prf#3479,o_orderstatus_prf#3480,o_totalprice_prf#3481,o_orderkey_prf#3482,o_comment_prf#3483] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3494, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3495]
            :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
            :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#3496 AS c_acctbal_prf_2#3505, rid#3497 AS rid_2#3506, c_name_prf#3498 AS c_name_prf_2#3507, c_nationkey_prf#3499 AS c_nationkey_prf_2#3508, c_custkey_prf#3500 AS c_custkey_prf_2#3509, c_comment_prf#3501 AS c_comment_prf_2#3510, c_address_prf#3502 AS c_address_prf_2#3511, c_mktsegment_prf#3503 AS c_mktsegment_prf_2#3512, c_phone_prf#3504 AS c_phone_prf_2#3513]
               +- Relation[c_acctbal_prf#3496,rid#3497,c_name_prf#3498,c_nationkey_prf#3499,c_custkey_prf#3500,c_comment_prf#3501,c_address_prf#3502,c_mktsegment_prf#3503,c_phone_prf#3504] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 183784ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/12 06:13:59 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:13:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3587L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 06:13:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3587L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [l_returnflag_prf#3589 AS l_returnflag_prf_0#3608, l_orderkey_and_l_linenumber_prf#3590 AS l_orderkey_and_l_linenumber_prf_0#3609, l_comment_prf#3591 AS l_comment_prf_0#3610, l_linestatus_prf#3592 AS l_linestatus_prf_0#3611, rid#3593 AS rid_0#3612, l_shipmode_prf#3594 AS l_shipmode_prf_0#3613, l_shipinstruct_prf#3595 AS l_shipinstruct_prf_0#3614, l_quantity_prf#3596 AS l_quantity_prf_0#3615, l_receiptdate_prf#3597 AS l_receiptdate_prf_0#3616, l_linenumber_prf#3598 AS l_linenumber_prf_0#3617, l_tax_prf#3599 AS l_tax_prf_0#3618, l_shipdate_prf#3600 AS l_shipdate_prf_0#3619, l_extendedprice_prf#3601 AS l_extendedprice_prf_0#3620, l_partkey_prf#3602 AS l_partkey_prf_0#3621, l_discount_prf#3603 AS l_discount_prf_0#3622, l_partkey_and_l_suppkey_prf#3604 AS l_partkey_and_l_suppkey_prf_0#3623, l_commitdate_prf#3605 AS l_commitdate_prf_0#3624, l_suppkey_prf#3606 AS l_suppkey_prf_0#3625, l_orderkey_prf#3607 AS l_orderkey_prf_0#3626]
         :  :  :  :  +- Relation[l_returnflag_prf#3589,l_orderkey_and_l_linenumber_prf#3590,l_comment_prf#3591,l_linestatus_prf#3592,rid#3593,l_shipmode_prf#3594,l_shipinstruct_prf#3595,l_quantity_prf#3596,l_receiptdate_prf#3597,l_linenumber_prf#3598,l_tax_prf#3599,l_shipdate_prf#3600,l_extendedprice_prf#3601,l_partkey_prf#3602,l_discount_prf#3603,l_partkey_and_l_suppkey_prf#3604,l_commitdate_prf#3605,l_suppkey_prf#3606,l_orderkey_prf#3607] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3627, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3628]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :  :  :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#3629 AS p_comment_prf_1#3639, p_name_prf#3630 AS p_name_prf_1#3640, rid#3631 AS rid_1#3641, p_type_prf#3632 AS p_type_prf_1#3642, p_retailprice_prf#3633 AS p_retailprice_prf_1#3643, p_mfgr_prf#3634 AS p_mfgr_prf_1#3644, p_container_prf#3635 AS p_container_prf_1#3645, p_brand_prf#3636 AS p_brand_prf_1#3646, p_size_prf#3637 AS p_size_prf_1#3647, p_partkey_prf#3638 AS p_partkey_prf_1#3648]
         :  :     +- Relation[p_comment_prf#3629,p_name_prf#3630,rid#3631,p_type_prf#3632,p_retailprice_prf#3633,p_mfgr_prf#3634,p_container_prf#3635,p_brand_prf#3636,p_size_prf#3637,p_partkey_prf#3638] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3649, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3650]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#3651 AS s_phone_prf_2#3659, rid#3652 AS rid_2#3660, s_address_prf#3653 AS s_address_prf_2#3661, s_nationkey_prf#3654 AS s_nationkey_prf_2#3662, s_suppkey_prf#3655 AS s_suppkey_prf_2#3663, s_name_prf#3656 AS s_name_prf_2#3664, s_acctbal_prf#3657 AS s_acctbal_prf_2#3665, s_comment_prf#3658 AS s_comment_prf_2#3666]
            +- Relation[s_phone_prf#3651,rid#3652,s_address_prf#3653,s_nationkey_prf#3654,s_suppkey_prf#3655,s_name_prf#3656,s_acctbal_prf#3657,s_comment_prf#3658] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 202081ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/12 06:17:21 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:17:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3732L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 06:17:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3732L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [o_shippriority_prf#3734 AS o_shippriority_prf_0#3744, rid#3735 AS rid_0#3745, o_orderdate_prf#3736 AS o_orderdate_prf_0#3746, o_custkey_prf#3737 AS o_custkey_prf_0#3747, o_orderpriority_prf#3738 AS o_orderpriority_prf_0#3748, o_clerk_prf#3739 AS o_clerk_prf_0#3749, o_orderstatus_prf#3740 AS o_orderstatus_prf_0#3750, o_totalprice_prf#3741 AS o_totalprice_prf_0#3751, o_orderkey_prf#3742 AS o_orderkey_prf_0#3752, o_comment_prf#3743 AS o_comment_prf_0#3753]
         :  :  +- Relation[o_shippriority_prf#3734,rid#3735,o_orderdate_prf#3736,o_custkey_prf#3737,o_orderpriority_prf#3738,o_clerk_prf#3739,o_orderstatus_prf#3740,o_totalprice_prf#3741,o_orderkey_prf#3742,o_comment_prf#3743] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3754, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3755]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3756 AS l_returnflag_prf_1#3775, l_orderkey_and_l_linenumber_prf#3757 AS l_orderkey_and_l_linenumber_prf_1#3776, l_comment_prf#3758 AS l_comment_prf_1#3777, l_linestatus_prf#3759 AS l_linestatus_prf_1#3778, rid#3760 AS rid_1#3779, l_shipmode_prf#3761 AS l_shipmode_prf_1#3780, l_shipinstruct_prf#3762 AS l_shipinstruct_prf_1#3781, l_quantity_prf#3763 AS l_quantity_prf_1#3782, l_receiptdate_prf#3764 AS l_receiptdate_prf_1#3783, l_linenumber_prf#3765 AS l_linenumber_prf_1#3784, l_tax_prf#3766 AS l_tax_prf_1#3785, l_shipdate_prf#3767 AS l_shipdate_prf_1#3786, l_extendedprice_prf#3768 AS l_extendedprice_prf_1#3787, l_partkey_prf#3769 AS l_partkey_prf_1#3788, l_discount_prf#3770 AS l_discount_prf_1#3789, l_partkey_and_l_suppkey_prf#3771 AS l_partkey_and_l_suppkey_prf_1#3790, l_commitdate_prf#3772 AS l_commitdate_prf_1#3791, l_suppkey_prf#3773 AS l_suppkey_prf_1#3792, l_orderkey_prf#3774 AS l_orderkey_prf_1#3793]
            +- Relation[l_returnflag_prf#3756,l_orderkey_and_l_linenumber_prf#3757,l_comment_prf#3758,l_linestatus_prf#3759,rid#3760,l_shipmode_prf#3761,l_shipinstruct_prf#3762,l_quantity_prf#3763,l_receiptdate_prf#3764,l_linenumber_prf#3765,l_tax_prf#3766,l_shipdate_prf#3767,l_extendedprice_prf#3768,l_partkey_prf#3769,l_discount_prf#3770,l_partkey_and_l_suppkey_prf#3771,l_commitdate_prf#3772,l_suppkey_prf#3773,l_orderkey_prf#3774] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 107570ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/12 06:19:09 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:19:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3859L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 06:19:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3859L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#3861 AS l_returnflag_prf_0#3880, l_orderkey_and_l_linenumber_prf#3862 AS l_orderkey_and_l_linenumber_prf_0#3881, l_comment_prf#3863 AS l_comment_prf_0#3882, l_linestatus_prf#3864 AS l_linestatus_prf_0#3883, rid#3865 AS rid_0#3884, l_shipmode_prf#3866 AS l_shipmode_prf_0#3885, l_shipinstruct_prf#3867 AS l_shipinstruct_prf_0#3886, l_quantity_prf#3868 AS l_quantity_prf_0#3887, l_receiptdate_prf#3869 AS l_receiptdate_prf_0#3888, l_linenumber_prf#3870 AS l_linenumber_prf_0#3889, l_tax_prf#3871 AS l_tax_prf_0#3890, l_shipdate_prf#3872 AS l_shipdate_prf_0#3891, l_extendedprice_prf#3873 AS l_extendedprice_prf_0#3892, l_partkey_prf#3874 AS l_partkey_prf_0#3893, l_discount_prf#3875 AS l_discount_prf_0#3894, l_partkey_and_l_suppkey_prf#3876 AS l_partkey_and_l_suppkey_prf_0#3895, l_commitdate_prf#3877 AS l_commitdate_prf_0#3896, l_suppkey_prf#3878 AS l_suppkey_prf_0#3897, l_orderkey_prf#3879 AS l_orderkey_prf_0#3898]
         :  :  +- Relation[l_returnflag_prf#3861,l_orderkey_and_l_linenumber_prf#3862,l_comment_prf#3863,l_linestatus_prf#3864,rid#3865,l_shipmode_prf#3866,l_shipinstruct_prf#3867,l_quantity_prf#3868,l_receiptdate_prf#3869,l_linenumber_prf#3870,l_tax_prf#3871,l_shipdate_prf#3872,l_extendedprice_prf#3873,l_partkey_prf#3874,l_discount_prf#3875,l_partkey_and_l_suppkey_prf#3876,l_commitdate_prf#3877,l_suppkey_prf#3878,l_orderkey_prf#3879] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3899, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3900]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [c_acctbal_prf#3901 AS c_acctbal_prf_1#3910, rid#3902 AS rid_1#3911, c_name_prf#3903 AS c_name_prf_1#3912, c_nationkey_prf#3904 AS c_nationkey_prf_1#3913, c_custkey_prf#3905 AS c_custkey_prf_1#3914, c_comment_prf#3906 AS c_comment_prf_1#3915, c_address_prf#3907 AS c_address_prf_1#3916, c_mktsegment_prf#3908 AS c_mktsegment_prf_1#3917, c_phone_prf#3909 AS c_phone_prf_1#3918]
            :  :  +- Relation[c_acctbal_prf#3901,rid#3902,c_name_prf#3903,c_nationkey_prf#3904,c_custkey_prf#3905,c_comment_prf#3906,c_address_prf#3907,c_mktsegment_prf#3908,c_phone_prf#3909] JDBCRelation(customer_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3919, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3920]
            :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
            :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3921 AS o_shippriority_prf_2#3931, rid#3922 AS rid_2#3932, o_orderdate_prf#3923 AS o_orderdate_prf_2#3933, o_custkey_prf#3924 AS o_custkey_prf_2#3934, o_orderpriority_prf#3925 AS o_orderpriority_prf_2#3935, o_clerk_prf#3926 AS o_clerk_prf_2#3936, o_orderstatus_prf#3927 AS o_orderstatus_prf_2#3937, o_totalprice_prf#3928 AS o_totalprice_prf_2#3938, o_orderkey_prf#3929 AS o_orderkey_prf_2#3939, o_comment_prf#3930 AS o_comment_prf_2#3940]
               +- Relation[o_shippriority_prf#3921,rid#3922,o_orderdate_prf#3923,o_custkey_prf#3924,o_orderpriority_prf#3925,o_clerk_prf#3926,o_orderstatus_prf#3927,o_totalprice_prf#3928,o_orderkey_prf#3929,o_comment_prf#3930] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 181914ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/12 06:22:11 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:22:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4001L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 06:22:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4001L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [s_phone_prf#4003 AS s_phone_prf_0#4011, rid#4004 AS rid_0#4012, s_address_prf#4005 AS s_address_prf_0#4013, s_nationkey_prf#4006 AS s_nationkey_prf_0#4014, s_suppkey_prf#4007 AS s_suppkey_prf_0#4015, s_name_prf#4008 AS s_name_prf_0#4016, s_acctbal_prf#4009 AS s_acctbal_prf_0#4017, s_comment_prf#4010 AS s_comment_prf_0#4018]
         :  :  :  :  +- Relation[s_phone_prf#4003,rid#4004,s_address_prf#4005,s_nationkey_prf#4006,s_suppkey_prf#4007,s_name_prf#4008,s_acctbal_prf#4009,s_comment_prf#4010] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4019, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4020]
         :  :  :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :  :  :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [rid#4021 AS rid_1#4026, n_regionkey_prf#4022 AS n_regionkey_prf_1#4027, n_nationkey_prf#4023 AS n_nationkey_prf_1#4028, n_name_prf#4024 AS n_name_prf_1#4029, n_comment_prf#4025 AS n_comment_prf_1#4030]
         :  :     +- Relation[rid#4021,n_regionkey_prf#4022,n_nationkey_prf#4023,n_name_prf#4024,n_comment_prf#4025] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4031, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4032]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4033 AS c_acctbal_prf_2#4042, rid#4034 AS rid_2#4043, c_name_prf#4035 AS c_name_prf_2#4044, c_nationkey_prf#4036 AS c_nationkey_prf_2#4045, c_custkey_prf#4037 AS c_custkey_prf_2#4046, c_comment_prf#4038 AS c_comment_prf_2#4047, c_address_prf#4039 AS c_address_prf_2#4048, c_mktsegment_prf#4040 AS c_mktsegment_prf_2#4049, c_phone_prf#4041 AS c_phone_prf_2#4050]
            +- Relation[c_acctbal_prf#4033,rid#4034,c_name_prf#4035,c_nationkey_prf#4036,c_custkey_prf#4037,c_comment_prf#4038,c_address_prf#4039,c_mktsegment_prf#4040,c_phone_prf#4041] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 893880ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/12 06:37:04 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:37:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4092L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 06:37:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4092L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#4094 AS l_returnflag_prf_0#4113, l_orderkey_and_l_linenumber_prf#4095 AS l_orderkey_and_l_linenumber_prf_0#4114, l_comment_prf#4096 AS l_comment_prf_0#4115, l_linestatus_prf#4097 AS l_linestatus_prf_0#4116, rid#4098 AS rid_0#4117, l_shipmode_prf#4099 AS l_shipmode_prf_0#4118, l_shipinstruct_prf#4100 AS l_shipinstruct_prf_0#4119, l_quantity_prf#4101 AS l_quantity_prf_0#4120, l_receiptdate_prf#4102 AS l_receiptdate_prf_0#4121, l_linenumber_prf#4103 AS l_linenumber_prf_0#4122, l_tax_prf#4104 AS l_tax_prf_0#4123, l_shipdate_prf#4105 AS l_shipdate_prf_0#4124, l_extendedprice_prf#4106 AS l_extendedprice_prf_0#4125, l_partkey_prf#4107 AS l_partkey_prf_0#4126, l_discount_prf#4108 AS l_discount_prf_0#4127, l_partkey_and_l_suppkey_prf#4109 AS l_partkey_and_l_suppkey_prf_0#4128, l_commitdate_prf#4110 AS l_commitdate_prf_0#4129, l_suppkey_prf#4111 AS l_suppkey_prf_0#4130, l_orderkey_prf#4112 AS l_orderkey_prf_0#4131]
         :  +- Relation[l_returnflag_prf#4094,l_orderkey_and_l_linenumber_prf#4095,l_comment_prf#4096,l_linestatus_prf#4097,rid#4098,l_shipmode_prf#4099,l_shipinstruct_prf#4100,l_quantity_prf#4101,l_receiptdate_prf#4102,l_linenumber_prf#4103,l_tax_prf#4104,l_shipdate_prf#4105,l_extendedprice_prf#4106,l_partkey_prf#4107,l_discount_prf#4108,l_partkey_and_l_suppkey_prf#4109,l_commitdate_prf#4110,l_suppkey_prf#4111,l_orderkey_prf#4112] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4132]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1502,value#1503] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 23274ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/12 06:37:28 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:37:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4187L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 06:37:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4187L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4189 AS s_phone_prf_0#4197, rid#4190 AS rid_0#4198, s_address_prf#4191 AS s_address_prf_0#4199, s_nationkey_prf#4192 AS s_nationkey_prf_0#4200, s_suppkey_prf#4193 AS s_suppkey_prf_0#4201, s_name_prf#4194 AS s_name_prf_0#4202, s_acctbal_prf#4195 AS s_acctbal_prf_0#4203, s_comment_prf#4196 AS s_comment_prf_0#4204]
         :  :  +- Relation[s_phone_prf#4189,rid#4190,s_address_prf#4191,s_nationkey_prf#4192,s_suppkey_prf#4193,s_name_prf#4194,s_acctbal_prf#4195,s_comment_prf#4196] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4205, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4206]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [p_comment_prf#4207 AS p_comment_prf_1#4217, p_name_prf#4208 AS p_name_prf_1#4218, rid#4209 AS rid_1#4219, p_type_prf#4210 AS p_type_prf_1#4220, p_retailprice_prf#4211 AS p_retailprice_prf_1#4221, p_mfgr_prf#4212 AS p_mfgr_prf_1#4222, p_container_prf#4213 AS p_container_prf_1#4223, p_brand_prf#4214 AS p_brand_prf_1#4224, p_size_prf#4215 AS p_size_prf_1#4225, p_partkey_prf#4216 AS p_partkey_prf_1#4226]
            :  :  +- Relation[p_comment_prf#4207,p_name_prf#4208,rid#4209,p_type_prf#4210,p_retailprice_prf#4211,p_mfgr_prf#4212,p_container_prf#4213,p_brand_prf#4214,p_size_prf#4215,p_partkey_prf#4216] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4227, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4228]
            :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
            :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4229 AS l_returnflag_prf_2#4248, l_orderkey_and_l_linenumber_prf#4230 AS l_orderkey_and_l_linenumber_prf_2#4249, l_comment_prf#4231 AS l_comment_prf_2#4250, l_linestatus_prf#4232 AS l_linestatus_prf_2#4251, rid#4233 AS rid_2#4252, l_shipmode_prf#4234 AS l_shipmode_prf_2#4253, l_shipinstruct_prf#4235 AS l_shipinstruct_prf_2#4254, l_quantity_prf#4236 AS l_quantity_prf_2#4255, l_receiptdate_prf#4237 AS l_receiptdate_prf_2#4256, l_linenumber_prf#4238 AS l_linenumber_prf_2#4257, l_tax_prf#4239 AS l_tax_prf_2#4258, l_shipdate_prf#4240 AS l_shipdate_prf_2#4259, l_extendedprice_prf#4241 AS l_extendedprice_prf_2#4260, l_partkey_prf#4242 AS l_partkey_prf_2#4261, l_discount_prf#4243 AS l_discount_prf_2#4262, l_partkey_and_l_suppkey_prf#4244 AS l_partkey_and_l_suppkey_prf_2#4263, l_commitdate_prf#4245 AS l_commitdate_prf_2#4264, l_suppkey_prf#4246 AS l_suppkey_prf_2#4265, l_orderkey_prf#4247 AS l_orderkey_prf_2#4266]
               +- Relation[l_returnflag_prf#4229,l_orderkey_and_l_linenumber_prf#4230,l_comment_prf#4231,l_linestatus_prf#4232,rid#4233,l_shipmode_prf#4234,l_shipinstruct_prf#4235,l_quantity_prf#4236,l_receiptdate_prf#4237,l_linenumber_prf#4238,l_tax_prf#4239,l_shipdate_prf#4240,l_extendedprice_prf#4241,l_partkey_prf#4242,l_discount_prf#4243,l_partkey_and_l_suppkey_prf#4244,l_commitdate_prf#4245,l_suppkey_prf#4246,l_orderkey_prf#4247] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201272ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/12 06:40:49 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:40:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4316L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 06:40:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4316L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#4318 AS p_comment_prf_0#4328, p_name_prf#4319 AS p_name_prf_0#4329, rid#4320 AS rid_0#4330, p_type_prf#4321 AS p_type_prf_0#4331, p_retailprice_prf#4322 AS p_retailprice_prf_0#4332, p_mfgr_prf#4323 AS p_mfgr_prf_0#4333, p_container_prf#4324 AS p_container_prf_0#4334, p_brand_prf#4325 AS p_brand_prf_0#4335, p_size_prf#4326 AS p_size_prf_0#4336, p_partkey_prf#4327 AS p_partkey_prf_0#4337]
         :  +- Relation[p_comment_prf#4318,p_name_prf#4319,rid#4320,p_type_prf#4321,p_retailprice_prf#4322,p_mfgr_prf#4323,p_container_prf#4324,p_brand_prf#4325,p_size_prf#4326,p_partkey_prf#4327] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4338]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1502,value#1503] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1451
Elapsed time: 81ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/12 06:40:49 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:40:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4369L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 06:40:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4369L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#4371 AS c_acctbal_prf_0#4380, rid#4372 AS rid_0#4381, c_name_prf#4373 AS c_name_prf_0#4382, c_nationkey_prf#4374 AS c_nationkey_prf_0#4383, c_custkey_prf#4375 AS c_custkey_prf_0#4384, c_comment_prf#4376 AS c_comment_prf_0#4385, c_address_prf#4377 AS c_address_prf_0#4386, c_mktsegment_prf#4378 AS c_mktsegment_prf_0#4387, c_phone_prf#4379 AS c_phone_prf_0#4388]
         :  :  +- Relation[c_acctbal_prf#4371,rid#4372,c_name_prf#4373,c_nationkey_prf#4374,c_custkey_prf#4375,c_comment_prf#4376,c_address_prf#4377,c_mktsegment_prf#4378,c_phone_prf#4379] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4389, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4390]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4391 AS o_shippriority_prf_1#4401, rid#4392 AS rid_1#4402, o_orderdate_prf#4393 AS o_orderdate_prf_1#4403, o_custkey_prf#4394 AS o_custkey_prf_1#4404, o_orderpriority_prf#4395 AS o_orderpriority_prf_1#4405, o_clerk_prf#4396 AS o_clerk_prf_1#4406, o_orderstatus_prf#4397 AS o_orderstatus_prf_1#4407, o_totalprice_prf#4398 AS o_totalprice_prf_1#4408, o_orderkey_prf#4399 AS o_orderkey_prf_1#4409, o_comment_prf#4400 AS o_comment_prf_1#4410]
            +- Relation[o_shippriority_prf#4391,rid#4392,o_orderdate_prf#4393,o_custkey_prf#4394,o_orderpriority_prf#4395,o_clerk_prf#4396,o_orderstatus_prf#4397,o_totalprice_prf#4398,o_orderkey_prf#4399,o_comment_prf#4400] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=1500000
Elapsed time: 23597ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/12 06:41:13 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:41:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4458L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 06:41:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4458L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#4460 AS l_returnflag_prf_0#4479, l_orderkey_and_l_linenumber_prf#4461 AS l_orderkey_and_l_linenumber_prf_0#4480, l_comment_prf#4462 AS l_comment_prf_0#4481, l_linestatus_prf#4463 AS l_linestatus_prf_0#4482, rid#4464 AS rid_0#4483, l_shipmode_prf#4465 AS l_shipmode_prf_0#4484, l_shipinstruct_prf#4466 AS l_shipinstruct_prf_0#4485, l_quantity_prf#4467 AS l_quantity_prf_0#4486, l_receiptdate_prf#4468 AS l_receiptdate_prf_0#4487, l_linenumber_prf#4469 AS l_linenumber_prf_0#4488, l_tax_prf#4470 AS l_tax_prf_0#4489, l_shipdate_prf#4471 AS l_shipdate_prf_0#4490, l_extendedprice_prf#4472 AS l_extendedprice_prf_0#4491, l_partkey_prf#4473 AS l_partkey_prf_0#4492, l_discount_prf#4474 AS l_discount_prf_0#4493, l_partkey_and_l_suppkey_prf#4475 AS l_partkey_and_l_suppkey_prf_0#4494, l_commitdate_prf#4476 AS l_commitdate_prf_0#4495, l_suppkey_prf#4477 AS l_suppkey_prf_0#4496, l_orderkey_prf#4478 AS l_orderkey_prf_0#4497]
         :  :  +- Relation[l_returnflag_prf#4460,l_orderkey_and_l_linenumber_prf#4461,l_comment_prf#4462,l_linestatus_prf#4463,rid#4464,l_shipmode_prf#4465,l_shipinstruct_prf#4466,l_quantity_prf#4467,l_receiptdate_prf#4468,l_linenumber_prf#4469,l_tax_prf#4470,l_shipdate_prf#4471,l_extendedprice_prf#4472,l_partkey_prf#4473,l_discount_prf#4474,l_partkey_and_l_suppkey_prf#4475,l_commitdate_prf#4476,l_suppkey_prf#4477,l_orderkey_prf#4478] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4498, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4499]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4500 AS o_shippriority_prf_1#4510, rid#4501 AS rid_1#4511, o_orderdate_prf#4502 AS o_orderdate_prf_1#4512, o_custkey_prf#4503 AS o_custkey_prf_1#4513, o_orderpriority_prf#4504 AS o_orderpriority_prf_1#4514, o_clerk_prf#4505 AS o_clerk_prf_1#4515, o_orderstatus_prf#4506 AS o_orderstatus_prf_1#4516, o_totalprice_prf#4507 AS o_totalprice_prf_1#4517, o_orderkey_prf#4508 AS o_orderkey_prf_1#4518, o_comment_prf#4509 AS o_comment_prf_1#4519]
            +- Relation[o_shippriority_prf#4500,rid#4501,o_orderdate_prf#4502,o_custkey_prf#4503,o_orderpriority_prf#4504,o_clerk_prf#4505,o_orderstatus_prf#4506,o_totalprice_prf#4507,o_orderkey_prf#4508,o_comment_prf#4509] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 108497ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/12 06:43:01 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:43:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4573L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 06:43:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4573L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4575 AS s_phone_prf_0#4583, rid#4576 AS rid_0#4584, s_address_prf#4577 AS s_address_prf_0#4585, s_nationkey_prf#4578 AS s_nationkey_prf_0#4586, s_suppkey_prf#4579 AS s_suppkey_prf_0#4587, s_name_prf#4580 AS s_name_prf_0#4588, s_acctbal_prf#4581 AS s_acctbal_prf_0#4589, s_comment_prf#4582 AS s_comment_prf_0#4590]
         :  :  +- Relation[s_phone_prf#4575,rid#4576,s_address_prf#4577,s_nationkey_prf#4578,s_suppkey_prf#4579,s_name_prf#4580,s_acctbal_prf#4581,s_comment_prf#4582] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4591, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4592]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [p_comment_prf#4593 AS p_comment_prf_1#4603, p_name_prf#4594 AS p_name_prf_1#4604, rid#4595 AS rid_1#4605, p_type_prf#4596 AS p_type_prf_1#4606, p_retailprice_prf#4597 AS p_retailprice_prf_1#4607, p_mfgr_prf#4598 AS p_mfgr_prf_1#4608, p_container_prf#4599 AS p_container_prf_1#4609, p_brand_prf#4600 AS p_brand_prf_1#4610, p_size_prf#4601 AS p_size_prf_1#4611, p_partkey_prf#4602 AS p_partkey_prf_1#4612]
            :  :  +- Relation[p_comment_prf#4593,p_name_prf#4594,rid#4595,p_type_prf#4596,p_retailprice_prf#4597,p_mfgr_prf#4598,p_container_prf#4599,p_brand_prf#4600,p_size_prf#4601,p_partkey_prf#4602] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4613, dexdecrypt('value_dec_key, 'value_right) AS rid_2#4614]
            :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
            :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#4615 AS ps_partkey_and_ps_suppkey_prf_2#4622, rid#4616 AS rid_2#4623, ps_availqty_prf#4617 AS ps_availqty_prf_2#4624, ps_comment_prf#4618 AS ps_comment_prf_2#4625, ps_partkey_prf#4619 AS ps_partkey_prf_2#4626, ps_supplycost_prf#4620 AS ps_supplycost_prf_2#4627, ps_suppkey_prf#4621 AS ps_suppkey_prf_2#4628]
               +- Relation[ps_partkey_and_ps_suppkey_prf#4615,rid#4616,ps_availqty_prf#4617,ps_comment_prf#4618,ps_partkey_prf#4619,ps_supplycost_prf#4620,ps_suppkey_prf#4621] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26231ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/12 06:43:27 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:43:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4661L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 06:43:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4661L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#4663 AS rid_0#4668, n_regionkey_prf#4664 AS n_regionkey_prf_0#4669, n_nationkey_prf#4665 AS n_nationkey_prf_0#4670, n_name_prf#4666 AS n_name_prf_0#4671, n_comment_prf#4667 AS n_comment_prf_0#4672]
         :  +- Relation[rid#4663,n_regionkey_prf#4664,n_nationkey_prf#4665,n_name_prf#4666,n_comment_prf#4667] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4673]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1502,value#1503] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1
Elapsed time: 51ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/12 06:43:27 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:43:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4705L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 06:43:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4705L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4707 AS s_phone_prf_0#4715, rid#4708 AS rid_0#4716, s_address_prf#4709 AS s_address_prf_0#4717, s_nationkey_prf#4710 AS s_nationkey_prf_0#4718, s_suppkey_prf#4711 AS s_suppkey_prf_0#4719, s_name_prf#4712 AS s_name_prf_0#4720, s_acctbal_prf#4713 AS s_acctbal_prf_0#4721, s_comment_prf#4714 AS s_comment_prf_0#4722]
         :  :  +- Relation[s_phone_prf#4707,rid#4708,s_address_prf#4709,s_nationkey_prf#4710,s_suppkey_prf#4711,s_name_prf#4712,s_acctbal_prf#4713,s_comment_prf#4714] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4723, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4724]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4725 AS l_returnflag_prf_1#4744, l_orderkey_and_l_linenumber_prf#4726 AS l_orderkey_and_l_linenumber_prf_1#4745, l_comment_prf#4727 AS l_comment_prf_1#4746, l_linestatus_prf#4728 AS l_linestatus_prf_1#4747, rid#4729 AS rid_1#4748, l_shipmode_prf#4730 AS l_shipmode_prf_1#4749, l_shipinstruct_prf#4731 AS l_shipinstruct_prf_1#4750, l_quantity_prf#4732 AS l_quantity_prf_1#4751, l_receiptdate_prf#4733 AS l_receiptdate_prf_1#4752, l_linenumber_prf#4734 AS l_linenumber_prf_1#4753, l_tax_prf#4735 AS l_tax_prf_1#4754, l_shipdate_prf#4736 AS l_shipdate_prf_1#4755, l_extendedprice_prf#4737 AS l_extendedprice_prf_1#4756, l_partkey_prf#4738 AS l_partkey_prf_1#4757, l_discount_prf#4739 AS l_discount_prf_1#4758, l_partkey_and_l_suppkey_prf#4740 AS l_partkey_and_l_suppkey_prf_1#4759, l_commitdate_prf#4741 AS l_commitdate_prf_1#4760, l_suppkey_prf#4742 AS l_suppkey_prf_1#4761, l_orderkey_prf#4743 AS l_orderkey_prf_1#4762]
            +- Relation[l_returnflag_prf#4725,l_orderkey_and_l_linenumber_prf#4726,l_comment_prf#4727,l_linestatus_prf#4728,rid#4729,l_shipmode_prf#4730,l_shipinstruct_prf#4731,l_quantity_prf#4732,l_receiptdate_prf#4733,l_linenumber_prf#4734,l_tax_prf#4735,l_shipdate_prf#4736,l_extendedprice_prf#4737,l_partkey_prf#4738,l_discount_prf#4739,l_partkey_and_l_suppkey_prf#4740,l_commitdate_prf#4741,l_suppkey_prf#4742,l_orderkey_prf#4743] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 89191ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/12 06:44:57 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:44:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4805L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 06:44:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4805L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4807 AS s_phone_prf_0#4815, rid#4808 AS rid_0#4816, s_address_prf#4809 AS s_address_prf_0#4817, s_nationkey_prf#4810 AS s_nationkey_prf_0#4818, s_suppkey_prf#4811 AS s_suppkey_prf_0#4819, s_name_prf#4812 AS s_name_prf_0#4820, s_acctbal_prf#4813 AS s_acctbal_prf_0#4821, s_comment_prf#4814 AS s_comment_prf_0#4822]
         :  :  +- Relation[s_phone_prf#4807,rid#4808,s_address_prf#4809,s_nationkey_prf#4810,s_suppkey_prf#4811,s_name_prf#4812,s_acctbal_prf#4813,s_comment_prf#4814] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4823, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4824]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4825 AS ps_partkey_and_ps_suppkey_prf_1#4832, rid#4826 AS rid_1#4833, ps_availqty_prf#4827 AS ps_availqty_prf_1#4834, ps_comment_prf#4828 AS ps_comment_prf_1#4835, ps_partkey_prf#4829 AS ps_partkey_prf_1#4836, ps_supplycost_prf#4830 AS ps_supplycost_prf_1#4837, ps_suppkey_prf#4831 AS ps_suppkey_prf_1#4838]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4825,rid#4826,ps_availqty_prf#4827,ps_comment_prf#4828,ps_partkey_prf#4829,ps_supplycost_prf#4830,ps_suppkey_prf#4831] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 11706ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/12 06:45:08 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:45:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4871L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 06:45:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4871L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [p_comment_prf#4873 AS p_comment_prf_0#4883, p_name_prf#4874 AS p_name_prf_0#4884, rid#4875 AS rid_0#4885, p_type_prf#4876 AS p_type_prf_0#4886, p_retailprice_prf#4877 AS p_retailprice_prf_0#4887, p_mfgr_prf#4878 AS p_mfgr_prf_0#4888, p_container_prf#4879 AS p_container_prf_0#4889, p_brand_prf#4880 AS p_brand_prf_0#4890, p_size_prf#4881 AS p_size_prf_0#4891, p_partkey_prf#4882 AS p_partkey_prf_0#4892]
         :  :  :  +- Relation[p_comment_prf#4873,p_name_prf#4874,rid#4875,p_type_prf#4876,p_retailprice_prf#4877,p_mfgr_prf#4878,p_container_prf#4879,p_brand_prf#4880,p_size_prf#4881,p_partkey_prf#4882] JDBCRelation(part_prf) [numPartitions=1]
         :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4893]
         :  :     +- DexRidFilter part~p_size~15
         :  :        +- Relation[label#1502,value#1503] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4894, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4895]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4896 AS ps_partkey_and_ps_suppkey_prf_1#4903, rid#4897 AS rid_1#4904, ps_availqty_prf#4898 AS ps_availqty_prf_1#4905, ps_comment_prf#4899 AS ps_comment_prf_1#4906, ps_partkey_prf#4900 AS ps_partkey_prf_1#4907, ps_supplycost_prf#4901 AS ps_supplycost_prf_1#4908, ps_suppkey_prf#4902 AS ps_suppkey_prf_1#4909]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4896,rid#4897,ps_availqty_prf#4898,ps_comment_prf#4899,ps_partkey_prf#4900,ps_supplycost_prf#4901,ps_suppkey_prf#4902] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=15628
Elapsed time: 7785ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/12 06:45:16 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:45:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4937L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 06:45:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4937L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [r_regionkey_prf#4939 AS r_regionkey_prf_0#4943, r_name_prf#4940 AS r_name_prf_0#4944, r_comment_prf#4941 AS r_comment_prf_0#4945, rid#4942 AS rid_0#4946]
         :  :  +- Relation[r_regionkey_prf#4939,r_name_prf#4940,r_comment_prf#4941,rid#4942] JDBCRelation(region_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4947, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4948]
         :     +- SpxRidUncorrelatedJoin nation~n_regionkey~region~r_regionkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [rid#4949 AS rid_1#4954, n_regionkey_prf#4950 AS n_regionkey_prf_1#4955, n_nationkey_prf#4951 AS n_nationkey_prf_1#4956, n_name_prf#4952 AS n_name_prf_1#4957, n_comment_prf#4953 AS n_comment_prf_1#4958]
            +- Relation[rid#4949,n_regionkey_prf#4950,n_nationkey_prf#4951,n_name_prf#4952,n_comment_prf#4953] JDBCRelation(nation_prf) [numPartitions=1]

DexSpx$ result size=25
Elapsed time: 66ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/12 06:45:16 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 06:45:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4990L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 06:45:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4990L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#4992 AS c_acctbal_prf_0#5001, rid#4993 AS rid_0#5002, c_name_prf#4994 AS c_name_prf_0#5003, c_nationkey_prf#4995 AS c_nationkey_prf_0#5004, c_custkey_prf#4996 AS c_custkey_prf_0#5005, c_comment_prf#4997 AS c_comment_prf_0#5006, c_address_prf#4998 AS c_address_prf_0#5007, c_mktsegment_prf#4999 AS c_mktsegment_prf_0#5008, c_phone_prf#5000 AS c_phone_prf_0#5009]
         :  :  +- Relation[c_acctbal_prf#4992,rid#4993,c_name_prf#4994,c_nationkey_prf#4995,c_custkey_prf#4996,c_comment_prf#4997,c_address_prf#4998,c_mktsegment_prf#4999,c_phone_prf#5000] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5010, dexdecrypt('value_dec_key, 'value_right) AS rid_2#5011]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [s_phone_prf#5012 AS s_phone_prf_1#5020, rid#5013 AS rid_1#5021, s_address_prf#5014 AS s_address_prf_1#5022, s_nationkey_prf#5015 AS s_nationkey_prf_1#5023, s_suppkey_prf#5016 AS s_suppkey_prf_1#5024, s_name_prf#5017 AS s_name_prf_1#5025, s_acctbal_prf#5018 AS s_acctbal_prf_1#5026, s_comment_prf#5019 AS s_comment_prf_1#5027]
            :  :  +- Relation[s_phone_prf#5012,rid#5013,s_address_prf#5014,s_nationkey_prf#5015,s_suppkey_prf#5016,s_name_prf#5017,s_acctbal_prf#5018,s_comment_prf#5019] JDBCRelation(supplier_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#5028, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5029]
            :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
            :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [rid#5030 AS rid_2#5035, n_regionkey_prf#5031 AS n_regionkey_prf_2#5036, n_nationkey_prf#5032 AS n_nationkey_prf_2#5037, n_name_prf#5033 AS n_name_prf_2#5038, n_comment_prf#5034 AS n_comment_prf_2#5039]
               +- Relation[rid#5030,n_regionkey_prf#5031,n_nationkey_prf#5032,n_name_prf#5033,n_comment_prf#5034] JDBCRelation(nation_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 905681ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/12 07:00:22 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:00:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5098L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 07:00:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5098L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [c_acctbal_prf#5100 AS c_acctbal_prf_0#5109, rid#5101 AS rid_0#5110, c_name_prf#5102 AS c_name_prf_0#5111, c_nationkey_prf#5103 AS c_nationkey_prf_0#5112, c_custkey_prf#5104 AS c_custkey_prf_0#5113, c_comment_prf#5105 AS c_comment_prf_0#5114, c_address_prf#5106 AS c_address_prf_0#5115, c_mktsegment_prf#5107 AS c_mktsegment_prf_0#5116, c_phone_prf#5108 AS c_phone_prf_0#5117]
         :  :  :  :  +- Relation[c_acctbal_prf#5100,rid#5101,c_name_prf#5102,c_nationkey_prf#5103,c_custkey_prf#5104,c_comment_prf#5105,c_address_prf#5106,c_mktsegment_prf#5107,c_phone_prf#5108] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5118, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5119]
         :  :  :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :  :  :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#5120 AS o_shippriority_prf_1#5130, rid#5121 AS rid_1#5131, o_orderdate_prf#5122 AS o_orderdate_prf_1#5132, o_custkey_prf#5123 AS o_custkey_prf_1#5133, o_orderpriority_prf#5124 AS o_orderpriority_prf_1#5134, o_clerk_prf#5125 AS o_clerk_prf_1#5135, o_orderstatus_prf#5126 AS o_orderstatus_prf_1#5136, o_totalprice_prf#5127 AS o_totalprice_prf_1#5137, o_orderkey_prf#5128 AS o_orderkey_prf_1#5138, o_comment_prf#5129 AS o_comment_prf_1#5139]
         :  :     +- Relation[o_shippriority_prf#5120,rid#5121,o_orderdate_prf#5122,o_custkey_prf#5123,o_orderpriority_prf#5124,o_clerk_prf#5125,o_orderstatus_prf#5126,o_totalprice_prf#5127,o_orderkey_prf#5128,o_comment_prf#5129] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#5140, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5141]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5142 AS l_returnflag_prf_2#5161, l_orderkey_and_l_linenumber_prf#5143 AS l_orderkey_and_l_linenumber_prf_2#5162, l_comment_prf#5144 AS l_comment_prf_2#5163, l_linestatus_prf#5145 AS l_linestatus_prf_2#5164, rid#5146 AS rid_2#5165, l_shipmode_prf#5147 AS l_shipmode_prf_2#5166, l_shipinstruct_prf#5148 AS l_shipinstruct_prf_2#5167, l_quantity_prf#5149 AS l_quantity_prf_2#5168, l_receiptdate_prf#5150 AS l_receiptdate_prf_2#5169, l_linenumber_prf#5151 AS l_linenumber_prf_2#5170, l_tax_prf#5152 AS l_tax_prf_2#5171, l_shipdate_prf#5153 AS l_shipdate_prf_2#5172, l_extendedprice_prf#5154 AS l_extendedprice_prf_2#5173, l_partkey_prf#5155 AS l_partkey_prf_2#5174, l_discount_prf#5156 AS l_discount_prf_2#5175, l_partkey_and_l_suppkey_prf#5157 AS l_partkey_and_l_suppkey_prf_2#5176, l_commitdate_prf#5158 AS l_commitdate_prf_2#5177, l_suppkey_prf#5159 AS l_suppkey_prf_2#5178, l_orderkey_prf#5160 AS l_orderkey_prf_2#5179]
            +- Relation[l_returnflag_prf#5142,l_orderkey_and_l_linenumber_prf#5143,l_comment_prf#5144,l_linestatus_prf#5145,rid#5146,l_shipmode_prf#5147,l_shipinstruct_prf#5148,l_quantity_prf#5149,l_receiptdate_prf#5150,l_linenumber_prf#5151,l_tax_prf#5152,l_shipdate_prf#5153,l_extendedprice_prf#5154,l_partkey_prf#5155,l_discount_prf#5156,l_partkey_and_l_suppkey_prf#5157,l_commitdate_prf#5158,l_suppkey_prf#5159,l_orderkey_prf#5160] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 170162ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/12 07:03:12 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:03:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5246L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 07:03:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5246L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [l_returnflag_prf#5248 AS l_returnflag_prf_0#5267, l_orderkey_and_l_linenumber_prf#5249 AS l_orderkey_and_l_linenumber_prf_0#5268, l_comment_prf#5250 AS l_comment_prf_0#5269, l_linestatus_prf#5251 AS l_linestatus_prf_0#5270, rid#5252 AS rid_0#5271, l_shipmode_prf#5253 AS l_shipmode_prf_0#5272, l_shipinstruct_prf#5254 AS l_shipinstruct_prf_0#5273, l_quantity_prf#5255 AS l_quantity_prf_0#5274, l_receiptdate_prf#5256 AS l_receiptdate_prf_0#5275, l_linenumber_prf#5257 AS l_linenumber_prf_0#5276, l_tax_prf#5258 AS l_tax_prf_0#5277, l_shipdate_prf#5259 AS l_shipdate_prf_0#5278, l_extendedprice_prf#5260 AS l_extendedprice_prf_0#5279, l_partkey_prf#5261 AS l_partkey_prf_0#5280, l_discount_prf#5262 AS l_discount_prf_0#5281, l_partkey_and_l_suppkey_prf#5263 AS l_partkey_and_l_suppkey_prf_0#5282, l_commitdate_prf#5264 AS l_commitdate_prf_0#5283, l_suppkey_prf#5265 AS l_suppkey_prf_0#5284, l_orderkey_prf#5266 AS l_orderkey_prf_0#5285]
         :  :  :  +- Relation[l_returnflag_prf#5248,l_orderkey_and_l_linenumber_prf#5249,l_comment_prf#5250,l_linestatus_prf#5251,rid#5252,l_shipmode_prf#5253,l_shipinstruct_prf#5254,l_quantity_prf#5255,l_receiptdate_prf#5256,l_linenumber_prf#5257,l_tax_prf#5258,l_shipdate_prf#5259,l_extendedprice_prf#5260,l_partkey_prf#5261,l_discount_prf#5262,l_partkey_and_l_suppkey_prf#5263,l_commitdate_prf#5264,l_suppkey_prf#5265,l_orderkey_prf#5266] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5286]
         :  :     +- DexRidFilter lineitem~l_returnflag~R
         :  :        +- Relation[label#1502,value#1503] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5287, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5288]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#5289 AS o_shippriority_prf_1#5299, rid#5290 AS rid_1#5300, o_orderdate_prf#5291 AS o_orderdate_prf_1#5301, o_custkey_prf#5292 AS o_custkey_prf_1#5302, o_orderpriority_prf#5293 AS o_orderpriority_prf_1#5303, o_clerk_prf#5294 AS o_clerk_prf_1#5304, o_orderstatus_prf#5295 AS o_orderstatus_prf_1#5305, o_totalprice_prf#5296 AS o_totalprice_prf_1#5306, o_orderkey_prf#5297 AS o_orderkey_prf_1#5307, o_comment_prf#5298 AS o_comment_prf_1#5308]
            +- Relation[o_shippriority_prf#5289,rid#5290,o_orderdate_prf#5291,o_custkey_prf#5292,o_orderpriority_prf#5293,o_clerk_prf#5294,o_orderstatus_prf#5295,o_totalprice_prf#5296,o_orderkey_prf#5297,o_comment_prf#5298] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 97563ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/12 07:04:50 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:04:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5355L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 07:04:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5355L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [ps_partkey_and_ps_suppkey_prf#5357 AS ps_partkey_and_ps_suppkey_prf_0#5364, rid#5358 AS rid_0#5365, ps_availqty_prf#5359 AS ps_availqty_prf_0#5366, ps_comment_prf#5360 AS ps_comment_prf_0#5367, ps_partkey_prf#5361 AS ps_partkey_prf_0#5368, ps_supplycost_prf#5362 AS ps_supplycost_prf_0#5369, ps_suppkey_prf#5363 AS ps_suppkey_prf_0#5370]
         :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#5357,rid#5358,ps_availqty_prf#5359,ps_comment_prf#5360,ps_partkey_prf#5361,ps_supplycost_prf#5362,ps_suppkey_prf#5363] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#5371, dexdecrypt('value_dec_key, 'value_right) AS rid_0#5372]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#5373 AS p_comment_prf_1#5383, p_name_prf#5374 AS p_name_prf_1#5384, rid#5375 AS rid_1#5385, p_type_prf#5376 AS p_type_prf_1#5386, p_retailprice_prf#5377 AS p_retailprice_prf_1#5387, p_mfgr_prf#5378 AS p_mfgr_prf_1#5388, p_container_prf#5379 AS p_container_prf_1#5389, p_brand_prf#5380 AS p_brand_prf_1#5390, p_size_prf#5381 AS p_size_prf_1#5391, p_partkey_prf#5382 AS p_partkey_prf_1#5392]
            :  +- Relation[p_comment_prf#5373,p_name_prf#5374,rid#5375,p_type_prf#5376,p_retailprice_prf#5377,p_mfgr_prf#5378,p_container_prf#5379,p_brand_prf#5380,p_size_prf#5381,p_partkey_prf#5382] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5393]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1502,value#1503] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=15628
Elapsed time: 7742ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/12 07:04:57 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 07:04:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5425L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 07:04:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5425L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [rid#5427 AS rid_0#5432, n_regionkey_prf#5428 AS n_regionkey_prf_0#5433, n_nationkey_prf#5429 AS n_nationkey_prf_0#5434, n_name_prf#5430 AS n_name_prf_0#5435, n_comment_prf#5431 AS n_comment_prf_0#5436]
         :  :  +- Relation[rid#5427,n_regionkey_prf#5428,n_nationkey_prf#5429,n_name_prf#5430,n_comment_prf#5431] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5437, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5438]
         :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :        +- Relation[label#1561,value_left#1562,value_right#1563] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#5439 AS s_phone_prf_1#5447, rid#5440 AS rid_1#5448, s_address_prf#5441 AS s_address_prf_1#5449, s_nationkey_prf#5442 AS s_nationkey_prf_1#5450, s_suppkey_prf#5443 AS s_suppkey_prf_1#5451, s_name_prf#5444 AS s_name_prf_1#5452, s_acctbal_prf#5445 AS s_acctbal_prf_1#5453, s_comment_prf#5446 AS s_comment_prf_1#5454]
            +- Relation[s_phone_prf#5439,rid#5440,s_address_prf#5441,s_nationkey_prf#5442,s_suppkey_prf#5443,s_name_prf#5444,s_acctbal_prf#5445,s_comment_prf#5446] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=10000
Elapsed time: 222ms
query=b1a, count=15628, duration=7785
query=b1b, count=15628, duration=7742
query=b2a, count=1478870, duration=98762
query=b2b, count=1478870, duration=97563
query=f1, count=1, duration=54
query=f2, count=3907, duration=292
query=f3, count=1451, duration=81
query=f4, count=1, duration=51
query=f5, count=1478870, duration=23274
query=f6, count=857401, duration=13632
query=j1, count=800000, duration=12239
query=j10, count=6001215, duration=89191
query=j2, count=800000, duration=11706
query=j3, count=25, duration=66
query=j4, count=150000, duration=2538
query=j5, count=10000, duration=222
query=j6, count=6001215, duration=106419
query=j7, count=1500000, duration=23597
query=j8, count=6001215, duration=107570
query=j8b, count=6001215, duration=108497
query=j9, count=6001215, duration=94982
query=j9b, count=6001215, duration=94894
query=r1a, count=6001215, duration=183121
query=r1b, count=6001215, duration=183784
query=r1c, count=6001215, duration=181914
query=r1d, count=6001215, duration=170162
query=r1e, count=6001215, duration=170915
query=r1f, count=6001215, duration=143093
query=t1a, count=60000414, duration=893880
query=t1b, count=60000414, duration=894682
query=t1c, count=60000414, duration=905681
query=t2a, count=800000, duration=26319
query=t2b, count=800000, duration=26136
query=t2c, count=800000, duration=26231
query=t2d, count=800000, duration=26137
query=t3a, count=6001215, duration=202081
query=t3b, count=6001215, duration=201748
query=t3c, count=6001215, duration=201272
query=t3d, count=6001215, duration=202110
