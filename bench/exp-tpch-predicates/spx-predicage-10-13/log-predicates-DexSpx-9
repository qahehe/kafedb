19/10/12 16:19:04 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7236ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Oct 12 16:19:06 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Oct 12 16:19:07 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Oct 12 16:19:07 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Oct 12 16:19:07 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Oct 12 16:19:07 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Oct 12 16:19:10 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Oct 12 16:19:12 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Oct 12 16:19:12 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/12 16:19:13 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:19:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1485L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 16:19:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1485L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [p_comment_prf#1487 AS p_comment_prf_0#1497, p_name_prf#1488 AS p_name_prf_0#1498, rid#1489 AS rid_0#1499, p_type_prf#1490 AS p_type_prf_0#1500, p_retailprice_prf#1491 AS p_retailprice_prf_0#1501, p_mfgr_prf#1492 AS p_mfgr_prf_0#1502, p_container_prf#1493 AS p_container_prf_0#1503, p_brand_prf#1494 AS p_brand_prf_0#1504, p_size_prf#1495 AS p_size_prf_0#1505, p_partkey_prf#1496 AS p_partkey_prf_0#1506]
         :  :  +- Relation[p_comment_prf#1487,p_name_prf#1488,rid#1489,p_type_prf#1490,p_retailprice_prf#1491,p_mfgr_prf#1492,p_container_prf#1493,p_brand_prf#1494,p_size_prf#1495,p_partkey_prf#1496] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1510, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1511]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#1512 AS ps_partkey_and_ps_suppkey_prf_1#1519, rid#1513 AS rid_1#1520, ps_availqty_prf#1514 AS ps_availqty_prf_1#1521, ps_comment_prf#1515 AS ps_comment_prf_1#1522, ps_partkey_prf#1516 AS ps_partkey_prf_1#1523, ps_supplycost_prf#1517 AS ps_supplycost_prf_1#1524, ps_suppkey_prf#1518 AS ps_suppkey_prf_1#1525]
            +- Relation[ps_partkey_and_ps_suppkey_prf#1512,rid#1513,ps_availqty_prf#1514,ps_comment_prf#1515,ps_partkey_prf#1516,ps_supplycost_prf#1517,ps_suppkey_prf#1518] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 12352ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/12 16:19:26 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:19:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1579L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 16:19:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1579L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [c_acctbal_prf#1581 AS c_acctbal_prf_0#1590, rid#1582 AS rid_0#1591, c_name_prf#1583 AS c_name_prf_0#1592, c_nationkey_prf#1584 AS c_nationkey_prf_0#1593, c_custkey_prf#1585 AS c_custkey_prf_0#1594, c_comment_prf#1586 AS c_comment_prf_0#1595, c_address_prf#1587 AS c_address_prf_0#1596, c_mktsegment_prf#1588 AS c_mktsegment_prf_0#1597, c_phone_prf#1589 AS c_phone_prf_0#1598]
         :  :  :  :  +- Relation[c_acctbal_prf#1581,rid#1582,c_name_prf#1583,c_nationkey_prf#1584,c_custkey_prf#1585,c_comment_prf#1586,c_address_prf#1587,c_mktsegment_prf#1588,c_phone_prf#1589] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1599, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1600]
         :  :  :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :  :  :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#1601 AS o_shippriority_prf_1#1611, rid#1602 AS rid_1#1612, o_orderdate_prf#1603 AS o_orderdate_prf_1#1613, o_custkey_prf#1604 AS o_custkey_prf_1#1614, o_orderpriority_prf#1605 AS o_orderpriority_prf_1#1615, o_clerk_prf#1606 AS o_clerk_prf_1#1616, o_orderstatus_prf#1607 AS o_orderstatus_prf_1#1617, o_totalprice_prf#1608 AS o_totalprice_prf_1#1618, o_orderkey_prf#1609 AS o_orderkey_prf_1#1619, o_comment_prf#1610 AS o_comment_prf_1#1620]
         :  :     +- Relation[o_shippriority_prf#1601,rid#1602,o_orderdate_prf#1603,o_custkey_prf#1604,o_orderpriority_prf#1605,o_clerk_prf#1606,o_orderstatus_prf#1607,o_totalprice_prf#1608,o_orderkey_prf#1609,o_comment_prf#1610] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#1621, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1622]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1623 AS l_returnflag_prf_2#1642, l_orderkey_and_l_linenumber_prf#1624 AS l_orderkey_and_l_linenumber_prf_2#1643, l_comment_prf#1625 AS l_comment_prf_2#1644, l_linestatus_prf#1626 AS l_linestatus_prf_2#1645, rid#1627 AS rid_2#1646, l_shipmode_prf#1628 AS l_shipmode_prf_2#1647, l_shipinstruct_prf#1629 AS l_shipinstruct_prf_2#1648, l_quantity_prf#1630 AS l_quantity_prf_2#1649, l_receiptdate_prf#1631 AS l_receiptdate_prf_2#1650, l_linenumber_prf#1632 AS l_linenumber_prf_2#1651, l_tax_prf#1633 AS l_tax_prf_2#1652, l_shipdate_prf#1634 AS l_shipdate_prf_2#1653, l_extendedprice_prf#1635 AS l_extendedprice_prf_2#1654, l_partkey_prf#1636 AS l_partkey_prf_2#1655, l_discount_prf#1637 AS l_discount_prf_2#1656, l_partkey_and_l_suppkey_prf#1638 AS l_partkey_and_l_suppkey_prf_2#1657, l_commitdate_prf#1639 AS l_commitdate_prf_2#1658, l_suppkey_prf#1640 AS l_suppkey_prf_2#1659, l_orderkey_prf#1641 AS l_orderkey_prf_2#1660]
            +- Relation[l_returnflag_prf#1623,l_orderkey_and_l_linenumber_prf#1624,l_comment_prf#1625,l_linestatus_prf#1626,rid#1627,l_shipmode_prf#1628,l_shipinstruct_prf#1629,l_quantity_prf#1630,l_receiptdate_prf#1631,l_linenumber_prf#1632,l_tax_prf#1633,l_shipdate_prf#1634,l_extendedprice_prf#1635,l_partkey_prf#1636,l_discount_prf#1637,l_partkey_and_l_suppkey_prf#1638,l_commitdate_prf#1639,l_suppkey_prf#1640,l_orderkey_prf#1641] JDBCRelation(lineitem_prf) [numPartitions=1]

19/10/12 16:19:26 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexSpx$ result size=6001215
Elapsed time: 169549ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/12 16:22:15 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:22:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1727L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 16:22:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1727L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#1729 AS l_returnflag_prf_0#1748, l_orderkey_and_l_linenumber_prf#1730 AS l_orderkey_and_l_linenumber_prf_0#1749, l_comment_prf#1731 AS l_comment_prf_0#1750, l_linestatus_prf#1732 AS l_linestatus_prf_0#1751, rid#1733 AS rid_0#1752, l_shipmode_prf#1734 AS l_shipmode_prf_0#1753, l_shipinstruct_prf#1735 AS l_shipinstruct_prf_0#1754, l_quantity_prf#1736 AS l_quantity_prf_0#1755, l_receiptdate_prf#1737 AS l_receiptdate_prf_0#1756, l_linenumber_prf#1738 AS l_linenumber_prf_0#1757, l_tax_prf#1739 AS l_tax_prf_0#1758, l_shipdate_prf#1740 AS l_shipdate_prf_0#1759, l_extendedprice_prf#1741 AS l_extendedprice_prf_0#1760, l_partkey_prf#1742 AS l_partkey_prf_0#1761, l_discount_prf#1743 AS l_discount_prf_0#1762, l_partkey_and_l_suppkey_prf#1744 AS l_partkey_and_l_suppkey_prf_0#1763, l_commitdate_prf#1745 AS l_commitdate_prf_0#1764, l_suppkey_prf#1746 AS l_suppkey_prf_0#1765, l_orderkey_prf#1747 AS l_orderkey_prf_0#1766]
         :  :  +- Relation[l_returnflag_prf#1729,l_orderkey_and_l_linenumber_prf#1730,l_comment_prf#1731,l_linestatus_prf#1732,rid#1733,l_shipmode_prf#1734,l_shipinstruct_prf#1735,l_quantity_prf#1736,l_receiptdate_prf#1737,l_linenumber_prf#1738,l_tax_prf#1739,l_shipdate_prf#1740,l_extendedprice_prf#1741,l_partkey_prf#1742,l_discount_prf#1743,l_partkey_and_l_suppkey_prf#1744,l_commitdate_prf#1745,l_suppkey_prf#1746,l_orderkey_prf#1747] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1767, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1768]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#1769 AS o_shippriority_prf_1#1779, rid#1770 AS rid_1#1780, o_orderdate_prf#1771 AS o_orderdate_prf_1#1781, o_custkey_prf#1772 AS o_custkey_prf_1#1782, o_orderpriority_prf#1773 AS o_orderpriority_prf_1#1783, o_clerk_prf#1774 AS o_clerk_prf_1#1784, o_orderstatus_prf#1775 AS o_orderstatus_prf_1#1785, o_totalprice_prf#1776 AS o_totalprice_prf_1#1786, o_orderkey_prf#1777 AS o_orderkey_prf_1#1787, o_comment_prf#1778 AS o_comment_prf_1#1788]
            +- Relation[o_shippriority_prf#1769,rid#1770,o_orderdate_prf#1771,o_custkey_prf#1772,o_orderpriority_prf#1773,o_clerk_prf#1774,o_orderstatus_prf#1775,o_totalprice_prf#1776,o_orderkey_prf#1777,o_comment_prf#1778] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 107069ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/12 16:24:02 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:24:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1853L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 16:24:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1853L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [p_comment_prf#1855 AS p_comment_prf_0#1865, p_name_prf#1856 AS p_name_prf_0#1866, rid#1857 AS rid_0#1867, p_type_prf#1858 AS p_type_prf_0#1868, p_retailprice_prf#1859 AS p_retailprice_prf_0#1869, p_mfgr_prf#1860 AS p_mfgr_prf_0#1870, p_container_prf#1861 AS p_container_prf_0#1871, p_brand_prf#1862 AS p_brand_prf_0#1872, p_size_prf#1863 AS p_size_prf_0#1873, p_partkey_prf#1864 AS p_partkey_prf_0#1874]
         :  :  :  :  +- Relation[p_comment_prf#1855,p_name_prf#1856,rid#1857,p_type_prf#1858,p_retailprice_prf#1859,p_mfgr_prf#1860,p_container_prf#1861,p_brand_prf#1862,p_size_prf#1863,p_partkey_prf#1864] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1875, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1876]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :  :  :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#1877 AS l_returnflag_prf_1#1896, l_orderkey_and_l_linenumber_prf#1878 AS l_orderkey_and_l_linenumber_prf_1#1897, l_comment_prf#1879 AS l_comment_prf_1#1898, l_linestatus_prf#1880 AS l_linestatus_prf_1#1899, rid#1881 AS rid_1#1900, l_shipmode_prf#1882 AS l_shipmode_prf_1#1901, l_shipinstruct_prf#1883 AS l_shipinstruct_prf_1#1902, l_quantity_prf#1884 AS l_quantity_prf_1#1903, l_receiptdate_prf#1885 AS l_receiptdate_prf_1#1904, l_linenumber_prf#1886 AS l_linenumber_prf_1#1905, l_tax_prf#1887 AS l_tax_prf_1#1906, l_shipdate_prf#1888 AS l_shipdate_prf_1#1907, l_extendedprice_prf#1889 AS l_extendedprice_prf_1#1908, l_partkey_prf#1890 AS l_partkey_prf_1#1909, l_discount_prf#1891 AS l_discount_prf_1#1910, l_partkey_and_l_suppkey_prf#1892 AS l_partkey_and_l_suppkey_prf_1#1911, l_commitdate_prf#1893 AS l_commitdate_prf_1#1912, l_suppkey_prf#1894 AS l_suppkey_prf_1#1913, l_orderkey_prf#1895 AS l_orderkey_prf_1#1914]
         :  :     +- Relation[l_returnflag_prf#1877,l_orderkey_and_l_linenumber_prf#1878,l_comment_prf#1879,l_linestatus_prf#1880,rid#1881,l_shipmode_prf#1882,l_shipinstruct_prf#1883,l_quantity_prf#1884,l_receiptdate_prf#1885,l_linenumber_prf#1886,l_tax_prf#1887,l_shipdate_prf#1888,l_extendedprice_prf#1889,l_partkey_prf#1890,l_discount_prf#1891,l_partkey_and_l_suppkey_prf#1892,l_commitdate_prf#1893,l_suppkey_prf#1894,l_orderkey_prf#1895] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1915, dexdecrypt('value_dec_key, 'value_right) AS rid_2#1916]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#1917 AS s_phone_prf_2#1925, rid#1918 AS rid_2#1926, s_address_prf#1919 AS s_address_prf_2#1927, s_nationkey_prf#1920 AS s_nationkey_prf_2#1928, s_suppkey_prf#1921 AS s_suppkey_prf_2#1929, s_name_prf#1922 AS s_name_prf_2#1930, s_acctbal_prf#1923 AS s_acctbal_prf_2#1931, s_comment_prf#1924 AS s_comment_prf_2#1932]
            +- Relation[s_phone_prf#1917,rid#1918,s_address_prf#1919,s_nationkey_prf#1920,s_suppkey_prf#1921,s_name_prf#1922,s_acctbal_prf#1923,s_comment_prf#1924] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201569ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/12 16:27:24 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:27:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1998L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 16:27:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1998L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [o_shippriority_prf#2000 AS o_shippriority_prf_0#2010, rid#2001 AS rid_0#2011, o_orderdate_prf#2002 AS o_orderdate_prf_0#2012, o_custkey_prf#2003 AS o_custkey_prf_0#2013, o_orderpriority_prf#2004 AS o_orderpriority_prf_0#2014, o_clerk_prf#2005 AS o_clerk_prf_0#2015, o_orderstatus_prf#2006 AS o_orderstatus_prf_0#2016, o_totalprice_prf#2007 AS o_totalprice_prf_0#2017, o_orderkey_prf#2008 AS o_orderkey_prf_0#2018, o_comment_prf#2009 AS o_comment_prf_0#2019]
         :  :  +- Relation[o_shippriority_prf#2000,rid#2001,o_orderdate_prf#2002,o_custkey_prf#2003,o_orderpriority_prf#2004,o_clerk_prf#2005,o_orderstatus_prf#2006,o_totalprice_prf#2007,o_orderkey_prf#2008,o_comment_prf#2009] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2020, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2021]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2022 AS l_returnflag_prf_1#2041, l_orderkey_and_l_linenumber_prf#2023 AS l_orderkey_and_l_linenumber_prf_1#2042, l_comment_prf#2024 AS l_comment_prf_1#2043, l_linestatus_prf#2025 AS l_linestatus_prf_1#2044, rid#2026 AS rid_1#2045, l_shipmode_prf#2027 AS l_shipmode_prf_1#2046, l_shipinstruct_prf#2028 AS l_shipinstruct_prf_1#2047, l_quantity_prf#2029 AS l_quantity_prf_1#2048, l_receiptdate_prf#2030 AS l_receiptdate_prf_1#2049, l_linenumber_prf#2031 AS l_linenumber_prf_1#2050, l_tax_prf#2032 AS l_tax_prf_1#2051, l_shipdate_prf#2033 AS l_shipdate_prf_1#2052, l_extendedprice_prf#2034 AS l_extendedprice_prf_1#2053, l_partkey_prf#2035 AS l_partkey_prf_1#2054, l_discount_prf#2036 AS l_discount_prf_1#2055, l_partkey_and_l_suppkey_prf#2037 AS l_partkey_and_l_suppkey_prf_1#2056, l_commitdate_prf#2038 AS l_commitdate_prf_1#2057, l_suppkey_prf#2039 AS l_suppkey_prf_1#2058, l_orderkey_prf#2040 AS l_orderkey_prf_1#2059]
            +- Relation[l_returnflag_prf#2022,l_orderkey_and_l_linenumber_prf#2023,l_comment_prf#2024,l_linestatus_prf#2025,rid#2026,l_shipmode_prf#2027,l_shipinstruct_prf#2028,l_quantity_prf#2029,l_receiptdate_prf#2030,l_linenumber_prf#2031,l_tax_prf#2032,l_shipdate_prf#2033,l_extendedprice_prf#2034,l_partkey_prf#2035,l_discount_prf#2036,l_partkey_and_l_suppkey_prf#2037,l_commitdate_prf#2038,l_suppkey_prf#2039,l_orderkey_prf#2040] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 107140ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/12 16:29:11 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:29:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2108L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 16:29:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2108L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#2110 AS l_returnflag_prf_0#2129, l_orderkey_and_l_linenumber_prf#2111 AS l_orderkey_and_l_linenumber_prf_0#2130, l_comment_prf#2112 AS l_comment_prf_0#2131, l_linestatus_prf#2113 AS l_linestatus_prf_0#2132, rid#2114 AS rid_0#2133, l_shipmode_prf#2115 AS l_shipmode_prf_0#2134, l_shipinstruct_prf#2116 AS l_shipinstruct_prf_0#2135, l_quantity_prf#2117 AS l_quantity_prf_0#2136, l_receiptdate_prf#2118 AS l_receiptdate_prf_0#2137, l_linenumber_prf#2119 AS l_linenumber_prf_0#2138, l_tax_prf#2120 AS l_tax_prf_0#2139, l_shipdate_prf#2121 AS l_shipdate_prf_0#2140, l_extendedprice_prf#2122 AS l_extendedprice_prf_0#2141, l_partkey_prf#2123 AS l_partkey_prf_0#2142, l_discount_prf#2124 AS l_discount_prf_0#2143, l_partkey_and_l_suppkey_prf#2125 AS l_partkey_and_l_suppkey_prf_0#2144, l_commitdate_prf#2126 AS l_commitdate_prf_0#2145, l_suppkey_prf#2127 AS l_suppkey_prf_0#2146, l_orderkey_prf#2128 AS l_orderkey_prf_0#2147]
         :  +- Relation[l_returnflag_prf#2110,l_orderkey_and_l_linenumber_prf#2111,l_comment_prf#2112,l_linestatus_prf#2113,rid#2114,l_shipmode_prf#2115,l_shipinstruct_prf#2116,l_quantity_prf#2117,l_receiptdate_prf#2118,l_linenumber_prf#2119,l_tax_prf#2120,l_shipdate_prf#2121,l_extendedprice_prf#2122,l_partkey_prf#2123,l_discount_prf#2124,l_partkey_and_l_suppkey_prf#2125,l_commitdate_prf#2126,l_suppkey_prf#2127,l_orderkey_prf#2128] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2150]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 23421ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/12 16:29:34 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:29:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2205L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 16:29:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2205L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#2207 AS s_phone_prf_0#2215, rid#2208 AS rid_0#2216, s_address_prf#2209 AS s_address_prf_0#2217, s_nationkey_prf#2210 AS s_nationkey_prf_0#2218, s_suppkey_prf#2211 AS s_suppkey_prf_0#2219, s_name_prf#2212 AS s_name_prf_0#2220, s_acctbal_prf#2213 AS s_acctbal_prf_0#2221, s_comment_prf#2214 AS s_comment_prf_0#2222]
         :  :  +- Relation[s_phone_prf#2207,rid#2208,s_address_prf#2209,s_nationkey_prf#2210,s_suppkey_prf#2211,s_name_prf#2212,s_acctbal_prf#2213,s_comment_prf#2214] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2223, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2224]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [l_returnflag_prf#2225 AS l_returnflag_prf_1#2244, l_orderkey_and_l_linenumber_prf#2226 AS l_orderkey_and_l_linenumber_prf_1#2245, l_comment_prf#2227 AS l_comment_prf_1#2246, l_linestatus_prf#2228 AS l_linestatus_prf_1#2247, rid#2229 AS rid_1#2248, l_shipmode_prf#2230 AS l_shipmode_prf_1#2249, l_shipinstruct_prf#2231 AS l_shipinstruct_prf_1#2250, l_quantity_prf#2232 AS l_quantity_prf_1#2251, l_receiptdate_prf#2233 AS l_receiptdate_prf_1#2252, l_linenumber_prf#2234 AS l_linenumber_prf_1#2253, l_tax_prf#2235 AS l_tax_prf_1#2254, l_shipdate_prf#2236 AS l_shipdate_prf_1#2255, l_extendedprice_prf#2237 AS l_extendedprice_prf_1#2256, l_partkey_prf#2238 AS l_partkey_prf_1#2257, l_discount_prf#2239 AS l_discount_prf_1#2258, l_partkey_and_l_suppkey_prf#2240 AS l_partkey_and_l_suppkey_prf_1#2259, l_commitdate_prf#2241 AS l_commitdate_prf_1#2260, l_suppkey_prf#2242 AS l_suppkey_prf_1#2261, l_orderkey_prf#2243 AS l_orderkey_prf_1#2262]
            :  :  +- Relation[l_returnflag_prf#2225,l_orderkey_and_l_linenumber_prf#2226,l_comment_prf#2227,l_linestatus_prf#2228,rid#2229,l_shipmode_prf#2230,l_shipinstruct_prf#2231,l_quantity_prf#2232,l_receiptdate_prf#2233,l_linenumber_prf#2234,l_tax_prf#2235,l_shipdate_prf#2236,l_extendedprice_prf#2237,l_partkey_prf#2238,l_discount_prf#2239,l_partkey_and_l_suppkey_prf#2240,l_commitdate_prf#2241,l_suppkey_prf#2242,l_orderkey_prf#2243] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2263, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2264]
            :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
            :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [p_comment_prf#2265 AS p_comment_prf_2#2275, p_name_prf#2266 AS p_name_prf_2#2276, rid#2267 AS rid_2#2277, p_type_prf#2268 AS p_type_prf_2#2278, p_retailprice_prf#2269 AS p_retailprice_prf_2#2279, p_mfgr_prf#2270 AS p_mfgr_prf_2#2280, p_container_prf#2271 AS p_container_prf_2#2281, p_brand_prf#2272 AS p_brand_prf_2#2282, p_size_prf#2273 AS p_size_prf_2#2283, p_partkey_prf#2274 AS p_partkey_prf_2#2284]
               +- Relation[p_comment_prf#2265,p_name_prf#2266,rid#2267,p_type_prf#2268,p_retailprice_prf#2269,p_mfgr_prf#2270,p_container_prf#2271,p_brand_prf#2272,p_size_prf#2273,p_partkey_prf#2274] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 200730ms

f2=
select * from part where p_size = 15
19/10/12 16:32:55 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:32:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2334L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 16:32:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2334L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#2336 AS p_comment_prf_0#2346, p_name_prf#2337 AS p_name_prf_0#2347, rid#2338 AS rid_0#2348, p_type_prf#2339 AS p_type_prf_0#2349, p_retailprice_prf#2340 AS p_retailprice_prf_0#2350, p_mfgr_prf#2341 AS p_mfgr_prf_0#2351, p_container_prf#2342 AS p_container_prf_0#2352, p_brand_prf#2343 AS p_brand_prf_0#2353, p_size_prf#2344 AS p_size_prf_0#2354, p_partkey_prf#2345 AS p_partkey_prf_0#2355]
         :  +- Relation[p_comment_prf#2336,p_name_prf#2337,rid#2338,p_type_prf#2339,p_retailprice_prf#2340,p_mfgr_prf#2341,p_container_prf#2342,p_brand_prf#2343,p_size_prf#2344,p_partkey_prf#2345] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2356]
            +- DexRidFilter part~p_size~15
               +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=3907
Elapsed time: 125ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/12 16:32:55 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:32:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2382L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 16:32:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2382L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#2384 AS s_phone_prf_0#2392, rid#2385 AS rid_0#2393, s_address_prf#2386 AS s_address_prf_0#2394, s_nationkey_prf#2387 AS s_nationkey_prf_0#2395, s_suppkey_prf#2388 AS s_suppkey_prf_0#2396, s_name_prf#2389 AS s_name_prf_0#2397, s_acctbal_prf#2390 AS s_acctbal_prf_0#2398, s_comment_prf#2391 AS s_comment_prf_0#2399]
         :  :  +- Relation[s_phone_prf#2384,rid#2385,s_address_prf#2386,s_nationkey_prf#2387,s_suppkey_prf#2388,s_name_prf#2389,s_acctbal_prf#2390,s_comment_prf#2391] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2400, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2401]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2402 AS ps_partkey_and_ps_suppkey_prf_1#2409, rid#2403 AS rid_1#2410, ps_availqty_prf#2404 AS ps_availqty_prf_1#2411, ps_comment_prf#2405 AS ps_comment_prf_1#2412, ps_partkey_prf#2406 AS ps_partkey_prf_1#2413, ps_supplycost_prf#2407 AS ps_supplycost_prf_1#2414, ps_suppkey_prf#2408 AS ps_suppkey_prf_1#2415]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2402,rid#2403,ps_availqty_prf#2404,ps_comment_prf#2405,ps_partkey_prf#2406,ps_supplycost_prf#2407,ps_suppkey_prf#2408] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 11738ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/12 16:33:07 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:33:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2455L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 16:33:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2455L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [ps_partkey_and_ps_suppkey_prf#2457 AS ps_partkey_and_ps_suppkey_prf_0#2464, rid#2458 AS rid_0#2465, ps_availqty_prf#2459 AS ps_availqty_prf_0#2466, ps_comment_prf#2460 AS ps_comment_prf_0#2467, ps_partkey_prf#2461 AS ps_partkey_prf_0#2468, ps_supplycost_prf#2462 AS ps_supplycost_prf_0#2469, ps_suppkey_prf#2463 AS ps_suppkey_prf_0#2470]
         :  :  :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#2457,rid#2458,ps_availqty_prf#2459,ps_comment_prf#2460,ps_partkey_prf#2461,ps_supplycost_prf#2462,ps_suppkey_prf#2463] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2471, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2472]
         :  :  :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :  :  :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#2473 AS p_comment_prf_1#2483, p_name_prf#2474 AS p_name_prf_1#2484, rid#2475 AS rid_1#2485, p_type_prf#2476 AS p_type_prf_1#2486, p_retailprice_prf#2477 AS p_retailprice_prf_1#2487, p_mfgr_prf#2478 AS p_mfgr_prf_1#2488, p_container_prf#2479 AS p_container_prf_1#2489, p_brand_prf#2480 AS p_brand_prf_1#2490, p_size_prf#2481 AS p_size_prf_1#2491, p_partkey_prf#2482 AS p_partkey_prf_1#2492]
         :  :     +- Relation[p_comment_prf#2473,p_name_prf#2474,rid#2475,p_type_prf#2476,p_retailprice_prf#2477,p_mfgr_prf#2478,p_container_prf#2479,p_brand_prf#2480,p_size_prf#2481,p_partkey_prf#2482] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2493, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2494]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#2495 AS s_phone_prf_2#2503, rid#2496 AS rid_2#2504, s_address_prf#2497 AS s_address_prf_2#2505, s_nationkey_prf#2498 AS s_nationkey_prf_2#2506, s_suppkey_prf#2499 AS s_suppkey_prf_2#2507, s_name_prf#2500 AS s_name_prf_2#2508, s_acctbal_prf#2501 AS s_acctbal_prf_2#2509, s_comment_prf#2502 AS s_comment_prf_2#2510]
            +- Relation[s_phone_prf#2495,rid#2496,s_address_prf#2497,s_nationkey_prf#2498,s_suppkey_prf#2499,s_name_prf#2500,s_acctbal_prf#2501,s_comment_prf#2502] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26088ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/12 16:33:33 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:33:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2543L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 16:33:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2543L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#2545 AS rid_0#2550, n_regionkey_prf#2546 AS n_regionkey_prf_0#2551, n_nationkey_prf#2547 AS n_nationkey_prf_0#2552, n_name_prf#2548 AS n_name_prf_0#2553, n_comment_prf#2549 AS n_comment_prf_0#2554]
         :  +- Relation[rid#2545,n_regionkey_prf#2546,n_nationkey_prf#2547,n_name_prf#2548,n_comment_prf#2549] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2555]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1
Elapsed time: 55ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/12 16:33:33 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:33:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2597L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 16:33:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2597L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#2599 AS c_acctbal_prf_0#2608, rid#2600 AS rid_0#2609, c_name_prf#2601 AS c_name_prf_0#2610, c_nationkey_prf#2602 AS c_nationkey_prf_0#2611, c_custkey_prf#2603 AS c_custkey_prf_0#2612, c_comment_prf#2604 AS c_comment_prf_0#2613, c_address_prf#2605 AS c_address_prf_0#2614, c_mktsegment_prf#2606 AS c_mktsegment_prf_0#2615, c_phone_prf#2607 AS c_phone_prf_0#2616]
         :  :  +- Relation[c_acctbal_prf#2599,rid#2600,c_name_prf#2601,c_nationkey_prf#2602,c_custkey_prf#2603,c_comment_prf#2604,c_address_prf#2605,c_mktsegment_prf#2606,c_phone_prf#2607] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2617, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2618]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [o_shippriority_prf#2619 AS o_shippriority_prf_1#2629, rid#2620 AS rid_1#2630, o_orderdate_prf#2621 AS o_orderdate_prf_1#2631, o_custkey_prf#2622 AS o_custkey_prf_1#2632, o_orderpriority_prf#2623 AS o_orderpriority_prf_1#2633, o_clerk_prf#2624 AS o_clerk_prf_1#2634, o_orderstatus_prf#2625 AS o_orderstatus_prf_1#2635, o_totalprice_prf#2626 AS o_totalprice_prf_1#2636, o_orderkey_prf#2627 AS o_orderkey_prf_1#2637, o_comment_prf#2628 AS o_comment_prf_1#2638]
            :  :  +- Relation[o_shippriority_prf#2619,rid#2620,o_orderdate_prf#2621,o_custkey_prf#2622,o_orderpriority_prf#2623,o_clerk_prf#2624,o_orderstatus_prf#2625,o_totalprice_prf#2626,o_orderkey_prf#2627,o_comment_prf#2628] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2639, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2640]
            :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
            :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2641 AS l_returnflag_prf_2#2660, l_orderkey_and_l_linenumber_prf#2642 AS l_orderkey_and_l_linenumber_prf_2#2661, l_comment_prf#2643 AS l_comment_prf_2#2662, l_linestatus_prf#2644 AS l_linestatus_prf_2#2663, rid#2645 AS rid_2#2664, l_shipmode_prf#2646 AS l_shipmode_prf_2#2665, l_shipinstruct_prf#2647 AS l_shipinstruct_prf_2#2666, l_quantity_prf#2648 AS l_quantity_prf_2#2667, l_receiptdate_prf#2649 AS l_receiptdate_prf_2#2668, l_linenumber_prf#2650 AS l_linenumber_prf_2#2669, l_tax_prf#2651 AS l_tax_prf_2#2670, l_shipdate_prf#2652 AS l_shipdate_prf_2#2671, l_extendedprice_prf#2653 AS l_extendedprice_prf_2#2672, l_partkey_prf#2654 AS l_partkey_prf_2#2673, l_discount_prf#2655 AS l_discount_prf_2#2674, l_partkey_and_l_suppkey_prf#2656 AS l_partkey_and_l_suppkey_prf_2#2675, l_commitdate_prf#2657 AS l_commitdate_prf_2#2676, l_suppkey_prf#2658 AS l_suppkey_prf_2#2677, l_orderkey_prf#2659 AS l_orderkey_prf_2#2678]
               +- Relation[l_returnflag_prf#2641,l_orderkey_and_l_linenumber_prf#2642,l_comment_prf#2643,l_linestatus_prf#2644,rid#2645,l_shipmode_prf#2646,l_shipinstruct_prf#2647,l_quantity_prf#2648,l_receiptdate_prf#2649,l_linenumber_prf#2650,l_tax_prf#2651,l_shipdate_prf#2652,l_extendedprice_prf#2653,l_partkey_prf#2654,l_discount_prf#2655,l_partkey_and_l_suppkey_prf#2656,l_commitdate_prf#2657,l_suppkey_prf#2658,l_orderkey_prf#2659] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 168626ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/12 16:36:22 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:36:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2739L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 16:36:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2739L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [rid#2741 AS rid_0#2746, n_regionkey_prf#2742 AS n_regionkey_prf_0#2747, n_nationkey_prf#2743 AS n_nationkey_prf_0#2748, n_name_prf#2744 AS n_name_prf_0#2749, n_comment_prf#2745 AS n_comment_prf_0#2750]
         :  :  :  :  +- Relation[rid#2741,n_regionkey_prf#2742,n_nationkey_prf#2743,n_name_prf#2744,n_comment_prf#2745] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2751, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2752]
         :  :  :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :  :  :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#2753 AS s_phone_prf_1#2761, rid#2754 AS rid_1#2762, s_address_prf#2755 AS s_address_prf_1#2763, s_nationkey_prf#2756 AS s_nationkey_prf_1#2764, s_suppkey_prf#2757 AS s_suppkey_prf_1#2765, s_name_prf#2758 AS s_name_prf_1#2766, s_acctbal_prf#2759 AS s_acctbal_prf_1#2767, s_comment_prf#2760 AS s_comment_prf_1#2768]
         :  :     +- Relation[s_phone_prf#2753,rid#2754,s_address_prf#2755,s_nationkey_prf#2756,s_suppkey_prf#2757,s_name_prf#2758,s_acctbal_prf#2759,s_comment_prf#2760] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2769, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2770]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2771 AS c_acctbal_prf_2#2780, rid#2772 AS rid_2#2781, c_name_prf#2773 AS c_name_prf_2#2782, c_nationkey_prf#2774 AS c_nationkey_prf_2#2783, c_custkey_prf#2775 AS c_custkey_prf_2#2784, c_comment_prf#2776 AS c_comment_prf_2#2785, c_address_prf#2777 AS c_address_prf_2#2786, c_mktsegment_prf#2778 AS c_mktsegment_prf_2#2787, c_phone_prf#2779 AS c_phone_prf_2#2788]
            +- Relation[c_acctbal_prf#2771,rid#2772,c_name_prf#2773,c_nationkey_prf#2774,c_custkey_prf#2775,c_comment_prf#2776,c_address_prf#2777,c_mktsegment_prf#2778,c_phone_prf#2779] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 908190ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/12 16:51:30 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:51:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2823L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 16:51:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2823L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#2825 AS p_comment_prf_0#2835, p_name_prf#2826 AS p_name_prf_0#2836, rid#2827 AS rid_0#2837, p_type_prf#2828 AS p_type_prf_0#2838, p_retailprice_prf#2829 AS p_retailprice_prf_0#2839, p_mfgr_prf#2830 AS p_mfgr_prf_0#2840, p_container_prf#2831 AS p_container_prf_0#2841, p_brand_prf#2832 AS p_brand_prf_0#2842, p_size_prf#2833 AS p_size_prf_0#2843, p_partkey_prf#2834 AS p_partkey_prf_0#2844]
         :  +- Relation[p_comment_prf#2825,p_name_prf#2826,rid#2827,p_type_prf#2828,p_retailprice_prf#2829,p_mfgr_prf#2830,p_container_prf#2831,p_brand_prf#2832,p_size_prf#2833,p_partkey_prf#2834] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2845]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1451
Elapsed time: 84ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/12 16:51:30 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:51:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2873L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 16:51:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2873L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [p_comment_prf#2875 AS p_comment_prf_0#2885, p_name_prf#2876 AS p_name_prf_0#2886, rid#2877 AS rid_0#2887, p_type_prf#2878 AS p_type_prf_0#2888, p_retailprice_prf#2879 AS p_retailprice_prf_0#2889, p_mfgr_prf#2880 AS p_mfgr_prf_0#2890, p_container_prf#2881 AS p_container_prf_0#2891, p_brand_prf#2882 AS p_brand_prf_0#2892, p_size_prf#2883 AS p_size_prf_0#2893, p_partkey_prf#2884 AS p_partkey_prf_0#2894]
         :  :  :  +- Relation[p_comment_prf#2875,p_name_prf#2876,rid#2877,p_type_prf#2878,p_retailprice_prf#2879,p_mfgr_prf#2880,p_container_prf#2881,p_brand_prf#2882,p_size_prf#2883,p_partkey_prf#2884] JDBCRelation(part_prf) [numPartitions=1]
         :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2895]
         :  :     +- DexRidFilter part~p_size~15
         :  :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2896, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2897]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2898 AS ps_partkey_and_ps_suppkey_prf_1#2905, rid#2899 AS rid_1#2906, ps_availqty_prf#2900 AS ps_availqty_prf_1#2907, ps_comment_prf#2901 AS ps_comment_prf_1#2908, ps_partkey_prf#2902 AS ps_partkey_prf_1#2909, ps_supplycost_prf#2903 AS ps_supplycost_prf_1#2910, ps_suppkey_prf#2904 AS ps_suppkey_prf_1#2911]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2898,rid#2899,ps_availqty_prf#2900,ps_comment_prf#2901,ps_partkey_prf#2902,ps_supplycost_prf#2903,ps_suppkey_prf#2904] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=15628
Elapsed time: 7744ms

f1=
select * from region where r_name = 'EUROPE'
19/10/12 16:51:38 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:51:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2935L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/12 16:51:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2935L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#2937 AS r_regionkey_prf_0#2941, r_name_prf#2938 AS r_name_prf_0#2942, r_comment_prf#2939 AS r_comment_prf_0#2943, rid#2940 AS rid_0#2944]
         :  +- Relation[r_regionkey_prf#2937,r_name_prf#2938,r_comment_prf#2939,rid#2940] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2945]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1
Elapsed time: 52ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/12 16:51:38 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:51:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2969L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 16:51:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2969L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#2971 AS l_returnflag_prf_0#2990, l_orderkey_and_l_linenumber_prf#2972 AS l_orderkey_and_l_linenumber_prf_0#2991, l_comment_prf#2973 AS l_comment_prf_0#2992, l_linestatus_prf#2974 AS l_linestatus_prf_0#2993, rid#2975 AS rid_0#2994, l_shipmode_prf#2976 AS l_shipmode_prf_0#2995, l_shipinstruct_prf#2977 AS l_shipinstruct_prf_0#2996, l_quantity_prf#2978 AS l_quantity_prf_0#2997, l_receiptdate_prf#2979 AS l_receiptdate_prf_0#2998, l_linenumber_prf#2980 AS l_linenumber_prf_0#2999, l_tax_prf#2981 AS l_tax_prf_0#3000, l_shipdate_prf#2982 AS l_shipdate_prf_0#3001, l_extendedprice_prf#2983 AS l_extendedprice_prf_0#3002, l_partkey_prf#2984 AS l_partkey_prf_0#3003, l_discount_prf#2985 AS l_discount_prf_0#3004, l_partkey_and_l_suppkey_prf#2986 AS l_partkey_and_l_suppkey_prf_0#3005, l_commitdate_prf#2987 AS l_commitdate_prf_0#3006, l_suppkey_prf#2988 AS l_suppkey_prf_0#3007, l_orderkey_prf#2989 AS l_orderkey_prf_0#3008]
         :  +- Relation[l_returnflag_prf#2971,l_orderkey_and_l_linenumber_prf#2972,l_comment_prf#2973,l_linestatus_prf#2974,rid#2975,l_shipmode_prf#2976,l_shipinstruct_prf#2977,l_quantity_prf#2978,l_receiptdate_prf#2979,l_linenumber_prf#2980,l_tax_prf#2981,l_shipdate_prf#2982,l_extendedprice_prf#2983,l_partkey_prf#2984,l_discount_prf#2985,l_partkey_and_l_suppkey_prf#2986,l_commitdate_prf#2987,l_suppkey_prf#2988,l_orderkey_prf#2989] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3009]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=857401
Elapsed time: 13619ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/12 16:51:51 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:51:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3053L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 16:51:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3053L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [p_comment_prf#3055 AS p_comment_prf_0#3065, p_name_prf#3056 AS p_name_prf_0#3066, rid#3057 AS rid_0#3067, p_type_prf#3058 AS p_type_prf_0#3068, p_retailprice_prf#3059 AS p_retailprice_prf_0#3069, p_mfgr_prf#3060 AS p_mfgr_prf_0#3070, p_container_prf#3061 AS p_container_prf_0#3071, p_brand_prf#3062 AS p_brand_prf_0#3072, p_size_prf#3063 AS p_size_prf_0#3073, p_partkey_prf#3064 AS p_partkey_prf_0#3074]
         :  :  :  :  +- Relation[p_comment_prf#3055,p_name_prf#3056,rid#3057,p_type_prf#3058,p_retailprice_prf#3059,p_mfgr_prf#3060,p_container_prf#3061,p_brand_prf#3062,p_size_prf#3063,p_partkey_prf#3064] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3075, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3076]
         :  :  :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :  :  :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#3077 AS ps_partkey_and_ps_suppkey_prf_1#3084, rid#3078 AS rid_1#3085, ps_availqty_prf#3079 AS ps_availqty_prf_1#3086, ps_comment_prf#3080 AS ps_comment_prf_1#3087, ps_partkey_prf#3081 AS ps_partkey_prf_1#3088, ps_supplycost_prf#3082 AS ps_supplycost_prf_1#3089, ps_suppkey_prf#3083 AS ps_suppkey_prf_1#3090]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#3077,rid#3078,ps_availqty_prf#3079,ps_comment_prf#3080,ps_partkey_prf#3081,ps_supplycost_prf#3082,ps_suppkey_prf#3083] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3091, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3092]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#3093 AS s_phone_prf_2#3101, rid#3094 AS rid_2#3102, s_address_prf#3095 AS s_address_prf_2#3103, s_nationkey_prf#3096 AS s_nationkey_prf_2#3104, s_suppkey_prf#3097 AS s_suppkey_prf_2#3105, s_name_prf#3098 AS s_name_prf_2#3106, s_acctbal_prf#3099 AS s_acctbal_prf_2#3107, s_comment_prf#3100 AS s_comment_prf_2#3108]
            +- Relation[s_phone_prf#3093,rid#3094,s_address_prf#3095,s_nationkey_prf#3096,s_suppkey_prf#3097,s_name_prf#3098,s_acctbal_prf#3099,s_comment_prf#3100] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26153ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/12 16:52:22 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:52:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3170L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 16:52:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3170L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#3172 AS c_acctbal_prf_0#3181, rid#3173 AS rid_0#3182, c_name_prf#3174 AS c_name_prf_0#3183, c_nationkey_prf#3175 AS c_nationkey_prf_0#3184, c_custkey_prf#3176 AS c_custkey_prf_0#3185, c_comment_prf#3177 AS c_comment_prf_0#3186, c_address_prf#3178 AS c_address_prf_0#3187, c_mktsegment_prf#3179 AS c_mktsegment_prf_0#3188, c_phone_prf#3180 AS c_phone_prf_0#3189]
         :  :  +- Relation[c_acctbal_prf#3172,rid#3173,c_name_prf#3174,c_nationkey_prf#3175,c_custkey_prf#3176,c_comment_prf#3177,c_address_prf#3178,c_mktsegment_prf#3179,c_phone_prf#3180] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3190, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3191]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [l_returnflag_prf#3192 AS l_returnflag_prf_1#3211, l_orderkey_and_l_linenumber_prf#3193 AS l_orderkey_and_l_linenumber_prf_1#3212, l_comment_prf#3194 AS l_comment_prf_1#3213, l_linestatus_prf#3195 AS l_linestatus_prf_1#3214, rid#3196 AS rid_1#3215, l_shipmode_prf#3197 AS l_shipmode_prf_1#3216, l_shipinstruct_prf#3198 AS l_shipinstruct_prf_1#3217, l_quantity_prf#3199 AS l_quantity_prf_1#3218, l_receiptdate_prf#3200 AS l_receiptdate_prf_1#3219, l_linenumber_prf#3201 AS l_linenumber_prf_1#3220, l_tax_prf#3202 AS l_tax_prf_1#3221, l_shipdate_prf#3203 AS l_shipdate_prf_1#3222, l_extendedprice_prf#3204 AS l_extendedprice_prf_1#3223, l_partkey_prf#3205 AS l_partkey_prf_1#3224, l_discount_prf#3206 AS l_discount_prf_1#3225, l_partkey_and_l_suppkey_prf#3207 AS l_partkey_and_l_suppkey_prf_1#3226, l_commitdate_prf#3208 AS l_commitdate_prf_1#3227, l_suppkey_prf#3209 AS l_suppkey_prf_1#3228, l_orderkey_prf#3210 AS l_orderkey_prf_1#3229]
            :  :  +- Relation[l_returnflag_prf#3192,l_orderkey_and_l_linenumber_prf#3193,l_comment_prf#3194,l_linestatus_prf#3195,rid#3196,l_shipmode_prf#3197,l_shipinstruct_prf#3198,l_quantity_prf#3199,l_receiptdate_prf#3200,l_linenumber_prf#3201,l_tax_prf#3202,l_shipdate_prf#3203,l_extendedprice_prf#3204,l_partkey_prf#3205,l_discount_prf#3206,l_partkey_and_l_suppkey_prf#3207,l_commitdate_prf#3208,l_suppkey_prf#3209,l_orderkey_prf#3210] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3230, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3231]
            :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
            :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3232 AS o_shippriority_prf_2#3242, rid#3233 AS rid_2#3243, o_orderdate_prf#3234 AS o_orderdate_prf_2#3244, o_custkey_prf#3235 AS o_custkey_prf_2#3245, o_orderpriority_prf#3236 AS o_orderpriority_prf_2#3246, o_clerk_prf#3237 AS o_clerk_prf_2#3247, o_orderstatus_prf#3238 AS o_orderstatus_prf_2#3248, o_totalprice_prf#3239 AS o_totalprice_prf_2#3249, o_orderkey_prf#3240 AS o_orderkey_prf_2#3250, o_comment_prf#3241 AS o_comment_prf_2#3251]
               +- Relation[o_shippriority_prf#3232,rid#3233,o_orderdate_prf#3234,o_custkey_prf#3235,o_orderpriority_prf#3236,o_clerk_prf#3237,o_orderstatus_prf#3238,o_totalprice_prf#3239,o_orderkey_prf#3240,o_comment_prf#3241] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 147899ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/12 16:54:45 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:54:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3316L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 16:54:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3316L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#3318 AS s_phone_prf_0#3326, rid#3319 AS rid_0#3327, s_address_prf#3320 AS s_address_prf_0#3328, s_nationkey_prf#3321 AS s_nationkey_prf_0#3329, s_suppkey_prf#3322 AS s_suppkey_prf_0#3330, s_name_prf#3323 AS s_name_prf_0#3331, s_acctbal_prf#3324 AS s_acctbal_prf_0#3332, s_comment_prf#3325 AS s_comment_prf_0#3333]
         :  :  +- Relation[s_phone_prf#3318,rid#3319,s_address_prf#3320,s_nationkey_prf#3321,s_suppkey_prf#3322,s_name_prf#3323,s_acctbal_prf#3324,s_comment_prf#3325] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3334, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3335]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3336 AS l_returnflag_prf_1#3355, l_orderkey_and_l_linenumber_prf#3337 AS l_orderkey_and_l_linenumber_prf_1#3356, l_comment_prf#3338 AS l_comment_prf_1#3357, l_linestatus_prf#3339 AS l_linestatus_prf_1#3358, rid#3340 AS rid_1#3359, l_shipmode_prf#3341 AS l_shipmode_prf_1#3360, l_shipinstruct_prf#3342 AS l_shipinstruct_prf_1#3361, l_quantity_prf#3343 AS l_quantity_prf_1#3362, l_receiptdate_prf#3344 AS l_receiptdate_prf_1#3363, l_linenumber_prf#3345 AS l_linenumber_prf_1#3364, l_tax_prf#3346 AS l_tax_prf_1#3365, l_shipdate_prf#3347 AS l_shipdate_prf_1#3366, l_extendedprice_prf#3348 AS l_extendedprice_prf_1#3367, l_partkey_prf#3349 AS l_partkey_prf_1#3368, l_discount_prf#3350 AS l_discount_prf_1#3369, l_partkey_and_l_suppkey_prf#3351 AS l_partkey_and_l_suppkey_prf_1#3370, l_commitdate_prf#3352 AS l_commitdate_prf_1#3371, l_suppkey_prf#3353 AS l_suppkey_prf_1#3372, l_orderkey_prf#3354 AS l_orderkey_prf_1#3373]
            +- Relation[l_returnflag_prf#3336,l_orderkey_and_l_linenumber_prf#3337,l_comment_prf#3338,l_linestatus_prf#3339,rid#3340,l_shipmode_prf#3341,l_shipinstruct_prf#3342,l_quantity_prf#3343,l_receiptdate_prf#3344,l_linenumber_prf#3345,l_tax_prf#3346,l_shipdate_prf#3347,l_extendedprice_prf#3348,l_partkey_prf#3349,l_discount_prf#3350,l_partkey_and_l_suppkey_prf#3351,l_commitdate_prf#3352,l_suppkey_prf#3353,l_orderkey_prf#3354] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 90505ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/12 16:56:16 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:56:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3416L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 16:56:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3416L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [rid#3418 AS rid_0#3423, n_regionkey_prf#3419 AS n_regionkey_prf_0#3424, n_nationkey_prf#3420 AS n_nationkey_prf_0#3425, n_name_prf#3421 AS n_name_prf_0#3426, n_comment_prf#3422 AS n_comment_prf_0#3427]
         :  :  +- Relation[rid#3418,n_regionkey_prf#3419,n_nationkey_prf#3420,n_name_prf#3421,n_comment_prf#3422] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3428, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3429]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3430 AS c_acctbal_prf_1#3439, rid#3431 AS rid_1#3440, c_name_prf#3432 AS c_name_prf_1#3441, c_nationkey_prf#3433 AS c_nationkey_prf_1#3442, c_custkey_prf#3434 AS c_custkey_prf_1#3443, c_comment_prf#3435 AS c_comment_prf_1#3444, c_address_prf#3436 AS c_address_prf_1#3445, c_mktsegment_prf#3437 AS c_mktsegment_prf_1#3446, c_phone_prf#3438 AS c_phone_prf_1#3447]
            +- Relation[c_acctbal_prf#3430,rid#3431,c_name_prf#3432,c_nationkey_prf#3433,c_custkey_prf#3434,c_comment_prf#3435,c_address_prf#3436,c_mktsegment_prf#3437,c_phone_prf#3438] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=150000
Elapsed time: 2517ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/12 16:56:18 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:56:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3497L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 16:56:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3497L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [l_returnflag_prf#3499 AS l_returnflag_prf_0#3518, l_orderkey_and_l_linenumber_prf#3500 AS l_orderkey_and_l_linenumber_prf_0#3519, l_comment_prf#3501 AS l_comment_prf_0#3520, l_linestatus_prf#3502 AS l_linestatus_prf_0#3521, rid#3503 AS rid_0#3522, l_shipmode_prf#3504 AS l_shipmode_prf_0#3523, l_shipinstruct_prf#3505 AS l_shipinstruct_prf_0#3524, l_quantity_prf#3506 AS l_quantity_prf_0#3525, l_receiptdate_prf#3507 AS l_receiptdate_prf_0#3526, l_linenumber_prf#3508 AS l_linenumber_prf_0#3527, l_tax_prf#3509 AS l_tax_prf_0#3528, l_shipdate_prf#3510 AS l_shipdate_prf_0#3529, l_extendedprice_prf#3511 AS l_extendedprice_prf_0#3530, l_partkey_prf#3512 AS l_partkey_prf_0#3531, l_discount_prf#3513 AS l_discount_prf_0#3532, l_partkey_and_l_suppkey_prf#3514 AS l_partkey_and_l_suppkey_prf_0#3533, l_commitdate_prf#3515 AS l_commitdate_prf_0#3534, l_suppkey_prf#3516 AS l_suppkey_prf_0#3535, l_orderkey_prf#3517 AS l_orderkey_prf_0#3536]
         :  :  :  :  +- Relation[l_returnflag_prf#3499,l_orderkey_and_l_linenumber_prf#3500,l_comment_prf#3501,l_linestatus_prf#3502,rid#3503,l_shipmode_prf#3504,l_shipinstruct_prf#3505,l_quantity_prf#3506,l_receiptdate_prf#3507,l_linenumber_prf#3508,l_tax_prf#3509,l_shipdate_prf#3510,l_extendedprice_prf#3511,l_partkey_prf#3512,l_discount_prf#3513,l_partkey_and_l_suppkey_prf#3514,l_commitdate_prf#3515,l_suppkey_prf#3516,l_orderkey_prf#3517] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3537, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3538]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :  :  :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#3539 AS p_comment_prf_1#3549, p_name_prf#3540 AS p_name_prf_1#3550, rid#3541 AS rid_1#3551, p_type_prf#3542 AS p_type_prf_1#3552, p_retailprice_prf#3543 AS p_retailprice_prf_1#3553, p_mfgr_prf#3544 AS p_mfgr_prf_1#3554, p_container_prf#3545 AS p_container_prf_1#3555, p_brand_prf#3546 AS p_brand_prf_1#3556, p_size_prf#3547 AS p_size_prf_1#3557, p_partkey_prf#3548 AS p_partkey_prf_1#3558]
         :  :     +- Relation[p_comment_prf#3539,p_name_prf#3540,rid#3541,p_type_prf#3542,p_retailprice_prf#3543,p_mfgr_prf#3544,p_container_prf#3545,p_brand_prf#3546,p_size_prf#3547,p_partkey_prf#3548] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3559, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3560]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#3561 AS s_phone_prf_2#3569, rid#3562 AS rid_2#3570, s_address_prf#3563 AS s_address_prf_2#3571, s_nationkey_prf#3564 AS s_nationkey_prf_2#3572, s_suppkey_prf#3565 AS s_suppkey_prf_2#3573, s_name_prf#3566 AS s_name_prf_2#3574, s_acctbal_prf#3567 AS s_acctbal_prf_2#3575, s_comment_prf#3568 AS s_comment_prf_2#3576]
            +- Relation[s_phone_prf#3561,rid#3562,s_address_prf#3563,s_nationkey_prf#3564,s_suppkey_prf#3565,s_name_prf#3566,s_acctbal_prf#3567,s_comment_prf#3568] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201974ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/12 16:59:40 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 16:59:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3638L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 16:59:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3638L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#3640 AS s_phone_prf_0#3648, rid#3641 AS rid_0#3649, s_address_prf#3642 AS s_address_prf_0#3650, s_nationkey_prf#3643 AS s_nationkey_prf_0#3651, s_suppkey_prf#3644 AS s_suppkey_prf_0#3652, s_name_prf#3645 AS s_name_prf_0#3653, s_acctbal_prf#3646 AS s_acctbal_prf_0#3654, s_comment_prf#3647 AS s_comment_prf_0#3655]
         :  :  +- Relation[s_phone_prf#3640,rid#3641,s_address_prf#3642,s_nationkey_prf#3643,s_suppkey_prf#3644,s_name_prf#3645,s_acctbal_prf#3646,s_comment_prf#3647] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3656, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3657]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [ps_partkey_and_ps_suppkey_prf#3658 AS ps_partkey_and_ps_suppkey_prf_1#3665, rid#3659 AS rid_1#3666, ps_availqty_prf#3660 AS ps_availqty_prf_1#3667, ps_comment_prf#3661 AS ps_comment_prf_1#3668, ps_partkey_prf#3662 AS ps_partkey_prf_1#3669, ps_supplycost_prf#3663 AS ps_supplycost_prf_1#3670, ps_suppkey_prf#3664 AS ps_suppkey_prf_1#3671]
            :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#3658,rid#3659,ps_availqty_prf#3660,ps_comment_prf#3661,ps_partkey_prf#3662,ps_supplycost_prf#3663,ps_suppkey_prf#3664] JDBCRelation(partsupp_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3672, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3673]
            :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
            :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [p_comment_prf#3674 AS p_comment_prf_2#3684, p_name_prf#3675 AS p_name_prf_2#3685, rid#3676 AS rid_2#3686, p_type_prf#3677 AS p_type_prf_2#3687, p_retailprice_prf#3678 AS p_retailprice_prf_2#3688, p_mfgr_prf#3679 AS p_mfgr_prf_2#3689, p_container_prf#3680 AS p_container_prf_2#3690, p_brand_prf#3681 AS p_brand_prf_2#3691, p_size_prf#3682 AS p_size_prf_2#3692, p_partkey_prf#3683 AS p_partkey_prf_2#3693]
               +- Relation[p_comment_prf#3674,p_name_prf#3675,rid#3676,p_type_prf#3677,p_retailprice_prf#3678,p_mfgr_prf#3679,p_container_prf#3680,p_brand_prf#3681,p_size_prf#3682,p_partkey_prf#3683] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26230ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/12 17:00:07 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:00:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3747L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 17:00:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3747L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [l_returnflag_prf#3749 AS l_returnflag_prf_0#3768, l_orderkey_and_l_linenumber_prf#3750 AS l_orderkey_and_l_linenumber_prf_0#3769, l_comment_prf#3751 AS l_comment_prf_0#3770, l_linestatus_prf#3752 AS l_linestatus_prf_0#3771, rid#3753 AS rid_0#3772, l_shipmode_prf#3754 AS l_shipmode_prf_0#3773, l_shipinstruct_prf#3755 AS l_shipinstruct_prf_0#3774, l_quantity_prf#3756 AS l_quantity_prf_0#3775, l_receiptdate_prf#3757 AS l_receiptdate_prf_0#3776, l_linenumber_prf#3758 AS l_linenumber_prf_0#3777, l_tax_prf#3759 AS l_tax_prf_0#3778, l_shipdate_prf#3760 AS l_shipdate_prf_0#3779, l_extendedprice_prf#3761 AS l_extendedprice_prf_0#3780, l_partkey_prf#3762 AS l_partkey_prf_0#3781, l_discount_prf#3763 AS l_discount_prf_0#3782, l_partkey_and_l_suppkey_prf#3764 AS l_partkey_and_l_suppkey_prf_0#3783, l_commitdate_prf#3765 AS l_commitdate_prf_0#3784, l_suppkey_prf#3766 AS l_suppkey_prf_0#3785, l_orderkey_prf#3767 AS l_orderkey_prf_0#3786]
         :  :  :  +- Relation[l_returnflag_prf#3749,l_orderkey_and_l_linenumber_prf#3750,l_comment_prf#3751,l_linestatus_prf#3752,rid#3753,l_shipmode_prf#3754,l_shipinstruct_prf#3755,l_quantity_prf#3756,l_receiptdate_prf#3757,l_linenumber_prf#3758,l_tax_prf#3759,l_shipdate_prf#3760,l_extendedprice_prf#3761,l_partkey_prf#3762,l_discount_prf#3763,l_partkey_and_l_suppkey_prf#3764,l_commitdate_prf#3765,l_suppkey_prf#3766,l_orderkey_prf#3767] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3787]
         :  :     +- DexRidFilter lineitem~l_returnflag~R
         :  :        +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3788, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3789]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3790 AS o_shippriority_prf_1#3800, rid#3791 AS rid_1#3801, o_orderdate_prf#3792 AS o_orderdate_prf_1#3802, o_custkey_prf#3793 AS o_custkey_prf_1#3803, o_orderpriority_prf#3794 AS o_orderpriority_prf_1#3804, o_clerk_prf#3795 AS o_clerk_prf_1#3805, o_orderstatus_prf#3796 AS o_orderstatus_prf_1#3806, o_totalprice_prf#3797 AS o_totalprice_prf_1#3807, o_orderkey_prf#3798 AS o_orderkey_prf_1#3808, o_comment_prf#3799 AS o_comment_prf_1#3809]
            +- Relation[o_shippriority_prf#3790,rid#3791,o_orderdate_prf#3792,o_custkey_prf#3793,o_orderpriority_prf#3794,o_clerk_prf#3795,o_orderstatus_prf#3796,o_totalprice_prf#3797,o_orderkey_prf#3798,o_comment_prf#3799] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 97699ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/12 17:01:44 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:01:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3875L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 17:01:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3875L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#3877 AS l_returnflag_prf_0#3896, l_orderkey_and_l_linenumber_prf#3878 AS l_orderkey_and_l_linenumber_prf_0#3897, l_comment_prf#3879 AS l_comment_prf_0#3898, l_linestatus_prf#3880 AS l_linestatus_prf_0#3899, rid#3881 AS rid_0#3900, l_shipmode_prf#3882 AS l_shipmode_prf_0#3901, l_shipinstruct_prf#3883 AS l_shipinstruct_prf_0#3902, l_quantity_prf#3884 AS l_quantity_prf_0#3903, l_receiptdate_prf#3885 AS l_receiptdate_prf_0#3904, l_linenumber_prf#3886 AS l_linenumber_prf_0#3905, l_tax_prf#3887 AS l_tax_prf_0#3906, l_shipdate_prf#3888 AS l_shipdate_prf_0#3907, l_extendedprice_prf#3889 AS l_extendedprice_prf_0#3908, l_partkey_prf#3890 AS l_partkey_prf_0#3909, l_discount_prf#3891 AS l_discount_prf_0#3910, l_partkey_and_l_suppkey_prf#3892 AS l_partkey_and_l_suppkey_prf_0#3911, l_commitdate_prf#3893 AS l_commitdate_prf_0#3912, l_suppkey_prf#3894 AS l_suppkey_prf_0#3913, l_orderkey_prf#3895 AS l_orderkey_prf_0#3914]
         :  :  +- Relation[l_returnflag_prf#3877,l_orderkey_and_l_linenumber_prf#3878,l_comment_prf#3879,l_linestatus_prf#3880,rid#3881,l_shipmode_prf#3882,l_shipinstruct_prf#3883,l_quantity_prf#3884,l_receiptdate_prf#3885,l_linenumber_prf#3886,l_tax_prf#3887,l_shipdate_prf#3888,l_extendedprice_prf#3889,l_partkey_prf#3890,l_discount_prf#3891,l_partkey_and_l_suppkey_prf#3892,l_commitdate_prf#3893,l_suppkey_prf#3894,l_orderkey_prf#3895] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3915, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3916]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [o_shippriority_prf#3917 AS o_shippriority_prf_1#3927, rid#3918 AS rid_1#3928, o_orderdate_prf#3919 AS o_orderdate_prf_1#3929, o_custkey_prf#3920 AS o_custkey_prf_1#3930, o_orderpriority_prf#3921 AS o_orderpriority_prf_1#3931, o_clerk_prf#3922 AS o_clerk_prf_1#3932, o_orderstatus_prf#3923 AS o_orderstatus_prf_1#3933, o_totalprice_prf#3924 AS o_totalprice_prf_1#3934, o_orderkey_prf#3925 AS o_orderkey_prf_1#3935, o_comment_prf#3926 AS o_comment_prf_1#3936]
            :  :  +- Relation[o_shippriority_prf#3917,rid#3918,o_orderdate_prf#3919,o_custkey_prf#3920,o_orderpriority_prf#3921,o_clerk_prf#3922,o_orderstatus_prf#3923,o_totalprice_prf#3924,o_orderkey_prf#3925,o_comment_prf#3926] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3937, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3938]
            :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
            :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#3939 AS c_acctbal_prf_2#3948, rid#3940 AS rid_2#3949, c_name_prf#3941 AS c_name_prf_2#3950, c_nationkey_prf#3942 AS c_nationkey_prf_2#3951, c_custkey_prf#3943 AS c_custkey_prf_2#3952, c_comment_prf#3944 AS c_comment_prf_2#3953, c_address_prf#3945 AS c_address_prf_2#3954, c_mktsegment_prf#3946 AS c_mktsegment_prf_2#3955, c_phone_prf#3947 AS c_phone_prf_2#3956]
               +- Relation[c_acctbal_prf#3939,rid#3940,c_name_prf#3941,c_nationkey_prf#3942,c_custkey_prf#3943,c_comment_prf#3944,c_address_prf#3945,c_mktsegment_prf#3946,c_phone_prf#3947] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 183189ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/12 17:04:47 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:04:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4019L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 17:04:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4019L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [ps_partkey_and_ps_suppkey_prf#4021 AS ps_partkey_and_ps_suppkey_prf_0#4028, rid#4022 AS rid_0#4029, ps_availqty_prf#4023 AS ps_availqty_prf_0#4030, ps_comment_prf#4024 AS ps_comment_prf_0#4031, ps_partkey_prf#4025 AS ps_partkey_prf_0#4032, ps_supplycost_prf#4026 AS ps_supplycost_prf_0#4033, ps_suppkey_prf#4027 AS ps_suppkey_prf_0#4034]
         :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#4021,rid#4022,ps_availqty_prf#4023,ps_comment_prf#4024,ps_partkey_prf#4025,ps_supplycost_prf#4026,ps_suppkey_prf#4027] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4035, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4036]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey_and_l_suppkey~partsupp~ps_partkey_and_ps_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4037 AS l_returnflag_prf_1#4056, l_orderkey_and_l_linenumber_prf#4038 AS l_orderkey_and_l_linenumber_prf_1#4057, l_comment_prf#4039 AS l_comment_prf_1#4058, l_linestatus_prf#4040 AS l_linestatus_prf_1#4059, rid#4041 AS rid_1#4060, l_shipmode_prf#4042 AS l_shipmode_prf_1#4061, l_shipinstruct_prf#4043 AS l_shipinstruct_prf_1#4062, l_quantity_prf#4044 AS l_quantity_prf_1#4063, l_receiptdate_prf#4045 AS l_receiptdate_prf_1#4064, l_linenumber_prf#4046 AS l_linenumber_prf_1#4065, l_tax_prf#4047 AS l_tax_prf_1#4066, l_shipdate_prf#4048 AS l_shipdate_prf_1#4067, l_extendedprice_prf#4049 AS l_extendedprice_prf_1#4068, l_partkey_prf#4050 AS l_partkey_prf_1#4069, l_discount_prf#4051 AS l_discount_prf_1#4070, l_partkey_and_l_suppkey_prf#4052 AS l_partkey_and_l_suppkey_prf_1#4071, l_commitdate_prf#4053 AS l_commitdate_prf_1#4072, l_suppkey_prf#4054 AS l_suppkey_prf_1#4073, l_orderkey_prf#4055 AS l_orderkey_prf_1#4074]
            +- Relation[l_returnflag_prf#4037,l_orderkey_and_l_linenumber_prf#4038,l_comment_prf#4039,l_linestatus_prf#4040,rid#4041,l_shipmode_prf#4042,l_shipinstruct_prf#4043,l_quantity_prf#4044,l_receiptdate_prf#4045,l_linenumber_prf#4046,l_tax_prf#4047,l_shipdate_prf#4048,l_extendedprice_prf#4049,l_partkey_prf#4050,l_discount_prf#4051,l_partkey_and_l_suppkey_prf#4052,l_commitdate_prf#4053,l_suppkey_prf#4054,l_orderkey_prf#4055] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 105410ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/12 17:06:33 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:06:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4129L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 17:06:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4129L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [o_shippriority_prf#4131 AS o_shippriority_prf_0#4141, rid#4132 AS rid_0#4142, o_orderdate_prf#4133 AS o_orderdate_prf_0#4143, o_custkey_prf#4134 AS o_custkey_prf_0#4144, o_orderpriority_prf#4135 AS o_orderpriority_prf_0#4145, o_clerk_prf#4136 AS o_clerk_prf_0#4146, o_orderstatus_prf#4137 AS o_orderstatus_prf_0#4147, o_totalprice_prf#4138 AS o_totalprice_prf_0#4148, o_orderkey_prf#4139 AS o_orderkey_prf_0#4149, o_comment_prf#4140 AS o_comment_prf_0#4150]
         :  :  +- Relation[o_shippriority_prf#4131,rid#4132,o_orderdate_prf#4133,o_custkey_prf#4134,o_orderpriority_prf#4135,o_clerk_prf#4136,o_orderstatus_prf#4137,o_totalprice_prf#4138,o_orderkey_prf#4139,o_comment_prf#4140] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4151, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4152]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#4153 AS l_returnflag_prf_1#4172, l_orderkey_and_l_linenumber_prf#4154 AS l_orderkey_and_l_linenumber_prf_1#4173, l_comment_prf#4155 AS l_comment_prf_1#4174, l_linestatus_prf#4156 AS l_linestatus_prf_1#4175, rid#4157 AS rid_1#4176, l_shipmode_prf#4158 AS l_shipmode_prf_1#4177, l_shipinstruct_prf#4159 AS l_shipinstruct_prf_1#4178, l_quantity_prf#4160 AS l_quantity_prf_1#4179, l_receiptdate_prf#4161 AS l_receiptdate_prf_1#4180, l_linenumber_prf#4162 AS l_linenumber_prf_1#4181, l_tax_prf#4163 AS l_tax_prf_1#4182, l_shipdate_prf#4164 AS l_shipdate_prf_1#4183, l_extendedprice_prf#4165 AS l_extendedprice_prf_1#4184, l_partkey_prf#4166 AS l_partkey_prf_1#4185, l_discount_prf#4167 AS l_discount_prf_1#4186, l_partkey_and_l_suppkey_prf#4168 AS l_partkey_and_l_suppkey_prf_1#4187, l_commitdate_prf#4169 AS l_commitdate_prf_1#4188, l_suppkey_prf#4170 AS l_suppkey_prf_1#4189, l_orderkey_prf#4171 AS l_orderkey_prf_1#4190]
            :  +- Relation[l_returnflag_prf#4153,l_orderkey_and_l_linenumber_prf#4154,l_comment_prf#4155,l_linestatus_prf#4156,rid#4157,l_shipmode_prf#4158,l_shipinstruct_prf#4159,l_quantity_prf#4160,l_receiptdate_prf#4161,l_linenumber_prf#4162,l_tax_prf#4163,l_shipdate_prf#4164,l_extendedprice_prf#4165,l_partkey_prf#4166,l_discount_prf#4167,l_partkey_and_l_suppkey_prf#4168,l_commitdate_prf#4169,l_suppkey_prf#4170,l_orderkey_prf#4171] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4191]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 98575ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/12 17:08:11 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:08:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4243L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 17:08:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4243L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [s_phone_prf#4245 AS s_phone_prf_0#4253, rid#4246 AS rid_0#4254, s_address_prf#4247 AS s_address_prf_0#4255, s_nationkey_prf#4248 AS s_nationkey_prf_0#4256, s_suppkey_prf#4249 AS s_suppkey_prf_0#4257, s_name_prf#4250 AS s_name_prf_0#4258, s_acctbal_prf#4251 AS s_acctbal_prf_0#4259, s_comment_prf#4252 AS s_comment_prf_0#4260]
         :  :  :  :  +- Relation[s_phone_prf#4245,rid#4246,s_address_prf#4247,s_nationkey_prf#4248,s_suppkey_prf#4249,s_name_prf#4250,s_acctbal_prf#4251,s_comment_prf#4252] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4261, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4262]
         :  :  :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :  :  :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [rid#4263 AS rid_1#4268, n_regionkey_prf#4264 AS n_regionkey_prf_1#4269, n_nationkey_prf#4265 AS n_nationkey_prf_1#4270, n_name_prf#4266 AS n_name_prf_1#4271, n_comment_prf#4267 AS n_comment_prf_1#4272]
         :  :     +- Relation[rid#4263,n_regionkey_prf#4264,n_nationkey_prf#4265,n_name_prf#4266,n_comment_prf#4267] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4273, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4274]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4275 AS c_acctbal_prf_2#4284, rid#4276 AS rid_2#4285, c_name_prf#4277 AS c_name_prf_2#4286, c_nationkey_prf#4278 AS c_nationkey_prf_2#4287, c_custkey_prf#4279 AS c_custkey_prf_2#4288, c_comment_prf#4280 AS c_comment_prf_2#4289, c_address_prf#4281 AS c_address_prf_2#4290, c_mktsegment_prf#4282 AS c_mktsegment_prf_2#4291, c_phone_prf#4283 AS c_phone_prf_2#4292]
            +- Relation[c_acctbal_prf#4275,rid#4276,c_name_prf#4277,c_nationkey_prf#4278,c_custkey_prf#4279,c_comment_prf#4280,c_address_prf#4281,c_mktsegment_prf#4282,c_phone_prf#4283] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 900011ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/12 17:23:12 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:23:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4339L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 17:23:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4339L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4341 AS s_phone_prf_0#4349, rid#4342 AS rid_0#4350, s_address_prf#4343 AS s_address_prf_0#4351, s_nationkey_prf#4344 AS s_nationkey_prf_0#4352, s_suppkey_prf#4345 AS s_suppkey_prf_0#4353, s_name_prf#4346 AS s_name_prf_0#4354, s_acctbal_prf#4347 AS s_acctbal_prf_0#4355, s_comment_prf#4348 AS s_comment_prf_0#4356]
         :  :  +- Relation[s_phone_prf#4341,rid#4342,s_address_prf#4343,s_nationkey_prf#4344,s_suppkey_prf#4345,s_name_prf#4346,s_acctbal_prf#4347,s_comment_prf#4348] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4357, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4358]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [p_comment_prf#4359 AS p_comment_prf_1#4369, p_name_prf#4360 AS p_name_prf_1#4370, rid#4361 AS rid_1#4371, p_type_prf#4362 AS p_type_prf_1#4372, p_retailprice_prf#4363 AS p_retailprice_prf_1#4373, p_mfgr_prf#4364 AS p_mfgr_prf_1#4374, p_container_prf#4365 AS p_container_prf_1#4375, p_brand_prf#4366 AS p_brand_prf_1#4376, p_size_prf#4367 AS p_size_prf_1#4377, p_partkey_prf#4368 AS p_partkey_prf_1#4378]
            :  :  +- Relation[p_comment_prf#4359,p_name_prf#4360,rid#4361,p_type_prf#4362,p_retailprice_prf#4363,p_mfgr_prf#4364,p_container_prf#4365,p_brand_prf#4366,p_size_prf#4367,p_partkey_prf#4368] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4379, dexdecrypt('value_dec_key, 'value_right) AS rid_2#4380]
            :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
            :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#4381 AS ps_partkey_and_ps_suppkey_prf_2#4388, rid#4382 AS rid_2#4389, ps_availqty_prf#4383 AS ps_availqty_prf_2#4390, ps_comment_prf#4384 AS ps_comment_prf_2#4391, ps_partkey_prf#4385 AS ps_partkey_prf_2#4392, ps_supplycost_prf#4386 AS ps_supplycost_prf_2#4393, ps_suppkey_prf#4387 AS ps_suppkey_prf_2#4394]
               +- Relation[ps_partkey_and_ps_suppkey_prf#4381,rid#4382,ps_availqty_prf#4383,ps_comment_prf#4384,ps_partkey_prf#4385,ps_supplycost_prf#4386,ps_suppkey_prf#4387] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26211ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/12 17:23:38 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:23:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4456L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 17:23:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4456L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#4458 AS l_returnflag_prf_0#4477, l_orderkey_and_l_linenumber_prf#4459 AS l_orderkey_and_l_linenumber_prf_0#4478, l_comment_prf#4460 AS l_comment_prf_0#4479, l_linestatus_prf#4461 AS l_linestatus_prf_0#4480, rid#4462 AS rid_0#4481, l_shipmode_prf#4463 AS l_shipmode_prf_0#4482, l_shipinstruct_prf#4464 AS l_shipinstruct_prf_0#4483, l_quantity_prf#4465 AS l_quantity_prf_0#4484, l_receiptdate_prf#4466 AS l_receiptdate_prf_0#4485, l_linenumber_prf#4467 AS l_linenumber_prf_0#4486, l_tax_prf#4468 AS l_tax_prf_0#4487, l_shipdate_prf#4469 AS l_shipdate_prf_0#4488, l_extendedprice_prf#4470 AS l_extendedprice_prf_0#4489, l_partkey_prf#4471 AS l_partkey_prf_0#4490, l_discount_prf#4472 AS l_discount_prf_0#4491, l_partkey_and_l_suppkey_prf#4473 AS l_partkey_and_l_suppkey_prf_0#4492, l_commitdate_prf#4474 AS l_commitdate_prf_0#4493, l_suppkey_prf#4475 AS l_suppkey_prf_0#4494, l_orderkey_prf#4476 AS l_orderkey_prf_0#4495]
         :  :  +- Relation[l_returnflag_prf#4458,l_orderkey_and_l_linenumber_prf#4459,l_comment_prf#4460,l_linestatus_prf#4461,rid#4462,l_shipmode_prf#4463,l_shipinstruct_prf#4464,l_quantity_prf#4465,l_receiptdate_prf#4466,l_linenumber_prf#4467,l_tax_prf#4468,l_shipdate_prf#4469,l_extendedprice_prf#4470,l_partkey_prf#4471,l_discount_prf#4472,l_partkey_and_l_suppkey_prf#4473,l_commitdate_prf#4474,l_suppkey_prf#4475,l_orderkey_prf#4476] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4496, dexdecrypt('value_dec_key, 'value_right) AS rid_2#4497]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [c_acctbal_prf#4498 AS c_acctbal_prf_1#4507, rid#4499 AS rid_1#4508, c_name_prf#4500 AS c_name_prf_1#4509, c_nationkey_prf#4501 AS c_nationkey_prf_1#4510, c_custkey_prf#4502 AS c_custkey_prf_1#4511, c_comment_prf#4503 AS c_comment_prf_1#4512, c_address_prf#4504 AS c_address_prf_1#4513, c_mktsegment_prf#4505 AS c_mktsegment_prf_1#4514, c_phone_prf#4506 AS c_phone_prf_1#4515]
            :  :  +- Relation[c_acctbal_prf#4498,rid#4499,c_name_prf#4500,c_nationkey_prf#4501,c_custkey_prf#4502,c_comment_prf#4503,c_address_prf#4504,c_mktsegment_prf#4505,c_phone_prf#4506] JDBCRelation(customer_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4516, dexdecrypt('value_dec_key, 'value_right) AS rid_2#4517]
            :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
            :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4518 AS o_shippriority_prf_2#4528, rid#4519 AS rid_2#4529, o_orderdate_prf#4520 AS o_orderdate_prf_2#4530, o_custkey_prf#4521 AS o_custkey_prf_2#4531, o_orderpriority_prf#4522 AS o_orderpriority_prf_2#4532, o_clerk_prf#4523 AS o_clerk_prf_2#4533, o_orderstatus_prf#4524 AS o_orderstatus_prf_2#4534, o_totalprice_prf#4525 AS o_totalprice_prf_2#4535, o_orderkey_prf#4526 AS o_orderkey_prf_2#4536, o_comment_prf#4527 AS o_comment_prf_2#4537]
               +- Relation[o_shippriority_prf#4518,rid#4519,o_orderdate_prf#4520,o_custkey_prf#4521,o_orderpriority_prf#4522,o_clerk_prf#4523,o_orderstatus_prf#4524,o_totalprice_prf#4525,o_orderkey_prf#4526,o_comment_prf#4527] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 181778ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/12 17:26:39 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:26:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4604L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 17:26:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4604L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [p_comment_prf#4606 AS p_comment_prf_0#4616, p_name_prf#4607 AS p_name_prf_0#4617, rid#4608 AS rid_0#4618, p_type_prf#4609 AS p_type_prf_0#4619, p_retailprice_prf#4610 AS p_retailprice_prf_0#4620, p_mfgr_prf#4611 AS p_mfgr_prf_0#4621, p_container_prf#4612 AS p_container_prf_0#4622, p_brand_prf#4613 AS p_brand_prf_0#4623, p_size_prf#4614 AS p_size_prf_0#4624, p_partkey_prf#4615 AS p_partkey_prf_0#4625]
         :  :  +- Relation[p_comment_prf#4606,p_name_prf#4607,rid#4608,p_type_prf#4609,p_retailprice_prf#4610,p_mfgr_prf#4611,p_container_prf#4612,p_brand_prf#4613,p_size_prf#4614,p_partkey_prf#4615] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4626, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4627]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4628 AS l_returnflag_prf_1#4647, l_orderkey_and_l_linenumber_prf#4629 AS l_orderkey_and_l_linenumber_prf_1#4648, l_comment_prf#4630 AS l_comment_prf_1#4649, l_linestatus_prf#4631 AS l_linestatus_prf_1#4650, rid#4632 AS rid_1#4651, l_shipmode_prf#4633 AS l_shipmode_prf_1#4652, l_shipinstruct_prf#4634 AS l_shipinstruct_prf_1#4653, l_quantity_prf#4635 AS l_quantity_prf_1#4654, l_receiptdate_prf#4636 AS l_receiptdate_prf_1#4655, l_linenumber_prf#4637 AS l_linenumber_prf_1#4656, l_tax_prf#4638 AS l_tax_prf_1#4657, l_shipdate_prf#4639 AS l_shipdate_prf_1#4658, l_extendedprice_prf#4640 AS l_extendedprice_prf_1#4659, l_partkey_prf#4641 AS l_partkey_prf_1#4660, l_discount_prf#4642 AS l_discount_prf_1#4661, l_partkey_and_l_suppkey_prf#4643 AS l_partkey_and_l_suppkey_prf_1#4662, l_commitdate_prf#4644 AS l_commitdate_prf_1#4663, l_suppkey_prf#4645 AS l_suppkey_prf_1#4664, l_orderkey_prf#4646 AS l_orderkey_prf_1#4665]
            +- Relation[l_returnflag_prf#4628,l_orderkey_and_l_linenumber_prf#4629,l_comment_prf#4630,l_linestatus_prf#4631,rid#4632,l_shipmode_prf#4633,l_shipinstruct_prf#4634,l_quantity_prf#4635,l_receiptdate_prf#4636,l_linenumber_prf#4637,l_tax_prf#4638,l_shipdate_prf#4639,l_extendedprice_prf#4640,l_partkey_prf#4641,l_discount_prf#4642,l_partkey_and_l_suppkey_prf#4643,l_commitdate_prf#4644,l_suppkey_prf#4645,l_orderkey_prf#4646] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 95237ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/12 17:28:15 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:28:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4715L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 17:28:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4715L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#4717 AS c_acctbal_prf_0#4726, rid#4718 AS rid_0#4727, c_name_prf#4719 AS c_name_prf_0#4728, c_nationkey_prf#4720 AS c_nationkey_prf_0#4729, c_custkey_prf#4721 AS c_custkey_prf_0#4730, c_comment_prf#4722 AS c_comment_prf_0#4731, c_address_prf#4723 AS c_address_prf_0#4732, c_mktsegment_prf#4724 AS c_mktsegment_prf_0#4733, c_phone_prf#4725 AS c_phone_prf_0#4734]
         :  :  +- Relation[c_acctbal_prf#4717,rid#4718,c_name_prf#4719,c_nationkey_prf#4720,c_custkey_prf#4721,c_comment_prf#4722,c_address_prf#4723,c_mktsegment_prf#4724,c_phone_prf#4725] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4735, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4736]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4737 AS o_shippriority_prf_1#4747, rid#4738 AS rid_1#4748, o_orderdate_prf#4739 AS o_orderdate_prf_1#4749, o_custkey_prf#4740 AS o_custkey_prf_1#4750, o_orderpriority_prf#4741 AS o_orderpriority_prf_1#4751, o_clerk_prf#4742 AS o_clerk_prf_1#4752, o_orderstatus_prf#4743 AS o_orderstatus_prf_1#4753, o_totalprice_prf#4744 AS o_totalprice_prf_1#4754, o_orderkey_prf#4745 AS o_orderkey_prf_1#4755, o_comment_prf#4746 AS o_comment_prf_1#4756]
            +- Relation[o_shippriority_prf#4737,rid#4738,o_orderdate_prf#4739,o_custkey_prf#4740,o_orderpriority_prf#4741,o_clerk_prf#4742,o_orderstatus_prf#4743,o_totalprice_prf#4744,o_orderkey_prf#4745,o_comment_prf#4746] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=1500000
Elapsed time: 23917ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/12 17:28:39 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:28:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4793L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 17:28:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4793L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [ps_partkey_and_ps_suppkey_prf#4795 AS ps_partkey_and_ps_suppkey_prf_0#4802, rid#4796 AS rid_0#4803, ps_availqty_prf#4797 AS ps_availqty_prf_0#4804, ps_comment_prf#4798 AS ps_comment_prf_0#4805, ps_partkey_prf#4799 AS ps_partkey_prf_0#4806, ps_supplycost_prf#4800 AS ps_supplycost_prf_0#4807, ps_suppkey_prf#4801 AS ps_suppkey_prf_0#4808]
         :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#4795,rid#4796,ps_availqty_prf#4797,ps_comment_prf#4798,ps_partkey_prf#4799,ps_supplycost_prf#4800,ps_suppkey_prf#4801] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4809, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4810]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#4811 AS p_comment_prf_1#4821, p_name_prf#4812 AS p_name_prf_1#4822, rid#4813 AS rid_1#4823, p_type_prf#4814 AS p_type_prf_1#4824, p_retailprice_prf#4815 AS p_retailprice_prf_1#4825, p_mfgr_prf#4816 AS p_mfgr_prf_1#4826, p_container_prf#4817 AS p_container_prf_1#4827, p_brand_prf#4818 AS p_brand_prf_1#4828, p_size_prf#4819 AS p_size_prf_1#4829, p_partkey_prf#4820 AS p_partkey_prf_1#4830]
            :  +- Relation[p_comment_prf#4811,p_name_prf#4812,rid#4813,p_type_prf#4814,p_retailprice_prf#4815,p_mfgr_prf#4816,p_container_prf#4817,p_brand_prf#4818,p_size_prf#4819,p_partkey_prf#4820] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4831]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#2148,value#2149] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=15628
Elapsed time: 7738ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/12 17:28:46 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:28:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4863L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 17:28:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4863L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [rid#4865 AS rid_0#4870, n_regionkey_prf#4866 AS n_regionkey_prf_0#4871, n_nationkey_prf#4867 AS n_nationkey_prf_0#4872, n_name_prf#4868 AS n_name_prf_0#4873, n_comment_prf#4869 AS n_comment_prf_0#4874]
         :  :  +- Relation[rid#4865,n_regionkey_prf#4866,n_nationkey_prf#4867,n_name_prf#4868,n_comment_prf#4869] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4875, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4876]
         :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#4877 AS s_phone_prf_1#4885, rid#4878 AS rid_1#4886, s_address_prf#4879 AS s_address_prf_1#4887, s_nationkey_prf#4880 AS s_nationkey_prf_1#4888, s_suppkey_prf#4881 AS s_suppkey_prf_1#4889, s_name_prf#4882 AS s_name_prf_1#4890, s_acctbal_prf#4883 AS s_acctbal_prf_1#4891, s_comment_prf#4884 AS s_comment_prf_1#4892]
            +- Relation[s_phone_prf#4877,rid#4878,s_address_prf#4879,s_nationkey_prf#4880,s_suppkey_prf#4881,s_name_prf#4882,s_acctbal_prf#4883,s_comment_prf#4884] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=10000
Elapsed time: 3303ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/12 17:28:50 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:28:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4941L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 17:28:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4941L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4943 AS s_phone_prf_0#4951, rid#4944 AS rid_0#4952, s_address_prf#4945 AS s_address_prf_0#4953, s_nationkey_prf#4946 AS s_nationkey_prf_0#4954, s_suppkey_prf#4947 AS s_suppkey_prf_0#4955, s_name_prf#4948 AS s_name_prf_0#4956, s_acctbal_prf#4949 AS s_acctbal_prf_0#4957, s_comment_prf#4950 AS s_comment_prf_0#4958]
         :  :  +- Relation[s_phone_prf#4943,rid#4944,s_address_prf#4945,s_nationkey_prf#4946,s_suppkey_prf#4947,s_name_prf#4948,s_acctbal_prf#4949,s_comment_prf#4950] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4959, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4960]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [p_comment_prf#4961 AS p_comment_prf_1#4971, p_name_prf#4962 AS p_name_prf_1#4972, rid#4963 AS rid_1#4973, p_type_prf#4964 AS p_type_prf_1#4974, p_retailprice_prf#4965 AS p_retailprice_prf_1#4975, p_mfgr_prf#4966 AS p_mfgr_prf_1#4976, p_container_prf#4967 AS p_container_prf_1#4977, p_brand_prf#4968 AS p_brand_prf_1#4978, p_size_prf#4969 AS p_size_prf_1#4979, p_partkey_prf#4970 AS p_partkey_prf_1#4980]
            :  :  +- Relation[p_comment_prf#4961,p_name_prf#4962,rid#4963,p_type_prf#4964,p_retailprice_prf#4965,p_mfgr_prf#4966,p_container_prf#4967,p_brand_prf#4968,p_size_prf#4969,p_partkey_prf#4970] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4981, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4982]
            :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
            :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4983 AS l_returnflag_prf_2#5002, l_orderkey_and_l_linenumber_prf#4984 AS l_orderkey_and_l_linenumber_prf_2#5003, l_comment_prf#4985 AS l_comment_prf_2#5004, l_linestatus_prf#4986 AS l_linestatus_prf_2#5005, rid#4987 AS rid_2#5006, l_shipmode_prf#4988 AS l_shipmode_prf_2#5007, l_shipinstruct_prf#4989 AS l_shipinstruct_prf_2#5008, l_quantity_prf#4990 AS l_quantity_prf_2#5009, l_receiptdate_prf#4991 AS l_receiptdate_prf_2#5010, l_linenumber_prf#4992 AS l_linenumber_prf_2#5011, l_tax_prf#4993 AS l_tax_prf_2#5012, l_shipdate_prf#4994 AS l_shipdate_prf_2#5013, l_extendedprice_prf#4995 AS l_extendedprice_prf_2#5014, l_partkey_prf#4996 AS l_partkey_prf_2#5015, l_discount_prf#4997 AS l_discount_prf_2#5016, l_partkey_and_l_suppkey_prf#4998 AS l_partkey_and_l_suppkey_prf_2#5017, l_commitdate_prf#4999 AS l_commitdate_prf_2#5018, l_suppkey_prf#5000 AS l_suppkey_prf_2#5019, l_orderkey_prf#5001 AS l_orderkey_prf_2#5020]
               +- Relation[l_returnflag_prf#4983,l_orderkey_and_l_linenumber_prf#4984,l_comment_prf#4985,l_linestatus_prf#4986,rid#4987,l_shipmode_prf#4988,l_shipinstruct_prf#4989,l_quantity_prf#4990,l_receiptdate_prf#4991,l_linenumber_prf#4992,l_tax_prf#4993,l_shipdate_prf#4994,l_extendedprice_prf#4995,l_partkey_prf#4996,l_discount_prf#4997,l_partkey_and_l_suppkey_prf#4998,l_commitdate_prf#4999,l_suppkey_prf#5000,l_orderkey_prf#5001] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201663ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/12 17:32:11 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:32:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5094L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 17:32:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5094L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [l_returnflag_prf#5096 AS l_returnflag_prf_0#5115, l_orderkey_and_l_linenumber_prf#5097 AS l_orderkey_and_l_linenumber_prf_0#5116, l_comment_prf#5098 AS l_comment_prf_0#5117, l_linestatus_prf#5099 AS l_linestatus_prf_0#5118, rid#5100 AS rid_0#5119, l_shipmode_prf#5101 AS l_shipmode_prf_0#5120, l_shipinstruct_prf#5102 AS l_shipinstruct_prf_0#5121, l_quantity_prf#5103 AS l_quantity_prf_0#5122, l_receiptdate_prf#5104 AS l_receiptdate_prf_0#5123, l_linenumber_prf#5105 AS l_linenumber_prf_0#5124, l_tax_prf#5106 AS l_tax_prf_0#5125, l_shipdate_prf#5107 AS l_shipdate_prf_0#5126, l_extendedprice_prf#5108 AS l_extendedprice_prf_0#5127, l_partkey_prf#5109 AS l_partkey_prf_0#5128, l_discount_prf#5110 AS l_discount_prf_0#5129, l_partkey_and_l_suppkey_prf#5111 AS l_partkey_and_l_suppkey_prf_0#5130, l_commitdate_prf#5112 AS l_commitdate_prf_0#5131, l_suppkey_prf#5113 AS l_suppkey_prf_0#5132, l_orderkey_prf#5114 AS l_orderkey_prf_0#5133]
         :  :  :  :  +- Relation[l_returnflag_prf#5096,l_orderkey_and_l_linenumber_prf#5097,l_comment_prf#5098,l_linestatus_prf#5099,rid#5100,l_shipmode_prf#5101,l_shipinstruct_prf#5102,l_quantity_prf#5103,l_receiptdate_prf#5104,l_linenumber_prf#5105,l_tax_prf#5106,l_shipdate_prf#5107,l_extendedprice_prf#5108,l_partkey_prf#5109,l_discount_prf#5110,l_partkey_and_l_suppkey_prf#5111,l_commitdate_prf#5112,l_suppkey_prf#5113,l_orderkey_prf#5114] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5134, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5135]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :  :  :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#5136 AS o_shippriority_prf_1#5146, rid#5137 AS rid_1#5147, o_orderdate_prf#5138 AS o_orderdate_prf_1#5148, o_custkey_prf#5139 AS o_custkey_prf_1#5149, o_orderpriority_prf#5140 AS o_orderpriority_prf_1#5150, o_clerk_prf#5141 AS o_clerk_prf_1#5151, o_orderstatus_prf#5142 AS o_orderstatus_prf_1#5152, o_totalprice_prf#5143 AS o_totalprice_prf_1#5153, o_orderkey_prf#5144 AS o_orderkey_prf_1#5154, o_comment_prf#5145 AS o_comment_prf_1#5155]
         :  :     +- Relation[o_shippriority_prf#5136,rid#5137,o_orderdate_prf#5138,o_custkey_prf#5139,o_orderpriority_prf#5140,o_clerk_prf#5141,o_orderstatus_prf#5142,o_totalprice_prf#5143,o_orderkey_prf#5144,o_comment_prf#5145] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#5156, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5157]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#5158 AS c_acctbal_prf_2#5167, rid#5159 AS rid_2#5168, c_name_prf#5160 AS c_name_prf_2#5169, c_nationkey_prf#5161 AS c_nationkey_prf_2#5170, c_custkey_prf#5162 AS c_custkey_prf_2#5171, c_comment_prf#5163 AS c_comment_prf_2#5172, c_address_prf#5164 AS c_address_prf_2#5173, c_mktsegment_prf#5165 AS c_mktsegment_prf_2#5174, c_phone_prf#5166 AS c_phone_prf_2#5175]
            +- Relation[c_acctbal_prf#5158,rid#5159,c_name_prf#5160,c_nationkey_prf#5161,c_custkey_prf#5162,c_comment_prf#5163,c_address_prf#5164,c_mktsegment_prf#5165,c_phone_prf#5166] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 183539ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/12 17:35:15 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:35:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5224L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 17:35:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5224L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [r_regionkey_prf#5226 AS r_regionkey_prf_0#5230, r_name_prf#5227 AS r_name_prf_0#5231, r_comment_prf#5228 AS r_comment_prf_0#5232, rid#5229 AS rid_0#5233]
         :  :  +- Relation[r_regionkey_prf#5226,r_name_prf#5227,r_comment_prf#5228,rid#5229] JDBCRelation(region_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#5234, dexdecrypt('value_dec_key, 'value_right) AS rid_0#5235]
         :     +- SpxRidUncorrelatedJoin nation~n_regionkey~region~r_regionkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [rid#5236 AS rid_1#5241, n_regionkey_prf#5237 AS n_regionkey_prf_1#5242, n_nationkey_prf#5238 AS n_nationkey_prf_1#5243, n_name_prf#5239 AS n_name_prf_1#5244, n_comment_prf#5240 AS n_comment_prf_1#5245]
            +- Relation[rid#5236,n_regionkey_prf#5237,n_nationkey_prf#5238,n_name_prf#5239,n_comment_prf#5240] JDBCRelation(nation_prf) [numPartitions=1]

DexSpx$ result size=25
Elapsed time: 67ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/12 17:35:15 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:35:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5277L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 17:35:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5277L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#5279 AS c_acctbal_prf_0#5288, rid#5280 AS rid_0#5289, c_name_prf#5281 AS c_name_prf_0#5290, c_nationkey_prf#5282 AS c_nationkey_prf_0#5291, c_custkey_prf#5283 AS c_custkey_prf_0#5292, c_comment_prf#5284 AS c_comment_prf_0#5293, c_address_prf#5285 AS c_address_prf_0#5294, c_mktsegment_prf#5286 AS c_mktsegment_prf_0#5295, c_phone_prf#5287 AS c_phone_prf_0#5296]
         :  :  +- Relation[c_acctbal_prf#5279,rid#5280,c_name_prf#5281,c_nationkey_prf#5282,c_custkey_prf#5283,c_comment_prf#5284,c_address_prf#5285,c_mktsegment_prf#5286,c_phone_prf#5287] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5297, dexdecrypt('value_dec_key, 'value_right) AS rid_2#5298]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [s_phone_prf#5299 AS s_phone_prf_1#5307, rid#5300 AS rid_1#5308, s_address_prf#5301 AS s_address_prf_1#5309, s_nationkey_prf#5302 AS s_nationkey_prf_1#5310, s_suppkey_prf#5303 AS s_suppkey_prf_1#5311, s_name_prf#5304 AS s_name_prf_1#5312, s_acctbal_prf#5305 AS s_acctbal_prf_1#5313, s_comment_prf#5306 AS s_comment_prf_1#5314]
            :  :  +- Relation[s_phone_prf#5299,rid#5300,s_address_prf#5301,s_nationkey_prf#5302,s_suppkey_prf#5303,s_name_prf#5304,s_acctbal_prf#5305,s_comment_prf#5306] JDBCRelation(supplier_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#5315, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5316]
            :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
            :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [rid#5317 AS rid_2#5322, n_regionkey_prf#5318 AS n_regionkey_prf_2#5323, n_nationkey_prf#5319 AS n_nationkey_prf_2#5324, n_name_prf#5320 AS n_name_prf_2#5325, n_comment_prf#5321 AS n_comment_prf_2#5326]
               +- Relation[rid#5317,n_regionkey_prf#5318,n_nationkey_prf#5319,n_name_prf#5320,n_comment_prf#5321] JDBCRelation(nation_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 926099ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/12 17:50:41 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 17:50:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5377L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 17:50:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5377L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#5379 AS l_returnflag_prf_0#5398, l_orderkey_and_l_linenumber_prf#5380 AS l_orderkey_and_l_linenumber_prf_0#5399, l_comment_prf#5381 AS l_comment_prf_0#5400, l_linestatus_prf#5382 AS l_linestatus_prf_0#5401, rid#5383 AS rid_0#5402, l_shipmode_prf#5384 AS l_shipmode_prf_0#5403, l_shipinstruct_prf#5385 AS l_shipinstruct_prf_0#5404, l_quantity_prf#5386 AS l_quantity_prf_0#5405, l_receiptdate_prf#5387 AS l_receiptdate_prf_0#5406, l_linenumber_prf#5388 AS l_linenumber_prf_0#5407, l_tax_prf#5389 AS l_tax_prf_0#5408, l_shipdate_prf#5390 AS l_shipdate_prf_0#5409, l_extendedprice_prf#5391 AS l_extendedprice_prf_0#5410, l_partkey_prf#5392 AS l_partkey_prf_0#5411, l_discount_prf#5393 AS l_discount_prf_0#5412, l_partkey_and_l_suppkey_prf#5394 AS l_partkey_and_l_suppkey_prf_0#5413, l_commitdate_prf#5395 AS l_commitdate_prf_0#5414, l_suppkey_prf#5396 AS l_suppkey_prf_0#5415, l_orderkey_prf#5397 AS l_orderkey_prf_0#5416]
         :  :  +- Relation[l_returnflag_prf#5379,l_orderkey_and_l_linenumber_prf#5380,l_comment_prf#5381,l_linestatus_prf#5382,rid#5383,l_shipmode_prf#5384,l_shipinstruct_prf#5385,l_quantity_prf#5386,l_receiptdate_prf#5387,l_linenumber_prf#5388,l_tax_prf#5389,l_shipdate_prf#5390,l_extendedprice_prf#5391,l_partkey_prf#5392,l_discount_prf#5393,l_partkey_and_l_suppkey_prf#5394,l_commitdate_prf#5395,l_suppkey_prf#5396,l_orderkey_prf#5397] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5417, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5418]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :        +- Relation[label#1507,value_left#1508,value_right#1509] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [p_comment_prf#5419 AS p_comment_prf_1#5429, p_name_prf#5420 AS p_name_prf_1#5430, rid#5421 AS rid_1#5431, p_type_prf#5422 AS p_type_prf_1#5432, p_retailprice_prf#5423 AS p_retailprice_prf_1#5433, p_mfgr_prf#5424 AS p_mfgr_prf_1#5434, p_container_prf#5425 AS p_container_prf_1#5435, p_brand_prf#5426 AS p_brand_prf_1#5436, p_size_prf#5427 AS p_size_prf_1#5437, p_partkey_prf#5428 AS p_partkey_prf_1#5438]
            +- Relation[p_comment_prf#5419,p_name_prf#5420,rid#5421,p_type_prf#5422,p_retailprice_prf#5423,p_mfgr_prf#5424,p_container_prf#5425,p_brand_prf#5426,p_size_prf#5427,p_partkey_prf#5428] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 95342ms
query=b1a, count=15628, duration=7744
query=b1b, count=15628, duration=7738
query=b2a, count=1478870, duration=98575
query=b2b, count=1478870, duration=97699
query=f1, count=1, duration=52
query=f2, count=3907, duration=125
query=f3, count=1451, duration=84
query=f4, count=1, duration=55
query=f5, count=1478870, duration=23421
query=f6, count=857401, duration=13619
query=j1, count=800000, duration=12352
query=j10, count=6001215, duration=90505
query=j2, count=800000, duration=11738
query=j3, count=25, duration=67
query=j4, count=150000, duration=2517
query=j5, count=10000, duration=3303
query=j6, count=6001215, duration=105410
query=j7, count=1500000, duration=23917
query=j8, count=6001215, duration=107140
query=j8b, count=6001215, duration=107069
query=j9, count=6001215, duration=95237
query=j9b, count=6001215, duration=95342
query=r1a, count=6001215, duration=183539
query=r1b, count=6001215, duration=183189
query=r1c, count=6001215, duration=181778
query=r1d, count=6001215, duration=169549
query=r1e, count=6001215, duration=168626
query=r1f, count=6001215, duration=147899
query=t1a, count=60000414, duration=900011
query=t1b, count=60000414, duration=908190
query=t1c, count=60000414, duration=926099
query=t2a, count=800000, duration=26088
query=t2b, count=800000, duration=26153
query=t2c, count=800000, duration=26211
query=t2d, count=800000, duration=26230
query=t3a, count=6001215, duration=201974
query=t3b, count=6001215, duration=201569
query=t3c, count=6001215, duration=201663
query=t3d, count=6001215, duration=200730
