19/10/12 08:37:21 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7094ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Oct 12 08:37:23 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Oct 12 08:37:24 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Oct 12 08:37:25 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Oct 12 08:37:25 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Oct 12 08:37:25 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Oct 12 08:37:27 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Oct 12 08:37:29 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Oct 12 08:37:30 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/12 08:37:31 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 08:37:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1496L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 08:37:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1496L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#1498 AS l_returnflag_prf_0#1517, l_orderkey_and_l_linenumber_prf#1499 AS l_orderkey_and_l_linenumber_prf_0#1518, l_comment_prf#1500 AS l_comment_prf_0#1519, l_linestatus_prf#1501 AS l_linestatus_prf_0#1520, rid#1502 AS rid_0#1521, l_shipmode_prf#1503 AS l_shipmode_prf_0#1522, l_shipinstruct_prf#1504 AS l_shipinstruct_prf_0#1523, l_quantity_prf#1505 AS l_quantity_prf_0#1524, l_receiptdate_prf#1506 AS l_receiptdate_prf_0#1525, l_linenumber_prf#1507 AS l_linenumber_prf_0#1526, l_tax_prf#1508 AS l_tax_prf_0#1527, l_shipdate_prf#1509 AS l_shipdate_prf_0#1528, l_extendedprice_prf#1510 AS l_extendedprice_prf_0#1529, l_partkey_prf#1511 AS l_partkey_prf_0#1530, l_discount_prf#1512 AS l_discount_prf_0#1531, l_partkey_and_l_suppkey_prf#1513 AS l_partkey_and_l_suppkey_prf_0#1532, l_commitdate_prf#1514 AS l_commitdate_prf_0#1533, l_suppkey_prf#1515 AS l_suppkey_prf_0#1534, l_orderkey_prf#1516 AS l_orderkey_prf_0#1535]
         :  :  +- Relation[l_returnflag_prf#1498,l_orderkey_and_l_linenumber_prf#1499,l_comment_prf#1500,l_linestatus_prf#1501,rid#1502,l_shipmode_prf#1503,l_shipinstruct_prf#1504,l_quantity_prf#1505,l_receiptdate_prf#1506,l_linenumber_prf#1507,l_tax_prf#1508,l_shipdate_prf#1509,l_extendedprice_prf#1510,l_partkey_prf#1511,l_discount_prf#1512,l_partkey_and_l_suppkey_prf#1513,l_commitdate_prf#1514,l_suppkey_prf#1515,l_orderkey_prf#1516] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1539, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1540]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [p_comment_prf#1541 AS p_comment_prf_1#1551, p_name_prf#1542 AS p_name_prf_1#1552, rid#1543 AS rid_1#1553, p_type_prf#1544 AS p_type_prf_1#1554, p_retailprice_prf#1545 AS p_retailprice_prf_1#1555, p_mfgr_prf#1546 AS p_mfgr_prf_1#1556, p_container_prf#1547 AS p_container_prf_1#1557, p_brand_prf#1548 AS p_brand_prf_1#1558, p_size_prf#1549 AS p_size_prf_1#1559, p_partkey_prf#1550 AS p_partkey_prf_1#1560]
            +- Relation[p_comment_prf#1541,p_name_prf#1542,rid#1543,p_type_prf#1544,p_retailprice_prf#1545,p_mfgr_prf#1546,p_container_prf#1547,p_brand_prf#1548,p_size_prf#1549,p_partkey_prf#1550] JDBCRelation(part_prf) [numPartitions=1]

19/10/12 08:37:31 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexSpx$ result size=6001215
Elapsed time: 95148ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/12 08:39:06 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 08:39:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1604L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 08:39:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1604L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [rid#1606 AS rid_0#1611, n_regionkey_prf#1607 AS n_regionkey_prf_0#1612, n_nationkey_prf#1608 AS n_nationkey_prf_0#1613, n_name_prf#1609 AS n_name_prf_0#1614, n_comment_prf#1610 AS n_comment_prf_0#1615]
         :  :  +- Relation[rid#1606,n_regionkey_prf#1607,n_nationkey_prf#1608,n_name_prf#1609,n_comment_prf#1610] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1616, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1617]
         :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#1618 AS s_phone_prf_1#1626, rid#1619 AS rid_1#1627, s_address_prf#1620 AS s_address_prf_1#1628, s_nationkey_prf#1621 AS s_nationkey_prf_1#1629, s_suppkey_prf#1622 AS s_suppkey_prf_1#1630, s_name_prf#1623 AS s_name_prf_1#1631, s_acctbal_prf#1624 AS s_acctbal_prf_1#1632, s_comment_prf#1625 AS s_comment_prf_1#1633]
            +- Relation[s_phone_prf#1618,rid#1619,s_address_prf#1620,s_nationkey_prf#1621,s_suppkey_prf#1622,s_name_prf#1623,s_acctbal_prf#1624,s_comment_prf#1625] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=10000
Elapsed time: 241ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/12 08:39:06 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 08:39:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1669L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 08:39:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1669L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [s_phone_prf#1671 AS s_phone_prf_0#1679, rid#1672 AS rid_0#1680, s_address_prf#1673 AS s_address_prf_0#1681, s_nationkey_prf#1674 AS s_nationkey_prf_0#1682, s_suppkey_prf#1675 AS s_suppkey_prf_0#1683, s_name_prf#1676 AS s_name_prf_0#1684, s_acctbal_prf#1677 AS s_acctbal_prf_0#1685, s_comment_prf#1678 AS s_comment_prf_0#1686]
         :  :  :  :  +- Relation[s_phone_prf#1671,rid#1672,s_address_prf#1673,s_nationkey_prf#1674,s_suppkey_prf#1675,s_name_prf#1676,s_acctbal_prf#1677,s_comment_prf#1678] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1687, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1688]
         :  :  :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :  :  :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [rid#1689 AS rid_1#1694, n_regionkey_prf#1690 AS n_regionkey_prf_1#1695, n_nationkey_prf#1691 AS n_nationkey_prf_1#1696, n_name_prf#1692 AS n_name_prf_1#1697, n_comment_prf#1693 AS n_comment_prf_1#1698]
         :  :     +- Relation[rid#1689,n_regionkey_prf#1690,n_nationkey_prf#1691,n_name_prf#1692,n_comment_prf#1693] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#1699, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1700]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#1701 AS c_acctbal_prf_2#1710, rid#1702 AS rid_2#1711, c_name_prf#1703 AS c_name_prf_2#1712, c_nationkey_prf#1704 AS c_nationkey_prf_2#1713, c_custkey_prf#1705 AS c_custkey_prf_2#1714, c_comment_prf#1706 AS c_comment_prf_2#1715, c_address_prf#1707 AS c_address_prf_2#1716, c_mktsegment_prf#1708 AS c_mktsegment_prf_2#1717, c_phone_prf#1709 AS c_phone_prf_2#1718]
            +- Relation[c_acctbal_prf#1701,rid#1702,c_name_prf#1703,c_nationkey_prf#1704,c_custkey_prf#1705,c_comment_prf#1706,c_address_prf#1707,c_mktsegment_prf#1708,c_phone_prf#1709] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 887500ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/12 08:53:54 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 08:53:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1756L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 08:53:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1756L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [rid#1758 AS rid_0#1763, n_regionkey_prf#1759 AS n_regionkey_prf_0#1764, n_nationkey_prf#1760 AS n_nationkey_prf_0#1765, n_name_prf#1761 AS n_name_prf_0#1766, n_comment_prf#1762 AS n_comment_prf_0#1767]
         :  :  +- Relation[rid#1758,n_regionkey_prf#1759,n_nationkey_prf#1760,n_name_prf#1761,n_comment_prf#1762] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1768, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1769]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#1770 AS c_acctbal_prf_1#1779, rid#1771 AS rid_1#1780, c_name_prf#1772 AS c_name_prf_1#1781, c_nationkey_prf#1773 AS c_nationkey_prf_1#1782, c_custkey_prf#1774 AS c_custkey_prf_1#1783, c_comment_prf#1775 AS c_comment_prf_1#1784, c_address_prf#1776 AS c_address_prf_1#1785, c_mktsegment_prf#1777 AS c_mktsegment_prf_1#1786, c_phone_prf#1778 AS c_phone_prf_1#1787]
            +- Relation[c_acctbal_prf#1770,rid#1771,c_name_prf#1772,c_nationkey_prf#1773,c_custkey_prf#1774,c_comment_prf#1775,c_address_prf#1776,c_mktsegment_prf#1777,c_phone_prf#1778] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=150000
Elapsed time: 2533ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/12 08:53:56 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 08:53:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1838L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 08:53:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1838L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#1840 AS c_acctbal_prf_0#1849, rid#1841 AS rid_0#1850, c_name_prf#1842 AS c_name_prf_0#1851, c_nationkey_prf#1843 AS c_nationkey_prf_0#1852, c_custkey_prf#1844 AS c_custkey_prf_0#1853, c_comment_prf#1845 AS c_comment_prf_0#1854, c_address_prf#1846 AS c_address_prf_0#1855, c_mktsegment_prf#1847 AS c_mktsegment_prf_0#1856, c_phone_prf#1848 AS c_phone_prf_0#1857]
         :  :  +- Relation[c_acctbal_prf#1840,rid#1841,c_name_prf#1842,c_nationkey_prf#1843,c_custkey_prf#1844,c_comment_prf#1845,c_address_prf#1846,c_mktsegment_prf#1847,c_phone_prf#1848] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1858, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1859]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [o_shippriority_prf#1860 AS o_shippriority_prf_1#1870, rid#1861 AS rid_1#1871, o_orderdate_prf#1862 AS o_orderdate_prf_1#1872, o_custkey_prf#1863 AS o_custkey_prf_1#1873, o_orderpriority_prf#1864 AS o_orderpriority_prf_1#1874, o_clerk_prf#1865 AS o_clerk_prf_1#1875, o_orderstatus_prf#1866 AS o_orderstatus_prf_1#1876, o_totalprice_prf#1867 AS o_totalprice_prf_1#1877, o_orderkey_prf#1868 AS o_orderkey_prf_1#1878, o_comment_prf#1869 AS o_comment_prf_1#1879]
            :  :  +- Relation[o_shippriority_prf#1860,rid#1861,o_orderdate_prf#1862,o_custkey_prf#1863,o_orderpriority_prf#1864,o_clerk_prf#1865,o_orderstatus_prf#1866,o_totalprice_prf#1867,o_orderkey_prf#1868,o_comment_prf#1869] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#1880, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1881]
            :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
            :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#1882 AS l_returnflag_prf_2#1901, l_orderkey_and_l_linenumber_prf#1883 AS l_orderkey_and_l_linenumber_prf_2#1902, l_comment_prf#1884 AS l_comment_prf_2#1903, l_linestatus_prf#1885 AS l_linestatus_prf_2#1904, rid#1886 AS rid_2#1905, l_shipmode_prf#1887 AS l_shipmode_prf_2#1906, l_shipinstruct_prf#1888 AS l_shipinstruct_prf_2#1907, l_quantity_prf#1889 AS l_quantity_prf_2#1908, l_receiptdate_prf#1890 AS l_receiptdate_prf_2#1909, l_linenumber_prf#1891 AS l_linenumber_prf_2#1910, l_tax_prf#1892 AS l_tax_prf_2#1911, l_shipdate_prf#1893 AS l_shipdate_prf_2#1912, l_extendedprice_prf#1894 AS l_extendedprice_prf_2#1913, l_partkey_prf#1895 AS l_partkey_prf_2#1914, l_discount_prf#1896 AS l_discount_prf_2#1915, l_partkey_and_l_suppkey_prf#1897 AS l_partkey_and_l_suppkey_prf_2#1916, l_commitdate_prf#1898 AS l_commitdate_prf_2#1917, l_suppkey_prf#1899 AS l_suppkey_prf_2#1918, l_orderkey_prf#1900 AS l_orderkey_prf_2#1919]
               +- Relation[l_returnflag_prf#1882,l_orderkey_and_l_linenumber_prf#1883,l_comment_prf#1884,l_linestatus_prf#1885,rid#1886,l_shipmode_prf#1887,l_shipinstruct_prf#1888,l_quantity_prf#1889,l_receiptdate_prf#1890,l_linenumber_prf#1891,l_tax_prf#1892,l_shipdate_prf#1893,l_extendedprice_prf#1894,l_partkey_prf#1895,l_discount_prf#1896,l_partkey_and_l_suppkey_prf#1897,l_commitdate_prf#1898,l_suppkey_prf#1899,l_orderkey_prf#1900] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 168514ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/12 08:56:45 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 08:56:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1986L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 08:56:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1986L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [l_returnflag_prf#1988 AS l_returnflag_prf_0#2007, l_orderkey_and_l_linenumber_prf#1989 AS l_orderkey_and_l_linenumber_prf_0#2008, l_comment_prf#1990 AS l_comment_prf_0#2009, l_linestatus_prf#1991 AS l_linestatus_prf_0#2010, rid#1992 AS rid_0#2011, l_shipmode_prf#1993 AS l_shipmode_prf_0#2012, l_shipinstruct_prf#1994 AS l_shipinstruct_prf_0#2013, l_quantity_prf#1995 AS l_quantity_prf_0#2014, l_receiptdate_prf#1996 AS l_receiptdate_prf_0#2015, l_linenumber_prf#1997 AS l_linenumber_prf_0#2016, l_tax_prf#1998 AS l_tax_prf_0#2017, l_shipdate_prf#1999 AS l_shipdate_prf_0#2018, l_extendedprice_prf#2000 AS l_extendedprice_prf_0#2019, l_partkey_prf#2001 AS l_partkey_prf_0#2020, l_discount_prf#2002 AS l_discount_prf_0#2021, l_partkey_and_l_suppkey_prf#2003 AS l_partkey_and_l_suppkey_prf_0#2022, l_commitdate_prf#2004 AS l_commitdate_prf_0#2023, l_suppkey_prf#2005 AS l_suppkey_prf_0#2024, l_orderkey_prf#2006 AS l_orderkey_prf_0#2025]
         :  :  :  +- Relation[l_returnflag_prf#1988,l_orderkey_and_l_linenumber_prf#1989,l_comment_prf#1990,l_linestatus_prf#1991,rid#1992,l_shipmode_prf#1993,l_shipinstruct_prf#1994,l_quantity_prf#1995,l_receiptdate_prf#1996,l_linenumber_prf#1997,l_tax_prf#1998,l_shipdate_prf#1999,l_extendedprice_prf#2000,l_partkey_prf#2001,l_discount_prf#2002,l_partkey_and_l_suppkey_prf#2003,l_commitdate_prf#2004,l_suppkey_prf#2005,l_orderkey_prf#2006] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2028]
         :  :     +- DexRidFilter lineitem~l_returnflag~R
         :  :        +- Relation[label#2026,value#2027] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2029, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2030]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2031 AS o_shippriority_prf_1#2041, rid#2032 AS rid_1#2042, o_orderdate_prf#2033 AS o_orderdate_prf_1#2043, o_custkey_prf#2034 AS o_custkey_prf_1#2044, o_orderpriority_prf#2035 AS o_orderpriority_prf_1#2045, o_clerk_prf#2036 AS o_clerk_prf_1#2046, o_orderstatus_prf#2037 AS o_orderstatus_prf_1#2047, o_totalprice_prf#2038 AS o_totalprice_prf_1#2048, o_orderkey_prf#2039 AS o_orderkey_prf_1#2049, o_comment_prf#2040 AS o_comment_prf_1#2050]
            +- Relation[o_shippriority_prf#2031,rid#2032,o_orderdate_prf#2033,o_custkey_prf#2034,o_orderpriority_prf#2035,o_clerk_prf#2036,o_orderstatus_prf#2037,o_totalprice_prf#2038,o_orderkey_prf#2039,o_comment_prf#2040] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 97475ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/12 08:58:22 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 08:58:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2115L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 08:58:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2115L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#2117 AS s_phone_prf_0#2125, rid#2118 AS rid_0#2126, s_address_prf#2119 AS s_address_prf_0#2127, s_nationkey_prf#2120 AS s_nationkey_prf_0#2128, s_suppkey_prf#2121 AS s_suppkey_prf_0#2129, s_name_prf#2122 AS s_name_prf_0#2130, s_acctbal_prf#2123 AS s_acctbal_prf_0#2131, s_comment_prf#2124 AS s_comment_prf_0#2132]
         :  :  +- Relation[s_phone_prf#2117,rid#2118,s_address_prf#2119,s_nationkey_prf#2120,s_suppkey_prf#2121,s_name_prf#2122,s_acctbal_prf#2123,s_comment_prf#2124] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2133, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2134]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [p_comment_prf#2135 AS p_comment_prf_1#2145, p_name_prf#2136 AS p_name_prf_1#2146, rid#2137 AS rid_1#2147, p_type_prf#2138 AS p_type_prf_1#2148, p_retailprice_prf#2139 AS p_retailprice_prf_1#2149, p_mfgr_prf#2140 AS p_mfgr_prf_1#2150, p_container_prf#2141 AS p_container_prf_1#2151, p_brand_prf#2142 AS p_brand_prf_1#2152, p_size_prf#2143 AS p_size_prf_1#2153, p_partkey_prf#2144 AS p_partkey_prf_1#2154]
            :  :  +- Relation[p_comment_prf#2135,p_name_prf#2136,rid#2137,p_type_prf#2138,p_retailprice_prf#2139,p_mfgr_prf#2140,p_container_prf#2141,p_brand_prf#2142,p_size_prf#2143,p_partkey_prf#2144] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2155, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2156]
            :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
            :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2157 AS l_returnflag_prf_2#2176, l_orderkey_and_l_linenumber_prf#2158 AS l_orderkey_and_l_linenumber_prf_2#2177, l_comment_prf#2159 AS l_comment_prf_2#2178, l_linestatus_prf#2160 AS l_linestatus_prf_2#2179, rid#2161 AS rid_2#2180, l_shipmode_prf#2162 AS l_shipmode_prf_2#2181, l_shipinstruct_prf#2163 AS l_shipinstruct_prf_2#2182, l_quantity_prf#2164 AS l_quantity_prf_2#2183, l_receiptdate_prf#2165 AS l_receiptdate_prf_2#2184, l_linenumber_prf#2166 AS l_linenumber_prf_2#2185, l_tax_prf#2167 AS l_tax_prf_2#2186, l_shipdate_prf#2168 AS l_shipdate_prf_2#2187, l_extendedprice_prf#2169 AS l_extendedprice_prf_2#2188, l_partkey_prf#2170 AS l_partkey_prf_2#2189, l_discount_prf#2171 AS l_discount_prf_2#2190, l_partkey_and_l_suppkey_prf#2172 AS l_partkey_and_l_suppkey_prf_2#2191, l_commitdate_prf#2173 AS l_commitdate_prf_2#2192, l_suppkey_prf#2174 AS l_suppkey_prf_2#2193, l_orderkey_prf#2175 AS l_orderkey_prf_2#2194]
               +- Relation[l_returnflag_prf#2157,l_orderkey_and_l_linenumber_prf#2158,l_comment_prf#2159,l_linestatus_prf#2160,rid#2161,l_shipmode_prf#2162,l_shipinstruct_prf#2163,l_quantity_prf#2164,l_receiptdate_prf#2165,l_linenumber_prf#2166,l_tax_prf#2167,l_shipdate_prf#2168,l_extendedprice_prf#2169,l_partkey_prf#2170,l_discount_prf#2171,l_partkey_and_l_suppkey_prf#2172,l_commitdate_prf#2173,l_suppkey_prf#2174,l_orderkey_prf#2175] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201634ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/12 09:01:44 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:01:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2258L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 09:01:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2258L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#2260 AS s_phone_prf_0#2268, rid#2261 AS rid_0#2269, s_address_prf#2262 AS s_address_prf_0#2270, s_nationkey_prf#2263 AS s_nationkey_prf_0#2271, s_suppkey_prf#2264 AS s_suppkey_prf_0#2272, s_name_prf#2265 AS s_name_prf_0#2273, s_acctbal_prf#2266 AS s_acctbal_prf_0#2274, s_comment_prf#2267 AS s_comment_prf_0#2275]
         :  :  +- Relation[s_phone_prf#2260,rid#2261,s_address_prf#2262,s_nationkey_prf#2263,s_suppkey_prf#2264,s_name_prf#2265,s_acctbal_prf#2266,s_comment_prf#2267] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2276, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2277]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2278 AS l_returnflag_prf_1#2297, l_orderkey_and_l_linenumber_prf#2279 AS l_orderkey_and_l_linenumber_prf_1#2298, l_comment_prf#2280 AS l_comment_prf_1#2299, l_linestatus_prf#2281 AS l_linestatus_prf_1#2300, rid#2282 AS rid_1#2301, l_shipmode_prf#2283 AS l_shipmode_prf_1#2302, l_shipinstruct_prf#2284 AS l_shipinstruct_prf_1#2303, l_quantity_prf#2285 AS l_quantity_prf_1#2304, l_receiptdate_prf#2286 AS l_receiptdate_prf_1#2305, l_linenumber_prf#2287 AS l_linenumber_prf_1#2306, l_tax_prf#2288 AS l_tax_prf_1#2307, l_shipdate_prf#2289 AS l_shipdate_prf_1#2308, l_extendedprice_prf#2290 AS l_extendedprice_prf_1#2309, l_partkey_prf#2291 AS l_partkey_prf_1#2310, l_discount_prf#2292 AS l_discount_prf_1#2311, l_partkey_and_l_suppkey_prf#2293 AS l_partkey_and_l_suppkey_prf_1#2312, l_commitdate_prf#2294 AS l_commitdate_prf_1#2313, l_suppkey_prf#2295 AS l_suppkey_prf_1#2314, l_orderkey_prf#2296 AS l_orderkey_prf_1#2315]
            +- Relation[l_returnflag_prf#2278,l_orderkey_and_l_linenumber_prf#2279,l_comment_prf#2280,l_linestatus_prf#2281,rid#2282,l_shipmode_prf#2283,l_shipinstruct_prf#2284,l_quantity_prf#2285,l_receiptdate_prf#2286,l_linenumber_prf#2287,l_tax_prf#2288,l_shipdate_prf#2289,l_extendedprice_prf#2290,l_partkey_prf#2291,l_discount_prf#2292,l_partkey_and_l_suppkey_prf#2293,l_commitdate_prf#2294,l_suppkey_prf#2295,l_orderkey_prf#2296] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 89297ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/12 09:03:13 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:03:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2363L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 09:03:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2363L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#2365 AS c_acctbal_prf_0#2374, rid#2366 AS rid_0#2375, c_name_prf#2367 AS c_name_prf_0#2376, c_nationkey_prf#2368 AS c_nationkey_prf_0#2377, c_custkey_prf#2369 AS c_custkey_prf_0#2378, c_comment_prf#2370 AS c_comment_prf_0#2379, c_address_prf#2371 AS c_address_prf_0#2380, c_mktsegment_prf#2372 AS c_mktsegment_prf_0#2381, c_phone_prf#2373 AS c_phone_prf_0#2382]
         :  :  +- Relation[c_acctbal_prf#2365,rid#2366,c_name_prf#2367,c_nationkey_prf#2368,c_custkey_prf#2369,c_comment_prf#2370,c_address_prf#2371,c_mktsegment_prf#2372,c_phone_prf#2373] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2383, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2384]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2385 AS o_shippriority_prf_1#2395, rid#2386 AS rid_1#2396, o_orderdate_prf#2387 AS o_orderdate_prf_1#2397, o_custkey_prf#2388 AS o_custkey_prf_1#2398, o_orderpriority_prf#2389 AS o_orderpriority_prf_1#2399, o_clerk_prf#2390 AS o_clerk_prf_1#2400, o_orderstatus_prf#2391 AS o_orderstatus_prf_1#2401, o_totalprice_prf#2392 AS o_totalprice_prf_1#2402, o_orderkey_prf#2393 AS o_orderkey_prf_1#2403, o_comment_prf#2394 AS o_comment_prf_1#2404]
            +- Relation[o_shippriority_prf#2385,rid#2386,o_orderdate_prf#2387,o_custkey_prf#2388,o_orderpriority_prf#2389,o_clerk_prf#2390,o_orderstatus_prf#2391,o_totalprice_prf#2392,o_orderkey_prf#2393,o_comment_prf#2394] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=1500000
Elapsed time: 23513ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/12 09:03:37 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:03:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2448L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 09:03:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2448L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [ps_partkey_and_ps_suppkey_prf#2450 AS ps_partkey_and_ps_suppkey_prf_0#2457, rid#2451 AS rid_0#2458, ps_availqty_prf#2452 AS ps_availqty_prf_0#2459, ps_comment_prf#2453 AS ps_comment_prf_0#2460, ps_partkey_prf#2454 AS ps_partkey_prf_0#2461, ps_supplycost_prf#2455 AS ps_supplycost_prf_0#2462, ps_suppkey_prf#2456 AS ps_suppkey_prf_0#2463]
         :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#2450,rid#2451,ps_availqty_prf#2452,ps_comment_prf#2453,ps_partkey_prf#2454,ps_supplycost_prf#2455,ps_suppkey_prf#2456] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2464, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2465]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey_and_l_suppkey~partsupp~ps_partkey_and_ps_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2466 AS l_returnflag_prf_1#2485, l_orderkey_and_l_linenumber_prf#2467 AS l_orderkey_and_l_linenumber_prf_1#2486, l_comment_prf#2468 AS l_comment_prf_1#2487, l_linestatus_prf#2469 AS l_linestatus_prf_1#2488, rid#2470 AS rid_1#2489, l_shipmode_prf#2471 AS l_shipmode_prf_1#2490, l_shipinstruct_prf#2472 AS l_shipinstruct_prf_1#2491, l_quantity_prf#2473 AS l_quantity_prf_1#2492, l_receiptdate_prf#2474 AS l_receiptdate_prf_1#2493, l_linenumber_prf#2475 AS l_linenumber_prf_1#2494, l_tax_prf#2476 AS l_tax_prf_1#2495, l_shipdate_prf#2477 AS l_shipdate_prf_1#2496, l_extendedprice_prf#2478 AS l_extendedprice_prf_1#2497, l_partkey_prf#2479 AS l_partkey_prf_1#2498, l_discount_prf#2480 AS l_discount_prf_1#2499, l_partkey_and_l_suppkey_prf#2481 AS l_partkey_and_l_suppkey_prf_1#2500, l_commitdate_prf#2482 AS l_commitdate_prf_1#2501, l_suppkey_prf#2483 AS l_suppkey_prf_1#2502, l_orderkey_prf#2484 AS l_orderkey_prf_1#2503]
            +- Relation[l_returnflag_prf#2466,l_orderkey_and_l_linenumber_prf#2467,l_comment_prf#2468,l_linestatus_prf#2469,rid#2470,l_shipmode_prf#2471,l_shipinstruct_prf#2472,l_quantity_prf#2473,l_receiptdate_prf#2474,l_linenumber_prf#2475,l_tax_prf#2476,l_shipdate_prf#2477,l_extendedprice_prf#2478,l_partkey_prf#2479,l_discount_prf#2480,l_partkey_and_l_suppkey_prf#2481,l_commitdate_prf#2482,l_suppkey_prf#2483,l_orderkey_prf#2484] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 106591ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/12 09:05:23 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:05:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2565L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 09:05:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2565L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [l_returnflag_prf#2567 AS l_returnflag_prf_0#2586, l_orderkey_and_l_linenumber_prf#2568 AS l_orderkey_and_l_linenumber_prf_0#2587, l_comment_prf#2569 AS l_comment_prf_0#2588, l_linestatus_prf#2570 AS l_linestatus_prf_0#2589, rid#2571 AS rid_0#2590, l_shipmode_prf#2572 AS l_shipmode_prf_0#2591, l_shipinstruct_prf#2573 AS l_shipinstruct_prf_0#2592, l_quantity_prf#2574 AS l_quantity_prf_0#2593, l_receiptdate_prf#2575 AS l_receiptdate_prf_0#2594, l_linenumber_prf#2576 AS l_linenumber_prf_0#2595, l_tax_prf#2577 AS l_tax_prf_0#2596, l_shipdate_prf#2578 AS l_shipdate_prf_0#2597, l_extendedprice_prf#2579 AS l_extendedprice_prf_0#2598, l_partkey_prf#2580 AS l_partkey_prf_0#2599, l_discount_prf#2581 AS l_discount_prf_0#2600, l_partkey_and_l_suppkey_prf#2582 AS l_partkey_and_l_suppkey_prf_0#2601, l_commitdate_prf#2583 AS l_commitdate_prf_0#2602, l_suppkey_prf#2584 AS l_suppkey_prf_0#2603, l_orderkey_prf#2585 AS l_orderkey_prf_0#2604]
         :  :  :  :  +- Relation[l_returnflag_prf#2567,l_orderkey_and_l_linenumber_prf#2568,l_comment_prf#2569,l_linestatus_prf#2570,rid#2571,l_shipmode_prf#2572,l_shipinstruct_prf#2573,l_quantity_prf#2574,l_receiptdate_prf#2575,l_linenumber_prf#2576,l_tax_prf#2577,l_shipdate_prf#2578,l_extendedprice_prf#2579,l_partkey_prf#2580,l_discount_prf#2581,l_partkey_and_l_suppkey_prf#2582,l_commitdate_prf#2583,l_suppkey_prf#2584,l_orderkey_prf#2585] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2605, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2606]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :  :  :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#2607 AS p_comment_prf_1#2617, p_name_prf#2608 AS p_name_prf_1#2618, rid#2609 AS rid_1#2619, p_type_prf#2610 AS p_type_prf_1#2620, p_retailprice_prf#2611 AS p_retailprice_prf_1#2621, p_mfgr_prf#2612 AS p_mfgr_prf_1#2622, p_container_prf#2613 AS p_container_prf_1#2623, p_brand_prf#2614 AS p_brand_prf_1#2624, p_size_prf#2615 AS p_size_prf_1#2625, p_partkey_prf#2616 AS p_partkey_prf_1#2626]
         :  :     +- Relation[p_comment_prf#2607,p_name_prf#2608,rid#2609,p_type_prf#2610,p_retailprice_prf#2611,p_mfgr_prf#2612,p_container_prf#2613,p_brand_prf#2614,p_size_prf#2615,p_partkey_prf#2616] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2627, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2628]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#2629 AS s_phone_prf_2#2637, rid#2630 AS rid_2#2638, s_address_prf#2631 AS s_address_prf_2#2639, s_nationkey_prf#2632 AS s_nationkey_prf_2#2640, s_suppkey_prf#2633 AS s_suppkey_prf_2#2641, s_name_prf#2634 AS s_name_prf_2#2642, s_acctbal_prf#2635 AS s_acctbal_prf_2#2643, s_comment_prf#2636 AS s_comment_prf_2#2644]
            +- Relation[s_phone_prf#2629,rid#2630,s_address_prf#2631,s_nationkey_prf#2632,s_suppkey_prf#2633,s_name_prf#2634,s_acctbal_prf#2635,s_comment_prf#2636] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 202557ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/12 09:08:46 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:08:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2706L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 09:08:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2706L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#2708 AS s_phone_prf_0#2716, rid#2709 AS rid_0#2717, s_address_prf#2710 AS s_address_prf_0#2718, s_nationkey_prf#2711 AS s_nationkey_prf_0#2719, s_suppkey_prf#2712 AS s_suppkey_prf_0#2720, s_name_prf#2713 AS s_name_prf_0#2721, s_acctbal_prf#2714 AS s_acctbal_prf_0#2722, s_comment_prf#2715 AS s_comment_prf_0#2723]
         :  :  +- Relation[s_phone_prf#2708,rid#2709,s_address_prf#2710,s_nationkey_prf#2711,s_suppkey_prf#2712,s_name_prf#2713,s_acctbal_prf#2714,s_comment_prf#2715] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2724, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2725]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [p_comment_prf#2726 AS p_comment_prf_1#2736, p_name_prf#2727 AS p_name_prf_1#2737, rid#2728 AS rid_1#2738, p_type_prf#2729 AS p_type_prf_1#2739, p_retailprice_prf#2730 AS p_retailprice_prf_1#2740, p_mfgr_prf#2731 AS p_mfgr_prf_1#2741, p_container_prf#2732 AS p_container_prf_1#2742, p_brand_prf#2733 AS p_brand_prf_1#2743, p_size_prf#2734 AS p_size_prf_1#2744, p_partkey_prf#2735 AS p_partkey_prf_1#2745]
            :  :  +- Relation[p_comment_prf#2726,p_name_prf#2727,rid#2728,p_type_prf#2729,p_retailprice_prf#2730,p_mfgr_prf#2731,p_container_prf#2732,p_brand_prf#2733,p_size_prf#2734,p_partkey_prf#2735] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2746, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2747]
            :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
            :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#2748 AS ps_partkey_and_ps_suppkey_prf_2#2755, rid#2749 AS rid_2#2756, ps_availqty_prf#2750 AS ps_availqty_prf_2#2757, ps_comment_prf#2751 AS ps_comment_prf_2#2758, ps_partkey_prf#2752 AS ps_partkey_prf_2#2759, ps_supplycost_prf#2753 AS ps_supplycost_prf_2#2760, ps_suppkey_prf#2754 AS ps_suppkey_prf_2#2761]
               +- Relation[ps_partkey_and_ps_suppkey_prf#2748,rid#2749,ps_availqty_prf#2750,ps_comment_prf#2751,ps_partkey_prf#2752,ps_supplycost_prf#2753,ps_suppkey_prf#2754] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26191ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/12 09:09:12 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:09:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2811L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 09:09:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2811L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [ps_partkey_and_ps_suppkey_prf#2813 AS ps_partkey_and_ps_suppkey_prf_0#2820, rid#2814 AS rid_0#2821, ps_availqty_prf#2815 AS ps_availqty_prf_0#2822, ps_comment_prf#2816 AS ps_comment_prf_0#2823, ps_partkey_prf#2817 AS ps_partkey_prf_0#2824, ps_supplycost_prf#2818 AS ps_supplycost_prf_0#2825, ps_suppkey_prf#2819 AS ps_suppkey_prf_0#2826]
         :  :  :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#2813,rid#2814,ps_availqty_prf#2815,ps_comment_prf#2816,ps_partkey_prf#2817,ps_supplycost_prf#2818,ps_suppkey_prf#2819] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2827, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2828]
         :  :  :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :  :  :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#2829 AS p_comment_prf_1#2839, p_name_prf#2830 AS p_name_prf_1#2840, rid#2831 AS rid_1#2841, p_type_prf#2832 AS p_type_prf_1#2842, p_retailprice_prf#2833 AS p_retailprice_prf_1#2843, p_mfgr_prf#2834 AS p_mfgr_prf_1#2844, p_container_prf#2835 AS p_container_prf_1#2845, p_brand_prf#2836 AS p_brand_prf_1#2846, p_size_prf#2837 AS p_size_prf_1#2847, p_partkey_prf#2838 AS p_partkey_prf_1#2848]
         :  :     +- Relation[p_comment_prf#2829,p_name_prf#2830,rid#2831,p_type_prf#2832,p_retailprice_prf#2833,p_mfgr_prf#2834,p_container_prf#2835,p_brand_prf#2836,p_size_prf#2837,p_partkey_prf#2838] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2849, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2850]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#2851 AS s_phone_prf_2#2859, rid#2852 AS rid_2#2860, s_address_prf#2853 AS s_address_prf_2#2861, s_nationkey_prf#2854 AS s_nationkey_prf_2#2862, s_suppkey_prf#2855 AS s_suppkey_prf_2#2863, s_name_prf#2856 AS s_name_prf_2#2864, s_acctbal_prf#2857 AS s_acctbal_prf_2#2865, s_comment_prf#2858 AS s_comment_prf_2#2866]
            +- Relation[s_phone_prf#2851,rid#2852,s_address_prf#2853,s_nationkey_prf#2854,s_suppkey_prf#2855,s_name_prf#2856,s_acctbal_prf#2857,s_comment_prf#2858] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26146ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/12 09:09:38 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:09:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2928L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 09:09:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2928L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#2930 AS l_returnflag_prf_0#2949, l_orderkey_and_l_linenumber_prf#2931 AS l_orderkey_and_l_linenumber_prf_0#2950, l_comment_prf#2932 AS l_comment_prf_0#2951, l_linestatus_prf#2933 AS l_linestatus_prf_0#2952, rid#2934 AS rid_0#2953, l_shipmode_prf#2935 AS l_shipmode_prf_0#2954, l_shipinstruct_prf#2936 AS l_shipinstruct_prf_0#2955, l_quantity_prf#2937 AS l_quantity_prf_0#2956, l_receiptdate_prf#2938 AS l_receiptdate_prf_0#2957, l_linenumber_prf#2939 AS l_linenumber_prf_0#2958, l_tax_prf#2940 AS l_tax_prf_0#2959, l_shipdate_prf#2941 AS l_shipdate_prf_0#2960, l_extendedprice_prf#2942 AS l_extendedprice_prf_0#2961, l_partkey_prf#2943 AS l_partkey_prf_0#2962, l_discount_prf#2944 AS l_discount_prf_0#2963, l_partkey_and_l_suppkey_prf#2945 AS l_partkey_and_l_suppkey_prf_0#2964, l_commitdate_prf#2946 AS l_commitdate_prf_0#2965, l_suppkey_prf#2947 AS l_suppkey_prf_0#2966, l_orderkey_prf#2948 AS l_orderkey_prf_0#2967]
         :  :  +- Relation[l_returnflag_prf#2930,l_orderkey_and_l_linenumber_prf#2931,l_comment_prf#2932,l_linestatus_prf#2933,rid#2934,l_shipmode_prf#2935,l_shipinstruct_prf#2936,l_quantity_prf#2937,l_receiptdate_prf#2938,l_linenumber_prf#2939,l_tax_prf#2940,l_shipdate_prf#2941,l_extendedprice_prf#2942,l_partkey_prf#2943,l_discount_prf#2944,l_partkey_and_l_suppkey_prf#2945,l_commitdate_prf#2946,l_suppkey_prf#2947,l_orderkey_prf#2948] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2968, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2969]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [c_acctbal_prf#2970 AS c_acctbal_prf_1#2979, rid#2971 AS rid_1#2980, c_name_prf#2972 AS c_name_prf_1#2981, c_nationkey_prf#2973 AS c_nationkey_prf_1#2982, c_custkey_prf#2974 AS c_custkey_prf_1#2983, c_comment_prf#2975 AS c_comment_prf_1#2984, c_address_prf#2976 AS c_address_prf_1#2985, c_mktsegment_prf#2977 AS c_mktsegment_prf_1#2986, c_phone_prf#2978 AS c_phone_prf_1#2987]
            :  :  +- Relation[c_acctbal_prf#2970,rid#2971,c_name_prf#2972,c_nationkey_prf#2973,c_custkey_prf#2974,c_comment_prf#2975,c_address_prf#2976,c_mktsegment_prf#2977,c_phone_prf#2978] JDBCRelation(customer_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2988, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2989]
            :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
            :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2990 AS o_shippriority_prf_2#3000, rid#2991 AS rid_2#3001, o_orderdate_prf#2992 AS o_orderdate_prf_2#3002, o_custkey_prf#2993 AS o_custkey_prf_2#3003, o_orderpriority_prf#2994 AS o_orderpriority_prf_2#3004, o_clerk_prf#2995 AS o_clerk_prf_2#3005, o_orderstatus_prf#2996 AS o_orderstatus_prf_2#3006, o_totalprice_prf#2997 AS o_totalprice_prf_2#3007, o_orderkey_prf#2998 AS o_orderkey_prf_2#3008, o_comment_prf#2999 AS o_comment_prf_2#3009]
               +- Relation[o_shippriority_prf#2990,rid#2991,o_orderdate_prf#2992,o_custkey_prf#2993,o_orderpriority_prf#2994,o_clerk_prf#2995,o_orderstatus_prf#2996,o_totalprice_prf#2997,o_orderkey_prf#2998,o_comment_prf#2999] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 181877ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/12 09:12:40 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:12:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3065L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 09:12:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3065L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [p_comment_prf#3067 AS p_comment_prf_0#3077, p_name_prf#3068 AS p_name_prf_0#3078, rid#3069 AS rid_0#3079, p_type_prf#3070 AS p_type_prf_0#3080, p_retailprice_prf#3071 AS p_retailprice_prf_0#3081, p_mfgr_prf#3072 AS p_mfgr_prf_0#3082, p_container_prf#3073 AS p_container_prf_0#3083, p_brand_prf#3074 AS p_brand_prf_0#3084, p_size_prf#3075 AS p_size_prf_0#3085, p_partkey_prf#3076 AS p_partkey_prf_0#3086]
         :  :  :  +- Relation[p_comment_prf#3067,p_name_prf#3068,rid#3069,p_type_prf#3070,p_retailprice_prf#3071,p_mfgr_prf#3072,p_container_prf#3073,p_brand_prf#3074,p_size_prf#3075,p_partkey_prf#3076] JDBCRelation(part_prf) [numPartitions=1]
         :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3087]
         :  :     +- DexRidFilter part~p_size~15
         :  :        +- Relation[label#2026,value#2027] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3088, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3089]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#3090 AS ps_partkey_and_ps_suppkey_prf_1#3097, rid#3091 AS rid_1#3098, ps_availqty_prf#3092 AS ps_availqty_prf_1#3099, ps_comment_prf#3093 AS ps_comment_prf_1#3100, ps_partkey_prf#3094 AS ps_partkey_prf_1#3101, ps_supplycost_prf#3095 AS ps_supplycost_prf_1#3102, ps_suppkey_prf#3096 AS ps_suppkey_prf_1#3103]
            +- Relation[ps_partkey_and_ps_suppkey_prf#3090,rid#3091,ps_availqty_prf#3092,ps_comment_prf#3093,ps_partkey_prf#3094,ps_supplycost_prf#3095,ps_suppkey_prf#3096] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=15628
Elapsed time: 7768ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/12 09:12:48 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:12:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3133L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 09:12:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3133L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#3135 AS p_comment_prf_0#3145, p_name_prf#3136 AS p_name_prf_0#3146, rid#3137 AS rid_0#3147, p_type_prf#3138 AS p_type_prf_0#3148, p_retailprice_prf#3139 AS p_retailprice_prf_0#3149, p_mfgr_prf#3140 AS p_mfgr_prf_0#3150, p_container_prf#3141 AS p_container_prf_0#3151, p_brand_prf#3142 AS p_brand_prf_0#3152, p_size_prf#3143 AS p_size_prf_0#3153, p_partkey_prf#3144 AS p_partkey_prf_0#3154]
         :  +- Relation[p_comment_prf#3135,p_name_prf#3136,rid#3137,p_type_prf#3138,p_retailprice_prf#3139,p_mfgr_prf#3140,p_container_prf#3141,p_brand_prf#3142,p_size_prf#3143,p_partkey_prf#3144] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3155]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#2026,value#2027] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1451
Elapsed time: 80ms

f1=
select * from region where r_name = 'EUROPE'
19/10/12 09:12:48 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:12:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3172L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/12 09:12:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3172L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#3174 AS r_regionkey_prf_0#3178, r_name_prf#3175 AS r_name_prf_0#3179, r_comment_prf#3176 AS r_comment_prf_0#3180, rid#3177 AS rid_0#3181]
         :  +- Relation[r_regionkey_prf#3174,r_name_prf#3175,r_comment_prf#3176,rid#3177] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3182]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#2026,value#2027] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1
Elapsed time: 48ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/12 09:12:48 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:12:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3209L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 09:12:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3209L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [rid#3211 AS rid_0#3216, n_regionkey_prf#3212 AS n_regionkey_prf_0#3217, n_nationkey_prf#3213 AS n_nationkey_prf_0#3218, n_name_prf#3214 AS n_name_prf_0#3219, n_comment_prf#3215 AS n_comment_prf_0#3220]
         :  :  :  :  +- Relation[rid#3211,n_regionkey_prf#3212,n_nationkey_prf#3213,n_name_prf#3214,n_comment_prf#3215] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3221, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3222]
         :  :  :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :  :  :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#3223 AS s_phone_prf_1#3231, rid#3224 AS rid_1#3232, s_address_prf#3225 AS s_address_prf_1#3233, s_nationkey_prf#3226 AS s_nationkey_prf_1#3234, s_suppkey_prf#3227 AS s_suppkey_prf_1#3235, s_name_prf#3228 AS s_name_prf_1#3236, s_acctbal_prf#3229 AS s_acctbal_prf_1#3237, s_comment_prf#3230 AS s_comment_prf_1#3238]
         :  :     +- Relation[s_phone_prf#3223,rid#3224,s_address_prf#3225,s_nationkey_prf#3226,s_suppkey_prf#3227,s_name_prf#3228,s_acctbal_prf#3229,s_comment_prf#3230] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3239, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3240]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3241 AS c_acctbal_prf_2#3250, rid#3242 AS rid_2#3251, c_name_prf#3243 AS c_name_prf_2#3252, c_nationkey_prf#3244 AS c_nationkey_prf_2#3253, c_custkey_prf#3245 AS c_custkey_prf_2#3254, c_comment_prf#3246 AS c_comment_prf_2#3255, c_address_prf#3247 AS c_address_prf_2#3256, c_mktsegment_prf#3248 AS c_mktsegment_prf_2#3257, c_phone_prf#3249 AS c_phone_prf_2#3258]
            +- Relation[c_acctbal_prf#3241,rid#3242,c_name_prf#3243,c_nationkey_prf#3244,c_custkey_prf#3245,c_comment_prf#3246,c_address_prf#3247,c_mktsegment_prf#3248,c_phone_prf#3249] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 878012ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/12 09:27:26 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:27:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3317L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 09:27:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3317L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#3319 AS c_acctbal_prf_0#3328, rid#3320 AS rid_0#3329, c_name_prf#3321 AS c_name_prf_0#3330, c_nationkey_prf#3322 AS c_nationkey_prf_0#3331, c_custkey_prf#3323 AS c_custkey_prf_0#3332, c_comment_prf#3324 AS c_comment_prf_0#3333, c_address_prf#3325 AS c_address_prf_0#3334, c_mktsegment_prf#3326 AS c_mktsegment_prf_0#3335, c_phone_prf#3327 AS c_phone_prf_0#3336]
         :  :  +- Relation[c_acctbal_prf#3319,rid#3320,c_name_prf#3321,c_nationkey_prf#3322,c_custkey_prf#3323,c_comment_prf#3324,c_address_prf#3325,c_mktsegment_prf#3326,c_phone_prf#3327] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3337, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3338]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [l_returnflag_prf#3339 AS l_returnflag_prf_1#3358, l_orderkey_and_l_linenumber_prf#3340 AS l_orderkey_and_l_linenumber_prf_1#3359, l_comment_prf#3341 AS l_comment_prf_1#3360, l_linestatus_prf#3342 AS l_linestatus_prf_1#3361, rid#3343 AS rid_1#3362, l_shipmode_prf#3344 AS l_shipmode_prf_1#3363, l_shipinstruct_prf#3345 AS l_shipinstruct_prf_1#3364, l_quantity_prf#3346 AS l_quantity_prf_1#3365, l_receiptdate_prf#3347 AS l_receiptdate_prf_1#3366, l_linenumber_prf#3348 AS l_linenumber_prf_1#3367, l_tax_prf#3349 AS l_tax_prf_1#3368, l_shipdate_prf#3350 AS l_shipdate_prf_1#3369, l_extendedprice_prf#3351 AS l_extendedprice_prf_1#3370, l_partkey_prf#3352 AS l_partkey_prf_1#3371, l_discount_prf#3353 AS l_discount_prf_1#3372, l_partkey_and_l_suppkey_prf#3354 AS l_partkey_and_l_suppkey_prf_1#3373, l_commitdate_prf#3355 AS l_commitdate_prf_1#3374, l_suppkey_prf#3356 AS l_suppkey_prf_1#3375, l_orderkey_prf#3357 AS l_orderkey_prf_1#3376]
            :  :  +- Relation[l_returnflag_prf#3339,l_orderkey_and_l_linenumber_prf#3340,l_comment_prf#3341,l_linestatus_prf#3342,rid#3343,l_shipmode_prf#3344,l_shipinstruct_prf#3345,l_quantity_prf#3346,l_receiptdate_prf#3347,l_linenumber_prf#3348,l_tax_prf#3349,l_shipdate_prf#3350,l_extendedprice_prf#3351,l_partkey_prf#3352,l_discount_prf#3353,l_partkey_and_l_suppkey_prf#3354,l_commitdate_prf#3355,l_suppkey_prf#3356,l_orderkey_prf#3357] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3377, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3378]
            :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
            :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3379 AS o_shippriority_prf_2#3389, rid#3380 AS rid_2#3390, o_orderdate_prf#3381 AS o_orderdate_prf_2#3391, o_custkey_prf#3382 AS o_custkey_prf_2#3392, o_orderpriority_prf#3383 AS o_orderpriority_prf_2#3393, o_clerk_prf#3384 AS o_clerk_prf_2#3394, o_orderstatus_prf#3385 AS o_orderstatus_prf_2#3395, o_totalprice_prf#3386 AS o_totalprice_prf_2#3396, o_orderkey_prf#3387 AS o_orderkey_prf_2#3397, o_comment_prf#3388 AS o_comment_prf_2#3398]
               +- Relation[o_shippriority_prf#3379,rid#3380,o_orderdate_prf#3381,o_custkey_prf#3382,o_orderpriority_prf#3383,o_clerk_prf#3384,o_orderstatus_prf#3385,o_totalprice_prf#3386,o_orderkey_prf#3387,o_comment_prf#3388] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 143150ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/12 09:29:49 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:29:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3461L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 09:29:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3461L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#3463 AS s_phone_prf_0#3471, rid#3464 AS rid_0#3472, s_address_prf#3465 AS s_address_prf_0#3473, s_nationkey_prf#3466 AS s_nationkey_prf_0#3474, s_suppkey_prf#3467 AS s_suppkey_prf_0#3475, s_name_prf#3468 AS s_name_prf_0#3476, s_acctbal_prf#3469 AS s_acctbal_prf_0#3477, s_comment_prf#3470 AS s_comment_prf_0#3478]
         :  :  +- Relation[s_phone_prf#3463,rid#3464,s_address_prf#3465,s_nationkey_prf#3466,s_suppkey_prf#3467,s_name_prf#3468,s_acctbal_prf#3469,s_comment_prf#3470] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3479, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3480]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [ps_partkey_and_ps_suppkey_prf#3481 AS ps_partkey_and_ps_suppkey_prf_1#3488, rid#3482 AS rid_1#3489, ps_availqty_prf#3483 AS ps_availqty_prf_1#3490, ps_comment_prf#3484 AS ps_comment_prf_1#3491, ps_partkey_prf#3485 AS ps_partkey_prf_1#3492, ps_supplycost_prf#3486 AS ps_supplycost_prf_1#3493, ps_suppkey_prf#3487 AS ps_suppkey_prf_1#3494]
            :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#3481,rid#3482,ps_availqty_prf#3483,ps_comment_prf#3484,ps_partkey_prf#3485,ps_supplycost_prf#3486,ps_suppkey_prf#3487] JDBCRelation(partsupp_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3495, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3496]
            :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
            :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [p_comment_prf#3497 AS p_comment_prf_2#3507, p_name_prf#3498 AS p_name_prf_2#3508, rid#3499 AS rid_2#3509, p_type_prf#3500 AS p_type_prf_2#3510, p_retailprice_prf#3501 AS p_retailprice_prf_2#3511, p_mfgr_prf#3502 AS p_mfgr_prf_2#3512, p_container_prf#3503 AS p_container_prf_2#3513, p_brand_prf#3504 AS p_brand_prf_2#3514, p_size_prf#3505 AS p_size_prf_2#3515, p_partkey_prf#3506 AS p_partkey_prf_2#3516]
               +- Relation[p_comment_prf#3497,p_name_prf#3498,rid#3499,p_type_prf#3500,p_retailprice_prf#3501,p_mfgr_prf#3502,p_container_prf#3503,p_brand_prf#3504,p_size_prf#3505,p_partkey_prf#3506] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26126ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/12 09:30:15 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:30:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3566L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 09:30:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3566L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [p_comment_prf#3568 AS p_comment_prf_0#3578, p_name_prf#3569 AS p_name_prf_0#3579, rid#3570 AS rid_0#3580, p_type_prf#3571 AS p_type_prf_0#3581, p_retailprice_prf#3572 AS p_retailprice_prf_0#3582, p_mfgr_prf#3573 AS p_mfgr_prf_0#3583, p_container_prf#3574 AS p_container_prf_0#3584, p_brand_prf#3575 AS p_brand_prf_0#3585, p_size_prf#3576 AS p_size_prf_0#3586, p_partkey_prf#3577 AS p_partkey_prf_0#3587]
         :  :  :  :  +- Relation[p_comment_prf#3568,p_name_prf#3569,rid#3570,p_type_prf#3571,p_retailprice_prf#3572,p_mfgr_prf#3573,p_container_prf#3574,p_brand_prf#3575,p_size_prf#3576,p_partkey_prf#3577] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3588, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3589]
         :  :  :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :  :  :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#3590 AS ps_partkey_and_ps_suppkey_prf_1#3597, rid#3591 AS rid_1#3598, ps_availqty_prf#3592 AS ps_availqty_prf_1#3599, ps_comment_prf#3593 AS ps_comment_prf_1#3600, ps_partkey_prf#3594 AS ps_partkey_prf_1#3601, ps_supplycost_prf#3595 AS ps_supplycost_prf_1#3602, ps_suppkey_prf#3596 AS ps_suppkey_prf_1#3603]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#3590,rid#3591,ps_availqty_prf#3592,ps_comment_prf#3593,ps_partkey_prf#3594,ps_supplycost_prf#3595,ps_suppkey_prf#3596] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3604, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3605]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#3606 AS s_phone_prf_2#3614, rid#3607 AS rid_2#3615, s_address_prf#3608 AS s_address_prf_2#3616, s_nationkey_prf#3609 AS s_nationkey_prf_2#3617, s_suppkey_prf#3610 AS s_suppkey_prf_2#3618, s_name_prf#3611 AS s_name_prf_2#3619, s_acctbal_prf#3612 AS s_acctbal_prf_2#3620, s_comment_prf#3613 AS s_comment_prf_2#3621]
            +- Relation[s_phone_prf#3606,rid#3607,s_address_prf#3608,s_nationkey_prf#3609,s_suppkey_prf#3610,s_name_prf#3611,s_acctbal_prf#3612,s_comment_prf#3613] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26075ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/12 09:30:41 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:30:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3664L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 09:30:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3664L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [p_comment_prf#3666 AS p_comment_prf_0#3676, p_name_prf#3667 AS p_name_prf_0#3677, rid#3668 AS rid_0#3678, p_type_prf#3669 AS p_type_prf_0#3679, p_retailprice_prf#3670 AS p_retailprice_prf_0#3680, p_mfgr_prf#3671 AS p_mfgr_prf_0#3681, p_container_prf#3672 AS p_container_prf_0#3682, p_brand_prf#3673 AS p_brand_prf_0#3683, p_size_prf#3674 AS p_size_prf_0#3684, p_partkey_prf#3675 AS p_partkey_prf_0#3685]
         :  :  +- Relation[p_comment_prf#3666,p_name_prf#3667,rid#3668,p_type_prf#3669,p_retailprice_prf#3670,p_mfgr_prf#3671,p_container_prf#3672,p_brand_prf#3673,p_size_prf#3674,p_partkey_prf#3675] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3686, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3687]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#3688 AS ps_partkey_and_ps_suppkey_prf_1#3695, rid#3689 AS rid_1#3696, ps_availqty_prf#3690 AS ps_availqty_prf_1#3697, ps_comment_prf#3691 AS ps_comment_prf_1#3698, ps_partkey_prf#3692 AS ps_partkey_prf_1#3699, ps_supplycost_prf#3693 AS ps_supplycost_prf_1#3700, ps_suppkey_prf#3694 AS ps_suppkey_prf_1#3701]
            +- Relation[ps_partkey_and_ps_suppkey_prf#3688,rid#3689,ps_availqty_prf#3690,ps_comment_prf#3691,ps_partkey_prf#3692,ps_supplycost_prf#3693,ps_suppkey_prf#3694] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 12119ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/12 09:30:53 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:30:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3754L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 09:30:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3754L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#3756 AS s_phone_prf_0#3764, rid#3757 AS rid_0#3765, s_address_prf#3758 AS s_address_prf_0#3766, s_nationkey_prf#3759 AS s_nationkey_prf_0#3767, s_suppkey_prf#3760 AS s_suppkey_prf_0#3768, s_name_prf#3761 AS s_name_prf_0#3769, s_acctbal_prf#3762 AS s_acctbal_prf_0#3770, s_comment_prf#3763 AS s_comment_prf_0#3771]
         :  :  +- Relation[s_phone_prf#3756,rid#3757,s_address_prf#3758,s_nationkey_prf#3759,s_suppkey_prf#3760,s_name_prf#3761,s_acctbal_prf#3762,s_comment_prf#3763] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3772, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3773]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [l_returnflag_prf#3774 AS l_returnflag_prf_1#3793, l_orderkey_and_l_linenumber_prf#3775 AS l_orderkey_and_l_linenumber_prf_1#3794, l_comment_prf#3776 AS l_comment_prf_1#3795, l_linestatus_prf#3777 AS l_linestatus_prf_1#3796, rid#3778 AS rid_1#3797, l_shipmode_prf#3779 AS l_shipmode_prf_1#3798, l_shipinstruct_prf#3780 AS l_shipinstruct_prf_1#3799, l_quantity_prf#3781 AS l_quantity_prf_1#3800, l_receiptdate_prf#3782 AS l_receiptdate_prf_1#3801, l_linenumber_prf#3783 AS l_linenumber_prf_1#3802, l_tax_prf#3784 AS l_tax_prf_1#3803, l_shipdate_prf#3785 AS l_shipdate_prf_1#3804, l_extendedprice_prf#3786 AS l_extendedprice_prf_1#3805, l_partkey_prf#3787 AS l_partkey_prf_1#3806, l_discount_prf#3788 AS l_discount_prf_1#3807, l_partkey_and_l_suppkey_prf#3789 AS l_partkey_and_l_suppkey_prf_1#3808, l_commitdate_prf#3790 AS l_commitdate_prf_1#3809, l_suppkey_prf#3791 AS l_suppkey_prf_1#3810, l_orderkey_prf#3792 AS l_orderkey_prf_1#3811]
            :  :  +- Relation[l_returnflag_prf#3774,l_orderkey_and_l_linenumber_prf#3775,l_comment_prf#3776,l_linestatus_prf#3777,rid#3778,l_shipmode_prf#3779,l_shipinstruct_prf#3780,l_quantity_prf#3781,l_receiptdate_prf#3782,l_linenumber_prf#3783,l_tax_prf#3784,l_shipdate_prf#3785,l_extendedprice_prf#3786,l_partkey_prf#3787,l_discount_prf#3788,l_partkey_and_l_suppkey_prf#3789,l_commitdate_prf#3790,l_suppkey_prf#3791,l_orderkey_prf#3792] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3812, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3813]
            :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
            :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [p_comment_prf#3814 AS p_comment_prf_2#3824, p_name_prf#3815 AS p_name_prf_2#3825, rid#3816 AS rid_2#3826, p_type_prf#3817 AS p_type_prf_2#3827, p_retailprice_prf#3818 AS p_retailprice_prf_2#3828, p_mfgr_prf#3819 AS p_mfgr_prf_2#3829, p_container_prf#3820 AS p_container_prf_2#3830, p_brand_prf#3821 AS p_brand_prf_2#3831, p_size_prf#3822 AS p_size_prf_2#3832, p_partkey_prf#3823 AS p_partkey_prf_2#3833]
               +- Relation[p_comment_prf#3814,p_name_prf#3815,rid#3816,p_type_prf#3817,p_retailprice_prf#3818,p_mfgr_prf#3819,p_container_prf#3820,p_brand_prf#3821,p_size_prf#3822,p_partkey_prf#3823] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 202180ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/12 09:34:15 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:34:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3907L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 09:34:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3907L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [c_acctbal_prf#3909 AS c_acctbal_prf_0#3918, rid#3910 AS rid_0#3919, c_name_prf#3911 AS c_name_prf_0#3920, c_nationkey_prf#3912 AS c_nationkey_prf_0#3921, c_custkey_prf#3913 AS c_custkey_prf_0#3922, c_comment_prf#3914 AS c_comment_prf_0#3923, c_address_prf#3915 AS c_address_prf_0#3924, c_mktsegment_prf#3916 AS c_mktsegment_prf_0#3925, c_phone_prf#3917 AS c_phone_prf_0#3926]
         :  :  :  :  +- Relation[c_acctbal_prf#3909,rid#3910,c_name_prf#3911,c_nationkey_prf#3912,c_custkey_prf#3913,c_comment_prf#3914,c_address_prf#3915,c_mktsegment_prf#3916,c_phone_prf#3917] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3927, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3928]
         :  :  :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :  :  :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#3929 AS o_shippriority_prf_1#3939, rid#3930 AS rid_1#3940, o_orderdate_prf#3931 AS o_orderdate_prf_1#3941, o_custkey_prf#3932 AS o_custkey_prf_1#3942, o_orderpriority_prf#3933 AS o_orderpriority_prf_1#3943, o_clerk_prf#3934 AS o_clerk_prf_1#3944, o_orderstatus_prf#3935 AS o_orderstatus_prf_1#3945, o_totalprice_prf#3936 AS o_totalprice_prf_1#3946, o_orderkey_prf#3937 AS o_orderkey_prf_1#3947, o_comment_prf#3938 AS o_comment_prf_1#3948]
         :  :     +- Relation[o_shippriority_prf#3929,rid#3930,o_orderdate_prf#3931,o_custkey_prf#3932,o_orderpriority_prf#3933,o_clerk_prf#3934,o_orderstatus_prf#3935,o_totalprice_prf#3936,o_orderkey_prf#3937,o_comment_prf#3938] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3949, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3950]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3951 AS l_returnflag_prf_2#3970, l_orderkey_and_l_linenumber_prf#3952 AS l_orderkey_and_l_linenumber_prf_2#3971, l_comment_prf#3953 AS l_comment_prf_2#3972, l_linestatus_prf#3954 AS l_linestatus_prf_2#3973, rid#3955 AS rid_2#3974, l_shipmode_prf#3956 AS l_shipmode_prf_2#3975, l_shipinstruct_prf#3957 AS l_shipinstruct_prf_2#3976, l_quantity_prf#3958 AS l_quantity_prf_2#3977, l_receiptdate_prf#3959 AS l_receiptdate_prf_2#3978, l_linenumber_prf#3960 AS l_linenumber_prf_2#3979, l_tax_prf#3961 AS l_tax_prf_2#3980, l_shipdate_prf#3962 AS l_shipdate_prf_2#3981, l_extendedprice_prf#3963 AS l_extendedprice_prf_2#3982, l_partkey_prf#3964 AS l_partkey_prf_2#3983, l_discount_prf#3965 AS l_discount_prf_2#3984, l_partkey_and_l_suppkey_prf#3966 AS l_partkey_and_l_suppkey_prf_2#3985, l_commitdate_prf#3967 AS l_commitdate_prf_2#3986, l_suppkey_prf#3968 AS l_suppkey_prf_2#3987, l_orderkey_prf#3969 AS l_orderkey_prf_2#3988]
            +- Relation[l_returnflag_prf#3951,l_orderkey_and_l_linenumber_prf#3952,l_comment_prf#3953,l_linestatus_prf#3954,rid#3955,l_shipmode_prf#3956,l_shipinstruct_prf#3957,l_quantity_prf#3958,l_receiptdate_prf#3959,l_linenumber_prf#3960,l_tax_prf#3961,l_shipdate_prf#3962,l_extendedprice_prf#3963,l_partkey_prf#3964,l_discount_prf#3965,l_partkey_and_l_suppkey_prf#3966,l_commitdate_prf#3967,l_suppkey_prf#3968,l_orderkey_prf#3969] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 168960ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/12 09:37:04 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:37:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4055L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 09:37:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4055L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [p_comment_prf#4057 AS p_comment_prf_0#4067, p_name_prf#4058 AS p_name_prf_0#4068, rid#4059 AS rid_0#4069, p_type_prf#4060 AS p_type_prf_0#4070, p_retailprice_prf#4061 AS p_retailprice_prf_0#4071, p_mfgr_prf#4062 AS p_mfgr_prf_0#4072, p_container_prf#4063 AS p_container_prf_0#4073, p_brand_prf#4064 AS p_brand_prf_0#4074, p_size_prf#4065 AS p_size_prf_0#4075, p_partkey_prf#4066 AS p_partkey_prf_0#4076]
         :  :  +- Relation[p_comment_prf#4057,p_name_prf#4058,rid#4059,p_type_prf#4060,p_retailprice_prf#4061,p_mfgr_prf#4062,p_container_prf#4063,p_brand_prf#4064,p_size_prf#4065,p_partkey_prf#4066] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4077, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4078]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4079 AS l_returnflag_prf_1#4098, l_orderkey_and_l_linenumber_prf#4080 AS l_orderkey_and_l_linenumber_prf_1#4099, l_comment_prf#4081 AS l_comment_prf_1#4100, l_linestatus_prf#4082 AS l_linestatus_prf_1#4101, rid#4083 AS rid_1#4102, l_shipmode_prf#4084 AS l_shipmode_prf_1#4103, l_shipinstruct_prf#4085 AS l_shipinstruct_prf_1#4104, l_quantity_prf#4086 AS l_quantity_prf_1#4105, l_receiptdate_prf#4087 AS l_receiptdate_prf_1#4106, l_linenumber_prf#4088 AS l_linenumber_prf_1#4107, l_tax_prf#4089 AS l_tax_prf_1#4108, l_shipdate_prf#4090 AS l_shipdate_prf_1#4109, l_extendedprice_prf#4091 AS l_extendedprice_prf_1#4110, l_partkey_prf#4092 AS l_partkey_prf_1#4111, l_discount_prf#4093 AS l_discount_prf_1#4112, l_partkey_and_l_suppkey_prf#4094 AS l_partkey_and_l_suppkey_prf_1#4113, l_commitdate_prf#4095 AS l_commitdate_prf_1#4114, l_suppkey_prf#4096 AS l_suppkey_prf_1#4115, l_orderkey_prf#4097 AS l_orderkey_prf_1#4116]
            +- Relation[l_returnflag_prf#4079,l_orderkey_and_l_linenumber_prf#4080,l_comment_prf#4081,l_linestatus_prf#4082,rid#4083,l_shipmode_prf#4084,l_shipinstruct_prf#4085,l_quantity_prf#4086,l_receiptdate_prf#4087,l_linenumber_prf#4088,l_tax_prf#4089,l_shipdate_prf#4090,l_extendedprice_prf#4091,l_partkey_prf#4092,l_discount_prf#4093,l_partkey_and_l_suppkey_prf#4094,l_commitdate_prf#4095,l_suppkey_prf#4096,l_orderkey_prf#4097] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 95011ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/12 09:38:39 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:38:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4165L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 09:38:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4165L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#4167 AS l_returnflag_prf_0#4186, l_orderkey_and_l_linenumber_prf#4168 AS l_orderkey_and_l_linenumber_prf_0#4187, l_comment_prf#4169 AS l_comment_prf_0#4188, l_linestatus_prf#4170 AS l_linestatus_prf_0#4189, rid#4171 AS rid_0#4190, l_shipmode_prf#4172 AS l_shipmode_prf_0#4191, l_shipinstruct_prf#4173 AS l_shipinstruct_prf_0#4192, l_quantity_prf#4174 AS l_quantity_prf_0#4193, l_receiptdate_prf#4175 AS l_receiptdate_prf_0#4194, l_linenumber_prf#4176 AS l_linenumber_prf_0#4195, l_tax_prf#4177 AS l_tax_prf_0#4196, l_shipdate_prf#4178 AS l_shipdate_prf_0#4197, l_extendedprice_prf#4179 AS l_extendedprice_prf_0#4198, l_partkey_prf#4180 AS l_partkey_prf_0#4199, l_discount_prf#4181 AS l_discount_prf_0#4200, l_partkey_and_l_suppkey_prf#4182 AS l_partkey_and_l_suppkey_prf_0#4201, l_commitdate_prf#4183 AS l_commitdate_prf_0#4202, l_suppkey_prf#4184 AS l_suppkey_prf_0#4203, l_orderkey_prf#4185 AS l_orderkey_prf_0#4204]
         :  +- Relation[l_returnflag_prf#4167,l_orderkey_and_l_linenumber_prf#4168,l_comment_prf#4169,l_linestatus_prf#4170,rid#4171,l_shipmode_prf#4172,l_shipinstruct_prf#4173,l_quantity_prf#4174,l_receiptdate_prf#4175,l_linenumber_prf#4176,l_tax_prf#4177,l_shipdate_prf#4178,l_extendedprice_prf#4179,l_partkey_prf#4180,l_discount_prf#4181,l_partkey_and_l_suppkey_prf#4182,l_commitdate_prf#4183,l_suppkey_prf#4184,l_orderkey_prf#4185] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4205]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#2026,value#2027] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=857401
Elapsed time: 13666ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/12 09:38:53 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:38:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4235L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 09:38:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4235L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [r_regionkey_prf#4237 AS r_regionkey_prf_0#4241, r_name_prf#4238 AS r_name_prf_0#4242, r_comment_prf#4239 AS r_comment_prf_0#4243, rid#4240 AS rid_0#4244]
         :  :  +- Relation[r_regionkey_prf#4237,r_name_prf#4238,r_comment_prf#4239,rid#4240] JDBCRelation(region_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4245, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4246]
         :     +- SpxRidUncorrelatedJoin nation~n_regionkey~region~r_regionkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [rid#4247 AS rid_1#4252, n_regionkey_prf#4248 AS n_regionkey_prf_1#4253, n_nationkey_prf#4249 AS n_nationkey_prf_1#4254, n_name_prf#4250 AS n_name_prf_1#4255, n_comment_prf#4251 AS n_comment_prf_1#4256]
            +- Relation[rid#4247,n_regionkey_prf#4248,n_nationkey_prf#4249,n_name_prf#4250,n_comment_prf#4251] JDBCRelation(nation_prf) [numPartitions=1]

DexSpx$ result size=25
Elapsed time: 67ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/12 09:38:53 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:38:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4273L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 09:38:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4273L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#4275 AS rid_0#4280, n_regionkey_prf#4276 AS n_regionkey_prf_0#4281, n_nationkey_prf#4277 AS n_nationkey_prf_0#4282, n_name_prf#4278 AS n_name_prf_0#4283, n_comment_prf#4279 AS n_comment_prf_0#4284]
         :  +- Relation[rid#4275,n_regionkey_prf#4276,n_nationkey_prf#4277,n_name_prf#4278,n_comment_prf#4279] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4285]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#2026,value#2027] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1
Elapsed time: 48ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/12 09:38:53 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:38:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4319L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 09:38:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4319L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#4321 AS l_returnflag_prf_0#4340, l_orderkey_and_l_linenumber_prf#4322 AS l_orderkey_and_l_linenumber_prf_0#4341, l_comment_prf#4323 AS l_comment_prf_0#4342, l_linestatus_prf#4324 AS l_linestatus_prf_0#4343, rid#4325 AS rid_0#4344, l_shipmode_prf#4326 AS l_shipmode_prf_0#4345, l_shipinstruct_prf#4327 AS l_shipinstruct_prf_0#4346, l_quantity_prf#4328 AS l_quantity_prf_0#4347, l_receiptdate_prf#4329 AS l_receiptdate_prf_0#4348, l_linenumber_prf#4330 AS l_linenumber_prf_0#4349, l_tax_prf#4331 AS l_tax_prf_0#4350, l_shipdate_prf#4332 AS l_shipdate_prf_0#4351, l_extendedprice_prf#4333 AS l_extendedprice_prf_0#4352, l_partkey_prf#4334 AS l_partkey_prf_0#4353, l_discount_prf#4335 AS l_discount_prf_0#4354, l_partkey_and_l_suppkey_prf#4336 AS l_partkey_and_l_suppkey_prf_0#4355, l_commitdate_prf#4337 AS l_commitdate_prf_0#4356, l_suppkey_prf#4338 AS l_suppkey_prf_0#4357, l_orderkey_prf#4339 AS l_orderkey_prf_0#4358]
         :  :  +- Relation[l_returnflag_prf#4321,l_orderkey_and_l_linenumber_prf#4322,l_comment_prf#4323,l_linestatus_prf#4324,rid#4325,l_shipmode_prf#4326,l_shipinstruct_prf#4327,l_quantity_prf#4328,l_receiptdate_prf#4329,l_linenumber_prf#4330,l_tax_prf#4331,l_shipdate_prf#4332,l_extendedprice_prf#4333,l_partkey_prf#4334,l_discount_prf#4335,l_partkey_and_l_suppkey_prf#4336,l_commitdate_prf#4337,l_suppkey_prf#4338,l_orderkey_prf#4339] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4359, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4360]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4361 AS o_shippriority_prf_1#4371, rid#4362 AS rid_1#4372, o_orderdate_prf#4363 AS o_orderdate_prf_1#4373, o_custkey_prf#4364 AS o_custkey_prf_1#4374, o_orderpriority_prf#4365 AS o_orderpriority_prf_1#4375, o_clerk_prf#4366 AS o_clerk_prf_1#4376, o_orderstatus_prf#4367 AS o_orderstatus_prf_1#4377, o_totalprice_prf#4368 AS o_totalprice_prf_1#4378, o_orderkey_prf#4369 AS o_orderkey_prf_1#4379, o_comment_prf#4370 AS o_comment_prf_1#4380]
            +- Relation[o_shippriority_prf#4361,rid#4362,o_orderdate_prf#4363,o_custkey_prf#4364,o_orderpriority_prf#4365,o_clerk_prf#4366,o_orderstatus_prf#4367,o_totalprice_prf#4368,o_orderkey_prf#4369,o_comment_prf#4370] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 106706ms

f2=
select * from part where p_size = 15
19/10/12 09:40:40 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:40:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4422L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 09:40:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4422L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#4424 AS p_comment_prf_0#4434, p_name_prf#4425 AS p_name_prf_0#4435, rid#4426 AS rid_0#4436, p_type_prf#4427 AS p_type_prf_0#4437, p_retailprice_prf#4428 AS p_retailprice_prf_0#4438, p_mfgr_prf#4429 AS p_mfgr_prf_0#4439, p_container_prf#4430 AS p_container_prf_0#4440, p_brand_prf#4431 AS p_brand_prf_0#4441, p_size_prf#4432 AS p_size_prf_0#4442, p_partkey_prf#4433 AS p_partkey_prf_0#4443]
         :  +- Relation[p_comment_prf#4424,p_name_prf#4425,rid#4426,p_type_prf#4427,p_retailprice_prf#4428,p_mfgr_prf#4429,p_container_prf#4430,p_brand_prf#4431,p_size_prf#4432,p_partkey_prf#4433] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4444]
            +- DexRidFilter part~p_size~15
               +- Relation[label#2026,value#2027] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=3907
Elapsed time: 122ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/12 09:40:40 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:40:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4470L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 09:40:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4470L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4472 AS s_phone_prf_0#4480, rid#4473 AS rid_0#4481, s_address_prf#4474 AS s_address_prf_0#4482, s_nationkey_prf#4475 AS s_nationkey_prf_0#4483, s_suppkey_prf#4476 AS s_suppkey_prf_0#4484, s_name_prf#4477 AS s_name_prf_0#4485, s_acctbal_prf#4478 AS s_acctbal_prf_0#4486, s_comment_prf#4479 AS s_comment_prf_0#4487]
         :  :  +- Relation[s_phone_prf#4472,rid#4473,s_address_prf#4474,s_nationkey_prf#4475,s_suppkey_prf#4476,s_name_prf#4477,s_acctbal_prf#4478,s_comment_prf#4479] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4488, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4489]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4490 AS ps_partkey_and_ps_suppkey_prf_1#4497, rid#4491 AS rid_1#4498, ps_availqty_prf#4492 AS ps_availqty_prf_1#4499, ps_comment_prf#4493 AS ps_comment_prf_1#4500, ps_partkey_prf#4494 AS ps_partkey_prf_1#4501, ps_supplycost_prf#4495 AS ps_supplycost_prf_1#4502, ps_suppkey_prf#4496 AS ps_suppkey_prf_1#4503]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4490,rid#4491,ps_availqty_prf#4492,ps_comment_prf#4493,ps_partkey_prf#4494,ps_supplycost_prf#4495,ps_suppkey_prf#4496] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 11666ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/12 09:40:52 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:40:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4555L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 09:40:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4555L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [l_returnflag_prf#4557 AS l_returnflag_prf_0#4576, l_orderkey_and_l_linenumber_prf#4558 AS l_orderkey_and_l_linenumber_prf_0#4577, l_comment_prf#4559 AS l_comment_prf_0#4578, l_linestatus_prf#4560 AS l_linestatus_prf_0#4579, rid#4561 AS rid_0#4580, l_shipmode_prf#4562 AS l_shipmode_prf_0#4581, l_shipinstruct_prf#4563 AS l_shipinstruct_prf_0#4582, l_quantity_prf#4564 AS l_quantity_prf_0#4583, l_receiptdate_prf#4565 AS l_receiptdate_prf_0#4584, l_linenumber_prf#4566 AS l_linenumber_prf_0#4585, l_tax_prf#4567 AS l_tax_prf_0#4586, l_shipdate_prf#4568 AS l_shipdate_prf_0#4587, l_extendedprice_prf#4569 AS l_extendedprice_prf_0#4588, l_partkey_prf#4570 AS l_partkey_prf_0#4589, l_discount_prf#4571 AS l_discount_prf_0#4590, l_partkey_and_l_suppkey_prf#4572 AS l_partkey_and_l_suppkey_prf_0#4591, l_commitdate_prf#4573 AS l_commitdate_prf_0#4592, l_suppkey_prf#4574 AS l_suppkey_prf_0#4593, l_orderkey_prf#4575 AS l_orderkey_prf_0#4594]
         :  :  :  :  +- Relation[l_returnflag_prf#4557,l_orderkey_and_l_linenumber_prf#4558,l_comment_prf#4559,l_linestatus_prf#4560,rid#4561,l_shipmode_prf#4562,l_shipinstruct_prf#4563,l_quantity_prf#4564,l_receiptdate_prf#4565,l_linenumber_prf#4566,l_tax_prf#4567,l_shipdate_prf#4568,l_extendedprice_prf#4569,l_partkey_prf#4570,l_discount_prf#4571,l_partkey_and_l_suppkey_prf#4572,l_commitdate_prf#4573,l_suppkey_prf#4574,l_orderkey_prf#4575] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4595, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4596]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :  :  :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#4597 AS o_shippriority_prf_1#4607, rid#4598 AS rid_1#4608, o_orderdate_prf#4599 AS o_orderdate_prf_1#4609, o_custkey_prf#4600 AS o_custkey_prf_1#4610, o_orderpriority_prf#4601 AS o_orderpriority_prf_1#4611, o_clerk_prf#4602 AS o_clerk_prf_1#4612, o_orderstatus_prf#4603 AS o_orderstatus_prf_1#4613, o_totalprice_prf#4604 AS o_totalprice_prf_1#4614, o_orderkey_prf#4605 AS o_orderkey_prf_1#4615, o_comment_prf#4606 AS o_comment_prf_1#4616]
         :  :     +- Relation[o_shippriority_prf#4597,rid#4598,o_orderdate_prf#4599,o_custkey_prf#4600,o_orderpriority_prf#4601,o_clerk_prf#4602,o_orderstatus_prf#4603,o_totalprice_prf#4604,o_orderkey_prf#4605,o_comment_prf#4606] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4617, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4618]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4619 AS c_acctbal_prf_2#4628, rid#4620 AS rid_2#4629, c_name_prf#4621 AS c_name_prf_2#4630, c_nationkey_prf#4622 AS c_nationkey_prf_2#4631, c_custkey_prf#4623 AS c_custkey_prf_2#4632, c_comment_prf#4624 AS c_comment_prf_2#4633, c_address_prf#4625 AS c_address_prf_2#4634, c_mktsegment_prf#4626 AS c_mktsegment_prf_2#4635, c_phone_prf#4627 AS c_phone_prf_2#4636]
            +- Relation[c_acctbal_prf#4619,rid#4620,c_name_prf#4621,c_nationkey_prf#4622,c_custkey_prf#4623,c_comment_prf#4624,c_address_prf#4625,c_mktsegment_prf#4626,c_phone_prf#4627] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 183559ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/12 09:43:55 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:43:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4694L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 09:43:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4694L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#4696 AS l_returnflag_prf_0#4715, l_orderkey_and_l_linenumber_prf#4697 AS l_orderkey_and_l_linenumber_prf_0#4716, l_comment_prf#4698 AS l_comment_prf_0#4717, l_linestatus_prf#4699 AS l_linestatus_prf_0#4718, rid#4700 AS rid_0#4719, l_shipmode_prf#4701 AS l_shipmode_prf_0#4720, l_shipinstruct_prf#4702 AS l_shipinstruct_prf_0#4721, l_quantity_prf#4703 AS l_quantity_prf_0#4722, l_receiptdate_prf#4704 AS l_receiptdate_prf_0#4723, l_linenumber_prf#4705 AS l_linenumber_prf_0#4724, l_tax_prf#4706 AS l_tax_prf_0#4725, l_shipdate_prf#4707 AS l_shipdate_prf_0#4726, l_extendedprice_prf#4708 AS l_extendedprice_prf_0#4727, l_partkey_prf#4709 AS l_partkey_prf_0#4728, l_discount_prf#4710 AS l_discount_prf_0#4729, l_partkey_and_l_suppkey_prf#4711 AS l_partkey_and_l_suppkey_prf_0#4730, l_commitdate_prf#4712 AS l_commitdate_prf_0#4731, l_suppkey_prf#4713 AS l_suppkey_prf_0#4732, l_orderkey_prf#4714 AS l_orderkey_prf_0#4733]
         :  +- Relation[l_returnflag_prf#4696,l_orderkey_and_l_linenumber_prf#4697,l_comment_prf#4698,l_linestatus_prf#4699,rid#4700,l_shipmode_prf#4701,l_shipinstruct_prf#4702,l_quantity_prf#4703,l_receiptdate_prf#4704,l_linenumber_prf#4705,l_tax_prf#4706,l_shipdate_prf#4707,l_extendedprice_prf#4708,l_partkey_prf#4709,l_discount_prf#4710,l_partkey_and_l_suppkey_prf#4711,l_commitdate_prf#4712,l_suppkey_prf#4713,l_orderkey_prf#4714] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4734]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#2026,value#2027] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 23249ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/12 09:44:18 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:44:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4771L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 09:44:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4771L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [ps_partkey_and_ps_suppkey_prf#4773 AS ps_partkey_and_ps_suppkey_prf_0#4780, rid#4774 AS rid_0#4781, ps_availqty_prf#4775 AS ps_availqty_prf_0#4782, ps_comment_prf#4776 AS ps_comment_prf_0#4783, ps_partkey_prf#4777 AS ps_partkey_prf_0#4784, ps_supplycost_prf#4778 AS ps_supplycost_prf_0#4785, ps_suppkey_prf#4779 AS ps_suppkey_prf_0#4786]
         :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#4773,rid#4774,ps_availqty_prf#4775,ps_comment_prf#4776,ps_partkey_prf#4777,ps_supplycost_prf#4778,ps_suppkey_prf#4779] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4787, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4788]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#4789 AS p_comment_prf_1#4799, p_name_prf#4790 AS p_name_prf_1#4800, rid#4791 AS rid_1#4801, p_type_prf#4792 AS p_type_prf_1#4802, p_retailprice_prf#4793 AS p_retailprice_prf_1#4803, p_mfgr_prf#4794 AS p_mfgr_prf_1#4804, p_container_prf#4795 AS p_container_prf_1#4805, p_brand_prf#4796 AS p_brand_prf_1#4806, p_size_prf#4797 AS p_size_prf_1#4807, p_partkey_prf#4798 AS p_partkey_prf_1#4808]
            :  +- Relation[p_comment_prf#4789,p_name_prf#4790,rid#4791,p_type_prf#4792,p_retailprice_prf#4793,p_mfgr_prf#4794,p_container_prf#4795,p_brand_prf#4796,p_size_prf#4797,p_partkey_prf#4798] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4809]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#2026,value#2027] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=15628
Elapsed time: 7731ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/12 09:44:26 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:44:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4863L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 09:44:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4863L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#4865 AS l_returnflag_prf_0#4884, l_orderkey_and_l_linenumber_prf#4866 AS l_orderkey_and_l_linenumber_prf_0#4885, l_comment_prf#4867 AS l_comment_prf_0#4886, l_linestatus_prf#4868 AS l_linestatus_prf_0#4887, rid#4869 AS rid_0#4888, l_shipmode_prf#4870 AS l_shipmode_prf_0#4889, l_shipinstruct_prf#4871 AS l_shipinstruct_prf_0#4890, l_quantity_prf#4872 AS l_quantity_prf_0#4891, l_receiptdate_prf#4873 AS l_receiptdate_prf_0#4892, l_linenumber_prf#4874 AS l_linenumber_prf_0#4893, l_tax_prf#4875 AS l_tax_prf_0#4894, l_shipdate_prf#4876 AS l_shipdate_prf_0#4895, l_extendedprice_prf#4877 AS l_extendedprice_prf_0#4896, l_partkey_prf#4878 AS l_partkey_prf_0#4897, l_discount_prf#4879 AS l_discount_prf_0#4898, l_partkey_and_l_suppkey_prf#4880 AS l_partkey_and_l_suppkey_prf_0#4899, l_commitdate_prf#4881 AS l_commitdate_prf_0#4900, l_suppkey_prf#4882 AS l_suppkey_prf_0#4901, l_orderkey_prf#4883 AS l_orderkey_prf_0#4902]
         :  :  +- Relation[l_returnflag_prf#4865,l_orderkey_and_l_linenumber_prf#4866,l_comment_prf#4867,l_linestatus_prf#4868,rid#4869,l_shipmode_prf#4870,l_shipinstruct_prf#4871,l_quantity_prf#4872,l_receiptdate_prf#4873,l_linenumber_prf#4874,l_tax_prf#4875,l_shipdate_prf#4876,l_extendedprice_prf#4877,l_partkey_prf#4878,l_discount_prf#4879,l_partkey_and_l_suppkey_prf#4880,l_commitdate_prf#4881,l_suppkey_prf#4882,l_orderkey_prf#4883] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4903, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4904]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [o_shippriority_prf#4905 AS o_shippriority_prf_1#4915, rid#4906 AS rid_1#4916, o_orderdate_prf#4907 AS o_orderdate_prf_1#4917, o_custkey_prf#4908 AS o_custkey_prf_1#4918, o_orderpriority_prf#4909 AS o_orderpriority_prf_1#4919, o_clerk_prf#4910 AS o_clerk_prf_1#4920, o_orderstatus_prf#4911 AS o_orderstatus_prf_1#4921, o_totalprice_prf#4912 AS o_totalprice_prf_1#4922, o_orderkey_prf#4913 AS o_orderkey_prf_1#4923, o_comment_prf#4914 AS o_comment_prf_1#4924]
            :  :  +- Relation[o_shippriority_prf#4905,rid#4906,o_orderdate_prf#4907,o_custkey_prf#4908,o_orderpriority_prf#4909,o_clerk_prf#4910,o_orderstatus_prf#4911,o_totalprice_prf#4912,o_orderkey_prf#4913,o_comment_prf#4914] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4925, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4926]
            :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
            :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4927 AS c_acctbal_prf_2#4936, rid#4928 AS rid_2#4937, c_name_prf#4929 AS c_name_prf_2#4938, c_nationkey_prf#4930 AS c_nationkey_prf_2#4939, c_custkey_prf#4931 AS c_custkey_prf_2#4940, c_comment_prf#4932 AS c_comment_prf_2#4941, c_address_prf#4933 AS c_address_prf_2#4942, c_mktsegment_prf#4934 AS c_mktsegment_prf_2#4943, c_phone_prf#4935 AS c_phone_prf_2#4944]
               +- Relation[c_acctbal_prf#4927,rid#4928,c_name_prf#4929,c_nationkey_prf#4930,c_custkey_prf#4931,c_comment_prf#4932,c_address_prf#4933,c_mktsegment_prf#4934,c_phone_prf#4935] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 184256ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/12 09:47:30 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 09:47:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5005L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 09:47:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5005L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#5007 AS c_acctbal_prf_0#5016, rid#5008 AS rid_0#5017, c_name_prf#5009 AS c_name_prf_0#5018, c_nationkey_prf#5010 AS c_nationkey_prf_0#5019, c_custkey_prf#5011 AS c_custkey_prf_0#5020, c_comment_prf#5012 AS c_comment_prf_0#5021, c_address_prf#5013 AS c_address_prf_0#5022, c_mktsegment_prf#5014 AS c_mktsegment_prf_0#5023, c_phone_prf#5015 AS c_phone_prf_0#5024]
         :  :  +- Relation[c_acctbal_prf#5007,rid#5008,c_name_prf#5009,c_nationkey_prf#5010,c_custkey_prf#5011,c_comment_prf#5012,c_address_prf#5013,c_mktsegment_prf#5014,c_phone_prf#5015] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5025, dexdecrypt('value_dec_key, 'value_right) AS rid_2#5026]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [s_phone_prf#5027 AS s_phone_prf_1#5035, rid#5028 AS rid_1#5036, s_address_prf#5029 AS s_address_prf_1#5037, s_nationkey_prf#5030 AS s_nationkey_prf_1#5038, s_suppkey_prf#5031 AS s_suppkey_prf_1#5039, s_name_prf#5032 AS s_name_prf_1#5040, s_acctbal_prf#5033 AS s_acctbal_prf_1#5041, s_comment_prf#5034 AS s_comment_prf_1#5042]
            :  :  +- Relation[s_phone_prf#5027,rid#5028,s_address_prf#5029,s_nationkey_prf#5030,s_suppkey_prf#5031,s_name_prf#5032,s_acctbal_prf#5033,s_comment_prf#5034] JDBCRelation(supplier_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#5043, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5044]
            :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
            :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [rid#5045 AS rid_2#5050, n_regionkey_prf#5046 AS n_regionkey_prf_2#5051, n_nationkey_prf#5047 AS n_nationkey_prf_2#5052, n_name_prf#5048 AS n_name_prf_2#5053, n_comment_prf#5049 AS n_comment_prf_2#5054]
               +- Relation[rid#5045,n_regionkey_prf#5046,n_nationkey_prf#5047,n_name_prf#5048,n_comment_prf#5049] JDBCRelation(nation_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 924122ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/12 10:02:55 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:02:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5105L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 10:02:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5105L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [o_shippriority_prf#5107 AS o_shippriority_prf_0#5117, rid#5108 AS rid_0#5118, o_orderdate_prf#5109 AS o_orderdate_prf_0#5119, o_custkey_prf#5110 AS o_custkey_prf_0#5120, o_orderpriority_prf#5111 AS o_orderpriority_prf_0#5121, o_clerk_prf#5112 AS o_clerk_prf_0#5122, o_orderstatus_prf#5113 AS o_orderstatus_prf_0#5123, o_totalprice_prf#5114 AS o_totalprice_prf_0#5124, o_orderkey_prf#5115 AS o_orderkey_prf_0#5125, o_comment_prf#5116 AS o_comment_prf_0#5126]
         :  :  +- Relation[o_shippriority_prf#5107,rid#5108,o_orderdate_prf#5109,o_custkey_prf#5110,o_orderpriority_prf#5111,o_clerk_prf#5112,o_orderstatus_prf#5113,o_totalprice_prf#5114,o_orderkey_prf#5115,o_comment_prf#5116] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#5127, dexdecrypt('value_dec_key, 'value_right) AS rid_0#5128]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#5129 AS l_returnflag_prf_1#5148, l_orderkey_and_l_linenumber_prf#5130 AS l_orderkey_and_l_linenumber_prf_1#5149, l_comment_prf#5131 AS l_comment_prf_1#5150, l_linestatus_prf#5132 AS l_linestatus_prf_1#5151, rid#5133 AS rid_1#5152, l_shipmode_prf#5134 AS l_shipmode_prf_1#5153, l_shipinstruct_prf#5135 AS l_shipinstruct_prf_1#5154, l_quantity_prf#5136 AS l_quantity_prf_1#5155, l_receiptdate_prf#5137 AS l_receiptdate_prf_1#5156, l_linenumber_prf#5138 AS l_linenumber_prf_1#5157, l_tax_prf#5139 AS l_tax_prf_1#5158, l_shipdate_prf#5140 AS l_shipdate_prf_1#5159, l_extendedprice_prf#5141 AS l_extendedprice_prf_1#5160, l_partkey_prf#5142 AS l_partkey_prf_1#5161, l_discount_prf#5143 AS l_discount_prf_1#5162, l_partkey_and_l_suppkey_prf#5144 AS l_partkey_and_l_suppkey_prf_1#5163, l_commitdate_prf#5145 AS l_commitdate_prf_1#5164, l_suppkey_prf#5146 AS l_suppkey_prf_1#5165, l_orderkey_prf#5147 AS l_orderkey_prf_1#5166]
            :  +- Relation[l_returnflag_prf#5129,l_orderkey_and_l_linenumber_prf#5130,l_comment_prf#5131,l_linestatus_prf#5132,rid#5133,l_shipmode_prf#5134,l_shipinstruct_prf#5135,l_quantity_prf#5136,l_receiptdate_prf#5137,l_linenumber_prf#5138,l_tax_prf#5139,l_shipdate_prf#5140,l_extendedprice_prf#5141,l_partkey_prf#5142,l_discount_prf#5143,l_partkey_and_l_suppkey_prf#5144,l_commitdate_prf#5145,l_suppkey_prf#5146,l_orderkey_prf#5147] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5167]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#2026,value#2027] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 98765ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/12 10:04:33 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:04:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5232L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 10:04:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5232L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [p_comment_prf#5234 AS p_comment_prf_0#5244, p_name_prf#5235 AS p_name_prf_0#5245, rid#5236 AS rid_0#5246, p_type_prf#5237 AS p_type_prf_0#5247, p_retailprice_prf#5238 AS p_retailprice_prf_0#5248, p_mfgr_prf#5239 AS p_mfgr_prf_0#5249, p_container_prf#5240 AS p_container_prf_0#5250, p_brand_prf#5241 AS p_brand_prf_0#5251, p_size_prf#5242 AS p_size_prf_0#5252, p_partkey_prf#5243 AS p_partkey_prf_0#5253]
         :  :  :  :  +- Relation[p_comment_prf#5234,p_name_prf#5235,rid#5236,p_type_prf#5237,p_retailprice_prf#5238,p_mfgr_prf#5239,p_container_prf#5240,p_brand_prf#5241,p_size_prf#5242,p_partkey_prf#5243] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#5254, dexdecrypt('value_dec_key, 'value_right) AS rid_0#5255]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :  :  :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#5256 AS l_returnflag_prf_1#5275, l_orderkey_and_l_linenumber_prf#5257 AS l_orderkey_and_l_linenumber_prf_1#5276, l_comment_prf#5258 AS l_comment_prf_1#5277, l_linestatus_prf#5259 AS l_linestatus_prf_1#5278, rid#5260 AS rid_1#5279, l_shipmode_prf#5261 AS l_shipmode_prf_1#5280, l_shipinstruct_prf#5262 AS l_shipinstruct_prf_1#5281, l_quantity_prf#5263 AS l_quantity_prf_1#5282, l_receiptdate_prf#5264 AS l_receiptdate_prf_1#5283, l_linenumber_prf#5265 AS l_linenumber_prf_1#5284, l_tax_prf#5266 AS l_tax_prf_1#5285, l_shipdate_prf#5267 AS l_shipdate_prf_1#5286, l_extendedprice_prf#5268 AS l_extendedprice_prf_1#5287, l_partkey_prf#5269 AS l_partkey_prf_1#5288, l_discount_prf#5270 AS l_discount_prf_1#5289, l_partkey_and_l_suppkey_prf#5271 AS l_partkey_and_l_suppkey_prf_1#5290, l_commitdate_prf#5272 AS l_commitdate_prf_1#5291, l_suppkey_prf#5273 AS l_suppkey_prf_1#5292, l_orderkey_prf#5274 AS l_orderkey_prf_1#5293]
         :  :     +- Relation[l_returnflag_prf#5256,l_orderkey_and_l_linenumber_prf#5257,l_comment_prf#5258,l_linestatus_prf#5259,rid#5260,l_shipmode_prf#5261,l_shipinstruct_prf#5262,l_quantity_prf#5263,l_receiptdate_prf#5264,l_linenumber_prf#5265,l_tax_prf#5266,l_shipdate_prf#5267,l_extendedprice_prf#5268,l_partkey_prf#5269,l_discount_prf#5270,l_partkey_and_l_suppkey_prf#5271,l_commitdate_prf#5272,l_suppkey_prf#5273,l_orderkey_prf#5274] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#5294, dexdecrypt('value_dec_key, 'value_right) AS rid_2#5295]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#5296 AS s_phone_prf_2#5304, rid#5297 AS rid_2#5305, s_address_prf#5298 AS s_address_prf_2#5306, s_nationkey_prf#5299 AS s_nationkey_prf_2#5307, s_suppkey_prf#5300 AS s_suppkey_prf_2#5308, s_name_prf#5301 AS s_name_prf_2#5309, s_acctbal_prf#5302 AS s_acctbal_prf_2#5310, s_comment_prf#5303 AS s_comment_prf_2#5311]
            +- Relation[s_phone_prf#5296,rid#5297,s_address_prf#5298,s_nationkey_prf#5299,s_suppkey_prf#5300,s_name_prf#5301,s_acctbal_prf#5302,s_comment_prf#5303] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 203277ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/12 10:07:57 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:07:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5377L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 10:07:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5377L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [o_shippriority_prf#5379 AS o_shippriority_prf_0#5389, rid#5380 AS rid_0#5390, o_orderdate_prf#5381 AS o_orderdate_prf_0#5391, o_custkey_prf#5382 AS o_custkey_prf_0#5392, o_orderpriority_prf#5383 AS o_orderpriority_prf_0#5393, o_clerk_prf#5384 AS o_clerk_prf_0#5394, o_orderstatus_prf#5385 AS o_orderstatus_prf_0#5395, o_totalprice_prf#5386 AS o_totalprice_prf_0#5396, o_orderkey_prf#5387 AS o_orderkey_prf_0#5397, o_comment_prf#5388 AS o_comment_prf_0#5398]
         :  :  +- Relation[o_shippriority_prf#5379,rid#5380,o_orderdate_prf#5381,o_custkey_prf#5382,o_orderpriority_prf#5383,o_clerk_prf#5384,o_orderstatus_prf#5385,o_totalprice_prf#5386,o_orderkey_prf#5387,o_comment_prf#5388] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#5399, dexdecrypt('value_dec_key, 'value_right) AS rid_0#5400]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5401 AS l_returnflag_prf_1#5420, l_orderkey_and_l_linenumber_prf#5402 AS l_orderkey_and_l_linenumber_prf_1#5421, l_comment_prf#5403 AS l_comment_prf_1#5422, l_linestatus_prf#5404 AS l_linestatus_prf_1#5423, rid#5405 AS rid_1#5424, l_shipmode_prf#5406 AS l_shipmode_prf_1#5425, l_shipinstruct_prf#5407 AS l_shipinstruct_prf_1#5426, l_quantity_prf#5408 AS l_quantity_prf_1#5427, l_receiptdate_prf#5409 AS l_receiptdate_prf_1#5428, l_linenumber_prf#5410 AS l_linenumber_prf_1#5429, l_tax_prf#5411 AS l_tax_prf_1#5430, l_shipdate_prf#5412 AS l_shipdate_prf_1#5431, l_extendedprice_prf#5413 AS l_extendedprice_prf_1#5432, l_partkey_prf#5414 AS l_partkey_prf_1#5433, l_discount_prf#5415 AS l_discount_prf_1#5434, l_partkey_and_l_suppkey_prf#5416 AS l_partkey_and_l_suppkey_prf_1#5435, l_commitdate_prf#5417 AS l_commitdate_prf_1#5436, l_suppkey_prf#5418 AS l_suppkey_prf_1#5437, l_orderkey_prf#5419 AS l_orderkey_prf_1#5438]
            +- Relation[l_returnflag_prf#5401,l_orderkey_and_l_linenumber_prf#5402,l_comment_prf#5403,l_linestatus_prf#5404,rid#5405,l_shipmode_prf#5406,l_shipinstruct_prf#5407,l_quantity_prf#5408,l_receiptdate_prf#5409,l_linenumber_prf#5410,l_tax_prf#5411,l_shipdate_prf#5412,l_extendedprice_prf#5413,l_partkey_prf#5414,l_discount_prf#5415,l_partkey_and_l_suppkey_prf#5416,l_commitdate_prf#5417,l_suppkey_prf#5418,l_orderkey_prf#5419] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 107001ms
query=b1a, count=15628, duration=7768
query=b1b, count=15628, duration=7731
query=b2a, count=1478870, duration=98765
query=b2b, count=1478870, duration=97475
query=f1, count=1, duration=48
query=f2, count=3907, duration=122
query=f3, count=1451, duration=80
query=f4, count=1, duration=48
query=f5, count=1478870, duration=23249
query=f6, count=857401, duration=13666
query=j1, count=800000, duration=12119
query=j10, count=6001215, duration=89297
query=j2, count=800000, duration=11666
query=j3, count=25, duration=67
query=j4, count=150000, duration=2533
query=j5, count=10000, duration=241
query=j6, count=6001215, duration=106591
query=j7, count=1500000, duration=23513
query=j8, count=6001215, duration=107001
query=j8b, count=6001215, duration=106706
query=j9, count=6001215, duration=95011
query=j9b, count=6001215, duration=95148
query=r1a, count=6001215, duration=183559
query=r1b, count=6001215, duration=184256
query=r1c, count=6001215, duration=181877
query=r1d, count=6001215, duration=168960
query=r1e, count=6001215, duration=168514
query=r1f, count=6001215, duration=143150
query=t1a, count=60000414, duration=887500
query=t1b, count=60000414, duration=878012
query=t1c, count=60000414, duration=924122
query=t2a, count=800000, duration=26146
query=t2b, count=800000, duration=26075
query=t2c, count=800000, duration=26191
query=t2d, count=800000, duration=26126
query=t3a, count=6001215, duration=202557
query=t3b, count=6001215, duration=203277
query=t3c, count=6001215, duration=201634
query=t3d, count=6001215, duration=202180
