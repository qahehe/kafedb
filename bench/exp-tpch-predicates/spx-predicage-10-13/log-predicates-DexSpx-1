19/10/12 03:55:43 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7448ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Oct 12 03:55:45 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Oct 12 03:55:46 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Oct 12 03:55:46 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Oct 12 03:55:46 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Oct 12 03:55:46 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Oct 12 03:55:49 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Oct 12 03:55:51 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Oct 12 03:55:51 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/12 03:55:53 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 03:55:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1496L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 03:55:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1496L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#1498 AS l_returnflag_prf_0#1517, l_orderkey_and_l_linenumber_prf#1499 AS l_orderkey_and_l_linenumber_prf_0#1518, l_comment_prf#1500 AS l_comment_prf_0#1519, l_linestatus_prf#1501 AS l_linestatus_prf_0#1520, rid#1502 AS rid_0#1521, l_shipmode_prf#1503 AS l_shipmode_prf_0#1522, l_shipinstruct_prf#1504 AS l_shipinstruct_prf_0#1523, l_quantity_prf#1505 AS l_quantity_prf_0#1524, l_receiptdate_prf#1506 AS l_receiptdate_prf_0#1525, l_linenumber_prf#1507 AS l_linenumber_prf_0#1526, l_tax_prf#1508 AS l_tax_prf_0#1527, l_shipdate_prf#1509 AS l_shipdate_prf_0#1528, l_extendedprice_prf#1510 AS l_extendedprice_prf_0#1529, l_partkey_prf#1511 AS l_partkey_prf_0#1530, l_discount_prf#1512 AS l_discount_prf_0#1531, l_partkey_and_l_suppkey_prf#1513 AS l_partkey_and_l_suppkey_prf_0#1532, l_commitdate_prf#1514 AS l_commitdate_prf_0#1533, l_suppkey_prf#1515 AS l_suppkey_prf_0#1534, l_orderkey_prf#1516 AS l_orderkey_prf_0#1535]
         :  :  +- Relation[l_returnflag_prf#1498,l_orderkey_and_l_linenumber_prf#1499,l_comment_prf#1500,l_linestatus_prf#1501,rid#1502,l_shipmode_prf#1503,l_shipinstruct_prf#1504,l_quantity_prf#1505,l_receiptdate_prf#1506,l_linenumber_prf#1507,l_tax_prf#1508,l_shipdate_prf#1509,l_extendedprice_prf#1510,l_partkey_prf#1511,l_discount_prf#1512,l_partkey_and_l_suppkey_prf#1513,l_commitdate_prf#1514,l_suppkey_prf#1515,l_orderkey_prf#1516] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1539, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1540]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [p_comment_prf#1541 AS p_comment_prf_1#1551, p_name_prf#1542 AS p_name_prf_1#1552, rid#1543 AS rid_1#1553, p_type_prf#1544 AS p_type_prf_1#1554, p_retailprice_prf#1545 AS p_retailprice_prf_1#1555, p_mfgr_prf#1546 AS p_mfgr_prf_1#1556, p_container_prf#1547 AS p_container_prf_1#1557, p_brand_prf#1548 AS p_brand_prf_1#1558, p_size_prf#1549 AS p_size_prf_1#1559, p_partkey_prf#1550 AS p_partkey_prf_1#1560]
            +- Relation[p_comment_prf#1541,p_name_prf#1542,rid#1543,p_type_prf#1544,p_retailprice_prf#1545,p_mfgr_prf#1546,p_container_prf#1547,p_brand_prf#1548,p_size_prf#1549,p_partkey_prf#1550] JDBCRelation(part_prf) [numPartitions=1]

19/10/12 03:55:53 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexSpx$ result size=6001215
Elapsed time: 186920ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/12 03:59:00 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 03:59:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1612L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 03:59:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1612L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [rid#1614 AS rid_0#1619, n_regionkey_prf#1615 AS n_regionkey_prf_0#1620, n_nationkey_prf#1616 AS n_nationkey_prf_0#1621, n_name_prf#1617 AS n_name_prf_0#1622, n_comment_prf#1618 AS n_comment_prf_0#1623]
         :  :  :  :  +- Relation[rid#1614,n_regionkey_prf#1615,n_nationkey_prf#1616,n_name_prf#1617,n_comment_prf#1618] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1624, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1625]
         :  :  :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :  :  :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#1626 AS s_phone_prf_1#1634, rid#1627 AS rid_1#1635, s_address_prf#1628 AS s_address_prf_1#1636, s_nationkey_prf#1629 AS s_nationkey_prf_1#1637, s_suppkey_prf#1630 AS s_suppkey_prf_1#1638, s_name_prf#1631 AS s_name_prf_1#1639, s_acctbal_prf#1632 AS s_acctbal_prf_1#1640, s_comment_prf#1633 AS s_comment_prf_1#1641]
         :  :     +- Relation[s_phone_prf#1626,rid#1627,s_address_prf#1628,s_nationkey_prf#1629,s_suppkey_prf#1630,s_name_prf#1631,s_acctbal_prf#1632,s_comment_prf#1633] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#1642, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1643]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#1644 AS c_acctbal_prf_2#1653, rid#1645 AS rid_2#1654, c_name_prf#1646 AS c_name_prf_2#1655, c_nationkey_prf#1647 AS c_nationkey_prf_2#1656, c_custkey_prf#1648 AS c_custkey_prf_2#1657, c_comment_prf#1649 AS c_comment_prf_2#1658, c_address_prf#1650 AS c_address_prf_2#1659, c_mktsegment_prf#1651 AS c_mktsegment_prf_2#1660, c_phone_prf#1652 AS c_phone_prf_2#1661]
            +- Relation[c_acctbal_prf#1644,rid#1645,c_name_prf#1646,c_nationkey_prf#1647,c_custkey_prf#1648,c_comment_prf#1649,c_address_prf#1650,c_mktsegment_prf#1651,c_phone_prf#1652] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 893717ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/12 04:13:53 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:13:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1720L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 04:13:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1720L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#1722 AS c_acctbal_prf_0#1731, rid#1723 AS rid_0#1732, c_name_prf#1724 AS c_name_prf_0#1733, c_nationkey_prf#1725 AS c_nationkey_prf_0#1734, c_custkey_prf#1726 AS c_custkey_prf_0#1735, c_comment_prf#1727 AS c_comment_prf_0#1736, c_address_prf#1728 AS c_address_prf_0#1737, c_mktsegment_prf#1729 AS c_mktsegment_prf_0#1738, c_phone_prf#1730 AS c_phone_prf_0#1739]
         :  :  +- Relation[c_acctbal_prf#1722,rid#1723,c_name_prf#1724,c_nationkey_prf#1725,c_custkey_prf#1726,c_comment_prf#1727,c_address_prf#1728,c_mktsegment_prf#1729,c_phone_prf#1730] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1740, dexdecrypt('value_dec_key, 'value_right) AS rid_2#1741]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [l_returnflag_prf#1742 AS l_returnflag_prf_1#1761, l_orderkey_and_l_linenumber_prf#1743 AS l_orderkey_and_l_linenumber_prf_1#1762, l_comment_prf#1744 AS l_comment_prf_1#1763, l_linestatus_prf#1745 AS l_linestatus_prf_1#1764, rid#1746 AS rid_1#1765, l_shipmode_prf#1747 AS l_shipmode_prf_1#1766, l_shipinstruct_prf#1748 AS l_shipinstruct_prf_1#1767, l_quantity_prf#1749 AS l_quantity_prf_1#1768, l_receiptdate_prf#1750 AS l_receiptdate_prf_1#1769, l_linenumber_prf#1751 AS l_linenumber_prf_1#1770, l_tax_prf#1752 AS l_tax_prf_1#1771, l_shipdate_prf#1753 AS l_shipdate_prf_1#1772, l_extendedprice_prf#1754 AS l_extendedprice_prf_1#1773, l_partkey_prf#1755 AS l_partkey_prf_1#1774, l_discount_prf#1756 AS l_discount_prf_1#1775, l_partkey_and_l_suppkey_prf#1757 AS l_partkey_and_l_suppkey_prf_1#1776, l_commitdate_prf#1758 AS l_commitdate_prf_1#1777, l_suppkey_prf#1759 AS l_suppkey_prf_1#1778, l_orderkey_prf#1760 AS l_orderkey_prf_1#1779]
            :  :  +- Relation[l_returnflag_prf#1742,l_orderkey_and_l_linenumber_prf#1743,l_comment_prf#1744,l_linestatus_prf#1745,rid#1746,l_shipmode_prf#1747,l_shipinstruct_prf#1748,l_quantity_prf#1749,l_receiptdate_prf#1750,l_linenumber_prf#1751,l_tax_prf#1752,l_shipdate_prf#1753,l_extendedprice_prf#1754,l_partkey_prf#1755,l_discount_prf#1756,l_partkey_and_l_suppkey_prf#1757,l_commitdate_prf#1758,l_suppkey_prf#1759,l_orderkey_prf#1760] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1780, dexdecrypt('value_dec_key, 'value_right) AS rid_2#1781]
            :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
            :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#1782 AS o_shippriority_prf_2#1792, rid#1783 AS rid_2#1793, o_orderdate_prf#1784 AS o_orderdate_prf_2#1794, o_custkey_prf#1785 AS o_custkey_prf_2#1795, o_orderpriority_prf#1786 AS o_orderpriority_prf_2#1796, o_clerk_prf#1787 AS o_clerk_prf_2#1797, o_orderstatus_prf#1788 AS o_orderstatus_prf_2#1798, o_totalprice_prf#1789 AS o_totalprice_prf_2#1799, o_orderkey_prf#1790 AS o_orderkey_prf_2#1800, o_comment_prf#1791 AS o_comment_prf_2#1801]
               +- Relation[o_shippriority_prf#1782,rid#1783,o_orderdate_prf#1784,o_custkey_prf#1785,o_orderpriority_prf#1786,o_clerk_prf#1787,o_orderstatus_prf#1788,o_totalprice_prf#1789,o_orderkey_prf#1790,o_comment_prf#1791] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201478ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/12 04:17:15 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:17:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1864L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 04:17:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1864L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [p_comment_prf#1866 AS p_comment_prf_0#1876, p_name_prf#1867 AS p_name_prf_0#1877, rid#1868 AS rid_0#1878, p_type_prf#1869 AS p_type_prf_0#1879, p_retailprice_prf#1870 AS p_retailprice_prf_0#1880, p_mfgr_prf#1871 AS p_mfgr_prf_0#1881, p_container_prf#1872 AS p_container_prf_0#1882, p_brand_prf#1873 AS p_brand_prf_0#1883, p_size_prf#1874 AS p_size_prf_0#1884, p_partkey_prf#1875 AS p_partkey_prf_0#1885]
         :  :  :  :  +- Relation[p_comment_prf#1866,p_name_prf#1867,rid#1868,p_type_prf#1869,p_retailprice_prf#1870,p_mfgr_prf#1871,p_container_prf#1872,p_brand_prf#1873,p_size_prf#1874,p_partkey_prf#1875] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1886, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1887]
         :  :  :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :  :  :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#1888 AS ps_partkey_and_ps_suppkey_prf_1#1895, rid#1889 AS rid_1#1896, ps_availqty_prf#1890 AS ps_availqty_prf_1#1897, ps_comment_prf#1891 AS ps_comment_prf_1#1898, ps_partkey_prf#1892 AS ps_partkey_prf_1#1899, ps_supplycost_prf#1893 AS ps_supplycost_prf_1#1900, ps_suppkey_prf#1894 AS ps_suppkey_prf_1#1901]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#1888,rid#1889,ps_availqty_prf#1890,ps_comment_prf#1891,ps_partkey_prf#1892,ps_supplycost_prf#1893,ps_suppkey_prf#1894] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1902, dexdecrypt('value_dec_key, 'value_right) AS rid_2#1903]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#1904 AS s_phone_prf_2#1912, rid#1905 AS rid_2#1913, s_address_prf#1906 AS s_address_prf_2#1914, s_nationkey_prf#1907 AS s_nationkey_prf_2#1915, s_suppkey_prf#1908 AS s_suppkey_prf_2#1916, s_name_prf#1909 AS s_name_prf_2#1917, s_acctbal_prf#1910 AS s_acctbal_prf_2#1918, s_comment_prf#1911 AS s_comment_prf_2#1919]
            +- Relation[s_phone_prf#1904,rid#1905,s_address_prf#1906,s_nationkey_prf#1907,s_suppkey_prf#1908,s_name_prf#1909,s_acctbal_prf#1910,s_comment_prf#1911] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 34282ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/12 04:17:49 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:17:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1973L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 04:17:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1973L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [o_shippriority_prf#1975 AS o_shippriority_prf_0#1985, rid#1976 AS rid_0#1986, o_orderdate_prf#1977 AS o_orderdate_prf_0#1987, o_custkey_prf#1978 AS o_custkey_prf_0#1988, o_orderpriority_prf#1979 AS o_orderpriority_prf_0#1989, o_clerk_prf#1980 AS o_clerk_prf_0#1990, o_orderstatus_prf#1981 AS o_orderstatus_prf_0#1991, o_totalprice_prf#1982 AS o_totalprice_prf_0#1992, o_orderkey_prf#1983 AS o_orderkey_prf_0#1993, o_comment_prf#1984 AS o_comment_prf_0#1994]
         :  :  +- Relation[o_shippriority_prf#1975,rid#1976,o_orderdate_prf#1977,o_custkey_prf#1978,o_orderpriority_prf#1979,o_clerk_prf#1980,o_orderstatus_prf#1981,o_totalprice_prf#1982,o_orderkey_prf#1983,o_comment_prf#1984] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1995, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1996]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1997 AS l_returnflag_prf_1#2016, l_orderkey_and_l_linenumber_prf#1998 AS l_orderkey_and_l_linenumber_prf_1#2017, l_comment_prf#1999 AS l_comment_prf_1#2018, l_linestatus_prf#2000 AS l_linestatus_prf_1#2019, rid#2001 AS rid_1#2020, l_shipmode_prf#2002 AS l_shipmode_prf_1#2021, l_shipinstruct_prf#2003 AS l_shipinstruct_prf_1#2022, l_quantity_prf#2004 AS l_quantity_prf_1#2023, l_receiptdate_prf#2005 AS l_receiptdate_prf_1#2024, l_linenumber_prf#2006 AS l_linenumber_prf_1#2025, l_tax_prf#2007 AS l_tax_prf_1#2026, l_shipdate_prf#2008 AS l_shipdate_prf_1#2027, l_extendedprice_prf#2009 AS l_extendedprice_prf_1#2028, l_partkey_prf#2010 AS l_partkey_prf_1#2029, l_discount_prf#2011 AS l_discount_prf_1#2030, l_partkey_and_l_suppkey_prf#2012 AS l_partkey_and_l_suppkey_prf_1#2031, l_commitdate_prf#2013 AS l_commitdate_prf_1#2032, l_suppkey_prf#2014 AS l_suppkey_prf_1#2033, l_orderkey_prf#2015 AS l_orderkey_prf_1#2034]
            +- Relation[l_returnflag_prf#1997,l_orderkey_and_l_linenumber_prf#1998,l_comment_prf#1999,l_linestatus_prf#2000,rid#2001,l_shipmode_prf#2002,l_shipinstruct_prf#2003,l_quantity_prf#2004,l_receiptdate_prf#2005,l_linenumber_prf#2006,l_tax_prf#2007,l_shipdate_prf#2008,l_extendedprice_prf#2009,l_partkey_prf#2010,l_discount_prf#2011,l_partkey_and_l_suppkey_prf#2012,l_commitdate_prf#2013,l_suppkey_prf#2014,l_orderkey_prf#2015] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 107055ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/12 04:19:36 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:19:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2088L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 04:19:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2088L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [ps_partkey_and_ps_suppkey_prf#2090 AS ps_partkey_and_ps_suppkey_prf_0#2097, rid#2091 AS rid_0#2098, ps_availqty_prf#2092 AS ps_availqty_prf_0#2099, ps_comment_prf#2093 AS ps_comment_prf_0#2100, ps_partkey_prf#2094 AS ps_partkey_prf_0#2101, ps_supplycost_prf#2095 AS ps_supplycost_prf_0#2102, ps_suppkey_prf#2096 AS ps_suppkey_prf_0#2103]
         :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#2090,rid#2091,ps_availqty_prf#2092,ps_comment_prf#2093,ps_partkey_prf#2094,ps_supplycost_prf#2095,ps_suppkey_prf#2096] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2104, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2105]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey_and_l_suppkey~partsupp~ps_partkey_and_ps_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2106 AS l_returnflag_prf_1#2125, l_orderkey_and_l_linenumber_prf#2107 AS l_orderkey_and_l_linenumber_prf_1#2126, l_comment_prf#2108 AS l_comment_prf_1#2127, l_linestatus_prf#2109 AS l_linestatus_prf_1#2128, rid#2110 AS rid_1#2129, l_shipmode_prf#2111 AS l_shipmode_prf_1#2130, l_shipinstruct_prf#2112 AS l_shipinstruct_prf_1#2131, l_quantity_prf#2113 AS l_quantity_prf_1#2132, l_receiptdate_prf#2114 AS l_receiptdate_prf_1#2133, l_linenumber_prf#2115 AS l_linenumber_prf_1#2134, l_tax_prf#2116 AS l_tax_prf_1#2135, l_shipdate_prf#2117 AS l_shipdate_prf_1#2136, l_extendedprice_prf#2118 AS l_extendedprice_prf_1#2137, l_partkey_prf#2119 AS l_partkey_prf_1#2138, l_discount_prf#2120 AS l_discount_prf_1#2139, l_partkey_and_l_suppkey_prf#2121 AS l_partkey_and_l_suppkey_prf_1#2140, l_commitdate_prf#2122 AS l_commitdate_prf_1#2141, l_suppkey_prf#2123 AS l_suppkey_prf_1#2142, l_orderkey_prf#2124 AS l_orderkey_prf_1#2143]
            +- Relation[l_returnflag_prf#2106,l_orderkey_and_l_linenumber_prf#2107,l_comment_prf#2108,l_linestatus_prf#2109,rid#2110,l_shipmode_prf#2111,l_shipinstruct_prf#2112,l_quantity_prf#2113,l_receiptdate_prf#2114,l_linenumber_prf#2115,l_tax_prf#2116,l_shipdate_prf#2117,l_extendedprice_prf#2118,l_partkey_prf#2119,l_discount_prf#2120,l_partkey_and_l_suppkey_prf#2121,l_commitdate_prf#2122,l_suppkey_prf#2123,l_orderkey_prf#2124] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 144287ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/12 04:22:00 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:22:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2196L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 04:22:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2196L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#2198 AS s_phone_prf_0#2206, rid#2199 AS rid_0#2207, s_address_prf#2200 AS s_address_prf_0#2208, s_nationkey_prf#2201 AS s_nationkey_prf_0#2209, s_suppkey_prf#2202 AS s_suppkey_prf_0#2210, s_name_prf#2203 AS s_name_prf_0#2211, s_acctbal_prf#2204 AS s_acctbal_prf_0#2212, s_comment_prf#2205 AS s_comment_prf_0#2213]
         :  :  +- Relation[s_phone_prf#2198,rid#2199,s_address_prf#2200,s_nationkey_prf#2201,s_suppkey_prf#2202,s_name_prf#2203,s_acctbal_prf#2204,s_comment_prf#2205] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2214, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2215]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2216 AS l_returnflag_prf_1#2235, l_orderkey_and_l_linenumber_prf#2217 AS l_orderkey_and_l_linenumber_prf_1#2236, l_comment_prf#2218 AS l_comment_prf_1#2237, l_linestatus_prf#2219 AS l_linestatus_prf_1#2238, rid#2220 AS rid_1#2239, l_shipmode_prf#2221 AS l_shipmode_prf_1#2240, l_shipinstruct_prf#2222 AS l_shipinstruct_prf_1#2241, l_quantity_prf#2223 AS l_quantity_prf_1#2242, l_receiptdate_prf#2224 AS l_receiptdate_prf_1#2243, l_linenumber_prf#2225 AS l_linenumber_prf_1#2244, l_tax_prf#2226 AS l_tax_prf_1#2245, l_shipdate_prf#2227 AS l_shipdate_prf_1#2246, l_extendedprice_prf#2228 AS l_extendedprice_prf_1#2247, l_partkey_prf#2229 AS l_partkey_prf_1#2248, l_discount_prf#2230 AS l_discount_prf_1#2249, l_partkey_and_l_suppkey_prf#2231 AS l_partkey_and_l_suppkey_prf_1#2250, l_commitdate_prf#2232 AS l_commitdate_prf_1#2251, l_suppkey_prf#2233 AS l_suppkey_prf_1#2252, l_orderkey_prf#2234 AS l_orderkey_prf_1#2253]
            +- Relation[l_returnflag_prf#2216,l_orderkey_and_l_linenumber_prf#2217,l_comment_prf#2218,l_linestatus_prf#2219,rid#2220,l_shipmode_prf#2221,l_shipinstruct_prf#2222,l_quantity_prf#2223,l_receiptdate_prf#2224,l_linenumber_prf#2225,l_tax_prf#2226,l_shipdate_prf#2227,l_extendedprice_prf#2228,l_partkey_prf#2229,l_discount_prf#2230,l_partkey_and_l_suppkey_prf#2231,l_commitdate_prf#2232,l_suppkey_prf#2233,l_orderkey_prf#2234] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 119142ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/12 04:23:59 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:23:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2309L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 04:24:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2309L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [o_shippriority_prf#2311 AS o_shippriority_prf_0#2321, rid#2312 AS rid_0#2322, o_orderdate_prf#2313 AS o_orderdate_prf_0#2323, o_custkey_prf#2314 AS o_custkey_prf_0#2324, o_orderpriority_prf#2315 AS o_orderpriority_prf_0#2325, o_clerk_prf#2316 AS o_clerk_prf_0#2326, o_orderstatus_prf#2317 AS o_orderstatus_prf_0#2327, o_totalprice_prf#2318 AS o_totalprice_prf_0#2328, o_orderkey_prf#2319 AS o_orderkey_prf_0#2329, o_comment_prf#2320 AS o_comment_prf_0#2330]
         :  :  +- Relation[o_shippriority_prf#2311,rid#2312,o_orderdate_prf#2313,o_custkey_prf#2314,o_orderpriority_prf#2315,o_clerk_prf#2316,o_orderstatus_prf#2317,o_totalprice_prf#2318,o_orderkey_prf#2319,o_comment_prf#2320] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2331, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2332]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#2333 AS l_returnflag_prf_1#2352, l_orderkey_and_l_linenumber_prf#2334 AS l_orderkey_and_l_linenumber_prf_1#2353, l_comment_prf#2335 AS l_comment_prf_1#2354, l_linestatus_prf#2336 AS l_linestatus_prf_1#2355, rid#2337 AS rid_1#2356, l_shipmode_prf#2338 AS l_shipmode_prf_1#2357, l_shipinstruct_prf#2339 AS l_shipinstruct_prf_1#2358, l_quantity_prf#2340 AS l_quantity_prf_1#2359, l_receiptdate_prf#2341 AS l_receiptdate_prf_1#2360, l_linenumber_prf#2342 AS l_linenumber_prf_1#2361, l_tax_prf#2343 AS l_tax_prf_1#2362, l_shipdate_prf#2344 AS l_shipdate_prf_1#2363, l_extendedprice_prf#2345 AS l_extendedprice_prf_1#2364, l_partkey_prf#2346 AS l_partkey_prf_1#2365, l_discount_prf#2347 AS l_discount_prf_1#2366, l_partkey_and_l_suppkey_prf#2348 AS l_partkey_and_l_suppkey_prf_1#2367, l_commitdate_prf#2349 AS l_commitdate_prf_1#2368, l_suppkey_prf#2350 AS l_suppkey_prf_1#2369, l_orderkey_prf#2351 AS l_orderkey_prf_1#2370]
            :  +- Relation[l_returnflag_prf#2333,l_orderkey_and_l_linenumber_prf#2334,l_comment_prf#2335,l_linestatus_prf#2336,rid#2337,l_shipmode_prf#2338,l_shipinstruct_prf#2339,l_quantity_prf#2340,l_receiptdate_prf#2341,l_linenumber_prf#2342,l_tax_prf#2343,l_shipdate_prf#2344,l_extendedprice_prf#2345,l_partkey_prf#2346,l_discount_prf#2347,l_partkey_and_l_suppkey_prf#2348,l_commitdate_prf#2349,l_suppkey_prf#2350,l_orderkey_prf#2351] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2373]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#2371,value#2372] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 107543ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/12 04:25:47 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:25:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2439L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 04:25:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2439L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [l_returnflag_prf#2441 AS l_returnflag_prf_0#2460, l_orderkey_and_l_linenumber_prf#2442 AS l_orderkey_and_l_linenumber_prf_0#2461, l_comment_prf#2443 AS l_comment_prf_0#2462, l_linestatus_prf#2444 AS l_linestatus_prf_0#2463, rid#2445 AS rid_0#2464, l_shipmode_prf#2446 AS l_shipmode_prf_0#2465, l_shipinstruct_prf#2447 AS l_shipinstruct_prf_0#2466, l_quantity_prf#2448 AS l_quantity_prf_0#2467, l_receiptdate_prf#2449 AS l_receiptdate_prf_0#2468, l_linenumber_prf#2450 AS l_linenumber_prf_0#2469, l_tax_prf#2451 AS l_tax_prf_0#2470, l_shipdate_prf#2452 AS l_shipdate_prf_0#2471, l_extendedprice_prf#2453 AS l_extendedprice_prf_0#2472, l_partkey_prf#2454 AS l_partkey_prf_0#2473, l_discount_prf#2455 AS l_discount_prf_0#2474, l_partkey_and_l_suppkey_prf#2456 AS l_partkey_and_l_suppkey_prf_0#2475, l_commitdate_prf#2457 AS l_commitdate_prf_0#2476, l_suppkey_prf#2458 AS l_suppkey_prf_0#2477, l_orderkey_prf#2459 AS l_orderkey_prf_0#2478]
         :  :  :  :  +- Relation[l_returnflag_prf#2441,l_orderkey_and_l_linenumber_prf#2442,l_comment_prf#2443,l_linestatus_prf#2444,rid#2445,l_shipmode_prf#2446,l_shipinstruct_prf#2447,l_quantity_prf#2448,l_receiptdate_prf#2449,l_linenumber_prf#2450,l_tax_prf#2451,l_shipdate_prf#2452,l_extendedprice_prf#2453,l_partkey_prf#2454,l_discount_prf#2455,l_partkey_and_l_suppkey_prf#2456,l_commitdate_prf#2457,l_suppkey_prf#2458,l_orderkey_prf#2459] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2479, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2480]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :  :  :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#2481 AS o_shippriority_prf_1#2491, rid#2482 AS rid_1#2492, o_orderdate_prf#2483 AS o_orderdate_prf_1#2493, o_custkey_prf#2484 AS o_custkey_prf_1#2494, o_orderpriority_prf#2485 AS o_orderpriority_prf_1#2495, o_clerk_prf#2486 AS o_clerk_prf_1#2496, o_orderstatus_prf#2487 AS o_orderstatus_prf_1#2497, o_totalprice_prf#2488 AS o_totalprice_prf_1#2498, o_orderkey_prf#2489 AS o_orderkey_prf_1#2499, o_comment_prf#2490 AS o_comment_prf_1#2500]
         :  :     +- Relation[o_shippriority_prf#2481,rid#2482,o_orderdate_prf#2483,o_custkey_prf#2484,o_orderpriority_prf#2485,o_clerk_prf#2486,o_orderstatus_prf#2487,o_totalprice_prf#2488,o_orderkey_prf#2489,o_comment_prf#2490] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2501, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2502]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2503 AS c_acctbal_prf_2#2512, rid#2504 AS rid_2#2513, c_name_prf#2505 AS c_name_prf_2#2514, c_nationkey_prf#2506 AS c_nationkey_prf_2#2515, c_custkey_prf#2507 AS c_custkey_prf_2#2516, c_comment_prf#2508 AS c_comment_prf_2#2517, c_address_prf#2509 AS c_address_prf_2#2518, c_mktsegment_prf#2510 AS c_mktsegment_prf_2#2519, c_phone_prf#2511 AS c_phone_prf_2#2520]
            +- Relation[c_acctbal_prf#2503,rid#2504,c_name_prf#2505,c_nationkey_prf#2506,c_custkey_prf#2507,c_comment_prf#2508,c_address_prf#2509,c_mktsegment_prf#2510,c_phone_prf#2511] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 183830ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/12 04:28:51 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:28:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2571L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 04:28:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2571L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#2573 AS p_comment_prf_0#2583, p_name_prf#2574 AS p_name_prf_0#2584, rid#2575 AS rid_0#2585, p_type_prf#2576 AS p_type_prf_0#2586, p_retailprice_prf#2577 AS p_retailprice_prf_0#2587, p_mfgr_prf#2578 AS p_mfgr_prf_0#2588, p_container_prf#2579 AS p_container_prf_0#2589, p_brand_prf#2580 AS p_brand_prf_0#2590, p_size_prf#2581 AS p_size_prf_0#2591, p_partkey_prf#2582 AS p_partkey_prf_0#2592]
         :  +- Relation[p_comment_prf#2573,p_name_prf#2574,rid#2575,p_type_prf#2576,p_retailprice_prf#2577,p_mfgr_prf#2578,p_container_prf#2579,p_brand_prf#2580,p_size_prf#2581,p_partkey_prf#2582] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2593]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#2371,value#2372] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1451
Elapsed time: 98ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/12 04:28:51 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:28:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2628L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 04:28:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2628L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [ps_partkey_and_ps_suppkey_prf#2630 AS ps_partkey_and_ps_suppkey_prf_0#2637, rid#2631 AS rid_0#2638, ps_availqty_prf#2632 AS ps_availqty_prf_0#2639, ps_comment_prf#2633 AS ps_comment_prf_0#2640, ps_partkey_prf#2634 AS ps_partkey_prf_0#2641, ps_supplycost_prf#2635 AS ps_supplycost_prf_0#2642, ps_suppkey_prf#2636 AS ps_suppkey_prf_0#2643]
         :  :  :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#2630,rid#2631,ps_availqty_prf#2632,ps_comment_prf#2633,ps_partkey_prf#2634,ps_supplycost_prf#2635,ps_suppkey_prf#2636] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2644, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2645]
         :  :  :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :  :  :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#2646 AS p_comment_prf_1#2656, p_name_prf#2647 AS p_name_prf_1#2657, rid#2648 AS rid_1#2658, p_type_prf#2649 AS p_type_prf_1#2659, p_retailprice_prf#2650 AS p_retailprice_prf_1#2660, p_mfgr_prf#2651 AS p_mfgr_prf_1#2661, p_container_prf#2652 AS p_container_prf_1#2662, p_brand_prf#2653 AS p_brand_prf_1#2663, p_size_prf#2654 AS p_size_prf_1#2664, p_partkey_prf#2655 AS p_partkey_prf_1#2665]
         :  :     +- Relation[p_comment_prf#2646,p_name_prf#2647,rid#2648,p_type_prf#2649,p_retailprice_prf#2650,p_mfgr_prf#2651,p_container_prf#2652,p_brand_prf#2653,p_size_prf#2654,p_partkey_prf#2655] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2666, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2667]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#2668 AS s_phone_prf_2#2676, rid#2669 AS rid_2#2677, s_address_prf#2670 AS s_address_prf_2#2678, s_nationkey_prf#2671 AS s_nationkey_prf_2#2679, s_suppkey_prf#2672 AS s_suppkey_prf_2#2680, s_name_prf#2673 AS s_name_prf_2#2681, s_acctbal_prf#2674 AS s_acctbal_prf_2#2682, s_comment_prf#2675 AS s_comment_prf_2#2683]
            +- Relation[s_phone_prf#2668,rid#2669,s_address_prf#2670,s_nationkey_prf#2671,s_suppkey_prf#2672,s_name_prf#2673,s_acctbal_prf#2674,s_comment_prf#2675] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26097ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/12 04:29:17 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:29:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2744L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 04:29:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2744L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [p_comment_prf#2746 AS p_comment_prf_0#2756, p_name_prf#2747 AS p_name_prf_0#2757, rid#2748 AS rid_0#2758, p_type_prf#2749 AS p_type_prf_0#2759, p_retailprice_prf#2750 AS p_retailprice_prf_0#2760, p_mfgr_prf#2751 AS p_mfgr_prf_0#2761, p_container_prf#2752 AS p_container_prf_0#2762, p_brand_prf#2753 AS p_brand_prf_0#2763, p_size_prf#2754 AS p_size_prf_0#2764, p_partkey_prf#2755 AS p_partkey_prf_0#2765]
         :  :  :  :  +- Relation[p_comment_prf#2746,p_name_prf#2747,rid#2748,p_type_prf#2749,p_retailprice_prf#2750,p_mfgr_prf#2751,p_container_prf#2752,p_brand_prf#2753,p_size_prf#2754,p_partkey_prf#2755] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2766, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2767]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :  :  :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#2768 AS l_returnflag_prf_1#2787, l_orderkey_and_l_linenumber_prf#2769 AS l_orderkey_and_l_linenumber_prf_1#2788, l_comment_prf#2770 AS l_comment_prf_1#2789, l_linestatus_prf#2771 AS l_linestatus_prf_1#2790, rid#2772 AS rid_1#2791, l_shipmode_prf#2773 AS l_shipmode_prf_1#2792, l_shipinstruct_prf#2774 AS l_shipinstruct_prf_1#2793, l_quantity_prf#2775 AS l_quantity_prf_1#2794, l_receiptdate_prf#2776 AS l_receiptdate_prf_1#2795, l_linenumber_prf#2777 AS l_linenumber_prf_1#2796, l_tax_prf#2778 AS l_tax_prf_1#2797, l_shipdate_prf#2779 AS l_shipdate_prf_1#2798, l_extendedprice_prf#2780 AS l_extendedprice_prf_1#2799, l_partkey_prf#2781 AS l_partkey_prf_1#2800, l_discount_prf#2782 AS l_discount_prf_1#2801, l_partkey_and_l_suppkey_prf#2783 AS l_partkey_and_l_suppkey_prf_1#2802, l_commitdate_prf#2784 AS l_commitdate_prf_1#2803, l_suppkey_prf#2785 AS l_suppkey_prf_1#2804, l_orderkey_prf#2786 AS l_orderkey_prf_1#2805]
         :  :     +- Relation[l_returnflag_prf#2768,l_orderkey_and_l_linenumber_prf#2769,l_comment_prf#2770,l_linestatus_prf#2771,rid#2772,l_shipmode_prf#2773,l_shipinstruct_prf#2774,l_quantity_prf#2775,l_receiptdate_prf#2776,l_linenumber_prf#2777,l_tax_prf#2778,l_shipdate_prf#2779,l_extendedprice_prf#2780,l_partkey_prf#2781,l_discount_prf#2782,l_partkey_and_l_suppkey_prf#2783,l_commitdate_prf#2784,l_suppkey_prf#2785,l_orderkey_prf#2786] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2806, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2807]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#2808 AS s_phone_prf_2#2816, rid#2809 AS rid_2#2817, s_address_prf#2810 AS s_address_prf_2#2818, s_nationkey_prf#2811 AS s_nationkey_prf_2#2819, s_suppkey_prf#2812 AS s_suppkey_prf_2#2820, s_name_prf#2813 AS s_name_prf_2#2821, s_acctbal_prf#2814 AS s_acctbal_prf_2#2822, s_comment_prf#2815 AS s_comment_prf_2#2823]
            +- Relation[s_phone_prf#2808,rid#2809,s_address_prf#2810,s_nationkey_prf#2811,s_suppkey_prf#2812,s_name_prf#2813,s_acctbal_prf#2814,s_comment_prf#2815] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201692ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/12 04:32:39 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:32:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2868L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 04:32:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2868L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#2870 AS rid_0#2875, n_regionkey_prf#2871 AS n_regionkey_prf_0#2876, n_nationkey_prf#2872 AS n_nationkey_prf_0#2877, n_name_prf#2873 AS n_name_prf_0#2878, n_comment_prf#2874 AS n_comment_prf_0#2879]
         :  +- Relation[rid#2870,n_regionkey_prf#2871,n_nationkey_prf#2872,n_name_prf#2873,n_comment_prf#2874] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2880]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#2371,value#2372] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1
Elapsed time: 57ms

f1=
select * from region where r_name = 'EUROPE'
19/10/12 04:32:39 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:32:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2892L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/12 04:32:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2892L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#2894 AS r_regionkey_prf_0#2898, r_name_prf#2895 AS r_name_prf_0#2899, r_comment_prf#2896 AS r_comment_prf_0#2900, rid#2897 AS rid_0#2901]
         :  +- Relation[r_regionkey_prf#2894,r_name_prf#2895,r_comment_prf#2896,rid#2897] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2902]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#2371,value#2372] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1
Elapsed time: 57ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/12 04:32:39 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:32:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2931L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 04:32:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2931L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#2933 AS s_phone_prf_0#2941, rid#2934 AS rid_0#2942, s_address_prf#2935 AS s_address_prf_0#2943, s_nationkey_prf#2936 AS s_nationkey_prf_0#2944, s_suppkey_prf#2937 AS s_suppkey_prf_0#2945, s_name_prf#2938 AS s_name_prf_0#2946, s_acctbal_prf#2939 AS s_acctbal_prf_0#2947, s_comment_prf#2940 AS s_comment_prf_0#2948]
         :  :  +- Relation[s_phone_prf#2933,rid#2934,s_address_prf#2935,s_nationkey_prf#2936,s_suppkey_prf#2937,s_name_prf#2938,s_acctbal_prf#2939,s_comment_prf#2940] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2949, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2950]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [ps_partkey_and_ps_suppkey_prf#2951 AS ps_partkey_and_ps_suppkey_prf_1#2958, rid#2952 AS rid_1#2959, ps_availqty_prf#2953 AS ps_availqty_prf_1#2960, ps_comment_prf#2954 AS ps_comment_prf_1#2961, ps_partkey_prf#2955 AS ps_partkey_prf_1#2962, ps_supplycost_prf#2956 AS ps_supplycost_prf_1#2963, ps_suppkey_prf#2957 AS ps_suppkey_prf_1#2964]
            :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#2951,rid#2952,ps_availqty_prf#2953,ps_comment_prf#2954,ps_partkey_prf#2955,ps_supplycost_prf#2956,ps_suppkey_prf#2957] JDBCRelation(partsupp_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2965, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2966]
            :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
            :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [p_comment_prf#2967 AS p_comment_prf_2#2977, p_name_prf#2968 AS p_name_prf_2#2978, rid#2969 AS rid_2#2979, p_type_prf#2970 AS p_type_prf_2#2980, p_retailprice_prf#2971 AS p_retailprice_prf_2#2981, p_mfgr_prf#2972 AS p_mfgr_prf_2#2982, p_container_prf#2973 AS p_container_prf_2#2983, p_brand_prf#2974 AS p_brand_prf_2#2984, p_size_prf#2975 AS p_size_prf_2#2985, p_partkey_prf#2976 AS p_partkey_prf_2#2986]
               +- Relation[p_comment_prf#2967,p_name_prf#2968,rid#2969,p_type_prf#2970,p_retailprice_prf#2971,p_mfgr_prf#2972,p_container_prf#2973,p_brand_prf#2974,p_size_prf#2975,p_partkey_prf#2976] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26256ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/12 04:33:05 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:33:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3048L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 04:33:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3048L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#3050 AS c_acctbal_prf_0#3059, rid#3051 AS rid_0#3060, c_name_prf#3052 AS c_name_prf_0#3061, c_nationkey_prf#3053 AS c_nationkey_prf_0#3062, c_custkey_prf#3054 AS c_custkey_prf_0#3063, c_comment_prf#3055 AS c_comment_prf_0#3064, c_address_prf#3056 AS c_address_prf_0#3065, c_mktsegment_prf#3057 AS c_mktsegment_prf_0#3066, c_phone_prf#3058 AS c_phone_prf_0#3067]
         :  :  +- Relation[c_acctbal_prf#3050,rid#3051,c_name_prf#3052,c_nationkey_prf#3053,c_custkey_prf#3054,c_comment_prf#3055,c_address_prf#3056,c_mktsegment_prf#3057,c_phone_prf#3058] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3068, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3069]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [o_shippriority_prf#3070 AS o_shippriority_prf_1#3080, rid#3071 AS rid_1#3081, o_orderdate_prf#3072 AS o_orderdate_prf_1#3082, o_custkey_prf#3073 AS o_custkey_prf_1#3083, o_orderpriority_prf#3074 AS o_orderpriority_prf_1#3084, o_clerk_prf#3075 AS o_clerk_prf_1#3085, o_orderstatus_prf#3076 AS o_orderstatus_prf_1#3086, o_totalprice_prf#3077 AS o_totalprice_prf_1#3087, o_orderkey_prf#3078 AS o_orderkey_prf_1#3088, o_comment_prf#3079 AS o_comment_prf_1#3089]
            :  :  +- Relation[o_shippriority_prf#3070,rid#3071,o_orderdate_prf#3072,o_custkey_prf#3073,o_orderpriority_prf#3074,o_clerk_prf#3075,o_orderstatus_prf#3076,o_totalprice_prf#3077,o_orderkey_prf#3078,o_comment_prf#3079] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3090, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3091]
            :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
            :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3092 AS l_returnflag_prf_2#3111, l_orderkey_and_l_linenumber_prf#3093 AS l_orderkey_and_l_linenumber_prf_2#3112, l_comment_prf#3094 AS l_comment_prf_2#3113, l_linestatus_prf#3095 AS l_linestatus_prf_2#3114, rid#3096 AS rid_2#3115, l_shipmode_prf#3097 AS l_shipmode_prf_2#3116, l_shipinstruct_prf#3098 AS l_shipinstruct_prf_2#3117, l_quantity_prf#3099 AS l_quantity_prf_2#3118, l_receiptdate_prf#3100 AS l_receiptdate_prf_2#3119, l_linenumber_prf#3101 AS l_linenumber_prf_2#3120, l_tax_prf#3102 AS l_tax_prf_2#3121, l_shipdate_prf#3103 AS l_shipdate_prf_2#3122, l_extendedprice_prf#3104 AS l_extendedprice_prf_2#3123, l_partkey_prf#3105 AS l_partkey_prf_2#3124, l_discount_prf#3106 AS l_discount_prf_2#3125, l_partkey_and_l_suppkey_prf#3107 AS l_partkey_and_l_suppkey_prf_2#3126, l_commitdate_prf#3108 AS l_commitdate_prf_2#3127, l_suppkey_prf#3109 AS l_suppkey_prf_2#3128, l_orderkey_prf#3110 AS l_orderkey_prf_2#3129]
               +- Relation[l_returnflag_prf#3092,l_orderkey_and_l_linenumber_prf#3093,l_comment_prf#3094,l_linestatus_prf#3095,rid#3096,l_shipmode_prf#3097,l_shipinstruct_prf#3098,l_quantity_prf#3099,l_receiptdate_prf#3100,l_linenumber_prf#3101,l_tax_prf#3102,l_shipdate_prf#3103,l_extendedprice_prf#3104,l_partkey_prf#3105,l_discount_prf#3106,l_partkey_and_l_suppkey_prf#3107,l_commitdate_prf#3108,l_suppkey_prf#3109,l_orderkey_prf#3110] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 169545ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/12 04:35:55 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:35:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3182L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 04:35:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3182L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [rid#3184 AS rid_0#3189, n_regionkey_prf#3185 AS n_regionkey_prf_0#3190, n_nationkey_prf#3186 AS n_nationkey_prf_0#3191, n_name_prf#3187 AS n_name_prf_0#3192, n_comment_prf#3188 AS n_comment_prf_0#3193]
         :  :  +- Relation[rid#3184,n_regionkey_prf#3185,n_nationkey_prf#3186,n_name_prf#3187,n_comment_prf#3188] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3194, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3195]
         :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#3196 AS s_phone_prf_1#3204, rid#3197 AS rid_1#3205, s_address_prf#3198 AS s_address_prf_1#3206, s_nationkey_prf#3199 AS s_nationkey_prf_1#3207, s_suppkey_prf#3200 AS s_suppkey_prf_1#3208, s_name_prf#3201 AS s_name_prf_1#3209, s_acctbal_prf#3202 AS s_acctbal_prf_1#3210, s_comment_prf#3203 AS s_comment_prf_1#3211]
            +- Relation[s_phone_prf#3196,rid#3197,s_address_prf#3198,s_nationkey_prf#3199,s_suppkey_prf#3200,s_name_prf#3201,s_acctbal_prf#3202,s_comment_prf#3203] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=10000
Elapsed time: 229ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/12 04:35:55 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:35:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3240L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 04:35:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3240L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [rid#3242 AS rid_0#3247, n_regionkey_prf#3243 AS n_regionkey_prf_0#3248, n_nationkey_prf#3244 AS n_nationkey_prf_0#3249, n_name_prf#3245 AS n_name_prf_0#3250, n_comment_prf#3246 AS n_comment_prf_0#3251]
         :  :  +- Relation[rid#3242,n_regionkey_prf#3243,n_nationkey_prf#3244,n_name_prf#3245,n_comment_prf#3246] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3252, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3253]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3254 AS c_acctbal_prf_1#3263, rid#3255 AS rid_1#3264, c_name_prf#3256 AS c_name_prf_1#3265, c_nationkey_prf#3257 AS c_nationkey_prf_1#3266, c_custkey_prf#3258 AS c_custkey_prf_1#3267, c_comment_prf#3259 AS c_comment_prf_1#3268, c_address_prf#3260 AS c_address_prf_1#3269, c_mktsegment_prf#3261 AS c_mktsegment_prf_1#3270, c_phone_prf#3262 AS c_phone_prf_1#3271]
            +- Relation[c_acctbal_prf#3254,rid#3255,c_name_prf#3256,c_nationkey_prf#3257,c_custkey_prf#3258,c_comment_prf#3259,c_address_prf#3260,c_mktsegment_prf#3261,c_phone_prf#3262] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=150000
Elapsed time: 2515ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/12 04:35:57 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:35:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3305L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 04:35:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3305L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#3307 AS l_returnflag_prf_0#3326, l_orderkey_and_l_linenumber_prf#3308 AS l_orderkey_and_l_linenumber_prf_0#3327, l_comment_prf#3309 AS l_comment_prf_0#3328, l_linestatus_prf#3310 AS l_linestatus_prf_0#3329, rid#3311 AS rid_0#3330, l_shipmode_prf#3312 AS l_shipmode_prf_0#3331, l_shipinstruct_prf#3313 AS l_shipinstruct_prf_0#3332, l_quantity_prf#3314 AS l_quantity_prf_0#3333, l_receiptdate_prf#3315 AS l_receiptdate_prf_0#3334, l_linenumber_prf#3316 AS l_linenumber_prf_0#3335, l_tax_prf#3317 AS l_tax_prf_0#3336, l_shipdate_prf#3318 AS l_shipdate_prf_0#3337, l_extendedprice_prf#3319 AS l_extendedprice_prf_0#3338, l_partkey_prf#3320 AS l_partkey_prf_0#3339, l_discount_prf#3321 AS l_discount_prf_0#3340, l_partkey_and_l_suppkey_prf#3322 AS l_partkey_and_l_suppkey_prf_0#3341, l_commitdate_prf#3323 AS l_commitdate_prf_0#3342, l_suppkey_prf#3324 AS l_suppkey_prf_0#3343, l_orderkey_prf#3325 AS l_orderkey_prf_0#3344]
         :  +- Relation[l_returnflag_prf#3307,l_orderkey_and_l_linenumber_prf#3308,l_comment_prf#3309,l_linestatus_prf#3310,rid#3311,l_shipmode_prf#3312,l_shipinstruct_prf#3313,l_quantity_prf#3314,l_receiptdate_prf#3315,l_linenumber_prf#3316,l_tax_prf#3317,l_shipdate_prf#3318,l_extendedprice_prf#3319,l_partkey_prf#3320,l_discount_prf#3321,l_partkey_and_l_suppkey_prf#3322,l_commitdate_prf#3323,l_suppkey_prf#3324,l_orderkey_prf#3325] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3345]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#2371,value#2372] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=857401
Elapsed time: 21317ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/12 04:36:19 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:36:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3375L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 04:36:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3375L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [r_regionkey_prf#3377 AS r_regionkey_prf_0#3381, r_name_prf#3378 AS r_name_prf_0#3382, r_comment_prf#3379 AS r_comment_prf_0#3383, rid#3380 AS rid_0#3384]
         :  :  +- Relation[r_regionkey_prf#3377,r_name_prf#3378,r_comment_prf#3379,rid#3380] JDBCRelation(region_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3385, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3386]
         :     +- SpxRidUncorrelatedJoin nation~n_regionkey~region~r_regionkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [rid#3387 AS rid_1#3392, n_regionkey_prf#3388 AS n_regionkey_prf_1#3393, n_nationkey_prf#3389 AS n_nationkey_prf_1#3394, n_name_prf#3390 AS n_name_prf_1#3395, n_comment_prf#3391 AS n_comment_prf_1#3396]
            +- Relation[rid#3387,n_regionkey_prf#3388,n_nationkey_prf#3389,n_name_prf#3390,n_comment_prf#3391] JDBCRelation(nation_prf) [numPartitions=1]

DexSpx$ result size=25
Elapsed time: 67ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/12 04:36:19 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:36:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3423L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 04:36:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3423L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [p_comment_prf#3425 AS p_comment_prf_0#3435, p_name_prf#3426 AS p_name_prf_0#3436, rid#3427 AS rid_0#3437, p_type_prf#3428 AS p_type_prf_0#3438, p_retailprice_prf#3429 AS p_retailprice_prf_0#3439, p_mfgr_prf#3430 AS p_mfgr_prf_0#3440, p_container_prf#3431 AS p_container_prf_0#3441, p_brand_prf#3432 AS p_brand_prf_0#3442, p_size_prf#3433 AS p_size_prf_0#3443, p_partkey_prf#3434 AS p_partkey_prf_0#3444]
         :  :  :  +- Relation[p_comment_prf#3425,p_name_prf#3426,rid#3427,p_type_prf#3428,p_retailprice_prf#3429,p_mfgr_prf#3430,p_container_prf#3431,p_brand_prf#3432,p_size_prf#3433,p_partkey_prf#3434] JDBCRelation(part_prf) [numPartitions=1]
         :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3445]
         :  :     +- DexRidFilter part~p_size~15
         :  :        +- Relation[label#2371,value#2372] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3446, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3447]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#3448 AS ps_partkey_and_ps_suppkey_prf_1#3455, rid#3449 AS rid_1#3456, ps_availqty_prf#3450 AS ps_availqty_prf_1#3457, ps_comment_prf#3451 AS ps_comment_prf_1#3458, ps_partkey_prf#3452 AS ps_partkey_prf_1#3459, ps_supplycost_prf#3453 AS ps_supplycost_prf_1#3460, ps_suppkey_prf#3454 AS ps_suppkey_prf_1#3461]
            +- Relation[ps_partkey_and_ps_suppkey_prf#3448,rid#3449,ps_availqty_prf#3450,ps_comment_prf#3451,ps_partkey_prf#3452,ps_supplycost_prf#3453,ps_suppkey_prf#3454] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=15628
Elapsed time: 10915ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/12 04:36:30 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:36:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3515L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 04:36:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3515L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#3517 AS l_returnflag_prf_0#3536, l_orderkey_and_l_linenumber_prf#3518 AS l_orderkey_and_l_linenumber_prf_0#3537, l_comment_prf#3519 AS l_comment_prf_0#3538, l_linestatus_prf#3520 AS l_linestatus_prf_0#3539, rid#3521 AS rid_0#3540, l_shipmode_prf#3522 AS l_shipmode_prf_0#3541, l_shipinstruct_prf#3523 AS l_shipinstruct_prf_0#3542, l_quantity_prf#3524 AS l_quantity_prf_0#3543, l_receiptdate_prf#3525 AS l_receiptdate_prf_0#3544, l_linenumber_prf#3526 AS l_linenumber_prf_0#3545, l_tax_prf#3527 AS l_tax_prf_0#3546, l_shipdate_prf#3528 AS l_shipdate_prf_0#3547, l_extendedprice_prf#3529 AS l_extendedprice_prf_0#3548, l_partkey_prf#3530 AS l_partkey_prf_0#3549, l_discount_prf#3531 AS l_discount_prf_0#3550, l_partkey_and_l_suppkey_prf#3532 AS l_partkey_and_l_suppkey_prf_0#3551, l_commitdate_prf#3533 AS l_commitdate_prf_0#3552, l_suppkey_prf#3534 AS l_suppkey_prf_0#3553, l_orderkey_prf#3535 AS l_orderkey_prf_0#3554]
         :  :  +- Relation[l_returnflag_prf#3517,l_orderkey_and_l_linenumber_prf#3518,l_comment_prf#3519,l_linestatus_prf#3520,rid#3521,l_shipmode_prf#3522,l_shipinstruct_prf#3523,l_quantity_prf#3524,l_receiptdate_prf#3525,l_linenumber_prf#3526,l_tax_prf#3527,l_shipdate_prf#3528,l_extendedprice_prf#3529,l_partkey_prf#3530,l_discount_prf#3531,l_partkey_and_l_suppkey_prf#3532,l_commitdate_prf#3533,l_suppkey_prf#3534,l_orderkey_prf#3535] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3555, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3556]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [o_shippriority_prf#3557 AS o_shippriority_prf_1#3567, rid#3558 AS rid_1#3568, o_orderdate_prf#3559 AS o_orderdate_prf_1#3569, o_custkey_prf#3560 AS o_custkey_prf_1#3570, o_orderpriority_prf#3561 AS o_orderpriority_prf_1#3571, o_clerk_prf#3562 AS o_clerk_prf_1#3572, o_orderstatus_prf#3563 AS o_orderstatus_prf_1#3573, o_totalprice_prf#3564 AS o_totalprice_prf_1#3574, o_orderkey_prf#3565 AS o_orderkey_prf_1#3575, o_comment_prf#3566 AS o_comment_prf_1#3576]
            :  :  +- Relation[o_shippriority_prf#3557,rid#3558,o_orderdate_prf#3559,o_custkey_prf#3560,o_orderpriority_prf#3561,o_clerk_prf#3562,o_orderstatus_prf#3563,o_totalprice_prf#3564,o_orderkey_prf#3565,o_comment_prf#3566] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3577, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3578]
            :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
            :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#3579 AS c_acctbal_prf_2#3588, rid#3580 AS rid_2#3589, c_name_prf#3581 AS c_name_prf_2#3590, c_nationkey_prf#3582 AS c_nationkey_prf_2#3591, c_custkey_prf#3583 AS c_custkey_prf_2#3592, c_comment_prf#3584 AS c_comment_prf_2#3593, c_address_prf#3585 AS c_address_prf_2#3594, c_mktsegment_prf#3586 AS c_mktsegment_prf_2#3595, c_phone_prf#3587 AS c_phone_prf_2#3596]
               +- Relation[c_acctbal_prf#3579,rid#3580,c_name_prf#3581,c_nationkey_prf#3582,c_custkey_prf#3583,c_comment_prf#3584,c_address_prf#3585,c_mktsegment_prf#3586,c_phone_prf#3587] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 182962ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/12 04:39:33 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:39:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3655L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 04:39:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3655L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#3657 AS c_acctbal_prf_0#3666, rid#3658 AS rid_0#3667, c_name_prf#3659 AS c_name_prf_0#3668, c_nationkey_prf#3660 AS c_nationkey_prf_0#3669, c_custkey_prf#3661 AS c_custkey_prf_0#3670, c_comment_prf#3662 AS c_comment_prf_0#3671, c_address_prf#3663 AS c_address_prf_0#3672, c_mktsegment_prf#3664 AS c_mktsegment_prf_0#3673, c_phone_prf#3665 AS c_phone_prf_0#3674]
         :  :  +- Relation[c_acctbal_prf#3657,rid#3658,c_name_prf#3659,c_nationkey_prf#3660,c_custkey_prf#3661,c_comment_prf#3662,c_address_prf#3663,c_mktsegment_prf#3664,c_phone_prf#3665] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3675, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3676]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3677 AS o_shippriority_prf_1#3687, rid#3678 AS rid_1#3688, o_orderdate_prf#3679 AS o_orderdate_prf_1#3689, o_custkey_prf#3680 AS o_custkey_prf_1#3690, o_orderpriority_prf#3681 AS o_orderpriority_prf_1#3691, o_clerk_prf#3682 AS o_clerk_prf_1#3692, o_orderstatus_prf#3683 AS o_orderstatus_prf_1#3693, o_totalprice_prf#3684 AS o_totalprice_prf_1#3694, o_orderkey_prf#3685 AS o_orderkey_prf_1#3695, o_comment_prf#3686 AS o_comment_prf_1#3696]
            +- Relation[o_shippriority_prf#3677,rid#3678,o_orderdate_prf#3679,o_custkey_prf#3680,o_orderpriority_prf#3681,o_clerk_prf#3682,o_orderstatus_prf#3683,o_totalprice_prf#3684,o_orderkey_prf#3685,o_comment_prf#3686] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=1500000
Elapsed time: 23637ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/12 04:39:56 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:39:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3744L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 04:39:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3744L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [p_comment_prf#3746 AS p_comment_prf_0#3756, p_name_prf#3747 AS p_name_prf_0#3757, rid#3748 AS rid_0#3758, p_type_prf#3749 AS p_type_prf_0#3759, p_retailprice_prf#3750 AS p_retailprice_prf_0#3760, p_mfgr_prf#3751 AS p_mfgr_prf_0#3761, p_container_prf#3752 AS p_container_prf_0#3762, p_brand_prf#3753 AS p_brand_prf_0#3763, p_size_prf#3754 AS p_size_prf_0#3764, p_partkey_prf#3755 AS p_partkey_prf_0#3765]
         :  :  +- Relation[p_comment_prf#3746,p_name_prf#3747,rid#3748,p_type_prf#3749,p_retailprice_prf#3750,p_mfgr_prf#3751,p_container_prf#3752,p_brand_prf#3753,p_size_prf#3754,p_partkey_prf#3755] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3766, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3767]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3768 AS l_returnflag_prf_1#3787, l_orderkey_and_l_linenumber_prf#3769 AS l_orderkey_and_l_linenumber_prf_1#3788, l_comment_prf#3770 AS l_comment_prf_1#3789, l_linestatus_prf#3771 AS l_linestatus_prf_1#3790, rid#3772 AS rid_1#3791, l_shipmode_prf#3773 AS l_shipmode_prf_1#3792, l_shipinstruct_prf#3774 AS l_shipinstruct_prf_1#3793, l_quantity_prf#3775 AS l_quantity_prf_1#3794, l_receiptdate_prf#3776 AS l_receiptdate_prf_1#3795, l_linenumber_prf#3777 AS l_linenumber_prf_1#3796, l_tax_prf#3778 AS l_tax_prf_1#3797, l_shipdate_prf#3779 AS l_shipdate_prf_1#3798, l_extendedprice_prf#3780 AS l_extendedprice_prf_1#3799, l_partkey_prf#3781 AS l_partkey_prf_1#3800, l_discount_prf#3782 AS l_discount_prf_1#3801, l_partkey_and_l_suppkey_prf#3783 AS l_partkey_and_l_suppkey_prf_1#3802, l_commitdate_prf#3784 AS l_commitdate_prf_1#3803, l_suppkey_prf#3785 AS l_suppkey_prf_1#3804, l_orderkey_prf#3786 AS l_orderkey_prf_1#3805]
            +- Relation[l_returnflag_prf#3768,l_orderkey_and_l_linenumber_prf#3769,l_comment_prf#3770,l_linestatus_prf#3771,rid#3772,l_shipmode_prf#3773,l_shipinstruct_prf#3774,l_quantity_prf#3775,l_receiptdate_prf#3776,l_linenumber_prf#3777,l_tax_prf#3778,l_shipdate_prf#3779,l_extendedprice_prf#3780,l_partkey_prf#3781,l_discount_prf#3782,l_partkey_and_l_suppkey_prf#3783,l_commitdate_prf#3784,l_suppkey_prf#3785,l_orderkey_prf#3786] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 94881ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/12 04:41:31 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:41:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3863L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 04:41:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3863L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [l_returnflag_prf#3865 AS l_returnflag_prf_0#3884, l_orderkey_and_l_linenumber_prf#3866 AS l_orderkey_and_l_linenumber_prf_0#3885, l_comment_prf#3867 AS l_comment_prf_0#3886, l_linestatus_prf#3868 AS l_linestatus_prf_0#3887, rid#3869 AS rid_0#3888, l_shipmode_prf#3870 AS l_shipmode_prf_0#3889, l_shipinstruct_prf#3871 AS l_shipinstruct_prf_0#3890, l_quantity_prf#3872 AS l_quantity_prf_0#3891, l_receiptdate_prf#3873 AS l_receiptdate_prf_0#3892, l_linenumber_prf#3874 AS l_linenumber_prf_0#3893, l_tax_prf#3875 AS l_tax_prf_0#3894, l_shipdate_prf#3876 AS l_shipdate_prf_0#3895, l_extendedprice_prf#3877 AS l_extendedprice_prf_0#3896, l_partkey_prf#3878 AS l_partkey_prf_0#3897, l_discount_prf#3879 AS l_discount_prf_0#3898, l_partkey_and_l_suppkey_prf#3880 AS l_partkey_and_l_suppkey_prf_0#3899, l_commitdate_prf#3881 AS l_commitdate_prf_0#3900, l_suppkey_prf#3882 AS l_suppkey_prf_0#3901, l_orderkey_prf#3883 AS l_orderkey_prf_0#3902]
         :  :  :  +- Relation[l_returnflag_prf#3865,l_orderkey_and_l_linenumber_prf#3866,l_comment_prf#3867,l_linestatus_prf#3868,rid#3869,l_shipmode_prf#3870,l_shipinstruct_prf#3871,l_quantity_prf#3872,l_receiptdate_prf#3873,l_linenumber_prf#3874,l_tax_prf#3875,l_shipdate_prf#3876,l_extendedprice_prf#3877,l_partkey_prf#3878,l_discount_prf#3879,l_partkey_and_l_suppkey_prf#3880,l_commitdate_prf#3881,l_suppkey_prf#3882,l_orderkey_prf#3883] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3903]
         :  :     +- DexRidFilter lineitem~l_returnflag~R
         :  :        +- Relation[label#2371,value#2372] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3904, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3905]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3906 AS o_shippriority_prf_1#3916, rid#3907 AS rid_1#3917, o_orderdate_prf#3908 AS o_orderdate_prf_1#3918, o_custkey_prf#3909 AS o_custkey_prf_1#3919, o_orderpriority_prf#3910 AS o_orderpriority_prf_1#3920, o_clerk_prf#3911 AS o_clerk_prf_1#3921, o_orderstatus_prf#3912 AS o_orderstatus_prf_1#3922, o_totalprice_prf#3913 AS o_totalprice_prf_1#3923, o_orderkey_prf#3914 AS o_orderkey_prf_1#3924, o_comment_prf#3915 AS o_comment_prf_1#3925]
            +- Relation[o_shippriority_prf#3906,rid#3907,o_orderdate_prf#3908,o_custkey_prf#3909,o_orderpriority_prf#3910,o_clerk_prf#3911,o_orderstatus_prf#3912,o_totalprice_prf#3913,o_orderkey_prf#3914,o_comment_prf#3915] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 97428ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/12 04:43:09 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:43:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3991L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 04:43:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3991L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#3993 AS l_returnflag_prf_0#4012, l_orderkey_and_l_linenumber_prf#3994 AS l_orderkey_and_l_linenumber_prf_0#4013, l_comment_prf#3995 AS l_comment_prf_0#4014, l_linestatus_prf#3996 AS l_linestatus_prf_0#4015, rid#3997 AS rid_0#4016, l_shipmode_prf#3998 AS l_shipmode_prf_0#4017, l_shipinstruct_prf#3999 AS l_shipinstruct_prf_0#4018, l_quantity_prf#4000 AS l_quantity_prf_0#4019, l_receiptdate_prf#4001 AS l_receiptdate_prf_0#4020, l_linenumber_prf#4002 AS l_linenumber_prf_0#4021, l_tax_prf#4003 AS l_tax_prf_0#4022, l_shipdate_prf#4004 AS l_shipdate_prf_0#4023, l_extendedprice_prf#4005 AS l_extendedprice_prf_0#4024, l_partkey_prf#4006 AS l_partkey_prf_0#4025, l_discount_prf#4007 AS l_discount_prf_0#4026, l_partkey_and_l_suppkey_prf#4008 AS l_partkey_and_l_suppkey_prf_0#4027, l_commitdate_prf#4009 AS l_commitdate_prf_0#4028, l_suppkey_prf#4010 AS l_suppkey_prf_0#4029, l_orderkey_prf#4011 AS l_orderkey_prf_0#4030]
         :  :  +- Relation[l_returnflag_prf#3993,l_orderkey_and_l_linenumber_prf#3994,l_comment_prf#3995,l_linestatus_prf#3996,rid#3997,l_shipmode_prf#3998,l_shipinstruct_prf#3999,l_quantity_prf#4000,l_receiptdate_prf#4001,l_linenumber_prf#4002,l_tax_prf#4003,l_shipdate_prf#4004,l_extendedprice_prf#4005,l_partkey_prf#4006,l_discount_prf#4007,l_partkey_and_l_suppkey_prf#4008,l_commitdate_prf#4009,l_suppkey_prf#4010,l_orderkey_prf#4011] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4031, dexdecrypt('value_dec_key, 'value_right) AS rid_2#4032]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [c_acctbal_prf#4033 AS c_acctbal_prf_1#4042, rid#4034 AS rid_1#4043, c_name_prf#4035 AS c_name_prf_1#4044, c_nationkey_prf#4036 AS c_nationkey_prf_1#4045, c_custkey_prf#4037 AS c_custkey_prf_1#4046, c_comment_prf#4038 AS c_comment_prf_1#4047, c_address_prf#4039 AS c_address_prf_1#4048, c_mktsegment_prf#4040 AS c_mktsegment_prf_1#4049, c_phone_prf#4041 AS c_phone_prf_1#4050]
            :  :  +- Relation[c_acctbal_prf#4033,rid#4034,c_name_prf#4035,c_nationkey_prf#4036,c_custkey_prf#4037,c_comment_prf#4038,c_address_prf#4039,c_mktsegment_prf#4040,c_phone_prf#4041] JDBCRelation(customer_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4051, dexdecrypt('value_dec_key, 'value_right) AS rid_2#4052]
            :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
            :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4053 AS o_shippriority_prf_2#4063, rid#4054 AS rid_2#4064, o_orderdate_prf#4055 AS o_orderdate_prf_2#4065, o_custkey_prf#4056 AS o_custkey_prf_2#4066, o_orderpriority_prf#4057 AS o_orderpriority_prf_2#4067, o_clerk_prf#4058 AS o_clerk_prf_2#4068, o_orderstatus_prf#4059 AS o_orderstatus_prf_2#4069, o_totalprice_prf#4060 AS o_totalprice_prf_2#4070, o_orderkey_prf#4061 AS o_orderkey_prf_2#4071, o_comment_prf#4062 AS o_comment_prf_2#4072]
               +- Relation[o_shippriority_prf#4053,rid#4054,o_orderdate_prf#4055,o_custkey_prf#4056,o_orderpriority_prf#4057,o_clerk_prf#4058,o_orderstatus_prf#4059,o_totalprice_prf#4060,o_orderkey_prf#4061,o_comment_prf#4062] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 182156ms

f2=
select * from part where p_size = 15
19/10/12 04:46:11 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:46:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4123L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 04:46:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4123L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#4125 AS p_comment_prf_0#4135, p_name_prf#4126 AS p_name_prf_0#4136, rid#4127 AS rid_0#4137, p_type_prf#4128 AS p_type_prf_0#4138, p_retailprice_prf#4129 AS p_retailprice_prf_0#4139, p_mfgr_prf#4130 AS p_mfgr_prf_0#4140, p_container_prf#4131 AS p_container_prf_0#4141, p_brand_prf#4132 AS p_brand_prf_0#4142, p_size_prf#4133 AS p_size_prf_0#4143, p_partkey_prf#4134 AS p_partkey_prf_0#4144]
         :  +- Relation[p_comment_prf#4125,p_name_prf#4126,rid#4127,p_type_prf#4128,p_retailprice_prf#4129,p_mfgr_prf#4130,p_container_prf#4131,p_brand_prf#4132,p_size_prf#4133,p_partkey_prf#4134] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4145]
            +- DexRidFilter part~p_size~15
               +- Relation[label#2371,value#2372] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=3907
Elapsed time: 122ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/12 04:46:11 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:46:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4180L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 04:46:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4180L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4182 AS s_phone_prf_0#4190, rid#4183 AS rid_0#4191, s_address_prf#4184 AS s_address_prf_0#4192, s_nationkey_prf#4185 AS s_nationkey_prf_0#4193, s_suppkey_prf#4186 AS s_suppkey_prf_0#4194, s_name_prf#4187 AS s_name_prf_0#4195, s_acctbal_prf#4188 AS s_acctbal_prf_0#4196, s_comment_prf#4189 AS s_comment_prf_0#4197]
         :  :  +- Relation[s_phone_prf#4182,rid#4183,s_address_prf#4184,s_nationkey_prf#4185,s_suppkey_prf#4186,s_name_prf#4187,s_acctbal_prf#4188,s_comment_prf#4189] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4198, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4199]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [p_comment_prf#4200 AS p_comment_prf_1#4210, p_name_prf#4201 AS p_name_prf_1#4211, rid#4202 AS rid_1#4212, p_type_prf#4203 AS p_type_prf_1#4213, p_retailprice_prf#4204 AS p_retailprice_prf_1#4214, p_mfgr_prf#4205 AS p_mfgr_prf_1#4215, p_container_prf#4206 AS p_container_prf_1#4216, p_brand_prf#4207 AS p_brand_prf_1#4217, p_size_prf#4208 AS p_size_prf_1#4218, p_partkey_prf#4209 AS p_partkey_prf_1#4219]
            :  :  +- Relation[p_comment_prf#4200,p_name_prf#4201,rid#4202,p_type_prf#4203,p_retailprice_prf#4204,p_mfgr_prf#4205,p_container_prf#4206,p_brand_prf#4207,p_size_prf#4208,p_partkey_prf#4209] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4220, dexdecrypt('value_dec_key, 'value_right) AS rid_2#4221]
            :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
            :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#4222 AS ps_partkey_and_ps_suppkey_prf_2#4229, rid#4223 AS rid_2#4230, ps_availqty_prf#4224 AS ps_availqty_prf_2#4231, ps_comment_prf#4225 AS ps_comment_prf_2#4232, ps_partkey_prf#4226 AS ps_partkey_prf_2#4233, ps_supplycost_prf#4227 AS ps_supplycost_prf_2#4234, ps_suppkey_prf#4228 AS ps_suppkey_prf_2#4235]
               +- Relation[ps_partkey_and_ps_suppkey_prf#4222,rid#4223,ps_availqty_prf#4224,ps_comment_prf#4225,ps_partkey_prf#4226,ps_supplycost_prf#4227,ps_suppkey_prf#4228] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26270ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/12 04:46:37 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:46:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4276L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 04:46:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4276L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4278 AS s_phone_prf_0#4286, rid#4279 AS rid_0#4287, s_address_prf#4280 AS s_address_prf_0#4288, s_nationkey_prf#4281 AS s_nationkey_prf_0#4289, s_suppkey_prf#4282 AS s_suppkey_prf_0#4290, s_name_prf#4283 AS s_name_prf_0#4291, s_acctbal_prf#4284 AS s_acctbal_prf_0#4292, s_comment_prf#4285 AS s_comment_prf_0#4293]
         :  :  +- Relation[s_phone_prf#4278,rid#4279,s_address_prf#4280,s_nationkey_prf#4281,s_suppkey_prf#4282,s_name_prf#4283,s_acctbal_prf#4284,s_comment_prf#4285] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4294, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4295]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4296 AS ps_partkey_and_ps_suppkey_prf_1#4303, rid#4297 AS rid_1#4304, ps_availqty_prf#4298 AS ps_availqty_prf_1#4305, ps_comment_prf#4299 AS ps_comment_prf_1#4306, ps_partkey_prf#4300 AS ps_partkey_prf_1#4307, ps_supplycost_prf#4301 AS ps_supplycost_prf_1#4308, ps_suppkey_prf#4302 AS ps_suppkey_prf_1#4309]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4296,rid#4297,ps_availqty_prf#4298,ps_comment_prf#4299,ps_partkey_prf#4300,ps_supplycost_prf#4301,ps_suppkey_prf#4302] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 11671ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/12 04:46:49 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 04:46:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4347L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 04:46:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4347L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [s_phone_prf#4349 AS s_phone_prf_0#4357, rid#4350 AS rid_0#4358, s_address_prf#4351 AS s_address_prf_0#4359, s_nationkey_prf#4352 AS s_nationkey_prf_0#4360, s_suppkey_prf#4353 AS s_suppkey_prf_0#4361, s_name_prf#4354 AS s_name_prf_0#4362, s_acctbal_prf#4355 AS s_acctbal_prf_0#4363, s_comment_prf#4356 AS s_comment_prf_0#4364]
         :  :  :  :  +- Relation[s_phone_prf#4349,rid#4350,s_address_prf#4351,s_nationkey_prf#4352,s_suppkey_prf#4353,s_name_prf#4354,s_acctbal_prf#4355,s_comment_prf#4356] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4365, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4366]
         :  :  :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :  :  :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [rid#4367 AS rid_1#4372, n_regionkey_prf#4368 AS n_regionkey_prf_1#4373, n_nationkey_prf#4369 AS n_nationkey_prf_1#4374, n_name_prf#4370 AS n_name_prf_1#4375, n_comment_prf#4371 AS n_comment_prf_1#4376]
         :  :     +- Relation[rid#4367,n_regionkey_prf#4368,n_nationkey_prf#4369,n_name_prf#4370,n_comment_prf#4371] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4377, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4378]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4379 AS c_acctbal_prf_2#4388, rid#4380 AS rid_2#4389, c_name_prf#4381 AS c_name_prf_2#4390, c_nationkey_prf#4382 AS c_nationkey_prf_2#4391, c_custkey_prf#4383 AS c_custkey_prf_2#4392, c_comment_prf#4384 AS c_comment_prf_2#4393, c_address_prf#4385 AS c_address_prf_2#4394, c_mktsegment_prf#4386 AS c_mktsegment_prf_2#4395, c_phone_prf#4387 AS c_phone_prf_2#4396]
            +- Relation[c_acctbal_prf#4379,rid#4380,c_name_prf#4381,c_nationkey_prf#4382,c_custkey_prf#4383,c_comment_prf#4384,c_address_prf#4385,c_mktsegment_prf#4386,c_phone_prf#4387] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 908819ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/12 05:01:58 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:01:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4454L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 05:01:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4454L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4456 AS s_phone_prf_0#4464, rid#4457 AS rid_0#4465, s_address_prf#4458 AS s_address_prf_0#4466, s_nationkey_prf#4459 AS s_nationkey_prf_0#4467, s_suppkey_prf#4460 AS s_suppkey_prf_0#4468, s_name_prf#4461 AS s_name_prf_0#4469, s_acctbal_prf#4462 AS s_acctbal_prf_0#4470, s_comment_prf#4463 AS s_comment_prf_0#4471]
         :  :  +- Relation[s_phone_prf#4456,rid#4457,s_address_prf#4458,s_nationkey_prf#4459,s_suppkey_prf#4460,s_name_prf#4461,s_acctbal_prf#4462,s_comment_prf#4463] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4472, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4473]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [p_comment_prf#4474 AS p_comment_prf_1#4484, p_name_prf#4475 AS p_name_prf_1#4485, rid#4476 AS rid_1#4486, p_type_prf#4477 AS p_type_prf_1#4487, p_retailprice_prf#4478 AS p_retailprice_prf_1#4488, p_mfgr_prf#4479 AS p_mfgr_prf_1#4489, p_container_prf#4480 AS p_container_prf_1#4490, p_brand_prf#4481 AS p_brand_prf_1#4491, p_size_prf#4482 AS p_size_prf_1#4492, p_partkey_prf#4483 AS p_partkey_prf_1#4493]
            :  :  +- Relation[p_comment_prf#4474,p_name_prf#4475,rid#4476,p_type_prf#4477,p_retailprice_prf#4478,p_mfgr_prf#4479,p_container_prf#4480,p_brand_prf#4481,p_size_prf#4482,p_partkey_prf#4483] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4494, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4495]
            :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
            :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4496 AS l_returnflag_prf_2#4515, l_orderkey_and_l_linenumber_prf#4497 AS l_orderkey_and_l_linenumber_prf_2#4516, l_comment_prf#4498 AS l_comment_prf_2#4517, l_linestatus_prf#4499 AS l_linestatus_prf_2#4518, rid#4500 AS rid_2#4519, l_shipmode_prf#4501 AS l_shipmode_prf_2#4520, l_shipinstruct_prf#4502 AS l_shipinstruct_prf_2#4521, l_quantity_prf#4503 AS l_quantity_prf_2#4522, l_receiptdate_prf#4504 AS l_receiptdate_prf_2#4523, l_linenumber_prf#4505 AS l_linenumber_prf_2#4524, l_tax_prf#4506 AS l_tax_prf_2#4525, l_shipdate_prf#4507 AS l_shipdate_prf_2#4526, l_extendedprice_prf#4508 AS l_extendedprice_prf_2#4527, l_partkey_prf#4509 AS l_partkey_prf_2#4528, l_discount_prf#4510 AS l_discount_prf_2#4529, l_partkey_and_l_suppkey_prf#4511 AS l_partkey_and_l_suppkey_prf_2#4530, l_commitdate_prf#4512 AS l_commitdate_prf_2#4531, l_suppkey_prf#4513 AS l_suppkey_prf_2#4532, l_orderkey_prf#4514 AS l_orderkey_prf_2#4533]
               +- Relation[l_returnflag_prf#4496,l_orderkey_and_l_linenumber_prf#4497,l_comment_prf#4498,l_linestatus_prf#4499,rid#4500,l_shipmode_prf#4501,l_shipinstruct_prf#4502,l_quantity_prf#4503,l_receiptdate_prf#4504,l_linenumber_prf#4505,l_tax_prf#4506,l_shipdate_prf#4507,l_extendedprice_prf#4508,l_partkey_prf#4509,l_discount_prf#4510,l_partkey_and_l_suppkey_prf#4511,l_commitdate_prf#4512,l_suppkey_prf#4513,l_orderkey_prf#4514] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201837ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/12 05:05:19 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:05:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4590L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 05:05:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4590L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#4592 AS l_returnflag_prf_0#4611, l_orderkey_and_l_linenumber_prf#4593 AS l_orderkey_and_l_linenumber_prf_0#4612, l_comment_prf#4594 AS l_comment_prf_0#4613, l_linestatus_prf#4595 AS l_linestatus_prf_0#4614, rid#4596 AS rid_0#4615, l_shipmode_prf#4597 AS l_shipmode_prf_0#4616, l_shipinstruct_prf#4598 AS l_shipinstruct_prf_0#4617, l_quantity_prf#4599 AS l_quantity_prf_0#4618, l_receiptdate_prf#4600 AS l_receiptdate_prf_0#4619, l_linenumber_prf#4601 AS l_linenumber_prf_0#4620, l_tax_prf#4602 AS l_tax_prf_0#4621, l_shipdate_prf#4603 AS l_shipdate_prf_0#4622, l_extendedprice_prf#4604 AS l_extendedprice_prf_0#4623, l_partkey_prf#4605 AS l_partkey_prf_0#4624, l_discount_prf#4606 AS l_discount_prf_0#4625, l_partkey_and_l_suppkey_prf#4607 AS l_partkey_and_l_suppkey_prf_0#4626, l_commitdate_prf#4608 AS l_commitdate_prf_0#4627, l_suppkey_prf#4609 AS l_suppkey_prf_0#4628, l_orderkey_prf#4610 AS l_orderkey_prf_0#4629]
         :  +- Relation[l_returnflag_prf#4592,l_orderkey_and_l_linenumber_prf#4593,l_comment_prf#4594,l_linestatus_prf#4595,rid#4596,l_shipmode_prf#4597,l_shipinstruct_prf#4598,l_quantity_prf#4599,l_receiptdate_prf#4600,l_linenumber_prf#4601,l_tax_prf#4602,l_shipdate_prf#4603,l_extendedprice_prf#4604,l_partkey_prf#4605,l_discount_prf#4606,l_partkey_and_l_suppkey_prf#4607,l_commitdate_prf#4608,l_suppkey_prf#4609,l_orderkey_prf#4610] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4630]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#2371,value#2372] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 23325ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/12 05:05:43 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:05:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4667L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 05:05:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4667L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [ps_partkey_and_ps_suppkey_prf#4669 AS ps_partkey_and_ps_suppkey_prf_0#4676, rid#4670 AS rid_0#4677, ps_availqty_prf#4671 AS ps_availqty_prf_0#4678, ps_comment_prf#4672 AS ps_comment_prf_0#4679, ps_partkey_prf#4673 AS ps_partkey_prf_0#4680, ps_supplycost_prf#4674 AS ps_supplycost_prf_0#4681, ps_suppkey_prf#4675 AS ps_suppkey_prf_0#4682]
         :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#4669,rid#4670,ps_availqty_prf#4671,ps_comment_prf#4672,ps_partkey_prf#4673,ps_supplycost_prf#4674,ps_suppkey_prf#4675] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4683, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4684]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#4685 AS p_comment_prf_1#4695, p_name_prf#4686 AS p_name_prf_1#4696, rid#4687 AS rid_1#4697, p_type_prf#4688 AS p_type_prf_1#4698, p_retailprice_prf#4689 AS p_retailprice_prf_1#4699, p_mfgr_prf#4690 AS p_mfgr_prf_1#4700, p_container_prf#4691 AS p_container_prf_1#4701, p_brand_prf#4692 AS p_brand_prf_1#4702, p_size_prf#4693 AS p_size_prf_1#4703, p_partkey_prf#4694 AS p_partkey_prf_1#4704]
            :  +- Relation[p_comment_prf#4685,p_name_prf#4686,rid#4687,p_type_prf#4688,p_retailprice_prf#4689,p_mfgr_prf#4690,p_container_prf#4691,p_brand_prf#4692,p_size_prf#4693,p_partkey_prf#4694] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4705]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#2371,value#2372] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=15628
Elapsed time: 7765ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/12 05:05:51 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:05:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4745L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 05:05:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4745L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#4747 AS c_acctbal_prf_0#4756, rid#4748 AS rid_0#4757, c_name_prf#4749 AS c_name_prf_0#4758, c_nationkey_prf#4750 AS c_nationkey_prf_0#4759, c_custkey_prf#4751 AS c_custkey_prf_0#4760, c_comment_prf#4752 AS c_comment_prf_0#4761, c_address_prf#4753 AS c_address_prf_0#4762, c_mktsegment_prf#4754 AS c_mktsegment_prf_0#4763, c_phone_prf#4755 AS c_phone_prf_0#4764]
         :  :  +- Relation[c_acctbal_prf#4747,rid#4748,c_name_prf#4749,c_nationkey_prf#4750,c_custkey_prf#4751,c_comment_prf#4752,c_address_prf#4753,c_mktsegment_prf#4754,c_phone_prf#4755] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4765, dexdecrypt('value_dec_key, 'value_right) AS rid_2#4766]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [s_phone_prf#4767 AS s_phone_prf_1#4775, rid#4768 AS rid_1#4776, s_address_prf#4769 AS s_address_prf_1#4777, s_nationkey_prf#4770 AS s_nationkey_prf_1#4778, s_suppkey_prf#4771 AS s_suppkey_prf_1#4779, s_name_prf#4772 AS s_name_prf_1#4780, s_acctbal_prf#4773 AS s_acctbal_prf_1#4781, s_comment_prf#4774 AS s_comment_prf_1#4782]
            :  :  +- Relation[s_phone_prf#4767,rid#4768,s_address_prf#4769,s_nationkey_prf#4770,s_suppkey_prf#4771,s_name_prf#4772,s_acctbal_prf#4773,s_comment_prf#4774] JDBCRelation(supplier_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4783, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4784]
            :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
            :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [rid#4785 AS rid_2#4790, n_regionkey_prf#4786 AS n_regionkey_prf_2#4791, n_nationkey_prf#4787 AS n_nationkey_prf_2#4792, n_name_prf#4788 AS n_name_prf_2#4793, n_comment_prf#4789 AS n_comment_prf_2#4794]
               +- Relation[rid#4785,n_regionkey_prf#4786,n_nationkey_prf#4787,n_name_prf#4788,n_comment_prf#4789] JDBCRelation(nation_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 904040ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/12 05:20:55 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:20:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4852L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 05:20:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4852L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4854 AS s_phone_prf_0#4862, rid#4855 AS rid_0#4863, s_address_prf#4856 AS s_address_prf_0#4864, s_nationkey_prf#4857 AS s_nationkey_prf_0#4865, s_suppkey_prf#4858 AS s_suppkey_prf_0#4866, s_name_prf#4859 AS s_name_prf_0#4867, s_acctbal_prf#4860 AS s_acctbal_prf_0#4868, s_comment_prf#4861 AS s_comment_prf_0#4869]
         :  :  +- Relation[s_phone_prf#4854,rid#4855,s_address_prf#4856,s_nationkey_prf#4857,s_suppkey_prf#4858,s_name_prf#4859,s_acctbal_prf#4860,s_comment_prf#4861] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4870, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4871]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [l_returnflag_prf#4872 AS l_returnflag_prf_1#4891, l_orderkey_and_l_linenumber_prf#4873 AS l_orderkey_and_l_linenumber_prf_1#4892, l_comment_prf#4874 AS l_comment_prf_1#4893, l_linestatus_prf#4875 AS l_linestatus_prf_1#4894, rid#4876 AS rid_1#4895, l_shipmode_prf#4877 AS l_shipmode_prf_1#4896, l_shipinstruct_prf#4878 AS l_shipinstruct_prf_1#4897, l_quantity_prf#4879 AS l_quantity_prf_1#4898, l_receiptdate_prf#4880 AS l_receiptdate_prf_1#4899, l_linenumber_prf#4881 AS l_linenumber_prf_1#4900, l_tax_prf#4882 AS l_tax_prf_1#4901, l_shipdate_prf#4883 AS l_shipdate_prf_1#4902, l_extendedprice_prf#4884 AS l_extendedprice_prf_1#4903, l_partkey_prf#4885 AS l_partkey_prf_1#4904, l_discount_prf#4886 AS l_discount_prf_1#4905, l_partkey_and_l_suppkey_prf#4887 AS l_partkey_and_l_suppkey_prf_1#4906, l_commitdate_prf#4888 AS l_commitdate_prf_1#4907, l_suppkey_prf#4889 AS l_suppkey_prf_1#4908, l_orderkey_prf#4890 AS l_orderkey_prf_1#4909]
            :  :  +- Relation[l_returnflag_prf#4872,l_orderkey_and_l_linenumber_prf#4873,l_comment_prf#4874,l_linestatus_prf#4875,rid#4876,l_shipmode_prf#4877,l_shipinstruct_prf#4878,l_quantity_prf#4879,l_receiptdate_prf#4880,l_linenumber_prf#4881,l_tax_prf#4882,l_shipdate_prf#4883,l_extendedprice_prf#4884,l_partkey_prf#4885,l_discount_prf#4886,l_partkey_and_l_suppkey_prf#4887,l_commitdate_prf#4888,l_suppkey_prf#4889,l_orderkey_prf#4890] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4910, dexdecrypt('value_dec_key, 'value_right) AS rid_2#4911]
            :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
            :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [p_comment_prf#4912 AS p_comment_prf_2#4922, p_name_prf#4913 AS p_name_prf_2#4923, rid#4914 AS rid_2#4924, p_type_prf#4915 AS p_type_prf_2#4925, p_retailprice_prf#4916 AS p_retailprice_prf_2#4926, p_mfgr_prf#4917 AS p_mfgr_prf_2#4927, p_container_prf#4918 AS p_container_prf_2#4928, p_brand_prf#4919 AS p_brand_prf_2#4929, p_size_prf#4920 AS p_size_prf_2#4930, p_partkey_prf#4921 AS p_partkey_prf_2#4931]
               +- Relation[p_comment_prf#4912,p_name_prf#4913,rid#4914,p_type_prf#4915,p_retailprice_prf#4916,p_mfgr_prf#4917,p_container_prf#4918,p_brand_prf#4919,p_size_prf#4920,p_partkey_prf#4921] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201098ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/12 05:24:16 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:24:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4986L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 05:24:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4986L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [p_comment_prf#4988 AS p_comment_prf_0#4998, p_name_prf#4989 AS p_name_prf_0#4999, rid#4990 AS rid_0#5000, p_type_prf#4991 AS p_type_prf_0#5001, p_retailprice_prf#4992 AS p_retailprice_prf_0#5002, p_mfgr_prf#4993 AS p_mfgr_prf_0#5003, p_container_prf#4994 AS p_container_prf_0#5004, p_brand_prf#4995 AS p_brand_prf_0#5005, p_size_prf#4996 AS p_size_prf_0#5006, p_partkey_prf#4997 AS p_partkey_prf_0#5007]
         :  :  +- Relation[p_comment_prf#4988,p_name_prf#4989,rid#4990,p_type_prf#4991,p_retailprice_prf#4992,p_mfgr_prf#4993,p_container_prf#4994,p_brand_prf#4995,p_size_prf#4996,p_partkey_prf#4997] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5008, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5009]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#5010 AS ps_partkey_and_ps_suppkey_prf_1#5017, rid#5011 AS rid_1#5018, ps_availqty_prf#5012 AS ps_availqty_prf_1#5019, ps_comment_prf#5013 AS ps_comment_prf_1#5020, ps_partkey_prf#5014 AS ps_partkey_prf_1#5021, ps_supplycost_prf#5015 AS ps_supplycost_prf_1#5022, ps_suppkey_prf#5016 AS ps_suppkey_prf_1#5023]
            +- Relation[ps_partkey_and_ps_suppkey_prf#5010,rid#5011,ps_availqty_prf#5012,ps_comment_prf#5013,ps_partkey_prf#5014,ps_supplycost_prf#5015,ps_suppkey_prf#5016] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 12148ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/12 05:24:28 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:24:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5069L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 05:24:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5069L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#5071 AS l_returnflag_prf_0#5090, l_orderkey_and_l_linenumber_prf#5072 AS l_orderkey_and_l_linenumber_prf_0#5091, l_comment_prf#5073 AS l_comment_prf_0#5092, l_linestatus_prf#5074 AS l_linestatus_prf_0#5093, rid#5075 AS rid_0#5094, l_shipmode_prf#5076 AS l_shipmode_prf_0#5095, l_shipinstruct_prf#5077 AS l_shipinstruct_prf_0#5096, l_quantity_prf#5078 AS l_quantity_prf_0#5097, l_receiptdate_prf#5079 AS l_receiptdate_prf_0#5098, l_linenumber_prf#5080 AS l_linenumber_prf_0#5099, l_tax_prf#5081 AS l_tax_prf_0#5100, l_shipdate_prf#5082 AS l_shipdate_prf_0#5101, l_extendedprice_prf#5083 AS l_extendedprice_prf_0#5102, l_partkey_prf#5084 AS l_partkey_prf_0#5103, l_discount_prf#5085 AS l_discount_prf_0#5104, l_partkey_and_l_suppkey_prf#5086 AS l_partkey_and_l_suppkey_prf_0#5105, l_commitdate_prf#5087 AS l_commitdate_prf_0#5106, l_suppkey_prf#5088 AS l_suppkey_prf_0#5107, l_orderkey_prf#5089 AS l_orderkey_prf_0#5108]
         :  :  +- Relation[l_returnflag_prf#5071,l_orderkey_and_l_linenumber_prf#5072,l_comment_prf#5073,l_linestatus_prf#5074,rid#5075,l_shipmode_prf#5076,l_shipinstruct_prf#5077,l_quantity_prf#5078,l_receiptdate_prf#5079,l_linenumber_prf#5080,l_tax_prf#5081,l_shipdate_prf#5082,l_extendedprice_prf#5083,l_partkey_prf#5084,l_discount_prf#5085,l_partkey_and_l_suppkey_prf#5086,l_commitdate_prf#5087,l_suppkey_prf#5088,l_orderkey_prf#5089] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5109, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5110]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#5111 AS o_shippriority_prf_1#5121, rid#5112 AS rid_1#5122, o_orderdate_prf#5113 AS o_orderdate_prf_1#5123, o_custkey_prf#5114 AS o_custkey_prf_1#5124, o_orderpriority_prf#5115 AS o_orderpriority_prf_1#5125, o_clerk_prf#5116 AS o_clerk_prf_1#5126, o_orderstatus_prf#5117 AS o_orderstatus_prf_1#5127, o_totalprice_prf#5118 AS o_totalprice_prf_1#5128, o_orderkey_prf#5119 AS o_orderkey_prf_1#5129, o_comment_prf#5120 AS o_comment_prf_1#5130]
            +- Relation[o_shippriority_prf#5111,rid#5112,o_orderdate_prf#5113,o_custkey_prf#5114,o_orderpriority_prf#5115,o_clerk_prf#5116,o_orderstatus_prf#5117,o_totalprice_prf#5118,o_orderkey_prf#5119,o_comment_prf#5120] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 108596ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/12 05:26:16 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:26:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5196L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 05:26:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5196L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [c_acctbal_prf#5198 AS c_acctbal_prf_0#5207, rid#5199 AS rid_0#5208, c_name_prf#5200 AS c_name_prf_0#5209, c_nationkey_prf#5201 AS c_nationkey_prf_0#5210, c_custkey_prf#5202 AS c_custkey_prf_0#5211, c_comment_prf#5203 AS c_comment_prf_0#5212, c_address_prf#5204 AS c_address_prf_0#5213, c_mktsegment_prf#5205 AS c_mktsegment_prf_0#5214, c_phone_prf#5206 AS c_phone_prf_0#5215]
         :  :  :  :  +- Relation[c_acctbal_prf#5198,rid#5199,c_name_prf#5200,c_nationkey_prf#5201,c_custkey_prf#5202,c_comment_prf#5203,c_address_prf#5204,c_mktsegment_prf#5205,c_phone_prf#5206] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5216, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5217]
         :  :  :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :  :  :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#5218 AS o_shippriority_prf_1#5228, rid#5219 AS rid_1#5229, o_orderdate_prf#5220 AS o_orderdate_prf_1#5230, o_custkey_prf#5221 AS o_custkey_prf_1#5231, o_orderpriority_prf#5222 AS o_orderpriority_prf_1#5232, o_clerk_prf#5223 AS o_clerk_prf_1#5233, o_orderstatus_prf#5224 AS o_orderstatus_prf_1#5234, o_totalprice_prf#5225 AS o_totalprice_prf_1#5235, o_orderkey_prf#5226 AS o_orderkey_prf_1#5236, o_comment_prf#5227 AS o_comment_prf_1#5237]
         :  :     +- Relation[o_shippriority_prf#5218,rid#5219,o_orderdate_prf#5220,o_custkey_prf#5221,o_orderpriority_prf#5222,o_clerk_prf#5223,o_orderstatus_prf#5224,o_totalprice_prf#5225,o_orderkey_prf#5226,o_comment_prf#5227] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#5238, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5239]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5240 AS l_returnflag_prf_2#5259, l_orderkey_and_l_linenumber_prf#5241 AS l_orderkey_and_l_linenumber_prf_2#5260, l_comment_prf#5242 AS l_comment_prf_2#5261, l_linestatus_prf#5243 AS l_linestatus_prf_2#5262, rid#5244 AS rid_2#5263, l_shipmode_prf#5245 AS l_shipmode_prf_2#5264, l_shipinstruct_prf#5246 AS l_shipinstruct_prf_2#5265, l_quantity_prf#5247 AS l_quantity_prf_2#5266, l_receiptdate_prf#5248 AS l_receiptdate_prf_2#5267, l_linenumber_prf#5249 AS l_linenumber_prf_2#5268, l_tax_prf#5250 AS l_tax_prf_2#5269, l_shipdate_prf#5251 AS l_shipdate_prf_2#5270, l_extendedprice_prf#5252 AS l_extendedprice_prf_2#5271, l_partkey_prf#5253 AS l_partkey_prf_2#5272, l_discount_prf#5254 AS l_discount_prf_2#5273, l_partkey_and_l_suppkey_prf#5255 AS l_partkey_and_l_suppkey_prf_2#5274, l_commitdate_prf#5256 AS l_commitdate_prf_2#5275, l_suppkey_prf#5257 AS l_suppkey_prf_2#5276, l_orderkey_prf#5258 AS l_orderkey_prf_2#5277]
            +- Relation[l_returnflag_prf#5240,l_orderkey_and_l_linenumber_prf#5241,l_comment_prf#5242,l_linestatus_prf#5243,rid#5244,l_shipmode_prf#5245,l_shipinstruct_prf#5246,l_quantity_prf#5247,l_receiptdate_prf#5248,l_linenumber_prf#5249,l_tax_prf#5250,l_shipdate_prf#5251,l_extendedprice_prf#5252,l_partkey_prf#5253,l_discount_prf#5254,l_partkey_and_l_suppkey_prf#5255,l_commitdate_prf#5256,l_suppkey_prf#5257,l_orderkey_prf#5258] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 168847ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/12 05:29:05 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 05:29:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5351L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 05:29:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5351L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [l_returnflag_prf#5353 AS l_returnflag_prf_0#5372, l_orderkey_and_l_linenumber_prf#5354 AS l_orderkey_and_l_linenumber_prf_0#5373, l_comment_prf#5355 AS l_comment_prf_0#5374, l_linestatus_prf#5356 AS l_linestatus_prf_0#5375, rid#5357 AS rid_0#5376, l_shipmode_prf#5358 AS l_shipmode_prf_0#5377, l_shipinstruct_prf#5359 AS l_shipinstruct_prf_0#5378, l_quantity_prf#5360 AS l_quantity_prf_0#5379, l_receiptdate_prf#5361 AS l_receiptdate_prf_0#5380, l_linenumber_prf#5362 AS l_linenumber_prf_0#5381, l_tax_prf#5363 AS l_tax_prf_0#5382, l_shipdate_prf#5364 AS l_shipdate_prf_0#5383, l_extendedprice_prf#5365 AS l_extendedprice_prf_0#5384, l_partkey_prf#5366 AS l_partkey_prf_0#5385, l_discount_prf#5367 AS l_discount_prf_0#5386, l_partkey_and_l_suppkey_prf#5368 AS l_partkey_and_l_suppkey_prf_0#5387, l_commitdate_prf#5369 AS l_commitdate_prf_0#5388, l_suppkey_prf#5370 AS l_suppkey_prf_0#5389, l_orderkey_prf#5371 AS l_orderkey_prf_0#5390]
         :  :  :  :  +- Relation[l_returnflag_prf#5353,l_orderkey_and_l_linenumber_prf#5354,l_comment_prf#5355,l_linestatus_prf#5356,rid#5357,l_shipmode_prf#5358,l_shipinstruct_prf#5359,l_quantity_prf#5360,l_receiptdate_prf#5361,l_linenumber_prf#5362,l_tax_prf#5363,l_shipdate_prf#5364,l_extendedprice_prf#5365,l_partkey_prf#5366,l_discount_prf#5367,l_partkey_and_l_suppkey_prf#5368,l_commitdate_prf#5369,l_suppkey_prf#5370,l_orderkey_prf#5371] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5391, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5392]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :  :  :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#5393 AS p_comment_prf_1#5403, p_name_prf#5394 AS p_name_prf_1#5404, rid#5395 AS rid_1#5405, p_type_prf#5396 AS p_type_prf_1#5406, p_retailprice_prf#5397 AS p_retailprice_prf_1#5407, p_mfgr_prf#5398 AS p_mfgr_prf_1#5408, p_container_prf#5399 AS p_container_prf_1#5409, p_brand_prf#5400 AS p_brand_prf_1#5410, p_size_prf#5401 AS p_size_prf_1#5411, p_partkey_prf#5402 AS p_partkey_prf_1#5412]
         :  :     +- Relation[p_comment_prf#5393,p_name_prf#5394,rid#5395,p_type_prf#5396,p_retailprice_prf#5397,p_mfgr_prf#5398,p_container_prf#5399,p_brand_prf#5400,p_size_prf#5401,p_partkey_prf#5402] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5413, dexdecrypt('value_dec_key, 'value_right) AS rid_2#5414]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1536,value_left#1537,value_right#1538] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#5415 AS s_phone_prf_2#5423, rid#5416 AS rid_2#5424, s_address_prf#5417 AS s_address_prf_2#5425, s_nationkey_prf#5418 AS s_nationkey_prf_2#5426, s_suppkey_prf#5419 AS s_suppkey_prf_2#5427, s_name_prf#5420 AS s_name_prf_2#5428, s_acctbal_prf#5421 AS s_acctbal_prf_2#5429, s_comment_prf#5422 AS s_comment_prf_2#5430]
            +- Relation[s_phone_prf#5415,rid#5416,s_address_prf#5417,s_nationkey_prf#5418,s_suppkey_prf#5419,s_name_prf#5420,s_acctbal_prf#5421,s_comment_prf#5422] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201186ms
query=b1a, count=15628, duration=10915
query=b1b, count=15628, duration=7765
query=b2a, count=1478870, duration=107543
query=b2b, count=1478870, duration=97428
query=f1, count=1, duration=57
query=f2, count=3907, duration=122
query=f3, count=1451, duration=98
query=f4, count=1, duration=57
query=f5, count=1478870, duration=23325
query=f6, count=857401, duration=21317
query=j1, count=800000, duration=12148
query=j10, count=6001215, duration=119142
query=j2, count=800000, duration=11671
query=j3, count=25, duration=67
query=j4, count=150000, duration=2515
query=j5, count=10000, duration=229
query=j6, count=6001215, duration=144287
query=j7, count=1500000, duration=23637
query=j8, count=6001215, duration=107055
query=j8b, count=6001215, duration=108596
query=j9, count=6001215, duration=94881
query=j9b, count=6001215, duration=186920
query=r1a, count=6001215, duration=183830
query=r1b, count=6001215, duration=182962
query=r1c, count=6001215, duration=182156
query=r1d, count=6001215, duration=168847
query=r1e, count=6001215, duration=169545
query=r1f, count=6001215, duration=201478
query=t1a, count=60000414, duration=908819
query=t1b, count=60000414, duration=893717
query=t1c, count=60000414, duration=904040
query=t2a, count=800000, duration=26097
query=t2b, count=800000, duration=34282
query=t2c, count=800000, duration=26270
query=t2d, count=800000, duration=26256
query=t3a, count=6001215, duration=201186
query=t3b, count=6001215, duration=201692
query=t3c, count=6001215, duration=201837
query=t3d, count=6001215, duration=201098
