19/10/12 10:09:45 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7097ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Oct 12 10:09:47 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Oct 12 10:09:48 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Oct 12 10:09:48 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Oct 12 10:09:48 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Oct 12 10:09:48 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Oct 12 10:09:51 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Oct 12 10:09:53 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Oct 12 10:09:53 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



f5=
select * from lineitem where l_returnflag = 'R'
19/10/12 10:09:54 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:09:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1487L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 10:09:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1487L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#1489 AS l_returnflag_prf_0#1508, l_orderkey_and_l_linenumber_prf#1490 AS l_orderkey_and_l_linenumber_prf_0#1509, l_comment_prf#1491 AS l_comment_prf_0#1510, l_linestatus_prf#1492 AS l_linestatus_prf_0#1511, rid#1493 AS rid_0#1512, l_shipmode_prf#1494 AS l_shipmode_prf_0#1513, l_shipinstruct_prf#1495 AS l_shipinstruct_prf_0#1514, l_quantity_prf#1496 AS l_quantity_prf_0#1515, l_receiptdate_prf#1497 AS l_receiptdate_prf_0#1516, l_linenumber_prf#1498 AS l_linenumber_prf_0#1517, l_tax_prf#1499 AS l_tax_prf_0#1518, l_shipdate_prf#1500 AS l_shipdate_prf_0#1519, l_extendedprice_prf#1501 AS l_extendedprice_prf_0#1520, l_partkey_prf#1502 AS l_partkey_prf_0#1521, l_discount_prf#1503 AS l_discount_prf_0#1522, l_partkey_and_l_suppkey_prf#1504 AS l_partkey_and_l_suppkey_prf_0#1523, l_commitdate_prf#1505 AS l_commitdate_prf_0#1524, l_suppkey_prf#1506 AS l_suppkey_prf_0#1525, l_orderkey_prf#1507 AS l_orderkey_prf_0#1526]
         :  +- Relation[l_returnflag_prf#1489,l_orderkey_and_l_linenumber_prf#1490,l_comment_prf#1491,l_linestatus_prf#1492,rid#1493,l_shipmode_prf#1494,l_shipinstruct_prf#1495,l_quantity_prf#1496,l_receiptdate_prf#1497,l_linenumber_prf#1498,l_tax_prf#1499,l_shipdate_prf#1500,l_extendedprice_prf#1501,l_partkey_prf#1502,l_discount_prf#1503,l_partkey_and_l_suppkey_prf#1504,l_commitdate_prf#1505,l_suppkey_prf#1506,l_orderkey_prf#1507] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1529]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 23499ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/12 10:10:18 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:10:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1573L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 10:10:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1573L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [ps_partkey_and_ps_suppkey_prf#1575 AS ps_partkey_and_ps_suppkey_prf_0#1582, rid#1576 AS rid_0#1583, ps_availqty_prf#1577 AS ps_availqty_prf_0#1584, ps_comment_prf#1578 AS ps_comment_prf_0#1585, ps_partkey_prf#1579 AS ps_partkey_prf_0#1586, ps_supplycost_prf#1580 AS ps_supplycost_prf_0#1587, ps_suppkey_prf#1581 AS ps_suppkey_prf_0#1588]
         :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#1575,rid#1576,ps_availqty_prf#1577,ps_comment_prf#1578,ps_partkey_prf#1579,ps_supplycost_prf#1580,ps_suppkey_prf#1581] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1592, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1593]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey_and_l_suppkey~partsupp~ps_partkey_and_ps_suppkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1594 AS l_returnflag_prf_1#1613, l_orderkey_and_l_linenumber_prf#1595 AS l_orderkey_and_l_linenumber_prf_1#1614, l_comment_prf#1596 AS l_comment_prf_1#1615, l_linestatus_prf#1597 AS l_linestatus_prf_1#1616, rid#1598 AS rid_1#1617, l_shipmode_prf#1599 AS l_shipmode_prf_1#1618, l_shipinstruct_prf#1600 AS l_shipinstruct_prf_1#1619, l_quantity_prf#1601 AS l_quantity_prf_1#1620, l_receiptdate_prf#1602 AS l_receiptdate_prf_1#1621, l_linenumber_prf#1603 AS l_linenumber_prf_1#1622, l_tax_prf#1604 AS l_tax_prf_1#1623, l_shipdate_prf#1605 AS l_shipdate_prf_1#1624, l_extendedprice_prf#1606 AS l_extendedprice_prf_1#1625, l_partkey_prf#1607 AS l_partkey_prf_1#1626, l_discount_prf#1608 AS l_discount_prf_1#1627, l_partkey_and_l_suppkey_prf#1609 AS l_partkey_and_l_suppkey_prf_1#1628, l_commitdate_prf#1610 AS l_commitdate_prf_1#1629, l_suppkey_prf#1611 AS l_suppkey_prf_1#1630, l_orderkey_prf#1612 AS l_orderkey_prf_1#1631]
            +- Relation[l_returnflag_prf#1594,l_orderkey_and_l_linenumber_prf#1595,l_comment_prf#1596,l_linestatus_prf#1597,rid#1598,l_shipmode_prf#1599,l_shipinstruct_prf#1600,l_quantity_prf#1601,l_receiptdate_prf#1602,l_linenumber_prf#1603,l_tax_prf#1604,l_shipdate_prf#1605,l_extendedprice_prf#1606,l_partkey_prf#1607,l_discount_prf#1608,l_partkey_and_l_suppkey_prf#1609,l_commitdate_prf#1610,l_suppkey_prf#1611,l_orderkey_prf#1612] JDBCRelation(lineitem_prf) [numPartitions=1]

19/10/12 10:10:18 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexSpx$ result size=6001215
Elapsed time: 105767ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/12 10:12:04 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:12:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1677L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 10:12:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1677L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#1679 AS l_returnflag_prf_0#1698, l_orderkey_and_l_linenumber_prf#1680 AS l_orderkey_and_l_linenumber_prf_0#1699, l_comment_prf#1681 AS l_comment_prf_0#1700, l_linestatus_prf#1682 AS l_linestatus_prf_0#1701, rid#1683 AS rid_0#1702, l_shipmode_prf#1684 AS l_shipmode_prf_0#1703, l_shipinstruct_prf#1685 AS l_shipinstruct_prf_0#1704, l_quantity_prf#1686 AS l_quantity_prf_0#1705, l_receiptdate_prf#1687 AS l_receiptdate_prf_0#1706, l_linenumber_prf#1688 AS l_linenumber_prf_0#1707, l_tax_prf#1689 AS l_tax_prf_0#1708, l_shipdate_prf#1690 AS l_shipdate_prf_0#1709, l_extendedprice_prf#1691 AS l_extendedprice_prf_0#1710, l_partkey_prf#1692 AS l_partkey_prf_0#1711, l_discount_prf#1693 AS l_discount_prf_0#1712, l_partkey_and_l_suppkey_prf#1694 AS l_partkey_and_l_suppkey_prf_0#1713, l_commitdate_prf#1695 AS l_commitdate_prf_0#1714, l_suppkey_prf#1696 AS l_suppkey_prf_0#1715, l_orderkey_prf#1697 AS l_orderkey_prf_0#1716]
         :  +- Relation[l_returnflag_prf#1679,l_orderkey_and_l_linenumber_prf#1680,l_comment_prf#1681,l_linestatus_prf#1682,rid#1683,l_shipmode_prf#1684,l_shipinstruct_prf#1685,l_quantity_prf#1686,l_receiptdate_prf#1687,l_linenumber_prf#1688,l_tax_prf#1689,l_shipdate_prf#1690,l_extendedprice_prf#1691,l_partkey_prf#1692,l_discount_prf#1693,l_partkey_and_l_suppkey_prf#1694,l_commitdate_prf#1695,l_suppkey_prf#1696,l_orderkey_prf#1697] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1717]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=857401
Elapsed time: 13721ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/12 10:12:17 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:12:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1744L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 10:12:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1744L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#1746 AS rid_0#1751, n_regionkey_prf#1747 AS n_regionkey_prf_0#1752, n_nationkey_prf#1748 AS n_nationkey_prf_0#1753, n_name_prf#1749 AS n_name_prf_0#1754, n_comment_prf#1750 AS n_comment_prf_0#1755]
         :  +- Relation[rid#1746,n_regionkey_prf#1747,n_nationkey_prf#1748,n_name_prf#1749,n_comment_prf#1750] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1756]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1
Elapsed time: 60ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/12 10:12:17 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:12:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1777L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 10:12:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1777L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#1779 AS s_phone_prf_0#1787, rid#1780 AS rid_0#1788, s_address_prf#1781 AS s_address_prf_0#1789, s_nationkey_prf#1782 AS s_nationkey_prf_0#1790, s_suppkey_prf#1783 AS s_suppkey_prf_0#1791, s_name_prf#1784 AS s_name_prf_0#1792, s_acctbal_prf#1785 AS s_acctbal_prf_0#1793, s_comment_prf#1786 AS s_comment_prf_0#1794]
         :  :  +- Relation[s_phone_prf#1779,rid#1780,s_address_prf#1781,s_nationkey_prf#1782,s_suppkey_prf#1783,s_name_prf#1784,s_acctbal_prf#1785,s_comment_prf#1786] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1795, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1796]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#1797 AS ps_partkey_and_ps_suppkey_prf_1#1804, rid#1798 AS rid_1#1805, ps_availqty_prf#1799 AS ps_availqty_prf_1#1806, ps_comment_prf#1800 AS ps_comment_prf_1#1807, ps_partkey_prf#1801 AS ps_partkey_prf_1#1808, ps_supplycost_prf#1802 AS ps_supplycost_prf_1#1809, ps_suppkey_prf#1803 AS ps_suppkey_prf_1#1810]
            +- Relation[ps_partkey_and_ps_suppkey_prf#1797,rid#1798,ps_availqty_prf#1799,ps_comment_prf#1800,ps_partkey_prf#1801,ps_supplycost_prf#1802,ps_suppkey_prf#1803] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 11794ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/12 10:12:29 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:12:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1850L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 10:12:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1850L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#1852 AS s_phone_prf_0#1860, rid#1853 AS rid_0#1861, s_address_prf#1854 AS s_address_prf_0#1862, s_nationkey_prf#1855 AS s_nationkey_prf_0#1863, s_suppkey_prf#1856 AS s_suppkey_prf_0#1864, s_name_prf#1857 AS s_name_prf_0#1865, s_acctbal_prf#1858 AS s_acctbal_prf_0#1866, s_comment_prf#1859 AS s_comment_prf_0#1867]
         :  :  +- Relation[s_phone_prf#1852,rid#1853,s_address_prf#1854,s_nationkey_prf#1855,s_suppkey_prf#1856,s_name_prf#1857,s_acctbal_prf#1858,s_comment_prf#1859] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#1868, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1869]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [p_comment_prf#1870 AS p_comment_prf_1#1880, p_name_prf#1871 AS p_name_prf_1#1881, rid#1872 AS rid_1#1882, p_type_prf#1873 AS p_type_prf_1#1883, p_retailprice_prf#1874 AS p_retailprice_prf_1#1884, p_mfgr_prf#1875 AS p_mfgr_prf_1#1885, p_container_prf#1876 AS p_container_prf_1#1886, p_brand_prf#1877 AS p_brand_prf_1#1887, p_size_prf#1878 AS p_size_prf_1#1888, p_partkey_prf#1879 AS p_partkey_prf_1#1889]
            :  :  +- Relation[p_comment_prf#1870,p_name_prf#1871,rid#1872,p_type_prf#1873,p_retailprice_prf#1874,p_mfgr_prf#1875,p_container_prf#1876,p_brand_prf#1877,p_size_prf#1878,p_partkey_prf#1879] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1890, dexdecrypt('value_dec_key, 'value_right) AS rid_2#1891]
            :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
            :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#1892 AS ps_partkey_and_ps_suppkey_prf_2#1899, rid#1893 AS rid_2#1900, ps_availqty_prf#1894 AS ps_availqty_prf_2#1901, ps_comment_prf#1895 AS ps_comment_prf_2#1902, ps_partkey_prf#1896 AS ps_partkey_prf_2#1903, ps_supplycost_prf#1897 AS ps_supplycost_prf_2#1904, ps_suppkey_prf#1898 AS ps_suppkey_prf_2#1905]
               +- Relation[ps_partkey_and_ps_suppkey_prf#1892,rid#1893,ps_availqty_prf#1894,ps_comment_prf#1895,ps_partkey_prf#1896,ps_supplycost_prf#1897,ps_suppkey_prf#1898] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26199ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/12 10:12:55 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:12:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1967L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 10:12:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1967L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [l_returnflag_prf#1969 AS l_returnflag_prf_0#1988, l_orderkey_and_l_linenumber_prf#1970 AS l_orderkey_and_l_linenumber_prf_0#1989, l_comment_prf#1971 AS l_comment_prf_0#1990, l_linestatus_prf#1972 AS l_linestatus_prf_0#1991, rid#1973 AS rid_0#1992, l_shipmode_prf#1974 AS l_shipmode_prf_0#1993, l_shipinstruct_prf#1975 AS l_shipinstruct_prf_0#1994, l_quantity_prf#1976 AS l_quantity_prf_0#1995, l_receiptdate_prf#1977 AS l_receiptdate_prf_0#1996, l_linenumber_prf#1978 AS l_linenumber_prf_0#1997, l_tax_prf#1979 AS l_tax_prf_0#1998, l_shipdate_prf#1980 AS l_shipdate_prf_0#1999, l_extendedprice_prf#1981 AS l_extendedprice_prf_0#2000, l_partkey_prf#1982 AS l_partkey_prf_0#2001, l_discount_prf#1983 AS l_discount_prf_0#2002, l_partkey_and_l_suppkey_prf#1984 AS l_partkey_and_l_suppkey_prf_0#2003, l_commitdate_prf#1985 AS l_commitdate_prf_0#2004, l_suppkey_prf#1986 AS l_suppkey_prf_0#2005, l_orderkey_prf#1987 AS l_orderkey_prf_0#2006]
         :  :  :  :  +- Relation[l_returnflag_prf#1969,l_orderkey_and_l_linenumber_prf#1970,l_comment_prf#1971,l_linestatus_prf#1972,rid#1973,l_shipmode_prf#1974,l_shipinstruct_prf#1975,l_quantity_prf#1976,l_receiptdate_prf#1977,l_linenumber_prf#1978,l_tax_prf#1979,l_shipdate_prf#1980,l_extendedprice_prf#1981,l_partkey_prf#1982,l_discount_prf#1983,l_partkey_and_l_suppkey_prf#1984,l_commitdate_prf#1985,l_suppkey_prf#1986,l_orderkey_prf#1987] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2007, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2008]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :  :  :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#2009 AS o_shippriority_prf_1#2019, rid#2010 AS rid_1#2020, o_orderdate_prf#2011 AS o_orderdate_prf_1#2021, o_custkey_prf#2012 AS o_custkey_prf_1#2022, o_orderpriority_prf#2013 AS o_orderpriority_prf_1#2023, o_clerk_prf#2014 AS o_clerk_prf_1#2024, o_orderstatus_prf#2015 AS o_orderstatus_prf_1#2025, o_totalprice_prf#2016 AS o_totalprice_prf_1#2026, o_orderkey_prf#2017 AS o_orderkey_prf_1#2027, o_comment_prf#2018 AS o_comment_prf_1#2028]
         :  :     +- Relation[o_shippriority_prf#2009,rid#2010,o_orderdate_prf#2011,o_custkey_prf#2012,o_orderpriority_prf#2013,o_clerk_prf#2014,o_orderstatus_prf#2015,o_totalprice_prf#2016,o_orderkey_prf#2017,o_comment_prf#2018] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2029, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2030]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2031 AS c_acctbal_prf_2#2040, rid#2032 AS rid_2#2041, c_name_prf#2033 AS c_name_prf_2#2042, c_nationkey_prf#2034 AS c_nationkey_prf_2#2043, c_custkey_prf#2035 AS c_custkey_prf_2#2044, c_comment_prf#2036 AS c_comment_prf_2#2045, c_address_prf#2037 AS c_address_prf_2#2046, c_mktsegment_prf#2038 AS c_mktsegment_prf_2#2047, c_phone_prf#2039 AS c_phone_prf_2#2048]
            +- Relation[c_acctbal_prf#2031,rid#2032,c_name_prf#2033,c_nationkey_prf#2034,c_custkey_prf#2035,c_comment_prf#2036,c_address_prf#2037,c_mktsegment_prf#2038,c_phone_prf#2039] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 183910ms

f2=
select * from part where p_size = 15
19/10/12 10:15:59 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:15:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2099L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 10:15:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2099L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#2101 AS p_comment_prf_0#2111, p_name_prf#2102 AS p_name_prf_0#2112, rid#2103 AS rid_0#2113, p_type_prf#2104 AS p_type_prf_0#2114, p_retailprice_prf#2105 AS p_retailprice_prf_0#2115, p_mfgr_prf#2106 AS p_mfgr_prf_0#2116, p_container_prf#2107 AS p_container_prf_0#2117, p_brand_prf#2108 AS p_brand_prf_0#2118, p_size_prf#2109 AS p_size_prf_0#2119, p_partkey_prf#2110 AS p_partkey_prf_0#2120]
         :  +- Relation[p_comment_prf#2101,p_name_prf#2102,rid#2103,p_type_prf#2104,p_retailprice_prf#2105,p_mfgr_prf#2106,p_container_prf#2107,p_brand_prf#2108,p_size_prf#2109,p_partkey_prf#2110] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2121]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=3907
Elapsed time: 127ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/12 10:15:59 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:15:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2156L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 10:15:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2156L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#2158 AS s_phone_prf_0#2166, rid#2159 AS rid_0#2167, s_address_prf#2160 AS s_address_prf_0#2168, s_nationkey_prf#2161 AS s_nationkey_prf_0#2169, s_suppkey_prf#2162 AS s_suppkey_prf_0#2170, s_name_prf#2163 AS s_name_prf_0#2171, s_acctbal_prf#2164 AS s_acctbal_prf_0#2172, s_comment_prf#2165 AS s_comment_prf_0#2173]
         :  :  +- Relation[s_phone_prf#2158,rid#2159,s_address_prf#2160,s_nationkey_prf#2161,s_suppkey_prf#2162,s_name_prf#2163,s_acctbal_prf#2164,s_comment_prf#2165] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2174, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2175]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [ps_partkey_and_ps_suppkey_prf#2176 AS ps_partkey_and_ps_suppkey_prf_1#2183, rid#2177 AS rid_1#2184, ps_availqty_prf#2178 AS ps_availqty_prf_1#2185, ps_comment_prf#2179 AS ps_comment_prf_1#2186, ps_partkey_prf#2180 AS ps_partkey_prf_1#2187, ps_supplycost_prf#2181 AS ps_supplycost_prf_1#2188, ps_suppkey_prf#2182 AS ps_suppkey_prf_1#2189]
            :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#2176,rid#2177,ps_availqty_prf#2178,ps_comment_prf#2179,ps_partkey_prf#2180,ps_supplycost_prf#2181,ps_suppkey_prf#2182] JDBCRelation(partsupp_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2190, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2191]
            :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
            :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [p_comment_prf#2192 AS p_comment_prf_2#2202, p_name_prf#2193 AS p_name_prf_2#2203, rid#2194 AS rid_2#2204, p_type_prf#2195 AS p_type_prf_2#2205, p_retailprice_prf#2196 AS p_retailprice_prf_2#2206, p_mfgr_prf#2197 AS p_mfgr_prf_2#2207, p_container_prf#2198 AS p_container_prf_2#2208, p_brand_prf#2199 AS p_brand_prf_2#2209, p_size_prf#2200 AS p_size_prf_2#2210, p_partkey_prf#2201 AS p_partkey_prf_2#2211]
               +- Relation[p_comment_prf#2192,p_name_prf#2193,rid#2194,p_type_prf#2195,p_retailprice_prf#2196,p_mfgr_prf#2197,p_container_prf#2198,p_brand_prf#2199,p_size_prf#2200,p_partkey_prf#2201] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26117ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/12 10:16:25 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:16:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2272L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 10:16:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2272L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [l_returnflag_prf#2274 AS l_returnflag_prf_0#2293, l_orderkey_and_l_linenumber_prf#2275 AS l_orderkey_and_l_linenumber_prf_0#2294, l_comment_prf#2276 AS l_comment_prf_0#2295, l_linestatus_prf#2277 AS l_linestatus_prf_0#2296, rid#2278 AS rid_0#2297, l_shipmode_prf#2279 AS l_shipmode_prf_0#2298, l_shipinstruct_prf#2280 AS l_shipinstruct_prf_0#2299, l_quantity_prf#2281 AS l_quantity_prf_0#2300, l_receiptdate_prf#2282 AS l_receiptdate_prf_0#2301, l_linenumber_prf#2283 AS l_linenumber_prf_0#2302, l_tax_prf#2284 AS l_tax_prf_0#2303, l_shipdate_prf#2285 AS l_shipdate_prf_0#2304, l_extendedprice_prf#2286 AS l_extendedprice_prf_0#2305, l_partkey_prf#2287 AS l_partkey_prf_0#2306, l_discount_prf#2288 AS l_discount_prf_0#2307, l_partkey_and_l_suppkey_prf#2289 AS l_partkey_and_l_suppkey_prf_0#2308, l_commitdate_prf#2290 AS l_commitdate_prf_0#2309, l_suppkey_prf#2291 AS l_suppkey_prf_0#2310, l_orderkey_prf#2292 AS l_orderkey_prf_0#2311]
         :  :  :  :  +- Relation[l_returnflag_prf#2274,l_orderkey_and_l_linenumber_prf#2275,l_comment_prf#2276,l_linestatus_prf#2277,rid#2278,l_shipmode_prf#2279,l_shipinstruct_prf#2280,l_quantity_prf#2281,l_receiptdate_prf#2282,l_linenumber_prf#2283,l_tax_prf#2284,l_shipdate_prf#2285,l_extendedprice_prf#2286,l_partkey_prf#2287,l_discount_prf#2288,l_partkey_and_l_suppkey_prf#2289,l_commitdate_prf#2290,l_suppkey_prf#2291,l_orderkey_prf#2292] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2312, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2313]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :  :  :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#2314 AS p_comment_prf_1#2324, p_name_prf#2315 AS p_name_prf_1#2325, rid#2316 AS rid_1#2326, p_type_prf#2317 AS p_type_prf_1#2327, p_retailprice_prf#2318 AS p_retailprice_prf_1#2328, p_mfgr_prf#2319 AS p_mfgr_prf_1#2329, p_container_prf#2320 AS p_container_prf_1#2330, p_brand_prf#2321 AS p_brand_prf_1#2331, p_size_prf#2322 AS p_size_prf_1#2332, p_partkey_prf#2323 AS p_partkey_prf_1#2333]
         :  :     +- Relation[p_comment_prf#2314,p_name_prf#2315,rid#2316,p_type_prf#2317,p_retailprice_prf#2318,p_mfgr_prf#2319,p_container_prf#2320,p_brand_prf#2321,p_size_prf#2322,p_partkey_prf#2323] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2334, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2335]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#2336 AS s_phone_prf_2#2344, rid#2337 AS rid_2#2345, s_address_prf#2338 AS s_address_prf_2#2346, s_nationkey_prf#2339 AS s_nationkey_prf_2#2347, s_suppkey_prf#2340 AS s_suppkey_prf_2#2348, s_name_prf#2341 AS s_name_prf_2#2349, s_acctbal_prf#2342 AS s_acctbal_prf_2#2350, s_comment_prf#2343 AS s_comment_prf_2#2351]
            +- Relation[s_phone_prf#2336,rid#2337,s_address_prf#2338,s_nationkey_prf#2339,s_suppkey_prf#2340,s_name_prf#2341,s_acctbal_prf#2342,s_comment_prf#2343] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201942ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/12 10:19:47 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:19:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2417L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 10:19:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2417L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#2419 AS l_returnflag_prf_0#2438, l_orderkey_and_l_linenumber_prf#2420 AS l_orderkey_and_l_linenumber_prf_0#2439, l_comment_prf#2421 AS l_comment_prf_0#2440, l_linestatus_prf#2422 AS l_linestatus_prf_0#2441, rid#2423 AS rid_0#2442, l_shipmode_prf#2424 AS l_shipmode_prf_0#2443, l_shipinstruct_prf#2425 AS l_shipinstruct_prf_0#2444, l_quantity_prf#2426 AS l_quantity_prf_0#2445, l_receiptdate_prf#2427 AS l_receiptdate_prf_0#2446, l_linenumber_prf#2428 AS l_linenumber_prf_0#2447, l_tax_prf#2429 AS l_tax_prf_0#2448, l_shipdate_prf#2430 AS l_shipdate_prf_0#2449, l_extendedprice_prf#2431 AS l_extendedprice_prf_0#2450, l_partkey_prf#2432 AS l_partkey_prf_0#2451, l_discount_prf#2433 AS l_discount_prf_0#2452, l_partkey_and_l_suppkey_prf#2434 AS l_partkey_and_l_suppkey_prf_0#2453, l_commitdate_prf#2435 AS l_commitdate_prf_0#2454, l_suppkey_prf#2436 AS l_suppkey_prf_0#2455, l_orderkey_prf#2437 AS l_orderkey_prf_0#2456]
         :  :  +- Relation[l_returnflag_prf#2419,l_orderkey_and_l_linenumber_prf#2420,l_comment_prf#2421,l_linestatus_prf#2422,rid#2423,l_shipmode_prf#2424,l_shipinstruct_prf#2425,l_quantity_prf#2426,l_receiptdate_prf#2427,l_linenumber_prf#2428,l_tax_prf#2429,l_shipdate_prf#2430,l_extendedprice_prf#2431,l_partkey_prf#2432,l_discount_prf#2433,l_partkey_and_l_suppkey_prf#2434,l_commitdate_prf#2435,l_suppkey_prf#2436,l_orderkey_prf#2437] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2457, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2458]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [p_comment_prf#2459 AS p_comment_prf_1#2469, p_name_prf#2460 AS p_name_prf_1#2470, rid#2461 AS rid_1#2471, p_type_prf#2462 AS p_type_prf_1#2472, p_retailprice_prf#2463 AS p_retailprice_prf_1#2473, p_mfgr_prf#2464 AS p_mfgr_prf_1#2474, p_container_prf#2465 AS p_container_prf_1#2475, p_brand_prf#2466 AS p_brand_prf_1#2476, p_size_prf#2467 AS p_size_prf_1#2477, p_partkey_prf#2468 AS p_partkey_prf_1#2478]
            +- Relation[p_comment_prf#2459,p_name_prf#2460,rid#2461,p_type_prf#2462,p_retailprice_prf#2463,p_mfgr_prf#2464,p_container_prf#2465,p_brand_prf#2466,p_size_prf#2467,p_partkey_prf#2468] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 95486ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/12 10:21:23 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:21:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2543L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 10:21:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2543L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#2545 AS s_phone_prf_0#2553, rid#2546 AS rid_0#2554, s_address_prf#2547 AS s_address_prf_0#2555, s_nationkey_prf#2548 AS s_nationkey_prf_0#2556, s_suppkey_prf#2549 AS s_suppkey_prf_0#2557, s_name_prf#2550 AS s_name_prf_0#2558, s_acctbal_prf#2551 AS s_acctbal_prf_0#2559, s_comment_prf#2552 AS s_comment_prf_0#2560]
         :  :  +- Relation[s_phone_prf#2545,rid#2546,s_address_prf#2547,s_nationkey_prf#2548,s_suppkey_prf#2549,s_name_prf#2550,s_acctbal_prf#2551,s_comment_prf#2552] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2561, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2562]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [l_returnflag_prf#2563 AS l_returnflag_prf_1#2582, l_orderkey_and_l_linenumber_prf#2564 AS l_orderkey_and_l_linenumber_prf_1#2583, l_comment_prf#2565 AS l_comment_prf_1#2584, l_linestatus_prf#2566 AS l_linestatus_prf_1#2585, rid#2567 AS rid_1#2586, l_shipmode_prf#2568 AS l_shipmode_prf_1#2587, l_shipinstruct_prf#2569 AS l_shipinstruct_prf_1#2588, l_quantity_prf#2570 AS l_quantity_prf_1#2589, l_receiptdate_prf#2571 AS l_receiptdate_prf_1#2590, l_linenumber_prf#2572 AS l_linenumber_prf_1#2591, l_tax_prf#2573 AS l_tax_prf_1#2592, l_shipdate_prf#2574 AS l_shipdate_prf_1#2593, l_extendedprice_prf#2575 AS l_extendedprice_prf_1#2594, l_partkey_prf#2576 AS l_partkey_prf_1#2595, l_discount_prf#2577 AS l_discount_prf_1#2596, l_partkey_and_l_suppkey_prf#2578 AS l_partkey_and_l_suppkey_prf_1#2597, l_commitdate_prf#2579 AS l_commitdate_prf_1#2598, l_suppkey_prf#2580 AS l_suppkey_prf_1#2599, l_orderkey_prf#2581 AS l_orderkey_prf_1#2600]
            :  :  +- Relation[l_returnflag_prf#2563,l_orderkey_and_l_linenumber_prf#2564,l_comment_prf#2565,l_linestatus_prf#2566,rid#2567,l_shipmode_prf#2568,l_shipinstruct_prf#2569,l_quantity_prf#2570,l_receiptdate_prf#2571,l_linenumber_prf#2572,l_tax_prf#2573,l_shipdate_prf#2574,l_extendedprice_prf#2575,l_partkey_prf#2576,l_discount_prf#2577,l_partkey_and_l_suppkey_prf#2578,l_commitdate_prf#2579,l_suppkey_prf#2580,l_orderkey_prf#2581] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2601, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2602]
            :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
            :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [p_comment_prf#2603 AS p_comment_prf_2#2613, p_name_prf#2604 AS p_name_prf_2#2614, rid#2605 AS rid_2#2615, p_type_prf#2606 AS p_type_prf_2#2616, p_retailprice_prf#2607 AS p_retailprice_prf_2#2617, p_mfgr_prf#2608 AS p_mfgr_prf_2#2618, p_container_prf#2609 AS p_container_prf_2#2619, p_brand_prf#2610 AS p_brand_prf_2#2620, p_size_prf#2611 AS p_size_prf_2#2621, p_partkey_prf#2612 AS p_partkey_prf_2#2622]
               +- Relation[p_comment_prf#2603,p_name_prf#2604,rid#2605,p_type_prf#2606,p_retailprice_prf#2607,p_mfgr_prf#2608,p_container_prf#2609,p_brand_prf#2610,p_size_prf#2611,p_partkey_prf#2612] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 200583ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/12 10:24:43 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:24:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2674L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 10:24:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2674L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [rid#2676 AS rid_0#2681, n_regionkey_prf#2677 AS n_regionkey_prf_0#2682, n_nationkey_prf#2678 AS n_nationkey_prf_0#2683, n_name_prf#2679 AS n_name_prf_0#2684, n_comment_prf#2680 AS n_comment_prf_0#2685]
         :  :  +- Relation[rid#2676,n_regionkey_prf#2677,n_nationkey_prf#2678,n_name_prf#2679,n_comment_prf#2680] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2686, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2687]
         :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#2688 AS s_phone_prf_1#2696, rid#2689 AS rid_1#2697, s_address_prf#2690 AS s_address_prf_1#2698, s_nationkey_prf#2691 AS s_nationkey_prf_1#2699, s_suppkey_prf#2692 AS s_suppkey_prf_1#2700, s_name_prf#2693 AS s_name_prf_1#2701, s_acctbal_prf#2694 AS s_acctbal_prf_1#2702, s_comment_prf#2695 AS s_comment_prf_1#2703]
            +- Relation[s_phone_prf#2688,rid#2689,s_address_prf#2690,s_nationkey_prf#2691,s_suppkey_prf#2692,s_name_prf#2693,s_acctbal_prf#2694,s_comment_prf#2695] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=10000
Elapsed time: 230ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/12 10:24:44 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:24:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2753L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 10:24:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2753L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#2755 AS c_acctbal_prf_0#2764, rid#2756 AS rid_0#2765, c_name_prf#2757 AS c_name_prf_0#2766, c_nationkey_prf#2758 AS c_nationkey_prf_0#2767, c_custkey_prf#2759 AS c_custkey_prf_0#2768, c_comment_prf#2760 AS c_comment_prf_0#2769, c_address_prf#2761 AS c_address_prf_0#2770, c_mktsegment_prf#2762 AS c_mktsegment_prf_0#2771, c_phone_prf#2763 AS c_phone_prf_0#2772]
         :  :  +- Relation[c_acctbal_prf#2755,rid#2756,c_name_prf#2757,c_nationkey_prf#2758,c_custkey_prf#2759,c_comment_prf#2760,c_address_prf#2761,c_mktsegment_prf#2762,c_phone_prf#2763] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2773, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2774]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [l_returnflag_prf#2775 AS l_returnflag_prf_1#2794, l_orderkey_and_l_linenumber_prf#2776 AS l_orderkey_and_l_linenumber_prf_1#2795, l_comment_prf#2777 AS l_comment_prf_1#2796, l_linestatus_prf#2778 AS l_linestatus_prf_1#2797, rid#2779 AS rid_1#2798, l_shipmode_prf#2780 AS l_shipmode_prf_1#2799, l_shipinstruct_prf#2781 AS l_shipinstruct_prf_1#2800, l_quantity_prf#2782 AS l_quantity_prf_1#2801, l_receiptdate_prf#2783 AS l_receiptdate_prf_1#2802, l_linenumber_prf#2784 AS l_linenumber_prf_1#2803, l_tax_prf#2785 AS l_tax_prf_1#2804, l_shipdate_prf#2786 AS l_shipdate_prf_1#2805, l_extendedprice_prf#2787 AS l_extendedprice_prf_1#2806, l_partkey_prf#2788 AS l_partkey_prf_1#2807, l_discount_prf#2789 AS l_discount_prf_1#2808, l_partkey_and_l_suppkey_prf#2790 AS l_partkey_and_l_suppkey_prf_1#2809, l_commitdate_prf#2791 AS l_commitdate_prf_1#2810, l_suppkey_prf#2792 AS l_suppkey_prf_1#2811, l_orderkey_prf#2793 AS l_orderkey_prf_1#2812]
            :  :  +- Relation[l_returnflag_prf#2775,l_orderkey_and_l_linenumber_prf#2776,l_comment_prf#2777,l_linestatus_prf#2778,rid#2779,l_shipmode_prf#2780,l_shipinstruct_prf#2781,l_quantity_prf#2782,l_receiptdate_prf#2783,l_linenumber_prf#2784,l_tax_prf#2785,l_shipdate_prf#2786,l_extendedprice_prf#2787,l_partkey_prf#2788,l_discount_prf#2789,l_partkey_and_l_suppkey_prf#2790,l_commitdate_prf#2791,l_suppkey_prf#2792,l_orderkey_prf#2793] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2813, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2814]
            :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
            :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2815 AS o_shippriority_prf_2#2825, rid#2816 AS rid_2#2826, o_orderdate_prf#2817 AS o_orderdate_prf_2#2827, o_custkey_prf#2818 AS o_custkey_prf_2#2828, o_orderpriority_prf#2819 AS o_orderpriority_prf_2#2829, o_clerk_prf#2820 AS o_clerk_prf_2#2830, o_orderstatus_prf#2821 AS o_orderstatus_prf_2#2831, o_totalprice_prf#2822 AS o_totalprice_prf_2#2832, o_orderkey_prf#2823 AS o_orderkey_prf_2#2833, o_comment_prf#2824 AS o_comment_prf_2#2834]
               +- Relation[o_shippriority_prf#2815,rid#2816,o_orderdate_prf#2817,o_custkey_prf#2818,o_orderpriority_prf#2819,o_clerk_prf#2820,o_orderstatus_prf#2821,o_totalprice_prf#2822,o_orderkey_prf#2823,o_comment_prf#2824] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 142933ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/12 10:27:07 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:27:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2888L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 10:27:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2888L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [rid#2890 AS rid_0#2895, n_regionkey_prf#2891 AS n_regionkey_prf_0#2896, n_nationkey_prf#2892 AS n_nationkey_prf_0#2897, n_name_prf#2893 AS n_name_prf_0#2898, n_comment_prf#2894 AS n_comment_prf_0#2899]
         :  :  +- Relation[rid#2890,n_regionkey_prf#2891,n_nationkey_prf#2892,n_name_prf#2893,n_comment_prf#2894] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2900, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2901]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2902 AS c_acctbal_prf_1#2911, rid#2903 AS rid_1#2912, c_name_prf#2904 AS c_name_prf_1#2913, c_nationkey_prf#2905 AS c_nationkey_prf_1#2914, c_custkey_prf#2906 AS c_custkey_prf_1#2915, c_comment_prf#2907 AS c_comment_prf_1#2916, c_address_prf#2908 AS c_address_prf_1#2917, c_mktsegment_prf#2909 AS c_mktsegment_prf_1#2918, c_phone_prf#2910 AS c_phone_prf_1#2919]
            +- Relation[c_acctbal_prf#2902,rid#2903,c_name_prf#2904,c_nationkey_prf#2905,c_custkey_prf#2906,c_comment_prf#2907,c_address_prf#2908,c_mktsegment_prf#2909,c_phone_prf#2910] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=150000
Elapsed time: 2528ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/12 10:27:09 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:27:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2962L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 10:27:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2962L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [l_returnflag_prf#2964 AS l_returnflag_prf_0#2983, l_orderkey_and_l_linenumber_prf#2965 AS l_orderkey_and_l_linenumber_prf_0#2984, l_comment_prf#2966 AS l_comment_prf_0#2985, l_linestatus_prf#2967 AS l_linestatus_prf_0#2986, rid#2968 AS rid_0#2987, l_shipmode_prf#2969 AS l_shipmode_prf_0#2988, l_shipinstruct_prf#2970 AS l_shipinstruct_prf_0#2989, l_quantity_prf#2971 AS l_quantity_prf_0#2990, l_receiptdate_prf#2972 AS l_receiptdate_prf_0#2991, l_linenumber_prf#2973 AS l_linenumber_prf_0#2992, l_tax_prf#2974 AS l_tax_prf_0#2993, l_shipdate_prf#2975 AS l_shipdate_prf_0#2994, l_extendedprice_prf#2976 AS l_extendedprice_prf_0#2995, l_partkey_prf#2977 AS l_partkey_prf_0#2996, l_discount_prf#2978 AS l_discount_prf_0#2997, l_partkey_and_l_suppkey_prf#2979 AS l_partkey_and_l_suppkey_prf_0#2998, l_commitdate_prf#2980 AS l_commitdate_prf_0#2999, l_suppkey_prf#2981 AS l_suppkey_prf_0#3000, l_orderkey_prf#2982 AS l_orderkey_prf_0#3001]
         :  :  :  +- Relation[l_returnflag_prf#2964,l_orderkey_and_l_linenumber_prf#2965,l_comment_prf#2966,l_linestatus_prf#2967,rid#2968,l_shipmode_prf#2969,l_shipinstruct_prf#2970,l_quantity_prf#2971,l_receiptdate_prf#2972,l_linenumber_prf#2973,l_tax_prf#2974,l_shipdate_prf#2975,l_extendedprice_prf#2976,l_partkey_prf#2977,l_discount_prf#2978,l_partkey_and_l_suppkey_prf#2979,l_commitdate_prf#2980,l_suppkey_prf#2981,l_orderkey_prf#2982] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3002]
         :  :     +- DexRidFilter lineitem~l_returnflag~R
         :  :        +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3003, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3004]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3005 AS o_shippriority_prf_1#3015, rid#3006 AS rid_1#3016, o_orderdate_prf#3007 AS o_orderdate_prf_1#3017, o_custkey_prf#3008 AS o_custkey_prf_1#3018, o_orderpriority_prf#3009 AS o_orderpriority_prf_1#3019, o_clerk_prf#3010 AS o_clerk_prf_1#3020, o_orderstatus_prf#3011 AS o_orderstatus_prf_1#3021, o_totalprice_prf#3012 AS o_totalprice_prf_1#3022, o_orderkey_prf#3013 AS o_orderkey_prf_1#3023, o_comment_prf#3014 AS o_comment_prf_1#3024]
            +- Relation[o_shippriority_prf#3005,rid#3006,o_orderdate_prf#3007,o_custkey_prf#3008,o_orderpriority_prf#3009,o_clerk_prf#3010,o_orderstatus_prf#3011,o_totalprice_prf#3012,o_orderkey_prf#3013,o_comment_prf#3014] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 97917ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/12 10:28:47 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:28:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3090L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 10:28:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3090L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#3092 AS c_acctbal_prf_0#3101, rid#3093 AS rid_0#3102, c_name_prf#3094 AS c_name_prf_0#3103, c_nationkey_prf#3095 AS c_nationkey_prf_0#3104, c_custkey_prf#3096 AS c_custkey_prf_0#3105, c_comment_prf#3097 AS c_comment_prf_0#3106, c_address_prf#3098 AS c_address_prf_0#3107, c_mktsegment_prf#3099 AS c_mktsegment_prf_0#3108, c_phone_prf#3100 AS c_phone_prf_0#3109]
         :  :  +- Relation[c_acctbal_prf#3092,rid#3093,c_name_prf#3094,c_nationkey_prf#3095,c_custkey_prf#3096,c_comment_prf#3097,c_address_prf#3098,c_mktsegment_prf#3099,c_phone_prf#3100] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3110, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3111]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [o_shippriority_prf#3112 AS o_shippriority_prf_1#3122, rid#3113 AS rid_1#3123, o_orderdate_prf#3114 AS o_orderdate_prf_1#3124, o_custkey_prf#3115 AS o_custkey_prf_1#3125, o_orderpriority_prf#3116 AS o_orderpriority_prf_1#3126, o_clerk_prf#3117 AS o_clerk_prf_1#3127, o_orderstatus_prf#3118 AS o_orderstatus_prf_1#3128, o_totalprice_prf#3119 AS o_totalprice_prf_1#3129, o_orderkey_prf#3120 AS o_orderkey_prf_1#3130, o_comment_prf#3121 AS o_comment_prf_1#3131]
            :  :  +- Relation[o_shippriority_prf#3112,rid#3113,o_orderdate_prf#3114,o_custkey_prf#3115,o_orderpriority_prf#3116,o_clerk_prf#3117,o_orderstatus_prf#3118,o_totalprice_prf#3119,o_orderkey_prf#3120,o_comment_prf#3121] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3132, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3133]
            :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
            :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3134 AS l_returnflag_prf_2#3153, l_orderkey_and_l_linenumber_prf#3135 AS l_orderkey_and_l_linenumber_prf_2#3154, l_comment_prf#3136 AS l_comment_prf_2#3155, l_linestatus_prf#3137 AS l_linestatus_prf_2#3156, rid#3138 AS rid_2#3157, l_shipmode_prf#3139 AS l_shipmode_prf_2#3158, l_shipinstruct_prf#3140 AS l_shipinstruct_prf_2#3159, l_quantity_prf#3141 AS l_quantity_prf_2#3160, l_receiptdate_prf#3142 AS l_receiptdate_prf_2#3161, l_linenumber_prf#3143 AS l_linenumber_prf_2#3162, l_tax_prf#3144 AS l_tax_prf_2#3163, l_shipdate_prf#3145 AS l_shipdate_prf_2#3164, l_extendedprice_prf#3146 AS l_extendedprice_prf_2#3165, l_partkey_prf#3147 AS l_partkey_prf_2#3166, l_discount_prf#3148 AS l_discount_prf_2#3167, l_partkey_and_l_suppkey_prf#3149 AS l_partkey_and_l_suppkey_prf_2#3168, l_commitdate_prf#3150 AS l_commitdate_prf_2#3169, l_suppkey_prf#3151 AS l_suppkey_prf_2#3170, l_orderkey_prf#3152 AS l_orderkey_prf_2#3171]
               +- Relation[l_returnflag_prf#3134,l_orderkey_and_l_linenumber_prf#3135,l_comment_prf#3136,l_linestatus_prf#3137,rid#3138,l_shipmode_prf#3139,l_shipinstruct_prf#3140,l_quantity_prf#3141,l_receiptdate_prf#3142,l_linenumber_prf#3143,l_tax_prf#3144,l_shipdate_prf#3145,l_extendedprice_prf#3146,l_partkey_prf#3147,l_discount_prf#3148,l_partkey_and_l_suppkey_prf#3149,l_commitdate_prf#3150,l_suppkey_prf#3151,l_orderkey_prf#3152] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 169297ms

f1=
select * from region where r_name = 'EUROPE'
19/10/12 10:31:36 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:31:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3216L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/12 10:31:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3216L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#3218 AS r_regionkey_prf_0#3222, r_name_prf#3219 AS r_name_prf_0#3223, r_comment_prf#3220 AS r_comment_prf_0#3224, rid#3221 AS rid_0#3225]
         :  +- Relation[r_regionkey_prf#3218,r_name_prf#3219,r_comment_prf#3220,rid#3221] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3226]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1
Elapsed time: 54ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/12 10:31:36 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:31:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3257L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 10:31:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3257L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#3259 AS s_phone_prf_0#3267, rid#3260 AS rid_0#3268, s_address_prf#3261 AS s_address_prf_0#3269, s_nationkey_prf#3262 AS s_nationkey_prf_0#3270, s_suppkey_prf#3263 AS s_suppkey_prf_0#3271, s_name_prf#3264 AS s_name_prf_0#3272, s_acctbal_prf#3265 AS s_acctbal_prf_0#3273, s_comment_prf#3266 AS s_comment_prf_0#3274]
         :  :  +- Relation[s_phone_prf#3259,rid#3260,s_address_prf#3261,s_nationkey_prf#3262,s_suppkey_prf#3263,s_name_prf#3264,s_acctbal_prf#3265,s_comment_prf#3266] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3275, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3276]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3277 AS l_returnflag_prf_1#3296, l_orderkey_and_l_linenumber_prf#3278 AS l_orderkey_and_l_linenumber_prf_1#3297, l_comment_prf#3279 AS l_comment_prf_1#3298, l_linestatus_prf#3280 AS l_linestatus_prf_1#3299, rid#3281 AS rid_1#3300, l_shipmode_prf#3282 AS l_shipmode_prf_1#3301, l_shipinstruct_prf#3283 AS l_shipinstruct_prf_1#3302, l_quantity_prf#3284 AS l_quantity_prf_1#3303, l_receiptdate_prf#3285 AS l_receiptdate_prf_1#3304, l_linenumber_prf#3286 AS l_linenumber_prf_1#3305, l_tax_prf#3287 AS l_tax_prf_1#3306, l_shipdate_prf#3288 AS l_shipdate_prf_1#3307, l_extendedprice_prf#3289 AS l_extendedprice_prf_1#3308, l_partkey_prf#3290 AS l_partkey_prf_1#3309, l_discount_prf#3291 AS l_discount_prf_1#3310, l_partkey_and_l_suppkey_prf#3292 AS l_partkey_and_l_suppkey_prf_1#3311, l_commitdate_prf#3293 AS l_commitdate_prf_1#3312, l_suppkey_prf#3294 AS l_suppkey_prf_1#3313, l_orderkey_prf#3295 AS l_orderkey_prf_1#3314]
            +- Relation[l_returnflag_prf#3277,l_orderkey_and_l_linenumber_prf#3278,l_comment_prf#3279,l_linestatus_prf#3280,rid#3281,l_shipmode_prf#3282,l_shipinstruct_prf#3283,l_quantity_prf#3284,l_receiptdate_prf#3285,l_linenumber_prf#3286,l_tax_prf#3287,l_shipdate_prf#3288,l_extendedprice_prf#3289,l_partkey_prf#3290,l_discount_prf#3291,l_partkey_and_l_suppkey_prf#3292,l_commitdate_prf#3293,l_suppkey_prf#3294,l_orderkey_prf#3295] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 89247ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/12 10:33:06 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:33:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3354L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 10:33:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3354L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#3356 AS p_comment_prf_0#3366, p_name_prf#3357 AS p_name_prf_0#3367, rid#3358 AS rid_0#3368, p_type_prf#3359 AS p_type_prf_0#3369, p_retailprice_prf#3360 AS p_retailprice_prf_0#3370, p_mfgr_prf#3361 AS p_mfgr_prf_0#3371, p_container_prf#3362 AS p_container_prf_0#3372, p_brand_prf#3363 AS p_brand_prf_0#3373, p_size_prf#3364 AS p_size_prf_0#3374, p_partkey_prf#3365 AS p_partkey_prf_0#3375]
         :  +- Relation[p_comment_prf#3356,p_name_prf#3357,rid#3358,p_type_prf#3359,p_retailprice_prf#3360,p_mfgr_prf#3361,p_container_prf#3362,p_brand_prf#3363,p_size_prf#3364,p_partkey_prf#3365] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3376]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1451
Elapsed time: 82ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/12 10:33:06 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:33:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3415L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 10:33:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3415L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [p_comment_prf#3417 AS p_comment_prf_0#3427, p_name_prf#3418 AS p_name_prf_0#3428, rid#3419 AS rid_0#3429, p_type_prf#3420 AS p_type_prf_0#3430, p_retailprice_prf#3421 AS p_retailprice_prf_0#3431, p_mfgr_prf#3422 AS p_mfgr_prf_0#3432, p_container_prf#3423 AS p_container_prf_0#3433, p_brand_prf#3424 AS p_brand_prf_0#3434, p_size_prf#3425 AS p_size_prf_0#3435, p_partkey_prf#3426 AS p_partkey_prf_0#3436]
         :  :  +- Relation[p_comment_prf#3417,p_name_prf#3418,rid#3419,p_type_prf#3420,p_retailprice_prf#3421,p_mfgr_prf#3422,p_container_prf#3423,p_brand_prf#3424,p_size_prf#3425,p_partkey_prf#3426] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3437, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3438]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3439 AS l_returnflag_prf_1#3458, l_orderkey_and_l_linenumber_prf#3440 AS l_orderkey_and_l_linenumber_prf_1#3459, l_comment_prf#3441 AS l_comment_prf_1#3460, l_linestatus_prf#3442 AS l_linestatus_prf_1#3461, rid#3443 AS rid_1#3462, l_shipmode_prf#3444 AS l_shipmode_prf_1#3463, l_shipinstruct_prf#3445 AS l_shipinstruct_prf_1#3464, l_quantity_prf#3446 AS l_quantity_prf_1#3465, l_receiptdate_prf#3447 AS l_receiptdate_prf_1#3466, l_linenumber_prf#3448 AS l_linenumber_prf_1#3467, l_tax_prf#3449 AS l_tax_prf_1#3468, l_shipdate_prf#3450 AS l_shipdate_prf_1#3469, l_extendedprice_prf#3451 AS l_extendedprice_prf_1#3470, l_partkey_prf#3452 AS l_partkey_prf_1#3471, l_discount_prf#3453 AS l_discount_prf_1#3472, l_partkey_and_l_suppkey_prf#3454 AS l_partkey_and_l_suppkey_prf_1#3473, l_commitdate_prf#3455 AS l_commitdate_prf_1#3474, l_suppkey_prf#3456 AS l_suppkey_prf_1#3475, l_orderkey_prf#3457 AS l_orderkey_prf_1#3476]
            +- Relation[l_returnflag_prf#3439,l_orderkey_and_l_linenumber_prf#3440,l_comment_prf#3441,l_linestatus_prf#3442,rid#3443,l_shipmode_prf#3444,l_shipinstruct_prf#3445,l_quantity_prf#3446,l_receiptdate_prf#3447,l_linenumber_prf#3448,l_tax_prf#3449,l_shipdate_prf#3450,l_extendedprice_prf#3451,l_partkey_prf#3452,l_discount_prf#3453,l_partkey_and_l_suppkey_prf#3454,l_commitdate_prf#3455,l_suppkey_prf#3456,l_orderkey_prf#3457] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 94975ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/12 10:34:41 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:34:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3542L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 10:34:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3542L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [c_acctbal_prf#3544 AS c_acctbal_prf_0#3553, rid#3545 AS rid_0#3554, c_name_prf#3546 AS c_name_prf_0#3555, c_nationkey_prf#3547 AS c_nationkey_prf_0#3556, c_custkey_prf#3548 AS c_custkey_prf_0#3557, c_comment_prf#3549 AS c_comment_prf_0#3558, c_address_prf#3550 AS c_address_prf_0#3559, c_mktsegment_prf#3551 AS c_mktsegment_prf_0#3560, c_phone_prf#3552 AS c_phone_prf_0#3561]
         :  :  :  :  +- Relation[c_acctbal_prf#3544,rid#3545,c_name_prf#3546,c_nationkey_prf#3547,c_custkey_prf#3548,c_comment_prf#3549,c_address_prf#3550,c_mktsegment_prf#3551,c_phone_prf#3552] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3562, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3563]
         :  :  :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :  :  :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#3564 AS o_shippriority_prf_1#3574, rid#3565 AS rid_1#3575, o_orderdate_prf#3566 AS o_orderdate_prf_1#3576, o_custkey_prf#3567 AS o_custkey_prf_1#3577, o_orderpriority_prf#3568 AS o_orderpriority_prf_1#3578, o_clerk_prf#3569 AS o_clerk_prf_1#3579, o_orderstatus_prf#3570 AS o_orderstatus_prf_1#3580, o_totalprice_prf#3571 AS o_totalprice_prf_1#3581, o_orderkey_prf#3572 AS o_orderkey_prf_1#3582, o_comment_prf#3573 AS o_comment_prf_1#3583]
         :  :     +- Relation[o_shippriority_prf#3564,rid#3565,o_orderdate_prf#3566,o_custkey_prf#3567,o_orderpriority_prf#3568,o_clerk_prf#3569,o_orderstatus_prf#3570,o_totalprice_prf#3571,o_orderkey_prf#3572,o_comment_prf#3573] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3584, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3585]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3586 AS l_returnflag_prf_2#3605, l_orderkey_and_l_linenumber_prf#3587 AS l_orderkey_and_l_linenumber_prf_2#3606, l_comment_prf#3588 AS l_comment_prf_2#3607, l_linestatus_prf#3589 AS l_linestatus_prf_2#3608, rid#3590 AS rid_2#3609, l_shipmode_prf#3591 AS l_shipmode_prf_2#3610, l_shipinstruct_prf#3592 AS l_shipinstruct_prf_2#3611, l_quantity_prf#3593 AS l_quantity_prf_2#3612, l_receiptdate_prf#3594 AS l_receiptdate_prf_2#3613, l_linenumber_prf#3595 AS l_linenumber_prf_2#3614, l_tax_prf#3596 AS l_tax_prf_2#3615, l_shipdate_prf#3597 AS l_shipdate_prf_2#3616, l_extendedprice_prf#3598 AS l_extendedprice_prf_2#3617, l_partkey_prf#3599 AS l_partkey_prf_2#3618, l_discount_prf#3600 AS l_discount_prf_2#3619, l_partkey_and_l_suppkey_prf#3601 AS l_partkey_and_l_suppkey_prf_2#3620, l_commitdate_prf#3602 AS l_commitdate_prf_2#3621, l_suppkey_prf#3603 AS l_suppkey_prf_2#3622, l_orderkey_prf#3604 AS l_orderkey_prf_2#3623]
            +- Relation[l_returnflag_prf#3586,l_orderkey_and_l_linenumber_prf#3587,l_comment_prf#3588,l_linestatus_prf#3589,rid#3590,l_shipmode_prf#3591,l_shipinstruct_prf#3592,l_quantity_prf#3593,l_receiptdate_prf#3594,l_linenumber_prf#3595,l_tax_prf#3596,l_shipdate_prf#3597,l_extendedprice_prf#3598,l_partkey_prf#3599,l_discount_prf#3600,l_partkey_and_l_suppkey_prf#3601,l_commitdate_prf#3602,l_suppkey_prf#3603,l_orderkey_prf#3604] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 169360ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/12 10:37:30 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:37:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3698L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 10:37:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3698L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#3700 AS l_returnflag_prf_0#3719, l_orderkey_and_l_linenumber_prf#3701 AS l_orderkey_and_l_linenumber_prf_0#3720, l_comment_prf#3702 AS l_comment_prf_0#3721, l_linestatus_prf#3703 AS l_linestatus_prf_0#3722, rid#3704 AS rid_0#3723, l_shipmode_prf#3705 AS l_shipmode_prf_0#3724, l_shipinstruct_prf#3706 AS l_shipinstruct_prf_0#3725, l_quantity_prf#3707 AS l_quantity_prf_0#3726, l_receiptdate_prf#3708 AS l_receiptdate_prf_0#3727, l_linenumber_prf#3709 AS l_linenumber_prf_0#3728, l_tax_prf#3710 AS l_tax_prf_0#3729, l_shipdate_prf#3711 AS l_shipdate_prf_0#3730, l_extendedprice_prf#3712 AS l_extendedprice_prf_0#3731, l_partkey_prf#3713 AS l_partkey_prf_0#3732, l_discount_prf#3714 AS l_discount_prf_0#3733, l_partkey_and_l_suppkey_prf#3715 AS l_partkey_and_l_suppkey_prf_0#3734, l_commitdate_prf#3716 AS l_commitdate_prf_0#3735, l_suppkey_prf#3717 AS l_suppkey_prf_0#3736, l_orderkey_prf#3718 AS l_orderkey_prf_0#3737]
         :  :  +- Relation[l_returnflag_prf#3700,l_orderkey_and_l_linenumber_prf#3701,l_comment_prf#3702,l_linestatus_prf#3703,rid#3704,l_shipmode_prf#3705,l_shipinstruct_prf#3706,l_quantity_prf#3707,l_receiptdate_prf#3708,l_linenumber_prf#3709,l_tax_prf#3710,l_shipdate_prf#3711,l_extendedprice_prf#3712,l_partkey_prf#3713,l_discount_prf#3714,l_partkey_and_l_suppkey_prf#3715,l_commitdate_prf#3716,l_suppkey_prf#3717,l_orderkey_prf#3718] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3738, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3739]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [c_acctbal_prf#3740 AS c_acctbal_prf_1#3749, rid#3741 AS rid_1#3750, c_name_prf#3742 AS c_name_prf_1#3751, c_nationkey_prf#3743 AS c_nationkey_prf_1#3752, c_custkey_prf#3744 AS c_custkey_prf_1#3753, c_comment_prf#3745 AS c_comment_prf_1#3754, c_address_prf#3746 AS c_address_prf_1#3755, c_mktsegment_prf#3747 AS c_mktsegment_prf_1#3756, c_phone_prf#3748 AS c_phone_prf_1#3757]
            :  :  +- Relation[c_acctbal_prf#3740,rid#3741,c_name_prf#3742,c_nationkey_prf#3743,c_custkey_prf#3744,c_comment_prf#3745,c_address_prf#3746,c_mktsegment_prf#3747,c_phone_prf#3748] JDBCRelation(customer_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3758, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3759]
            :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
            :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3760 AS o_shippriority_prf_2#3770, rid#3761 AS rid_2#3771, o_orderdate_prf#3762 AS o_orderdate_prf_2#3772, o_custkey_prf#3763 AS o_custkey_prf_2#3773, o_orderpriority_prf#3764 AS o_orderpriority_prf_2#3774, o_clerk_prf#3765 AS o_clerk_prf_2#3775, o_orderstatus_prf#3766 AS o_orderstatus_prf_2#3776, o_totalprice_prf#3767 AS o_totalprice_prf_2#3777, o_orderkey_prf#3768 AS o_orderkey_prf_2#3778, o_comment_prf#3769 AS o_comment_prf_2#3779]
               +- Relation[o_shippriority_prf#3760,rid#3761,o_orderdate_prf#3762,o_custkey_prf#3763,o_orderpriority_prf#3764,o_clerk_prf#3765,o_orderstatus_prf#3766,o_totalprice_prf#3767,o_orderkey_prf#3768,o_comment_prf#3769] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 183538ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/12 10:40:34 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:40:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3846L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 10:40:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3846L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [o_shippriority_prf#3848 AS o_shippriority_prf_0#3858, rid#3849 AS rid_0#3859, o_orderdate_prf#3850 AS o_orderdate_prf_0#3860, o_custkey_prf#3851 AS o_custkey_prf_0#3861, o_orderpriority_prf#3852 AS o_orderpriority_prf_0#3862, o_clerk_prf#3853 AS o_clerk_prf_0#3863, o_orderstatus_prf#3854 AS o_orderstatus_prf_0#3864, o_totalprice_prf#3855 AS o_totalprice_prf_0#3865, o_orderkey_prf#3856 AS o_orderkey_prf_0#3866, o_comment_prf#3857 AS o_comment_prf_0#3867]
         :  :  +- Relation[o_shippriority_prf#3848,rid#3849,o_orderdate_prf#3850,o_custkey_prf#3851,o_orderpriority_prf#3852,o_clerk_prf#3853,o_orderstatus_prf#3854,o_totalprice_prf#3855,o_orderkey_prf#3856,o_comment_prf#3857] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3868, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3869]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3870 AS l_returnflag_prf_1#3889, l_orderkey_and_l_linenumber_prf#3871 AS l_orderkey_and_l_linenumber_prf_1#3890, l_comment_prf#3872 AS l_comment_prf_1#3891, l_linestatus_prf#3873 AS l_linestatus_prf_1#3892, rid#3874 AS rid_1#3893, l_shipmode_prf#3875 AS l_shipmode_prf_1#3894, l_shipinstruct_prf#3876 AS l_shipinstruct_prf_1#3895, l_quantity_prf#3877 AS l_quantity_prf_1#3896, l_receiptdate_prf#3878 AS l_receiptdate_prf_1#3897, l_linenumber_prf#3879 AS l_linenumber_prf_1#3898, l_tax_prf#3880 AS l_tax_prf_1#3899, l_shipdate_prf#3881 AS l_shipdate_prf_1#3900, l_extendedprice_prf#3882 AS l_extendedprice_prf_1#3901, l_partkey_prf#3883 AS l_partkey_prf_1#3902, l_discount_prf#3884 AS l_discount_prf_1#3903, l_partkey_and_l_suppkey_prf#3885 AS l_partkey_and_l_suppkey_prf_1#3904, l_commitdate_prf#3886 AS l_commitdate_prf_1#3905, l_suppkey_prf#3887 AS l_suppkey_prf_1#3906, l_orderkey_prf#3888 AS l_orderkey_prf_1#3907]
            +- Relation[l_returnflag_prf#3870,l_orderkey_and_l_linenumber_prf#3871,l_comment_prf#3872,l_linestatus_prf#3873,rid#3874,l_shipmode_prf#3875,l_shipinstruct_prf#3876,l_quantity_prf#3877,l_receiptdate_prf#3878,l_linenumber_prf#3879,l_tax_prf#3880,l_shipdate_prf#3881,l_extendedprice_prf#3882,l_partkey_prf#3883,l_discount_prf#3884,l_partkey_and_l_suppkey_prf#3885,l_commitdate_prf#3886,l_suppkey_prf#3887,l_orderkey_prf#3888] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 106958ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/12 10:42:21 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:42:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3954L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 10:42:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3954L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [p_comment_prf#3956 AS p_comment_prf_0#3966, p_name_prf#3957 AS p_name_prf_0#3967, rid#3958 AS rid_0#3968, p_type_prf#3959 AS p_type_prf_0#3969, p_retailprice_prf#3960 AS p_retailprice_prf_0#3970, p_mfgr_prf#3961 AS p_mfgr_prf_0#3971, p_container_prf#3962 AS p_container_prf_0#3972, p_brand_prf#3963 AS p_brand_prf_0#3973, p_size_prf#3964 AS p_size_prf_0#3974, p_partkey_prf#3965 AS p_partkey_prf_0#3975]
         :  :  +- Relation[p_comment_prf#3956,p_name_prf#3957,rid#3958,p_type_prf#3959,p_retailprice_prf#3960,p_mfgr_prf#3961,p_container_prf#3962,p_brand_prf#3963,p_size_prf#3964,p_partkey_prf#3965] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3976, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3977]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#3978 AS ps_partkey_and_ps_suppkey_prf_1#3985, rid#3979 AS rid_1#3986, ps_availqty_prf#3980 AS ps_availqty_prf_1#3987, ps_comment_prf#3981 AS ps_comment_prf_1#3988, ps_partkey_prf#3982 AS ps_partkey_prf_1#3989, ps_supplycost_prf#3983 AS ps_supplycost_prf_1#3990, ps_suppkey_prf#3984 AS ps_suppkey_prf_1#3991]
            +- Relation[ps_partkey_and_ps_suppkey_prf#3978,rid#3979,ps_availqty_prf#3980,ps_comment_prf#3981,ps_partkey_prf#3982,ps_supplycost_prf#3983,ps_suppkey_prf#3984] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 12134ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/12 10:42:33 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:42:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4026L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 10:42:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4026L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [p_comment_prf#4028 AS p_comment_prf_0#4038, p_name_prf#4029 AS p_name_prf_0#4039, rid#4030 AS rid_0#4040, p_type_prf#4031 AS p_type_prf_0#4041, p_retailprice_prf#4032 AS p_retailprice_prf_0#4042, p_mfgr_prf#4033 AS p_mfgr_prf_0#4043, p_container_prf#4034 AS p_container_prf_0#4044, p_brand_prf#4035 AS p_brand_prf_0#4045, p_size_prf#4036 AS p_size_prf_0#4046, p_partkey_prf#4037 AS p_partkey_prf_0#4047]
         :  :  :  +- Relation[p_comment_prf#4028,p_name_prf#4029,rid#4030,p_type_prf#4031,p_retailprice_prf#4032,p_mfgr_prf#4033,p_container_prf#4034,p_brand_prf#4035,p_size_prf#4036,p_partkey_prf#4037] JDBCRelation(part_prf) [numPartitions=1]
         :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4048]
         :  :     +- DexRidFilter part~p_size~15
         :  :        +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4049, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4050]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4051 AS ps_partkey_and_ps_suppkey_prf_1#4058, rid#4052 AS rid_1#4059, ps_availqty_prf#4053 AS ps_availqty_prf_1#4060, ps_comment_prf#4054 AS ps_comment_prf_1#4061, ps_partkey_prf#4055 AS ps_partkey_prf_1#4062, ps_supplycost_prf#4056 AS ps_supplycost_prf_1#4063, ps_suppkey_prf#4057 AS ps_suppkey_prf_1#4064]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4051,rid#4052,ps_availqty_prf#4053,ps_comment_prf#4054,ps_partkey_prf#4055,ps_supplycost_prf#4056,ps_suppkey_prf#4057] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=15628
Elapsed time: 7770ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/12 10:42:40 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:42:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4092L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 10:42:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4092L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [r_regionkey_prf#4094 AS r_regionkey_prf_0#4098, r_name_prf#4095 AS r_name_prf_0#4099, r_comment_prf#4096 AS r_comment_prf_0#4100, rid#4097 AS rid_0#4101]
         :  :  +- Relation[r_regionkey_prf#4094,r_name_prf#4095,r_comment_prf#4096,rid#4097] JDBCRelation(region_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4102, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4103]
         :     +- SpxRidUncorrelatedJoin nation~n_regionkey~region~r_regionkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [rid#4104 AS rid_1#4109, n_regionkey_prf#4105 AS n_regionkey_prf_1#4110, n_nationkey_prf#4106 AS n_nationkey_prf_1#4111, n_name_prf#4107 AS n_name_prf_1#4112, n_comment_prf#4108 AS n_comment_prf_1#4113]
            +- Relation[rid#4104,n_regionkey_prf#4105,n_nationkey_prf#4106,n_name_prf#4107,n_comment_prf#4108] JDBCRelation(nation_prf) [numPartitions=1]

DexSpx$ result size=25
Elapsed time: 66ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/12 10:42:41 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:42:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4158L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 10:42:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4158L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4160 AS s_phone_prf_0#4168, rid#4161 AS rid_0#4169, s_address_prf#4162 AS s_address_prf_0#4170, s_nationkey_prf#4163 AS s_nationkey_prf_0#4171, s_suppkey_prf#4164 AS s_suppkey_prf_0#4172, s_name_prf#4165 AS s_name_prf_0#4173, s_acctbal_prf#4166 AS s_acctbal_prf_0#4174, s_comment_prf#4167 AS s_comment_prf_0#4175]
         :  :  +- Relation[s_phone_prf#4160,rid#4161,s_address_prf#4162,s_nationkey_prf#4163,s_suppkey_prf#4164,s_name_prf#4165,s_acctbal_prf#4166,s_comment_prf#4167] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4176, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4177]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [p_comment_prf#4178 AS p_comment_prf_1#4188, p_name_prf#4179 AS p_name_prf_1#4189, rid#4180 AS rid_1#4190, p_type_prf#4181 AS p_type_prf_1#4191, p_retailprice_prf#4182 AS p_retailprice_prf_1#4192, p_mfgr_prf#4183 AS p_mfgr_prf_1#4193, p_container_prf#4184 AS p_container_prf_1#4194, p_brand_prf#4185 AS p_brand_prf_1#4195, p_size_prf#4186 AS p_size_prf_1#4196, p_partkey_prf#4187 AS p_partkey_prf_1#4197]
            :  :  +- Relation[p_comment_prf#4178,p_name_prf#4179,rid#4180,p_type_prf#4181,p_retailprice_prf#4182,p_mfgr_prf#4183,p_container_prf#4184,p_brand_prf#4185,p_size_prf#4186,p_partkey_prf#4187] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4198, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4199]
            :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
            :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4200 AS l_returnflag_prf_2#4219, l_orderkey_and_l_linenumber_prf#4201 AS l_orderkey_and_l_linenumber_prf_2#4220, l_comment_prf#4202 AS l_comment_prf_2#4221, l_linestatus_prf#4203 AS l_linestatus_prf_2#4222, rid#4204 AS rid_2#4223, l_shipmode_prf#4205 AS l_shipmode_prf_2#4224, l_shipinstruct_prf#4206 AS l_shipinstruct_prf_2#4225, l_quantity_prf#4207 AS l_quantity_prf_2#4226, l_receiptdate_prf#4208 AS l_receiptdate_prf_2#4227, l_linenumber_prf#4209 AS l_linenumber_prf_2#4228, l_tax_prf#4210 AS l_tax_prf_2#4229, l_shipdate_prf#4211 AS l_shipdate_prf_2#4230, l_extendedprice_prf#4212 AS l_extendedprice_prf_2#4231, l_partkey_prf#4213 AS l_partkey_prf_2#4232, l_discount_prf#4214 AS l_discount_prf_2#4233, l_partkey_and_l_suppkey_prf#4215 AS l_partkey_and_l_suppkey_prf_2#4234, l_commitdate_prf#4216 AS l_commitdate_prf_2#4235, l_suppkey_prf#4217 AS l_suppkey_prf_2#4236, l_orderkey_prf#4218 AS l_orderkey_prf_2#4237]
               +- Relation[l_returnflag_prf#4200,l_orderkey_and_l_linenumber_prf#4201,l_comment_prf#4202,l_linestatus_prf#4203,rid#4204,l_shipmode_prf#4205,l_shipinstruct_prf#4206,l_quantity_prf#4207,l_receiptdate_prf#4208,l_linenumber_prf#4209,l_tax_prf#4210,l_shipdate_prf#4211,l_extendedprice_prf#4212,l_partkey_prf#4213,l_discount_prf#4214,l_partkey_and_l_suppkey_prf#4215,l_commitdate_prf#4216,l_suppkey_prf#4217,l_orderkey_prf#4218] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201195ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/12 10:46:02 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 10:46:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4297L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 10:46:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4297L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [rid#4299 AS rid_0#4304, n_regionkey_prf#4300 AS n_regionkey_prf_0#4305, n_nationkey_prf#4301 AS n_nationkey_prf_0#4306, n_name_prf#4302 AS n_name_prf_0#4307, n_comment_prf#4303 AS n_comment_prf_0#4308]
         :  :  :  :  +- Relation[rid#4299,n_regionkey_prf#4300,n_nationkey_prf#4301,n_name_prf#4302,n_comment_prf#4303] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4309, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4310]
         :  :  :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :  :  :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#4311 AS s_phone_prf_1#4319, rid#4312 AS rid_1#4320, s_address_prf#4313 AS s_address_prf_1#4321, s_nationkey_prf#4314 AS s_nationkey_prf_1#4322, s_suppkey_prf#4315 AS s_suppkey_prf_1#4323, s_name_prf#4316 AS s_name_prf_1#4324, s_acctbal_prf#4317 AS s_acctbal_prf_1#4325, s_comment_prf#4318 AS s_comment_prf_1#4326]
         :  :     +- Relation[s_phone_prf#4311,rid#4312,s_address_prf#4313,s_nationkey_prf#4314,s_suppkey_prf#4315,s_name_prf#4316,s_acctbal_prf#4317,s_comment_prf#4318] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4327, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4328]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4329 AS c_acctbal_prf_2#4338, rid#4330 AS rid_2#4339, c_name_prf#4331 AS c_name_prf_2#4340, c_nationkey_prf#4332 AS c_nationkey_prf_2#4341, c_custkey_prf#4333 AS c_custkey_prf_2#4342, c_comment_prf#4334 AS c_comment_prf_2#4343, c_address_prf#4335 AS c_address_prf_2#4344, c_mktsegment_prf#4336 AS c_mktsegment_prf_2#4345, c_phone_prf#4337 AS c_phone_prf_2#4346]
            +- Relation[c_acctbal_prf#4329,rid#4330,c_name_prf#4331,c_nationkey_prf#4332,c_custkey_prf#4333,c_comment_prf#4334,c_address_prf#4335,c_mktsegment_prf#4336,c_phone_prf#4337] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 886813ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/12 11:00:49 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 11:00:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4393L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 11:00:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4393L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [ps_partkey_and_ps_suppkey_prf#4395 AS ps_partkey_and_ps_suppkey_prf_0#4402, rid#4396 AS rid_0#4403, ps_availqty_prf#4397 AS ps_availqty_prf_0#4404, ps_comment_prf#4398 AS ps_comment_prf_0#4405, ps_partkey_prf#4399 AS ps_partkey_prf_0#4406, ps_supplycost_prf#4400 AS ps_supplycost_prf_0#4407, ps_suppkey_prf#4401 AS ps_suppkey_prf_0#4408]
         :  :  :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#4395,rid#4396,ps_availqty_prf#4397,ps_comment_prf#4398,ps_partkey_prf#4399,ps_supplycost_prf#4400,ps_suppkey_prf#4401] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4409, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4410]
         :  :  :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :  :  :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#4411 AS p_comment_prf_1#4421, p_name_prf#4412 AS p_name_prf_1#4422, rid#4413 AS rid_1#4423, p_type_prf#4414 AS p_type_prf_1#4424, p_retailprice_prf#4415 AS p_retailprice_prf_1#4425, p_mfgr_prf#4416 AS p_mfgr_prf_1#4426, p_container_prf#4417 AS p_container_prf_1#4427, p_brand_prf#4418 AS p_brand_prf_1#4428, p_size_prf#4419 AS p_size_prf_1#4429, p_partkey_prf#4420 AS p_partkey_prf_1#4430]
         :  :     +- Relation[p_comment_prf#4411,p_name_prf#4412,rid#4413,p_type_prf#4414,p_retailprice_prf#4415,p_mfgr_prf#4416,p_container_prf#4417,p_brand_prf#4418,p_size_prf#4419,p_partkey_prf#4420] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4431, dexdecrypt('value_dec_key, 'value_right) AS rid_2#4432]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#4433 AS s_phone_prf_2#4441, rid#4434 AS rid_2#4442, s_address_prf#4435 AS s_address_prf_2#4443, s_nationkey_prf#4436 AS s_nationkey_prf_2#4444, s_suppkey_prf#4437 AS s_suppkey_prf_2#4445, s_name_prf#4438 AS s_name_prf_2#4446, s_acctbal_prf#4439 AS s_acctbal_prf_2#4447, s_comment_prf#4440 AS s_comment_prf_2#4448]
            +- Relation[s_phone_prf#4433,rid#4434,s_address_prf#4435,s_nationkey_prf#4436,s_suppkey_prf#4437,s_name_prf#4438,s_acctbal_prf#4439,s_comment_prf#4440] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26266ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/12 11:01:15 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 11:01:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4496L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 11:01:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4496L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [s_phone_prf#4498 AS s_phone_prf_0#4506, rid#4499 AS rid_0#4507, s_address_prf#4500 AS s_address_prf_0#4508, s_nationkey_prf#4501 AS s_nationkey_prf_0#4509, s_suppkey_prf#4502 AS s_suppkey_prf_0#4510, s_name_prf#4503 AS s_name_prf_0#4511, s_acctbal_prf#4504 AS s_acctbal_prf_0#4512, s_comment_prf#4505 AS s_comment_prf_0#4513]
         :  :  :  :  +- Relation[s_phone_prf#4498,rid#4499,s_address_prf#4500,s_nationkey_prf#4501,s_suppkey_prf#4502,s_name_prf#4503,s_acctbal_prf#4504,s_comment_prf#4505] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4514, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4515]
         :  :  :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :  :  :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [rid#4516 AS rid_1#4521, n_regionkey_prf#4517 AS n_regionkey_prf_1#4522, n_nationkey_prf#4518 AS n_nationkey_prf_1#4523, n_name_prf#4519 AS n_name_prf_1#4524, n_comment_prf#4520 AS n_comment_prf_1#4525]
         :  :     +- Relation[rid#4516,n_regionkey_prf#4517,n_nationkey_prf#4518,n_name_prf#4519,n_comment_prf#4520] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4526, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4527]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4528 AS c_acctbal_prf_2#4537, rid#4529 AS rid_2#4538, c_name_prf#4530 AS c_name_prf_2#4539, c_nationkey_prf#4531 AS c_nationkey_prf_2#4540, c_custkey_prf#4532 AS c_custkey_prf_2#4541, c_comment_prf#4533 AS c_comment_prf_2#4542, c_address_prf#4534 AS c_address_prf_2#4543, c_mktsegment_prf#4535 AS c_mktsegment_prf_2#4544, c_phone_prf#4536 AS c_phone_prf_2#4545]
            +- Relation[c_acctbal_prf#4528,rid#4529,c_name_prf#4530,c_nationkey_prf#4531,c_custkey_prf#4532,c_comment_prf#4533,c_address_prf#4534,c_mktsegment_prf#4535,c_phone_prf#4536] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 889581ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/12 11:16:04 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 11:16:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4596L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 11:16:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4596L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [o_shippriority_prf#4598 AS o_shippriority_prf_0#4608, rid#4599 AS rid_0#4609, o_orderdate_prf#4600 AS o_orderdate_prf_0#4610, o_custkey_prf#4601 AS o_custkey_prf_0#4611, o_orderpriority_prf#4602 AS o_orderpriority_prf_0#4612, o_clerk_prf#4603 AS o_clerk_prf_0#4613, o_orderstatus_prf#4604 AS o_orderstatus_prf_0#4614, o_totalprice_prf#4605 AS o_totalprice_prf_0#4615, o_orderkey_prf#4606 AS o_orderkey_prf_0#4616, o_comment_prf#4607 AS o_comment_prf_0#4617]
         :  :  +- Relation[o_shippriority_prf#4598,rid#4599,o_orderdate_prf#4600,o_custkey_prf#4601,o_orderpriority_prf#4602,o_clerk_prf#4603,o_orderstatus_prf#4604,o_totalprice_prf#4605,o_orderkey_prf#4606,o_comment_prf#4607] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4618, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4619]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#4620 AS l_returnflag_prf_1#4639, l_orderkey_and_l_linenumber_prf#4621 AS l_orderkey_and_l_linenumber_prf_1#4640, l_comment_prf#4622 AS l_comment_prf_1#4641, l_linestatus_prf#4623 AS l_linestatus_prf_1#4642, rid#4624 AS rid_1#4643, l_shipmode_prf#4625 AS l_shipmode_prf_1#4644, l_shipinstruct_prf#4626 AS l_shipinstruct_prf_1#4645, l_quantity_prf#4627 AS l_quantity_prf_1#4646, l_receiptdate_prf#4628 AS l_receiptdate_prf_1#4647, l_linenumber_prf#4629 AS l_linenumber_prf_1#4648, l_tax_prf#4630 AS l_tax_prf_1#4649, l_shipdate_prf#4631 AS l_shipdate_prf_1#4650, l_extendedprice_prf#4632 AS l_extendedprice_prf_1#4651, l_partkey_prf#4633 AS l_partkey_prf_1#4652, l_discount_prf#4634 AS l_discount_prf_1#4653, l_partkey_and_l_suppkey_prf#4635 AS l_partkey_and_l_suppkey_prf_1#4654, l_commitdate_prf#4636 AS l_commitdate_prf_1#4655, l_suppkey_prf#4637 AS l_suppkey_prf_1#4656, l_orderkey_prf#4638 AS l_orderkey_prf_1#4657]
            :  +- Relation[l_returnflag_prf#4620,l_orderkey_and_l_linenumber_prf#4621,l_comment_prf#4622,l_linestatus_prf#4623,rid#4624,l_shipmode_prf#4625,l_shipinstruct_prf#4626,l_quantity_prf#4627,l_receiptdate_prf#4628,l_linenumber_prf#4629,l_tax_prf#4630,l_shipdate_prf#4631,l_extendedprice_prf#4632,l_partkey_prf#4633,l_discount_prf#4634,l_partkey_and_l_suppkey_prf#4635,l_commitdate_prf#4636,l_suppkey_prf#4637,l_orderkey_prf#4638] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4658]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 98623ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/12 11:17:43 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 11:17:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4705L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 11:17:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4705L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [ps_partkey_and_ps_suppkey_prf#4707 AS ps_partkey_and_ps_suppkey_prf_0#4714, rid#4708 AS rid_0#4715, ps_availqty_prf#4709 AS ps_availqty_prf_0#4716, ps_comment_prf#4710 AS ps_comment_prf_0#4717, ps_partkey_prf#4711 AS ps_partkey_prf_0#4718, ps_supplycost_prf#4712 AS ps_supplycost_prf_0#4719, ps_suppkey_prf#4713 AS ps_suppkey_prf_0#4720]
         :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#4707,rid#4708,ps_availqty_prf#4709,ps_comment_prf#4710,ps_partkey_prf#4711,ps_supplycost_prf#4712,ps_suppkey_prf#4713] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4721, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4722]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#4723 AS p_comment_prf_1#4733, p_name_prf#4724 AS p_name_prf_1#4734, rid#4725 AS rid_1#4735, p_type_prf#4726 AS p_type_prf_1#4736, p_retailprice_prf#4727 AS p_retailprice_prf_1#4737, p_mfgr_prf#4728 AS p_mfgr_prf_1#4738, p_container_prf#4729 AS p_container_prf_1#4739, p_brand_prf#4730 AS p_brand_prf_1#4740, p_size_prf#4731 AS p_size_prf_1#4741, p_partkey_prf#4732 AS p_partkey_prf_1#4742]
            :  +- Relation[p_comment_prf#4723,p_name_prf#4724,rid#4725,p_type_prf#4726,p_retailprice_prf#4727,p_mfgr_prf#4728,p_container_prf#4729,p_brand_prf#4730,p_size_prf#4731,p_partkey_prf#4732] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4743]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=15628
Elapsed time: 7747ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/12 11:17:51 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 11:17:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4789L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 11:17:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4789L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#4791 AS l_returnflag_prf_0#4810, l_orderkey_and_l_linenumber_prf#4792 AS l_orderkey_and_l_linenumber_prf_0#4811, l_comment_prf#4793 AS l_comment_prf_0#4812, l_linestatus_prf#4794 AS l_linestatus_prf_0#4813, rid#4795 AS rid_0#4814, l_shipmode_prf#4796 AS l_shipmode_prf_0#4815, l_shipinstruct_prf#4797 AS l_shipinstruct_prf_0#4816, l_quantity_prf#4798 AS l_quantity_prf_0#4817, l_receiptdate_prf#4799 AS l_receiptdate_prf_0#4818, l_linenumber_prf#4800 AS l_linenumber_prf_0#4819, l_tax_prf#4801 AS l_tax_prf_0#4820, l_shipdate_prf#4802 AS l_shipdate_prf_0#4821, l_extendedprice_prf#4803 AS l_extendedprice_prf_0#4822, l_partkey_prf#4804 AS l_partkey_prf_0#4823, l_discount_prf#4805 AS l_discount_prf_0#4824, l_partkey_and_l_suppkey_prf#4806 AS l_partkey_and_l_suppkey_prf_0#4825, l_commitdate_prf#4807 AS l_commitdate_prf_0#4826, l_suppkey_prf#4808 AS l_suppkey_prf_0#4827, l_orderkey_prf#4809 AS l_orderkey_prf_0#4828]
         :  :  +- Relation[l_returnflag_prf#4791,l_orderkey_and_l_linenumber_prf#4792,l_comment_prf#4793,l_linestatus_prf#4794,rid#4795,l_shipmode_prf#4796,l_shipinstruct_prf#4797,l_quantity_prf#4798,l_receiptdate_prf#4799,l_linenumber_prf#4800,l_tax_prf#4801,l_shipdate_prf#4802,l_extendedprice_prf#4803,l_partkey_prf#4804,l_discount_prf#4805,l_partkey_and_l_suppkey_prf#4806,l_commitdate_prf#4807,l_suppkey_prf#4808,l_orderkey_prf#4809] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4829, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4830]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4831 AS o_shippriority_prf_1#4841, rid#4832 AS rid_1#4842, o_orderdate_prf#4833 AS o_orderdate_prf_1#4843, o_custkey_prf#4834 AS o_custkey_prf_1#4844, o_orderpriority_prf#4835 AS o_orderpriority_prf_1#4845, o_clerk_prf#4836 AS o_clerk_prf_1#4846, o_orderstatus_prf#4837 AS o_orderstatus_prf_1#4847, o_totalprice_prf#4838 AS o_totalprice_prf_1#4848, o_orderkey_prf#4839 AS o_orderkey_prf_1#4849, o_comment_prf#4840 AS o_comment_prf_1#4850]
            +- Relation[o_shippriority_prf#4831,rid#4832,o_orderdate_prf#4833,o_custkey_prf#4834,o_orderpriority_prf#4835,o_clerk_prf#4836,o_orderstatus_prf#4837,o_totalprice_prf#4838,o_orderkey_prf#4839,o_comment_prf#4840] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 106759ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/12 11:19:38 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 11:19:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4904L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 11:19:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4904L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [p_comment_prf#4906 AS p_comment_prf_0#4916, p_name_prf#4907 AS p_name_prf_0#4917, rid#4908 AS rid_0#4918, p_type_prf#4909 AS p_type_prf_0#4919, p_retailprice_prf#4910 AS p_retailprice_prf_0#4920, p_mfgr_prf#4911 AS p_mfgr_prf_0#4921, p_container_prf#4912 AS p_container_prf_0#4922, p_brand_prf#4913 AS p_brand_prf_0#4923, p_size_prf#4914 AS p_size_prf_0#4924, p_partkey_prf#4915 AS p_partkey_prf_0#4925]
         :  :  :  :  +- Relation[p_comment_prf#4906,p_name_prf#4907,rid#4908,p_type_prf#4909,p_retailprice_prf#4910,p_mfgr_prf#4911,p_container_prf#4912,p_brand_prf#4913,p_size_prf#4914,p_partkey_prf#4915] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4926, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4927]
         :  :  :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :  :  :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#4928 AS ps_partkey_and_ps_suppkey_prf_1#4935, rid#4929 AS rid_1#4936, ps_availqty_prf#4930 AS ps_availqty_prf_1#4937, ps_comment_prf#4931 AS ps_comment_prf_1#4938, ps_partkey_prf#4932 AS ps_partkey_prf_1#4939, ps_supplycost_prf#4933 AS ps_supplycost_prf_1#4940, ps_suppkey_prf#4934 AS ps_suppkey_prf_1#4941]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#4928,rid#4929,ps_availqty_prf#4930,ps_comment_prf#4931,ps_partkey_prf#4932,ps_supplycost_prf#4933,ps_suppkey_prf#4934] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4942, dexdecrypt('value_dec_key, 'value_right) AS rid_2#4943]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#4944 AS s_phone_prf_2#4952, rid#4945 AS rid_2#4953, s_address_prf#4946 AS s_address_prf_2#4954, s_nationkey_prf#4947 AS s_nationkey_prf_2#4955, s_suppkey_prf#4948 AS s_suppkey_prf_2#4956, s_name_prf#4949 AS s_name_prf_2#4957, s_acctbal_prf#4950 AS s_acctbal_prf_2#4958, s_comment_prf#4951 AS s_comment_prf_2#4959]
            +- Relation[s_phone_prf#4944,rid#4945,s_address_prf#4946,s_nationkey_prf#4947,s_suppkey_prf#4948,s_name_prf#4949,s_acctbal_prf#4950,s_comment_prf#4951] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26112ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/12 11:20:04 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 11:20:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5005L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 11:20:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5005L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#5007 AS c_acctbal_prf_0#5016, rid#5008 AS rid_0#5017, c_name_prf#5009 AS c_name_prf_0#5018, c_nationkey_prf#5010 AS c_nationkey_prf_0#5019, c_custkey_prf#5011 AS c_custkey_prf_0#5020, c_comment_prf#5012 AS c_comment_prf_0#5021, c_address_prf#5013 AS c_address_prf_0#5022, c_mktsegment_prf#5014 AS c_mktsegment_prf_0#5023, c_phone_prf#5015 AS c_phone_prf_0#5024]
         :  :  +- Relation[c_acctbal_prf#5007,rid#5008,c_name_prf#5009,c_nationkey_prf#5010,c_custkey_prf#5011,c_comment_prf#5012,c_address_prf#5013,c_mktsegment_prf#5014,c_phone_prf#5015] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5025, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5026]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#5027 AS o_shippriority_prf_1#5037, rid#5028 AS rid_1#5038, o_orderdate_prf#5029 AS o_orderdate_prf_1#5039, o_custkey_prf#5030 AS o_custkey_prf_1#5040, o_orderpriority_prf#5031 AS o_orderpriority_prf_1#5041, o_clerk_prf#5032 AS o_clerk_prf_1#5042, o_orderstatus_prf#5033 AS o_orderstatus_prf_1#5043, o_totalprice_prf#5034 AS o_totalprice_prf_1#5044, o_orderkey_prf#5035 AS o_orderkey_prf_1#5045, o_comment_prf#5036 AS o_comment_prf_1#5046]
            +- Relation[o_shippriority_prf#5027,rid#5028,o_orderdate_prf#5029,o_custkey_prf#5030,o_orderpriority_prf#5031,o_clerk_prf#5032,o_orderstatus_prf#5033,o_totalprice_prf#5034,o_orderkey_prf#5035,o_comment_prf#5036] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=1500000
Elapsed time: 23703ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/12 11:20:27 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 11:20:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5102L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 11:20:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5102L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#5104 AS l_returnflag_prf_0#5123, l_orderkey_and_l_linenumber_prf#5105 AS l_orderkey_and_l_linenumber_prf_0#5124, l_comment_prf#5106 AS l_comment_prf_0#5125, l_linestatus_prf#5107 AS l_linestatus_prf_0#5126, rid#5108 AS rid_0#5127, l_shipmode_prf#5109 AS l_shipmode_prf_0#5128, l_shipinstruct_prf#5110 AS l_shipinstruct_prf_0#5129, l_quantity_prf#5111 AS l_quantity_prf_0#5130, l_receiptdate_prf#5112 AS l_receiptdate_prf_0#5131, l_linenumber_prf#5113 AS l_linenumber_prf_0#5132, l_tax_prf#5114 AS l_tax_prf_0#5133, l_shipdate_prf#5115 AS l_shipdate_prf_0#5134, l_extendedprice_prf#5116 AS l_extendedprice_prf_0#5135, l_partkey_prf#5117 AS l_partkey_prf_0#5136, l_discount_prf#5118 AS l_discount_prf_0#5137, l_partkey_and_l_suppkey_prf#5119 AS l_partkey_and_l_suppkey_prf_0#5138, l_commitdate_prf#5120 AS l_commitdate_prf_0#5139, l_suppkey_prf#5121 AS l_suppkey_prf_0#5140, l_orderkey_prf#5122 AS l_orderkey_prf_0#5141]
         :  :  +- Relation[l_returnflag_prf#5104,l_orderkey_and_l_linenumber_prf#5105,l_comment_prf#5106,l_linestatus_prf#5107,rid#5108,l_shipmode_prf#5109,l_shipinstruct_prf#5110,l_quantity_prf#5111,l_receiptdate_prf#5112,l_linenumber_prf#5113,l_tax_prf#5114,l_shipdate_prf#5115,l_extendedprice_prf#5116,l_partkey_prf#5117,l_discount_prf#5118,l_partkey_and_l_suppkey_prf#5119,l_commitdate_prf#5120,l_suppkey_prf#5121,l_orderkey_prf#5122] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5142, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5143]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [o_shippriority_prf#5144 AS o_shippriority_prf_1#5154, rid#5145 AS rid_1#5155, o_orderdate_prf#5146 AS o_orderdate_prf_1#5156, o_custkey_prf#5147 AS o_custkey_prf_1#5157, o_orderpriority_prf#5148 AS o_orderpriority_prf_1#5158, o_clerk_prf#5149 AS o_clerk_prf_1#5159, o_orderstatus_prf#5150 AS o_orderstatus_prf_1#5160, o_totalprice_prf#5151 AS o_totalprice_prf_1#5161, o_orderkey_prf#5152 AS o_orderkey_prf_1#5162, o_comment_prf#5153 AS o_comment_prf_1#5163]
            :  :  +- Relation[o_shippriority_prf#5144,rid#5145,o_orderdate_prf#5146,o_custkey_prf#5147,o_orderpriority_prf#5148,o_clerk_prf#5149,o_orderstatus_prf#5150,o_totalprice_prf#5151,o_orderkey_prf#5152,o_comment_prf#5153] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#5164, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5165]
            :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
            :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#5166 AS c_acctbal_prf_2#5175, rid#5167 AS rid_2#5176, c_name_prf#5168 AS c_name_prf_2#5177, c_nationkey_prf#5169 AS c_nationkey_prf_2#5178, c_custkey_prf#5170 AS c_custkey_prf_2#5179, c_comment_prf#5171 AS c_comment_prf_2#5180, c_address_prf#5172 AS c_address_prf_2#5181, c_mktsegment_prf#5173 AS c_mktsegment_prf_2#5182, c_phone_prf#5174 AS c_phone_prf_2#5183]
               +- Relation[c_acctbal_prf#5166,rid#5167,c_name_prf#5168,c_nationkey_prf#5169,c_custkey_prf#5170,c_comment_prf#5171,c_address_prf#5172,c_mktsegment_prf#5173,c_phone_prf#5174] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 184876ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/12 11:23:32 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 11:23:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5244L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 11:23:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5244L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#5246 AS c_acctbal_prf_0#5255, rid#5247 AS rid_0#5256, c_name_prf#5248 AS c_name_prf_0#5257, c_nationkey_prf#5249 AS c_nationkey_prf_0#5258, c_custkey_prf#5250 AS c_custkey_prf_0#5259, c_comment_prf#5251 AS c_comment_prf_0#5260, c_address_prf#5252 AS c_address_prf_0#5261, c_mktsegment_prf#5253 AS c_mktsegment_prf_0#5262, c_phone_prf#5254 AS c_phone_prf_0#5263]
         :  :  +- Relation[c_acctbal_prf#5246,rid#5247,c_name_prf#5248,c_nationkey_prf#5249,c_custkey_prf#5250,c_comment_prf#5251,c_address_prf#5252,c_mktsegment_prf#5253,c_phone_prf#5254] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5264, dexdecrypt('value_dec_key, 'value_right) AS rid_2#5265]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [s_phone_prf#5266 AS s_phone_prf_1#5274, rid#5267 AS rid_1#5275, s_address_prf#5268 AS s_address_prf_1#5276, s_nationkey_prf#5269 AS s_nationkey_prf_1#5277, s_suppkey_prf#5270 AS s_suppkey_prf_1#5278, s_name_prf#5271 AS s_name_prf_1#5279, s_acctbal_prf#5272 AS s_acctbal_prf_1#5280, s_comment_prf#5273 AS s_comment_prf_1#5281]
            :  :  +- Relation[s_phone_prf#5266,rid#5267,s_address_prf#5268,s_nationkey_prf#5269,s_suppkey_prf#5270,s_name_prf#5271,s_acctbal_prf#5272,s_comment_prf#5273] JDBCRelation(supplier_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#5282, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5283]
            :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
            :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [rid#5284 AS rid_2#5289, n_regionkey_prf#5285 AS n_regionkey_prf_2#5290, n_nationkey_prf#5286 AS n_nationkey_prf_2#5291, n_name_prf#5287 AS n_name_prf_2#5292, n_comment_prf#5288 AS n_comment_prf_2#5293]
               +- Relation[rid#5284,n_regionkey_prf#5285,n_nationkey_prf#5286,n_name_prf#5287,n_comment_prf#5288] JDBCRelation(nation_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 903095ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/12 11:38:35 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 11:38:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5351L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 11:38:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5351L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [p_comment_prf#5353 AS p_comment_prf_0#5363, p_name_prf#5354 AS p_name_prf_0#5364, rid#5355 AS rid_0#5365, p_type_prf#5356 AS p_type_prf_0#5366, p_retailprice_prf#5357 AS p_retailprice_prf_0#5367, p_mfgr_prf#5358 AS p_mfgr_prf_0#5368, p_container_prf#5359 AS p_container_prf_0#5369, p_brand_prf#5360 AS p_brand_prf_0#5370, p_size_prf#5361 AS p_size_prf_0#5371, p_partkey_prf#5362 AS p_partkey_prf_0#5372]
         :  :  :  :  +- Relation[p_comment_prf#5353,p_name_prf#5354,rid#5355,p_type_prf#5356,p_retailprice_prf#5357,p_mfgr_prf#5358,p_container_prf#5359,p_brand_prf#5360,p_size_prf#5361,p_partkey_prf#5362] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#5373, dexdecrypt('value_dec_key, 'value_right) AS rid_0#5374]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :  :  :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#5375 AS l_returnflag_prf_1#5394, l_orderkey_and_l_linenumber_prf#5376 AS l_orderkey_and_l_linenumber_prf_1#5395, l_comment_prf#5377 AS l_comment_prf_1#5396, l_linestatus_prf#5378 AS l_linestatus_prf_1#5397, rid#5379 AS rid_1#5398, l_shipmode_prf#5380 AS l_shipmode_prf_1#5399, l_shipinstruct_prf#5381 AS l_shipinstruct_prf_1#5400, l_quantity_prf#5382 AS l_quantity_prf_1#5401, l_receiptdate_prf#5383 AS l_receiptdate_prf_1#5402, l_linenumber_prf#5384 AS l_linenumber_prf_1#5403, l_tax_prf#5385 AS l_tax_prf_1#5404, l_shipdate_prf#5386 AS l_shipdate_prf_1#5405, l_extendedprice_prf#5387 AS l_extendedprice_prf_1#5406, l_partkey_prf#5388 AS l_partkey_prf_1#5407, l_discount_prf#5389 AS l_discount_prf_1#5408, l_partkey_and_l_suppkey_prf#5390 AS l_partkey_and_l_suppkey_prf_1#5409, l_commitdate_prf#5391 AS l_commitdate_prf_1#5410, l_suppkey_prf#5392 AS l_suppkey_prf_1#5411, l_orderkey_prf#5393 AS l_orderkey_prf_1#5412]
         :  :     +- Relation[l_returnflag_prf#5375,l_orderkey_and_l_linenumber_prf#5376,l_comment_prf#5377,l_linestatus_prf#5378,rid#5379,l_shipmode_prf#5380,l_shipinstruct_prf#5381,l_quantity_prf#5382,l_receiptdate_prf#5383,l_linenumber_prf#5384,l_tax_prf#5385,l_shipdate_prf#5386,l_extendedprice_prf#5387,l_partkey_prf#5388,l_discount_prf#5389,l_partkey_and_l_suppkey_prf#5390,l_commitdate_prf#5391,l_suppkey_prf#5392,l_orderkey_prf#5393] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#5413, dexdecrypt('value_dec_key, 'value_right) AS rid_2#5414]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1589,value_left#1590,value_right#1591] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#5415 AS s_phone_prf_2#5423, rid#5416 AS rid_2#5424, s_address_prf#5417 AS s_address_prf_2#5425, s_nationkey_prf#5418 AS s_nationkey_prf_2#5426, s_suppkey_prf#5419 AS s_suppkey_prf_2#5427, s_name_prf#5420 AS s_name_prf_2#5428, s_acctbal_prf#5421 AS s_acctbal_prf_2#5429, s_comment_prf#5422 AS s_comment_prf_2#5430]
            +- Relation[s_phone_prf#5415,rid#5416,s_address_prf#5417,s_nationkey_prf#5418,s_suppkey_prf#5419,s_name_prf#5420,s_acctbal_prf#5421,s_comment_prf#5422] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201252ms
query=b1a, count=15628, duration=7770
query=b1b, count=15628, duration=7747
query=b2a, count=1478870, duration=98623
query=b2b, count=1478870, duration=97917
query=f1, count=1, duration=54
query=f2, count=3907, duration=127
query=f3, count=1451, duration=82
query=f4, count=1, duration=60
query=f5, count=1478870, duration=23499
query=f6, count=857401, duration=13721
query=j1, count=800000, duration=12134
query=j10, count=6001215, duration=89247
query=j2, count=800000, duration=11794
query=j3, count=25, duration=66
query=j4, count=150000, duration=2528
query=j5, count=10000, duration=230
query=j6, count=6001215, duration=105767
query=j7, count=1500000, duration=23703
query=j8, count=6001215, duration=106958
query=j8b, count=6001215, duration=106759
query=j9, count=6001215, duration=94975
query=j9b, count=6001215, duration=95486
query=r1a, count=6001215, duration=183910
query=r1b, count=6001215, duration=184876
query=r1c, count=6001215, duration=183538
query=r1d, count=6001215, duration=169360
query=r1e, count=6001215, duration=169297
query=r1f, count=6001215, duration=142933
query=t1a, count=60000414, duration=889581
query=t1b, count=60000414, duration=886813
query=t1c, count=60000414, duration=903095
query=t2a, count=800000, duration=26266
query=t2b, count=800000, duration=26112
query=t2c, count=800000, duration=26199
query=t2d, count=800000, duration=26117
query=t3a, count=6001215, duration=201942
query=t3b, count=6001215, duration=201252
query=t3c, count=6001215, duration=201195
query=t3d, count=6001215, duration=200583
