19/10/12 11:41:58 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7098ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Oct 12 11:42:00 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Oct 12 11:42:01 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Oct 12 11:42:01 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Oct 12 11:42:01 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Oct 12 11:42:01 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Oct 12 11:42:04 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Oct 12 11:42:06 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Oct 12 11:42:06 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/12 11:42:07 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 11:42:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1496L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 11:42:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1496L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [o_shippriority_prf#1498 AS o_shippriority_prf_0#1508, rid#1499 AS rid_0#1509, o_orderdate_prf#1500 AS o_orderdate_prf_0#1510, o_custkey_prf#1501 AS o_custkey_prf_0#1511, o_orderpriority_prf#1502 AS o_orderpriority_prf_0#1512, o_clerk_prf#1503 AS o_clerk_prf_0#1513, o_orderstatus_prf#1504 AS o_orderstatus_prf_0#1514, o_totalprice_prf#1505 AS o_totalprice_prf_0#1515, o_orderkey_prf#1506 AS o_orderkey_prf_0#1516, o_comment_prf#1507 AS o_comment_prf_0#1517]
         :  :  +- Relation[o_shippriority_prf#1498,rid#1499,o_orderdate_prf#1500,o_custkey_prf#1501,o_orderpriority_prf#1502,o_clerk_prf#1503,o_orderstatus_prf#1504,o_totalprice_prf#1505,o_orderkey_prf#1506,o_comment_prf#1507] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1521, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1522]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#1523 AS l_returnflag_prf_1#1542, l_orderkey_and_l_linenumber_prf#1524 AS l_orderkey_and_l_linenumber_prf_1#1543, l_comment_prf#1525 AS l_comment_prf_1#1544, l_linestatus_prf#1526 AS l_linestatus_prf_1#1545, rid#1527 AS rid_1#1546, l_shipmode_prf#1528 AS l_shipmode_prf_1#1547, l_shipinstruct_prf#1529 AS l_shipinstruct_prf_1#1548, l_quantity_prf#1530 AS l_quantity_prf_1#1549, l_receiptdate_prf#1531 AS l_receiptdate_prf_1#1550, l_linenumber_prf#1532 AS l_linenumber_prf_1#1551, l_tax_prf#1533 AS l_tax_prf_1#1552, l_shipdate_prf#1534 AS l_shipdate_prf_1#1553, l_extendedprice_prf#1535 AS l_extendedprice_prf_1#1554, l_partkey_prf#1536 AS l_partkey_prf_1#1555, l_discount_prf#1537 AS l_discount_prf_1#1556, l_partkey_and_l_suppkey_prf#1538 AS l_partkey_and_l_suppkey_prf_1#1557, l_commitdate_prf#1539 AS l_commitdate_prf_1#1558, l_suppkey_prf#1540 AS l_suppkey_prf_1#1559, l_orderkey_prf#1541 AS l_orderkey_prf_1#1560]
            :  +- Relation[l_returnflag_prf#1523,l_orderkey_and_l_linenumber_prf#1524,l_comment_prf#1525,l_linestatus_prf#1526,rid#1527,l_shipmode_prf#1528,l_shipinstruct_prf#1529,l_quantity_prf#1530,l_receiptdate_prf#1531,l_linenumber_prf#1532,l_tax_prf#1533,l_shipdate_prf#1534,l_extendedprice_prf#1535,l_partkey_prf#1536,l_discount_prf#1537,l_partkey_and_l_suppkey_prf#1538,l_commitdate_prf#1539,l_suppkey_prf#1540,l_orderkey_prf#1541] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#1563]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1561,value#1562] JDBCRelation(t_filter) [numPartitions=1]

19/10/12 11:42:07 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexSpx$ result size=1478870
Elapsed time: 98241ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/12 11:43:45 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 11:43:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1612L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 11:43:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1612L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#1614 AS l_returnflag_prf_0#1633, l_orderkey_and_l_linenumber_prf#1615 AS l_orderkey_and_l_linenumber_prf_0#1634, l_comment_prf#1616 AS l_comment_prf_0#1635, l_linestatus_prf#1617 AS l_linestatus_prf_0#1636, rid#1618 AS rid_0#1637, l_shipmode_prf#1619 AS l_shipmode_prf_0#1638, l_shipinstruct_prf#1620 AS l_shipinstruct_prf_0#1639, l_quantity_prf#1621 AS l_quantity_prf_0#1640, l_receiptdate_prf#1622 AS l_receiptdate_prf_0#1641, l_linenumber_prf#1623 AS l_linenumber_prf_0#1642, l_tax_prf#1624 AS l_tax_prf_0#1643, l_shipdate_prf#1625 AS l_shipdate_prf_0#1644, l_extendedprice_prf#1626 AS l_extendedprice_prf_0#1645, l_partkey_prf#1627 AS l_partkey_prf_0#1646, l_discount_prf#1628 AS l_discount_prf_0#1647, l_partkey_and_l_suppkey_prf#1629 AS l_partkey_and_l_suppkey_prf_0#1648, l_commitdate_prf#1630 AS l_commitdate_prf_0#1649, l_suppkey_prf#1631 AS l_suppkey_prf_0#1650, l_orderkey_prf#1632 AS l_orderkey_prf_0#1651]
         :  +- Relation[l_returnflag_prf#1614,l_orderkey_and_l_linenumber_prf#1615,l_comment_prf#1616,l_linestatus_prf#1617,rid#1618,l_shipmode_prf#1619,l_shipinstruct_prf#1620,l_quantity_prf#1621,l_receiptdate_prf#1622,l_linenumber_prf#1623,l_tax_prf#1624,l_shipdate_prf#1625,l_extendedprice_prf#1626,l_partkey_prf#1627,l_discount_prf#1628,l_partkey_and_l_suppkey_prf#1629,l_commitdate_prf#1630,l_suppkey_prf#1631,l_orderkey_prf#1632] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1652]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1561,value#1562] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 23501ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/12 11:44:09 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 11:44:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1696L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 11:44:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1696L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [p_comment_prf#1698 AS p_comment_prf_0#1708, p_name_prf#1699 AS p_name_prf_0#1709, rid#1700 AS rid_0#1710, p_type_prf#1701 AS p_type_prf_0#1711, p_retailprice_prf#1702 AS p_retailprice_prf_0#1712, p_mfgr_prf#1703 AS p_mfgr_prf_0#1713, p_container_prf#1704 AS p_container_prf_0#1714, p_brand_prf#1705 AS p_brand_prf_0#1715, p_size_prf#1706 AS p_size_prf_0#1716, p_partkey_prf#1707 AS p_partkey_prf_0#1717]
         :  :  :  :  +- Relation[p_comment_prf#1698,p_name_prf#1699,rid#1700,p_type_prf#1701,p_retailprice_prf#1702,p_mfgr_prf#1703,p_container_prf#1704,p_brand_prf#1705,p_size_prf#1706,p_partkey_prf#1707] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1718, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1719]
         :  :  :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :  :  :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#1720 AS ps_partkey_and_ps_suppkey_prf_1#1727, rid#1721 AS rid_1#1728, ps_availqty_prf#1722 AS ps_availqty_prf_1#1729, ps_comment_prf#1723 AS ps_comment_prf_1#1730, ps_partkey_prf#1724 AS ps_partkey_prf_1#1731, ps_supplycost_prf#1725 AS ps_supplycost_prf_1#1732, ps_suppkey_prf#1726 AS ps_suppkey_prf_1#1733]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#1720,rid#1721,ps_availqty_prf#1722,ps_comment_prf#1723,ps_partkey_prf#1724,ps_supplycost_prf#1725,ps_suppkey_prf#1726] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1734, dexdecrypt('value_dec_key, 'value_right) AS rid_2#1735]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#1736 AS s_phone_prf_2#1744, rid#1737 AS rid_2#1745, s_address_prf#1738 AS s_address_prf_2#1746, s_nationkey_prf#1739 AS s_nationkey_prf_2#1747, s_suppkey_prf#1740 AS s_suppkey_prf_2#1748, s_name_prf#1741 AS s_name_prf_2#1749, s_acctbal_prf#1742 AS s_acctbal_prf_2#1750, s_comment_prf#1743 AS s_comment_prf_2#1751]
            +- Relation[s_phone_prf#1736,rid#1737,s_address_prf#1738,s_nationkey_prf#1739,s_suppkey_prf#1740,s_name_prf#1741,s_acctbal_prf#1742,s_comment_prf#1743] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26270ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/12 11:44:35 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 11:44:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1799L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 11:44:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1799L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#1801 AS c_acctbal_prf_0#1810, rid#1802 AS rid_0#1811, c_name_prf#1803 AS c_name_prf_0#1812, c_nationkey_prf#1804 AS c_nationkey_prf_0#1813, c_custkey_prf#1805 AS c_custkey_prf_0#1814, c_comment_prf#1806 AS c_comment_prf_0#1815, c_address_prf#1807 AS c_address_prf_0#1816, c_mktsegment_prf#1808 AS c_mktsegment_prf_0#1817, c_phone_prf#1809 AS c_phone_prf_0#1818]
         :  :  +- Relation[c_acctbal_prf#1801,rid#1802,c_name_prf#1803,c_nationkey_prf#1804,c_custkey_prf#1805,c_comment_prf#1806,c_address_prf#1807,c_mktsegment_prf#1808,c_phone_prf#1809] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1819, dexdecrypt('value_dec_key, 'value_right) AS rid_2#1820]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [s_phone_prf#1821 AS s_phone_prf_1#1829, rid#1822 AS rid_1#1830, s_address_prf#1823 AS s_address_prf_1#1831, s_nationkey_prf#1824 AS s_nationkey_prf_1#1832, s_suppkey_prf#1825 AS s_suppkey_prf_1#1833, s_name_prf#1826 AS s_name_prf_1#1834, s_acctbal_prf#1827 AS s_acctbal_prf_1#1835, s_comment_prf#1828 AS s_comment_prf_1#1836]
            :  :  +- Relation[s_phone_prf#1821,rid#1822,s_address_prf#1823,s_nationkey_prf#1824,s_suppkey_prf#1825,s_name_prf#1826,s_acctbal_prf#1827,s_comment_prf#1828] JDBCRelation(supplier_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#1837, dexdecrypt('value_dec_key, 'value_right) AS rid_1#1838]
            :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
            :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [rid#1839 AS rid_2#1844, n_regionkey_prf#1840 AS n_regionkey_prf_2#1845, n_nationkey_prf#1841 AS n_nationkey_prf_2#1846, n_name_prf#1842 AS n_name_prf_2#1847, n_comment_prf#1843 AS n_comment_prf_2#1848]
               +- Relation[rid#1839,n_regionkey_prf#1840,n_nationkey_prf#1841,n_name_prf#1842,n_comment_prf#1843] JDBCRelation(nation_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 925342ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/12 12:00:00 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:00:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1886L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 12:00:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1886L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [rid#1888 AS rid_0#1893, n_regionkey_prf#1889 AS n_regionkey_prf_0#1894, n_nationkey_prf#1890 AS n_nationkey_prf_0#1895, n_name_prf#1891 AS n_name_prf_0#1896, n_comment_prf#1892 AS n_comment_prf_0#1897]
         :  :  +- Relation[rid#1888,n_regionkey_prf#1889,n_nationkey_prf#1890,n_name_prf#1891,n_comment_prf#1892] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1898, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1899]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#1900 AS c_acctbal_prf_1#1909, rid#1901 AS rid_1#1910, c_name_prf#1902 AS c_name_prf_1#1911, c_nationkey_prf#1903 AS c_nationkey_prf_1#1912, c_custkey_prf#1904 AS c_custkey_prf_1#1913, c_comment_prf#1905 AS c_comment_prf_1#1914, c_address_prf#1906 AS c_address_prf_1#1915, c_mktsegment_prf#1907 AS c_mktsegment_prf_1#1916, c_phone_prf#1908 AS c_phone_prf_1#1917]
            +- Relation[c_acctbal_prf#1900,rid#1901,c_name_prf#1902,c_nationkey_prf#1903,c_custkey_prf#1904,c_comment_prf#1905,c_address_prf#1906,c_mktsegment_prf#1907,c_phone_prf#1908] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=150000
Elapsed time: 2536ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/12 12:00:03 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:00:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1956L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 12:00:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1956L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [ps_partkey_and_ps_suppkey_prf#1958 AS ps_partkey_and_ps_suppkey_prf_0#1965, rid#1959 AS rid_0#1966, ps_availqty_prf#1960 AS ps_availqty_prf_0#1967, ps_comment_prf#1961 AS ps_comment_prf_0#1968, ps_partkey_prf#1962 AS ps_partkey_prf_0#1969, ps_supplycost_prf#1963 AS ps_supplycost_prf_0#1970, ps_suppkey_prf#1964 AS ps_suppkey_prf_0#1971]
         :  :  :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#1958,rid#1959,ps_availqty_prf#1960,ps_comment_prf#1961,ps_partkey_prf#1962,ps_supplycost_prf#1963,ps_suppkey_prf#1964] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#1972, dexdecrypt('value_dec_key, 'value_right) AS rid_0#1973]
         :  :  :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :  :  :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#1974 AS p_comment_prf_1#1984, p_name_prf#1975 AS p_name_prf_1#1985, rid#1976 AS rid_1#1986, p_type_prf#1977 AS p_type_prf_1#1987, p_retailprice_prf#1978 AS p_retailprice_prf_1#1988, p_mfgr_prf#1979 AS p_mfgr_prf_1#1989, p_container_prf#1980 AS p_container_prf_1#1990, p_brand_prf#1981 AS p_brand_prf_1#1991, p_size_prf#1982 AS p_size_prf_1#1992, p_partkey_prf#1983 AS p_partkey_prf_1#1993]
         :  :     +- Relation[p_comment_prf#1974,p_name_prf#1975,rid#1976,p_type_prf#1977,p_retailprice_prf#1978,p_mfgr_prf#1979,p_container_prf#1980,p_brand_prf#1981,p_size_prf#1982,p_partkey_prf#1983] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#1994, dexdecrypt('value_dec_key, 'value_right) AS rid_2#1995]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#1996 AS s_phone_prf_2#2004, rid#1997 AS rid_2#2005, s_address_prf#1998 AS s_address_prf_2#2006, s_nationkey_prf#1999 AS s_nationkey_prf_2#2007, s_suppkey_prf#2000 AS s_suppkey_prf_2#2008, s_name_prf#2001 AS s_name_prf_2#2009, s_acctbal_prf#2002 AS s_acctbal_prf_2#2010, s_comment_prf#2003 AS s_comment_prf_2#2011]
            +- Relation[s_phone_prf#1996,rid#1997,s_address_prf#1998,s_nationkey_prf#1999,s_suppkey_prf#2000,s_name_prf#2001,s_acctbal_prf#2002,s_comment_prf#2003] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26131ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/12 12:00:29 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:00:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2072L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 12:00:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2072L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [p_comment_prf#2074 AS p_comment_prf_0#2084, p_name_prf#2075 AS p_name_prf_0#2085, rid#2076 AS rid_0#2086, p_type_prf#2077 AS p_type_prf_0#2087, p_retailprice_prf#2078 AS p_retailprice_prf_0#2088, p_mfgr_prf#2079 AS p_mfgr_prf_0#2089, p_container_prf#2080 AS p_container_prf_0#2090, p_brand_prf#2081 AS p_brand_prf_0#2091, p_size_prf#2082 AS p_size_prf_0#2092, p_partkey_prf#2083 AS p_partkey_prf_0#2093]
         :  :  :  :  +- Relation[p_comment_prf#2074,p_name_prf#2075,rid#2076,p_type_prf#2077,p_retailprice_prf#2078,p_mfgr_prf#2079,p_container_prf#2080,p_brand_prf#2081,p_size_prf#2082,p_partkey_prf#2083] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2094, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2095]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :  :  :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#2096 AS l_returnflag_prf_1#2115, l_orderkey_and_l_linenumber_prf#2097 AS l_orderkey_and_l_linenumber_prf_1#2116, l_comment_prf#2098 AS l_comment_prf_1#2117, l_linestatus_prf#2099 AS l_linestatus_prf_1#2118, rid#2100 AS rid_1#2119, l_shipmode_prf#2101 AS l_shipmode_prf_1#2120, l_shipinstruct_prf#2102 AS l_shipinstruct_prf_1#2121, l_quantity_prf#2103 AS l_quantity_prf_1#2122, l_receiptdate_prf#2104 AS l_receiptdate_prf_1#2123, l_linenumber_prf#2105 AS l_linenumber_prf_1#2124, l_tax_prf#2106 AS l_tax_prf_1#2125, l_shipdate_prf#2107 AS l_shipdate_prf_1#2126, l_extendedprice_prf#2108 AS l_extendedprice_prf_1#2127, l_partkey_prf#2109 AS l_partkey_prf_1#2128, l_discount_prf#2110 AS l_discount_prf_1#2129, l_partkey_and_l_suppkey_prf#2111 AS l_partkey_and_l_suppkey_prf_1#2130, l_commitdate_prf#2112 AS l_commitdate_prf_1#2131, l_suppkey_prf#2113 AS l_suppkey_prf_1#2132, l_orderkey_prf#2114 AS l_orderkey_prf_1#2133]
         :  :     +- Relation[l_returnflag_prf#2096,l_orderkey_and_l_linenumber_prf#2097,l_comment_prf#2098,l_linestatus_prf#2099,rid#2100,l_shipmode_prf#2101,l_shipinstruct_prf#2102,l_quantity_prf#2103,l_receiptdate_prf#2104,l_linenumber_prf#2105,l_tax_prf#2106,l_shipdate_prf#2107,l_extendedprice_prf#2108,l_partkey_prf#2109,l_discount_prf#2110,l_partkey_and_l_suppkey_prf#2111,l_commitdate_prf#2112,l_suppkey_prf#2113,l_orderkey_prf#2114] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2134, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2135]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#2136 AS s_phone_prf_2#2144, rid#2137 AS rid_2#2145, s_address_prf#2138 AS s_address_prf_2#2146, s_nationkey_prf#2139 AS s_nationkey_prf_2#2147, s_suppkey_prf#2140 AS s_suppkey_prf_2#2148, s_name_prf#2141 AS s_name_prf_2#2149, s_acctbal_prf#2142 AS s_acctbal_prf_2#2150, s_comment_prf#2143 AS s_comment_prf_2#2151]
            +- Relation[s_phone_prf#2136,rid#2137,s_address_prf#2138,s_nationkey_prf#2139,s_suppkey_prf#2140,s_name_prf#2141,s_acctbal_prf#2142,s_comment_prf#2143] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201296ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/12 12:03:50 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:03:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2225L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 12:03:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2225L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#2227 AS c_acctbal_prf_0#2236, rid#2228 AS rid_0#2237, c_name_prf#2229 AS c_name_prf_0#2238, c_nationkey_prf#2230 AS c_nationkey_prf_0#2239, c_custkey_prf#2231 AS c_custkey_prf_0#2240, c_comment_prf#2232 AS c_comment_prf_0#2241, c_address_prf#2233 AS c_address_prf_0#2242, c_mktsegment_prf#2234 AS c_mktsegment_prf_0#2243, c_phone_prf#2235 AS c_phone_prf_0#2244]
         :  :  +- Relation[c_acctbal_prf#2227,rid#2228,c_name_prf#2229,c_nationkey_prf#2230,c_custkey_prf#2231,c_comment_prf#2232,c_address_prf#2233,c_mktsegment_prf#2234,c_phone_prf#2235] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2245, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2246]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [o_shippriority_prf#2247 AS o_shippriority_prf_1#2257, rid#2248 AS rid_1#2258, o_orderdate_prf#2249 AS o_orderdate_prf_1#2259, o_custkey_prf#2250 AS o_custkey_prf_1#2260, o_orderpriority_prf#2251 AS o_orderpriority_prf_1#2261, o_clerk_prf#2252 AS o_clerk_prf_1#2262, o_orderstatus_prf#2253 AS o_orderstatus_prf_1#2263, o_totalprice_prf#2254 AS o_totalprice_prf_1#2264, o_orderkey_prf#2255 AS o_orderkey_prf_1#2265, o_comment_prf#2256 AS o_comment_prf_1#2266]
            :  :  +- Relation[o_shippriority_prf#2247,rid#2248,o_orderdate_prf#2249,o_custkey_prf#2250,o_orderpriority_prf#2251,o_clerk_prf#2252,o_orderstatus_prf#2253,o_totalprice_prf#2254,o_orderkey_prf#2255,o_comment_prf#2256] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2267, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2268]
            :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
            :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2269 AS l_returnflag_prf_2#2288, l_orderkey_and_l_linenumber_prf#2270 AS l_orderkey_and_l_linenumber_prf_2#2289, l_comment_prf#2271 AS l_comment_prf_2#2290, l_linestatus_prf#2272 AS l_linestatus_prf_2#2291, rid#2273 AS rid_2#2292, l_shipmode_prf#2274 AS l_shipmode_prf_2#2293, l_shipinstruct_prf#2275 AS l_shipinstruct_prf_2#2294, l_quantity_prf#2276 AS l_quantity_prf_2#2295, l_receiptdate_prf#2277 AS l_receiptdate_prf_2#2296, l_linenumber_prf#2278 AS l_linenumber_prf_2#2297, l_tax_prf#2279 AS l_tax_prf_2#2298, l_shipdate_prf#2280 AS l_shipdate_prf_2#2299, l_extendedprice_prf#2281 AS l_extendedprice_prf_2#2300, l_partkey_prf#2282 AS l_partkey_prf_2#2301, l_discount_prf#2283 AS l_discount_prf_2#2302, l_partkey_and_l_suppkey_prf#2284 AS l_partkey_and_l_suppkey_prf_2#2303, l_commitdate_prf#2285 AS l_commitdate_prf_2#2304, l_suppkey_prf#2286 AS l_suppkey_prf_2#2305, l_orderkey_prf#2287 AS l_orderkey_prf_2#2306]
               +- Relation[l_returnflag_prf#2269,l_orderkey_and_l_linenumber_prf#2270,l_comment_prf#2271,l_linestatus_prf#2272,rid#2273,l_shipmode_prf#2274,l_shipinstruct_prf#2275,l_quantity_prf#2276,l_receiptdate_prf#2277,l_linenumber_prf#2278,l_tax_prf#2279,l_shipdate_prf#2280,l_extendedprice_prf#2281,l_partkey_prf#2282,l_discount_prf#2283,l_partkey_and_l_suppkey_prf#2284,l_commitdate_prf#2285,l_suppkey_prf#2286,l_orderkey_prf#2287] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 168795ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/12 12:06:39 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:06:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2380L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 12:06:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2380L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#2382 AS s_phone_prf_0#2390, rid#2383 AS rid_0#2391, s_address_prf#2384 AS s_address_prf_0#2392, s_nationkey_prf#2385 AS s_nationkey_prf_0#2393, s_suppkey_prf#2386 AS s_suppkey_prf_0#2394, s_name_prf#2387 AS s_name_prf_0#2395, s_acctbal_prf#2388 AS s_acctbal_prf_0#2396, s_comment_prf#2389 AS s_comment_prf_0#2397]
         :  :  +- Relation[s_phone_prf#2382,rid#2383,s_address_prf#2384,s_nationkey_prf#2385,s_suppkey_prf#2386,s_name_prf#2387,s_acctbal_prf#2388,s_comment_prf#2389] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2398, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2399]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [p_comment_prf#2400 AS p_comment_prf_1#2410, p_name_prf#2401 AS p_name_prf_1#2411, rid#2402 AS rid_1#2412, p_type_prf#2403 AS p_type_prf_1#2413, p_retailprice_prf#2404 AS p_retailprice_prf_1#2414, p_mfgr_prf#2405 AS p_mfgr_prf_1#2415, p_container_prf#2406 AS p_container_prf_1#2416, p_brand_prf#2407 AS p_brand_prf_1#2417, p_size_prf#2408 AS p_size_prf_1#2418, p_partkey_prf#2409 AS p_partkey_prf_1#2419]
            :  :  +- Relation[p_comment_prf#2400,p_name_prf#2401,rid#2402,p_type_prf#2403,p_retailprice_prf#2404,p_mfgr_prf#2405,p_container_prf#2406,p_brand_prf#2407,p_size_prf#2408,p_partkey_prf#2409] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#2420, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2421]
            :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
            :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2422 AS l_returnflag_prf_2#2441, l_orderkey_and_l_linenumber_prf#2423 AS l_orderkey_and_l_linenumber_prf_2#2442, l_comment_prf#2424 AS l_comment_prf_2#2443, l_linestatus_prf#2425 AS l_linestatus_prf_2#2444, rid#2426 AS rid_2#2445, l_shipmode_prf#2427 AS l_shipmode_prf_2#2446, l_shipinstruct_prf#2428 AS l_shipinstruct_prf_2#2447, l_quantity_prf#2429 AS l_quantity_prf_2#2448, l_receiptdate_prf#2430 AS l_receiptdate_prf_2#2449, l_linenumber_prf#2431 AS l_linenumber_prf_2#2450, l_tax_prf#2432 AS l_tax_prf_2#2451, l_shipdate_prf#2433 AS l_shipdate_prf_2#2452, l_extendedprice_prf#2434 AS l_extendedprice_prf_2#2453, l_partkey_prf#2435 AS l_partkey_prf_2#2454, l_discount_prf#2436 AS l_discount_prf_2#2455, l_partkey_and_l_suppkey_prf#2437 AS l_partkey_and_l_suppkey_prf_2#2456, l_commitdate_prf#2438 AS l_commitdate_prf_2#2457, l_suppkey_prf#2439 AS l_suppkey_prf_2#2458, l_orderkey_prf#2440 AS l_orderkey_prf_2#2459]
               +- Relation[l_returnflag_prf#2422,l_orderkey_and_l_linenumber_prf#2423,l_comment_prf#2424,l_linestatus_prf#2425,rid#2426,l_shipmode_prf#2427,l_shipinstruct_prf#2428,l_quantity_prf#2429,l_receiptdate_prf#2430,l_linenumber_prf#2431,l_tax_prf#2432,l_shipdate_prf#2433,l_extendedprice_prf#2434,l_partkey_prf#2435,l_discount_prf#2436,l_partkey_and_l_suppkey_prf#2437,l_commitdate_prf#2438,l_suppkey_prf#2439,l_orderkey_prf#2440] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 202310ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/12 12:10:02 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:10:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2525L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 12:10:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2525L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [o_shippriority_prf#2527 AS o_shippriority_prf_0#2537, rid#2528 AS rid_0#2538, o_orderdate_prf#2529 AS o_orderdate_prf_0#2539, o_custkey_prf#2530 AS o_custkey_prf_0#2540, o_orderpriority_prf#2531 AS o_orderpriority_prf_0#2541, o_clerk_prf#2532 AS o_clerk_prf_0#2542, o_orderstatus_prf#2533 AS o_orderstatus_prf_0#2543, o_totalprice_prf#2534 AS o_totalprice_prf_0#2544, o_orderkey_prf#2535 AS o_orderkey_prf_0#2545, o_comment_prf#2536 AS o_comment_prf_0#2546]
         :  :  +- Relation[o_shippriority_prf#2527,rid#2528,o_orderdate_prf#2529,o_custkey_prf#2530,o_orderpriority_prf#2531,o_clerk_prf#2532,o_orderstatus_prf#2533,o_totalprice_prf#2534,o_orderkey_prf#2535,o_comment_prf#2536] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2547, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2548]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2549 AS l_returnflag_prf_1#2568, l_orderkey_and_l_linenumber_prf#2550 AS l_orderkey_and_l_linenumber_prf_1#2569, l_comment_prf#2551 AS l_comment_prf_1#2570, l_linestatus_prf#2552 AS l_linestatus_prf_1#2571, rid#2553 AS rid_1#2572, l_shipmode_prf#2554 AS l_shipmode_prf_1#2573, l_shipinstruct_prf#2555 AS l_shipinstruct_prf_1#2574, l_quantity_prf#2556 AS l_quantity_prf_1#2575, l_receiptdate_prf#2557 AS l_receiptdate_prf_1#2576, l_linenumber_prf#2558 AS l_linenumber_prf_1#2577, l_tax_prf#2559 AS l_tax_prf_1#2578, l_shipdate_prf#2560 AS l_shipdate_prf_1#2579, l_extendedprice_prf#2561 AS l_extendedprice_prf_1#2580, l_partkey_prf#2562 AS l_partkey_prf_1#2581, l_discount_prf#2563 AS l_discount_prf_1#2582, l_partkey_and_l_suppkey_prf#2564 AS l_partkey_and_l_suppkey_prf_1#2583, l_commitdate_prf#2565 AS l_commitdate_prf_1#2584, l_suppkey_prf#2566 AS l_suppkey_prf_1#2585, l_orderkey_prf#2567 AS l_orderkey_prf_1#2586]
            +- Relation[l_returnflag_prf#2549,l_orderkey_and_l_linenumber_prf#2550,l_comment_prf#2551,l_linestatus_prf#2552,rid#2553,l_shipmode_prf#2554,l_shipinstruct_prf#2555,l_quantity_prf#2556,l_receiptdate_prf#2557,l_linenumber_prf#2558,l_tax_prf#2559,l_shipdate_prf#2560,l_extendedprice_prf#2561,l_partkey_prf#2562,l_discount_prf#2563,l_partkey_and_l_suppkey_prf#2564,l_commitdate_prf#2565,l_suppkey_prf#2566,l_orderkey_prf#2567] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 107238ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/12 12:11:49 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:11:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2633L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 12:11:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2633L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [p_comment_prf#2635 AS p_comment_prf_0#2645, p_name_prf#2636 AS p_name_prf_0#2646, rid#2637 AS rid_0#2647, p_type_prf#2638 AS p_type_prf_0#2648, p_retailprice_prf#2639 AS p_retailprice_prf_0#2649, p_mfgr_prf#2640 AS p_mfgr_prf_0#2650, p_container_prf#2641 AS p_container_prf_0#2651, p_brand_prf#2642 AS p_brand_prf_0#2652, p_size_prf#2643 AS p_size_prf_0#2653, p_partkey_prf#2644 AS p_partkey_prf_0#2654]
         :  :  +- Relation[p_comment_prf#2635,p_name_prf#2636,rid#2637,p_type_prf#2638,p_retailprice_prf#2639,p_mfgr_prf#2640,p_container_prf#2641,p_brand_prf#2642,p_size_prf#2643,p_partkey_prf#2644] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2655, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2656]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2657 AS ps_partkey_and_ps_suppkey_prf_1#2664, rid#2658 AS rid_1#2665, ps_availqty_prf#2659 AS ps_availqty_prf_1#2666, ps_comment_prf#2660 AS ps_comment_prf_1#2667, ps_partkey_prf#2661 AS ps_partkey_prf_1#2668, ps_supplycost_prf#2662 AS ps_supplycost_prf_1#2669, ps_suppkey_prf#2663 AS ps_suppkey_prf_1#2670]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2657,rid#2658,ps_availqty_prf#2659,ps_comment_prf#2660,ps_partkey_prf#2661,ps_supplycost_prf#2662,ps_suppkey_prf#2663] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 12318ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/12 12:12:01 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:12:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2723L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 12:12:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2723L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#2725 AS s_phone_prf_0#2733, rid#2726 AS rid_0#2734, s_address_prf#2727 AS s_address_prf_0#2735, s_nationkey_prf#2728 AS s_nationkey_prf_0#2736, s_suppkey_prf#2729 AS s_suppkey_prf_0#2737, s_name_prf#2730 AS s_name_prf_0#2738, s_acctbal_prf#2731 AS s_acctbal_prf_0#2739, s_comment_prf#2732 AS s_comment_prf_0#2740]
         :  :  +- Relation[s_phone_prf#2725,rid#2726,s_address_prf#2727,s_nationkey_prf#2728,s_suppkey_prf#2729,s_name_prf#2730,s_acctbal_prf#2731,s_comment_prf#2732] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2741, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2742]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [l_returnflag_prf#2743 AS l_returnflag_prf_1#2762, l_orderkey_and_l_linenumber_prf#2744 AS l_orderkey_and_l_linenumber_prf_1#2763, l_comment_prf#2745 AS l_comment_prf_1#2764, l_linestatus_prf#2746 AS l_linestatus_prf_1#2765, rid#2747 AS rid_1#2766, l_shipmode_prf#2748 AS l_shipmode_prf_1#2767, l_shipinstruct_prf#2749 AS l_shipinstruct_prf_1#2768, l_quantity_prf#2750 AS l_quantity_prf_1#2769, l_receiptdate_prf#2751 AS l_receiptdate_prf_1#2770, l_linenumber_prf#2752 AS l_linenumber_prf_1#2771, l_tax_prf#2753 AS l_tax_prf_1#2772, l_shipdate_prf#2754 AS l_shipdate_prf_1#2773, l_extendedprice_prf#2755 AS l_extendedprice_prf_1#2774, l_partkey_prf#2756 AS l_partkey_prf_1#2775, l_discount_prf#2757 AS l_discount_prf_1#2776, l_partkey_and_l_suppkey_prf#2758 AS l_partkey_and_l_suppkey_prf_1#2777, l_commitdate_prf#2759 AS l_commitdate_prf_1#2778, l_suppkey_prf#2760 AS l_suppkey_prf_1#2779, l_orderkey_prf#2761 AS l_orderkey_prf_1#2780]
            :  :  +- Relation[l_returnflag_prf#2743,l_orderkey_and_l_linenumber_prf#2744,l_comment_prf#2745,l_linestatus_prf#2746,rid#2747,l_shipmode_prf#2748,l_shipinstruct_prf#2749,l_quantity_prf#2750,l_receiptdate_prf#2751,l_linenumber_prf#2752,l_tax_prf#2753,l_shipdate_prf#2754,l_extendedprice_prf#2755,l_partkey_prf#2756,l_discount_prf#2757,l_partkey_and_l_suppkey_prf#2758,l_commitdate_prf#2759,l_suppkey_prf#2760,l_orderkey_prf#2761] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2781, dexdecrypt('value_dec_key, 'value_right) AS rid_2#2782]
            :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
            :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [p_comment_prf#2783 AS p_comment_prf_2#2793, p_name_prf#2784 AS p_name_prf_2#2794, rid#2785 AS rid_2#2795, p_type_prf#2786 AS p_type_prf_2#2796, p_retailprice_prf#2787 AS p_retailprice_prf_2#2797, p_mfgr_prf#2788 AS p_mfgr_prf_2#2798, p_container_prf#2789 AS p_container_prf_2#2799, p_brand_prf#2790 AS p_brand_prf_2#2800, p_size_prf#2791 AS p_size_prf_2#2801, p_partkey_prf#2792 AS p_partkey_prf_2#2802]
               +- Relation[p_comment_prf#2783,p_name_prf#2784,rid#2785,p_type_prf#2786,p_retailprice_prf#2787,p_mfgr_prf#2788,p_container_prf#2789,p_brand_prf#2790,p_size_prf#2791,p_partkey_prf#2792] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 201002ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/12 12:15:22 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:15:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2854L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 12:15:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2854L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [rid#2856 AS rid_0#2861, n_regionkey_prf#2857 AS n_regionkey_prf_0#2862, n_nationkey_prf#2858 AS n_nationkey_prf_0#2863, n_name_prf#2859 AS n_name_prf_0#2864, n_comment_prf#2860 AS n_comment_prf_0#2865]
         :  :  +- Relation[rid#2856,n_regionkey_prf#2857,n_nationkey_prf#2858,n_name_prf#2859,n_comment_prf#2860] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#2866, dexdecrypt('value_dec_key, 'value_right) AS rid_1#2867]
         :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#2868 AS s_phone_prf_1#2876, rid#2869 AS rid_1#2877, s_address_prf#2870 AS s_address_prf_1#2878, s_nationkey_prf#2871 AS s_nationkey_prf_1#2879, s_suppkey_prf#2872 AS s_suppkey_prf_1#2880, s_name_prf#2873 AS s_name_prf_1#2881, s_acctbal_prf#2874 AS s_acctbal_prf_1#2882, s_comment_prf#2875 AS s_comment_prf_1#2883]
            +- Relation[s_phone_prf#2868,rid#2869,s_address_prf#2870,s_nationkey_prf#2871,s_suppkey_prf#2872,s_name_prf#2873,s_acctbal_prf#2874,s_comment_prf#2875] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=10000
Elapsed time: 231ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/12 12:15:22 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:15:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2907L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 12:15:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2907L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [r_regionkey_prf#2909 AS r_regionkey_prf_0#2913, r_name_prf#2910 AS r_name_prf_0#2914, r_comment_prf#2911 AS r_comment_prf_0#2915, rid#2912 AS rid_0#2916]
         :  :  +- Relation[r_regionkey_prf#2909,r_name_prf#2910,r_comment_prf#2911,rid#2912] JDBCRelation(region_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#2917, dexdecrypt('value_dec_key, 'value_right) AS rid_0#2918]
         :     +- SpxRidUncorrelatedJoin nation~n_regionkey~region~r_regionkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [rid#2919 AS rid_1#2924, n_regionkey_prf#2920 AS n_regionkey_prf_1#2925, n_nationkey_prf#2921 AS n_nationkey_prf_1#2926, n_name_prf#2922 AS n_name_prf_1#2927, n_comment_prf#2923 AS n_comment_prf_1#2928]
            +- Relation[rid#2919,n_regionkey_prf#2920,n_nationkey_prf#2921,n_name_prf#2922,n_comment_prf#2923] JDBCRelation(nation_prf) [numPartitions=1]

DexSpx$ result size=25
Elapsed time: 68ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/12 12:15:22 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:15:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2966L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 12:15:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2966L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#2968 AS l_returnflag_prf_0#2987, l_orderkey_and_l_linenumber_prf#2969 AS l_orderkey_and_l_linenumber_prf_0#2988, l_comment_prf#2970 AS l_comment_prf_0#2989, l_linestatus_prf#2971 AS l_linestatus_prf_0#2990, rid#2972 AS rid_0#2991, l_shipmode_prf#2973 AS l_shipmode_prf_0#2992, l_shipinstruct_prf#2974 AS l_shipinstruct_prf_0#2993, l_quantity_prf#2975 AS l_quantity_prf_0#2994, l_receiptdate_prf#2976 AS l_receiptdate_prf_0#2995, l_linenumber_prf#2977 AS l_linenumber_prf_0#2996, l_tax_prf#2978 AS l_tax_prf_0#2997, l_shipdate_prf#2979 AS l_shipdate_prf_0#2998, l_extendedprice_prf#2980 AS l_extendedprice_prf_0#2999, l_partkey_prf#2981 AS l_partkey_prf_0#3000, l_discount_prf#2982 AS l_discount_prf_0#3001, l_partkey_and_l_suppkey_prf#2983 AS l_partkey_and_l_suppkey_prf_0#3002, l_commitdate_prf#2984 AS l_commitdate_prf_0#3003, l_suppkey_prf#2985 AS l_suppkey_prf_0#3004, l_orderkey_prf#2986 AS l_orderkey_prf_0#3005]
         :  :  +- Relation[l_returnflag_prf#2968,l_orderkey_and_l_linenumber_prf#2969,l_comment_prf#2970,l_linestatus_prf#2971,rid#2972,l_shipmode_prf#2973,l_shipinstruct_prf#2974,l_quantity_prf#2975,l_receiptdate_prf#2976,l_linenumber_prf#2977,l_tax_prf#2978,l_shipdate_prf#2979,l_extendedprice_prf#2980,l_partkey_prf#2981,l_discount_prf#2982,l_partkey_and_l_suppkey_prf#2983,l_commitdate_prf#2984,l_suppkey_prf#2985,l_orderkey_prf#2986] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3006, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3007]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3008 AS o_shippriority_prf_1#3018, rid#3009 AS rid_1#3019, o_orderdate_prf#3010 AS o_orderdate_prf_1#3020, o_custkey_prf#3011 AS o_custkey_prf_1#3021, o_orderpriority_prf#3012 AS o_orderpriority_prf_1#3022, o_clerk_prf#3013 AS o_clerk_prf_1#3023, o_orderstatus_prf#3014 AS o_orderstatus_prf_1#3024, o_totalprice_prf#3015 AS o_totalprice_prf_1#3025, o_orderkey_prf#3016 AS o_orderkey_prf_1#3026, o_comment_prf#3017 AS o_comment_prf_1#3027]
            +- Relation[o_shippriority_prf#3008,rid#3009,o_orderdate_prf#3010,o_custkey_prf#3011,o_orderpriority_prf#3012,o_clerk_prf#3013,o_orderstatus_prf#3014,o_totalprice_prf#3015,o_orderkey_prf#3016,o_comment_prf#3017] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 106785ms

f2=
select * from part where p_size = 15
19/10/12 12:17:09 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:17:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3069L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 12:17:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3069L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#3071 AS p_comment_prf_0#3081, p_name_prf#3072 AS p_name_prf_0#3082, rid#3073 AS rid_0#3083, p_type_prf#3074 AS p_type_prf_0#3084, p_retailprice_prf#3075 AS p_retailprice_prf_0#3085, p_mfgr_prf#3076 AS p_mfgr_prf_0#3086, p_container_prf#3077 AS p_container_prf_0#3087, p_brand_prf#3078 AS p_brand_prf_0#3088, p_size_prf#3079 AS p_size_prf_0#3089, p_partkey_prf#3080 AS p_partkey_prf_0#3090]
         :  +- Relation[p_comment_prf#3071,p_name_prf#3072,rid#3073,p_type_prf#3074,p_retailprice_prf#3075,p_mfgr_prf#3076,p_container_prf#3077,p_brand_prf#3078,p_size_prf#3079,p_partkey_prf#3080] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3091]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1561,value#1562] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=3907
Elapsed time: 124ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/12 12:17:09 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:17:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3138L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 12:17:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3138L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#3140 AS c_acctbal_prf_0#3149, rid#3141 AS rid_0#3150, c_name_prf#3142 AS c_name_prf_0#3151, c_nationkey_prf#3143 AS c_nationkey_prf_0#3152, c_custkey_prf#3144 AS c_custkey_prf_0#3153, c_comment_prf#3145 AS c_comment_prf_0#3154, c_address_prf#3146 AS c_address_prf_0#3155, c_mktsegment_prf#3147 AS c_mktsegment_prf_0#3156, c_phone_prf#3148 AS c_phone_prf_0#3157]
         :  :  +- Relation[c_acctbal_prf#3140,rid#3141,c_name_prf#3142,c_nationkey_prf#3143,c_custkey_prf#3144,c_comment_prf#3145,c_address_prf#3146,c_mktsegment_prf#3147,c_phone_prf#3148] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3158, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3159]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [l_returnflag_prf#3160 AS l_returnflag_prf_1#3179, l_orderkey_and_l_linenumber_prf#3161 AS l_orderkey_and_l_linenumber_prf_1#3180, l_comment_prf#3162 AS l_comment_prf_1#3181, l_linestatus_prf#3163 AS l_linestatus_prf_1#3182, rid#3164 AS rid_1#3183, l_shipmode_prf#3165 AS l_shipmode_prf_1#3184, l_shipinstruct_prf#3166 AS l_shipinstruct_prf_1#3185, l_quantity_prf#3167 AS l_quantity_prf_1#3186, l_receiptdate_prf#3168 AS l_receiptdate_prf_1#3187, l_linenumber_prf#3169 AS l_linenumber_prf_1#3188, l_tax_prf#3170 AS l_tax_prf_1#3189, l_shipdate_prf#3171 AS l_shipdate_prf_1#3190, l_extendedprice_prf#3172 AS l_extendedprice_prf_1#3191, l_partkey_prf#3173 AS l_partkey_prf_1#3192, l_discount_prf#3174 AS l_discount_prf_1#3193, l_partkey_and_l_suppkey_prf#3175 AS l_partkey_and_l_suppkey_prf_1#3194, l_commitdate_prf#3176 AS l_commitdate_prf_1#3195, l_suppkey_prf#3177 AS l_suppkey_prf_1#3196, l_orderkey_prf#3178 AS l_orderkey_prf_1#3197]
            :  :  +- Relation[l_returnflag_prf#3160,l_orderkey_and_l_linenumber_prf#3161,l_comment_prf#3162,l_linestatus_prf#3163,rid#3164,l_shipmode_prf#3165,l_shipinstruct_prf#3166,l_quantity_prf#3167,l_receiptdate_prf#3168,l_linenumber_prf#3169,l_tax_prf#3170,l_shipdate_prf#3171,l_extendedprice_prf#3172,l_partkey_prf#3173,l_discount_prf#3174,l_partkey_and_l_suppkey_prf#3175,l_commitdate_prf#3176,l_suppkey_prf#3177,l_orderkey_prf#3178] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3198, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3199]
            :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
            :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3200 AS o_shippriority_prf_2#3210, rid#3201 AS rid_2#3211, o_orderdate_prf#3202 AS o_orderdate_prf_2#3212, o_custkey_prf#3203 AS o_custkey_prf_2#3213, o_orderpriority_prf#3204 AS o_orderpriority_prf_2#3214, o_clerk_prf#3205 AS o_clerk_prf_2#3215, o_orderstatus_prf#3206 AS o_orderstatus_prf_2#3216, o_totalprice_prf#3207 AS o_totalprice_prf_2#3217, o_orderkey_prf#3208 AS o_orderkey_prf_2#3218, o_comment_prf#3209 AS o_comment_prf_2#3219]
               +- Relation[o_shippriority_prf#3200,rid#3201,o_orderdate_prf#3202,o_custkey_prf#3203,o_orderpriority_prf#3204,o_clerk_prf#3205,o_orderstatus_prf#3206,o_totalprice_prf#3207,o_orderkey_prf#3208,o_comment_prf#3209] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 142905ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/12 12:19:32 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:19:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3294L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 12:19:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3294L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#3296 AS l_returnflag_prf_0#3315, l_orderkey_and_l_linenumber_prf#3297 AS l_orderkey_and_l_linenumber_prf_0#3316, l_comment_prf#3298 AS l_comment_prf_0#3317, l_linestatus_prf#3299 AS l_linestatus_prf_0#3318, rid#3300 AS rid_0#3319, l_shipmode_prf#3301 AS l_shipmode_prf_0#3320, l_shipinstruct_prf#3302 AS l_shipinstruct_prf_0#3321, l_quantity_prf#3303 AS l_quantity_prf_0#3322, l_receiptdate_prf#3304 AS l_receiptdate_prf_0#3323, l_linenumber_prf#3305 AS l_linenumber_prf_0#3324, l_tax_prf#3306 AS l_tax_prf_0#3325, l_shipdate_prf#3307 AS l_shipdate_prf_0#3326, l_extendedprice_prf#3308 AS l_extendedprice_prf_0#3327, l_partkey_prf#3309 AS l_partkey_prf_0#3328, l_discount_prf#3310 AS l_discount_prf_0#3329, l_partkey_and_l_suppkey_prf#3311 AS l_partkey_and_l_suppkey_prf_0#3330, l_commitdate_prf#3312 AS l_commitdate_prf_0#3331, l_suppkey_prf#3313 AS l_suppkey_prf_0#3332, l_orderkey_prf#3314 AS l_orderkey_prf_0#3333]
         :  :  +- Relation[l_returnflag_prf#3296,l_orderkey_and_l_linenumber_prf#3297,l_comment_prf#3298,l_linestatus_prf#3299,rid#3300,l_shipmode_prf#3301,l_shipinstruct_prf#3302,l_quantity_prf#3303,l_receiptdate_prf#3304,l_linenumber_prf#3305,l_tax_prf#3306,l_shipdate_prf#3307,l_extendedprice_prf#3308,l_partkey_prf#3309,l_discount_prf#3310,l_partkey_and_l_suppkey_prf#3311,l_commitdate_prf#3312,l_suppkey_prf#3313,l_orderkey_prf#3314] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3334, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3335]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [c_acctbal_prf#3336 AS c_acctbal_prf_1#3345, rid#3337 AS rid_1#3346, c_name_prf#3338 AS c_name_prf_1#3347, c_nationkey_prf#3339 AS c_nationkey_prf_1#3348, c_custkey_prf#3340 AS c_custkey_prf_1#3349, c_comment_prf#3341 AS c_comment_prf_1#3350, c_address_prf#3342 AS c_address_prf_1#3351, c_mktsegment_prf#3343 AS c_mktsegment_prf_1#3352, c_phone_prf#3344 AS c_phone_prf_1#3353]
            :  :  +- Relation[c_acctbal_prf#3336,rid#3337,c_name_prf#3338,c_nationkey_prf#3339,c_custkey_prf#3340,c_comment_prf#3341,c_address_prf#3342,c_mktsegment_prf#3343,c_phone_prf#3344] JDBCRelation(customer_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3354, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3355]
            :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
            :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3356 AS o_shippriority_prf_2#3366, rid#3357 AS rid_2#3367, o_orderdate_prf#3358 AS o_orderdate_prf_2#3368, o_custkey_prf#3359 AS o_custkey_prf_2#3369, o_orderpriority_prf#3360 AS o_orderpriority_prf_2#3370, o_clerk_prf#3361 AS o_clerk_prf_2#3371, o_orderstatus_prf#3362 AS o_orderstatus_prf_2#3372, o_totalprice_prf#3363 AS o_totalprice_prf_2#3373, o_orderkey_prf#3364 AS o_orderkey_prf_2#3374, o_comment_prf#3365 AS o_comment_prf_2#3375]
               +- Relation[o_shippriority_prf#3356,rid#3357,o_orderdate_prf#3358,o_custkey_prf#3359,o_orderpriority_prf#3360,o_clerk_prf#3361,o_orderstatus_prf#3362,o_totalprice_prf#3363,o_orderkey_prf#3364,o_comment_prf#3365] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 182183ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/12 12:22:34 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:22:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3433L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 12:22:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3433L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#3435 AS l_returnflag_prf_0#3454, l_orderkey_and_l_linenumber_prf#3436 AS l_orderkey_and_l_linenumber_prf_0#3455, l_comment_prf#3437 AS l_comment_prf_0#3456, l_linestatus_prf#3438 AS l_linestatus_prf_0#3457, rid#3439 AS rid_0#3458, l_shipmode_prf#3440 AS l_shipmode_prf_0#3459, l_shipinstruct_prf#3441 AS l_shipinstruct_prf_0#3460, l_quantity_prf#3442 AS l_quantity_prf_0#3461, l_receiptdate_prf#3443 AS l_receiptdate_prf_0#3462, l_linenumber_prf#3444 AS l_linenumber_prf_0#3463, l_tax_prf#3445 AS l_tax_prf_0#3464, l_shipdate_prf#3446 AS l_shipdate_prf_0#3465, l_extendedprice_prf#3447 AS l_extendedprice_prf_0#3466, l_partkey_prf#3448 AS l_partkey_prf_0#3467, l_discount_prf#3449 AS l_discount_prf_0#3468, l_partkey_and_l_suppkey_prf#3450 AS l_partkey_and_l_suppkey_prf_0#3469, l_commitdate_prf#3451 AS l_commitdate_prf_0#3470, l_suppkey_prf#3452 AS l_suppkey_prf_0#3471, l_orderkey_prf#3453 AS l_orderkey_prf_0#3472]
         :  +- Relation[l_returnflag_prf#3435,l_orderkey_and_l_linenumber_prf#3436,l_comment_prf#3437,l_linestatus_prf#3438,rid#3439,l_shipmode_prf#3440,l_shipinstruct_prf#3441,l_quantity_prf#3442,l_receiptdate_prf#3443,l_linenumber_prf#3444,l_tax_prf#3445,l_shipdate_prf#3446,l_extendedprice_prf#3447,l_partkey_prf#3448,l_discount_prf#3449,l_partkey_and_l_suppkey_prf#3450,l_commitdate_prf#3451,l_suppkey_prf#3452,l_orderkey_prf#3453] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3473]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1561,value#1562] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=857401
Elapsed time: 13677ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/12 12:22:48 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:22:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3510L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 12:22:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3510L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [p_comment_prf#3512 AS p_comment_prf_0#3522, p_name_prf#3513 AS p_name_prf_0#3523, rid#3514 AS rid_0#3524, p_type_prf#3515 AS p_type_prf_0#3525, p_retailprice_prf#3516 AS p_retailprice_prf_0#3526, p_mfgr_prf#3517 AS p_mfgr_prf_0#3527, p_container_prf#3518 AS p_container_prf_0#3528, p_brand_prf#3519 AS p_brand_prf_0#3529, p_size_prf#3520 AS p_size_prf_0#3530, p_partkey_prf#3521 AS p_partkey_prf_0#3531]
         :  :  :  +- Relation[p_comment_prf#3512,p_name_prf#3513,rid#3514,p_type_prf#3515,p_retailprice_prf#3516,p_mfgr_prf#3517,p_container_prf#3518,p_brand_prf#3519,p_size_prf#3520,p_partkey_prf#3521] JDBCRelation(part_prf) [numPartitions=1]
         :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3532]
         :  :     +- DexRidFilter part~p_size~15
         :  :        +- Relation[label#1561,value#1562] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3533, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3534]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#3535 AS ps_partkey_and_ps_suppkey_prf_1#3542, rid#3536 AS rid_1#3543, ps_availqty_prf#3537 AS ps_availqty_prf_1#3544, ps_comment_prf#3538 AS ps_comment_prf_1#3545, ps_partkey_prf#3539 AS ps_partkey_prf_1#3546, ps_supplycost_prf#3540 AS ps_supplycost_prf_1#3547, ps_suppkey_prf#3541 AS ps_suppkey_prf_1#3548]
            +- Relation[ps_partkey_and_ps_suppkey_prf#3535,rid#3536,ps_availqty_prf#3537,ps_comment_prf#3538,ps_partkey_prf#3539,ps_supplycost_prf#3540,ps_suppkey_prf#3541] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=15628
Elapsed time: 7759ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/12 12:22:56 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:22:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3590L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 12:22:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3590L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#3592 AS s_phone_prf_0#3600, rid#3593 AS rid_0#3601, s_address_prf#3594 AS s_address_prf_0#3602, s_nationkey_prf#3595 AS s_nationkey_prf_0#3603, s_suppkey_prf#3596 AS s_suppkey_prf_0#3604, s_name_prf#3597 AS s_name_prf_0#3605, s_acctbal_prf#3598 AS s_acctbal_prf_0#3606, s_comment_prf#3599 AS s_comment_prf_0#3607]
         :  :  +- Relation[s_phone_prf#3592,rid#3593,s_address_prf#3594,s_nationkey_prf#3595,s_suppkey_prf#3596,s_name_prf#3597,s_acctbal_prf#3598,s_comment_prf#3599] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3608, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3609]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [ps_partkey_and_ps_suppkey_prf#3610 AS ps_partkey_and_ps_suppkey_prf_1#3617, rid#3611 AS rid_1#3618, ps_availqty_prf#3612 AS ps_availqty_prf_1#3619, ps_comment_prf#3613 AS ps_comment_prf_1#3620, ps_partkey_prf#3614 AS ps_partkey_prf_1#3621, ps_supplycost_prf#3615 AS ps_supplycost_prf_1#3622, ps_suppkey_prf#3616 AS ps_suppkey_prf_1#3623]
            :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#3610,rid#3611,ps_availqty_prf#3612,ps_comment_prf#3613,ps_partkey_prf#3614,ps_supplycost_prf#3615,ps_suppkey_prf#3616] JDBCRelation(partsupp_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#3624, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3625]
            :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
            :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [p_comment_prf#3626 AS p_comment_prf_2#3636, p_name_prf#3627 AS p_name_prf_2#3637, rid#3628 AS rid_2#3638, p_type_prf#3629 AS p_type_prf_2#3639, p_retailprice_prf#3630 AS p_retailprice_prf_2#3640, p_mfgr_prf#3631 AS p_mfgr_prf_2#3641, p_container_prf#3632 AS p_container_prf_2#3642, p_brand_prf#3633 AS p_brand_prf_2#3643, p_size_prf#3634 AS p_size_prf_2#3644, p_partkey_prf#3635 AS p_partkey_prf_2#3645]
               +- Relation[p_comment_prf#3626,p_name_prf#3627,rid#3628,p_type_prf#3629,p_retailprice_prf#3630,p_mfgr_prf#3631,p_container_prf#3632,p_brand_prf#3633,p_size_prf#3634,p_partkey_prf#3635] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26161ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/12 12:23:22 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:23:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3691L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 12:23:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3691L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [c_acctbal_prf#3693 AS c_acctbal_prf_0#3702, rid#3694 AS rid_0#3703, c_name_prf#3695 AS c_name_prf_0#3704, c_nationkey_prf#3696 AS c_nationkey_prf_0#3705, c_custkey_prf#3697 AS c_custkey_prf_0#3706, c_comment_prf#3698 AS c_comment_prf_0#3707, c_address_prf#3699 AS c_address_prf_0#3708, c_mktsegment_prf#3700 AS c_mktsegment_prf_0#3709, c_phone_prf#3701 AS c_phone_prf_0#3710]
         :  :  +- Relation[c_acctbal_prf#3693,rid#3694,c_name_prf#3695,c_nationkey_prf#3696,c_custkey_prf#3697,c_comment_prf#3698,c_address_prf#3699,c_mktsegment_prf#3700,c_phone_prf#3701] JDBCRelation(customer_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3711, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3712]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3713 AS o_shippriority_prf_1#3723, rid#3714 AS rid_1#3724, o_orderdate_prf#3715 AS o_orderdate_prf_1#3725, o_custkey_prf#3716 AS o_custkey_prf_1#3726, o_orderpriority_prf#3717 AS o_orderpriority_prf_1#3727, o_clerk_prf#3718 AS o_clerk_prf_1#3728, o_orderstatus_prf#3719 AS o_orderstatus_prf_1#3729, o_totalprice_prf#3720 AS o_totalprice_prf_1#3730, o_orderkey_prf#3721 AS o_orderkey_prf_1#3731, o_comment_prf#3722 AS o_comment_prf_1#3732]
            +- Relation[o_shippriority_prf#3713,rid#3714,o_orderdate_prf#3715,o_custkey_prf#3716,o_orderpriority_prf#3717,o_clerk_prf#3718,o_orderstatus_prf#3719,o_totalprice_prf#3720,o_orderkey_prf#3721,o_comment_prf#3722] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=1500000
Elapsed time: 23678ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/12 12:23:46 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:23:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3767L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 12:23:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3767L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#3769 AS s_phone_prf_0#3777, rid#3770 AS rid_0#3778, s_address_prf#3771 AS s_address_prf_0#3779, s_nationkey_prf#3772 AS s_nationkey_prf_0#3780, s_suppkey_prf#3773 AS s_suppkey_prf_0#3781, s_name_prf#3774 AS s_name_prf_0#3782, s_acctbal_prf#3775 AS s_acctbal_prf_0#3783, s_comment_prf#3776 AS s_comment_prf_0#3784]
         :  :  +- Relation[s_phone_prf#3769,rid#3770,s_address_prf#3771,s_nationkey_prf#3772,s_suppkey_prf#3773,s_name_prf#3774,s_acctbal_prf#3775,s_comment_prf#3776] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#3785, dexdecrypt('value_dec_key, 'value_right) AS rid_0#3786]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#3787 AS ps_partkey_and_ps_suppkey_prf_1#3794, rid#3788 AS rid_1#3795, ps_availqty_prf#3789 AS ps_availqty_prf_1#3796, ps_comment_prf#3790 AS ps_comment_prf_1#3797, ps_partkey_prf#3791 AS ps_partkey_prf_1#3798, ps_supplycost_prf#3792 AS ps_supplycost_prf_1#3799, ps_suppkey_prf#3793 AS ps_suppkey_prf_1#3800]
            +- Relation[ps_partkey_and_ps_suppkey_prf#3787,rid#3788,ps_availqty_prf#3789,ps_comment_prf#3790,ps_partkey_prf#3791,ps_supplycost_prf#3792,ps_suppkey_prf#3793] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 11677ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/12 12:23:57 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:23:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3851L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/12 12:23:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3851L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [l_returnflag_prf#3853 AS l_returnflag_prf_0#3872, l_orderkey_and_l_linenumber_prf#3854 AS l_orderkey_and_l_linenumber_prf_0#3873, l_comment_prf#3855 AS l_comment_prf_0#3874, l_linestatus_prf#3856 AS l_linestatus_prf_0#3875, rid#3857 AS rid_0#3876, l_shipmode_prf#3858 AS l_shipmode_prf_0#3877, l_shipinstruct_prf#3859 AS l_shipinstruct_prf_0#3878, l_quantity_prf#3860 AS l_quantity_prf_0#3879, l_receiptdate_prf#3861 AS l_receiptdate_prf_0#3880, l_linenumber_prf#3862 AS l_linenumber_prf_0#3881, l_tax_prf#3863 AS l_tax_prf_0#3882, l_shipdate_prf#3864 AS l_shipdate_prf_0#3883, l_extendedprice_prf#3865 AS l_extendedprice_prf_0#3884, l_partkey_prf#3866 AS l_partkey_prf_0#3885, l_discount_prf#3867 AS l_discount_prf_0#3886, l_partkey_and_l_suppkey_prf#3868 AS l_partkey_and_l_suppkey_prf_0#3887, l_commitdate_prf#3869 AS l_commitdate_prf_0#3888, l_suppkey_prf#3870 AS l_suppkey_prf_0#3889, l_orderkey_prf#3871 AS l_orderkey_prf_0#3890]
         :  :  :  :  +- Relation[l_returnflag_prf#3853,l_orderkey_and_l_linenumber_prf#3854,l_comment_prf#3855,l_linestatus_prf#3856,rid#3857,l_shipmode_prf#3858,l_shipinstruct_prf#3859,l_quantity_prf#3860,l_receiptdate_prf#3861,l_linenumber_prf#3862,l_tax_prf#3863,l_shipdate_prf#3864,l_extendedprice_prf#3865,l_partkey_prf#3866,l_discount_prf#3867,l_partkey_and_l_suppkey_prf#3868,l_commitdate_prf#3869,l_suppkey_prf#3870,l_orderkey_prf#3871] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3891, dexdecrypt('value_dec_key, 'value_right) AS rid_1#3892]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :  :  :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#3893 AS p_comment_prf_1#3903, p_name_prf#3894 AS p_name_prf_1#3904, rid#3895 AS rid_1#3905, p_type_prf#3896 AS p_type_prf_1#3906, p_retailprice_prf#3897 AS p_retailprice_prf_1#3907, p_mfgr_prf#3898 AS p_mfgr_prf_1#3908, p_container_prf#3899 AS p_container_prf_1#3909, p_brand_prf#3900 AS p_brand_prf_1#3910, p_size_prf#3901 AS p_size_prf_1#3911, p_partkey_prf#3902 AS p_partkey_prf_1#3912]
         :  :     +- Relation[p_comment_prf#3893,p_name_prf#3894,rid#3895,p_type_prf#3896,p_retailprice_prf#3897,p_mfgr_prf#3898,p_container_prf#3899,p_brand_prf#3900,p_size_prf#3901,p_partkey_prf#3902] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#3913, dexdecrypt('value_dec_key, 'value_right) AS rid_2#3914]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [s_phone_prf#3915 AS s_phone_prf_2#3923, rid#3916 AS rid_2#3924, s_address_prf#3917 AS s_address_prf_2#3925, s_nationkey_prf#3918 AS s_nationkey_prf_2#3926, s_suppkey_prf#3919 AS s_suppkey_prf_2#3927, s_name_prf#3920 AS s_name_prf_2#3928, s_acctbal_prf#3921 AS s_acctbal_prf_2#3929, s_comment_prf#3922 AS s_comment_prf_2#3930]
            +- Relation[s_phone_prf#3915,rid#3916,s_address_prf#3917,s_nationkey_prf#3918,s_suppkey_prf#3919,s_name_prf#3920,s_acctbal_prf#3921,s_comment_prf#3922] JDBCRelation(supplier_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 200656ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/12 12:27:18 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:27:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3996L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/12 12:27:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3996L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [l_returnflag_prf#3998 AS l_returnflag_prf_0#4017, l_orderkey_and_l_linenumber_prf#3999 AS l_orderkey_and_l_linenumber_prf_0#4018, l_comment_prf#4000 AS l_comment_prf_0#4019, l_linestatus_prf#4001 AS l_linestatus_prf_0#4020, rid#4002 AS rid_0#4021, l_shipmode_prf#4003 AS l_shipmode_prf_0#4022, l_shipinstruct_prf#4004 AS l_shipinstruct_prf_0#4023, l_quantity_prf#4005 AS l_quantity_prf_0#4024, l_receiptdate_prf#4006 AS l_receiptdate_prf_0#4025, l_linenumber_prf#4007 AS l_linenumber_prf_0#4026, l_tax_prf#4008 AS l_tax_prf_0#4027, l_shipdate_prf#4009 AS l_shipdate_prf_0#4028, l_extendedprice_prf#4010 AS l_extendedprice_prf_0#4029, l_partkey_prf#4011 AS l_partkey_prf_0#4030, l_discount_prf#4012 AS l_discount_prf_0#4031, l_partkey_and_l_suppkey_prf#4013 AS l_partkey_and_l_suppkey_prf_0#4032, l_commitdate_prf#4014 AS l_commitdate_prf_0#4033, l_suppkey_prf#4015 AS l_suppkey_prf_0#4034, l_orderkey_prf#4016 AS l_orderkey_prf_0#4035]
         :  :  :  +- Relation[l_returnflag_prf#3998,l_orderkey_and_l_linenumber_prf#3999,l_comment_prf#4000,l_linestatus_prf#4001,rid#4002,l_shipmode_prf#4003,l_shipinstruct_prf#4004,l_quantity_prf#4005,l_receiptdate_prf#4006,l_linenumber_prf#4007,l_tax_prf#4008,l_shipdate_prf#4009,l_extendedprice_prf#4010,l_partkey_prf#4011,l_discount_prf#4012,l_partkey_and_l_suppkey_prf#4013,l_commitdate_prf#4014,l_suppkey_prf#4015,l_orderkey_prf#4016] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4036]
         :  :     +- DexRidFilter lineitem~l_returnflag~R
         :  :        +- Relation[label#1561,value#1562] JDBCRelation(t_filter) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4037, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4038]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4039 AS o_shippriority_prf_1#4049, rid#4040 AS rid_1#4050, o_orderdate_prf#4041 AS o_orderdate_prf_1#4051, o_custkey_prf#4042 AS o_custkey_prf_1#4052, o_orderpriority_prf#4043 AS o_orderpriority_prf_1#4053, o_clerk_prf#4044 AS o_clerk_prf_1#4054, o_orderstatus_prf#4045 AS o_orderstatus_prf_1#4055, o_totalprice_prf#4046 AS o_totalprice_prf_1#4056, o_orderkey_prf#4047 AS o_orderkey_prf_1#4057, o_comment_prf#4048 AS o_comment_prf_1#4058]
            +- Relation[o_shippriority_prf#4039,rid#4040,o_orderdate_prf#4041,o_custkey_prf#4042,o_orderpriority_prf#4043,o_clerk_prf#4044,o_orderstatus_prf#4045,o_totalprice_prf#4046,o_orderkey_prf#4047,o_comment_prf#4048] JDBCRelation(orders_prf) [numPartitions=1]

DexSpx$ result size=1478870
Elapsed time: 97436ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/12 12:28:55 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:28:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4105L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 12:28:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4105L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [ps_partkey_and_ps_suppkey_prf#4107 AS ps_partkey_and_ps_suppkey_prf_0#4114, rid#4108 AS rid_0#4115, ps_availqty_prf#4109 AS ps_availqty_prf_0#4116, ps_comment_prf#4110 AS ps_comment_prf_0#4117, ps_partkey_prf#4111 AS ps_partkey_prf_0#4118, ps_supplycost_prf#4112 AS ps_supplycost_prf_0#4119, ps_suppkey_prf#4113 AS ps_suppkey_prf_0#4120]
         :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#4107,rid#4108,ps_availqty_prf#4109,ps_comment_prf#4110,ps_partkey_prf#4111,ps_supplycost_prf#4112,ps_suppkey_prf#4113] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4121, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4122]
         :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#4123 AS p_comment_prf_1#4133, p_name_prf#4124 AS p_name_prf_1#4134, rid#4125 AS rid_1#4135, p_type_prf#4126 AS p_type_prf_1#4136, p_retailprice_prf#4127 AS p_retailprice_prf_1#4137, p_mfgr_prf#4128 AS p_mfgr_prf_1#4138, p_container_prf#4129 AS p_container_prf_1#4139, p_brand_prf#4130 AS p_brand_prf_1#4140, p_size_prf#4131 AS p_size_prf_1#4141, p_partkey_prf#4132 AS p_partkey_prf_1#4142]
            :  +- Relation[p_comment_prf#4123,p_name_prf#4124,rid#4125,p_type_prf#4126,p_retailprice_prf#4127,p_mfgr_prf#4128,p_container_prf#4129,p_brand_prf#4130,p_size_prf#4131,p_partkey_prf#4132] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4143]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1561,value#1562] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=15628
Elapsed time: 7753ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/12 12:29:03 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:29:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4185L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 12:29:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4185L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [ps_partkey_and_ps_suppkey_prf#4187 AS ps_partkey_and_ps_suppkey_prf_0#4194, rid#4188 AS rid_0#4195, ps_availqty_prf#4189 AS ps_availqty_prf_0#4196, ps_comment_prf#4190 AS ps_comment_prf_0#4197, ps_partkey_prf#4191 AS ps_partkey_prf_0#4198, ps_supplycost_prf#4192 AS ps_supplycost_prf_0#4199, ps_suppkey_prf#4193 AS ps_suppkey_prf_0#4200]
         :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#4187,rid#4188,ps_availqty_prf#4189,ps_comment_prf#4190,ps_partkey_prf#4191,ps_supplycost_prf#4192,ps_suppkey_prf#4193] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4201, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4202]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey_and_l_suppkey~partsupp~ps_partkey_and_ps_suppkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4203 AS l_returnflag_prf_1#4222, l_orderkey_and_l_linenumber_prf#4204 AS l_orderkey_and_l_linenumber_prf_1#4223, l_comment_prf#4205 AS l_comment_prf_1#4224, l_linestatus_prf#4206 AS l_linestatus_prf_1#4225, rid#4207 AS rid_1#4226, l_shipmode_prf#4208 AS l_shipmode_prf_1#4227, l_shipinstruct_prf#4209 AS l_shipinstruct_prf_1#4228, l_quantity_prf#4210 AS l_quantity_prf_1#4229, l_receiptdate_prf#4211 AS l_receiptdate_prf_1#4230, l_linenumber_prf#4212 AS l_linenumber_prf_1#4231, l_tax_prf#4213 AS l_tax_prf_1#4232, l_shipdate_prf#4214 AS l_shipdate_prf_1#4233, l_extendedprice_prf#4215 AS l_extendedprice_prf_1#4234, l_partkey_prf#4216 AS l_partkey_prf_1#4235, l_discount_prf#4217 AS l_discount_prf_1#4236, l_partkey_and_l_suppkey_prf#4218 AS l_partkey_and_l_suppkey_prf_1#4237, l_commitdate_prf#4219 AS l_commitdate_prf_1#4238, l_suppkey_prf#4220 AS l_suppkey_prf_1#4239, l_orderkey_prf#4221 AS l_orderkey_prf_1#4240]
            +- Relation[l_returnflag_prf#4203,l_orderkey_and_l_linenumber_prf#4204,l_comment_prf#4205,l_linestatus_prf#4206,rid#4207,l_shipmode_prf#4208,l_shipinstruct_prf#4209,l_quantity_prf#4210,l_receiptdate_prf#4211,l_linenumber_prf#4212,l_tax_prf#4213,l_shipdate_prf#4214,l_extendedprice_prf#4215,l_partkey_prf#4216,l_discount_prf#4217,l_partkey_and_l_suppkey_prf#4218,l_commitdate_prf#4219,l_suppkey_prf#4220,l_orderkey_prf#4221] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 105524ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/12 12:30:49 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:30:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4295L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 12:30:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4295L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#4297 AS l_returnflag_prf_0#4316, l_orderkey_and_l_linenumber_prf#4298 AS l_orderkey_and_l_linenumber_prf_0#4317, l_comment_prf#4299 AS l_comment_prf_0#4318, l_linestatus_prf#4300 AS l_linestatus_prf_0#4319, rid#4301 AS rid_0#4320, l_shipmode_prf#4302 AS l_shipmode_prf_0#4321, l_shipinstruct_prf#4303 AS l_shipinstruct_prf_0#4322, l_quantity_prf#4304 AS l_quantity_prf_0#4323, l_receiptdate_prf#4305 AS l_receiptdate_prf_0#4324, l_linenumber_prf#4306 AS l_linenumber_prf_0#4325, l_tax_prf#4307 AS l_tax_prf_0#4326, l_shipdate_prf#4308 AS l_shipdate_prf_0#4327, l_extendedprice_prf#4309 AS l_extendedprice_prf_0#4328, l_partkey_prf#4310 AS l_partkey_prf_0#4329, l_discount_prf#4311 AS l_discount_prf_0#4330, l_partkey_and_l_suppkey_prf#4312 AS l_partkey_and_l_suppkey_prf_0#4331, l_commitdate_prf#4313 AS l_commitdate_prf_0#4332, l_suppkey_prf#4314 AS l_suppkey_prf_0#4333, l_orderkey_prf#4315 AS l_orderkey_prf_0#4334]
         :  :  +- Relation[l_returnflag_prf#4297,l_orderkey_and_l_linenumber_prf#4298,l_comment_prf#4299,l_linestatus_prf#4300,rid#4301,l_shipmode_prf#4302,l_shipinstruct_prf#4303,l_quantity_prf#4304,l_receiptdate_prf#4305,l_linenumber_prf#4306,l_tax_prf#4307,l_shipdate_prf#4308,l_extendedprice_prf#4309,l_partkey_prf#4310,l_discount_prf#4311,l_partkey_and_l_suppkey_prf#4312,l_commitdate_prf#4313,l_suppkey_prf#4314,l_orderkey_prf#4315] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4335, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4336]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [p_comment_prf#4337 AS p_comment_prf_1#4347, p_name_prf#4338 AS p_name_prf_1#4348, rid#4339 AS rid_1#4349, p_type_prf#4340 AS p_type_prf_1#4350, p_retailprice_prf#4341 AS p_retailprice_prf_1#4351, p_mfgr_prf#4342 AS p_mfgr_prf_1#4352, p_container_prf#4343 AS p_container_prf_1#4353, p_brand_prf#4344 AS p_brand_prf_1#4354, p_size_prf#4345 AS p_size_prf_1#4355, p_partkey_prf#4346 AS p_partkey_prf_1#4356]
            +- Relation[p_comment_prf#4337,p_name_prf#4338,rid#4339,p_type_prf#4340,p_retailprice_prf#4341,p_mfgr_prf#4342,p_container_prf#4343,p_brand_prf#4344,p_size_prf#4345,p_partkey_prf#4346] JDBCRelation(part_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 94980ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/12 12:32:24 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:32:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4408L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 12:32:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4408L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [s_phone_prf#4410 AS s_phone_prf_0#4418, rid#4411 AS rid_0#4419, s_address_prf#4412 AS s_address_prf_0#4420, s_nationkey_prf#4413 AS s_nationkey_prf_0#4421, s_suppkey_prf#4414 AS s_suppkey_prf_0#4422, s_name_prf#4415 AS s_name_prf_0#4423, s_acctbal_prf#4416 AS s_acctbal_prf_0#4424, s_comment_prf#4417 AS s_comment_prf_0#4425]
         :  :  :  :  +- Relation[s_phone_prf#4410,rid#4411,s_address_prf#4412,s_nationkey_prf#4413,s_suppkey_prf#4414,s_name_prf#4415,s_acctbal_prf#4416,s_comment_prf#4417] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4426, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4427]
         :  :  :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :  :  :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [rid#4428 AS rid_1#4433, n_regionkey_prf#4429 AS n_regionkey_prf_1#4434, n_nationkey_prf#4430 AS n_nationkey_prf_1#4435, n_name_prf#4431 AS n_name_prf_1#4436, n_comment_prf#4432 AS n_comment_prf_1#4437]
         :  :     +- Relation[rid#4428,n_regionkey_prf#4429,n_nationkey_prf#4430,n_name_prf#4431,n_comment_prf#4432] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4438, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4439]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4440 AS c_acctbal_prf_2#4449, rid#4441 AS rid_2#4450, c_name_prf#4442 AS c_name_prf_2#4451, c_nationkey_prf#4443 AS c_nationkey_prf_2#4452, c_custkey_prf#4444 AS c_custkey_prf_2#4453, c_comment_prf#4445 AS c_comment_prf_2#4454, c_address_prf#4446 AS c_address_prf_2#4455, c_mktsegment_prf#4447 AS c_mktsegment_prf_2#4456, c_phone_prf#4448 AS c_phone_prf_2#4457]
            +- Relation[c_acctbal_prf#4440,rid#4441,c_name_prf#4442,c_nationkey_prf#4443,c_custkey_prf#4444,c_comment_prf#4445,c_address_prf#4446,c_mktsegment_prf#4447,c_phone_prf#4448] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 893389ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/12 12:47:17 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:47:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4508L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 12:47:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4508L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [p_comment_prf#4510 AS p_comment_prf_0#4520, p_name_prf#4511 AS p_name_prf_0#4521, rid#4512 AS rid_0#4522, p_type_prf#4513 AS p_type_prf_0#4523, p_retailprice_prf#4514 AS p_retailprice_prf_0#4524, p_mfgr_prf#4515 AS p_mfgr_prf_0#4525, p_container_prf#4516 AS p_container_prf_0#4526, p_brand_prf#4517 AS p_brand_prf_0#4527, p_size_prf#4518 AS p_size_prf_0#4528, p_partkey_prf#4519 AS p_partkey_prf_0#4529]
         :  :  +- Relation[p_comment_prf#4510,p_name_prf#4511,rid#4512,p_type_prf#4513,p_retailprice_prf#4514,p_mfgr_prf#4515,p_container_prf#4516,p_brand_prf#4517,p_size_prf#4518,p_partkey_prf#4519] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4530, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4531]
         :     +- SpxRidUncorrelatedJoin lineitem~l_partkey~part~p_partkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4532 AS l_returnflag_prf_1#4551, l_orderkey_and_l_linenumber_prf#4533 AS l_orderkey_and_l_linenumber_prf_1#4552, l_comment_prf#4534 AS l_comment_prf_1#4553, l_linestatus_prf#4535 AS l_linestatus_prf_1#4554, rid#4536 AS rid_1#4555, l_shipmode_prf#4537 AS l_shipmode_prf_1#4556, l_shipinstruct_prf#4538 AS l_shipinstruct_prf_1#4557, l_quantity_prf#4539 AS l_quantity_prf_1#4558, l_receiptdate_prf#4540 AS l_receiptdate_prf_1#4559, l_linenumber_prf#4541 AS l_linenumber_prf_1#4560, l_tax_prf#4542 AS l_tax_prf_1#4561, l_shipdate_prf#4543 AS l_shipdate_prf_1#4562, l_extendedprice_prf#4544 AS l_extendedprice_prf_1#4563, l_partkey_prf#4545 AS l_partkey_prf_1#4564, l_discount_prf#4546 AS l_discount_prf_1#4565, l_partkey_and_l_suppkey_prf#4547 AS l_partkey_and_l_suppkey_prf_1#4566, l_commitdate_prf#4548 AS l_commitdate_prf_1#4567, l_suppkey_prf#4549 AS l_suppkey_prf_1#4568, l_orderkey_prf#4550 AS l_orderkey_prf_1#4569]
            +- Relation[l_returnflag_prf#4532,l_orderkey_and_l_linenumber_prf#4533,l_comment_prf#4534,l_linestatus_prf#4535,rid#4536,l_shipmode_prf#4537,l_shipinstruct_prf#4538,l_quantity_prf#4539,l_receiptdate_prf#4540,l_linenumber_prf#4541,l_tax_prf#4542,l_shipdate_prf#4543,l_extendedprice_prf#4544,l_partkey_prf#4545,l_discount_prf#4546,l_partkey_and_l_suppkey_prf#4547,l_commitdate_prf#4548,l_suppkey_prf#4549,l_orderkey_prf#4550] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 95614ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/12 12:48:53 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:48:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4611L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/12 12:48:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4611L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#4613 AS p_comment_prf_0#4623, p_name_prf#4614 AS p_name_prf_0#4624, rid#4615 AS rid_0#4625, p_type_prf#4616 AS p_type_prf_0#4626, p_retailprice_prf#4617 AS p_retailprice_prf_0#4627, p_mfgr_prf#4618 AS p_mfgr_prf_0#4628, p_container_prf#4619 AS p_container_prf_0#4629, p_brand_prf#4620 AS p_brand_prf_0#4630, p_size_prf#4621 AS p_size_prf_0#4631, p_partkey_prf#4622 AS p_partkey_prf_0#4632]
         :  +- Relation[p_comment_prf#4613,p_name_prf#4614,rid#4615,p_type_prf#4616,p_retailprice_prf#4617,p_mfgr_prf#4618,p_container_prf#4619,p_brand_prf#4620,p_size_prf#4621,p_partkey_prf#4622] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4633]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1561,value#1562] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1451
Elapsed time: 91ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/12 12:48:53 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:48:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4651L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/12 12:48:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4651L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#4653 AS rid_0#4658, n_regionkey_prf#4654 AS n_regionkey_prf_0#4659, n_nationkey_prf#4655 AS n_nationkey_prf_0#4660, n_name_prf#4656 AS n_name_prf_0#4661, n_comment_prf#4657 AS n_comment_prf_0#4662]
         :  +- Relation[rid#4653,n_regionkey_prf#4654,n_nationkey_prf#4655,n_name_prf#4656,n_comment_prf#4657] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4663]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1561,value#1562] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1
Elapsed time: 47ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/12 12:48:53 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 12:48:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4691L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 12:48:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4691L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [rid#4693 AS rid_0#4698, n_regionkey_prf#4694 AS n_regionkey_prf_0#4699, n_nationkey_prf#4695 AS n_nationkey_prf_0#4700, n_name_prf#4696 AS n_name_prf_0#4701, n_comment_prf#4697 AS n_comment_prf_0#4702]
         :  :  :  :  +- Relation[rid#4693,n_regionkey_prf#4694,n_nationkey_prf#4695,n_name_prf#4696,n_comment_prf#4697] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4703, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4704]
         :  :  :     +- SpxRidUncorrelatedJoin nation~n_nationkey~supplier~s_nationkey
         :  :  :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#4705 AS s_phone_prf_1#4713, rid#4706 AS rid_1#4714, s_address_prf#4707 AS s_address_prf_1#4715, s_nationkey_prf#4708 AS s_nationkey_prf_1#4716, s_suppkey_prf#4709 AS s_suppkey_prf_1#4717, s_name_prf#4710 AS s_name_prf_1#4718, s_acctbal_prf#4711 AS s_acctbal_prf_1#4719, s_comment_prf#4712 AS s_comment_prf_1#4720]
         :  :     +- Relation[s_phone_prf#4705,rid#4706,s_address_prf#4707,s_nationkey_prf#4708,s_suppkey_prf#4709,s_name_prf#4710,s_acctbal_prf#4711,s_comment_prf#4712] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4721, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4722]
         :     +- SpxRidUncorrelatedJoin customer~c_nationkey~nation~n_nationkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4723 AS c_acctbal_prf_2#4732, rid#4724 AS rid_2#4733, c_name_prf#4725 AS c_name_prf_2#4734, c_nationkey_prf#4726 AS c_nationkey_prf_2#4735, c_custkey_prf#4727 AS c_custkey_prf_2#4736, c_comment_prf#4728 AS c_comment_prf_2#4737, c_address_prf#4729 AS c_address_prf_2#4738, c_mktsegment_prf#4730 AS c_mktsegment_prf_2#4739, c_phone_prf#4731 AS c_phone_prf_2#4740]
            +- Relation[c_acctbal_prf#4723,rid#4724,c_name_prf#4725,c_nationkey_prf#4726,c_custkey_prf#4727,c_comment_prf#4728,c_address_prf#4729,c_mktsegment_prf#4730,c_phone_prf#4731] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=60000414
Elapsed time: 879891ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/12 13:03:33 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:03:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4799L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 13:03:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4799L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [c_acctbal_prf#4801 AS c_acctbal_prf_0#4810, rid#4802 AS rid_0#4811, c_name_prf#4803 AS c_name_prf_0#4812, c_nationkey_prf#4804 AS c_nationkey_prf_0#4813, c_custkey_prf#4805 AS c_custkey_prf_0#4814, c_comment_prf#4806 AS c_comment_prf_0#4815, c_address_prf#4807 AS c_address_prf_0#4816, c_mktsegment_prf#4808 AS c_mktsegment_prf_0#4817, c_phone_prf#4809 AS c_phone_prf_0#4818]
         :  :  :  :  +- Relation[c_acctbal_prf#4801,rid#4802,c_name_prf#4803,c_nationkey_prf#4804,c_custkey_prf#4805,c_comment_prf#4806,c_address_prf#4807,c_mktsegment_prf#4808,c_phone_prf#4809] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#4819, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4820]
         :  :  :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :  :  :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#4821 AS o_shippriority_prf_1#4831, rid#4822 AS rid_1#4832, o_orderdate_prf#4823 AS o_orderdate_prf_1#4833, o_custkey_prf#4824 AS o_custkey_prf_1#4834, o_orderpriority_prf#4825 AS o_orderpriority_prf_1#4835, o_clerk_prf#4826 AS o_clerk_prf_1#4836, o_orderstatus_prf#4827 AS o_orderstatus_prf_1#4837, o_totalprice_prf#4828 AS o_totalprice_prf_1#4838, o_orderkey_prf#4829 AS o_orderkey_prf_1#4839, o_comment_prf#4830 AS o_comment_prf_1#4840]
         :  :     +- Relation[o_shippriority_prf#4821,rid#4822,o_orderdate_prf#4823,o_custkey_prf#4824,o_orderpriority_prf#4825,o_clerk_prf#4826,o_orderstatus_prf#4827,o_totalprice_prf#4828,o_orderkey_prf#4829,o_comment_prf#4830] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4841, dexdecrypt('value_dec_key, 'value_right) AS rid_1#4842]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4843 AS l_returnflag_prf_2#4862, l_orderkey_and_l_linenumber_prf#4844 AS l_orderkey_and_l_linenumber_prf_2#4863, l_comment_prf#4845 AS l_comment_prf_2#4864, l_linestatus_prf#4846 AS l_linestatus_prf_2#4865, rid#4847 AS rid_2#4866, l_shipmode_prf#4848 AS l_shipmode_prf_2#4867, l_shipinstruct_prf#4849 AS l_shipinstruct_prf_2#4868, l_quantity_prf#4850 AS l_quantity_prf_2#4869, l_receiptdate_prf#4851 AS l_receiptdate_prf_2#4870, l_linenumber_prf#4852 AS l_linenumber_prf_2#4871, l_tax_prf#4853 AS l_tax_prf_2#4872, l_shipdate_prf#4854 AS l_shipdate_prf_2#4873, l_extendedprice_prf#4855 AS l_extendedprice_prf_2#4874, l_partkey_prf#4856 AS l_partkey_prf_2#4875, l_discount_prf#4857 AS l_discount_prf_2#4876, l_partkey_and_l_suppkey_prf#4858 AS l_partkey_and_l_suppkey_prf_2#4877, l_commitdate_prf#4859 AS l_commitdate_prf_2#4878, l_suppkey_prf#4860 AS l_suppkey_prf_2#4879, l_orderkey_prf#4861 AS l_orderkey_prf_2#4880]
            +- Relation[l_returnflag_prf#4843,l_orderkey_and_l_linenumber_prf#4844,l_comment_prf#4845,l_linestatus_prf#4846,rid#4847,l_shipmode_prf#4848,l_shipinstruct_prf#4849,l_quantity_prf#4850,l_receiptdate_prf#4851,l_linenumber_prf#4852,l_tax_prf#4853,l_shipdate_prf#4854,l_extendedprice_prf#4855,l_partkey_prf#4856,l_discount_prf#4857,l_partkey_and_l_suppkey_prf#4858,l_commitdate_prf#4859,l_suppkey_prf#4860,l_orderkey_prf#4861] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 169028ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/12 13:06:22 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:06:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4943L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/12 13:06:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4943L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#4945 AS s_phone_prf_0#4953, rid#4946 AS rid_0#4954, s_address_prf#4947 AS s_address_prf_0#4955, s_nationkey_prf#4948 AS s_nationkey_prf_0#4956, s_suppkey_prf#4949 AS s_suppkey_prf_0#4957, s_name_prf#4950 AS s_name_prf_0#4958, s_acctbal_prf#4951 AS s_acctbal_prf_0#4959, s_comment_prf#4952 AS s_comment_prf_0#4960]
         :  :  +- Relation[s_phone_prf#4945,rid#4946,s_address_prf#4947,s_nationkey_prf#4948,s_suppkey_prf#4949,s_name_prf#4950,s_acctbal_prf#4951,s_comment_prf#4952] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#4961, dexdecrypt('value_dec_key, 'value_right) AS rid_0#4962]
         :     +- SpxRidUncorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [p_comment_prf#4963 AS p_comment_prf_1#4973, p_name_prf#4964 AS p_name_prf_1#4974, rid#4965 AS rid_1#4975, p_type_prf#4966 AS p_type_prf_1#4976, p_retailprice_prf#4967 AS p_retailprice_prf_1#4977, p_mfgr_prf#4968 AS p_mfgr_prf_1#4978, p_container_prf#4969 AS p_container_prf_1#4979, p_brand_prf#4970 AS p_brand_prf_1#4980, p_size_prf#4971 AS p_size_prf_1#4981, p_partkey_prf#4972 AS p_partkey_prf_1#4982]
            :  :  +- Relation[p_comment_prf#4963,p_name_prf#4964,rid#4965,p_type_prf#4966,p_retailprice_prf#4967,p_mfgr_prf#4968,p_container_prf#4969,p_brand_prf#4970,p_size_prf#4971,p_partkey_prf#4972] JDBCRelation(part_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#4983, dexdecrypt('value_dec_key, 'value_right) AS rid_2#4984]
            :     +- SpxRidUncorrelatedJoin part~p_partkey~partsupp~ps_partkey
            :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#4985 AS ps_partkey_and_ps_suppkey_prf_2#4992, rid#4986 AS rid_2#4993, ps_availqty_prf#4987 AS ps_availqty_prf_2#4994, ps_comment_prf#4988 AS ps_comment_prf_2#4995, ps_partkey_prf#4989 AS ps_partkey_prf_2#4996, ps_supplycost_prf#4990 AS ps_supplycost_prf_2#4997, ps_suppkey_prf#4991 AS ps_suppkey_prf_2#4998]
               +- Relation[ps_partkey_and_ps_suppkey_prf#4985,rid#4986,ps_availqty_prf#4987,ps_comment_prf#4988,ps_partkey_prf#4989,ps_supplycost_prf#4990,ps_suppkey_prf#4991] JDBCRelation(partsupp_prf) [numPartitions=1]

DexSpx$ result size=800000
Elapsed time: 26360ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/12 13:06:48 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:06:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5060L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 13:06:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5060L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :- Project [l_returnflag_prf#5062 AS l_returnflag_prf_0#5081, l_orderkey_and_l_linenumber_prf#5063 AS l_orderkey_and_l_linenumber_prf_0#5082, l_comment_prf#5064 AS l_comment_prf_0#5083, l_linestatus_prf#5065 AS l_linestatus_prf_0#5084, rid#5066 AS rid_0#5085, l_shipmode_prf#5067 AS l_shipmode_prf_0#5086, l_shipinstruct_prf#5068 AS l_shipinstruct_prf_0#5087, l_quantity_prf#5069 AS l_quantity_prf_0#5088, l_receiptdate_prf#5070 AS l_receiptdate_prf_0#5089, l_linenumber_prf#5071 AS l_linenumber_prf_0#5090, l_tax_prf#5072 AS l_tax_prf_0#5091, l_shipdate_prf#5073 AS l_shipdate_prf_0#5092, l_extendedprice_prf#5074 AS l_extendedprice_prf_0#5093, l_partkey_prf#5075 AS l_partkey_prf_0#5094, l_discount_prf#5076 AS l_discount_prf_0#5095, l_partkey_and_l_suppkey_prf#5077 AS l_partkey_and_l_suppkey_prf_0#5096, l_commitdate_prf#5078 AS l_commitdate_prf_0#5097, l_suppkey_prf#5079 AS l_suppkey_prf_0#5098, l_orderkey_prf#5080 AS l_orderkey_prf_0#5099]
         :  :  :  :  +- Relation[l_returnflag_prf#5062,l_orderkey_and_l_linenumber_prf#5063,l_comment_prf#5064,l_linestatus_prf#5065,rid#5066,l_shipmode_prf#5067,l_shipinstruct_prf#5068,l_quantity_prf#5069,l_receiptdate_prf#5070,l_linenumber_prf#5071,l_tax_prf#5072,l_shipdate_prf#5073,l_extendedprice_prf#5074,l_partkey_prf#5075,l_discount_prf#5076,l_partkey_and_l_suppkey_prf#5077,l_commitdate_prf#5078,l_suppkey_prf#5079,l_orderkey_prf#5080] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5100, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5101]
         :  :  :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :  :  :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#5102 AS o_shippriority_prf_1#5112, rid#5103 AS rid_1#5113, o_orderdate_prf#5104 AS o_orderdate_prf_1#5114, o_custkey_prf#5105 AS o_custkey_prf_1#5115, o_orderpriority_prf#5106 AS o_orderpriority_prf_1#5116, o_clerk_prf#5107 AS o_clerk_prf_1#5117, o_orderstatus_prf#5108 AS o_orderstatus_prf_1#5118, o_totalprice_prf#5109 AS o_totalprice_prf_1#5119, o_orderkey_prf#5110 AS o_orderkey_prf_1#5120, o_comment_prf#5111 AS o_comment_prf_1#5121]
         :  :     +- Relation[o_shippriority_prf#5102,rid#5103,o_orderdate_prf#5104,o_custkey_prf#5105,o_orderpriority_prf#5106,o_clerk_prf#5107,o_orderstatus_prf#5108,o_totalprice_prf#5109,o_orderkey_prf#5110,o_comment_prf#5111] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#5122, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5123]
         :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#5124 AS c_acctbal_prf_2#5133, rid#5125 AS rid_2#5134, c_name_prf#5126 AS c_name_prf_2#5135, c_nationkey_prf#5127 AS c_nationkey_prf_2#5136, c_custkey_prf#5128 AS c_custkey_prf_2#5137, c_comment_prf#5129 AS c_comment_prf_2#5138, c_address_prf#5130 AS c_address_prf_2#5139, c_mktsegment_prf#5131 AS c_mktsegment_prf_2#5140, c_phone_prf#5132 AS c_phone_prf_2#5141]
            +- Relation[c_acctbal_prf#5124,rid#5125,c_name_prf#5126,c_nationkey_prf#5127,c_custkey_prf#5128,c_comment_prf#5129,c_address_prf#5130,c_mktsegment_prf#5131,c_phone_prf#5132] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 183214ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/12 13:09:51 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:09:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5216L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/12 13:09:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5216L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [l_returnflag_prf#5218 AS l_returnflag_prf_0#5237, l_orderkey_and_l_linenumber_prf#5219 AS l_orderkey_and_l_linenumber_prf_0#5238, l_comment_prf#5220 AS l_comment_prf_0#5239, l_linestatus_prf#5221 AS l_linestatus_prf_0#5240, rid#5222 AS rid_0#5241, l_shipmode_prf#5223 AS l_shipmode_prf_0#5242, l_shipinstruct_prf#5224 AS l_shipinstruct_prf_0#5243, l_quantity_prf#5225 AS l_quantity_prf_0#5244, l_receiptdate_prf#5226 AS l_receiptdate_prf_0#5245, l_linenumber_prf#5227 AS l_linenumber_prf_0#5246, l_tax_prf#5228 AS l_tax_prf_0#5247, l_shipdate_prf#5229 AS l_shipdate_prf_0#5248, l_extendedprice_prf#5230 AS l_extendedprice_prf_0#5249, l_partkey_prf#5231 AS l_partkey_prf_0#5250, l_discount_prf#5232 AS l_discount_prf_0#5251, l_partkey_and_l_suppkey_prf#5233 AS l_partkey_and_l_suppkey_prf_0#5252, l_commitdate_prf#5234 AS l_commitdate_prf_0#5253, l_suppkey_prf#5235 AS l_suppkey_prf_0#5254, l_orderkey_prf#5236 AS l_orderkey_prf_0#5255]
         :  :  +- Relation[l_returnflag_prf#5218,l_orderkey_and_l_linenumber_prf#5219,l_comment_prf#5220,l_linestatus_prf#5221,rid#5222,l_shipmode_prf#5223,l_shipinstruct_prf#5224,l_quantity_prf#5225,l_receiptdate_prf#5226,l_linenumber_prf#5227,l_tax_prf#5228,l_shipdate_prf#5229,l_extendedprice_prf#5230,l_partkey_prf#5231,l_discount_prf#5232,l_partkey_and_l_suppkey_prf#5233,l_commitdate_prf#5234,l_suppkey_prf#5235,l_orderkey_prf#5236] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_0#5256, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5257]
         :     +- SpxRidUncorrelatedJoin lineitem~l_orderkey~orders~o_orderkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Join NaturalJoin(Inner)
            :  :- Project [o_shippriority_prf#5258 AS o_shippriority_prf_1#5268, rid#5259 AS rid_1#5269, o_orderdate_prf#5260 AS o_orderdate_prf_1#5270, o_custkey_prf#5261 AS o_custkey_prf_1#5271, o_orderpriority_prf#5262 AS o_orderpriority_prf_1#5272, o_clerk_prf#5263 AS o_clerk_prf_1#5273, o_orderstatus_prf#5264 AS o_orderstatus_prf_1#5274, o_totalprice_prf#5265 AS o_totalprice_prf_1#5275, o_orderkey_prf#5266 AS o_orderkey_prf_1#5276, o_comment_prf#5267 AS o_comment_prf_1#5277]
            :  :  +- Relation[o_shippriority_prf#5258,rid#5259,o_orderdate_prf#5260,o_custkey_prf#5261,o_orderpriority_prf#5262,o_clerk_prf#5263,o_orderstatus_prf#5264,o_totalprice_prf#5265,o_orderkey_prf#5266,o_comment_prf#5267] JDBCRelation(orders_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_2#5278, dexdecrypt('value_dec_key, 'value_right) AS rid_1#5279]
            :     +- SpxRidUncorrelatedJoin customer~c_custkey~orders~o_custkey
            :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#5280 AS c_acctbal_prf_2#5289, rid#5281 AS rid_2#5290, c_name_prf#5282 AS c_name_prf_2#5291, c_nationkey_prf#5283 AS c_nationkey_prf_2#5292, c_custkey_prf#5284 AS c_custkey_prf_2#5293, c_comment_prf#5285 AS c_comment_prf_2#5294, c_address_prf#5286 AS c_address_prf_2#5295, c_mktsegment_prf#5287 AS c_mktsegment_prf_2#5296, c_phone_prf#5288 AS c_phone_prf_2#5297]
               +- Relation[c_acctbal_prf#5280,rid#5281,c_name_prf#5282,c_nationkey_prf#5283,c_custkey_prf#5284,c_comment_prf#5285,c_address_prf#5286,c_mktsegment_prf#5287,c_phone_prf#5288] JDBCRelation(customer_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 184442ms

f1=
select * from region where r_name = 'EUROPE'
19/10/12 13:12:56 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:12:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5342L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/12 13:12:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5342L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#5344 AS r_regionkey_prf_0#5348, r_name_prf#5345 AS r_name_prf_0#5349, r_comment_prf#5346 AS r_comment_prf_0#5350, rid#5347 AS rid_0#5351]
         :  +- Relation[r_regionkey_prf#5344,r_name_prf#5345,r_comment_prf#5346,rid#5347] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5352]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1561,value#1562] JDBCRelation(t_filter) [numPartitions=1]

DexSpx$ result size=1
Elapsed time: 56ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/12 13:12:56 WARN DexPlanner: dexPlan=SpxPlan
19/10/12 13:12:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5383L]
+- SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/12 13:12:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5383L]
+- 'Project
   +- 'SpxPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join NaturalJoin(Inner)
         :  :- Project [s_phone_prf#5385 AS s_phone_prf_0#5393, rid#5386 AS rid_0#5394, s_address_prf#5387 AS s_address_prf_0#5395, s_nationkey_prf#5388 AS s_nationkey_prf_0#5396, s_suppkey_prf#5389 AS s_suppkey_prf_0#5397, s_name_prf#5390 AS s_name_prf_0#5398, s_acctbal_prf#5391 AS s_acctbal_prf_0#5399, s_comment_prf#5392 AS s_comment_prf_0#5400]
         :  :  +- Relation[s_phone_prf#5385,rid#5386,s_address_prf#5387,s_nationkey_prf#5388,s_suppkey_prf#5389,s_name_prf#5390,s_acctbal_prf#5391,s_comment_prf#5392] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project [dexdecrypt('value_dec_key, 'value_left) AS rid_1#5401, dexdecrypt('value_dec_key, 'value_right) AS rid_0#5402]
         :     +- SpxRidUncorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey
         :        +- Relation[label#1518,value_left#1519,value_right#1520] JDBCRelation(t_uncorrelated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5403 AS l_returnflag_prf_1#5422, l_orderkey_and_l_linenumber_prf#5404 AS l_orderkey_and_l_linenumber_prf_1#5423, l_comment_prf#5405 AS l_comment_prf_1#5424, l_linestatus_prf#5406 AS l_linestatus_prf_1#5425, rid#5407 AS rid_1#5426, l_shipmode_prf#5408 AS l_shipmode_prf_1#5427, l_shipinstruct_prf#5409 AS l_shipinstruct_prf_1#5428, l_quantity_prf#5410 AS l_quantity_prf_1#5429, l_receiptdate_prf#5411 AS l_receiptdate_prf_1#5430, l_linenumber_prf#5412 AS l_linenumber_prf_1#5431, l_tax_prf#5413 AS l_tax_prf_1#5432, l_shipdate_prf#5414 AS l_shipdate_prf_1#5433, l_extendedprice_prf#5415 AS l_extendedprice_prf_1#5434, l_partkey_prf#5416 AS l_partkey_prf_1#5435, l_discount_prf#5417 AS l_discount_prf_1#5436, l_partkey_and_l_suppkey_prf#5418 AS l_partkey_and_l_suppkey_prf_1#5437, l_commitdate_prf#5419 AS l_commitdate_prf_1#5438, l_suppkey_prf#5420 AS l_suppkey_prf_1#5439, l_orderkey_prf#5421 AS l_orderkey_prf_1#5440]
            +- Relation[l_returnflag_prf#5403,l_orderkey_and_l_linenumber_prf#5404,l_comment_prf#5405,l_linestatus_prf#5406,rid#5407,l_shipmode_prf#5408,l_shipinstruct_prf#5409,l_quantity_prf#5410,l_receiptdate_prf#5411,l_linenumber_prf#5412,l_tax_prf#5413,l_shipdate_prf#5414,l_extendedprice_prf#5415,l_partkey_prf#5416,l_discount_prf#5417,l_partkey_and_l_suppkey_prf#5418,l_commitdate_prf#5419,l_suppkey_prf#5420,l_orderkey_prf#5421] JDBCRelation(lineitem_prf) [numPartitions=1]

DexSpx$ result size=6001215
Elapsed time: 89140ms
query=b1a, count=15628, duration=7759
query=b1b, count=15628, duration=7753
query=b2a, count=1478870, duration=98241
query=b2b, count=1478870, duration=97436
query=f1, count=1, duration=56
query=f2, count=3907, duration=124
query=f3, count=1451, duration=91
query=f4, count=1, duration=47
query=f5, count=1478870, duration=23501
query=f6, count=857401, duration=13677
query=j1, count=800000, duration=12318
query=j10, count=6001215, duration=89140
query=j2, count=800000, duration=11677
query=j3, count=25, duration=68
query=j4, count=150000, duration=2536
query=j5, count=10000, duration=231
query=j6, count=6001215, duration=105524
query=j7, count=1500000, duration=23678
query=j8, count=6001215, duration=107238
query=j8b, count=6001215, duration=106785
query=j9, count=6001215, duration=95614
query=j9b, count=6001215, duration=94980
query=r1a, count=6001215, duration=183214
query=r1b, count=6001215, duration=184442
query=r1c, count=6001215, duration=182183
query=r1d, count=6001215, duration=169028
query=r1e, count=6001215, duration=168795
query=r1f, count=6001215, duration=142905
query=t1a, count=60000414, duration=893389
query=t1b, count=60000414, duration=879891
query=t1c, count=60000414, duration=925342
query=t2a, count=800000, duration=26131
query=t2b, count=800000, duration=26270
query=t2c, count=800000, duration=26360
query=t2d, count=800000, duration=26161
query=t3a, count=6001215, duration=200656
query=t3b, count=6001215, duration=201296
query=t3c, count=6001215, duration=202310
query=t3d, count=6001215, duration=201002
