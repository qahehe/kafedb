19/10/11 00:19:50 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7142ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Fri Oct 11 00:19:53 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Fri Oct 11 00:19:54 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Fri Oct 11 00:19:54 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Fri Oct 11 00:19:54 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Fri Oct 11 00:19:54 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Fri Oct 11 00:19:56 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Fri Oct 11 00:19:59 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Fri Oct 11 00:19:59 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/11 00:20:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 00:20:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1487L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 00:20:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1487L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#1489 AS l_returnflag_prf_0#1508, l_orderkey_and_l_linenumber_prf#1490 AS l_orderkey_and_l_linenumber_prf_0#1509, l_comment_prf#1491 AS l_comment_prf_0#1510, l_linestatus_prf#1492 AS l_linestatus_prf_0#1511, rid#1493 AS rid_0#1512, l_shipmode_prf#1494 AS l_shipmode_prf_0#1513, l_shipinstruct_prf#1495 AS l_shipinstruct_prf_0#1514, l_quantity_prf#1496 AS l_quantity_prf_0#1515, l_receiptdate_prf#1497 AS l_receiptdate_prf_0#1516, l_linenumber_prf#1498 AS l_linenumber_prf_0#1517, l_tax_prf#1499 AS l_tax_prf_0#1518, l_shipdate_prf#1500 AS l_shipdate_prf_0#1519, l_extendedprice_prf#1501 AS l_extendedprice_prf_0#1520, l_partkey_prf#1502 AS l_partkey_prf_0#1521, l_discount_prf#1503 AS l_discount_prf_0#1522, l_partkey_and_l_suppkey_prf#1504 AS l_partkey_and_l_suppkey_prf_0#1523, l_commitdate_prf#1505 AS l_commitdate_prf_0#1524, l_suppkey_prf#1506 AS l_suppkey_prf_0#1525, l_orderkey_prf#1507 AS l_orderkey_prf_0#1526]
         :  +- Relation[l_returnflag_prf#1489,l_orderkey_and_l_linenumber_prf#1490,l_comment_prf#1491,l_linestatus_prf#1492,rid#1493,l_shipmode_prf#1494,l_shipinstruct_prf#1495,l_quantity_prf#1496,l_receiptdate_prf#1497,l_linenumber_prf#1498,l_tax_prf#1499,l_shipdate_prf#1500,l_extendedprice_prf#1501,l_partkey_prf#1502,l_discount_prf#1503,l_partkey_and_l_suppkey_prf#1504,l_commitdate_prf#1505,l_suppkey_prf#1506,l_orderkey_prf#1507] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1529]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 14114ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/11 00:20:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 00:20:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1566L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 00:20:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1566L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#1584]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#1576: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#1568 AS ps_partkey_and_ps_suppkey_prf_0#1575, rid#1569 AS rid_0#1576, ps_availqty_prf#1570 AS ps_availqty_prf_0#1577, ps_comment_prf#1571 AS ps_comment_prf_0#1578, ps_partkey_prf#1572 AS ps_partkey_prf_0#1579, ps_supplycost_prf#1573 AS ps_supplycost_prf_0#1580, ps_suppkey_prf#1574 AS ps_suppkey_prf_0#1581]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#1568,rid#1569,ps_availqty_prf#1570,ps_comment_prf#1571,ps_partkey_prf#1572,ps_supplycost_prf#1573,ps_suppkey_prf#1574] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#1585 AS p_comment_prf_1#1595, p_name_prf#1586 AS p_name_prf_1#1596, rid#1587 AS rid_1#1597, p_type_prf#1588 AS p_type_prf_1#1598, p_retailprice_prf#1589 AS p_retailprice_prf_1#1599, p_mfgr_prf#1590 AS p_mfgr_prf_1#1600, p_container_prf#1591 AS p_container_prf_1#1601, p_brand_prf#1592 AS p_brand_prf_1#1602, p_size_prf#1593 AS p_size_prf_1#1603, p_partkey_prf#1594 AS p_partkey_prf_1#1604]
            :  +- Relation[p_comment_prf#1585,p_name_prf#1586,rid#1587,p_type_prf#1588,p_retailprice_prf#1589,p_mfgr_prf#1590,p_container_prf#1591,p_brand_prf#1592,p_size_prf#1593,p_partkey_prf#1594] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#1605]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 50462ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/11 00:21:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 00:21:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1651L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 00:21:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1651L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#1691]
         :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#1676: string
         :     :- Project [l_returnflag_prf#1653 AS l_returnflag_prf_0#1672, l_orderkey_and_l_linenumber_prf#1654 AS l_orderkey_and_l_linenumber_prf_0#1673, l_comment_prf#1655 AS l_comment_prf_0#1674, l_linestatus_prf#1656 AS l_linestatus_prf_0#1675, rid#1657 AS rid_0#1676, l_shipmode_prf#1658 AS l_shipmode_prf_0#1677, l_shipinstruct_prf#1659 AS l_shipinstruct_prf_0#1678, l_quantity_prf#1660 AS l_quantity_prf_0#1679, l_receiptdate_prf#1661 AS l_receiptdate_prf_0#1680, l_linenumber_prf#1662 AS l_linenumber_prf_0#1681, l_tax_prf#1663 AS l_tax_prf_0#1682, l_shipdate_prf#1664 AS l_shipdate_prf_0#1683, l_extendedprice_prf#1665 AS l_extendedprice_prf_0#1684, l_partkey_prf#1666 AS l_partkey_prf_0#1685, l_discount_prf#1667 AS l_discount_prf_0#1686, l_partkey_and_l_suppkey_prf#1668 AS l_partkey_and_l_suppkey_prf_0#1687, l_commitdate_prf#1669 AS l_commitdate_prf_0#1688, l_suppkey_prf#1670 AS l_suppkey_prf_0#1689, l_orderkey_prf#1671 AS l_orderkey_prf_0#1690]
         :     :  +- Relation[l_returnflag_prf#1653,l_orderkey_and_l_linenumber_prf#1654,l_comment_prf#1655,l_linestatus_prf#1656,rid#1657,l_shipmode_prf#1658,l_shipinstruct_prf#1659,l_quantity_prf#1660,l_receiptdate_prf#1661,l_linenumber_prf#1662,l_tax_prf#1663,l_shipdate_prf#1664,l_extendedprice_prf#1665,l_partkey_prf#1666,l_discount_prf#1667,l_partkey_and_l_suppkey_prf#1668,l_commitdate_prf#1669,l_suppkey_prf#1670,l_orderkey_prf#1671] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#1692 AS p_comment_prf_1#1702, p_name_prf#1693 AS p_name_prf_1#1703, rid#1694 AS rid_1#1704, p_type_prf#1695 AS p_type_prf_1#1705, p_retailprice_prf#1696 AS p_retailprice_prf_1#1706, p_mfgr_prf#1697 AS p_mfgr_prf_1#1707, p_container_prf#1698 AS p_container_prf_1#1708, p_brand_prf#1699 AS p_brand_prf_1#1709, p_size_prf#1700 AS p_size_prf_1#1710, p_partkey_prf#1701 AS p_partkey_prf_1#1711]
            +- Relation[p_comment_prf#1692,p_name_prf#1693,rid#1694,p_type_prf#1695,p_retailprice_prf#1696,p_mfgr_prf#1697,p_container_prf#1698,p_brand_prf#1699,p_size_prf#1700,p_partkey_prf#1701] JDBCRelation(part_prf) [numPartitions=1]

19/10/11 00:21:05 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=6001215
Elapsed time: 129435ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/11 00:23:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 00:23:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1748L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 00:23:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1748L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#1750 AS rid_0#1755, n_regionkey_prf#1751 AS n_regionkey_prf_0#1756, n_nationkey_prf#1752 AS n_nationkey_prf_0#1757, n_name_prf#1753 AS n_name_prf_0#1758, n_comment_prf#1754 AS n_comment_prf_0#1759]
         :  +- Relation[rid#1750,n_regionkey_prf#1751,n_nationkey_prf#1752,n_name_prf#1753,n_comment_prf#1754] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1760]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 61ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/11 00:23:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 00:23:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1788L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 00:23:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1788L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#1583) AS rid_2#1817]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#1806]
         :     :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#1799: string
         :     :  :     :- Project [s_phone_prf#1790 AS s_phone_prf_0#1798, rid#1791 AS rid_0#1799, s_address_prf#1792 AS s_address_prf_0#1800, s_nationkey_prf#1793 AS s_nationkey_prf_0#1801, s_suppkey_prf#1794 AS s_suppkey_prf_0#1802, s_name_prf#1795 AS s_name_prf_0#1803, s_acctbal_prf#1796 AS s_acctbal_prf_0#1804, s_comment_prf#1797 AS s_comment_prf_0#1805]
         :     :  :     :  +- Relation[s_phone_prf#1790,rid#1791,s_address_prf#1792,s_nationkey_prf#1793,s_suppkey_prf#1794,s_name_prf#1795,s_acctbal_prf#1796,s_comment_prf#1797] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [rid#1807 AS rid_1#1812, n_regionkey_prf#1808 AS n_regionkey_prf_1#1813, n_nationkey_prf#1809 AS n_nationkey_prf_1#1814, n_name_prf#1810 AS n_name_prf_1#1815, n_comment_prf#1811 AS n_comment_prf_1#1816]
         :     :     +- Relation[rid#1807,n_regionkey_prf#1808,n_nationkey_prf#1809,n_name_prf#1810,n_comment_prf#1811] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#1818 AS c_acctbal_prf_2#1827, rid#1819 AS rid_2#1828, c_name_prf#1820 AS c_name_prf_2#1829, c_nationkey_prf#1821 AS c_nationkey_prf_2#1830, c_custkey_prf#1822 AS c_custkey_prf_2#1831, c_comment_prf#1823 AS c_comment_prf_2#1832, c_address_prf#1824 AS c_address_prf_2#1833, c_mktsegment_prf#1825 AS c_mktsegment_prf_2#1834, c_phone_prf#1826 AS c_phone_prf_2#1835]
            +- Relation[c_acctbal_prf#1818,rid#1819,c_name_prf#1820,c_nationkey_prf#1821,c_custkey_prf#1822,c_comment_prf#1823,c_address_prf#1824,c_mktsegment_prf#1825,c_phone_prf#1826] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 679611ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/11 00:34:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 00:34:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1886L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 00:34:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1886L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#1908]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#1899: string
         :     :- Project [o_shippriority_prf#1888 AS o_shippriority_prf_0#1898, rid#1889 AS rid_0#1899, o_orderdate_prf#1890 AS o_orderdate_prf_0#1900, o_custkey_prf#1891 AS o_custkey_prf_0#1901, o_orderpriority_prf#1892 AS o_orderpriority_prf_0#1902, o_clerk_prf#1893 AS o_clerk_prf_0#1903, o_orderstatus_prf#1894 AS o_orderstatus_prf_0#1904, o_totalprice_prf#1895 AS o_totalprice_prf_0#1905, o_orderkey_prf#1896 AS o_orderkey_prf_0#1906, o_comment_prf#1897 AS o_comment_prf_0#1907]
         :     :  +- Relation[o_shippriority_prf#1888,rid#1889,o_orderdate_prf#1890,o_custkey_prf#1891,o_orderpriority_prf#1892,o_clerk_prf#1893,o_orderstatus_prf#1894,o_totalprice_prf#1895,o_orderkey_prf#1896,o_comment_prf#1897] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1909 AS l_returnflag_prf_1#1928, l_orderkey_and_l_linenumber_prf#1910 AS l_orderkey_and_l_linenumber_prf_1#1929, l_comment_prf#1911 AS l_comment_prf_1#1930, l_linestatus_prf#1912 AS l_linestatus_prf_1#1931, rid#1913 AS rid_1#1932, l_shipmode_prf#1914 AS l_shipmode_prf_1#1933, l_shipinstruct_prf#1915 AS l_shipinstruct_prf_1#1934, l_quantity_prf#1916 AS l_quantity_prf_1#1935, l_receiptdate_prf#1917 AS l_receiptdate_prf_1#1936, l_linenumber_prf#1918 AS l_linenumber_prf_1#1937, l_tax_prf#1919 AS l_tax_prf_1#1938, l_shipdate_prf#1920 AS l_shipdate_prf_1#1939, l_extendedprice_prf#1921 AS l_extendedprice_prf_1#1940, l_partkey_prf#1922 AS l_partkey_prf_1#1941, l_discount_prf#1923 AS l_discount_prf_1#1942, l_partkey_and_l_suppkey_prf#1924 AS l_partkey_and_l_suppkey_prf_1#1943, l_commitdate_prf#1925 AS l_commitdate_prf_1#1944, l_suppkey_prf#1926 AS l_suppkey_prf_1#1945, l_orderkey_prf#1927 AS l_orderkey_prf_1#1946]
            +- Relation[l_returnflag_prf#1909,l_orderkey_and_l_linenumber_prf#1910,l_comment_prf#1911,l_linestatus_prf#1912,rid#1913,l_shipmode_prf#1914,l_shipinstruct_prf#1915,l_quantity_prf#1916,l_receiptdate_prf#1917,l_linenumber_prf#1918,l_tax_prf#1919,l_shipdate_prf#1920,l_extendedprice_prf#1921,l_partkey_prf#1922,l_discount_prf#1923,l_partkey_and_l_suppkey_prf#1924,l_commitdate_prf#1925,l_suppkey_prf#1926,l_orderkey_prf#1927] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 200585ms

f2=
select * from part where p_size = 15
19/10/11 00:37:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 00:37:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1988L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 00:37:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1988L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#1990 AS p_comment_prf_0#2000, p_name_prf#1991 AS p_name_prf_0#2001, rid#1992 AS rid_0#2002, p_type_prf#1993 AS p_type_prf_0#2003, p_retailprice_prf#1994 AS p_retailprice_prf_0#2004, p_mfgr_prf#1995 AS p_mfgr_prf_0#2005, p_container_prf#1996 AS p_container_prf_0#2006, p_brand_prf#1997 AS p_brand_prf_0#2007, p_size_prf#1998 AS p_size_prf_0#2008, p_partkey_prf#1999 AS p_partkey_prf_0#2009]
         :  +- Relation[p_comment_prf#1990,p_name_prf#1991,rid#1992,p_type_prf#1993,p_retailprice_prf#1994,p_mfgr_prf#1995,p_container_prf#1996,p_brand_prf#1997,p_size_prf#1998,p_partkey_prf#1999] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2010]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3907
Elapsed time: 126ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/11 00:37:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 00:37:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2045L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 00:37:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2045L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#2063]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#2056: string
         :     :- Project [s_phone_prf#2047 AS s_phone_prf_0#2055, rid#2048 AS rid_0#2056, s_address_prf#2049 AS s_address_prf_0#2057, s_nationkey_prf#2050 AS s_nationkey_prf_0#2058, s_suppkey_prf#2051 AS s_suppkey_prf_0#2059, s_name_prf#2052 AS s_name_prf_0#2060, s_acctbal_prf#2053 AS s_acctbal_prf_0#2061, s_comment_prf#2054 AS s_comment_prf_0#2062]
         :     :  +- Relation[s_phone_prf#2047,rid#2048,s_address_prf#2049,s_nationkey_prf#2050,s_suppkey_prf#2051,s_name_prf#2052,s_acctbal_prf#2053,s_comment_prf#2054] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1583) AS rid_2#2078]
            :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_1#2072: string
            :     :- Project [ps_partkey_and_ps_suppkey_prf#2064 AS ps_partkey_and_ps_suppkey_prf_1#2071, rid#2065 AS rid_1#2072, ps_availqty_prf#2066 AS ps_availqty_prf_1#2073, ps_comment_prf#2067 AS ps_comment_prf_1#2074, ps_partkey_prf#2068 AS ps_partkey_prf_1#2075, ps_supplycost_prf#2069 AS ps_supplycost_prf_1#2076, ps_suppkey_prf#2070 AS ps_suppkey_prf_1#2077]
            :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2064,rid#2065,ps_availqty_prf#2066,ps_comment_prf#2067,ps_partkey_prf#2068,ps_supplycost_prf#2069,ps_suppkey_prf#2070] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#2079 AS p_comment_prf_2#2089, p_name_prf#2080 AS p_name_prf_2#2090, rid#2081 AS rid_2#2091, p_type_prf#2082 AS p_type_prf_2#2092, p_retailprice_prf#2083 AS p_retailprice_prf_2#2093, p_mfgr_prf#2084 AS p_mfgr_prf_2#2094, p_container_prf#2085 AS p_container_prf_2#2095, p_brand_prf#2086 AS p_brand_prf_2#2096, p_size_prf#2087 AS p_size_prf_2#2097, p_partkey_prf#2088 AS p_partkey_prf_2#2098]
               +- Relation[p_comment_prf#2079,p_name_prf#2080,rid#2081,p_type_prf#2082,p_retailprice_prf#2083,p_mfgr_prf#2084,p_container_prf#2085,p_brand_prf#2086,p_size_prf#2087,p_partkey_prf#2088] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 62444ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_orderkey and l_orderkey = o_orderkey
19/10/11 00:38:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 00:38:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2160L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 00:38:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2160L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_2#2200]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2185: string
         :     :- Project [l_returnflag_prf#2162 AS l_returnflag_prf_0#2181, l_orderkey_and_l_linenumber_prf#2163 AS l_orderkey_and_l_linenumber_prf_0#2182, l_comment_prf#2164 AS l_comment_prf_0#2183, l_linestatus_prf#2165 AS l_linestatus_prf_0#2184, rid#2166 AS rid_0#2185, l_shipmode_prf#2167 AS l_shipmode_prf_0#2186, l_shipinstruct_prf#2168 AS l_shipinstruct_prf_0#2187, l_quantity_prf#2169 AS l_quantity_prf_0#2188, l_receiptdate_prf#2170 AS l_receiptdate_prf_0#2189, l_linenumber_prf#2171 AS l_linenumber_prf_0#2190, l_tax_prf#2172 AS l_tax_prf_0#2191, l_shipdate_prf#2173 AS l_shipdate_prf_0#2192, l_extendedprice_prf#2174 AS l_extendedprice_prf_0#2193, l_partkey_prf#2175 AS l_partkey_prf_0#2194, l_discount_prf#2176 AS l_discount_prf_0#2195, l_partkey_and_l_suppkey_prf#2177 AS l_partkey_and_l_suppkey_prf_0#2196, l_commitdate_prf#2178 AS l_commitdate_prf_0#2197, l_suppkey_prf#2179 AS l_suppkey_prf_0#2198, l_orderkey_prf#2180 AS l_orderkey_prf_0#2199]
         :     :  +- Relation[l_returnflag_prf#2162,l_orderkey_and_l_linenumber_prf#2163,l_comment_prf#2164,l_linestatus_prf#2165,rid#2166,l_shipmode_prf#2167,l_shipinstruct_prf#2168,l_quantity_prf#2169,l_receiptdate_prf#2170,l_linenumber_prf#2171,l_tax_prf#2172,l_shipdate_prf#2173,l_extendedprice_prf#2174,l_partkey_prf#2175,l_discount_prf#2176,l_partkey_and_l_suppkey_prf#2177,l_commitdate_prf#2178,l_suppkey_prf#2179,l_orderkey_prf#2180] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1583) AS rid_2#2219]
            :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#2211: string
            :     :- Project [c_acctbal_prf#2201 AS c_acctbal_prf_1#2210, rid#2202 AS rid_1#2211, c_name_prf#2203 AS c_name_prf_1#2212, c_nationkey_prf#2204 AS c_nationkey_prf_1#2213, c_custkey_prf#2205 AS c_custkey_prf_1#2214, c_comment_prf#2206 AS c_comment_prf_1#2215, c_address_prf#2207 AS c_address_prf_1#2216, c_mktsegment_prf#2208 AS c_mktsegment_prf_1#2217, c_phone_prf#2209 AS c_phone_prf_1#2218]
            :     :  +- Relation[c_acctbal_prf#2201,rid#2202,c_name_prf#2203,c_nationkey_prf#2204,c_custkey_prf#2205,c_comment_prf#2206,c_address_prf#2207,c_mktsegment_prf#2208,c_phone_prf#2209] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2220 AS o_shippriority_prf_2#2230, rid#2221 AS rid_2#2231, o_orderdate_prf#2222 AS o_orderdate_prf_2#2232, o_custkey_prf#2223 AS o_custkey_prf_2#2233, o_orderpriority_prf#2224 AS o_orderpriority_prf_2#2234, o_clerk_prf#2225 AS o_clerk_prf_2#2235, o_orderstatus_prf#2226 AS o_orderstatus_prf_2#2236, o_totalprice_prf#2227 AS o_totalprice_prf_2#2237, o_orderkey_prf#2228 AS o_orderkey_prf_2#2238, o_comment_prf#2229 AS o_comment_prf_2#2239]
               +- Relation[o_shippriority_prf#2220,rid#2221,o_orderdate_prf#2222,o_custkey_prf#2223,o_orderpriority_prf#2224,o_clerk_prf#2225,o_orderstatus_prf#2226,o_totalprice_prf#2227,o_orderkey_prf#2228,o_comment_prf#2229] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 175990ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/11 00:41:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 00:41:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2314L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 00:41:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2314L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#2334]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2326: string
         :     :- Project [c_acctbal_prf#2316 AS c_acctbal_prf_0#2325, rid#2317 AS rid_0#2326, c_name_prf#2318 AS c_name_prf_0#2327, c_nationkey_prf#2319 AS c_nationkey_prf_0#2328, c_custkey_prf#2320 AS c_custkey_prf_0#2329, c_comment_prf#2321 AS c_comment_prf_0#2330, c_address_prf#2322 AS c_address_prf_0#2331, c_mktsegment_prf#2323 AS c_mktsegment_prf_0#2332, c_phone_prf#2324 AS c_phone_prf_0#2333]
         :     :  +- Relation[c_acctbal_prf#2316,rid#2317,c_name_prf#2318,c_nationkey_prf#2319,c_custkey_prf#2320,c_comment_prf#2321,c_address_prf#2322,c_mktsegment_prf#2323,c_phone_prf#2324] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1583) AS rid_2#2355]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#2346: string
            :     :- Project [o_shippriority_prf#2335 AS o_shippriority_prf_1#2345, rid#2336 AS rid_1#2346, o_orderdate_prf#2337 AS o_orderdate_prf_1#2347, o_custkey_prf#2338 AS o_custkey_prf_1#2348, o_orderpriority_prf#2339 AS o_orderpriority_prf_1#2349, o_clerk_prf#2340 AS o_clerk_prf_1#2350, o_orderstatus_prf#2341 AS o_orderstatus_prf_1#2351, o_totalprice_prf#2342 AS o_totalprice_prf_1#2352, o_orderkey_prf#2343 AS o_orderkey_prf_1#2353, o_comment_prf#2344 AS o_comment_prf_1#2354]
            :     :  +- Relation[o_shippriority_prf#2335,rid#2336,o_orderdate_prf#2337,o_custkey_prf#2338,o_orderpriority_prf#2339,o_clerk_prf#2340,o_orderstatus_prf#2341,o_totalprice_prf#2342,o_orderkey_prf#2343,o_comment_prf#2344] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2356 AS l_returnflag_prf_2#2375, l_orderkey_and_l_linenumber_prf#2357 AS l_orderkey_and_l_linenumber_prf_2#2376, l_comment_prf#2358 AS l_comment_prf_2#2377, l_linestatus_prf#2359 AS l_linestatus_prf_2#2378, rid#2360 AS rid_2#2379, l_shipmode_prf#2361 AS l_shipmode_prf_2#2380, l_shipinstruct_prf#2362 AS l_shipinstruct_prf_2#2381, l_quantity_prf#2363 AS l_quantity_prf_2#2382, l_receiptdate_prf#2364 AS l_receiptdate_prf_2#2383, l_linenumber_prf#2365 AS l_linenumber_prf_2#2384, l_tax_prf#2366 AS l_tax_prf_2#2385, l_shipdate_prf#2367 AS l_shipdate_prf_2#2386, l_extendedprice_prf#2368 AS l_extendedprice_prf_2#2387, l_partkey_prf#2369 AS l_partkey_prf_2#2388, l_discount_prf#2370 AS l_discount_prf_2#2389, l_partkey_and_l_suppkey_prf#2371 AS l_partkey_and_l_suppkey_prf_2#2390, l_commitdate_prf#2372 AS l_commitdate_prf_2#2391, l_suppkey_prf#2373 AS l_suppkey_prf_2#2392, l_orderkey_prf#2374 AS l_orderkey_prf_2#2393]
               +- Relation[l_returnflag_prf#2356,l_orderkey_and_l_linenumber_prf#2357,l_comment_prf#2358,l_linestatus_prf#2359,rid#2360,l_shipmode_prf#2361,l_shipinstruct_prf#2362,l_quantity_prf#2363,l_receiptdate_prf#2364,l_linenumber_prf#2365,l_tax_prf#2366,l_shipdate_prf#2367,l_extendedprice_prf#2368,l_partkey_prf#2369,l_discount_prf#2370,l_partkey_and_l_suppkey_prf#2371,l_commitdate_prf#2372,l_suppkey_prf#2373,l_orderkey_prf#2374] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 241331ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/11 00:45:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 00:45:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2454L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 00:45:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2454L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1583) AS rid_2#2483]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#2466]
         :     :  :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#2461: string
         :     :  :     :- Project [rid#2456 AS rid_0#2461, n_regionkey_prf#2457 AS n_regionkey_prf_0#2462, n_nationkey_prf#2458 AS n_nationkey_prf_0#2463, n_name_prf#2459 AS n_name_prf_0#2464, n_comment_prf#2460 AS n_comment_prf_0#2465]
         :     :  :     :  +- Relation[rid#2456,n_regionkey_prf#2457,n_nationkey_prf#2458,n_name_prf#2459,n_comment_prf#2460] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#2467 AS s_phone_prf_1#2475, rid#2468 AS rid_1#2476, s_address_prf#2469 AS s_address_prf_1#2477, s_nationkey_prf#2470 AS s_nationkey_prf_1#2478, s_suppkey_prf#2471 AS s_suppkey_prf_1#2479, s_name_prf#2472 AS s_name_prf_1#2480, s_acctbal_prf#2473 AS s_acctbal_prf_1#2481, s_comment_prf#2474 AS s_comment_prf_1#2482]
         :     :     +- Relation[s_phone_prf#2467,rid#2468,s_address_prf#2469,s_nationkey_prf#2470,s_suppkey_prf#2471,s_name_prf#2472,s_acctbal_prf#2473,s_comment_prf#2474] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2484 AS c_acctbal_prf_2#2493, rid#2485 AS rid_2#2494, c_name_prf#2486 AS c_name_prf_2#2495, c_nationkey_prf#2487 AS c_nationkey_prf_2#2496, c_custkey_prf#2488 AS c_custkey_prf_2#2497, c_comment_prf#2489 AS c_comment_prf_2#2498, c_address_prf#2490 AS c_address_prf_2#2499, c_mktsegment_prf#2491 AS c_mktsegment_prf_2#2500, c_phone_prf#2492 AS c_phone_prf_2#2501]
            +- Relation[c_acctbal_prf#2484,rid#2485,c_name_prf#2486,c_nationkey_prf#2487,c_custkey_prf#2488,c_comment_prf#2489,c_address_prf#2490,c_mktsegment_prf#2491,c_phone_prf#2492] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 774250ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/11 00:58:48 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 00:58:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2559L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 00:58:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2559L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#2577]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#2570: string
         :     :- Project [s_phone_prf#2561 AS s_phone_prf_0#2569, rid#2562 AS rid_0#2570, s_address_prf#2563 AS s_address_prf_0#2571, s_nationkey_prf#2564 AS s_nationkey_prf_0#2572, s_suppkey_prf#2565 AS s_suppkey_prf_0#2573, s_name_prf#2566 AS s_name_prf_0#2574, s_acctbal_prf#2567 AS s_acctbal_prf_0#2575, s_comment_prf#2568 AS s_comment_prf_0#2576]
         :     :  +- Relation[s_phone_prf#2561,rid#2562,s_address_prf#2563,s_nationkey_prf#2564,s_suppkey_prf#2565,s_name_prf#2566,s_acctbal_prf#2567,s_comment_prf#2568] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1583) AS rid_2#2616]
            :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_1#2601: string
            :     :- Project [l_returnflag_prf#2578 AS l_returnflag_prf_1#2597, l_orderkey_and_l_linenumber_prf#2579 AS l_orderkey_and_l_linenumber_prf_1#2598, l_comment_prf#2580 AS l_comment_prf_1#2599, l_linestatus_prf#2581 AS l_linestatus_prf_1#2600, rid#2582 AS rid_1#2601, l_shipmode_prf#2583 AS l_shipmode_prf_1#2602, l_shipinstruct_prf#2584 AS l_shipinstruct_prf_1#2603, l_quantity_prf#2585 AS l_quantity_prf_1#2604, l_receiptdate_prf#2586 AS l_receiptdate_prf_1#2605, l_linenumber_prf#2587 AS l_linenumber_prf_1#2606, l_tax_prf#2588 AS l_tax_prf_1#2607, l_shipdate_prf#2589 AS l_shipdate_prf_1#2608, l_extendedprice_prf#2590 AS l_extendedprice_prf_1#2609, l_partkey_prf#2591 AS l_partkey_prf_1#2610, l_discount_prf#2592 AS l_discount_prf_1#2611, l_partkey_and_l_suppkey_prf#2593 AS l_partkey_and_l_suppkey_prf_1#2612, l_commitdate_prf#2594 AS l_commitdate_prf_1#2613, l_suppkey_prf#2595 AS l_suppkey_prf_1#2614, l_orderkey_prf#2596 AS l_orderkey_prf_1#2615]
            :     :  +- Relation[l_returnflag_prf#2578,l_orderkey_and_l_linenumber_prf#2579,l_comment_prf#2580,l_linestatus_prf#2581,rid#2582,l_shipmode_prf#2583,l_shipinstruct_prf#2584,l_quantity_prf#2585,l_receiptdate_prf#2586,l_linenumber_prf#2587,l_tax_prf#2588,l_shipdate_prf#2589,l_extendedprice_prf#2590,l_partkey_prf#2591,l_discount_prf#2592,l_partkey_and_l_suppkey_prf#2593,l_commitdate_prf#2594,l_suppkey_prf#2595,l_orderkey_prf#2596] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#2617 AS p_comment_prf_2#2627, p_name_prf#2618 AS p_name_prf_2#2628, rid#2619 AS rid_2#2629, p_type_prf#2620 AS p_type_prf_2#2630, p_retailprice_prf#2621 AS p_retailprice_prf_2#2631, p_mfgr_prf#2622 AS p_mfgr_prf_2#2632, p_container_prf#2623 AS p_container_prf_2#2633, p_brand_prf#2624 AS p_brand_prf_2#2634, p_size_prf#2625 AS p_size_prf_2#2635, p_partkey_prf#2626 AS p_partkey_prf_2#2636]
               +- Relation[p_comment_prf#2617,p_name_prf#2618,rid#2619,p_type_prf#2620,p_retailprice_prf#2621,p_mfgr_prf#2622,p_container_prf#2623,p_brand_prf#2624,p_size_prf#2625,p_partkey_prf#2626] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 199170ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/11 01:02:07 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:02:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2709L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 01:02:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2709L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#2731]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2723: string
         :     :  :     :- Project [p_comment_prf#2711 AS p_comment_prf_0#2721, p_name_prf#2712 AS p_name_prf_0#2722, rid#2713 AS rid_0#2723, p_type_prf#2714 AS p_type_prf_0#2724, p_retailprice_prf#2715 AS p_retailprice_prf_0#2725, p_mfgr_prf#2716 AS p_mfgr_prf_0#2726, p_container_prf#2717 AS p_container_prf_0#2727, p_brand_prf#2718 AS p_brand_prf_0#2728, p_size_prf#2719 AS p_size_prf_0#2729, p_partkey_prf#2720 AS p_partkey_prf_0#2730]
         :     :  :     :  +- Relation[p_comment_prf#2711,p_name_prf#2712,rid#2713,p_type_prf#2714,p_retailprice_prf#2715,p_mfgr_prf#2716,p_container_prf#2717,p_brand_prf#2718,p_size_prf#2719,p_partkey_prf#2720] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#2732 AS l_returnflag_prf_1#2751, l_orderkey_and_l_linenumber_prf#2733 AS l_orderkey_and_l_linenumber_prf_1#2752, l_comment_prf#2734 AS l_comment_prf_1#2753, l_linestatus_prf#2735 AS l_linestatus_prf_1#2754, rid#2736 AS rid_1#2755, l_shipmode_prf#2737 AS l_shipmode_prf_1#2756, l_shipinstruct_prf#2738 AS l_shipinstruct_prf_1#2757, l_quantity_prf#2739 AS l_quantity_prf_1#2758, l_receiptdate_prf#2740 AS l_receiptdate_prf_1#2759, l_linenumber_prf#2741 AS l_linenumber_prf_1#2760, l_tax_prf#2742 AS l_tax_prf_1#2761, l_shipdate_prf#2743 AS l_shipdate_prf_1#2762, l_extendedprice_prf#2744 AS l_extendedprice_prf_1#2763, l_partkey_prf#2745 AS l_partkey_prf_1#2764, l_discount_prf#2746 AS l_discount_prf_1#2765, l_partkey_and_l_suppkey_prf#2747 AS l_partkey_and_l_suppkey_prf_1#2766, l_commitdate_prf#2748 AS l_commitdate_prf_1#2767, l_suppkey_prf#2749 AS l_suppkey_prf_1#2768, l_orderkey_prf#2750 AS l_orderkey_prf_1#2769]
         :     :     +- Relation[l_returnflag_prf#2732,l_orderkey_and_l_linenumber_prf#2733,l_comment_prf#2734,l_linestatus_prf#2735,rid#2736,l_shipmode_prf#2737,l_shipinstruct_prf#2738,l_quantity_prf#2739,l_receiptdate_prf#2740,l_linenumber_prf#2741,l_tax_prf#2742,l_shipdate_prf#2743,l_extendedprice_prf#2744,l_partkey_prf#2745,l_discount_prf#2746,l_partkey_and_l_suppkey_prf#2747,l_commitdate_prf#2748,l_suppkey_prf#2749,l_orderkey_prf#2750] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2771 AS s_phone_prf_2#2779, rid#2772 AS rid_2#2780, s_address_prf#2773 AS s_address_prf_2#2781, s_nationkey_prf#2774 AS s_nationkey_prf_2#2782, s_suppkey_prf#2775 AS s_suppkey_prf_2#2783, s_name_prf#2776 AS s_name_prf_2#2784, s_acctbal_prf#2777 AS s_acctbal_prf_2#2785, s_comment_prf#2778 AS s_comment_prf_2#2786]
            +- Relation[s_phone_prf#2771,rid#2772,s_address_prf#2773,s_nationkey_prf#2774,s_suppkey_prf#2775,s_name_prf#2776,s_acctbal_prf#2777,s_comment_prf#2778] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 312826ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/11 01:07:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:07:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2860L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 01:07:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2860L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#2900]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2885: string
         :     :  :     :- Project [l_returnflag_prf#2862 AS l_returnflag_prf_0#2881, l_orderkey_and_l_linenumber_prf#2863 AS l_orderkey_and_l_linenumber_prf_0#2882, l_comment_prf#2864 AS l_comment_prf_0#2883, l_linestatus_prf#2865 AS l_linestatus_prf_0#2884, rid#2866 AS rid_0#2885, l_shipmode_prf#2867 AS l_shipmode_prf_0#2886, l_shipinstruct_prf#2868 AS l_shipinstruct_prf_0#2887, l_quantity_prf#2869 AS l_quantity_prf_0#2888, l_receiptdate_prf#2870 AS l_receiptdate_prf_0#2889, l_linenumber_prf#2871 AS l_linenumber_prf_0#2890, l_tax_prf#2872 AS l_tax_prf_0#2891, l_shipdate_prf#2873 AS l_shipdate_prf_0#2892, l_extendedprice_prf#2874 AS l_extendedprice_prf_0#2893, l_partkey_prf#2875 AS l_partkey_prf_0#2894, l_discount_prf#2876 AS l_discount_prf_0#2895, l_partkey_and_l_suppkey_prf#2877 AS l_partkey_and_l_suppkey_prf_0#2896, l_commitdate_prf#2878 AS l_commitdate_prf_0#2897, l_suppkey_prf#2879 AS l_suppkey_prf_0#2898, l_orderkey_prf#2880 AS l_orderkey_prf_0#2899]
         :     :  :     :  +- Relation[l_returnflag_prf#2862,l_orderkey_and_l_linenumber_prf#2863,l_comment_prf#2864,l_linestatus_prf#2865,rid#2866,l_shipmode_prf#2867,l_shipinstruct_prf#2868,l_quantity_prf#2869,l_receiptdate_prf#2870,l_linenumber_prf#2871,l_tax_prf#2872,l_shipdate_prf#2873,l_extendedprice_prf#2874,l_partkey_prf#2875,l_discount_prf#2876,l_partkey_and_l_suppkey_prf#2877,l_commitdate_prf#2878,l_suppkey_prf#2879,l_orderkey_prf#2880] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#2901 AS o_shippriority_prf_1#2911, rid#2902 AS rid_1#2912, o_orderdate_prf#2903 AS o_orderdate_prf_1#2913, o_custkey_prf#2904 AS o_custkey_prf_1#2914, o_orderpriority_prf#2905 AS o_orderpriority_prf_1#2915, o_clerk_prf#2906 AS o_clerk_prf_1#2916, o_orderstatus_prf#2907 AS o_orderstatus_prf_1#2917, o_totalprice_prf#2908 AS o_totalprice_prf_1#2918, o_orderkey_prf#2909 AS o_orderkey_prf_1#2919, o_comment_prf#2910 AS o_comment_prf_1#2920]
         :     :     +- Relation[o_shippriority_prf#2901,rid#2902,o_orderdate_prf#2903,o_custkey_prf#2904,o_orderpriority_prf#2905,o_clerk_prf#2906,o_orderstatus_prf#2907,o_totalprice_prf#2908,o_orderkey_prf#2909,o_comment_prf#2910] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2922 AS c_acctbal_prf_2#2931, rid#2923 AS rid_2#2932, c_name_prf#2924 AS c_name_prf_2#2933, c_nationkey_prf#2925 AS c_nationkey_prf_2#2934, c_custkey_prf#2926 AS c_custkey_prf_2#2935, c_comment_prf#2927 AS c_comment_prf_2#2936, c_address_prf#2928 AS c_address_prf_2#2937, c_mktsegment_prf#2929 AS c_mktsegment_prf_2#2938, c_phone_prf#2930 AS c_phone_prf_2#2939]
            +- Relation[c_acctbal_prf#2922,rid#2923,c_name_prf#2924,c_nationkey_prf#2925,c_custkey_prf#2926,c_comment_prf#2927,c_address_prf#2928,c_mktsegment_prf#2929,c_phone_prf#2930] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 343759ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/11 01:13:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:13:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2993L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 01:13:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2993L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#3005]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#3000: string
         :     :- Project [rid#2995 AS rid_0#3000, n_regionkey_prf#2996 AS n_regionkey_prf_0#3001, n_nationkey_prf#2997 AS n_nationkey_prf_0#3002, n_name_prf#2998 AS n_name_prf_0#3003, n_comment_prf#2999 AS n_comment_prf_0#3004]
         :     :  +- Relation[rid#2995,n_regionkey_prf#2996,n_nationkey_prf#2997,n_name_prf#2998,n_comment_prf#2999] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3006 AS c_acctbal_prf_1#3015, rid#3007 AS rid_1#3016, c_name_prf#3008 AS c_name_prf_1#3017, c_nationkey_prf#3009 AS c_nationkey_prf_1#3018, c_custkey_prf#3010 AS c_custkey_prf_1#3019, c_comment_prf#3011 AS c_comment_prf_1#3020, c_address_prf#3012 AS c_address_prf_1#3021, c_mktsegment_prf#3013 AS c_mktsegment_prf_1#3022, c_phone_prf#3014 AS c_phone_prf_1#3023]
            +- Relation[c_acctbal_prf#3006,rid#3007,c_name_prf#3008,c_nationkey_prf#3009,c_custkey_prf#3010,c_comment_prf#3011,c_address_prf#3012,c_mktsegment_prf#3013,c_phone_prf#3014] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=150000
Elapsed time: 1946ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/11 01:13:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:13:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3064L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 01:13:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3064L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#3082]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#3075: string
         :     :- Project [s_phone_prf#3066 AS s_phone_prf_0#3074, rid#3067 AS rid_0#3075, s_address_prf#3068 AS s_address_prf_0#3076, s_nationkey_prf#3069 AS s_nationkey_prf_0#3077, s_suppkey_prf#3070 AS s_suppkey_prf_0#3078, s_name_prf#3071 AS s_name_prf_0#3079, s_acctbal_prf#3072 AS s_acctbal_prf_0#3080, s_comment_prf#3073 AS s_comment_prf_0#3081]
         :     :  +- Relation[s_phone_prf#3066,rid#3067,s_address_prf#3068,s_nationkey_prf#3069,s_suppkey_prf#3070,s_name_prf#3071,s_acctbal_prf#3072,s_comment_prf#3073] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3083 AS l_returnflag_prf_1#3102, l_orderkey_and_l_linenumber_prf#3084 AS l_orderkey_and_l_linenumber_prf_1#3103, l_comment_prf#3085 AS l_comment_prf_1#3104, l_linestatus_prf#3086 AS l_linestatus_prf_1#3105, rid#3087 AS rid_1#3106, l_shipmode_prf#3088 AS l_shipmode_prf_1#3107, l_shipinstruct_prf#3089 AS l_shipinstruct_prf_1#3108, l_quantity_prf#3090 AS l_quantity_prf_1#3109, l_receiptdate_prf#3091 AS l_receiptdate_prf_1#3110, l_linenumber_prf#3092 AS l_linenumber_prf_1#3111, l_tax_prf#3093 AS l_tax_prf_1#3112, l_shipdate_prf#3094 AS l_shipdate_prf_1#3113, l_extendedprice_prf#3095 AS l_extendedprice_prf_1#3114, l_partkey_prf#3096 AS l_partkey_prf_1#3115, l_discount_prf#3097 AS l_discount_prf_1#3116, l_partkey_and_l_suppkey_prf#3098 AS l_partkey_and_l_suppkey_prf_1#3117, l_commitdate_prf#3099 AS l_commitdate_prf_1#3118, l_suppkey_prf#3100 AS l_suppkey_prf_1#3119, l_orderkey_prf#3101 AS l_orderkey_prf_1#3120]
            +- Relation[l_returnflag_prf#3083,l_orderkey_and_l_linenumber_prf#3084,l_comment_prf#3085,l_linestatus_prf#3086,rid#3087,l_shipmode_prf#3088,l_shipinstruct_prf#3089,l_quantity_prf#3090,l_receiptdate_prf#3091,l_linenumber_prf#3092,l_tax_prf#3093,l_shipdate_prf#3094,l_extendedprice_prf#3095,l_partkey_prf#3096,l_discount_prf#3097,l_partkey_and_l_suppkey_prf#3098,l_commitdate_prf#3099,l_suppkey_prf#3100,l_orderkey_prf#3101] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 88401ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/11 01:14:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:14:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3183L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 01:14:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3183L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_2#3201]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#3194: string
         :     :- Project [s_phone_prf#3185 AS s_phone_prf_0#3193, rid#3186 AS rid_0#3194, s_address_prf#3187 AS s_address_prf_0#3195, s_nationkey_prf#3188 AS s_nationkey_prf_0#3196, s_suppkey_prf#3189 AS s_suppkey_prf_0#3197, s_name_prf#3190 AS s_name_prf_0#3198, s_acctbal_prf#3191 AS s_acctbal_prf_0#3199, s_comment_prf#3192 AS s_comment_prf_0#3200]
         :     :  +- Relation[s_phone_prf#3185,rid#3186,s_address_prf#3187,s_nationkey_prf#3188,s_suppkey_prf#3189,s_name_prf#3190,s_acctbal_prf#3191,s_comment_prf#3192] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1583) AS rid_2#3222]
            :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#3214: string
            :     :- Project [p_comment_prf#3202 AS p_comment_prf_1#3212, p_name_prf#3203 AS p_name_prf_1#3213, rid#3204 AS rid_1#3214, p_type_prf#3205 AS p_type_prf_1#3215, p_retailprice_prf#3206 AS p_retailprice_prf_1#3216, p_mfgr_prf#3207 AS p_mfgr_prf_1#3217, p_container_prf#3208 AS p_container_prf_1#3218, p_brand_prf#3209 AS p_brand_prf_1#3219, p_size_prf#3210 AS p_size_prf_1#3220, p_partkey_prf#3211 AS p_partkey_prf_1#3221]
            :     :  +- Relation[p_comment_prf#3202,p_name_prf#3203,rid#3204,p_type_prf#3205,p_retailprice_prf#3206,p_mfgr_prf#3207,p_container_prf#3208,p_brand_prf#3209,p_size_prf#3210,p_partkey_prf#3211] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3223 AS l_returnflag_prf_2#3242, l_orderkey_and_l_linenumber_prf#3224 AS l_orderkey_and_l_linenumber_prf_2#3243, l_comment_prf#3225 AS l_comment_prf_2#3244, l_linestatus_prf#3226 AS l_linestatus_prf_2#3245, rid#3227 AS rid_2#3246, l_shipmode_prf#3228 AS l_shipmode_prf_2#3247, l_shipinstruct_prf#3229 AS l_shipinstruct_prf_2#3248, l_quantity_prf#3230 AS l_quantity_prf_2#3249, l_receiptdate_prf#3231 AS l_receiptdate_prf_2#3250, l_linenumber_prf#3232 AS l_linenumber_prf_2#3251, l_tax_prf#3233 AS l_tax_prf_2#3252, l_shipdate_prf#3234 AS l_shipdate_prf_2#3253, l_extendedprice_prf#3235 AS l_extendedprice_prf_2#3254, l_partkey_prf#3236 AS l_partkey_prf_2#3255, l_discount_prf#3237 AS l_discount_prf_2#3256, l_partkey_and_l_suppkey_prf#3238 AS l_partkey_and_l_suppkey_prf_2#3257, l_commitdate_prf#3239 AS l_commitdate_prf_2#3258, l_suppkey_prf#3240 AS l_suppkey_prf_2#3259, l_orderkey_prf#3241 AS l_orderkey_prf_2#3260]
               +- Relation[l_returnflag_prf#3223,l_orderkey_and_l_linenumber_prf#3224,l_comment_prf#3225,l_linestatus_prf#3226,rid#3227,l_shipmode_prf#3228,l_shipinstruct_prf#3229,l_quantity_prf#3230,l_receiptdate_prf#3231,l_linenumber_prf#3232,l_tax_prf#3233,l_shipdate_prf#3234,l_extendedprice_prf#3235,l_partkey_prf#3236,l_discount_prf#3237,l_partkey_and_l_suppkey_prf#3238,l_commitdate_prf#3239,l_suppkey_prf#3240,l_orderkey_prf#3241] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 189154ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/11 01:17:44 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:17:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3313L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 01:17:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3313L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#3331]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#3324: string
         :     :- Project [s_phone_prf#3315 AS s_phone_prf_0#3323, rid#3316 AS rid_0#3324, s_address_prf#3317 AS s_address_prf_0#3325, s_nationkey_prf#3318 AS s_nationkey_prf_0#3326, s_suppkey_prf#3319 AS s_suppkey_prf_0#3327, s_name_prf#3320 AS s_name_prf_0#3328, s_acctbal_prf#3321 AS s_acctbal_prf_0#3329, s_comment_prf#3322 AS s_comment_prf_0#3330]
         :     :  +- Relation[s_phone_prf#3315,rid#3316,s_address_prf#3317,s_nationkey_prf#3318,s_suppkey_prf#3319,s_name_prf#3320,s_acctbal_prf#3321,s_comment_prf#3322] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#3332 AS ps_partkey_and_ps_suppkey_prf_1#3339, rid#3333 AS rid_1#3340, ps_availqty_prf#3334 AS ps_availqty_prf_1#3341, ps_comment_prf#3335 AS ps_comment_prf_1#3342, ps_partkey_prf#3336 AS ps_partkey_prf_1#3343, ps_supplycost_prf#3337 AS ps_supplycost_prf_1#3344, ps_suppkey_prf#3338 AS ps_suppkey_prf_1#3345]
            +- Relation[ps_partkey_and_ps_suppkey_prf#3332,rid#3333,ps_availqty_prf#3334,ps_comment_prf#3335,ps_partkey_prf#3336,ps_supplycost_prf#3337,ps_suppkey_prf#3338] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 11240ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/11 01:17:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:17:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3397L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 01:17:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3397L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_2#3417]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3409: string
         :     :- Project [c_acctbal_prf#3399 AS c_acctbal_prf_0#3408, rid#3400 AS rid_0#3409, c_name_prf#3401 AS c_name_prf_0#3410, c_nationkey_prf#3402 AS c_nationkey_prf_0#3411, c_custkey_prf#3403 AS c_custkey_prf_0#3412, c_comment_prf#3404 AS c_comment_prf_0#3413, c_address_prf#3405 AS c_address_prf_0#3414, c_mktsegment_prf#3406 AS c_mktsegment_prf_0#3415, c_phone_prf#3407 AS c_phone_prf_0#3416]
         :     :  +- Relation[c_acctbal_prf#3399,rid#3400,c_name_prf#3401,c_nationkey_prf#3402,c_custkey_prf#3403,c_comment_prf#3404,c_address_prf#3405,c_mktsegment_prf#3406,c_phone_prf#3407] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1583) AS rid_2#3456]
            :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_1#3441: string
            :     :- Project [l_returnflag_prf#3418 AS l_returnflag_prf_1#3437, l_orderkey_and_l_linenumber_prf#3419 AS l_orderkey_and_l_linenumber_prf_1#3438, l_comment_prf#3420 AS l_comment_prf_1#3439, l_linestatus_prf#3421 AS l_linestatus_prf_1#3440, rid#3422 AS rid_1#3441, l_shipmode_prf#3423 AS l_shipmode_prf_1#3442, l_shipinstruct_prf#3424 AS l_shipinstruct_prf_1#3443, l_quantity_prf#3425 AS l_quantity_prf_1#3444, l_receiptdate_prf#3426 AS l_receiptdate_prf_1#3445, l_linenumber_prf#3427 AS l_linenumber_prf_1#3446, l_tax_prf#3428 AS l_tax_prf_1#3447, l_shipdate_prf#3429 AS l_shipdate_prf_1#3448, l_extendedprice_prf#3430 AS l_extendedprice_prf_1#3449, l_partkey_prf#3431 AS l_partkey_prf_1#3450, l_discount_prf#3432 AS l_discount_prf_1#3451, l_partkey_and_l_suppkey_prf#3433 AS l_partkey_and_l_suppkey_prf_1#3452, l_commitdate_prf#3434 AS l_commitdate_prf_1#3453, l_suppkey_prf#3435 AS l_suppkey_prf_1#3454, l_orderkey_prf#3436 AS l_orderkey_prf_1#3455]
            :     :  +- Relation[l_returnflag_prf#3418,l_orderkey_and_l_linenumber_prf#3419,l_comment_prf#3420,l_linestatus_prf#3421,rid#3422,l_shipmode_prf#3423,l_shipinstruct_prf#3424,l_quantity_prf#3425,l_receiptdate_prf#3426,l_linenumber_prf#3427,l_tax_prf#3428,l_shipdate_prf#3429,l_extendedprice_prf#3430,l_partkey_prf#3431,l_discount_prf#3432,l_partkey_and_l_suppkey_prf#3433,l_commitdate_prf#3434,l_suppkey_prf#3435,l_orderkey_prf#3436] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3457 AS o_shippriority_prf_2#3467, rid#3458 AS rid_2#3468, o_orderdate_prf#3459 AS o_orderdate_prf_2#3469, o_custkey_prf#3460 AS o_custkey_prf_2#3470, o_orderpriority_prf#3461 AS o_orderpriority_prf_2#3471, o_clerk_prf#3462 AS o_clerk_prf_2#3472, o_orderstatus_prf#3463 AS o_orderstatus_prf_2#3473, o_totalprice_prf#3464 AS o_totalprice_prf_2#3474, o_orderkey_prf#3465 AS o_orderkey_prf_2#3475, o_comment_prf#3466 AS o_comment_prf_2#3476]
               +- Relation[o_shippriority_prf#3457,rid#3458,o_orderdate_prf#3459,o_custkey_prf#3460,o_orderpriority_prf#3461,o_clerk_prf#3462,o_orderstatus_prf#3463,o_totalprice_prf#3464,o_orderkey_prf#3465,o_comment_prf#3466] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 175486ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/11 01:20:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:20:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3543L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 01:20:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3543L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#3565]
         :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3557: string
         :     :- Project [p_comment_prf#3545 AS p_comment_prf_0#3555, p_name_prf#3546 AS p_name_prf_0#3556, rid#3547 AS rid_0#3557, p_type_prf#3548 AS p_type_prf_0#3558, p_retailprice_prf#3549 AS p_retailprice_prf_0#3559, p_mfgr_prf#3550 AS p_mfgr_prf_0#3560, p_container_prf#3551 AS p_container_prf_0#3561, p_brand_prf#3552 AS p_brand_prf_0#3562, p_size_prf#3553 AS p_size_prf_0#3563, p_partkey_prf#3554 AS p_partkey_prf_0#3564]
         :     :  +- Relation[p_comment_prf#3545,p_name_prf#3546,rid#3547,p_type_prf#3548,p_retailprice_prf#3549,p_mfgr_prf#3550,p_container_prf#3551,p_brand_prf#3552,p_size_prf#3553,p_partkey_prf#3554] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3566 AS l_returnflag_prf_1#3585, l_orderkey_and_l_linenumber_prf#3567 AS l_orderkey_and_l_linenumber_prf_1#3586, l_comment_prf#3568 AS l_comment_prf_1#3587, l_linestatus_prf#3569 AS l_linestatus_prf_1#3588, rid#3570 AS rid_1#3589, l_shipmode_prf#3571 AS l_shipmode_prf_1#3590, l_shipinstruct_prf#3572 AS l_shipinstruct_prf_1#3591, l_quantity_prf#3573 AS l_quantity_prf_1#3592, l_receiptdate_prf#3574 AS l_receiptdate_prf_1#3593, l_linenumber_prf#3575 AS l_linenumber_prf_1#3594, l_tax_prf#3576 AS l_tax_prf_1#3595, l_shipdate_prf#3577 AS l_shipdate_prf_1#3596, l_extendedprice_prf#3578 AS l_extendedprice_prf_1#3597, l_partkey_prf#3579 AS l_partkey_prf_1#3598, l_discount_prf#3580 AS l_discount_prf_1#3599, l_partkey_and_l_suppkey_prf#3581 AS l_partkey_and_l_suppkey_prf_1#3600, l_commitdate_prf#3582 AS l_commitdate_prf_1#3601, l_suppkey_prf#3583 AS l_suppkey_prf_1#3602, l_orderkey_prf#3584 AS l_orderkey_prf_1#3603]
            +- Relation[l_returnflag_prf#3566,l_orderkey_and_l_linenumber_prf#3567,l_comment_prf#3568,l_linestatus_prf#3569,rid#3570,l_shipmode_prf#3571,l_shipinstruct_prf#3572,l_quantity_prf#3573,l_receiptdate_prf#3574,l_linenumber_prf#3575,l_tax_prf#3576,l_shipdate_prf#3577,l_extendedprice_prf#3578,l_partkey_prf#3579,l_discount_prf#3580,l_partkey_and_l_suppkey_prf#3581,l_commitdate_prf#3582,l_suppkey_prf#3583,l_orderkey_prf#3584] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 95742ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/11 01:22:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:22:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3657L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 01:22:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3657L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1583) AS rid_2#3694]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#3679]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#3671: string
         :     :  :     :- Project [p_comment_prf#3659 AS p_comment_prf_0#3669, p_name_prf#3660 AS p_name_prf_0#3670, rid#3661 AS rid_0#3671, p_type_prf#3662 AS p_type_prf_0#3672, p_retailprice_prf#3663 AS p_retailprice_prf_0#3673, p_mfgr_prf#3664 AS p_mfgr_prf_0#3674, p_container_prf#3665 AS p_container_prf_0#3675, p_brand_prf#3666 AS p_brand_prf_0#3676, p_size_prf#3667 AS p_size_prf_0#3677, p_partkey_prf#3668 AS p_partkey_prf_0#3678]
         :     :  :     :  +- Relation[p_comment_prf#3659,p_name_prf#3660,rid#3661,p_type_prf#3662,p_retailprice_prf#3663,p_mfgr_prf#3664,p_container_prf#3665,p_brand_prf#3666,p_size_prf#3667,p_partkey_prf#3668] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#3680 AS ps_partkey_and_ps_suppkey_prf_1#3687, rid#3681 AS rid_1#3688, ps_availqty_prf#3682 AS ps_availqty_prf_1#3689, ps_comment_prf#3683 AS ps_comment_prf_1#3690, ps_partkey_prf#3684 AS ps_partkey_prf_1#3691, ps_supplycost_prf#3685 AS ps_supplycost_prf_1#3692, ps_suppkey_prf#3686 AS ps_suppkey_prf_1#3693]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#3680,rid#3681,ps_availqty_prf#3682,ps_comment_prf#3683,ps_partkey_prf#3684,ps_supplycost_prf#3685,ps_suppkey_prf#3686] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3695 AS s_phone_prf_2#3703, rid#3696 AS rid_2#3704, s_address_prf#3697 AS s_address_prf_2#3705, s_nationkey_prf#3698 AS s_nationkey_prf_2#3706, s_suppkey_prf#3699 AS s_suppkey_prf_2#3707, s_name_prf#3700 AS s_name_prf_2#3708, s_acctbal_prf#3701 AS s_acctbal_prf_2#3709, s_comment_prf#3702 AS s_comment_prf_2#3710]
            +- Relation[s_phone_prf#3695,rid#3696,s_address_prf#3697,s_nationkey_prf#3698,s_suppkey_prf#3699,s_name_prf#3700,s_acctbal_prf#3701,s_comment_prf#3702] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 94357ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/11 01:24:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:24:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3764L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 01:24:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3764L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#3805]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3789: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#3766 AS l_returnflag_prf_0#3785, l_orderkey_and_l_linenumber_prf#3767 AS l_orderkey_and_l_linenumber_prf_0#3786, l_comment_prf#3768 AS l_comment_prf_0#3787, l_linestatus_prf#3769 AS l_linestatus_prf_0#3788, rid#3770 AS rid_0#3789, l_shipmode_prf#3771 AS l_shipmode_prf_0#3790, l_shipinstruct_prf#3772 AS l_shipinstruct_prf_0#3791, l_quantity_prf#3773 AS l_quantity_prf_0#3792, l_receiptdate_prf#3774 AS l_receiptdate_prf_0#3793, l_linenumber_prf#3775 AS l_linenumber_prf_0#3794, l_tax_prf#3776 AS l_tax_prf_0#3795, l_shipdate_prf#3777 AS l_shipdate_prf_0#3796, l_extendedprice_prf#3778 AS l_extendedprice_prf_0#3797, l_partkey_prf#3779 AS l_partkey_prf_0#3798, l_discount_prf#3780 AS l_discount_prf_0#3799, l_partkey_and_l_suppkey_prf#3781 AS l_partkey_and_l_suppkey_prf_0#3800, l_commitdate_prf#3782 AS l_commitdate_prf_0#3801, l_suppkey_prf#3783 AS l_suppkey_prf_0#3802, l_orderkey_prf#3784 AS l_orderkey_prf_0#3803]
         :     :  :  +- Relation[l_returnflag_prf#3766,l_orderkey_and_l_linenumber_prf#3767,l_comment_prf#3768,l_linestatus_prf#3769,rid#3770,l_shipmode_prf#3771,l_shipinstruct_prf#3772,l_quantity_prf#3773,l_receiptdate_prf#3774,l_linenumber_prf#3775,l_tax_prf#3776,l_shipdate_prf#3777,l_extendedprice_prf#3778,l_partkey_prf#3779,l_discount_prf#3780,l_partkey_and_l_suppkey_prf#3781,l_commitdate_prf#3782,l_suppkey_prf#3783,l_orderkey_prf#3784] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3804]
         :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :        +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3806 AS o_shippriority_prf_1#3816, rid#3807 AS rid_1#3817, o_orderdate_prf#3808 AS o_orderdate_prf_1#3818, o_custkey_prf#3809 AS o_custkey_prf_1#3819, o_orderpriority_prf#3810 AS o_orderpriority_prf_1#3820, o_clerk_prf#3811 AS o_clerk_prf_1#3821, o_orderstatus_prf#3812 AS o_orderstatus_prf_1#3822, o_totalprice_prf#3813 AS o_totalprice_prf_1#3823, o_orderkey_prf#3814 AS o_orderkey_prf_1#3824, o_comment_prf#3815 AS o_comment_prf_1#3825]
            +- Relation[o_shippriority_prf#3806,rid#3807,o_orderdate_prf#3808,o_custkey_prf#3809,o_orderpriority_prf#3810,o_clerk_prf#3811,o_orderstatus_prf#3812,o_totalprice_prf#3813,o_orderkey_prf#3814,o_comment_prf#3815] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 57284ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/11 01:24:58 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:24:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3879L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 01:24:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3879L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_2#3897]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#3890: string
         :     :- Project [s_phone_prf#3881 AS s_phone_prf_0#3889, rid#3882 AS rid_0#3890, s_address_prf#3883 AS s_address_prf_0#3891, s_nationkey_prf#3884 AS s_nationkey_prf_0#3892, s_suppkey_prf#3885 AS s_suppkey_prf_0#3893, s_name_prf#3886 AS s_name_prf_0#3894, s_acctbal_prf#3887 AS s_acctbal_prf_0#3895, s_comment_prf#3888 AS s_comment_prf_0#3896]
         :     :  +- Relation[s_phone_prf#3881,rid#3882,s_address_prf#3883,s_nationkey_prf#3884,s_suppkey_prf#3885,s_name_prf#3886,s_acctbal_prf#3887,s_comment_prf#3888] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1583) AS rid_2#3918]
            :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#3910: string
            :     :- Project [p_comment_prf#3898 AS p_comment_prf_1#3908, p_name_prf#3899 AS p_name_prf_1#3909, rid#3900 AS rid_1#3910, p_type_prf#3901 AS p_type_prf_1#3911, p_retailprice_prf#3902 AS p_retailprice_prf_1#3912, p_mfgr_prf#3903 AS p_mfgr_prf_1#3913, p_container_prf#3904 AS p_container_prf_1#3914, p_brand_prf#3905 AS p_brand_prf_1#3915, p_size_prf#3906 AS p_size_prf_1#3916, p_partkey_prf#3907 AS p_partkey_prf_1#3917]
            :     :  +- Relation[p_comment_prf#3898,p_name_prf#3899,rid#3900,p_type_prf#3901,p_retailprice_prf#3902,p_mfgr_prf#3903,p_container_prf#3904,p_brand_prf#3905,p_size_prf#3906,p_partkey_prf#3907] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#3919 AS ps_partkey_and_ps_suppkey_prf_2#3926, rid#3920 AS rid_2#3927, ps_availqty_prf#3921 AS ps_availqty_prf_2#3928, ps_comment_prf#3922 AS ps_comment_prf_2#3929, ps_partkey_prf#3923 AS ps_partkey_prf_2#3930, ps_supplycost_prf#3924 AS ps_supplycost_prf_2#3931, ps_suppkey_prf#3925 AS ps_suppkey_prf_2#3932]
               +- Relation[ps_partkey_and_ps_suppkey_prf#3919,rid#3920,ps_availqty_prf#3921,ps_comment_prf#3922,ps_partkey_prf#3923,ps_supplycost_prf#3924,ps_suppkey_prf#3925] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 43543ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/11 01:25:41 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:25:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3970L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 01:25:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3970L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#3972 AS p_comment_prf_0#3982, p_name_prf#3973 AS p_name_prf_0#3983, rid#3974 AS rid_0#3984, p_type_prf#3975 AS p_type_prf_0#3985, p_retailprice_prf#3976 AS p_retailprice_prf_0#3986, p_mfgr_prf#3977 AS p_mfgr_prf_0#3987, p_container_prf#3978 AS p_container_prf_0#3988, p_brand_prf#3979 AS p_brand_prf_0#3989, p_size_prf#3980 AS p_size_prf_0#3990, p_partkey_prf#3981 AS p_partkey_prf_0#3991]
         :  +- Relation[p_comment_prf#3972,p_name_prf#3973,rid#3974,p_type_prf#3975,p_retailprice_prf#3976,p_mfgr_prf#3977,p_container_prf#3978,p_brand_prf#3979,p_size_prf#3980,p_partkey_prf#3981] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3992]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1451
Elapsed time: 84ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/11 01:25:41 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:25:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4027L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 01:25:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4027L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#4043]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, rid_0#4037: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#4029 AS ps_partkey_and_ps_suppkey_prf_0#4036, rid#4030 AS rid_0#4037, ps_availqty_prf#4031 AS ps_availqty_prf_0#4038, ps_comment_prf#4032 AS ps_comment_prf_0#4039, ps_partkey_prf#4033 AS ps_partkey_prf_0#4040, ps_supplycost_prf#4034 AS ps_supplycost_prf_0#4041, ps_suppkey_prf#4035 AS ps_suppkey_prf_0#4042]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#4029,rid#4030,ps_availqty_prf#4031,ps_comment_prf#4032,ps_partkey_prf#4033,ps_supplycost_prf#4034,ps_suppkey_prf#4035] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4044 AS l_returnflag_prf_1#4063, l_orderkey_and_l_linenumber_prf#4045 AS l_orderkey_and_l_linenumber_prf_1#4064, l_comment_prf#4046 AS l_comment_prf_1#4065, l_linestatus_prf#4047 AS l_linestatus_prf_1#4066, rid#4048 AS rid_1#4067, l_shipmode_prf#4049 AS l_shipmode_prf_1#4068, l_shipinstruct_prf#4050 AS l_shipinstruct_prf_1#4069, l_quantity_prf#4051 AS l_quantity_prf_1#4070, l_receiptdate_prf#4052 AS l_receiptdate_prf_1#4071, l_linenumber_prf#4053 AS l_linenumber_prf_1#4072, l_tax_prf#4054 AS l_tax_prf_1#4073, l_shipdate_prf#4055 AS l_shipdate_prf_1#4074, l_extendedprice_prf#4056 AS l_extendedprice_prf_1#4075, l_partkey_prf#4057 AS l_partkey_prf_1#4076, l_discount_prf#4058 AS l_discount_prf_1#4077, l_partkey_and_l_suppkey_prf#4059 AS l_partkey_and_l_suppkey_prf_1#4078, l_commitdate_prf#4060 AS l_commitdate_prf_1#4079, l_suppkey_prf#4061 AS l_suppkey_prf_1#4080, l_orderkey_prf#4062 AS l_orderkey_prf_1#4081]
            +- Relation[l_returnflag_prf#4044,l_orderkey_and_l_linenumber_prf#4045,l_comment_prf#4046,l_linestatus_prf#4047,rid#4048,l_shipmode_prf#4049,l_shipinstruct_prf#4050,l_quantity_prf#4051,l_receiptdate_prf#4052,l_linenumber_prf#4053,l_tax_prf#4054,l_shipdate_prf#4055,l_extendedprice_prf#4056,l_partkey_prf#4057,l_discount_prf#4058,l_partkey_and_l_suppkey_prf#4059,l_commitdate_prf#4060,l_suppkey_prf#4061,l_orderkey_prf#4062] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 117416ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/11 01:27:39 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:27:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4136L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 01:27:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4136L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#4158]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#4149: string
         :     :- Project [o_shippriority_prf#4138 AS o_shippriority_prf_0#4148, rid#4139 AS rid_0#4149, o_orderdate_prf#4140 AS o_orderdate_prf_0#4150, o_custkey_prf#4141 AS o_custkey_prf_0#4151, o_orderpriority_prf#4142 AS o_orderpriority_prf_0#4152, o_clerk_prf#4143 AS o_clerk_prf_0#4153, o_orderstatus_prf#4144 AS o_orderstatus_prf_0#4154, o_totalprice_prf#4145 AS o_totalprice_prf_0#4155, o_orderkey_prf#4146 AS o_orderkey_prf_0#4156, o_comment_prf#4147 AS o_comment_prf_0#4157]
         :     :  +- Relation[o_shippriority_prf#4138,rid#4139,o_orderdate_prf#4140,o_custkey_prf#4141,o_orderpriority_prf#4142,o_clerk_prf#4143,o_orderstatus_prf#4144,o_totalprice_prf#4145,o_orderkey_prf#4146,o_comment_prf#4147] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#4159 AS l_returnflag_prf_1#4178, l_orderkey_and_l_linenumber_prf#4160 AS l_orderkey_and_l_linenumber_prf_1#4179, l_comment_prf#4161 AS l_comment_prf_1#4180, l_linestatus_prf#4162 AS l_linestatus_prf_1#4181, rid#4163 AS rid_1#4182, l_shipmode_prf#4164 AS l_shipmode_prf_1#4183, l_shipinstruct_prf#4165 AS l_shipinstruct_prf_1#4184, l_quantity_prf#4166 AS l_quantity_prf_1#4185, l_receiptdate_prf#4167 AS l_receiptdate_prf_1#4186, l_linenumber_prf#4168 AS l_linenumber_prf_1#4187, l_tax_prf#4169 AS l_tax_prf_1#4188, l_shipdate_prf#4170 AS l_shipdate_prf_1#4189, l_extendedprice_prf#4171 AS l_extendedprice_prf_1#4190, l_partkey_prf#4172 AS l_partkey_prf_1#4191, l_discount_prf#4173 AS l_discount_prf_1#4192, l_partkey_and_l_suppkey_prf#4174 AS l_partkey_and_l_suppkey_prf_1#4193, l_commitdate_prf#4175 AS l_commitdate_prf_1#4194, l_suppkey_prf#4176 AS l_suppkey_prf_1#4195, l_orderkey_prf#4177 AS l_orderkey_prf_1#4196]
            :  +- Relation[l_returnflag_prf#4159,l_orderkey_and_l_linenumber_prf#4160,l_comment_prf#4161,l_linestatus_prf#4162,rid#4163,l_shipmode_prf#4164,l_shipinstruct_prf#4165,l_quantity_prf#4166,l_receiptdate_prf#4167,l_linenumber_prf#4168,l_tax_prf#4169,l_shipdate_prf#4170,l_extendedprice_prf#4171,l_partkey_prf#4172,l_discount_prf#4173,l_partkey_and_l_suppkey_prf#4174,l_commitdate_prf#4175,l_suppkey_prf#4176,l_orderkey_prf#4177] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4197]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 201225ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/11 01:31:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:31:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4244L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 01:31:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4244L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#4266]
         :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4258: string
         :     :- Project [p_comment_prf#4246 AS p_comment_prf_0#4256, p_name_prf#4247 AS p_name_prf_0#4257, rid#4248 AS rid_0#4258, p_type_prf#4249 AS p_type_prf_0#4259, p_retailprice_prf#4250 AS p_retailprice_prf_0#4260, p_mfgr_prf#4251 AS p_mfgr_prf_0#4261, p_container_prf#4252 AS p_container_prf_0#4262, p_brand_prf#4253 AS p_brand_prf_0#4263, p_size_prf#4254 AS p_size_prf_0#4264, p_partkey_prf#4255 AS p_partkey_prf_0#4265]
         :     :  +- Relation[p_comment_prf#4246,p_name_prf#4247,rid#4248,p_type_prf#4249,p_retailprice_prf#4250,p_mfgr_prf#4251,p_container_prf#4252,p_brand_prf#4253,p_size_prf#4254,p_partkey_prf#4255] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4267 AS ps_partkey_and_ps_suppkey_prf_1#4274, rid#4268 AS rid_1#4275, ps_availqty_prf#4269 AS ps_availqty_prf_1#4276, ps_comment_prf#4270 AS ps_comment_prf_1#4277, ps_partkey_prf#4271 AS ps_partkey_prf_1#4278, ps_supplycost_prf#4272 AS ps_supplycost_prf_1#4279, ps_suppkey_prf#4273 AS ps_suppkey_prf_1#4280]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4267,rid#4268,ps_availqty_prf#4269,ps_comment_prf#4270,ps_partkey_prf#4271,ps_supplycost_prf#4272,ps_suppkey_prf#4273] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 32102ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/11 01:31:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:31:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4334L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 01:31:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4334L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#4374]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4359: string
         :     :- Project [l_returnflag_prf#4336 AS l_returnflag_prf_0#4355, l_orderkey_and_l_linenumber_prf#4337 AS l_orderkey_and_l_linenumber_prf_0#4356, l_comment_prf#4338 AS l_comment_prf_0#4357, l_linestatus_prf#4339 AS l_linestatus_prf_0#4358, rid#4340 AS rid_0#4359, l_shipmode_prf#4341 AS l_shipmode_prf_0#4360, l_shipinstruct_prf#4342 AS l_shipinstruct_prf_0#4361, l_quantity_prf#4343 AS l_quantity_prf_0#4362, l_receiptdate_prf#4344 AS l_receiptdate_prf_0#4363, l_linenumber_prf#4345 AS l_linenumber_prf_0#4364, l_tax_prf#4346 AS l_tax_prf_0#4365, l_shipdate_prf#4347 AS l_shipdate_prf_0#4366, l_extendedprice_prf#4348 AS l_extendedprice_prf_0#4367, l_partkey_prf#4349 AS l_partkey_prf_0#4368, l_discount_prf#4350 AS l_discount_prf_0#4369, l_partkey_and_l_suppkey_prf#4351 AS l_partkey_and_l_suppkey_prf_0#4370, l_commitdate_prf#4352 AS l_commitdate_prf_0#4371, l_suppkey_prf#4353 AS l_suppkey_prf_0#4372, l_orderkey_prf#4354 AS l_orderkey_prf_0#4373]
         :     :  +- Relation[l_returnflag_prf#4336,l_orderkey_and_l_linenumber_prf#4337,l_comment_prf#4338,l_linestatus_prf#4339,rid#4340,l_shipmode_prf#4341,l_shipinstruct_prf#4342,l_quantity_prf#4343,l_receiptdate_prf#4344,l_linenumber_prf#4345,l_tax_prf#4346,l_shipdate_prf#4347,l_extendedprice_prf#4348,l_partkey_prf#4349,l_discount_prf#4350,l_partkey_and_l_suppkey_prf#4351,l_commitdate_prf#4352,l_suppkey_prf#4353,l_orderkey_prf#4354] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1583) AS rid_2#4395]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#4386: string
            :     :- Project [o_shippriority_prf#4375 AS o_shippriority_prf_1#4385, rid#4376 AS rid_1#4386, o_orderdate_prf#4377 AS o_orderdate_prf_1#4387, o_custkey_prf#4378 AS o_custkey_prf_1#4388, o_orderpriority_prf#4379 AS o_orderpriority_prf_1#4389, o_clerk_prf#4380 AS o_clerk_prf_1#4390, o_orderstatus_prf#4381 AS o_orderstatus_prf_1#4391, o_totalprice_prf#4382 AS o_totalprice_prf_1#4392, o_orderkey_prf#4383 AS o_orderkey_prf_1#4393, o_comment_prf#4384 AS o_comment_prf_1#4394]
            :     :  +- Relation[o_shippriority_prf#4375,rid#4376,o_orderdate_prf#4377,o_custkey_prf#4378,o_orderpriority_prf#4379,o_clerk_prf#4380,o_orderstatus_prf#4381,o_totalprice_prf#4382,o_orderkey_prf#4383,o_comment_prf#4384] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4396 AS c_acctbal_prf_2#4405, rid#4397 AS rid_2#4406, c_name_prf#4398 AS c_name_prf_2#4407, c_nationkey_prf#4399 AS c_nationkey_prf_2#4408, c_custkey_prf#4400 AS c_custkey_prf_2#4409, c_comment_prf#4401 AS c_comment_prf_2#4410, c_address_prf#4402 AS c_address_prf_2#4411, c_mktsegment_prf#4403 AS c_mktsegment_prf_2#4412, c_phone_prf#4404 AS c_phone_prf_2#4413]
               +- Relation[c_acctbal_prf#4396,rid#4397,c_name_prf#4398,c_nationkey_prf#4399,c_custkey_prf#4400,c_comment_prf#4401,c_address_prf#4402,c_mktsegment_prf#4403,c_phone_prf#4404] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 167657ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/11 01:34:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:34:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4471L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 01:34:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4471L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#4473 AS l_returnflag_prf_0#4492, l_orderkey_and_l_linenumber_prf#4474 AS l_orderkey_and_l_linenumber_prf_0#4493, l_comment_prf#4475 AS l_comment_prf_0#4494, l_linestatus_prf#4476 AS l_linestatus_prf_0#4495, rid#4477 AS rid_0#4496, l_shipmode_prf#4478 AS l_shipmode_prf_0#4497, l_shipinstruct_prf#4479 AS l_shipinstruct_prf_0#4498, l_quantity_prf#4480 AS l_quantity_prf_0#4499, l_receiptdate_prf#4481 AS l_receiptdate_prf_0#4500, l_linenumber_prf#4482 AS l_linenumber_prf_0#4501, l_tax_prf#4483 AS l_tax_prf_0#4502, l_shipdate_prf#4484 AS l_shipdate_prf_0#4503, l_extendedprice_prf#4485 AS l_extendedprice_prf_0#4504, l_partkey_prf#4486 AS l_partkey_prf_0#4505, l_discount_prf#4487 AS l_discount_prf_0#4506, l_partkey_and_l_suppkey_prf#4488 AS l_partkey_and_l_suppkey_prf_0#4507, l_commitdate_prf#4489 AS l_commitdate_prf_0#4508, l_suppkey_prf#4490 AS l_suppkey_prf_0#4509, l_orderkey_prf#4491 AS l_orderkey_prf_0#4510]
         :  +- Relation[l_returnflag_prf#4473,l_orderkey_and_l_linenumber_prf#4474,l_comment_prf#4475,l_linestatus_prf#4476,rid#4477,l_shipmode_prf#4478,l_shipinstruct_prf#4479,l_quantity_prf#4480,l_receiptdate_prf#4481,l_linenumber_prf#4482,l_tax_prf#4483,l_shipdate_prf#4484,l_extendedprice_prf#4485,l_partkey_prf#4486,l_discount_prf#4487,l_partkey_and_l_suppkey_prf#4488,l_commitdate_prf#4489,l_suppkey_prf#4490,l_orderkey_prf#4491] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4511]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 23786ms

f1=
select * from region where r_name = 'EUROPE'
19/10/11 01:34:43 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:34:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4537L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/11 01:34:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4537L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#4539 AS r_regionkey_prf_0#4543, r_name_prf#4540 AS r_name_prf_0#4544, r_comment_prf#4541 AS r_comment_prf_0#4545, rid#4542 AS rid_0#4546]
         :  +- Relation[r_regionkey_prf#4539,r_name_prf#4540,r_comment_prf#4541,rid#4542] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4547]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 52ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/11 01:34:44 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:34:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4569L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 01:34:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4569L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#4592]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4583: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#4571 AS p_comment_prf_0#4581, p_name_prf#4572 AS p_name_prf_0#4582, rid#4573 AS rid_0#4583, p_type_prf#4574 AS p_type_prf_0#4584, p_retailprice_prf#4575 AS p_retailprice_prf_0#4585, p_mfgr_prf#4576 AS p_mfgr_prf_0#4586, p_container_prf#4577 AS p_container_prf_0#4587, p_brand_prf#4578 AS p_brand_prf_0#4588, p_size_prf#4579 AS p_size_prf_0#4589, p_partkey_prf#4580 AS p_partkey_prf_0#4590]
         :     :  :  +- Relation[p_comment_prf#4571,p_name_prf#4572,rid#4573,p_type_prf#4574,p_retailprice_prf#4575,p_mfgr_prf#4576,p_container_prf#4577,p_brand_prf#4578,p_size_prf#4579,p_partkey_prf#4580] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4591]
         :     :     +- DexRidFilter part~p_size~15
         :     :        +- Relation[label#1527,value#1528] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4593 AS ps_partkey_and_ps_suppkey_prf_1#4600, rid#4594 AS rid_1#4601, ps_availqty_prf#4595 AS ps_availqty_prf_1#4602, ps_comment_prf#4596 AS ps_comment_prf_1#4603, ps_partkey_prf#4597 AS ps_partkey_prf_1#4604, ps_supplycost_prf#4598 AS ps_supplycost_prf_1#4605, ps_suppkey_prf#4599 AS ps_suppkey_prf_1#4606]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4593,rid#4594,ps_availqty_prf#4595,ps_comment_prf#4596,ps_partkey_prf#4597,ps_supplycost_prf#4598,ps_suppkey_prf#4599] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 381ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/11 01:34:44 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:34:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4648L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 01:34:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4648L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1583) AS rid_2#4685]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#4664]
         :     :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#4658: string
         :     :  :     :- Project [ps_partkey_and_ps_suppkey_prf#4650 AS ps_partkey_and_ps_suppkey_prf_0#4657, rid#4651 AS rid_0#4658, ps_availqty_prf#4652 AS ps_availqty_prf_0#4659, ps_comment_prf#4653 AS ps_comment_prf_0#4660, ps_partkey_prf#4654 AS ps_partkey_prf_0#4661, ps_supplycost_prf#4655 AS ps_supplycost_prf_0#4662, ps_suppkey_prf#4656 AS ps_suppkey_prf_0#4663]
         :     :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#4650,rid#4651,ps_availqty_prf#4652,ps_comment_prf#4653,ps_partkey_prf#4654,ps_supplycost_prf#4655,ps_suppkey_prf#4656] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#4665 AS p_comment_prf_1#4675, p_name_prf#4666 AS p_name_prf_1#4676, rid#4667 AS rid_1#4677, p_type_prf#4668 AS p_type_prf_1#4678, p_retailprice_prf#4669 AS p_retailprice_prf_1#4679, p_mfgr_prf#4670 AS p_mfgr_prf_1#4680, p_container_prf#4671 AS p_container_prf_1#4681, p_brand_prf#4672 AS p_brand_prf_1#4682, p_size_prf#4673 AS p_size_prf_1#4683, p_partkey_prf#4674 AS p_partkey_prf_1#4684]
         :     :     +- Relation[p_comment_prf#4665,p_name_prf#4666,rid#4667,p_type_prf#4668,p_retailprice_prf#4669,p_mfgr_prf#4670,p_container_prf#4671,p_brand_prf#4672,p_size_prf#4673,p_partkey_prf#4674] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4686 AS s_phone_prf_2#4694, rid#4687 AS rid_2#4695, s_address_prf#4688 AS s_address_prf_2#4696, s_nationkey_prf#4689 AS s_nationkey_prf_2#4697, s_suppkey_prf#4690 AS s_suppkey_prf_2#4698, s_name_prf#4691 AS s_name_prf_2#4699, s_acctbal_prf#4692 AS s_acctbal_prf_2#4700, s_comment_prf#4693 AS s_comment_prf_2#4701]
            +- Relation[s_phone_prf#4686,rid#4687,s_address_prf#4688,s_nationkey_prf#4689,s_suppkey_prf#4690,s_name_prf#4691,s_acctbal_prf#4692,s_comment_prf#4693] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 109743ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/11 01:36:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:36:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4741L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 01:36:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4741L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#4753]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#4748: string
         :     :- Project [rid#4743 AS rid_0#4748, n_regionkey_prf#4744 AS n_regionkey_prf_0#4749, n_nationkey_prf#4745 AS n_nationkey_prf_0#4750, n_name_prf#4746 AS n_name_prf_0#4751, n_comment_prf#4747 AS n_comment_prf_0#4752]
         :     :  +- Relation[rid#4743,n_regionkey_prf#4744,n_nationkey_prf#4745,n_name_prf#4746,n_comment_prf#4747] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4754 AS s_phone_prf_1#4762, rid#4755 AS rid_1#4763, s_address_prf#4756 AS s_address_prf_1#4764, s_nationkey_prf#4757 AS s_nationkey_prf_1#4765, s_suppkey_prf#4758 AS s_suppkey_prf_1#4766, s_name_prf#4759 AS s_name_prf_1#4767, s_acctbal_prf#4760 AS s_acctbal_prf_1#4768, s_comment_prf#4761 AS s_comment_prf_1#4769]
            +- Relation[s_phone_prf#4754,rid#4755,s_address_prf#4756,s_nationkey_prf#4757,s_suppkey_prf#4758,s_name_prf#4759,s_acctbal_prf#4760,s_comment_prf#4761] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=10000
Elapsed time: 188ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/11 01:36:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:36:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4818L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 01:36:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4818L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#4858]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#4843: string
         :     :  :     :- Project [l_returnflag_prf#4820 AS l_returnflag_prf_0#4839, l_orderkey_and_l_linenumber_prf#4821 AS l_orderkey_and_l_linenumber_prf_0#4840, l_comment_prf#4822 AS l_comment_prf_0#4841, l_linestatus_prf#4823 AS l_linestatus_prf_0#4842, rid#4824 AS rid_0#4843, l_shipmode_prf#4825 AS l_shipmode_prf_0#4844, l_shipinstruct_prf#4826 AS l_shipinstruct_prf_0#4845, l_quantity_prf#4827 AS l_quantity_prf_0#4846, l_receiptdate_prf#4828 AS l_receiptdate_prf_0#4847, l_linenumber_prf#4829 AS l_linenumber_prf_0#4848, l_tax_prf#4830 AS l_tax_prf_0#4849, l_shipdate_prf#4831 AS l_shipdate_prf_0#4850, l_extendedprice_prf#4832 AS l_extendedprice_prf_0#4851, l_partkey_prf#4833 AS l_partkey_prf_0#4852, l_discount_prf#4834 AS l_discount_prf_0#4853, l_partkey_and_l_suppkey_prf#4835 AS l_partkey_and_l_suppkey_prf_0#4854, l_commitdate_prf#4836 AS l_commitdate_prf_0#4855, l_suppkey_prf#4837 AS l_suppkey_prf_0#4856, l_orderkey_prf#4838 AS l_orderkey_prf_0#4857]
         :     :  :     :  +- Relation[l_returnflag_prf#4820,l_orderkey_and_l_linenumber_prf#4821,l_comment_prf#4822,l_linestatus_prf#4823,rid#4824,l_shipmode_prf#4825,l_shipinstruct_prf#4826,l_quantity_prf#4827,l_receiptdate_prf#4828,l_linenumber_prf#4829,l_tax_prf#4830,l_shipdate_prf#4831,l_extendedprice_prf#4832,l_partkey_prf#4833,l_discount_prf#4834,l_partkey_and_l_suppkey_prf#4835,l_commitdate_prf#4836,l_suppkey_prf#4837,l_orderkey_prf#4838] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#4859 AS p_comment_prf_1#4869, p_name_prf#4860 AS p_name_prf_1#4870, rid#4861 AS rid_1#4871, p_type_prf#4862 AS p_type_prf_1#4872, p_retailprice_prf#4863 AS p_retailprice_prf_1#4873, p_mfgr_prf#4864 AS p_mfgr_prf_1#4874, p_container_prf#4865 AS p_container_prf_1#4875, p_brand_prf#4866 AS p_brand_prf_1#4876, p_size_prf#4867 AS p_size_prf_1#4877, p_partkey_prf#4868 AS p_partkey_prf_1#4878]
         :     :     +- Relation[p_comment_prf#4859,p_name_prf#4860,rid#4861,p_type_prf#4862,p_retailprice_prf#4863,p_mfgr_prf#4864,p_container_prf#4865,p_brand_prf#4866,p_size_prf#4867,p_partkey_prf#4868] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4880 AS s_phone_prf_2#4888, rid#4881 AS rid_2#4889, s_address_prf#4882 AS s_address_prf_2#4890, s_nationkey_prf#4883 AS s_nationkey_prf_2#4891, s_suppkey_prf#4884 AS s_suppkey_prf_2#4892, s_name_prf#4885 AS s_name_prf_2#4893, s_acctbal_prf#4886 AS s_acctbal_prf_2#4894, s_comment_prf#4887 AS s_comment_prf_2#4895]
            +- Relation[s_phone_prf#4880,rid#4881,s_address_prf#4882,s_nationkey_prf#4883,s_suppkey_prf#4884,s_name_prf#4885,s_acctbal_prf#4886,s_comment_prf#4887] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 292795ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/11 01:41:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:41:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4969L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 01:41:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4969L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1583) AS rid_2#5010]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#4989]
         :     :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4981: string
         :     :  :     :- Project [c_acctbal_prf#4971 AS c_acctbal_prf_0#4980, rid#4972 AS rid_0#4981, c_name_prf#4973 AS c_name_prf_0#4982, c_nationkey_prf#4974 AS c_nationkey_prf_0#4983, c_custkey_prf#4975 AS c_custkey_prf_0#4984, c_comment_prf#4976 AS c_comment_prf_0#4985, c_address_prf#4977 AS c_address_prf_0#4986, c_mktsegment_prf#4978 AS c_mktsegment_prf_0#4987, c_phone_prf#4979 AS c_phone_prf_0#4988]
         :     :  :     :  +- Relation[c_acctbal_prf#4971,rid#4972,c_name_prf#4973,c_nationkey_prf#4974,c_custkey_prf#4975,c_comment_prf#4976,c_address_prf#4977,c_mktsegment_prf#4978,c_phone_prf#4979] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#4990 AS o_shippriority_prf_1#5000, rid#4991 AS rid_1#5001, o_orderdate_prf#4992 AS o_orderdate_prf_1#5002, o_custkey_prf#4993 AS o_custkey_prf_1#5003, o_orderpriority_prf#4994 AS o_orderpriority_prf_1#5004, o_clerk_prf#4995 AS o_clerk_prf_1#5005, o_orderstatus_prf#4996 AS o_orderstatus_prf_1#5006, o_totalprice_prf#4997 AS o_totalprice_prf_1#5007, o_orderkey_prf#4998 AS o_orderkey_prf_1#5008, o_comment_prf#4999 AS o_comment_prf_1#5009]
         :     :     +- Relation[o_shippriority_prf#4990,rid#4991,o_orderdate_prf#4992,o_custkey_prf#4993,o_orderpriority_prf#4994,o_clerk_prf#4995,o_orderstatus_prf#4996,o_totalprice_prf#4997,o_orderkey_prf#4998,o_comment_prf#4999] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5011 AS l_returnflag_prf_2#5030, l_orderkey_and_l_linenumber_prf#5012 AS l_orderkey_and_l_linenumber_prf_2#5031, l_comment_prf#5013 AS l_comment_prf_2#5032, l_linestatus_prf#5014 AS l_linestatus_prf_2#5033, rid#5015 AS rid_2#5034, l_shipmode_prf#5016 AS l_shipmode_prf_2#5035, l_shipinstruct_prf#5017 AS l_shipinstruct_prf_2#5036, l_quantity_prf#5018 AS l_quantity_prf_2#5037, l_receiptdate_prf#5019 AS l_receiptdate_prf_2#5038, l_linenumber_prf#5020 AS l_linenumber_prf_2#5039, l_tax_prf#5021 AS l_tax_prf_2#5040, l_shipdate_prf#5022 AS l_shipdate_prf_2#5041, l_extendedprice_prf#5023 AS l_extendedprice_prf_2#5042, l_partkey_prf#5024 AS l_partkey_prf_2#5043, l_discount_prf#5025 AS l_discount_prf_2#5044, l_partkey_and_l_suppkey_prf#5026 AS l_partkey_and_l_suppkey_prf_2#5045, l_commitdate_prf#5027 AS l_commitdate_prf_2#5046, l_suppkey_prf#5028 AS l_suppkey_prf_2#5047, l_orderkey_prf#5029 AS l_orderkey_prf_2#5048]
            +- Relation[l_returnflag_prf#5011,l_orderkey_and_l_linenumber_prf#5012,l_comment_prf#5013,l_linestatus_prf#5014,rid#5015,l_shipmode_prf#5016,l_shipinstruct_prf#5017,l_quantity_prf#5018,l_receiptdate_prf#5019,l_linenumber_prf#5020,l_tax_prf#5021,l_shipdate_prf#5022,l_extendedprice_prf#5023,l_partkey_prf#5024,l_discount_prf#5025,l_partkey_and_l_suppkey_prf#5026,l_commitdate_prf#5027,l_suppkey_prf#5028,l_orderkey_prf#5029] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 186489ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/11 01:44:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:44:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5109L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 01:44:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5109L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_2#5129]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#5121: string
         :     :- Project [c_acctbal_prf#5111 AS c_acctbal_prf_0#5120, rid#5112 AS rid_0#5121, c_name_prf#5113 AS c_name_prf_0#5122, c_nationkey_prf#5114 AS c_nationkey_prf_0#5123, c_custkey_prf#5115 AS c_custkey_prf_0#5124, c_comment_prf#5116 AS c_comment_prf_0#5125, c_address_prf#5117 AS c_address_prf_0#5126, c_mktsegment_prf#5118 AS c_mktsegment_prf_0#5127, c_phone_prf#5119 AS c_phone_prf_0#5128]
         :     :  +- Relation[c_acctbal_prf#5111,rid#5112,c_name_prf#5113,c_nationkey_prf#5114,c_custkey_prf#5115,c_comment_prf#5116,c_address_prf#5117,c_mktsegment_prf#5118,c_phone_prf#5119] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1583) AS rid_2#5146]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#5139: string
            :     :- Project [s_phone_prf#5130 AS s_phone_prf_1#5138, rid#5131 AS rid_1#5139, s_address_prf#5132 AS s_address_prf_1#5140, s_nationkey_prf#5133 AS s_nationkey_prf_1#5141, s_suppkey_prf#5134 AS s_suppkey_prf_1#5142, s_name_prf#5135 AS s_name_prf_1#5143, s_acctbal_prf#5136 AS s_acctbal_prf_1#5144, s_comment_prf#5137 AS s_comment_prf_1#5145]
            :     :  +- Relation[s_phone_prf#5130,rid#5131,s_address_prf#5132,s_nationkey_prf#5133,s_suppkey_prf#5134,s_name_prf#5135,s_acctbal_prf#5136,s_comment_prf#5137] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [rid#5147 AS rid_2#5152, n_regionkey_prf#5148 AS n_regionkey_prf_2#5153, n_nationkey_prf#5149 AS n_nationkey_prf_2#5154, n_name_prf#5150 AS n_name_prf_2#5155, n_comment_prf#5151 AS n_comment_prf_2#5156]
               +- Relation[rid#5147,n_regionkey_prf#5148,n_nationkey_prf#5149,n_name_prf#5150,n_comment_prf#5151] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 42481ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/11 01:45:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:45:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5189L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 01:45:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5189L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#5199]
         :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#5198: string
         :     :- Project [r_regionkey_prf#5191 AS r_regionkey_prf_0#5195, r_name_prf#5192 AS r_name_prf_0#5196, r_comment_prf#5193 AS r_comment_prf_0#5197, rid#5194 AS rid_0#5198]
         :     :  +- Relation[r_regionkey_prf#5191,r_name_prf#5192,r_comment_prf#5193,rid#5194] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#5200 AS rid_1#5205, n_regionkey_prf#5201 AS n_regionkey_prf_1#5206, n_nationkey_prf#5202 AS n_nationkey_prf_1#5207, n_name_prf#5203 AS n_name_prf_1#5208, n_comment_prf#5204 AS n_comment_prf_1#5209]
            +- Relation[rid#5200,n_regionkey_prf#5201,n_nationkey_prf#5202,n_name_prf#5203,n_comment_prf#5204] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=25
Elapsed time: 65ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/11 01:45:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:45:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5247L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 01:45:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5247L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#5287]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#5272: string
         :     :- Project [l_returnflag_prf#5249 AS l_returnflag_prf_0#5268, l_orderkey_and_l_linenumber_prf#5250 AS l_orderkey_and_l_linenumber_prf_0#5269, l_comment_prf#5251 AS l_comment_prf_0#5270, l_linestatus_prf#5252 AS l_linestatus_prf_0#5271, rid#5253 AS rid_0#5272, l_shipmode_prf#5254 AS l_shipmode_prf_0#5273, l_shipinstruct_prf#5255 AS l_shipinstruct_prf_0#5274, l_quantity_prf#5256 AS l_quantity_prf_0#5275, l_receiptdate_prf#5257 AS l_receiptdate_prf_0#5276, l_linenumber_prf#5258 AS l_linenumber_prf_0#5277, l_tax_prf#5259 AS l_tax_prf_0#5278, l_shipdate_prf#5260 AS l_shipdate_prf_0#5279, l_extendedprice_prf#5261 AS l_extendedprice_prf_0#5280, l_partkey_prf#5262 AS l_partkey_prf_0#5281, l_discount_prf#5263 AS l_discount_prf_0#5282, l_partkey_and_l_suppkey_prf#5264 AS l_partkey_and_l_suppkey_prf_0#5283, l_commitdate_prf#5265 AS l_commitdate_prf_0#5284, l_suppkey_prf#5266 AS l_suppkey_prf_0#5285, l_orderkey_prf#5267 AS l_orderkey_prf_0#5286]
         :     :  +- Relation[l_returnflag_prf#5249,l_orderkey_and_l_linenumber_prf#5250,l_comment_prf#5251,l_linestatus_prf#5252,rid#5253,l_shipmode_prf#5254,l_shipinstruct_prf#5255,l_quantity_prf#5256,l_receiptdate_prf#5257,l_linenumber_prf#5258,l_tax_prf#5259,l_shipdate_prf#5260,l_extendedprice_prf#5261,l_partkey_prf#5262,l_discount_prf#5263,l_partkey_and_l_suppkey_prf#5264,l_commitdate_prf#5265,l_suppkey_prf#5266,l_orderkey_prf#5267] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#5288 AS o_shippriority_prf_1#5298, rid#5289 AS rid_1#5299, o_orderdate_prf#5290 AS o_orderdate_prf_1#5300, o_custkey_prf#5291 AS o_custkey_prf_1#5301, o_orderpriority_prf#5292 AS o_orderpriority_prf_1#5302, o_clerk_prf#5293 AS o_clerk_prf_1#5303, o_orderstatus_prf#5294 AS o_orderstatus_prf_1#5304, o_totalprice_prf#5295 AS o_totalprice_prf_1#5305, o_orderkey_prf#5296 AS o_orderkey_prf_1#5306, o_comment_prf#5297 AS o_comment_prf_1#5307]
            +- Relation[o_shippriority_prf#5288,rid#5289,o_orderdate_prf#5290,o_custkey_prf#5291,o_orderpriority_prf#5292,o_clerk_prf#5293,o_orderstatus_prf#5294,o_totalprice_prf#5295,o_orderkey_prf#5296,o_comment_prf#5297] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 132337ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/11 01:47:28 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:47:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5357L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 01:47:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5357L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1583) AS rid_1#5377]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#5369: string
         :     :- Project [c_acctbal_prf#5359 AS c_acctbal_prf_0#5368, rid#5360 AS rid_0#5369, c_name_prf#5361 AS c_name_prf_0#5370, c_nationkey_prf#5362 AS c_nationkey_prf_0#5371, c_custkey_prf#5363 AS c_custkey_prf_0#5372, c_comment_prf#5364 AS c_comment_prf_0#5373, c_address_prf#5365 AS c_address_prf_0#5374, c_mktsegment_prf#5366 AS c_mktsegment_prf_0#5375, c_phone_prf#5367 AS c_phone_prf_0#5376]
         :     :  +- Relation[c_acctbal_prf#5359,rid#5360,c_name_prf#5361,c_nationkey_prf#5362,c_custkey_prf#5363,c_comment_prf#5364,c_address_prf#5365,c_mktsegment_prf#5366,c_phone_prf#5367] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1582,value#1583] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#5378 AS o_shippriority_prf_1#5388, rid#5379 AS rid_1#5389, o_orderdate_prf#5380 AS o_orderdate_prf_1#5390, o_custkey_prf#5381 AS o_custkey_prf_1#5391, o_orderpriority_prf#5382 AS o_orderpriority_prf_1#5392, o_clerk_prf#5383 AS o_clerk_prf_1#5393, o_orderstatus_prf#5384 AS o_orderstatus_prf_1#5394, o_totalprice_prf#5385 AS o_totalprice_prf_1#5395, o_orderkey_prf#5386 AS o_orderkey_prf_1#5396, o_comment_prf#5387 AS o_comment_prf_1#5397]
            +- Relation[o_shippriority_prf#5378,rid#5379,o_orderdate_prf#5380,o_custkey_prf#5381,o_orderpriority_prf#5382,o_clerk_prf#5383,o_orderstatus_prf#5384,o_totalprice_prf#5385,o_orderkey_prf#5386,o_comment_prf#5387] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1500000
Elapsed time: 40836ms
query=b1a, count=15628, duration=381
query=b1b, count=15628, duration=50462
query=b2a, count=1478870, duration=201225
query=b2b, count=1478870, duration=57284
query=f1, count=1, duration=52
query=f2, count=3907, duration=126
query=f3, count=1451, duration=84
query=f4, count=1, duration=61
query=f5, count=1478870, duration=23786
query=f6, count=857401, duration=14114
query=j1, count=800000, duration=32102
query=j10, count=6001215, duration=88401
query=j2, count=800000, duration=11240
query=j3, count=25, duration=65
query=j4, count=150000, duration=1946
query=j5, count=10000, duration=188
query=j6, count=6001215, duration=117416
query=j7, count=1500000, duration=40836
query=j8, count=6001215, duration=200585
query=j8b, count=6001215, duration=132337
query=j9, count=6001215, duration=95742
query=j9b, count=6001215, duration=129435
query=r1a, count=6001215, duration=343759
query=r1b, count=6001215, duration=167657
query=r1c, count=6001215, duration=175990
query=r1d, count=6001215, duration=186489
query=r1e, count=6001215, duration=241331
query=r1f, count=6001215, duration=175486
query=t1a, count=60000414, duration=679611
query=t1b, count=60000414, duration=774250
query=t1c, count=60000414, duration=42481
query=t2a, count=800000, duration=109743
query=t2b, count=800000, duration=94357
query=t2c, count=800000, duration=43543
query=t2d, count=800000, duration=62444
query=t3a, count=6001215, duration=292795
query=t3b, count=6001215, duration=312826
query=t3c, count=6001215, duration=189154
query=t3d, count=6001215, duration=199170
