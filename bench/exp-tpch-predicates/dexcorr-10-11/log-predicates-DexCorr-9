19/10/11 09:12:19 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7172ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Fri Oct 11 09:12:21 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Fri Oct 11 09:12:22 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Fri Oct 11 09:12:22 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Fri Oct 11 09:12:22 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Fri Oct 11 09:12:23 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Fri Oct 11 09:12:25 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Fri Oct 11 09:12:27 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Fri Oct 11 09:12:27 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/11 09:12:29 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:12:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1496L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 09:12:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1496L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#1520]
         :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#1510: string
         :     :- Project [p_comment_prf#1498 AS p_comment_prf_0#1508, p_name_prf#1499 AS p_name_prf_0#1509, rid#1500 AS rid_0#1510, p_type_prf#1501 AS p_type_prf_0#1511, p_retailprice_prf#1502 AS p_retailprice_prf_0#1512, p_mfgr_prf#1503 AS p_mfgr_prf_0#1513, p_container_prf#1504 AS p_container_prf_0#1514, p_brand_prf#1505 AS p_brand_prf_0#1515, p_size_prf#1506 AS p_size_prf_0#1516, p_partkey_prf#1507 AS p_partkey_prf_0#1517]
         :     :  +- Relation[p_comment_prf#1498,p_name_prf#1499,rid#1500,p_type_prf#1501,p_retailprice_prf#1502,p_mfgr_prf#1503,p_container_prf#1504,p_brand_prf#1505,p_size_prf#1506,p_partkey_prf#1507] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1521 AS l_returnflag_prf_1#1540, l_orderkey_and_l_linenumber_prf#1522 AS l_orderkey_and_l_linenumber_prf_1#1541, l_comment_prf#1523 AS l_comment_prf_1#1542, l_linestatus_prf#1524 AS l_linestatus_prf_1#1543, rid#1525 AS rid_1#1544, l_shipmode_prf#1526 AS l_shipmode_prf_1#1545, l_shipinstruct_prf#1527 AS l_shipinstruct_prf_1#1546, l_quantity_prf#1528 AS l_quantity_prf_1#1547, l_receiptdate_prf#1529 AS l_receiptdate_prf_1#1548, l_linenumber_prf#1530 AS l_linenumber_prf_1#1549, l_tax_prf#1531 AS l_tax_prf_1#1550, l_shipdate_prf#1532 AS l_shipdate_prf_1#1551, l_extendedprice_prf#1533 AS l_extendedprice_prf_1#1552, l_partkey_prf#1534 AS l_partkey_prf_1#1553, l_discount_prf#1535 AS l_discount_prf_1#1554, l_partkey_and_l_suppkey_prf#1536 AS l_partkey_and_l_suppkey_prf_1#1555, l_commitdate_prf#1537 AS l_commitdate_prf_1#1556, l_suppkey_prf#1538 AS l_suppkey_prf_1#1557, l_orderkey_prf#1539 AS l_orderkey_prf_1#1558]
            +- Relation[l_returnflag_prf#1521,l_orderkey_and_l_linenumber_prf#1522,l_comment_prf#1523,l_linestatus_prf#1524,rid#1525,l_shipmode_prf#1526,l_shipinstruct_prf#1527,l_quantity_prf#1528,l_receiptdate_prf#1529,l_linenumber_prf#1530,l_tax_prf#1531,l_shipdate_prf#1532,l_extendedprice_prf#1533,l_partkey_prf#1534,l_discount_prf#1535,l_partkey_and_l_suppkey_prf#1536,l_commitdate_prf#1537,l_suppkey_prf#1538,l_orderkey_prf#1539] JDBCRelation(lineitem_prf) [numPartitions=1]

19/10/11 09:12:29 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=6001215
Elapsed time: 96109ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/11 09:14:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:14:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1605L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 09:14:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1605L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#1630]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#1619: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#1607 AS p_comment_prf_0#1617, p_name_prf#1608 AS p_name_prf_0#1618, rid#1609 AS rid_0#1619, p_type_prf#1610 AS p_type_prf_0#1620, p_retailprice_prf#1611 AS p_retailprice_prf_0#1621, p_mfgr_prf#1612 AS p_mfgr_prf_0#1622, p_container_prf#1613 AS p_container_prf_0#1623, p_brand_prf#1614 AS p_brand_prf_0#1624, p_size_prf#1615 AS p_size_prf_0#1625, p_partkey_prf#1616 AS p_partkey_prf_0#1626]
         :     :  :  +- Relation[p_comment_prf#1607,p_name_prf#1608,rid#1609,p_type_prf#1610,p_retailprice_prf#1611,p_mfgr_prf#1612,p_container_prf#1613,p_brand_prf#1614,p_size_prf#1615,p_partkey_prf#1616] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1629]
         :     :     +- DexRidFilter part~p_size~15
         :     :        +- Relation[label#1627,value#1628] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#1631 AS ps_partkey_and_ps_suppkey_prf_1#1638, rid#1632 AS rid_1#1639, ps_availqty_prf#1633 AS ps_availqty_prf_1#1640, ps_comment_prf#1634 AS ps_comment_prf_1#1641, ps_partkey_prf#1635 AS ps_partkey_prf_1#1642, ps_supplycost_prf#1636 AS ps_supplycost_prf_1#1643, ps_suppkey_prf#1637 AS ps_suppkey_prf_1#1644]
            +- Relation[ps_partkey_and_ps_suppkey_prf#1631,rid#1632,ps_availqty_prf#1633,ps_comment_prf#1634,ps_partkey_prf#1635,ps_supplycost_prf#1636,ps_suppkey_prf#1637] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 443ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/11 09:14:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:14:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1676L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 09:14:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1676L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#1688]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#1683: string
         :     :- Project [rid#1678 AS rid_0#1683, n_regionkey_prf#1679 AS n_regionkey_prf_0#1684, n_nationkey_prf#1680 AS n_nationkey_prf_0#1685, n_name_prf#1681 AS n_name_prf_0#1686, n_comment_prf#1682 AS n_comment_prf_0#1687]
         :     :  +- Relation[rid#1678,n_regionkey_prf#1679,n_nationkey_prf#1680,n_name_prf#1681,n_comment_prf#1682] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#1689 AS s_phone_prf_1#1697, rid#1690 AS rid_1#1698, s_address_prf#1691 AS s_address_prf_1#1699, s_nationkey_prf#1692 AS s_nationkey_prf_1#1700, s_suppkey_prf#1693 AS s_suppkey_prf_1#1701, s_name_prf#1694 AS s_name_prf_1#1702, s_acctbal_prf#1695 AS s_acctbal_prf_1#1703, s_comment_prf#1696 AS s_comment_prf_1#1704]
            +- Relation[s_phone_prf#1689,rid#1690,s_address_prf#1691,s_nationkey_prf#1692,s_suppkey_prf#1693,s_name_prf#1694,s_acctbal_prf#1695,s_comment_prf#1696] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=10000
Elapsed time: 195ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/11 09:14:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:14:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1733L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 09:14:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1733L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#1745]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#1740: string
         :     :- Project [rid#1735 AS rid_0#1740, n_regionkey_prf#1736 AS n_regionkey_prf_0#1741, n_nationkey_prf#1737 AS n_nationkey_prf_0#1742, n_name_prf#1738 AS n_name_prf_0#1743, n_comment_prf#1739 AS n_comment_prf_0#1744]
         :     :  +- Relation[rid#1735,n_regionkey_prf#1736,n_nationkey_prf#1737,n_name_prf#1738,n_comment_prf#1739] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#1746 AS c_acctbal_prf_1#1755, rid#1747 AS rid_1#1756, c_name_prf#1748 AS c_name_prf_1#1757, c_nationkey_prf#1749 AS c_nationkey_prf_1#1758, c_custkey_prf#1750 AS c_custkey_prf_1#1759, c_comment_prf#1751 AS c_comment_prf_1#1760, c_address_prf#1752 AS c_address_prf_1#1761, c_mktsegment_prf#1753 AS c_mktsegment_prf_1#1762, c_phone_prf#1754 AS c_phone_prf_1#1763]
            +- Relation[c_acctbal_prf#1746,rid#1747,c_name_prf#1748,c_nationkey_prf#1749,c_custkey_prf#1750,c_comment_prf#1751,c_address_prf#1752,c_mktsegment_prf#1753,c_phone_prf#1754] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=150000
Elapsed time: 1952ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/11 09:14:07 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:14:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1814L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 09:14:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1814L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#1854]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#1839: string
         :     :  :     :- Project [l_returnflag_prf#1816 AS l_returnflag_prf_0#1835, l_orderkey_and_l_linenumber_prf#1817 AS l_orderkey_and_l_linenumber_prf_0#1836, l_comment_prf#1818 AS l_comment_prf_0#1837, l_linestatus_prf#1819 AS l_linestatus_prf_0#1838, rid#1820 AS rid_0#1839, l_shipmode_prf#1821 AS l_shipmode_prf_0#1840, l_shipinstruct_prf#1822 AS l_shipinstruct_prf_0#1841, l_quantity_prf#1823 AS l_quantity_prf_0#1842, l_receiptdate_prf#1824 AS l_receiptdate_prf_0#1843, l_linenumber_prf#1825 AS l_linenumber_prf_0#1844, l_tax_prf#1826 AS l_tax_prf_0#1845, l_shipdate_prf#1827 AS l_shipdate_prf_0#1846, l_extendedprice_prf#1828 AS l_extendedprice_prf_0#1847, l_partkey_prf#1829 AS l_partkey_prf_0#1848, l_discount_prf#1830 AS l_discount_prf_0#1849, l_partkey_and_l_suppkey_prf#1831 AS l_partkey_and_l_suppkey_prf_0#1850, l_commitdate_prf#1832 AS l_commitdate_prf_0#1851, l_suppkey_prf#1833 AS l_suppkey_prf_0#1852, l_orderkey_prf#1834 AS l_orderkey_prf_0#1853]
         :     :  :     :  +- Relation[l_returnflag_prf#1816,l_orderkey_and_l_linenumber_prf#1817,l_comment_prf#1818,l_linestatus_prf#1819,rid#1820,l_shipmode_prf#1821,l_shipinstruct_prf#1822,l_quantity_prf#1823,l_receiptdate_prf#1824,l_linenumber_prf#1825,l_tax_prf#1826,l_shipdate_prf#1827,l_extendedprice_prf#1828,l_partkey_prf#1829,l_discount_prf#1830,l_partkey_and_l_suppkey_prf#1831,l_commitdate_prf#1832,l_suppkey_prf#1833,l_orderkey_prf#1834] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#1855 AS o_shippriority_prf_1#1865, rid#1856 AS rid_1#1866, o_orderdate_prf#1857 AS o_orderdate_prf_1#1867, o_custkey_prf#1858 AS o_custkey_prf_1#1868, o_orderpriority_prf#1859 AS o_orderpriority_prf_1#1869, o_clerk_prf#1860 AS o_clerk_prf_1#1870, o_orderstatus_prf#1861 AS o_orderstatus_prf_1#1871, o_totalprice_prf#1862 AS o_totalprice_prf_1#1872, o_orderkey_prf#1863 AS o_orderkey_prf_1#1873, o_comment_prf#1864 AS o_comment_prf_1#1874]
         :     :     +- Relation[o_shippriority_prf#1855,rid#1856,o_orderdate_prf#1857,o_custkey_prf#1858,o_orderpriority_prf#1859,o_clerk_prf#1860,o_orderstatus_prf#1861,o_totalprice_prf#1862,o_orderkey_prf#1863,o_comment_prf#1864] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#1876 AS c_acctbal_prf_2#1885, rid#1877 AS rid_2#1886, c_name_prf#1878 AS c_name_prf_2#1887, c_nationkey_prf#1879 AS c_nationkey_prf_2#1888, c_custkey_prf#1880 AS c_custkey_prf_2#1889, c_comment_prf#1881 AS c_comment_prf_2#1890, c_address_prf#1882 AS c_address_prf_2#1891, c_mktsegment_prf#1883 AS c_mktsegment_prf_2#1892, c_phone_prf#1884 AS c_phone_prf_2#1893]
            +- Relation[c_acctbal_prf#1876,rid#1877,c_name_prf#1878,c_nationkey_prf#1879,c_custkey_prf#1880,c_comment_prf#1881,c_address_prf#1882,c_mktsegment_prf#1883,c_phone_prf#1884] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 343868ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/11 09:19:51 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:19:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1960L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 09:19:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1960L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#2000]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#1985: string
         :     :- Project [l_returnflag_prf#1962 AS l_returnflag_prf_0#1981, l_orderkey_and_l_linenumber_prf#1963 AS l_orderkey_and_l_linenumber_prf_0#1982, l_comment_prf#1964 AS l_comment_prf_0#1983, l_linestatus_prf#1965 AS l_linestatus_prf_0#1984, rid#1966 AS rid_0#1985, l_shipmode_prf#1967 AS l_shipmode_prf_0#1986, l_shipinstruct_prf#1968 AS l_shipinstruct_prf_0#1987, l_quantity_prf#1969 AS l_quantity_prf_0#1988, l_receiptdate_prf#1970 AS l_receiptdate_prf_0#1989, l_linenumber_prf#1971 AS l_linenumber_prf_0#1990, l_tax_prf#1972 AS l_tax_prf_0#1991, l_shipdate_prf#1973 AS l_shipdate_prf_0#1992, l_extendedprice_prf#1974 AS l_extendedprice_prf_0#1993, l_partkey_prf#1975 AS l_partkey_prf_0#1994, l_discount_prf#1976 AS l_discount_prf_0#1995, l_partkey_and_l_suppkey_prf#1977 AS l_partkey_and_l_suppkey_prf_0#1996, l_commitdate_prf#1978 AS l_commitdate_prf_0#1997, l_suppkey_prf#1979 AS l_suppkey_prf_0#1998, l_orderkey_prf#1980 AS l_orderkey_prf_0#1999]
         :     :  +- Relation[l_returnflag_prf#1962,l_orderkey_and_l_linenumber_prf#1963,l_comment_prf#1964,l_linestatus_prf#1965,rid#1966,l_shipmode_prf#1967,l_shipinstruct_prf#1968,l_quantity_prf#1969,l_receiptdate_prf#1970,l_linenumber_prf#1971,l_tax_prf#1972,l_shipdate_prf#1973,l_extendedprice_prf#1974,l_partkey_prf#1975,l_discount_prf#1976,l_partkey_and_l_suppkey_prf#1977,l_commitdate_prf#1978,l_suppkey_prf#1979,l_orderkey_prf#1980] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2001 AS o_shippriority_prf_1#2011, rid#2002 AS rid_1#2012, o_orderdate_prf#2003 AS o_orderdate_prf_1#2013, o_custkey_prf#2004 AS o_custkey_prf_1#2014, o_orderpriority_prf#2005 AS o_orderpriority_prf_1#2015, o_clerk_prf#2006 AS o_clerk_prf_1#2016, o_orderstatus_prf#2007 AS o_orderstatus_prf_1#2017, o_totalprice_prf#2008 AS o_totalprice_prf_1#2018, o_orderkey_prf#2009 AS o_orderkey_prf_1#2019, o_comment_prf#2010 AS o_comment_prf_1#2020]
            +- Relation[o_shippriority_prf#2001,rid#2002,o_orderdate_prf#2003,o_custkey_prf#2004,o_orderpriority_prf#2005,o_clerk_prf#2006,o_orderstatus_prf#2007,o_totalprice_prf#2008,o_orderkey_prf#2009,o_comment_prf#2010] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 131337ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/11 09:22:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:22:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2065L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 09:22:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2065L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#2083]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#2076: string
         :     :- Project [s_phone_prf#2067 AS s_phone_prf_0#2075, rid#2068 AS rid_0#2076, s_address_prf#2069 AS s_address_prf_0#2077, s_nationkey_prf#2070 AS s_nationkey_prf_0#2078, s_suppkey_prf#2071 AS s_suppkey_prf_0#2079, s_name_prf#2072 AS s_name_prf_0#2080, s_acctbal_prf#2073 AS s_acctbal_prf_0#2081, s_comment_prf#2074 AS s_comment_prf_0#2082]
         :     :  +- Relation[s_phone_prf#2067,rid#2068,s_address_prf#2069,s_nationkey_prf#2070,s_suppkey_prf#2071,s_name_prf#2072,s_acctbal_prf#2073,s_comment_prf#2074] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2084 AS ps_partkey_and_ps_suppkey_prf_1#2091, rid#2085 AS rid_1#2092, ps_availqty_prf#2086 AS ps_availqty_prf_1#2093, ps_comment_prf#2087 AS ps_comment_prf_1#2094, ps_partkey_prf#2088 AS ps_partkey_prf_1#2095, ps_supplycost_prf#2089 AS ps_supplycost_prf_1#2096, ps_suppkey_prf#2090 AS ps_suppkey_prf_1#2097]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2084,rid#2085,ps_availqty_prf#2086,ps_comment_prf#2087,ps_partkey_prf#2088,ps_supplycost_prf#2089,ps_suppkey_prf#2090] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 11320ms

f1=
select * from region where r_name = 'EUROPE'
19/10/11 09:22:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:22:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2119L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/11 09:22:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2119L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#2121 AS r_regionkey_prf_0#2125, r_name_prf#2122 AS r_name_prf_0#2126, r_comment_prf#2123 AS r_comment_prf_0#2127, rid#2124 AS rid_0#2128]
         :  +- Relation[r_regionkey_prf#2121,r_name_prf#2122,r_comment_prf#2123,rid#2124] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2129]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1627,value#1628] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 51ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/11 09:22:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:22:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2170L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 09:22:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2170L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#2190]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2182: string
         :     :- Project [c_acctbal_prf#2172 AS c_acctbal_prf_0#2181, rid#2173 AS rid_0#2182, c_name_prf#2174 AS c_name_prf_0#2183, c_nationkey_prf#2175 AS c_nationkey_prf_0#2184, c_custkey_prf#2176 AS c_custkey_prf_0#2185, c_comment_prf#2177 AS c_comment_prf_0#2186, c_address_prf#2178 AS c_address_prf_0#2187, c_mktsegment_prf#2179 AS c_mktsegment_prf_0#2188, c_phone_prf#2180 AS c_phone_prf_0#2189]
         :     :  +- Relation[c_acctbal_prf#2172,rid#2173,c_name_prf#2174,c_nationkey_prf#2175,c_custkey_prf#2176,c_comment_prf#2177,c_address_prf#2178,c_mktsegment_prf#2179,c_phone_prf#2180] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1519) AS rid_2#2211]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#2202: string
            :     :- Project [o_shippriority_prf#2191 AS o_shippriority_prf_1#2201, rid#2192 AS rid_1#2202, o_orderdate_prf#2193 AS o_orderdate_prf_1#2203, o_custkey_prf#2194 AS o_custkey_prf_1#2204, o_orderpriority_prf#2195 AS o_orderpriority_prf_1#2205, o_clerk_prf#2196 AS o_clerk_prf_1#2206, o_orderstatus_prf#2197 AS o_orderstatus_prf_1#2207, o_totalprice_prf#2198 AS o_totalprice_prf_1#2208, o_orderkey_prf#2199 AS o_orderkey_prf_1#2209, o_comment_prf#2200 AS o_comment_prf_1#2210]
            :     :  +- Relation[o_shippriority_prf#2191,rid#2192,o_orderdate_prf#2193,o_custkey_prf#2194,o_orderpriority_prf#2195,o_clerk_prf#2196,o_orderstatus_prf#2197,o_totalprice_prf#2198,o_orderkey_prf#2199,o_comment_prf#2200] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2212 AS l_returnflag_prf_2#2231, l_orderkey_and_l_linenumber_prf#2213 AS l_orderkey_and_l_linenumber_prf_2#2232, l_comment_prf#2214 AS l_comment_prf_2#2233, l_linestatus_prf#2215 AS l_linestatus_prf_2#2234, rid#2216 AS rid_2#2235, l_shipmode_prf#2217 AS l_shipmode_prf_2#2236, l_shipinstruct_prf#2218 AS l_shipinstruct_prf_2#2237, l_quantity_prf#2219 AS l_quantity_prf_2#2238, l_receiptdate_prf#2220 AS l_receiptdate_prf_2#2239, l_linenumber_prf#2221 AS l_linenumber_prf_2#2240, l_tax_prf#2222 AS l_tax_prf_2#2241, l_shipdate_prf#2223 AS l_shipdate_prf_2#2242, l_extendedprice_prf#2224 AS l_extendedprice_prf_2#2243, l_partkey_prf#2225 AS l_partkey_prf_2#2244, l_discount_prf#2226 AS l_discount_prf_2#2245, l_partkey_and_l_suppkey_prf#2227 AS l_partkey_and_l_suppkey_prf_2#2246, l_commitdate_prf#2228 AS l_commitdate_prf_2#2247, l_suppkey_prf#2229 AS l_suppkey_prf_2#2248, l_orderkey_prf#2230 AS l_orderkey_prf_2#2249]
               +- Relation[l_returnflag_prf#2212,l_orderkey_and_l_linenumber_prf#2213,l_comment_prf#2214,l_linestatus_prf#2215,rid#2216,l_shipmode_prf#2217,l_shipinstruct_prf#2218,l_quantity_prf#2219,l_receiptdate_prf#2220,l_linenumber_prf#2221,l_tax_prf#2222,l_shipdate_prf#2223,l_extendedprice_prf#2224,l_partkey_prf#2225,l_discount_prf#2226,l_partkey_and_l_suppkey_prf#2227,l_commitdate_prf#2228,l_suppkey_prf#2229,l_orderkey_prf#2230] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 238596ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/11 09:26:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:26:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2323L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 09:26:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2323L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_2#2341]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#2334: string
         :     :- Project [s_phone_prf#2325 AS s_phone_prf_0#2333, rid#2326 AS rid_0#2334, s_address_prf#2327 AS s_address_prf_0#2335, s_nationkey_prf#2328 AS s_nationkey_prf_0#2336, s_suppkey_prf#2329 AS s_suppkey_prf_0#2337, s_name_prf#2330 AS s_name_prf_0#2338, s_acctbal_prf#2331 AS s_acctbal_prf_0#2339, s_comment_prf#2332 AS s_comment_prf_0#2340]
         :     :  +- Relation[s_phone_prf#2325,rid#2326,s_address_prf#2327,s_nationkey_prf#2328,s_suppkey_prf#2329,s_name_prf#2330,s_acctbal_prf#2331,s_comment_prf#2332] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1519) AS rid_2#2362]
            :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#2354: string
            :     :- Project [p_comment_prf#2342 AS p_comment_prf_1#2352, p_name_prf#2343 AS p_name_prf_1#2353, rid#2344 AS rid_1#2354, p_type_prf#2345 AS p_type_prf_1#2355, p_retailprice_prf#2346 AS p_retailprice_prf_1#2356, p_mfgr_prf#2347 AS p_mfgr_prf_1#2357, p_container_prf#2348 AS p_container_prf_1#2358, p_brand_prf#2349 AS p_brand_prf_1#2359, p_size_prf#2350 AS p_size_prf_1#2360, p_partkey_prf#2351 AS p_partkey_prf_1#2361]
            :     :  +- Relation[p_comment_prf#2342,p_name_prf#2343,rid#2344,p_type_prf#2345,p_retailprice_prf#2346,p_mfgr_prf#2347,p_container_prf#2348,p_brand_prf#2349,p_size_prf#2350,p_partkey_prf#2351] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2363 AS l_returnflag_prf_2#2382, l_orderkey_and_l_linenumber_prf#2364 AS l_orderkey_and_l_linenumber_prf_2#2383, l_comment_prf#2365 AS l_comment_prf_2#2384, l_linestatus_prf#2366 AS l_linestatus_prf_2#2385, rid#2367 AS rid_2#2386, l_shipmode_prf#2368 AS l_shipmode_prf_2#2387, l_shipinstruct_prf#2369 AS l_shipinstruct_prf_2#2388, l_quantity_prf#2370 AS l_quantity_prf_2#2389, l_receiptdate_prf#2371 AS l_receiptdate_prf_2#2390, l_linenumber_prf#2372 AS l_linenumber_prf_2#2391, l_tax_prf#2373 AS l_tax_prf_2#2392, l_shipdate_prf#2374 AS l_shipdate_prf_2#2393, l_extendedprice_prf#2375 AS l_extendedprice_prf_2#2394, l_partkey_prf#2376 AS l_partkey_prf_2#2395, l_discount_prf#2377 AS l_discount_prf_2#2396, l_partkey_and_l_suppkey_prf#2378 AS l_partkey_and_l_suppkey_prf_2#2397, l_commitdate_prf#2379 AS l_commitdate_prf_2#2398, l_suppkey_prf#2380 AS l_suppkey_prf_2#2399, l_orderkey_prf#2381 AS l_orderkey_prf_2#2400]
               +- Relation[l_returnflag_prf#2363,l_orderkey_and_l_linenumber_prf#2364,l_comment_prf#2365,l_linestatus_prf#2366,rid#2367,l_shipmode_prf#2368,l_shipinstruct_prf#2369,l_quantity_prf#2370,l_receiptdate_prf#2371,l_linenumber_prf#2372,l_tax_prf#2373,l_shipdate_prf#2374,l_extendedprice_prf#2375,l_partkey_prf#2376,l_discount_prf#2377,l_partkey_and_l_suppkey_prf#2378,l_commitdate_prf#2379,l_suppkey_prf#2380,l_orderkey_prf#2381] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 191373ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/11 09:29:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:29:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2462L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 09:29:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2462L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#2478]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, rid_0#2472: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#2464 AS ps_partkey_and_ps_suppkey_prf_0#2471, rid#2465 AS rid_0#2472, ps_availqty_prf#2466 AS ps_availqty_prf_0#2473, ps_comment_prf#2467 AS ps_comment_prf_0#2474, ps_partkey_prf#2468 AS ps_partkey_prf_0#2475, ps_supplycost_prf#2469 AS ps_supplycost_prf_0#2476, ps_suppkey_prf#2470 AS ps_suppkey_prf_0#2477]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2464,rid#2465,ps_availqty_prf#2466,ps_comment_prf#2467,ps_partkey_prf#2468,ps_supplycost_prf#2469,ps_suppkey_prf#2470] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2479 AS l_returnflag_prf_1#2498, l_orderkey_and_l_linenumber_prf#2480 AS l_orderkey_and_l_linenumber_prf_1#2499, l_comment_prf#2481 AS l_comment_prf_1#2500, l_linestatus_prf#2482 AS l_linestatus_prf_1#2501, rid#2483 AS rid_1#2502, l_shipmode_prf#2484 AS l_shipmode_prf_1#2503, l_shipinstruct_prf#2485 AS l_shipinstruct_prf_1#2504, l_quantity_prf#2486 AS l_quantity_prf_1#2505, l_receiptdate_prf#2487 AS l_receiptdate_prf_1#2506, l_linenumber_prf#2488 AS l_linenumber_prf_1#2507, l_tax_prf#2489 AS l_tax_prf_1#2508, l_shipdate_prf#2490 AS l_shipdate_prf_1#2509, l_extendedprice_prf#2491 AS l_extendedprice_prf_1#2510, l_partkey_prf#2492 AS l_partkey_prf_1#2511, l_discount_prf#2493 AS l_discount_prf_1#2512, l_partkey_and_l_suppkey_prf#2494 AS l_partkey_and_l_suppkey_prf_1#2513, l_commitdate_prf#2495 AS l_commitdate_prf_1#2514, l_suppkey_prf#2496 AS l_suppkey_prf_1#2515, l_orderkey_prf#2497 AS l_orderkey_prf_1#2516]
            +- Relation[l_returnflag_prf#2479,l_orderkey_and_l_linenumber_prf#2480,l_comment_prf#2481,l_linestatus_prf#2482,rid#2483,l_shipmode_prf#2484,l_shipinstruct_prf#2485,l_quantity_prf#2486,l_receiptdate_prf#2487,l_linenumber_prf#2488,l_tax_prf#2489,l_shipdate_prf#2490,l_extendedprice_prf#2491,l_partkey_prf#2492,l_discount_prf#2493,l_partkey_and_l_suppkey_prf#2494,l_commitdate_prf#2495,l_suppkey_prf#2496,l_orderkey_prf#2497] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 118021ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/11 09:31:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:31:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2555L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 09:31:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2555L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#2557 AS p_comment_prf_0#2567, p_name_prf#2558 AS p_name_prf_0#2568, rid#2559 AS rid_0#2569, p_type_prf#2560 AS p_type_prf_0#2570, p_retailprice_prf#2561 AS p_retailprice_prf_0#2571, p_mfgr_prf#2562 AS p_mfgr_prf_0#2572, p_container_prf#2563 AS p_container_prf_0#2573, p_brand_prf#2564 AS p_brand_prf_0#2574, p_size_prf#2565 AS p_size_prf_0#2575, p_partkey_prf#2566 AS p_partkey_prf_0#2576]
         :  +- Relation[p_comment_prf#2557,p_name_prf#2558,rid#2559,p_type_prf#2560,p_retailprice_prf#2561,p_mfgr_prf#2562,p_container_prf#2563,p_brand_prf#2564,p_size_prf#2565,p_partkey_prf#2566] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2577]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1627,value#1628] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1451
Elapsed time: 84ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/11 09:31:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:31:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2616L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 09:31:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2616L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#2638]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#2629: string
         :     :- Project [o_shippriority_prf#2618 AS o_shippriority_prf_0#2628, rid#2619 AS rid_0#2629, o_orderdate_prf#2620 AS o_orderdate_prf_0#2630, o_custkey_prf#2621 AS o_custkey_prf_0#2631, o_orderpriority_prf#2622 AS o_orderpriority_prf_0#2632, o_clerk_prf#2623 AS o_clerk_prf_0#2633, o_orderstatus_prf#2624 AS o_orderstatus_prf_0#2634, o_totalprice_prf#2625 AS o_totalprice_prf_0#2635, o_orderkey_prf#2626 AS o_orderkey_prf_0#2636, o_comment_prf#2627 AS o_comment_prf_0#2637]
         :     :  +- Relation[o_shippriority_prf#2618,rid#2619,o_orderdate_prf#2620,o_custkey_prf#2621,o_orderpriority_prf#2622,o_clerk_prf#2623,o_orderstatus_prf#2624,o_totalprice_prf#2625,o_orderkey_prf#2626,o_comment_prf#2627] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#2639 AS l_returnflag_prf_1#2658, l_orderkey_and_l_linenumber_prf#2640 AS l_orderkey_and_l_linenumber_prf_1#2659, l_comment_prf#2641 AS l_comment_prf_1#2660, l_linestatus_prf#2642 AS l_linestatus_prf_1#2661, rid#2643 AS rid_1#2662, l_shipmode_prf#2644 AS l_shipmode_prf_1#2663, l_shipinstruct_prf#2645 AS l_shipinstruct_prf_1#2664, l_quantity_prf#2646 AS l_quantity_prf_1#2665, l_receiptdate_prf#2647 AS l_receiptdate_prf_1#2666, l_linenumber_prf#2648 AS l_linenumber_prf_1#2667, l_tax_prf#2649 AS l_tax_prf_1#2668, l_shipdate_prf#2650 AS l_shipdate_prf_1#2669, l_extendedprice_prf#2651 AS l_extendedprice_prf_1#2670, l_partkey_prf#2652 AS l_partkey_prf_1#2671, l_discount_prf#2653 AS l_discount_prf_1#2672, l_partkey_and_l_suppkey_prf#2654 AS l_partkey_and_l_suppkey_prf_1#2673, l_commitdate_prf#2655 AS l_commitdate_prf_1#2674, l_suppkey_prf#2656 AS l_suppkey_prf_1#2675, l_orderkey_prf#2657 AS l_orderkey_prf_1#2676]
            :  +- Relation[l_returnflag_prf#2639,l_orderkey_and_l_linenumber_prf#2640,l_comment_prf#2641,l_linestatus_prf#2642,rid#2643,l_shipmode_prf#2644,l_shipinstruct_prf#2645,l_quantity_prf#2646,l_receiptdate_prf#2647,l_linenumber_prf#2648,l_tax_prf#2649,l_shipdate_prf#2650,l_extendedprice_prf#2651,l_partkey_prf#2652,l_discount_prf#2653,l_partkey_and_l_suppkey_prf#2654,l_commitdate_prf#2655,l_suppkey_prf#2656,l_orderkey_prf#2657] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2677]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1627,value#1628] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 201439ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/11 09:34:44 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:34:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2731L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 09:34:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2731L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_2#2749]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#2742: string
         :     :- Project [s_phone_prf#2733 AS s_phone_prf_0#2741, rid#2734 AS rid_0#2742, s_address_prf#2735 AS s_address_prf_0#2743, s_nationkey_prf#2736 AS s_nationkey_prf_0#2744, s_suppkey_prf#2737 AS s_suppkey_prf_0#2745, s_name_prf#2738 AS s_name_prf_0#2746, s_acctbal_prf#2739 AS s_acctbal_prf_0#2747, s_comment_prf#2740 AS s_comment_prf_0#2748]
         :     :  +- Relation[s_phone_prf#2733,rid#2734,s_address_prf#2735,s_nationkey_prf#2736,s_suppkey_prf#2737,s_name_prf#2738,s_acctbal_prf#2739,s_comment_prf#2740] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1519) AS rid_2#2770]
            :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#2762: string
            :     :- Project [p_comment_prf#2750 AS p_comment_prf_1#2760, p_name_prf#2751 AS p_name_prf_1#2761, rid#2752 AS rid_1#2762, p_type_prf#2753 AS p_type_prf_1#2763, p_retailprice_prf#2754 AS p_retailprice_prf_1#2764, p_mfgr_prf#2755 AS p_mfgr_prf_1#2765, p_container_prf#2756 AS p_container_prf_1#2766, p_brand_prf#2757 AS p_brand_prf_1#2767, p_size_prf#2758 AS p_size_prf_1#2768, p_partkey_prf#2759 AS p_partkey_prf_1#2769]
            :     :  +- Relation[p_comment_prf#2750,p_name_prf#2751,rid#2752,p_type_prf#2753,p_retailprice_prf#2754,p_mfgr_prf#2755,p_container_prf#2756,p_brand_prf#2757,p_size_prf#2758,p_partkey_prf#2759] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#2771 AS ps_partkey_and_ps_suppkey_prf_2#2778, rid#2772 AS rid_2#2779, ps_availqty_prf#2773 AS ps_availqty_prf_2#2780, ps_comment_prf#2774 AS ps_comment_prf_2#2781, ps_partkey_prf#2775 AS ps_partkey_prf_2#2782, ps_supplycost_prf#2776 AS ps_supplycost_prf_2#2783, ps_suppkey_prf#2777 AS ps_suppkey_prf_2#2784]
               +- Relation[ps_partkey_and_ps_suppkey_prf#2771,rid#2772,ps_availqty_prf#2773,ps_comment_prf#2774,ps_partkey_prf#2775,ps_supplycost_prf#2776,ps_suppkey_prf#2777] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 43701ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/11 09:35:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:35:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2827L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 09:35:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2827L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#2849]
         :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2841: string
         :     :- Project [p_comment_prf#2829 AS p_comment_prf_0#2839, p_name_prf#2830 AS p_name_prf_0#2840, rid#2831 AS rid_0#2841, p_type_prf#2832 AS p_type_prf_0#2842, p_retailprice_prf#2833 AS p_retailprice_prf_0#2843, p_mfgr_prf#2834 AS p_mfgr_prf_0#2844, p_container_prf#2835 AS p_container_prf_0#2845, p_brand_prf#2836 AS p_brand_prf_0#2846, p_size_prf#2837 AS p_size_prf_0#2847, p_partkey_prf#2838 AS p_partkey_prf_0#2848]
         :     :  +- Relation[p_comment_prf#2829,p_name_prf#2830,rid#2831,p_type_prf#2832,p_retailprice_prf#2833,p_mfgr_prf#2834,p_container_prf#2835,p_brand_prf#2836,p_size_prf#2837,p_partkey_prf#2838] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2850 AS ps_partkey_and_ps_suppkey_prf_1#2857, rid#2851 AS rid_1#2858, ps_availqty_prf#2852 AS ps_availqty_prf_1#2859, ps_comment_prf#2853 AS ps_comment_prf_1#2860, ps_partkey_prf#2854 AS ps_partkey_prf_1#2861, ps_supplycost_prf#2855 AS ps_supplycost_prf_1#2862, ps_suppkey_prf#2856 AS ps_suppkey_prf_1#2863]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2850,rid#2851,ps_availqty_prf#2852,ps_comment_prf#2853,ps_partkey_prf#2854,ps_supplycost_prf#2855,ps_suppkey_prf#2856] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 32085ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/11 09:35:59 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:35:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2905L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 09:35:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2905L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#2923]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#2916: string
         :     :- Project [s_phone_prf#2907 AS s_phone_prf_0#2915, rid#2908 AS rid_0#2916, s_address_prf#2909 AS s_address_prf_0#2917, s_nationkey_prf#2910 AS s_nationkey_prf_0#2918, s_suppkey_prf#2911 AS s_suppkey_prf_0#2919, s_name_prf#2912 AS s_name_prf_0#2920, s_acctbal_prf#2913 AS s_acctbal_prf_0#2921, s_comment_prf#2914 AS s_comment_prf_0#2922]
         :     :  +- Relation[s_phone_prf#2907,rid#2908,s_address_prf#2909,s_nationkey_prf#2910,s_suppkey_prf#2911,s_name_prf#2912,s_acctbal_prf#2913,s_comment_prf#2914] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1519) AS rid_2#2938]
            :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_1#2932: string
            :     :- Project [ps_partkey_and_ps_suppkey_prf#2924 AS ps_partkey_and_ps_suppkey_prf_1#2931, rid#2925 AS rid_1#2932, ps_availqty_prf#2926 AS ps_availqty_prf_1#2933, ps_comment_prf#2927 AS ps_comment_prf_1#2934, ps_partkey_prf#2928 AS ps_partkey_prf_1#2935, ps_supplycost_prf#2929 AS ps_supplycost_prf_1#2936, ps_suppkey_prf#2930 AS ps_suppkey_prf_1#2937]
            :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2924,rid#2925,ps_availqty_prf#2926,ps_comment_prf#2927,ps_partkey_prf#2928,ps_supplycost_prf#2929,ps_suppkey_prf#2930] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#2939 AS p_comment_prf_2#2949, p_name_prf#2940 AS p_name_prf_2#2950, rid#2941 AS rid_2#2951, p_type_prf#2942 AS p_type_prf_2#2952, p_retailprice_prf#2943 AS p_retailprice_prf_2#2953, p_mfgr_prf#2944 AS p_mfgr_prf_2#2954, p_container_prf#2945 AS p_container_prf_2#2955, p_brand_prf#2946 AS p_brand_prf_2#2956, p_size_prf#2947 AS p_size_prf_2#2957, p_partkey_prf#2948 AS p_partkey_prf_2#2958]
               +- Relation[p_comment_prf#2939,p_name_prf#2940,rid#2941,p_type_prf#2942,p_retailprice_prf#2943,p_mfgr_prf#2944,p_container_prf#2945,p_brand_prf#2946,p_size_prf#2947,p_partkey_prf#2948] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 62512ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/11 09:37:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:37:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2994L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 09:37:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2994L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#3004]
         :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#3003: string
         :     :- Project [r_regionkey_prf#2996 AS r_regionkey_prf_0#3000, r_name_prf#2997 AS r_name_prf_0#3001, r_comment_prf#2998 AS r_comment_prf_0#3002, rid#2999 AS rid_0#3003]
         :     :  +- Relation[r_regionkey_prf#2996,r_name_prf#2997,r_comment_prf#2998,rid#2999] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#3005 AS rid_1#3010, n_regionkey_prf#3006 AS n_regionkey_prf_1#3011, n_nationkey_prf#3007 AS n_nationkey_prf_1#3012, n_name_prf#3008 AS n_name_prf_1#3013, n_comment_prf#3009 AS n_comment_prf_1#3014]
            +- Relation[rid#3005,n_regionkey_prf#3006,n_nationkey_prf#3007,n_name_prf#3008,n_comment_prf#3009] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=25
Elapsed time: 69ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/11 09:37:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:37:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3043L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 09:37:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3043L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#3045 AS l_returnflag_prf_0#3064, l_orderkey_and_l_linenumber_prf#3046 AS l_orderkey_and_l_linenumber_prf_0#3065, l_comment_prf#3047 AS l_comment_prf_0#3066, l_linestatus_prf#3048 AS l_linestatus_prf_0#3067, rid#3049 AS rid_0#3068, l_shipmode_prf#3050 AS l_shipmode_prf_0#3069, l_shipinstruct_prf#3051 AS l_shipinstruct_prf_0#3070, l_quantity_prf#3052 AS l_quantity_prf_0#3071, l_receiptdate_prf#3053 AS l_receiptdate_prf_0#3072, l_linenumber_prf#3054 AS l_linenumber_prf_0#3073, l_tax_prf#3055 AS l_tax_prf_0#3074, l_shipdate_prf#3056 AS l_shipdate_prf_0#3075, l_extendedprice_prf#3057 AS l_extendedprice_prf_0#3076, l_partkey_prf#3058 AS l_partkey_prf_0#3077, l_discount_prf#3059 AS l_discount_prf_0#3078, l_partkey_and_l_suppkey_prf#3060 AS l_partkey_and_l_suppkey_prf_0#3079, l_commitdate_prf#3061 AS l_commitdate_prf_0#3080, l_suppkey_prf#3062 AS l_suppkey_prf_0#3081, l_orderkey_prf#3063 AS l_orderkey_prf_0#3082]
         :  +- Relation[l_returnflag_prf#3045,l_orderkey_and_l_linenumber_prf#3046,l_comment_prf#3047,l_linestatus_prf#3048,rid#3049,l_shipmode_prf#3050,l_shipinstruct_prf#3051,l_quantity_prf#3052,l_receiptdate_prf#3053,l_linenumber_prf#3054,l_tax_prf#3055,l_shipdate_prf#3056,l_extendedprice_prf#3057,l_partkey_prf#3058,l_discount_prf#3059,l_partkey_and_l_suppkey_prf#3060,l_commitdate_prf#3061,l_suppkey_prf#3062,l_orderkey_prf#3063] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3083]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1627,value#1628] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 23834ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_orderkey and l_orderkey = o_orderkey
19/10/11 09:37:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:37:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3139L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 09:37:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3139L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_2#3179]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3164: string
         :     :- Project [l_returnflag_prf#3141 AS l_returnflag_prf_0#3160, l_orderkey_and_l_linenumber_prf#3142 AS l_orderkey_and_l_linenumber_prf_0#3161, l_comment_prf#3143 AS l_comment_prf_0#3162, l_linestatus_prf#3144 AS l_linestatus_prf_0#3163, rid#3145 AS rid_0#3164, l_shipmode_prf#3146 AS l_shipmode_prf_0#3165, l_shipinstruct_prf#3147 AS l_shipinstruct_prf_0#3166, l_quantity_prf#3148 AS l_quantity_prf_0#3167, l_receiptdate_prf#3149 AS l_receiptdate_prf_0#3168, l_linenumber_prf#3150 AS l_linenumber_prf_0#3169, l_tax_prf#3151 AS l_tax_prf_0#3170, l_shipdate_prf#3152 AS l_shipdate_prf_0#3171, l_extendedprice_prf#3153 AS l_extendedprice_prf_0#3172, l_partkey_prf#3154 AS l_partkey_prf_0#3173, l_discount_prf#3155 AS l_discount_prf_0#3174, l_partkey_and_l_suppkey_prf#3156 AS l_partkey_and_l_suppkey_prf_0#3175, l_commitdate_prf#3157 AS l_commitdate_prf_0#3176, l_suppkey_prf#3158 AS l_suppkey_prf_0#3177, l_orderkey_prf#3159 AS l_orderkey_prf_0#3178]
         :     :  +- Relation[l_returnflag_prf#3141,l_orderkey_and_l_linenumber_prf#3142,l_comment_prf#3143,l_linestatus_prf#3144,rid#3145,l_shipmode_prf#3146,l_shipinstruct_prf#3147,l_quantity_prf#3148,l_receiptdate_prf#3149,l_linenumber_prf#3150,l_tax_prf#3151,l_shipdate_prf#3152,l_extendedprice_prf#3153,l_partkey_prf#3154,l_discount_prf#3155,l_partkey_and_l_suppkey_prf#3156,l_commitdate_prf#3157,l_suppkey_prf#3158,l_orderkey_prf#3159] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1519) AS rid_2#3198]
            :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#3190: string
            :     :- Project [c_acctbal_prf#3180 AS c_acctbal_prf_1#3189, rid#3181 AS rid_1#3190, c_name_prf#3182 AS c_name_prf_1#3191, c_nationkey_prf#3183 AS c_nationkey_prf_1#3192, c_custkey_prf#3184 AS c_custkey_prf_1#3193, c_comment_prf#3185 AS c_comment_prf_1#3194, c_address_prf#3186 AS c_address_prf_1#3195, c_mktsegment_prf#3187 AS c_mktsegment_prf_1#3196, c_phone_prf#3188 AS c_phone_prf_1#3197]
            :     :  +- Relation[c_acctbal_prf#3180,rid#3181,c_name_prf#3182,c_nationkey_prf#3183,c_custkey_prf#3184,c_comment_prf#3185,c_address_prf#3186,c_mktsegment_prf#3187,c_phone_prf#3188] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3199 AS o_shippriority_prf_2#3209, rid#3200 AS rid_2#3210, o_orderdate_prf#3201 AS o_orderdate_prf_2#3211, o_custkey_prf#3202 AS o_custkey_prf_2#3212, o_orderpriority_prf#3203 AS o_orderpriority_prf_2#3213, o_clerk_prf#3204 AS o_clerk_prf_2#3214, o_orderstatus_prf#3205 AS o_orderstatus_prf_2#3215, o_totalprice_prf#3206 AS o_totalprice_prf_2#3216, o_orderkey_prf#3207 AS o_orderkey_prf_2#3217, o_comment_prf#3208 AS o_comment_prf_2#3218]
               +- Relation[o_shippriority_prf#3199,rid#3200,o_orderdate_prf#3201,o_custkey_prf#3202,o_orderpriority_prf#3203,o_clerk_prf#3204,o_orderstatus_prf#3205,o_totalprice_prf#3206,o_orderkey_prf#3207,o_comment_prf#3208] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 175576ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/11 09:40:21 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:40:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3292L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 09:40:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3292L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#3310]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#3303: string
         :     :- Project [s_phone_prf#3294 AS s_phone_prf_0#3302, rid#3295 AS rid_0#3303, s_address_prf#3296 AS s_address_prf_0#3304, s_nationkey_prf#3297 AS s_nationkey_prf_0#3305, s_suppkey_prf#3298 AS s_suppkey_prf_0#3306, s_name_prf#3299 AS s_name_prf_0#3307, s_acctbal_prf#3300 AS s_acctbal_prf_0#3308, s_comment_prf#3301 AS s_comment_prf_0#3309]
         :     :  +- Relation[s_phone_prf#3294,rid#3295,s_address_prf#3296,s_nationkey_prf#3297,s_suppkey_prf#3298,s_name_prf#3299,s_acctbal_prf#3300,s_comment_prf#3301] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1519) AS rid_2#3349]
            :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_1#3334: string
            :     :- Project [l_returnflag_prf#3311 AS l_returnflag_prf_1#3330, l_orderkey_and_l_linenumber_prf#3312 AS l_orderkey_and_l_linenumber_prf_1#3331, l_comment_prf#3313 AS l_comment_prf_1#3332, l_linestatus_prf#3314 AS l_linestatus_prf_1#3333, rid#3315 AS rid_1#3334, l_shipmode_prf#3316 AS l_shipmode_prf_1#3335, l_shipinstruct_prf#3317 AS l_shipinstruct_prf_1#3336, l_quantity_prf#3318 AS l_quantity_prf_1#3337, l_receiptdate_prf#3319 AS l_receiptdate_prf_1#3338, l_linenumber_prf#3320 AS l_linenumber_prf_1#3339, l_tax_prf#3321 AS l_tax_prf_1#3340, l_shipdate_prf#3322 AS l_shipdate_prf_1#3341, l_extendedprice_prf#3323 AS l_extendedprice_prf_1#3342, l_partkey_prf#3324 AS l_partkey_prf_1#3343, l_discount_prf#3325 AS l_discount_prf_1#3344, l_partkey_and_l_suppkey_prf#3326 AS l_partkey_and_l_suppkey_prf_1#3345, l_commitdate_prf#3327 AS l_commitdate_prf_1#3346, l_suppkey_prf#3328 AS l_suppkey_prf_1#3347, l_orderkey_prf#3329 AS l_orderkey_prf_1#3348]
            :     :  +- Relation[l_returnflag_prf#3311,l_orderkey_and_l_linenumber_prf#3312,l_comment_prf#3313,l_linestatus_prf#3314,rid#3315,l_shipmode_prf#3316,l_shipinstruct_prf#3317,l_quantity_prf#3318,l_receiptdate_prf#3319,l_linenumber_prf#3320,l_tax_prf#3321,l_shipdate_prf#3322,l_extendedprice_prf#3323,l_partkey_prf#3324,l_discount_prf#3325,l_partkey_and_l_suppkey_prf#3326,l_commitdate_prf#3327,l_suppkey_prf#3328,l_orderkey_prf#3329] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#3350 AS p_comment_prf_2#3360, p_name_prf#3351 AS p_name_prf_2#3361, rid#3352 AS rid_2#3362, p_type_prf#3353 AS p_type_prf_2#3363, p_retailprice_prf#3354 AS p_retailprice_prf_2#3364, p_mfgr_prf#3355 AS p_mfgr_prf_2#3365, p_container_prf#3356 AS p_container_prf_2#3366, p_brand_prf#3357 AS p_brand_prf_2#3367, p_size_prf#3358 AS p_size_prf_2#3368, p_partkey_prf#3359 AS p_partkey_prf_2#3369]
               +- Relation[p_comment_prf#3350,p_name_prf#3351,rid#3352,p_type_prf#3353,p_retailprice_prf#3354,p_mfgr_prf#3355,p_container_prf#3356,p_brand_prf#3357,p_size_prf#3358,p_partkey_prf#3359] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 201025ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/11 09:43:42 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:43:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3424L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 09:43:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3424L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#3440]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#3434: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#3426 AS ps_partkey_and_ps_suppkey_prf_0#3433, rid#3427 AS rid_0#3434, ps_availqty_prf#3428 AS ps_availqty_prf_0#3435, ps_comment_prf#3429 AS ps_comment_prf_0#3436, ps_partkey_prf#3430 AS ps_partkey_prf_0#3437, ps_supplycost_prf#3431 AS ps_supplycost_prf_0#3438, ps_suppkey_prf#3432 AS ps_suppkey_prf_0#3439]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#3426,rid#3427,ps_availqty_prf#3428,ps_comment_prf#3429,ps_partkey_prf#3430,ps_supplycost_prf#3431,ps_suppkey_prf#3432] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#3441 AS p_comment_prf_1#3451, p_name_prf#3442 AS p_name_prf_1#3452, rid#3443 AS rid_1#3453, p_type_prf#3444 AS p_type_prf_1#3454, p_retailprice_prf#3445 AS p_retailprice_prf_1#3455, p_mfgr_prf#3446 AS p_mfgr_prf_1#3456, p_container_prf#3447 AS p_container_prf_1#3457, p_brand_prf#3448 AS p_brand_prf_1#3458, p_size_prf#3449 AS p_size_prf_1#3459, p_partkey_prf#3450 AS p_partkey_prf_1#3460]
            :  +- Relation[p_comment_prf#3441,p_name_prf#3442,rid#3443,p_type_prf#3444,p_retailprice_prf#3445,p_mfgr_prf#3446,p_container_prf#3447,p_brand_prf#3448,p_size_prf#3449,p_partkey_prf#3450] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3461]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1627,value#1628] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 50547ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/11 09:44:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:44:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3514L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 09:44:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3514L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#3554]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#3539: string
         :     :  :     :- Project [l_returnflag_prf#3516 AS l_returnflag_prf_0#3535, l_orderkey_and_l_linenumber_prf#3517 AS l_orderkey_and_l_linenumber_prf_0#3536, l_comment_prf#3518 AS l_comment_prf_0#3537, l_linestatus_prf#3519 AS l_linestatus_prf_0#3538, rid#3520 AS rid_0#3539, l_shipmode_prf#3521 AS l_shipmode_prf_0#3540, l_shipinstruct_prf#3522 AS l_shipinstruct_prf_0#3541, l_quantity_prf#3523 AS l_quantity_prf_0#3542, l_receiptdate_prf#3524 AS l_receiptdate_prf_0#3543, l_linenumber_prf#3525 AS l_linenumber_prf_0#3544, l_tax_prf#3526 AS l_tax_prf_0#3545, l_shipdate_prf#3527 AS l_shipdate_prf_0#3546, l_extendedprice_prf#3528 AS l_extendedprice_prf_0#3547, l_partkey_prf#3529 AS l_partkey_prf_0#3548, l_discount_prf#3530 AS l_discount_prf_0#3549, l_partkey_and_l_suppkey_prf#3531 AS l_partkey_and_l_suppkey_prf_0#3550, l_commitdate_prf#3532 AS l_commitdate_prf_0#3551, l_suppkey_prf#3533 AS l_suppkey_prf_0#3552, l_orderkey_prf#3534 AS l_orderkey_prf_0#3553]
         :     :  :     :  +- Relation[l_returnflag_prf#3516,l_orderkey_and_l_linenumber_prf#3517,l_comment_prf#3518,l_linestatus_prf#3519,rid#3520,l_shipmode_prf#3521,l_shipinstruct_prf#3522,l_quantity_prf#3523,l_receiptdate_prf#3524,l_linenumber_prf#3525,l_tax_prf#3526,l_shipdate_prf#3527,l_extendedprice_prf#3528,l_partkey_prf#3529,l_discount_prf#3530,l_partkey_and_l_suppkey_prf#3531,l_commitdate_prf#3532,l_suppkey_prf#3533,l_orderkey_prf#3534] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#3555 AS p_comment_prf_1#3565, p_name_prf#3556 AS p_name_prf_1#3566, rid#3557 AS rid_1#3567, p_type_prf#3558 AS p_type_prf_1#3568, p_retailprice_prf#3559 AS p_retailprice_prf_1#3569, p_mfgr_prf#3560 AS p_mfgr_prf_1#3570, p_container_prf#3561 AS p_container_prf_1#3571, p_brand_prf#3562 AS p_brand_prf_1#3572, p_size_prf#3563 AS p_size_prf_1#3573, p_partkey_prf#3564 AS p_partkey_prf_1#3574]
         :     :     +- Relation[p_comment_prf#3555,p_name_prf#3556,rid#3557,p_type_prf#3558,p_retailprice_prf#3559,p_mfgr_prf#3560,p_container_prf#3561,p_brand_prf#3562,p_size_prf#3563,p_partkey_prf#3564] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3576 AS s_phone_prf_2#3584, rid#3577 AS rid_2#3585, s_address_prf#3578 AS s_address_prf_2#3586, s_nationkey_prf#3579 AS s_nationkey_prf_2#3587, s_suppkey_prf#3580 AS s_suppkey_prf_2#3588, s_name_prf#3581 AS s_name_prf_2#3589, s_acctbal_prf#3582 AS s_acctbal_prf_2#3590, s_comment_prf#3583 AS s_comment_prf_2#3591]
            +- Relation[s_phone_prf#3576,rid#3577,s_address_prf#3578,s_nationkey_prf#3579,s_suppkey_prf#3580,s_name_prf#3581,s_acctbal_prf#3582,s_comment_prf#3583] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 294309ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/11 09:49:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:49:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3653L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 09:49:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3653L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1519) AS rid_2#3690]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#3675]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#3667: string
         :     :  :     :- Project [p_comment_prf#3655 AS p_comment_prf_0#3665, p_name_prf#3656 AS p_name_prf_0#3666, rid#3657 AS rid_0#3667, p_type_prf#3658 AS p_type_prf_0#3668, p_retailprice_prf#3659 AS p_retailprice_prf_0#3669, p_mfgr_prf#3660 AS p_mfgr_prf_0#3670, p_container_prf#3661 AS p_container_prf_0#3671, p_brand_prf#3662 AS p_brand_prf_0#3672, p_size_prf#3663 AS p_size_prf_0#3673, p_partkey_prf#3664 AS p_partkey_prf_0#3674]
         :     :  :     :  +- Relation[p_comment_prf#3655,p_name_prf#3656,rid#3657,p_type_prf#3658,p_retailprice_prf#3659,p_mfgr_prf#3660,p_container_prf#3661,p_brand_prf#3662,p_size_prf#3663,p_partkey_prf#3664] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#3676 AS ps_partkey_and_ps_suppkey_prf_1#3683, rid#3677 AS rid_1#3684, ps_availqty_prf#3678 AS ps_availqty_prf_1#3685, ps_comment_prf#3679 AS ps_comment_prf_1#3686, ps_partkey_prf#3680 AS ps_partkey_prf_1#3687, ps_supplycost_prf#3681 AS ps_supplycost_prf_1#3688, ps_suppkey_prf#3682 AS ps_suppkey_prf_1#3689]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#3676,rid#3677,ps_availqty_prf#3678,ps_comment_prf#3679,ps_partkey_prf#3680,ps_supplycost_prf#3681,ps_suppkey_prf#3682] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3691 AS s_phone_prf_2#3699, rid#3692 AS rid_2#3700, s_address_prf#3693 AS s_address_prf_2#3701, s_nationkey_prf#3694 AS s_nationkey_prf_2#3702, s_suppkey_prf#3695 AS s_suppkey_prf_2#3703, s_name_prf#3696 AS s_name_prf_2#3704, s_acctbal_prf#3697 AS s_acctbal_prf_2#3705, s_comment_prf#3698 AS s_comment_prf_2#3706]
            +- Relation[s_phone_prf#3691,rid#3692,s_address_prf#3693,s_nationkey_prf#3694,s_suppkey_prf#3695,s_name_prf#3696,s_acctbal_prf#3697,s_comment_prf#3698] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 94918ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/11 09:51:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 09:51:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3754L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 09:51:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3754L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#1519) AS rid_2#3783]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#3772]
         :     :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#3765: string
         :     :  :     :- Project [s_phone_prf#3756 AS s_phone_prf_0#3764, rid#3757 AS rid_0#3765, s_address_prf#3758 AS s_address_prf_0#3766, s_nationkey_prf#3759 AS s_nationkey_prf_0#3767, s_suppkey_prf#3760 AS s_suppkey_prf_0#3768, s_name_prf#3761 AS s_name_prf_0#3769, s_acctbal_prf#3762 AS s_acctbal_prf_0#3770, s_comment_prf#3763 AS s_comment_prf_0#3771]
         :     :  :     :  +- Relation[s_phone_prf#3756,rid#3757,s_address_prf#3758,s_nationkey_prf#3759,s_suppkey_prf#3760,s_name_prf#3761,s_acctbal_prf#3762,s_comment_prf#3763] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [rid#3773 AS rid_1#3778, n_regionkey_prf#3774 AS n_regionkey_prf_1#3779, n_nationkey_prf#3775 AS n_nationkey_prf_1#3780, n_name_prf#3776 AS n_name_prf_1#3781, n_comment_prf#3777 AS n_comment_prf_1#3782]
         :     :     +- Relation[rid#3773,n_regionkey_prf#3774,n_nationkey_prf#3775,n_name_prf#3776,n_comment_prf#3777] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3784 AS c_acctbal_prf_2#3793, rid#3785 AS rid_2#3794, c_name_prf#3786 AS c_name_prf_2#3795, c_nationkey_prf#3787 AS c_nationkey_prf_2#3796, c_custkey_prf#3788 AS c_custkey_prf_2#3797, c_comment_prf#3789 AS c_comment_prf_2#3798, c_address_prf#3790 AS c_address_prf_2#3799, c_mktsegment_prf#3791 AS c_mktsegment_prf_2#3800, c_phone_prf#3792 AS c_phone_prf_2#3801]
            +- Relation[c_acctbal_prf#3784,rid#3785,c_name_prf#3786,c_nationkey_prf#3787,c_custkey_prf#3788,c_comment_prf#3789,c_address_prf#3790,c_mktsegment_prf#3791,c_phone_prf#3792] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 680675ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/11 10:02:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:02:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3852L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 10:02:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3852L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#3892]
         :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#3877: string
         :     :- Project [l_returnflag_prf#3854 AS l_returnflag_prf_0#3873, l_orderkey_and_l_linenumber_prf#3855 AS l_orderkey_and_l_linenumber_prf_0#3874, l_comment_prf#3856 AS l_comment_prf_0#3875, l_linestatus_prf#3857 AS l_linestatus_prf_0#3876, rid#3858 AS rid_0#3877, l_shipmode_prf#3859 AS l_shipmode_prf_0#3878, l_shipinstruct_prf#3860 AS l_shipinstruct_prf_0#3879, l_quantity_prf#3861 AS l_quantity_prf_0#3880, l_receiptdate_prf#3862 AS l_receiptdate_prf_0#3881, l_linenumber_prf#3863 AS l_linenumber_prf_0#3882, l_tax_prf#3864 AS l_tax_prf_0#3883, l_shipdate_prf#3865 AS l_shipdate_prf_0#3884, l_extendedprice_prf#3866 AS l_extendedprice_prf_0#3885, l_partkey_prf#3867 AS l_partkey_prf_0#3886, l_discount_prf#3868 AS l_discount_prf_0#3887, l_partkey_and_l_suppkey_prf#3869 AS l_partkey_and_l_suppkey_prf_0#3888, l_commitdate_prf#3870 AS l_commitdate_prf_0#3889, l_suppkey_prf#3871 AS l_suppkey_prf_0#3890, l_orderkey_prf#3872 AS l_orderkey_prf_0#3891]
         :     :  +- Relation[l_returnflag_prf#3854,l_orderkey_and_l_linenumber_prf#3855,l_comment_prf#3856,l_linestatus_prf#3857,rid#3858,l_shipmode_prf#3859,l_shipinstruct_prf#3860,l_quantity_prf#3861,l_receiptdate_prf#3862,l_linenumber_prf#3863,l_tax_prf#3864,l_shipdate_prf#3865,l_extendedprice_prf#3866,l_partkey_prf#3867,l_discount_prf#3868,l_partkey_and_l_suppkey_prf#3869,l_commitdate_prf#3870,l_suppkey_prf#3871,l_orderkey_prf#3872] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#3893 AS p_comment_prf_1#3903, p_name_prf#3894 AS p_name_prf_1#3904, rid#3895 AS rid_1#3905, p_type_prf#3896 AS p_type_prf_1#3906, p_retailprice_prf#3897 AS p_retailprice_prf_1#3907, p_mfgr_prf#3898 AS p_mfgr_prf_1#3908, p_container_prf#3899 AS p_container_prf_1#3909, p_brand_prf#3900 AS p_brand_prf_1#3910, p_size_prf#3901 AS p_size_prf_1#3911, p_partkey_prf#3902 AS p_partkey_prf_1#3912]
            +- Relation[p_comment_prf#3893,p_name_prf#3894,rid#3895,p_type_prf#3896,p_retailprice_prf#3897,p_mfgr_prf#3898,p_container_prf#3899,p_brand_prf#3900,p_size_prf#3901,p_partkey_prf#3902] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 129788ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/11 10:04:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:04:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3970L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 10:04:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3970L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#3992]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#3983: string
         :     :- Project [o_shippriority_prf#3972 AS o_shippriority_prf_0#3982, rid#3973 AS rid_0#3983, o_orderdate_prf#3974 AS o_orderdate_prf_0#3984, o_custkey_prf#3975 AS o_custkey_prf_0#3985, o_orderpriority_prf#3976 AS o_orderpriority_prf_0#3986, o_clerk_prf#3977 AS o_clerk_prf_0#3987, o_orderstatus_prf#3978 AS o_orderstatus_prf_0#3988, o_totalprice_prf#3979 AS o_totalprice_prf_0#3989, o_orderkey_prf#3980 AS o_orderkey_prf_0#3990, o_comment_prf#3981 AS o_comment_prf_0#3991]
         :     :  +- Relation[o_shippriority_prf#3972,rid#3973,o_orderdate_prf#3974,o_custkey_prf#3975,o_orderpriority_prf#3976,o_clerk_prf#3977,o_orderstatus_prf#3978,o_totalprice_prf#3979,o_orderkey_prf#3980,o_comment_prf#3981] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3993 AS l_returnflag_prf_1#4012, l_orderkey_and_l_linenumber_prf#3994 AS l_orderkey_and_l_linenumber_prf_1#4013, l_comment_prf#3995 AS l_comment_prf_1#4014, l_linestatus_prf#3996 AS l_linestatus_prf_1#4015, rid#3997 AS rid_1#4016, l_shipmode_prf#3998 AS l_shipmode_prf_1#4017, l_shipinstruct_prf#3999 AS l_shipinstruct_prf_1#4018, l_quantity_prf#4000 AS l_quantity_prf_1#4019, l_receiptdate_prf#4001 AS l_receiptdate_prf_1#4020, l_linenumber_prf#4002 AS l_linenumber_prf_1#4021, l_tax_prf#4003 AS l_tax_prf_1#4022, l_shipdate_prf#4004 AS l_shipdate_prf_1#4023, l_extendedprice_prf#4005 AS l_extendedprice_prf_1#4024, l_partkey_prf#4006 AS l_partkey_prf_1#4025, l_discount_prf#4007 AS l_discount_prf_1#4026, l_partkey_and_l_suppkey_prf#4008 AS l_partkey_and_l_suppkey_prf_1#4027, l_commitdate_prf#4009 AS l_commitdate_prf_1#4028, l_suppkey_prf#4010 AS l_suppkey_prf_1#4029, l_orderkey_prf#4011 AS l_orderkey_prf_1#4030]
            +- Relation[l_returnflag_prf#3993,l_orderkey_and_l_linenumber_prf#3994,l_comment_prf#3995,l_linestatus_prf#3996,rid#3997,l_shipmode_prf#3998,l_shipinstruct_prf#3999,l_quantity_prf#4000,l_receiptdate_prf#4001,l_linenumber_prf#4002,l_tax_prf#4003,l_shipdate_prf#4004,l_extendedprice_prf#4005,l_partkey_prf#4006,l_discount_prf#4007,l_partkey_and_l_suppkey_prf#4008,l_commitdate_prf#4009,l_suppkey_prf#4010,l_orderkey_prf#4011] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 199502ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/11 10:07:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:07:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4082L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 10:07:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4082L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1519) AS rid_2#4111]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#4094]
         :     :  :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#4089: string
         :     :  :     :- Project [rid#4084 AS rid_0#4089, n_regionkey_prf#4085 AS n_regionkey_prf_0#4090, n_nationkey_prf#4086 AS n_nationkey_prf_0#4091, n_name_prf#4087 AS n_name_prf_0#4092, n_comment_prf#4088 AS n_comment_prf_0#4093]
         :     :  :     :  +- Relation[rid#4084,n_regionkey_prf#4085,n_nationkey_prf#4086,n_name_prf#4087,n_comment_prf#4088] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#4095 AS s_phone_prf_1#4103, rid#4096 AS rid_1#4104, s_address_prf#4097 AS s_address_prf_1#4105, s_nationkey_prf#4098 AS s_nationkey_prf_1#4106, s_suppkey_prf#4099 AS s_suppkey_prf_1#4107, s_name_prf#4100 AS s_name_prf_1#4108, s_acctbal_prf#4101 AS s_acctbal_prf_1#4109, s_comment_prf#4102 AS s_comment_prf_1#4110]
         :     :     +- Relation[s_phone_prf#4095,rid#4096,s_address_prf#4097,s_nationkey_prf#4098,s_suppkey_prf#4099,s_name_prf#4100,s_acctbal_prf#4101,s_comment_prf#4102] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4112 AS c_acctbal_prf_2#4121, rid#4113 AS rid_2#4122, c_name_prf#4114 AS c_name_prf_2#4123, c_nationkey_prf#4115 AS c_nationkey_prf_2#4124, c_custkey_prf#4116 AS c_custkey_prf_2#4125, c_comment_prf#4117 AS c_comment_prf_2#4126, c_address_prf#4118 AS c_address_prf_2#4127, c_mktsegment_prf#4119 AS c_mktsegment_prf_2#4128, c_phone_prf#4120 AS c_phone_prf_2#4129]
            +- Relation[c_acctbal_prf#4112,rid#4113,c_name_prf#4114,c_nationkey_prf#4115,c_custkey_prf#4116,c_comment_prf#4117,c_address_prf#4118,c_mktsegment_prf#4119,c_phone_prf#4120] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 794587ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/11 10:21:07 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:21:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4188L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 10:21:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4188L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_2#4208]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4200: string
         :     :- Project [c_acctbal_prf#4190 AS c_acctbal_prf_0#4199, rid#4191 AS rid_0#4200, c_name_prf#4192 AS c_name_prf_0#4201, c_nationkey_prf#4193 AS c_nationkey_prf_0#4202, c_custkey_prf#4194 AS c_custkey_prf_0#4203, c_comment_prf#4195 AS c_comment_prf_0#4204, c_address_prf#4196 AS c_address_prf_0#4205, c_mktsegment_prf#4197 AS c_mktsegment_prf_0#4206, c_phone_prf#4198 AS c_phone_prf_0#4207]
         :     :  +- Relation[c_acctbal_prf#4190,rid#4191,c_name_prf#4192,c_nationkey_prf#4193,c_custkey_prf#4194,c_comment_prf#4195,c_address_prf#4196,c_mktsegment_prf#4197,c_phone_prf#4198] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1519) AS rid_2#4247]
            :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_1#4232: string
            :     :- Project [l_returnflag_prf#4209 AS l_returnflag_prf_1#4228, l_orderkey_and_l_linenumber_prf#4210 AS l_orderkey_and_l_linenumber_prf_1#4229, l_comment_prf#4211 AS l_comment_prf_1#4230, l_linestatus_prf#4212 AS l_linestatus_prf_1#4231, rid#4213 AS rid_1#4232, l_shipmode_prf#4214 AS l_shipmode_prf_1#4233, l_shipinstruct_prf#4215 AS l_shipinstruct_prf_1#4234, l_quantity_prf#4216 AS l_quantity_prf_1#4235, l_receiptdate_prf#4217 AS l_receiptdate_prf_1#4236, l_linenumber_prf#4218 AS l_linenumber_prf_1#4237, l_tax_prf#4219 AS l_tax_prf_1#4238, l_shipdate_prf#4220 AS l_shipdate_prf_1#4239, l_extendedprice_prf#4221 AS l_extendedprice_prf_1#4240, l_partkey_prf#4222 AS l_partkey_prf_1#4241, l_discount_prf#4223 AS l_discount_prf_1#4242, l_partkey_and_l_suppkey_prf#4224 AS l_partkey_and_l_suppkey_prf_1#4243, l_commitdate_prf#4225 AS l_commitdate_prf_1#4244, l_suppkey_prf#4226 AS l_suppkey_prf_1#4245, l_orderkey_prf#4227 AS l_orderkey_prf_1#4246]
            :     :  +- Relation[l_returnflag_prf#4209,l_orderkey_and_l_linenumber_prf#4210,l_comment_prf#4211,l_linestatus_prf#4212,rid#4213,l_shipmode_prf#4214,l_shipinstruct_prf#4215,l_quantity_prf#4216,l_receiptdate_prf#4217,l_linenumber_prf#4218,l_tax_prf#4219,l_shipdate_prf#4220,l_extendedprice_prf#4221,l_partkey_prf#4222,l_discount_prf#4223,l_partkey_and_l_suppkey_prf#4224,l_commitdate_prf#4225,l_suppkey_prf#4226,l_orderkey_prf#4227] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4248 AS o_shippriority_prf_2#4258, rid#4249 AS rid_2#4259, o_orderdate_prf#4250 AS o_orderdate_prf_2#4260, o_custkey_prf#4251 AS o_custkey_prf_2#4261, o_orderpriority_prf#4252 AS o_orderpriority_prf_2#4262, o_clerk_prf#4253 AS o_clerk_prf_2#4263, o_orderstatus_prf#4254 AS o_orderstatus_prf_2#4264, o_totalprice_prf#4255 AS o_totalprice_prf_2#4265, o_orderkey_prf#4256 AS o_orderkey_prf_2#4266, o_comment_prf#4257 AS o_comment_prf_2#4267]
               +- Relation[o_shippriority_prf#4248,rid#4249,o_orderdate_prf#4250,o_custkey_prf#4251,o_orderpriority_prf#4252,o_clerk_prf#4253,o_orderstatus_prf#4254,o_totalprice_prf#4255,o_orderkey_prf#4256,o_comment_prf#4257] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 175675ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/11 10:24:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:24:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4325L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 10:24:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4325L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#4327 AS l_returnflag_prf_0#4346, l_orderkey_and_l_linenumber_prf#4328 AS l_orderkey_and_l_linenumber_prf_0#4347, l_comment_prf#4329 AS l_comment_prf_0#4348, l_linestatus_prf#4330 AS l_linestatus_prf_0#4349, rid#4331 AS rid_0#4350, l_shipmode_prf#4332 AS l_shipmode_prf_0#4351, l_shipinstruct_prf#4333 AS l_shipinstruct_prf_0#4352, l_quantity_prf#4334 AS l_quantity_prf_0#4353, l_receiptdate_prf#4335 AS l_receiptdate_prf_0#4354, l_linenumber_prf#4336 AS l_linenumber_prf_0#4355, l_tax_prf#4337 AS l_tax_prf_0#4356, l_shipdate_prf#4338 AS l_shipdate_prf_0#4357, l_extendedprice_prf#4339 AS l_extendedprice_prf_0#4358, l_partkey_prf#4340 AS l_partkey_prf_0#4359, l_discount_prf#4341 AS l_discount_prf_0#4360, l_partkey_and_l_suppkey_prf#4342 AS l_partkey_and_l_suppkey_prf_0#4361, l_commitdate_prf#4343 AS l_commitdate_prf_0#4362, l_suppkey_prf#4344 AS l_suppkey_prf_0#4363, l_orderkey_prf#4345 AS l_orderkey_prf_0#4364]
         :  +- Relation[l_returnflag_prf#4327,l_orderkey_and_l_linenumber_prf#4328,l_comment_prf#4329,l_linestatus_prf#4330,rid#4331,l_shipmode_prf#4332,l_shipinstruct_prf#4333,l_quantity_prf#4334,l_receiptdate_prf#4335,l_linenumber_prf#4336,l_tax_prf#4337,l_shipdate_prf#4338,l_extendedprice_prf#4339,l_partkey_prf#4340,l_discount_prf#4341,l_partkey_and_l_suppkey_prf#4342,l_commitdate_prf#4343,l_suppkey_prf#4344,l_orderkey_prf#4345] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4365]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1627,value#1628] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 13874ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/11 10:24:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:24:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4413L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 10:24:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4413L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#4454]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4438: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#4415 AS l_returnflag_prf_0#4434, l_orderkey_and_l_linenumber_prf#4416 AS l_orderkey_and_l_linenumber_prf_0#4435, l_comment_prf#4417 AS l_comment_prf_0#4436, l_linestatus_prf#4418 AS l_linestatus_prf_0#4437, rid#4419 AS rid_0#4438, l_shipmode_prf#4420 AS l_shipmode_prf_0#4439, l_shipinstruct_prf#4421 AS l_shipinstruct_prf_0#4440, l_quantity_prf#4422 AS l_quantity_prf_0#4441, l_receiptdate_prf#4423 AS l_receiptdate_prf_0#4442, l_linenumber_prf#4424 AS l_linenumber_prf_0#4443, l_tax_prf#4425 AS l_tax_prf_0#4444, l_shipdate_prf#4426 AS l_shipdate_prf_0#4445, l_extendedprice_prf#4427 AS l_extendedprice_prf_0#4446, l_partkey_prf#4428 AS l_partkey_prf_0#4447, l_discount_prf#4429 AS l_discount_prf_0#4448, l_partkey_and_l_suppkey_prf#4430 AS l_partkey_and_l_suppkey_prf_0#4449, l_commitdate_prf#4431 AS l_commitdate_prf_0#4450, l_suppkey_prf#4432 AS l_suppkey_prf_0#4451, l_orderkey_prf#4433 AS l_orderkey_prf_0#4452]
         :     :  :  +- Relation[l_returnflag_prf#4415,l_orderkey_and_l_linenumber_prf#4416,l_comment_prf#4417,l_linestatus_prf#4418,rid#4419,l_shipmode_prf#4420,l_shipinstruct_prf#4421,l_quantity_prf#4422,l_receiptdate_prf#4423,l_linenumber_prf#4424,l_tax_prf#4425,l_shipdate_prf#4426,l_extendedprice_prf#4427,l_partkey_prf#4428,l_discount_prf#4429,l_partkey_and_l_suppkey_prf#4430,l_commitdate_prf#4431,l_suppkey_prf#4432,l_orderkey_prf#4433] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4453]
         :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :        +- Relation[label#1627,value#1628] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4455 AS o_shippriority_prf_1#4465, rid#4456 AS rid_1#4466, o_orderdate_prf#4457 AS o_orderdate_prf_1#4467, o_custkey_prf#4458 AS o_custkey_prf_1#4468, o_orderpriority_prf#4459 AS o_orderpriority_prf_1#4469, o_clerk_prf#4460 AS o_clerk_prf_1#4470, o_orderstatus_prf#4461 AS o_orderstatus_prf_1#4471, o_totalprice_prf#4462 AS o_totalprice_prf_1#4472, o_orderkey_prf#4463 AS o_orderkey_prf_1#4473, o_comment_prf#4464 AS o_comment_prf_1#4474]
            +- Relation[o_shippriority_prf#4455,rid#4456,o_orderdate_prf#4457,o_custkey_prf#4458,o_orderpriority_prf#4459,o_clerk_prf#4460,o_orderstatus_prf#4461,o_totalprice_prf#4462,o_orderkey_prf#4463,o_comment_prf#4464] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 57337ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/11 10:25:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:25:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4526L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 10:25:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4526L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_2#4546]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#4538: string
         :     :- Project [c_acctbal_prf#4528 AS c_acctbal_prf_0#4537, rid#4529 AS rid_0#4538, c_name_prf#4530 AS c_name_prf_0#4539, c_nationkey_prf#4531 AS c_nationkey_prf_0#4540, c_custkey_prf#4532 AS c_custkey_prf_0#4541, c_comment_prf#4533 AS c_comment_prf_0#4542, c_address_prf#4534 AS c_address_prf_0#4543, c_mktsegment_prf#4535 AS c_mktsegment_prf_0#4544, c_phone_prf#4536 AS c_phone_prf_0#4545]
         :     :  +- Relation[c_acctbal_prf#4528,rid#4529,c_name_prf#4530,c_nationkey_prf#4531,c_custkey_prf#4532,c_comment_prf#4533,c_address_prf#4534,c_mktsegment_prf#4535,c_phone_prf#4536] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1519) AS rid_2#4563]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#4556: string
            :     :- Project [s_phone_prf#4547 AS s_phone_prf_1#4555, rid#4548 AS rid_1#4556, s_address_prf#4549 AS s_address_prf_1#4557, s_nationkey_prf#4550 AS s_nationkey_prf_1#4558, s_suppkey_prf#4551 AS s_suppkey_prf_1#4559, s_name_prf#4552 AS s_name_prf_1#4560, s_acctbal_prf#4553 AS s_acctbal_prf_1#4561, s_comment_prf#4554 AS s_comment_prf_1#4562]
            :     :  +- Relation[s_phone_prf#4547,rid#4548,s_address_prf#4549,s_nationkey_prf#4550,s_suppkey_prf#4551,s_name_prf#4552,s_acctbal_prf#4553,s_comment_prf#4554] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [rid#4564 AS rid_2#4569, n_regionkey_prf#4565 AS n_regionkey_prf_2#4570, n_nationkey_prf#4566 AS n_nationkey_prf_2#4571, n_name_prf#4567 AS n_name_prf_2#4572, n_comment_prf#4568 AS n_comment_prf_2#4573]
               +- Relation[rid#4564,n_regionkey_prf#4565,n_nationkey_prf#4566,n_name_prf#4567,n_comment_prf#4568] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 56136ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/11 10:26:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:26:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4620L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 10:26:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4620L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1519) AS rid_2#4657]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#4636]
         :     :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#4630: string
         :     :  :     :- Project [ps_partkey_and_ps_suppkey_prf#4622 AS ps_partkey_and_ps_suppkey_prf_0#4629, rid#4623 AS rid_0#4630, ps_availqty_prf#4624 AS ps_availqty_prf_0#4631, ps_comment_prf#4625 AS ps_comment_prf_0#4632, ps_partkey_prf#4626 AS ps_partkey_prf_0#4633, ps_supplycost_prf#4627 AS ps_supplycost_prf_0#4634, ps_suppkey_prf#4628 AS ps_suppkey_prf_0#4635]
         :     :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#4622,rid#4623,ps_availqty_prf#4624,ps_comment_prf#4625,ps_partkey_prf#4626,ps_supplycost_prf#4627,ps_suppkey_prf#4628] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#4637 AS p_comment_prf_1#4647, p_name_prf#4638 AS p_name_prf_1#4648, rid#4639 AS rid_1#4649, p_type_prf#4640 AS p_type_prf_1#4650, p_retailprice_prf#4641 AS p_retailprice_prf_1#4651, p_mfgr_prf#4642 AS p_mfgr_prf_1#4652, p_container_prf#4643 AS p_container_prf_1#4653, p_brand_prf#4644 AS p_brand_prf_1#4654, p_size_prf#4645 AS p_size_prf_1#4655, p_partkey_prf#4646 AS p_partkey_prf_1#4656]
         :     :     +- Relation[p_comment_prf#4637,p_name_prf#4638,rid#4639,p_type_prf#4640,p_retailprice_prf#4641,p_mfgr_prf#4642,p_container_prf#4643,p_brand_prf#4644,p_size_prf#4645,p_partkey_prf#4646] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4658 AS s_phone_prf_2#4666, rid#4659 AS rid_2#4667, s_address_prf#4660 AS s_address_prf_2#4668, s_nationkey_prf#4661 AS s_nationkey_prf_2#4669, s_suppkey_prf#4662 AS s_suppkey_prf_2#4670, s_name_prf#4663 AS s_name_prf_2#4671, s_acctbal_prf#4664 AS s_acctbal_prf_2#4672, s_comment_prf#4665 AS s_comment_prf_2#4673]
            +- Relation[s_phone_prf#4658,rid#4659,s_address_prf#4660,s_nationkey_prf#4661,s_suppkey_prf#4662,s_name_prf#4663,s_acctbal_prf#4664,s_comment_prf#4665] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 109681ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/11 10:27:59 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:27:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4719L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 10:27:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4719L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#4739]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4731: string
         :     :- Project [c_acctbal_prf#4721 AS c_acctbal_prf_0#4730, rid#4722 AS rid_0#4731, c_name_prf#4723 AS c_name_prf_0#4732, c_nationkey_prf#4724 AS c_nationkey_prf_0#4733, c_custkey_prf#4725 AS c_custkey_prf_0#4734, c_comment_prf#4726 AS c_comment_prf_0#4735, c_address_prf#4727 AS c_address_prf_0#4736, c_mktsegment_prf#4728 AS c_mktsegment_prf_0#4737, c_phone_prf#4729 AS c_phone_prf_0#4738]
         :     :  +- Relation[c_acctbal_prf#4721,rid#4722,c_name_prf#4723,c_nationkey_prf#4724,c_custkey_prf#4725,c_comment_prf#4726,c_address_prf#4727,c_mktsegment_prf#4728,c_phone_prf#4729] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4740 AS o_shippriority_prf_1#4750, rid#4741 AS rid_1#4751, o_orderdate_prf#4742 AS o_orderdate_prf_1#4752, o_custkey_prf#4743 AS o_custkey_prf_1#4753, o_orderpriority_prf#4744 AS o_orderpriority_prf_1#4754, o_clerk_prf#4745 AS o_clerk_prf_1#4755, o_orderstatus_prf#4746 AS o_orderstatus_prf_1#4756, o_totalprice_prf#4747 AS o_totalprice_prf_1#4757, o_orderkey_prf#4748 AS o_orderkey_prf_1#4758, o_comment_prf#4749 AS o_comment_prf_1#4759]
            +- Relation[o_shippriority_prf#4740,rid#4741,o_orderdate_prf#4742,o_custkey_prf#4743,o_orderpriority_prf#4744,o_clerk_prf#4745,o_orderstatus_prf#4746,o_totalprice_prf#4747,o_orderkey_prf#4748,o_comment_prf#4749] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1500000
Elapsed time: 40871ms

f2=
select * from part where p_size = 15
19/10/11 10:28:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:28:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4791L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 10:28:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4791L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#4793 AS p_comment_prf_0#4803, p_name_prf#4794 AS p_name_prf_0#4804, rid#4795 AS rid_0#4805, p_type_prf#4796 AS p_type_prf_0#4806, p_retailprice_prf#4797 AS p_retailprice_prf_0#4807, p_mfgr_prf#4798 AS p_mfgr_prf_0#4808, p_container_prf#4799 AS p_container_prf_0#4809, p_brand_prf#4800 AS p_brand_prf_0#4810, p_size_prf#4801 AS p_size_prf_0#4811, p_partkey_prf#4802 AS p_partkey_prf_0#4812]
         :  +- Relation[p_comment_prf#4793,p_name_prf#4794,rid#4795,p_type_prf#4796,p_retailprice_prf#4797,p_mfgr_prf#4798,p_container_prf#4799,p_brand_prf#4800,p_size_prf#4801,p_partkey_prf#4802] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4813]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1627,value#1628] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3907
Elapsed time: 121ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/11 10:28:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:28:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4860L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 10:28:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4860L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#4900]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4885: string
         :     :- Project [l_returnflag_prf#4862 AS l_returnflag_prf_0#4881, l_orderkey_and_l_linenumber_prf#4863 AS l_orderkey_and_l_linenumber_prf_0#4882, l_comment_prf#4864 AS l_comment_prf_0#4883, l_linestatus_prf#4865 AS l_linestatus_prf_0#4884, rid#4866 AS rid_0#4885, l_shipmode_prf#4867 AS l_shipmode_prf_0#4886, l_shipinstruct_prf#4868 AS l_shipinstruct_prf_0#4887, l_quantity_prf#4869 AS l_quantity_prf_0#4888, l_receiptdate_prf#4870 AS l_receiptdate_prf_0#4889, l_linenumber_prf#4871 AS l_linenumber_prf_0#4890, l_tax_prf#4872 AS l_tax_prf_0#4891, l_shipdate_prf#4873 AS l_shipdate_prf_0#4892, l_extendedprice_prf#4874 AS l_extendedprice_prf_0#4893, l_partkey_prf#4875 AS l_partkey_prf_0#4894, l_discount_prf#4876 AS l_discount_prf_0#4895, l_partkey_and_l_suppkey_prf#4877 AS l_partkey_and_l_suppkey_prf_0#4896, l_commitdate_prf#4878 AS l_commitdate_prf_0#4897, l_suppkey_prf#4879 AS l_suppkey_prf_0#4898, l_orderkey_prf#4880 AS l_orderkey_prf_0#4899]
         :     :  +- Relation[l_returnflag_prf#4862,l_orderkey_and_l_linenumber_prf#4863,l_comment_prf#4864,l_linestatus_prf#4865,rid#4866,l_shipmode_prf#4867,l_shipinstruct_prf#4868,l_quantity_prf#4869,l_receiptdate_prf#4870,l_linenumber_prf#4871,l_tax_prf#4872,l_shipdate_prf#4873,l_extendedprice_prf#4874,l_partkey_prf#4875,l_discount_prf#4876,l_partkey_and_l_suppkey_prf#4877,l_commitdate_prf#4878,l_suppkey_prf#4879,l_orderkey_prf#4880] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1519) AS rid_2#4921]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#4912: string
            :     :- Project [o_shippriority_prf#4901 AS o_shippriority_prf_1#4911, rid#4902 AS rid_1#4912, o_orderdate_prf#4903 AS o_orderdate_prf_1#4913, o_custkey_prf#4904 AS o_custkey_prf_1#4914, o_orderpriority_prf#4905 AS o_orderpriority_prf_1#4915, o_clerk_prf#4906 AS o_clerk_prf_1#4916, o_orderstatus_prf#4907 AS o_orderstatus_prf_1#4917, o_totalprice_prf#4908 AS o_totalprice_prf_1#4918, o_orderkey_prf#4909 AS o_orderkey_prf_1#4919, o_comment_prf#4910 AS o_comment_prf_1#4920]
            :     :  +- Relation[o_shippriority_prf#4901,rid#4902,o_orderdate_prf#4903,o_custkey_prf#4904,o_orderpriority_prf#4905,o_clerk_prf#4906,o_orderstatus_prf#4907,o_totalprice_prf#4908,o_orderkey_prf#4909,o_comment_prf#4910] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4922 AS c_acctbal_prf_2#4931, rid#4923 AS rid_2#4932, c_name_prf#4924 AS c_name_prf_2#4933, c_nationkey_prf#4925 AS c_nationkey_prf_2#4934, c_custkey_prf#4926 AS c_custkey_prf_2#4935, c_comment_prf#4927 AS c_comment_prf_2#4936, c_address_prf#4928 AS c_address_prf_2#4937, c_mktsegment_prf#4929 AS c_mktsegment_prf_2#4938, c_phone_prf#4930 AS c_phone_prf_2#4939]
               +- Relation[c_acctbal_prf#4922,rid#4923,c_name_prf#4924,c_nationkey_prf#4925,c_custkey_prf#4926,c_comment_prf#4927,c_address_prf#4928,c_mktsegment_prf#4929,c_phone_prf#4930] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 167983ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/11 10:31:28 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:31:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5014L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 10:31:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5014L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1519) AS rid_2#5055]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#5034]
         :     :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#5026: string
         :     :  :     :- Project [c_acctbal_prf#5016 AS c_acctbal_prf_0#5025, rid#5017 AS rid_0#5026, c_name_prf#5018 AS c_name_prf_0#5027, c_nationkey_prf#5019 AS c_nationkey_prf_0#5028, c_custkey_prf#5020 AS c_custkey_prf_0#5029, c_comment_prf#5021 AS c_comment_prf_0#5030, c_address_prf#5022 AS c_address_prf_0#5031, c_mktsegment_prf#5023 AS c_mktsegment_prf_0#5032, c_phone_prf#5024 AS c_phone_prf_0#5033]
         :     :  :     :  +- Relation[c_acctbal_prf#5016,rid#5017,c_name_prf#5018,c_nationkey_prf#5019,c_custkey_prf#5020,c_comment_prf#5021,c_address_prf#5022,c_mktsegment_prf#5023,c_phone_prf#5024] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#5035 AS o_shippriority_prf_1#5045, rid#5036 AS rid_1#5046, o_orderdate_prf#5037 AS o_orderdate_prf_1#5047, o_custkey_prf#5038 AS o_custkey_prf_1#5048, o_orderpriority_prf#5039 AS o_orderpriority_prf_1#5049, o_clerk_prf#5040 AS o_clerk_prf_1#5050, o_orderstatus_prf#5041 AS o_orderstatus_prf_1#5051, o_totalprice_prf#5042 AS o_totalprice_prf_1#5052, o_orderkey_prf#5043 AS o_orderkey_prf_1#5053, o_comment_prf#5044 AS o_comment_prf_1#5054]
         :     :     +- Relation[o_shippriority_prf#5035,rid#5036,o_orderdate_prf#5037,o_custkey_prf#5038,o_orderpriority_prf#5039,o_clerk_prf#5040,o_orderstatus_prf#5041,o_totalprice_prf#5042,o_orderkey_prf#5043,o_comment_prf#5044] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5056 AS l_returnflag_prf_2#5075, l_orderkey_and_l_linenumber_prf#5057 AS l_orderkey_and_l_linenumber_prf_2#5076, l_comment_prf#5058 AS l_comment_prf_2#5077, l_linestatus_prf#5059 AS l_linestatus_prf_2#5078, rid#5060 AS rid_2#5079, l_shipmode_prf#5061 AS l_shipmode_prf_2#5080, l_shipinstruct_prf#5062 AS l_shipinstruct_prf_2#5081, l_quantity_prf#5063 AS l_quantity_prf_2#5082, l_receiptdate_prf#5064 AS l_receiptdate_prf_2#5083, l_linenumber_prf#5065 AS l_linenumber_prf_2#5084, l_tax_prf#5066 AS l_tax_prf_2#5085, l_shipdate_prf#5067 AS l_shipdate_prf_2#5086, l_extendedprice_prf#5068 AS l_extendedprice_prf_2#5087, l_partkey_prf#5069 AS l_partkey_prf_2#5088, l_discount_prf#5070 AS l_discount_prf_2#5089, l_partkey_and_l_suppkey_prf#5071 AS l_partkey_and_l_suppkey_prf_2#5090, l_commitdate_prf#5072 AS l_commitdate_prf_2#5091, l_suppkey_prf#5073 AS l_suppkey_prf_2#5092, l_orderkey_prf#5074 AS l_orderkey_prf_2#5093]
            +- Relation[l_returnflag_prf#5056,l_orderkey_and_l_linenumber_prf#5057,l_comment_prf#5058,l_linestatus_prf#5059,rid#5060,l_shipmode_prf#5061,l_shipinstruct_prf#5062,l_quantity_prf#5063,l_receiptdate_prf#5064,l_linenumber_prf#5065,l_tax_prf#5066,l_shipdate_prf#5067,l_extendedprice_prf#5068,l_partkey_prf#5069,l_discount_prf#5070,l_partkey_and_l_suppkey_prf#5071,l_commitdate_prf#5072,l_suppkey_prf#5073,l_orderkey_prf#5074] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 186999ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/11 10:34:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:34:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5139L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 10:34:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5139L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#5141 AS rid_0#5146, n_regionkey_prf#5142 AS n_regionkey_prf_0#5147, n_nationkey_prf#5143 AS n_nationkey_prf_0#5148, n_name_prf#5144 AS n_name_prf_0#5149, n_comment_prf#5145 AS n_comment_prf_0#5150]
         :  +- Relation[rid#5141,n_regionkey_prf#5142,n_nationkey_prf#5143,n_name_prf#5144,n_comment_prf#5145] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5151]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1627,value#1628] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 57ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/11 10:34:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:34:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5192L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 10:34:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5192L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#5214]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#5206: string
         :     :  :     :- Project [p_comment_prf#5194 AS p_comment_prf_0#5204, p_name_prf#5195 AS p_name_prf_0#5205, rid#5196 AS rid_0#5206, p_type_prf#5197 AS p_type_prf_0#5207, p_retailprice_prf#5198 AS p_retailprice_prf_0#5208, p_mfgr_prf#5199 AS p_mfgr_prf_0#5209, p_container_prf#5200 AS p_container_prf_0#5210, p_brand_prf#5201 AS p_brand_prf_0#5211, p_size_prf#5202 AS p_size_prf_0#5212, p_partkey_prf#5203 AS p_partkey_prf_0#5213]
         :     :  :     :  +- Relation[p_comment_prf#5194,p_name_prf#5195,rid#5196,p_type_prf#5197,p_retailprice_prf#5198,p_mfgr_prf#5199,p_container_prf#5200,p_brand_prf#5201,p_size_prf#5202,p_partkey_prf#5203] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#5215 AS l_returnflag_prf_1#5234, l_orderkey_and_l_linenumber_prf#5216 AS l_orderkey_and_l_linenumber_prf_1#5235, l_comment_prf#5217 AS l_comment_prf_1#5236, l_linestatus_prf#5218 AS l_linestatus_prf_1#5237, rid#5219 AS rid_1#5238, l_shipmode_prf#5220 AS l_shipmode_prf_1#5239, l_shipinstruct_prf#5221 AS l_shipinstruct_prf_1#5240, l_quantity_prf#5222 AS l_quantity_prf_1#5241, l_receiptdate_prf#5223 AS l_receiptdate_prf_1#5242, l_linenumber_prf#5224 AS l_linenumber_prf_1#5243, l_tax_prf#5225 AS l_tax_prf_1#5244, l_shipdate_prf#5226 AS l_shipdate_prf_1#5245, l_extendedprice_prf#5227 AS l_extendedprice_prf_1#5246, l_partkey_prf#5228 AS l_partkey_prf_1#5247, l_discount_prf#5229 AS l_discount_prf_1#5248, l_partkey_and_l_suppkey_prf#5230 AS l_partkey_and_l_suppkey_prf_1#5249, l_commitdate_prf#5231 AS l_commitdate_prf_1#5250, l_suppkey_prf#5232 AS l_suppkey_prf_1#5251, l_orderkey_prf#5233 AS l_orderkey_prf_1#5252]
         :     :     +- Relation[l_returnflag_prf#5215,l_orderkey_and_l_linenumber_prf#5216,l_comment_prf#5217,l_linestatus_prf#5218,rid#5219,l_shipmode_prf#5220,l_shipinstruct_prf#5221,l_quantity_prf#5222,l_receiptdate_prf#5223,l_linenumber_prf#5224,l_tax_prf#5225,l_shipdate_prf#5226,l_extendedprice_prf#5227,l_partkey_prf#5228,l_discount_prf#5229,l_partkey_and_l_suppkey_prf#5230,l_commitdate_prf#5231,l_suppkey_prf#5232,l_orderkey_prf#5233] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5254 AS s_phone_prf_2#5262, rid#5255 AS rid_2#5263, s_address_prf#5256 AS s_address_prf_2#5264, s_nationkey_prf#5257 AS s_nationkey_prf_2#5265, s_suppkey_prf#5258 AS s_suppkey_prf_2#5266, s_name_prf#5259 AS s_name_prf_2#5267, s_acctbal_prf#5260 AS s_acctbal_prf_2#5268, s_comment_prf#5261 AS s_comment_prf_2#5269]
            +- Relation[s_phone_prf#5254,rid#5255,s_address_prf#5256,s_nationkey_prf#5257,s_suppkey_prf#5258,s_name_prf#5259,s_acctbal_prf#5260,s_comment_prf#5261] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 313513ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/11 10:39:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:39:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5333L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 10:39:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5333L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1519) AS rid_1#5351]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#5344: string
         :     :- Project [s_phone_prf#5335 AS s_phone_prf_0#5343, rid#5336 AS rid_0#5344, s_address_prf#5337 AS s_address_prf_0#5345, s_nationkey_prf#5338 AS s_nationkey_prf_0#5346, s_suppkey_prf#5339 AS s_suppkey_prf_0#5347, s_name_prf#5340 AS s_name_prf_0#5348, s_acctbal_prf#5341 AS s_acctbal_prf_0#5349, s_comment_prf#5342 AS s_comment_prf_0#5350]
         :     :  +- Relation[s_phone_prf#5335,rid#5336,s_address_prf#5337,s_nationkey_prf#5338,s_suppkey_prf#5339,s_name_prf#5340,s_acctbal_prf#5341,s_comment_prf#5342] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1518,value#1519] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5352 AS l_returnflag_prf_1#5371, l_orderkey_and_l_linenumber_prf#5353 AS l_orderkey_and_l_linenumber_prf_1#5372, l_comment_prf#5354 AS l_comment_prf_1#5373, l_linestatus_prf#5355 AS l_linestatus_prf_1#5374, rid#5356 AS rid_1#5375, l_shipmode_prf#5357 AS l_shipmode_prf_1#5376, l_shipinstruct_prf#5358 AS l_shipinstruct_prf_1#5377, l_quantity_prf#5359 AS l_quantity_prf_1#5378, l_receiptdate_prf#5360 AS l_receiptdate_prf_1#5379, l_linenumber_prf#5361 AS l_linenumber_prf_1#5380, l_tax_prf#5362 AS l_tax_prf_1#5381, l_shipdate_prf#5363 AS l_shipdate_prf_1#5382, l_extendedprice_prf#5364 AS l_extendedprice_prf_1#5383, l_partkey_prf#5365 AS l_partkey_prf_1#5384, l_discount_prf#5366 AS l_discount_prf_1#5385, l_partkey_and_l_suppkey_prf#5367 AS l_partkey_and_l_suppkey_prf_1#5386, l_commitdate_prf#5368 AS l_commitdate_prf_1#5387, l_suppkey_prf#5369 AS l_suppkey_prf_1#5388, l_orderkey_prf#5370 AS l_orderkey_prf_1#5389]
            +- Relation[l_returnflag_prf#5352,l_orderkey_and_l_linenumber_prf#5353,l_comment_prf#5354,l_linestatus_prf#5355,rid#5356,l_shipmode_prf#5357,l_shipinstruct_prf#5358,l_quantity_prf#5359,l_receiptdate_prf#5360,l_linenumber_prf#5361,l_tax_prf#5362,l_shipdate_prf#5363,l_extendedprice_prf#5364,l_partkey_prf#5365,l_discount_prf#5366,l_partkey_and_l_suppkey_prf#5367,l_commitdate_prf#5368,l_suppkey_prf#5369,l_orderkey_prf#5370] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 88628ms
query=b1a, count=15628, duration=443
query=b1b, count=15628, duration=50547
query=b2a, count=1478870, duration=201439
query=b2b, count=1478870, duration=57337
query=f1, count=1, duration=51
query=f2, count=3907, duration=121
query=f3, count=1451, duration=84
query=f4, count=1, duration=57
query=f5, count=1478870, duration=23834
query=f6, count=857401, duration=13874
query=j1, count=800000, duration=32085
query=j10, count=6001215, duration=88628
query=j2, count=800000, duration=11320
query=j3, count=25, duration=69
query=j4, count=150000, duration=1952
query=j5, count=10000, duration=195
query=j6, count=6001215, duration=118021
query=j7, count=1500000, duration=40871
query=j8, count=6001215, duration=199502
query=j8b, count=6001215, duration=131337
query=j9, count=6001215, duration=96109
query=j9b, count=6001215, duration=129788
query=r1a, count=6001215, duration=343868
query=r1b, count=6001215, duration=167983
query=r1c, count=6001215, duration=175576
query=r1d, count=6001215, duration=186999
query=r1e, count=6001215, duration=238596
query=r1f, count=6001215, duration=175675
query=t1a, count=60000414, duration=680675
query=t1b, count=60000414, duration=794587
query=t1c, count=60000414, duration=56136
query=t2a, count=800000, duration=109681
query=t2b, count=800000, duration=94918
query=t2c, count=800000, duration=43701
query=t2d, count=800000, duration=62512
query=t3a, count=6001215, duration=294309
query=t3b, count=6001215, duration=313513
query=t3c, count=6001215, duration=191373
query=t3d, count=6001215, duration=201025
