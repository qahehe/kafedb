19/10/11 10:41:19 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7238ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Fri Oct 11 10:41:21 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Fri Oct 11 10:41:22 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Fri Oct 11 10:41:22 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Fri Oct 11 10:41:22 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Fri Oct 11 10:41:22 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Fri Oct 11 10:41:25 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Fri Oct 11 10:41:27 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Fri Oct 11 10:41:27 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/11 10:41:28 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:41:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1503L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 10:41:28 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
19/10/11 10:41:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1503L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#1545]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#1528: string
         :     :  :     :- Project [l_returnflag_prf#1505 AS l_returnflag_prf_0#1524, l_orderkey_and_l_linenumber_prf#1506 AS l_orderkey_and_l_linenumber_prf_0#1525, l_comment_prf#1507 AS l_comment_prf_0#1526, l_linestatus_prf#1508 AS l_linestatus_prf_0#1527, rid#1509 AS rid_0#1528, l_shipmode_prf#1510 AS l_shipmode_prf_0#1529, l_shipinstruct_prf#1511 AS l_shipinstruct_prf_0#1530, l_quantity_prf#1512 AS l_quantity_prf_0#1531, l_receiptdate_prf#1513 AS l_receiptdate_prf_0#1532, l_linenumber_prf#1514 AS l_linenumber_prf_0#1533, l_tax_prf#1515 AS l_tax_prf_0#1534, l_shipdate_prf#1516 AS l_shipdate_prf_0#1535, l_extendedprice_prf#1517 AS l_extendedprice_prf_0#1536, l_partkey_prf#1518 AS l_partkey_prf_0#1537, l_discount_prf#1519 AS l_discount_prf_0#1538, l_partkey_and_l_suppkey_prf#1520 AS l_partkey_and_l_suppkey_prf_0#1539, l_commitdate_prf#1521 AS l_commitdate_prf_0#1540, l_suppkey_prf#1522 AS l_suppkey_prf_0#1541, l_orderkey_prf#1523 AS l_orderkey_prf_0#1542]
         :     :  :     :  +- Relation[l_returnflag_prf#1505,l_orderkey_and_l_linenumber_prf#1506,l_comment_prf#1507,l_linestatus_prf#1508,rid#1509,l_shipmode_prf#1510,l_shipinstruct_prf#1511,l_quantity_prf#1512,l_receiptdate_prf#1513,l_linenumber_prf#1514,l_tax_prf#1515,l_shipdate_prf#1516,l_extendedprice_prf#1517,l_partkey_prf#1518,l_discount_prf#1519,l_partkey_and_l_suppkey_prf#1520,l_commitdate_prf#1521,l_suppkey_prf#1522,l_orderkey_prf#1523] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#1546 AS p_comment_prf_1#1556, p_name_prf#1547 AS p_name_prf_1#1557, rid#1548 AS rid_1#1558, p_type_prf#1549 AS p_type_prf_1#1559, p_retailprice_prf#1550 AS p_retailprice_prf_1#1560, p_mfgr_prf#1551 AS p_mfgr_prf_1#1561, p_container_prf#1552 AS p_container_prf_1#1562, p_brand_prf#1553 AS p_brand_prf_1#1563, p_size_prf#1554 AS p_size_prf_1#1564, p_partkey_prf#1555 AS p_partkey_prf_1#1565]
         :     :     +- Relation[p_comment_prf#1546,p_name_prf#1547,rid#1548,p_type_prf#1549,p_retailprice_prf#1550,p_mfgr_prf#1551,p_container_prf#1552,p_brand_prf#1553,p_size_prf#1554,p_partkey_prf#1555] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#1567 AS s_phone_prf_2#1575, rid#1568 AS rid_2#1576, s_address_prf#1569 AS s_address_prf_2#1577, s_nationkey_prf#1570 AS s_nationkey_prf_2#1578, s_suppkey_prf#1571 AS s_suppkey_prf_2#1579, s_name_prf#1572 AS s_name_prf_2#1580, s_acctbal_prf#1573 AS s_acctbal_prf_2#1581, s_comment_prf#1574 AS s_comment_prf_2#1582]
            +- Relation[s_phone_prf#1567,rid#1568,s_address_prf#1569,s_nationkey_prf#1570,s_suppkey_prf#1571,s_name_prf#1572,s_acctbal_prf#1573,s_comment_prf#1574] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 295120ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/11 10:46:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:46:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1656L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 10:46:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1656L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_2#1676]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#1668: string
         :     :- Project [c_acctbal_prf#1658 AS c_acctbal_prf_0#1667, rid#1659 AS rid_0#1668, c_name_prf#1660 AS c_name_prf_0#1669, c_nationkey_prf#1661 AS c_nationkey_prf_0#1670, c_custkey_prf#1662 AS c_custkey_prf_0#1671, c_comment_prf#1663 AS c_comment_prf_0#1672, c_address_prf#1664 AS c_address_prf_0#1673, c_mktsegment_prf#1665 AS c_mktsegment_prf_0#1674, c_phone_prf#1666 AS c_phone_prf_0#1675]
         :     :  +- Relation[c_acctbal_prf#1658,rid#1659,c_name_prf#1660,c_nationkey_prf#1661,c_custkey_prf#1662,c_comment_prf#1663,c_address_prf#1664,c_mktsegment_prf#1665,c_phone_prf#1666] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1544) AS rid_2#1715]
            :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_1#1700: string
            :     :- Project [l_returnflag_prf#1677 AS l_returnflag_prf_1#1696, l_orderkey_and_l_linenumber_prf#1678 AS l_orderkey_and_l_linenumber_prf_1#1697, l_comment_prf#1679 AS l_comment_prf_1#1698, l_linestatus_prf#1680 AS l_linestatus_prf_1#1699, rid#1681 AS rid_1#1700, l_shipmode_prf#1682 AS l_shipmode_prf_1#1701, l_shipinstruct_prf#1683 AS l_shipinstruct_prf_1#1702, l_quantity_prf#1684 AS l_quantity_prf_1#1703, l_receiptdate_prf#1685 AS l_receiptdate_prf_1#1704, l_linenumber_prf#1686 AS l_linenumber_prf_1#1705, l_tax_prf#1687 AS l_tax_prf_1#1706, l_shipdate_prf#1688 AS l_shipdate_prf_1#1707, l_extendedprice_prf#1689 AS l_extendedprice_prf_1#1708, l_partkey_prf#1690 AS l_partkey_prf_1#1709, l_discount_prf#1691 AS l_discount_prf_1#1710, l_partkey_and_l_suppkey_prf#1692 AS l_partkey_and_l_suppkey_prf_1#1711, l_commitdate_prf#1693 AS l_commitdate_prf_1#1712, l_suppkey_prf#1694 AS l_suppkey_prf_1#1713, l_orderkey_prf#1695 AS l_orderkey_prf_1#1714]
            :     :  +- Relation[l_returnflag_prf#1677,l_orderkey_and_l_linenumber_prf#1678,l_comment_prf#1679,l_linestatus_prf#1680,rid#1681,l_shipmode_prf#1682,l_shipinstruct_prf#1683,l_quantity_prf#1684,l_receiptdate_prf#1685,l_linenumber_prf#1686,l_tax_prf#1687,l_shipdate_prf#1688,l_extendedprice_prf#1689,l_partkey_prf#1690,l_discount_prf#1691,l_partkey_and_l_suppkey_prf#1692,l_commitdate_prf#1693,l_suppkey_prf#1694,l_orderkey_prf#1695] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#1716 AS o_shippriority_prf_2#1726, rid#1717 AS rid_2#1727, o_orderdate_prf#1718 AS o_orderdate_prf_2#1728, o_custkey_prf#1719 AS o_custkey_prf_2#1729, o_orderpriority_prf#1720 AS o_orderpriority_prf_2#1730, o_clerk_prf#1721 AS o_clerk_prf_2#1731, o_orderstatus_prf#1722 AS o_orderstatus_prf_2#1732, o_totalprice_prf#1723 AS o_totalprice_prf_2#1733, o_orderkey_prf#1724 AS o_orderkey_prf_2#1734, o_comment_prf#1725 AS o_comment_prf_2#1735]
               +- Relation[o_shippriority_prf#1716,rid#1717,o_orderdate_prf#1718,o_custkey_prf#1719,o_orderpriority_prf#1720,o_clerk_prf#1721,o_orderstatus_prf#1722,o_totalprice_prf#1723,o_orderkey_prf#1724,o_comment_prf#1725] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 176143ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/11 10:49:19 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:49:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1798L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 10:49:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1798L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#1814]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, rid_0#1808: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#1800 AS ps_partkey_and_ps_suppkey_prf_0#1807, rid#1801 AS rid_0#1808, ps_availqty_prf#1802 AS ps_availqty_prf_0#1809, ps_comment_prf#1803 AS ps_comment_prf_0#1810, ps_partkey_prf#1804 AS ps_partkey_prf_0#1811, ps_supplycost_prf#1805 AS ps_supplycost_prf_0#1812, ps_suppkey_prf#1806 AS ps_suppkey_prf_0#1813]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#1800,rid#1801,ps_availqty_prf#1802,ps_comment_prf#1803,ps_partkey_prf#1804,ps_supplycost_prf#1805,ps_suppkey_prf#1806] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1815 AS l_returnflag_prf_1#1834, l_orderkey_and_l_linenumber_prf#1816 AS l_orderkey_and_l_linenumber_prf_1#1835, l_comment_prf#1817 AS l_comment_prf_1#1836, l_linestatus_prf#1818 AS l_linestatus_prf_1#1837, rid#1819 AS rid_1#1838, l_shipmode_prf#1820 AS l_shipmode_prf_1#1839, l_shipinstruct_prf#1821 AS l_shipinstruct_prf_1#1840, l_quantity_prf#1822 AS l_quantity_prf_1#1841, l_receiptdate_prf#1823 AS l_receiptdate_prf_1#1842, l_linenumber_prf#1824 AS l_linenumber_prf_1#1843, l_tax_prf#1825 AS l_tax_prf_1#1844, l_shipdate_prf#1826 AS l_shipdate_prf_1#1845, l_extendedprice_prf#1827 AS l_extendedprice_prf_1#1846, l_partkey_prf#1828 AS l_partkey_prf_1#1847, l_discount_prf#1829 AS l_discount_prf_1#1848, l_partkey_and_l_suppkey_prf#1830 AS l_partkey_and_l_suppkey_prf_1#1849, l_commitdate_prf#1831 AS l_commitdate_prf_1#1850, l_suppkey_prf#1832 AS l_suppkey_prf_1#1851, l_orderkey_prf#1833 AS l_orderkey_prf_1#1852]
            +- Relation[l_returnflag_prf#1815,l_orderkey_and_l_linenumber_prf#1816,l_comment_prf#1817,l_linestatus_prf#1818,rid#1819,l_shipmode_prf#1820,l_shipinstruct_prf#1821,l_quantity_prf#1822,l_receiptdate_prf#1823,l_linenumber_prf#1824,l_tax_prf#1825,l_shipdate_prf#1826,l_extendedprice_prf#1827,l_partkey_prf#1828,l_discount_prf#1829,l_partkey_and_l_suppkey_prf#1830,l_commitdate_prf#1831,l_suppkey_prf#1832,l_orderkey_prf#1833] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 118786ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/11 10:51:18 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:51:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1898L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 10:51:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1898L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#1900 AS l_returnflag_prf_0#1919, l_orderkey_and_l_linenumber_prf#1901 AS l_orderkey_and_l_linenumber_prf_0#1920, l_comment_prf#1902 AS l_comment_prf_0#1921, l_linestatus_prf#1903 AS l_linestatus_prf_0#1922, rid#1904 AS rid_0#1923, l_shipmode_prf#1905 AS l_shipmode_prf_0#1924, l_shipinstruct_prf#1906 AS l_shipinstruct_prf_0#1925, l_quantity_prf#1907 AS l_quantity_prf_0#1926, l_receiptdate_prf#1908 AS l_receiptdate_prf_0#1927, l_linenumber_prf#1909 AS l_linenumber_prf_0#1928, l_tax_prf#1910 AS l_tax_prf_0#1929, l_shipdate_prf#1911 AS l_shipdate_prf_0#1930, l_extendedprice_prf#1912 AS l_extendedprice_prf_0#1931, l_partkey_prf#1913 AS l_partkey_prf_0#1932, l_discount_prf#1914 AS l_discount_prf_0#1933, l_partkey_and_l_suppkey_prf#1915 AS l_partkey_and_l_suppkey_prf_0#1934, l_commitdate_prf#1916 AS l_commitdate_prf_0#1935, l_suppkey_prf#1917 AS l_suppkey_prf_0#1936, l_orderkey_prf#1918 AS l_orderkey_prf_0#1937]
         :  +- Relation[l_returnflag_prf#1900,l_orderkey_and_l_linenumber_prf#1901,l_comment_prf#1902,l_linestatus_prf#1903,rid#1904,l_shipmode_prf#1905,l_shipinstruct_prf#1906,l_quantity_prf#1907,l_receiptdate_prf#1908,l_linenumber_prf#1909,l_tax_prf#1910,l_shipdate_prf#1911,l_extendedprice_prf#1912,l_partkey_prf#1913,l_discount_prf#1914,l_partkey_and_l_suppkey_prf#1915,l_commitdate_prf#1916,l_suppkey_prf#1917,l_orderkey_prf#1918] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1940]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1938,value#1939] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 23743ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/11 10:51:42 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:51:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1988L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 10:51:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1988L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#2028]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2013: string
         :     :- Project [l_returnflag_prf#1990 AS l_returnflag_prf_0#2009, l_orderkey_and_l_linenumber_prf#1991 AS l_orderkey_and_l_linenumber_prf_0#2010, l_comment_prf#1992 AS l_comment_prf_0#2011, l_linestatus_prf#1993 AS l_linestatus_prf_0#2012, rid#1994 AS rid_0#2013, l_shipmode_prf#1995 AS l_shipmode_prf_0#2014, l_shipinstruct_prf#1996 AS l_shipinstruct_prf_0#2015, l_quantity_prf#1997 AS l_quantity_prf_0#2016, l_receiptdate_prf#1998 AS l_receiptdate_prf_0#2017, l_linenumber_prf#1999 AS l_linenumber_prf_0#2018, l_tax_prf#2000 AS l_tax_prf_0#2019, l_shipdate_prf#2001 AS l_shipdate_prf_0#2020, l_extendedprice_prf#2002 AS l_extendedprice_prf_0#2021, l_partkey_prf#2003 AS l_partkey_prf_0#2022, l_discount_prf#2004 AS l_discount_prf_0#2023, l_partkey_and_l_suppkey_prf#2005 AS l_partkey_and_l_suppkey_prf_0#2024, l_commitdate_prf#2006 AS l_commitdate_prf_0#2025, l_suppkey_prf#2007 AS l_suppkey_prf_0#2026, l_orderkey_prf#2008 AS l_orderkey_prf_0#2027]
         :     :  +- Relation[l_returnflag_prf#1990,l_orderkey_and_l_linenumber_prf#1991,l_comment_prf#1992,l_linestatus_prf#1993,rid#1994,l_shipmode_prf#1995,l_shipinstruct_prf#1996,l_quantity_prf#1997,l_receiptdate_prf#1998,l_linenumber_prf#1999,l_tax_prf#2000,l_shipdate_prf#2001,l_extendedprice_prf#2002,l_partkey_prf#2003,l_discount_prf#2004,l_partkey_and_l_suppkey_prf#2005,l_commitdate_prf#2006,l_suppkey_prf#2007,l_orderkey_prf#2008] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2029 AS o_shippriority_prf_1#2039, rid#2030 AS rid_1#2040, o_orderdate_prf#2031 AS o_orderdate_prf_1#2041, o_custkey_prf#2032 AS o_custkey_prf_1#2042, o_orderpriority_prf#2033 AS o_orderpriority_prf_1#2043, o_clerk_prf#2034 AS o_clerk_prf_1#2044, o_orderstatus_prf#2035 AS o_orderstatus_prf_1#2045, o_totalprice_prf#2036 AS o_totalprice_prf_1#2046, o_orderkey_prf#2037 AS o_orderkey_prf_1#2047, o_comment_prf#2038 AS o_comment_prf_1#2048]
            +- Relation[o_shippriority_prf#2029,rid#2030,o_orderdate_prf#2031,o_custkey_prf#2032,o_orderpriority_prf#2033,o_clerk_prf#2034,o_orderstatus_prf#2035,o_totalprice_prf#2036,o_orderkey_prf#2037,o_comment_prf#2038] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 130797ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/11 10:53:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 10:53:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2100L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 10:53:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2100L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1544) AS rid_2#2129]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#2112]
         :     :  :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#2107: string
         :     :  :     :- Project [rid#2102 AS rid_0#2107, n_regionkey_prf#2103 AS n_regionkey_prf_0#2108, n_nationkey_prf#2104 AS n_nationkey_prf_0#2109, n_name_prf#2105 AS n_name_prf_0#2110, n_comment_prf#2106 AS n_comment_prf_0#2111]
         :     :  :     :  +- Relation[rid#2102,n_regionkey_prf#2103,n_nationkey_prf#2104,n_name_prf#2105,n_comment_prf#2106] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#2113 AS s_phone_prf_1#2121, rid#2114 AS rid_1#2122, s_address_prf#2115 AS s_address_prf_1#2123, s_nationkey_prf#2116 AS s_nationkey_prf_1#2124, s_suppkey_prf#2117 AS s_suppkey_prf_1#2125, s_name_prf#2118 AS s_name_prf_1#2126, s_acctbal_prf#2119 AS s_acctbal_prf_1#2127, s_comment_prf#2120 AS s_comment_prf_1#2128]
         :     :     +- Relation[s_phone_prf#2113,rid#2114,s_address_prf#2115,s_nationkey_prf#2116,s_suppkey_prf#2117,s_name_prf#2118,s_acctbal_prf#2119,s_comment_prf#2120] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2130 AS c_acctbal_prf_2#2139, rid#2131 AS rid_2#2140, c_name_prf#2132 AS c_name_prf_2#2141, c_nationkey_prf#2133 AS c_nationkey_prf_2#2142, c_custkey_prf#2134 AS c_custkey_prf_2#2143, c_comment_prf#2135 AS c_comment_prf_2#2144, c_address_prf#2136 AS c_address_prf_2#2145, c_mktsegment_prf#2137 AS c_mktsegment_prf_2#2146, c_phone_prf#2138 AS c_phone_prf_2#2147]
            +- Relation[c_acctbal_prf#2130,rid#2131,c_name_prf#2132,c_nationkey_prf#2133,c_custkey_prf#2134,c_comment_prf#2135,c_address_prf#2136,c_mktsegment_prf#2137,c_phone_prf#2138] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 791294ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/11 11:07:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:07:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2194L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 11:07:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2194L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#2212]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#2205: string
         :     :- Project [s_phone_prf#2196 AS s_phone_prf_0#2204, rid#2197 AS rid_0#2205, s_address_prf#2198 AS s_address_prf_0#2206, s_nationkey_prf#2199 AS s_nationkey_prf_0#2207, s_suppkey_prf#2200 AS s_suppkey_prf_0#2208, s_name_prf#2201 AS s_name_prf_0#2209, s_acctbal_prf#2202 AS s_acctbal_prf_0#2210, s_comment_prf#2203 AS s_comment_prf_0#2211]
         :     :  +- Relation[s_phone_prf#2196,rid#2197,s_address_prf#2198,s_nationkey_prf#2199,s_suppkey_prf#2200,s_name_prf#2201,s_acctbal_prf#2202,s_comment_prf#2203] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1544) AS rid_2#2227]
            :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_1#2221: string
            :     :- Project [ps_partkey_and_ps_suppkey_prf#2213 AS ps_partkey_and_ps_suppkey_prf_1#2220, rid#2214 AS rid_1#2221, ps_availqty_prf#2215 AS ps_availqty_prf_1#2222, ps_comment_prf#2216 AS ps_comment_prf_1#2223, ps_partkey_prf#2217 AS ps_partkey_prf_1#2224, ps_supplycost_prf#2218 AS ps_supplycost_prf_1#2225, ps_suppkey_prf#2219 AS ps_suppkey_prf_1#2226]
            :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2213,rid#2214,ps_availqty_prf#2215,ps_comment_prf#2216,ps_partkey_prf#2217,ps_supplycost_prf#2218,ps_suppkey_prf#2219] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#2228 AS p_comment_prf_2#2238, p_name_prf#2229 AS p_name_prf_2#2239, rid#2230 AS rid_2#2240, p_type_prf#2231 AS p_type_prf_2#2241, p_retailprice_prf#2232 AS p_retailprice_prf_2#2242, p_mfgr_prf#2233 AS p_mfgr_prf_2#2243, p_container_prf#2234 AS p_container_prf_2#2244, p_brand_prf#2235 AS p_brand_prf_2#2245, p_size_prf#2236 AS p_size_prf_2#2246, p_partkey_prf#2237 AS p_partkey_prf_2#2247]
               +- Relation[p_comment_prf#2228,p_name_prf#2229,rid#2230,p_type_prf#2231,p_retailprice_prf#2232,p_mfgr_prf#2233,p_container_prf#2234,p_brand_prf#2235,p_size_prf#2236,p_partkey_prf#2237] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 62340ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/11 11:08:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:08:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2308L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 11:08:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2308L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#2330]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2322: string
         :     :  :     :- Project [p_comment_prf#2310 AS p_comment_prf_0#2320, p_name_prf#2311 AS p_name_prf_0#2321, rid#2312 AS rid_0#2322, p_type_prf#2313 AS p_type_prf_0#2323, p_retailprice_prf#2314 AS p_retailprice_prf_0#2324, p_mfgr_prf#2315 AS p_mfgr_prf_0#2325, p_container_prf#2316 AS p_container_prf_0#2326, p_brand_prf#2317 AS p_brand_prf_0#2327, p_size_prf#2318 AS p_size_prf_0#2328, p_partkey_prf#2319 AS p_partkey_prf_0#2329]
         :     :  :     :  +- Relation[p_comment_prf#2310,p_name_prf#2311,rid#2312,p_type_prf#2313,p_retailprice_prf#2314,p_mfgr_prf#2315,p_container_prf#2316,p_brand_prf#2317,p_size_prf#2318,p_partkey_prf#2319] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#2331 AS l_returnflag_prf_1#2350, l_orderkey_and_l_linenumber_prf#2332 AS l_orderkey_and_l_linenumber_prf_1#2351, l_comment_prf#2333 AS l_comment_prf_1#2352, l_linestatus_prf#2334 AS l_linestatus_prf_1#2353, rid#2335 AS rid_1#2354, l_shipmode_prf#2336 AS l_shipmode_prf_1#2355, l_shipinstruct_prf#2337 AS l_shipinstruct_prf_1#2356, l_quantity_prf#2338 AS l_quantity_prf_1#2357, l_receiptdate_prf#2339 AS l_receiptdate_prf_1#2358, l_linenumber_prf#2340 AS l_linenumber_prf_1#2359, l_tax_prf#2341 AS l_tax_prf_1#2360, l_shipdate_prf#2342 AS l_shipdate_prf_1#2361, l_extendedprice_prf#2343 AS l_extendedprice_prf_1#2362, l_partkey_prf#2344 AS l_partkey_prf_1#2363, l_discount_prf#2345 AS l_discount_prf_1#2364, l_partkey_and_l_suppkey_prf#2346 AS l_partkey_and_l_suppkey_prf_1#2365, l_commitdate_prf#2347 AS l_commitdate_prf_1#2366, l_suppkey_prf#2348 AS l_suppkey_prf_1#2367, l_orderkey_prf#2349 AS l_orderkey_prf_1#2368]
         :     :     +- Relation[l_returnflag_prf#2331,l_orderkey_and_l_linenumber_prf#2332,l_comment_prf#2333,l_linestatus_prf#2334,rid#2335,l_shipmode_prf#2336,l_shipinstruct_prf#2337,l_quantity_prf#2338,l_receiptdate_prf#2339,l_linenumber_prf#2340,l_tax_prf#2341,l_shipdate_prf#2342,l_extendedprice_prf#2343,l_partkey_prf#2344,l_discount_prf#2345,l_partkey_and_l_suppkey_prf#2346,l_commitdate_prf#2347,l_suppkey_prf#2348,l_orderkey_prf#2349] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2370 AS s_phone_prf_2#2378, rid#2371 AS rid_2#2379, s_address_prf#2372 AS s_address_prf_2#2380, s_nationkey_prf#2373 AS s_nationkey_prf_2#2381, s_suppkey_prf#2374 AS s_suppkey_prf_2#2382, s_name_prf#2375 AS s_name_prf_2#2383, s_acctbal_prf#2376 AS s_acctbal_prf_2#2384, s_comment_prf#2377 AS s_comment_prf_2#2385]
            +- Relation[s_phone_prf#2370,rid#2371,s_address_prf#2372,s_nationkey_prf#2373,s_suppkey_prf#2374,s_name_prf#2375,s_acctbal_prf#2376,s_comment_prf#2377] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 314030ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/11 11:13:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:13:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2435L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 11:13:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2435L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#2437 AS p_comment_prf_0#2447, p_name_prf#2438 AS p_name_prf_0#2448, rid#2439 AS rid_0#2449, p_type_prf#2440 AS p_type_prf_0#2450, p_retailprice_prf#2441 AS p_retailprice_prf_0#2451, p_mfgr_prf#2442 AS p_mfgr_prf_0#2452, p_container_prf#2443 AS p_container_prf_0#2453, p_brand_prf#2444 AS p_brand_prf_0#2454, p_size_prf#2445 AS p_size_prf_0#2455, p_partkey_prf#2446 AS p_partkey_prf_0#2456]
         :  +- Relation[p_comment_prf#2437,p_name_prf#2438,rid#2439,p_type_prf#2440,p_retailprice_prf#2441,p_mfgr_prf#2442,p_container_prf#2443,p_brand_prf#2444,p_size_prf#2445,p_partkey_prf#2446] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2457]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1938,value#1939] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1451
Elapsed time: 91ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/11 11:13:21 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:13:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2492L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 11:13:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2492L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1544) AS rid_2#2529]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#2514]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2506: string
         :     :  :     :- Project [p_comment_prf#2494 AS p_comment_prf_0#2504, p_name_prf#2495 AS p_name_prf_0#2505, rid#2496 AS rid_0#2506, p_type_prf#2497 AS p_type_prf_0#2507, p_retailprice_prf#2498 AS p_retailprice_prf_0#2508, p_mfgr_prf#2499 AS p_mfgr_prf_0#2509, p_container_prf#2500 AS p_container_prf_0#2510, p_brand_prf#2501 AS p_brand_prf_0#2511, p_size_prf#2502 AS p_size_prf_0#2512, p_partkey_prf#2503 AS p_partkey_prf_0#2513]
         :     :  :     :  +- Relation[p_comment_prf#2494,p_name_prf#2495,rid#2496,p_type_prf#2497,p_retailprice_prf#2498,p_mfgr_prf#2499,p_container_prf#2500,p_brand_prf#2501,p_size_prf#2502,p_partkey_prf#2503] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#2515 AS ps_partkey_and_ps_suppkey_prf_1#2522, rid#2516 AS rid_1#2523, ps_availqty_prf#2517 AS ps_availqty_prf_1#2524, ps_comment_prf#2518 AS ps_comment_prf_1#2525, ps_partkey_prf#2519 AS ps_partkey_prf_1#2526, ps_supplycost_prf#2520 AS ps_supplycost_prf_1#2527, ps_suppkey_prf#2521 AS ps_suppkey_prf_1#2528]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#2515,rid#2516,ps_availqty_prf#2517,ps_comment_prf#2518,ps_partkey_prf#2519,ps_supplycost_prf#2520,ps_suppkey_prf#2521] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2530 AS s_phone_prf_2#2538, rid#2531 AS rid_2#2539, s_address_prf#2532 AS s_address_prf_2#2540, s_nationkey_prf#2533 AS s_nationkey_prf_2#2541, s_suppkey_prf#2534 AS s_suppkey_prf_2#2542, s_name_prf#2535 AS s_name_prf_2#2543, s_acctbal_prf#2536 AS s_acctbal_prf_2#2544, s_comment_prf#2537 AS s_comment_prf_2#2545]
            +- Relation[s_phone_prf#2530,rid#2531,s_address_prf#2532,s_nationkey_prf#2533,s_suppkey_prf#2534,s_name_prf#2535,s_acctbal_prf#2536,s_comment_prf#2537] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 94357ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/11 11:14:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:14:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2607L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 11:14:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2607L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#2647]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2632: string
         :     :  :     :- Project [l_returnflag_prf#2609 AS l_returnflag_prf_0#2628, l_orderkey_and_l_linenumber_prf#2610 AS l_orderkey_and_l_linenumber_prf_0#2629, l_comment_prf#2611 AS l_comment_prf_0#2630, l_linestatus_prf#2612 AS l_linestatus_prf_0#2631, rid#2613 AS rid_0#2632, l_shipmode_prf#2614 AS l_shipmode_prf_0#2633, l_shipinstruct_prf#2615 AS l_shipinstruct_prf_0#2634, l_quantity_prf#2616 AS l_quantity_prf_0#2635, l_receiptdate_prf#2617 AS l_receiptdate_prf_0#2636, l_linenumber_prf#2618 AS l_linenumber_prf_0#2637, l_tax_prf#2619 AS l_tax_prf_0#2638, l_shipdate_prf#2620 AS l_shipdate_prf_0#2639, l_extendedprice_prf#2621 AS l_extendedprice_prf_0#2640, l_partkey_prf#2622 AS l_partkey_prf_0#2641, l_discount_prf#2623 AS l_discount_prf_0#2642, l_partkey_and_l_suppkey_prf#2624 AS l_partkey_and_l_suppkey_prf_0#2643, l_commitdate_prf#2625 AS l_commitdate_prf_0#2644, l_suppkey_prf#2626 AS l_suppkey_prf_0#2645, l_orderkey_prf#2627 AS l_orderkey_prf_0#2646]
         :     :  :     :  +- Relation[l_returnflag_prf#2609,l_orderkey_and_l_linenumber_prf#2610,l_comment_prf#2611,l_linestatus_prf#2612,rid#2613,l_shipmode_prf#2614,l_shipinstruct_prf#2615,l_quantity_prf#2616,l_receiptdate_prf#2617,l_linenumber_prf#2618,l_tax_prf#2619,l_shipdate_prf#2620,l_extendedprice_prf#2621,l_partkey_prf#2622,l_discount_prf#2623,l_partkey_and_l_suppkey_prf#2624,l_commitdate_prf#2625,l_suppkey_prf#2626,l_orderkey_prf#2627] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#2648 AS o_shippriority_prf_1#2658, rid#2649 AS rid_1#2659, o_orderdate_prf#2650 AS o_orderdate_prf_1#2660, o_custkey_prf#2651 AS o_custkey_prf_1#2661, o_orderpriority_prf#2652 AS o_orderpriority_prf_1#2662, o_clerk_prf#2653 AS o_clerk_prf_1#2663, o_orderstatus_prf#2654 AS o_orderstatus_prf_1#2664, o_totalprice_prf#2655 AS o_totalprice_prf_1#2665, o_orderkey_prf#2656 AS o_orderkey_prf_1#2666, o_comment_prf#2657 AS o_comment_prf_1#2667]
         :     :     +- Relation[o_shippriority_prf#2648,rid#2649,o_orderdate_prf#2650,o_custkey_prf#2651,o_orderpriority_prf#2652,o_clerk_prf#2653,o_orderstatus_prf#2654,o_totalprice_prf#2655,o_orderkey_prf#2656,o_comment_prf#2657] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2669 AS c_acctbal_prf_2#2678, rid#2670 AS rid_2#2679, c_name_prf#2671 AS c_name_prf_2#2680, c_nationkey_prf#2672 AS c_nationkey_prf_2#2681, c_custkey_prf#2673 AS c_custkey_prf_2#2682, c_comment_prf#2674 AS c_comment_prf_2#2683, c_address_prf#2675 AS c_address_prf_2#2684, c_mktsegment_prf#2676 AS c_mktsegment_prf_2#2685, c_phone_prf#2677 AS c_phone_prf_2#2686]
            +- Relation[c_acctbal_prf#2669,rid#2670,c_name_prf#2671,c_nationkey_prf#2672,c_custkey_prf#2673,c_comment_prf#2674,c_address_prf#2675,c_mktsegment_prf#2676,c_phone_prf#2677] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 346305ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/11 11:20:41 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:20:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2744L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 11:20:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2744L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#2746 AS l_returnflag_prf_0#2765, l_orderkey_and_l_linenumber_prf#2747 AS l_orderkey_and_l_linenumber_prf_0#2766, l_comment_prf#2748 AS l_comment_prf_0#2767, l_linestatus_prf#2749 AS l_linestatus_prf_0#2768, rid#2750 AS rid_0#2769, l_shipmode_prf#2751 AS l_shipmode_prf_0#2770, l_shipinstruct_prf#2752 AS l_shipinstruct_prf_0#2771, l_quantity_prf#2753 AS l_quantity_prf_0#2772, l_receiptdate_prf#2754 AS l_receiptdate_prf_0#2773, l_linenumber_prf#2755 AS l_linenumber_prf_0#2774, l_tax_prf#2756 AS l_tax_prf_0#2775, l_shipdate_prf#2757 AS l_shipdate_prf_0#2776, l_extendedprice_prf#2758 AS l_extendedprice_prf_0#2777, l_partkey_prf#2759 AS l_partkey_prf_0#2778, l_discount_prf#2760 AS l_discount_prf_0#2779, l_partkey_and_l_suppkey_prf#2761 AS l_partkey_and_l_suppkey_prf_0#2780, l_commitdate_prf#2762 AS l_commitdate_prf_0#2781, l_suppkey_prf#2763 AS l_suppkey_prf_0#2782, l_orderkey_prf#2764 AS l_orderkey_prf_0#2783]
         :  +- Relation[l_returnflag_prf#2746,l_orderkey_and_l_linenumber_prf#2747,l_comment_prf#2748,l_linestatus_prf#2749,rid#2750,l_shipmode_prf#2751,l_shipinstruct_prf#2752,l_quantity_prf#2753,l_receiptdate_prf#2754,l_linenumber_prf#2755,l_tax_prf#2756,l_shipdate_prf#2757,l_extendedprice_prf#2758,l_partkey_prf#2759,l_discount_prf#2760,l_partkey_and_l_suppkey_prf#2761,l_commitdate_prf#2762,l_suppkey_prf#2763,l_orderkey_prf#2764] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2784]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1938,value#1939] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 13935ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/11 11:20:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:20:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2839L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 11:20:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2839L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_2#2857]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#2850: string
         :     :- Project [s_phone_prf#2841 AS s_phone_prf_0#2849, rid#2842 AS rid_0#2850, s_address_prf#2843 AS s_address_prf_0#2851, s_nationkey_prf#2844 AS s_nationkey_prf_0#2852, s_suppkey_prf#2845 AS s_suppkey_prf_0#2853, s_name_prf#2846 AS s_name_prf_0#2854, s_acctbal_prf#2847 AS s_acctbal_prf_0#2855, s_comment_prf#2848 AS s_comment_prf_0#2856]
         :     :  +- Relation[s_phone_prf#2841,rid#2842,s_address_prf#2843,s_nationkey_prf#2844,s_suppkey_prf#2845,s_name_prf#2846,s_acctbal_prf#2847,s_comment_prf#2848] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1544) AS rid_2#2878]
            :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#2870: string
            :     :- Project [p_comment_prf#2858 AS p_comment_prf_1#2868, p_name_prf#2859 AS p_name_prf_1#2869, rid#2860 AS rid_1#2870, p_type_prf#2861 AS p_type_prf_1#2871, p_retailprice_prf#2862 AS p_retailprice_prf_1#2872, p_mfgr_prf#2863 AS p_mfgr_prf_1#2873, p_container_prf#2864 AS p_container_prf_1#2874, p_brand_prf#2865 AS p_brand_prf_1#2875, p_size_prf#2866 AS p_size_prf_1#2876, p_partkey_prf#2867 AS p_partkey_prf_1#2877]
            :     :  +- Relation[p_comment_prf#2858,p_name_prf#2859,rid#2860,p_type_prf#2861,p_retailprice_prf#2862,p_mfgr_prf#2863,p_container_prf#2864,p_brand_prf#2865,p_size_prf#2866,p_partkey_prf#2867] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2879 AS l_returnflag_prf_2#2898, l_orderkey_and_l_linenumber_prf#2880 AS l_orderkey_and_l_linenumber_prf_2#2899, l_comment_prf#2881 AS l_comment_prf_2#2900, l_linestatus_prf#2882 AS l_linestatus_prf_2#2901, rid#2883 AS rid_2#2902, l_shipmode_prf#2884 AS l_shipmode_prf_2#2903, l_shipinstruct_prf#2885 AS l_shipinstruct_prf_2#2904, l_quantity_prf#2886 AS l_quantity_prf_2#2905, l_receiptdate_prf#2887 AS l_receiptdate_prf_2#2906, l_linenumber_prf#2888 AS l_linenumber_prf_2#2907, l_tax_prf#2889 AS l_tax_prf_2#2908, l_shipdate_prf#2890 AS l_shipdate_prf_2#2909, l_extendedprice_prf#2891 AS l_extendedprice_prf_2#2910, l_partkey_prf#2892 AS l_partkey_prf_2#2911, l_discount_prf#2893 AS l_discount_prf_2#2912, l_partkey_and_l_suppkey_prf#2894 AS l_partkey_and_l_suppkey_prf_2#2913, l_commitdate_prf#2895 AS l_commitdate_prf_2#2914, l_suppkey_prf#2896 AS l_suppkey_prf_2#2915, l_orderkey_prf#2897 AS l_orderkey_prf_2#2916]
               +- Relation[l_returnflag_prf#2879,l_orderkey_and_l_linenumber_prf#2880,l_comment_prf#2881,l_linestatus_prf#2882,rid#2883,l_shipmode_prf#2884,l_shipinstruct_prf#2885,l_quantity_prf#2886,l_receiptdate_prf#2887,l_linenumber_prf#2888,l_tax_prf#2889,l_shipdate_prf#2890,l_extendedprice_prf#2891,l_partkey_prf#2892,l_discount_prf#2893,l_partkey_and_l_suppkey_prf#2894,l_commitdate_prf#2895,l_suppkey_prf#2896,l_orderkey_prf#2897] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 191216ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/11 11:24:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:24:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2976L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 11:24:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2976L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_2#2996]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#2988: string
         :     :- Project [c_acctbal_prf#2978 AS c_acctbal_prf_0#2987, rid#2979 AS rid_0#2988, c_name_prf#2980 AS c_name_prf_0#2989, c_nationkey_prf#2981 AS c_nationkey_prf_0#2990, c_custkey_prf#2982 AS c_custkey_prf_0#2991, c_comment_prf#2983 AS c_comment_prf_0#2992, c_address_prf#2984 AS c_address_prf_0#2993, c_mktsegment_prf#2985 AS c_mktsegment_prf_0#2994, c_phone_prf#2986 AS c_phone_prf_0#2995]
         :     :  +- Relation[c_acctbal_prf#2978,rid#2979,c_name_prf#2980,c_nationkey_prf#2981,c_custkey_prf#2982,c_comment_prf#2983,c_address_prf#2984,c_mktsegment_prf#2985,c_phone_prf#2986] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1544) AS rid_2#3013]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#3006: string
            :     :- Project [s_phone_prf#2997 AS s_phone_prf_1#3005, rid#2998 AS rid_1#3006, s_address_prf#2999 AS s_address_prf_1#3007, s_nationkey_prf#3000 AS s_nationkey_prf_1#3008, s_suppkey_prf#3001 AS s_suppkey_prf_1#3009, s_name_prf#3002 AS s_name_prf_1#3010, s_acctbal_prf#3003 AS s_acctbal_prf_1#3011, s_comment_prf#3004 AS s_comment_prf_1#3012]
            :     :  +- Relation[s_phone_prf#2997,rid#2998,s_address_prf#2999,s_nationkey_prf#3000,s_suppkey_prf#3001,s_name_prf#3002,s_acctbal_prf#3003,s_comment_prf#3004] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [rid#3014 AS rid_2#3019, n_regionkey_prf#3015 AS n_regionkey_prf_2#3020, n_nationkey_prf#3016 AS n_nationkey_prf_2#3021, n_name_prf#3017 AS n_name_prf_2#3022, n_comment_prf#3018 AS n_comment_prf_2#3023]
               +- Relation[rid#3014,n_regionkey_prf#3015,n_nationkey_prf#3016,n_name_prf#3017,n_comment_prf#3018] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 43278ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/11 11:24:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:24:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3072L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 11:24:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3072L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#3090]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#3083: string
         :     :- Project [s_phone_prf#3074 AS s_phone_prf_0#3082, rid#3075 AS rid_0#3083, s_address_prf#3076 AS s_address_prf_0#3084, s_nationkey_prf#3077 AS s_nationkey_prf_0#3085, s_suppkey_prf#3078 AS s_suppkey_prf_0#3086, s_name_prf#3079 AS s_name_prf_0#3087, s_acctbal_prf#3080 AS s_acctbal_prf_0#3088, s_comment_prf#3081 AS s_comment_prf_0#3089]
         :     :  +- Relation[s_phone_prf#3074,rid#3075,s_address_prf#3076,s_nationkey_prf#3077,s_suppkey_prf#3078,s_name_prf#3079,s_acctbal_prf#3080,s_comment_prf#3081] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3091 AS l_returnflag_prf_1#3110, l_orderkey_and_l_linenumber_prf#3092 AS l_orderkey_and_l_linenumber_prf_1#3111, l_comment_prf#3093 AS l_comment_prf_1#3112, l_linestatus_prf#3094 AS l_linestatus_prf_1#3113, rid#3095 AS rid_1#3114, l_shipmode_prf#3096 AS l_shipmode_prf_1#3115, l_shipinstruct_prf#3097 AS l_shipinstruct_prf_1#3116, l_quantity_prf#3098 AS l_quantity_prf_1#3117, l_receiptdate_prf#3099 AS l_receiptdate_prf_1#3118, l_linenumber_prf#3100 AS l_linenumber_prf_1#3119, l_tax_prf#3101 AS l_tax_prf_1#3120, l_shipdate_prf#3102 AS l_shipdate_prf_1#3121, l_extendedprice_prf#3103 AS l_extendedprice_prf_1#3122, l_partkey_prf#3104 AS l_partkey_prf_1#3123, l_discount_prf#3105 AS l_discount_prf_1#3124, l_partkey_and_l_suppkey_prf#3106 AS l_partkey_and_l_suppkey_prf_1#3125, l_commitdate_prf#3107 AS l_commitdate_prf_1#3126, l_suppkey_prf#3108 AS l_suppkey_prf_1#3127, l_orderkey_prf#3109 AS l_orderkey_prf_1#3128]
            +- Relation[l_returnflag_prf#3091,l_orderkey_and_l_linenumber_prf#3092,l_comment_prf#3093,l_linestatus_prf#3094,rid#3095,l_shipmode_prf#3096,l_shipinstruct_prf#3097,l_quantity_prf#3098,l_receiptdate_prf#3099,l_linenumber_prf#3100,l_tax_prf#3101,l_shipdate_prf#3102,l_extendedprice_prf#3103,l_partkey_prf#3104,l_discount_prf#3105,l_partkey_and_l_suppkey_prf#3106,l_commitdate_prf#3107,l_suppkey_prf#3108,l_orderkey_prf#3109] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 88855ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_orderkey and l_orderkey = o_orderkey
19/10/11 11:26:19 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:26:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3192L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 11:26:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3192L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_2#3232]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3217: string
         :     :- Project [l_returnflag_prf#3194 AS l_returnflag_prf_0#3213, l_orderkey_and_l_linenumber_prf#3195 AS l_orderkey_and_l_linenumber_prf_0#3214, l_comment_prf#3196 AS l_comment_prf_0#3215, l_linestatus_prf#3197 AS l_linestatus_prf_0#3216, rid#3198 AS rid_0#3217, l_shipmode_prf#3199 AS l_shipmode_prf_0#3218, l_shipinstruct_prf#3200 AS l_shipinstruct_prf_0#3219, l_quantity_prf#3201 AS l_quantity_prf_0#3220, l_receiptdate_prf#3202 AS l_receiptdate_prf_0#3221, l_linenumber_prf#3203 AS l_linenumber_prf_0#3222, l_tax_prf#3204 AS l_tax_prf_0#3223, l_shipdate_prf#3205 AS l_shipdate_prf_0#3224, l_extendedprice_prf#3206 AS l_extendedprice_prf_0#3225, l_partkey_prf#3207 AS l_partkey_prf_0#3226, l_discount_prf#3208 AS l_discount_prf_0#3227, l_partkey_and_l_suppkey_prf#3209 AS l_partkey_and_l_suppkey_prf_0#3228, l_commitdate_prf#3210 AS l_commitdate_prf_0#3229, l_suppkey_prf#3211 AS l_suppkey_prf_0#3230, l_orderkey_prf#3212 AS l_orderkey_prf_0#3231]
         :     :  +- Relation[l_returnflag_prf#3194,l_orderkey_and_l_linenumber_prf#3195,l_comment_prf#3196,l_linestatus_prf#3197,rid#3198,l_shipmode_prf#3199,l_shipinstruct_prf#3200,l_quantity_prf#3201,l_receiptdate_prf#3202,l_linenumber_prf#3203,l_tax_prf#3204,l_shipdate_prf#3205,l_extendedprice_prf#3206,l_partkey_prf#3207,l_discount_prf#3208,l_partkey_and_l_suppkey_prf#3209,l_commitdate_prf#3210,l_suppkey_prf#3211,l_orderkey_prf#3212] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1544) AS rid_2#3251]
            :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#3243: string
            :     :- Project [c_acctbal_prf#3233 AS c_acctbal_prf_1#3242, rid#3234 AS rid_1#3243, c_name_prf#3235 AS c_name_prf_1#3244, c_nationkey_prf#3236 AS c_nationkey_prf_1#3245, c_custkey_prf#3237 AS c_custkey_prf_1#3246, c_comment_prf#3238 AS c_comment_prf_1#3247, c_address_prf#3239 AS c_address_prf_1#3248, c_mktsegment_prf#3240 AS c_mktsegment_prf_1#3249, c_phone_prf#3241 AS c_phone_prf_1#3250]
            :     :  +- Relation[c_acctbal_prf#3233,rid#3234,c_name_prf#3235,c_nationkey_prf#3236,c_custkey_prf#3237,c_comment_prf#3238,c_address_prf#3239,c_mktsegment_prf#3240,c_phone_prf#3241] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3252 AS o_shippriority_prf_2#3262, rid#3253 AS rid_2#3263, o_orderdate_prf#3254 AS o_orderdate_prf_2#3264, o_custkey_prf#3255 AS o_custkey_prf_2#3265, o_orderpriority_prf#3256 AS o_orderpriority_prf_2#3266, o_clerk_prf#3257 AS o_clerk_prf_2#3267, o_orderstatus_prf#3258 AS o_orderstatus_prf_2#3268, o_totalprice_prf#3259 AS o_totalprice_prf_2#3269, o_orderkey_prf#3260 AS o_orderkey_prf_2#3270, o_comment_prf#3261 AS o_comment_prf_2#3271]
               +- Relation[o_shippriority_prf#3252,rid#3253,o_orderdate_prf#3254,o_custkey_prf#3255,o_orderpriority_prf#3256,o_clerk_prf#3257,o_orderstatus_prf#3258,o_totalprice_prf#3259,o_orderkey_prf#3260,o_comment_prf#3261] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 176782ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/11 11:29:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:29:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3320L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 11:29:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3320L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#3330]
         :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#3329: string
         :     :- Project [r_regionkey_prf#3322 AS r_regionkey_prf_0#3326, r_name_prf#3323 AS r_name_prf_0#3327, r_comment_prf#3324 AS r_comment_prf_0#3328, rid#3325 AS rid_0#3329]
         :     :  +- Relation[r_regionkey_prf#3322,r_name_prf#3323,r_comment_prf#3324,rid#3325] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#3331 AS rid_1#3336, n_regionkey_prf#3332 AS n_regionkey_prf_1#3337, n_nationkey_prf#3333 AS n_nationkey_prf_1#3338, n_name_prf#3334 AS n_name_prf_1#3339, n_comment_prf#3335 AS n_comment_prf_1#3340]
            +- Relation[rid#3331,n_regionkey_prf#3332,n_nationkey_prf#3333,n_name_prf#3334,n_comment_prf#3335] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=25
Elapsed time: 71ms

f1=
select * from region where r_name = 'EUROPE'
19/10/11 11:29:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:29:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3356L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/11 11:29:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3356L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#3358 AS r_regionkey_prf_0#3362, r_name_prf#3359 AS r_name_prf_0#3363, r_comment_prf#3360 AS r_comment_prf_0#3364, rid#3361 AS rid_0#3365]
         :  +- Relation[r_regionkey_prf#3358,r_name_prf#3359,r_comment_prf#3360,rid#3361] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3366]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1938,value#1939] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 50ms

f2=
select * from part where p_size = 15
19/10/11 11:29:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:29:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3383L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 11:29:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3383L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#3385 AS p_comment_prf_0#3395, p_name_prf#3386 AS p_name_prf_0#3396, rid#3387 AS rid_0#3397, p_type_prf#3388 AS p_type_prf_0#3398, p_retailprice_prf#3389 AS p_retailprice_prf_0#3399, p_mfgr_prf#3390 AS p_mfgr_prf_0#3400, p_container_prf#3391 AS p_container_prf_0#3401, p_brand_prf#3392 AS p_brand_prf_0#3402, p_size_prf#3393 AS p_size_prf_0#3403, p_partkey_prf#3394 AS p_partkey_prf_0#3404]
         :  +- Relation[p_comment_prf#3385,p_name_prf#3386,rid#3387,p_type_prf#3388,p_retailprice_prf#3389,p_mfgr_prf#3390,p_container_prf#3391,p_brand_prf#3392,p_size_prf#3393,p_partkey_prf#3394] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3405]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1938,value#1939] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3907
Elapsed time: 115ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/11 11:29:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:29:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3444L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 11:29:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3444L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#3466]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#3457: string
         :     :- Project [o_shippriority_prf#3446 AS o_shippriority_prf_0#3456, rid#3447 AS rid_0#3457, o_orderdate_prf#3448 AS o_orderdate_prf_0#3458, o_custkey_prf#3449 AS o_custkey_prf_0#3459, o_orderpriority_prf#3450 AS o_orderpriority_prf_0#3460, o_clerk_prf#3451 AS o_clerk_prf_0#3461, o_orderstatus_prf#3452 AS o_orderstatus_prf_0#3462, o_totalprice_prf#3453 AS o_totalprice_prf_0#3463, o_orderkey_prf#3454 AS o_orderkey_prf_0#3464, o_comment_prf#3455 AS o_comment_prf_0#3465]
         :     :  +- Relation[o_shippriority_prf#3446,rid#3447,o_orderdate_prf#3448,o_custkey_prf#3449,o_orderpriority_prf#3450,o_clerk_prf#3451,o_orderstatus_prf#3452,o_totalprice_prf#3453,o_orderkey_prf#3454,o_comment_prf#3455] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3467 AS l_returnflag_prf_1#3486, l_orderkey_and_l_linenumber_prf#3468 AS l_orderkey_and_l_linenumber_prf_1#3487, l_comment_prf#3469 AS l_comment_prf_1#3488, l_linestatus_prf#3470 AS l_linestatus_prf_1#3489, rid#3471 AS rid_1#3490, l_shipmode_prf#3472 AS l_shipmode_prf_1#3491, l_shipinstruct_prf#3473 AS l_shipinstruct_prf_1#3492, l_quantity_prf#3474 AS l_quantity_prf_1#3493, l_receiptdate_prf#3475 AS l_receiptdate_prf_1#3494, l_linenumber_prf#3476 AS l_linenumber_prf_1#3495, l_tax_prf#3477 AS l_tax_prf_1#3496, l_shipdate_prf#3478 AS l_shipdate_prf_1#3497, l_extendedprice_prf#3479 AS l_extendedprice_prf_1#3498, l_partkey_prf#3480 AS l_partkey_prf_1#3499, l_discount_prf#3481 AS l_discount_prf_1#3500, l_partkey_and_l_suppkey_prf#3482 AS l_partkey_and_l_suppkey_prf_1#3501, l_commitdate_prf#3483 AS l_commitdate_prf_1#3502, l_suppkey_prf#3484 AS l_suppkey_prf_1#3503, l_orderkey_prf#3485 AS l_orderkey_prf_1#3504]
            +- Relation[l_returnflag_prf#3467,l_orderkey_and_l_linenumber_prf#3468,l_comment_prf#3469,l_linestatus_prf#3470,rid#3471,l_shipmode_prf#3472,l_shipinstruct_prf#3473,l_quantity_prf#3474,l_receiptdate_prf#3475,l_linenumber_prf#3476,l_tax_prf#3477,l_shipdate_prf#3478,l_extendedprice_prf#3479,l_partkey_prf#3480,l_discount_prf#3481,l_partkey_and_l_suppkey_prf#3482,l_commitdate_prf#3483,l_suppkey_prf#3484,l_orderkey_prf#3485] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 199593ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/11 11:32:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:32:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3549L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 11:32:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3549L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#3567]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#3560: string
         :     :- Project [s_phone_prf#3551 AS s_phone_prf_0#3559, rid#3552 AS rid_0#3560, s_address_prf#3553 AS s_address_prf_0#3561, s_nationkey_prf#3554 AS s_nationkey_prf_0#3562, s_suppkey_prf#3555 AS s_suppkey_prf_0#3563, s_name_prf#3556 AS s_name_prf_0#3564, s_acctbal_prf#3557 AS s_acctbal_prf_0#3565, s_comment_prf#3558 AS s_comment_prf_0#3566]
         :     :  +- Relation[s_phone_prf#3551,rid#3552,s_address_prf#3553,s_nationkey_prf#3554,s_suppkey_prf#3555,s_name_prf#3556,s_acctbal_prf#3557,s_comment_prf#3558] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#3568 AS ps_partkey_and_ps_suppkey_prf_1#3575, rid#3569 AS rid_1#3576, ps_availqty_prf#3570 AS ps_availqty_prf_1#3577, ps_comment_prf#3571 AS ps_comment_prf_1#3578, ps_partkey_prf#3572 AS ps_partkey_prf_1#3579, ps_supplycost_prf#3573 AS ps_supplycost_prf_1#3580, ps_suppkey_prf#3574 AS ps_suppkey_prf_1#3581]
            +- Relation[ps_partkey_and_ps_suppkey_prf#3568,rid#3569,ps_availqty_prf#3570,ps_comment_prf#3571,ps_partkey_prf#3572,ps_supplycost_prf#3573,ps_suppkey_prf#3574] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 11268ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/11 11:32:46 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:32:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3633L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 11:32:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3633L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1544) AS rid_2#3674]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#3653]
         :     :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3645: string
         :     :  :     :- Project [c_acctbal_prf#3635 AS c_acctbal_prf_0#3644, rid#3636 AS rid_0#3645, c_name_prf#3637 AS c_name_prf_0#3646, c_nationkey_prf#3638 AS c_nationkey_prf_0#3647, c_custkey_prf#3639 AS c_custkey_prf_0#3648, c_comment_prf#3640 AS c_comment_prf_0#3649, c_address_prf#3641 AS c_address_prf_0#3650, c_mktsegment_prf#3642 AS c_mktsegment_prf_0#3651, c_phone_prf#3643 AS c_phone_prf_0#3652]
         :     :  :     :  +- Relation[c_acctbal_prf#3635,rid#3636,c_name_prf#3637,c_nationkey_prf#3638,c_custkey_prf#3639,c_comment_prf#3640,c_address_prf#3641,c_mktsegment_prf#3642,c_phone_prf#3643] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#3654 AS o_shippriority_prf_1#3664, rid#3655 AS rid_1#3665, o_orderdate_prf#3656 AS o_orderdate_prf_1#3666, o_custkey_prf#3657 AS o_custkey_prf_1#3667, o_orderpriority_prf#3658 AS o_orderpriority_prf_1#3668, o_clerk_prf#3659 AS o_clerk_prf_1#3669, o_orderstatus_prf#3660 AS o_orderstatus_prf_1#3670, o_totalprice_prf#3661 AS o_totalprice_prf_1#3671, o_orderkey_prf#3662 AS o_orderkey_prf_1#3672, o_comment_prf#3663 AS o_comment_prf_1#3673]
         :     :     +- Relation[o_shippriority_prf#3654,rid#3655,o_orderdate_prf#3656,o_custkey_prf#3657,o_orderpriority_prf#3658,o_clerk_prf#3659,o_orderstatus_prf#3660,o_totalprice_prf#3661,o_orderkey_prf#3662,o_comment_prf#3663] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3675 AS l_returnflag_prf_2#3694, l_orderkey_and_l_linenumber_prf#3676 AS l_orderkey_and_l_linenumber_prf_2#3695, l_comment_prf#3677 AS l_comment_prf_2#3696, l_linestatus_prf#3678 AS l_linestatus_prf_2#3697, rid#3679 AS rid_2#3698, l_shipmode_prf#3680 AS l_shipmode_prf_2#3699, l_shipinstruct_prf#3681 AS l_shipinstruct_prf_2#3700, l_quantity_prf#3682 AS l_quantity_prf_2#3701, l_receiptdate_prf#3683 AS l_receiptdate_prf_2#3702, l_linenumber_prf#3684 AS l_linenumber_prf_2#3703, l_tax_prf#3685 AS l_tax_prf_2#3704, l_shipdate_prf#3686 AS l_shipdate_prf_2#3705, l_extendedprice_prf#3687 AS l_extendedprice_prf_2#3706, l_partkey_prf#3688 AS l_partkey_prf_2#3707, l_discount_prf#3689 AS l_discount_prf_2#3708, l_partkey_and_l_suppkey_prf#3690 AS l_partkey_and_l_suppkey_prf_2#3709, l_commitdate_prf#3691 AS l_commitdate_prf_2#3710, l_suppkey_prf#3692 AS l_suppkey_prf_2#3711, l_orderkey_prf#3693 AS l_orderkey_prf_2#3712]
            +- Relation[l_returnflag_prf#3675,l_orderkey_and_l_linenumber_prf#3676,l_comment_prf#3677,l_linestatus_prf#3678,rid#3679,l_shipmode_prf#3680,l_shipinstruct_prf#3681,l_quantity_prf#3682,l_receiptdate_prf#3683,l_linenumber_prf#3684,l_tax_prf#3685,l_shipdate_prf#3686,l_extendedprice_prf#3687,l_partkey_prf#3688,l_discount_prf#3689,l_partkey_and_l_suppkey_prf#3690,l_commitdate_prf#3691,l_suppkey_prf#3692,l_orderkey_prf#3693] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 185815ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/11 11:35:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:35:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3765L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 11:35:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3765L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#3777]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#3772: string
         :     :- Project [rid#3767 AS rid_0#3772, n_regionkey_prf#3768 AS n_regionkey_prf_0#3773, n_nationkey_prf#3769 AS n_nationkey_prf_0#3774, n_name_prf#3770 AS n_name_prf_0#3775, n_comment_prf#3771 AS n_comment_prf_0#3776]
         :     :  +- Relation[rid#3767,n_regionkey_prf#3768,n_nationkey_prf#3769,n_name_prf#3770,n_comment_prf#3771] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3778 AS s_phone_prf_1#3786, rid#3779 AS rid_1#3787, s_address_prf#3780 AS s_address_prf_1#3788, s_nationkey_prf#3781 AS s_nationkey_prf_1#3789, s_suppkey_prf#3782 AS s_suppkey_prf_1#3790, s_name_prf#3783 AS s_name_prf_1#3791, s_acctbal_prf#3784 AS s_acctbal_prf_1#3792, s_comment_prf#3785 AS s_comment_prf_1#3793]
            +- Relation[s_phone_prf#3778,rid#3779,s_address_prf#3780,s_nationkey_prf#3781,s_suppkey_prf#3782,s_name_prf#3783,s_acctbal_prf#3784,s_comment_prf#3785] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=10000
Elapsed time: 189ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/11 11:35:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:35:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3827L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 11:35:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3827L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#3847]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3839: string
         :     :- Project [c_acctbal_prf#3829 AS c_acctbal_prf_0#3838, rid#3830 AS rid_0#3839, c_name_prf#3831 AS c_name_prf_0#3840, c_nationkey_prf#3832 AS c_nationkey_prf_0#3841, c_custkey_prf#3833 AS c_custkey_prf_0#3842, c_comment_prf#3834 AS c_comment_prf_0#3843, c_address_prf#3835 AS c_address_prf_0#3844, c_mktsegment_prf#3836 AS c_mktsegment_prf_0#3845, c_phone_prf#3837 AS c_phone_prf_0#3846]
         :     :  +- Relation[c_acctbal_prf#3829,rid#3830,c_name_prf#3831,c_nationkey_prf#3832,c_custkey_prf#3833,c_comment_prf#3834,c_address_prf#3835,c_mktsegment_prf#3836,c_phone_prf#3837] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3848 AS o_shippriority_prf_1#3858, rid#3849 AS rid_1#3859, o_orderdate_prf#3850 AS o_orderdate_prf_1#3860, o_custkey_prf#3851 AS o_custkey_prf_1#3861, o_orderpriority_prf#3852 AS o_orderpriority_prf_1#3862, o_clerk_prf#3853 AS o_clerk_prf_1#3863, o_orderstatus_prf#3854 AS o_orderstatus_prf_1#3864, o_totalprice_prf#3855 AS o_totalprice_prf_1#3865, o_orderkey_prf#3856 AS o_orderkey_prf_1#3866, o_comment_prf#3857 AS o_comment_prf_1#3867]
            +- Relation[o_shippriority_prf#3848,rid#3849,o_orderdate_prf#3850,o_custkey_prf#3851,o_orderpriority_prf#3852,o_clerk_prf#3853,o_orderstatus_prf#3854,o_totalprice_prf#3855,o_orderkey_prf#3856,o_comment_prf#3857] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1500000
Elapsed time: 40586ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/11 11:36:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:36:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3904L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 11:36:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3904L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#3927]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#3918: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#3906 AS p_comment_prf_0#3916, p_name_prf#3907 AS p_name_prf_0#3917, rid#3908 AS rid_0#3918, p_type_prf#3909 AS p_type_prf_0#3919, p_retailprice_prf#3910 AS p_retailprice_prf_0#3920, p_mfgr_prf#3911 AS p_mfgr_prf_0#3921, p_container_prf#3912 AS p_container_prf_0#3922, p_brand_prf#3913 AS p_brand_prf_0#3923, p_size_prf#3914 AS p_size_prf_0#3924, p_partkey_prf#3915 AS p_partkey_prf_0#3925]
         :     :  :  +- Relation[p_comment_prf#3906,p_name_prf#3907,rid#3908,p_type_prf#3909,p_retailprice_prf#3910,p_mfgr_prf#3911,p_container_prf#3912,p_brand_prf#3913,p_size_prf#3914,p_partkey_prf#3915] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3926]
         :     :     +- DexRidFilter part~p_size~15
         :     :        +- Relation[label#1938,value#1939] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#3928 AS ps_partkey_and_ps_suppkey_prf_1#3935, rid#3929 AS rid_1#3936, ps_availqty_prf#3930 AS ps_availqty_prf_1#3937, ps_comment_prf#3931 AS ps_comment_prf_1#3938, ps_partkey_prf#3932 AS ps_partkey_prf_1#3939, ps_supplycost_prf#3933 AS ps_supplycost_prf_1#3940, ps_suppkey_prf#3934 AS ps_suppkey_prf_1#3941]
            +- Relation[ps_partkey_and_ps_suppkey_prf#3928,rid#3929,ps_availqty_prf#3930,ps_comment_prf#3931,ps_partkey_prf#3932,ps_supplycost_prf#3933,ps_suppkey_prf#3934] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 390ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/11 11:36:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:36:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3983L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 11:36:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3983L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1544) AS rid_2#4020]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#3999]
         :     :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#3993: string
         :     :  :     :- Project [ps_partkey_and_ps_suppkey_prf#3985 AS ps_partkey_and_ps_suppkey_prf_0#3992, rid#3986 AS rid_0#3993, ps_availqty_prf#3987 AS ps_availqty_prf_0#3994, ps_comment_prf#3988 AS ps_comment_prf_0#3995, ps_partkey_prf#3989 AS ps_partkey_prf_0#3996, ps_supplycost_prf#3990 AS ps_supplycost_prf_0#3997, ps_suppkey_prf#3991 AS ps_suppkey_prf_0#3998]
         :     :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#3985,rid#3986,ps_availqty_prf#3987,ps_comment_prf#3988,ps_partkey_prf#3989,ps_supplycost_prf#3990,ps_suppkey_prf#3991] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#4000 AS p_comment_prf_1#4010, p_name_prf#4001 AS p_name_prf_1#4011, rid#4002 AS rid_1#4012, p_type_prf#4003 AS p_type_prf_1#4013, p_retailprice_prf#4004 AS p_retailprice_prf_1#4014, p_mfgr_prf#4005 AS p_mfgr_prf_1#4015, p_container_prf#4006 AS p_container_prf_1#4016, p_brand_prf#4007 AS p_brand_prf_1#4017, p_size_prf#4008 AS p_size_prf_1#4018, p_partkey_prf#4009 AS p_partkey_prf_1#4019]
         :     :     +- Relation[p_comment_prf#4000,p_name_prf#4001,rid#4002,p_type_prf#4003,p_retailprice_prf#4004,p_mfgr_prf#4005,p_container_prf#4006,p_brand_prf#4007,p_size_prf#4008,p_partkey_prf#4009] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4021 AS s_phone_prf_2#4029, rid#4022 AS rid_2#4030, s_address_prf#4023 AS s_address_prf_2#4031, s_nationkey_prf#4024 AS s_nationkey_prf_2#4032, s_suppkey_prf#4025 AS s_suppkey_prf_2#4033, s_name_prf#4026 AS s_name_prf_2#4034, s_acctbal_prf#4027 AS s_acctbal_prf_2#4035, s_comment_prf#4028 AS s_comment_prf_2#4036]
            +- Relation[s_phone_prf#4021,rid#4022,s_address_prf#4023,s_nationkey_prf#4024,s_suppkey_prf#4025,s_name_prf#4026,s_acctbal_prf#4027,s_comment_prf#4028] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 109322ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/11 11:38:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:38:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4079L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 11:38:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4079L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#4095]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#4089: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#4081 AS ps_partkey_and_ps_suppkey_prf_0#4088, rid#4082 AS rid_0#4089, ps_availqty_prf#4083 AS ps_availqty_prf_0#4090, ps_comment_prf#4084 AS ps_comment_prf_0#4091, ps_partkey_prf#4085 AS ps_partkey_prf_0#4092, ps_supplycost_prf#4086 AS ps_supplycost_prf_0#4093, ps_suppkey_prf#4087 AS ps_suppkey_prf_0#4094]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#4081,rid#4082,ps_availqty_prf#4083,ps_comment_prf#4084,ps_partkey_prf#4085,ps_supplycost_prf#4086,ps_suppkey_prf#4087] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#4096 AS p_comment_prf_1#4106, p_name_prf#4097 AS p_name_prf_1#4107, rid#4098 AS rid_1#4108, p_type_prf#4099 AS p_type_prf_1#4109, p_retailprice_prf#4100 AS p_retailprice_prf_1#4110, p_mfgr_prf#4101 AS p_mfgr_prf_1#4111, p_container_prf#4102 AS p_container_prf_1#4112, p_brand_prf#4103 AS p_brand_prf_1#4113, p_size_prf#4104 AS p_size_prf_1#4114, p_partkey_prf#4105 AS p_partkey_prf_1#4115]
            :  +- Relation[p_comment_prf#4096,p_name_prf#4097,rid#4098,p_type_prf#4099,p_retailprice_prf#4100,p_mfgr_prf#4101,p_container_prf#4102,p_brand_prf#4103,p_size_prf#4104,p_partkey_prf#4105] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4116]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1938,value#1939] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 50717ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/11 11:39:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:39:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4141L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 11:39:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4141L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#4143 AS rid_0#4148, n_regionkey_prf#4144 AS n_regionkey_prf_0#4149, n_nationkey_prf#4145 AS n_nationkey_prf_0#4150, n_name_prf#4146 AS n_name_prf_0#4151, n_comment_prf#4147 AS n_comment_prf_0#4152]
         :  +- Relation[rid#4143,n_regionkey_prf#4144,n_nationkey_prf#4145,n_name_prf#4146,n_comment_prf#4147] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4153]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1938,value#1939] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 53ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/11 11:39:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:39:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4194L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 11:39:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4194L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#4212]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#4205: string
         :     :- Project [s_phone_prf#4196 AS s_phone_prf_0#4204, rid#4197 AS rid_0#4205, s_address_prf#4198 AS s_address_prf_0#4206, s_nationkey_prf#4199 AS s_nationkey_prf_0#4207, s_suppkey_prf#4200 AS s_suppkey_prf_0#4208, s_name_prf#4201 AS s_name_prf_0#4209, s_acctbal_prf#4202 AS s_acctbal_prf_0#4210, s_comment_prf#4203 AS s_comment_prf_0#4211]
         :     :  +- Relation[s_phone_prf#4196,rid#4197,s_address_prf#4198,s_nationkey_prf#4199,s_suppkey_prf#4200,s_name_prf#4201,s_acctbal_prf#4202,s_comment_prf#4203] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1544) AS rid_2#4251]
            :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_1#4236: string
            :     :- Project [l_returnflag_prf#4213 AS l_returnflag_prf_1#4232, l_orderkey_and_l_linenumber_prf#4214 AS l_orderkey_and_l_linenumber_prf_1#4233, l_comment_prf#4215 AS l_comment_prf_1#4234, l_linestatus_prf#4216 AS l_linestatus_prf_1#4235, rid#4217 AS rid_1#4236, l_shipmode_prf#4218 AS l_shipmode_prf_1#4237, l_shipinstruct_prf#4219 AS l_shipinstruct_prf_1#4238, l_quantity_prf#4220 AS l_quantity_prf_1#4239, l_receiptdate_prf#4221 AS l_receiptdate_prf_1#4240, l_linenumber_prf#4222 AS l_linenumber_prf_1#4241, l_tax_prf#4223 AS l_tax_prf_1#4242, l_shipdate_prf#4224 AS l_shipdate_prf_1#4243, l_extendedprice_prf#4225 AS l_extendedprice_prf_1#4244, l_partkey_prf#4226 AS l_partkey_prf_1#4245, l_discount_prf#4227 AS l_discount_prf_1#4246, l_partkey_and_l_suppkey_prf#4228 AS l_partkey_and_l_suppkey_prf_1#4247, l_commitdate_prf#4229 AS l_commitdate_prf_1#4248, l_suppkey_prf#4230 AS l_suppkey_prf_1#4249, l_orderkey_prf#4231 AS l_orderkey_prf_1#4250]
            :     :  +- Relation[l_returnflag_prf#4213,l_orderkey_and_l_linenumber_prf#4214,l_comment_prf#4215,l_linestatus_prf#4216,rid#4217,l_shipmode_prf#4218,l_shipinstruct_prf#4219,l_quantity_prf#4220,l_receiptdate_prf#4221,l_linenumber_prf#4222,l_tax_prf#4223,l_shipdate_prf#4224,l_extendedprice_prf#4225,l_partkey_prf#4226,l_discount_prf#4227,l_partkey_and_l_suppkey_prf#4228,l_commitdate_prf#4229,l_suppkey_prf#4230,l_orderkey_prf#4231] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#4252 AS p_comment_prf_2#4262, p_name_prf#4253 AS p_name_prf_2#4263, rid#4254 AS rid_2#4264, p_type_prf#4255 AS p_type_prf_2#4265, p_retailprice_prf#4256 AS p_retailprice_prf_2#4266, p_mfgr_prf#4257 AS p_mfgr_prf_2#4267, p_container_prf#4258 AS p_container_prf_2#4268, p_brand_prf#4259 AS p_brand_prf_2#4269, p_size_prf#4260 AS p_size_prf_2#4270, p_partkey_prf#4261 AS p_partkey_prf_2#4271]
               +- Relation[p_comment_prf#4252,p_name_prf#4253,rid#4254,p_type_prf#4255,p_retailprice_prf#4256,p_mfgr_prf#4257,p_container_prf#4258,p_brand_prf#4259,p_size_prf#4260,p_partkey_prf#4261] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 200917ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/11 11:42:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:42:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4345L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 11:42:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4345L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#4385]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4370: string
         :     :- Project [l_returnflag_prf#4347 AS l_returnflag_prf_0#4366, l_orderkey_and_l_linenumber_prf#4348 AS l_orderkey_and_l_linenumber_prf_0#4367, l_comment_prf#4349 AS l_comment_prf_0#4368, l_linestatus_prf#4350 AS l_linestatus_prf_0#4369, rid#4351 AS rid_0#4370, l_shipmode_prf#4352 AS l_shipmode_prf_0#4371, l_shipinstruct_prf#4353 AS l_shipinstruct_prf_0#4372, l_quantity_prf#4354 AS l_quantity_prf_0#4373, l_receiptdate_prf#4355 AS l_receiptdate_prf_0#4374, l_linenumber_prf#4356 AS l_linenumber_prf_0#4375, l_tax_prf#4357 AS l_tax_prf_0#4376, l_shipdate_prf#4358 AS l_shipdate_prf_0#4377, l_extendedprice_prf#4359 AS l_extendedprice_prf_0#4378, l_partkey_prf#4360 AS l_partkey_prf_0#4379, l_discount_prf#4361 AS l_discount_prf_0#4380, l_partkey_and_l_suppkey_prf#4362 AS l_partkey_and_l_suppkey_prf_0#4381, l_commitdate_prf#4363 AS l_commitdate_prf_0#4382, l_suppkey_prf#4364 AS l_suppkey_prf_0#4383, l_orderkey_prf#4365 AS l_orderkey_prf_0#4384]
         :     :  +- Relation[l_returnflag_prf#4347,l_orderkey_and_l_linenumber_prf#4348,l_comment_prf#4349,l_linestatus_prf#4350,rid#4351,l_shipmode_prf#4352,l_shipinstruct_prf#4353,l_quantity_prf#4354,l_receiptdate_prf#4355,l_linenumber_prf#4356,l_tax_prf#4357,l_shipdate_prf#4358,l_extendedprice_prf#4359,l_partkey_prf#4360,l_discount_prf#4361,l_partkey_and_l_suppkey_prf#4362,l_commitdate_prf#4363,l_suppkey_prf#4364,l_orderkey_prf#4365] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1544) AS rid_2#4406]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#4397: string
            :     :- Project [o_shippriority_prf#4386 AS o_shippriority_prf_1#4396, rid#4387 AS rid_1#4397, o_orderdate_prf#4388 AS o_orderdate_prf_1#4398, o_custkey_prf#4389 AS o_custkey_prf_1#4399, o_orderpriority_prf#4390 AS o_orderpriority_prf_1#4400, o_clerk_prf#4391 AS o_clerk_prf_1#4401, o_orderstatus_prf#4392 AS o_orderstatus_prf_1#4402, o_totalprice_prf#4393 AS o_totalprice_prf_1#4403, o_orderkey_prf#4394 AS o_orderkey_prf_1#4404, o_comment_prf#4395 AS o_comment_prf_1#4405]
            :     :  +- Relation[o_shippriority_prf#4386,rid#4387,o_orderdate_prf#4388,o_custkey_prf#4389,o_orderpriority_prf#4390,o_clerk_prf#4391,o_orderstatus_prf#4392,o_totalprice_prf#4393,o_orderkey_prf#4394,o_comment_prf#4395] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4407 AS c_acctbal_prf_2#4416, rid#4408 AS rid_2#4417, c_name_prf#4409 AS c_name_prf_2#4418, c_nationkey_prf#4410 AS c_nationkey_prf_2#4419, c_custkey_prf#4411 AS c_custkey_prf_2#4420, c_comment_prf#4412 AS c_comment_prf_2#4421, c_address_prf#4413 AS c_address_prf_2#4422, c_mktsegment_prf#4414 AS c_mktsegment_prf_2#4423, c_phone_prf#4415 AS c_phone_prf_2#4424]
               +- Relation[c_acctbal_prf#4407,rid#4408,c_name_prf#4409,c_nationkey_prf#4410,c_custkey_prf#4411,c_comment_prf#4412,c_address_prf#4413,c_mktsegment_prf#4414,c_phone_prf#4415] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 169789ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/11 11:45:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:45:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4478L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 11:45:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4478L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#4490]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#4485: string
         :     :- Project [rid#4480 AS rid_0#4485, n_regionkey_prf#4481 AS n_regionkey_prf_0#4486, n_nationkey_prf#4482 AS n_nationkey_prf_0#4487, n_name_prf#4483 AS n_name_prf_0#4488, n_comment_prf#4484 AS n_comment_prf_0#4489]
         :     :  +- Relation[rid#4480,n_regionkey_prf#4481,n_nationkey_prf#4482,n_name_prf#4483,n_comment_prf#4484] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4491 AS c_acctbal_prf_1#4500, rid#4492 AS rid_1#4501, c_name_prf#4493 AS c_name_prf_1#4502, c_nationkey_prf#4494 AS c_nationkey_prf_1#4503, c_custkey_prf#4495 AS c_custkey_prf_1#4504, c_comment_prf#4496 AS c_comment_prf_1#4505, c_address_prf#4497 AS c_address_prf_1#4506, c_mktsegment_prf#4498 AS c_mktsegment_prf_1#4507, c_phone_prf#4499 AS c_phone_prf_1#4508]
            +- Relation[c_acctbal_prf#4491,rid#4492,c_name_prf#4493,c_nationkey_prf#4494,c_custkey_prf#4495,c_comment_prf#4496,c_address_prf#4497,c_mktsegment_prf#4498,c_phone_prf#4499] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=150000
Elapsed time: 1940ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/11 11:45:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:45:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4551L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 11:45:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4551L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#4592]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4576: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#4553 AS l_returnflag_prf_0#4572, l_orderkey_and_l_linenumber_prf#4554 AS l_orderkey_and_l_linenumber_prf_0#4573, l_comment_prf#4555 AS l_comment_prf_0#4574, l_linestatus_prf#4556 AS l_linestatus_prf_0#4575, rid#4557 AS rid_0#4576, l_shipmode_prf#4558 AS l_shipmode_prf_0#4577, l_shipinstruct_prf#4559 AS l_shipinstruct_prf_0#4578, l_quantity_prf#4560 AS l_quantity_prf_0#4579, l_receiptdate_prf#4561 AS l_receiptdate_prf_0#4580, l_linenumber_prf#4562 AS l_linenumber_prf_0#4581, l_tax_prf#4563 AS l_tax_prf_0#4582, l_shipdate_prf#4564 AS l_shipdate_prf_0#4583, l_extendedprice_prf#4565 AS l_extendedprice_prf_0#4584, l_partkey_prf#4566 AS l_partkey_prf_0#4585, l_discount_prf#4567 AS l_discount_prf_0#4586, l_partkey_and_l_suppkey_prf#4568 AS l_partkey_and_l_suppkey_prf_0#4587, l_commitdate_prf#4569 AS l_commitdate_prf_0#4588, l_suppkey_prf#4570 AS l_suppkey_prf_0#4589, l_orderkey_prf#4571 AS l_orderkey_prf_0#4590]
         :     :  :  +- Relation[l_returnflag_prf#4553,l_orderkey_and_l_linenumber_prf#4554,l_comment_prf#4555,l_linestatus_prf#4556,rid#4557,l_shipmode_prf#4558,l_shipinstruct_prf#4559,l_quantity_prf#4560,l_receiptdate_prf#4561,l_linenumber_prf#4562,l_tax_prf#4563,l_shipdate_prf#4564,l_extendedprice_prf#4565,l_partkey_prf#4566,l_discount_prf#4567,l_partkey_and_l_suppkey_prf#4568,l_commitdate_prf#4569,l_suppkey_prf#4570,l_orderkey_prf#4571] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4591]
         :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :        +- Relation[label#1938,value#1939] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4593 AS o_shippriority_prf_1#4603, rid#4594 AS rid_1#4604, o_orderdate_prf#4595 AS o_orderdate_prf_1#4605, o_custkey_prf#4596 AS o_custkey_prf_1#4606, o_orderpriority_prf#4597 AS o_orderpriority_prf_1#4607, o_clerk_prf#4598 AS o_clerk_prf_1#4608, o_orderstatus_prf#4599 AS o_orderstatus_prf_1#4609, o_totalprice_prf#4600 AS o_totalprice_prf_1#4610, o_orderkey_prf#4601 AS o_orderkey_prf_1#4611, o_comment_prf#4602 AS o_comment_prf_1#4612]
            +- Relation[o_shippriority_prf#4593,rid#4594,o_orderdate_prf#4595,o_custkey_prf#4596,o_orderpriority_prf#4597,o_clerk_prf#4598,o_orderstatus_prf#4599,o_totalprice_prf#4600,o_orderkey_prf#4601,o_comment_prf#4602] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 57719ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/11 11:46:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:46:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4659L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 11:46:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4659L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#4681]
         :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4673: string
         :     :- Project [p_comment_prf#4661 AS p_comment_prf_0#4671, p_name_prf#4662 AS p_name_prf_0#4672, rid#4663 AS rid_0#4673, p_type_prf#4664 AS p_type_prf_0#4674, p_retailprice_prf#4665 AS p_retailprice_prf_0#4675, p_mfgr_prf#4666 AS p_mfgr_prf_0#4676, p_container_prf#4667 AS p_container_prf_0#4677, p_brand_prf#4668 AS p_brand_prf_0#4678, p_size_prf#4669 AS p_size_prf_0#4679, p_partkey_prf#4670 AS p_partkey_prf_0#4680]
         :     :  +- Relation[p_comment_prf#4661,p_name_prf#4662,rid#4663,p_type_prf#4664,p_retailprice_prf#4665,p_mfgr_prf#4666,p_container_prf#4667,p_brand_prf#4668,p_size_prf#4669,p_partkey_prf#4670] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4682 AS ps_partkey_and_ps_suppkey_prf_1#4689, rid#4683 AS rid_1#4690, ps_availqty_prf#4684 AS ps_availqty_prf_1#4691, ps_comment_prf#4685 AS ps_comment_prf_1#4692, ps_partkey_prf#4686 AS ps_partkey_prf_1#4693, ps_supplycost_prf#4687 AS ps_supplycost_prf_1#4694, ps_suppkey_prf#4688 AS ps_suppkey_prf_1#4695]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4682,rid#4683,ps_availqty_prf#4684,ps_comment_prf#4685,ps_partkey_prf#4686,ps_supplycost_prf#4687,ps_suppkey_prf#4688] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 32187ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/11 11:46:56 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:46:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4735L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 11:46:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4735L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#1544) AS rid_2#4764]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#4753]
         :     :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#4746: string
         :     :  :     :- Project [s_phone_prf#4737 AS s_phone_prf_0#4745, rid#4738 AS rid_0#4746, s_address_prf#4739 AS s_address_prf_0#4747, s_nationkey_prf#4740 AS s_nationkey_prf_0#4748, s_suppkey_prf#4741 AS s_suppkey_prf_0#4749, s_name_prf#4742 AS s_name_prf_0#4750, s_acctbal_prf#4743 AS s_acctbal_prf_0#4751, s_comment_prf#4744 AS s_comment_prf_0#4752]
         :     :  :     :  +- Relation[s_phone_prf#4737,rid#4738,s_address_prf#4739,s_nationkey_prf#4740,s_suppkey_prf#4741,s_name_prf#4742,s_acctbal_prf#4743,s_comment_prf#4744] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [rid#4754 AS rid_1#4759, n_regionkey_prf#4755 AS n_regionkey_prf_1#4760, n_nationkey_prf#4756 AS n_nationkey_prf_1#4761, n_name_prf#4757 AS n_name_prf_1#4762, n_comment_prf#4758 AS n_comment_prf_1#4763]
         :     :     +- Relation[rid#4754,n_regionkey_prf#4755,n_nationkey_prf#4756,n_name_prf#4757,n_comment_prf#4758] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4765 AS c_acctbal_prf_2#4774, rid#4766 AS rid_2#4775, c_name_prf#4767 AS c_name_prf_2#4776, c_nationkey_prf#4768 AS c_nationkey_prf_2#4777, c_custkey_prf#4769 AS c_custkey_prf_2#4778, c_comment_prf#4770 AS c_comment_prf_2#4779, c_address_prf#4771 AS c_address_prf_2#4780, c_mktsegment_prf#4772 AS c_mktsegment_prf_2#4781, c_phone_prf#4773 AS c_phone_prf_2#4782]
            +- Relation[c_acctbal_prf#4765,rid#4766,c_name_prf#4767,c_nationkey_prf#4768,c_custkey_prf#4769,c_comment_prf#4770,c_address_prf#4771,c_mktsegment_prf#4772,c_phone_prf#4773] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 666234ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/11 11:58:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 11:58:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4833L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 11:58:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4833L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#4855]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#4846: string
         :     :- Project [o_shippriority_prf#4835 AS o_shippriority_prf_0#4845, rid#4836 AS rid_0#4846, o_orderdate_prf#4837 AS o_orderdate_prf_0#4847, o_custkey_prf#4838 AS o_custkey_prf_0#4848, o_orderpriority_prf#4839 AS o_orderpriority_prf_0#4849, o_clerk_prf#4840 AS o_clerk_prf_0#4850, o_orderstatus_prf#4841 AS o_orderstatus_prf_0#4851, o_totalprice_prf#4842 AS o_totalprice_prf_0#4852, o_orderkey_prf#4843 AS o_orderkey_prf_0#4853, o_comment_prf#4844 AS o_comment_prf_0#4854]
         :     :  +- Relation[o_shippriority_prf#4835,rid#4836,o_orderdate_prf#4837,o_custkey_prf#4838,o_orderpriority_prf#4839,o_clerk_prf#4840,o_orderstatus_prf#4841,o_totalprice_prf#4842,o_orderkey_prf#4843,o_comment_prf#4844] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#4856 AS l_returnflag_prf_1#4875, l_orderkey_and_l_linenumber_prf#4857 AS l_orderkey_and_l_linenumber_prf_1#4876, l_comment_prf#4858 AS l_comment_prf_1#4877, l_linestatus_prf#4859 AS l_linestatus_prf_1#4878, rid#4860 AS rid_1#4879, l_shipmode_prf#4861 AS l_shipmode_prf_1#4880, l_shipinstruct_prf#4862 AS l_shipinstruct_prf_1#4881, l_quantity_prf#4863 AS l_quantity_prf_1#4882, l_receiptdate_prf#4864 AS l_receiptdate_prf_1#4883, l_linenumber_prf#4865 AS l_linenumber_prf_1#4884, l_tax_prf#4866 AS l_tax_prf_1#4885, l_shipdate_prf#4867 AS l_shipdate_prf_1#4886, l_extendedprice_prf#4868 AS l_extendedprice_prf_1#4887, l_partkey_prf#4869 AS l_partkey_prf_1#4888, l_discount_prf#4870 AS l_discount_prf_1#4889, l_partkey_and_l_suppkey_prf#4871 AS l_partkey_and_l_suppkey_prf_1#4890, l_commitdate_prf#4872 AS l_commitdate_prf_1#4891, l_suppkey_prf#4873 AS l_suppkey_prf_1#4892, l_orderkey_prf#4874 AS l_orderkey_prf_1#4893]
            :  +- Relation[l_returnflag_prf#4856,l_orderkey_and_l_linenumber_prf#4857,l_comment_prf#4858,l_linestatus_prf#4859,rid#4860,l_shipmode_prf#4861,l_shipinstruct_prf#4862,l_quantity_prf#4863,l_receiptdate_prf#4864,l_linenumber_prf#4865,l_tax_prf#4866,l_shipdate_prf#4867,l_extendedprice_prf#4868,l_partkey_prf#4869,l_discount_prf#4870,l_partkey_and_l_suppkey_prf#4871,l_commitdate_prf#4872,l_suppkey_prf#4873,l_orderkey_prf#4874] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4894]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1938,value#1939] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 201581ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/11 12:01:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 12:01:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4948L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 12:01:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4948L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_2#4966]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#4959: string
         :     :- Project [s_phone_prf#4950 AS s_phone_prf_0#4958, rid#4951 AS rid_0#4959, s_address_prf#4952 AS s_address_prf_0#4960, s_nationkey_prf#4953 AS s_nationkey_prf_0#4961, s_suppkey_prf#4954 AS s_suppkey_prf_0#4962, s_name_prf#4955 AS s_name_prf_0#4963, s_acctbal_prf#4956 AS s_acctbal_prf_0#4964, s_comment_prf#4957 AS s_comment_prf_0#4965]
         :     :  +- Relation[s_phone_prf#4950,rid#4951,s_address_prf#4952,s_nationkey_prf#4953,s_suppkey_prf#4954,s_name_prf#4955,s_acctbal_prf#4956,s_comment_prf#4957] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1544) AS rid_2#4987]
            :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#4979: string
            :     :- Project [p_comment_prf#4967 AS p_comment_prf_1#4977, p_name_prf#4968 AS p_name_prf_1#4978, rid#4969 AS rid_1#4979, p_type_prf#4970 AS p_type_prf_1#4980, p_retailprice_prf#4971 AS p_retailprice_prf_1#4981, p_mfgr_prf#4972 AS p_mfgr_prf_1#4982, p_container_prf#4973 AS p_container_prf_1#4983, p_brand_prf#4974 AS p_brand_prf_1#4984, p_size_prf#4975 AS p_size_prf_1#4985, p_partkey_prf#4976 AS p_partkey_prf_1#4986]
            :     :  +- Relation[p_comment_prf#4967,p_name_prf#4968,rid#4969,p_type_prf#4970,p_retailprice_prf#4971,p_mfgr_prf#4972,p_container_prf#4973,p_brand_prf#4974,p_size_prf#4975,p_partkey_prf#4976] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#4988 AS ps_partkey_and_ps_suppkey_prf_2#4995, rid#4989 AS rid_2#4996, ps_availqty_prf#4990 AS ps_availqty_prf_2#4997, ps_comment_prf#4991 AS ps_comment_prf_2#4998, ps_partkey_prf#4992 AS ps_partkey_prf_2#4999, ps_supplycost_prf#4993 AS ps_supplycost_prf_2#5000, ps_suppkey_prf#4994 AS ps_suppkey_prf_2#5001]
               +- Relation[ps_partkey_and_ps_suppkey_prf#4988,rid#4989,ps_availqty_prf#4990,ps_comment_prf#4991,ps_partkey_prf#4992,ps_supplycost_prf#4993,ps_suppkey_prf#4994] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 43836ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/11 12:02:08 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 12:02:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5055L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 12:02:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5055L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#5095]
         :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#5080: string
         :     :- Project [l_returnflag_prf#5057 AS l_returnflag_prf_0#5076, l_orderkey_and_l_linenumber_prf#5058 AS l_orderkey_and_l_linenumber_prf_0#5077, l_comment_prf#5059 AS l_comment_prf_0#5078, l_linestatus_prf#5060 AS l_linestatus_prf_0#5079, rid#5061 AS rid_0#5080, l_shipmode_prf#5062 AS l_shipmode_prf_0#5081, l_shipinstruct_prf#5063 AS l_shipinstruct_prf_0#5082, l_quantity_prf#5064 AS l_quantity_prf_0#5083, l_receiptdate_prf#5065 AS l_receiptdate_prf_0#5084, l_linenumber_prf#5066 AS l_linenumber_prf_0#5085, l_tax_prf#5067 AS l_tax_prf_0#5086, l_shipdate_prf#5068 AS l_shipdate_prf_0#5087, l_extendedprice_prf#5069 AS l_extendedprice_prf_0#5088, l_partkey_prf#5070 AS l_partkey_prf_0#5089, l_discount_prf#5071 AS l_discount_prf_0#5090, l_partkey_and_l_suppkey_prf#5072 AS l_partkey_and_l_suppkey_prf_0#5091, l_commitdate_prf#5073 AS l_commitdate_prf_0#5092, l_suppkey_prf#5074 AS l_suppkey_prf_0#5093, l_orderkey_prf#5075 AS l_orderkey_prf_0#5094]
         :     :  +- Relation[l_returnflag_prf#5057,l_orderkey_and_l_linenumber_prf#5058,l_comment_prf#5059,l_linestatus_prf#5060,rid#5061,l_shipmode_prf#5062,l_shipinstruct_prf#5063,l_quantity_prf#5064,l_receiptdate_prf#5065,l_linenumber_prf#5066,l_tax_prf#5067,l_shipdate_prf#5068,l_extendedprice_prf#5069,l_partkey_prf#5070,l_discount_prf#5071,l_partkey_and_l_suppkey_prf#5072,l_commitdate_prf#5073,l_suppkey_prf#5074,l_orderkey_prf#5075] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#5096 AS p_comment_prf_1#5106, p_name_prf#5097 AS p_name_prf_1#5107, rid#5098 AS rid_1#5108, p_type_prf#5099 AS p_type_prf_1#5109, p_retailprice_prf#5100 AS p_retailprice_prf_1#5110, p_mfgr_prf#5101 AS p_mfgr_prf_1#5111, p_container_prf#5102 AS p_container_prf_1#5112, p_brand_prf#5103 AS p_brand_prf_1#5113, p_size_prf#5104 AS p_size_prf_1#5114, p_partkey_prf#5105 AS p_partkey_prf_1#5115]
            +- Relation[p_comment_prf#5096,p_name_prf#5097,rid#5098,p_type_prf#5099,p_retailprice_prf#5100,p_mfgr_prf#5101,p_container_prf#5102,p_brand_prf#5103,p_size_prf#5104,p_partkey_prf#5105] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 129680ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/11 12:04:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 12:04:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5173L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 12:04:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5173L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#5195]
         :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#5187: string
         :     :- Project [p_comment_prf#5175 AS p_comment_prf_0#5185, p_name_prf#5176 AS p_name_prf_0#5186, rid#5177 AS rid_0#5187, p_type_prf#5178 AS p_type_prf_0#5188, p_retailprice_prf#5179 AS p_retailprice_prf_0#5189, p_mfgr_prf#5180 AS p_mfgr_prf_0#5190, p_container_prf#5181 AS p_container_prf_0#5191, p_brand_prf#5182 AS p_brand_prf_0#5192, p_size_prf#5183 AS p_size_prf_0#5193, p_partkey_prf#5184 AS p_partkey_prf_0#5194]
         :     :  +- Relation[p_comment_prf#5175,p_name_prf#5176,rid#5177,p_type_prf#5178,p_retailprice_prf#5179,p_mfgr_prf#5180,p_container_prf#5181,p_brand_prf#5182,p_size_prf#5183,p_partkey_prf#5184] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5196 AS l_returnflag_prf_1#5215, l_orderkey_and_l_linenumber_prf#5197 AS l_orderkey_and_l_linenumber_prf_1#5216, l_comment_prf#5198 AS l_comment_prf_1#5217, l_linestatus_prf#5199 AS l_linestatus_prf_1#5218, rid#5200 AS rid_1#5219, l_shipmode_prf#5201 AS l_shipmode_prf_1#5220, l_shipinstruct_prf#5202 AS l_shipinstruct_prf_1#5221, l_quantity_prf#5203 AS l_quantity_prf_1#5222, l_receiptdate_prf#5204 AS l_receiptdate_prf_1#5223, l_linenumber_prf#5205 AS l_linenumber_prf_1#5224, l_tax_prf#5206 AS l_tax_prf_1#5225, l_shipdate_prf#5207 AS l_shipdate_prf_1#5226, l_extendedprice_prf#5208 AS l_extendedprice_prf_1#5227, l_partkey_prf#5209 AS l_partkey_prf_1#5228, l_discount_prf#5210 AS l_discount_prf_1#5229, l_partkey_and_l_suppkey_prf#5211 AS l_partkey_and_l_suppkey_prf_1#5230, l_commitdate_prf#5212 AS l_commitdate_prf_1#5231, l_suppkey_prf#5213 AS l_suppkey_prf_1#5232, l_orderkey_prf#5214 AS l_orderkey_prf_1#5233]
            +- Relation[l_returnflag_prf#5196,l_orderkey_and_l_linenumber_prf#5197,l_comment_prf#5198,l_linestatus_prf#5199,rid#5200,l_shipmode_prf#5201,l_shipinstruct_prf#5202,l_quantity_prf#5203,l_receiptdate_prf#5204,l_linenumber_prf#5205,l_tax_prf#5206,l_shipdate_prf#5207,l_extendedprice_prf#5208,l_partkey_prf#5209,l_discount_prf#5210,l_partkey_and_l_suppkey_prf#5211,l_commitdate_prf#5212,l_suppkey_prf#5213,l_orderkey_prf#5214] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 96505ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/11 12:05:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 12:05:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5299L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 12:05:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5299L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1544) AS rid_1#5319]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#5311: string
         :     :- Project [c_acctbal_prf#5301 AS c_acctbal_prf_0#5310, rid#5302 AS rid_0#5311, c_name_prf#5303 AS c_name_prf_0#5312, c_nationkey_prf#5304 AS c_nationkey_prf_0#5313, c_custkey_prf#5305 AS c_custkey_prf_0#5314, c_comment_prf#5306 AS c_comment_prf_0#5315, c_address_prf#5307 AS c_address_prf_0#5316, c_mktsegment_prf#5308 AS c_mktsegment_prf_0#5317, c_phone_prf#5309 AS c_phone_prf_0#5318]
         :     :  +- Relation[c_acctbal_prf#5301,rid#5302,c_name_prf#5303,c_nationkey_prf#5304,c_custkey_prf#5305,c_comment_prf#5306,c_address_prf#5307,c_mktsegment_prf#5308,c_phone_prf#5309] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1544) AS rid_2#5340]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#5331: string
            :     :- Project [o_shippriority_prf#5320 AS o_shippriority_prf_1#5330, rid#5321 AS rid_1#5331, o_orderdate_prf#5322 AS o_orderdate_prf_1#5332, o_custkey_prf#5323 AS o_custkey_prf_1#5333, o_orderpriority_prf#5324 AS o_orderpriority_prf_1#5334, o_clerk_prf#5325 AS o_clerk_prf_1#5335, o_orderstatus_prf#5326 AS o_orderstatus_prf_1#5336, o_totalprice_prf#5327 AS o_totalprice_prf_1#5337, o_orderkey_prf#5328 AS o_orderkey_prf_1#5338, o_comment_prf#5329 AS o_comment_prf_1#5339]
            :     :  +- Relation[o_shippriority_prf#5320,rid#5321,o_orderdate_prf#5322,o_custkey_prf#5323,o_orderpriority_prf#5324,o_clerk_prf#5325,o_orderstatus_prf#5326,o_totalprice_prf#5327,o_orderkey_prf#5328,o_comment_prf#5329] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1543,value#1544] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#5341 AS l_returnflag_prf_2#5360, l_orderkey_and_l_linenumber_prf#5342 AS l_orderkey_and_l_linenumber_prf_2#5361, l_comment_prf#5343 AS l_comment_prf_2#5362, l_linestatus_prf#5344 AS l_linestatus_prf_2#5363, rid#5345 AS rid_2#5364, l_shipmode_prf#5346 AS l_shipmode_prf_2#5365, l_shipinstruct_prf#5347 AS l_shipinstruct_prf_2#5366, l_quantity_prf#5348 AS l_quantity_prf_2#5367, l_receiptdate_prf#5349 AS l_receiptdate_prf_2#5368, l_linenumber_prf#5350 AS l_linenumber_prf_2#5369, l_tax_prf#5351 AS l_tax_prf_2#5370, l_shipdate_prf#5352 AS l_shipdate_prf_2#5371, l_extendedprice_prf#5353 AS l_extendedprice_prf_2#5372, l_partkey_prf#5354 AS l_partkey_prf_2#5373, l_discount_prf#5355 AS l_discount_prf_2#5374, l_partkey_and_l_suppkey_prf#5356 AS l_partkey_and_l_suppkey_prf_2#5375, l_commitdate_prf#5357 AS l_commitdate_prf_2#5376, l_suppkey_prf#5358 AS l_suppkey_prf_2#5377, l_orderkey_prf#5359 AS l_orderkey_prf_2#5378]
               +- Relation[l_returnflag_prf#5341,l_orderkey_and_l_linenumber_prf#5342,l_comment_prf#5343,l_linestatus_prf#5344,rid#5345,l_shipmode_prf#5346,l_shipinstruct_prf#5347,l_quantity_prf#5348,l_receiptdate_prf#5349,l_linenumber_prf#5350,l_tax_prf#5351,l_shipdate_prf#5352,l_extendedprice_prf#5353,l_partkey_prf#5354,l_discount_prf#5355,l_partkey_and_l_suppkey_prf#5356,l_commitdate_prf#5357,l_suppkey_prf#5358,l_orderkey_prf#5359] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 238605ms
query=b1a, count=15628, duration=390
query=b1b, count=15628, duration=50717
query=b2a, count=1478870, duration=201581
query=b2b, count=1478870, duration=57719
query=f1, count=1, duration=50
query=f2, count=3907, duration=115
query=f3, count=1451, duration=91
query=f4, count=1, duration=53
query=f5, count=1478870, duration=23743
query=f6, count=857401, duration=13935
query=j1, count=800000, duration=32187
query=j10, count=6001215, duration=88855
query=j2, count=800000, duration=11268
query=j3, count=25, duration=71
query=j4, count=150000, duration=1940
query=j5, count=10000, duration=189
query=j6, count=6001215, duration=118786
query=j7, count=1500000, duration=40586
query=j8, count=6001215, duration=199593
query=j8b, count=6001215, duration=130797
query=j9, count=6001215, duration=96505
query=j9b, count=6001215, duration=129680
query=r1a, count=6001215, duration=346305
query=r1b, count=6001215, duration=169789
query=r1c, count=6001215, duration=176782
query=r1d, count=6001215, duration=185815
query=r1e, count=6001215, duration=238605
query=r1f, count=6001215, duration=176143
query=t1a, count=60000414, duration=666234
query=t1b, count=60000414, duration=791294
query=t1c, count=60000414, duration=43278
query=t2a, count=800000, duration=109322
query=t2b, count=800000, duration=94357
query=t2c, count=800000, duration=43836
query=t2d, count=800000, duration=62340
query=t3a, count=6001215, duration=295120
query=t3b, count=6001215, duration=314030
query=t3c, count=6001215, duration=191216
query=t3d, count=6001215, duration=200917
