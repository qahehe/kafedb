19/10/11 01:48:10 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7173ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Fri Oct 11 01:48:12 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Fri Oct 11 01:48:13 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Fri Oct 11 01:48:13 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Fri Oct 11 01:48:13 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Fri Oct 11 01:48:13 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Fri Oct 11 01:48:16 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Fri Oct 11 01:48:18 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Fri Oct 11 01:48:18 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/11 01:48:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:48:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1492L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 01:48:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1492L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#1512]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#1503: string
         :     :- Project [s_phone_prf#1494 AS s_phone_prf_0#1502, rid#1495 AS rid_0#1503, s_address_prf#1496 AS s_address_prf_0#1504, s_nationkey_prf#1497 AS s_nationkey_prf_0#1505, s_suppkey_prf#1498 AS s_suppkey_prf_0#1506, s_name_prf#1499 AS s_name_prf_0#1507, s_acctbal_prf#1500 AS s_acctbal_prf_0#1508, s_comment_prf#1501 AS s_comment_prf_0#1509]
         :     :  +- Relation[s_phone_prf#1494,rid#1495,s_address_prf#1496,s_nationkey_prf#1497,s_suppkey_prf#1498,s_name_prf#1499,s_acctbal_prf#1500,s_comment_prf#1501] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#1527]
            :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_1#1521: string
            :     :- Project [ps_partkey_and_ps_suppkey_prf#1513 AS ps_partkey_and_ps_suppkey_prf_1#1520, rid#1514 AS rid_1#1521, ps_availqty_prf#1515 AS ps_availqty_prf_1#1522, ps_comment_prf#1516 AS ps_comment_prf_1#1523, ps_partkey_prf#1517 AS ps_partkey_prf_1#1524, ps_supplycost_prf#1518 AS ps_supplycost_prf_1#1525, ps_suppkey_prf#1519 AS ps_suppkey_prf_1#1526]
            :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#1513,rid#1514,ps_availqty_prf#1515,ps_comment_prf#1516,ps_partkey_prf#1517,ps_supplycost_prf#1518,ps_suppkey_prf#1519] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#1528 AS p_comment_prf_2#1538, p_name_prf#1529 AS p_name_prf_2#1539, rid#1530 AS rid_2#1540, p_type_prf#1531 AS p_type_prf_2#1541, p_retailprice_prf#1532 AS p_retailprice_prf_2#1542, p_mfgr_prf#1533 AS p_mfgr_prf_2#1543, p_container_prf#1534 AS p_container_prf_2#1544, p_brand_prf#1535 AS p_brand_prf_2#1545, p_size_prf#1536 AS p_size_prf_2#1546, p_partkey_prf#1537 AS p_partkey_prf_2#1547]
               +- Relation[p_comment_prf#1528,p_name_prf#1529,rid#1530,p_type_prf#1531,p_retailprice_prf#1532,p_mfgr_prf#1533,p_container_prf#1534,p_brand_prf#1535,p_size_prf#1536,p_partkey_prf#1537] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 62337ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/11 01:49:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 01:49:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1595L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 01:49:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1595L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#1624]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#1607]
         :     :  :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#1602: string
         :     :  :     :- Project [rid#1597 AS rid_0#1602, n_regionkey_prf#1598 AS n_regionkey_prf_0#1603, n_nationkey_prf#1599 AS n_nationkey_prf_0#1604, n_name_prf#1600 AS n_name_prf_0#1605, n_comment_prf#1601 AS n_comment_prf_0#1606]
         :     :  :     :  +- Relation[rid#1597,n_regionkey_prf#1598,n_nationkey_prf#1599,n_name_prf#1600,n_comment_prf#1601] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#1608 AS s_phone_prf_1#1616, rid#1609 AS rid_1#1617, s_address_prf#1610 AS s_address_prf_1#1618, s_nationkey_prf#1611 AS s_nationkey_prf_1#1619, s_suppkey_prf#1612 AS s_suppkey_prf_1#1620, s_name_prf#1613 AS s_name_prf_1#1621, s_acctbal_prf#1614 AS s_acctbal_prf_1#1622, s_comment_prf#1615 AS s_comment_prf_1#1623]
         :     :     +- Relation[s_phone_prf#1608,rid#1609,s_address_prf#1610,s_nationkey_prf#1611,s_suppkey_prf#1612,s_name_prf#1613,s_acctbal_prf#1614,s_comment_prf#1615] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#1625 AS c_acctbal_prf_2#1634, rid#1626 AS rid_2#1635, c_name_prf#1627 AS c_name_prf_2#1636, c_nationkey_prf#1628 AS c_nationkey_prf_2#1637, c_custkey_prf#1629 AS c_custkey_prf_2#1638, c_comment_prf#1630 AS c_comment_prf_2#1639, c_address_prf#1631 AS c_address_prf_2#1640, c_mktsegment_prf#1632 AS c_mktsegment_prf_2#1641, c_phone_prf#1633 AS c_phone_prf_2#1642]
            +- Relation[c_acctbal_prf#1625,rid#1626,c_name_prf#1627,c_nationkey_prf#1628,c_custkey_prf#1629,c_comment_prf#1630,c_address_prf#1631,c_mktsegment_prf#1632,c_phone_prf#1633] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 783029ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/11 02:02:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:02:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1691L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 02:02:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1691L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#1709]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#1702: string
         :     :- Project [s_phone_prf#1693 AS s_phone_prf_0#1701, rid#1694 AS rid_0#1702, s_address_prf#1695 AS s_address_prf_0#1703, s_nationkey_prf#1696 AS s_nationkey_prf_0#1704, s_suppkey_prf#1697 AS s_suppkey_prf_0#1705, s_name_prf#1698 AS s_name_prf_0#1706, s_acctbal_prf#1699 AS s_acctbal_prf_0#1707, s_comment_prf#1700 AS s_comment_prf_0#1708]
         :     :  +- Relation[s_phone_prf#1693,rid#1694,s_address_prf#1695,s_nationkey_prf#1696,s_suppkey_prf#1697,s_name_prf#1698,s_acctbal_prf#1699,s_comment_prf#1700] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1710 AS l_returnflag_prf_1#1729, l_orderkey_and_l_linenumber_prf#1711 AS l_orderkey_and_l_linenumber_prf_1#1730, l_comment_prf#1712 AS l_comment_prf_1#1731, l_linestatus_prf#1713 AS l_linestatus_prf_1#1732, rid#1714 AS rid_1#1733, l_shipmode_prf#1715 AS l_shipmode_prf_1#1734, l_shipinstruct_prf#1716 AS l_shipinstruct_prf_1#1735, l_quantity_prf#1717 AS l_quantity_prf_1#1736, l_receiptdate_prf#1718 AS l_receiptdate_prf_1#1737, l_linenumber_prf#1719 AS l_linenumber_prf_1#1738, l_tax_prf#1720 AS l_tax_prf_1#1739, l_shipdate_prf#1721 AS l_shipdate_prf_1#1740, l_extendedprice_prf#1722 AS l_extendedprice_prf_1#1741, l_partkey_prf#1723 AS l_partkey_prf_1#1742, l_discount_prf#1724 AS l_discount_prf_1#1743, l_partkey_and_l_suppkey_prf#1725 AS l_partkey_and_l_suppkey_prf_1#1744, l_commitdate_prf#1726 AS l_commitdate_prf_1#1745, l_suppkey_prf#1727 AS l_suppkey_prf_1#1746, l_orderkey_prf#1728 AS l_orderkey_prf_1#1747]
            +- Relation[l_returnflag_prf#1710,l_orderkey_and_l_linenumber_prf#1711,l_comment_prf#1712,l_linestatus_prf#1713,rid#1714,l_shipmode_prf#1715,l_shipinstruct_prf#1716,l_quantity_prf#1717,l_receiptdate_prf#1718,l_linenumber_prf#1719,l_tax_prf#1720,l_shipdate_prf#1721,l_extendedprice_prf#1722,l_partkey_prf#1723,l_discount_prf#1724,l_partkey_and_l_suppkey_prf#1725,l_commitdate_prf#1726,l_suppkey_prf#1727,l_orderkey_prf#1728] JDBCRelation(lineitem_prf) [numPartitions=1]

19/10/11 02:02:25 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=6001215
Elapsed time: 88687ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/11 02:03:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:03:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1799L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 02:03:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1799L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_2#1817]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#1810: string
         :     :- Project [s_phone_prf#1801 AS s_phone_prf_0#1809, rid#1802 AS rid_0#1810, s_address_prf#1803 AS s_address_prf_0#1811, s_nationkey_prf#1804 AS s_nationkey_prf_0#1812, s_suppkey_prf#1805 AS s_suppkey_prf_0#1813, s_name_prf#1806 AS s_name_prf_0#1814, s_acctbal_prf#1807 AS s_acctbal_prf_0#1815, s_comment_prf#1808 AS s_comment_prf_0#1816]
         :     :  +- Relation[s_phone_prf#1801,rid#1802,s_address_prf#1803,s_nationkey_prf#1804,s_suppkey_prf#1805,s_name_prf#1806,s_acctbal_prf#1807,s_comment_prf#1808] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#1838]
            :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#1830: string
            :     :- Project [p_comment_prf#1818 AS p_comment_prf_1#1828, p_name_prf#1819 AS p_name_prf_1#1829, rid#1820 AS rid_1#1830, p_type_prf#1821 AS p_type_prf_1#1831, p_retailprice_prf#1822 AS p_retailprice_prf_1#1832, p_mfgr_prf#1823 AS p_mfgr_prf_1#1833, p_container_prf#1824 AS p_container_prf_1#1834, p_brand_prf#1825 AS p_brand_prf_1#1835, p_size_prf#1826 AS p_size_prf_1#1836, p_partkey_prf#1827 AS p_partkey_prf_1#1837]
            :     :  +- Relation[p_comment_prf#1818,p_name_prf#1819,rid#1820,p_type_prf#1821,p_retailprice_prf#1822,p_mfgr_prf#1823,p_container_prf#1824,p_brand_prf#1825,p_size_prf#1826,p_partkey_prf#1827] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#1839 AS ps_partkey_and_ps_suppkey_prf_2#1846, rid#1840 AS rid_2#1847, ps_availqty_prf#1841 AS ps_availqty_prf_2#1848, ps_comment_prf#1842 AS ps_comment_prf_2#1849, ps_partkey_prf#1843 AS ps_partkey_prf_2#1850, ps_supplycost_prf#1844 AS ps_supplycost_prf_2#1851, ps_suppkey_prf#1845 AS ps_suppkey_prf_2#1852]
               +- Relation[ps_partkey_and_ps_suppkey_prf#1839,rid#1840,ps_availqty_prf#1841,ps_comment_prf#1842,ps_partkey_prf#1843,ps_supplycost_prf#1844,ps_suppkey_prf#1845] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 43633ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/11 02:04:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:04:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1913L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 02:04:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1913L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#1931]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#1924: string
         :     :- Project [s_phone_prf#1915 AS s_phone_prf_0#1923, rid#1916 AS rid_0#1924, s_address_prf#1917 AS s_address_prf_0#1925, s_nationkey_prf#1918 AS s_nationkey_prf_0#1926, s_suppkey_prf#1919 AS s_suppkey_prf_0#1927, s_name_prf#1920 AS s_name_prf_0#1928, s_acctbal_prf#1921 AS s_acctbal_prf_0#1929, s_comment_prf#1922 AS s_comment_prf_0#1930]
         :     :  +- Relation[s_phone_prf#1915,rid#1916,s_address_prf#1917,s_nationkey_prf#1918,s_suppkey_prf#1919,s_name_prf#1920,s_acctbal_prf#1921,s_comment_prf#1922] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#1970]
            :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_1#1955: string
            :     :- Project [l_returnflag_prf#1932 AS l_returnflag_prf_1#1951, l_orderkey_and_l_linenumber_prf#1933 AS l_orderkey_and_l_linenumber_prf_1#1952, l_comment_prf#1934 AS l_comment_prf_1#1953, l_linestatus_prf#1935 AS l_linestatus_prf_1#1954, rid#1936 AS rid_1#1955, l_shipmode_prf#1937 AS l_shipmode_prf_1#1956, l_shipinstruct_prf#1938 AS l_shipinstruct_prf_1#1957, l_quantity_prf#1939 AS l_quantity_prf_1#1958, l_receiptdate_prf#1940 AS l_receiptdate_prf_1#1959, l_linenumber_prf#1941 AS l_linenumber_prf_1#1960, l_tax_prf#1942 AS l_tax_prf_1#1961, l_shipdate_prf#1943 AS l_shipdate_prf_1#1962, l_extendedprice_prf#1944 AS l_extendedprice_prf_1#1963, l_partkey_prf#1945 AS l_partkey_prf_1#1964, l_discount_prf#1946 AS l_discount_prf_1#1965, l_partkey_and_l_suppkey_prf#1947 AS l_partkey_and_l_suppkey_prf_1#1966, l_commitdate_prf#1948 AS l_commitdate_prf_1#1967, l_suppkey_prf#1949 AS l_suppkey_prf_1#1968, l_orderkey_prf#1950 AS l_orderkey_prf_1#1969]
            :     :  +- Relation[l_returnflag_prf#1932,l_orderkey_and_l_linenumber_prf#1933,l_comment_prf#1934,l_linestatus_prf#1935,rid#1936,l_shipmode_prf#1937,l_shipinstruct_prf#1938,l_quantity_prf#1939,l_receiptdate_prf#1940,l_linenumber_prf#1941,l_tax_prf#1942,l_shipdate_prf#1943,l_extendedprice_prf#1944,l_partkey_prf#1945,l_discount_prf#1946,l_partkey_and_l_suppkey_prf#1947,l_commitdate_prf#1948,l_suppkey_prf#1949,l_orderkey_prf#1950] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#1971 AS p_comment_prf_2#1981, p_name_prf#1972 AS p_name_prf_2#1982, rid#1973 AS rid_2#1983, p_type_prf#1974 AS p_type_prf_2#1984, p_retailprice_prf#1975 AS p_retailprice_prf_2#1985, p_mfgr_prf#1976 AS p_mfgr_prf_2#1986, p_container_prf#1977 AS p_container_prf_2#1987, p_brand_prf#1978 AS p_brand_prf_2#1988, p_size_prf#1979 AS p_size_prf_2#1989, p_partkey_prf#1980 AS p_partkey_prf_2#1990]
               +- Relation[p_comment_prf#1971,p_name_prf#1972,rid#1973,p_type_prf#1974,p_retailprice_prf#1975,p_mfgr_prf#1976,p_container_prf#1977,p_brand_prf#1978,p_size_prf#1979,p_partkey_prf#1980] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 200648ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/11 02:07:58 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:07:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2056L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 02:07:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2056L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#2099]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2081: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#2058 AS l_returnflag_prf_0#2077, l_orderkey_and_l_linenumber_prf#2059 AS l_orderkey_and_l_linenumber_prf_0#2078, l_comment_prf#2060 AS l_comment_prf_0#2079, l_linestatus_prf#2061 AS l_linestatus_prf_0#2080, rid#2062 AS rid_0#2081, l_shipmode_prf#2063 AS l_shipmode_prf_0#2082, l_shipinstruct_prf#2064 AS l_shipinstruct_prf_0#2083, l_quantity_prf#2065 AS l_quantity_prf_0#2084, l_receiptdate_prf#2066 AS l_receiptdate_prf_0#2085, l_linenumber_prf#2067 AS l_linenumber_prf_0#2086, l_tax_prf#2068 AS l_tax_prf_0#2087, l_shipdate_prf#2069 AS l_shipdate_prf_0#2088, l_extendedprice_prf#2070 AS l_extendedprice_prf_0#2089, l_partkey_prf#2071 AS l_partkey_prf_0#2090, l_discount_prf#2072 AS l_discount_prf_0#2091, l_partkey_and_l_suppkey_prf#2073 AS l_partkey_and_l_suppkey_prf_0#2092, l_commitdate_prf#2074 AS l_commitdate_prf_0#2093, l_suppkey_prf#2075 AS l_suppkey_prf_0#2094, l_orderkey_prf#2076 AS l_orderkey_prf_0#2095]
         :     :  :  +- Relation[l_returnflag_prf#2058,l_orderkey_and_l_linenumber_prf#2059,l_comment_prf#2060,l_linestatus_prf#2061,rid#2062,l_shipmode_prf#2063,l_shipinstruct_prf#2064,l_quantity_prf#2065,l_receiptdate_prf#2066,l_linenumber_prf#2067,l_tax_prf#2068,l_shipdate_prf#2069,l_extendedprice_prf#2070,l_partkey_prf#2071,l_discount_prf#2072,l_partkey_and_l_suppkey_prf#2073,l_commitdate_prf#2074,l_suppkey_prf#2075,l_orderkey_prf#2076] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2098]
         :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :        +- Relation[label#2096,value#2097] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2100 AS o_shippriority_prf_1#2110, rid#2101 AS rid_1#2111, o_orderdate_prf#2102 AS o_orderdate_prf_1#2112, o_custkey_prf#2103 AS o_custkey_prf_1#2113, o_orderpriority_prf#2104 AS o_orderpriority_prf_1#2114, o_clerk_prf#2105 AS o_clerk_prf_1#2115, o_orderstatus_prf#2106 AS o_orderstatus_prf_1#2116, o_totalprice_prf#2107 AS o_totalprice_prf_1#2117, o_orderkey_prf#2108 AS o_orderkey_prf_1#2118, o_comment_prf#2109 AS o_comment_prf_1#2119]
            +- Relation[o_shippriority_prf#2100,rid#2101,o_orderdate_prf#2102,o_custkey_prf#2103,o_orderpriority_prf#2104,o_clerk_prf#2105,o_orderstatus_prf#2106,o_totalprice_prf#2107,o_orderkey_prf#2108,o_comment_prf#2109] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 57408ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/11 02:08:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:08:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2161L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 02:08:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2161L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#2163 AS p_comment_prf_0#2173, p_name_prf#2164 AS p_name_prf_0#2174, rid#2165 AS rid_0#2175, p_type_prf#2166 AS p_type_prf_0#2176, p_retailprice_prf#2167 AS p_retailprice_prf_0#2177, p_mfgr_prf#2168 AS p_mfgr_prf_0#2178, p_container_prf#2169 AS p_container_prf_0#2179, p_brand_prf#2170 AS p_brand_prf_0#2180, p_size_prf#2171 AS p_size_prf_0#2181, p_partkey_prf#2172 AS p_partkey_prf_0#2182]
         :  +- Relation[p_comment_prf#2163,p_name_prf#2164,rid#2165,p_type_prf#2166,p_retailprice_prf#2167,p_mfgr_prf#2168,p_container_prf#2169,p_brand_prf#2170,p_size_prf#2171,p_partkey_prf#2172] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2183]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#2096,value#2097] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1451
Elapsed time: 86ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/11 02:08:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:08:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2229L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 02:08:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2229L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_2#2247]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#2240: string
         :     :- Project [s_phone_prf#2231 AS s_phone_prf_0#2239, rid#2232 AS rid_0#2240, s_address_prf#2233 AS s_address_prf_0#2241, s_nationkey_prf#2234 AS s_nationkey_prf_0#2242, s_suppkey_prf#2235 AS s_suppkey_prf_0#2243, s_name_prf#2236 AS s_name_prf_0#2244, s_acctbal_prf#2237 AS s_acctbal_prf_0#2245, s_comment_prf#2238 AS s_comment_prf_0#2246]
         :     :  +- Relation[s_phone_prf#2231,rid#2232,s_address_prf#2233,s_nationkey_prf#2234,s_suppkey_prf#2235,s_name_prf#2236,s_acctbal_prf#2237,s_comment_prf#2238] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#2268]
            :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#2260: string
            :     :- Project [p_comment_prf#2248 AS p_comment_prf_1#2258, p_name_prf#2249 AS p_name_prf_1#2259, rid#2250 AS rid_1#2260, p_type_prf#2251 AS p_type_prf_1#2261, p_retailprice_prf#2252 AS p_retailprice_prf_1#2262, p_mfgr_prf#2253 AS p_mfgr_prf_1#2263, p_container_prf#2254 AS p_container_prf_1#2264, p_brand_prf#2255 AS p_brand_prf_1#2265, p_size_prf#2256 AS p_size_prf_1#2266, p_partkey_prf#2257 AS p_partkey_prf_1#2267]
            :     :  +- Relation[p_comment_prf#2248,p_name_prf#2249,rid#2250,p_type_prf#2251,p_retailprice_prf#2252,p_mfgr_prf#2253,p_container_prf#2254,p_brand_prf#2255,p_size_prf#2256,p_partkey_prf#2257] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2269 AS l_returnflag_prf_2#2288, l_orderkey_and_l_linenumber_prf#2270 AS l_orderkey_and_l_linenumber_prf_2#2289, l_comment_prf#2271 AS l_comment_prf_2#2290, l_linestatus_prf#2272 AS l_linestatus_prf_2#2291, rid#2273 AS rid_2#2292, l_shipmode_prf#2274 AS l_shipmode_prf_2#2293, l_shipinstruct_prf#2275 AS l_shipinstruct_prf_2#2294, l_quantity_prf#2276 AS l_quantity_prf_2#2295, l_receiptdate_prf#2277 AS l_receiptdate_prf_2#2296, l_linenumber_prf#2278 AS l_linenumber_prf_2#2297, l_tax_prf#2279 AS l_tax_prf_2#2298, l_shipdate_prf#2280 AS l_shipdate_prf_2#2299, l_extendedprice_prf#2281 AS l_extendedprice_prf_2#2300, l_partkey_prf#2282 AS l_partkey_prf_2#2301, l_discount_prf#2283 AS l_discount_prf_2#2302, l_partkey_and_l_suppkey_prf#2284 AS l_partkey_and_l_suppkey_prf_2#2303, l_commitdate_prf#2285 AS l_commitdate_prf_2#2304, l_suppkey_prf#2286 AS l_suppkey_prf_2#2305, l_orderkey_prf#2287 AS l_orderkey_prf_2#2306]
               +- Relation[l_returnflag_prf#2269,l_orderkey_and_l_linenumber_prf#2270,l_comment_prf#2271,l_linestatus_prf#2272,rid#2273,l_shipmode_prf#2274,l_shipinstruct_prf#2275,l_quantity_prf#2276,l_receiptdate_prf#2277,l_linenumber_prf#2278,l_tax_prf#2279,l_shipdate_prf#2280,l_extendedprice_prf#2281,l_partkey_prf#2282,l_discount_prf#2283,l_partkey_and_l_suppkey_prf#2284,l_commitdate_prf#2285,l_suppkey_prf#2286,l_orderkey_prf#2287] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 190140ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/11 02:12:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:12:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2366L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 02:12:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2366L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_2#2386]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#2378: string
         :     :- Project [c_acctbal_prf#2368 AS c_acctbal_prf_0#2377, rid#2369 AS rid_0#2378, c_name_prf#2370 AS c_name_prf_0#2379, c_nationkey_prf#2371 AS c_nationkey_prf_0#2380, c_custkey_prf#2372 AS c_custkey_prf_0#2381, c_comment_prf#2373 AS c_comment_prf_0#2382, c_address_prf#2374 AS c_address_prf_0#2383, c_mktsegment_prf#2375 AS c_mktsegment_prf_0#2384, c_phone_prf#2376 AS c_phone_prf_0#2385]
         :     :  +- Relation[c_acctbal_prf#2368,rid#2369,c_name_prf#2370,c_nationkey_prf#2371,c_custkey_prf#2372,c_comment_prf#2373,c_address_prf#2374,c_mktsegment_prf#2375,c_phone_prf#2376] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#2403]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#2396: string
            :     :- Project [s_phone_prf#2387 AS s_phone_prf_1#2395, rid#2388 AS rid_1#2396, s_address_prf#2389 AS s_address_prf_1#2397, s_nationkey_prf#2390 AS s_nationkey_prf_1#2398, s_suppkey_prf#2391 AS s_suppkey_prf_1#2399, s_name_prf#2392 AS s_name_prf_1#2400, s_acctbal_prf#2393 AS s_acctbal_prf_1#2401, s_comment_prf#2394 AS s_comment_prf_1#2402]
            :     :  +- Relation[s_phone_prf#2387,rid#2388,s_address_prf#2389,s_nationkey_prf#2390,s_suppkey_prf#2391,s_name_prf#2392,s_acctbal_prf#2393,s_comment_prf#2394] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [rid#2404 AS rid_2#2409, n_regionkey_prf#2405 AS n_regionkey_prf_2#2410, n_nationkey_prf#2406 AS n_nationkey_prf_2#2411, n_name_prf#2407 AS n_name_prf_2#2412, n_comment_prf#2408 AS n_comment_prf_2#2413]
               +- Relation[rid#2404,n_regionkey_prf#2405,n_nationkey_prf#2406,n_name_prf#2407,n_comment_prf#2408] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 52066ms

f1=
select * from region where r_name = 'EUROPE'
19/10/11 02:12:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:12:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2442L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/11 02:12:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2442L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#2444 AS r_regionkey_prf_0#2448, r_name_prf#2445 AS r_name_prf_0#2449, r_comment_prf#2446 AS r_comment_prf_0#2450, rid#2447 AS rid_0#2451]
         :  +- Relation[r_regionkey_prf#2444,r_name_prf#2445,r_comment_prf#2446,rid#2447] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2452]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#2096,value#2097] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 59ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/11 02:12:58 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:12:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2493L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 02:12:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2493L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#2533]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2518: string
         :     :  :     :- Project [l_returnflag_prf#2495 AS l_returnflag_prf_0#2514, l_orderkey_and_l_linenumber_prf#2496 AS l_orderkey_and_l_linenumber_prf_0#2515, l_comment_prf#2497 AS l_comment_prf_0#2516, l_linestatus_prf#2498 AS l_linestatus_prf_0#2517, rid#2499 AS rid_0#2518, l_shipmode_prf#2500 AS l_shipmode_prf_0#2519, l_shipinstruct_prf#2501 AS l_shipinstruct_prf_0#2520, l_quantity_prf#2502 AS l_quantity_prf_0#2521, l_receiptdate_prf#2503 AS l_receiptdate_prf_0#2522, l_linenumber_prf#2504 AS l_linenumber_prf_0#2523, l_tax_prf#2505 AS l_tax_prf_0#2524, l_shipdate_prf#2506 AS l_shipdate_prf_0#2525, l_extendedprice_prf#2507 AS l_extendedprice_prf_0#2526, l_partkey_prf#2508 AS l_partkey_prf_0#2527, l_discount_prf#2509 AS l_discount_prf_0#2528, l_partkey_and_l_suppkey_prf#2510 AS l_partkey_and_l_suppkey_prf_0#2529, l_commitdate_prf#2511 AS l_commitdate_prf_0#2530, l_suppkey_prf#2512 AS l_suppkey_prf_0#2531, l_orderkey_prf#2513 AS l_orderkey_prf_0#2532]
         :     :  :     :  +- Relation[l_returnflag_prf#2495,l_orderkey_and_l_linenumber_prf#2496,l_comment_prf#2497,l_linestatus_prf#2498,rid#2499,l_shipmode_prf#2500,l_shipinstruct_prf#2501,l_quantity_prf#2502,l_receiptdate_prf#2503,l_linenumber_prf#2504,l_tax_prf#2505,l_shipdate_prf#2506,l_extendedprice_prf#2507,l_partkey_prf#2508,l_discount_prf#2509,l_partkey_and_l_suppkey_prf#2510,l_commitdate_prf#2511,l_suppkey_prf#2512,l_orderkey_prf#2513] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#2534 AS o_shippriority_prf_1#2544, rid#2535 AS rid_1#2545, o_orderdate_prf#2536 AS o_orderdate_prf_1#2546, o_custkey_prf#2537 AS o_custkey_prf_1#2547, o_orderpriority_prf#2538 AS o_orderpriority_prf_1#2548, o_clerk_prf#2539 AS o_clerk_prf_1#2549, o_orderstatus_prf#2540 AS o_orderstatus_prf_1#2550, o_totalprice_prf#2541 AS o_totalprice_prf_1#2551, o_orderkey_prf#2542 AS o_orderkey_prf_1#2552, o_comment_prf#2543 AS o_comment_prf_1#2553]
         :     :     +- Relation[o_shippriority_prf#2534,rid#2535,o_orderdate_prf#2536,o_custkey_prf#2537,o_orderpriority_prf#2538,o_clerk_prf#2539,o_orderstatus_prf#2540,o_totalprice_prf#2541,o_orderkey_prf#2542,o_comment_prf#2543] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2555 AS c_acctbal_prf_2#2564, rid#2556 AS rid_2#2565, c_name_prf#2557 AS c_name_prf_2#2566, c_nationkey_prf#2558 AS c_nationkey_prf_2#2567, c_custkey_prf#2559 AS c_custkey_prf_2#2568, c_comment_prf#2560 AS c_comment_prf_2#2569, c_address_prf#2561 AS c_address_prf_2#2570, c_mktsegment_prf#2562 AS c_mktsegment_prf_2#2571, c_phone_prf#2563 AS c_phone_prf_2#2572]
            +- Relation[c_acctbal_prf#2555,rid#2556,c_name_prf#2557,c_nationkey_prf#2558,c_custkey_prf#2559,c_comment_prf#2560,c_address_prf#2561,c_mktsegment_prf#2562,c_phone_prf#2563] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 346915ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/11 02:18:44 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:18:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2635L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 02:18:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2635L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#2651]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, rid_0#2645: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#2637 AS ps_partkey_and_ps_suppkey_prf_0#2644, rid#2638 AS rid_0#2645, ps_availqty_prf#2639 AS ps_availqty_prf_0#2646, ps_comment_prf#2640 AS ps_comment_prf_0#2647, ps_partkey_prf#2641 AS ps_partkey_prf_0#2648, ps_supplycost_prf#2642 AS ps_supplycost_prf_0#2649, ps_suppkey_prf#2643 AS ps_suppkey_prf_0#2650]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2637,rid#2638,ps_availqty_prf#2639,ps_comment_prf#2640,ps_partkey_prf#2641,ps_supplycost_prf#2642,ps_suppkey_prf#2643] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2652 AS l_returnflag_prf_1#2671, l_orderkey_and_l_linenumber_prf#2653 AS l_orderkey_and_l_linenumber_prf_1#2672, l_comment_prf#2654 AS l_comment_prf_1#2673, l_linestatus_prf#2655 AS l_linestatus_prf_1#2674, rid#2656 AS rid_1#2675, l_shipmode_prf#2657 AS l_shipmode_prf_1#2676, l_shipinstruct_prf#2658 AS l_shipinstruct_prf_1#2677, l_quantity_prf#2659 AS l_quantity_prf_1#2678, l_receiptdate_prf#2660 AS l_receiptdate_prf_1#2679, l_linenumber_prf#2661 AS l_linenumber_prf_1#2680, l_tax_prf#2662 AS l_tax_prf_1#2681, l_shipdate_prf#2663 AS l_shipdate_prf_1#2682, l_extendedprice_prf#2664 AS l_extendedprice_prf_1#2683, l_partkey_prf#2665 AS l_partkey_prf_1#2684, l_discount_prf#2666 AS l_discount_prf_1#2685, l_partkey_and_l_suppkey_prf#2667 AS l_partkey_and_l_suppkey_prf_1#2686, l_commitdate_prf#2668 AS l_commitdate_prf_1#2687, l_suppkey_prf#2669 AS l_suppkey_prf_1#2688, l_orderkey_prf#2670 AS l_orderkey_prf_1#2689]
            +- Relation[l_returnflag_prf#2652,l_orderkey_and_l_linenumber_prf#2653,l_comment_prf#2654,l_linestatus_prf#2655,rid#2656,l_shipmode_prf#2657,l_shipinstruct_prf#2658,l_quantity_prf#2659,l_receiptdate_prf#2660,l_linenumber_prf#2661,l_tax_prf#2662,l_shipdate_prf#2663,l_extendedprice_prf#2664,l_partkey_prf#2665,l_discount_prf#2666,l_partkey_and_l_suppkey_prf#2667,l_commitdate_prf#2668,l_suppkey_prf#2669,l_orderkey_prf#2670] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 118341ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/11 02:20:43 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:20:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2752L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 02:20:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2752L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#2792]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2777: string
         :     :- Project [l_returnflag_prf#2754 AS l_returnflag_prf_0#2773, l_orderkey_and_l_linenumber_prf#2755 AS l_orderkey_and_l_linenumber_prf_0#2774, l_comment_prf#2756 AS l_comment_prf_0#2775, l_linestatus_prf#2757 AS l_linestatus_prf_0#2776, rid#2758 AS rid_0#2777, l_shipmode_prf#2759 AS l_shipmode_prf_0#2778, l_shipinstruct_prf#2760 AS l_shipinstruct_prf_0#2779, l_quantity_prf#2761 AS l_quantity_prf_0#2780, l_receiptdate_prf#2762 AS l_receiptdate_prf_0#2781, l_linenumber_prf#2763 AS l_linenumber_prf_0#2782, l_tax_prf#2764 AS l_tax_prf_0#2783, l_shipdate_prf#2765 AS l_shipdate_prf_0#2784, l_extendedprice_prf#2766 AS l_extendedprice_prf_0#2785, l_partkey_prf#2767 AS l_partkey_prf_0#2786, l_discount_prf#2768 AS l_discount_prf_0#2787, l_partkey_and_l_suppkey_prf#2769 AS l_partkey_and_l_suppkey_prf_0#2788, l_commitdate_prf#2770 AS l_commitdate_prf_0#2789, l_suppkey_prf#2771 AS l_suppkey_prf_0#2790, l_orderkey_prf#2772 AS l_orderkey_prf_0#2791]
         :     :  +- Relation[l_returnflag_prf#2754,l_orderkey_and_l_linenumber_prf#2755,l_comment_prf#2756,l_linestatus_prf#2757,rid#2758,l_shipmode_prf#2759,l_shipinstruct_prf#2760,l_quantity_prf#2761,l_receiptdate_prf#2762,l_linenumber_prf#2763,l_tax_prf#2764,l_shipdate_prf#2765,l_extendedprice_prf#2766,l_partkey_prf#2767,l_discount_prf#2768,l_partkey_and_l_suppkey_prf#2769,l_commitdate_prf#2770,l_suppkey_prf#2771,l_orderkey_prf#2772] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#2813]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#2804: string
            :     :- Project [o_shippriority_prf#2793 AS o_shippriority_prf_1#2803, rid#2794 AS rid_1#2804, o_orderdate_prf#2795 AS o_orderdate_prf_1#2805, o_custkey_prf#2796 AS o_custkey_prf_1#2806, o_orderpriority_prf#2797 AS o_orderpriority_prf_1#2807, o_clerk_prf#2798 AS o_clerk_prf_1#2808, o_orderstatus_prf#2799 AS o_orderstatus_prf_1#2809, o_totalprice_prf#2800 AS o_totalprice_prf_1#2810, o_orderkey_prf#2801 AS o_orderkey_prf_1#2811, o_comment_prf#2802 AS o_comment_prf_1#2812]
            :     :  +- Relation[o_shippriority_prf#2793,rid#2794,o_orderdate_prf#2795,o_custkey_prf#2796,o_orderpriority_prf#2797,o_clerk_prf#2798,o_orderstatus_prf#2799,o_totalprice_prf#2800,o_orderkey_prf#2801,o_comment_prf#2802] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#2814 AS c_acctbal_prf_2#2823, rid#2815 AS rid_2#2824, c_name_prf#2816 AS c_name_prf_2#2825, c_nationkey_prf#2817 AS c_nationkey_prf_2#2826, c_custkey_prf#2818 AS c_custkey_prf_2#2827, c_comment_prf#2819 AS c_comment_prf_2#2828, c_address_prf#2820 AS c_address_prf_2#2829, c_mktsegment_prf#2821 AS c_mktsegment_prf_2#2830, c_phone_prf#2822 AS c_phone_prf_2#2831]
               +- Relation[c_acctbal_prf#2814,rid#2815,c_name_prf#2816,c_nationkey_prf#2817,c_custkey_prf#2818,c_comment_prf#2819,c_address_prf#2820,c_mktsegment_prf#2821,c_phone_prf#2822] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 168867ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/11 02:23:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:23:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2905L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 02:23:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2905L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#2927]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2919: string
         :     :  :     :- Project [p_comment_prf#2907 AS p_comment_prf_0#2917, p_name_prf#2908 AS p_name_prf_0#2918, rid#2909 AS rid_0#2919, p_type_prf#2910 AS p_type_prf_0#2920, p_retailprice_prf#2911 AS p_retailprice_prf_0#2921, p_mfgr_prf#2912 AS p_mfgr_prf_0#2922, p_container_prf#2913 AS p_container_prf_0#2923, p_brand_prf#2914 AS p_brand_prf_0#2924, p_size_prf#2915 AS p_size_prf_0#2925, p_partkey_prf#2916 AS p_partkey_prf_0#2926]
         :     :  :     :  +- Relation[p_comment_prf#2907,p_name_prf#2908,rid#2909,p_type_prf#2910,p_retailprice_prf#2911,p_mfgr_prf#2912,p_container_prf#2913,p_brand_prf#2914,p_size_prf#2915,p_partkey_prf#2916] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#2928 AS l_returnflag_prf_1#2947, l_orderkey_and_l_linenumber_prf#2929 AS l_orderkey_and_l_linenumber_prf_1#2948, l_comment_prf#2930 AS l_comment_prf_1#2949, l_linestatus_prf#2931 AS l_linestatus_prf_1#2950, rid#2932 AS rid_1#2951, l_shipmode_prf#2933 AS l_shipmode_prf_1#2952, l_shipinstruct_prf#2934 AS l_shipinstruct_prf_1#2953, l_quantity_prf#2935 AS l_quantity_prf_1#2954, l_receiptdate_prf#2936 AS l_receiptdate_prf_1#2955, l_linenumber_prf#2937 AS l_linenumber_prf_1#2956, l_tax_prf#2938 AS l_tax_prf_1#2957, l_shipdate_prf#2939 AS l_shipdate_prf_1#2958, l_extendedprice_prf#2940 AS l_extendedprice_prf_1#2959, l_partkey_prf#2941 AS l_partkey_prf_1#2960, l_discount_prf#2942 AS l_discount_prf_1#2961, l_partkey_and_l_suppkey_prf#2943 AS l_partkey_and_l_suppkey_prf_1#2962, l_commitdate_prf#2944 AS l_commitdate_prf_1#2963, l_suppkey_prf#2945 AS l_suppkey_prf_1#2964, l_orderkey_prf#2946 AS l_orderkey_prf_1#2965]
         :     :     +- Relation[l_returnflag_prf#2928,l_orderkey_and_l_linenumber_prf#2929,l_comment_prf#2930,l_linestatus_prf#2931,rid#2932,l_shipmode_prf#2933,l_shipinstruct_prf#2934,l_quantity_prf#2935,l_receiptdate_prf#2936,l_linenumber_prf#2937,l_tax_prf#2938,l_shipdate_prf#2939,l_extendedprice_prf#2940,l_partkey_prf#2941,l_discount_prf#2942,l_partkey_and_l_suppkey_prf#2943,l_commitdate_prf#2944,l_suppkey_prf#2945,l_orderkey_prf#2946] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2967 AS s_phone_prf_2#2975, rid#2968 AS rid_2#2976, s_address_prf#2969 AS s_address_prf_2#2977, s_nationkey_prf#2970 AS s_nationkey_prf_2#2978, s_suppkey_prf#2971 AS s_suppkey_prf_2#2979, s_name_prf#2972 AS s_name_prf_2#2980, s_acctbal_prf#2973 AS s_acctbal_prf_2#2981, s_comment_prf#2974 AS s_comment_prf_2#2982]
            +- Relation[s_phone_prf#2967,rid#2968,s_address_prf#2969,s_nationkey_prf#2970,s_suppkey_prf#2971,s_name_prf#2972,s_acctbal_prf#2973,s_comment_prf#2974] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 313570ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/11 02:28:45 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:28:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3044L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 02:28:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3044L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#3081]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3066]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#3058: string
         :     :  :     :- Project [p_comment_prf#3046 AS p_comment_prf_0#3056, p_name_prf#3047 AS p_name_prf_0#3057, rid#3048 AS rid_0#3058, p_type_prf#3049 AS p_type_prf_0#3059, p_retailprice_prf#3050 AS p_retailprice_prf_0#3060, p_mfgr_prf#3051 AS p_mfgr_prf_0#3061, p_container_prf#3052 AS p_container_prf_0#3062, p_brand_prf#3053 AS p_brand_prf_0#3063, p_size_prf#3054 AS p_size_prf_0#3064, p_partkey_prf#3055 AS p_partkey_prf_0#3065]
         :     :  :     :  +- Relation[p_comment_prf#3046,p_name_prf#3047,rid#3048,p_type_prf#3049,p_retailprice_prf#3050,p_mfgr_prf#3051,p_container_prf#3052,p_brand_prf#3053,p_size_prf#3054,p_partkey_prf#3055] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#3067 AS ps_partkey_and_ps_suppkey_prf_1#3074, rid#3068 AS rid_1#3075, ps_availqty_prf#3069 AS ps_availqty_prf_1#3076, ps_comment_prf#3070 AS ps_comment_prf_1#3077, ps_partkey_prf#3071 AS ps_partkey_prf_1#3078, ps_supplycost_prf#3072 AS ps_supplycost_prf_1#3079, ps_suppkey_prf#3073 AS ps_suppkey_prf_1#3080]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#3067,rid#3068,ps_availqty_prf#3069,ps_comment_prf#3070,ps_partkey_prf#3071,ps_supplycost_prf#3072,ps_suppkey_prf#3073] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3082 AS s_phone_prf_2#3090, rid#3083 AS rid_2#3091, s_address_prf#3084 AS s_address_prf_2#3092, s_nationkey_prf#3085 AS s_nationkey_prf_2#3093, s_suppkey_prf#3086 AS s_suppkey_prf_2#3094, s_name_prf#3087 AS s_name_prf_2#3095, s_acctbal_prf#3088 AS s_acctbal_prf_2#3096, s_comment_prf#3089 AS s_comment_prf_2#3097]
            +- Relation[s_phone_prf#3082,rid#3083,s_address_prf#3084,s_nationkey_prf#3085,s_suppkey_prf#3086,s_name_prf#3087,s_acctbal_prf#3088,s_comment_prf#3089] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 94790ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/11 02:30:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:30:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3159L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 02:30:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3159L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#3200]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3179]
         :     :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3171: string
         :     :  :     :- Project [c_acctbal_prf#3161 AS c_acctbal_prf_0#3170, rid#3162 AS rid_0#3171, c_name_prf#3163 AS c_name_prf_0#3172, c_nationkey_prf#3164 AS c_nationkey_prf_0#3173, c_custkey_prf#3165 AS c_custkey_prf_0#3174, c_comment_prf#3166 AS c_comment_prf_0#3175, c_address_prf#3167 AS c_address_prf_0#3176, c_mktsegment_prf#3168 AS c_mktsegment_prf_0#3177, c_phone_prf#3169 AS c_phone_prf_0#3178]
         :     :  :     :  +- Relation[c_acctbal_prf#3161,rid#3162,c_name_prf#3163,c_nationkey_prf#3164,c_custkey_prf#3165,c_comment_prf#3166,c_address_prf#3167,c_mktsegment_prf#3168,c_phone_prf#3169] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#3180 AS o_shippriority_prf_1#3190, rid#3181 AS rid_1#3191, o_orderdate_prf#3182 AS o_orderdate_prf_1#3192, o_custkey_prf#3183 AS o_custkey_prf_1#3193, o_orderpriority_prf#3184 AS o_orderpriority_prf_1#3194, o_clerk_prf#3185 AS o_clerk_prf_1#3195, o_orderstatus_prf#3186 AS o_orderstatus_prf_1#3196, o_totalprice_prf#3187 AS o_totalprice_prf_1#3197, o_orderkey_prf#3188 AS o_orderkey_prf_1#3198, o_comment_prf#3189 AS o_comment_prf_1#3199]
         :     :     +- Relation[o_shippriority_prf#3180,rid#3181,o_orderdate_prf#3182,o_custkey_prf#3183,o_orderpriority_prf#3184,o_clerk_prf#3185,o_orderstatus_prf#3186,o_totalprice_prf#3187,o_orderkey_prf#3188,o_comment_prf#3189] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3201 AS l_returnflag_prf_2#3220, l_orderkey_and_l_linenumber_prf#3202 AS l_orderkey_and_l_linenumber_prf_2#3221, l_comment_prf#3203 AS l_comment_prf_2#3222, l_linestatus_prf#3204 AS l_linestatus_prf_2#3223, rid#3205 AS rid_2#3224, l_shipmode_prf#3206 AS l_shipmode_prf_2#3225, l_shipinstruct_prf#3207 AS l_shipinstruct_prf_2#3226, l_quantity_prf#3208 AS l_quantity_prf_2#3227, l_receiptdate_prf#3209 AS l_receiptdate_prf_2#3228, l_linenumber_prf#3210 AS l_linenumber_prf_2#3229, l_tax_prf#3211 AS l_tax_prf_2#3230, l_shipdate_prf#3212 AS l_shipdate_prf_2#3231, l_extendedprice_prf#3213 AS l_extendedprice_prf_2#3232, l_partkey_prf#3214 AS l_partkey_prf_2#3233, l_discount_prf#3215 AS l_discount_prf_2#3234, l_partkey_and_l_suppkey_prf#3216 AS l_partkey_and_l_suppkey_prf_2#3235, l_commitdate_prf#3217 AS l_commitdate_prf_2#3236, l_suppkey_prf#3218 AS l_suppkey_prf_2#3237, l_orderkey_prf#3219 AS l_orderkey_prf_2#3238]
            +- Relation[l_returnflag_prf#3201,l_orderkey_and_l_linenumber_prf#3202,l_comment_prf#3203,l_linestatus_prf#3204,rid#3205,l_shipmode_prf#3206,l_shipinstruct_prf#3207,l_quantity_prf#3208,l_receiptdate_prf#3209,l_linenumber_prf#3210,l_tax_prf#3211,l_shipdate_prf#3212,l_extendedprice_prf#3213,l_partkey_prf#3214,l_discount_prf#3215,l_partkey_and_l_suppkey_prf#3216,l_commitdate_prf#3217,l_suppkey_prf#3218,l_orderkey_prf#3219] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 185328ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/11 02:33:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:33:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3291L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 02:33:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3291L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3303]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#3298: string
         :     :- Project [rid#3293 AS rid_0#3298, n_regionkey_prf#3294 AS n_regionkey_prf_0#3299, n_nationkey_prf#3295 AS n_nationkey_prf_0#3300, n_name_prf#3296 AS n_name_prf_0#3301, n_comment_prf#3297 AS n_comment_prf_0#3302]
         :     :  +- Relation[rid#3293,n_regionkey_prf#3294,n_nationkey_prf#3295,n_name_prf#3296,n_comment_prf#3297] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3304 AS s_phone_prf_1#3312, rid#3305 AS rid_1#3313, s_address_prf#3306 AS s_address_prf_1#3314, s_nationkey_prf#3307 AS s_nationkey_prf_1#3315, s_suppkey_prf#3308 AS s_suppkey_prf_1#3316, s_name_prf#3309 AS s_name_prf_1#3317, s_acctbal_prf#3310 AS s_acctbal_prf_1#3318, s_comment_prf#3311 AS s_comment_prf_1#3319]
            +- Relation[s_phone_prf#3304,rid#3305,s_address_prf#3306,s_nationkey_prf#3307,s_suppkey_prf#3308,s_name_prf#3309,s_acctbal_prf#3310,s_comment_prf#3311] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=10000
Elapsed time: 189ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/11 02:33:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:33:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3361L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 02:33:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3361L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3383]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#3374: string
         :     :- Project [o_shippriority_prf#3363 AS o_shippriority_prf_0#3373, rid#3364 AS rid_0#3374, o_orderdate_prf#3365 AS o_orderdate_prf_0#3375, o_custkey_prf#3366 AS o_custkey_prf_0#3376, o_orderpriority_prf#3367 AS o_orderpriority_prf_0#3377, o_clerk_prf#3368 AS o_clerk_prf_0#3378, o_orderstatus_prf#3369 AS o_orderstatus_prf_0#3379, o_totalprice_prf#3370 AS o_totalprice_prf_0#3380, o_orderkey_prf#3371 AS o_orderkey_prf_0#3381, o_comment_prf#3372 AS o_comment_prf_0#3382]
         :     :  +- Relation[o_shippriority_prf#3363,rid#3364,o_orderdate_prf#3365,o_custkey_prf#3366,o_orderpriority_prf#3367,o_clerk_prf#3368,o_orderstatus_prf#3369,o_totalprice_prf#3370,o_orderkey_prf#3371,o_comment_prf#3372] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#3384 AS l_returnflag_prf_1#3403, l_orderkey_and_l_linenumber_prf#3385 AS l_orderkey_and_l_linenumber_prf_1#3404, l_comment_prf#3386 AS l_comment_prf_1#3405, l_linestatus_prf#3387 AS l_linestatus_prf_1#3406, rid#3388 AS rid_1#3407, l_shipmode_prf#3389 AS l_shipmode_prf_1#3408, l_shipinstruct_prf#3390 AS l_shipinstruct_prf_1#3409, l_quantity_prf#3391 AS l_quantity_prf_1#3410, l_receiptdate_prf#3392 AS l_receiptdate_prf_1#3411, l_linenumber_prf#3393 AS l_linenumber_prf_1#3412, l_tax_prf#3394 AS l_tax_prf_1#3413, l_shipdate_prf#3395 AS l_shipdate_prf_1#3414, l_extendedprice_prf#3396 AS l_extendedprice_prf_1#3415, l_partkey_prf#3397 AS l_partkey_prf_1#3416, l_discount_prf#3398 AS l_discount_prf_1#3417, l_partkey_and_l_suppkey_prf#3399 AS l_partkey_and_l_suppkey_prf_1#3418, l_commitdate_prf#3400 AS l_commitdate_prf_1#3419, l_suppkey_prf#3401 AS l_suppkey_prf_1#3420, l_orderkey_prf#3402 AS l_orderkey_prf_1#3421]
            :  +- Relation[l_returnflag_prf#3384,l_orderkey_and_l_linenumber_prf#3385,l_comment_prf#3386,l_linestatus_prf#3387,rid#3388,l_shipmode_prf#3389,l_shipinstruct_prf#3390,l_quantity_prf#3391,l_receiptdate_prf#3392,l_linenumber_prf#3393,l_tax_prf#3394,l_shipdate_prf#3395,l_extendedprice_prf#3396,l_partkey_prf#3397,l_discount_prf#3398,l_partkey_and_l_suppkey_prf#3399,l_commitdate_prf#3400,l_suppkey_prf#3401,l_orderkey_prf#3402] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3422]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#2096,value#2097] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 201061ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/11 02:36:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:36:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3480L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 02:36:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3480L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3502]
         :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3494: string
         :     :- Project [p_comment_prf#3482 AS p_comment_prf_0#3492, p_name_prf#3483 AS p_name_prf_0#3493, rid#3484 AS rid_0#3494, p_type_prf#3485 AS p_type_prf_0#3495, p_retailprice_prf#3486 AS p_retailprice_prf_0#3496, p_mfgr_prf#3487 AS p_mfgr_prf_0#3497, p_container_prf#3488 AS p_container_prf_0#3498, p_brand_prf#3489 AS p_brand_prf_0#3499, p_size_prf#3490 AS p_size_prf_0#3500, p_partkey_prf#3491 AS p_partkey_prf_0#3501]
         :     :  +- Relation[p_comment_prf#3482,p_name_prf#3483,rid#3484,p_type_prf#3485,p_retailprice_prf#3486,p_mfgr_prf#3487,p_container_prf#3488,p_brand_prf#3489,p_size_prf#3490,p_partkey_prf#3491] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3503 AS l_returnflag_prf_1#3522, l_orderkey_and_l_linenumber_prf#3504 AS l_orderkey_and_l_linenumber_prf_1#3523, l_comment_prf#3505 AS l_comment_prf_1#3524, l_linestatus_prf#3506 AS l_linestatus_prf_1#3525, rid#3507 AS rid_1#3526, l_shipmode_prf#3508 AS l_shipmode_prf_1#3527, l_shipinstruct_prf#3509 AS l_shipinstruct_prf_1#3528, l_quantity_prf#3510 AS l_quantity_prf_1#3529, l_receiptdate_prf#3511 AS l_receiptdate_prf_1#3530, l_linenumber_prf#3512 AS l_linenumber_prf_1#3531, l_tax_prf#3513 AS l_tax_prf_1#3532, l_shipdate_prf#3514 AS l_shipdate_prf_1#3533, l_extendedprice_prf#3515 AS l_extendedprice_prf_1#3534, l_partkey_prf#3516 AS l_partkey_prf_1#3535, l_discount_prf#3517 AS l_discount_prf_1#3536, l_partkey_and_l_suppkey_prf#3518 AS l_partkey_and_l_suppkey_prf_1#3537, l_commitdate_prf#3519 AS l_commitdate_prf_1#3538, l_suppkey_prf#3520 AS l_suppkey_prf_1#3539, l_orderkey_prf#3521 AS l_orderkey_prf_1#3540]
            +- Relation[l_returnflag_prf#3503,l_orderkey_and_l_linenumber_prf#3504,l_comment_prf#3505,l_linestatus_prf#3506,rid#3507,l_shipmode_prf#3508,l_shipinstruct_prf#3509,l_quantity_prf#3510,l_receiptdate_prf#3511,l_linenumber_prf#3512,l_tax_prf#3513,l_shipdate_prf#3514,l_extendedprice_prf#3515,l_partkey_prf#3516,l_discount_prf#3517,l_partkey_and_l_suppkey_prf#3518,l_commitdate_prf#3519,l_suppkey_prf#3520,l_orderkey_prf#3521] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 96283ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/11 02:38:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:38:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3585L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 02:38:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3585L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3597]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#3592: string
         :     :- Project [rid#3587 AS rid_0#3592, n_regionkey_prf#3588 AS n_regionkey_prf_0#3593, n_nationkey_prf#3589 AS n_nationkey_prf_0#3594, n_name_prf#3590 AS n_name_prf_0#3595, n_comment_prf#3591 AS n_comment_prf_0#3596]
         :     :  +- Relation[rid#3587,n_regionkey_prf#3588,n_nationkey_prf#3589,n_name_prf#3590,n_comment_prf#3591] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3598 AS c_acctbal_prf_1#3607, rid#3599 AS rid_1#3608, c_name_prf#3600 AS c_name_prf_1#3609, c_nationkey_prf#3601 AS c_nationkey_prf_1#3610, c_custkey_prf#3602 AS c_custkey_prf_1#3611, c_comment_prf#3603 AS c_comment_prf_1#3612, c_address_prf#3604 AS c_address_prf_1#3613, c_mktsegment_prf#3605 AS c_mktsegment_prf_1#3614, c_phone_prf#3606 AS c_phone_prf_1#3615]
            +- Relation[c_acctbal_prf#3598,rid#3599,c_name_prf#3600,c_nationkey_prf#3601,c_custkey_prf#3602,c_comment_prf#3603,c_address_prf#3604,c_mktsegment_prf#3605,c_phone_prf#3606] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=150000
Elapsed time: 1934ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/11 02:38:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:38:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3658L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 02:38:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3658L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3680]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#3671: string
         :     :- Project [o_shippriority_prf#3660 AS o_shippriority_prf_0#3670, rid#3661 AS rid_0#3671, o_orderdate_prf#3662 AS o_orderdate_prf_0#3672, o_custkey_prf#3663 AS o_custkey_prf_0#3673, o_orderpriority_prf#3664 AS o_orderpriority_prf_0#3674, o_clerk_prf#3665 AS o_clerk_prf_0#3675, o_orderstatus_prf#3666 AS o_orderstatus_prf_0#3676, o_totalprice_prf#3667 AS o_totalprice_prf_0#3677, o_orderkey_prf#3668 AS o_orderkey_prf_0#3678, o_comment_prf#3669 AS o_comment_prf_0#3679]
         :     :  +- Relation[o_shippriority_prf#3660,rid#3661,o_orderdate_prf#3662,o_custkey_prf#3663,o_orderpriority_prf#3664,o_clerk_prf#3665,o_orderstatus_prf#3666,o_totalprice_prf#3667,o_orderkey_prf#3668,o_comment_prf#3669] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3681 AS l_returnflag_prf_1#3700, l_orderkey_and_l_linenumber_prf#3682 AS l_orderkey_and_l_linenumber_prf_1#3701, l_comment_prf#3683 AS l_comment_prf_1#3702, l_linestatus_prf#3684 AS l_linestatus_prf_1#3703, rid#3685 AS rid_1#3704, l_shipmode_prf#3686 AS l_shipmode_prf_1#3705, l_shipinstruct_prf#3687 AS l_shipinstruct_prf_1#3706, l_quantity_prf#3688 AS l_quantity_prf_1#3707, l_receiptdate_prf#3689 AS l_receiptdate_prf_1#3708, l_linenumber_prf#3690 AS l_linenumber_prf_1#3709, l_tax_prf#3691 AS l_tax_prf_1#3710, l_shipdate_prf#3692 AS l_shipdate_prf_1#3711, l_extendedprice_prf#3693 AS l_extendedprice_prf_1#3712, l_partkey_prf#3694 AS l_partkey_prf_1#3713, l_discount_prf#3695 AS l_discount_prf_1#3714, l_partkey_and_l_suppkey_prf#3696 AS l_partkey_and_l_suppkey_prf_1#3715, l_commitdate_prf#3697 AS l_commitdate_prf_1#3716, l_suppkey_prf#3698 AS l_suppkey_prf_1#3717, l_orderkey_prf#3699 AS l_orderkey_prf_1#3718]
            +- Relation[l_returnflag_prf#3681,l_orderkey_and_l_linenumber_prf#3682,l_comment_prf#3683,l_linestatus_prf#3684,rid#3685,l_shipmode_prf#3686,l_shipinstruct_prf#3687,l_quantity_prf#3688,l_receiptdate_prf#3689,l_linenumber_prf#3690,l_tax_prf#3691,l_shipdate_prf#3692,l_extendedprice_prf#3693,l_partkey_prf#3694,l_discount_prf#3695,l_partkey_and_l_suppkey_prf#3696,l_commitdate_prf#3697,l_suppkey_prf#3698,l_orderkey_prf#3699] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 199927ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/11 02:41:45 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:41:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3765L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 02:41:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3765L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3781]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#3775: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#3767 AS ps_partkey_and_ps_suppkey_prf_0#3774, rid#3768 AS rid_0#3775, ps_availqty_prf#3769 AS ps_availqty_prf_0#3776, ps_comment_prf#3770 AS ps_comment_prf_0#3777, ps_partkey_prf#3771 AS ps_partkey_prf_0#3778, ps_supplycost_prf#3772 AS ps_supplycost_prf_0#3779, ps_suppkey_prf#3773 AS ps_suppkey_prf_0#3780]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#3767,rid#3768,ps_availqty_prf#3769,ps_comment_prf#3770,ps_partkey_prf#3771,ps_supplycost_prf#3772,ps_suppkey_prf#3773] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#3782 AS p_comment_prf_1#3792, p_name_prf#3783 AS p_name_prf_1#3793, rid#3784 AS rid_1#3794, p_type_prf#3785 AS p_type_prf_1#3795, p_retailprice_prf#3786 AS p_retailprice_prf_1#3796, p_mfgr_prf#3787 AS p_mfgr_prf_1#3797, p_container_prf#3788 AS p_container_prf_1#3798, p_brand_prf#3789 AS p_brand_prf_1#3799, p_size_prf#3790 AS p_size_prf_1#3800, p_partkey_prf#3791 AS p_partkey_prf_1#3801]
            :  +- Relation[p_comment_prf#3782,p_name_prf#3783,rid#3784,p_type_prf#3785,p_retailprice_prf#3786,p_mfgr_prf#3787,p_container_prf#3788,p_brand_prf#3789,p_size_prf#3790,p_partkey_prf#3791] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3802]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#2096,value#2097] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 50700ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/11 02:42:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:42:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3844L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 02:42:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3844L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#3881]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3860]
         :     :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#3854: string
         :     :  :     :- Project [ps_partkey_and_ps_suppkey_prf#3846 AS ps_partkey_and_ps_suppkey_prf_0#3853, rid#3847 AS rid_0#3854, ps_availqty_prf#3848 AS ps_availqty_prf_0#3855, ps_comment_prf#3849 AS ps_comment_prf_0#3856, ps_partkey_prf#3850 AS ps_partkey_prf_0#3857, ps_supplycost_prf#3851 AS ps_supplycost_prf_0#3858, ps_suppkey_prf#3852 AS ps_suppkey_prf_0#3859]
         :     :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#3846,rid#3847,ps_availqty_prf#3848,ps_comment_prf#3849,ps_partkey_prf#3850,ps_supplycost_prf#3851,ps_suppkey_prf#3852] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#3861 AS p_comment_prf_1#3871, p_name_prf#3862 AS p_name_prf_1#3872, rid#3863 AS rid_1#3873, p_type_prf#3864 AS p_type_prf_1#3874, p_retailprice_prf#3865 AS p_retailprice_prf_1#3875, p_mfgr_prf#3866 AS p_mfgr_prf_1#3876, p_container_prf#3867 AS p_container_prf_1#3877, p_brand_prf#3868 AS p_brand_prf_1#3878, p_size_prf#3869 AS p_size_prf_1#3879, p_partkey_prf#3870 AS p_partkey_prf_1#3880]
         :     :     +- Relation[p_comment_prf#3861,p_name_prf#3862,rid#3863,p_type_prf#3864,p_retailprice_prf#3865,p_mfgr_prf#3866,p_container_prf#3867,p_brand_prf#3868,p_size_prf#3869,p_partkey_prf#3870] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3882 AS s_phone_prf_2#3890, rid#3883 AS rid_2#3891, s_address_prf#3884 AS s_address_prf_2#3892, s_nationkey_prf#3885 AS s_nationkey_prf_2#3893, s_suppkey_prf#3886 AS s_suppkey_prf_2#3894, s_name_prf#3887 AS s_name_prf_2#3895, s_acctbal_prf#3888 AS s_acctbal_prf_2#3896, s_comment_prf#3889 AS s_comment_prf_2#3897]
            +- Relation[s_phone_prf#3882,rid#3883,s_address_prf#3884,s_nationkey_prf#3885,s_suppkey_prf#3886,s_name_prf#3887,s_acctbal_prf#3888,s_comment_prf#3889] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 109743ms

f2=
select * from part where p_size = 15
19/10/11 02:44:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:44:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3935L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 02:44:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3935L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#3937 AS p_comment_prf_0#3947, p_name_prf#3938 AS p_name_prf_0#3948, rid#3939 AS rid_0#3949, p_type_prf#3940 AS p_type_prf_0#3950, p_retailprice_prf#3941 AS p_retailprice_prf_0#3951, p_mfgr_prf#3942 AS p_mfgr_prf_0#3952, p_container_prf#3943 AS p_container_prf_0#3953, p_brand_prf#3944 AS p_brand_prf_0#3954, p_size_prf#3945 AS p_size_prf_0#3955, p_partkey_prf#3946 AS p_partkey_prf_0#3956]
         :  +- Relation[p_comment_prf#3937,p_name_prf#3938,rid#3939,p_type_prf#3940,p_retailprice_prf#3941,p_mfgr_prf#3942,p_container_prf#3943,p_brand_prf#3944,p_size_prf#3945,p_partkey_prf#3946] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3957]
            +- DexRidFilter part~p_size~15
               +- Relation[label#2096,value#2097] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3907
Elapsed time: 121ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/11 02:44:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:44:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4003L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 02:44:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4003L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4043]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#4028: string
         :     :  :     :- Project [l_returnflag_prf#4005 AS l_returnflag_prf_0#4024, l_orderkey_and_l_linenumber_prf#4006 AS l_orderkey_and_l_linenumber_prf_0#4025, l_comment_prf#4007 AS l_comment_prf_0#4026, l_linestatus_prf#4008 AS l_linestatus_prf_0#4027, rid#4009 AS rid_0#4028, l_shipmode_prf#4010 AS l_shipmode_prf_0#4029, l_shipinstruct_prf#4011 AS l_shipinstruct_prf_0#4030, l_quantity_prf#4012 AS l_quantity_prf_0#4031, l_receiptdate_prf#4013 AS l_receiptdate_prf_0#4032, l_linenumber_prf#4014 AS l_linenumber_prf_0#4033, l_tax_prf#4015 AS l_tax_prf_0#4034, l_shipdate_prf#4016 AS l_shipdate_prf_0#4035, l_extendedprice_prf#4017 AS l_extendedprice_prf_0#4036, l_partkey_prf#4018 AS l_partkey_prf_0#4037, l_discount_prf#4019 AS l_discount_prf_0#4038, l_partkey_and_l_suppkey_prf#4020 AS l_partkey_and_l_suppkey_prf_0#4039, l_commitdate_prf#4021 AS l_commitdate_prf_0#4040, l_suppkey_prf#4022 AS l_suppkey_prf_0#4041, l_orderkey_prf#4023 AS l_orderkey_prf_0#4042]
         :     :  :     :  +- Relation[l_returnflag_prf#4005,l_orderkey_and_l_linenumber_prf#4006,l_comment_prf#4007,l_linestatus_prf#4008,rid#4009,l_shipmode_prf#4010,l_shipinstruct_prf#4011,l_quantity_prf#4012,l_receiptdate_prf#4013,l_linenumber_prf#4014,l_tax_prf#4015,l_shipdate_prf#4016,l_extendedprice_prf#4017,l_partkey_prf#4018,l_discount_prf#4019,l_partkey_and_l_suppkey_prf#4020,l_commitdate_prf#4021,l_suppkey_prf#4022,l_orderkey_prf#4023] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#4044 AS p_comment_prf_1#4054, p_name_prf#4045 AS p_name_prf_1#4055, rid#4046 AS rid_1#4056, p_type_prf#4047 AS p_type_prf_1#4057, p_retailprice_prf#4048 AS p_retailprice_prf_1#4058, p_mfgr_prf#4049 AS p_mfgr_prf_1#4059, p_container_prf#4050 AS p_container_prf_1#4060, p_brand_prf#4051 AS p_brand_prf_1#4061, p_size_prf#4052 AS p_size_prf_1#4062, p_partkey_prf#4053 AS p_partkey_prf_1#4063]
         :     :     +- Relation[p_comment_prf#4044,p_name_prf#4045,rid#4046,p_type_prf#4047,p_retailprice_prf#4048,p_mfgr_prf#4049,p_container_prf#4050,p_brand_prf#4051,p_size_prf#4052,p_partkey_prf#4053] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4065 AS s_phone_prf_2#4073, rid#4066 AS rid_2#4074, s_address_prf#4067 AS s_address_prf_2#4075, s_nationkey_prf#4068 AS s_nationkey_prf_2#4076, s_suppkey_prf#4069 AS s_suppkey_prf_2#4077, s_name_prf#4070 AS s_name_prf_2#4078, s_acctbal_prf#4071 AS s_acctbal_prf_2#4079, s_comment_prf#4072 AS s_comment_prf_2#4080]
            +- Relation[s_phone_prf#4065,rid#4066,s_address_prf#4067,s_nationkey_prf#4068,s_suppkey_prf#4069,s_name_prf#4070,s_acctbal_prf#4071,s_comment_prf#4072] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 292706ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/11 02:49:18 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:49:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4146L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 02:49:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4146L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4186]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4171: string
         :     :- Project [l_returnflag_prf#4148 AS l_returnflag_prf_0#4167, l_orderkey_and_l_linenumber_prf#4149 AS l_orderkey_and_l_linenumber_prf_0#4168, l_comment_prf#4150 AS l_comment_prf_0#4169, l_linestatus_prf#4151 AS l_linestatus_prf_0#4170, rid#4152 AS rid_0#4171, l_shipmode_prf#4153 AS l_shipmode_prf_0#4172, l_shipinstruct_prf#4154 AS l_shipinstruct_prf_0#4173, l_quantity_prf#4155 AS l_quantity_prf_0#4174, l_receiptdate_prf#4156 AS l_receiptdate_prf_0#4175, l_linenumber_prf#4157 AS l_linenumber_prf_0#4176, l_tax_prf#4158 AS l_tax_prf_0#4177, l_shipdate_prf#4159 AS l_shipdate_prf_0#4178, l_extendedprice_prf#4160 AS l_extendedprice_prf_0#4179, l_partkey_prf#4161 AS l_partkey_prf_0#4180, l_discount_prf#4162 AS l_discount_prf_0#4181, l_partkey_and_l_suppkey_prf#4163 AS l_partkey_and_l_suppkey_prf_0#4182, l_commitdate_prf#4164 AS l_commitdate_prf_0#4183, l_suppkey_prf#4165 AS l_suppkey_prf_0#4184, l_orderkey_prf#4166 AS l_orderkey_prf_0#4185]
         :     :  +- Relation[l_returnflag_prf#4148,l_orderkey_and_l_linenumber_prf#4149,l_comment_prf#4150,l_linestatus_prf#4151,rid#4152,l_shipmode_prf#4153,l_shipinstruct_prf#4154,l_quantity_prf#4155,l_receiptdate_prf#4156,l_linenumber_prf#4157,l_tax_prf#4158,l_shipdate_prf#4159,l_extendedprice_prf#4160,l_partkey_prf#4161,l_discount_prf#4162,l_partkey_and_l_suppkey_prf#4163,l_commitdate_prf#4164,l_suppkey_prf#4165,l_orderkey_prf#4166] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4187 AS o_shippriority_prf_1#4197, rid#4188 AS rid_1#4198, o_orderdate_prf#4189 AS o_orderdate_prf_1#4199, o_custkey_prf#4190 AS o_custkey_prf_1#4200, o_orderpriority_prf#4191 AS o_orderpriority_prf_1#4201, o_clerk_prf#4192 AS o_clerk_prf_1#4202, o_orderstatus_prf#4193 AS o_orderstatus_prf_1#4203, o_totalprice_prf#4194 AS o_totalprice_prf_1#4204, o_orderkey_prf#4195 AS o_orderkey_prf_1#4205, o_comment_prf#4196 AS o_comment_prf_1#4206]
            +- Relation[o_shippriority_prf#4187,rid#4188,o_orderdate_prf#4189,o_custkey_prf#4190,o_orderpriority_prf#4191,o_clerk_prf#4192,o_orderstatus_prf#4193,o_totalprice_prf#4194,o_orderkey_prf#4195,o_comment_prf#4196] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 131145ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/11 02:51:29 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:51:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4253L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 02:51:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4253L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4276]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4267: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#4255 AS p_comment_prf_0#4265, p_name_prf#4256 AS p_name_prf_0#4266, rid#4257 AS rid_0#4267, p_type_prf#4258 AS p_type_prf_0#4268, p_retailprice_prf#4259 AS p_retailprice_prf_0#4269, p_mfgr_prf#4260 AS p_mfgr_prf_0#4270, p_container_prf#4261 AS p_container_prf_0#4271, p_brand_prf#4262 AS p_brand_prf_0#4272, p_size_prf#4263 AS p_size_prf_0#4273, p_partkey_prf#4264 AS p_partkey_prf_0#4274]
         :     :  :  +- Relation[p_comment_prf#4255,p_name_prf#4256,rid#4257,p_type_prf#4258,p_retailprice_prf#4259,p_mfgr_prf#4260,p_container_prf#4261,p_brand_prf#4262,p_size_prf#4263,p_partkey_prf#4264] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4275]
         :     :     +- DexRidFilter part~p_size~15
         :     :        +- Relation[label#2096,value#2097] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4277 AS ps_partkey_and_ps_suppkey_prf_1#4284, rid#4278 AS rid_1#4285, ps_availqty_prf#4279 AS ps_availqty_prf_1#4286, ps_comment_prf#4280 AS ps_comment_prf_1#4287, ps_partkey_prf#4281 AS ps_partkey_prf_1#4288, ps_supplycost_prf#4282 AS ps_supplycost_prf_1#4289, ps_suppkey_prf#4283 AS ps_suppkey_prf_1#4290]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4277,rid#4278,ps_availqty_prf#4279,ps_comment_prf#4280,ps_partkey_prf#4281,ps_supplycost_prf#4282,ps_suppkey_prf#4283] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 403ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/11 02:51:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 02:51:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4330L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 02:51:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4330L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#4359]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4348]
         :     :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#4341: string
         :     :  :     :- Project [s_phone_prf#4332 AS s_phone_prf_0#4340, rid#4333 AS rid_0#4341, s_address_prf#4334 AS s_address_prf_0#4342, s_nationkey_prf#4335 AS s_nationkey_prf_0#4343, s_suppkey_prf#4336 AS s_suppkey_prf_0#4344, s_name_prf#4337 AS s_name_prf_0#4345, s_acctbal_prf#4338 AS s_acctbal_prf_0#4346, s_comment_prf#4339 AS s_comment_prf_0#4347]
         :     :  :     :  +- Relation[s_phone_prf#4332,rid#4333,s_address_prf#4334,s_nationkey_prf#4335,s_suppkey_prf#4336,s_name_prf#4337,s_acctbal_prf#4338,s_comment_prf#4339] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [rid#4349 AS rid_1#4354, n_regionkey_prf#4350 AS n_regionkey_prf_1#4355, n_nationkey_prf#4351 AS n_nationkey_prf_1#4356, n_name_prf#4352 AS n_name_prf_1#4357, n_comment_prf#4353 AS n_comment_prf_1#4358]
         :     :     +- Relation[rid#4349,n_regionkey_prf#4350,n_nationkey_prf#4351,n_name_prf#4352,n_comment_prf#4353] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4360 AS c_acctbal_prf_2#4369, rid#4361 AS rid_2#4370, c_name_prf#4362 AS c_name_prf_2#4371, c_nationkey_prf#4363 AS c_nationkey_prf_2#4372, c_custkey_prf#4364 AS c_custkey_prf_2#4373, c_comment_prf#4365 AS c_comment_prf_2#4374, c_address_prf#4366 AS c_address_prf_2#4375, c_mktsegment_prf#4367 AS c_mktsegment_prf_2#4376, c_phone_prf#4368 AS c_phone_prf_2#4377]
            +- Relation[c_acctbal_prf#4360,rid#4361,c_name_prf#4362,c_nationkey_prf#4363,c_custkey_prf#4364,c_comment_prf#4365,c_address_prf#4366,c_mktsegment_prf#4367,c_phone_prf#4368] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 689752ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/11 03:02:59 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:02:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4428L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 03:02:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4428L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4468]
         :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#4453: string
         :     :- Project [l_returnflag_prf#4430 AS l_returnflag_prf_0#4449, l_orderkey_and_l_linenumber_prf#4431 AS l_orderkey_and_l_linenumber_prf_0#4450, l_comment_prf#4432 AS l_comment_prf_0#4451, l_linestatus_prf#4433 AS l_linestatus_prf_0#4452, rid#4434 AS rid_0#4453, l_shipmode_prf#4435 AS l_shipmode_prf_0#4454, l_shipinstruct_prf#4436 AS l_shipinstruct_prf_0#4455, l_quantity_prf#4437 AS l_quantity_prf_0#4456, l_receiptdate_prf#4438 AS l_receiptdate_prf_0#4457, l_linenumber_prf#4439 AS l_linenumber_prf_0#4458, l_tax_prf#4440 AS l_tax_prf_0#4459, l_shipdate_prf#4441 AS l_shipdate_prf_0#4460, l_extendedprice_prf#4442 AS l_extendedprice_prf_0#4461, l_partkey_prf#4443 AS l_partkey_prf_0#4462, l_discount_prf#4444 AS l_discount_prf_0#4463, l_partkey_and_l_suppkey_prf#4445 AS l_partkey_and_l_suppkey_prf_0#4464, l_commitdate_prf#4446 AS l_commitdate_prf_0#4465, l_suppkey_prf#4447 AS l_suppkey_prf_0#4466, l_orderkey_prf#4448 AS l_orderkey_prf_0#4467]
         :     :  +- Relation[l_returnflag_prf#4430,l_orderkey_and_l_linenumber_prf#4431,l_comment_prf#4432,l_linestatus_prf#4433,rid#4434,l_shipmode_prf#4435,l_shipinstruct_prf#4436,l_quantity_prf#4437,l_receiptdate_prf#4438,l_linenumber_prf#4439,l_tax_prf#4440,l_shipdate_prf#4441,l_extendedprice_prf#4442,l_partkey_prf#4443,l_discount_prf#4444,l_partkey_and_l_suppkey_prf#4445,l_commitdate_prf#4446,l_suppkey_prf#4447,l_orderkey_prf#4448] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#4469 AS p_comment_prf_1#4479, p_name_prf#4470 AS p_name_prf_1#4480, rid#4471 AS rid_1#4481, p_type_prf#4472 AS p_type_prf_1#4482, p_retailprice_prf#4473 AS p_retailprice_prf_1#4483, p_mfgr_prf#4474 AS p_mfgr_prf_1#4484, p_container_prf#4475 AS p_container_prf_1#4485, p_brand_prf#4476 AS p_brand_prf_1#4486, p_size_prf#4477 AS p_size_prf_1#4487, p_partkey_prf#4478 AS p_partkey_prf_1#4488]
            +- Relation[p_comment_prf#4469,p_name_prf#4470,rid#4471,p_type_prf#4472,p_retailprice_prf#4473,p_mfgr_prf#4474,p_container_prf#4475,p_brand_prf#4476,p_size_prf#4477,p_partkey_prf#4478] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 130317ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/11 03:05:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:05:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4554L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 03:05:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4554L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4574]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4566: string
         :     :- Project [c_acctbal_prf#4556 AS c_acctbal_prf_0#4565, rid#4557 AS rid_0#4566, c_name_prf#4558 AS c_name_prf_0#4567, c_nationkey_prf#4559 AS c_nationkey_prf_0#4568, c_custkey_prf#4560 AS c_custkey_prf_0#4569, c_comment_prf#4561 AS c_comment_prf_0#4570, c_address_prf#4562 AS c_address_prf_0#4571, c_mktsegment_prf#4563 AS c_mktsegment_prf_0#4572, c_phone_prf#4564 AS c_phone_prf_0#4573]
         :     :  +- Relation[c_acctbal_prf#4556,rid#4557,c_name_prf#4558,c_nationkey_prf#4559,c_custkey_prf#4560,c_comment_prf#4561,c_address_prf#4562,c_mktsegment_prf#4563,c_phone_prf#4564] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#4595]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#4586: string
            :     :- Project [o_shippriority_prf#4575 AS o_shippriority_prf_1#4585, rid#4576 AS rid_1#4586, o_orderdate_prf#4577 AS o_orderdate_prf_1#4587, o_custkey_prf#4578 AS o_custkey_prf_1#4588, o_orderpriority_prf#4579 AS o_orderpriority_prf_1#4589, o_clerk_prf#4580 AS o_clerk_prf_1#4590, o_orderstatus_prf#4581 AS o_orderstatus_prf_1#4591, o_totalprice_prf#4582 AS o_totalprice_prf_1#4592, o_orderkey_prf#4583 AS o_orderkey_prf_1#4593, o_comment_prf#4584 AS o_comment_prf_1#4594]
            :     :  +- Relation[o_shippriority_prf#4575,rid#4576,o_orderdate_prf#4577,o_custkey_prf#4578,o_orderpriority_prf#4579,o_clerk_prf#4580,o_orderstatus_prf#4581,o_totalprice_prf#4582,o_orderkey_prf#4583,o_comment_prf#4584] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4596 AS l_returnflag_prf_2#4615, l_orderkey_and_l_linenumber_prf#4597 AS l_orderkey_and_l_linenumber_prf_2#4616, l_comment_prf#4598 AS l_comment_prf_2#4617, l_linestatus_prf#4599 AS l_linestatus_prf_2#4618, rid#4600 AS rid_2#4619, l_shipmode_prf#4601 AS l_shipmode_prf_2#4620, l_shipinstruct_prf#4602 AS l_shipinstruct_prf_2#4621, l_quantity_prf#4603 AS l_quantity_prf_2#4622, l_receiptdate_prf#4604 AS l_receiptdate_prf_2#4623, l_linenumber_prf#4605 AS l_linenumber_prf_2#4624, l_tax_prf#4606 AS l_tax_prf_2#4625, l_shipdate_prf#4607 AS l_shipdate_prf_2#4626, l_extendedprice_prf#4608 AS l_extendedprice_prf_2#4627, l_partkey_prf#4609 AS l_partkey_prf_2#4628, l_discount_prf#4610 AS l_discount_prf_2#4629, l_partkey_and_l_suppkey_prf#4611 AS l_partkey_and_l_suppkey_prf_2#4630, l_commitdate_prf#4612 AS l_commitdate_prf_2#4631, l_suppkey_prf#4613 AS l_suppkey_prf_2#4632, l_orderkey_prf#4614 AS l_orderkey_prf_2#4633]
               +- Relation[l_returnflag_prf#4596,l_orderkey_and_l_linenumber_prf#4597,l_comment_prf#4598,l_linestatus_prf#4599,rid#4600,l_shipmode_prf#4601,l_shipinstruct_prf#4602,l_quantity_prf#4603,l_receiptdate_prf#4604,l_linenumber_prf#4605,l_tax_prf#4606,l_shipdate_prf#4607,l_extendedprice_prf#4608,l_partkey_prf#4609,l_discount_prf#4610,l_partkey_and_l_suppkey_prf#4611,l_commitdate_prf#4612,l_suppkey_prf#4613,l_orderkey_prf#4614] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 239891ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/11 03:09:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:09:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4687L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 03:09:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4687L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4705]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#4698: string
         :     :- Project [s_phone_prf#4689 AS s_phone_prf_0#4697, rid#4690 AS rid_0#4698, s_address_prf#4691 AS s_address_prf_0#4699, s_nationkey_prf#4692 AS s_nationkey_prf_0#4700, s_suppkey_prf#4693 AS s_suppkey_prf_0#4701, s_name_prf#4694 AS s_name_prf_0#4702, s_acctbal_prf#4695 AS s_acctbal_prf_0#4703, s_comment_prf#4696 AS s_comment_prf_0#4704]
         :     :  +- Relation[s_phone_prf#4689,rid#4690,s_address_prf#4691,s_nationkey_prf#4692,s_suppkey_prf#4693,s_name_prf#4694,s_acctbal_prf#4695,s_comment_prf#4696] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4706 AS ps_partkey_and_ps_suppkey_prf_1#4713, rid#4707 AS rid_1#4714, ps_availqty_prf#4708 AS ps_availqty_prf_1#4715, ps_comment_prf#4709 AS ps_comment_prf_1#4716, ps_partkey_prf#4710 AS ps_partkey_prf_1#4717, ps_supplycost_prf#4711 AS ps_supplycost_prf_1#4718, ps_suppkey_prf#4712 AS ps_suppkey_prf_1#4719]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4706,rid#4707,ps_availqty_prf#4708,ps_comment_prf#4709,ps_partkey_prf#4710,ps_supplycost_prf#4711,ps_suppkey_prf#4712] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 11214ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/11 03:09:21 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:09:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4755L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 03:09:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4755L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4775]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4767: string
         :     :- Project [c_acctbal_prf#4757 AS c_acctbal_prf_0#4766, rid#4758 AS rid_0#4767, c_name_prf#4759 AS c_name_prf_0#4768, c_nationkey_prf#4760 AS c_nationkey_prf_0#4769, c_custkey_prf#4761 AS c_custkey_prf_0#4770, c_comment_prf#4762 AS c_comment_prf_0#4771, c_address_prf#4763 AS c_address_prf_0#4772, c_mktsegment_prf#4764 AS c_mktsegment_prf_0#4773, c_phone_prf#4765 AS c_phone_prf_0#4774]
         :     :  +- Relation[c_acctbal_prf#4757,rid#4758,c_name_prf#4759,c_nationkey_prf#4760,c_custkey_prf#4761,c_comment_prf#4762,c_address_prf#4763,c_mktsegment_prf#4764,c_phone_prf#4765] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4776 AS o_shippriority_prf_1#4786, rid#4777 AS rid_1#4787, o_orderdate_prf#4778 AS o_orderdate_prf_1#4788, o_custkey_prf#4779 AS o_custkey_prf_1#4789, o_orderpriority_prf#4780 AS o_orderpriority_prf_1#4790, o_clerk_prf#4781 AS o_clerk_prf_1#4791, o_orderstatus_prf#4782 AS o_orderstatus_prf_1#4792, o_totalprice_prf#4783 AS o_totalprice_prf_1#4793, o_orderkey_prf#4784 AS o_orderkey_prf_1#4794, o_comment_prf#4785 AS o_comment_prf_1#4795]
            +- Relation[o_shippriority_prf#4776,rid#4777,o_orderdate_prf#4778,o_custkey_prf#4779,o_orderpriority_prf#4780,o_clerk_prf#4781,o_orderstatus_prf#4782,o_totalprice_prf#4783,o_orderkey_prf#4784,o_comment_prf#4785] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1500000
Elapsed time: 40651ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/11 03:10:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:10:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4851L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 03:10:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4851L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_2#4871]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4863: string
         :     :- Project [c_acctbal_prf#4853 AS c_acctbal_prf_0#4862, rid#4854 AS rid_0#4863, c_name_prf#4855 AS c_name_prf_0#4864, c_nationkey_prf#4856 AS c_nationkey_prf_0#4865, c_custkey_prf#4857 AS c_custkey_prf_0#4866, c_comment_prf#4858 AS c_comment_prf_0#4867, c_address_prf#4859 AS c_address_prf_0#4868, c_mktsegment_prf#4860 AS c_mktsegment_prf_0#4869, c_phone_prf#4861 AS c_phone_prf_0#4870]
         :     :  +- Relation[c_acctbal_prf#4853,rid#4854,c_name_prf#4855,c_nationkey_prf#4856,c_custkey_prf#4857,c_comment_prf#4858,c_address_prf#4859,c_mktsegment_prf#4860,c_phone_prf#4861] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#4910]
            :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_1#4895: string
            :     :- Project [l_returnflag_prf#4872 AS l_returnflag_prf_1#4891, l_orderkey_and_l_linenumber_prf#4873 AS l_orderkey_and_l_linenumber_prf_1#4892, l_comment_prf#4874 AS l_comment_prf_1#4893, l_linestatus_prf#4875 AS l_linestatus_prf_1#4894, rid#4876 AS rid_1#4895, l_shipmode_prf#4877 AS l_shipmode_prf_1#4896, l_shipinstruct_prf#4878 AS l_shipinstruct_prf_1#4897, l_quantity_prf#4879 AS l_quantity_prf_1#4898, l_receiptdate_prf#4880 AS l_receiptdate_prf_1#4899, l_linenumber_prf#4881 AS l_linenumber_prf_1#4900, l_tax_prf#4882 AS l_tax_prf_1#4901, l_shipdate_prf#4883 AS l_shipdate_prf_1#4902, l_extendedprice_prf#4884 AS l_extendedprice_prf_1#4903, l_partkey_prf#4885 AS l_partkey_prf_1#4904, l_discount_prf#4886 AS l_discount_prf_1#4905, l_partkey_and_l_suppkey_prf#4887 AS l_partkey_and_l_suppkey_prf_1#4906, l_commitdate_prf#4888 AS l_commitdate_prf_1#4907, l_suppkey_prf#4889 AS l_suppkey_prf_1#4908, l_orderkey_prf#4890 AS l_orderkey_prf_1#4909]
            :     :  +- Relation[l_returnflag_prf#4872,l_orderkey_and_l_linenumber_prf#4873,l_comment_prf#4874,l_linestatus_prf#4875,rid#4876,l_shipmode_prf#4877,l_shipinstruct_prf#4878,l_quantity_prf#4879,l_receiptdate_prf#4880,l_linenumber_prf#4881,l_tax_prf#4882,l_shipdate_prf#4883,l_extendedprice_prf#4884,l_partkey_prf#4885,l_discount_prf#4886,l_partkey_and_l_suppkey_prf#4887,l_commitdate_prf#4888,l_suppkey_prf#4889,l_orderkey_prf#4890] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4911 AS o_shippriority_prf_2#4921, rid#4912 AS rid_2#4922, o_orderdate_prf#4913 AS o_orderdate_prf_2#4923, o_custkey_prf#4914 AS o_custkey_prf_2#4924, o_orderpriority_prf#4915 AS o_orderpriority_prf_2#4925, o_clerk_prf#4916 AS o_clerk_prf_2#4926, o_orderstatus_prf#4917 AS o_orderstatus_prf_2#4927, o_totalprice_prf#4918 AS o_totalprice_prf_2#4928, o_orderkey_prf#4919 AS o_orderkey_prf_2#4929, o_comment_prf#4920 AS o_comment_prf_2#4930]
               +- Relation[o_shippriority_prf#4911,rid#4912,o_orderdate_prf#4913,o_custkey_prf#4914,o_orderpriority_prf#4915,o_clerk_prf#4916,o_orderstatus_prf#4917,o_totalprice_prf#4918,o_orderkey_prf#4919,o_comment_prf#4920] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 175561ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/11 03:12:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:12:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4988L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 03:12:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4988L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#4990 AS l_returnflag_prf_0#5009, l_orderkey_and_l_linenumber_prf#4991 AS l_orderkey_and_l_linenumber_prf_0#5010, l_comment_prf#4992 AS l_comment_prf_0#5011, l_linestatus_prf#4993 AS l_linestatus_prf_0#5012, rid#4994 AS rid_0#5013, l_shipmode_prf#4995 AS l_shipmode_prf_0#5014, l_shipinstruct_prf#4996 AS l_shipinstruct_prf_0#5015, l_quantity_prf#4997 AS l_quantity_prf_0#5016, l_receiptdate_prf#4998 AS l_receiptdate_prf_0#5017, l_linenumber_prf#4999 AS l_linenumber_prf_0#5018, l_tax_prf#5000 AS l_tax_prf_0#5019, l_shipdate_prf#5001 AS l_shipdate_prf_0#5020, l_extendedprice_prf#5002 AS l_extendedprice_prf_0#5021, l_partkey_prf#5003 AS l_partkey_prf_0#5022, l_discount_prf#5004 AS l_discount_prf_0#5023, l_partkey_and_l_suppkey_prf#5005 AS l_partkey_and_l_suppkey_prf_0#5024, l_commitdate_prf#5006 AS l_commitdate_prf_0#5025, l_suppkey_prf#5007 AS l_suppkey_prf_0#5026, l_orderkey_prf#5008 AS l_orderkey_prf_0#5027]
         :  +- Relation[l_returnflag_prf#4990,l_orderkey_and_l_linenumber_prf#4991,l_comment_prf#4992,l_linestatus_prf#4993,rid#4994,l_shipmode_prf#4995,l_shipinstruct_prf#4996,l_quantity_prf#4997,l_receiptdate_prf#4998,l_linenumber_prf#4999,l_tax_prf#5000,l_shipdate_prf#5001,l_extendedprice_prf#5002,l_partkey_prf#5003,l_discount_prf#5004,l_partkey_and_l_suppkey_prf#5005,l_commitdate_prf#5006,l_suppkey_prf#5007,l_orderkey_prf#5008] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5028]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#2096,value#2097] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 13861ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/11 03:13:11 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:13:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5058L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 03:13:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5058L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#5068]
         :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#5067: string
         :     :- Project [r_regionkey_prf#5060 AS r_regionkey_prf_0#5064, r_name_prf#5061 AS r_name_prf_0#5065, r_comment_prf#5062 AS r_comment_prf_0#5066, rid#5063 AS rid_0#5067]
         :     :  +- Relation[r_regionkey_prf#5060,r_name_prf#5061,r_comment_prf#5062,rid#5063] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#5069 AS rid_1#5074, n_regionkey_prf#5070 AS n_regionkey_prf_1#5075, n_nationkey_prf#5071 AS n_nationkey_prf_1#5076, n_name_prf#5072 AS n_name_prf_1#5077, n_comment_prf#5073 AS n_comment_prf_1#5078]
            +- Relation[rid#5069,n_regionkey_prf#5070,n_nationkey_prf#5071,n_name_prf#5072,n_comment_prf#5073] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=25
Elapsed time: 71ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/11 03:13:11 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:13:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5095L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 03:13:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5095L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#5097 AS rid_0#5102, n_regionkey_prf#5098 AS n_regionkey_prf_0#5103, n_nationkey_prf#5099 AS n_nationkey_prf_0#5104, n_name_prf#5100 AS n_name_prf_0#5105, n_comment_prf#5101 AS n_comment_prf_0#5106]
         :  +- Relation[rid#5097,n_regionkey_prf#5098,n_nationkey_prf#5099,n_name_prf#5100,n_comment_prf#5101] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5107]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#2096,value#2097] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 48ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/11 03:13:11 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:13:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5130L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 03:13:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5130L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#5152]
         :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#5144: string
         :     :- Project [p_comment_prf#5132 AS p_comment_prf_0#5142, p_name_prf#5133 AS p_name_prf_0#5143, rid#5134 AS rid_0#5144, p_type_prf#5135 AS p_type_prf_0#5145, p_retailprice_prf#5136 AS p_retailprice_prf_0#5146, p_mfgr_prf#5137 AS p_mfgr_prf_0#5147, p_container_prf#5138 AS p_container_prf_0#5148, p_brand_prf#5139 AS p_brand_prf_0#5149, p_size_prf#5140 AS p_size_prf_0#5150, p_partkey_prf#5141 AS p_partkey_prf_0#5151]
         :     :  +- Relation[p_comment_prf#5132,p_name_prf#5133,rid#5134,p_type_prf#5135,p_retailprice_prf#5136,p_mfgr_prf#5137,p_container_prf#5138,p_brand_prf#5139,p_size_prf#5140,p_partkey_prf#5141] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#5153 AS ps_partkey_and_ps_suppkey_prf_1#5160, rid#5154 AS rid_1#5161, ps_availqty_prf#5155 AS ps_availqty_prf_1#5162, ps_comment_prf#5156 AS ps_comment_prf_1#5163, ps_partkey_prf#5157 AS ps_partkey_prf_1#5164, ps_supplycost_prf#5158 AS ps_supplycost_prf_1#5165, ps_suppkey_prf#5159 AS ps_suppkey_prf_1#5166]
            +- Relation[ps_partkey_and_ps_suppkey_prf#5153,rid#5154,ps_availqty_prf#5155,ps_comment_prf#5156,ps_partkey_prf#5157,ps_supplycost_prf#5158,ps_suppkey_prf#5159] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 32202ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_orderkey and l_orderkey = o_orderkey
19/10/11 03:13:43 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:13:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5220L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 03:13:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5220L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_2#5260]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#5245: string
         :     :- Project [l_returnflag_prf#5222 AS l_returnflag_prf_0#5241, l_orderkey_and_l_linenumber_prf#5223 AS l_orderkey_and_l_linenumber_prf_0#5242, l_comment_prf#5224 AS l_comment_prf_0#5243, l_linestatus_prf#5225 AS l_linestatus_prf_0#5244, rid#5226 AS rid_0#5245, l_shipmode_prf#5227 AS l_shipmode_prf_0#5246, l_shipinstruct_prf#5228 AS l_shipinstruct_prf_0#5247, l_quantity_prf#5229 AS l_quantity_prf_0#5248, l_receiptdate_prf#5230 AS l_receiptdate_prf_0#5249, l_linenumber_prf#5231 AS l_linenumber_prf_0#5250, l_tax_prf#5232 AS l_tax_prf_0#5251, l_shipdate_prf#5233 AS l_shipdate_prf_0#5252, l_extendedprice_prf#5234 AS l_extendedprice_prf_0#5253, l_partkey_prf#5235 AS l_partkey_prf_0#5254, l_discount_prf#5236 AS l_discount_prf_0#5255, l_partkey_and_l_suppkey_prf#5237 AS l_partkey_and_l_suppkey_prf_0#5256, l_commitdate_prf#5238 AS l_commitdate_prf_0#5257, l_suppkey_prf#5239 AS l_suppkey_prf_0#5258, l_orderkey_prf#5240 AS l_orderkey_prf_0#5259]
         :     :  +- Relation[l_returnflag_prf#5222,l_orderkey_and_l_linenumber_prf#5223,l_comment_prf#5224,l_linestatus_prf#5225,rid#5226,l_shipmode_prf#5227,l_shipinstruct_prf#5228,l_quantity_prf#5229,l_receiptdate_prf#5230,l_linenumber_prf#5231,l_tax_prf#5232,l_shipdate_prf#5233,l_extendedprice_prf#5234,l_partkey_prf#5235,l_discount_prf#5236,l_partkey_and_l_suppkey_prf#5237,l_commitdate_prf#5238,l_suppkey_prf#5239,l_orderkey_prf#5240] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#5279]
            :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#5271: string
            :     :- Project [c_acctbal_prf#5261 AS c_acctbal_prf_1#5270, rid#5262 AS rid_1#5271, c_name_prf#5263 AS c_name_prf_1#5272, c_nationkey_prf#5264 AS c_nationkey_prf_1#5273, c_custkey_prf#5265 AS c_custkey_prf_1#5274, c_comment_prf#5266 AS c_comment_prf_1#5275, c_address_prf#5267 AS c_address_prf_1#5276, c_mktsegment_prf#5268 AS c_mktsegment_prf_1#5277, c_phone_prf#5269 AS c_phone_prf_1#5278]
            :     :  +- Relation[c_acctbal_prf#5261,rid#5262,c_name_prf#5263,c_nationkey_prf#5264,c_custkey_prf#5265,c_comment_prf#5266,c_address_prf#5267,c_mktsegment_prf#5268,c_phone_prf#5269] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#5280 AS o_shippriority_prf_2#5290, rid#5281 AS rid_2#5291, o_orderdate_prf#5282 AS o_orderdate_prf_2#5292, o_custkey_prf#5283 AS o_custkey_prf_2#5293, o_orderpriority_prf#5284 AS o_orderpriority_prf_2#5294, o_clerk_prf#5285 AS o_clerk_prf_2#5295, o_orderstatus_prf#5286 AS o_orderstatus_prf_2#5296, o_totalprice_prf#5287 AS o_totalprice_prf_2#5297, o_orderkey_prf#5288 AS o_orderkey_prf_2#5298, o_comment_prf#5289 AS o_comment_prf_2#5299]
               +- Relation[o_shippriority_prf#5280,rid#5281,o_orderdate_prf#5282,o_custkey_prf#5283,o_orderpriority_prf#5284,o_clerk_prf#5285,o_orderstatus_prf#5286,o_totalprice_prf#5287,o_orderkey_prf#5288,o_comment_prf#5289] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 175289ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/11 03:16:38 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:16:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5357L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 03:16:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5357L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#5359 AS l_returnflag_prf_0#5378, l_orderkey_and_l_linenumber_prf#5360 AS l_orderkey_and_l_linenumber_prf_0#5379, l_comment_prf#5361 AS l_comment_prf_0#5380, l_linestatus_prf#5362 AS l_linestatus_prf_0#5381, rid#5363 AS rid_0#5382, l_shipmode_prf#5364 AS l_shipmode_prf_0#5383, l_shipinstruct_prf#5365 AS l_shipinstruct_prf_0#5384, l_quantity_prf#5366 AS l_quantity_prf_0#5385, l_receiptdate_prf#5367 AS l_receiptdate_prf_0#5386, l_linenumber_prf#5368 AS l_linenumber_prf_0#5387, l_tax_prf#5369 AS l_tax_prf_0#5388, l_shipdate_prf#5370 AS l_shipdate_prf_0#5389, l_extendedprice_prf#5371 AS l_extendedprice_prf_0#5390, l_partkey_prf#5372 AS l_partkey_prf_0#5391, l_discount_prf#5373 AS l_discount_prf_0#5392, l_partkey_and_l_suppkey_prf#5374 AS l_partkey_and_l_suppkey_prf_0#5393, l_commitdate_prf#5375 AS l_commitdate_prf_0#5394, l_suppkey_prf#5376 AS l_suppkey_prf_0#5395, l_orderkey_prf#5377 AS l_orderkey_prf_0#5396]
         :  +- Relation[l_returnflag_prf#5359,l_orderkey_and_l_linenumber_prf#5360,l_comment_prf#5361,l_linestatus_prf#5362,rid#5363,l_shipmode_prf#5364,l_shipinstruct_prf#5365,l_quantity_prf#5366,l_receiptdate_prf#5367,l_linenumber_prf#5368,l_tax_prf#5369,l_shipdate_prf#5370,l_extendedprice_prf#5371,l_partkey_prf#5372,l_discount_prf#5373,l_partkey_and_l_suppkey_prf#5374,l_commitdate_prf#5375,l_suppkey_prf#5376,l_orderkey_prf#5377] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5397]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#2096,value#2097] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 23757ms
query=b1a, count=15628, duration=403
query=b1b, count=15628, duration=50700
query=b2a, count=1478870, duration=201061
query=b2b, count=1478870, duration=57408
query=f1, count=1, duration=59
query=f2, count=3907, duration=121
query=f3, count=1451, duration=86
query=f4, count=1, duration=48
query=f5, count=1478870, duration=23757
query=f6, count=857401, duration=13861
query=j1, count=800000, duration=32202
query=j10, count=6001215, duration=88687
query=j2, count=800000, duration=11214
query=j3, count=25, duration=71
query=j4, count=150000, duration=1934
query=j5, count=10000, duration=189
query=j6, count=6001215, duration=118341
query=j7, count=1500000, duration=40651
query=j8, count=6001215, duration=199927
query=j8b, count=6001215, duration=131145
query=j9, count=6001215, duration=96283
query=j9b, count=6001215, duration=130317
query=r1a, count=6001215, duration=346915
query=r1b, count=6001215, duration=168867
query=r1c, count=6001215, duration=175289
query=r1d, count=6001215, duration=185328
query=r1e, count=6001215, duration=239891
query=r1f, count=6001215, duration=175561
query=t1a, count=60000414, duration=689752
query=t1b, count=60000414, duration=783029
query=t1c, count=60000414, duration=52066
query=t2a, count=800000, duration=109743
query=t2b, count=800000, duration=94790
query=t2c, count=800000, duration=43633
query=t2d, count=800000, duration=62337
query=t3a, count=6001215, duration=292706
query=t3b, count=6001215, duration=313570
query=t3c, count=6001215, duration=190140
query=t3d, count=6001215, duration=200648
