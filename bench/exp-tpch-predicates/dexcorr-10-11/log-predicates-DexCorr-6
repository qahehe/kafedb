19/10/11 04:46:06 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7090ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Fri Oct 11 04:46:08 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Fri Oct 11 04:46:09 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Fri Oct 11 04:46:09 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Fri Oct 11 04:46:09 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Fri Oct 11 04:46:09 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Fri Oct 11 04:46:12 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Fri Oct 11 04:46:14 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Fri Oct 11 04:46:14 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/11 04:46:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 04:46:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1504L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 04:46:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1504L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#1526]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#1516: string
         :     :- Project [c_acctbal_prf#1506 AS c_acctbal_prf_0#1515, rid#1507 AS rid_0#1516, c_name_prf#1508 AS c_name_prf_0#1517, c_nationkey_prf#1509 AS c_nationkey_prf_0#1518, c_custkey_prf#1510 AS c_custkey_prf_0#1519, c_comment_prf#1511 AS c_comment_prf_0#1520, c_address_prf#1512 AS c_address_prf_0#1521, c_mktsegment_prf#1513 AS c_mktsegment_prf_0#1522, c_phone_prf#1514 AS c_phone_prf_0#1523]
         :     :  +- Relation[c_acctbal_prf#1506,rid#1507,c_name_prf#1508,c_nationkey_prf#1509,c_custkey_prf#1510,c_comment_prf#1511,c_address_prf#1512,c_mktsegment_prf#1513,c_phone_prf#1514] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#1547]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#1538: string
            :     :- Project [o_shippriority_prf#1527 AS o_shippriority_prf_1#1537, rid#1528 AS rid_1#1538, o_orderdate_prf#1529 AS o_orderdate_prf_1#1539, o_custkey_prf#1530 AS o_custkey_prf_1#1540, o_orderpriority_prf#1531 AS o_orderpriority_prf_1#1541, o_clerk_prf#1532 AS o_clerk_prf_1#1542, o_orderstatus_prf#1533 AS o_orderstatus_prf_1#1543, o_totalprice_prf#1534 AS o_totalprice_prf_1#1544, o_orderkey_prf#1535 AS o_orderkey_prf_1#1545, o_comment_prf#1536 AS o_comment_prf_1#1546]
            :     :  +- Relation[o_shippriority_prf#1527,rid#1528,o_orderdate_prf#1529,o_custkey_prf#1530,o_orderpriority_prf#1531,o_clerk_prf#1532,o_orderstatus_prf#1533,o_totalprice_prf#1534,o_orderkey_prf#1535,o_comment_prf#1536] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#1548 AS l_returnflag_prf_2#1567, l_orderkey_and_l_linenumber_prf#1549 AS l_orderkey_and_l_linenumber_prf_2#1568, l_comment_prf#1550 AS l_comment_prf_2#1569, l_linestatus_prf#1551 AS l_linestatus_prf_2#1570, rid#1552 AS rid_2#1571, l_shipmode_prf#1553 AS l_shipmode_prf_2#1572, l_shipinstruct_prf#1554 AS l_shipinstruct_prf_2#1573, l_quantity_prf#1555 AS l_quantity_prf_2#1574, l_receiptdate_prf#1556 AS l_receiptdate_prf_2#1575, l_linenumber_prf#1557 AS l_linenumber_prf_2#1576, l_tax_prf#1558 AS l_tax_prf_2#1577, l_shipdate_prf#1559 AS l_shipdate_prf_2#1578, l_extendedprice_prf#1560 AS l_extendedprice_prf_2#1579, l_partkey_prf#1561 AS l_partkey_prf_2#1580, l_discount_prf#1562 AS l_discount_prf_2#1581, l_partkey_and_l_suppkey_prf#1563 AS l_partkey_and_l_suppkey_prf_2#1582, l_commitdate_prf#1564 AS l_commitdate_prf_2#1583, l_suppkey_prf#1565 AS l_suppkey_prf_2#1584, l_orderkey_prf#1566 AS l_orderkey_prf_2#1585]
               +- Relation[l_returnflag_prf#1548,l_orderkey_and_l_linenumber_prf#1549,l_comment_prf#1550,l_linestatus_prf#1551,rid#1552,l_shipmode_prf#1553,l_shipinstruct_prf#1554,l_quantity_prf#1555,l_receiptdate_prf#1556,l_linenumber_prf#1557,l_tax_prf#1558,l_shipdate_prf#1559,l_extendedprice_prf#1560,l_partkey_prf#1561,l_discount_prf#1562,l_partkey_and_l_suppkey_prf#1563,l_commitdate_prf#1564,l_suppkey_prf#1565,l_orderkey_prf#1566] JDBCRelation(lineitem_prf) [numPartitions=1]

19/10/11 04:46:15 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=6001215
Elapsed time: 238653ms

f2=
select * from part where p_size = 15
19/10/11 04:50:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 04:50:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1636L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 04:50:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1636L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#1638 AS p_comment_prf_0#1648, p_name_prf#1639 AS p_name_prf_0#1649, rid#1640 AS rid_0#1650, p_type_prf#1641 AS p_type_prf_0#1651, p_retailprice_prf#1642 AS p_retailprice_prf_0#1652, p_mfgr_prf#1643 AS p_mfgr_prf_0#1653, p_container_prf#1644 AS p_container_prf_0#1654, p_brand_prf#1645 AS p_brand_prf_0#1655, p_size_prf#1646 AS p_size_prf_0#1656, p_partkey_prf#1647 AS p_partkey_prf_0#1657]
         :  +- Relation[p_comment_prf#1638,p_name_prf#1639,rid#1640,p_type_prf#1641,p_retailprice_prf#1642,p_mfgr_prf#1643,p_container_prf#1644,p_brand_prf#1645,p_size_prf#1646,p_partkey_prf#1647] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1660]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1658,value#1659] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3907
Elapsed time: 143ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/11 04:50:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 04:50:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1690L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 04:50:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1690L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#1692 AS l_returnflag_prf_0#1711, l_orderkey_and_l_linenumber_prf#1693 AS l_orderkey_and_l_linenumber_prf_0#1712, l_comment_prf#1694 AS l_comment_prf_0#1713, l_linestatus_prf#1695 AS l_linestatus_prf_0#1714, rid#1696 AS rid_0#1715, l_shipmode_prf#1697 AS l_shipmode_prf_0#1716, l_shipinstruct_prf#1698 AS l_shipinstruct_prf_0#1717, l_quantity_prf#1699 AS l_quantity_prf_0#1718, l_receiptdate_prf#1700 AS l_receiptdate_prf_0#1719, l_linenumber_prf#1701 AS l_linenumber_prf_0#1720, l_tax_prf#1702 AS l_tax_prf_0#1721, l_shipdate_prf#1703 AS l_shipdate_prf_0#1722, l_extendedprice_prf#1704 AS l_extendedprice_prf_0#1723, l_partkey_prf#1705 AS l_partkey_prf_0#1724, l_discount_prf#1706 AS l_discount_prf_0#1725, l_partkey_and_l_suppkey_prf#1707 AS l_partkey_and_l_suppkey_prf_0#1726, l_commitdate_prf#1708 AS l_commitdate_prf_0#1727, l_suppkey_prf#1709 AS l_suppkey_prf_0#1728, l_orderkey_prf#1710 AS l_orderkey_prf_0#1729]
         :  +- Relation[l_returnflag_prf#1692,l_orderkey_and_l_linenumber_prf#1693,l_comment_prf#1694,l_linestatus_prf#1695,rid#1696,l_shipmode_prf#1697,l_shipinstruct_prf#1698,l_quantity_prf#1699,l_receiptdate_prf#1700,l_linenumber_prf#1701,l_tax_prf#1702,l_shipdate_prf#1703,l_extendedprice_prf#1704,l_partkey_prf#1705,l_discount_prf#1706,l_partkey_and_l_suppkey_prf#1707,l_commitdate_prf#1708,l_suppkey_prf#1709,l_orderkey_prf#1710] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1730]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1658,value#1659] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 23849ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/11 04:50:38 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 04:50:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1772L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 04:50:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1772L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#1801]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#1784]
         :     :  :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#1779: string
         :     :  :     :- Project [rid#1774 AS rid_0#1779, n_regionkey_prf#1775 AS n_regionkey_prf_0#1780, n_nationkey_prf#1776 AS n_nationkey_prf_0#1781, n_name_prf#1777 AS n_name_prf_0#1782, n_comment_prf#1778 AS n_comment_prf_0#1783]
         :     :  :     :  +- Relation[rid#1774,n_regionkey_prf#1775,n_nationkey_prf#1776,n_name_prf#1777,n_comment_prf#1778] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#1785 AS s_phone_prf_1#1793, rid#1786 AS rid_1#1794, s_address_prf#1787 AS s_address_prf_1#1795, s_nationkey_prf#1788 AS s_nationkey_prf_1#1796, s_suppkey_prf#1789 AS s_suppkey_prf_1#1797, s_name_prf#1790 AS s_name_prf_1#1798, s_acctbal_prf#1791 AS s_acctbal_prf_1#1799, s_comment_prf#1792 AS s_comment_prf_1#1800]
         :     :     +- Relation[s_phone_prf#1785,rid#1786,s_address_prf#1787,s_nationkey_prf#1788,s_suppkey_prf#1789,s_name_prf#1790,s_acctbal_prf#1791,s_comment_prf#1792] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#1802 AS c_acctbal_prf_2#1811, rid#1803 AS rid_2#1812, c_name_prf#1804 AS c_name_prf_2#1813, c_nationkey_prf#1805 AS c_nationkey_prf_2#1814, c_custkey_prf#1806 AS c_custkey_prf_2#1815, c_comment_prf#1807 AS c_comment_prf_2#1816, c_address_prf#1808 AS c_address_prf_2#1817, c_mktsegment_prf#1809 AS c_mktsegment_prf_2#1818, c_phone_prf#1810 AS c_phone_prf_2#1819]
            +- Relation[c_acctbal_prf#1802,rid#1803,c_name_prf#1804,c_nationkey_prf#1805,c_custkey_prf#1806,c_comment_prf#1807,c_address_prf#1808,c_mktsegment_prf#1809,c_phone_prf#1810] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 781792ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/11 05:03:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:03:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1859L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 05:03:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1859L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#1881]
         :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#1873: string
         :     :- Project [p_comment_prf#1861 AS p_comment_prf_0#1871, p_name_prf#1862 AS p_name_prf_0#1872, rid#1863 AS rid_0#1873, p_type_prf#1864 AS p_type_prf_0#1874, p_retailprice_prf#1865 AS p_retailprice_prf_0#1875, p_mfgr_prf#1866 AS p_mfgr_prf_0#1876, p_container_prf#1867 AS p_container_prf_0#1877, p_brand_prf#1868 AS p_brand_prf_0#1878, p_size_prf#1869 AS p_size_prf_0#1879, p_partkey_prf#1870 AS p_partkey_prf_0#1880]
         :     :  +- Relation[p_comment_prf#1861,p_name_prf#1862,rid#1863,p_type_prf#1864,p_retailprice_prf#1865,p_mfgr_prf#1866,p_container_prf#1867,p_brand_prf#1868,p_size_prf#1869,p_partkey_prf#1870] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#1882 AS ps_partkey_and_ps_suppkey_prf_1#1889, rid#1883 AS rid_1#1890, ps_availqty_prf#1884 AS ps_availqty_prf_1#1891, ps_comment_prf#1885 AS ps_comment_prf_1#1892, ps_partkey_prf#1886 AS ps_partkey_prf_1#1893, ps_supplycost_prf#1887 AS ps_supplycost_prf_1#1894, ps_suppkey_prf#1888 AS ps_suppkey_prf_1#1895]
            +- Relation[ps_partkey_and_ps_suppkey_prf#1882,rid#1883,ps_availqty_prf#1884,ps_comment_prf#1885,ps_partkey_prf#1886,ps_supplycost_prf#1887,ps_suppkey_prf#1888] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 32286ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/11 05:04:12 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:04:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1948L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 05:04:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1948L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_2#1966]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#1959: string
         :     :- Project [s_phone_prf#1950 AS s_phone_prf_0#1958, rid#1951 AS rid_0#1959, s_address_prf#1952 AS s_address_prf_0#1960, s_nationkey_prf#1953 AS s_nationkey_prf_0#1961, s_suppkey_prf#1954 AS s_suppkey_prf_0#1962, s_name_prf#1955 AS s_name_prf_0#1963, s_acctbal_prf#1956 AS s_acctbal_prf_0#1964, s_comment_prf#1957 AS s_comment_prf_0#1965]
         :     :  +- Relation[s_phone_prf#1950,rid#1951,s_address_prf#1952,s_nationkey_prf#1953,s_suppkey_prf#1954,s_name_prf#1955,s_acctbal_prf#1956,s_comment_prf#1957] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#1987]
            :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#1979: string
            :     :- Project [p_comment_prf#1967 AS p_comment_prf_1#1977, p_name_prf#1968 AS p_name_prf_1#1978, rid#1969 AS rid_1#1979, p_type_prf#1970 AS p_type_prf_1#1980, p_retailprice_prf#1971 AS p_retailprice_prf_1#1981, p_mfgr_prf#1972 AS p_mfgr_prf_1#1982, p_container_prf#1973 AS p_container_prf_1#1983, p_brand_prf#1974 AS p_brand_prf_1#1984, p_size_prf#1975 AS p_size_prf_1#1985, p_partkey_prf#1976 AS p_partkey_prf_1#1986]
            :     :  +- Relation[p_comment_prf#1967,p_name_prf#1968,rid#1969,p_type_prf#1970,p_retailprice_prf#1971,p_mfgr_prf#1972,p_container_prf#1973,p_brand_prf#1974,p_size_prf#1975,p_partkey_prf#1976] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#1988 AS l_returnflag_prf_2#2007, l_orderkey_and_l_linenumber_prf#1989 AS l_orderkey_and_l_linenumber_prf_2#2008, l_comment_prf#1990 AS l_comment_prf_2#2009, l_linestatus_prf#1991 AS l_linestatus_prf_2#2010, rid#1992 AS rid_2#2011, l_shipmode_prf#1993 AS l_shipmode_prf_2#2012, l_shipinstruct_prf#1994 AS l_shipinstruct_prf_2#2013, l_quantity_prf#1995 AS l_quantity_prf_2#2014, l_receiptdate_prf#1996 AS l_receiptdate_prf_2#2015, l_linenumber_prf#1997 AS l_linenumber_prf_2#2016, l_tax_prf#1998 AS l_tax_prf_2#2017, l_shipdate_prf#1999 AS l_shipdate_prf_2#2018, l_extendedprice_prf#2000 AS l_extendedprice_prf_2#2019, l_partkey_prf#2001 AS l_partkey_prf_2#2020, l_discount_prf#2002 AS l_discount_prf_2#2021, l_partkey_and_l_suppkey_prf#2003 AS l_partkey_and_l_suppkey_prf_2#2022, l_commitdate_prf#2004 AS l_commitdate_prf_2#2023, l_suppkey_prf#2005 AS l_suppkey_prf_2#2024, l_orderkey_prf#2006 AS l_orderkey_prf_2#2025]
               +- Relation[l_returnflag_prf#1988,l_orderkey_and_l_linenumber_prf#1989,l_comment_prf#1990,l_linestatus_prf#1991,rid#1992,l_shipmode_prf#1993,l_shipinstruct_prf#1994,l_quantity_prf#1995,l_receiptdate_prf#1996,l_linenumber_prf#1997,l_tax_prf#1998,l_shipdate_prf#1999,l_extendedprice_prf#2000,l_partkey_prf#2001,l_discount_prf#2002,l_partkey_and_l_suppkey_prf#2003,l_commitdate_prf#2004,l_suppkey_prf#2005,l_orderkey_prf#2006] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 190823ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/11 05:07:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:07:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2080L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 05:07:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2080L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#2103]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2094: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#2082 AS p_comment_prf_0#2092, p_name_prf#2083 AS p_name_prf_0#2093, rid#2084 AS rid_0#2094, p_type_prf#2085 AS p_type_prf_0#2095, p_retailprice_prf#2086 AS p_retailprice_prf_0#2096, p_mfgr_prf#2087 AS p_mfgr_prf_0#2097, p_container_prf#2088 AS p_container_prf_0#2098, p_brand_prf#2089 AS p_brand_prf_0#2099, p_size_prf#2090 AS p_size_prf_0#2100, p_partkey_prf#2091 AS p_partkey_prf_0#2101]
         :     :  :  +- Relation[p_comment_prf#2082,p_name_prf#2083,rid#2084,p_type_prf#2085,p_retailprice_prf#2086,p_mfgr_prf#2087,p_container_prf#2088,p_brand_prf#2089,p_size_prf#2090,p_partkey_prf#2091] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2102]
         :     :     +- DexRidFilter part~p_size~15
         :     :        +- Relation[label#1658,value#1659] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2104 AS ps_partkey_and_ps_suppkey_prf_1#2111, rid#2105 AS rid_1#2112, ps_availqty_prf#2106 AS ps_availqty_prf_1#2113, ps_comment_prf#2107 AS ps_comment_prf_1#2114, ps_partkey_prf#2108 AS ps_partkey_prf_1#2115, ps_supplycost_prf#2109 AS ps_supplycost_prf_1#2116, ps_suppkey_prf#2110 AS ps_suppkey_prf_1#2117]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2104,rid#2105,ps_availqty_prf#2106,ps_comment_prf#2107,ps_partkey_prf#2108,ps_supplycost_prf#2109,ps_suppkey_prf#2110] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 395ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/11 05:07:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:07:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2159L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 05:07:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2159L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#2196]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#2181]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2173: string
         :     :  :     :- Project [p_comment_prf#2161 AS p_comment_prf_0#2171, p_name_prf#2162 AS p_name_prf_0#2172, rid#2163 AS rid_0#2173, p_type_prf#2164 AS p_type_prf_0#2174, p_retailprice_prf#2165 AS p_retailprice_prf_0#2175, p_mfgr_prf#2166 AS p_mfgr_prf_0#2176, p_container_prf#2167 AS p_container_prf_0#2177, p_brand_prf#2168 AS p_brand_prf_0#2178, p_size_prf#2169 AS p_size_prf_0#2179, p_partkey_prf#2170 AS p_partkey_prf_0#2180]
         :     :  :     :  +- Relation[p_comment_prf#2161,p_name_prf#2162,rid#2163,p_type_prf#2164,p_retailprice_prf#2165,p_mfgr_prf#2166,p_container_prf#2167,p_brand_prf#2168,p_size_prf#2169,p_partkey_prf#2170] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#2182 AS ps_partkey_and_ps_suppkey_prf_1#2189, rid#2183 AS rid_1#2190, ps_availqty_prf#2184 AS ps_availqty_prf_1#2191, ps_comment_prf#2185 AS ps_comment_prf_1#2192, ps_partkey_prf#2186 AS ps_partkey_prf_1#2193, ps_supplycost_prf#2187 AS ps_supplycost_prf_1#2194, ps_suppkey_prf#2188 AS ps_suppkey_prf_1#2195]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#2182,rid#2183,ps_availqty_prf#2184,ps_comment_prf#2185,ps_partkey_prf#2186,ps_supplycost_prf#2187,ps_suppkey_prf#2188] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2197 AS s_phone_prf_2#2205, rid#2198 AS rid_2#2206, s_address_prf#2199 AS s_address_prf_2#2207, s_nationkey_prf#2200 AS s_nationkey_prf_2#2208, s_suppkey_prf#2201 AS s_suppkey_prf_2#2209, s_name_prf#2202 AS s_name_prf_2#2210, s_acctbal_prf#2203 AS s_acctbal_prf_2#2211, s_comment_prf#2204 AS s_comment_prf_2#2212]
            +- Relation[s_phone_prf#2197,rid#2198,s_address_prf#2199,s_nationkey_prf#2200,s_suppkey_prf#2201,s_name_prf#2202,s_acctbal_prf#2203,s_comment_prf#2204] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 94357ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/11 05:08:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:08:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2274L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 05:08:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2274L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#2315]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#2294]
         :     :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2286: string
         :     :  :     :- Project [c_acctbal_prf#2276 AS c_acctbal_prf_0#2285, rid#2277 AS rid_0#2286, c_name_prf#2278 AS c_name_prf_0#2287, c_nationkey_prf#2279 AS c_nationkey_prf_0#2288, c_custkey_prf#2280 AS c_custkey_prf_0#2289, c_comment_prf#2281 AS c_comment_prf_0#2290, c_address_prf#2282 AS c_address_prf_0#2291, c_mktsegment_prf#2283 AS c_mktsegment_prf_0#2292, c_phone_prf#2284 AS c_phone_prf_0#2293]
         :     :  :     :  +- Relation[c_acctbal_prf#2276,rid#2277,c_name_prf#2278,c_nationkey_prf#2279,c_custkey_prf#2280,c_comment_prf#2281,c_address_prf#2282,c_mktsegment_prf#2283,c_phone_prf#2284] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#2295 AS o_shippriority_prf_1#2305, rid#2296 AS rid_1#2306, o_orderdate_prf#2297 AS o_orderdate_prf_1#2307, o_custkey_prf#2298 AS o_custkey_prf_1#2308, o_orderpriority_prf#2299 AS o_orderpriority_prf_1#2309, o_clerk_prf#2300 AS o_clerk_prf_1#2310, o_orderstatus_prf#2301 AS o_orderstatus_prf_1#2311, o_totalprice_prf#2302 AS o_totalprice_prf_1#2312, o_orderkey_prf#2303 AS o_orderkey_prf_1#2313, o_comment_prf#2304 AS o_comment_prf_1#2314]
         :     :     +- Relation[o_shippriority_prf#2295,rid#2296,o_orderdate_prf#2297,o_custkey_prf#2298,o_orderpriority_prf#2299,o_clerk_prf#2300,o_orderstatus_prf#2301,o_totalprice_prf#2302,o_orderkey_prf#2303,o_comment_prf#2304] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2316 AS l_returnflag_prf_2#2335, l_orderkey_and_l_linenumber_prf#2317 AS l_orderkey_and_l_linenumber_prf_2#2336, l_comment_prf#2318 AS l_comment_prf_2#2337, l_linestatus_prf#2319 AS l_linestatus_prf_2#2338, rid#2320 AS rid_2#2339, l_shipmode_prf#2321 AS l_shipmode_prf_2#2340, l_shipinstruct_prf#2322 AS l_shipinstruct_prf_2#2341, l_quantity_prf#2323 AS l_quantity_prf_2#2342, l_receiptdate_prf#2324 AS l_receiptdate_prf_2#2343, l_linenumber_prf#2325 AS l_linenumber_prf_2#2344, l_tax_prf#2326 AS l_tax_prf_2#2345, l_shipdate_prf#2327 AS l_shipdate_prf_2#2346, l_extendedprice_prf#2328 AS l_extendedprice_prf_2#2347, l_partkey_prf#2329 AS l_partkey_prf_2#2348, l_discount_prf#2330 AS l_discount_prf_2#2349, l_partkey_and_l_suppkey_prf#2331 AS l_partkey_and_l_suppkey_prf_2#2350, l_commitdate_prf#2332 AS l_commitdate_prf_2#2351, l_suppkey_prf#2333 AS l_suppkey_prf_2#2352, l_orderkey_prf#2334 AS l_orderkey_prf_2#2353]
            +- Relation[l_returnflag_prf#2316,l_orderkey_and_l_linenumber_prf#2317,l_comment_prf#2318,l_linestatus_prf#2319,rid#2320,l_shipmode_prf#2321,l_shipinstruct_prf#2322,l_quantity_prf#2323,l_receiptdate_prf#2324,l_linenumber_prf#2325,l_tax_prf#2326,l_shipdate_prf#2327,l_extendedprice_prf#2328,l_partkey_prf#2329,l_discount_prf#2330,l_partkey_and_l_suppkey_prf#2331,l_commitdate_prf#2332,l_suppkey_prf#2333,l_orderkey_prf#2334] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 185684ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/11 05:12:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:12:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2399L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 05:12:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2399L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#2401 AS rid_0#2406, n_regionkey_prf#2402 AS n_regionkey_prf_0#2407, n_nationkey_prf#2403 AS n_nationkey_prf_0#2408, n_name_prf#2404 AS n_name_prf_0#2409, n_comment_prf#2405 AS n_comment_prf_0#2410]
         :  +- Relation[rid#2401,n_regionkey_prf#2402,n_nationkey_prf#2403,n_name_prf#2404,n_comment_prf#2405] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2411]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1658,value#1659] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 57ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/11 05:12:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:12:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2427L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 05:12:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2427L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#2437]
         :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#2436: string
         :     :- Project [r_regionkey_prf#2429 AS r_regionkey_prf_0#2433, r_name_prf#2430 AS r_name_prf_0#2434, r_comment_prf#2431 AS r_comment_prf_0#2435, rid#2432 AS rid_0#2436]
         :     :  +- Relation[r_regionkey_prf#2429,r_name_prf#2430,r_comment_prf#2431,rid#2432] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#2438 AS rid_1#2443, n_regionkey_prf#2439 AS n_regionkey_prf_1#2444, n_nationkey_prf#2440 AS n_nationkey_prf_1#2445, n_name_prf#2441 AS n_name_prf_1#2446, n_comment_prf#2442 AS n_comment_prf_1#2447]
            +- Relation[rid#2438,n_regionkey_prf#2439,n_nationkey_prf#2440,n_name_prf#2441,n_comment_prf#2442] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=25
Elapsed time: 72ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/11 05:12:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:12:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2481L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 05:12:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2481L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#2499]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#2492: string
         :     :- Project [s_phone_prf#2483 AS s_phone_prf_0#2491, rid#2484 AS rid_0#2492, s_address_prf#2485 AS s_address_prf_0#2493, s_nationkey_prf#2486 AS s_nationkey_prf_0#2494, s_suppkey_prf#2487 AS s_suppkey_prf_0#2495, s_name_prf#2488 AS s_name_prf_0#2496, s_acctbal_prf#2489 AS s_acctbal_prf_0#2497, s_comment_prf#2490 AS s_comment_prf_0#2498]
         :     :  +- Relation[s_phone_prf#2483,rid#2484,s_address_prf#2485,s_nationkey_prf#2486,s_suppkey_prf#2487,s_name_prf#2488,s_acctbal_prf#2489,s_comment_prf#2490] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#2514]
            :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_1#2508: string
            :     :- Project [ps_partkey_and_ps_suppkey_prf#2500 AS ps_partkey_and_ps_suppkey_prf_1#2507, rid#2501 AS rid_1#2508, ps_availqty_prf#2502 AS ps_availqty_prf_1#2509, ps_comment_prf#2503 AS ps_comment_prf_1#2510, ps_partkey_prf#2504 AS ps_partkey_prf_1#2511, ps_supplycost_prf#2505 AS ps_supplycost_prf_1#2512, ps_suppkey_prf#2506 AS ps_suppkey_prf_1#2513]
            :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2500,rid#2501,ps_availqty_prf#2502,ps_comment_prf#2503,ps_partkey_prf#2504,ps_supplycost_prf#2505,ps_suppkey_prf#2506] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#2515 AS p_comment_prf_2#2525, p_name_prf#2516 AS p_name_prf_2#2526, rid#2517 AS rid_2#2527, p_type_prf#2518 AS p_type_prf_2#2528, p_retailprice_prf#2519 AS p_retailprice_prf_2#2529, p_mfgr_prf#2520 AS p_mfgr_prf_2#2530, p_container_prf#2521 AS p_container_prf_2#2531, p_brand_prf#2522 AS p_brand_prf_2#2532, p_size_prf#2523 AS p_size_prf_2#2533, p_partkey_prf#2524 AS p_partkey_prf_2#2534]
               +- Relation[p_comment_prf#2515,p_name_prf#2516,rid#2517,p_type_prf#2518,p_retailprice_prf#2519,p_mfgr_prf#2520,p_container_prf#2521,p_brand_prf#2522,p_size_prf#2523,p_partkey_prf#2524] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 65202ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/11 05:13:08 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:13:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2596L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 05:13:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2596L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#2636]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2621: string
         :     :- Project [l_returnflag_prf#2598 AS l_returnflag_prf_0#2617, l_orderkey_and_l_linenumber_prf#2599 AS l_orderkey_and_l_linenumber_prf_0#2618, l_comment_prf#2600 AS l_comment_prf_0#2619, l_linestatus_prf#2601 AS l_linestatus_prf_0#2620, rid#2602 AS rid_0#2621, l_shipmode_prf#2603 AS l_shipmode_prf_0#2622, l_shipinstruct_prf#2604 AS l_shipinstruct_prf_0#2623, l_quantity_prf#2605 AS l_quantity_prf_0#2624, l_receiptdate_prf#2606 AS l_receiptdate_prf_0#2625, l_linenumber_prf#2607 AS l_linenumber_prf_0#2626, l_tax_prf#2608 AS l_tax_prf_0#2627, l_shipdate_prf#2609 AS l_shipdate_prf_0#2628, l_extendedprice_prf#2610 AS l_extendedprice_prf_0#2629, l_partkey_prf#2611 AS l_partkey_prf_0#2630, l_discount_prf#2612 AS l_discount_prf_0#2631, l_partkey_and_l_suppkey_prf#2613 AS l_partkey_and_l_suppkey_prf_0#2632, l_commitdate_prf#2614 AS l_commitdate_prf_0#2633, l_suppkey_prf#2615 AS l_suppkey_prf_0#2634, l_orderkey_prf#2616 AS l_orderkey_prf_0#2635]
         :     :  +- Relation[l_returnflag_prf#2598,l_orderkey_and_l_linenumber_prf#2599,l_comment_prf#2600,l_linestatus_prf#2601,rid#2602,l_shipmode_prf#2603,l_shipinstruct_prf#2604,l_quantity_prf#2605,l_receiptdate_prf#2606,l_linenumber_prf#2607,l_tax_prf#2608,l_shipdate_prf#2609,l_extendedprice_prf#2610,l_partkey_prf#2611,l_discount_prf#2612,l_partkey_and_l_suppkey_prf#2613,l_commitdate_prf#2614,l_suppkey_prf#2615,l_orderkey_prf#2616] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#2657]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#2648: string
            :     :- Project [o_shippriority_prf#2637 AS o_shippriority_prf_1#2647, rid#2638 AS rid_1#2648, o_orderdate_prf#2639 AS o_orderdate_prf_1#2649, o_custkey_prf#2640 AS o_custkey_prf_1#2650, o_orderpriority_prf#2641 AS o_orderpriority_prf_1#2651, o_clerk_prf#2642 AS o_clerk_prf_1#2652, o_orderstatus_prf#2643 AS o_orderstatus_prf_1#2653, o_totalprice_prf#2644 AS o_totalprice_prf_1#2654, o_orderkey_prf#2645 AS o_orderkey_prf_1#2655, o_comment_prf#2646 AS o_comment_prf_1#2656]
            :     :  +- Relation[o_shippriority_prf#2637,rid#2638,o_orderdate_prf#2639,o_custkey_prf#2640,o_orderpriority_prf#2641,o_clerk_prf#2642,o_orderstatus_prf#2643,o_totalprice_prf#2644,o_orderkey_prf#2645,o_comment_prf#2646] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#2658 AS c_acctbal_prf_2#2667, rid#2659 AS rid_2#2668, c_name_prf#2660 AS c_name_prf_2#2669, c_nationkey_prf#2661 AS c_nationkey_prf_2#2670, c_custkey_prf#2662 AS c_custkey_prf_2#2671, c_comment_prf#2663 AS c_comment_prf_2#2672, c_address_prf#2664 AS c_address_prf_2#2673, c_mktsegment_prf#2665 AS c_mktsegment_prf_2#2674, c_phone_prf#2666 AS c_phone_prf_2#2675]
               +- Relation[c_acctbal_prf#2658,rid#2659,c_name_prf#2660,c_nationkey_prf#2661,c_custkey_prf#2662,c_comment_prf#2663,c_address_prf#2664,c_mktsegment_prf#2665,c_phone_prf#2666] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 168541ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_orderkey and l_orderkey = o_orderkey
19/10/11 05:15:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:15:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2750L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 05:15:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2750L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_2#2790]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2775: string
         :     :- Project [l_returnflag_prf#2752 AS l_returnflag_prf_0#2771, l_orderkey_and_l_linenumber_prf#2753 AS l_orderkey_and_l_linenumber_prf_0#2772, l_comment_prf#2754 AS l_comment_prf_0#2773, l_linestatus_prf#2755 AS l_linestatus_prf_0#2774, rid#2756 AS rid_0#2775, l_shipmode_prf#2757 AS l_shipmode_prf_0#2776, l_shipinstruct_prf#2758 AS l_shipinstruct_prf_0#2777, l_quantity_prf#2759 AS l_quantity_prf_0#2778, l_receiptdate_prf#2760 AS l_receiptdate_prf_0#2779, l_linenumber_prf#2761 AS l_linenumber_prf_0#2780, l_tax_prf#2762 AS l_tax_prf_0#2781, l_shipdate_prf#2763 AS l_shipdate_prf_0#2782, l_extendedprice_prf#2764 AS l_extendedprice_prf_0#2783, l_partkey_prf#2765 AS l_partkey_prf_0#2784, l_discount_prf#2766 AS l_discount_prf_0#2785, l_partkey_and_l_suppkey_prf#2767 AS l_partkey_and_l_suppkey_prf_0#2786, l_commitdate_prf#2768 AS l_commitdate_prf_0#2787, l_suppkey_prf#2769 AS l_suppkey_prf_0#2788, l_orderkey_prf#2770 AS l_orderkey_prf_0#2789]
         :     :  +- Relation[l_returnflag_prf#2752,l_orderkey_and_l_linenumber_prf#2753,l_comment_prf#2754,l_linestatus_prf#2755,rid#2756,l_shipmode_prf#2757,l_shipinstruct_prf#2758,l_quantity_prf#2759,l_receiptdate_prf#2760,l_linenumber_prf#2761,l_tax_prf#2762,l_shipdate_prf#2763,l_extendedprice_prf#2764,l_partkey_prf#2765,l_discount_prf#2766,l_partkey_and_l_suppkey_prf#2767,l_commitdate_prf#2768,l_suppkey_prf#2769,l_orderkey_prf#2770] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#2809]
            :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#2801: string
            :     :- Project [c_acctbal_prf#2791 AS c_acctbal_prf_1#2800, rid#2792 AS rid_1#2801, c_name_prf#2793 AS c_name_prf_1#2802, c_nationkey_prf#2794 AS c_nationkey_prf_1#2803, c_custkey_prf#2795 AS c_custkey_prf_1#2804, c_comment_prf#2796 AS c_comment_prf_1#2805, c_address_prf#2797 AS c_address_prf_1#2806, c_mktsegment_prf#2798 AS c_mktsegment_prf_1#2807, c_phone_prf#2799 AS c_phone_prf_1#2808]
            :     :  +- Relation[c_acctbal_prf#2791,rid#2792,c_name_prf#2793,c_nationkey_prf#2794,c_custkey_prf#2795,c_comment_prf#2796,c_address_prf#2797,c_mktsegment_prf#2798,c_phone_prf#2799] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2810 AS o_shippriority_prf_2#2820, rid#2811 AS rid_2#2821, o_orderdate_prf#2812 AS o_orderdate_prf_2#2822, o_custkey_prf#2813 AS o_custkey_prf_2#2823, o_orderpriority_prf#2814 AS o_orderpriority_prf_2#2824, o_clerk_prf#2815 AS o_clerk_prf_2#2825, o_orderstatus_prf#2816 AS o_orderstatus_prf_2#2826, o_totalprice_prf#2817 AS o_totalprice_prf_2#2827, o_orderkey_prf#2818 AS o_orderkey_prf_2#2828, o_comment_prf#2819 AS o_comment_prf_2#2829]
               +- Relation[o_shippriority_prf#2810,rid#2811,o_orderdate_prf#2812,o_custkey_prf#2813,o_orderpriority_prf#2814,o_clerk_prf#2815,o_orderstatus_prf#2816,o_totalprice_prf#2817,o_orderkey_prf#2818,o_comment_prf#2819] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 175719ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/11 05:18:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:18:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2896L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 05:18:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2896L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#2937]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2921: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#2898 AS l_returnflag_prf_0#2917, l_orderkey_and_l_linenumber_prf#2899 AS l_orderkey_and_l_linenumber_prf_0#2918, l_comment_prf#2900 AS l_comment_prf_0#2919, l_linestatus_prf#2901 AS l_linestatus_prf_0#2920, rid#2902 AS rid_0#2921, l_shipmode_prf#2903 AS l_shipmode_prf_0#2922, l_shipinstruct_prf#2904 AS l_shipinstruct_prf_0#2923, l_quantity_prf#2905 AS l_quantity_prf_0#2924, l_receiptdate_prf#2906 AS l_receiptdate_prf_0#2925, l_linenumber_prf#2907 AS l_linenumber_prf_0#2926, l_tax_prf#2908 AS l_tax_prf_0#2927, l_shipdate_prf#2909 AS l_shipdate_prf_0#2928, l_extendedprice_prf#2910 AS l_extendedprice_prf_0#2929, l_partkey_prf#2911 AS l_partkey_prf_0#2930, l_discount_prf#2912 AS l_discount_prf_0#2931, l_partkey_and_l_suppkey_prf#2913 AS l_partkey_and_l_suppkey_prf_0#2932, l_commitdate_prf#2914 AS l_commitdate_prf_0#2933, l_suppkey_prf#2915 AS l_suppkey_prf_0#2934, l_orderkey_prf#2916 AS l_orderkey_prf_0#2935]
         :     :  :  +- Relation[l_returnflag_prf#2898,l_orderkey_and_l_linenumber_prf#2899,l_comment_prf#2900,l_linestatus_prf#2901,rid#2902,l_shipmode_prf#2903,l_shipinstruct_prf#2904,l_quantity_prf#2905,l_receiptdate_prf#2906,l_linenumber_prf#2907,l_tax_prf#2908,l_shipdate_prf#2909,l_extendedprice_prf#2910,l_partkey_prf#2911,l_discount_prf#2912,l_partkey_and_l_suppkey_prf#2913,l_commitdate_prf#2914,l_suppkey_prf#2915,l_orderkey_prf#2916] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2936]
         :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :        +- Relation[label#1658,value#1659] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2938 AS o_shippriority_prf_1#2948, rid#2939 AS rid_1#2949, o_orderdate_prf#2940 AS o_orderdate_prf_1#2950, o_custkey_prf#2941 AS o_custkey_prf_1#2951, o_orderpriority_prf#2942 AS o_orderpriority_prf_1#2952, o_clerk_prf#2943 AS o_clerk_prf_1#2953, o_orderstatus_prf#2944 AS o_orderstatus_prf_1#2954, o_totalprice_prf#2945 AS o_totalprice_prf_1#2955, o_orderkey_prf#2946 AS o_orderkey_prf_1#2956, o_comment_prf#2947 AS o_comment_prf_1#2957]
            +- Relation[o_shippriority_prf#2938,rid#2939,o_orderdate_prf#2940,o_custkey_prf#2941,o_orderpriority_prf#2942,o_clerk_prf#2943,o_orderstatus_prf#2944,o_totalprice_prf#2945,o_orderkey_prf#2946,o_comment_prf#2947] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 57193ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/11 05:19:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:19:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3022L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 05:19:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3022L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#3062]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#3047: string
         :     :  :     :- Project [l_returnflag_prf#3024 AS l_returnflag_prf_0#3043, l_orderkey_and_l_linenumber_prf#3025 AS l_orderkey_and_l_linenumber_prf_0#3044, l_comment_prf#3026 AS l_comment_prf_0#3045, l_linestatus_prf#3027 AS l_linestatus_prf_0#3046, rid#3028 AS rid_0#3047, l_shipmode_prf#3029 AS l_shipmode_prf_0#3048, l_shipinstruct_prf#3030 AS l_shipinstruct_prf_0#3049, l_quantity_prf#3031 AS l_quantity_prf_0#3050, l_receiptdate_prf#3032 AS l_receiptdate_prf_0#3051, l_linenumber_prf#3033 AS l_linenumber_prf_0#3052, l_tax_prf#3034 AS l_tax_prf_0#3053, l_shipdate_prf#3035 AS l_shipdate_prf_0#3054, l_extendedprice_prf#3036 AS l_extendedprice_prf_0#3055, l_partkey_prf#3037 AS l_partkey_prf_0#3056, l_discount_prf#3038 AS l_discount_prf_0#3057, l_partkey_and_l_suppkey_prf#3039 AS l_partkey_and_l_suppkey_prf_0#3058, l_commitdate_prf#3040 AS l_commitdate_prf_0#3059, l_suppkey_prf#3041 AS l_suppkey_prf_0#3060, l_orderkey_prf#3042 AS l_orderkey_prf_0#3061]
         :     :  :     :  +- Relation[l_returnflag_prf#3024,l_orderkey_and_l_linenumber_prf#3025,l_comment_prf#3026,l_linestatus_prf#3027,rid#3028,l_shipmode_prf#3029,l_shipinstruct_prf#3030,l_quantity_prf#3031,l_receiptdate_prf#3032,l_linenumber_prf#3033,l_tax_prf#3034,l_shipdate_prf#3035,l_extendedprice_prf#3036,l_partkey_prf#3037,l_discount_prf#3038,l_partkey_and_l_suppkey_prf#3039,l_commitdate_prf#3040,l_suppkey_prf#3041,l_orderkey_prf#3042] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#3063 AS p_comment_prf_1#3073, p_name_prf#3064 AS p_name_prf_1#3074, rid#3065 AS rid_1#3075, p_type_prf#3066 AS p_type_prf_1#3076, p_retailprice_prf#3067 AS p_retailprice_prf_1#3077, p_mfgr_prf#3068 AS p_mfgr_prf_1#3078, p_container_prf#3069 AS p_container_prf_1#3079, p_brand_prf#3070 AS p_brand_prf_1#3080, p_size_prf#3071 AS p_size_prf_1#3081, p_partkey_prf#3072 AS p_partkey_prf_1#3082]
         :     :     +- Relation[p_comment_prf#3063,p_name_prf#3064,rid#3065,p_type_prf#3066,p_retailprice_prf#3067,p_mfgr_prf#3068,p_container_prf#3069,p_brand_prf#3070,p_size_prf#3071,p_partkey_prf#3072] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3084 AS s_phone_prf_2#3092, rid#3085 AS rid_2#3093, s_address_prf#3086 AS s_address_prf_2#3094, s_nationkey_prf#3087 AS s_nationkey_prf_2#3095, s_suppkey_prf#3088 AS s_suppkey_prf_2#3096, s_name_prf#3089 AS s_name_prf_2#3097, s_acctbal_prf#3090 AS s_acctbal_prf_2#3098, s_comment_prf#3091 AS s_comment_prf_2#3099]
            +- Relation[s_phone_prf#3084,rid#3085,s_address_prf#3086,s_nationkey_prf#3087,s_suppkey_prf#3088,s_name_prf#3089,s_acctbal_prf#3090,s_comment_prf#3091] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 293852ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/11 05:24:44 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:24:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3165L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 05:24:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3165L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#3187]
         :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3179: string
         :     :- Project [p_comment_prf#3167 AS p_comment_prf_0#3177, p_name_prf#3168 AS p_name_prf_0#3178, rid#3169 AS rid_0#3179, p_type_prf#3170 AS p_type_prf_0#3180, p_retailprice_prf#3171 AS p_retailprice_prf_0#3181, p_mfgr_prf#3172 AS p_mfgr_prf_0#3182, p_container_prf#3173 AS p_container_prf_0#3183, p_brand_prf#3174 AS p_brand_prf_0#3184, p_size_prf#3175 AS p_size_prf_0#3185, p_partkey_prf#3176 AS p_partkey_prf_0#3186]
         :     :  +- Relation[p_comment_prf#3167,p_name_prf#3168,rid#3169,p_type_prf#3170,p_retailprice_prf#3171,p_mfgr_prf#3172,p_container_prf#3173,p_brand_prf#3174,p_size_prf#3175,p_partkey_prf#3176] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3188 AS l_returnflag_prf_1#3207, l_orderkey_and_l_linenumber_prf#3189 AS l_orderkey_and_l_linenumber_prf_1#3208, l_comment_prf#3190 AS l_comment_prf_1#3209, l_linestatus_prf#3191 AS l_linestatus_prf_1#3210, rid#3192 AS rid_1#3211, l_shipmode_prf#3193 AS l_shipmode_prf_1#3212, l_shipinstruct_prf#3194 AS l_shipinstruct_prf_1#3213, l_quantity_prf#3195 AS l_quantity_prf_1#3214, l_receiptdate_prf#3196 AS l_receiptdate_prf_1#3215, l_linenumber_prf#3197 AS l_linenumber_prf_1#3216, l_tax_prf#3198 AS l_tax_prf_1#3217, l_shipdate_prf#3199 AS l_shipdate_prf_1#3218, l_extendedprice_prf#3200 AS l_extendedprice_prf_1#3219, l_partkey_prf#3201 AS l_partkey_prf_1#3220, l_discount_prf#3202 AS l_discount_prf_1#3221, l_partkey_and_l_suppkey_prf#3203 AS l_partkey_and_l_suppkey_prf_1#3222, l_commitdate_prf#3204 AS l_commitdate_prf_1#3223, l_suppkey_prf#3205 AS l_suppkey_prf_1#3224, l_orderkey_prf#3206 AS l_orderkey_prf_1#3225]
            +- Relation[l_returnflag_prf#3188,l_orderkey_and_l_linenumber_prf#3189,l_comment_prf#3190,l_linestatus_prf#3191,rid#3192,l_shipmode_prf#3193,l_shipinstruct_prf#3194,l_quantity_prf#3195,l_receiptdate_prf#3196,l_linenumber_prf#3197,l_tax_prf#3198,l_shipdate_prf#3199,l_extendedprice_prf#3200,l_partkey_prf#3201,l_discount_prf#3202,l_partkey_and_l_suppkey_prf#3203,l_commitdate_prf#3204,l_suppkey_prf#3205,l_orderkey_prf#3206] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 96575ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/11 05:26:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:26:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3283L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 05:26:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3283L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#3323]
         :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#3308: string
         :     :- Project [l_returnflag_prf#3285 AS l_returnflag_prf_0#3304, l_orderkey_and_l_linenumber_prf#3286 AS l_orderkey_and_l_linenumber_prf_0#3305, l_comment_prf#3287 AS l_comment_prf_0#3306, l_linestatus_prf#3288 AS l_linestatus_prf_0#3307, rid#3289 AS rid_0#3308, l_shipmode_prf#3290 AS l_shipmode_prf_0#3309, l_shipinstruct_prf#3291 AS l_shipinstruct_prf_0#3310, l_quantity_prf#3292 AS l_quantity_prf_0#3311, l_receiptdate_prf#3293 AS l_receiptdate_prf_0#3312, l_linenumber_prf#3294 AS l_linenumber_prf_0#3313, l_tax_prf#3295 AS l_tax_prf_0#3314, l_shipdate_prf#3296 AS l_shipdate_prf_0#3315, l_extendedprice_prf#3297 AS l_extendedprice_prf_0#3316, l_partkey_prf#3298 AS l_partkey_prf_0#3317, l_discount_prf#3299 AS l_discount_prf_0#3318, l_partkey_and_l_suppkey_prf#3300 AS l_partkey_and_l_suppkey_prf_0#3319, l_commitdate_prf#3301 AS l_commitdate_prf_0#3320, l_suppkey_prf#3302 AS l_suppkey_prf_0#3321, l_orderkey_prf#3303 AS l_orderkey_prf_0#3322]
         :     :  +- Relation[l_returnflag_prf#3285,l_orderkey_and_l_linenumber_prf#3286,l_comment_prf#3287,l_linestatus_prf#3288,rid#3289,l_shipmode_prf#3290,l_shipinstruct_prf#3291,l_quantity_prf#3292,l_receiptdate_prf#3293,l_linenumber_prf#3294,l_tax_prf#3295,l_shipdate_prf#3296,l_extendedprice_prf#3297,l_partkey_prf#3298,l_discount_prf#3299,l_partkey_and_l_suppkey_prf#3300,l_commitdate_prf#3301,l_suppkey_prf#3302,l_orderkey_prf#3303] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#3324 AS p_comment_prf_1#3334, p_name_prf#3325 AS p_name_prf_1#3335, rid#3326 AS rid_1#3336, p_type_prf#3327 AS p_type_prf_1#3337, p_retailprice_prf#3328 AS p_retailprice_prf_1#3338, p_mfgr_prf#3329 AS p_mfgr_prf_1#3339, p_container_prf#3330 AS p_container_prf_1#3340, p_brand_prf#3331 AS p_brand_prf_1#3341, p_size_prf#3332 AS p_size_prf_1#3342, p_partkey_prf#3333 AS p_partkey_prf_1#3343]
            +- Relation[p_comment_prf#3324,p_name_prf#3325,rid#3326,p_type_prf#3327,p_retailprice_prf#3328,p_mfgr_prf#3329,p_container_prf#3330,p_brand_prf#3331,p_size_prf#3332,p_partkey_prf#3333] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 129829ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/11 05:28:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:28:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3401L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 05:28:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3401L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#3423]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#3414: string
         :     :- Project [o_shippriority_prf#3403 AS o_shippriority_prf_0#3413, rid#3404 AS rid_0#3414, o_orderdate_prf#3405 AS o_orderdate_prf_0#3415, o_custkey_prf#3406 AS o_custkey_prf_0#3416, o_orderpriority_prf#3407 AS o_orderpriority_prf_0#3417, o_clerk_prf#3408 AS o_clerk_prf_0#3418, o_orderstatus_prf#3409 AS o_orderstatus_prf_0#3419, o_totalprice_prf#3410 AS o_totalprice_prf_0#3420, o_orderkey_prf#3411 AS o_orderkey_prf_0#3421, o_comment_prf#3412 AS o_comment_prf_0#3422]
         :     :  +- Relation[o_shippriority_prf#3403,rid#3404,o_orderdate_prf#3405,o_custkey_prf#3406,o_orderpriority_prf#3407,o_clerk_prf#3408,o_orderstatus_prf#3409,o_totalprice_prf#3410,o_orderkey_prf#3411,o_comment_prf#3412] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3424 AS l_returnflag_prf_1#3443, l_orderkey_and_l_linenumber_prf#3425 AS l_orderkey_and_l_linenumber_prf_1#3444, l_comment_prf#3426 AS l_comment_prf_1#3445, l_linestatus_prf#3427 AS l_linestatus_prf_1#3446, rid#3428 AS rid_1#3447, l_shipmode_prf#3429 AS l_shipmode_prf_1#3448, l_shipinstruct_prf#3430 AS l_shipinstruct_prf_1#3449, l_quantity_prf#3431 AS l_quantity_prf_1#3450, l_receiptdate_prf#3432 AS l_receiptdate_prf_1#3451, l_linenumber_prf#3433 AS l_linenumber_prf_1#3452, l_tax_prf#3434 AS l_tax_prf_1#3453, l_shipdate_prf#3435 AS l_shipdate_prf_1#3454, l_extendedprice_prf#3436 AS l_extendedprice_prf_1#3455, l_partkey_prf#3437 AS l_partkey_prf_1#3456, l_discount_prf#3438 AS l_discount_prf_1#3457, l_partkey_and_l_suppkey_prf#3439 AS l_partkey_and_l_suppkey_prf_1#3458, l_commitdate_prf#3440 AS l_commitdate_prf_1#3459, l_suppkey_prf#3441 AS l_suppkey_prf_1#3460, l_orderkey_prf#3442 AS l_orderkey_prf_1#3461]
            +- Relation[l_returnflag_prf#3424,l_orderkey_and_l_linenumber_prf#3425,l_comment_prf#3426,l_linestatus_prf#3427,rid#3428,l_shipmode_prf#3429,l_shipinstruct_prf#3430,l_quantity_prf#3431,l_receiptdate_prf#3432,l_linenumber_prf#3433,l_tax_prf#3434,l_shipdate_prf#3435,l_extendedprice_prf#3436,l_partkey_prf#3437,l_discount_prf#3438,l_partkey_and_l_suppkey_prf#3439,l_commitdate_prf#3440,l_suppkey_prf#3441,l_orderkey_prf#3442] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 199894ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/11 05:31:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:31:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3506L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 05:31:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3506L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#3518]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#3513: string
         :     :- Project [rid#3508 AS rid_0#3513, n_regionkey_prf#3509 AS n_regionkey_prf_0#3514, n_nationkey_prf#3510 AS n_nationkey_prf_0#3515, n_name_prf#3511 AS n_name_prf_0#3516, n_comment_prf#3512 AS n_comment_prf_0#3517]
         :     :  +- Relation[rid#3508,n_regionkey_prf#3509,n_nationkey_prf#3510,n_name_prf#3511,n_comment_prf#3512] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3519 AS c_acctbal_prf_1#3528, rid#3520 AS rid_1#3529, c_name_prf#3521 AS c_name_prf_1#3530, c_nationkey_prf#3522 AS c_nationkey_prf_1#3531, c_custkey_prf#3523 AS c_custkey_prf_1#3532, c_comment_prf#3524 AS c_comment_prf_1#3533, c_address_prf#3525 AS c_address_prf_1#3534, c_mktsegment_prf#3526 AS c_mktsegment_prf_1#3535, c_phone_prf#3527 AS c_phone_prf_1#3536]
            +- Relation[c_acctbal_prf#3519,rid#3520,c_name_prf#3521,c_nationkey_prf#3522,c_custkey_prf#3523,c_comment_prf#3524,c_address_prf#3525,c_mktsegment_prf#3526,c_phone_prf#3527] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=150000
Elapsed time: 1944ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/11 05:31:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:31:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3579L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 05:31:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3579L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#3619]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3604: string
         :     :- Project [l_returnflag_prf#3581 AS l_returnflag_prf_0#3600, l_orderkey_and_l_linenumber_prf#3582 AS l_orderkey_and_l_linenumber_prf_0#3601, l_comment_prf#3583 AS l_comment_prf_0#3602, l_linestatus_prf#3584 AS l_linestatus_prf_0#3603, rid#3585 AS rid_0#3604, l_shipmode_prf#3586 AS l_shipmode_prf_0#3605, l_shipinstruct_prf#3587 AS l_shipinstruct_prf_0#3606, l_quantity_prf#3588 AS l_quantity_prf_0#3607, l_receiptdate_prf#3589 AS l_receiptdate_prf_0#3608, l_linenumber_prf#3590 AS l_linenumber_prf_0#3609, l_tax_prf#3591 AS l_tax_prf_0#3610, l_shipdate_prf#3592 AS l_shipdate_prf_0#3611, l_extendedprice_prf#3593 AS l_extendedprice_prf_0#3612, l_partkey_prf#3594 AS l_partkey_prf_0#3613, l_discount_prf#3595 AS l_discount_prf_0#3614, l_partkey_and_l_suppkey_prf#3596 AS l_partkey_and_l_suppkey_prf_0#3615, l_commitdate_prf#3597 AS l_commitdate_prf_0#3616, l_suppkey_prf#3598 AS l_suppkey_prf_0#3617, l_orderkey_prf#3599 AS l_orderkey_prf_0#3618]
         :     :  +- Relation[l_returnflag_prf#3581,l_orderkey_and_l_linenumber_prf#3582,l_comment_prf#3583,l_linestatus_prf#3584,rid#3585,l_shipmode_prf#3586,l_shipinstruct_prf#3587,l_quantity_prf#3588,l_receiptdate_prf#3589,l_linenumber_prf#3590,l_tax_prf#3591,l_shipdate_prf#3592,l_extendedprice_prf#3593,l_partkey_prf#3594,l_discount_prf#3595,l_partkey_and_l_suppkey_prf#3596,l_commitdate_prf#3597,l_suppkey_prf#3598,l_orderkey_prf#3599] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3620 AS o_shippriority_prf_1#3630, rid#3621 AS rid_1#3631, o_orderdate_prf#3622 AS o_orderdate_prf_1#3632, o_custkey_prf#3623 AS o_custkey_prf_1#3633, o_orderpriority_prf#3624 AS o_orderpriority_prf_1#3634, o_clerk_prf#3625 AS o_clerk_prf_1#3635, o_orderstatus_prf#3626 AS o_orderstatus_prf_1#3636, o_totalprice_prf#3627 AS o_totalprice_prf_1#3637, o_orderkey_prf#3628 AS o_orderkey_prf_1#3638, o_comment_prf#3629 AS o_comment_prf_1#3639]
            +- Relation[o_shippriority_prf#3620,rid#3621,o_orderdate_prf#3622,o_custkey_prf#3623,o_orderpriority_prf#3624,o_clerk_prf#3625,o_orderstatus_prf#3626,o_totalprice_prf#3627,o_orderkey_prf#3628,o_comment_prf#3629] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 131250ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/11 05:34:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:34:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3705L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 05:34:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3705L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_2#3725]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3717: string
         :     :- Project [c_acctbal_prf#3707 AS c_acctbal_prf_0#3716, rid#3708 AS rid_0#3717, c_name_prf#3709 AS c_name_prf_0#3718, c_nationkey_prf#3710 AS c_nationkey_prf_0#3719, c_custkey_prf#3711 AS c_custkey_prf_0#3720, c_comment_prf#3712 AS c_comment_prf_0#3721, c_address_prf#3713 AS c_address_prf_0#3722, c_mktsegment_prf#3714 AS c_mktsegment_prf_0#3723, c_phone_prf#3715 AS c_phone_prf_0#3724]
         :     :  +- Relation[c_acctbal_prf#3707,rid#3708,c_name_prf#3709,c_nationkey_prf#3710,c_custkey_prf#3711,c_comment_prf#3712,c_address_prf#3713,c_mktsegment_prf#3714,c_phone_prf#3715] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#3764]
            :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_1#3749: string
            :     :- Project [l_returnflag_prf#3726 AS l_returnflag_prf_1#3745, l_orderkey_and_l_linenumber_prf#3727 AS l_orderkey_and_l_linenumber_prf_1#3746, l_comment_prf#3728 AS l_comment_prf_1#3747, l_linestatus_prf#3729 AS l_linestatus_prf_1#3748, rid#3730 AS rid_1#3749, l_shipmode_prf#3731 AS l_shipmode_prf_1#3750, l_shipinstruct_prf#3732 AS l_shipinstruct_prf_1#3751, l_quantity_prf#3733 AS l_quantity_prf_1#3752, l_receiptdate_prf#3734 AS l_receiptdate_prf_1#3753, l_linenumber_prf#3735 AS l_linenumber_prf_1#3754, l_tax_prf#3736 AS l_tax_prf_1#3755, l_shipdate_prf#3737 AS l_shipdate_prf_1#3756, l_extendedprice_prf#3738 AS l_extendedprice_prf_1#3757, l_partkey_prf#3739 AS l_partkey_prf_1#3758, l_discount_prf#3740 AS l_discount_prf_1#3759, l_partkey_and_l_suppkey_prf#3741 AS l_partkey_and_l_suppkey_prf_1#3760, l_commitdate_prf#3742 AS l_commitdate_prf_1#3761, l_suppkey_prf#3743 AS l_suppkey_prf_1#3762, l_orderkey_prf#3744 AS l_orderkey_prf_1#3763]
            :     :  +- Relation[l_returnflag_prf#3726,l_orderkey_and_l_linenumber_prf#3727,l_comment_prf#3728,l_linestatus_prf#3729,rid#3730,l_shipmode_prf#3731,l_shipinstruct_prf#3732,l_quantity_prf#3733,l_receiptdate_prf#3734,l_linenumber_prf#3735,l_tax_prf#3736,l_shipdate_prf#3737,l_extendedprice_prf#3738,l_partkey_prf#3739,l_discount_prf#3740,l_partkey_and_l_suppkey_prf#3741,l_commitdate_prf#3742,l_suppkey_prf#3743,l_orderkey_prf#3744] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3765 AS o_shippriority_prf_2#3775, rid#3766 AS rid_2#3776, o_orderdate_prf#3767 AS o_orderdate_prf_2#3777, o_custkey_prf#3768 AS o_custkey_prf_2#3778, o_orderpriority_prf#3769 AS o_orderpriority_prf_2#3779, o_clerk_prf#3770 AS o_clerk_prf_2#3780, o_orderstatus_prf#3771 AS o_orderstatus_prf_2#3781, o_totalprice_prf#3772 AS o_totalprice_prf_2#3782, o_orderkey_prf#3773 AS o_orderkey_prf_2#3783, o_comment_prf#3774 AS o_comment_prf_2#3784]
               +- Relation[o_shippriority_prf#3765,rid#3766,o_orderdate_prf#3767,o_custkey_prf#3768,o_orderpriority_prf#3769,o_clerk_prf#3770,o_orderstatus_prf#3771,o_totalprice_prf#3772,o_orderkey_prf#3773,o_comment_prf#3774] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 176815ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/11 05:37:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:37:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3835L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 05:37:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3835L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#3837 AS p_comment_prf_0#3847, p_name_prf#3838 AS p_name_prf_0#3848, rid#3839 AS rid_0#3849, p_type_prf#3840 AS p_type_prf_0#3850, p_retailprice_prf#3841 AS p_retailprice_prf_0#3851, p_mfgr_prf#3842 AS p_mfgr_prf_0#3852, p_container_prf#3843 AS p_container_prf_0#3853, p_brand_prf#3844 AS p_brand_prf_0#3854, p_size_prf#3845 AS p_size_prf_0#3855, p_partkey_prf#3846 AS p_partkey_prf_0#3856]
         :  +- Relation[p_comment_prf#3837,p_name_prf#3838,rid#3839,p_type_prf#3840,p_retailprice_prf#3841,p_mfgr_prf#3842,p_container_prf#3843,p_brand_prf#3844,p_size_prf#3845,p_partkey_prf#3846] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3857]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1658,value#1659] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1451
Elapsed time: 84ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/11 05:37:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:37:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3888L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 05:37:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3888L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#3908]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3900: string
         :     :- Project [c_acctbal_prf#3890 AS c_acctbal_prf_0#3899, rid#3891 AS rid_0#3900, c_name_prf#3892 AS c_name_prf_0#3901, c_nationkey_prf#3893 AS c_nationkey_prf_0#3902, c_custkey_prf#3894 AS c_custkey_prf_0#3903, c_comment_prf#3895 AS c_comment_prf_0#3904, c_address_prf#3896 AS c_address_prf_0#3905, c_mktsegment_prf#3897 AS c_mktsegment_prf_0#3906, c_phone_prf#3898 AS c_phone_prf_0#3907]
         :     :  +- Relation[c_acctbal_prf#3890,rid#3891,c_name_prf#3892,c_nationkey_prf#3893,c_custkey_prf#3894,c_comment_prf#3895,c_address_prf#3896,c_mktsegment_prf#3897,c_phone_prf#3898] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3909 AS o_shippriority_prf_1#3919, rid#3910 AS rid_1#3920, o_orderdate_prf#3911 AS o_orderdate_prf_1#3921, o_custkey_prf#3912 AS o_custkey_prf_1#3922, o_orderpriority_prf#3913 AS o_orderpriority_prf_1#3923, o_clerk_prf#3914 AS o_clerk_prf_1#3924, o_orderstatus_prf#3915 AS o_orderstatus_prf_1#3925, o_totalprice_prf#3916 AS o_totalprice_prf_1#3926, o_orderkey_prf#3917 AS o_orderkey_prf_1#3927, o_comment_prf#3918 AS o_comment_prf_1#3928]
            +- Relation[o_shippriority_prf#3909,rid#3910,o_orderdate_prf#3911,o_custkey_prf#3912,o_orderpriority_prf#3913,o_clerk_prf#3914,o_orderstatus_prf#3915,o_totalprice_prf#3916,o_orderkey_prf#3917,o_comment_prf#3918] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1500000
Elapsed time: 40686ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/11 05:37:41 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:37:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3983L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 05:37:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3983L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#4001]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#3994: string
         :     :- Project [s_phone_prf#3985 AS s_phone_prf_0#3993, rid#3986 AS rid_0#3994, s_address_prf#3987 AS s_address_prf_0#3995, s_nationkey_prf#3988 AS s_nationkey_prf_0#3996, s_suppkey_prf#3989 AS s_suppkey_prf_0#3997, s_name_prf#3990 AS s_name_prf_0#3998, s_acctbal_prf#3991 AS s_acctbal_prf_0#3999, s_comment_prf#3992 AS s_comment_prf_0#4000]
         :     :  +- Relation[s_phone_prf#3985,rid#3986,s_address_prf#3987,s_nationkey_prf#3988,s_suppkey_prf#3989,s_name_prf#3990,s_acctbal_prf#3991,s_comment_prf#3992] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#4040]
            :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_1#4025: string
            :     :- Project [l_returnflag_prf#4002 AS l_returnflag_prf_1#4021, l_orderkey_and_l_linenumber_prf#4003 AS l_orderkey_and_l_linenumber_prf_1#4022, l_comment_prf#4004 AS l_comment_prf_1#4023, l_linestatus_prf#4005 AS l_linestatus_prf_1#4024, rid#4006 AS rid_1#4025, l_shipmode_prf#4007 AS l_shipmode_prf_1#4026, l_shipinstruct_prf#4008 AS l_shipinstruct_prf_1#4027, l_quantity_prf#4009 AS l_quantity_prf_1#4028, l_receiptdate_prf#4010 AS l_receiptdate_prf_1#4029, l_linenumber_prf#4011 AS l_linenumber_prf_1#4030, l_tax_prf#4012 AS l_tax_prf_1#4031, l_shipdate_prf#4013 AS l_shipdate_prf_1#4032, l_extendedprice_prf#4014 AS l_extendedprice_prf_1#4033, l_partkey_prf#4015 AS l_partkey_prf_1#4034, l_discount_prf#4016 AS l_discount_prf_1#4035, l_partkey_and_l_suppkey_prf#4017 AS l_partkey_and_l_suppkey_prf_1#4036, l_commitdate_prf#4018 AS l_commitdate_prf_1#4037, l_suppkey_prf#4019 AS l_suppkey_prf_1#4038, l_orderkey_prf#4020 AS l_orderkey_prf_1#4039]
            :     :  +- Relation[l_returnflag_prf#4002,l_orderkey_and_l_linenumber_prf#4003,l_comment_prf#4004,l_linestatus_prf#4005,rid#4006,l_shipmode_prf#4007,l_shipinstruct_prf#4008,l_quantity_prf#4009,l_receiptdate_prf#4010,l_linenumber_prf#4011,l_tax_prf#4012,l_shipdate_prf#4013,l_extendedprice_prf#4014,l_partkey_prf#4015,l_discount_prf#4016,l_partkey_and_l_suppkey_prf#4017,l_commitdate_prf#4018,l_suppkey_prf#4019,l_orderkey_prf#4020] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#4041 AS p_comment_prf_2#4051, p_name_prf#4042 AS p_name_prf_2#4052, rid#4043 AS rid_2#4053, p_type_prf#4044 AS p_type_prf_2#4054, p_retailprice_prf#4045 AS p_retailprice_prf_2#4055, p_mfgr_prf#4046 AS p_mfgr_prf_2#4056, p_container_prf#4047 AS p_container_prf_2#4057, p_brand_prf#4048 AS p_brand_prf_2#4058, p_size_prf#4049 AS p_size_prf_2#4059, p_partkey_prf#4050 AS p_partkey_prf_2#4060]
               +- Relation[p_comment_prf#4041,p_name_prf#4042,rid#4043,p_type_prf#4044,p_retailprice_prf#4045,p_mfgr_prf#4046,p_container_prf#4047,p_brand_prf#4048,p_size_prf#4049,p_partkey_prf#4050] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 200863ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/11 05:41:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:41:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4120L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 05:41:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4120L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_2#4140]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#4132: string
         :     :- Project [c_acctbal_prf#4122 AS c_acctbal_prf_0#4131, rid#4123 AS rid_0#4132, c_name_prf#4124 AS c_name_prf_0#4133, c_nationkey_prf#4125 AS c_nationkey_prf_0#4134, c_custkey_prf#4126 AS c_custkey_prf_0#4135, c_comment_prf#4127 AS c_comment_prf_0#4136, c_address_prf#4128 AS c_address_prf_0#4137, c_mktsegment_prf#4129 AS c_mktsegment_prf_0#4138, c_phone_prf#4130 AS c_phone_prf_0#4139]
         :     :  +- Relation[c_acctbal_prf#4122,rid#4123,c_name_prf#4124,c_nationkey_prf#4125,c_custkey_prf#4126,c_comment_prf#4127,c_address_prf#4128,c_mktsegment_prf#4129,c_phone_prf#4130] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#4157]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#4150: string
            :     :- Project [s_phone_prf#4141 AS s_phone_prf_1#4149, rid#4142 AS rid_1#4150, s_address_prf#4143 AS s_address_prf_1#4151, s_nationkey_prf#4144 AS s_nationkey_prf_1#4152, s_suppkey_prf#4145 AS s_suppkey_prf_1#4153, s_name_prf#4146 AS s_name_prf_1#4154, s_acctbal_prf#4147 AS s_acctbal_prf_1#4155, s_comment_prf#4148 AS s_comment_prf_1#4156]
            :     :  +- Relation[s_phone_prf#4141,rid#4142,s_address_prf#4143,s_nationkey_prf#4144,s_suppkey_prf#4145,s_name_prf#4146,s_acctbal_prf#4147,s_comment_prf#4148] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [rid#4158 AS rid_2#4163, n_regionkey_prf#4159 AS n_regionkey_prf_2#4164, n_nationkey_prf#4160 AS n_nationkey_prf_2#4165, n_name_prf#4161 AS n_name_prf_2#4166, n_comment_prf#4162 AS n_comment_prf_2#4167]
               +- Relation[rid#4158,n_regionkey_prf#4159,n_nationkey_prf#4160,n_name_prf#4161,n_comment_prf#4162] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 42824ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/11 05:41:44 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:41:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4207L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 05:41:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4207L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#4223]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#4217: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#4209 AS ps_partkey_and_ps_suppkey_prf_0#4216, rid#4210 AS rid_0#4217, ps_availqty_prf#4211 AS ps_availqty_prf_0#4218, ps_comment_prf#4212 AS ps_comment_prf_0#4219, ps_partkey_prf#4213 AS ps_partkey_prf_0#4220, ps_supplycost_prf#4214 AS ps_supplycost_prf_0#4221, ps_suppkey_prf#4215 AS ps_suppkey_prf_0#4222]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#4209,rid#4210,ps_availqty_prf#4211,ps_comment_prf#4212,ps_partkey_prf#4213,ps_supplycost_prf#4214,ps_suppkey_prf#4215] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#4224 AS p_comment_prf_1#4234, p_name_prf#4225 AS p_name_prf_1#4235, rid#4226 AS rid_1#4236, p_type_prf#4227 AS p_type_prf_1#4237, p_retailprice_prf#4228 AS p_retailprice_prf_1#4238, p_mfgr_prf#4229 AS p_mfgr_prf_1#4239, p_container_prf#4230 AS p_container_prf_1#4240, p_brand_prf#4231 AS p_brand_prf_1#4241, p_size_prf#4232 AS p_size_prf_1#4242, p_partkey_prf#4233 AS p_partkey_prf_1#4243]
            :  +- Relation[p_comment_prf#4224,p_name_prf#4225,rid#4226,p_type_prf#4227,p_retailprice_prf#4228,p_mfgr_prf#4229,p_container_prf#4230,p_brand_prf#4231,p_size_prf#4232,p_partkey_prf#4233] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4244]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1658,value#1659] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 50890ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/11 05:42:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:42:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4277L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 05:42:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4277L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#4295]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#4288: string
         :     :- Project [s_phone_prf#4279 AS s_phone_prf_0#4287, rid#4280 AS rid_0#4288, s_address_prf#4281 AS s_address_prf_0#4289, s_nationkey_prf#4282 AS s_nationkey_prf_0#4290, s_suppkey_prf#4283 AS s_suppkey_prf_0#4291, s_name_prf#4284 AS s_name_prf_0#4292, s_acctbal_prf#4285 AS s_acctbal_prf_0#4293, s_comment_prf#4286 AS s_comment_prf_0#4294]
         :     :  +- Relation[s_phone_prf#4279,rid#4280,s_address_prf#4281,s_nationkey_prf#4282,s_suppkey_prf#4283,s_name_prf#4284,s_acctbal_prf#4285,s_comment_prf#4286] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4296 AS ps_partkey_and_ps_suppkey_prf_1#4303, rid#4297 AS rid_1#4304, ps_availqty_prf#4298 AS ps_availqty_prf_1#4305, ps_comment_prf#4299 AS ps_comment_prf_1#4306, ps_partkey_prf#4300 AS ps_partkey_prf_1#4307, ps_supplycost_prf#4301 AS ps_supplycost_prf_1#4308, ps_suppkey_prf#4302 AS ps_suppkey_prf_1#4309]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4296,rid#4297,ps_availqty_prf#4298,ps_comment_prf#4299,ps_partkey_prf#4300,ps_supplycost_prf#4301,ps_suppkey_prf#4302] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 11257ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/11 05:42:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:42:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4347L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 05:42:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4347L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#4376]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#4365]
         :     :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#4358: string
         :     :  :     :- Project [s_phone_prf#4349 AS s_phone_prf_0#4357, rid#4350 AS rid_0#4358, s_address_prf#4351 AS s_address_prf_0#4359, s_nationkey_prf#4352 AS s_nationkey_prf_0#4360, s_suppkey_prf#4353 AS s_suppkey_prf_0#4361, s_name_prf#4354 AS s_name_prf_0#4362, s_acctbal_prf#4355 AS s_acctbal_prf_0#4363, s_comment_prf#4356 AS s_comment_prf_0#4364]
         :     :  :     :  +- Relation[s_phone_prf#4349,rid#4350,s_address_prf#4351,s_nationkey_prf#4352,s_suppkey_prf#4353,s_name_prf#4354,s_acctbal_prf#4355,s_comment_prf#4356] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [rid#4366 AS rid_1#4371, n_regionkey_prf#4367 AS n_regionkey_prf_1#4372, n_nationkey_prf#4368 AS n_nationkey_prf_1#4373, n_name_prf#4369 AS n_name_prf_1#4374, n_comment_prf#4370 AS n_comment_prf_1#4375]
         :     :     +- Relation[rid#4366,n_regionkey_prf#4367,n_nationkey_prf#4368,n_name_prf#4369,n_comment_prf#4370] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4377 AS c_acctbal_prf_2#4386, rid#4378 AS rid_2#4387, c_name_prf#4379 AS c_name_prf_2#4388, c_nationkey_prf#4380 AS c_nationkey_prf_2#4389, c_custkey_prf#4381 AS c_custkey_prf_2#4390, c_comment_prf#4382 AS c_comment_prf_2#4391, c_address_prf#4383 AS c_address_prf_2#4392, c_mktsegment_prf#4384 AS c_mktsegment_prf_2#4393, c_phone_prf#4385 AS c_phone_prf_2#4394]
            +- Relation[c_acctbal_prf#4377,rid#4378,c_name_prf#4379,c_nationkey_prf#4380,c_custkey_prf#4381,c_comment_prf#4382,c_address_prf#4383,c_mktsegment_prf#4384,c_phone_prf#4385] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 673643ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/11 05:54:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:54:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4452L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 05:54:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4452L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#4474]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#4466: string
         :     :  :     :- Project [p_comment_prf#4454 AS p_comment_prf_0#4464, p_name_prf#4455 AS p_name_prf_0#4465, rid#4456 AS rid_0#4466, p_type_prf#4457 AS p_type_prf_0#4467, p_retailprice_prf#4458 AS p_retailprice_prf_0#4468, p_mfgr_prf#4459 AS p_mfgr_prf_0#4469, p_container_prf#4460 AS p_container_prf_0#4470, p_brand_prf#4461 AS p_brand_prf_0#4471, p_size_prf#4462 AS p_size_prf_0#4472, p_partkey_prf#4463 AS p_partkey_prf_0#4473]
         :     :  :     :  +- Relation[p_comment_prf#4454,p_name_prf#4455,rid#4456,p_type_prf#4457,p_retailprice_prf#4458,p_mfgr_prf#4459,p_container_prf#4460,p_brand_prf#4461,p_size_prf#4462,p_partkey_prf#4463] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#4475 AS l_returnflag_prf_1#4494, l_orderkey_and_l_linenumber_prf#4476 AS l_orderkey_and_l_linenumber_prf_1#4495, l_comment_prf#4477 AS l_comment_prf_1#4496, l_linestatus_prf#4478 AS l_linestatus_prf_1#4497, rid#4479 AS rid_1#4498, l_shipmode_prf#4480 AS l_shipmode_prf_1#4499, l_shipinstruct_prf#4481 AS l_shipinstruct_prf_1#4500, l_quantity_prf#4482 AS l_quantity_prf_1#4501, l_receiptdate_prf#4483 AS l_receiptdate_prf_1#4502, l_linenumber_prf#4484 AS l_linenumber_prf_1#4503, l_tax_prf#4485 AS l_tax_prf_1#4504, l_shipdate_prf#4486 AS l_shipdate_prf_1#4505, l_extendedprice_prf#4487 AS l_extendedprice_prf_1#4506, l_partkey_prf#4488 AS l_partkey_prf_1#4507, l_discount_prf#4489 AS l_discount_prf_1#4508, l_partkey_and_l_suppkey_prf#4490 AS l_partkey_and_l_suppkey_prf_1#4509, l_commitdate_prf#4491 AS l_commitdate_prf_1#4510, l_suppkey_prf#4492 AS l_suppkey_prf_1#4511, l_orderkey_prf#4493 AS l_orderkey_prf_1#4512]
         :     :     +- Relation[l_returnflag_prf#4475,l_orderkey_and_l_linenumber_prf#4476,l_comment_prf#4477,l_linestatus_prf#4478,rid#4479,l_shipmode_prf#4480,l_shipinstruct_prf#4481,l_quantity_prf#4482,l_receiptdate_prf#4483,l_linenumber_prf#4484,l_tax_prf#4485,l_shipdate_prf#4486,l_extendedprice_prf#4487,l_partkey_prf#4488,l_discount_prf#4489,l_partkey_and_l_suppkey_prf#4490,l_commitdate_prf#4491,l_suppkey_prf#4492,l_orderkey_prf#4493] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4514 AS s_phone_prf_2#4522, rid#4515 AS rid_2#4523, s_address_prf#4516 AS s_address_prf_2#4524, s_nationkey_prf#4517 AS s_nationkey_prf_2#4525, s_suppkey_prf#4518 AS s_suppkey_prf_2#4526, s_name_prf#4519 AS s_name_prf_2#4527, s_acctbal_prf#4520 AS s_acctbal_prf_2#4528, s_comment_prf#4521 AS s_comment_prf_2#4529]
            +- Relation[s_phone_prf#4514,rid#4515,s_address_prf#4516,s_nationkey_prf#4517,s_suppkey_prf#4518,s_name_prf#4519,s_acctbal_prf#4520,s_comment_prf#4521] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 313980ms

f1=
select * from region where r_name = 'EUROPE'
19/10/11 05:59:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:59:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4573L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/11 05:59:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4573L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#4575 AS r_regionkey_prf_0#4579, r_name_prf#4576 AS r_name_prf_0#4580, r_comment_prf#4577 AS r_comment_prf_0#4581, rid#4578 AS rid_0#4582]
         :  +- Relation[r_regionkey_prf#4575,r_name_prf#4576,r_comment_prf#4577,rid#4578] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4583]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1658,value#1659] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 51ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/11 05:59:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 05:59:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4612L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 05:59:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4612L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#4628]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, rid_0#4622: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#4614 AS ps_partkey_and_ps_suppkey_prf_0#4621, rid#4615 AS rid_0#4622, ps_availqty_prf#4616 AS ps_availqty_prf_0#4623, ps_comment_prf#4617 AS ps_comment_prf_0#4624, ps_partkey_prf#4618 AS ps_partkey_prf_0#4625, ps_supplycost_prf#4619 AS ps_supplycost_prf_0#4626, ps_suppkey_prf#4620 AS ps_suppkey_prf_0#4627]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#4614,rid#4615,ps_availqty_prf#4616,ps_comment_prf#4617,ps_partkey_prf#4618,ps_supplycost_prf#4619,ps_suppkey_prf#4620] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4629 AS l_returnflag_prf_1#4648, l_orderkey_and_l_linenumber_prf#4630 AS l_orderkey_and_l_linenumber_prf_1#4649, l_comment_prf#4631 AS l_comment_prf_1#4650, l_linestatus_prf#4632 AS l_linestatus_prf_1#4651, rid#4633 AS rid_1#4652, l_shipmode_prf#4634 AS l_shipmode_prf_1#4653, l_shipinstruct_prf#4635 AS l_shipinstruct_prf_1#4654, l_quantity_prf#4636 AS l_quantity_prf_1#4655, l_receiptdate_prf#4637 AS l_receiptdate_prf_1#4656, l_linenumber_prf#4638 AS l_linenumber_prf_1#4657, l_tax_prf#4639 AS l_tax_prf_1#4658, l_shipdate_prf#4640 AS l_shipdate_prf_1#4659, l_extendedprice_prf#4641 AS l_extendedprice_prf_1#4660, l_partkey_prf#4642 AS l_partkey_prf_1#4661, l_discount_prf#4643 AS l_discount_prf_1#4662, l_partkey_and_l_suppkey_prf#4644 AS l_partkey_and_l_suppkey_prf_1#4663, l_commitdate_prf#4645 AS l_commitdate_prf_1#4664, l_suppkey_prf#4646 AS l_suppkey_prf_1#4665, l_orderkey_prf#4647 AS l_orderkey_prf_1#4666]
            +- Relation[l_returnflag_prf#4629,l_orderkey_and_l_linenumber_prf#4630,l_comment_prf#4631,l_linestatus_prf#4632,rid#4633,l_shipmode_prf#4634,l_shipinstruct_prf#4635,l_quantity_prf#4636,l_receiptdate_prf#4637,l_linenumber_prf#4638,l_tax_prf#4639,l_shipdate_prf#4640,l_extendedprice_prf#4641,l_partkey_prf#4642,l_discount_prf#4643,l_partkey_and_l_suppkey_prf#4644,l_commitdate_prf#4645,l_suppkey_prf#4646,l_orderkey_prf#4647] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 126122ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/11 06:01:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:01:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4712L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 06:01:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4712L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#4714 AS l_returnflag_prf_0#4733, l_orderkey_and_l_linenumber_prf#4715 AS l_orderkey_and_l_linenumber_prf_0#4734, l_comment_prf#4716 AS l_comment_prf_0#4735, l_linestatus_prf#4717 AS l_linestatus_prf_0#4736, rid#4718 AS rid_0#4737, l_shipmode_prf#4719 AS l_shipmode_prf_0#4738, l_shipinstruct_prf#4720 AS l_shipinstruct_prf_0#4739, l_quantity_prf#4721 AS l_quantity_prf_0#4740, l_receiptdate_prf#4722 AS l_receiptdate_prf_0#4741, l_linenumber_prf#4723 AS l_linenumber_prf_0#4742, l_tax_prf#4724 AS l_tax_prf_0#4743, l_shipdate_prf#4725 AS l_shipdate_prf_0#4744, l_extendedprice_prf#4726 AS l_extendedprice_prf_0#4745, l_partkey_prf#4727 AS l_partkey_prf_0#4746, l_discount_prf#4728 AS l_discount_prf_0#4747, l_partkey_and_l_suppkey_prf#4729 AS l_partkey_and_l_suppkey_prf_0#4748, l_commitdate_prf#4730 AS l_commitdate_prf_0#4749, l_suppkey_prf#4731 AS l_suppkey_prf_0#4750, l_orderkey_prf#4732 AS l_orderkey_prf_0#4751]
         :  +- Relation[l_returnflag_prf#4714,l_orderkey_and_l_linenumber_prf#4715,l_comment_prf#4716,l_linestatus_prf#4717,rid#4718,l_shipmode_prf#4719,l_shipinstruct_prf#4720,l_quantity_prf#4721,l_receiptdate_prf#4722,l_linenumber_prf#4723,l_tax_prf#4724,l_shipdate_prf#4725,l_extendedprice_prf#4726,l_partkey_prf#4727,l_discount_prf#4728,l_partkey_and_l_suppkey_prf#4729,l_commitdate_prf#4730,l_suppkey_prf#4731,l_orderkey_prf#4732] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4752]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1658,value#1659] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 13838ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/11 06:01:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:01:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4796L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 06:01:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4796L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#4833]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#4812]
         :     :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#4806: string
         :     :  :     :- Project [ps_partkey_and_ps_suppkey_prf#4798 AS ps_partkey_and_ps_suppkey_prf_0#4805, rid#4799 AS rid_0#4806, ps_availqty_prf#4800 AS ps_availqty_prf_0#4807, ps_comment_prf#4801 AS ps_comment_prf_0#4808, ps_partkey_prf#4802 AS ps_partkey_prf_0#4809, ps_supplycost_prf#4803 AS ps_supplycost_prf_0#4810, ps_suppkey_prf#4804 AS ps_suppkey_prf_0#4811]
         :     :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#4798,rid#4799,ps_availqty_prf#4800,ps_comment_prf#4801,ps_partkey_prf#4802,ps_supplycost_prf#4803,ps_suppkey_prf#4804] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#4813 AS p_comment_prf_1#4823, p_name_prf#4814 AS p_name_prf_1#4824, rid#4815 AS rid_1#4825, p_type_prf#4816 AS p_type_prf_1#4826, p_retailprice_prf#4817 AS p_retailprice_prf_1#4827, p_mfgr_prf#4818 AS p_mfgr_prf_1#4828, p_container_prf#4819 AS p_container_prf_1#4829, p_brand_prf#4820 AS p_brand_prf_1#4830, p_size_prf#4821 AS p_size_prf_1#4831, p_partkey_prf#4822 AS p_partkey_prf_1#4832]
         :     :     +- Relation[p_comment_prf#4813,p_name_prf#4814,rid#4815,p_type_prf#4816,p_retailprice_prf#4817,p_mfgr_prf#4818,p_container_prf#4819,p_brand_prf#4820,p_size_prf#4821,p_partkey_prf#4822] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4834 AS s_phone_prf_2#4842, rid#4835 AS rid_2#4843, s_address_prf#4836 AS s_address_prf_2#4844, s_nationkey_prf#4837 AS s_nationkey_prf_2#4845, s_suppkey_prf#4838 AS s_suppkey_prf_2#4846, s_name_prf#4839 AS s_name_prf_2#4847, s_acctbal_prf#4840 AS s_acctbal_prf_2#4848, s_comment_prf#4841 AS s_comment_prf_2#4849]
            +- Relation[s_phone_prf#4834,rid#4835,s_address_prf#4836,s_nationkey_prf#4837,s_suppkey_prf#4838,s_name_prf#4839,s_acctbal_prf#4840,s_comment_prf#4841] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 109311ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/11 06:03:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:03:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4911L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 06:03:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4911L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#4951]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4936: string
         :     :  :     :- Project [l_returnflag_prf#4913 AS l_returnflag_prf_0#4932, l_orderkey_and_l_linenumber_prf#4914 AS l_orderkey_and_l_linenumber_prf_0#4933, l_comment_prf#4915 AS l_comment_prf_0#4934, l_linestatus_prf#4916 AS l_linestatus_prf_0#4935, rid#4917 AS rid_0#4936, l_shipmode_prf#4918 AS l_shipmode_prf_0#4937, l_shipinstruct_prf#4919 AS l_shipinstruct_prf_0#4938, l_quantity_prf#4920 AS l_quantity_prf_0#4939, l_receiptdate_prf#4921 AS l_receiptdate_prf_0#4940, l_linenumber_prf#4922 AS l_linenumber_prf_0#4941, l_tax_prf#4923 AS l_tax_prf_0#4942, l_shipdate_prf#4924 AS l_shipdate_prf_0#4943, l_extendedprice_prf#4925 AS l_extendedprice_prf_0#4944, l_partkey_prf#4926 AS l_partkey_prf_0#4945, l_discount_prf#4927 AS l_discount_prf_0#4946, l_partkey_and_l_suppkey_prf#4928 AS l_partkey_and_l_suppkey_prf_0#4947, l_commitdate_prf#4929 AS l_commitdate_prf_0#4948, l_suppkey_prf#4930 AS l_suppkey_prf_0#4949, l_orderkey_prf#4931 AS l_orderkey_prf_0#4950]
         :     :  :     :  +- Relation[l_returnflag_prf#4913,l_orderkey_and_l_linenumber_prf#4914,l_comment_prf#4915,l_linestatus_prf#4916,rid#4917,l_shipmode_prf#4918,l_shipinstruct_prf#4919,l_quantity_prf#4920,l_receiptdate_prf#4921,l_linenumber_prf#4922,l_tax_prf#4923,l_shipdate_prf#4924,l_extendedprice_prf#4925,l_partkey_prf#4926,l_discount_prf#4927,l_partkey_and_l_suppkey_prf#4928,l_commitdate_prf#4929,l_suppkey_prf#4930,l_orderkey_prf#4931] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#4952 AS o_shippriority_prf_1#4962, rid#4953 AS rid_1#4963, o_orderdate_prf#4954 AS o_orderdate_prf_1#4964, o_custkey_prf#4955 AS o_custkey_prf_1#4965, o_orderpriority_prf#4956 AS o_orderpriority_prf_1#4966, o_clerk_prf#4957 AS o_clerk_prf_1#4967, o_orderstatus_prf#4958 AS o_orderstatus_prf_1#4968, o_totalprice_prf#4959 AS o_totalprice_prf_1#4969, o_orderkey_prf#4960 AS o_orderkey_prf_1#4970, o_comment_prf#4961 AS o_comment_prf_1#4971]
         :     :     +- Relation[o_shippriority_prf#4952,rid#4953,o_orderdate_prf#4954,o_custkey_prf#4955,o_orderpriority_prf#4956,o_clerk_prf#4957,o_orderstatus_prf#4958,o_totalprice_prf#4959,o_orderkey_prf#4960,o_comment_prf#4961] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4973 AS c_acctbal_prf_2#4982, rid#4974 AS rid_2#4983, c_name_prf#4975 AS c_name_prf_2#4984, c_nationkey_prf#4976 AS c_nationkey_prf_2#4985, c_custkey_prf#4977 AS c_custkey_prf_2#4986, c_comment_prf#4978 AS c_comment_prf_2#4987, c_address_prf#4979 AS c_address_prf_2#4988, c_mktsegment_prf#4980 AS c_mktsegment_prf_2#4989, c_phone_prf#4981 AS c_phone_prf_2#4990]
            +- Relation[c_acctbal_prf#4973,rid#4974,c_name_prf#4975,c_nationkey_prf#4976,c_custkey_prf#4977,c_comment_prf#4978,c_address_prf#4979,c_mktsegment_prf#4980,c_phone_prf#4981] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 343825ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/11 06:09:07 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:09:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5057L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 06:09:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5057L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#5079]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#5070: string
         :     :- Project [o_shippriority_prf#5059 AS o_shippriority_prf_0#5069, rid#5060 AS rid_0#5070, o_orderdate_prf#5061 AS o_orderdate_prf_0#5071, o_custkey_prf#5062 AS o_custkey_prf_0#5072, o_orderpriority_prf#5063 AS o_orderpriority_prf_0#5073, o_clerk_prf#5064 AS o_clerk_prf_0#5074, o_orderstatus_prf#5065 AS o_orderstatus_prf_0#5075, o_totalprice_prf#5066 AS o_totalprice_prf_0#5076, o_orderkey_prf#5067 AS o_orderkey_prf_0#5077, o_comment_prf#5068 AS o_comment_prf_0#5078]
         :     :  +- Relation[o_shippriority_prf#5059,rid#5060,o_orderdate_prf#5061,o_custkey_prf#5062,o_orderpriority_prf#5063,o_clerk_prf#5064,o_orderstatus_prf#5065,o_totalprice_prf#5066,o_orderkey_prf#5067,o_comment_prf#5068] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#5080 AS l_returnflag_prf_1#5099, l_orderkey_and_l_linenumber_prf#5081 AS l_orderkey_and_l_linenumber_prf_1#5100, l_comment_prf#5082 AS l_comment_prf_1#5101, l_linestatus_prf#5083 AS l_linestatus_prf_1#5102, rid#5084 AS rid_1#5103, l_shipmode_prf#5085 AS l_shipmode_prf_1#5104, l_shipinstruct_prf#5086 AS l_shipinstruct_prf_1#5105, l_quantity_prf#5087 AS l_quantity_prf_1#5106, l_receiptdate_prf#5088 AS l_receiptdate_prf_1#5107, l_linenumber_prf#5089 AS l_linenumber_prf_1#5108, l_tax_prf#5090 AS l_tax_prf_1#5109, l_shipdate_prf#5091 AS l_shipdate_prf_1#5110, l_extendedprice_prf#5092 AS l_extendedprice_prf_1#5111, l_partkey_prf#5093 AS l_partkey_prf_1#5112, l_discount_prf#5094 AS l_discount_prf_1#5113, l_partkey_and_l_suppkey_prf#5095 AS l_partkey_and_l_suppkey_prf_1#5114, l_commitdate_prf#5096 AS l_commitdate_prf_1#5115, l_suppkey_prf#5097 AS l_suppkey_prf_1#5116, l_orderkey_prf#5098 AS l_orderkey_prf_1#5117]
            :  +- Relation[l_returnflag_prf#5080,l_orderkey_and_l_linenumber_prf#5081,l_comment_prf#5082,l_linestatus_prf#5083,rid#5084,l_shipmode_prf#5085,l_shipinstruct_prf#5086,l_quantity_prf#5087,l_receiptdate_prf#5088,l_linenumber_prf#5089,l_tax_prf#5090,l_shipdate_prf#5091,l_extendedprice_prf#5092,l_partkey_prf#5093,l_discount_prf#5094,l_partkey_and_l_suppkey_prf#5095,l_commitdate_prf#5096,l_suppkey_prf#5097,l_orderkey_prf#5098] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5118]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1658,value#1659] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 202277ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/11 06:12:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:12:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5174L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 06:12:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5174L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#5192]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#5185: string
         :     :- Project [s_phone_prf#5176 AS s_phone_prf_0#5184, rid#5177 AS rid_0#5185, s_address_prf#5178 AS s_address_prf_0#5186, s_nationkey_prf#5179 AS s_nationkey_prf_0#5187, s_suppkey_prf#5180 AS s_suppkey_prf_0#5188, s_name_prf#5181 AS s_name_prf_0#5189, s_acctbal_prf#5182 AS s_acctbal_prf_0#5190, s_comment_prf#5183 AS s_comment_prf_0#5191]
         :     :  +- Relation[s_phone_prf#5176,rid#5177,s_address_prf#5178,s_nationkey_prf#5179,s_suppkey_prf#5180,s_name_prf#5181,s_acctbal_prf#5182,s_comment_prf#5183] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5193 AS l_returnflag_prf_1#5212, l_orderkey_and_l_linenumber_prf#5194 AS l_orderkey_and_l_linenumber_prf_1#5213, l_comment_prf#5195 AS l_comment_prf_1#5214, l_linestatus_prf#5196 AS l_linestatus_prf_1#5215, rid#5197 AS rid_1#5216, l_shipmode_prf#5198 AS l_shipmode_prf_1#5217, l_shipinstruct_prf#5199 AS l_shipinstruct_prf_1#5218, l_quantity_prf#5200 AS l_quantity_prf_1#5219, l_receiptdate_prf#5201 AS l_receiptdate_prf_1#5220, l_linenumber_prf#5202 AS l_linenumber_prf_1#5221, l_tax_prf#5203 AS l_tax_prf_1#5222, l_shipdate_prf#5204 AS l_shipdate_prf_1#5223, l_extendedprice_prf#5205 AS l_extendedprice_prf_1#5224, l_partkey_prf#5206 AS l_partkey_prf_1#5225, l_discount_prf#5207 AS l_discount_prf_1#5226, l_partkey_and_l_suppkey_prf#5208 AS l_partkey_and_l_suppkey_prf_1#5227, l_commitdate_prf#5209 AS l_commitdate_prf_1#5228, l_suppkey_prf#5210 AS l_suppkey_prf_1#5229, l_orderkey_prf#5211 AS l_orderkey_prf_1#5230]
            +- Relation[l_returnflag_prf#5193,l_orderkey_and_l_linenumber_prf#5194,l_comment_prf#5195,l_linestatus_prf#5196,rid#5197,l_shipmode_prf#5198,l_shipinstruct_prf#5199,l_quantity_prf#5200,l_receiptdate_prf#5201,l_linenumber_prf#5202,l_tax_prf#5203,l_shipdate_prf#5204,l_extendedprice_prf#5205,l_partkey_prf#5206,l_discount_prf#5207,l_partkey_and_l_suppkey_prf#5208,l_commitdate_prf#5209,l_suppkey_prf#5210,l_orderkey_prf#5211] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 88494ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/11 06:13:58 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:13:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5272L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 06:13:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5272L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_1#5284]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#5279: string
         :     :- Project [rid#5274 AS rid_0#5279, n_regionkey_prf#5275 AS n_regionkey_prf_0#5280, n_nationkey_prf#5276 AS n_nationkey_prf_0#5281, n_name_prf#5277 AS n_name_prf_0#5282, n_comment_prf#5278 AS n_comment_prf_0#5283]
         :     :  +- Relation[rid#5274,n_regionkey_prf#5275,n_nationkey_prf#5276,n_name_prf#5277,n_comment_prf#5278] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5285 AS s_phone_prf_1#5293, rid#5286 AS rid_1#5294, s_address_prf#5287 AS s_address_prf_1#5295, s_nationkey_prf#5288 AS s_nationkey_prf_1#5296, s_suppkey_prf#5289 AS s_suppkey_prf_1#5297, s_name_prf#5290 AS s_name_prf_1#5298, s_acctbal_prf#5291 AS s_acctbal_prf_1#5299, s_comment_prf#5292 AS s_comment_prf_1#5300]
            +- Relation[s_phone_prf#5285,rid#5286,s_address_prf#5287,s_nationkey_prf#5288,s_suppkey_prf#5289,s_name_prf#5290,s_acctbal_prf#5291,s_comment_prf#5292] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=10000
Elapsed time: 186ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/11 06:13:58 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:13:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5338L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 06:13:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5338L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1525) AS rid_2#5356]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#5349: string
         :     :- Project [s_phone_prf#5340 AS s_phone_prf_0#5348, rid#5341 AS rid_0#5349, s_address_prf#5342 AS s_address_prf_0#5350, s_nationkey_prf#5343 AS s_nationkey_prf_0#5351, s_suppkey_prf#5344 AS s_suppkey_prf_0#5352, s_name_prf#5345 AS s_name_prf_0#5353, s_acctbal_prf#5346 AS s_acctbal_prf_0#5354, s_comment_prf#5347 AS s_comment_prf_0#5355]
         :     :  +- Relation[s_phone_prf#5340,rid#5341,s_address_prf#5342,s_nationkey_prf#5343,s_suppkey_prf#5344,s_name_prf#5345,s_acctbal_prf#5346,s_comment_prf#5347] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1525) AS rid_2#5377]
            :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#5369: string
            :     :- Project [p_comment_prf#5357 AS p_comment_prf_1#5367, p_name_prf#5358 AS p_name_prf_1#5368, rid#5359 AS rid_1#5369, p_type_prf#5360 AS p_type_prf_1#5370, p_retailprice_prf#5361 AS p_retailprice_prf_1#5371, p_mfgr_prf#5362 AS p_mfgr_prf_1#5372, p_container_prf#5363 AS p_container_prf_1#5373, p_brand_prf#5364 AS p_brand_prf_1#5374, p_size_prf#5365 AS p_size_prf_1#5375, p_partkey_prf#5366 AS p_partkey_prf_1#5376]
            :     :  +- Relation[p_comment_prf#5357,p_name_prf#5358,rid#5359,p_type_prf#5360,p_retailprice_prf#5361,p_mfgr_prf#5362,p_container_prf#5363,p_brand_prf#5364,p_size_prf#5365,p_partkey_prf#5366] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1524,value#1525] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#5378 AS ps_partkey_and_ps_suppkey_prf_2#5385, rid#5379 AS rid_2#5386, ps_availqty_prf#5380 AS ps_availqty_prf_2#5387, ps_comment_prf#5381 AS ps_comment_prf_2#5388, ps_partkey_prf#5382 AS ps_partkey_prf_2#5389, ps_supplycost_prf#5383 AS ps_supplycost_prf_2#5390, ps_suppkey_prf#5384 AS ps_suppkey_prf_2#5391]
               +- Relation[ps_partkey_and_ps_suppkey_prf#5378,rid#5379,ps_availqty_prf#5380,ps_comment_prf#5381,ps_partkey_prf#5382,ps_supplycost_prf#5383,ps_suppkey_prf#5384] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 43837ms
query=b1a, count=15628, duration=395
query=b1b, count=15628, duration=50890
query=b2a, count=1478870, duration=202277
query=b2b, count=1478870, duration=57193
query=f1, count=1, duration=51
query=f2, count=3907, duration=143
query=f3, count=1451, duration=84
query=f4, count=1, duration=57
query=f5, count=1478870, duration=23849
query=f6, count=857401, duration=13838
query=j1, count=800000, duration=32286
query=j10, count=6001215, duration=88494
query=j2, count=800000, duration=11257
query=j3, count=25, duration=72
query=j4, count=150000, duration=1944
query=j5, count=10000, duration=186
query=j6, count=6001215, duration=126122
query=j7, count=1500000, duration=40686
query=j8, count=6001215, duration=199894
query=j8b, count=6001215, duration=131250
query=j9, count=6001215, duration=96575
query=j9b, count=6001215, duration=129829
query=r1a, count=6001215, duration=343825
query=r1b, count=6001215, duration=168541
query=r1c, count=6001215, duration=175719
query=r1d, count=6001215, duration=185684
query=r1e, count=6001215, duration=238653
query=r1f, count=6001215, duration=176815
query=t1a, count=60000414, duration=673643
query=t1b, count=60000414, duration=781792
query=t1c, count=60000414, duration=42824
query=t2a, count=800000, duration=109311
query=t2b, count=800000, duration=94357
query=t2c, count=800000, duration=43837
query=t2d, count=800000, duration=65202
query=t3a, count=6001215, duration=293852
query=t3b, count=6001215, duration=313980
query=t3c, count=6001215, duration=190823
query=t3d, count=6001215, duration=200863
