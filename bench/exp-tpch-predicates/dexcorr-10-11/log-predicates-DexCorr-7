19/10/11 06:14:43 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7203ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Fri Oct 11 06:14:46 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Fri Oct 11 06:14:47 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Fri Oct 11 06:14:47 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Fri Oct 11 06:14:47 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Fri Oct 11 06:14:47 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Fri Oct 11 06:14:49 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Fri Oct 11 06:14:52 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Fri Oct 11 06:14:52 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/11 06:14:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:14:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1483L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 06:14:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1483L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#1497]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#1490: string
         :     :- Project [rid#1485 AS rid_0#1490, n_regionkey_prf#1486 AS n_regionkey_prf_0#1491, n_nationkey_prf#1487 AS n_nationkey_prf_0#1492, n_name_prf#1488 AS n_name_prf_0#1493, n_comment_prf#1489 AS n_comment_prf_0#1494]
         :     :  +- Relation[rid#1485,n_regionkey_prf#1486,n_nationkey_prf#1487,n_name_prf#1488,n_comment_prf#1489] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#1498 AS c_acctbal_prf_1#1507, rid#1499 AS rid_1#1508, c_name_prf#1500 AS c_name_prf_1#1509, c_nationkey_prf#1501 AS c_nationkey_prf_1#1510, c_custkey_prf#1502 AS c_custkey_prf_1#1511, c_comment_prf#1503 AS c_comment_prf_1#1512, c_address_prf#1504 AS c_address_prf_1#1513, c_mktsegment_prf#1505 AS c_mktsegment_prf_1#1514, c_phone_prf#1506 AS c_phone_prf_1#1515]
            +- Relation[c_acctbal_prf#1498,rid#1499,c_name_prf#1500,c_nationkey_prf#1501,c_custkey_prf#1502,c_comment_prf#1503,c_address_prf#1504,c_mktsegment_prf#1505,c_phone_prf#1506] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=150000
Elapsed time: 2135ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/11 06:14:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:14:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1556L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 06:14:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1556L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#1574]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#1567: string
         :     :- Project [s_phone_prf#1558 AS s_phone_prf_0#1566, rid#1559 AS rid_0#1567, s_address_prf#1560 AS s_address_prf_0#1568, s_nationkey_prf#1561 AS s_nationkey_prf_0#1569, s_suppkey_prf#1562 AS s_suppkey_prf_0#1570, s_name_prf#1563 AS s_name_prf_0#1571, s_acctbal_prf#1564 AS s_acctbal_prf_0#1572, s_comment_prf#1565 AS s_comment_prf_0#1573]
         :     :  +- Relation[s_phone_prf#1558,rid#1559,s_address_prf#1560,s_nationkey_prf#1561,s_suppkey_prf#1562,s_name_prf#1563,s_acctbal_prf#1564,s_comment_prf#1565] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1575 AS l_returnflag_prf_1#1594, l_orderkey_and_l_linenumber_prf#1576 AS l_orderkey_and_l_linenumber_prf_1#1595, l_comment_prf#1577 AS l_comment_prf_1#1596, l_linestatus_prf#1578 AS l_linestatus_prf_1#1597, rid#1579 AS rid_1#1598, l_shipmode_prf#1580 AS l_shipmode_prf_1#1599, l_shipinstruct_prf#1581 AS l_shipinstruct_prf_1#1600, l_quantity_prf#1582 AS l_quantity_prf_1#1601, l_receiptdate_prf#1583 AS l_receiptdate_prf_1#1602, l_linenumber_prf#1584 AS l_linenumber_prf_1#1603, l_tax_prf#1585 AS l_tax_prf_1#1604, l_shipdate_prf#1586 AS l_shipdate_prf_1#1605, l_extendedprice_prf#1587 AS l_extendedprice_prf_1#1606, l_partkey_prf#1588 AS l_partkey_prf_1#1607, l_discount_prf#1589 AS l_discount_prf_1#1608, l_partkey_and_l_suppkey_prf#1590 AS l_partkey_and_l_suppkey_prf_1#1609, l_commitdate_prf#1591 AS l_commitdate_prf_1#1610, l_suppkey_prf#1592 AS l_suppkey_prf_1#1611, l_orderkey_prf#1593 AS l_orderkey_prf_1#1612]
            +- Relation[l_returnflag_prf#1575,l_orderkey_and_l_linenumber_prf#1576,l_comment_prf#1577,l_linestatus_prf#1578,rid#1579,l_shipmode_prf#1580,l_shipinstruct_prf#1581,l_quantity_prf#1582,l_receiptdate_prf#1583,l_linenumber_prf#1584,l_tax_prf#1585,l_shipdate_prf#1586,l_extendedprice_prf#1587,l_partkey_prf#1588,l_discount_prf#1589,l_partkey_and_l_suppkey_prf#1590,l_commitdate_prf#1591,l_suppkey_prf#1592,l_orderkey_prf#1593] JDBCRelation(lineitem_prf) [numPartitions=1]

19/10/11 06:14:55 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=6001215
Elapsed time: 88433ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/11 06:16:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:16:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1675L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 06:16:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1675L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#1697]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#1689: string
         :     :  :     :- Project [p_comment_prf#1677 AS p_comment_prf_0#1687, p_name_prf#1678 AS p_name_prf_0#1688, rid#1679 AS rid_0#1689, p_type_prf#1680 AS p_type_prf_0#1690, p_retailprice_prf#1681 AS p_retailprice_prf_0#1691, p_mfgr_prf#1682 AS p_mfgr_prf_0#1692, p_container_prf#1683 AS p_container_prf_0#1693, p_brand_prf#1684 AS p_brand_prf_0#1694, p_size_prf#1685 AS p_size_prf_0#1695, p_partkey_prf#1686 AS p_partkey_prf_0#1696]
         :     :  :     :  +- Relation[p_comment_prf#1677,p_name_prf#1678,rid#1679,p_type_prf#1680,p_retailprice_prf#1681,p_mfgr_prf#1682,p_container_prf#1683,p_brand_prf#1684,p_size_prf#1685,p_partkey_prf#1686] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#1698 AS l_returnflag_prf_1#1717, l_orderkey_and_l_linenumber_prf#1699 AS l_orderkey_and_l_linenumber_prf_1#1718, l_comment_prf#1700 AS l_comment_prf_1#1719, l_linestatus_prf#1701 AS l_linestatus_prf_1#1720, rid#1702 AS rid_1#1721, l_shipmode_prf#1703 AS l_shipmode_prf_1#1722, l_shipinstruct_prf#1704 AS l_shipinstruct_prf_1#1723, l_quantity_prf#1705 AS l_quantity_prf_1#1724, l_receiptdate_prf#1706 AS l_receiptdate_prf_1#1725, l_linenumber_prf#1707 AS l_linenumber_prf_1#1726, l_tax_prf#1708 AS l_tax_prf_1#1727, l_shipdate_prf#1709 AS l_shipdate_prf_1#1728, l_extendedprice_prf#1710 AS l_extendedprice_prf_1#1729, l_partkey_prf#1711 AS l_partkey_prf_1#1730, l_discount_prf#1712 AS l_discount_prf_1#1731, l_partkey_and_l_suppkey_prf#1713 AS l_partkey_and_l_suppkey_prf_1#1732, l_commitdate_prf#1714 AS l_commitdate_prf_1#1733, l_suppkey_prf#1715 AS l_suppkey_prf_1#1734, l_orderkey_prf#1716 AS l_orderkey_prf_1#1735]
         :     :     +- Relation[l_returnflag_prf#1698,l_orderkey_and_l_linenumber_prf#1699,l_comment_prf#1700,l_linestatus_prf#1701,rid#1702,l_shipmode_prf#1703,l_shipinstruct_prf#1704,l_quantity_prf#1705,l_receiptdate_prf#1706,l_linenumber_prf#1707,l_tax_prf#1708,l_shipdate_prf#1709,l_extendedprice_prf#1710,l_partkey_prf#1711,l_discount_prf#1712,l_partkey_and_l_suppkey_prf#1713,l_commitdate_prf#1714,l_suppkey_prf#1715,l_orderkey_prf#1716] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#1737 AS s_phone_prf_2#1745, rid#1738 AS rid_2#1746, s_address_prf#1739 AS s_address_prf_2#1747, s_nationkey_prf#1740 AS s_nationkey_prf_2#1748, s_suppkey_prf#1741 AS s_suppkey_prf_2#1749, s_name_prf#1742 AS s_name_prf_2#1750, s_acctbal_prf#1743 AS s_acctbal_prf_2#1751, s_comment_prf#1744 AS s_comment_prf_2#1752]
            +- Relation[s_phone_prf#1737,rid#1738,s_address_prf#1739,s_nationkey_prf#1740,s_suppkey_prf#1741,s_name_prf#1742,s_acctbal_prf#1743,s_comment_prf#1744] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 312812ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/11 06:21:36 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:21:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1818L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 06:21:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1818L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#1861]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#1843: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#1820 AS l_returnflag_prf_0#1839, l_orderkey_and_l_linenumber_prf#1821 AS l_orderkey_and_l_linenumber_prf_0#1840, l_comment_prf#1822 AS l_comment_prf_0#1841, l_linestatus_prf#1823 AS l_linestatus_prf_0#1842, rid#1824 AS rid_0#1843, l_shipmode_prf#1825 AS l_shipmode_prf_0#1844, l_shipinstruct_prf#1826 AS l_shipinstruct_prf_0#1845, l_quantity_prf#1827 AS l_quantity_prf_0#1846, l_receiptdate_prf#1828 AS l_receiptdate_prf_0#1847, l_linenumber_prf#1829 AS l_linenumber_prf_0#1848, l_tax_prf#1830 AS l_tax_prf_0#1849, l_shipdate_prf#1831 AS l_shipdate_prf_0#1850, l_extendedprice_prf#1832 AS l_extendedprice_prf_0#1851, l_partkey_prf#1833 AS l_partkey_prf_0#1852, l_discount_prf#1834 AS l_discount_prf_0#1853, l_partkey_and_l_suppkey_prf#1835 AS l_partkey_and_l_suppkey_prf_0#1854, l_commitdate_prf#1836 AS l_commitdate_prf_0#1855, l_suppkey_prf#1837 AS l_suppkey_prf_0#1856, l_orderkey_prf#1838 AS l_orderkey_prf_0#1857]
         :     :  :  +- Relation[l_returnflag_prf#1820,l_orderkey_and_l_linenumber_prf#1821,l_comment_prf#1822,l_linestatus_prf#1823,rid#1824,l_shipmode_prf#1825,l_shipinstruct_prf#1826,l_quantity_prf#1827,l_receiptdate_prf#1828,l_linenumber_prf#1829,l_tax_prf#1830,l_shipdate_prf#1831,l_extendedprice_prf#1832,l_partkey_prf#1833,l_discount_prf#1834,l_partkey_and_l_suppkey_prf#1835,l_commitdate_prf#1836,l_suppkey_prf#1837,l_orderkey_prf#1838] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1860]
         :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :        +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#1862 AS o_shippriority_prf_1#1872, rid#1863 AS rid_1#1873, o_orderdate_prf#1864 AS o_orderdate_prf_1#1874, o_custkey_prf#1865 AS o_custkey_prf_1#1875, o_orderpriority_prf#1866 AS o_orderpriority_prf_1#1876, o_clerk_prf#1867 AS o_clerk_prf_1#1877, o_orderstatus_prf#1868 AS o_orderstatus_prf_1#1878, o_totalprice_prf#1869 AS o_totalprice_prf_1#1879, o_orderkey_prf#1870 AS o_orderkey_prf_1#1880, o_comment_prf#1871 AS o_comment_prf_1#1881]
            +- Relation[o_shippriority_prf#1862,rid#1863,o_orderdate_prf#1864,o_custkey_prf#1865,o_orderpriority_prf#1866,o_clerk_prf#1867,o_orderstatus_prf#1868,o_totalprice_prf#1869,o_orderkey_prf#1870,o_comment_prf#1871] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 57291ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/11 06:22:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:22:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1931L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 06:22:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1931L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#1951]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#1943: string
         :     :- Project [c_acctbal_prf#1933 AS c_acctbal_prf_0#1942, rid#1934 AS rid_0#1943, c_name_prf#1935 AS c_name_prf_0#1944, c_nationkey_prf#1936 AS c_nationkey_prf_0#1945, c_custkey_prf#1937 AS c_custkey_prf_0#1946, c_comment_prf#1938 AS c_comment_prf_0#1947, c_address_prf#1939 AS c_address_prf_0#1948, c_mktsegment_prf#1940 AS c_mktsegment_prf_0#1949, c_phone_prf#1941 AS c_phone_prf_0#1950]
         :     :  +- Relation[c_acctbal_prf#1933,rid#1934,c_name_prf#1935,c_nationkey_prf#1936,c_custkey_prf#1937,c_comment_prf#1938,c_address_prf#1939,c_mktsegment_prf#1940,c_phone_prf#1941] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#1952 AS o_shippriority_prf_1#1962, rid#1953 AS rid_1#1963, o_orderdate_prf#1954 AS o_orderdate_prf_1#1964, o_custkey_prf#1955 AS o_custkey_prf_1#1965, o_orderpriority_prf#1956 AS o_orderpriority_prf_1#1966, o_clerk_prf#1957 AS o_clerk_prf_1#1967, o_orderstatus_prf#1958 AS o_orderstatus_prf_1#1968, o_totalprice_prf#1959 AS o_totalprice_prf_1#1969, o_orderkey_prf#1960 AS o_orderkey_prf_1#1970, o_comment_prf#1961 AS o_comment_prf_1#1971]
            +- Relation[o_shippriority_prf#1952,rid#1953,o_orderdate_prf#1954,o_custkey_prf#1955,o_orderpriority_prf#1956,o_clerk_prf#1957,o_orderstatus_prf#1958,o_totalprice_prf#1959,o_orderkey_prf#1960,o_comment_prf#1961] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1500000
Elapsed time: 40618ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/11 06:23:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:23:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2027L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 06:23:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2027L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_2#2047]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2039: string
         :     :- Project [c_acctbal_prf#2029 AS c_acctbal_prf_0#2038, rid#2030 AS rid_0#2039, c_name_prf#2031 AS c_name_prf_0#2040, c_nationkey_prf#2032 AS c_nationkey_prf_0#2041, c_custkey_prf#2033 AS c_custkey_prf_0#2042, c_comment_prf#2034 AS c_comment_prf_0#2043, c_address_prf#2035 AS c_address_prf_0#2044, c_mktsegment_prf#2036 AS c_mktsegment_prf_0#2045, c_phone_prf#2037 AS c_phone_prf_0#2046]
         :     :  +- Relation[c_acctbal_prf#2029,rid#2030,c_name_prf#2031,c_nationkey_prf#2032,c_custkey_prf#2033,c_comment_prf#2034,c_address_prf#2035,c_mktsegment_prf#2036,c_phone_prf#2037] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1496) AS rid_2#2086]
            :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_1#2071: string
            :     :- Project [l_returnflag_prf#2048 AS l_returnflag_prf_1#2067, l_orderkey_and_l_linenumber_prf#2049 AS l_orderkey_and_l_linenumber_prf_1#2068, l_comment_prf#2050 AS l_comment_prf_1#2069, l_linestatus_prf#2051 AS l_linestatus_prf_1#2070, rid#2052 AS rid_1#2071, l_shipmode_prf#2053 AS l_shipmode_prf_1#2072, l_shipinstruct_prf#2054 AS l_shipinstruct_prf_1#2073, l_quantity_prf#2055 AS l_quantity_prf_1#2074, l_receiptdate_prf#2056 AS l_receiptdate_prf_1#2075, l_linenumber_prf#2057 AS l_linenumber_prf_1#2076, l_tax_prf#2058 AS l_tax_prf_1#2077, l_shipdate_prf#2059 AS l_shipdate_prf_1#2078, l_extendedprice_prf#2060 AS l_extendedprice_prf_1#2079, l_partkey_prf#2061 AS l_partkey_prf_1#2080, l_discount_prf#2062 AS l_discount_prf_1#2081, l_partkey_and_l_suppkey_prf#2063 AS l_partkey_and_l_suppkey_prf_1#2082, l_commitdate_prf#2064 AS l_commitdate_prf_1#2083, l_suppkey_prf#2065 AS l_suppkey_prf_1#2084, l_orderkey_prf#2066 AS l_orderkey_prf_1#2085]
            :     :  +- Relation[l_returnflag_prf#2048,l_orderkey_and_l_linenumber_prf#2049,l_comment_prf#2050,l_linestatus_prf#2051,rid#2052,l_shipmode_prf#2053,l_shipinstruct_prf#2054,l_quantity_prf#2055,l_receiptdate_prf#2056,l_linenumber_prf#2057,l_tax_prf#2058,l_shipdate_prf#2059,l_extendedprice_prf#2060,l_partkey_prf#2061,l_discount_prf#2062,l_partkey_and_l_suppkey_prf#2063,l_commitdate_prf#2064,l_suppkey_prf#2065,l_orderkey_prf#2066] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2087 AS o_shippriority_prf_2#2097, rid#2088 AS rid_2#2098, o_orderdate_prf#2089 AS o_orderdate_prf_2#2099, o_custkey_prf#2090 AS o_custkey_prf_2#2100, o_orderpriority_prf#2091 AS o_orderpriority_prf_2#2101, o_clerk_prf#2092 AS o_clerk_prf_2#2102, o_orderstatus_prf#2093 AS o_orderstatus_prf_2#2103, o_totalprice_prf#2094 AS o_totalprice_prf_2#2104, o_orderkey_prf#2095 AS o_orderkey_prf_2#2105, o_comment_prf#2096 AS o_comment_prf_2#2106]
               +- Relation[o_shippriority_prf#2087,rid#2088,o_orderdate_prf#2089,o_custkey_prf#2090,o_orderpriority_prf#2091,o_clerk_prf#2092,o_orderstatus_prf#2093,o_totalprice_prf#2094,o_orderkey_prf#2095,o_comment_prf#2096] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 175396ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/11 06:26:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:26:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2162L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 06:26:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2162L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#2185]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2176: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#2164 AS p_comment_prf_0#2174, p_name_prf#2165 AS p_name_prf_0#2175, rid#2166 AS rid_0#2176, p_type_prf#2167 AS p_type_prf_0#2177, p_retailprice_prf#2168 AS p_retailprice_prf_0#2178, p_mfgr_prf#2169 AS p_mfgr_prf_0#2179, p_container_prf#2170 AS p_container_prf_0#2180, p_brand_prf#2171 AS p_brand_prf_0#2181, p_size_prf#2172 AS p_size_prf_0#2182, p_partkey_prf#2173 AS p_partkey_prf_0#2183]
         :     :  :  +- Relation[p_comment_prf#2164,p_name_prf#2165,rid#2166,p_type_prf#2167,p_retailprice_prf#2168,p_mfgr_prf#2169,p_container_prf#2170,p_brand_prf#2171,p_size_prf#2172,p_partkey_prf#2173] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2184]
         :     :     +- DexRidFilter part~p_size~15
         :     :        +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2186 AS ps_partkey_and_ps_suppkey_prf_1#2193, rid#2187 AS rid_1#2194, ps_availqty_prf#2188 AS ps_availqty_prf_1#2195, ps_comment_prf#2189 AS ps_comment_prf_1#2196, ps_partkey_prf#2190 AS ps_partkey_prf_1#2197, ps_supplycost_prf#2191 AS ps_supplycost_prf_1#2198, ps_suppkey_prf#2192 AS ps_suppkey_prf_1#2199]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2186,rid#2187,ps_availqty_prf#2188,ps_comment_prf#2189,ps_partkey_prf#2190,ps_supplycost_prf#2191,ps_suppkey_prf#2192] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 393ms

f1=
select * from region where r_name = 'EUROPE'
19/10/11 06:26:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:26:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2223L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/11 06:26:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2223L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#2225 AS r_regionkey_prf_0#2229, r_name_prf#2226 AS r_name_prf_0#2230, r_comment_prf#2227 AS r_comment_prf_0#2231, rid#2228 AS rid_0#2232]
         :  +- Relation[r_regionkey_prf#2225,r_name_prf#2226,r_comment_prf#2227,rid#2228] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2233]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 54ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/11 06:26:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:26:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2262L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 06:26:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2262L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1496) AS rid_2#2299]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#2284]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2276: string
         :     :  :     :- Project [p_comment_prf#2264 AS p_comment_prf_0#2274, p_name_prf#2265 AS p_name_prf_0#2275, rid#2266 AS rid_0#2276, p_type_prf#2267 AS p_type_prf_0#2277, p_retailprice_prf#2268 AS p_retailprice_prf_0#2278, p_mfgr_prf#2269 AS p_mfgr_prf_0#2279, p_container_prf#2270 AS p_container_prf_0#2280, p_brand_prf#2271 AS p_brand_prf_0#2281, p_size_prf#2272 AS p_size_prf_0#2282, p_partkey_prf#2273 AS p_partkey_prf_0#2283]
         :     :  :     :  +- Relation[p_comment_prf#2264,p_name_prf#2265,rid#2266,p_type_prf#2267,p_retailprice_prf#2268,p_mfgr_prf#2269,p_container_prf#2270,p_brand_prf#2271,p_size_prf#2272,p_partkey_prf#2273] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#2285 AS ps_partkey_and_ps_suppkey_prf_1#2292, rid#2286 AS rid_1#2293, ps_availqty_prf#2287 AS ps_availqty_prf_1#2294, ps_comment_prf#2288 AS ps_comment_prf_1#2295, ps_partkey_prf#2289 AS ps_partkey_prf_1#2296, ps_supplycost_prf#2290 AS ps_supplycost_prf_1#2297, ps_suppkey_prf#2291 AS ps_suppkey_prf_1#2298]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#2285,rid#2286,ps_availqty_prf#2287,ps_comment_prf#2288,ps_partkey_prf#2289,ps_supplycost_prf#2290,ps_suppkey_prf#2291] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2300 AS s_phone_prf_2#2308, rid#2301 AS rid_2#2309, s_address_prf#2302 AS s_address_prf_2#2310, s_nationkey_prf#2303 AS s_nationkey_prf_2#2311, s_suppkey_prf#2304 AS s_suppkey_prf_2#2312, s_name_prf#2305 AS s_name_prf_2#2313, s_acctbal_prf#2306 AS s_acctbal_prf_2#2314, s_comment_prf#2307 AS s_comment_prf_2#2315]
            +- Relation[s_phone_prf#2300,rid#2301,s_address_prf#2302,s_nationkey_prf#2303,s_suppkey_prf#2304,s_name_prf#2305,s_acctbal_prf#2306,s_comment_prf#2307] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 94388ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/11 06:27:44 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:27:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2360L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 06:27:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2360L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#2362 AS l_returnflag_prf_0#2381, l_orderkey_and_l_linenumber_prf#2363 AS l_orderkey_and_l_linenumber_prf_0#2382, l_comment_prf#2364 AS l_comment_prf_0#2383, l_linestatus_prf#2365 AS l_linestatus_prf_0#2384, rid#2366 AS rid_0#2385, l_shipmode_prf#2367 AS l_shipmode_prf_0#2386, l_shipinstruct_prf#2368 AS l_shipinstruct_prf_0#2387, l_quantity_prf#2369 AS l_quantity_prf_0#2388, l_receiptdate_prf#2370 AS l_receiptdate_prf_0#2389, l_linenumber_prf#2371 AS l_linenumber_prf_0#2390, l_tax_prf#2372 AS l_tax_prf_0#2391, l_shipdate_prf#2373 AS l_shipdate_prf_0#2392, l_extendedprice_prf#2374 AS l_extendedprice_prf_0#2393, l_partkey_prf#2375 AS l_partkey_prf_0#2394, l_discount_prf#2376 AS l_discount_prf_0#2395, l_partkey_and_l_suppkey_prf#2377 AS l_partkey_and_l_suppkey_prf_0#2396, l_commitdate_prf#2378 AS l_commitdate_prf_0#2397, l_suppkey_prf#2379 AS l_suppkey_prf_0#2398, l_orderkey_prf#2380 AS l_orderkey_prf_0#2399]
         :  +- Relation[l_returnflag_prf#2362,l_orderkey_and_l_linenumber_prf#2363,l_comment_prf#2364,l_linestatus_prf#2365,rid#2366,l_shipmode_prf#2367,l_shipinstruct_prf#2368,l_quantity_prf#2369,l_receiptdate_prf#2370,l_linenumber_prf#2371,l_tax_prf#2372,l_shipdate_prf#2373,l_extendedprice_prf#2374,l_partkey_prf#2375,l_discount_prf#2376,l_partkey_and_l_suppkey_prf#2377,l_commitdate_prf#2378,l_suppkey_prf#2379,l_orderkey_prf#2380] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2400]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 23776ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/11 06:28:08 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:28:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2455L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 06:28:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2455L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#2495]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#2480: string
         :     :  :     :- Project [l_returnflag_prf#2457 AS l_returnflag_prf_0#2476, l_orderkey_and_l_linenumber_prf#2458 AS l_orderkey_and_l_linenumber_prf_0#2477, l_comment_prf#2459 AS l_comment_prf_0#2478, l_linestatus_prf#2460 AS l_linestatus_prf_0#2479, rid#2461 AS rid_0#2480, l_shipmode_prf#2462 AS l_shipmode_prf_0#2481, l_shipinstruct_prf#2463 AS l_shipinstruct_prf_0#2482, l_quantity_prf#2464 AS l_quantity_prf_0#2483, l_receiptdate_prf#2465 AS l_receiptdate_prf_0#2484, l_linenumber_prf#2466 AS l_linenumber_prf_0#2485, l_tax_prf#2467 AS l_tax_prf_0#2486, l_shipdate_prf#2468 AS l_shipdate_prf_0#2487, l_extendedprice_prf#2469 AS l_extendedprice_prf_0#2488, l_partkey_prf#2470 AS l_partkey_prf_0#2489, l_discount_prf#2471 AS l_discount_prf_0#2490, l_partkey_and_l_suppkey_prf#2472 AS l_partkey_and_l_suppkey_prf_0#2491, l_commitdate_prf#2473 AS l_commitdate_prf_0#2492, l_suppkey_prf#2474 AS l_suppkey_prf_0#2493, l_orderkey_prf#2475 AS l_orderkey_prf_0#2494]
         :     :  :     :  +- Relation[l_returnflag_prf#2457,l_orderkey_and_l_linenumber_prf#2458,l_comment_prf#2459,l_linestatus_prf#2460,rid#2461,l_shipmode_prf#2462,l_shipinstruct_prf#2463,l_quantity_prf#2464,l_receiptdate_prf#2465,l_linenumber_prf#2466,l_tax_prf#2467,l_shipdate_prf#2468,l_extendedprice_prf#2469,l_partkey_prf#2470,l_discount_prf#2471,l_partkey_and_l_suppkey_prf#2472,l_commitdate_prf#2473,l_suppkey_prf#2474,l_orderkey_prf#2475] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#2496 AS p_comment_prf_1#2506, p_name_prf#2497 AS p_name_prf_1#2507, rid#2498 AS rid_1#2508, p_type_prf#2499 AS p_type_prf_1#2509, p_retailprice_prf#2500 AS p_retailprice_prf_1#2510, p_mfgr_prf#2501 AS p_mfgr_prf_1#2511, p_container_prf#2502 AS p_container_prf_1#2512, p_brand_prf#2503 AS p_brand_prf_1#2513, p_size_prf#2504 AS p_size_prf_1#2514, p_partkey_prf#2505 AS p_partkey_prf_1#2515]
         :     :     +- Relation[p_comment_prf#2496,p_name_prf#2497,rid#2498,p_type_prf#2499,p_retailprice_prf#2500,p_mfgr_prf#2501,p_container_prf#2502,p_brand_prf#2503,p_size_prf#2504,p_partkey_prf#2505] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2517 AS s_phone_prf_2#2525, rid#2518 AS rid_2#2526, s_address_prf#2519 AS s_address_prf_2#2527, s_nationkey_prf#2520 AS s_nationkey_prf_2#2528, s_suppkey_prf#2521 AS s_suppkey_prf_2#2529, s_name_prf#2522 AS s_name_prf_2#2530, s_acctbal_prf#2523 AS s_acctbal_prf_2#2531, s_comment_prf#2524 AS s_comment_prf_2#2532]
            +- Relation[s_phone_prf#2517,rid#2518,s_address_prf#2519,s_nationkey_prf#2520,s_suppkey_prf#2521,s_name_prf#2522,s_acctbal_prf#2523,s_comment_prf#2524] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 293783ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/11 06:33:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:33:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2594L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 06:33:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2594L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#2610]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, rid_0#2604: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#2596 AS ps_partkey_and_ps_suppkey_prf_0#2603, rid#2597 AS rid_0#2604, ps_availqty_prf#2598 AS ps_availqty_prf_0#2605, ps_comment_prf#2599 AS ps_comment_prf_0#2606, ps_partkey_prf#2600 AS ps_partkey_prf_0#2607, ps_supplycost_prf#2601 AS ps_supplycost_prf_0#2608, ps_suppkey_prf#2602 AS ps_suppkey_prf_0#2609]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2596,rid#2597,ps_availqty_prf#2598,ps_comment_prf#2599,ps_partkey_prf#2600,ps_supplycost_prf#2601,ps_suppkey_prf#2602] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2611 AS l_returnflag_prf_1#2630, l_orderkey_and_l_linenumber_prf#2612 AS l_orderkey_and_l_linenumber_prf_1#2631, l_comment_prf#2613 AS l_comment_prf_1#2632, l_linestatus_prf#2614 AS l_linestatus_prf_1#2633, rid#2615 AS rid_1#2634, l_shipmode_prf#2616 AS l_shipmode_prf_1#2635, l_shipinstruct_prf#2617 AS l_shipinstruct_prf_1#2636, l_quantity_prf#2618 AS l_quantity_prf_1#2637, l_receiptdate_prf#2619 AS l_receiptdate_prf_1#2638, l_linenumber_prf#2620 AS l_linenumber_prf_1#2639, l_tax_prf#2621 AS l_tax_prf_1#2640, l_shipdate_prf#2622 AS l_shipdate_prf_1#2641, l_extendedprice_prf#2623 AS l_extendedprice_prf_1#2642, l_partkey_prf#2624 AS l_partkey_prf_1#2643, l_discount_prf#2625 AS l_discount_prf_1#2644, l_partkey_and_l_suppkey_prf#2626 AS l_partkey_and_l_suppkey_prf_1#2645, l_commitdate_prf#2627 AS l_commitdate_prf_1#2646, l_suppkey_prf#2628 AS l_suppkey_prf_1#2647, l_orderkey_prf#2629 AS l_orderkey_prf_1#2648]
            +- Relation[l_returnflag_prf#2611,l_orderkey_and_l_linenumber_prf#2612,l_comment_prf#2613,l_linestatus_prf#2614,rid#2615,l_shipmode_prf#2616,l_shipinstruct_prf#2617,l_quantity_prf#2618,l_receiptdate_prf#2619,l_linenumber_prf#2620,l_tax_prf#2621,l_shipdate_prf#2622,l_extendedprice_prf#2623,l_partkey_prf#2624,l_discount_prf#2625,l_partkey_and_l_suppkey_prf#2626,l_commitdate_prf#2627,l_suppkey_prf#2628,l_orderkey_prf#2629] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 117990ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/11 06:35:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:35:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2685L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 06:35:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2685L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#2695]
         :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#2694: string
         :     :- Project [r_regionkey_prf#2687 AS r_regionkey_prf_0#2691, r_name_prf#2688 AS r_name_prf_0#2692, r_comment_prf#2689 AS r_comment_prf_0#2693, rid#2690 AS rid_0#2694]
         :     :  +- Relation[r_regionkey_prf#2687,r_name_prf#2688,r_comment_prf#2689,rid#2690] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#2696 AS rid_1#2701, n_regionkey_prf#2697 AS n_regionkey_prf_1#2702, n_nationkey_prf#2698 AS n_nationkey_prf_1#2703, n_name_prf#2699 AS n_name_prf_1#2704, n_comment_prf#2700 AS n_comment_prf_1#2705]
            +- Relation[rid#2696,n_regionkey_prf#2697,n_nationkey_prf#2698,n_name_prf#2699,n_comment_prf#2700] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=25
Elapsed time: 76ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/11 06:35:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:35:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2739L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 06:35:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2739L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1496) AS rid_2#2776]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#2755]
         :     :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#2749: string
         :     :  :     :- Project [ps_partkey_and_ps_suppkey_prf#2741 AS ps_partkey_and_ps_suppkey_prf_0#2748, rid#2742 AS rid_0#2749, ps_availqty_prf#2743 AS ps_availqty_prf_0#2750, ps_comment_prf#2744 AS ps_comment_prf_0#2751, ps_partkey_prf#2745 AS ps_partkey_prf_0#2752, ps_supplycost_prf#2746 AS ps_supplycost_prf_0#2753, ps_suppkey_prf#2747 AS ps_suppkey_prf_0#2754]
         :     :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2741,rid#2742,ps_availqty_prf#2743,ps_comment_prf#2744,ps_partkey_prf#2745,ps_supplycost_prf#2746,ps_suppkey_prf#2747] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#2756 AS p_comment_prf_1#2766, p_name_prf#2757 AS p_name_prf_1#2767, rid#2758 AS rid_1#2768, p_type_prf#2759 AS p_type_prf_1#2769, p_retailprice_prf#2760 AS p_retailprice_prf_1#2770, p_mfgr_prf#2761 AS p_mfgr_prf_1#2771, p_container_prf#2762 AS p_container_prf_1#2772, p_brand_prf#2763 AS p_brand_prf_1#2773, p_size_prf#2764 AS p_size_prf_1#2774, p_partkey_prf#2765 AS p_partkey_prf_1#2775]
         :     :     +- Relation[p_comment_prf#2756,p_name_prf#2757,rid#2758,p_type_prf#2759,p_retailprice_prf#2760,p_mfgr_prf#2761,p_container_prf#2762,p_brand_prf#2763,p_size_prf#2764,p_partkey_prf#2765] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2777 AS s_phone_prf_2#2785, rid#2778 AS rid_2#2786, s_address_prf#2779 AS s_address_prf_2#2787, s_nationkey_prf#2780 AS s_nationkey_prf_2#2788, s_suppkey_prf#2781 AS s_suppkey_prf_2#2789, s_name_prf#2782 AS s_name_prf_2#2790, s_acctbal_prf#2783 AS s_acctbal_prf_2#2791, s_comment_prf#2784 AS s_comment_prf_2#2792]
            +- Relation[s_phone_prf#2777,rid#2778,s_address_prf#2779,s_nationkey_prf#2780,s_suppkey_prf#2781,s_name_prf#2782,s_acctbal_prf#2783,s_comment_prf#2784] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 109041ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/11 06:36:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:36:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2854L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 06:36:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2854L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#2894]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2879: string
         :     :- Project [l_returnflag_prf#2856 AS l_returnflag_prf_0#2875, l_orderkey_and_l_linenumber_prf#2857 AS l_orderkey_and_l_linenumber_prf_0#2876, l_comment_prf#2858 AS l_comment_prf_0#2877, l_linestatus_prf#2859 AS l_linestatus_prf_0#2878, rid#2860 AS rid_0#2879, l_shipmode_prf#2861 AS l_shipmode_prf_0#2880, l_shipinstruct_prf#2862 AS l_shipinstruct_prf_0#2881, l_quantity_prf#2863 AS l_quantity_prf_0#2882, l_receiptdate_prf#2864 AS l_receiptdate_prf_0#2883, l_linenumber_prf#2865 AS l_linenumber_prf_0#2884, l_tax_prf#2866 AS l_tax_prf_0#2885, l_shipdate_prf#2867 AS l_shipdate_prf_0#2886, l_extendedprice_prf#2868 AS l_extendedprice_prf_0#2887, l_partkey_prf#2869 AS l_partkey_prf_0#2888, l_discount_prf#2870 AS l_discount_prf_0#2889, l_partkey_and_l_suppkey_prf#2871 AS l_partkey_and_l_suppkey_prf_0#2890, l_commitdate_prf#2872 AS l_commitdate_prf_0#2891, l_suppkey_prf#2873 AS l_suppkey_prf_0#2892, l_orderkey_prf#2874 AS l_orderkey_prf_0#2893]
         :     :  +- Relation[l_returnflag_prf#2856,l_orderkey_and_l_linenumber_prf#2857,l_comment_prf#2858,l_linestatus_prf#2859,rid#2860,l_shipmode_prf#2861,l_shipinstruct_prf#2862,l_quantity_prf#2863,l_receiptdate_prf#2864,l_linenumber_prf#2865,l_tax_prf#2866,l_shipdate_prf#2867,l_extendedprice_prf#2868,l_partkey_prf#2869,l_discount_prf#2870,l_partkey_and_l_suppkey_prf#2871,l_commitdate_prf#2872,l_suppkey_prf#2873,l_orderkey_prf#2874] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1496) AS rid_2#2915]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#2906: string
            :     :- Project [o_shippriority_prf#2895 AS o_shippriority_prf_1#2905, rid#2896 AS rid_1#2906, o_orderdate_prf#2897 AS o_orderdate_prf_1#2907, o_custkey_prf#2898 AS o_custkey_prf_1#2908, o_orderpriority_prf#2899 AS o_orderpriority_prf_1#2909, o_clerk_prf#2900 AS o_clerk_prf_1#2910, o_orderstatus_prf#2901 AS o_orderstatus_prf_1#2911, o_totalprice_prf#2902 AS o_totalprice_prf_1#2912, o_orderkey_prf#2903 AS o_orderkey_prf_1#2913, o_comment_prf#2904 AS o_comment_prf_1#2914]
            :     :  +- Relation[o_shippriority_prf#2895,rid#2896,o_orderdate_prf#2897,o_custkey_prf#2898,o_orderpriority_prf#2899,o_clerk_prf#2900,o_orderstatus_prf#2901,o_totalprice_prf#2902,o_orderkey_prf#2903,o_comment_prf#2904] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#2916 AS c_acctbal_prf_2#2925, rid#2917 AS rid_2#2926, c_name_prf#2918 AS c_name_prf_2#2927, c_nationkey_prf#2919 AS c_nationkey_prf_2#2928, c_custkey_prf#2920 AS c_custkey_prf_2#2929, c_comment_prf#2921 AS c_comment_prf_2#2930, c_address_prf#2922 AS c_address_prf_2#2931, c_mktsegment_prf#2923 AS c_mktsegment_prf_2#2932, c_phone_prf#2924 AS c_phone_prf_2#2933]
               +- Relation[c_acctbal_prf#2916,rid#2917,c_name_prf#2918,c_nationkey_prf#2919,c_custkey_prf#2920,c_comment_prf#2921,c_address_prf#2922,c_mktsegment_prf#2923,c_phone_prf#2924] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 168570ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/11 06:39:38 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:39:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2979L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 06:39:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2979L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#2981 AS rid_0#2986, n_regionkey_prf#2982 AS n_regionkey_prf_0#2987, n_nationkey_prf#2983 AS n_nationkey_prf_0#2988, n_name_prf#2984 AS n_name_prf_0#2989, n_comment_prf#2985 AS n_comment_prf_0#2990]
         :  +- Relation[rid#2981,n_regionkey_prf#2982,n_nationkey_prf#2983,n_name_prf#2984,n_comment_prf#2985] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2991]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 55ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/11 06:39:38 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:39:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3033L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 06:39:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3033L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#3053]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3045: string
         :     :- Project [c_acctbal_prf#3035 AS c_acctbal_prf_0#3044, rid#3036 AS rid_0#3045, c_name_prf#3037 AS c_name_prf_0#3046, c_nationkey_prf#3038 AS c_nationkey_prf_0#3047, c_custkey_prf#3039 AS c_custkey_prf_0#3048, c_comment_prf#3040 AS c_comment_prf_0#3049, c_address_prf#3041 AS c_address_prf_0#3050, c_mktsegment_prf#3042 AS c_mktsegment_prf_0#3051, c_phone_prf#3043 AS c_phone_prf_0#3052]
         :     :  +- Relation[c_acctbal_prf#3035,rid#3036,c_name_prf#3037,c_nationkey_prf#3038,c_custkey_prf#3039,c_comment_prf#3040,c_address_prf#3041,c_mktsegment_prf#3042,c_phone_prf#3043] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1496) AS rid_2#3074]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#3065: string
            :     :- Project [o_shippriority_prf#3054 AS o_shippriority_prf_1#3064, rid#3055 AS rid_1#3065, o_orderdate_prf#3056 AS o_orderdate_prf_1#3066, o_custkey_prf#3057 AS o_custkey_prf_1#3067, o_orderpriority_prf#3058 AS o_orderpriority_prf_1#3068, o_clerk_prf#3059 AS o_clerk_prf_1#3069, o_orderstatus_prf#3060 AS o_orderstatus_prf_1#3070, o_totalprice_prf#3061 AS o_totalprice_prf_1#3071, o_orderkey_prf#3062 AS o_orderkey_prf_1#3072, o_comment_prf#3063 AS o_comment_prf_1#3073]
            :     :  +- Relation[o_shippriority_prf#3054,rid#3055,o_orderdate_prf#3056,o_custkey_prf#3057,o_orderpriority_prf#3058,o_clerk_prf#3059,o_orderstatus_prf#3060,o_totalprice_prf#3061,o_orderkey_prf#3062,o_comment_prf#3063] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3075 AS l_returnflag_prf_2#3094, l_orderkey_and_l_linenumber_prf#3076 AS l_orderkey_and_l_linenumber_prf_2#3095, l_comment_prf#3077 AS l_comment_prf_2#3096, l_linestatus_prf#3078 AS l_linestatus_prf_2#3097, rid#3079 AS rid_2#3098, l_shipmode_prf#3080 AS l_shipmode_prf_2#3099, l_shipinstruct_prf#3081 AS l_shipinstruct_prf_2#3100, l_quantity_prf#3082 AS l_quantity_prf_2#3101, l_receiptdate_prf#3083 AS l_receiptdate_prf_2#3102, l_linenumber_prf#3084 AS l_linenumber_prf_2#3103, l_tax_prf#3085 AS l_tax_prf_2#3104, l_shipdate_prf#3086 AS l_shipdate_prf_2#3105, l_extendedprice_prf#3087 AS l_extendedprice_prf_2#3106, l_partkey_prf#3088 AS l_partkey_prf_2#3107, l_discount_prf#3089 AS l_discount_prf_2#3108, l_partkey_and_l_suppkey_prf#3090 AS l_partkey_and_l_suppkey_prf_2#3109, l_commitdate_prf#3091 AS l_commitdate_prf_2#3110, l_suppkey_prf#3092 AS l_suppkey_prf_2#3111, l_orderkey_prf#3093 AS l_orderkey_prf_2#3112]
               +- Relation[l_returnflag_prf#3075,l_orderkey_and_l_linenumber_prf#3076,l_comment_prf#3077,l_linestatus_prf#3078,rid#3079,l_shipmode_prf#3080,l_shipinstruct_prf#3081,l_quantity_prf#3082,l_receiptdate_prf#3083,l_linenumber_prf#3084,l_tax_prf#3085,l_shipdate_prf#3086,l_extendedprice_prf#3087,l_partkey_prf#3088,l_discount_prf#3089,l_partkey_and_l_suppkey_prf#3090,l_commitdate_prf#3091,l_suppkey_prf#3092,l_orderkey_prf#3093] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 237648ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/11 06:43:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:43:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3163L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 06:43:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3163L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#3165 AS p_comment_prf_0#3175, p_name_prf#3166 AS p_name_prf_0#3176, rid#3167 AS rid_0#3177, p_type_prf#3168 AS p_type_prf_0#3178, p_retailprice_prf#3169 AS p_retailprice_prf_0#3179, p_mfgr_prf#3170 AS p_mfgr_prf_0#3180, p_container_prf#3171 AS p_container_prf_0#3181, p_brand_prf#3172 AS p_brand_prf_0#3182, p_size_prf#3173 AS p_size_prf_0#3183, p_partkey_prf#3174 AS p_partkey_prf_0#3184]
         :  +- Relation[p_comment_prf#3165,p_name_prf#3166,rid#3167,p_type_prf#3168,p_retailprice_prf#3169,p_mfgr_prf#3170,p_container_prf#3171,p_brand_prf#3172,p_size_prf#3173,p_partkey_prf#3174] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3185]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1451
Elapsed time: 84ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/11 06:43:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:43:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3218L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 06:43:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3218L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_2#3238]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#3230: string
         :     :- Project [c_acctbal_prf#3220 AS c_acctbal_prf_0#3229, rid#3221 AS rid_0#3230, c_name_prf#3222 AS c_name_prf_0#3231, c_nationkey_prf#3223 AS c_nationkey_prf_0#3232, c_custkey_prf#3224 AS c_custkey_prf_0#3233, c_comment_prf#3225 AS c_comment_prf_0#3234, c_address_prf#3226 AS c_address_prf_0#3235, c_mktsegment_prf#3227 AS c_mktsegment_prf_0#3236, c_phone_prf#3228 AS c_phone_prf_0#3237]
         :     :  +- Relation[c_acctbal_prf#3220,rid#3221,c_name_prf#3222,c_nationkey_prf#3223,c_custkey_prf#3224,c_comment_prf#3225,c_address_prf#3226,c_mktsegment_prf#3227,c_phone_prf#3228] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1496) AS rid_2#3255]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#3248: string
            :     :- Project [s_phone_prf#3239 AS s_phone_prf_1#3247, rid#3240 AS rid_1#3248, s_address_prf#3241 AS s_address_prf_1#3249, s_nationkey_prf#3242 AS s_nationkey_prf_1#3250, s_suppkey_prf#3243 AS s_suppkey_prf_1#3251, s_name_prf#3244 AS s_name_prf_1#3252, s_acctbal_prf#3245 AS s_acctbal_prf_1#3253, s_comment_prf#3246 AS s_comment_prf_1#3254]
            :     :  +- Relation[s_phone_prf#3239,rid#3240,s_address_prf#3241,s_nationkey_prf#3242,s_suppkey_prf#3243,s_name_prf#3244,s_acctbal_prf#3245,s_comment_prf#3246] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [rid#3256 AS rid_2#3261, n_regionkey_prf#3257 AS n_regionkey_prf_2#3262, n_nationkey_prf#3258 AS n_nationkey_prf_2#3263, n_name_prf#3259 AS n_name_prf_2#3264, n_comment_prf#3260 AS n_comment_prf_2#3265]
               +- Relation[rid#3256,n_regionkey_prf#3257,n_nationkey_prf#3258,n_name_prf#3259,n_comment_prf#3260] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 60662ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/11 06:44:36 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:44:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3312L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 06:44:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3312L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_2#3330]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#3323: string
         :     :- Project [s_phone_prf#3314 AS s_phone_prf_0#3322, rid#3315 AS rid_0#3323, s_address_prf#3316 AS s_address_prf_0#3324, s_nationkey_prf#3317 AS s_nationkey_prf_0#3325, s_suppkey_prf#3318 AS s_suppkey_prf_0#3326, s_name_prf#3319 AS s_name_prf_0#3327, s_acctbal_prf#3320 AS s_acctbal_prf_0#3328, s_comment_prf#3321 AS s_comment_prf_0#3329]
         :     :  +- Relation[s_phone_prf#3314,rid#3315,s_address_prf#3316,s_nationkey_prf#3317,s_suppkey_prf#3318,s_name_prf#3319,s_acctbal_prf#3320,s_comment_prf#3321] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1496) AS rid_2#3351]
            :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#3343: string
            :     :- Project [p_comment_prf#3331 AS p_comment_prf_1#3341, p_name_prf#3332 AS p_name_prf_1#3342, rid#3333 AS rid_1#3343, p_type_prf#3334 AS p_type_prf_1#3344, p_retailprice_prf#3335 AS p_retailprice_prf_1#3345, p_mfgr_prf#3336 AS p_mfgr_prf_1#3346, p_container_prf#3337 AS p_container_prf_1#3347, p_brand_prf#3338 AS p_brand_prf_1#3348, p_size_prf#3339 AS p_size_prf_1#3349, p_partkey_prf#3340 AS p_partkey_prf_1#3350]
            :     :  +- Relation[p_comment_prf#3331,p_name_prf#3332,rid#3333,p_type_prf#3334,p_retailprice_prf#3335,p_mfgr_prf#3336,p_container_prf#3337,p_brand_prf#3338,p_size_prf#3339,p_partkey_prf#3340] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#3352 AS ps_partkey_and_ps_suppkey_prf_2#3359, rid#3353 AS rid_2#3360, ps_availqty_prf#3354 AS ps_availqty_prf_2#3361, ps_comment_prf#3355 AS ps_comment_prf_2#3362, ps_partkey_prf#3356 AS ps_partkey_prf_2#3363, ps_supplycost_prf#3357 AS ps_supplycost_prf_2#3364, ps_suppkey_prf#3358 AS ps_suppkey_prf_2#3365]
               +- Relation[ps_partkey_and_ps_suppkey_prf#3352,rid#3353,ps_availqty_prf#3354,ps_comment_prf#3355,ps_partkey_prf#3356,ps_supplycost_prf#3357,ps_suppkey_prf#3358] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 43870ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/11 06:45:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:45:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3415L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 06:45:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3415L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#3433]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#3426: string
         :     :- Project [s_phone_prf#3417 AS s_phone_prf_0#3425, rid#3418 AS rid_0#3426, s_address_prf#3419 AS s_address_prf_0#3427, s_nationkey_prf#3420 AS s_nationkey_prf_0#3428, s_suppkey_prf#3421 AS s_suppkey_prf_0#3429, s_name_prf#3422 AS s_name_prf_0#3430, s_acctbal_prf#3423 AS s_acctbal_prf_0#3431, s_comment_prf#3424 AS s_comment_prf_0#3432]
         :     :  +- Relation[s_phone_prf#3417,rid#3418,s_address_prf#3419,s_nationkey_prf#3420,s_suppkey_prf#3421,s_name_prf#3422,s_acctbal_prf#3423,s_comment_prf#3424] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1496) AS rid_2#3448]
            :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_1#3442: string
            :     :- Project [ps_partkey_and_ps_suppkey_prf#3434 AS ps_partkey_and_ps_suppkey_prf_1#3441, rid#3435 AS rid_1#3442, ps_availqty_prf#3436 AS ps_availqty_prf_1#3443, ps_comment_prf#3437 AS ps_comment_prf_1#3444, ps_partkey_prf#3438 AS ps_partkey_prf_1#3445, ps_supplycost_prf#3439 AS ps_supplycost_prf_1#3446, ps_suppkey_prf#3440 AS ps_suppkey_prf_1#3447]
            :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#3434,rid#3435,ps_availqty_prf#3436,ps_comment_prf#3437,ps_partkey_prf#3438,ps_supplycost_prf#3439,ps_suppkey_prf#3440] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#3449 AS p_comment_prf_2#3459, p_name_prf#3450 AS p_name_prf_2#3460, rid#3451 AS rid_2#3461, p_type_prf#3452 AS p_type_prf_2#3462, p_retailprice_prf#3453 AS p_retailprice_prf_2#3463, p_mfgr_prf#3454 AS p_mfgr_prf_2#3464, p_container_prf#3455 AS p_container_prf_2#3465, p_brand_prf#3456 AS p_brand_prf_2#3466, p_size_prf#3457 AS p_size_prf_2#3467, p_partkey_prf#3458 AS p_partkey_prf_2#3468]
               +- Relation[p_comment_prf#3449,p_name_prf#3450,rid#3451,p_type_prf#3452,p_retailprice_prf#3453,p_mfgr_prf#3454,p_container_prf#3455,p_brand_prf#3456,p_size_prf#3457,p_partkey_prf#3458] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 62485ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/11 06:46:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:46:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3516L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 06:46:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3516L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#1496) AS rid_2#3545]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#3534]
         :     :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#3527: string
         :     :  :     :- Project [s_phone_prf#3518 AS s_phone_prf_0#3526, rid#3519 AS rid_0#3527, s_address_prf#3520 AS s_address_prf_0#3528, s_nationkey_prf#3521 AS s_nationkey_prf_0#3529, s_suppkey_prf#3522 AS s_suppkey_prf_0#3530, s_name_prf#3523 AS s_name_prf_0#3531, s_acctbal_prf#3524 AS s_acctbal_prf_0#3532, s_comment_prf#3525 AS s_comment_prf_0#3533]
         :     :  :     :  +- Relation[s_phone_prf#3518,rid#3519,s_address_prf#3520,s_nationkey_prf#3521,s_suppkey_prf#3522,s_name_prf#3523,s_acctbal_prf#3524,s_comment_prf#3525] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [rid#3535 AS rid_1#3540, n_regionkey_prf#3536 AS n_regionkey_prf_1#3541, n_nationkey_prf#3537 AS n_nationkey_prf_1#3542, n_name_prf#3538 AS n_name_prf_1#3543, n_comment_prf#3539 AS n_comment_prf_1#3544]
         :     :     +- Relation[rid#3535,n_regionkey_prf#3536,n_nationkey_prf#3537,n_name_prf#3538,n_comment_prf#3539] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3546 AS c_acctbal_prf_2#3555, rid#3547 AS rid_2#3556, c_name_prf#3548 AS c_name_prf_2#3557, c_nationkey_prf#3549 AS c_nationkey_prf_2#3558, c_custkey_prf#3550 AS c_custkey_prf_2#3559, c_comment_prf#3551 AS c_comment_prf_2#3560, c_address_prf#3552 AS c_address_prf_2#3561, c_mktsegment_prf#3553 AS c_mktsegment_prf_2#3562, c_phone_prf#3554 AS c_phone_prf_2#3563]
            +- Relation[c_acctbal_prf#3546,rid#3547,c_name_prf#3548,c_nationkey_prf#3549,c_custkey_prf#3550,c_comment_prf#3551,c_address_prf#3552,c_mktsegment_prf#3553,c_phone_prf#3554] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 670238ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_orderkey and l_orderkey = o_orderkey
19/10/11 06:57:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 06:57:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3622L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 06:57:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3622L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_2#3662]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3647: string
         :     :- Project [l_returnflag_prf#3624 AS l_returnflag_prf_0#3643, l_orderkey_and_l_linenumber_prf#3625 AS l_orderkey_and_l_linenumber_prf_0#3644, l_comment_prf#3626 AS l_comment_prf_0#3645, l_linestatus_prf#3627 AS l_linestatus_prf_0#3646, rid#3628 AS rid_0#3647, l_shipmode_prf#3629 AS l_shipmode_prf_0#3648, l_shipinstruct_prf#3630 AS l_shipinstruct_prf_0#3649, l_quantity_prf#3631 AS l_quantity_prf_0#3650, l_receiptdate_prf#3632 AS l_receiptdate_prf_0#3651, l_linenumber_prf#3633 AS l_linenumber_prf_0#3652, l_tax_prf#3634 AS l_tax_prf_0#3653, l_shipdate_prf#3635 AS l_shipdate_prf_0#3654, l_extendedprice_prf#3636 AS l_extendedprice_prf_0#3655, l_partkey_prf#3637 AS l_partkey_prf_0#3656, l_discount_prf#3638 AS l_discount_prf_0#3657, l_partkey_and_l_suppkey_prf#3639 AS l_partkey_and_l_suppkey_prf_0#3658, l_commitdate_prf#3640 AS l_commitdate_prf_0#3659, l_suppkey_prf#3641 AS l_suppkey_prf_0#3660, l_orderkey_prf#3642 AS l_orderkey_prf_0#3661]
         :     :  +- Relation[l_returnflag_prf#3624,l_orderkey_and_l_linenumber_prf#3625,l_comment_prf#3626,l_linestatus_prf#3627,rid#3628,l_shipmode_prf#3629,l_shipinstruct_prf#3630,l_quantity_prf#3631,l_receiptdate_prf#3632,l_linenumber_prf#3633,l_tax_prf#3634,l_shipdate_prf#3635,l_extendedprice_prf#3636,l_partkey_prf#3637,l_discount_prf#3638,l_partkey_and_l_suppkey_prf#3639,l_commitdate_prf#3640,l_suppkey_prf#3641,l_orderkey_prf#3642] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1496) AS rid_2#3681]
            :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#3673: string
            :     :- Project [c_acctbal_prf#3663 AS c_acctbal_prf_1#3672, rid#3664 AS rid_1#3673, c_name_prf#3665 AS c_name_prf_1#3674, c_nationkey_prf#3666 AS c_nationkey_prf_1#3675, c_custkey_prf#3667 AS c_custkey_prf_1#3676, c_comment_prf#3668 AS c_comment_prf_1#3677, c_address_prf#3669 AS c_address_prf_1#3678, c_mktsegment_prf#3670 AS c_mktsegment_prf_1#3679, c_phone_prf#3671 AS c_phone_prf_1#3680]
            :     :  +- Relation[c_acctbal_prf#3663,rid#3664,c_name_prf#3665,c_nationkey_prf#3666,c_custkey_prf#3667,c_comment_prf#3668,c_address_prf#3669,c_mktsegment_prf#3670,c_phone_prf#3671] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3682 AS o_shippriority_prf_2#3692, rid#3683 AS rid_2#3693, o_orderdate_prf#3684 AS o_orderdate_prf_2#3694, o_custkey_prf#3685 AS o_custkey_prf_2#3695, o_orderpriority_prf#3686 AS o_orderpriority_prf_2#3696, o_clerk_prf#3687 AS o_clerk_prf_2#3697, o_orderstatus_prf#3688 AS o_orderstatus_prf_2#3698, o_totalprice_prf#3689 AS o_totalprice_prf_2#3699, o_orderkey_prf#3690 AS o_orderkey_prf_2#3700, o_comment_prf#3691 AS o_comment_prf_2#3701]
               +- Relation[o_shippriority_prf#3682,rid#3683,o_orderdate_prf#3684,o_custkey_prf#3685,o_orderpriority_prf#3686,o_clerk_prf#3687,o_orderstatus_prf#3688,o_totalprice_prf#3689,o_orderkey_prf#3690,o_comment_prf#3691] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 175846ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/11 07:00:28 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 07:00:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3768L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 07:00:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3768L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#3790]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#3781: string
         :     :- Project [o_shippriority_prf#3770 AS o_shippriority_prf_0#3780, rid#3771 AS rid_0#3781, o_orderdate_prf#3772 AS o_orderdate_prf_0#3782, o_custkey_prf#3773 AS o_custkey_prf_0#3783, o_orderpriority_prf#3774 AS o_orderpriority_prf_0#3784, o_clerk_prf#3775 AS o_clerk_prf_0#3785, o_orderstatus_prf#3776 AS o_orderstatus_prf_0#3786, o_totalprice_prf#3777 AS o_totalprice_prf_0#3787, o_orderkey_prf#3778 AS o_orderkey_prf_0#3788, o_comment_prf#3779 AS o_comment_prf_0#3789]
         :     :  +- Relation[o_shippriority_prf#3770,rid#3771,o_orderdate_prf#3772,o_custkey_prf#3773,o_orderpriority_prf#3774,o_clerk_prf#3775,o_orderstatus_prf#3776,o_totalprice_prf#3777,o_orderkey_prf#3778,o_comment_prf#3779] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3791 AS l_returnflag_prf_1#3810, l_orderkey_and_l_linenumber_prf#3792 AS l_orderkey_and_l_linenumber_prf_1#3811, l_comment_prf#3793 AS l_comment_prf_1#3812, l_linestatus_prf#3794 AS l_linestatus_prf_1#3813, rid#3795 AS rid_1#3814, l_shipmode_prf#3796 AS l_shipmode_prf_1#3815, l_shipinstruct_prf#3797 AS l_shipinstruct_prf_1#3816, l_quantity_prf#3798 AS l_quantity_prf_1#3817, l_receiptdate_prf#3799 AS l_receiptdate_prf_1#3818, l_linenumber_prf#3800 AS l_linenumber_prf_1#3819, l_tax_prf#3801 AS l_tax_prf_1#3820, l_shipdate_prf#3802 AS l_shipdate_prf_1#3821, l_extendedprice_prf#3803 AS l_extendedprice_prf_1#3822, l_partkey_prf#3804 AS l_partkey_prf_1#3823, l_discount_prf#3805 AS l_discount_prf_1#3824, l_partkey_and_l_suppkey_prf#3806 AS l_partkey_and_l_suppkey_prf_1#3825, l_commitdate_prf#3807 AS l_commitdate_prf_1#3826, l_suppkey_prf#3808 AS l_suppkey_prf_1#3827, l_orderkey_prf#3809 AS l_orderkey_prf_1#3828]
            +- Relation[l_returnflag_prf#3791,l_orderkey_and_l_linenumber_prf#3792,l_comment_prf#3793,l_linestatus_prf#3794,rid#3795,l_shipmode_prf#3796,l_shipinstruct_prf#3797,l_quantity_prf#3798,l_receiptdate_prf#3799,l_linenumber_prf#3800,l_tax_prf#3801,l_shipdate_prf#3802,l_extendedprice_prf#3803,l_partkey_prf#3804,l_discount_prf#3805,l_partkey_and_l_suppkey_prf#3806,l_commitdate_prf#3807,l_suppkey_prf#3808,l_orderkey_prf#3809] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 199353ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/11 07:03:48 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 07:03:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3886L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 07:03:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3886L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#3908]
         :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3900: string
         :     :- Project [p_comment_prf#3888 AS p_comment_prf_0#3898, p_name_prf#3889 AS p_name_prf_0#3899, rid#3890 AS rid_0#3900, p_type_prf#3891 AS p_type_prf_0#3901, p_retailprice_prf#3892 AS p_retailprice_prf_0#3902, p_mfgr_prf#3893 AS p_mfgr_prf_0#3903, p_container_prf#3894 AS p_container_prf_0#3904, p_brand_prf#3895 AS p_brand_prf_0#3905, p_size_prf#3896 AS p_size_prf_0#3906, p_partkey_prf#3897 AS p_partkey_prf_0#3907]
         :     :  +- Relation[p_comment_prf#3888,p_name_prf#3889,rid#3890,p_type_prf#3891,p_retailprice_prf#3892,p_mfgr_prf#3893,p_container_prf#3894,p_brand_prf#3895,p_size_prf#3896,p_partkey_prf#3897] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3909 AS l_returnflag_prf_1#3928, l_orderkey_and_l_linenumber_prf#3910 AS l_orderkey_and_l_linenumber_prf_1#3929, l_comment_prf#3911 AS l_comment_prf_1#3930, l_linestatus_prf#3912 AS l_linestatus_prf_1#3931, rid#3913 AS rid_1#3932, l_shipmode_prf#3914 AS l_shipmode_prf_1#3933, l_shipinstruct_prf#3915 AS l_shipinstruct_prf_1#3934, l_quantity_prf#3916 AS l_quantity_prf_1#3935, l_receiptdate_prf#3917 AS l_receiptdate_prf_1#3936, l_linenumber_prf#3918 AS l_linenumber_prf_1#3937, l_tax_prf#3919 AS l_tax_prf_1#3938, l_shipdate_prf#3920 AS l_shipdate_prf_1#3939, l_extendedprice_prf#3921 AS l_extendedprice_prf_1#3940, l_partkey_prf#3922 AS l_partkey_prf_1#3941, l_discount_prf#3923 AS l_discount_prf_1#3942, l_partkey_and_l_suppkey_prf#3924 AS l_partkey_and_l_suppkey_prf_1#3943, l_commitdate_prf#3925 AS l_commitdate_prf_1#3944, l_suppkey_prf#3926 AS l_suppkey_prf_1#3945, l_orderkey_prf#3927 AS l_orderkey_prf_1#3946]
            +- Relation[l_returnflag_prf#3909,l_orderkey_and_l_linenumber_prf#3910,l_comment_prf#3911,l_linestatus_prf#3912,rid#3913,l_shipmode_prf#3914,l_shipinstruct_prf#3915,l_quantity_prf#3916,l_receiptdate_prf#3917,l_linenumber_prf#3918,l_tax_prf#3919,l_shipdate_prf#3920,l_extendedprice_prf#3921,l_partkey_prf#3922,l_discount_prf#3923,l_partkey_and_l_suppkey_prf#3924,l_commitdate_prf#3925,l_suppkey_prf#3926,l_orderkey_prf#3927] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 96242ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/11 07:05:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 07:05:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4011L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 07:05:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4011L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#4029]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#4022: string
         :     :- Project [s_phone_prf#4013 AS s_phone_prf_0#4021, rid#4014 AS rid_0#4022, s_address_prf#4015 AS s_address_prf_0#4023, s_nationkey_prf#4016 AS s_nationkey_prf_0#4024, s_suppkey_prf#4017 AS s_suppkey_prf_0#4025, s_name_prf#4018 AS s_name_prf_0#4026, s_acctbal_prf#4019 AS s_acctbal_prf_0#4027, s_comment_prf#4020 AS s_comment_prf_0#4028]
         :     :  +- Relation[s_phone_prf#4013,rid#4014,s_address_prf#4015,s_nationkey_prf#4016,s_suppkey_prf#4017,s_name_prf#4018,s_acctbal_prf#4019,s_comment_prf#4020] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1496) AS rid_2#4068]
            :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_1#4053: string
            :     :- Project [l_returnflag_prf#4030 AS l_returnflag_prf_1#4049, l_orderkey_and_l_linenumber_prf#4031 AS l_orderkey_and_l_linenumber_prf_1#4050, l_comment_prf#4032 AS l_comment_prf_1#4051, l_linestatus_prf#4033 AS l_linestatus_prf_1#4052, rid#4034 AS rid_1#4053, l_shipmode_prf#4035 AS l_shipmode_prf_1#4054, l_shipinstruct_prf#4036 AS l_shipinstruct_prf_1#4055, l_quantity_prf#4037 AS l_quantity_prf_1#4056, l_receiptdate_prf#4038 AS l_receiptdate_prf_1#4057, l_linenumber_prf#4039 AS l_linenumber_prf_1#4058, l_tax_prf#4040 AS l_tax_prf_1#4059, l_shipdate_prf#4041 AS l_shipdate_prf_1#4060, l_extendedprice_prf#4042 AS l_extendedprice_prf_1#4061, l_partkey_prf#4043 AS l_partkey_prf_1#4062, l_discount_prf#4044 AS l_discount_prf_1#4063, l_partkey_and_l_suppkey_prf#4045 AS l_partkey_and_l_suppkey_prf_1#4064, l_commitdate_prf#4046 AS l_commitdate_prf_1#4065, l_suppkey_prf#4047 AS l_suppkey_prf_1#4066, l_orderkey_prf#4048 AS l_orderkey_prf_1#4067]
            :     :  +- Relation[l_returnflag_prf#4030,l_orderkey_and_l_linenumber_prf#4031,l_comment_prf#4032,l_linestatus_prf#4033,rid#4034,l_shipmode_prf#4035,l_shipinstruct_prf#4036,l_quantity_prf#4037,l_receiptdate_prf#4038,l_linenumber_prf#4039,l_tax_prf#4040,l_shipdate_prf#4041,l_extendedprice_prf#4042,l_partkey_prf#4043,l_discount_prf#4044,l_partkey_and_l_suppkey_prf#4045,l_commitdate_prf#4046,l_suppkey_prf#4047,l_orderkey_prf#4048] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#4069 AS p_comment_prf_2#4079, p_name_prf#4070 AS p_name_prf_2#4080, rid#4071 AS rid_2#4081, p_type_prf#4072 AS p_type_prf_2#4082, p_retailprice_prf#4073 AS p_retailprice_prf_2#4083, p_mfgr_prf#4074 AS p_mfgr_prf_2#4084, p_container_prf#4075 AS p_container_prf_2#4085, p_brand_prf#4076 AS p_brand_prf_2#4086, p_size_prf#4077 AS p_size_prf_2#4087, p_partkey_prf#4078 AS p_partkey_prf_2#4088]
               +- Relation[p_comment_prf#4069,p_name_prf#4070,rid#4071,p_type_prf#4072,p_retailprice_prf#4073,p_mfgr_prf#4074,p_container_prf#4075,p_brand_prf#4076,p_size_prf#4077,p_partkey_prf#4078] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 200107ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/11 07:08:44 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 07:08:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4148L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 07:08:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4148L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1496) AS rid_2#4177]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#4160]
         :     :  :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#4155: string
         :     :  :     :- Project [rid#4150 AS rid_0#4155, n_regionkey_prf#4151 AS n_regionkey_prf_0#4156, n_nationkey_prf#4152 AS n_nationkey_prf_0#4157, n_name_prf#4153 AS n_name_prf_0#4158, n_comment_prf#4154 AS n_comment_prf_0#4159]
         :     :  :     :  +- Relation[rid#4150,n_regionkey_prf#4151,n_nationkey_prf#4152,n_name_prf#4153,n_comment_prf#4154] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#4161 AS s_phone_prf_1#4169, rid#4162 AS rid_1#4170, s_address_prf#4163 AS s_address_prf_1#4171, s_nationkey_prf#4164 AS s_nationkey_prf_1#4172, s_suppkey_prf#4165 AS s_suppkey_prf_1#4173, s_name_prf#4166 AS s_name_prf_1#4174, s_acctbal_prf#4167 AS s_acctbal_prf_1#4175, s_comment_prf#4168 AS s_comment_prf_1#4176]
         :     :     +- Relation[s_phone_prf#4161,rid#4162,s_address_prf#4163,s_nationkey_prf#4164,s_suppkey_prf#4165,s_name_prf#4166,s_acctbal_prf#4167,s_comment_prf#4168] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4178 AS c_acctbal_prf_2#4187, rid#4179 AS rid_2#4188, c_name_prf#4180 AS c_name_prf_2#4189, c_nationkey_prf#4181 AS c_nationkey_prf_2#4190, c_custkey_prf#4182 AS c_custkey_prf_2#4191, c_comment_prf#4183 AS c_comment_prf_2#4192, c_address_prf#4184 AS c_address_prf_2#4193, c_mktsegment_prf#4185 AS c_mktsegment_prf_2#4194, c_phone_prf#4186 AS c_phone_prf_2#4195]
            +- Relation[c_acctbal_prf#4178,rid#4179,c_name_prf#4180,c_nationkey_prf#4181,c_custkey_prf#4182,c_comment_prf#4183,c_address_prf#4184,c_mktsegment_prf#4185,c_phone_prf#4186] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 786024ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/11 07:21:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 07:21:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4246L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 07:21:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4246L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#4286]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4271: string
         :     :- Project [l_returnflag_prf#4248 AS l_returnflag_prf_0#4267, l_orderkey_and_l_linenumber_prf#4249 AS l_orderkey_and_l_linenumber_prf_0#4268, l_comment_prf#4250 AS l_comment_prf_0#4269, l_linestatus_prf#4251 AS l_linestatus_prf_0#4270, rid#4252 AS rid_0#4271, l_shipmode_prf#4253 AS l_shipmode_prf_0#4272, l_shipinstruct_prf#4254 AS l_shipinstruct_prf_0#4273, l_quantity_prf#4255 AS l_quantity_prf_0#4274, l_receiptdate_prf#4256 AS l_receiptdate_prf_0#4275, l_linenumber_prf#4257 AS l_linenumber_prf_0#4276, l_tax_prf#4258 AS l_tax_prf_0#4277, l_shipdate_prf#4259 AS l_shipdate_prf_0#4278, l_extendedprice_prf#4260 AS l_extendedprice_prf_0#4279, l_partkey_prf#4261 AS l_partkey_prf_0#4280, l_discount_prf#4262 AS l_discount_prf_0#4281, l_partkey_and_l_suppkey_prf#4263 AS l_partkey_and_l_suppkey_prf_0#4282, l_commitdate_prf#4264 AS l_commitdate_prf_0#4283, l_suppkey_prf#4265 AS l_suppkey_prf_0#4284, l_orderkey_prf#4266 AS l_orderkey_prf_0#4285]
         :     :  +- Relation[l_returnflag_prf#4248,l_orderkey_and_l_linenumber_prf#4249,l_comment_prf#4250,l_linestatus_prf#4251,rid#4252,l_shipmode_prf#4253,l_shipinstruct_prf#4254,l_quantity_prf#4255,l_receiptdate_prf#4256,l_linenumber_prf#4257,l_tax_prf#4258,l_shipdate_prf#4259,l_extendedprice_prf#4260,l_partkey_prf#4261,l_discount_prf#4262,l_partkey_and_l_suppkey_prf#4263,l_commitdate_prf#4264,l_suppkey_prf#4265,l_orderkey_prf#4266] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4287 AS o_shippriority_prf_1#4297, rid#4288 AS rid_1#4298, o_orderdate_prf#4289 AS o_orderdate_prf_1#4299, o_custkey_prf#4290 AS o_custkey_prf_1#4300, o_orderpriority_prf#4291 AS o_orderpriority_prf_1#4301, o_clerk_prf#4292 AS o_clerk_prf_1#4302, o_orderstatus_prf#4293 AS o_orderstatus_prf_1#4303, o_totalprice_prf#4294 AS o_totalprice_prf_1#4304, o_orderkey_prf#4295 AS o_orderkey_prf_1#4305, o_comment_prf#4296 AS o_comment_prf_1#4306]
            +- Relation[o_shippriority_prf#4287,rid#4288,o_orderdate_prf#4289,o_custkey_prf#4290,o_orderpriority_prf#4291,o_clerk_prf#4292,o_orderstatus_prf#4293,o_totalprice_prf#4294,o_orderkey_prf#4295,o_comment_prf#4296] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 130775ms

f2=
select * from part where p_size = 15
19/10/11 07:24:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 07:24:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4348L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 07:24:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4348L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#4350 AS p_comment_prf_0#4360, p_name_prf#4351 AS p_name_prf_0#4361, rid#4352 AS rid_0#4362, p_type_prf#4353 AS p_type_prf_0#4363, p_retailprice_prf#4354 AS p_retailprice_prf_0#4364, p_mfgr_prf#4355 AS p_mfgr_prf_0#4365, p_container_prf#4356 AS p_container_prf_0#4366, p_brand_prf#4357 AS p_brand_prf_0#4367, p_size_prf#4358 AS p_size_prf_0#4368, p_partkey_prf#4359 AS p_partkey_prf_0#4369]
         :  +- Relation[p_comment_prf#4350,p_name_prf#4351,rid#4352,p_type_prf#4353,p_retailprice_prf#4354,p_mfgr_prf#4355,p_container_prf#4356,p_brand_prf#4357,p_size_prf#4358,p_partkey_prf#4359] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4370]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3907
Elapsed time: 120ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/11 07:24:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 07:24:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4409L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 07:24:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4409L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#4431]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#4422: string
         :     :- Project [o_shippriority_prf#4411 AS o_shippriority_prf_0#4421, rid#4412 AS rid_0#4422, o_orderdate_prf#4413 AS o_orderdate_prf_0#4423, o_custkey_prf#4414 AS o_custkey_prf_0#4424, o_orderpriority_prf#4415 AS o_orderpriority_prf_0#4425, o_clerk_prf#4416 AS o_clerk_prf_0#4426, o_orderstatus_prf#4417 AS o_orderstatus_prf_0#4427, o_totalprice_prf#4418 AS o_totalprice_prf_0#4428, o_orderkey_prf#4419 AS o_orderkey_prf_0#4429, o_comment_prf#4420 AS o_comment_prf_0#4430]
         :     :  +- Relation[o_shippriority_prf#4411,rid#4412,o_orderdate_prf#4413,o_custkey_prf#4414,o_orderpriority_prf#4415,o_clerk_prf#4416,o_orderstatus_prf#4417,o_totalprice_prf#4418,o_orderkey_prf#4419,o_comment_prf#4420] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#4432 AS l_returnflag_prf_1#4451, l_orderkey_and_l_linenumber_prf#4433 AS l_orderkey_and_l_linenumber_prf_1#4452, l_comment_prf#4434 AS l_comment_prf_1#4453, l_linestatus_prf#4435 AS l_linestatus_prf_1#4454, rid#4436 AS rid_1#4455, l_shipmode_prf#4437 AS l_shipmode_prf_1#4456, l_shipinstruct_prf#4438 AS l_shipinstruct_prf_1#4457, l_quantity_prf#4439 AS l_quantity_prf_1#4458, l_receiptdate_prf#4440 AS l_receiptdate_prf_1#4459, l_linenumber_prf#4441 AS l_linenumber_prf_1#4460, l_tax_prf#4442 AS l_tax_prf_1#4461, l_shipdate_prf#4443 AS l_shipdate_prf_1#4462, l_extendedprice_prf#4444 AS l_extendedprice_prf_1#4463, l_partkey_prf#4445 AS l_partkey_prf_1#4464, l_discount_prf#4446 AS l_discount_prf_1#4465, l_partkey_and_l_suppkey_prf#4447 AS l_partkey_and_l_suppkey_prf_1#4466, l_commitdate_prf#4448 AS l_commitdate_prf_1#4467, l_suppkey_prf#4449 AS l_suppkey_prf_1#4468, l_orderkey_prf#4450 AS l_orderkey_prf_1#4469]
            :  +- Relation[l_returnflag_prf#4432,l_orderkey_and_l_linenumber_prf#4433,l_comment_prf#4434,l_linestatus_prf#4435,rid#4436,l_shipmode_prf#4437,l_shipinstruct_prf#4438,l_quantity_prf#4439,l_receiptdate_prf#4440,l_linenumber_prf#4441,l_tax_prf#4442,l_shipdate_prf#4443,l_extendedprice_prf#4444,l_partkey_prf#4445,l_discount_prf#4446,l_partkey_and_l_suppkey_prf#4447,l_commitdate_prf#4448,l_suppkey_prf#4449,l_orderkey_prf#4450] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4470]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 201535ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/11 07:27:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 07:27:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4517L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 07:27:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4517L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#4539]
         :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4531: string
         :     :- Project [p_comment_prf#4519 AS p_comment_prf_0#4529, p_name_prf#4520 AS p_name_prf_0#4530, rid#4521 AS rid_0#4531, p_type_prf#4522 AS p_type_prf_0#4532, p_retailprice_prf#4523 AS p_retailprice_prf_0#4533, p_mfgr_prf#4524 AS p_mfgr_prf_0#4534, p_container_prf#4525 AS p_container_prf_0#4535, p_brand_prf#4526 AS p_brand_prf_0#4536, p_size_prf#4527 AS p_size_prf_0#4537, p_partkey_prf#4528 AS p_partkey_prf_0#4538]
         :     :  +- Relation[p_comment_prf#4519,p_name_prf#4520,rid#4521,p_type_prf#4522,p_retailprice_prf#4523,p_mfgr_prf#4524,p_container_prf#4525,p_brand_prf#4526,p_size_prf#4527,p_partkey_prf#4528] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4540 AS ps_partkey_and_ps_suppkey_prf_1#4547, rid#4541 AS rid_1#4548, ps_availqty_prf#4542 AS ps_availqty_prf_1#4549, ps_comment_prf#4543 AS ps_comment_prf_1#4550, ps_partkey_prf#4544 AS ps_partkey_prf_1#4551, ps_supplycost_prf#4545 AS ps_supplycost_prf_1#4552, ps_suppkey_prf#4546 AS ps_suppkey_prf_1#4553]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4540,rid#4541,ps_availqty_prf#4542,ps_comment_prf#4543,ps_partkey_prf#4544,ps_supplycost_prf#4545,ps_suppkey_prf#4546] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 32156ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/11 07:27:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 07:27:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4606L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 07:27:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4606L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_2#4624]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#4617: string
         :     :- Project [s_phone_prf#4608 AS s_phone_prf_0#4616, rid#4609 AS rid_0#4617, s_address_prf#4610 AS s_address_prf_0#4618, s_nationkey_prf#4611 AS s_nationkey_prf_0#4619, s_suppkey_prf#4612 AS s_suppkey_prf_0#4620, s_name_prf#4613 AS s_name_prf_0#4621, s_acctbal_prf#4614 AS s_acctbal_prf_0#4622, s_comment_prf#4615 AS s_comment_prf_0#4623]
         :     :  +- Relation[s_phone_prf#4608,rid#4609,s_address_prf#4610,s_nationkey_prf#4611,s_suppkey_prf#4612,s_name_prf#4613,s_acctbal_prf#4614,s_comment_prf#4615] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1496) AS rid_2#4645]
            :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#4637: string
            :     :- Project [p_comment_prf#4625 AS p_comment_prf_1#4635, p_name_prf#4626 AS p_name_prf_1#4636, rid#4627 AS rid_1#4637, p_type_prf#4628 AS p_type_prf_1#4638, p_retailprice_prf#4629 AS p_retailprice_prf_1#4639, p_mfgr_prf#4630 AS p_mfgr_prf_1#4640, p_container_prf#4631 AS p_container_prf_1#4641, p_brand_prf#4632 AS p_brand_prf_1#4642, p_size_prf#4633 AS p_size_prf_1#4643, p_partkey_prf#4634 AS p_partkey_prf_1#4644]
            :     :  +- Relation[p_comment_prf#4625,p_name_prf#4626,rid#4627,p_type_prf#4628,p_retailprice_prf#4629,p_mfgr_prf#4630,p_container_prf#4631,p_brand_prf#4632,p_size_prf#4633,p_partkey_prf#4634] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4646 AS l_returnflag_prf_2#4665, l_orderkey_and_l_linenumber_prf#4647 AS l_orderkey_and_l_linenumber_prf_2#4666, l_comment_prf#4648 AS l_comment_prf_2#4667, l_linestatus_prf#4649 AS l_linestatus_prf_2#4668, rid#4650 AS rid_2#4669, l_shipmode_prf#4651 AS l_shipmode_prf_2#4670, l_shipinstruct_prf#4652 AS l_shipinstruct_prf_2#4671, l_quantity_prf#4653 AS l_quantity_prf_2#4672, l_receiptdate_prf#4654 AS l_receiptdate_prf_2#4673, l_linenumber_prf#4655 AS l_linenumber_prf_2#4674, l_tax_prf#4656 AS l_tax_prf_2#4675, l_shipdate_prf#4657 AS l_shipdate_prf_2#4676, l_extendedprice_prf#4658 AS l_extendedprice_prf_2#4677, l_partkey_prf#4659 AS l_partkey_prf_2#4678, l_discount_prf#4660 AS l_discount_prf_2#4679, l_partkey_and_l_suppkey_prf#4661 AS l_partkey_and_l_suppkey_prf_2#4680, l_commitdate_prf#4662 AS l_commitdate_prf_2#4681, l_suppkey_prf#4663 AS l_suppkey_prf_2#4682, l_orderkey_prf#4664 AS l_orderkey_prf_2#4683]
               +- Relation[l_returnflag_prf#4646,l_orderkey_and_l_linenumber_prf#4647,l_comment_prf#4648,l_linestatus_prf#4649,rid#4650,l_shipmode_prf#4651,l_shipinstruct_prf#4652,l_quantity_prf#4653,l_receiptdate_prf#4654,l_linenumber_prf#4655,l_tax_prf#4656,l_shipdate_prf#4657,l_extendedprice_prf#4658,l_partkey_prf#4659,l_discount_prf#4660,l_partkey_and_l_suppkey_prf#4661,l_commitdate_prf#4662,l_suppkey_prf#4663,l_orderkey_prf#4664] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 191810ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/11 07:31:07 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 07:31:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4740L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 07:31:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4740L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#4742 AS l_returnflag_prf_0#4761, l_orderkey_and_l_linenumber_prf#4743 AS l_orderkey_and_l_linenumber_prf_0#4762, l_comment_prf#4744 AS l_comment_prf_0#4763, l_linestatus_prf#4745 AS l_linestatus_prf_0#4764, rid#4746 AS rid_0#4765, l_shipmode_prf#4747 AS l_shipmode_prf_0#4766, l_shipinstruct_prf#4748 AS l_shipinstruct_prf_0#4767, l_quantity_prf#4749 AS l_quantity_prf_0#4768, l_receiptdate_prf#4750 AS l_receiptdate_prf_0#4769, l_linenumber_prf#4751 AS l_linenumber_prf_0#4770, l_tax_prf#4752 AS l_tax_prf_0#4771, l_shipdate_prf#4753 AS l_shipdate_prf_0#4772, l_extendedprice_prf#4754 AS l_extendedprice_prf_0#4773, l_partkey_prf#4755 AS l_partkey_prf_0#4774, l_discount_prf#4756 AS l_discount_prf_0#4775, l_partkey_and_l_suppkey_prf#4757 AS l_partkey_and_l_suppkey_prf_0#4776, l_commitdate_prf#4758 AS l_commitdate_prf_0#4777, l_suppkey_prf#4759 AS l_suppkey_prf_0#4778, l_orderkey_prf#4760 AS l_orderkey_prf_0#4779]
         :  +- Relation[l_returnflag_prf#4742,l_orderkey_and_l_linenumber_prf#4743,l_comment_prf#4744,l_linestatus_prf#4745,rid#4746,l_shipmode_prf#4747,l_shipinstruct_prf#4748,l_quantity_prf#4749,l_receiptdate_prf#4750,l_linenumber_prf#4751,l_tax_prf#4752,l_shipdate_prf#4753,l_extendedprice_prf#4754,l_partkey_prf#4755,l_discount_prf#4756,l_partkey_and_l_suppkey_prf#4757,l_commitdate_prf#4758,l_suppkey_prf#4759,l_orderkey_prf#4760] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4780]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 13883ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/11 07:31:21 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 07:31:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4836L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 07:31:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4836L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1496) AS rid_2#4877]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#4856]
         :     :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4848: string
         :     :  :     :- Project [c_acctbal_prf#4838 AS c_acctbal_prf_0#4847, rid#4839 AS rid_0#4848, c_name_prf#4840 AS c_name_prf_0#4849, c_nationkey_prf#4841 AS c_nationkey_prf_0#4850, c_custkey_prf#4842 AS c_custkey_prf_0#4851, c_comment_prf#4843 AS c_comment_prf_0#4852, c_address_prf#4844 AS c_address_prf_0#4853, c_mktsegment_prf#4845 AS c_mktsegment_prf_0#4854, c_phone_prf#4846 AS c_phone_prf_0#4855]
         :     :  :     :  +- Relation[c_acctbal_prf#4838,rid#4839,c_name_prf#4840,c_nationkey_prf#4841,c_custkey_prf#4842,c_comment_prf#4843,c_address_prf#4844,c_mktsegment_prf#4845,c_phone_prf#4846] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#4857 AS o_shippriority_prf_1#4867, rid#4858 AS rid_1#4868, o_orderdate_prf#4859 AS o_orderdate_prf_1#4869, o_custkey_prf#4860 AS o_custkey_prf_1#4870, o_orderpriority_prf#4861 AS o_orderpriority_prf_1#4871, o_clerk_prf#4862 AS o_clerk_prf_1#4872, o_orderstatus_prf#4863 AS o_orderstatus_prf_1#4873, o_totalprice_prf#4864 AS o_totalprice_prf_1#4874, o_orderkey_prf#4865 AS o_orderkey_prf_1#4875, o_comment_prf#4866 AS o_comment_prf_1#4876]
         :     :     +- Relation[o_shippriority_prf#4857,rid#4858,o_orderdate_prf#4859,o_custkey_prf#4860,o_orderpriority_prf#4861,o_clerk_prf#4862,o_orderstatus_prf#4863,o_totalprice_prf#4864,o_orderkey_prf#4865,o_comment_prf#4866] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4878 AS l_returnflag_prf_2#4897, l_orderkey_and_l_linenumber_prf#4879 AS l_orderkey_and_l_linenumber_prf_2#4898, l_comment_prf#4880 AS l_comment_prf_2#4899, l_linestatus_prf#4881 AS l_linestatus_prf_2#4900, rid#4882 AS rid_2#4901, l_shipmode_prf#4883 AS l_shipmode_prf_2#4902, l_shipinstruct_prf#4884 AS l_shipinstruct_prf_2#4903, l_quantity_prf#4885 AS l_quantity_prf_2#4904, l_receiptdate_prf#4886 AS l_receiptdate_prf_2#4905, l_linenumber_prf#4887 AS l_linenumber_prf_2#4906, l_tax_prf#4888 AS l_tax_prf_2#4907, l_shipdate_prf#4889 AS l_shipdate_prf_2#4908, l_extendedprice_prf#4890 AS l_extendedprice_prf_2#4909, l_partkey_prf#4891 AS l_partkey_prf_2#4910, l_discount_prf#4892 AS l_discount_prf_2#4911, l_partkey_and_l_suppkey_prf#4893 AS l_partkey_and_l_suppkey_prf_2#4912, l_commitdate_prf#4894 AS l_commitdate_prf_2#4913, l_suppkey_prf#4895 AS l_suppkey_prf_2#4914, l_orderkey_prf#4896 AS l_orderkey_prf_2#4915]
            +- Relation[l_returnflag_prf#4878,l_orderkey_and_l_linenumber_prf#4879,l_comment_prf#4880,l_linestatus_prf#4881,rid#4882,l_shipmode_prf#4883,l_shipinstruct_prf#4884,l_quantity_prf#4885,l_receiptdate_prf#4886,l_linenumber_prf#4887,l_tax_prf#4888,l_shipdate_prf#4889,l_extendedprice_prf#4890,l_partkey_prf#4891,l_discount_prf#4892,l_partkey_and_l_suppkey_prf#4893,l_commitdate_prf#4894,l_suppkey_prf#4895,l_orderkey_prf#4896] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 185997ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/11 07:34:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 07:34:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4971L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 07:34:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4971L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#4987]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#4981: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#4973 AS ps_partkey_and_ps_suppkey_prf_0#4980, rid#4974 AS rid_0#4981, ps_availqty_prf#4975 AS ps_availqty_prf_0#4982, ps_comment_prf#4976 AS ps_comment_prf_0#4983, ps_partkey_prf#4977 AS ps_partkey_prf_0#4984, ps_supplycost_prf#4978 AS ps_supplycost_prf_0#4985, ps_suppkey_prf#4979 AS ps_suppkey_prf_0#4986]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#4973,rid#4974,ps_availqty_prf#4975,ps_comment_prf#4976,ps_partkey_prf#4977,ps_supplycost_prf#4978,ps_suppkey_prf#4979] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#4988 AS p_comment_prf_1#4998, p_name_prf#4989 AS p_name_prf_1#4999, rid#4990 AS rid_1#5000, p_type_prf#4991 AS p_type_prf_1#5001, p_retailprice_prf#4992 AS p_retailprice_prf_1#5002, p_mfgr_prf#4993 AS p_mfgr_prf_1#5003, p_container_prf#4994 AS p_container_prf_1#5004, p_brand_prf#4995 AS p_brand_prf_1#5005, p_size_prf#4996 AS p_size_prf_1#5006, p_partkey_prf#4997 AS p_partkey_prf_1#5007]
            :  +- Relation[p_comment_prf#4988,p_name_prf#4989,rid#4990,p_type_prf#4991,p_retailprice_prf#4992,p_mfgr_prf#4993,p_container_prf#4994,p_brand_prf#4995,p_size_prf#4996,p_partkey_prf#4997] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5008]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1858,value#1859] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 51029ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/11 07:35:18 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 07:35:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5041L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 07:35:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5041L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#5059]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#5052: string
         :     :- Project [s_phone_prf#5043 AS s_phone_prf_0#5051, rid#5044 AS rid_0#5052, s_address_prf#5045 AS s_address_prf_0#5053, s_nationkey_prf#5046 AS s_nationkey_prf_0#5054, s_suppkey_prf#5047 AS s_suppkey_prf_0#5055, s_name_prf#5048 AS s_name_prf_0#5056, s_acctbal_prf#5049 AS s_acctbal_prf_0#5057, s_comment_prf#5050 AS s_comment_prf_0#5058]
         :     :  +- Relation[s_phone_prf#5043,rid#5044,s_address_prf#5045,s_nationkey_prf#5046,s_suppkey_prf#5047,s_name_prf#5048,s_acctbal_prf#5049,s_comment_prf#5050] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#5060 AS ps_partkey_and_ps_suppkey_prf_1#5067, rid#5061 AS rid_1#5068, ps_availqty_prf#5062 AS ps_availqty_prf_1#5069, ps_comment_prf#5063 AS ps_comment_prf_1#5070, ps_partkey_prf#5064 AS ps_partkey_prf_1#5071, ps_supplycost_prf#5065 AS ps_supplycost_prf_1#5072, ps_suppkey_prf#5066 AS ps_suppkey_prf_1#5073]
            +- Relation[ps_partkey_and_ps_suppkey_prf#5060,rid#5061,ps_availqty_prf#5062,ps_comment_prf#5063,ps_partkey_prf#5064,ps_supplycost_prf#5065,ps_suppkey_prf#5066] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 11253ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/11 07:35:29 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 07:35:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5125L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 07:35:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5125L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#5165]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#5150: string
         :     :  :     :- Project [l_returnflag_prf#5127 AS l_returnflag_prf_0#5146, l_orderkey_and_l_linenumber_prf#5128 AS l_orderkey_and_l_linenumber_prf_0#5147, l_comment_prf#5129 AS l_comment_prf_0#5148, l_linestatus_prf#5130 AS l_linestatus_prf_0#5149, rid#5131 AS rid_0#5150, l_shipmode_prf#5132 AS l_shipmode_prf_0#5151, l_shipinstruct_prf#5133 AS l_shipinstruct_prf_0#5152, l_quantity_prf#5134 AS l_quantity_prf_0#5153, l_receiptdate_prf#5135 AS l_receiptdate_prf_0#5154, l_linenumber_prf#5136 AS l_linenumber_prf_0#5155, l_tax_prf#5137 AS l_tax_prf_0#5156, l_shipdate_prf#5138 AS l_shipdate_prf_0#5157, l_extendedprice_prf#5139 AS l_extendedprice_prf_0#5158, l_partkey_prf#5140 AS l_partkey_prf_0#5159, l_discount_prf#5141 AS l_discount_prf_0#5160, l_partkey_and_l_suppkey_prf#5142 AS l_partkey_and_l_suppkey_prf_0#5161, l_commitdate_prf#5143 AS l_commitdate_prf_0#5162, l_suppkey_prf#5144 AS l_suppkey_prf_0#5163, l_orderkey_prf#5145 AS l_orderkey_prf_0#5164]
         :     :  :     :  +- Relation[l_returnflag_prf#5127,l_orderkey_and_l_linenumber_prf#5128,l_comment_prf#5129,l_linestatus_prf#5130,rid#5131,l_shipmode_prf#5132,l_shipinstruct_prf#5133,l_quantity_prf#5134,l_receiptdate_prf#5135,l_linenumber_prf#5136,l_tax_prf#5137,l_shipdate_prf#5138,l_extendedprice_prf#5139,l_partkey_prf#5140,l_discount_prf#5141,l_partkey_and_l_suppkey_prf#5142,l_commitdate_prf#5143,l_suppkey_prf#5144,l_orderkey_prf#5145] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#5166 AS o_shippriority_prf_1#5176, rid#5167 AS rid_1#5177, o_orderdate_prf#5168 AS o_orderdate_prf_1#5178, o_custkey_prf#5169 AS o_custkey_prf_1#5179, o_orderpriority_prf#5170 AS o_orderpriority_prf_1#5180, o_clerk_prf#5171 AS o_clerk_prf_1#5181, o_orderstatus_prf#5172 AS o_orderstatus_prf_1#5182, o_totalprice_prf#5173 AS o_totalprice_prf_1#5183, o_orderkey_prf#5174 AS o_orderkey_prf_1#5184, o_comment_prf#5175 AS o_comment_prf_1#5185]
         :     :     +- Relation[o_shippriority_prf#5166,rid#5167,o_orderdate_prf#5168,o_custkey_prf#5169,o_orderpriority_prf#5170,o_clerk_prf#5171,o_orderstatus_prf#5172,o_totalprice_prf#5173,o_orderkey_prf#5174,o_comment_prf#5175] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#5187 AS c_acctbal_prf_2#5196, rid#5188 AS rid_2#5197, c_name_prf#5189 AS c_name_prf_2#5198, c_nationkey_prf#5190 AS c_nationkey_prf_2#5199, c_custkey_prf#5191 AS c_custkey_prf_2#5200, c_comment_prf#5192 AS c_comment_prf_2#5201, c_address_prf#5193 AS c_address_prf_2#5202, c_mktsegment_prf#5194 AS c_mktsegment_prf_2#5203, c_phone_prf#5195 AS c_phone_prf_2#5204]
            +- Relation[c_acctbal_prf#5187,rid#5188,c_name_prf#5189,c_nationkey_prf#5190,c_custkey_prf#5191,c_comment_prf#5192,c_address_prf#5193,c_mktsegment_prf#5194,c_phone_prf#5195] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 345596ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/11 07:41:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 07:41:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5271L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 07:41:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5271L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#5311]
         :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#5296: string
         :     :- Project [l_returnflag_prf#5273 AS l_returnflag_prf_0#5292, l_orderkey_and_l_linenumber_prf#5274 AS l_orderkey_and_l_linenumber_prf_0#5293, l_comment_prf#5275 AS l_comment_prf_0#5294, l_linestatus_prf#5276 AS l_linestatus_prf_0#5295, rid#5277 AS rid_0#5296, l_shipmode_prf#5278 AS l_shipmode_prf_0#5297, l_shipinstruct_prf#5279 AS l_shipinstruct_prf_0#5298, l_quantity_prf#5280 AS l_quantity_prf_0#5299, l_receiptdate_prf#5281 AS l_receiptdate_prf_0#5300, l_linenumber_prf#5282 AS l_linenumber_prf_0#5301, l_tax_prf#5283 AS l_tax_prf_0#5302, l_shipdate_prf#5284 AS l_shipdate_prf_0#5303, l_extendedprice_prf#5285 AS l_extendedprice_prf_0#5304, l_partkey_prf#5286 AS l_partkey_prf_0#5305, l_discount_prf#5287 AS l_discount_prf_0#5306, l_partkey_and_l_suppkey_prf#5288 AS l_partkey_and_l_suppkey_prf_0#5307, l_commitdate_prf#5289 AS l_commitdate_prf_0#5308, l_suppkey_prf#5290 AS l_suppkey_prf_0#5309, l_orderkey_prf#5291 AS l_orderkey_prf_0#5310]
         :     :  +- Relation[l_returnflag_prf#5273,l_orderkey_and_l_linenumber_prf#5274,l_comment_prf#5275,l_linestatus_prf#5276,rid#5277,l_shipmode_prf#5278,l_shipinstruct_prf#5279,l_quantity_prf#5280,l_receiptdate_prf#5281,l_linenumber_prf#5282,l_tax_prf#5283,l_shipdate_prf#5284,l_extendedprice_prf#5285,l_partkey_prf#5286,l_discount_prf#5287,l_partkey_and_l_suppkey_prf#5288,l_commitdate_prf#5289,l_suppkey_prf#5290,l_orderkey_prf#5291] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#5312 AS p_comment_prf_1#5322, p_name_prf#5313 AS p_name_prf_1#5323, rid#5314 AS rid_1#5324, p_type_prf#5315 AS p_type_prf_1#5325, p_retailprice_prf#5316 AS p_retailprice_prf_1#5326, p_mfgr_prf#5317 AS p_mfgr_prf_1#5327, p_container_prf#5318 AS p_container_prf_1#5328, p_brand_prf#5319 AS p_brand_prf_1#5329, p_size_prf#5320 AS p_size_prf_1#5330, p_partkey_prf#5321 AS p_partkey_prf_1#5331]
            +- Relation[p_comment_prf#5312,p_name_prf#5313,rid#5314,p_type_prf#5315,p_retailprice_prf#5316,p_mfgr_prf#5317,p_container_prf#5318,p_brand_prf#5319,p_size_prf#5320,p_partkey_prf#5321] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 129680ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/11 07:43:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 07:43:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5375L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 07:43:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5375L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1496) AS rid_1#5387]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#5382: string
         :     :- Project [rid#5377 AS rid_0#5382, n_regionkey_prf#5378 AS n_regionkey_prf_0#5383, n_nationkey_prf#5379 AS n_nationkey_prf_0#5384, n_name_prf#5380 AS n_name_prf_0#5385, n_comment_prf#5381 AS n_comment_prf_0#5386]
         :     :  +- Relation[rid#5377,n_regionkey_prf#5378,n_nationkey_prf#5379,n_name_prf#5380,n_comment_prf#5381] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1495,value#1496] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5388 AS s_phone_prf_1#5396, rid#5389 AS rid_1#5397, s_address_prf#5390 AS s_address_prf_1#5398, s_nationkey_prf#5391 AS s_nationkey_prf_1#5399, s_suppkey_prf#5392 AS s_suppkey_prf_1#5400, s_name_prf#5393 AS s_name_prf_1#5401, s_acctbal_prf#5394 AS s_acctbal_prf_1#5402, s_comment_prf#5395 AS s_comment_prf_1#5403]
            +- Relation[s_phone_prf#5388,rid#5389,s_address_prf#5390,s_nationkey_prf#5391,s_suppkey_prf#5392,s_name_prf#5393,s_acctbal_prf#5394,s_comment_prf#5395] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=10000
Elapsed time: 186ms
query=b1a, count=15628, duration=393
query=b1b, count=15628, duration=51029
query=b2a, count=1478870, duration=201535
query=b2b, count=1478870, duration=57291
query=f1, count=1, duration=54
query=f2, count=3907, duration=120
query=f3, count=1451, duration=84
query=f4, count=1, duration=55
query=f5, count=1478870, duration=23776
query=f6, count=857401, duration=13883
query=j1, count=800000, duration=32156
query=j10, count=6001215, duration=88433
query=j2, count=800000, duration=11253
query=j3, count=25, duration=76
query=j4, count=150000, duration=2135
query=j5, count=10000, duration=186
query=j6, count=6001215, duration=117990
query=j7, count=1500000, duration=40618
query=j8, count=6001215, duration=199353
query=j8b, count=6001215, duration=130775
query=j9, count=6001215, duration=96242
query=j9b, count=6001215, duration=129680
query=r1a, count=6001215, duration=345596
query=r1b, count=6001215, duration=168570
query=r1c, count=6001215, duration=175846
query=r1d, count=6001215, duration=185997
query=r1e, count=6001215, duration=237648
query=r1f, count=6001215, duration=175396
query=t1a, count=60000414, duration=670238
query=t1b, count=60000414, duration=786024
query=t1c, count=60000414, duration=60662
query=t2a, count=800000, duration=109041
query=t2b, count=800000, duration=94388
query=t2c, count=800000, duration=43870
query=t2d, count=800000, duration=62485
query=t3a, count=6001215, duration=293783
query=t3b, count=6001215, duration=312812
query=t3c, count=6001215, duration=191810
query=t3d, count=6001215, duration=200107
