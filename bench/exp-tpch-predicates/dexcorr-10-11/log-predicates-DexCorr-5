19/10/11 03:17:03 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7201ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Fri Oct 11 03:17:06 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Fri Oct 11 03:17:07 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Fri Oct 11 03:17:07 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Fri Oct 11 03:17:07 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Fri Oct 11 03:17:07 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Fri Oct 11 03:17:09 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Fri Oct 11 03:17:12 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Fri Oct 11 03:17:12 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/11 03:17:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:17:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1504L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 03:17:13 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
19/10/11 03:17:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1504L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#1546]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#1529: string
         :     :  :     :- Project [l_returnflag_prf#1506 AS l_returnflag_prf_0#1525, l_orderkey_and_l_linenumber_prf#1507 AS l_orderkey_and_l_linenumber_prf_0#1526, l_comment_prf#1508 AS l_comment_prf_0#1527, l_linestatus_prf#1509 AS l_linestatus_prf_0#1528, rid#1510 AS rid_0#1529, l_shipmode_prf#1511 AS l_shipmode_prf_0#1530, l_shipinstruct_prf#1512 AS l_shipinstruct_prf_0#1531, l_quantity_prf#1513 AS l_quantity_prf_0#1532, l_receiptdate_prf#1514 AS l_receiptdate_prf_0#1533, l_linenumber_prf#1515 AS l_linenumber_prf_0#1534, l_tax_prf#1516 AS l_tax_prf_0#1535, l_shipdate_prf#1517 AS l_shipdate_prf_0#1536, l_extendedprice_prf#1518 AS l_extendedprice_prf_0#1537, l_partkey_prf#1519 AS l_partkey_prf_0#1538, l_discount_prf#1520 AS l_discount_prf_0#1539, l_partkey_and_l_suppkey_prf#1521 AS l_partkey_and_l_suppkey_prf_0#1540, l_commitdate_prf#1522 AS l_commitdate_prf_0#1541, l_suppkey_prf#1523 AS l_suppkey_prf_0#1542, l_orderkey_prf#1524 AS l_orderkey_prf_0#1543]
         :     :  :     :  +- Relation[l_returnflag_prf#1506,l_orderkey_and_l_linenumber_prf#1507,l_comment_prf#1508,l_linestatus_prf#1509,rid#1510,l_shipmode_prf#1511,l_shipinstruct_prf#1512,l_quantity_prf#1513,l_receiptdate_prf#1514,l_linenumber_prf#1515,l_tax_prf#1516,l_shipdate_prf#1517,l_extendedprice_prf#1518,l_partkey_prf#1519,l_discount_prf#1520,l_partkey_and_l_suppkey_prf#1521,l_commitdate_prf#1522,l_suppkey_prf#1523,l_orderkey_prf#1524] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#1547 AS o_shippriority_prf_1#1557, rid#1548 AS rid_1#1558, o_orderdate_prf#1549 AS o_orderdate_prf_1#1559, o_custkey_prf#1550 AS o_custkey_prf_1#1560, o_orderpriority_prf#1551 AS o_orderpriority_prf_1#1561, o_clerk_prf#1552 AS o_clerk_prf_1#1562, o_orderstatus_prf#1553 AS o_orderstatus_prf_1#1563, o_totalprice_prf#1554 AS o_totalprice_prf_1#1564, o_orderkey_prf#1555 AS o_orderkey_prf_1#1565, o_comment_prf#1556 AS o_comment_prf_1#1566]
         :     :     +- Relation[o_shippriority_prf#1547,rid#1548,o_orderdate_prf#1549,o_custkey_prf#1550,o_orderpriority_prf#1551,o_clerk_prf#1552,o_orderstatus_prf#1553,o_totalprice_prf#1554,o_orderkey_prf#1555,o_comment_prf#1556] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#1568 AS c_acctbal_prf_2#1577, rid#1569 AS rid_2#1578, c_name_prf#1570 AS c_name_prf_2#1579, c_nationkey_prf#1571 AS c_nationkey_prf_2#1580, c_custkey_prf#1572 AS c_custkey_prf_2#1581, c_comment_prf#1573 AS c_comment_prf_2#1582, c_address_prf#1574 AS c_address_prf_2#1583, c_mktsegment_prf#1575 AS c_mktsegment_prf_2#1584, c_phone_prf#1576 AS c_phone_prf_2#1585]
            +- Relation[c_acctbal_prf#1568,rid#1569,c_name_prf#1570,c_nationkey_prf#1571,c_custkey_prf#1572,c_comment_prf#1573,c_address_prf#1574,c_mktsegment_prf#1575,c_phone_prf#1576] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 344427ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/11 03:22:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:22:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1634L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 03:22:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1634L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#1644]
         :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#1643: string
         :     :- Project [r_regionkey_prf#1636 AS r_regionkey_prf_0#1640, r_name_prf#1637 AS r_name_prf_0#1641, r_comment_prf#1638 AS r_comment_prf_0#1642, rid#1639 AS rid_0#1643]
         :     :  +- Relation[r_regionkey_prf#1636,r_name_prf#1637,r_comment_prf#1638,rid#1639] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#1645 AS rid_1#1650, n_regionkey_prf#1646 AS n_regionkey_prf_1#1651, n_nationkey_prf#1647 AS n_nationkey_prf_1#1652, n_name_prf#1648 AS n_name_prf_1#1653, n_comment_prf#1649 AS n_comment_prf_1#1654]
            +- Relation[rid#1645,n_regionkey_prf#1646,n_nationkey_prf#1647,n_name_prf#1648,n_comment_prf#1649] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=25
Elapsed time: 77ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/11 03:22:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:22:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1700L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 03:22:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1700L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_2#1720]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#1712: string
         :     :- Project [c_acctbal_prf#1702 AS c_acctbal_prf_0#1711, rid#1703 AS rid_0#1712, c_name_prf#1704 AS c_name_prf_0#1713, c_nationkey_prf#1705 AS c_nationkey_prf_0#1714, c_custkey_prf#1706 AS c_custkey_prf_0#1715, c_comment_prf#1707 AS c_comment_prf_0#1716, c_address_prf#1708 AS c_address_prf_0#1717, c_mktsegment_prf#1709 AS c_mktsegment_prf_0#1718, c_phone_prf#1710 AS c_phone_prf_0#1719]
         :     :  +- Relation[c_acctbal_prf#1702,rid#1703,c_name_prf#1704,c_nationkey_prf#1705,c_custkey_prf#1706,c_comment_prf#1707,c_address_prf#1708,c_mktsegment_prf#1709,c_phone_prf#1710] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1545) AS rid_2#1759]
            :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_1#1744: string
            :     :- Project [l_returnflag_prf#1721 AS l_returnflag_prf_1#1740, l_orderkey_and_l_linenumber_prf#1722 AS l_orderkey_and_l_linenumber_prf_1#1741, l_comment_prf#1723 AS l_comment_prf_1#1742, l_linestatus_prf#1724 AS l_linestatus_prf_1#1743, rid#1725 AS rid_1#1744, l_shipmode_prf#1726 AS l_shipmode_prf_1#1745, l_shipinstruct_prf#1727 AS l_shipinstruct_prf_1#1746, l_quantity_prf#1728 AS l_quantity_prf_1#1747, l_receiptdate_prf#1729 AS l_receiptdate_prf_1#1748, l_linenumber_prf#1730 AS l_linenumber_prf_1#1749, l_tax_prf#1731 AS l_tax_prf_1#1750, l_shipdate_prf#1732 AS l_shipdate_prf_1#1751, l_extendedprice_prf#1733 AS l_extendedprice_prf_1#1752, l_partkey_prf#1734 AS l_partkey_prf_1#1753, l_discount_prf#1735 AS l_discount_prf_1#1754, l_partkey_and_l_suppkey_prf#1736 AS l_partkey_and_l_suppkey_prf_1#1755, l_commitdate_prf#1737 AS l_commitdate_prf_1#1756, l_suppkey_prf#1738 AS l_suppkey_prf_1#1757, l_orderkey_prf#1739 AS l_orderkey_prf_1#1758]
            :     :  +- Relation[l_returnflag_prf#1721,l_orderkey_and_l_linenumber_prf#1722,l_comment_prf#1723,l_linestatus_prf#1724,rid#1725,l_shipmode_prf#1726,l_shipinstruct_prf#1727,l_quantity_prf#1728,l_receiptdate_prf#1729,l_linenumber_prf#1730,l_tax_prf#1731,l_shipdate_prf#1732,l_extendedprice_prf#1733,l_partkey_prf#1734,l_discount_prf#1735,l_partkey_and_l_suppkey_prf#1736,l_commitdate_prf#1737,l_suppkey_prf#1738,l_orderkey_prf#1739] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#1760 AS o_shippriority_prf_2#1770, rid#1761 AS rid_2#1771, o_orderdate_prf#1762 AS o_orderdate_prf_2#1772, o_custkey_prf#1763 AS o_custkey_prf_2#1773, o_orderpriority_prf#1764 AS o_orderpriority_prf_2#1774, o_clerk_prf#1765 AS o_clerk_prf_2#1775, o_orderstatus_prf#1766 AS o_orderstatus_prf_2#1776, o_totalprice_prf#1767 AS o_totalprice_prf_2#1777, o_orderkey_prf#1768 AS o_orderkey_prf_2#1778, o_comment_prf#1769 AS o_comment_prf_2#1779]
               +- Relation[o_shippriority_prf#1760,rid#1761,o_orderdate_prf#1762,o_custkey_prf#1763,o_orderpriority_prf#1764,o_clerk_prf#1765,o_orderstatus_prf#1766,o_totalprice_prf#1767,o_orderkey_prf#1768,o_comment_prf#1769] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 175515ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/11 03:25:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:25:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1837L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 03:25:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1837L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#1839 AS l_returnflag_prf_0#1858, l_orderkey_and_l_linenumber_prf#1840 AS l_orderkey_and_l_linenumber_prf_0#1859, l_comment_prf#1841 AS l_comment_prf_0#1860, l_linestatus_prf#1842 AS l_linestatus_prf_0#1861, rid#1843 AS rid_0#1862, l_shipmode_prf#1844 AS l_shipmode_prf_0#1863, l_shipinstruct_prf#1845 AS l_shipinstruct_prf_0#1864, l_quantity_prf#1846 AS l_quantity_prf_0#1865, l_receiptdate_prf#1847 AS l_receiptdate_prf_0#1866, l_linenumber_prf#1848 AS l_linenumber_prf_0#1867, l_tax_prf#1849 AS l_tax_prf_0#1868, l_shipdate_prf#1850 AS l_shipdate_prf_0#1869, l_extendedprice_prf#1851 AS l_extendedprice_prf_0#1870, l_partkey_prf#1852 AS l_partkey_prf_0#1871, l_discount_prf#1853 AS l_discount_prf_0#1872, l_partkey_and_l_suppkey_prf#1854 AS l_partkey_and_l_suppkey_prf_0#1873, l_commitdate_prf#1855 AS l_commitdate_prf_0#1874, l_suppkey_prf#1856 AS l_suppkey_prf_0#1875, l_orderkey_prf#1857 AS l_orderkey_prf_0#1876]
         :  +- Relation[l_returnflag_prf#1839,l_orderkey_and_l_linenumber_prf#1840,l_comment_prf#1841,l_linestatus_prf#1842,rid#1843,l_shipmode_prf#1844,l_shipinstruct_prf#1845,l_quantity_prf#1846,l_receiptdate_prf#1847,l_linenumber_prf#1848,l_tax_prf#1849,l_shipdate_prf#1850,l_extendedprice_prf#1851,l_partkey_prf#1852,l_discount_prf#1853,l_partkey_and_l_suppkey_prf#1854,l_commitdate_prf#1855,l_suppkey_prf#1856,l_orderkey_prf#1857] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1879]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1877,value#1878] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 23992ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/11 03:26:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:26:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1927L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 03:26:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1927L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#1968]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#1952: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#1929 AS l_returnflag_prf_0#1948, l_orderkey_and_l_linenumber_prf#1930 AS l_orderkey_and_l_linenumber_prf_0#1949, l_comment_prf#1931 AS l_comment_prf_0#1950, l_linestatus_prf#1932 AS l_linestatus_prf_0#1951, rid#1933 AS rid_0#1952, l_shipmode_prf#1934 AS l_shipmode_prf_0#1953, l_shipinstruct_prf#1935 AS l_shipinstruct_prf_0#1954, l_quantity_prf#1936 AS l_quantity_prf_0#1955, l_receiptdate_prf#1937 AS l_receiptdate_prf_0#1956, l_linenumber_prf#1938 AS l_linenumber_prf_0#1957, l_tax_prf#1939 AS l_tax_prf_0#1958, l_shipdate_prf#1940 AS l_shipdate_prf_0#1959, l_extendedprice_prf#1941 AS l_extendedprice_prf_0#1960, l_partkey_prf#1942 AS l_partkey_prf_0#1961, l_discount_prf#1943 AS l_discount_prf_0#1962, l_partkey_and_l_suppkey_prf#1944 AS l_partkey_and_l_suppkey_prf_0#1963, l_commitdate_prf#1945 AS l_commitdate_prf_0#1964, l_suppkey_prf#1946 AS l_suppkey_prf_0#1965, l_orderkey_prf#1947 AS l_orderkey_prf_0#1966]
         :     :  :  +- Relation[l_returnflag_prf#1929,l_orderkey_and_l_linenumber_prf#1930,l_comment_prf#1931,l_linestatus_prf#1932,rid#1933,l_shipmode_prf#1934,l_shipinstruct_prf#1935,l_quantity_prf#1936,l_receiptdate_prf#1937,l_linenumber_prf#1938,l_tax_prf#1939,l_shipdate_prf#1940,l_extendedprice_prf#1941,l_partkey_prf#1942,l_discount_prf#1943,l_partkey_and_l_suppkey_prf#1944,l_commitdate_prf#1945,l_suppkey_prf#1946,l_orderkey_prf#1947] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1967]
         :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :        +- Relation[label#1877,value#1878] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#1969 AS o_shippriority_prf_1#1979, rid#1970 AS rid_1#1980, o_orderdate_prf#1971 AS o_orderdate_prf_1#1981, o_custkey_prf#1972 AS o_custkey_prf_1#1982, o_orderpriority_prf#1973 AS o_orderpriority_prf_1#1983, o_clerk_prf#1974 AS o_clerk_prf_1#1984, o_orderstatus_prf#1975 AS o_orderstatus_prf_1#1985, o_totalprice_prf#1976 AS o_totalprice_prf_1#1986, o_orderkey_prf#1977 AS o_orderkey_prf_1#1987, o_comment_prf#1978 AS o_comment_prf_1#1988]
            +- Relation[o_shippriority_prf#1969,rid#1970,o_orderdate_prf#1971,o_custkey_prf#1972,o_orderpriority_prf#1973,o_clerk_prf#1974,o_orderstatus_prf#1975,o_totalprice_prf#1976,o_orderkey_prf#1977,o_comment_prf#1978] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 57367ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/11 03:27:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:27:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2033L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 03:27:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2033L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#2045]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#2040: string
         :     :- Project [rid#2035 AS rid_0#2040, n_regionkey_prf#2036 AS n_regionkey_prf_0#2041, n_nationkey_prf#2037 AS n_nationkey_prf_0#2042, n_name_prf#2038 AS n_name_prf_0#2043, n_comment_prf#2039 AS n_comment_prf_0#2044]
         :     :  +- Relation[rid#2035,n_regionkey_prf#2036,n_nationkey_prf#2037,n_name_prf#2038,n_comment_prf#2039] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2046 AS c_acctbal_prf_1#2055, rid#2047 AS rid_1#2056, c_name_prf#2048 AS c_name_prf_1#2057, c_nationkey_prf#2049 AS c_nationkey_prf_1#2058, c_custkey_prf#2050 AS c_custkey_prf_1#2059, c_comment_prf#2051 AS c_comment_prf_1#2060, c_address_prf#2052 AS c_address_prf_1#2061, c_mktsegment_prf#2053 AS c_mktsegment_prf_1#2062, c_phone_prf#2054 AS c_phone_prf_1#2063]
            +- Relation[c_acctbal_prf#2046,rid#2047,c_name_prf#2048,c_nationkey_prf#2049,c_custkey_prf#2050,c_comment_prf#2051,c_address_prf#2052,c_mktsegment_prf#2053,c_phone_prf#2054] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=150000
Elapsed time: 1935ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/11 03:27:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:27:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2102L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 03:27:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2102L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#2120]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#2113: string
         :     :- Project [s_phone_prf#2104 AS s_phone_prf_0#2112, rid#2105 AS rid_0#2113, s_address_prf#2106 AS s_address_prf_0#2114, s_nationkey_prf#2107 AS s_nationkey_prf_0#2115, s_suppkey_prf#2108 AS s_suppkey_prf_0#2116, s_name_prf#2109 AS s_name_prf_0#2117, s_acctbal_prf#2110 AS s_acctbal_prf_0#2118, s_comment_prf#2111 AS s_comment_prf_0#2119]
         :     :  +- Relation[s_phone_prf#2104,rid#2105,s_address_prf#2106,s_nationkey_prf#2107,s_suppkey_prf#2108,s_name_prf#2109,s_acctbal_prf#2110,s_comment_prf#2111] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1545) AS rid_2#2135]
            :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_1#2129: string
            :     :- Project [ps_partkey_and_ps_suppkey_prf#2121 AS ps_partkey_and_ps_suppkey_prf_1#2128, rid#2122 AS rid_1#2129, ps_availqty_prf#2123 AS ps_availqty_prf_1#2130, ps_comment_prf#2124 AS ps_comment_prf_1#2131, ps_partkey_prf#2125 AS ps_partkey_prf_1#2132, ps_supplycost_prf#2126 AS ps_supplycost_prf_1#2133, ps_suppkey_prf#2127 AS ps_suppkey_prf_1#2134]
            :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2121,rid#2122,ps_availqty_prf#2123,ps_comment_prf#2124,ps_partkey_prf#2125,ps_supplycost_prf#2126,ps_suppkey_prf#2127] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#2136 AS p_comment_prf_2#2146, p_name_prf#2137 AS p_name_prf_2#2147, rid#2138 AS rid_2#2148, p_type_prf#2139 AS p_type_prf_2#2149, p_retailprice_prf#2140 AS p_retailprice_prf_2#2150, p_mfgr_prf#2141 AS p_mfgr_prf_2#2151, p_container_prf#2142 AS p_container_prf_2#2152, p_brand_prf#2143 AS p_brand_prf_2#2153, p_size_prf#2144 AS p_size_prf_2#2154, p_partkey_prf#2145 AS p_partkey_prf_2#2155]
               +- Relation[p_comment_prf#2136,p_name_prf#2137,rid#2138,p_type_prf#2139,p_retailprice_prf#2140,p_mfgr_prf#2141,p_container_prf#2142,p_brand_prf#2143,p_size_prf#2144,p_partkey_prf#2145] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 62396ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/11 03:28:19 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:28:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2217L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 03:28:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2217L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#2237]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2229: string
         :     :- Project [c_acctbal_prf#2219 AS c_acctbal_prf_0#2228, rid#2220 AS rid_0#2229, c_name_prf#2221 AS c_name_prf_0#2230, c_nationkey_prf#2222 AS c_nationkey_prf_0#2231, c_custkey_prf#2223 AS c_custkey_prf_0#2232, c_comment_prf#2224 AS c_comment_prf_0#2233, c_address_prf#2225 AS c_address_prf_0#2234, c_mktsegment_prf#2226 AS c_mktsegment_prf_0#2235, c_phone_prf#2227 AS c_phone_prf_0#2236]
         :     :  +- Relation[c_acctbal_prf#2219,rid#2220,c_name_prf#2221,c_nationkey_prf#2222,c_custkey_prf#2223,c_comment_prf#2224,c_address_prf#2225,c_mktsegment_prf#2226,c_phone_prf#2227] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1545) AS rid_2#2258]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#2249: string
            :     :- Project [o_shippriority_prf#2238 AS o_shippriority_prf_1#2248, rid#2239 AS rid_1#2249, o_orderdate_prf#2240 AS o_orderdate_prf_1#2250, o_custkey_prf#2241 AS o_custkey_prf_1#2251, o_orderpriority_prf#2242 AS o_orderpriority_prf_1#2252, o_clerk_prf#2243 AS o_clerk_prf_1#2253, o_orderstatus_prf#2244 AS o_orderstatus_prf_1#2254, o_totalprice_prf#2245 AS o_totalprice_prf_1#2255, o_orderkey_prf#2246 AS o_orderkey_prf_1#2256, o_comment_prf#2247 AS o_comment_prf_1#2257]
            :     :  +- Relation[o_shippriority_prf#2238,rid#2239,o_orderdate_prf#2240,o_custkey_prf#2241,o_orderpriority_prf#2242,o_clerk_prf#2243,o_orderstatus_prf#2244,o_totalprice_prf#2245,o_orderkey_prf#2246,o_comment_prf#2247] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2259 AS l_returnflag_prf_2#2278, l_orderkey_and_l_linenumber_prf#2260 AS l_orderkey_and_l_linenumber_prf_2#2279, l_comment_prf#2261 AS l_comment_prf_2#2280, l_linestatus_prf#2262 AS l_linestatus_prf_2#2281, rid#2263 AS rid_2#2282, l_shipmode_prf#2264 AS l_shipmode_prf_2#2283, l_shipinstruct_prf#2265 AS l_shipinstruct_prf_2#2284, l_quantity_prf#2266 AS l_quantity_prf_2#2285, l_receiptdate_prf#2267 AS l_receiptdate_prf_2#2286, l_linenumber_prf#2268 AS l_linenumber_prf_2#2287, l_tax_prf#2269 AS l_tax_prf_2#2288, l_shipdate_prf#2270 AS l_shipdate_prf_2#2289, l_extendedprice_prf#2271 AS l_extendedprice_prf_2#2290, l_partkey_prf#2272 AS l_partkey_prf_2#2291, l_discount_prf#2273 AS l_discount_prf_2#2292, l_partkey_and_l_suppkey_prf#2274 AS l_partkey_and_l_suppkey_prf_2#2293, l_commitdate_prf#2275 AS l_commitdate_prf_2#2294, l_suppkey_prf#2276 AS l_suppkey_prf_2#2295, l_orderkey_prf#2277 AS l_orderkey_prf_2#2296]
               +- Relation[l_returnflag_prf#2259,l_orderkey_and_l_linenumber_prf#2260,l_comment_prf#2261,l_linestatus_prf#2262,rid#2263,l_shipmode_prf#2264,l_shipinstruct_prf#2265,l_quantity_prf#2266,l_receiptdate_prf#2267,l_linenumber_prf#2268,l_tax_prf#2269,l_shipdate_prf#2270,l_extendedprice_prf#2271,l_partkey_prf#2272,l_discount_prf#2273,l_partkey_and_l_suppkey_prf#2274,l_commitdate_prf#2275,l_suppkey_prf#2276,l_orderkey_prf#2277] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 237985ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/11 03:32:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:32:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2363L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 03:32:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2363L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#2403]
         :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#2388: string
         :     :- Project [l_returnflag_prf#2365 AS l_returnflag_prf_0#2384, l_orderkey_and_l_linenumber_prf#2366 AS l_orderkey_and_l_linenumber_prf_0#2385, l_comment_prf#2367 AS l_comment_prf_0#2386, l_linestatus_prf#2368 AS l_linestatus_prf_0#2387, rid#2369 AS rid_0#2388, l_shipmode_prf#2370 AS l_shipmode_prf_0#2389, l_shipinstruct_prf#2371 AS l_shipinstruct_prf_0#2390, l_quantity_prf#2372 AS l_quantity_prf_0#2391, l_receiptdate_prf#2373 AS l_receiptdate_prf_0#2392, l_linenumber_prf#2374 AS l_linenumber_prf_0#2393, l_tax_prf#2375 AS l_tax_prf_0#2394, l_shipdate_prf#2376 AS l_shipdate_prf_0#2395, l_extendedprice_prf#2377 AS l_extendedprice_prf_0#2396, l_partkey_prf#2378 AS l_partkey_prf_0#2397, l_discount_prf#2379 AS l_discount_prf_0#2398, l_partkey_and_l_suppkey_prf#2380 AS l_partkey_and_l_suppkey_prf_0#2399, l_commitdate_prf#2381 AS l_commitdate_prf_0#2400, l_suppkey_prf#2382 AS l_suppkey_prf_0#2401, l_orderkey_prf#2383 AS l_orderkey_prf_0#2402]
         :     :  +- Relation[l_returnflag_prf#2365,l_orderkey_and_l_linenumber_prf#2366,l_comment_prf#2367,l_linestatus_prf#2368,rid#2369,l_shipmode_prf#2370,l_shipinstruct_prf#2371,l_quantity_prf#2372,l_receiptdate_prf#2373,l_linenumber_prf#2374,l_tax_prf#2375,l_shipdate_prf#2376,l_extendedprice_prf#2377,l_partkey_prf#2378,l_discount_prf#2379,l_partkey_and_l_suppkey_prf#2380,l_commitdate_prf#2381,l_suppkey_prf#2382,l_orderkey_prf#2383] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#2404 AS p_comment_prf_1#2414, p_name_prf#2405 AS p_name_prf_1#2415, rid#2406 AS rid_1#2416, p_type_prf#2407 AS p_type_prf_1#2417, p_retailprice_prf#2408 AS p_retailprice_prf_1#2418, p_mfgr_prf#2409 AS p_mfgr_prf_1#2419, p_container_prf#2410 AS p_container_prf_1#2420, p_brand_prf#2411 AS p_brand_prf_1#2421, p_size_prf#2412 AS p_size_prf_1#2422, p_partkey_prf#2413 AS p_partkey_prf_1#2423]
            +- Relation[p_comment_prf#2404,p_name_prf#2405,rid#2406,p_type_prf#2407,p_retailprice_prf#2408,p_mfgr_prf#2409,p_container_prf#2410,p_brand_prf#2411,p_size_prf#2412,p_partkey_prf#2413] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 129417ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/11 03:34:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:34:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2472L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 03:34:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2472L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#2474 AS l_returnflag_prf_0#2493, l_orderkey_and_l_linenumber_prf#2475 AS l_orderkey_and_l_linenumber_prf_0#2494, l_comment_prf#2476 AS l_comment_prf_0#2495, l_linestatus_prf#2477 AS l_linestatus_prf_0#2496, rid#2478 AS rid_0#2497, l_shipmode_prf#2479 AS l_shipmode_prf_0#2498, l_shipinstruct_prf#2480 AS l_shipinstruct_prf_0#2499, l_quantity_prf#2481 AS l_quantity_prf_0#2500, l_receiptdate_prf#2482 AS l_receiptdate_prf_0#2501, l_linenumber_prf#2483 AS l_linenumber_prf_0#2502, l_tax_prf#2484 AS l_tax_prf_0#2503, l_shipdate_prf#2485 AS l_shipdate_prf_0#2504, l_extendedprice_prf#2486 AS l_extendedprice_prf_0#2505, l_partkey_prf#2487 AS l_partkey_prf_0#2506, l_discount_prf#2488 AS l_discount_prf_0#2507, l_partkey_and_l_suppkey_prf#2489 AS l_partkey_and_l_suppkey_prf_0#2508, l_commitdate_prf#2490 AS l_commitdate_prf_0#2509, l_suppkey_prf#2491 AS l_suppkey_prf_0#2510, l_orderkey_prf#2492 AS l_orderkey_prf_0#2511]
         :  +- Relation[l_returnflag_prf#2474,l_orderkey_and_l_linenumber_prf#2475,l_comment_prf#2476,l_linestatus_prf#2477,rid#2478,l_shipmode_prf#2479,l_shipinstruct_prf#2480,l_quantity_prf#2481,l_receiptdate_prf#2482,l_linenumber_prf#2483,l_tax_prf#2484,l_shipdate_prf#2485,l_extendedprice_prf#2486,l_partkey_prf#2487,l_discount_prf#2488,l_partkey_and_l_suppkey_prf#2489,l_commitdate_prf#2490,l_suppkey_prf#2491,l_orderkey_prf#2492] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2512]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1877,value#1878] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 13957ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/11 03:34:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:34:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2556L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 03:34:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2556L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1545) AS rid_2#2593]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#2572]
         :     :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#2566: string
         :     :  :     :- Project [ps_partkey_and_ps_suppkey_prf#2558 AS ps_partkey_and_ps_suppkey_prf_0#2565, rid#2559 AS rid_0#2566, ps_availqty_prf#2560 AS ps_availqty_prf_0#2567, ps_comment_prf#2561 AS ps_comment_prf_0#2568, ps_partkey_prf#2562 AS ps_partkey_prf_0#2569, ps_supplycost_prf#2563 AS ps_supplycost_prf_0#2570, ps_suppkey_prf#2564 AS ps_suppkey_prf_0#2571]
         :     :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2558,rid#2559,ps_availqty_prf#2560,ps_comment_prf#2561,ps_partkey_prf#2562,ps_supplycost_prf#2563,ps_suppkey_prf#2564] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#2573 AS p_comment_prf_1#2583, p_name_prf#2574 AS p_name_prf_1#2584, rid#2575 AS rid_1#2585, p_type_prf#2576 AS p_type_prf_1#2586, p_retailprice_prf#2577 AS p_retailprice_prf_1#2587, p_mfgr_prf#2578 AS p_mfgr_prf_1#2588, p_container_prf#2579 AS p_container_prf_1#2589, p_brand_prf#2580 AS p_brand_prf_1#2590, p_size_prf#2581 AS p_size_prf_1#2591, p_partkey_prf#2582 AS p_partkey_prf_1#2592]
         :     :     +- Relation[p_comment_prf#2573,p_name_prf#2574,rid#2575,p_type_prf#2576,p_retailprice_prf#2577,p_mfgr_prf#2578,p_container_prf#2579,p_brand_prf#2580,p_size_prf#2581,p_partkey_prf#2582] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2594 AS s_phone_prf_2#2602, rid#2595 AS rid_2#2603, s_address_prf#2596 AS s_address_prf_2#2604, s_nationkey_prf#2597 AS s_nationkey_prf_2#2605, s_suppkey_prf#2598 AS s_suppkey_prf_2#2606, s_name_prf#2599 AS s_name_prf_2#2607, s_acctbal_prf#2600 AS s_acctbal_prf_2#2608, s_comment_prf#2601 AS s_comment_prf_2#2609]
            +- Relation[s_phone_prf#2594,rid#2595,s_address_prf#2596,s_nationkey_prf#2597,s_suppkey_prf#2598,s_name_prf#2599,s_acctbal_prf#2600,s_comment_prf#2601] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 109574ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/11 03:36:29 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:36:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2647L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 03:36:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2647L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#2649 AS p_comment_prf_0#2659, p_name_prf#2650 AS p_name_prf_0#2660, rid#2651 AS rid_0#2661, p_type_prf#2652 AS p_type_prf_0#2662, p_retailprice_prf#2653 AS p_retailprice_prf_0#2663, p_mfgr_prf#2654 AS p_mfgr_prf_0#2664, p_container_prf#2655 AS p_container_prf_0#2665, p_brand_prf#2656 AS p_brand_prf_0#2666, p_size_prf#2657 AS p_size_prf_0#2667, p_partkey_prf#2658 AS p_partkey_prf_0#2668]
         :  +- Relation[p_comment_prf#2649,p_name_prf#2650,rid#2651,p_type_prf#2652,p_retailprice_prf#2653,p_mfgr_prf#2654,p_container_prf#2655,p_brand_prf#2656,p_size_prf#2657,p_partkey_prf#2658] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2669]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1877,value#1878] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1451
Elapsed time: 84ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/11 03:36:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:36:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2708L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 03:36:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2708L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#2748]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2733: string
         :     :- Project [l_returnflag_prf#2710 AS l_returnflag_prf_0#2729, l_orderkey_and_l_linenumber_prf#2711 AS l_orderkey_and_l_linenumber_prf_0#2730, l_comment_prf#2712 AS l_comment_prf_0#2731, l_linestatus_prf#2713 AS l_linestatus_prf_0#2732, rid#2714 AS rid_0#2733, l_shipmode_prf#2715 AS l_shipmode_prf_0#2734, l_shipinstruct_prf#2716 AS l_shipinstruct_prf_0#2735, l_quantity_prf#2717 AS l_quantity_prf_0#2736, l_receiptdate_prf#2718 AS l_receiptdate_prf_0#2737, l_linenumber_prf#2719 AS l_linenumber_prf_0#2738, l_tax_prf#2720 AS l_tax_prf_0#2739, l_shipdate_prf#2721 AS l_shipdate_prf_0#2740, l_extendedprice_prf#2722 AS l_extendedprice_prf_0#2741, l_partkey_prf#2723 AS l_partkey_prf_0#2742, l_discount_prf#2724 AS l_discount_prf_0#2743, l_partkey_and_l_suppkey_prf#2725 AS l_partkey_and_l_suppkey_prf_0#2744, l_commitdate_prf#2726 AS l_commitdate_prf_0#2745, l_suppkey_prf#2727 AS l_suppkey_prf_0#2746, l_orderkey_prf#2728 AS l_orderkey_prf_0#2747]
         :     :  +- Relation[l_returnflag_prf#2710,l_orderkey_and_l_linenumber_prf#2711,l_comment_prf#2712,l_linestatus_prf#2713,rid#2714,l_shipmode_prf#2715,l_shipinstruct_prf#2716,l_quantity_prf#2717,l_receiptdate_prf#2718,l_linenumber_prf#2719,l_tax_prf#2720,l_shipdate_prf#2721,l_extendedprice_prf#2722,l_partkey_prf#2723,l_discount_prf#2724,l_partkey_and_l_suppkey_prf#2725,l_commitdate_prf#2726,l_suppkey_prf#2727,l_orderkey_prf#2728] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2749 AS o_shippriority_prf_1#2759, rid#2750 AS rid_1#2760, o_orderdate_prf#2751 AS o_orderdate_prf_1#2761, o_custkey_prf#2752 AS o_custkey_prf_1#2762, o_orderpriority_prf#2753 AS o_orderpriority_prf_1#2763, o_clerk_prf#2754 AS o_clerk_prf_1#2764, o_orderstatus_prf#2755 AS o_orderstatus_prf_1#2765, o_totalprice_prf#2756 AS o_totalprice_prf_1#2766, o_orderkey_prf#2757 AS o_orderkey_prf_1#2767, o_comment_prf#2758 AS o_comment_prf_1#2768]
            +- Relation[o_shippriority_prf#2749,rid#2750,o_orderdate_prf#2751,o_custkey_prf#2752,o_orderpriority_prf#2753,o_clerk_prf#2754,o_orderstatus_prf#2755,o_totalprice_prf#2756,o_orderkey_prf#2757,o_comment_prf#2758] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 130811ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/11 03:38:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:38:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2815L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 03:38:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2815L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#2831]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#2825: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#2817 AS ps_partkey_and_ps_suppkey_prf_0#2824, rid#2818 AS rid_0#2825, ps_availqty_prf#2819 AS ps_availqty_prf_0#2826, ps_comment_prf#2820 AS ps_comment_prf_0#2827, ps_partkey_prf#2821 AS ps_partkey_prf_0#2828, ps_supplycost_prf#2822 AS ps_supplycost_prf_0#2829, ps_suppkey_prf#2823 AS ps_suppkey_prf_0#2830]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2817,rid#2818,ps_availqty_prf#2819,ps_comment_prf#2820,ps_partkey_prf#2821,ps_supplycost_prf#2822,ps_suppkey_prf#2823] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#2832 AS p_comment_prf_1#2842, p_name_prf#2833 AS p_name_prf_1#2843, rid#2834 AS rid_1#2844, p_type_prf#2835 AS p_type_prf_1#2845, p_retailprice_prf#2836 AS p_retailprice_prf_1#2846, p_mfgr_prf#2837 AS p_mfgr_prf_1#2847, p_container_prf#2838 AS p_container_prf_1#2848, p_brand_prf#2839 AS p_brand_prf_1#2849, p_size_prf#2840 AS p_size_prf_1#2850, p_partkey_prf#2841 AS p_partkey_prf_1#2851]
            :  +- Relation[p_comment_prf#2832,p_name_prf#2833,rid#2834,p_type_prf#2835,p_retailprice_prf#2836,p_mfgr_prf#2837,p_container_prf#2838,p_brand_prf#2839,p_size_prf#2840,p_partkey_prf#2841] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2852]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1877,value#1878] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 50461ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/11 03:39:31 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:39:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2905L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 03:39:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2905L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#2927]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2919: string
         :     :  :     :- Project [p_comment_prf#2907 AS p_comment_prf_0#2917, p_name_prf#2908 AS p_name_prf_0#2918, rid#2909 AS rid_0#2919, p_type_prf#2910 AS p_type_prf_0#2920, p_retailprice_prf#2911 AS p_retailprice_prf_0#2921, p_mfgr_prf#2912 AS p_mfgr_prf_0#2922, p_container_prf#2913 AS p_container_prf_0#2923, p_brand_prf#2914 AS p_brand_prf_0#2924, p_size_prf#2915 AS p_size_prf_0#2925, p_partkey_prf#2916 AS p_partkey_prf_0#2926]
         :     :  :     :  +- Relation[p_comment_prf#2907,p_name_prf#2908,rid#2909,p_type_prf#2910,p_retailprice_prf#2911,p_mfgr_prf#2912,p_container_prf#2913,p_brand_prf#2914,p_size_prf#2915,p_partkey_prf#2916] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#2928 AS l_returnflag_prf_1#2947, l_orderkey_and_l_linenumber_prf#2929 AS l_orderkey_and_l_linenumber_prf_1#2948, l_comment_prf#2930 AS l_comment_prf_1#2949, l_linestatus_prf#2931 AS l_linestatus_prf_1#2950, rid#2932 AS rid_1#2951, l_shipmode_prf#2933 AS l_shipmode_prf_1#2952, l_shipinstruct_prf#2934 AS l_shipinstruct_prf_1#2953, l_quantity_prf#2935 AS l_quantity_prf_1#2954, l_receiptdate_prf#2936 AS l_receiptdate_prf_1#2955, l_linenumber_prf#2937 AS l_linenumber_prf_1#2956, l_tax_prf#2938 AS l_tax_prf_1#2957, l_shipdate_prf#2939 AS l_shipdate_prf_1#2958, l_extendedprice_prf#2940 AS l_extendedprice_prf_1#2959, l_partkey_prf#2941 AS l_partkey_prf_1#2960, l_discount_prf#2942 AS l_discount_prf_1#2961, l_partkey_and_l_suppkey_prf#2943 AS l_partkey_and_l_suppkey_prf_1#2962, l_commitdate_prf#2944 AS l_commitdate_prf_1#2963, l_suppkey_prf#2945 AS l_suppkey_prf_1#2964, l_orderkey_prf#2946 AS l_orderkey_prf_1#2965]
         :     :     +- Relation[l_returnflag_prf#2928,l_orderkey_and_l_linenumber_prf#2929,l_comment_prf#2930,l_linestatus_prf#2931,rid#2932,l_shipmode_prf#2933,l_shipinstruct_prf#2934,l_quantity_prf#2935,l_receiptdate_prf#2936,l_linenumber_prf#2937,l_tax_prf#2938,l_shipdate_prf#2939,l_extendedprice_prf#2940,l_partkey_prf#2941,l_discount_prf#2942,l_partkey_and_l_suppkey_prf#2943,l_commitdate_prf#2944,l_suppkey_prf#2945,l_orderkey_prf#2946] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2967 AS s_phone_prf_2#2975, rid#2968 AS rid_2#2976, s_address_prf#2969 AS s_address_prf_2#2977, s_nationkey_prf#2970 AS s_nationkey_prf_2#2978, s_suppkey_prf#2971 AS s_suppkey_prf_2#2979, s_name_prf#2972 AS s_name_prf_2#2980, s_acctbal_prf#2973 AS s_acctbal_prf_2#2981, s_comment_prf#2974 AS s_comment_prf_2#2982]
            +- Relation[s_phone_prf#2967,rid#2968,s_address_prf#2969,s_nationkey_prf#2970,s_suppkey_prf#2971,s_name_prf#2972,s_acctbal_prf#2973,s_comment_prf#2974] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 314013ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/11 03:44:45 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:44:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3048L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 03:44:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3048L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#3070]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#3061: string
         :     :- Project [o_shippriority_prf#3050 AS o_shippriority_prf_0#3060, rid#3051 AS rid_0#3061, o_orderdate_prf#3052 AS o_orderdate_prf_0#3062, o_custkey_prf#3053 AS o_custkey_prf_0#3063, o_orderpriority_prf#3054 AS o_orderpriority_prf_0#3064, o_clerk_prf#3055 AS o_clerk_prf_0#3065, o_orderstatus_prf#3056 AS o_orderstatus_prf_0#3066, o_totalprice_prf#3057 AS o_totalprice_prf_0#3067, o_orderkey_prf#3058 AS o_orderkey_prf_0#3068, o_comment_prf#3059 AS o_comment_prf_0#3069]
         :     :  +- Relation[o_shippriority_prf#3050,rid#3051,o_orderdate_prf#3052,o_custkey_prf#3053,o_orderpriority_prf#3054,o_clerk_prf#3055,o_orderstatus_prf#3056,o_totalprice_prf#3057,o_orderkey_prf#3058,o_comment_prf#3059] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#3071 AS l_returnflag_prf_1#3090, l_orderkey_and_l_linenumber_prf#3072 AS l_orderkey_and_l_linenumber_prf_1#3091, l_comment_prf#3073 AS l_comment_prf_1#3092, l_linestatus_prf#3074 AS l_linestatus_prf_1#3093, rid#3075 AS rid_1#3094, l_shipmode_prf#3076 AS l_shipmode_prf_1#3095, l_shipinstruct_prf#3077 AS l_shipinstruct_prf_1#3096, l_quantity_prf#3078 AS l_quantity_prf_1#3097, l_receiptdate_prf#3079 AS l_receiptdate_prf_1#3098, l_linenumber_prf#3080 AS l_linenumber_prf_1#3099, l_tax_prf#3081 AS l_tax_prf_1#3100, l_shipdate_prf#3082 AS l_shipdate_prf_1#3101, l_extendedprice_prf#3083 AS l_extendedprice_prf_1#3102, l_partkey_prf#3084 AS l_partkey_prf_1#3103, l_discount_prf#3085 AS l_discount_prf_1#3104, l_partkey_and_l_suppkey_prf#3086 AS l_partkey_and_l_suppkey_prf_1#3105, l_commitdate_prf#3087 AS l_commitdate_prf_1#3106, l_suppkey_prf#3088 AS l_suppkey_prf_1#3107, l_orderkey_prf#3089 AS l_orderkey_prf_1#3108]
            :  +- Relation[l_returnflag_prf#3071,l_orderkey_and_l_linenumber_prf#3072,l_comment_prf#3073,l_linestatus_prf#3074,rid#3075,l_shipmode_prf#3076,l_shipinstruct_prf#3077,l_quantity_prf#3078,l_receiptdate_prf#3079,l_linenumber_prf#3080,l_tax_prf#3081,l_shipdate_prf#3082,l_extendedprice_prf#3083,l_partkey_prf#3084,l_discount_prf#3085,l_partkey_and_l_suppkey_prf#3086,l_commitdate_prf#3087,l_suppkey_prf#3088,l_orderkey_prf#3089] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3109]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1877,value#1878] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 201351ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/11 03:48:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:48:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3163L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 03:48:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3163L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#3179]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, rid_0#3173: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#3165 AS ps_partkey_and_ps_suppkey_prf_0#3172, rid#3166 AS rid_0#3173, ps_availqty_prf#3167 AS ps_availqty_prf_0#3174, ps_comment_prf#3168 AS ps_comment_prf_0#3175, ps_partkey_prf#3169 AS ps_partkey_prf_0#3176, ps_supplycost_prf#3170 AS ps_supplycost_prf_0#3177, ps_suppkey_prf#3171 AS ps_suppkey_prf_0#3178]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#3165,rid#3166,ps_availqty_prf#3167,ps_comment_prf#3168,ps_partkey_prf#3169,ps_supplycost_prf#3170,ps_suppkey_prf#3171] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3180 AS l_returnflag_prf_1#3199, l_orderkey_and_l_linenumber_prf#3181 AS l_orderkey_and_l_linenumber_prf_1#3200, l_comment_prf#3182 AS l_comment_prf_1#3201, l_linestatus_prf#3183 AS l_linestatus_prf_1#3202, rid#3184 AS rid_1#3203, l_shipmode_prf#3185 AS l_shipmode_prf_1#3204, l_shipinstruct_prf#3186 AS l_shipinstruct_prf_1#3205, l_quantity_prf#3187 AS l_quantity_prf_1#3206, l_receiptdate_prf#3188 AS l_receiptdate_prf_1#3207, l_linenumber_prf#3189 AS l_linenumber_prf_1#3208, l_tax_prf#3190 AS l_tax_prf_1#3209, l_shipdate_prf#3191 AS l_shipdate_prf_1#3210, l_extendedprice_prf#3192 AS l_extendedprice_prf_1#3211, l_partkey_prf#3193 AS l_partkey_prf_1#3212, l_discount_prf#3194 AS l_discount_prf_1#3213, l_partkey_and_l_suppkey_prf#3195 AS l_partkey_and_l_suppkey_prf_1#3214, l_commitdate_prf#3196 AS l_commitdate_prf_1#3215, l_suppkey_prf#3197 AS l_suppkey_prf_1#3216, l_orderkey_prf#3198 AS l_orderkey_prf_1#3217]
            +- Relation[l_returnflag_prf#3180,l_orderkey_and_l_linenumber_prf#3181,l_comment_prf#3182,l_linestatus_prf#3183,rid#3184,l_shipmode_prf#3185,l_shipinstruct_prf#3186,l_quantity_prf#3187,l_receiptdate_prf#3188,l_linenumber_prf#3189,l_tax_prf#3190,l_shipdate_prf#3191,l_extendedprice_prf#3192,l_partkey_prf#3193,l_discount_prf#3194,l_partkey_and_l_suppkey_prf#3195,l_commitdate_prf#3196,l_suppkey_prf#3197,l_orderkey_prf#3198] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 117924ms

f2=
select * from part where p_size = 15
19/10/11 03:50:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:50:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3256L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 03:50:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3256L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#3258 AS p_comment_prf_0#3268, p_name_prf#3259 AS p_name_prf_0#3269, rid#3260 AS rid_0#3270, p_type_prf#3261 AS p_type_prf_0#3271, p_retailprice_prf#3262 AS p_retailprice_prf_0#3272, p_mfgr_prf#3263 AS p_mfgr_prf_0#3273, p_container_prf#3264 AS p_container_prf_0#3274, p_brand_prf#3265 AS p_brand_prf_0#3275, p_size_prf#3266 AS p_size_prf_0#3276, p_partkey_prf#3267 AS p_partkey_prf_0#3277]
         :  +- Relation[p_comment_prf#3258,p_name_prf#3259,rid#3260,p_type_prf#3261,p_retailprice_prf#3262,p_mfgr_prf#3263,p_container_prf#3264,p_brand_prf#3265,p_size_prf#3266,p_partkey_prf#3267] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3278]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1877,value#1878] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3907
Elapsed time: 121ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/11 03:50:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:50:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3317L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 03:50:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3317L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#3339]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#3330: string
         :     :- Project [o_shippriority_prf#3319 AS o_shippriority_prf_0#3329, rid#3320 AS rid_0#3330, o_orderdate_prf#3321 AS o_orderdate_prf_0#3331, o_custkey_prf#3322 AS o_custkey_prf_0#3332, o_orderpriority_prf#3323 AS o_orderpriority_prf_0#3333, o_clerk_prf#3324 AS o_clerk_prf_0#3334, o_orderstatus_prf#3325 AS o_orderstatus_prf_0#3335, o_totalprice_prf#3326 AS o_totalprice_prf_0#3336, o_orderkey_prf#3327 AS o_orderkey_prf_0#3337, o_comment_prf#3328 AS o_comment_prf_0#3338]
         :     :  +- Relation[o_shippriority_prf#3319,rid#3320,o_orderdate_prf#3321,o_custkey_prf#3322,o_orderpriority_prf#3323,o_clerk_prf#3324,o_orderstatus_prf#3325,o_totalprice_prf#3326,o_orderkey_prf#3327,o_comment_prf#3328] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3340 AS l_returnflag_prf_1#3359, l_orderkey_and_l_linenumber_prf#3341 AS l_orderkey_and_l_linenumber_prf_1#3360, l_comment_prf#3342 AS l_comment_prf_1#3361, l_linestatus_prf#3343 AS l_linestatus_prf_1#3362, rid#3344 AS rid_1#3363, l_shipmode_prf#3345 AS l_shipmode_prf_1#3364, l_shipinstruct_prf#3346 AS l_shipinstruct_prf_1#3365, l_quantity_prf#3347 AS l_quantity_prf_1#3366, l_receiptdate_prf#3348 AS l_receiptdate_prf_1#3367, l_linenumber_prf#3349 AS l_linenumber_prf_1#3368, l_tax_prf#3350 AS l_tax_prf_1#3369, l_shipdate_prf#3351 AS l_shipdate_prf_1#3370, l_extendedprice_prf#3352 AS l_extendedprice_prf_1#3371, l_partkey_prf#3353 AS l_partkey_prf_1#3372, l_discount_prf#3354 AS l_discount_prf_1#3373, l_partkey_and_l_suppkey_prf#3355 AS l_partkey_and_l_suppkey_prf_1#3374, l_commitdate_prf#3356 AS l_commitdate_prf_1#3375, l_suppkey_prf#3357 AS l_suppkey_prf_1#3376, l_orderkey_prf#3358 AS l_orderkey_prf_1#3377]
            +- Relation[l_returnflag_prf#3340,l_orderkey_and_l_linenumber_prf#3341,l_comment_prf#3342,l_linestatus_prf#3343,rid#3344,l_shipmode_prf#3345,l_shipinstruct_prf#3346,l_quantity_prf#3347,l_receiptdate_prf#3348,l_linenumber_prf#3349,l_tax_prf#3350,l_shipdate_prf#3351,l_extendedprice_prf#3352,l_partkey_prf#3353,l_discount_prf#3354,l_partkey_and_l_suppkey_prf#3355,l_commitdate_prf#3356,l_suppkey_prf#3357,l_orderkey_prf#3358] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 199376ms

f1=
select * from region where r_name = 'EUROPE'
19/10/11 03:53:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:53:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3413L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/11 03:53:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3413L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#3415 AS r_regionkey_prf_0#3419, r_name_prf#3416 AS r_name_prf_0#3420, r_comment_prf#3417 AS r_comment_prf_0#3421, rid#3418 AS rid_0#3422]
         :  +- Relation[r_regionkey_prf#3415,r_name_prf#3416,r_comment_prf#3417,rid#3418] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3423]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1877,value#1878] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 53ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/11 03:53:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:53:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3463L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 03:53:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3463L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'p_comment_prf_1, 'p_name_prf_1, 'p_type_prf_1, 'p_retailprice_prf_1, ... 6 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#3503]
         :     :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#3488: string
         :     :  :     :- Project [l_returnflag_prf#3465 AS l_returnflag_prf_0#3484, l_orderkey_and_l_linenumber_prf#3466 AS l_orderkey_and_l_linenumber_prf_0#3485, l_comment_prf#3467 AS l_comment_prf_0#3486, l_linestatus_prf#3468 AS l_linestatus_prf_0#3487, rid#3469 AS rid_0#3488, l_shipmode_prf#3470 AS l_shipmode_prf_0#3489, l_shipinstruct_prf#3471 AS l_shipinstruct_prf_0#3490, l_quantity_prf#3472 AS l_quantity_prf_0#3491, l_receiptdate_prf#3473 AS l_receiptdate_prf_0#3492, l_linenumber_prf#3474 AS l_linenumber_prf_0#3493, l_tax_prf#3475 AS l_tax_prf_0#3494, l_shipdate_prf#3476 AS l_shipdate_prf_0#3495, l_extendedprice_prf#3477 AS l_extendedprice_prf_0#3496, l_partkey_prf#3478 AS l_partkey_prf_0#3497, l_discount_prf#3479 AS l_discount_prf_0#3498, l_partkey_and_l_suppkey_prf#3480 AS l_partkey_and_l_suppkey_prf_0#3499, l_commitdate_prf#3481 AS l_commitdate_prf_0#3500, l_suppkey_prf#3482 AS l_suppkey_prf_0#3501, l_orderkey_prf#3483 AS l_orderkey_prf_0#3502]
         :     :  :     :  +- Relation[l_returnflag_prf#3465,l_orderkey_and_l_linenumber_prf#3466,l_comment_prf#3467,l_linestatus_prf#3468,rid#3469,l_shipmode_prf#3470,l_shipinstruct_prf#3471,l_quantity_prf#3472,l_receiptdate_prf#3473,l_linenumber_prf#3474,l_tax_prf#3475,l_shipdate_prf#3476,l_extendedprice_prf#3477,l_partkey_prf#3478,l_discount_prf#3479,l_partkey_and_l_suppkey_prf#3480,l_commitdate_prf#3481,l_suppkey_prf#3482,l_orderkey_prf#3483] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [p_comment_prf#3504 AS p_comment_prf_1#3514, p_name_prf#3505 AS p_name_prf_1#3515, rid#3506 AS rid_1#3516, p_type_prf#3507 AS p_type_prf_1#3517, p_retailprice_prf#3508 AS p_retailprice_prf_1#3518, p_mfgr_prf#3509 AS p_mfgr_prf_1#3519, p_container_prf#3510 AS p_container_prf_1#3520, p_brand_prf#3511 AS p_brand_prf_1#3521, p_size_prf#3512 AS p_size_prf_1#3522, p_partkey_prf#3513 AS p_partkey_prf_1#3523]
         :     :     +- Relation[p_comment_prf#3504,p_name_prf#3505,rid#3506,p_type_prf#3507,p_retailprice_prf#3508,p_mfgr_prf#3509,p_container_prf#3510,p_brand_prf#3511,p_size_prf#3512,p_partkey_prf#3513] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3525 AS s_phone_prf_2#3533, rid#3526 AS rid_2#3534, s_address_prf#3527 AS s_address_prf_2#3535, s_nationkey_prf#3528 AS s_nationkey_prf_2#3536, s_suppkey_prf#3529 AS s_suppkey_prf_2#3537, s_name_prf#3530 AS s_name_prf_2#3538, s_acctbal_prf#3531 AS s_acctbal_prf_2#3539, s_comment_prf#3532 AS s_comment_prf_2#3540]
            +- Relation[s_phone_prf#3525,rid#3526,s_address_prf#3527,s_nationkey_prf#3528,s_suppkey_prf#3529,s_name_prf#3530,s_acctbal_prf#3531,s_comment_prf#3532] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 293208ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/11 03:58:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:58:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3595L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 03:58:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3595L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#3617]
         :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#3609: string
         :     :- Project [p_comment_prf#3597 AS p_comment_prf_0#3607, p_name_prf#3598 AS p_name_prf_0#3608, rid#3599 AS rid_0#3609, p_type_prf#3600 AS p_type_prf_0#3610, p_retailprice_prf#3601 AS p_retailprice_prf_0#3611, p_mfgr_prf#3602 AS p_mfgr_prf_0#3612, p_container_prf#3603 AS p_container_prf_0#3613, p_brand_prf#3604 AS p_brand_prf_0#3614, p_size_prf#3605 AS p_size_prf_0#3615, p_partkey_prf#3606 AS p_partkey_prf_0#3616]
         :     :  +- Relation[p_comment_prf#3597,p_name_prf#3598,rid#3599,p_type_prf#3600,p_retailprice_prf#3601,p_mfgr_prf#3602,p_container_prf#3603,p_brand_prf#3604,p_size_prf#3605,p_partkey_prf#3606] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#3618 AS ps_partkey_and_ps_suppkey_prf_1#3625, rid#3619 AS rid_1#3626, ps_availqty_prf#3620 AS ps_availqty_prf_1#3627, ps_comment_prf#3621 AS ps_comment_prf_1#3628, ps_partkey_prf#3622 AS ps_partkey_prf_1#3629, ps_supplycost_prf#3623 AS ps_supplycost_prf_1#3630, ps_suppkey_prf#3624 AS ps_suppkey_prf_1#3631]
            +- Relation[ps_partkey_and_ps_suppkey_prf#3618,rid#3619,ps_availqty_prf#3620,ps_comment_prf#3621,ps_partkey_prf#3622,ps_supplycost_prf#3623,ps_suppkey_prf#3624] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 32184ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/11 03:58:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 03:58:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3671L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 03:58:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3671L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#1545) AS rid_2#3700]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#3689]
         :     :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#3682: string
         :     :  :     :- Project [s_phone_prf#3673 AS s_phone_prf_0#3681, rid#3674 AS rid_0#3682, s_address_prf#3675 AS s_address_prf_0#3683, s_nationkey_prf#3676 AS s_nationkey_prf_0#3684, s_suppkey_prf#3677 AS s_suppkey_prf_0#3685, s_name_prf#3678 AS s_name_prf_0#3686, s_acctbal_prf#3679 AS s_acctbal_prf_0#3687, s_comment_prf#3680 AS s_comment_prf_0#3688]
         :     :  :     :  +- Relation[s_phone_prf#3673,rid#3674,s_address_prf#3675,s_nationkey_prf#3676,s_suppkey_prf#3677,s_name_prf#3678,s_acctbal_prf#3679,s_comment_prf#3680] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [rid#3690 AS rid_1#3695, n_regionkey_prf#3691 AS n_regionkey_prf_1#3696, n_nationkey_prf#3692 AS n_nationkey_prf_1#3697, n_name_prf#3693 AS n_name_prf_1#3698, n_comment_prf#3694 AS n_comment_prf_1#3699]
         :     :     +- Relation[rid#3690,n_regionkey_prf#3691,n_nationkey_prf#3692,n_name_prf#3693,n_comment_prf#3694] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3701 AS c_acctbal_prf_2#3710, rid#3702 AS rid_2#3711, c_name_prf#3703 AS c_name_prf_2#3712, c_nationkey_prf#3704 AS c_nationkey_prf_2#3713, c_custkey_prf#3705 AS c_custkey_prf_2#3714, c_comment_prf#3706 AS c_comment_prf_2#3715, c_address_prf#3707 AS c_address_prf_2#3716, c_mktsegment_prf#3708 AS c_mktsegment_prf_2#3717, c_phone_prf#3709 AS c_phone_prf_2#3718]
            +- Relation[c_acctbal_prf#3701,rid#3702,c_name_prf#3703,c_nationkey_prf#3704,c_custkey_prf#3705,c_comment_prf#3706,c_address_prf#3707,c_mktsegment_prf#3708,c_phone_prf#3709] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 676696ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/11 04:10:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 04:10:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3776L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 04:10:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3776L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_2#3794]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#3787: string
         :     :- Project [s_phone_prf#3778 AS s_phone_prf_0#3786, rid#3779 AS rid_0#3787, s_address_prf#3780 AS s_address_prf_0#3788, s_nationkey_prf#3781 AS s_nationkey_prf_0#3789, s_suppkey_prf#3782 AS s_suppkey_prf_0#3790, s_name_prf#3783 AS s_name_prf_0#3791, s_acctbal_prf#3784 AS s_acctbal_prf_0#3792, s_comment_prf#3785 AS s_comment_prf_0#3793]
         :     :  +- Relation[s_phone_prf#3778,rid#3779,s_address_prf#3780,s_nationkey_prf#3781,s_suppkey_prf#3782,s_name_prf#3783,s_acctbal_prf#3784,s_comment_prf#3785] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1545) AS rid_2#3815]
            :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#3807: string
            :     :- Project [p_comment_prf#3795 AS p_comment_prf_1#3805, p_name_prf#3796 AS p_name_prf_1#3806, rid#3797 AS rid_1#3807, p_type_prf#3798 AS p_type_prf_1#3808, p_retailprice_prf#3799 AS p_retailprice_prf_1#3809, p_mfgr_prf#3800 AS p_mfgr_prf_1#3810, p_container_prf#3801 AS p_container_prf_1#3811, p_brand_prf#3802 AS p_brand_prf_1#3812, p_size_prf#3803 AS p_size_prf_1#3813, p_partkey_prf#3804 AS p_partkey_prf_1#3814]
            :     :  +- Relation[p_comment_prf#3795,p_name_prf#3796,rid#3797,p_type_prf#3798,p_retailprice_prf#3799,p_mfgr_prf#3800,p_container_prf#3801,p_brand_prf#3802,p_size_prf#3803,p_partkey_prf#3804] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3816 AS l_returnflag_prf_2#3835, l_orderkey_and_l_linenumber_prf#3817 AS l_orderkey_and_l_linenumber_prf_2#3836, l_comment_prf#3818 AS l_comment_prf_2#3837, l_linestatus_prf#3819 AS l_linestatus_prf_2#3838, rid#3820 AS rid_2#3839, l_shipmode_prf#3821 AS l_shipmode_prf_2#3840, l_shipinstruct_prf#3822 AS l_shipinstruct_prf_2#3841, l_quantity_prf#3823 AS l_quantity_prf_2#3842, l_receiptdate_prf#3824 AS l_receiptdate_prf_2#3843, l_linenumber_prf#3825 AS l_linenumber_prf_2#3844, l_tax_prf#3826 AS l_tax_prf_2#3845, l_shipdate_prf#3827 AS l_shipdate_prf_2#3846, l_extendedprice_prf#3828 AS l_extendedprice_prf_2#3847, l_partkey_prf#3829 AS l_partkey_prf_2#3848, l_discount_prf#3830 AS l_discount_prf_2#3849, l_partkey_and_l_suppkey_prf#3831 AS l_partkey_and_l_suppkey_prf_2#3850, l_commitdate_prf#3832 AS l_commitdate_prf_2#3851, l_suppkey_prf#3833 AS l_suppkey_prf_2#3852, l_orderkey_prf#3834 AS l_orderkey_prf_2#3853]
               +- Relation[l_returnflag_prf#3816,l_orderkey_and_l_linenumber_prf#3817,l_comment_prf#3818,l_linestatus_prf#3819,rid#3820,l_shipmode_prf#3821,l_shipinstruct_prf#3822,l_quantity_prf#3823,l_receiptdate_prf#3824,l_linenumber_prf#3825,l_tax_prf#3826,l_shipdate_prf#3827,l_extendedprice_prf#3828,l_partkey_prf#3829,l_discount_prf#3830,l_partkey_and_l_suppkey_prf#3831,l_commitdate_prf#3832,l_suppkey_prf#3833,l_orderkey_prf#3834] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 190182ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/11 04:13:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 04:13:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3905L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 04:13:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3905L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#3917]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#3912: string
         :     :- Project [rid#3907 AS rid_0#3912, n_regionkey_prf#3908 AS n_regionkey_prf_0#3913, n_nationkey_prf#3909 AS n_nationkey_prf_0#3914, n_name_prf#3910 AS n_name_prf_0#3915, n_comment_prf#3911 AS n_comment_prf_0#3916]
         :     :  +- Relation[rid#3907,n_regionkey_prf#3908,n_nationkey_prf#3909,n_name_prf#3910,n_comment_prf#3911] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3918 AS s_phone_prf_1#3926, rid#3919 AS rid_1#3927, s_address_prf#3920 AS s_address_prf_1#3928, s_nationkey_prf#3921 AS s_nationkey_prf_1#3929, s_suppkey_prf#3922 AS s_suppkey_prf_1#3930, s_name_prf#3923 AS s_name_prf_1#3931, s_acctbal_prf#3924 AS s_acctbal_prf_1#3932, s_comment_prf#3925 AS s_comment_prf_1#3933]
            +- Relation[s_phone_prf#3918,rid#3919,s_address_prf#3920,s_nationkey_prf#3921,s_suppkey_prf#3922,s_name_prf#3923,s_acctbal_prf#3924,s_comment_prf#3925] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=10000
Elapsed time: 189ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/11 04:13:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 04:13:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3983L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 04:13:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3983L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1545) AS rid_2#4024]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#4003]
         :     :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3995: string
         :     :  :     :- Project [c_acctbal_prf#3985 AS c_acctbal_prf_0#3994, rid#3986 AS rid_0#3995, c_name_prf#3987 AS c_name_prf_0#3996, c_nationkey_prf#3988 AS c_nationkey_prf_0#3997, c_custkey_prf#3989 AS c_custkey_prf_0#3998, c_comment_prf#3990 AS c_comment_prf_0#3999, c_address_prf#3991 AS c_address_prf_0#4000, c_mktsegment_prf#3992 AS c_mktsegment_prf_0#4001, c_phone_prf#3993 AS c_phone_prf_0#4002]
         :     :  :     :  +- Relation[c_acctbal_prf#3985,rid#3986,c_name_prf#3987,c_nationkey_prf#3988,c_custkey_prf#3989,c_comment_prf#3990,c_address_prf#3991,c_mktsegment_prf#3992,c_phone_prf#3993] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#4004 AS o_shippriority_prf_1#4014, rid#4005 AS rid_1#4015, o_orderdate_prf#4006 AS o_orderdate_prf_1#4016, o_custkey_prf#4007 AS o_custkey_prf_1#4017, o_orderpriority_prf#4008 AS o_orderpriority_prf_1#4018, o_clerk_prf#4009 AS o_clerk_prf_1#4019, o_orderstatus_prf#4010 AS o_orderstatus_prf_1#4020, o_totalprice_prf#4011 AS o_totalprice_prf_1#4021, o_orderkey_prf#4012 AS o_orderkey_prf_1#4022, o_comment_prf#4013 AS o_comment_prf_1#4023]
         :     :     +- Relation[o_shippriority_prf#4004,rid#4005,o_orderdate_prf#4006,o_custkey_prf#4007,o_orderpriority_prf#4008,o_clerk_prf#4009,o_orderstatus_prf#4010,o_totalprice_prf#4011,o_orderkey_prf#4012,o_comment_prf#4013] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4025 AS l_returnflag_prf_2#4044, l_orderkey_and_l_linenumber_prf#4026 AS l_orderkey_and_l_linenumber_prf_2#4045, l_comment_prf#4027 AS l_comment_prf_2#4046, l_linestatus_prf#4028 AS l_linestatus_prf_2#4047, rid#4029 AS rid_2#4048, l_shipmode_prf#4030 AS l_shipmode_prf_2#4049, l_shipinstruct_prf#4031 AS l_shipinstruct_prf_2#4050, l_quantity_prf#4032 AS l_quantity_prf_2#4051, l_receiptdate_prf#4033 AS l_receiptdate_prf_2#4052, l_linenumber_prf#4034 AS l_linenumber_prf_2#4053, l_tax_prf#4035 AS l_tax_prf_2#4054, l_shipdate_prf#4036 AS l_shipdate_prf_2#4055, l_extendedprice_prf#4037 AS l_extendedprice_prf_2#4056, l_partkey_prf#4038 AS l_partkey_prf_2#4057, l_discount_prf#4039 AS l_discount_prf_2#4058, l_partkey_and_l_suppkey_prf#4040 AS l_partkey_and_l_suppkey_prf_2#4059, l_commitdate_prf#4041 AS l_commitdate_prf_2#4060, l_suppkey_prf#4042 AS l_suppkey_prf_2#4061, l_orderkey_prf#4043 AS l_orderkey_prf_2#4062]
            +- Relation[l_returnflag_prf#4025,l_orderkey_and_l_linenumber_prf#4026,l_comment_prf#4027,l_linestatus_prf#4028,rid#4029,l_shipmode_prf#4030,l_shipinstruct_prf#4031,l_quantity_prf#4032,l_receiptdate_prf#4033,l_linenumber_prf#4034,l_tax_prf#4035,l_shipdate_prf#4036,l_extendedprice_prf#4037,l_partkey_prf#4038,l_discount_prf#4039,l_partkey_and_l_suppkey_prf#4040,l_commitdate_prf#4041,l_suppkey_prf#4042,l_orderkey_prf#4043] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 186042ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/11 04:16:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 04:16:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4116L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 04:16:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4116L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#4134]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#4127: string
         :     :- Project [s_phone_prf#4118 AS s_phone_prf_0#4126, rid#4119 AS rid_0#4127, s_address_prf#4120 AS s_address_prf_0#4128, s_nationkey_prf#4121 AS s_nationkey_prf_0#4129, s_suppkey_prf#4122 AS s_suppkey_prf_0#4130, s_name_prf#4123 AS s_name_prf_0#4131, s_acctbal_prf#4124 AS s_acctbal_prf_0#4132, s_comment_prf#4125 AS s_comment_prf_0#4133]
         :     :  +- Relation[s_phone_prf#4118,rid#4119,s_address_prf#4120,s_nationkey_prf#4121,s_suppkey_prf#4122,s_name_prf#4123,s_acctbal_prf#4124,s_comment_prf#4125] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4135 AS ps_partkey_and_ps_suppkey_prf_1#4142, rid#4136 AS rid_1#4143, ps_availqty_prf#4137 AS ps_availqty_prf_1#4144, ps_comment_prf#4138 AS ps_comment_prf_1#4145, ps_partkey_prf#4139 AS ps_partkey_prf_1#4146, ps_supplycost_prf#4140 AS ps_supplycost_prf_1#4147, ps_suppkey_prf#4141 AS ps_suppkey_prf_1#4148]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4135,rid#4136,ps_availqty_prf#4137,ps_comment_prf#4138,ps_partkey_prf#4139,ps_supplycost_prf#4140,ps_suppkey_prf#4141] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 11248ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_orderkey and l_orderkey = o_orderkey
19/10/11 04:16:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 04:16:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4200L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 04:16:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4200L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_2#4240]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4225: string
         :     :- Project [l_returnflag_prf#4202 AS l_returnflag_prf_0#4221, l_orderkey_and_l_linenumber_prf#4203 AS l_orderkey_and_l_linenumber_prf_0#4222, l_comment_prf#4204 AS l_comment_prf_0#4223, l_linestatus_prf#4205 AS l_linestatus_prf_0#4224, rid#4206 AS rid_0#4225, l_shipmode_prf#4207 AS l_shipmode_prf_0#4226, l_shipinstruct_prf#4208 AS l_shipinstruct_prf_0#4227, l_quantity_prf#4209 AS l_quantity_prf_0#4228, l_receiptdate_prf#4210 AS l_receiptdate_prf_0#4229, l_linenumber_prf#4211 AS l_linenumber_prf_0#4230, l_tax_prf#4212 AS l_tax_prf_0#4231, l_shipdate_prf#4213 AS l_shipdate_prf_0#4232, l_extendedprice_prf#4214 AS l_extendedprice_prf_0#4233, l_partkey_prf#4215 AS l_partkey_prf_0#4234, l_discount_prf#4216 AS l_discount_prf_0#4235, l_partkey_and_l_suppkey_prf#4217 AS l_partkey_and_l_suppkey_prf_0#4236, l_commitdate_prf#4218 AS l_commitdate_prf_0#4237, l_suppkey_prf#4219 AS l_suppkey_prf_0#4238, l_orderkey_prf#4220 AS l_orderkey_prf_0#4239]
         :     :  +- Relation[l_returnflag_prf#4202,l_orderkey_and_l_linenumber_prf#4203,l_comment_prf#4204,l_linestatus_prf#4205,rid#4206,l_shipmode_prf#4207,l_shipinstruct_prf#4208,l_quantity_prf#4209,l_receiptdate_prf#4210,l_linenumber_prf#4211,l_tax_prf#4212,l_shipdate_prf#4213,l_extendedprice_prf#4214,l_partkey_prf#4215,l_discount_prf#4216,l_partkey_and_l_suppkey_prf#4217,l_commitdate_prf#4218,l_suppkey_prf#4219,l_orderkey_prf#4220] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1545) AS rid_2#4259]
            :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#4251: string
            :     :- Project [c_acctbal_prf#4241 AS c_acctbal_prf_1#4250, rid#4242 AS rid_1#4251, c_name_prf#4243 AS c_name_prf_1#4252, c_nationkey_prf#4244 AS c_nationkey_prf_1#4253, c_custkey_prf#4245 AS c_custkey_prf_1#4254, c_comment_prf#4246 AS c_comment_prf_1#4255, c_address_prf#4247 AS c_address_prf_1#4256, c_mktsegment_prf#4248 AS c_mktsegment_prf_1#4257, c_phone_prf#4249 AS c_phone_prf_1#4258]
            :     :  +- Relation[c_acctbal_prf#4241,rid#4242,c_name_prf#4243,c_nationkey_prf#4244,c_custkey_prf#4245,c_comment_prf#4246,c_address_prf#4247,c_mktsegment_prf#4248,c_phone_prf#4249] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4260 AS o_shippriority_prf_2#4270, rid#4261 AS rid_2#4271, o_orderdate_prf#4262 AS o_orderdate_prf_2#4272, o_custkey_prf#4263 AS o_custkey_prf_2#4273, o_orderpriority_prf#4264 AS o_orderpriority_prf_2#4274, o_clerk_prf#4265 AS o_clerk_prf_2#4275, o_orderstatus_prf#4266 AS o_orderstatus_prf_2#4276, o_totalprice_prf#4267 AS o_totalprice_prf_2#4277, o_orderkey_prf#4268 AS o_orderkey_prf_2#4278, o_comment_prf#4269 AS o_comment_prf_2#4279]
               +- Relation[o_shippriority_prf#4260,rid#4261,o_orderdate_prf#4262,o_custkey_prf#4263,o_orderpriority_prf#4264,o_clerk_prf#4265,o_orderstatus_prf#4266,o_totalprice_prf#4267,o_orderkey_prf#4268,o_comment_prf#4269] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 179676ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/11 04:19:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 04:19:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4353L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/11 04:19:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4353L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#4371]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#4364: string
         :     :- Project [s_phone_prf#4355 AS s_phone_prf_0#4363, rid#4356 AS rid_0#4364, s_address_prf#4357 AS s_address_prf_0#4365, s_nationkey_prf#4358 AS s_nationkey_prf_0#4366, s_suppkey_prf#4359 AS s_suppkey_prf_0#4367, s_name_prf#4360 AS s_name_prf_0#4368, s_acctbal_prf#4361 AS s_acctbal_prf_0#4369, s_comment_prf#4362 AS s_comment_prf_0#4370]
         :     :  +- Relation[s_phone_prf#4355,rid#4356,s_address_prf#4357,s_nationkey_prf#4358,s_suppkey_prf#4359,s_name_prf#4360,s_acctbal_prf#4361,s_comment_prf#4362] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1545) AS rid_2#4410]
            :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_1#4395: string
            :     :- Project [l_returnflag_prf#4372 AS l_returnflag_prf_1#4391, l_orderkey_and_l_linenumber_prf#4373 AS l_orderkey_and_l_linenumber_prf_1#4392, l_comment_prf#4374 AS l_comment_prf_1#4393, l_linestatus_prf#4375 AS l_linestatus_prf_1#4394, rid#4376 AS rid_1#4395, l_shipmode_prf#4377 AS l_shipmode_prf_1#4396, l_shipinstruct_prf#4378 AS l_shipinstruct_prf_1#4397, l_quantity_prf#4379 AS l_quantity_prf_1#4398, l_receiptdate_prf#4380 AS l_receiptdate_prf_1#4399, l_linenumber_prf#4381 AS l_linenumber_prf_1#4400, l_tax_prf#4382 AS l_tax_prf_1#4401, l_shipdate_prf#4383 AS l_shipdate_prf_1#4402, l_extendedprice_prf#4384 AS l_extendedprice_prf_1#4403, l_partkey_prf#4385 AS l_partkey_prf_1#4404, l_discount_prf#4386 AS l_discount_prf_1#4405, l_partkey_and_l_suppkey_prf#4387 AS l_partkey_and_l_suppkey_prf_1#4406, l_commitdate_prf#4388 AS l_commitdate_prf_1#4407, l_suppkey_prf#4389 AS l_suppkey_prf_1#4408, l_orderkey_prf#4390 AS l_orderkey_prf_1#4409]
            :     :  +- Relation[l_returnflag_prf#4372,l_orderkey_and_l_linenumber_prf#4373,l_comment_prf#4374,l_linestatus_prf#4375,rid#4376,l_shipmode_prf#4377,l_shipinstruct_prf#4378,l_quantity_prf#4379,l_receiptdate_prf#4380,l_linenumber_prf#4381,l_tax_prf#4382,l_shipdate_prf#4383,l_extendedprice_prf#4384,l_partkey_prf#4385,l_discount_prf#4386,l_partkey_and_l_suppkey_prf#4387,l_commitdate_prf#4388,l_suppkey_prf#4389,l_orderkey_prf#4390] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#4411 AS p_comment_prf_2#4421, p_name_prf#4412 AS p_name_prf_2#4422, rid#4413 AS rid_2#4423, p_type_prf#4414 AS p_type_prf_2#4424, p_retailprice_prf#4415 AS p_retailprice_prf_2#4425, p_mfgr_prf#4416 AS p_mfgr_prf_2#4426, p_container_prf#4417 AS p_container_prf_2#4427, p_brand_prf#4418 AS p_brand_prf_2#4428, p_size_prf#4419 AS p_size_prf_2#4429, p_partkey_prf#4420 AS p_partkey_prf_2#4430]
               +- Relation[p_comment_prf#4411,p_name_prf#4412,rid#4413,p_type_prf#4414,p_retailprice_prf#4415,p_mfgr_prf#4416,p_container_prf#4417,p_brand_prf#4418,p_size_prf#4419,p_partkey_prf#4420] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 200675ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/11 04:22:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 04:22:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4488L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/11 04:22:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4488L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#4508]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4500: string
         :     :- Project [c_acctbal_prf#4490 AS c_acctbal_prf_0#4499, rid#4491 AS rid_0#4500, c_name_prf#4492 AS c_name_prf_0#4501, c_nationkey_prf#4493 AS c_nationkey_prf_0#4502, c_custkey_prf#4494 AS c_custkey_prf_0#4503, c_comment_prf#4495 AS c_comment_prf_0#4504, c_address_prf#4496 AS c_address_prf_0#4505, c_mktsegment_prf#4497 AS c_mktsegment_prf_0#4506, c_phone_prf#4498 AS c_phone_prf_0#4507]
         :     :  +- Relation[c_acctbal_prf#4490,rid#4491,c_name_prf#4492,c_nationkey_prf#4493,c_custkey_prf#4494,c_comment_prf#4495,c_address_prf#4496,c_mktsegment_prf#4497,c_phone_prf#4498] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4509 AS o_shippriority_prf_1#4519, rid#4510 AS rid_1#4520, o_orderdate_prf#4511 AS o_orderdate_prf_1#4521, o_custkey_prf#4512 AS o_custkey_prf_1#4522, o_orderpriority_prf#4513 AS o_orderpriority_prf_1#4523, o_clerk_prf#4514 AS o_clerk_prf_1#4524, o_orderstatus_prf#4515 AS o_orderstatus_prf_1#4525, o_totalprice_prf#4516 AS o_totalprice_prf_1#4526, o_orderkey_prf#4517 AS o_orderkey_prf_1#4527, o_comment_prf#4518 AS o_comment_prf_1#4528]
            +- Relation[o_shippriority_prf#4509,rid#4510,o_orderdate_prf#4511,o_custkey_prf#4512,o_orderpriority_prf#4513,o_clerk_prf#4514,o_orderstatus_prf#4515,o_totalprice_prf#4516,o_orderkey_prf#4517,o_comment_prf#4518] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1500000
Elapsed time: 40681ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/11 04:23:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 04:23:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4584L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 04:23:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4584L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#4624]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4609: string
         :     :- Project [l_returnflag_prf#4586 AS l_returnflag_prf_0#4605, l_orderkey_and_l_linenumber_prf#4587 AS l_orderkey_and_l_linenumber_prf_0#4606, l_comment_prf#4588 AS l_comment_prf_0#4607, l_linestatus_prf#4589 AS l_linestatus_prf_0#4608, rid#4590 AS rid_0#4609, l_shipmode_prf#4591 AS l_shipmode_prf_0#4610, l_shipinstruct_prf#4592 AS l_shipinstruct_prf_0#4611, l_quantity_prf#4593 AS l_quantity_prf_0#4612, l_receiptdate_prf#4594 AS l_receiptdate_prf_0#4613, l_linenumber_prf#4595 AS l_linenumber_prf_0#4614, l_tax_prf#4596 AS l_tax_prf_0#4615, l_shipdate_prf#4597 AS l_shipdate_prf_0#4616, l_extendedprice_prf#4598 AS l_extendedprice_prf_0#4617, l_partkey_prf#4599 AS l_partkey_prf_0#4618, l_discount_prf#4600 AS l_discount_prf_0#4619, l_partkey_and_l_suppkey_prf#4601 AS l_partkey_and_l_suppkey_prf_0#4620, l_commitdate_prf#4602 AS l_commitdate_prf_0#4621, l_suppkey_prf#4603 AS l_suppkey_prf_0#4622, l_orderkey_prf#4604 AS l_orderkey_prf_0#4623]
         :     :  +- Relation[l_returnflag_prf#4586,l_orderkey_and_l_linenumber_prf#4587,l_comment_prf#4588,l_linestatus_prf#4589,rid#4590,l_shipmode_prf#4591,l_shipinstruct_prf#4592,l_quantity_prf#4593,l_receiptdate_prf#4594,l_linenumber_prf#4595,l_tax_prf#4596,l_shipdate_prf#4597,l_extendedprice_prf#4598,l_partkey_prf#4599,l_discount_prf#4600,l_partkey_and_l_suppkey_prf#4601,l_commitdate_prf#4602,l_suppkey_prf#4603,l_orderkey_prf#4604] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1545) AS rid_2#4645]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#4636: string
            :     :- Project [o_shippriority_prf#4625 AS o_shippriority_prf_1#4635, rid#4626 AS rid_1#4636, o_orderdate_prf#4627 AS o_orderdate_prf_1#4637, o_custkey_prf#4628 AS o_custkey_prf_1#4638, o_orderpriority_prf#4629 AS o_orderpriority_prf_1#4639, o_clerk_prf#4630 AS o_clerk_prf_1#4640, o_orderstatus_prf#4631 AS o_orderstatus_prf_1#4641, o_totalprice_prf#4632 AS o_totalprice_prf_1#4642, o_orderkey_prf#4633 AS o_orderkey_prf_1#4643, o_comment_prf#4634 AS o_comment_prf_1#4644]
            :     :  +- Relation[o_shippriority_prf#4625,rid#4626,o_orderdate_prf#4627,o_custkey_prf#4628,o_orderpriority_prf#4629,o_clerk_prf#4630,o_orderstatus_prf#4631,o_totalprice_prf#4632,o_orderkey_prf#4633,o_comment_prf#4634] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4646 AS c_acctbal_prf_2#4655, rid#4647 AS rid_2#4656, c_name_prf#4648 AS c_name_prf_2#4657, c_nationkey_prf#4649 AS c_nationkey_prf_2#4658, c_custkey_prf#4650 AS c_custkey_prf_2#4659, c_comment_prf#4651 AS c_comment_prf_2#4660, c_address_prf#4652 AS c_address_prf_2#4661, c_mktsegment_prf#4653 AS c_mktsegment_prf_2#4662, c_phone_prf#4654 AS c_phone_prf_2#4663]
               +- Relation[c_acctbal_prf#4646,rid#4647,c_name_prf#4648,c_nationkey_prf#4649,c_custkey_prf#4650,c_comment_prf#4651,c_address_prf#4652,c_mktsegment_prf#4653,c_phone_prf#4654] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 167972ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/11 04:26:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 04:26:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4709L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 04:26:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4709L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#4711 AS rid_0#4716, n_regionkey_prf#4712 AS n_regionkey_prf_0#4717, n_nationkey_prf#4713 AS n_nationkey_prf_0#4718, n_name_prf#4714 AS n_name_prf_0#4719, n_comment_prf#4715 AS n_comment_prf_0#4720]
         :  +- Relation[rid#4711,n_regionkey_prf#4712,n_nationkey_prf#4713,n_name_prf#4714,n_comment_prf#4715] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4721]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1877,value#1878] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 52ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/11 04:26:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 04:26:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4744L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 04:26:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4744L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#4767]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4758: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#4746 AS p_comment_prf_0#4756, p_name_prf#4747 AS p_name_prf_0#4757, rid#4748 AS rid_0#4758, p_type_prf#4749 AS p_type_prf_0#4759, p_retailprice_prf#4750 AS p_retailprice_prf_0#4760, p_mfgr_prf#4751 AS p_mfgr_prf_0#4761, p_container_prf#4752 AS p_container_prf_0#4762, p_brand_prf#4753 AS p_brand_prf_0#4763, p_size_prf#4754 AS p_size_prf_0#4764, p_partkey_prf#4755 AS p_partkey_prf_0#4765]
         :     :  :  +- Relation[p_comment_prf#4746,p_name_prf#4747,rid#4748,p_type_prf#4749,p_retailprice_prf#4750,p_mfgr_prf#4751,p_container_prf#4752,p_brand_prf#4753,p_size_prf#4754,p_partkey_prf#4755] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4766]
         :     :     +- DexRidFilter part~p_size~15
         :     :        +- Relation[label#1877,value#1878] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4768 AS ps_partkey_and_ps_suppkey_prf_1#4775, rid#4769 AS rid_1#4776, ps_availqty_prf#4770 AS ps_availqty_prf_1#4777, ps_comment_prf#4771 AS ps_comment_prf_1#4778, ps_partkey_prf#4772 AS ps_partkey_prf_1#4779, ps_supplycost_prf#4773 AS ps_supplycost_prf_1#4780, ps_suppkey_prf#4774 AS ps_suppkey_prf_1#4781]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4768,rid#4769,ps_availqty_prf#4770,ps_comment_prf#4771,ps_partkey_prf#4772,ps_supplycost_prf#4773,ps_suppkey_prf#4774] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 400ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/11 04:26:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 04:26:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4825L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 04:26:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4825L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#4843]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#4836: string
         :     :- Project [s_phone_prf#4827 AS s_phone_prf_0#4835, rid#4828 AS rid_0#4836, s_address_prf#4829 AS s_address_prf_0#4837, s_nationkey_prf#4830 AS s_nationkey_prf_0#4838, s_suppkey_prf#4831 AS s_suppkey_prf_0#4839, s_name_prf#4832 AS s_name_prf_0#4840, s_acctbal_prf#4833 AS s_acctbal_prf_0#4841, s_comment_prf#4834 AS s_comment_prf_0#4842]
         :     :  +- Relation[s_phone_prf#4827,rid#4828,s_address_prf#4829,s_nationkey_prf#4830,s_suppkey_prf#4831,s_name_prf#4832,s_acctbal_prf#4833,s_comment_prf#4834] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4844 AS l_returnflag_prf_1#4863, l_orderkey_and_l_linenumber_prf#4845 AS l_orderkey_and_l_linenumber_prf_1#4864, l_comment_prf#4846 AS l_comment_prf_1#4865, l_linestatus_prf#4847 AS l_linestatus_prf_1#4866, rid#4848 AS rid_1#4867, l_shipmode_prf#4849 AS l_shipmode_prf_1#4868, l_shipinstruct_prf#4850 AS l_shipinstruct_prf_1#4869, l_quantity_prf#4851 AS l_quantity_prf_1#4870, l_receiptdate_prf#4852 AS l_receiptdate_prf_1#4871, l_linenumber_prf#4853 AS l_linenumber_prf_1#4872, l_tax_prf#4854 AS l_tax_prf_1#4873, l_shipdate_prf#4855 AS l_shipdate_prf_1#4874, l_extendedprice_prf#4856 AS l_extendedprice_prf_1#4875, l_partkey_prf#4857 AS l_partkey_prf_1#4876, l_discount_prf#4858 AS l_discount_prf_1#4877, l_partkey_and_l_suppkey_prf#4859 AS l_partkey_and_l_suppkey_prf_1#4878, l_commitdate_prf#4860 AS l_commitdate_prf_1#4879, l_suppkey_prf#4861 AS l_suppkey_prf_1#4880, l_orderkey_prf#4862 AS l_orderkey_prf_1#4881]
            +- Relation[l_returnflag_prf#4844,l_orderkey_and_l_linenumber_prf#4845,l_comment_prf#4846,l_linestatus_prf#4847,rid#4848,l_shipmode_prf#4849,l_shipinstruct_prf#4850,l_quantity_prf#4851,l_receiptdate_prf#4852,l_linenumber_prf#4853,l_tax_prf#4854,l_shipdate_prf#4855,l_extendedprice_prf#4856,l_partkey_prf#4857,l_discount_prf#4858,l_partkey_and_l_suppkey_prf#4859,l_commitdate_prf#4860,l_suppkey_prf#4861,l_orderkey_prf#4862] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 88300ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/11 04:27:51 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 04:27:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4931L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/11 04:27:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4931L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1545) AS rid_2#4960]
         :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#4943]
         :     :  :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#4938: string
         :     :  :     :- Project [rid#4933 AS rid_0#4938, n_regionkey_prf#4934 AS n_regionkey_prf_0#4939, n_nationkey_prf#4935 AS n_nationkey_prf_0#4940, n_name_prf#4936 AS n_name_prf_0#4941, n_comment_prf#4937 AS n_comment_prf_0#4942]
         :     :  :     :  +- Relation[rid#4933,n_regionkey_prf#4934,n_nationkey_prf#4935,n_name_prf#4936,n_comment_prf#4937] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#4944 AS s_phone_prf_1#4952, rid#4945 AS rid_1#4953, s_address_prf#4946 AS s_address_prf_1#4954, s_nationkey_prf#4947 AS s_nationkey_prf_1#4955, s_suppkey_prf#4948 AS s_suppkey_prf_1#4956, s_name_prf#4949 AS s_name_prf_1#4957, s_acctbal_prf#4950 AS s_acctbal_prf_1#4958, s_comment_prf#4951 AS s_comment_prf_1#4959]
         :     :     +- Relation[s_phone_prf#4944,rid#4945,s_address_prf#4946,s_nationkey_prf#4947,s_suppkey_prf#4948,s_name_prf#4949,s_acctbal_prf#4950,s_comment_prf#4951] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4961 AS c_acctbal_prf_2#4970, rid#4962 AS rid_2#4971, c_name_prf#4963 AS c_name_prf_2#4972, c_nationkey_prf#4964 AS c_nationkey_prf_2#4973, c_custkey_prf#4965 AS c_custkey_prf_2#4974, c_comment_prf#4966 AS c_comment_prf_2#4975, c_address_prf#4967 AS c_address_prf_2#4976, c_mktsegment_prf#4968 AS c_mktsegment_prf_2#4977, c_phone_prf#4969 AS c_phone_prf_2#4978]
            +- Relation[c_acctbal_prf#4961,rid#4962,c_name_prf#4963,c_nationkey_prf#4964,c_custkey_prf#4965,c_comment_prf#4966,c_address_prf#4967,c_mktsegment_prf#4968,c_phone_prf#4969] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 778333ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/11 04:40:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 04:40:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5025L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/11 04:40:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5025L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'ps_partkey_and_ps_suppkey_prf_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1545) AS rid_2#5062]
         :  +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#5047]
         :     :  :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#5039: string
         :     :  :     :- Project [p_comment_prf#5027 AS p_comment_prf_0#5037, p_name_prf#5028 AS p_name_prf_0#5038, rid#5029 AS rid_0#5039, p_type_prf#5030 AS p_type_prf_0#5040, p_retailprice_prf#5031 AS p_retailprice_prf_0#5041, p_mfgr_prf#5032 AS p_mfgr_prf_0#5042, p_container_prf#5033 AS p_container_prf_0#5043, p_brand_prf#5034 AS p_brand_prf_0#5044, p_size_prf#5035 AS p_size_prf_0#5045, p_partkey_prf#5036 AS p_partkey_prf_0#5046]
         :     :  :     :  +- Relation[p_comment_prf#5027,p_name_prf#5028,rid#5029,p_type_prf#5030,p_retailprice_prf#5031,p_mfgr_prf#5032,p_container_prf#5033,p_brand_prf#5034,p_size_prf#5035,p_partkey_prf#5036] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [ps_partkey_and_ps_suppkey_prf#5048 AS ps_partkey_and_ps_suppkey_prf_1#5055, rid#5049 AS rid_1#5056, ps_availqty_prf#5050 AS ps_availqty_prf_1#5057, ps_comment_prf#5051 AS ps_comment_prf_1#5058, ps_partkey_prf#5052 AS ps_partkey_prf_1#5059, ps_supplycost_prf#5053 AS ps_supplycost_prf_1#5060, ps_suppkey_prf#5054 AS ps_suppkey_prf_1#5061]
         :     :     +- Relation[ps_partkey_and_ps_suppkey_prf#5048,rid#5049,ps_availqty_prf#5050,ps_comment_prf#5051,ps_partkey_prf#5052,ps_supplycost_prf#5053,ps_suppkey_prf#5054] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5063 AS s_phone_prf_2#5071, rid#5064 AS rid_2#5072, s_address_prf#5065 AS s_address_prf_2#5073, s_nationkey_prf#5066 AS s_nationkey_prf_2#5074, s_suppkey_prf#5067 AS s_suppkey_prf_2#5075, s_name_prf#5068 AS s_name_prf_2#5076, s_acctbal_prf#5069 AS s_acctbal_prf_2#5077, s_comment_prf#5070 AS s_comment_prf_2#5078]
            +- Relation[s_phone_prf#5063,rid#5064,s_address_prf#5065,s_nationkey_prf#5066,s_suppkey_prf#5067,s_name_prf#5068,s_acctbal_prf#5069,s_comment_prf#5070] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 95492ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/11 04:42:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 04:42:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5128L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/11 04:42:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5128L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_2#5146]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#5139: string
         :     :- Project [s_phone_prf#5130 AS s_phone_prf_0#5138, rid#5131 AS rid_0#5139, s_address_prf#5132 AS s_address_prf_0#5140, s_nationkey_prf#5133 AS s_nationkey_prf_0#5141, s_suppkey_prf#5134 AS s_suppkey_prf_0#5142, s_name_prf#5135 AS s_name_prf_0#5143, s_acctbal_prf#5136 AS s_acctbal_prf_0#5144, s_comment_prf#5137 AS s_comment_prf_0#5145]
         :     :  +- Relation[s_phone_prf#5130,rid#5131,s_address_prf#5132,s_nationkey_prf#5133,s_suppkey_prf#5134,s_name_prf#5135,s_acctbal_prf#5136,s_comment_prf#5137] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1545) AS rid_2#5167]
            :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#5159: string
            :     :- Project [p_comment_prf#5147 AS p_comment_prf_1#5157, p_name_prf#5148 AS p_name_prf_1#5158, rid#5149 AS rid_1#5159, p_type_prf#5150 AS p_type_prf_1#5160, p_retailprice_prf#5151 AS p_retailprice_prf_1#5161, p_mfgr_prf#5152 AS p_mfgr_prf_1#5162, p_container_prf#5153 AS p_container_prf_1#5163, p_brand_prf#5154 AS p_brand_prf_1#5164, p_size_prf#5155 AS p_size_prf_1#5165, p_partkey_prf#5156 AS p_partkey_prf_1#5166]
            :     :  +- Relation[p_comment_prf#5147,p_name_prf#5148,rid#5149,p_type_prf#5150,p_retailprice_prf#5151,p_mfgr_prf#5152,p_container_prf#5153,p_brand_prf#5154,p_size_prf#5155,p_partkey_prf#5156] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#5168 AS ps_partkey_and_ps_suppkey_prf_2#5175, rid#5169 AS rid_2#5176, ps_availqty_prf#5170 AS ps_availqty_prf_2#5177, ps_comment_prf#5171 AS ps_comment_prf_2#5178, ps_partkey_prf#5172 AS ps_partkey_prf_2#5179, ps_supplycost_prf#5173 AS ps_supplycost_prf_2#5180, ps_suppkey_prf#5174 AS ps_suppkey_prf_2#5181]
               +- Relation[ps_partkey_and_ps_suppkey_prf#5168,rid#5169,ps_availqty_prf#5170,ps_comment_prf#5171,ps_partkey_prf#5172,ps_supplycost_prf#5173,ps_suppkey_prf#5174] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 43608ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/11 04:43:09 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 04:43:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5235L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/11 04:43:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5235L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_1#5257]
         :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#5249: string
         :     :- Project [p_comment_prf#5237 AS p_comment_prf_0#5247, p_name_prf#5238 AS p_name_prf_0#5248, rid#5239 AS rid_0#5249, p_type_prf#5240 AS p_type_prf_0#5250, p_retailprice_prf#5241 AS p_retailprice_prf_0#5251, p_mfgr_prf#5242 AS p_mfgr_prf_0#5252, p_container_prf#5243 AS p_container_prf_0#5253, p_brand_prf#5244 AS p_brand_prf_0#5254, p_size_prf#5245 AS p_size_prf_0#5255, p_partkey_prf#5246 AS p_partkey_prf_0#5256]
         :     :  +- Relation[p_comment_prf#5237,p_name_prf#5238,rid#5239,p_type_prf#5240,p_retailprice_prf#5241,p_mfgr_prf#5242,p_container_prf#5243,p_brand_prf#5244,p_size_prf#5245,p_partkey_prf#5246] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5258 AS l_returnflag_prf_1#5277, l_orderkey_and_l_linenumber_prf#5259 AS l_orderkey_and_l_linenumber_prf_1#5278, l_comment_prf#5260 AS l_comment_prf_1#5279, l_linestatus_prf#5261 AS l_linestatus_prf_1#5280, rid#5262 AS rid_1#5281, l_shipmode_prf#5263 AS l_shipmode_prf_1#5282, l_shipinstruct_prf#5264 AS l_shipinstruct_prf_1#5283, l_quantity_prf#5265 AS l_quantity_prf_1#5284, l_receiptdate_prf#5266 AS l_receiptdate_prf_1#5285, l_linenumber_prf#5267 AS l_linenumber_prf_1#5286, l_tax_prf#5268 AS l_tax_prf_1#5287, l_shipdate_prf#5269 AS l_shipdate_prf_1#5288, l_extendedprice_prf#5270 AS l_extendedprice_prf_1#5289, l_partkey_prf#5271 AS l_partkey_prf_1#5290, l_discount_prf#5272 AS l_discount_prf_1#5291, l_partkey_and_l_suppkey_prf#5273 AS l_partkey_and_l_suppkey_prf_1#5292, l_commitdate_prf#5274 AS l_commitdate_prf_1#5293, l_suppkey_prf#5275 AS l_suppkey_prf_1#5294, l_orderkey_prf#5276 AS l_orderkey_prf_1#5295]
            +- Relation[l_returnflag_prf#5258,l_orderkey_and_l_linenumber_prf#5259,l_comment_prf#5260,l_linestatus_prf#5261,rid#5262,l_shipmode_prf#5263,l_shipinstruct_prf#5264,l_quantity_prf#5265,l_receiptdate_prf#5266,l_linenumber_prf#5267,l_tax_prf#5268,l_shipdate_prf#5269,l_extendedprice_prf#5270,l_partkey_prf#5271,l_discount_prf#5272,l_partkey_and_l_suppkey_prf#5273,l_commitdate_prf#5274,l_suppkey_prf#5275,l_orderkey_prf#5276] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 96438ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/11 04:44:45 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/11 04:44:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5347L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/11 04:44:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5347L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1545) AS rid_2#5367]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#5359: string
         :     :- Project [c_acctbal_prf#5349 AS c_acctbal_prf_0#5358, rid#5350 AS rid_0#5359, c_name_prf#5351 AS c_name_prf_0#5360, c_nationkey_prf#5352 AS c_nationkey_prf_0#5361, c_custkey_prf#5353 AS c_custkey_prf_0#5362, c_comment_prf#5354 AS c_comment_prf_0#5363, c_address_prf#5355 AS c_address_prf_0#5364, c_mktsegment_prf#5356 AS c_mktsegment_prf_0#5365, c_phone_prf#5357 AS c_phone_prf_0#5366]
         :     :  +- Relation[c_acctbal_prf#5349,rid#5350,c_name_prf#5351,c_nationkey_prf#5352,c_custkey_prf#5353,c_comment_prf#5354,c_address_prf#5355,c_mktsegment_prf#5356,c_phone_prf#5357] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1545) AS rid_2#5384]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#5377: string
            :     :- Project [s_phone_prf#5368 AS s_phone_prf_1#5376, rid#5369 AS rid_1#5377, s_address_prf#5370 AS s_address_prf_1#5378, s_nationkey_prf#5371 AS s_nationkey_prf_1#5379, s_suppkey_prf#5372 AS s_suppkey_prf_1#5380, s_name_prf#5373 AS s_name_prf_1#5381, s_acctbal_prf#5374 AS s_acctbal_prf_1#5382, s_comment_prf#5375 AS s_comment_prf_1#5383]
            :     :  +- Relation[s_phone_prf#5368,rid#5369,s_address_prf#5370,s_nationkey_prf#5371,s_suppkey_prf#5372,s_name_prf#5373,s_acctbal_prf#5374,s_comment_prf#5375] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1544,value#1545] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [rid#5385 AS rid_2#5390, n_regionkey_prf#5386 AS n_regionkey_prf_2#5391, n_nationkey_prf#5387 AS n_nationkey_prf_2#5392, n_name_prf#5388 AS n_name_prf_2#5393, n_comment_prf#5389 AS n_comment_prf_2#5394]
               +- Relation[rid#5385,n_regionkey_prf#5386,n_nationkey_prf#5387,n_name_prf#5388,n_comment_prf#5389] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 79532ms
query=b1a, count=15628, duration=400
query=b1b, count=15628, duration=50461
query=b2a, count=1478870, duration=201351
query=b2b, count=1478870, duration=57367
query=f1, count=1, duration=53
query=f2, count=3907, duration=121
query=f3, count=1451, duration=84
query=f4, count=1, duration=52
query=f5, count=1478870, duration=23992
query=f6, count=857401, duration=13957
query=j1, count=800000, duration=32184
query=j10, count=6001215, duration=88300
query=j2, count=800000, duration=11248
query=j3, count=25, duration=77
query=j4, count=150000, duration=1935
query=j5, count=10000, duration=189
query=j6, count=6001215, duration=117924
query=j7, count=1500000, duration=40681
query=j8, count=6001215, duration=199376
query=j8b, count=6001215, duration=130811
query=j9, count=6001215, duration=96438
query=j9b, count=6001215, duration=129417
query=r1a, count=6001215, duration=344427
query=r1b, count=6001215, duration=167972
query=r1c, count=6001215, duration=179676
query=r1d, count=6001215, duration=186042
query=r1e, count=6001215, duration=237985
query=r1f, count=6001215, duration=175515
query=t1a, count=60000414, duration=676696
query=t1b, count=60000414, duration=778333
query=t1c, count=60000414, duration=79532
query=t2a, count=800000, duration=109574
query=t2b, count=800000, duration=95492
query=t2c, count=800000, duration=43608
query=t2d, count=800000, duration=62396
query=t3a, count=6001215, duration=293208
query=t3b, count=6001215, duration=314013
query=t3c, count=6001215, duration=190182
query=t3d, count=6001215, duration=200675
