19/10/15 01:18:06 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7214ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Tue Oct 15 01:18:08 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Tue Oct 15 01:18:09 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Tue Oct 15 01:18:09 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Tue Oct 15 01:18:09 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Tue Oct 15 01:18:09 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Tue Oct 15 01:18:12 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Tue Oct 15 01:18:14 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Tue Oct 15 01:18:14 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/15 01:18:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:18:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1490L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/15 01:18:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1490L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#1510]
         :  :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#1501: string
         :  :  :     :- Project [s_phone_prf#1492 AS s_phone_prf_0#1500, rid#1493 AS rid_0#1501, s_address_prf#1494 AS s_address_prf_0#1502, s_nationkey_prf#1495 AS s_nationkey_prf_0#1503, s_suppkey_prf#1496 AS s_suppkey_prf_0#1504, s_name_prf#1497 AS s_name_prf_0#1505, s_acctbal_prf#1498 AS s_acctbal_prf_0#1506, s_comment_prf#1499 AS s_comment_prf_0#1507]
         :  :  :     :  +- Relation[s_phone_prf#1492,rid#1493,s_address_prf#1494,s_nationkey_prf#1495,s_suppkey_prf#1496,s_name_prf#1497,s_acctbal_prf#1498,s_comment_prf#1499] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [rid#1511 AS rid_1#1516, n_regionkey_prf#1512 AS n_regionkey_prf_1#1517, n_nationkey_prf#1513 AS n_nationkey_prf_1#1518, n_name_prf#1514 AS n_name_prf_1#1519, n_comment_prf#1515 AS n_comment_prf_1#1520]
         :  :     +- Relation[rid#1511,n_regionkey_prf#1512,n_nationkey_prf#1513,n_name_prf#1514,n_comment_prf#1515] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#1527]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#1526]
         :        :  +- Relation[rid#1521,n_regionkey_prf#1522,n_nationkey_prf#1523,n_name_prf#1524,n_comment_prf#1525] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#1528 AS c_acctbal_prf_2#1537, rid#1529 AS rid_2#1538, c_name_prf#1530 AS c_name_prf_2#1539, c_nationkey_prf#1531 AS c_nationkey_prf_2#1540, c_custkey_prf#1532 AS c_custkey_prf_2#1541, c_comment_prf#1533 AS c_comment_prf_2#1542, c_address_prf#1534 AS c_address_prf_2#1543, c_mktsegment_prf#1535 AS c_mktsegment_prf_2#1544, c_phone_prf#1536 AS c_phone_prf_2#1545]
            +- Relation[c_acctbal_prf#1528,rid#1529,c_name_prf#1530,c_nationkey_prf#1531,c_custkey_prf#1532,c_comment_prf#1533,c_address_prf#1534,c_mktsegment_prf#1535,c_phone_prf#1536] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 38296ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/15 01:18:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:18:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1596L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 01:18:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1596L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#1618]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#1609: string
         :     :- Project [o_shippriority_prf#1598 AS o_shippriority_prf_0#1608, rid#1599 AS rid_0#1609, o_orderdate_prf#1600 AS o_orderdate_prf_0#1610, o_custkey_prf#1601 AS o_custkey_prf_0#1611, o_orderpriority_prf#1602 AS o_orderpriority_prf_0#1612, o_clerk_prf#1603 AS o_clerk_prf_0#1613, o_orderstatus_prf#1604 AS o_orderstatus_prf_0#1614, o_totalprice_prf#1605 AS o_totalprice_prf_0#1615, o_orderkey_prf#1606 AS o_orderkey_prf_0#1616, o_comment_prf#1607 AS o_comment_prf_0#1617]
         :     :  +- Relation[o_shippriority_prf#1598,rid#1599,o_orderdate_prf#1600,o_custkey_prf#1601,o_orderpriority_prf#1602,o_clerk_prf#1603,o_orderstatus_prf#1604,o_totalprice_prf#1605,o_orderkey_prf#1606,o_comment_prf#1607] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1619 AS l_returnflag_prf_1#1638, l_orderkey_and_l_linenumber_prf#1620 AS l_orderkey_and_l_linenumber_prf_1#1639, l_comment_prf#1621 AS l_comment_prf_1#1640, l_linestatus_prf#1622 AS l_linestatus_prf_1#1641, rid#1623 AS rid_1#1642, l_shipmode_prf#1624 AS l_shipmode_prf_1#1643, l_shipinstruct_prf#1625 AS l_shipinstruct_prf_1#1644, l_quantity_prf#1626 AS l_quantity_prf_1#1645, l_receiptdate_prf#1627 AS l_receiptdate_prf_1#1646, l_linenumber_prf#1628 AS l_linenumber_prf_1#1647, l_tax_prf#1629 AS l_tax_prf_1#1648, l_shipdate_prf#1630 AS l_shipdate_prf_1#1649, l_extendedprice_prf#1631 AS l_extendedprice_prf_1#1650, l_partkey_prf#1632 AS l_partkey_prf_1#1651, l_discount_prf#1633 AS l_discount_prf_1#1652, l_partkey_and_l_suppkey_prf#1634 AS l_partkey_and_l_suppkey_prf_1#1653, l_commitdate_prf#1635 AS l_commitdate_prf_1#1654, l_suppkey_prf#1636 AS l_suppkey_prf_1#1655, l_orderkey_prf#1637 AS l_orderkey_prf_1#1656]
            +- Relation[l_returnflag_prf#1619,l_orderkey_and_l_linenumber_prf#1620,l_comment_prf#1621,l_linestatus_prf#1622,rid#1623,l_shipmode_prf#1624,l_shipinstruct_prf#1625,l_quantity_prf#1626,l_receiptdate_prf#1627,l_linenumber_prf#1628,l_tax_prf#1629,l_shipdate_prf#1630,l_extendedprice_prf#1631,l_partkey_prf#1632,l_discount_prf#1633,l_partkey_and_l_suppkey_prf#1634,l_commitdate_prf#1635,l_suppkey_prf#1636,l_orderkey_prf#1637] JDBCRelation(lineitem_prf) [numPartitions=1]

19/10/15 01:18:54 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=6001215
Elapsed time: 196219ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/15 01:22:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:22:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1722L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 01:22:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1722L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_2#1742]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#1734: string
         :     :- Project [c_acctbal_prf#1724 AS c_acctbal_prf_0#1733, rid#1725 AS rid_0#1734, c_name_prf#1726 AS c_name_prf_0#1735, c_nationkey_prf#1727 AS c_nationkey_prf_0#1736, c_custkey_prf#1728 AS c_custkey_prf_0#1737, c_comment_prf#1729 AS c_comment_prf_0#1738, c_address_prf#1730 AS c_address_prf_0#1739, c_mktsegment_prf#1731 AS c_mktsegment_prf_0#1740, c_phone_prf#1732 AS c_phone_prf_0#1741]
         :     :  +- Relation[c_acctbal_prf#1724,rid#1725,c_name_prf#1726,c_nationkey_prf#1727,c_custkey_prf#1728,c_comment_prf#1729,c_address_prf#1730,c_mktsegment_prf#1731,c_phone_prf#1732] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#1781]
            :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_1#1766: string
            :     :- Project [l_returnflag_prf#1743 AS l_returnflag_prf_1#1762, l_orderkey_and_l_linenumber_prf#1744 AS l_orderkey_and_l_linenumber_prf_1#1763, l_comment_prf#1745 AS l_comment_prf_1#1764, l_linestatus_prf#1746 AS l_linestatus_prf_1#1765, rid#1747 AS rid_1#1766, l_shipmode_prf#1748 AS l_shipmode_prf_1#1767, l_shipinstruct_prf#1749 AS l_shipinstruct_prf_1#1768, l_quantity_prf#1750 AS l_quantity_prf_1#1769, l_receiptdate_prf#1751 AS l_receiptdate_prf_1#1770, l_linenumber_prf#1752 AS l_linenumber_prf_1#1771, l_tax_prf#1753 AS l_tax_prf_1#1772, l_shipdate_prf#1754 AS l_shipdate_prf_1#1773, l_extendedprice_prf#1755 AS l_extendedprice_prf_1#1774, l_partkey_prf#1756 AS l_partkey_prf_1#1775, l_discount_prf#1757 AS l_discount_prf_1#1776, l_partkey_and_l_suppkey_prf#1758 AS l_partkey_and_l_suppkey_prf_1#1777, l_commitdate_prf#1759 AS l_commitdate_prf_1#1778, l_suppkey_prf#1760 AS l_suppkey_prf_1#1779, l_orderkey_prf#1761 AS l_orderkey_prf_1#1780]
            :     :  +- Relation[l_returnflag_prf#1743,l_orderkey_and_l_linenumber_prf#1744,l_comment_prf#1745,l_linestatus_prf#1746,rid#1747,l_shipmode_prf#1748,l_shipinstruct_prf#1749,l_quantity_prf#1750,l_receiptdate_prf#1751,l_linenumber_prf#1752,l_tax_prf#1753,l_shipdate_prf#1754,l_extendedprice_prf#1755,l_partkey_prf#1756,l_discount_prf#1757,l_partkey_and_l_suppkey_prf#1758,l_commitdate_prf#1759,l_suppkey_prf#1760,l_orderkey_prf#1761] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#1782 AS o_shippriority_prf_2#1792, rid#1783 AS rid_2#1793, o_orderdate_prf#1784 AS o_orderdate_prf_2#1794, o_custkey_prf#1785 AS o_custkey_prf_2#1795, o_orderpriority_prf#1786 AS o_orderpriority_prf_2#1796, o_clerk_prf#1787 AS o_clerk_prf_2#1797, o_orderstatus_prf#1788 AS o_orderstatus_prf_2#1798, o_totalprice_prf#1789 AS o_totalprice_prf_2#1799, o_orderkey_prf#1790 AS o_orderkey_prf_2#1800, o_comment_prf#1791 AS o_comment_prf_2#1801]
               +- Relation[o_shippriority_prf#1782,rid#1783,o_orderdate_prf#1784,o_custkey_prf#1785,o_orderpriority_prf#1786,o_clerk_prf#1787,o_orderstatus_prf#1788,o_totalprice_prf#1789,o_orderkey_prf#1790,o_comment_prf#1791] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 157491ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/15 01:24:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:24:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1876L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/15 01:24:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1876L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#1916]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#1901: string
         :     :- Project [l_returnflag_prf#1878 AS l_returnflag_prf_0#1897, l_orderkey_and_l_linenumber_prf#1879 AS l_orderkey_and_l_linenumber_prf_0#1898, l_comment_prf#1880 AS l_comment_prf_0#1899, l_linestatus_prf#1881 AS l_linestatus_prf_0#1900, rid#1882 AS rid_0#1901, l_shipmode_prf#1883 AS l_shipmode_prf_0#1902, l_shipinstruct_prf#1884 AS l_shipinstruct_prf_0#1903, l_quantity_prf#1885 AS l_quantity_prf_0#1904, l_receiptdate_prf#1886 AS l_receiptdate_prf_0#1905, l_linenumber_prf#1887 AS l_linenumber_prf_0#1906, l_tax_prf#1888 AS l_tax_prf_0#1907, l_shipdate_prf#1889 AS l_shipdate_prf_0#1908, l_extendedprice_prf#1890 AS l_extendedprice_prf_0#1909, l_partkey_prf#1891 AS l_partkey_prf_0#1910, l_discount_prf#1892 AS l_discount_prf_0#1911, l_partkey_and_l_suppkey_prf#1893 AS l_partkey_and_l_suppkey_prf_0#1912, l_commitdate_prf#1894 AS l_commitdate_prf_0#1913, l_suppkey_prf#1895 AS l_suppkey_prf_0#1914, l_orderkey_prf#1896 AS l_orderkey_prf_0#1915]
         :     :  +- Relation[l_returnflag_prf#1878,l_orderkey_and_l_linenumber_prf#1879,l_comment_prf#1880,l_linestatus_prf#1881,rid#1882,l_shipmode_prf#1883,l_shipinstruct_prf#1884,l_quantity_prf#1885,l_receiptdate_prf#1886,l_linenumber_prf#1887,l_tax_prf#1888,l_shipdate_prf#1889,l_extendedprice_prf#1890,l_partkey_prf#1891,l_discount_prf#1892,l_partkey_and_l_suppkey_prf#1893,l_commitdate_prf#1894,l_suppkey_prf#1895,l_orderkey_prf#1896] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#1937]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#1928: string
            :     :- Project [o_shippriority_prf#1917 AS o_shippriority_prf_1#1927, rid#1918 AS rid_1#1928, o_orderdate_prf#1919 AS o_orderdate_prf_1#1929, o_custkey_prf#1920 AS o_custkey_prf_1#1930, o_orderpriority_prf#1921 AS o_orderpriority_prf_1#1931, o_clerk_prf#1922 AS o_clerk_prf_1#1932, o_orderstatus_prf#1923 AS o_orderstatus_prf_1#1933, o_totalprice_prf#1924 AS o_totalprice_prf_1#1934, o_orderkey_prf#1925 AS o_orderkey_prf_1#1935, o_comment_prf#1926 AS o_comment_prf_1#1936]
            :     :  +- Relation[o_shippriority_prf#1917,rid#1918,o_orderdate_prf#1919,o_custkey_prf#1920,o_orderpriority_prf#1921,o_clerk_prf#1922,o_orderstatus_prf#1923,o_totalprice_prf#1924,o_orderkey_prf#1925,o_comment_prf#1926] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#1938 AS c_acctbal_prf_2#1947, rid#1939 AS rid_2#1948, c_name_prf#1940 AS c_name_prf_2#1949, c_nationkey_prf#1941 AS c_nationkey_prf_2#1950, c_custkey_prf#1942 AS c_custkey_prf_2#1951, c_comment_prf#1943 AS c_comment_prf_2#1952, c_address_prf#1944 AS c_address_prf_2#1953, c_mktsegment_prf#1945 AS c_mktsegment_prf_2#1954, c_phone_prf#1946 AS c_phone_prf_2#1955]
               +- Relation[c_acctbal_prf#1938,rid#1939,c_name_prf#1940,c_nationkey_prf#1941,c_custkey_prf#1942,c_comment_prf#1943,c_address_prf#1944,c_mktsegment_prf#1945,c_phone_prf#1946] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 151632ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/15 01:27:19 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:27:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2018L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 01:27:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2018L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#2036]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#2029: string
         :     :- Project [s_phone_prf#2020 AS s_phone_prf_0#2028, rid#2021 AS rid_0#2029, s_address_prf#2022 AS s_address_prf_0#2030, s_nationkey_prf#2023 AS s_nationkey_prf_0#2031, s_suppkey_prf#2024 AS s_suppkey_prf_0#2032, s_name_prf#2025 AS s_name_prf_0#2033, s_acctbal_prf#2026 AS s_acctbal_prf_0#2034, s_comment_prf#2027 AS s_comment_prf_0#2035]
         :     :  +- Relation[s_phone_prf#2020,rid#2021,s_address_prf#2022,s_nationkey_prf#2023,s_suppkey_prf#2024,s_name_prf#2025,s_acctbal_prf#2026,s_comment_prf#2027] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#2051]
            :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_1#2045: string
            :     :- Project [ps_partkey_and_ps_suppkey_prf#2037 AS ps_partkey_and_ps_suppkey_prf_1#2044, rid#2038 AS rid_1#2045, ps_availqty_prf#2039 AS ps_availqty_prf_1#2046, ps_comment_prf#2040 AS ps_comment_prf_1#2047, ps_partkey_prf#2041 AS ps_partkey_prf_1#2048, ps_supplycost_prf#2042 AS ps_supplycost_prf_1#2049, ps_suppkey_prf#2043 AS ps_suppkey_prf_1#2050]
            :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2037,rid#2038,ps_availqty_prf#2039,ps_comment_prf#2040,ps_partkey_prf#2041,ps_supplycost_prf#2042,ps_suppkey_prf#2043] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#2052 AS p_comment_prf_2#2062, p_name_prf#2053 AS p_name_prf_2#2063, rid#2054 AS rid_2#2064, p_type_prf#2055 AS p_type_prf_2#2065, p_retailprice_prf#2056 AS p_retailprice_prf_2#2066, p_mfgr_prf#2057 AS p_mfgr_prf_2#2067, p_container_prf#2058 AS p_container_prf_2#2068, p_brand_prf#2059 AS p_brand_prf_2#2069, p_size_prf#2060 AS p_size_prf_2#2070, p_partkey_prf#2061 AS p_partkey_prf_2#2071]
               +- Relation[p_comment_prf#2052,p_name_prf#2053,rid#2054,p_type_prf#2055,p_retailprice_prf#2056,p_mfgr_prf#2057,p_container_prf#2058,p_brand_prf#2059,p_size_prf#2060,p_partkey_prf#2061] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 61963ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/15 01:28:21 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:28:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2121L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 01:28:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2121L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#2137]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, rid_0#2131: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#2123 AS ps_partkey_and_ps_suppkey_prf_0#2130, rid#2124 AS rid_0#2131, ps_availqty_prf#2125 AS ps_availqty_prf_0#2132, ps_comment_prf#2126 AS ps_comment_prf_0#2133, ps_partkey_prf#2127 AS ps_partkey_prf_0#2134, ps_supplycost_prf#2128 AS ps_supplycost_prf_0#2135, ps_suppkey_prf#2129 AS ps_suppkey_prf_0#2136]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2123,rid#2124,ps_availqty_prf#2125,ps_comment_prf#2126,ps_partkey_prf#2127,ps_supplycost_prf#2128,ps_suppkey_prf#2129] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2138 AS l_returnflag_prf_1#2157, l_orderkey_and_l_linenumber_prf#2139 AS l_orderkey_and_l_linenumber_prf_1#2158, l_comment_prf#2140 AS l_comment_prf_1#2159, l_linestatus_prf#2141 AS l_linestatus_prf_1#2160, rid#2142 AS rid_1#2161, l_shipmode_prf#2143 AS l_shipmode_prf_1#2162, l_shipinstruct_prf#2144 AS l_shipinstruct_prf_1#2163, l_quantity_prf#2145 AS l_quantity_prf_1#2164, l_receiptdate_prf#2146 AS l_receiptdate_prf_1#2165, l_linenumber_prf#2147 AS l_linenumber_prf_1#2166, l_tax_prf#2148 AS l_tax_prf_1#2167, l_shipdate_prf#2149 AS l_shipdate_prf_1#2168, l_extendedprice_prf#2150 AS l_extendedprice_prf_1#2169, l_partkey_prf#2151 AS l_partkey_prf_1#2170, l_discount_prf#2152 AS l_discount_prf_1#2171, l_partkey_and_l_suppkey_prf#2153 AS l_partkey_and_l_suppkey_prf_1#2172, l_commitdate_prf#2154 AS l_commitdate_prf_1#2173, l_suppkey_prf#2155 AS l_suppkey_prf_1#2174, l_orderkey_prf#2156 AS l_orderkey_prf_1#2175]
            +- Relation[l_returnflag_prf#2138,l_orderkey_and_l_linenumber_prf#2139,l_comment_prf#2140,l_linestatus_prf#2141,rid#2142,l_shipmode_prf#2143,l_shipinstruct_prf#2144,l_quantity_prf#2145,l_receiptdate_prf#2146,l_linenumber_prf#2147,l_tax_prf#2148,l_shipdate_prf#2149,l_extendedprice_prf#2150,l_partkey_prf#2151,l_discount_prf#2152,l_partkey_and_l_suppkey_prf#2153,l_commitdate_prf#2154,l_suppkey_prf#2155,l_orderkey_prf#2156] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 116747ms

f1=
select * from region where r_name = 'EUROPE'
19/10/15 01:30:18 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:30:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2208L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/15 01:30:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2208L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#2210 AS r_regionkey_prf_0#2214, r_name_prf#2211 AS r_name_prf_0#2215, r_comment_prf#2212 AS r_comment_prf_0#2216, rid#2213 AS rid_0#2217]
         :  +- Relation[r_regionkey_prf#2210,r_name_prf#2211,r_comment_prf#2212,rid#2213] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2220]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#2218,value#2219] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 66ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/15 01:30:18 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:30:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2261L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 01:30:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2261L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#2281]
         :  :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2273: string
         :  :  :     :- Project [c_acctbal_prf#2263 AS c_acctbal_prf_0#2272, rid#2264 AS rid_0#2273, c_name_prf#2265 AS c_name_prf_0#2274, c_nationkey_prf#2266 AS c_nationkey_prf_0#2275, c_custkey_prf#2267 AS c_custkey_prf_0#2276, c_comment_prf#2268 AS c_comment_prf_0#2277, c_address_prf#2269 AS c_address_prf_0#2278, c_mktsegment_prf#2270 AS c_mktsegment_prf_0#2279, c_phone_prf#2271 AS c_phone_prf_0#2280]
         :  :  :     :  +- Relation[c_acctbal_prf#2263,rid#2264,c_name_prf#2265,c_nationkey_prf#2266,c_custkey_prf#2267,c_comment_prf#2268,c_address_prf#2269,c_mktsegment_prf#2270,c_phone_prf#2271] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#2282 AS o_shippriority_prf_1#2292, rid#2283 AS rid_1#2293, o_orderdate_prf#2284 AS o_orderdate_prf_1#2294, o_custkey_prf#2285 AS o_custkey_prf_1#2295, o_orderpriority_prf#2286 AS o_orderpriority_prf_1#2296, o_clerk_prf#2287 AS o_clerk_prf_1#2297, o_orderstatus_prf#2288 AS o_orderstatus_prf_1#2298, o_totalprice_prf#2289 AS o_totalprice_prf_1#2299, o_orderkey_prf#2290 AS o_orderkey_prf_1#2300, o_comment_prf#2291 AS o_comment_prf_1#2301]
         :  :     +- Relation[o_shippriority_prf#2282,rid#2283,o_orderdate_prf#2284,o_custkey_prf#2285,o_orderpriority_prf#2286,o_clerk_prf#2287,o_orderstatus_prf#2288,o_totalprice_prf#2289,o_orderkey_prf#2290,o_comment_prf#2291] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#2313]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2312]
         :        :  +- Relation[o_shippriority_prf#2302,rid#2303,o_orderdate_prf#2304,o_custkey_prf#2305,o_orderpriority_prf#2306,o_clerk_prf#2307,o_orderstatus_prf#2308,o_totalprice_prf#2309,o_orderkey_prf#2310,o_comment_prf#2311] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2314 AS l_returnflag_prf_2#2333, l_orderkey_and_l_linenumber_prf#2315 AS l_orderkey_and_l_linenumber_prf_2#2334, l_comment_prf#2316 AS l_comment_prf_2#2335, l_linestatus_prf#2317 AS l_linestatus_prf_2#2336, rid#2318 AS rid_2#2337, l_shipmode_prf#2319 AS l_shipmode_prf_2#2338, l_shipinstruct_prf#2320 AS l_shipinstruct_prf_2#2339, l_quantity_prf#2321 AS l_quantity_prf_2#2340, l_receiptdate_prf#2322 AS l_receiptdate_prf_2#2341, l_linenumber_prf#2323 AS l_linenumber_prf_2#2342, l_tax_prf#2324 AS l_tax_prf_2#2343, l_shipdate_prf#2325 AS l_shipdate_prf_2#2344, l_extendedprice_prf#2326 AS l_extendedprice_prf_2#2345, l_partkey_prf#2327 AS l_partkey_prf_2#2346, l_discount_prf#2328 AS l_discount_prf_2#2347, l_partkey_and_l_suppkey_prf#2329 AS l_partkey_and_l_suppkey_prf_2#2348, l_commitdate_prf#2330 AS l_commitdate_prf_2#2349, l_suppkey_prf#2331 AS l_suppkey_prf_2#2350, l_orderkey_prf#2332 AS l_orderkey_prf_2#2351]
            +- Relation[l_returnflag_prf#2314,l_orderkey_and_l_linenumber_prf#2315,l_comment_prf#2316,l_linestatus_prf#2317,rid#2318,l_shipmode_prf#2319,l_shipinstruct_prf#2320,l_quantity_prf#2321,l_receiptdate_prf#2322,l_linenumber_prf#2323,l_tax_prf#2324,l_shipdate_prf#2325,l_extendedprice_prf#2326,l_partkey_prf#2327,l_discount_prf#2328,l_partkey_and_l_suppkey_prf#2329,l_commitdate_prf#2330,l_suppkey_prf#2331,l_orderkey_prf#2332] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 232129ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/15 01:34:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:34:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2407L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 01:34:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2407L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#2423]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#2417: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#2409 AS ps_partkey_and_ps_suppkey_prf_0#2416, rid#2410 AS rid_0#2417, ps_availqty_prf#2411 AS ps_availqty_prf_0#2418, ps_comment_prf#2412 AS ps_comment_prf_0#2419, ps_partkey_prf#2413 AS ps_partkey_prf_0#2420, ps_supplycost_prf#2414 AS ps_supplycost_prf_0#2421, ps_suppkey_prf#2415 AS ps_suppkey_prf_0#2422]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2409,rid#2410,ps_availqty_prf#2411,ps_comment_prf#2412,ps_partkey_prf#2413,ps_supplycost_prf#2414,ps_suppkey_prf#2415] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#2424 AS p_comment_prf_1#2434, p_name_prf#2425 AS p_name_prf_1#2435, rid#2426 AS rid_1#2436, p_type_prf#2427 AS p_type_prf_1#2437, p_retailprice_prf#2428 AS p_retailprice_prf_1#2438, p_mfgr_prf#2429 AS p_mfgr_prf_1#2439, p_container_prf#2430 AS p_container_prf_1#2440, p_brand_prf#2431 AS p_brand_prf_1#2441, p_size_prf#2432 AS p_size_prf_1#2442, p_partkey_prf#2433 AS p_partkey_prf_1#2443]
            :  +- Relation[p_comment_prf#2424,p_name_prf#2425,rid#2426,p_type_prf#2427,p_retailprice_prf#2428,p_mfgr_prf#2429,p_container_prf#2430,p_brand_prf#2431,p_size_prf#2432,p_partkey_prf#2433] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2444]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#2218,value#2219] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 49346ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/15 01:34:59 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:34:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2486L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 01:34:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2486L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#2502]
         :  :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#2496: string
         :  :  :     :- Project [ps_partkey_and_ps_suppkey_prf#2488 AS ps_partkey_and_ps_suppkey_prf_0#2495, rid#2489 AS rid_0#2496, ps_availqty_prf#2490 AS ps_availqty_prf_0#2497, ps_comment_prf#2491 AS ps_comment_prf_0#2498, ps_partkey_prf#2492 AS ps_partkey_prf_0#2499, ps_supplycost_prf#2493 AS ps_supplycost_prf_0#2500, ps_suppkey_prf#2494 AS ps_suppkey_prf_0#2501]
         :  :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2488,rid#2489,ps_availqty_prf#2490,ps_comment_prf#2491,ps_partkey_prf#2492,ps_supplycost_prf#2493,ps_suppkey_prf#2494] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#2503 AS p_comment_prf_1#2513, p_name_prf#2504 AS p_name_prf_1#2514, rid#2505 AS rid_1#2515, p_type_prf#2506 AS p_type_prf_1#2516, p_retailprice_prf#2507 AS p_retailprice_prf_1#2517, p_mfgr_prf#2508 AS p_mfgr_prf_1#2518, p_container_prf#2509 AS p_container_prf_1#2519, p_brand_prf#2510 AS p_brand_prf_1#2520, p_size_prf#2511 AS p_size_prf_1#2521, p_partkey_prf#2512 AS p_partkey_prf_1#2522]
         :  :     +- Relation[p_comment_prf#2503,p_name_prf#2504,rid#2505,p_type_prf#2506,p_retailprice_prf#2507,p_mfgr_prf#2508,p_container_prf#2509,p_brand_prf#2510,p_size_prf#2511,p_partkey_prf#2512] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1509) AS rid_2#2531]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2530]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#2523,rid#2524,ps_availqty_prf#2525,ps_comment_prf#2526,ps_partkey_prf#2527,ps_supplycost_prf#2528,ps_suppkey_prf#2529] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2532 AS s_phone_prf_2#2540, rid#2533 AS rid_2#2541, s_address_prf#2534 AS s_address_prf_2#2542, s_nationkey_prf#2535 AS s_nationkey_prf_2#2543, s_suppkey_prf#2536 AS s_suppkey_prf_2#2544, s_name_prf#2537 AS s_name_prf_2#2545, s_acctbal_prf#2538 AS s_acctbal_prf_2#2546, s_comment_prf#2539 AS s_comment_prf_2#2547]
            +- Relation[s_phone_prf#2532,rid#2533,s_address_prf#2534,s_nationkey_prf#2535,s_suppkey_prf#2536,s_name_prf#2537,s_acctbal_prf#2538,s_comment_prf#2539] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 105479ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/15 01:36:45 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:36:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2593L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 01:36:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2593L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#2613]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2605: string
         :     :- Project [c_acctbal_prf#2595 AS c_acctbal_prf_0#2604, rid#2596 AS rid_0#2605, c_name_prf#2597 AS c_name_prf_0#2606, c_nationkey_prf#2598 AS c_nationkey_prf_0#2607, c_custkey_prf#2599 AS c_custkey_prf_0#2608, c_comment_prf#2600 AS c_comment_prf_0#2609, c_address_prf#2601 AS c_address_prf_0#2610, c_mktsegment_prf#2602 AS c_mktsegment_prf_0#2611, c_phone_prf#2603 AS c_phone_prf_0#2612]
         :     :  +- Relation[c_acctbal_prf#2595,rid#2596,c_name_prf#2597,c_nationkey_prf#2598,c_custkey_prf#2599,c_comment_prf#2600,c_address_prf#2601,c_mktsegment_prf#2602,c_phone_prf#2603] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2614 AS o_shippriority_prf_1#2624, rid#2615 AS rid_1#2625, o_orderdate_prf#2616 AS o_orderdate_prf_1#2626, o_custkey_prf#2617 AS o_custkey_prf_1#2627, o_orderpriority_prf#2618 AS o_orderpriority_prf_1#2628, o_clerk_prf#2619 AS o_clerk_prf_1#2629, o_orderstatus_prf#2620 AS o_orderstatus_prf_1#2630, o_totalprice_prf#2621 AS o_totalprice_prf_1#2631, o_orderkey_prf#2622 AS o_orderkey_prf_1#2632, o_comment_prf#2623 AS o_comment_prf_1#2633]
            +- Relation[o_shippriority_prf#2614,rid#2615,o_orderdate_prf#2616,o_custkey_prf#2617,o_orderpriority_prf#2618,o_clerk_prf#2619,o_orderstatus_prf#2620,o_totalprice_prf#2621,o_orderkey_prf#2622,o_comment_prf#2623] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1500000
Elapsed time: 39979ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/15 01:37:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:37:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2663L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/15 01:37:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2663L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#2673]
         :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#2672: string
         :     :- Project [r_regionkey_prf#2665 AS r_regionkey_prf_0#2669, r_name_prf#2666 AS r_name_prf_0#2670, r_comment_prf#2667 AS r_comment_prf_0#2671, rid#2668 AS rid_0#2672]
         :     :  +- Relation[r_regionkey_prf#2665,r_name_prf#2666,r_comment_prf#2667,rid#2668] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#2674 AS rid_1#2679, n_regionkey_prf#2675 AS n_regionkey_prf_1#2680, n_nationkey_prf#2676 AS n_nationkey_prf_1#2681, n_name_prf#2677 AS n_name_prf_1#2682, n_comment_prf#2678 AS n_comment_prf_1#2683]
            +- Relation[rid#2674,n_regionkey_prf#2675,n_nationkey_prf#2676,n_name_prf#2677,n_comment_prf#2678] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=25
Elapsed time: 70ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/15 01:37:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:37:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2707L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 01:37:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2707L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#2719]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#2714: string
         :     :- Project [rid#2709 AS rid_0#2714, n_regionkey_prf#2710 AS n_regionkey_prf_0#2715, n_nationkey_prf#2711 AS n_nationkey_prf_0#2716, n_name_prf#2712 AS n_name_prf_0#2717, n_comment_prf#2713 AS n_comment_prf_0#2718]
         :     :  +- Relation[rid#2709,n_regionkey_prf#2710,n_nationkey_prf#2711,n_name_prf#2712,n_comment_prf#2713] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2720 AS s_phone_prf_1#2728, rid#2721 AS rid_1#2729, s_address_prf#2722 AS s_address_prf_1#2730, s_nationkey_prf#2723 AS s_nationkey_prf_1#2731, s_suppkey_prf#2724 AS s_suppkey_prf_1#2732, s_name_prf#2725 AS s_name_prf_1#2733, s_acctbal_prf#2726 AS s_acctbal_prf_1#2734, s_comment_prf#2727 AS s_comment_prf_1#2735]
            +- Relation[s_phone_prf#2720,rid#2721,s_address_prf#2722,s_nationkey_prf#2723,s_suppkey_prf#2724,s_name_prf#2725,s_acctbal_prf#2726,s_comment_prf#2727] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=10000
Elapsed time: 188ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/15 01:37:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:37:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2785L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/15 01:37:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2785L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#2825]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2810: string
         :  :  :     :- Project [l_returnflag_prf#2787 AS l_returnflag_prf_0#2806, l_orderkey_and_l_linenumber_prf#2788 AS l_orderkey_and_l_linenumber_prf_0#2807, l_comment_prf#2789 AS l_comment_prf_0#2808, l_linestatus_prf#2790 AS l_linestatus_prf_0#2809, rid#2791 AS rid_0#2810, l_shipmode_prf#2792 AS l_shipmode_prf_0#2811, l_shipinstruct_prf#2793 AS l_shipinstruct_prf_0#2812, l_quantity_prf#2794 AS l_quantity_prf_0#2813, l_receiptdate_prf#2795 AS l_receiptdate_prf_0#2814, l_linenumber_prf#2796 AS l_linenumber_prf_0#2815, l_tax_prf#2797 AS l_tax_prf_0#2816, l_shipdate_prf#2798 AS l_shipdate_prf_0#2817, l_extendedprice_prf#2799 AS l_extendedprice_prf_0#2818, l_partkey_prf#2800 AS l_partkey_prf_0#2819, l_discount_prf#2801 AS l_discount_prf_0#2820, l_partkey_and_l_suppkey_prf#2802 AS l_partkey_and_l_suppkey_prf_0#2821, l_commitdate_prf#2803 AS l_commitdate_prf_0#2822, l_suppkey_prf#2804 AS l_suppkey_prf_0#2823, l_orderkey_prf#2805 AS l_orderkey_prf_0#2824]
         :  :  :     :  +- Relation[l_returnflag_prf#2787,l_orderkey_and_l_linenumber_prf#2788,l_comment_prf#2789,l_linestatus_prf#2790,rid#2791,l_shipmode_prf#2792,l_shipinstruct_prf#2793,l_quantity_prf#2794,l_receiptdate_prf#2795,l_linenumber_prf#2796,l_tax_prf#2797,l_shipdate_prf#2798,l_extendedprice_prf#2799,l_partkey_prf#2800,l_discount_prf#2801,l_partkey_and_l_suppkey_prf#2802,l_commitdate_prf#2803,l_suppkey_prf#2804,l_orderkey_prf#2805] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#2826 AS o_shippriority_prf_1#2836, rid#2827 AS rid_1#2837, o_orderdate_prf#2828 AS o_orderdate_prf_1#2838, o_custkey_prf#2829 AS o_custkey_prf_1#2839, o_orderpriority_prf#2830 AS o_orderpriority_prf_1#2840, o_clerk_prf#2831 AS o_clerk_prf_1#2841, o_orderstatus_prf#2832 AS o_orderstatus_prf_1#2842, o_totalprice_prf#2833 AS o_totalprice_prf_1#2843, o_orderkey_prf#2834 AS o_orderkey_prf_1#2844, o_comment_prf#2835 AS o_comment_prf_1#2845]
         :  :     +- Relation[o_shippriority_prf#2826,rid#2827,o_orderdate_prf#2828,o_custkey_prf#2829,o_orderpriority_prf#2830,o_clerk_prf#2831,o_orderstatus_prf#2832,o_totalprice_prf#2833,o_orderkey_prf#2834,o_comment_prf#2835] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#2857]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2856]
         :        :  +- Relation[o_shippriority_prf#2846,rid#2847,o_orderdate_prf#2848,o_custkey_prf#2849,o_orderpriority_prf#2850,o_clerk_prf#2851,o_orderstatus_prf#2852,o_totalprice_prf#2853,o_orderkey_prf#2854,o_comment_prf#2855] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2858 AS c_acctbal_prf_2#2867, rid#2859 AS rid_2#2868, c_name_prf#2860 AS c_name_prf_2#2869, c_nationkey_prf#2861 AS c_nationkey_prf_2#2870, c_custkey_prf#2862 AS c_custkey_prf_2#2871, c_comment_prf#2863 AS c_comment_prf_2#2872, c_address_prf#2864 AS c_address_prf_2#2873, c_mktsegment_prf#2865 AS c_mktsegment_prf_2#2874, c_phone_prf#2866 AS c_phone_prf_2#2875]
            +- Relation[c_acctbal_prf#2858,rid#2859,c_name_prf#2860,c_nationkey_prf#2861,c_custkey_prf#2862,c_comment_prf#2863,c_address_prf#2864,c_mktsegment_prf#2865,c_phone_prf#2866] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 169951ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/15 01:40:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:40:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2949L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 01:40:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2949L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_2#2967]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#2960: string
         :     :- Project [s_phone_prf#2951 AS s_phone_prf_0#2959, rid#2952 AS rid_0#2960, s_address_prf#2953 AS s_address_prf_0#2961, s_nationkey_prf#2954 AS s_nationkey_prf_0#2962, s_suppkey_prf#2955 AS s_suppkey_prf_0#2963, s_name_prf#2956 AS s_name_prf_0#2964, s_acctbal_prf#2957 AS s_acctbal_prf_0#2965, s_comment_prf#2958 AS s_comment_prf_0#2966]
         :     :  +- Relation[s_phone_prf#2951,rid#2952,s_address_prf#2953,s_nationkey_prf#2954,s_suppkey_prf#2955,s_name_prf#2956,s_acctbal_prf#2957,s_comment_prf#2958] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#2988]
            :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#2980: string
            :     :- Project [p_comment_prf#2968 AS p_comment_prf_1#2978, p_name_prf#2969 AS p_name_prf_1#2979, rid#2970 AS rid_1#2980, p_type_prf#2971 AS p_type_prf_1#2981, p_retailprice_prf#2972 AS p_retailprice_prf_1#2982, p_mfgr_prf#2973 AS p_mfgr_prf_1#2983, p_container_prf#2974 AS p_container_prf_1#2984, p_brand_prf#2975 AS p_brand_prf_1#2985, p_size_prf#2976 AS p_size_prf_1#2986, p_partkey_prf#2977 AS p_partkey_prf_1#2987]
            :     :  +- Relation[p_comment_prf#2968,p_name_prf#2969,rid#2970,p_type_prf#2971,p_retailprice_prf#2972,p_mfgr_prf#2973,p_container_prf#2974,p_brand_prf#2975,p_size_prf#2976,p_partkey_prf#2977] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#2989 AS l_returnflag_prf_2#3008, l_orderkey_and_l_linenumber_prf#2990 AS l_orderkey_and_l_linenumber_prf_2#3009, l_comment_prf#2991 AS l_comment_prf_2#3010, l_linestatus_prf#2992 AS l_linestatus_prf_2#3011, rid#2993 AS rid_2#3012, l_shipmode_prf#2994 AS l_shipmode_prf_2#3013, l_shipinstruct_prf#2995 AS l_shipinstruct_prf_2#3014, l_quantity_prf#2996 AS l_quantity_prf_2#3015, l_receiptdate_prf#2997 AS l_receiptdate_prf_2#3016, l_linenumber_prf#2998 AS l_linenumber_prf_2#3017, l_tax_prf#2999 AS l_tax_prf_2#3018, l_shipdate_prf#3000 AS l_shipdate_prf_2#3019, l_extendedprice_prf#3001 AS l_extendedprice_prf_2#3020, l_partkey_prf#3002 AS l_partkey_prf_2#3021, l_discount_prf#3003 AS l_discount_prf_2#3022, l_partkey_and_l_suppkey_prf#3004 AS l_partkey_and_l_suppkey_prf_2#3023, l_commitdate_prf#3005 AS l_commitdate_prf_2#3024, l_suppkey_prf#3006 AS l_suppkey_prf_2#3025, l_orderkey_prf#3007 AS l_orderkey_prf_2#3026]
               +- Relation[l_returnflag_prf#2989,l_orderkey_and_l_linenumber_prf#2990,l_comment_prf#2991,l_linestatus_prf#2992,rid#2993,l_shipmode_prf#2994,l_shipinstruct_prf#2995,l_quantity_prf#2996,l_receiptdate_prf#2997,l_linenumber_prf#2998,l_tax_prf#2999,l_shipdate_prf#3000,l_extendedprice_prf#3001,l_partkey_prf#3002,l_discount_prf#3003,l_partkey_and_l_suppkey_prf#3004,l_commitdate_prf#3005,l_suppkey_prf#3006,l_orderkey_prf#3007] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 187873ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/15 01:43:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:43:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3090L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 01:43:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3090L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#3108]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#3101: string
         :     :- Project [s_phone_prf#3092 AS s_phone_prf_0#3100, rid#3093 AS rid_0#3101, s_address_prf#3094 AS s_address_prf_0#3102, s_nationkey_prf#3095 AS s_nationkey_prf_0#3103, s_suppkey_prf#3096 AS s_suppkey_prf_0#3104, s_name_prf#3097 AS s_name_prf_0#3105, s_acctbal_prf#3098 AS s_acctbal_prf_0#3106, s_comment_prf#3099 AS s_comment_prf_0#3107]
         :     :  +- Relation[s_phone_prf#3092,rid#3093,s_address_prf#3094,s_nationkey_prf#3095,s_suppkey_prf#3096,s_name_prf#3097,s_acctbal_prf#3098,s_comment_prf#3099] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3109 AS l_returnflag_prf_1#3128, l_orderkey_and_l_linenumber_prf#3110 AS l_orderkey_and_l_linenumber_prf_1#3129, l_comment_prf#3111 AS l_comment_prf_1#3130, l_linestatus_prf#3112 AS l_linestatus_prf_1#3131, rid#3113 AS rid_1#3132, l_shipmode_prf#3114 AS l_shipmode_prf_1#3133, l_shipinstruct_prf#3115 AS l_shipinstruct_prf_1#3134, l_quantity_prf#3116 AS l_quantity_prf_1#3135, l_receiptdate_prf#3117 AS l_receiptdate_prf_1#3136, l_linenumber_prf#3118 AS l_linenumber_prf_1#3137, l_tax_prf#3119 AS l_tax_prf_1#3138, l_shipdate_prf#3120 AS l_shipdate_prf_1#3139, l_extendedprice_prf#3121 AS l_extendedprice_prf_1#3140, l_partkey_prf#3122 AS l_partkey_prf_1#3141, l_discount_prf#3123 AS l_discount_prf_1#3142, l_partkey_and_l_suppkey_prf#3124 AS l_partkey_and_l_suppkey_prf_1#3143, l_commitdate_prf#3125 AS l_commitdate_prf_1#3144, l_suppkey_prf#3126 AS l_suppkey_prf_1#3145, l_orderkey_prf#3127 AS l_orderkey_prf_1#3146]
            +- Relation[l_returnflag_prf#3109,l_orderkey_and_l_linenumber_prf#3110,l_comment_prf#3111,l_linestatus_prf#3112,rid#3113,l_shipmode_prf#3114,l_shipinstruct_prf#3115,l_quantity_prf#3116,l_receiptdate_prf#3117,l_linenumber_prf#3118,l_tax_prf#3119,l_shipdate_prf#3120,l_extendedprice_prf#3121,l_partkey_prf#3122,l_discount_prf#3123,l_partkey_and_l_suppkey_prf#3124,l_commitdate_prf#3125,l_suppkey_prf#3126,l_orderkey_prf#3127] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 86575ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/15 01:44:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:44:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3181L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/15 01:44:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3181L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#3183 AS rid_0#3188, n_regionkey_prf#3184 AS n_regionkey_prf_0#3189, n_nationkey_prf#3185 AS n_nationkey_prf_0#3190, n_name_prf#3186 AS n_name_prf_0#3191, n_comment_prf#3187 AS n_comment_prf_0#3192]
         :  +- Relation[rid#3183,n_regionkey_prf#3184,n_nationkey_prf#3185,n_name_prf#3186,n_comment_prf#3187] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3193]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#2218,value#2219] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 53ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/15 01:44:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:44:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3227L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 01:44:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3227L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#3267]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3252: string
         :     :- Project [l_returnflag_prf#3229 AS l_returnflag_prf_0#3248, l_orderkey_and_l_linenumber_prf#3230 AS l_orderkey_and_l_linenumber_prf_0#3249, l_comment_prf#3231 AS l_comment_prf_0#3250, l_linestatus_prf#3232 AS l_linestatus_prf_0#3251, rid#3233 AS rid_0#3252, l_shipmode_prf#3234 AS l_shipmode_prf_0#3253, l_shipinstruct_prf#3235 AS l_shipinstruct_prf_0#3254, l_quantity_prf#3236 AS l_quantity_prf_0#3255, l_receiptdate_prf#3237 AS l_receiptdate_prf_0#3256, l_linenumber_prf#3238 AS l_linenumber_prf_0#3257, l_tax_prf#3239 AS l_tax_prf_0#3258, l_shipdate_prf#3240 AS l_shipdate_prf_0#3259, l_extendedprice_prf#3241 AS l_extendedprice_prf_0#3260, l_partkey_prf#3242 AS l_partkey_prf_0#3261, l_discount_prf#3243 AS l_discount_prf_0#3262, l_partkey_and_l_suppkey_prf#3244 AS l_partkey_and_l_suppkey_prf_0#3263, l_commitdate_prf#3245 AS l_commitdate_prf_0#3264, l_suppkey_prf#3246 AS l_suppkey_prf_0#3265, l_orderkey_prf#3247 AS l_orderkey_prf_0#3266]
         :     :  +- Relation[l_returnflag_prf#3229,l_orderkey_and_l_linenumber_prf#3230,l_comment_prf#3231,l_linestatus_prf#3232,rid#3233,l_shipmode_prf#3234,l_shipinstruct_prf#3235,l_quantity_prf#3236,l_receiptdate_prf#3237,l_linenumber_prf#3238,l_tax_prf#3239,l_shipdate_prf#3240,l_extendedprice_prf#3241,l_partkey_prf#3242,l_discount_prf#3243,l_partkey_and_l_suppkey_prf#3244,l_commitdate_prf#3245,l_suppkey_prf#3246,l_orderkey_prf#3247] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3268 AS o_shippriority_prf_1#3278, rid#3269 AS rid_1#3279, o_orderdate_prf#3270 AS o_orderdate_prf_1#3280, o_custkey_prf#3271 AS o_custkey_prf_1#3281, o_orderpriority_prf#3272 AS o_orderpriority_prf_1#3282, o_clerk_prf#3273 AS o_clerk_prf_1#3283, o_orderstatus_prf#3274 AS o_orderstatus_prf_1#3284, o_totalprice_prf#3275 AS o_totalprice_prf_1#3285, o_orderkey_prf#3276 AS o_orderkey_prf_1#3286, o_comment_prf#3277 AS o_comment_prf_1#3287]
            +- Relation[o_shippriority_prf#3268,rid#3269,o_orderdate_prf#3270,o_custkey_prf#3271,o_orderpriority_prf#3272,o_clerk_prf#3273,o_orderstatus_prf#3274,o_totalprice_prf#3275,o_orderkey_prf#3276,o_comment_prf#3277] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 114141ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/15 01:46:44 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:46:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3341L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/15 01:46:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3341L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_2#3359]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#3352: string
         :     :- Project [s_phone_prf#3343 AS s_phone_prf_0#3351, rid#3344 AS rid_0#3352, s_address_prf#3345 AS s_address_prf_0#3353, s_nationkey_prf#3346 AS s_nationkey_prf_0#3354, s_suppkey_prf#3347 AS s_suppkey_prf_0#3355, s_name_prf#3348 AS s_name_prf_0#3356, s_acctbal_prf#3349 AS s_acctbal_prf_0#3357, s_comment_prf#3350 AS s_comment_prf_0#3358]
         :     :  +- Relation[s_phone_prf#3343,rid#3344,s_address_prf#3345,s_nationkey_prf#3346,s_suppkey_prf#3347,s_name_prf#3348,s_acctbal_prf#3349,s_comment_prf#3350] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#3380]
            :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#3372: string
            :     :- Project [p_comment_prf#3360 AS p_comment_prf_1#3370, p_name_prf#3361 AS p_name_prf_1#3371, rid#3362 AS rid_1#3372, p_type_prf#3363 AS p_type_prf_1#3373, p_retailprice_prf#3364 AS p_retailprice_prf_1#3374, p_mfgr_prf#3365 AS p_mfgr_prf_1#3375, p_container_prf#3366 AS p_container_prf_1#3376, p_brand_prf#3367 AS p_brand_prf_1#3377, p_size_prf#3368 AS p_size_prf_1#3378, p_partkey_prf#3369 AS p_partkey_prf_1#3379]
            :     :  +- Relation[p_comment_prf#3360,p_name_prf#3361,rid#3362,p_type_prf#3363,p_retailprice_prf#3364,p_mfgr_prf#3365,p_container_prf#3366,p_brand_prf#3367,p_size_prf#3368,p_partkey_prf#3369] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#3381 AS ps_partkey_and_ps_suppkey_prf_2#3388, rid#3382 AS rid_2#3389, ps_availqty_prf#3383 AS ps_availqty_prf_2#3390, ps_comment_prf#3384 AS ps_comment_prf_2#3391, ps_partkey_prf#3385 AS ps_partkey_prf_2#3392, ps_supplycost_prf#3386 AS ps_supplycost_prf_2#3393, ps_suppkey_prf#3387 AS ps_suppkey_prf_2#3394]
               +- Relation[ps_partkey_and_ps_suppkey_prf#3381,rid#3382,ps_availqty_prf#3383,ps_comment_prf#3384,ps_partkey_prf#3385,ps_supplycost_prf#3386,ps_suppkey_prf#3387] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 42892ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/15 01:47:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:47:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3442L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/15 01:47:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3442L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_2#3462]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#3454: string
         :     :- Project [c_acctbal_prf#3444 AS c_acctbal_prf_0#3453, rid#3445 AS rid_0#3454, c_name_prf#3446 AS c_name_prf_0#3455, c_nationkey_prf#3447 AS c_nationkey_prf_0#3456, c_custkey_prf#3448 AS c_custkey_prf_0#3457, c_comment_prf#3449 AS c_comment_prf_0#3458, c_address_prf#3450 AS c_address_prf_0#3459, c_mktsegment_prf#3451 AS c_mktsegment_prf_0#3460, c_phone_prf#3452 AS c_phone_prf_0#3461]
         :     :  +- Relation[c_acctbal_prf#3444,rid#3445,c_name_prf#3446,c_nationkey_prf#3447,c_custkey_prf#3448,c_comment_prf#3449,c_address_prf#3450,c_mktsegment_prf#3451,c_phone_prf#3452] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#3479]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#3472: string
            :     :- Project [s_phone_prf#3463 AS s_phone_prf_1#3471, rid#3464 AS rid_1#3472, s_address_prf#3465 AS s_address_prf_1#3473, s_nationkey_prf#3466 AS s_nationkey_prf_1#3474, s_suppkey_prf#3467 AS s_suppkey_prf_1#3475, s_name_prf#3468 AS s_name_prf_1#3476, s_acctbal_prf#3469 AS s_acctbal_prf_1#3477, s_comment_prf#3470 AS s_comment_prf_1#3478]
            :     :  +- Relation[s_phone_prf#3463,rid#3464,s_address_prf#3465,s_nationkey_prf#3466,s_suppkey_prf#3467,s_name_prf#3468,s_acctbal_prf#3469,s_comment_prf#3470] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [rid#3480 AS rid_2#3485, n_regionkey_prf#3481 AS n_regionkey_prf_2#3486, n_nationkey_prf#3482 AS n_nationkey_prf_2#3487, n_name_prf#3483 AS n_name_prf_2#3488, n_comment_prf#3484 AS n_comment_prf_2#3489]
               +- Relation[rid#3480,n_regionkey_prf#3481,n_nationkey_prf#3482,n_name_prf#3483,n_comment_prf#3484] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 65101ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/15 01:48:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:48:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3529L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/15 01:48:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3529L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#3552]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#3543: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#3531 AS p_comment_prf_0#3541, p_name_prf#3532 AS p_name_prf_0#3542, rid#3533 AS rid_0#3543, p_type_prf#3534 AS p_type_prf_0#3544, p_retailprice_prf#3535 AS p_retailprice_prf_0#3545, p_mfgr_prf#3536 AS p_mfgr_prf_0#3546, p_container_prf#3537 AS p_container_prf_0#3547, p_brand_prf#3538 AS p_brand_prf_0#3548, p_size_prf#3539 AS p_size_prf_0#3549, p_partkey_prf#3540 AS p_partkey_prf_0#3550]
         :     :  :  +- Relation[p_comment_prf#3531,p_name_prf#3532,rid#3533,p_type_prf#3534,p_retailprice_prf#3535,p_mfgr_prf#3536,p_container_prf#3537,p_brand_prf#3538,p_size_prf#3539,p_partkey_prf#3540] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3551]
         :     :     +- DexRidFilter part~p_size~15
         :     :        +- Relation[label#2218,value#2219] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#3553 AS ps_partkey_and_ps_suppkey_prf_1#3560, rid#3554 AS rid_1#3561, ps_availqty_prf#3555 AS ps_availqty_prf_1#3562, ps_comment_prf#3556 AS ps_comment_prf_1#3563, ps_partkey_prf#3557 AS ps_partkey_prf_1#3564, ps_supplycost_prf#3558 AS ps_supplycost_prf_1#3565, ps_suppkey_prf#3559 AS ps_suppkey_prf_1#3566]
            +- Relation[ps_partkey_and_ps_suppkey_prf#3553,rid#3554,ps_availqty_prf#3555,ps_comment_prf#3556,ps_partkey_prf#3557,ps_supplycost_prf#3558,ps_suppkey_prf#3559] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 411ms

f2=
select * from part where p_size = 15
19/10/15 01:48:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:48:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3596L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 01:48:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3596L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#3598 AS p_comment_prf_0#3608, p_name_prf#3599 AS p_name_prf_0#3609, rid#3600 AS rid_0#3610, p_type_prf#3601 AS p_type_prf_0#3611, p_retailprice_prf#3602 AS p_retailprice_prf_0#3612, p_mfgr_prf#3603 AS p_mfgr_prf_0#3613, p_container_prf#3604 AS p_container_prf_0#3614, p_brand_prf#3605 AS p_brand_prf_0#3615, p_size_prf#3606 AS p_size_prf_0#3616, p_partkey_prf#3607 AS p_partkey_prf_0#3617]
         :  +- Relation[p_comment_prf#3598,p_name_prf#3599,rid#3600,p_type_prf#3601,p_retailprice_prf#3602,p_mfgr_prf#3603,p_container_prf#3604,p_brand_prf#3605,p_size_prf#3606,p_partkey_prf#3607] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3618]
            +- DexRidFilter part~p_size~15
               +- Relation[label#2218,value#2219] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3907
Elapsed time: 126ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/15 01:48:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:48:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3664L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 01:48:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3664L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#3704]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#3689: string
         :  :  :     :- Project [l_returnflag_prf#3666 AS l_returnflag_prf_0#3685, l_orderkey_and_l_linenumber_prf#3667 AS l_orderkey_and_l_linenumber_prf_0#3686, l_comment_prf#3668 AS l_comment_prf_0#3687, l_linestatus_prf#3669 AS l_linestatus_prf_0#3688, rid#3670 AS rid_0#3689, l_shipmode_prf#3671 AS l_shipmode_prf_0#3690, l_shipinstruct_prf#3672 AS l_shipinstruct_prf_0#3691, l_quantity_prf#3673 AS l_quantity_prf_0#3692, l_receiptdate_prf#3674 AS l_receiptdate_prf_0#3693, l_linenumber_prf#3675 AS l_linenumber_prf_0#3694, l_tax_prf#3676 AS l_tax_prf_0#3695, l_shipdate_prf#3677 AS l_shipdate_prf_0#3696, l_extendedprice_prf#3678 AS l_extendedprice_prf_0#3697, l_partkey_prf#3679 AS l_partkey_prf_0#3698, l_discount_prf#3680 AS l_discount_prf_0#3699, l_partkey_and_l_suppkey_prf#3681 AS l_partkey_and_l_suppkey_prf_0#3700, l_commitdate_prf#3682 AS l_commitdate_prf_0#3701, l_suppkey_prf#3683 AS l_suppkey_prf_0#3702, l_orderkey_prf#3684 AS l_orderkey_prf_0#3703]
         :  :  :     :  +- Relation[l_returnflag_prf#3666,l_orderkey_and_l_linenumber_prf#3667,l_comment_prf#3668,l_linestatus_prf#3669,rid#3670,l_shipmode_prf#3671,l_shipinstruct_prf#3672,l_quantity_prf#3673,l_receiptdate_prf#3674,l_linenumber_prf#3675,l_tax_prf#3676,l_shipdate_prf#3677,l_extendedprice_prf#3678,l_partkey_prf#3679,l_discount_prf#3680,l_partkey_and_l_suppkey_prf#3681,l_commitdate_prf#3682,l_suppkey_prf#3683,l_orderkey_prf#3684] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#3705 AS p_comment_prf_1#3715, p_name_prf#3706 AS p_name_prf_1#3716, rid#3707 AS rid_1#3717, p_type_prf#3708 AS p_type_prf_1#3718, p_retailprice_prf#3709 AS p_retailprice_prf_1#3719, p_mfgr_prf#3710 AS p_mfgr_prf_1#3720, p_container_prf#3711 AS p_container_prf_1#3721, p_brand_prf#3712 AS p_brand_prf_1#3722, p_size_prf#3713 AS p_size_prf_1#3723, p_partkey_prf#3714 AS p_partkey_prf_1#3724]
         :  :     +- Relation[p_comment_prf#3705,p_name_prf#3706,rid#3707,p_type_prf#3708,p_retailprice_prf#3709,p_mfgr_prf#3710,p_container_prf#3711,p_brand_prf#3712,p_size_prf#3713,p_partkey_prf#3714] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1509) AS rid_2#3745]
         :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3744]
         :        :  +- Relation[l_returnflag_prf#3725,l_orderkey_and_l_linenumber_prf#3726,l_comment_prf#3727,l_linestatus_prf#3728,rid#3729,l_shipmode_prf#3730,l_shipinstruct_prf#3731,l_quantity_prf#3732,l_receiptdate_prf#3733,l_linenumber_prf#3734,l_tax_prf#3735,l_shipdate_prf#3736,l_extendedprice_prf#3737,l_partkey_prf#3738,l_discount_prf#3739,l_partkey_and_l_suppkey_prf#3740,l_commitdate_prf#3741,l_suppkey_prf#3742,l_orderkey_prf#3743] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3746 AS s_phone_prf_2#3754, rid#3747 AS rid_2#3755, s_address_prf#3748 AS s_address_prf_2#3756, s_nationkey_prf#3749 AS s_nationkey_prf_2#3757, s_suppkey_prf#3750 AS s_suppkey_prf_2#3758, s_name_prf#3751 AS s_name_prf_2#3759, s_acctbal_prf#3752 AS s_acctbal_prf_2#3760, s_comment_prf#3753 AS s_comment_prf_2#3761]
            +- Relation[s_phone_prf#3746,rid#3747,s_address_prf#3748,s_nationkey_prf#3749,s_suppkey_prf#3750,s_name_prf#3751,s_acctbal_prf#3752,s_comment_prf#3753] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 222925ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/15 01:52:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:52:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3827L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 01:52:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3827L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#3849]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#3840: string
         :     :- Project [o_shippriority_prf#3829 AS o_shippriority_prf_0#3839, rid#3830 AS rid_0#3840, o_orderdate_prf#3831 AS o_orderdate_prf_0#3841, o_custkey_prf#3832 AS o_custkey_prf_0#3842, o_orderpriority_prf#3833 AS o_orderpriority_prf_0#3843, o_clerk_prf#3834 AS o_clerk_prf_0#3844, o_orderstatus_prf#3835 AS o_orderstatus_prf_0#3845, o_totalprice_prf#3836 AS o_totalprice_prf_0#3846, o_orderkey_prf#3837 AS o_orderkey_prf_0#3847, o_comment_prf#3838 AS o_comment_prf_0#3848]
         :     :  +- Relation[o_shippriority_prf#3829,rid#3830,o_orderdate_prf#3831,o_custkey_prf#3832,o_orderpriority_prf#3833,o_clerk_prf#3834,o_orderstatus_prf#3835,o_totalprice_prf#3836,o_orderkey_prf#3837,o_comment_prf#3838] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#3850 AS l_returnflag_prf_1#3869, l_orderkey_and_l_linenumber_prf#3851 AS l_orderkey_and_l_linenumber_prf_1#3870, l_comment_prf#3852 AS l_comment_prf_1#3871, l_linestatus_prf#3853 AS l_linestatus_prf_1#3872, rid#3854 AS rid_1#3873, l_shipmode_prf#3855 AS l_shipmode_prf_1#3874, l_shipinstruct_prf#3856 AS l_shipinstruct_prf_1#3875, l_quantity_prf#3857 AS l_quantity_prf_1#3876, l_receiptdate_prf#3858 AS l_receiptdate_prf_1#3877, l_linenumber_prf#3859 AS l_linenumber_prf_1#3878, l_tax_prf#3860 AS l_tax_prf_1#3879, l_shipdate_prf#3861 AS l_shipdate_prf_1#3880, l_extendedprice_prf#3862 AS l_extendedprice_prf_1#3881, l_partkey_prf#3863 AS l_partkey_prf_1#3882, l_discount_prf#3864 AS l_discount_prf_1#3883, l_partkey_and_l_suppkey_prf#3865 AS l_partkey_and_l_suppkey_prf_1#3884, l_commitdate_prf#3866 AS l_commitdate_prf_1#3885, l_suppkey_prf#3867 AS l_suppkey_prf_1#3886, l_orderkey_prf#3868 AS l_orderkey_prf_1#3887]
            :  +- Relation[l_returnflag_prf#3850,l_orderkey_and_l_linenumber_prf#3851,l_comment_prf#3852,l_linestatus_prf#3853,rid#3854,l_shipmode_prf#3855,l_shipinstruct_prf#3856,l_quantity_prf#3857,l_receiptdate_prf#3858,l_linenumber_prf#3859,l_tax_prf#3860,l_shipdate_prf#3861,l_extendedprice_prf#3862,l_partkey_prf#3863,l_discount_prf#3864,l_partkey_and_l_suppkey_prf#3865,l_commitdate_prf#3866,l_suppkey_prf#3867,l_orderkey_prf#3868] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3888]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#2218,value#2219] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 197183ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/15 01:55:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:55:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3946L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 01:55:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3946L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#3987]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3971: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#3948 AS l_returnflag_prf_0#3967, l_orderkey_and_l_linenumber_prf#3949 AS l_orderkey_and_l_linenumber_prf_0#3968, l_comment_prf#3950 AS l_comment_prf_0#3969, l_linestatus_prf#3951 AS l_linestatus_prf_0#3970, rid#3952 AS rid_0#3971, l_shipmode_prf#3953 AS l_shipmode_prf_0#3972, l_shipinstruct_prf#3954 AS l_shipinstruct_prf_0#3973, l_quantity_prf#3955 AS l_quantity_prf_0#3974, l_receiptdate_prf#3956 AS l_receiptdate_prf_0#3975, l_linenumber_prf#3957 AS l_linenumber_prf_0#3976, l_tax_prf#3958 AS l_tax_prf_0#3977, l_shipdate_prf#3959 AS l_shipdate_prf_0#3978, l_extendedprice_prf#3960 AS l_extendedprice_prf_0#3979, l_partkey_prf#3961 AS l_partkey_prf_0#3980, l_discount_prf#3962 AS l_discount_prf_0#3981, l_partkey_and_l_suppkey_prf#3963 AS l_partkey_and_l_suppkey_prf_0#3982, l_commitdate_prf#3964 AS l_commitdate_prf_0#3983, l_suppkey_prf#3965 AS l_suppkey_prf_0#3984, l_orderkey_prf#3966 AS l_orderkey_prf_0#3985]
         :     :  :  +- Relation[l_returnflag_prf#3948,l_orderkey_and_l_linenumber_prf#3949,l_comment_prf#3950,l_linestatus_prf#3951,rid#3952,l_shipmode_prf#3953,l_shipinstruct_prf#3954,l_quantity_prf#3955,l_receiptdate_prf#3956,l_linenumber_prf#3957,l_tax_prf#3958,l_shipdate_prf#3959,l_extendedprice_prf#3960,l_partkey_prf#3961,l_discount_prf#3962,l_partkey_and_l_suppkey_prf#3963,l_commitdate_prf#3964,l_suppkey_prf#3965,l_orderkey_prf#3966] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3986]
         :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :        +- Relation[label#2218,value#2219] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3988 AS o_shippriority_prf_1#3998, rid#3989 AS rid_1#3999, o_orderdate_prf#3990 AS o_orderdate_prf_1#4000, o_custkey_prf#3991 AS o_custkey_prf_1#4001, o_orderpriority_prf#3992 AS o_orderpriority_prf_1#4002, o_clerk_prf#3993 AS o_clerk_prf_1#4003, o_orderstatus_prf#3994 AS o_orderstatus_prf_1#4004, o_totalprice_prf#3995 AS o_totalprice_prf_1#4005, o_orderkey_prf#3996 AS o_orderkey_prf_1#4006, o_comment_prf#3997 AS o_comment_prf_1#4007]
            +- Relation[o_shippriority_prf#3988,rid#3989,o_orderdate_prf#3990,o_custkey_prf#3991,o_orderpriority_prf#3992,o_clerk_prf#3993,o_orderstatus_prf#3994,o_totalprice_prf#3995,o_orderkey_prf#3996,o_comment_prf#3997] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 54547ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/15 01:56:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:56:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4059L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/15 01:56:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4059L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#4071]
         :  :  :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#4066: string
         :  :  :     :- Project [rid#4061 AS rid_0#4066, n_regionkey_prf#4062 AS n_regionkey_prf_0#4067, n_nationkey_prf#4063 AS n_nationkey_prf_0#4068, n_name_prf#4064 AS n_name_prf_0#4069, n_comment_prf#4065 AS n_comment_prf_0#4070]
         :  :  :     :  +- Relation[rid#4061,n_regionkey_prf#4062,n_nationkey_prf#4063,n_name_prf#4064,n_comment_prf#4065] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#4072 AS s_phone_prf_1#4080, rid#4073 AS rid_1#4081, s_address_prf#4074 AS s_address_prf_1#4082, s_nationkey_prf#4075 AS s_nationkey_prf_1#4083, s_suppkey_prf#4076 AS s_suppkey_prf_1#4084, s_name_prf#4077 AS s_name_prf_1#4085, s_acctbal_prf#4078 AS s_acctbal_prf_1#4086, s_comment_prf#4079 AS s_comment_prf_1#4087]
         :  :     +- Relation[s_phone_prf#4072,rid#4073,s_address_prf#4074,s_nationkey_prf#4075,s_suppkey_prf#4076,s_name_prf#4077,s_acctbal_prf#4078,s_comment_prf#4079] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1509) AS rid_2#4094]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4093]
         :        :  +- Relation[rid#4088,n_regionkey_prf#4089,n_nationkey_prf#4090,n_name_prf#4091,n_comment_prf#4092] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4095 AS c_acctbal_prf_2#4104, rid#4096 AS rid_2#4105, c_name_prf#4097 AS c_name_prf_2#4106, c_nationkey_prf#4098 AS c_nationkey_prf_2#4107, c_custkey_prf#4099 AS c_custkey_prf_2#4108, c_comment_prf#4100 AS c_comment_prf_2#4109, c_address_prf#4101 AS c_address_prf_2#4110, c_mktsegment_prf#4102 AS c_mktsegment_prf_2#4111, c_phone_prf#4103 AS c_phone_prf_2#4112]
            +- Relation[c_acctbal_prf#4095,rid#4096,c_name_prf#4097,c_nationkey_prf#4098,c_custkey_prf#4099,c_comment_prf#4100,c_address_prf#4101,c_mktsegment_prf#4102,c_phone_prf#4103] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 20008ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/15 01:56:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:56:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4159L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 01:56:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4159L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#4181]
         :  :  :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4173: string
         :  :  :     :- Project [p_comment_prf#4161 AS p_comment_prf_0#4171, p_name_prf#4162 AS p_name_prf_0#4172, rid#4163 AS rid_0#4173, p_type_prf#4164 AS p_type_prf_0#4174, p_retailprice_prf#4165 AS p_retailprice_prf_0#4175, p_mfgr_prf#4166 AS p_mfgr_prf_0#4176, p_container_prf#4167 AS p_container_prf_0#4177, p_brand_prf#4168 AS p_brand_prf_0#4178, p_size_prf#4169 AS p_size_prf_0#4179, p_partkey_prf#4170 AS p_partkey_prf_0#4180]
         :  :  :     :  +- Relation[p_comment_prf#4161,p_name_prf#4162,rid#4163,p_type_prf#4164,p_retailprice_prf#4165,p_mfgr_prf#4166,p_container_prf#4167,p_brand_prf#4168,p_size_prf#4169,p_partkey_prf#4170] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#4182 AS ps_partkey_and_ps_suppkey_prf_1#4189, rid#4183 AS rid_1#4190, ps_availqty_prf#4184 AS ps_availqty_prf_1#4191, ps_comment_prf#4185 AS ps_comment_prf_1#4192, ps_partkey_prf#4186 AS ps_partkey_prf_1#4193, ps_supplycost_prf#4187 AS ps_supplycost_prf_1#4194, ps_suppkey_prf#4188 AS ps_suppkey_prf_1#4195]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#4182,rid#4183,ps_availqty_prf#4184,ps_comment_prf#4185,ps_partkey_prf#4186,ps_supplycost_prf#4187,ps_suppkey_prf#4188] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#4204]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4203]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#4196,rid#4197,ps_availqty_prf#4198,ps_comment_prf#4199,ps_partkey_prf#4200,ps_supplycost_prf#4201,ps_suppkey_prf#4202] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4205 AS s_phone_prf_2#4213, rid#4206 AS rid_2#4214, s_address_prf#4207 AS s_address_prf_2#4215, s_nationkey_prf#4208 AS s_nationkey_prf_2#4216, s_suppkey_prf#4209 AS s_suppkey_prf_2#4217, s_name_prf#4210 AS s_name_prf_2#4218, s_acctbal_prf#4211 AS s_acctbal_prf_2#4219, s_comment_prf#4212 AS s_comment_prf_2#4220]
            +- Relation[s_phone_prf#4205,rid#4206,s_address_prf#4207,s_nationkey_prf#4208,s_suppkey_prf#4209,s_name_prf#4210,s_acctbal_prf#4211,s_comment_prf#4212] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 84000ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/15 01:58:11 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:58:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4265L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 01:58:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4265L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#4267 AS l_returnflag_prf_0#4286, l_orderkey_and_l_linenumber_prf#4268 AS l_orderkey_and_l_linenumber_prf_0#4287, l_comment_prf#4269 AS l_comment_prf_0#4288, l_linestatus_prf#4270 AS l_linestatus_prf_0#4289, rid#4271 AS rid_0#4290, l_shipmode_prf#4272 AS l_shipmode_prf_0#4291, l_shipinstruct_prf#4273 AS l_shipinstruct_prf_0#4292, l_quantity_prf#4274 AS l_quantity_prf_0#4293, l_receiptdate_prf#4275 AS l_receiptdate_prf_0#4294, l_linenumber_prf#4276 AS l_linenumber_prf_0#4295, l_tax_prf#4277 AS l_tax_prf_0#4296, l_shipdate_prf#4278 AS l_shipdate_prf_0#4297, l_extendedprice_prf#4279 AS l_extendedprice_prf_0#4298, l_partkey_prf#4280 AS l_partkey_prf_0#4299, l_discount_prf#4281 AS l_discount_prf_0#4300, l_partkey_and_l_suppkey_prf#4282 AS l_partkey_and_l_suppkey_prf_0#4301, l_commitdate_prf#4283 AS l_commitdate_prf_0#4302, l_suppkey_prf#4284 AS l_suppkey_prf_0#4303, l_orderkey_prf#4285 AS l_orderkey_prf_0#4304]
         :  +- Relation[l_returnflag_prf#4267,l_orderkey_and_l_linenumber_prf#4268,l_comment_prf#4269,l_linestatus_prf#4270,rid#4271,l_shipmode_prf#4272,l_shipinstruct_prf#4273,l_quantity_prf#4274,l_receiptdate_prf#4275,l_linenumber_prf#4276,l_tax_prf#4277,l_shipdate_prf#4278,l_extendedprice_prf#4279,l_partkey_prf#4280,l_discount_prf#4281,l_partkey_and_l_suppkey_prf#4282,l_commitdate_prf#4283,l_suppkey_prf#4284,l_orderkey_prf#4285] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4305]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#2218,value#2219] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 23471ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/15 01:58:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:58:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4342L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/15 01:58:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4342L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#4364]
         :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4356: string
         :     :- Project [p_comment_prf#4344 AS p_comment_prf_0#4354, p_name_prf#4345 AS p_name_prf_0#4355, rid#4346 AS rid_0#4356, p_type_prf#4347 AS p_type_prf_0#4357, p_retailprice_prf#4348 AS p_retailprice_prf_0#4358, p_mfgr_prf#4349 AS p_mfgr_prf_0#4359, p_container_prf#4350 AS p_container_prf_0#4360, p_brand_prf#4351 AS p_brand_prf_0#4361, p_size_prf#4352 AS p_size_prf_0#4362, p_partkey_prf#4353 AS p_partkey_prf_0#4363]
         :     :  +- Relation[p_comment_prf#4344,p_name_prf#4345,rid#4346,p_type_prf#4347,p_retailprice_prf#4348,p_mfgr_prf#4349,p_container_prf#4350,p_brand_prf#4351,p_size_prf#4352,p_partkey_prf#4353] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4365 AS ps_partkey_and_ps_suppkey_prf_1#4372, rid#4366 AS rid_1#4373, ps_availqty_prf#4367 AS ps_availqty_prf_1#4374, ps_comment_prf#4368 AS ps_comment_prf_1#4375, ps_partkey_prf#4369 AS ps_partkey_prf_1#4376, ps_supplycost_prf#4370 AS ps_supplycost_prf_1#4377, ps_suppkey_prf#4371 AS ps_suppkey_prf_1#4378]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4365,rid#4366,ps_availqty_prf#4367,ps_comment_prf#4368,ps_partkey_prf#4369,ps_supplycost_prf#4370,ps_suppkey_prf#4371] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 31539ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/15 01:59:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 01:59:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4431L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 01:59:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4431L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#4449]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#4442: string
         :     :- Project [s_phone_prf#4433 AS s_phone_prf_0#4441, rid#4434 AS rid_0#4442, s_address_prf#4435 AS s_address_prf_0#4443, s_nationkey_prf#4436 AS s_nationkey_prf_0#4444, s_suppkey_prf#4437 AS s_suppkey_prf_0#4445, s_name_prf#4438 AS s_name_prf_0#4446, s_acctbal_prf#4439 AS s_acctbal_prf_0#4447, s_comment_prf#4440 AS s_comment_prf_0#4448]
         :     :  +- Relation[s_phone_prf#4433,rid#4434,s_address_prf#4435,s_nationkey_prf#4436,s_suppkey_prf#4437,s_name_prf#4438,s_acctbal_prf#4439,s_comment_prf#4440] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#4488]
            :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_1#4473: string
            :     :- Project [l_returnflag_prf#4450 AS l_returnflag_prf_1#4469, l_orderkey_and_l_linenumber_prf#4451 AS l_orderkey_and_l_linenumber_prf_1#4470, l_comment_prf#4452 AS l_comment_prf_1#4471, l_linestatus_prf#4453 AS l_linestatus_prf_1#4472, rid#4454 AS rid_1#4473, l_shipmode_prf#4455 AS l_shipmode_prf_1#4474, l_shipinstruct_prf#4456 AS l_shipinstruct_prf_1#4475, l_quantity_prf#4457 AS l_quantity_prf_1#4476, l_receiptdate_prf#4458 AS l_receiptdate_prf_1#4477, l_linenumber_prf#4459 AS l_linenumber_prf_1#4478, l_tax_prf#4460 AS l_tax_prf_1#4479, l_shipdate_prf#4461 AS l_shipdate_prf_1#4480, l_extendedprice_prf#4462 AS l_extendedprice_prf_1#4481, l_partkey_prf#4463 AS l_partkey_prf_1#4482, l_discount_prf#4464 AS l_discount_prf_1#4483, l_partkey_and_l_suppkey_prf#4465 AS l_partkey_and_l_suppkey_prf_1#4484, l_commitdate_prf#4466 AS l_commitdate_prf_1#4485, l_suppkey_prf#4467 AS l_suppkey_prf_1#4486, l_orderkey_prf#4468 AS l_orderkey_prf_1#4487]
            :     :  +- Relation[l_returnflag_prf#4450,l_orderkey_and_l_linenumber_prf#4451,l_comment_prf#4452,l_linestatus_prf#4453,rid#4454,l_shipmode_prf#4455,l_shipinstruct_prf#4456,l_quantity_prf#4457,l_receiptdate_prf#4458,l_linenumber_prf#4459,l_tax_prf#4460,l_shipdate_prf#4461,l_extendedprice_prf#4462,l_partkey_prf#4463,l_discount_prf#4464,l_partkey_and_l_suppkey_prf#4465,l_commitdate_prf#4466,l_suppkey_prf#4467,l_orderkey_prf#4468] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#4489 AS p_comment_prf_2#4499, p_name_prf#4490 AS p_name_prf_2#4500, rid#4491 AS rid_2#4501, p_type_prf#4492 AS p_type_prf_2#4502, p_retailprice_prf#4493 AS p_retailprice_prf_2#4503, p_mfgr_prf#4494 AS p_mfgr_prf_2#4504, p_container_prf#4495 AS p_container_prf_2#4505, p_brand_prf#4496 AS p_brand_prf_2#4506, p_size_prf#4497 AS p_size_prf_2#4507, p_partkey_prf#4498 AS p_partkey_prf_2#4508]
               +- Relation[p_comment_prf#4489,p_name_prf#4490,rid#4491,p_type_prf#4492,p_retailprice_prf#4493,p_mfgr_prf#4494,p_container_prf#4495,p_brand_prf#4496,p_size_prf#4497,p_partkey_prf#4498] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 186929ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/15 02:02:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:02:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4558L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 02:02:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4558L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#4560 AS p_comment_prf_0#4570, p_name_prf#4561 AS p_name_prf_0#4571, rid#4562 AS rid_0#4572, p_type_prf#4563 AS p_type_prf_0#4573, p_retailprice_prf#4564 AS p_retailprice_prf_0#4574, p_mfgr_prf#4565 AS p_mfgr_prf_0#4575, p_container_prf#4566 AS p_container_prf_0#4576, p_brand_prf#4567 AS p_brand_prf_0#4577, p_size_prf#4568 AS p_size_prf_0#4578, p_partkey_prf#4569 AS p_partkey_prf_0#4579]
         :  +- Relation[p_comment_prf#4560,p_name_prf#4561,rid#4562,p_type_prf#4563,p_retailprice_prf#4564,p_mfgr_prf#4565,p_container_prf#4566,p_brand_prf#4567,p_size_prf#4568,p_partkey_prf#4569] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4580]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#2218,value#2219] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1451
Elapsed time: 83ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/15 02:02:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:02:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4627L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 02:02:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4627L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_2#4667]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4652: string
         :     :- Project [l_returnflag_prf#4629 AS l_returnflag_prf_0#4648, l_orderkey_and_l_linenumber_prf#4630 AS l_orderkey_and_l_linenumber_prf_0#4649, l_comment_prf#4631 AS l_comment_prf_0#4650, l_linestatus_prf#4632 AS l_linestatus_prf_0#4651, rid#4633 AS rid_0#4652, l_shipmode_prf#4634 AS l_shipmode_prf_0#4653, l_shipinstruct_prf#4635 AS l_shipinstruct_prf_0#4654, l_quantity_prf#4636 AS l_quantity_prf_0#4655, l_receiptdate_prf#4637 AS l_receiptdate_prf_0#4656, l_linenumber_prf#4638 AS l_linenumber_prf_0#4657, l_tax_prf#4639 AS l_tax_prf_0#4658, l_shipdate_prf#4640 AS l_shipdate_prf_0#4659, l_extendedprice_prf#4641 AS l_extendedprice_prf_0#4660, l_partkey_prf#4642 AS l_partkey_prf_0#4661, l_discount_prf#4643 AS l_discount_prf_0#4662, l_partkey_and_l_suppkey_prf#4644 AS l_partkey_and_l_suppkey_prf_0#4663, l_commitdate_prf#4645 AS l_commitdate_prf_0#4664, l_suppkey_prf#4646 AS l_suppkey_prf_0#4665, l_orderkey_prf#4647 AS l_orderkey_prf_0#4666]
         :     :  +- Relation[l_returnflag_prf#4629,l_orderkey_and_l_linenumber_prf#4630,l_comment_prf#4631,l_linestatus_prf#4632,rid#4633,l_shipmode_prf#4634,l_shipinstruct_prf#4635,l_quantity_prf#4636,l_receiptdate_prf#4637,l_linenumber_prf#4638,l_tax_prf#4639,l_shipdate_prf#4640,l_extendedprice_prf#4641,l_partkey_prf#4642,l_discount_prf#4643,l_partkey_and_l_suppkey_prf#4644,l_commitdate_prf#4645,l_suppkey_prf#4646,l_orderkey_prf#4647] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#4686]
            :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#4678: string
            :     :- Project [c_acctbal_prf#4668 AS c_acctbal_prf_1#4677, rid#4669 AS rid_1#4678, c_name_prf#4670 AS c_name_prf_1#4679, c_nationkey_prf#4671 AS c_nationkey_prf_1#4680, c_custkey_prf#4672 AS c_custkey_prf_1#4681, c_comment_prf#4673 AS c_comment_prf_1#4682, c_address_prf#4674 AS c_address_prf_1#4683, c_mktsegment_prf#4675 AS c_mktsegment_prf_1#4684, c_phone_prf#4676 AS c_phone_prf_1#4685]
            :     :  +- Relation[c_acctbal_prf#4668,rid#4669,c_name_prf#4670,c_nationkey_prf#4671,c_custkey_prf#4672,c_comment_prf#4673,c_address_prf#4674,c_mktsegment_prf#4675,c_phone_prf#4676] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4687 AS o_shippriority_prf_2#4697, rid#4688 AS rid_2#4698, o_orderdate_prf#4689 AS o_orderdate_prf_2#4699, o_custkey_prf#4690 AS o_custkey_prf_2#4700, o_orderpriority_prf#4691 AS o_orderpriority_prf_2#4701, o_clerk_prf#4692 AS o_clerk_prf_2#4702, o_orderstatus_prf#4693 AS o_orderstatus_prf_2#4703, o_totalprice_prf#4694 AS o_totalprice_prf_2#4704, o_orderkey_prf#4695 AS o_orderkey_prf_2#4705, o_comment_prf#4696 AS o_comment_prf_2#4706]
               +- Relation[o_shippriority_prf#4687,rid#4688,o_orderdate_prf#4689,o_custkey_prf#4690,o_orderpriority_prf#4691,o_clerk_prf#4692,o_orderstatus_prf#4693,o_totalprice_prf#4694,o_orderkey_prf#4695,o_comment_prf#4696] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 157931ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/15 02:04:51 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:04:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4780L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 02:04:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4780L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#4802]
         :  :  :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#4794: string
         :  :  :     :- Project [p_comment_prf#4782 AS p_comment_prf_0#4792, p_name_prf#4783 AS p_name_prf_0#4793, rid#4784 AS rid_0#4794, p_type_prf#4785 AS p_type_prf_0#4795, p_retailprice_prf#4786 AS p_retailprice_prf_0#4796, p_mfgr_prf#4787 AS p_mfgr_prf_0#4797, p_container_prf#4788 AS p_container_prf_0#4798, p_brand_prf#4789 AS p_brand_prf_0#4799, p_size_prf#4790 AS p_size_prf_0#4800, p_partkey_prf#4791 AS p_partkey_prf_0#4801]
         :  :  :     :  +- Relation[p_comment_prf#4782,p_name_prf#4783,rid#4784,p_type_prf#4785,p_retailprice_prf#4786,p_mfgr_prf#4787,p_container_prf#4788,p_brand_prf#4789,p_size_prf#4790,p_partkey_prf#4791] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#4803 AS l_returnflag_prf_1#4822, l_orderkey_and_l_linenumber_prf#4804 AS l_orderkey_and_l_linenumber_prf_1#4823, l_comment_prf#4805 AS l_comment_prf_1#4824, l_linestatus_prf#4806 AS l_linestatus_prf_1#4825, rid#4807 AS rid_1#4826, l_shipmode_prf#4808 AS l_shipmode_prf_1#4827, l_shipinstruct_prf#4809 AS l_shipinstruct_prf_1#4828, l_quantity_prf#4810 AS l_quantity_prf_1#4829, l_receiptdate_prf#4811 AS l_receiptdate_prf_1#4830, l_linenumber_prf#4812 AS l_linenumber_prf_1#4831, l_tax_prf#4813 AS l_tax_prf_1#4832, l_shipdate_prf#4814 AS l_shipdate_prf_1#4833, l_extendedprice_prf#4815 AS l_extendedprice_prf_1#4834, l_partkey_prf#4816 AS l_partkey_prf_1#4835, l_discount_prf#4817 AS l_discount_prf_1#4836, l_partkey_and_l_suppkey_prf#4818 AS l_partkey_and_l_suppkey_prf_1#4837, l_commitdate_prf#4819 AS l_commitdate_prf_1#4838, l_suppkey_prf#4820 AS l_suppkey_prf_1#4839, l_orderkey_prf#4821 AS l_orderkey_prf_1#4840]
         :  :     +- Relation[l_returnflag_prf#4803,l_orderkey_and_l_linenumber_prf#4804,l_comment_prf#4805,l_linestatus_prf#4806,rid#4807,l_shipmode_prf#4808,l_shipinstruct_prf#4809,l_quantity_prf#4810,l_receiptdate_prf#4811,l_linenumber_prf#4812,l_tax_prf#4813,l_shipdate_prf#4814,l_extendedprice_prf#4815,l_partkey_prf#4816,l_discount_prf#4817,l_partkey_and_l_suppkey_prf#4818,l_commitdate_prf#4819,l_suppkey_prf#4820,l_orderkey_prf#4821] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#4861]
         :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4860]
         :        :  +- Relation[l_returnflag_prf#4841,l_orderkey_and_l_linenumber_prf#4842,l_comment_prf#4843,l_linestatus_prf#4844,rid#4845,l_shipmode_prf#4846,l_shipinstruct_prf#4847,l_quantity_prf#4848,l_receiptdate_prf#4849,l_linenumber_prf#4850,l_tax_prf#4851,l_shipdate_prf#4852,l_extendedprice_prf#4853,l_partkey_prf#4854,l_discount_prf#4855,l_partkey_and_l_suppkey_prf#4856,l_commitdate_prf#4857,l_suppkey_prf#4858,l_orderkey_prf#4859] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4862 AS s_phone_prf_2#4870, rid#4863 AS rid_2#4871, s_address_prf#4864 AS s_address_prf_2#4872, s_nationkey_prf#4865 AS s_nationkey_prf_2#4873, s_suppkey_prf#4866 AS s_suppkey_prf_2#4874, s_name_prf#4867 AS s_name_prf_2#4875, s_acctbal_prf#4868 AS s_acctbal_prf_2#4876, s_comment_prf#4869 AS s_comment_prf_2#4877]
            +- Relation[s_phone_prf#4862,rid#4863,s_address_prf#4864,s_nationkey_prf#4865,s_suppkey_prf#4866,s_name_prf#4867,s_acctbal_prf#4868,s_comment_prf#4869] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 196415ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/15 02:08:07 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:08:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4951L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 02:08:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4951L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#4971]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4963: string
         :     :- Project [c_acctbal_prf#4953 AS c_acctbal_prf_0#4962, rid#4954 AS rid_0#4963, c_name_prf#4955 AS c_name_prf_0#4964, c_nationkey_prf#4956 AS c_nationkey_prf_0#4965, c_custkey_prf#4957 AS c_custkey_prf_0#4966, c_comment_prf#4958 AS c_comment_prf_0#4967, c_address_prf#4959 AS c_address_prf_0#4968, c_mktsegment_prf#4960 AS c_mktsegment_prf_0#4969, c_phone_prf#4961 AS c_phone_prf_0#4970]
         :     :  +- Relation[c_acctbal_prf#4953,rid#4954,c_name_prf#4955,c_nationkey_prf#4956,c_custkey_prf#4957,c_comment_prf#4958,c_address_prf#4959,c_mktsegment_prf#4960,c_phone_prf#4961] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1509) AS rid_2#4992]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#4983: string
            :     :- Project [o_shippriority_prf#4972 AS o_shippriority_prf_1#4982, rid#4973 AS rid_1#4983, o_orderdate_prf#4974 AS o_orderdate_prf_1#4984, o_custkey_prf#4975 AS o_custkey_prf_1#4985, o_orderpriority_prf#4976 AS o_orderpriority_prf_1#4986, o_clerk_prf#4977 AS o_clerk_prf_1#4987, o_orderstatus_prf#4978 AS o_orderstatus_prf_1#4988, o_totalprice_prf#4979 AS o_totalprice_prf_1#4989, o_orderkey_prf#4980 AS o_orderkey_prf_1#4990, o_comment_prf#4981 AS o_comment_prf_1#4991]
            :     :  +- Relation[o_shippriority_prf#4972,rid#4973,o_orderdate_prf#4974,o_custkey_prf#4975,o_orderpriority_prf#4976,o_clerk_prf#4977,o_orderstatus_prf#4978,o_totalprice_prf#4979,o_orderkey_prf#4980,o_comment_prf#4981] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4993 AS l_returnflag_prf_2#5012, l_orderkey_and_l_linenumber_prf#4994 AS l_orderkey_and_l_linenumber_prf_2#5013, l_comment_prf#4995 AS l_comment_prf_2#5014, l_linestatus_prf#4996 AS l_linestatus_prf_2#5015, rid#4997 AS rid_2#5016, l_shipmode_prf#4998 AS l_shipmode_prf_2#5017, l_shipinstruct_prf#4999 AS l_shipinstruct_prf_2#5018, l_quantity_prf#5000 AS l_quantity_prf_2#5019, l_receiptdate_prf#5001 AS l_receiptdate_prf_2#5020, l_linenumber_prf#5002 AS l_linenumber_prf_2#5021, l_tax_prf#5003 AS l_tax_prf_2#5022, l_shipdate_prf#5004 AS l_shipdate_prf_2#5023, l_extendedprice_prf#5005 AS l_extendedprice_prf_2#5024, l_partkey_prf#5006 AS l_partkey_prf_2#5025, l_discount_prf#5007 AS l_discount_prf_2#5026, l_partkey_and_l_suppkey_prf#5008 AS l_partkey_and_l_suppkey_prf_2#5027, l_commitdate_prf#5009 AS l_commitdate_prf_2#5028, l_suppkey_prf#5010 AS l_suppkey_prf_2#5029, l_orderkey_prf#5011 AS l_orderkey_prf_2#5030]
               +- Relation[l_returnflag_prf#4993,l_orderkey_and_l_linenumber_prf#4994,l_comment_prf#4995,l_linestatus_prf#4996,rid#4997,l_shipmode_prf#4998,l_shipinstruct_prf#4999,l_quantity_prf#5000,l_receiptdate_prf#5001,l_linenumber_prf#5002,l_tax_prf#5003,l_shipdate_prf#5004,l_extendedprice_prf#5005,l_partkey_prf#5006,l_discount_prf#5007,l_partkey_and_l_suppkey_prf#5008,l_commitdate_prf#5009,l_suppkey_prf#5010,l_orderkey_prf#5011] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 235125ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/15 02:12:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:12:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5097L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 02:12:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5097L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#5137]
         :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#5122: string
         :     :- Project [l_returnflag_prf#5099 AS l_returnflag_prf_0#5118, l_orderkey_and_l_linenumber_prf#5100 AS l_orderkey_and_l_linenumber_prf_0#5119, l_comment_prf#5101 AS l_comment_prf_0#5120, l_linestatus_prf#5102 AS l_linestatus_prf_0#5121, rid#5103 AS rid_0#5122, l_shipmode_prf#5104 AS l_shipmode_prf_0#5123, l_shipinstruct_prf#5105 AS l_shipinstruct_prf_0#5124, l_quantity_prf#5106 AS l_quantity_prf_0#5125, l_receiptdate_prf#5107 AS l_receiptdate_prf_0#5126, l_linenumber_prf#5108 AS l_linenumber_prf_0#5127, l_tax_prf#5109 AS l_tax_prf_0#5128, l_shipdate_prf#5110 AS l_shipdate_prf_0#5129, l_extendedprice_prf#5111 AS l_extendedprice_prf_0#5130, l_partkey_prf#5112 AS l_partkey_prf_0#5131, l_discount_prf#5113 AS l_discount_prf_0#5132, l_partkey_and_l_suppkey_prf#5114 AS l_partkey_and_l_suppkey_prf_0#5133, l_commitdate_prf#5115 AS l_commitdate_prf_0#5134, l_suppkey_prf#5116 AS l_suppkey_prf_0#5135, l_orderkey_prf#5117 AS l_orderkey_prf_0#5136]
         :     :  +- Relation[l_returnflag_prf#5099,l_orderkey_and_l_linenumber_prf#5100,l_comment_prf#5101,l_linestatus_prf#5102,rid#5103,l_shipmode_prf#5104,l_shipinstruct_prf#5105,l_quantity_prf#5106,l_receiptdate_prf#5107,l_linenumber_prf#5108,l_tax_prf#5109,l_shipdate_prf#5110,l_extendedprice_prf#5111,l_partkey_prf#5112,l_discount_prf#5113,l_partkey_and_l_suppkey_prf#5114,l_commitdate_prf#5115,l_suppkey_prf#5116,l_orderkey_prf#5117] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#5138 AS p_comment_prf_1#5148, p_name_prf#5139 AS p_name_prf_1#5149, rid#5140 AS rid_1#5150, p_type_prf#5141 AS p_type_prf_1#5151, p_retailprice_prf#5142 AS p_retailprice_prf_1#5152, p_mfgr_prf#5143 AS p_mfgr_prf_1#5153, p_container_prf#5144 AS p_container_prf_1#5154, p_brand_prf#5145 AS p_brand_prf_1#5155, p_size_prf#5146 AS p_size_prf_1#5156, p_partkey_prf#5147 AS p_partkey_prf_1#5157]
            +- Relation[p_comment_prf#5138,p_name_prf#5139,rid#5140,p_type_prf#5141,p_retailprice_prf#5142,p_mfgr_prf#5143,p_container_prf#5144,p_brand_prf#5145,p_size_prf#5146,p_partkey_prf#5147] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 117406ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/15 02:14:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:14:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5206L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 02:14:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5206L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#5208 AS l_returnflag_prf_0#5227, l_orderkey_and_l_linenumber_prf#5209 AS l_orderkey_and_l_linenumber_prf_0#5228, l_comment_prf#5210 AS l_comment_prf_0#5229, l_linestatus_prf#5211 AS l_linestatus_prf_0#5230, rid#5212 AS rid_0#5231, l_shipmode_prf#5213 AS l_shipmode_prf_0#5232, l_shipinstruct_prf#5214 AS l_shipinstruct_prf_0#5233, l_quantity_prf#5215 AS l_quantity_prf_0#5234, l_receiptdate_prf#5216 AS l_receiptdate_prf_0#5235, l_linenumber_prf#5217 AS l_linenumber_prf_0#5236, l_tax_prf#5218 AS l_tax_prf_0#5237, l_shipdate_prf#5219 AS l_shipdate_prf_0#5238, l_extendedprice_prf#5220 AS l_extendedprice_prf_0#5239, l_partkey_prf#5221 AS l_partkey_prf_0#5240, l_discount_prf#5222 AS l_discount_prf_0#5241, l_partkey_and_l_suppkey_prf#5223 AS l_partkey_and_l_suppkey_prf_0#5242, l_commitdate_prf#5224 AS l_commitdate_prf_0#5243, l_suppkey_prf#5225 AS l_suppkey_prf_0#5244, l_orderkey_prf#5226 AS l_orderkey_prf_0#5245]
         :  +- Relation[l_returnflag_prf#5208,l_orderkey_and_l_linenumber_prf#5209,l_comment_prf#5210,l_linestatus_prf#5211,rid#5212,l_shipmode_prf#5213,l_shipinstruct_prf#5214,l_quantity_prf#5215,l_receiptdate_prf#5216,l_linenumber_prf#5217,l_tax_prf#5218,l_shipdate_prf#5219,l_extendedprice_prf#5220,l_partkey_prf#5221,l_discount_prf#5222,l_partkey_and_l_suppkey_prf#5223,l_commitdate_prf#5224,l_suppkey_prf#5225,l_orderkey_prf#5226] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5246]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#2218,value#2219] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 13782ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/15 02:14:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:14:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5281L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/15 02:14:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5281L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#5299]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#5292: string
         :     :- Project [s_phone_prf#5283 AS s_phone_prf_0#5291, rid#5284 AS rid_0#5292, s_address_prf#5285 AS s_address_prf_0#5293, s_nationkey_prf#5286 AS s_nationkey_prf_0#5294, s_suppkey_prf#5287 AS s_suppkey_prf_0#5295, s_name_prf#5288 AS s_name_prf_0#5296, s_acctbal_prf#5289 AS s_acctbal_prf_0#5297, s_comment_prf#5290 AS s_comment_prf_0#5298]
         :     :  +- Relation[s_phone_prf#5283,rid#5284,s_address_prf#5285,s_nationkey_prf#5286,s_suppkey_prf#5287,s_name_prf#5288,s_acctbal_prf#5289,s_comment_prf#5290] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#5300 AS ps_partkey_and_ps_suppkey_prf_1#5307, rid#5301 AS rid_1#5308, ps_availqty_prf#5302 AS ps_availqty_prf_1#5309, ps_comment_prf#5303 AS ps_comment_prf_1#5310, ps_partkey_prf#5304 AS ps_partkey_prf_1#5311, ps_supplycost_prf#5305 AS ps_supplycost_prf_1#5312, ps_suppkey_prf#5306 AS ps_suppkey_prf_1#5313]
            +- Relation[ps_partkey_and_ps_suppkey_prf#5300,rid#5301,ps_availqty_prf#5302,ps_comment_prf#5303,ps_partkey_prf#5304,ps_supplycost_prf#5305,ps_suppkey_prf#5306] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 10946ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/15 02:14:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:14:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5357L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 02:14:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5357L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#5379]
         :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#5371: string
         :     :- Project [p_comment_prf#5359 AS p_comment_prf_0#5369, p_name_prf#5360 AS p_name_prf_0#5370, rid#5361 AS rid_0#5371, p_type_prf#5362 AS p_type_prf_0#5372, p_retailprice_prf#5363 AS p_retailprice_prf_0#5373, p_mfgr_prf#5364 AS p_mfgr_prf_0#5374, p_container_prf#5365 AS p_container_prf_0#5375, p_brand_prf#5366 AS p_brand_prf_0#5376, p_size_prf#5367 AS p_size_prf_0#5377, p_partkey_prf#5368 AS p_partkey_prf_0#5378]
         :     :  +- Relation[p_comment_prf#5359,p_name_prf#5360,rid#5361,p_type_prf#5362,p_retailprice_prf#5363,p_mfgr_prf#5364,p_container_prf#5365,p_brand_prf#5366,p_size_prf#5367,p_partkey_prf#5368] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5380 AS l_returnflag_prf_1#5399, l_orderkey_and_l_linenumber_prf#5381 AS l_orderkey_and_l_linenumber_prf_1#5400, l_comment_prf#5382 AS l_comment_prf_1#5401, l_linestatus_prf#5383 AS l_linestatus_prf_1#5402, rid#5384 AS rid_1#5403, l_shipmode_prf#5385 AS l_shipmode_prf_1#5404, l_shipinstruct_prf#5386 AS l_shipinstruct_prf_1#5405, l_quantity_prf#5387 AS l_quantity_prf_1#5406, l_receiptdate_prf#5388 AS l_receiptdate_prf_1#5407, l_linenumber_prf#5389 AS l_linenumber_prf_1#5408, l_tax_prf#5390 AS l_tax_prf_1#5409, l_shipdate_prf#5391 AS l_shipdate_prf_1#5410, l_extendedprice_prf#5392 AS l_extendedprice_prf_1#5411, l_partkey_prf#5393 AS l_partkey_prf_1#5412, l_discount_prf#5394 AS l_discount_prf_1#5413, l_partkey_and_l_suppkey_prf#5395 AS l_partkey_and_l_suppkey_prf_1#5414, l_commitdate_prf#5396 AS l_commitdate_prf_1#5415, l_suppkey_prf#5397 AS l_suppkey_prf_1#5416, l_orderkey_prf#5398 AS l_orderkey_prf_1#5417]
            +- Relation[l_returnflag_prf#5380,l_orderkey_and_l_linenumber_prf#5381,l_comment_prf#5382,l_linestatus_prf#5383,rid#5384,l_shipmode_prf#5385,l_shipinstruct_prf#5386,l_quantity_prf#5387,l_receiptdate_prf#5388,l_linenumber_prf#5389,l_tax_prf#5390,l_shipdate_prf#5391,l_extendedprice_prf#5392,l_partkey_prf#5393,l_discount_prf#5394,l_partkey_and_l_suppkey_prf#5395,l_commitdate_prf#5396,l_suppkey_prf#5397,l_orderkey_prf#5398] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 94030ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/15 02:15:58 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:15:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5462L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/15 02:15:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5462L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1509) AS rid_1#5474]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#5469: string
         :     :- Project [rid#5464 AS rid_0#5469, n_regionkey_prf#5465 AS n_regionkey_prf_0#5470, n_nationkey_prf#5466 AS n_nationkey_prf_0#5471, n_name_prf#5467 AS n_name_prf_0#5472, n_comment_prf#5468 AS n_comment_prf_0#5473]
         :     :  +- Relation[rid#5464,n_regionkey_prf#5465,n_nationkey_prf#5466,n_name_prf#5467,n_comment_prf#5468] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1508,value#1509] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#5475 AS c_acctbal_prf_1#5484, rid#5476 AS rid_1#5485, c_name_prf#5477 AS c_name_prf_1#5486, c_nationkey_prf#5478 AS c_nationkey_prf_1#5487, c_custkey_prf#5479 AS c_custkey_prf_1#5488, c_comment_prf#5480 AS c_comment_prf_1#5489, c_address_prf#5481 AS c_address_prf_1#5490, c_mktsegment_prf#5482 AS c_mktsegment_prf_1#5491, c_phone_prf#5483 AS c_phone_prf_1#5492]
            +- Relation[c_acctbal_prf#5475,rid#5476,c_name_prf#5477,c_nationkey_prf#5478,c_custkey_prf#5479,c_comment_prf#5480,c_address_prf#5481,c_mktsegment_prf#5482,c_phone_prf#5483] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=150000
Elapsed time: 1955ms
query=b1a, count=15628, duration=411
query=b1b, count=15628, duration=49346
query=b2a, count=1478870, duration=197183
query=b2b, count=1478870, duration=54547
query=f1, count=1, duration=66
query=f2, count=3907, duration=126
query=f3, count=1451, duration=83
query=f4, count=1, duration=53
query=f5, count=1478870, duration=23471
query=f6, count=857401, duration=13782
query=j1, count=800000, duration=31539
query=j10, count=6001215, duration=86575
query=j2, count=800000, duration=10946
query=j3, count=25, duration=70
query=j4, count=150000, duration=1955
query=j5, count=10000, duration=188
query=j6, count=6001215, duration=116747
query=j7, count=1500000, duration=39979
query=j8, count=6001215, duration=196219
query=j8b, count=6001215, duration=114141
query=j9, count=6001215, duration=94030
query=j9b, count=6001215, duration=117406
query=r1a, count=6001215, duration=169951
query=r1b, count=6001215, duration=151632
query=r1c, count=6001215, duration=157931
query=r1d, count=6001215, duration=232129
query=r1e, count=6001215, duration=235125
query=r1f, count=6001215, duration=157491
query=t1a, count=60000414, duration=38296
query=t1b, count=60000414, duration=20008
query=t1c, count=60000414, duration=65101
query=t2a, count=800000, duration=105479
query=t2b, count=800000, duration=84000
query=t2c, count=800000, duration=42892
query=t2d, count=800000, duration=61963
query=t3a, count=6001215, duration=222925
query=t3b, count=6001215, duration=196415
query=t3c, count=6001215, duration=187873
query=t3d, count=6001215, duration=186929
