19/10/15 02:16:01 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7189ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Tue Oct 15 02:16:04 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Tue Oct 15 02:16:05 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Tue Oct 15 02:16:05 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Tue Oct 15 02:16:05 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Tue Oct 15 02:16:05 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Tue Oct 15 02:16:08 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Tue Oct 15 02:16:10 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Tue Oct 15 02:16:10 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/15 02:16:11 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:16:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1485L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/15 02:16:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1485L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#1512]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#1499: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#1487 AS p_comment_prf_0#1497, p_name_prf#1488 AS p_name_prf_0#1498, rid#1489 AS rid_0#1499, p_type_prf#1490 AS p_type_prf_0#1500, p_retailprice_prf#1491 AS p_retailprice_prf_0#1501, p_mfgr_prf#1492 AS p_mfgr_prf_0#1502, p_container_prf#1493 AS p_container_prf_0#1503, p_brand_prf#1494 AS p_brand_prf_0#1504, p_size_prf#1495 AS p_size_prf_0#1505, p_partkey_prf#1496 AS p_partkey_prf_0#1506]
         :     :  :  +- Relation[p_comment_prf#1487,p_name_prf#1488,rid#1489,p_type_prf#1490,p_retailprice_prf#1491,p_mfgr_prf#1492,p_container_prf#1493,p_brand_prf#1494,p_size_prf#1495,p_partkey_prf#1496] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1509]
         :     :     +- DexRidFilter part~p_size~15
         :     :        +- Relation[label#1507,value#1508] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#1513 AS ps_partkey_and_ps_suppkey_prf_1#1520, rid#1514 AS rid_1#1521, ps_availqty_prf#1515 AS ps_availqty_prf_1#1522, ps_comment_prf#1516 AS ps_comment_prf_1#1523, ps_partkey_prf#1517 AS ps_partkey_prf_1#1524, ps_supplycost_prf#1518 AS ps_supplycost_prf_1#1525, ps_suppkey_prf#1519 AS ps_suppkey_prf_1#1526]
            +- Relation[ps_partkey_and_ps_suppkey_prf#1513,rid#1514,ps_availqty_prf#1515,ps_comment_prf#1516,ps_partkey_prf#1517,ps_supplycost_prf#1518,ps_suppkey_prf#1519] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 635ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/15 02:16:12 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:16:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1568L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 02:16:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1568L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#1586]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#1579: string
         :     :- Project [s_phone_prf#1570 AS s_phone_prf_0#1578, rid#1571 AS rid_0#1579, s_address_prf#1572 AS s_address_prf_0#1580, s_nationkey_prf#1573 AS s_nationkey_prf_0#1581, s_suppkey_prf#1574 AS s_suppkey_prf_0#1582, s_name_prf#1575 AS s_name_prf_0#1583, s_acctbal_prf#1576 AS s_acctbal_prf_0#1584, s_comment_prf#1577 AS s_comment_prf_0#1585]
         :     :  +- Relation[s_phone_prf#1570,rid#1571,s_address_prf#1572,s_nationkey_prf#1573,s_suppkey_prf#1574,s_name_prf#1575,s_acctbal_prf#1576,s_comment_prf#1577] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#1601]
            :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_1#1595: string
            :     :- Project [ps_partkey_and_ps_suppkey_prf#1587 AS ps_partkey_and_ps_suppkey_prf_1#1594, rid#1588 AS rid_1#1595, ps_availqty_prf#1589 AS ps_availqty_prf_1#1596, ps_comment_prf#1590 AS ps_comment_prf_1#1597, ps_partkey_prf#1591 AS ps_partkey_prf_1#1598, ps_supplycost_prf#1592 AS ps_supplycost_prf_1#1599, ps_suppkey_prf#1593 AS ps_suppkey_prf_1#1600]
            :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#1587,rid#1588,ps_availqty_prf#1589,ps_comment_prf#1590,ps_partkey_prf#1591,ps_supplycost_prf#1592,ps_suppkey_prf#1593] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#1602 AS p_comment_prf_2#1612, p_name_prf#1603 AS p_name_prf_2#1613, rid#1604 AS rid_2#1614, p_type_prf#1605 AS p_type_prf_2#1615, p_retailprice_prf#1606 AS p_retailprice_prf_2#1616, p_mfgr_prf#1607 AS p_mfgr_prf_2#1617, p_container_prf#1608 AS p_container_prf_2#1618, p_brand_prf#1609 AS p_brand_prf_2#1619, p_size_prf#1610 AS p_size_prf_2#1620, p_partkey_prf#1611 AS p_partkey_prf_2#1621]
               +- Relation[p_comment_prf#1602,p_name_prf#1603,rid#1604,p_type_prf#1605,p_retailprice_prf#1606,p_mfgr_prf#1607,p_container_prf#1608,p_brand_prf#1609,p_size_prf#1610,p_partkey_prf#1611] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 61404ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/15 02:17:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:17:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1671L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 02:17:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1671L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#1687]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, rid_0#1681: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#1673 AS ps_partkey_and_ps_suppkey_prf_0#1680, rid#1674 AS rid_0#1681, ps_availqty_prf#1675 AS ps_availqty_prf_0#1682, ps_comment_prf#1676 AS ps_comment_prf_0#1683, ps_partkey_prf#1677 AS ps_partkey_prf_0#1684, ps_supplycost_prf#1678 AS ps_supplycost_prf_0#1685, ps_suppkey_prf#1679 AS ps_suppkey_prf_0#1686]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#1673,rid#1674,ps_availqty_prf#1675,ps_comment_prf#1676,ps_partkey_prf#1677,ps_supplycost_prf#1678,ps_suppkey_prf#1679] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1688 AS l_returnflag_prf_1#1707, l_orderkey_and_l_linenumber_prf#1689 AS l_orderkey_and_l_linenumber_prf_1#1708, l_comment_prf#1690 AS l_comment_prf_1#1709, l_linestatus_prf#1691 AS l_linestatus_prf_1#1710, rid#1692 AS rid_1#1711, l_shipmode_prf#1693 AS l_shipmode_prf_1#1712, l_shipinstruct_prf#1694 AS l_shipinstruct_prf_1#1713, l_quantity_prf#1695 AS l_quantity_prf_1#1714, l_receiptdate_prf#1696 AS l_receiptdate_prf_1#1715, l_linenumber_prf#1697 AS l_linenumber_prf_1#1716, l_tax_prf#1698 AS l_tax_prf_1#1717, l_shipdate_prf#1699 AS l_shipdate_prf_1#1718, l_extendedprice_prf#1700 AS l_extendedprice_prf_1#1719, l_partkey_prf#1701 AS l_partkey_prf_1#1720, l_discount_prf#1702 AS l_discount_prf_1#1721, l_partkey_and_l_suppkey_prf#1703 AS l_partkey_and_l_suppkey_prf_1#1722, l_commitdate_prf#1704 AS l_commitdate_prf_1#1723, l_suppkey_prf#1705 AS l_suppkey_prf_1#1724, l_orderkey_prf#1706 AS l_orderkey_prf_1#1725]
            +- Relation[l_returnflag_prf#1688,l_orderkey_and_l_linenumber_prf#1689,l_comment_prf#1690,l_linestatus_prf#1691,rid#1692,l_shipmode_prf#1693,l_shipinstruct_prf#1694,l_quantity_prf#1695,l_receiptdate_prf#1696,l_linenumber_prf#1697,l_tax_prf#1698,l_shipdate_prf#1699,l_extendedprice_prf#1700,l_partkey_prf#1701,l_discount_prf#1702,l_partkey_and_l_suppkey_prf#1703,l_commitdate_prf#1704,l_suppkey_prf#1705,l_orderkey_prf#1706] JDBCRelation(lineitem_prf) [numPartitions=1]

19/10/15 02:17:13 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=6001215
Elapsed time: 116563ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/15 02:19:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:19:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1767L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/15 02:19:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1767L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#1779]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#1774: string
         :     :- Project [rid#1769 AS rid_0#1774, n_regionkey_prf#1770 AS n_regionkey_prf_0#1775, n_nationkey_prf#1771 AS n_nationkey_prf_0#1776, n_name_prf#1772 AS n_name_prf_0#1777, n_comment_prf#1773 AS n_comment_prf_0#1778]
         :     :  +- Relation[rid#1769,n_regionkey_prf#1770,n_nationkey_prf#1771,n_name_prf#1772,n_comment_prf#1773] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#1780 AS c_acctbal_prf_1#1789, rid#1781 AS rid_1#1790, c_name_prf#1782 AS c_name_prf_1#1791, c_nationkey_prf#1783 AS c_nationkey_prf_1#1792, c_custkey_prf#1784 AS c_custkey_prf_1#1793, c_comment_prf#1785 AS c_comment_prf_1#1794, c_address_prf#1786 AS c_address_prf_1#1795, c_mktsegment_prf#1787 AS c_mktsegment_prf_1#1796, c_phone_prf#1788 AS c_phone_prf_1#1797]
            +- Relation[c_acctbal_prf#1780,rid#1781,c_name_prf#1782,c_nationkey_prf#1783,c_custkey_prf#1784,c_comment_prf#1785,c_address_prf#1786,c_mktsegment_prf#1787,c_phone_prf#1788] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=150000
Elapsed time: 1939ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/15 02:19:12 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:19:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1819L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/15 02:19:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1819L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#1821 AS rid_0#1826, n_regionkey_prf#1822 AS n_regionkey_prf_0#1827, n_nationkey_prf#1823 AS n_nationkey_prf_0#1828, n_name_prf#1824 AS n_name_prf_0#1829, n_comment_prf#1825 AS n_comment_prf_0#1830]
         :  +- Relation[rid#1821,n_regionkey_prf#1822,n_nationkey_prf#1823,n_name_prf#1824,n_comment_prf#1825] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1831]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1507,value#1508] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 55ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/15 02:19:12 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:19:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1865L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 02:19:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1865L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#1887]
         :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#1879: string
         :     :- Project [p_comment_prf#1867 AS p_comment_prf_0#1877, p_name_prf#1868 AS p_name_prf_0#1878, rid#1869 AS rid_0#1879, p_type_prf#1870 AS p_type_prf_0#1880, p_retailprice_prf#1871 AS p_retailprice_prf_0#1881, p_mfgr_prf#1872 AS p_mfgr_prf_0#1882, p_container_prf#1873 AS p_container_prf_0#1883, p_brand_prf#1874 AS p_brand_prf_0#1884, p_size_prf#1875 AS p_size_prf_0#1885, p_partkey_prf#1876 AS p_partkey_prf_0#1886]
         :     :  +- Relation[p_comment_prf#1867,p_name_prf#1868,rid#1869,p_type_prf#1870,p_retailprice_prf#1871,p_mfgr_prf#1872,p_container_prf#1873,p_brand_prf#1874,p_size_prf#1875,p_partkey_prf#1876] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1888 AS l_returnflag_prf_1#1907, l_orderkey_and_l_linenumber_prf#1889 AS l_orderkey_and_l_linenumber_prf_1#1908, l_comment_prf#1890 AS l_comment_prf_1#1909, l_linestatus_prf#1891 AS l_linestatus_prf_1#1910, rid#1892 AS rid_1#1911, l_shipmode_prf#1893 AS l_shipmode_prf_1#1912, l_shipinstruct_prf#1894 AS l_shipinstruct_prf_1#1913, l_quantity_prf#1895 AS l_quantity_prf_1#1914, l_receiptdate_prf#1896 AS l_receiptdate_prf_1#1915, l_linenumber_prf#1897 AS l_linenumber_prf_1#1916, l_tax_prf#1898 AS l_tax_prf_1#1917, l_shipdate_prf#1899 AS l_shipdate_prf_1#1918, l_extendedprice_prf#1900 AS l_extendedprice_prf_1#1919, l_partkey_prf#1901 AS l_partkey_prf_1#1920, l_discount_prf#1902 AS l_discount_prf_1#1921, l_partkey_and_l_suppkey_prf#1903 AS l_partkey_and_l_suppkey_prf_1#1922, l_commitdate_prf#1904 AS l_commitdate_prf_1#1923, l_suppkey_prf#1905 AS l_suppkey_prf_1#1924, l_orderkey_prf#1906 AS l_orderkey_prf_1#1925]
            +- Relation[l_returnflag_prf#1888,l_orderkey_and_l_linenumber_prf#1889,l_comment_prf#1890,l_linestatus_prf#1891,rid#1892,l_shipmode_prf#1893,l_shipinstruct_prf#1894,l_quantity_prf#1895,l_receiptdate_prf#1896,l_linenumber_prf#1897,l_tax_prf#1898,l_shipdate_prf#1899,l_extendedprice_prf#1900,l_partkey_prf#1901,l_discount_prf#1902,l_partkey_and_l_suppkey_prf#1903,l_commitdate_prf#1904,l_suppkey_prf#1905,l_orderkey_prf#1906] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 94282ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/15 02:20:46 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:20:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1972L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 02:20:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1972L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#1988]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#1982: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#1974 AS ps_partkey_and_ps_suppkey_prf_0#1981, rid#1975 AS rid_0#1982, ps_availqty_prf#1976 AS ps_availqty_prf_0#1983, ps_comment_prf#1977 AS ps_comment_prf_0#1984, ps_partkey_prf#1978 AS ps_partkey_prf_0#1985, ps_supplycost_prf#1979 AS ps_supplycost_prf_0#1986, ps_suppkey_prf#1980 AS ps_suppkey_prf_0#1987]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#1974,rid#1975,ps_availqty_prf#1976,ps_comment_prf#1977,ps_partkey_prf#1978,ps_supplycost_prf#1979,ps_suppkey_prf#1980] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#1989 AS p_comment_prf_1#1999, p_name_prf#1990 AS p_name_prf_1#2000, rid#1991 AS rid_1#2001, p_type_prf#1992 AS p_type_prf_1#2002, p_retailprice_prf#1993 AS p_retailprice_prf_1#2003, p_mfgr_prf#1994 AS p_mfgr_prf_1#2004, p_container_prf#1995 AS p_container_prf_1#2005, p_brand_prf#1996 AS p_brand_prf_1#2006, p_size_prf#1997 AS p_size_prf_1#2007, p_partkey_prf#1998 AS p_partkey_prf_1#2008]
            :  +- Relation[p_comment_prf#1989,p_name_prf#1990,rid#1991,p_type_prf#1992,p_retailprice_prf#1993,p_mfgr_prf#1994,p_container_prf#1995,p_brand_prf#1996,p_size_prf#1997,p_partkey_prf#1998] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2009]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1507,value#1508] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 49375ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/15 02:21:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:21:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2049L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/15 02:21:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2049L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_2#2069]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#2061: string
         :     :- Project [c_acctbal_prf#2051 AS c_acctbal_prf_0#2060, rid#2052 AS rid_0#2061, c_name_prf#2053 AS c_name_prf_0#2062, c_nationkey_prf#2054 AS c_nationkey_prf_0#2063, c_custkey_prf#2055 AS c_custkey_prf_0#2064, c_comment_prf#2056 AS c_comment_prf_0#2065, c_address_prf#2057 AS c_address_prf_0#2066, c_mktsegment_prf#2058 AS c_mktsegment_prf_0#2067, c_phone_prf#2059 AS c_phone_prf_0#2068]
         :     :  +- Relation[c_acctbal_prf#2051,rid#2052,c_name_prf#2053,c_nationkey_prf#2054,c_custkey_prf#2055,c_comment_prf#2056,c_address_prf#2057,c_mktsegment_prf#2058,c_phone_prf#2059] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#2086]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#2079: string
            :     :- Project [s_phone_prf#2070 AS s_phone_prf_1#2078, rid#2071 AS rid_1#2079, s_address_prf#2072 AS s_address_prf_1#2080, s_nationkey_prf#2073 AS s_nationkey_prf_1#2081, s_suppkey_prf#2074 AS s_suppkey_prf_1#2082, s_name_prf#2075 AS s_name_prf_1#2083, s_acctbal_prf#2076 AS s_acctbal_prf_1#2084, s_comment_prf#2077 AS s_comment_prf_1#2085]
            :     :  +- Relation[s_phone_prf#2070,rid#2071,s_address_prf#2072,s_nationkey_prf#2073,s_suppkey_prf#2074,s_name_prf#2075,s_acctbal_prf#2076,s_comment_prf#2077] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [rid#2087 AS rid_2#2092, n_regionkey_prf#2088 AS n_regionkey_prf_2#2093, n_nationkey_prf#2089 AS n_nationkey_prf_2#2094, n_name_prf#2090 AS n_name_prf_2#2095, n_comment_prf#2091 AS n_comment_prf_2#2096]
               +- Relation[rid#2087,n_regionkey_prf#2088,n_nationkey_prf#2089,n_name_prf#2090,n_comment_prf#2091] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 88700ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/15 02:23:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:23:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2155L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 02:23:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2155L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_2#2195]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2180: string
         :     :- Project [l_returnflag_prf#2157 AS l_returnflag_prf_0#2176, l_orderkey_and_l_linenumber_prf#2158 AS l_orderkey_and_l_linenumber_prf_0#2177, l_comment_prf#2159 AS l_comment_prf_0#2178, l_linestatus_prf#2160 AS l_linestatus_prf_0#2179, rid#2161 AS rid_0#2180, l_shipmode_prf#2162 AS l_shipmode_prf_0#2181, l_shipinstruct_prf#2163 AS l_shipinstruct_prf_0#2182, l_quantity_prf#2164 AS l_quantity_prf_0#2183, l_receiptdate_prf#2165 AS l_receiptdate_prf_0#2184, l_linenumber_prf#2166 AS l_linenumber_prf_0#2185, l_tax_prf#2167 AS l_tax_prf_0#2186, l_shipdate_prf#2168 AS l_shipdate_prf_0#2187, l_extendedprice_prf#2169 AS l_extendedprice_prf_0#2188, l_partkey_prf#2170 AS l_partkey_prf_0#2189, l_discount_prf#2171 AS l_discount_prf_0#2190, l_partkey_and_l_suppkey_prf#2172 AS l_partkey_and_l_suppkey_prf_0#2191, l_commitdate_prf#2173 AS l_commitdate_prf_0#2192, l_suppkey_prf#2174 AS l_suppkey_prf_0#2193, l_orderkey_prf#2175 AS l_orderkey_prf_0#2194]
         :     :  +- Relation[l_returnflag_prf#2157,l_orderkey_and_l_linenumber_prf#2158,l_comment_prf#2159,l_linestatus_prf#2160,rid#2161,l_shipmode_prf#2162,l_shipinstruct_prf#2163,l_quantity_prf#2164,l_receiptdate_prf#2165,l_linenumber_prf#2166,l_tax_prf#2167,l_shipdate_prf#2168,l_extendedprice_prf#2169,l_partkey_prf#2170,l_discount_prf#2171,l_partkey_and_l_suppkey_prf#2172,l_commitdate_prf#2173,l_suppkey_prf#2174,l_orderkey_prf#2175] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#2214]
            :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#2206: string
            :     :- Project [c_acctbal_prf#2196 AS c_acctbal_prf_1#2205, rid#2197 AS rid_1#2206, c_name_prf#2198 AS c_name_prf_1#2207, c_nationkey_prf#2199 AS c_nationkey_prf_1#2208, c_custkey_prf#2200 AS c_custkey_prf_1#2209, c_comment_prf#2201 AS c_comment_prf_1#2210, c_address_prf#2202 AS c_address_prf_1#2211, c_mktsegment_prf#2203 AS c_mktsegment_prf_1#2212, c_phone_prf#2204 AS c_phone_prf_1#2213]
            :     :  +- Relation[c_acctbal_prf#2196,rid#2197,c_name_prf#2198,c_nationkey_prf#2199,c_custkey_prf#2200,c_comment_prf#2201,c_address_prf#2202,c_mktsegment_prf#2203,c_phone_prf#2204] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2215 AS o_shippriority_prf_2#2225, rid#2216 AS rid_2#2226, o_orderdate_prf#2217 AS o_orderdate_prf_2#2227, o_custkey_prf#2218 AS o_custkey_prf_2#2228, o_orderpriority_prf#2219 AS o_orderpriority_prf_2#2229, o_clerk_prf#2220 AS o_clerk_prf_2#2230, o_orderstatus_prf#2221 AS o_orderstatus_prf_2#2231, o_totalprice_prf#2222 AS o_totalprice_prf_2#2232, o_orderkey_prf#2223 AS o_orderkey_prf_2#2233, o_comment_prf#2224 AS o_comment_prf_2#2234]
               +- Relation[o_shippriority_prf#2215,rid#2216,o_orderdate_prf#2217,o_custkey_prf#2218,o_orderpriority_prf#2219,o_clerk_prf#2220,o_orderstatus_prf#2221,o_totalprice_prf#2222,o_orderkey_prf#2223,o_comment_prf#2224] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 157454ms

j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/15 02:25:41 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:25:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2290L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/15 02:25:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2290L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#2312]
         :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2304: string
         :     :- Project [p_comment_prf#2292 AS p_comment_prf_0#2302, p_name_prf#2293 AS p_name_prf_0#2303, rid#2294 AS rid_0#2304, p_type_prf#2295 AS p_type_prf_0#2305, p_retailprice_prf#2296 AS p_retailprice_prf_0#2306, p_mfgr_prf#2297 AS p_mfgr_prf_0#2307, p_container_prf#2298 AS p_container_prf_0#2308, p_brand_prf#2299 AS p_brand_prf_0#2309, p_size_prf#2300 AS p_size_prf_0#2310, p_partkey_prf#2301 AS p_partkey_prf_0#2311]
         :     :  +- Relation[p_comment_prf#2292,p_name_prf#2293,rid#2294,p_type_prf#2295,p_retailprice_prf#2296,p_mfgr_prf#2297,p_container_prf#2298,p_brand_prf#2299,p_size_prf#2300,p_partkey_prf#2301] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2313 AS ps_partkey_and_ps_suppkey_prf_1#2320, rid#2314 AS rid_1#2321, ps_availqty_prf#2315 AS ps_availqty_prf_1#2322, ps_comment_prf#2316 AS ps_comment_prf_1#2323, ps_partkey_prf#2317 AS ps_partkey_prf_1#2324, ps_supplycost_prf#2318 AS ps_supplycost_prf_1#2325, ps_suppkey_prf#2319 AS ps_suppkey_prf_1#2326]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2313,rid#2314,ps_availqty_prf#2315,ps_comment_prf#2316,ps_partkey_prf#2317,ps_supplycost_prf#2318,ps_suppkey_prf#2319] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 31563ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/15 02:26:13 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:26:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2379L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 02:26:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2379L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#2419]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#2404: string
         :  :  :     :- Project [l_returnflag_prf#2381 AS l_returnflag_prf_0#2400, l_orderkey_and_l_linenumber_prf#2382 AS l_orderkey_and_l_linenumber_prf_0#2401, l_comment_prf#2383 AS l_comment_prf_0#2402, l_linestatus_prf#2384 AS l_linestatus_prf_0#2403, rid#2385 AS rid_0#2404, l_shipmode_prf#2386 AS l_shipmode_prf_0#2405, l_shipinstruct_prf#2387 AS l_shipinstruct_prf_0#2406, l_quantity_prf#2388 AS l_quantity_prf_0#2407, l_receiptdate_prf#2389 AS l_receiptdate_prf_0#2408, l_linenumber_prf#2390 AS l_linenumber_prf_0#2409, l_tax_prf#2391 AS l_tax_prf_0#2410, l_shipdate_prf#2392 AS l_shipdate_prf_0#2411, l_extendedprice_prf#2393 AS l_extendedprice_prf_0#2412, l_partkey_prf#2394 AS l_partkey_prf_0#2413, l_discount_prf#2395 AS l_discount_prf_0#2414, l_partkey_and_l_suppkey_prf#2396 AS l_partkey_and_l_suppkey_prf_0#2415, l_commitdate_prf#2397 AS l_commitdate_prf_0#2416, l_suppkey_prf#2398 AS l_suppkey_prf_0#2417, l_orderkey_prf#2399 AS l_orderkey_prf_0#2418]
         :  :  :     :  +- Relation[l_returnflag_prf#2381,l_orderkey_and_l_linenumber_prf#2382,l_comment_prf#2383,l_linestatus_prf#2384,rid#2385,l_shipmode_prf#2386,l_shipinstruct_prf#2387,l_quantity_prf#2388,l_receiptdate_prf#2389,l_linenumber_prf#2390,l_tax_prf#2391,l_shipdate_prf#2392,l_extendedprice_prf#2393,l_partkey_prf#2394,l_discount_prf#2395,l_partkey_and_l_suppkey_prf#2396,l_commitdate_prf#2397,l_suppkey_prf#2398,l_orderkey_prf#2399] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#2420 AS p_comment_prf_1#2430, p_name_prf#2421 AS p_name_prf_1#2431, rid#2422 AS rid_1#2432, p_type_prf#2423 AS p_type_prf_1#2433, p_retailprice_prf#2424 AS p_retailprice_prf_1#2434, p_mfgr_prf#2425 AS p_mfgr_prf_1#2435, p_container_prf#2426 AS p_container_prf_1#2436, p_brand_prf#2427 AS p_brand_prf_1#2437, p_size_prf#2428 AS p_size_prf_1#2438, p_partkey_prf#2429 AS p_partkey_prf_1#2439]
         :  :     +- Relation[p_comment_prf#2420,p_name_prf#2421,rid#2422,p_type_prf#2423,p_retailprice_prf#2424,p_mfgr_prf#2425,p_container_prf#2426,p_brand_prf#2427,p_size_prf#2428,p_partkey_prf#2429] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1511) AS rid_2#2460]
         :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2459]
         :        :  +- Relation[l_returnflag_prf#2440,l_orderkey_and_l_linenumber_prf#2441,l_comment_prf#2442,l_linestatus_prf#2443,rid#2444,l_shipmode_prf#2445,l_shipinstruct_prf#2446,l_quantity_prf#2447,l_receiptdate_prf#2448,l_linenumber_prf#2449,l_tax_prf#2450,l_shipdate_prf#2451,l_extendedprice_prf#2452,l_partkey_prf#2453,l_discount_prf#2454,l_partkey_and_l_suppkey_prf#2455,l_commitdate_prf#2456,l_suppkey_prf#2457,l_orderkey_prf#2458] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2461 AS s_phone_prf_2#2469, rid#2462 AS rid_2#2470, s_address_prf#2463 AS s_address_prf_2#2471, s_nationkey_prf#2464 AS s_nationkey_prf_2#2472, s_suppkey_prf#2465 AS s_suppkey_prf_2#2473, s_name_prf#2466 AS s_name_prf_2#2474, s_acctbal_prf#2467 AS s_acctbal_prf_2#2475, s_comment_prf#2468 AS s_comment_prf_2#2476]
            +- Relation[s_phone_prf#2461,rid#2462,s_address_prf#2463,s_nationkey_prf#2464,s_suppkey_prf#2465,s_name_prf#2466,s_acctbal_prf#2467,s_comment_prf#2468] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 222169ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/15 02:29:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:29:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2549L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 02:29:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2549L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#2567]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#2560: string
         :     :- Project [s_phone_prf#2551 AS s_phone_prf_0#2559, rid#2552 AS rid_0#2560, s_address_prf#2553 AS s_address_prf_0#2561, s_nationkey_prf#2554 AS s_nationkey_prf_0#2562, s_suppkey_prf#2555 AS s_suppkey_prf_0#2563, s_name_prf#2556 AS s_name_prf_0#2564, s_acctbal_prf#2557 AS s_acctbal_prf_0#2565, s_comment_prf#2558 AS s_comment_prf_0#2566]
         :     :  +- Relation[s_phone_prf#2551,rid#2552,s_address_prf#2553,s_nationkey_prf#2554,s_suppkey_prf#2555,s_name_prf#2556,s_acctbal_prf#2557,s_comment_prf#2558] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#2606]
            :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_1#2591: string
            :     :- Project [l_returnflag_prf#2568 AS l_returnflag_prf_1#2587, l_orderkey_and_l_linenumber_prf#2569 AS l_orderkey_and_l_linenumber_prf_1#2588, l_comment_prf#2570 AS l_comment_prf_1#2589, l_linestatus_prf#2571 AS l_linestatus_prf_1#2590, rid#2572 AS rid_1#2591, l_shipmode_prf#2573 AS l_shipmode_prf_1#2592, l_shipinstruct_prf#2574 AS l_shipinstruct_prf_1#2593, l_quantity_prf#2575 AS l_quantity_prf_1#2594, l_receiptdate_prf#2576 AS l_receiptdate_prf_1#2595, l_linenumber_prf#2577 AS l_linenumber_prf_1#2596, l_tax_prf#2578 AS l_tax_prf_1#2597, l_shipdate_prf#2579 AS l_shipdate_prf_1#2598, l_extendedprice_prf#2580 AS l_extendedprice_prf_1#2599, l_partkey_prf#2581 AS l_partkey_prf_1#2600, l_discount_prf#2582 AS l_discount_prf_1#2601, l_partkey_and_l_suppkey_prf#2583 AS l_partkey_and_l_suppkey_prf_1#2602, l_commitdate_prf#2584 AS l_commitdate_prf_1#2603, l_suppkey_prf#2585 AS l_suppkey_prf_1#2604, l_orderkey_prf#2586 AS l_orderkey_prf_1#2605]
            :     :  +- Relation[l_returnflag_prf#2568,l_orderkey_and_l_linenumber_prf#2569,l_comment_prf#2570,l_linestatus_prf#2571,rid#2572,l_shipmode_prf#2573,l_shipinstruct_prf#2574,l_quantity_prf#2575,l_receiptdate_prf#2576,l_linenumber_prf#2577,l_tax_prf#2578,l_shipdate_prf#2579,l_extendedprice_prf#2580,l_partkey_prf#2581,l_discount_prf#2582,l_partkey_and_l_suppkey_prf#2583,l_commitdate_prf#2584,l_suppkey_prf#2585,l_orderkey_prf#2586] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#2607 AS p_comment_prf_2#2617, p_name_prf#2608 AS p_name_prf_2#2618, rid#2609 AS rid_2#2619, p_type_prf#2610 AS p_type_prf_2#2620, p_retailprice_prf#2611 AS p_retailprice_prf_2#2621, p_mfgr_prf#2612 AS p_mfgr_prf_2#2622, p_container_prf#2613 AS p_container_prf_2#2623, p_brand_prf#2614 AS p_brand_prf_2#2624, p_size_prf#2615 AS p_size_prf_2#2625, p_partkey_prf#2616 AS p_partkey_prf_2#2626]
               +- Relation[p_comment_prf#2607,p_name_prf#2608,rid#2609,p_type_prf#2610,p_retailprice_prf#2611,p_mfgr_prf#2612,p_container_prf#2613,p_brand_prf#2614,p_size_prf#2615,p_partkey_prf#2616] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 186674ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/15 02:33:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:33:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2692L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 02:33:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2692L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#2733]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2717: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#2694 AS l_returnflag_prf_0#2713, l_orderkey_and_l_linenumber_prf#2695 AS l_orderkey_and_l_linenumber_prf_0#2714, l_comment_prf#2696 AS l_comment_prf_0#2715, l_linestatus_prf#2697 AS l_linestatus_prf_0#2716, rid#2698 AS rid_0#2717, l_shipmode_prf#2699 AS l_shipmode_prf_0#2718, l_shipinstruct_prf#2700 AS l_shipinstruct_prf_0#2719, l_quantity_prf#2701 AS l_quantity_prf_0#2720, l_receiptdate_prf#2702 AS l_receiptdate_prf_0#2721, l_linenumber_prf#2703 AS l_linenumber_prf_0#2722, l_tax_prf#2704 AS l_tax_prf_0#2723, l_shipdate_prf#2705 AS l_shipdate_prf_0#2724, l_extendedprice_prf#2706 AS l_extendedprice_prf_0#2725, l_partkey_prf#2707 AS l_partkey_prf_0#2726, l_discount_prf#2708 AS l_discount_prf_0#2727, l_partkey_and_l_suppkey_prf#2709 AS l_partkey_and_l_suppkey_prf_0#2728, l_commitdate_prf#2710 AS l_commitdate_prf_0#2729, l_suppkey_prf#2711 AS l_suppkey_prf_0#2730, l_orderkey_prf#2712 AS l_orderkey_prf_0#2731]
         :     :  :  +- Relation[l_returnflag_prf#2694,l_orderkey_and_l_linenumber_prf#2695,l_comment_prf#2696,l_linestatus_prf#2697,rid#2698,l_shipmode_prf#2699,l_shipinstruct_prf#2700,l_quantity_prf#2701,l_receiptdate_prf#2702,l_linenumber_prf#2703,l_tax_prf#2704,l_shipdate_prf#2705,l_extendedprice_prf#2706,l_partkey_prf#2707,l_discount_prf#2708,l_partkey_and_l_suppkey_prf#2709,l_commitdate_prf#2710,l_suppkey_prf#2711,l_orderkey_prf#2712] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2732]
         :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :        +- Relation[label#1507,value#1508] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2734 AS o_shippriority_prf_1#2744, rid#2735 AS rid_1#2745, o_orderdate_prf#2736 AS o_orderdate_prf_1#2746, o_custkey_prf#2737 AS o_custkey_prf_1#2747, o_orderpriority_prf#2738 AS o_orderpriority_prf_1#2748, o_clerk_prf#2739 AS o_clerk_prf_1#2749, o_orderstatus_prf#2740 AS o_orderstatus_prf_1#2750, o_totalprice_prf#2741 AS o_totalprice_prf_1#2751, o_orderkey_prf#2742 AS o_orderkey_prf_1#2752, o_comment_prf#2743 AS o_comment_prf_1#2753]
            +- Relation[o_shippriority_prf#2734,rid#2735,o_orderdate_prf#2736,o_custkey_prf#2737,o_orderpriority_prf#2738,o_clerk_prf#2739,o_orderstatus_prf#2740,o_totalprice_prf#2741,o_orderkey_prf#2742,o_comment_prf#2743] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 54414ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/15 02:33:56 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:33:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2803L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 02:33:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2803L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#2823]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2815: string
         :     :- Project [c_acctbal_prf#2805 AS c_acctbal_prf_0#2814, rid#2806 AS rid_0#2815, c_name_prf#2807 AS c_name_prf_0#2816, c_nationkey_prf#2808 AS c_nationkey_prf_0#2817, c_custkey_prf#2809 AS c_custkey_prf_0#2818, c_comment_prf#2810 AS c_comment_prf_0#2819, c_address_prf#2811 AS c_address_prf_0#2820, c_mktsegment_prf#2812 AS c_mktsegment_prf_0#2821, c_phone_prf#2813 AS c_phone_prf_0#2822]
         :     :  +- Relation[c_acctbal_prf#2805,rid#2806,c_name_prf#2807,c_nationkey_prf#2808,c_custkey_prf#2809,c_comment_prf#2810,c_address_prf#2811,c_mktsegment_prf#2812,c_phone_prf#2813] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2824 AS o_shippriority_prf_1#2834, rid#2825 AS rid_1#2835, o_orderdate_prf#2826 AS o_orderdate_prf_1#2836, o_custkey_prf#2827 AS o_custkey_prf_1#2837, o_orderpriority_prf#2828 AS o_orderpriority_prf_1#2838, o_clerk_prf#2829 AS o_clerk_prf_1#2839, o_orderstatus_prf#2830 AS o_orderstatus_prf_1#2840, o_totalprice_prf#2831 AS o_totalprice_prf_1#2841, o_orderkey_prf#2832 AS o_orderkey_prf_1#2842, o_comment_prf#2833 AS o_comment_prf_1#2843]
            +- Relation[o_shippriority_prf#2824,rid#2825,o_orderdate_prf#2826,o_custkey_prf#2827,o_orderpriority_prf#2828,o_clerk_prf#2829,o_orderstatus_prf#2830,o_totalprice_prf#2831,o_orderkey_prf#2832,o_comment_prf#2833] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1500000
Elapsed time: 40334ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/15 02:34:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:34:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2885L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/15 02:34:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2885L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#2903]
         :  :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#2896: string
         :  :  :     :- Project [s_phone_prf#2887 AS s_phone_prf_0#2895, rid#2888 AS rid_0#2896, s_address_prf#2889 AS s_address_prf_0#2897, s_nationkey_prf#2890 AS s_nationkey_prf_0#2898, s_suppkey_prf#2891 AS s_suppkey_prf_0#2899, s_name_prf#2892 AS s_name_prf_0#2900, s_acctbal_prf#2893 AS s_acctbal_prf_0#2901, s_comment_prf#2894 AS s_comment_prf_0#2902]
         :  :  :     :  +- Relation[s_phone_prf#2887,rid#2888,s_address_prf#2889,s_nationkey_prf#2890,s_suppkey_prf#2891,s_name_prf#2892,s_acctbal_prf#2893,s_comment_prf#2894] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [rid#2904 AS rid_1#2909, n_regionkey_prf#2905 AS n_regionkey_prf_1#2910, n_nationkey_prf#2906 AS n_nationkey_prf_1#2911, n_name_prf#2907 AS n_name_prf_1#2912, n_comment_prf#2908 AS n_comment_prf_1#2913]
         :  :     +- Relation[rid#2904,n_regionkey_prf#2905,n_nationkey_prf#2906,n_name_prf#2907,n_comment_prf#2908] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#2920]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2919]
         :        :  +- Relation[rid#2914,n_regionkey_prf#2915,n_nationkey_prf#2916,n_name_prf#2917,n_comment_prf#2918] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2921 AS c_acctbal_prf_2#2930, rid#2922 AS rid_2#2931, c_name_prf#2923 AS c_name_prf_2#2932, c_nationkey_prf#2924 AS c_nationkey_prf_2#2933, c_custkey_prf#2925 AS c_custkey_prf_2#2934, c_comment_prf#2926 AS c_comment_prf_2#2935, c_address_prf#2927 AS c_address_prf_2#2936, c_mktsegment_prf#2928 AS c_mktsegment_prf_2#2937, c_phone_prf#2929 AS c_phone_prf_2#2938]
            +- Relation[c_acctbal_prf#2921,rid#2922,c_name_prf#2923,c_nationkey_prf#2924,c_custkey_prf#2925,c_comment_prf#2926,c_address_prf#2927,c_mktsegment_prf#2928,c_phone_prf#2929] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 30080ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/15 02:35:07 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:35:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2997L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 02:35:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2997L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3017]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3009: string
         :     :- Project [c_acctbal_prf#2999 AS c_acctbal_prf_0#3008, rid#3000 AS rid_0#3009, c_name_prf#3001 AS c_name_prf_0#3010, c_nationkey_prf#3002 AS c_nationkey_prf_0#3011, c_custkey_prf#3003 AS c_custkey_prf_0#3012, c_comment_prf#3004 AS c_comment_prf_0#3013, c_address_prf#3005 AS c_address_prf_0#3014, c_mktsegment_prf#3006 AS c_mktsegment_prf_0#3015, c_phone_prf#3007 AS c_phone_prf_0#3016]
         :     :  +- Relation[c_acctbal_prf#2999,rid#3000,c_name_prf#3001,c_nationkey_prf#3002,c_custkey_prf#3003,c_comment_prf#3004,c_address_prf#3005,c_mktsegment_prf#3006,c_phone_prf#3007] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#3038]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#3029: string
            :     :- Project [o_shippriority_prf#3018 AS o_shippriority_prf_1#3028, rid#3019 AS rid_1#3029, o_orderdate_prf#3020 AS o_orderdate_prf_1#3030, o_custkey_prf#3021 AS o_custkey_prf_1#3031, o_orderpriority_prf#3022 AS o_orderpriority_prf_1#3032, o_clerk_prf#3023 AS o_clerk_prf_1#3033, o_orderstatus_prf#3024 AS o_orderstatus_prf_1#3034, o_totalprice_prf#3025 AS o_totalprice_prf_1#3035, o_orderkey_prf#3026 AS o_orderkey_prf_1#3036, o_comment_prf#3027 AS o_comment_prf_1#3037]
            :     :  +- Relation[o_shippriority_prf#3018,rid#3019,o_orderdate_prf#3020,o_custkey_prf#3021,o_orderpriority_prf#3022,o_clerk_prf#3023,o_orderstatus_prf#3024,o_totalprice_prf#3025,o_orderkey_prf#3026,o_comment_prf#3027] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3039 AS l_returnflag_prf_2#3058, l_orderkey_and_l_linenumber_prf#3040 AS l_orderkey_and_l_linenumber_prf_2#3059, l_comment_prf#3041 AS l_comment_prf_2#3060, l_linestatus_prf#3042 AS l_linestatus_prf_2#3061, rid#3043 AS rid_2#3062, l_shipmode_prf#3044 AS l_shipmode_prf_2#3063, l_shipinstruct_prf#3045 AS l_shipinstruct_prf_2#3064, l_quantity_prf#3046 AS l_quantity_prf_2#3065, l_receiptdate_prf#3047 AS l_receiptdate_prf_2#3066, l_linenumber_prf#3048 AS l_linenumber_prf_2#3067, l_tax_prf#3049 AS l_tax_prf_2#3068, l_shipdate_prf#3050 AS l_shipdate_prf_2#3069, l_extendedprice_prf#3051 AS l_extendedprice_prf_2#3070, l_partkey_prf#3052 AS l_partkey_prf_2#3071, l_discount_prf#3053 AS l_discount_prf_2#3072, l_partkey_and_l_suppkey_prf#3054 AS l_partkey_and_l_suppkey_prf_2#3073, l_commitdate_prf#3055 AS l_commitdate_prf_2#3074, l_suppkey_prf#3056 AS l_suppkey_prf_2#3075, l_orderkey_prf#3057 AS l_orderkey_prf_2#3076]
               +- Relation[l_returnflag_prf#3039,l_orderkey_and_l_linenumber_prf#3040,l_comment_prf#3041,l_linestatus_prf#3042,rid#3043,l_shipmode_prf#3044,l_shipinstruct_prf#3045,l_quantity_prf#3046,l_receiptdate_prf#3047,l_linenumber_prf#3048,l_tax_prf#3049,l_shipdate_prf#3050,l_extendedprice_prf#3051,l_partkey_prf#3052,l_discount_prf#3053,l_partkey_and_l_suppkey_prf#3054,l_commitdate_prf#3055,l_suppkey_prf#3056,l_orderkey_prf#3057] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 233949ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/15 02:39:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:39:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3139L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 02:39:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3139L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3155]
         :  :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#3149: string
         :  :  :     :- Project [ps_partkey_and_ps_suppkey_prf#3141 AS ps_partkey_and_ps_suppkey_prf_0#3148, rid#3142 AS rid_0#3149, ps_availqty_prf#3143 AS ps_availqty_prf_0#3150, ps_comment_prf#3144 AS ps_comment_prf_0#3151, ps_partkey_prf#3145 AS ps_partkey_prf_0#3152, ps_supplycost_prf#3146 AS ps_supplycost_prf_0#3153, ps_suppkey_prf#3147 AS ps_suppkey_prf_0#3154]
         :  :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#3141,rid#3142,ps_availqty_prf#3143,ps_comment_prf#3144,ps_partkey_prf#3145,ps_supplycost_prf#3146,ps_suppkey_prf#3147] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#3156 AS p_comment_prf_1#3166, p_name_prf#3157 AS p_name_prf_1#3167, rid#3158 AS rid_1#3168, p_type_prf#3159 AS p_type_prf_1#3169, p_retailprice_prf#3160 AS p_retailprice_prf_1#3170, p_mfgr_prf#3161 AS p_mfgr_prf_1#3171, p_container_prf#3162 AS p_container_prf_1#3172, p_brand_prf#3163 AS p_brand_prf_1#3173, p_size_prf#3164 AS p_size_prf_1#3174, p_partkey_prf#3165 AS p_partkey_prf_1#3175]
         :  :     +- Relation[p_comment_prf#3156,p_name_prf#3157,rid#3158,p_type_prf#3159,p_retailprice_prf#3160,p_mfgr_prf#3161,p_container_prf#3162,p_brand_prf#3163,p_size_prf#3164,p_partkey_prf#3165] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1511) AS rid_2#3184]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3183]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#3176,rid#3177,ps_availqty_prf#3178,ps_comment_prf#3179,ps_partkey_prf#3180,ps_supplycost_prf#3181,ps_suppkey_prf#3182] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3185 AS s_phone_prf_2#3193, rid#3186 AS rid_2#3194, s_address_prf#3187 AS s_address_prf_2#3195, s_nationkey_prf#3188 AS s_nationkey_prf_2#3196, s_suppkey_prf#3189 AS s_suppkey_prf_2#3197, s_name_prf#3190 AS s_name_prf_2#3198, s_acctbal_prf#3191 AS s_acctbal_prf_2#3199, s_comment_prf#3192 AS s_comment_prf_2#3200]
            +- Relation[s_phone_prf#3185,rid#3186,s_address_prf#3187,s_nationkey_prf#3188,s_suppkey_prf#3189,s_name_prf#3190,s_acctbal_prf#3191,s_comment_prf#3192] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 105591ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/15 02:40:46 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:40:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3254L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 02:40:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3254L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3294]
         :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#3279: string
         :     :- Project [l_returnflag_prf#3256 AS l_returnflag_prf_0#3275, l_orderkey_and_l_linenumber_prf#3257 AS l_orderkey_and_l_linenumber_prf_0#3276, l_comment_prf#3258 AS l_comment_prf_0#3277, l_linestatus_prf#3259 AS l_linestatus_prf_0#3278, rid#3260 AS rid_0#3279, l_shipmode_prf#3261 AS l_shipmode_prf_0#3280, l_shipinstruct_prf#3262 AS l_shipinstruct_prf_0#3281, l_quantity_prf#3263 AS l_quantity_prf_0#3282, l_receiptdate_prf#3264 AS l_receiptdate_prf_0#3283, l_linenumber_prf#3265 AS l_linenumber_prf_0#3284, l_tax_prf#3266 AS l_tax_prf_0#3285, l_shipdate_prf#3267 AS l_shipdate_prf_0#3286, l_extendedprice_prf#3268 AS l_extendedprice_prf_0#3287, l_partkey_prf#3269 AS l_partkey_prf_0#3288, l_discount_prf#3270 AS l_discount_prf_0#3289, l_partkey_and_l_suppkey_prf#3271 AS l_partkey_and_l_suppkey_prf_0#3290, l_commitdate_prf#3272 AS l_commitdate_prf_0#3291, l_suppkey_prf#3273 AS l_suppkey_prf_0#3292, l_orderkey_prf#3274 AS l_orderkey_prf_0#3293]
         :     :  +- Relation[l_returnflag_prf#3256,l_orderkey_and_l_linenumber_prf#3257,l_comment_prf#3258,l_linestatus_prf#3259,rid#3260,l_shipmode_prf#3261,l_shipinstruct_prf#3262,l_quantity_prf#3263,l_receiptdate_prf#3264,l_linenumber_prf#3265,l_tax_prf#3266,l_shipdate_prf#3267,l_extendedprice_prf#3268,l_partkey_prf#3269,l_discount_prf#3270,l_partkey_and_l_suppkey_prf#3271,l_commitdate_prf#3272,l_suppkey_prf#3273,l_orderkey_prf#3274] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#3295 AS p_comment_prf_1#3305, p_name_prf#3296 AS p_name_prf_1#3306, rid#3297 AS rid_1#3307, p_type_prf#3298 AS p_type_prf_1#3308, p_retailprice_prf#3299 AS p_retailprice_prf_1#3309, p_mfgr_prf#3300 AS p_mfgr_prf_1#3310, p_container_prf#3301 AS p_container_prf_1#3311, p_brand_prf#3302 AS p_brand_prf_1#3312, p_size_prf#3303 AS p_size_prf_1#3313, p_partkey_prf#3304 AS p_partkey_prf_1#3314]
            +- Relation[p_comment_prf#3295,p_name_prf#3296,rid#3297,p_type_prf#3298,p_retailprice_prf#3299,p_mfgr_prf#3300,p_container_prf#3301,p_brand_prf#3302,p_size_prf#3303,p_partkey_prf#3304] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 117045ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/15 02:42:43 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:42:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3379L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 02:42:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3379L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3401]
         :  :  :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3393: string
         :  :  :     :- Project [p_comment_prf#3381 AS p_comment_prf_0#3391, p_name_prf#3382 AS p_name_prf_0#3392, rid#3383 AS rid_0#3393, p_type_prf#3384 AS p_type_prf_0#3394, p_retailprice_prf#3385 AS p_retailprice_prf_0#3395, p_mfgr_prf#3386 AS p_mfgr_prf_0#3396, p_container_prf#3387 AS p_container_prf_0#3397, p_brand_prf#3388 AS p_brand_prf_0#3398, p_size_prf#3389 AS p_size_prf_0#3399, p_partkey_prf#3390 AS p_partkey_prf_0#3400]
         :  :  :     :  +- Relation[p_comment_prf#3381,p_name_prf#3382,rid#3383,p_type_prf#3384,p_retailprice_prf#3385,p_mfgr_prf#3386,p_container_prf#3387,p_brand_prf#3388,p_size_prf#3389,p_partkey_prf#3390] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#3402 AS l_returnflag_prf_1#3421, l_orderkey_and_l_linenumber_prf#3403 AS l_orderkey_and_l_linenumber_prf_1#3422, l_comment_prf#3404 AS l_comment_prf_1#3423, l_linestatus_prf#3405 AS l_linestatus_prf_1#3424, rid#3406 AS rid_1#3425, l_shipmode_prf#3407 AS l_shipmode_prf_1#3426, l_shipinstruct_prf#3408 AS l_shipinstruct_prf_1#3427, l_quantity_prf#3409 AS l_quantity_prf_1#3428, l_receiptdate_prf#3410 AS l_receiptdate_prf_1#3429, l_linenumber_prf#3411 AS l_linenumber_prf_1#3430, l_tax_prf#3412 AS l_tax_prf_1#3431, l_shipdate_prf#3413 AS l_shipdate_prf_1#3432, l_extendedprice_prf#3414 AS l_extendedprice_prf_1#3433, l_partkey_prf#3415 AS l_partkey_prf_1#3434, l_discount_prf#3416 AS l_discount_prf_1#3435, l_partkey_and_l_suppkey_prf#3417 AS l_partkey_and_l_suppkey_prf_1#3436, l_commitdate_prf#3418 AS l_commitdate_prf_1#3437, l_suppkey_prf#3419 AS l_suppkey_prf_1#3438, l_orderkey_prf#3420 AS l_orderkey_prf_1#3439]
         :  :     +- Relation[l_returnflag_prf#3402,l_orderkey_and_l_linenumber_prf#3403,l_comment_prf#3404,l_linestatus_prf#3405,rid#3406,l_shipmode_prf#3407,l_shipinstruct_prf#3408,l_quantity_prf#3409,l_receiptdate_prf#3410,l_linenumber_prf#3411,l_tax_prf#3412,l_shipdate_prf#3413,l_extendedprice_prf#3414,l_partkey_prf#3415,l_discount_prf#3416,l_partkey_and_l_suppkey_prf#3417,l_commitdate_prf#3418,l_suppkey_prf#3419,l_orderkey_prf#3420] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#3460]
         :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3459]
         :        :  +- Relation[l_returnflag_prf#3440,l_orderkey_and_l_linenumber_prf#3441,l_comment_prf#3442,l_linestatus_prf#3443,rid#3444,l_shipmode_prf#3445,l_shipinstruct_prf#3446,l_quantity_prf#3447,l_receiptdate_prf#3448,l_linenumber_prf#3449,l_tax_prf#3450,l_shipdate_prf#3451,l_extendedprice_prf#3452,l_partkey_prf#3453,l_discount_prf#3454,l_partkey_and_l_suppkey_prf#3455,l_commitdate_prf#3456,l_suppkey_prf#3457,l_orderkey_prf#3458] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#3461 AS s_phone_prf_2#3469, rid#3462 AS rid_2#3470, s_address_prf#3463 AS s_address_prf_2#3471, s_nationkey_prf#3464 AS s_nationkey_prf_2#3472, s_suppkey_prf#3465 AS s_suppkey_prf_2#3473, s_name_prf#3466 AS s_name_prf_2#3474, s_acctbal_prf#3467 AS s_acctbal_prf_2#3475, s_comment_prf#3468 AS s_comment_prf_2#3476]
            +- Relation[s_phone_prf#3461,rid#3462,s_address_prf#3463,s_nationkey_prf#3464,s_suppkey_prf#3465,s_name_prf#3466,s_acctbal_prf#3467,s_comment_prf#3468] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 198038ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/15 02:46:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:46:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3533L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 02:46:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3533L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#3535 AS l_returnflag_prf_0#3554, l_orderkey_and_l_linenumber_prf#3536 AS l_orderkey_and_l_linenumber_prf_0#3555, l_comment_prf#3537 AS l_comment_prf_0#3556, l_linestatus_prf#3538 AS l_linestatus_prf_0#3557, rid#3539 AS rid_0#3558, l_shipmode_prf#3540 AS l_shipmode_prf_0#3559, l_shipinstruct_prf#3541 AS l_shipinstruct_prf_0#3560, l_quantity_prf#3542 AS l_quantity_prf_0#3561, l_receiptdate_prf#3543 AS l_receiptdate_prf_0#3562, l_linenumber_prf#3544 AS l_linenumber_prf_0#3563, l_tax_prf#3545 AS l_tax_prf_0#3564, l_shipdate_prf#3546 AS l_shipdate_prf_0#3565, l_extendedprice_prf#3547 AS l_extendedprice_prf_0#3566, l_partkey_prf#3548 AS l_partkey_prf_0#3567, l_discount_prf#3549 AS l_discount_prf_0#3568, l_partkey_and_l_suppkey_prf#3550 AS l_partkey_and_l_suppkey_prf_0#3569, l_commitdate_prf#3551 AS l_commitdate_prf_0#3570, l_suppkey_prf#3552 AS l_suppkey_prf_0#3571, l_orderkey_prf#3553 AS l_orderkey_prf_0#3572]
         :  +- Relation[l_returnflag_prf#3535,l_orderkey_and_l_linenumber_prf#3536,l_comment_prf#3537,l_linestatus_prf#3538,rid#3539,l_shipmode_prf#3540,l_shipinstruct_prf#3541,l_quantity_prf#3542,l_receiptdate_prf#3543,l_linenumber_prf#3544,l_tax_prf#3545,l_shipdate_prf#3546,l_extendedprice_prf#3547,l_partkey_prf#3548,l_discount_prf#3549,l_partkey_and_l_suppkey_prf#3550,l_commitdate_prf#3551,l_suppkey_prf#3552,l_orderkey_prf#3553] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3573]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1507,value#1508] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 13701ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/15 02:46:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:46:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3621L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 02:46:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3621L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3643]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#3634: string
         :     :- Project [o_shippriority_prf#3623 AS o_shippriority_prf_0#3633, rid#3624 AS rid_0#3634, o_orderdate_prf#3625 AS o_orderdate_prf_0#3635, o_custkey_prf#3626 AS o_custkey_prf_0#3636, o_orderpriority_prf#3627 AS o_orderpriority_prf_0#3637, o_clerk_prf#3628 AS o_clerk_prf_0#3638, o_orderstatus_prf#3629 AS o_orderstatus_prf_0#3639, o_totalprice_prf#3630 AS o_totalprice_prf_0#3640, o_orderkey_prf#3631 AS o_orderkey_prf_0#3641, o_comment_prf#3632 AS o_comment_prf_0#3642]
         :     :  +- Relation[o_shippriority_prf#3623,rid#3624,o_orderdate_prf#3625,o_custkey_prf#3626,o_orderpriority_prf#3627,o_clerk_prf#3628,o_orderstatus_prf#3629,o_totalprice_prf#3630,o_orderkey_prf#3631,o_comment_prf#3632] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#3644 AS l_returnflag_prf_1#3663, l_orderkey_and_l_linenumber_prf#3645 AS l_orderkey_and_l_linenumber_prf_1#3664, l_comment_prf#3646 AS l_comment_prf_1#3665, l_linestatus_prf#3647 AS l_linestatus_prf_1#3666, rid#3648 AS rid_1#3667, l_shipmode_prf#3649 AS l_shipmode_prf_1#3668, l_shipinstruct_prf#3650 AS l_shipinstruct_prf_1#3669, l_quantity_prf#3651 AS l_quantity_prf_1#3670, l_receiptdate_prf#3652 AS l_receiptdate_prf_1#3671, l_linenumber_prf#3653 AS l_linenumber_prf_1#3672, l_tax_prf#3654 AS l_tax_prf_1#3673, l_shipdate_prf#3655 AS l_shipdate_prf_1#3674, l_extendedprice_prf#3656 AS l_extendedprice_prf_1#3675, l_partkey_prf#3657 AS l_partkey_prf_1#3676, l_discount_prf#3658 AS l_discount_prf_1#3677, l_partkey_and_l_suppkey_prf#3659 AS l_partkey_and_l_suppkey_prf_1#3678, l_commitdate_prf#3660 AS l_commitdate_prf_1#3679, l_suppkey_prf#3661 AS l_suppkey_prf_1#3680, l_orderkey_prf#3662 AS l_orderkey_prf_1#3681]
            :  +- Relation[l_returnflag_prf#3644,l_orderkey_and_l_linenumber_prf#3645,l_comment_prf#3646,l_linestatus_prf#3647,rid#3648,l_shipmode_prf#3649,l_shipinstruct_prf#3650,l_quantity_prf#3651,l_receiptdate_prf#3652,l_linenumber_prf#3653,l_tax_prf#3654,l_shipdate_prf#3655,l_extendedprice_prf#3656,l_partkey_prf#3657,l_discount_prf#3658,l_partkey_and_l_suppkey_prf#3659,l_commitdate_prf#3660,l_suppkey_prf#3661,l_orderkey_prf#3662] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3682]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1507,value#1508] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 197547ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/15 02:49:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:49:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3734L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/15 02:49:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3734L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#3746]
         :  :  :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#3741: string
         :  :  :     :- Project [rid#3736 AS rid_0#3741, n_regionkey_prf#3737 AS n_regionkey_prf_0#3742, n_nationkey_prf#3738 AS n_nationkey_prf_0#3743, n_name_prf#3739 AS n_name_prf_0#3744, n_comment_prf#3740 AS n_comment_prf_0#3745]
         :  :  :     :  +- Relation[rid#3736,n_regionkey_prf#3737,n_nationkey_prf#3738,n_name_prf#3739,n_comment_prf#3740] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#3747 AS s_phone_prf_1#3755, rid#3748 AS rid_1#3756, s_address_prf#3749 AS s_address_prf_1#3757, s_nationkey_prf#3750 AS s_nationkey_prf_1#3758, s_suppkey_prf#3751 AS s_suppkey_prf_1#3759, s_name_prf#3752 AS s_name_prf_1#3760, s_acctbal_prf#3753 AS s_acctbal_prf_1#3761, s_comment_prf#3754 AS s_comment_prf_1#3762]
         :  :     +- Relation[s_phone_prf#3747,rid#3748,s_address_prf#3749,s_nationkey_prf#3750,s_suppkey_prf#3751,s_name_prf#3752,s_acctbal_prf#3753,s_comment_prf#3754] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1511) AS rid_2#3769]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3768]
         :        :  +- Relation[rid#3763,n_regionkey_prf#3764,n_nationkey_prf#3765,n_name_prf#3766,n_comment_prf#3767] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3770 AS c_acctbal_prf_2#3779, rid#3771 AS rid_2#3780, c_name_prf#3772 AS c_name_prf_2#3781, c_nationkey_prf#3773 AS c_nationkey_prf_2#3782, c_custkey_prf#3774 AS c_custkey_prf_2#3783, c_comment_prf#3775 AS c_comment_prf_2#3784, c_address_prf#3776 AS c_address_prf_2#3785, c_mktsegment_prf#3777 AS c_mktsegment_prf_2#3786, c_phone_prf#3778 AS c_phone_prf_2#3787]
            +- Relation[c_acctbal_prf#3770,rid#3771,c_name_prf#3772,c_nationkey_prf#3773,c_custkey_prf#3774,c_comment_prf#3775,c_address_prf#3776,c_mktsegment_prf#3777,c_phone_prf#3778] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 20189ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/15 02:49:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:49:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3846L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 02:49:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3846L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_2#3866]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3858: string
         :     :- Project [c_acctbal_prf#3848 AS c_acctbal_prf_0#3857, rid#3849 AS rid_0#3858, c_name_prf#3850 AS c_name_prf_0#3859, c_nationkey_prf#3851 AS c_nationkey_prf_0#3860, c_custkey_prf#3852 AS c_custkey_prf_0#3861, c_comment_prf#3853 AS c_comment_prf_0#3862, c_address_prf#3854 AS c_address_prf_0#3863, c_mktsegment_prf#3855 AS c_mktsegment_prf_0#3864, c_phone_prf#3856 AS c_phone_prf_0#3865]
         :     :  +- Relation[c_acctbal_prf#3848,rid#3849,c_name_prf#3850,c_nationkey_prf#3851,c_custkey_prf#3852,c_comment_prf#3853,c_address_prf#3854,c_mktsegment_prf#3855,c_phone_prf#3856] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#3905]
            :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_1#3890: string
            :     :- Project [l_returnflag_prf#3867 AS l_returnflag_prf_1#3886, l_orderkey_and_l_linenumber_prf#3868 AS l_orderkey_and_l_linenumber_prf_1#3887, l_comment_prf#3869 AS l_comment_prf_1#3888, l_linestatus_prf#3870 AS l_linestatus_prf_1#3889, rid#3871 AS rid_1#3890, l_shipmode_prf#3872 AS l_shipmode_prf_1#3891, l_shipinstruct_prf#3873 AS l_shipinstruct_prf_1#3892, l_quantity_prf#3874 AS l_quantity_prf_1#3893, l_receiptdate_prf#3875 AS l_receiptdate_prf_1#3894, l_linenumber_prf#3876 AS l_linenumber_prf_1#3895, l_tax_prf#3877 AS l_tax_prf_1#3896, l_shipdate_prf#3878 AS l_shipdate_prf_1#3897, l_extendedprice_prf#3879 AS l_extendedprice_prf_1#3898, l_partkey_prf#3880 AS l_partkey_prf_1#3899, l_discount_prf#3881 AS l_discount_prf_1#3900, l_partkey_and_l_suppkey_prf#3882 AS l_partkey_and_l_suppkey_prf_1#3901, l_commitdate_prf#3883 AS l_commitdate_prf_1#3902, l_suppkey_prf#3884 AS l_suppkey_prf_1#3903, l_orderkey_prf#3885 AS l_orderkey_prf_1#3904]
            :     :  +- Relation[l_returnflag_prf#3867,l_orderkey_and_l_linenumber_prf#3868,l_comment_prf#3869,l_linestatus_prf#3870,rid#3871,l_shipmode_prf#3872,l_shipinstruct_prf#3873,l_quantity_prf#3874,l_receiptdate_prf#3875,l_linenumber_prf#3876,l_tax_prf#3877,l_shipdate_prf#3878,l_extendedprice_prf#3879,l_partkey_prf#3880,l_discount_prf#3881,l_partkey_and_l_suppkey_prf#3882,l_commitdate_prf#3883,l_suppkey_prf#3884,l_orderkey_prf#3885] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3906 AS o_shippriority_prf_2#3916, rid#3907 AS rid_2#3917, o_orderdate_prf#3908 AS o_orderdate_prf_2#3918, o_custkey_prf#3909 AS o_custkey_prf_2#3919, o_orderpriority_prf#3910 AS o_orderpriority_prf_2#3920, o_clerk_prf#3911 AS o_clerk_prf_2#3921, o_orderstatus_prf#3912 AS o_orderstatus_prf_2#3922, o_totalprice_prf#3913 AS o_totalprice_prf_2#3923, o_orderkey_prf#3914 AS o_orderkey_prf_2#3924, o_comment_prf#3915 AS o_comment_prf_2#3925]
               +- Relation[o_shippriority_prf#3906,rid#3907,o_orderdate_prf#3908,o_custkey_prf#3909,o_orderpriority_prf#3910,o_clerk_prf#3911,o_orderstatus_prf#3912,o_totalprice_prf#3913,o_orderkey_prf#3914,o_comment_prf#3915] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 157016ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/15 02:52:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:52:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3976L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 02:52:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3976L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#3978 AS p_comment_prf_0#3988, p_name_prf#3979 AS p_name_prf_0#3989, rid#3980 AS rid_0#3990, p_type_prf#3981 AS p_type_prf_0#3991, p_retailprice_prf#3982 AS p_retailprice_prf_0#3992, p_mfgr_prf#3983 AS p_mfgr_prf_0#3993, p_container_prf#3984 AS p_container_prf_0#3994, p_brand_prf#3985 AS p_brand_prf_0#3995, p_size_prf#3986 AS p_size_prf_0#3996, p_partkey_prf#3987 AS p_partkey_prf_0#3997]
         :  +- Relation[p_comment_prf#3978,p_name_prf#3979,rid#3980,p_type_prf#3981,p_retailprice_prf#3982,p_mfgr_prf#3983,p_container_prf#3984,p_brand_prf#3985,p_size_prf#3986,p_partkey_prf#3987] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3998]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1507,value#1508] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1451
Elapsed time: 86ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/15 02:52:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:52:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4019L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/15 02:52:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4019L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4029]
         :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#4028: string
         :     :- Project [r_regionkey_prf#4021 AS r_regionkey_prf_0#4025, r_name_prf#4022 AS r_name_prf_0#4026, r_comment_prf#4023 AS r_comment_prf_0#4027, rid#4024 AS rid_0#4028]
         :     :  +- Relation[r_regionkey_prf#4021,r_name_prf#4022,r_comment_prf#4023,rid#4024] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#4030 AS rid_1#4035, n_regionkey_prf#4031 AS n_regionkey_prf_1#4036, n_nationkey_prf#4032 AS n_nationkey_prf_1#4037, n_name_prf#4033 AS n_name_prf_1#4038, n_comment_prf#4034 AS n_comment_prf_1#4039]
            +- Relation[rid#4030,n_regionkey_prf#4031,n_nationkey_prf#4032,n_name_prf#4033,n_comment_prf#4034] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=25
Elapsed time: 65ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/15 02:52:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:52:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4068L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 02:52:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4068L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#4070 AS l_returnflag_prf_0#4089, l_orderkey_and_l_linenumber_prf#4071 AS l_orderkey_and_l_linenumber_prf_0#4090, l_comment_prf#4072 AS l_comment_prf_0#4091, l_linestatus_prf#4073 AS l_linestatus_prf_0#4092, rid#4074 AS rid_0#4093, l_shipmode_prf#4075 AS l_shipmode_prf_0#4094, l_shipinstruct_prf#4076 AS l_shipinstruct_prf_0#4095, l_quantity_prf#4077 AS l_quantity_prf_0#4096, l_receiptdate_prf#4078 AS l_receiptdate_prf_0#4097, l_linenumber_prf#4079 AS l_linenumber_prf_0#4098, l_tax_prf#4080 AS l_tax_prf_0#4099, l_shipdate_prf#4081 AS l_shipdate_prf_0#4100, l_extendedprice_prf#4082 AS l_extendedprice_prf_0#4101, l_partkey_prf#4083 AS l_partkey_prf_0#4102, l_discount_prf#4084 AS l_discount_prf_0#4103, l_partkey_and_l_suppkey_prf#4085 AS l_partkey_and_l_suppkey_prf_0#4104, l_commitdate_prf#4086 AS l_commitdate_prf_0#4105, l_suppkey_prf#4087 AS l_suppkey_prf_0#4106, l_orderkey_prf#4088 AS l_orderkey_prf_0#4107]
         :  +- Relation[l_returnflag_prf#4070,l_orderkey_and_l_linenumber_prf#4071,l_comment_prf#4072,l_linestatus_prf#4073,rid#4074,l_shipmode_prf#4075,l_shipinstruct_prf#4076,l_quantity_prf#4077,l_receiptdate_prf#4078,l_linenumber_prf#4079,l_tax_prf#4080,l_shipdate_prf#4081,l_extendedprice_prf#4082,l_partkey_prf#4083,l_discount_prf#4084,l_partkey_and_l_suppkey_prf#4085,l_commitdate_prf#4086,l_suppkey_prf#4087,l_orderkey_prf#4088] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4108]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1507,value#1508] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 23478ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/15 02:52:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:52:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4142L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 02:52:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4142L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4154]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#4149: string
         :     :- Project [rid#4144 AS rid_0#4149, n_regionkey_prf#4145 AS n_regionkey_prf_0#4150, n_nationkey_prf#4146 AS n_nationkey_prf_0#4151, n_name_prf#4147 AS n_name_prf_0#4152, n_comment_prf#4148 AS n_comment_prf_0#4153]
         :     :  +- Relation[rid#4144,n_regionkey_prf#4145,n_nationkey_prf#4146,n_name_prf#4147,n_comment_prf#4148] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4155 AS s_phone_prf_1#4163, rid#4156 AS rid_1#4164, s_address_prf#4157 AS s_address_prf_1#4165, s_nationkey_prf#4158 AS s_nationkey_prf_1#4166, s_suppkey_prf#4159 AS s_suppkey_prf_1#4167, s_name_prf#4160 AS s_name_prf_1#4168, s_acctbal_prf#4161 AS s_acctbal_prf_1#4169, s_comment_prf#4162 AS s_comment_prf_1#4170]
            +- Relation[s_phone_prf#4155,rid#4156,s_address_prf#4157,s_nationkey_prf#4158,s_suppkey_prf#4159,s_name_prf#4160,s_acctbal_prf#4161,s_comment_prf#4162] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=10000
Elapsed time: 187ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/15 02:52:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:52:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4219L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 02:52:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4219L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_2#4237]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#4230: string
         :     :- Project [s_phone_prf#4221 AS s_phone_prf_0#4229, rid#4222 AS rid_0#4230, s_address_prf#4223 AS s_address_prf_0#4231, s_nationkey_prf#4224 AS s_nationkey_prf_0#4232, s_suppkey_prf#4225 AS s_suppkey_prf_0#4233, s_name_prf#4226 AS s_name_prf_0#4234, s_acctbal_prf#4227 AS s_acctbal_prf_0#4235, s_comment_prf#4228 AS s_comment_prf_0#4236]
         :     :  +- Relation[s_phone_prf#4221,rid#4222,s_address_prf#4223,s_nationkey_prf#4224,s_suppkey_prf#4225,s_name_prf#4226,s_acctbal_prf#4227,s_comment_prf#4228] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#4258]
            :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#4250: string
            :     :- Project [p_comment_prf#4238 AS p_comment_prf_1#4248, p_name_prf#4239 AS p_name_prf_1#4249, rid#4240 AS rid_1#4250, p_type_prf#4241 AS p_type_prf_1#4251, p_retailprice_prf#4242 AS p_retailprice_prf_1#4252, p_mfgr_prf#4243 AS p_mfgr_prf_1#4253, p_container_prf#4244 AS p_container_prf_1#4254, p_brand_prf#4245 AS p_brand_prf_1#4255, p_size_prf#4246 AS p_size_prf_1#4256, p_partkey_prf#4247 AS p_partkey_prf_1#4257]
            :     :  +- Relation[p_comment_prf#4238,p_name_prf#4239,rid#4240,p_type_prf#4241,p_retailprice_prf#4242,p_mfgr_prf#4243,p_container_prf#4244,p_brand_prf#4245,p_size_prf#4246,p_partkey_prf#4247] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4259 AS l_returnflag_prf_2#4278, l_orderkey_and_l_linenumber_prf#4260 AS l_orderkey_and_l_linenumber_prf_2#4279, l_comment_prf#4261 AS l_comment_prf_2#4280, l_linestatus_prf#4262 AS l_linestatus_prf_2#4281, rid#4263 AS rid_2#4282, l_shipmode_prf#4264 AS l_shipmode_prf_2#4283, l_shipinstruct_prf#4265 AS l_shipinstruct_prf_2#4284, l_quantity_prf#4266 AS l_quantity_prf_2#4285, l_receiptdate_prf#4267 AS l_receiptdate_prf_2#4286, l_linenumber_prf#4268 AS l_linenumber_prf_2#4287, l_tax_prf#4269 AS l_tax_prf_2#4288, l_shipdate_prf#4270 AS l_shipdate_prf_2#4289, l_extendedprice_prf#4271 AS l_extendedprice_prf_2#4290, l_partkey_prf#4272 AS l_partkey_prf_2#4291, l_discount_prf#4273 AS l_discount_prf_2#4292, l_partkey_and_l_suppkey_prf#4274 AS l_partkey_and_l_suppkey_prf_2#4293, l_commitdate_prf#4275 AS l_commitdate_prf_2#4294, l_suppkey_prf#4276 AS l_suppkey_prf_2#4295, l_orderkey_prf#4277 AS l_orderkey_prf_2#4296]
               +- Relation[l_returnflag_prf#4259,l_orderkey_and_l_linenumber_prf#4260,l_comment_prf#4261,l_linestatus_prf#4262,rid#4263,l_shipmode_prf#4264,l_shipinstruct_prf#4265,l_quantity_prf#4266,l_receiptdate_prf#4267,l_linenumber_prf#4268,l_tax_prf#4269,l_shipdate_prf#4270,l_extendedprice_prf#4271,l_partkey_prf#4272,l_discount_prf#4273,l_partkey_and_l_suppkey_prf#4274,l_commitdate_prf#4275,l_suppkey_prf#4276,l_orderkey_prf#4277] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 188043ms

f1=
select * from region where r_name = 'EUROPE'
19/10/15 02:56:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:56:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4340L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/15 02:56:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4340L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#4342 AS r_regionkey_prf_0#4346, r_name_prf#4343 AS r_name_prf_0#4347, r_comment_prf#4344 AS r_comment_prf_0#4348, rid#4345 AS rid_0#4349]
         :  +- Relation[r_regionkey_prf#4342,r_name_prf#4343,r_comment_prf#4344,rid#4345] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4350]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1507,value#1508] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 57ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/15 02:56:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:56:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4383L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/15 02:56:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4383L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4423]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4408: string
         :     :- Project [l_returnflag_prf#4385 AS l_returnflag_prf_0#4404, l_orderkey_and_l_linenumber_prf#4386 AS l_orderkey_and_l_linenumber_prf_0#4405, l_comment_prf#4387 AS l_comment_prf_0#4406, l_linestatus_prf#4388 AS l_linestatus_prf_0#4407, rid#4389 AS rid_0#4408, l_shipmode_prf#4390 AS l_shipmode_prf_0#4409, l_shipinstruct_prf#4391 AS l_shipinstruct_prf_0#4410, l_quantity_prf#4392 AS l_quantity_prf_0#4411, l_receiptdate_prf#4393 AS l_receiptdate_prf_0#4412, l_linenumber_prf#4394 AS l_linenumber_prf_0#4413, l_tax_prf#4395 AS l_tax_prf_0#4414, l_shipdate_prf#4396 AS l_shipdate_prf_0#4415, l_extendedprice_prf#4397 AS l_extendedprice_prf_0#4416, l_partkey_prf#4398 AS l_partkey_prf_0#4417, l_discount_prf#4399 AS l_discount_prf_0#4418, l_partkey_and_l_suppkey_prf#4400 AS l_partkey_and_l_suppkey_prf_0#4419, l_commitdate_prf#4401 AS l_commitdate_prf_0#4420, l_suppkey_prf#4402 AS l_suppkey_prf_0#4421, l_orderkey_prf#4403 AS l_orderkey_prf_0#4422]
         :     :  +- Relation[l_returnflag_prf#4385,l_orderkey_and_l_linenumber_prf#4386,l_comment_prf#4387,l_linestatus_prf#4388,rid#4389,l_shipmode_prf#4390,l_shipinstruct_prf#4391,l_quantity_prf#4392,l_receiptdate_prf#4393,l_linenumber_prf#4394,l_tax_prf#4395,l_shipdate_prf#4396,l_extendedprice_prf#4397,l_partkey_prf#4398,l_discount_prf#4399,l_partkey_and_l_suppkey_prf#4400,l_commitdate_prf#4401,l_suppkey_prf#4402,l_orderkey_prf#4403] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4424 AS o_shippriority_prf_1#4434, rid#4425 AS rid_1#4435, o_orderdate_prf#4426 AS o_orderdate_prf_1#4436, o_custkey_prf#4427 AS o_custkey_prf_1#4437, o_orderpriority_prf#4428 AS o_orderpriority_prf_1#4438, o_clerk_prf#4429 AS o_clerk_prf_1#4439, o_orderstatus_prf#4430 AS o_orderstatus_prf_1#4440, o_totalprice_prf#4431 AS o_totalprice_prf_1#4441, o_orderkey_prf#4432 AS o_orderkey_prf_1#4442, o_comment_prf#4433 AS o_comment_prf_1#4443]
            +- Relation[o_shippriority_prf#4424,rid#4425,o_orderdate_prf#4426,o_custkey_prf#4427,o_orderpriority_prf#4428,o_clerk_prf#4429,o_orderstatus_prf#4430,o_totalprice_prf#4431,o_orderkey_prf#4432,o_comment_prf#4433] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 114597ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/15 02:57:56 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:57:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4497L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/15 02:57:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4497L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4519]
         :  :  :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4511: string
         :  :  :     :- Project [p_comment_prf#4499 AS p_comment_prf_0#4509, p_name_prf#4500 AS p_name_prf_0#4510, rid#4501 AS rid_0#4511, p_type_prf#4502 AS p_type_prf_0#4512, p_retailprice_prf#4503 AS p_retailprice_prf_0#4513, p_mfgr_prf#4504 AS p_mfgr_prf_0#4514, p_container_prf#4505 AS p_container_prf_0#4515, p_brand_prf#4506 AS p_brand_prf_0#4516, p_size_prf#4507 AS p_size_prf_0#4517, p_partkey_prf#4508 AS p_partkey_prf_0#4518]
         :  :  :     :  +- Relation[p_comment_prf#4499,p_name_prf#4500,rid#4501,p_type_prf#4502,p_retailprice_prf#4503,p_mfgr_prf#4504,p_container_prf#4505,p_brand_prf#4506,p_size_prf#4507,p_partkey_prf#4508] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#4520 AS ps_partkey_and_ps_suppkey_prf_1#4527, rid#4521 AS rid_1#4528, ps_availqty_prf#4522 AS ps_availqty_prf_1#4529, ps_comment_prf#4523 AS ps_comment_prf_1#4530, ps_partkey_prf#4524 AS ps_partkey_prf_1#4531, ps_supplycost_prf#4525 AS ps_supplycost_prf_1#4532, ps_suppkey_prf#4526 AS ps_suppkey_prf_1#4533]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#4520,rid#4521,ps_availqty_prf#4522,ps_comment_prf#4523,ps_partkey_prf#4524,ps_supplycost_prf#4525,ps_suppkey_prf#4526] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#4542]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4541]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#4534,rid#4535,ps_availqty_prf#4536,ps_comment_prf#4537,ps_partkey_prf#4538,ps_supplycost_prf#4539,ps_suppkey_prf#4540] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4543 AS s_phone_prf_2#4551, rid#4544 AS rid_2#4552, s_address_prf#4545 AS s_address_prf_2#4553, s_nationkey_prf#4546 AS s_nationkey_prf_2#4554, s_suppkey_prf#4547 AS s_suppkey_prf_2#4555, s_name_prf#4548 AS s_name_prf_2#4556, s_acctbal_prf#4549 AS s_acctbal_prf_2#4557, s_comment_prf#4550 AS s_comment_prf_2#4558]
            +- Relation[s_phone_prf#4543,rid#4544,s_address_prf#4545,s_nationkey_prf#4546,s_suppkey_prf#4547,s_name_prf#4548,s_acctbal_prf#4549,s_comment_prf#4550] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 83373ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/15 02:59:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:59:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4599L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/15 02:59:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4599L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4617]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#4610: string
         :     :- Project [s_phone_prf#4601 AS s_phone_prf_0#4609, rid#4602 AS rid_0#4610, s_address_prf#4603 AS s_address_prf_0#4611, s_nationkey_prf#4604 AS s_nationkey_prf_0#4612, s_suppkey_prf#4605 AS s_suppkey_prf_0#4613, s_name_prf#4606 AS s_name_prf_0#4614, s_acctbal_prf#4607 AS s_acctbal_prf_0#4615, s_comment_prf#4608 AS s_comment_prf_0#4616]
         :     :  +- Relation[s_phone_prf#4601,rid#4602,s_address_prf#4603,s_nationkey_prf#4604,s_suppkey_prf#4605,s_name_prf#4606,s_acctbal_prf#4607,s_comment_prf#4608] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4618 AS ps_partkey_and_ps_suppkey_prf_1#4625, rid#4619 AS rid_1#4626, ps_availqty_prf#4620 AS ps_availqty_prf_1#4627, ps_comment_prf#4621 AS ps_comment_prf_1#4628, ps_partkey_prf#4622 AS ps_partkey_prf_1#4629, ps_supplycost_prf#4623 AS ps_supplycost_prf_1#4630, ps_suppkey_prf#4624 AS ps_suppkey_prf_1#4631]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4618,rid#4619,ps_availqty_prf#4620,ps_comment_prf#4621,ps_partkey_prf#4622,ps_supplycost_prf#4623,ps_suppkey_prf#4624] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 11001ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/15 02:59:31 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 02:59:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4671L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/15 02:59:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4671L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_2#4689]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#4682: string
         :     :- Project [s_phone_prf#4673 AS s_phone_prf_0#4681, rid#4674 AS rid_0#4682, s_address_prf#4675 AS s_address_prf_0#4683, s_nationkey_prf#4676 AS s_nationkey_prf_0#4684, s_suppkey_prf#4677 AS s_suppkey_prf_0#4685, s_name_prf#4678 AS s_name_prf_0#4686, s_acctbal_prf#4679 AS s_acctbal_prf_0#4687, s_comment_prf#4680 AS s_comment_prf_0#4688]
         :     :  +- Relation[s_phone_prf#4673,rid#4674,s_address_prf#4675,s_nationkey_prf#4676,s_suppkey_prf#4677,s_name_prf#4678,s_acctbal_prf#4679,s_comment_prf#4680] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#4710]
            :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#4702: string
            :     :- Project [p_comment_prf#4690 AS p_comment_prf_1#4700, p_name_prf#4691 AS p_name_prf_1#4701, rid#4692 AS rid_1#4702, p_type_prf#4693 AS p_type_prf_1#4703, p_retailprice_prf#4694 AS p_retailprice_prf_1#4704, p_mfgr_prf#4695 AS p_mfgr_prf_1#4705, p_container_prf#4696 AS p_container_prf_1#4706, p_brand_prf#4697 AS p_brand_prf_1#4707, p_size_prf#4698 AS p_size_prf_1#4708, p_partkey_prf#4699 AS p_partkey_prf_1#4709]
            :     :  +- Relation[p_comment_prf#4690,p_name_prf#4691,rid#4692,p_type_prf#4693,p_retailprice_prf#4694,p_mfgr_prf#4695,p_container_prf#4696,p_brand_prf#4697,p_size_prf#4698,p_partkey_prf#4699] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#4711 AS ps_partkey_and_ps_suppkey_prf_2#4718, rid#4712 AS rid_2#4719, ps_availqty_prf#4713 AS ps_availqty_prf_2#4720, ps_comment_prf#4714 AS ps_comment_prf_2#4721, ps_partkey_prf#4715 AS ps_partkey_prf_2#4722, ps_supplycost_prf#4716 AS ps_supplycost_prf_2#4723, ps_suppkey_prf#4717 AS ps_suppkey_prf_2#4724]
               +- Relation[ps_partkey_and_ps_suppkey_prf#4711,rid#4712,ps_availqty_prf#4713,ps_comment_prf#4714,ps_partkey_prf#4715,ps_supplycost_prf#4716,ps_suppkey_prf#4717] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 43121ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/15 03:00:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:00:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4778L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 03:00:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4778L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4800]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#4791: string
         :     :- Project [o_shippriority_prf#4780 AS o_shippriority_prf_0#4790, rid#4781 AS rid_0#4791, o_orderdate_prf#4782 AS o_orderdate_prf_0#4792, o_custkey_prf#4783 AS o_custkey_prf_0#4793, o_orderpriority_prf#4784 AS o_orderpriority_prf_0#4794, o_clerk_prf#4785 AS o_clerk_prf_0#4795, o_orderstatus_prf#4786 AS o_orderstatus_prf_0#4796, o_totalprice_prf#4787 AS o_totalprice_prf_0#4797, o_orderkey_prf#4788 AS o_orderkey_prf_0#4798, o_comment_prf#4789 AS o_comment_prf_0#4799]
         :     :  +- Relation[o_shippriority_prf#4780,rid#4781,o_orderdate_prf#4782,o_custkey_prf#4783,o_orderpriority_prf#4784,o_clerk_prf#4785,o_orderstatus_prf#4786,o_totalprice_prf#4787,o_orderkey_prf#4788,o_comment_prf#4789] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4801 AS l_returnflag_prf_1#4820, l_orderkey_and_l_linenumber_prf#4802 AS l_orderkey_and_l_linenumber_prf_1#4821, l_comment_prf#4803 AS l_comment_prf_1#4822, l_linestatus_prf#4804 AS l_linestatus_prf_1#4823, rid#4805 AS rid_1#4824, l_shipmode_prf#4806 AS l_shipmode_prf_1#4825, l_shipinstruct_prf#4807 AS l_shipinstruct_prf_1#4826, l_quantity_prf#4808 AS l_quantity_prf_1#4827, l_receiptdate_prf#4809 AS l_receiptdate_prf_1#4828, l_linenumber_prf#4810 AS l_linenumber_prf_1#4829, l_tax_prf#4811 AS l_tax_prf_1#4830, l_shipdate_prf#4812 AS l_shipdate_prf_1#4831, l_extendedprice_prf#4813 AS l_extendedprice_prf_1#4832, l_partkey_prf#4814 AS l_partkey_prf_1#4833, l_discount_prf#4815 AS l_discount_prf_1#4834, l_partkey_and_l_suppkey_prf#4816 AS l_partkey_and_l_suppkey_prf_1#4835, l_commitdate_prf#4817 AS l_commitdate_prf_1#4836, l_suppkey_prf#4818 AS l_suppkey_prf_1#4837, l_orderkey_prf#4819 AS l_orderkey_prf_1#4838]
            +- Relation[l_returnflag_prf#4801,l_orderkey_and_l_linenumber_prf#4802,l_comment_prf#4803,l_linestatus_prf#4804,rid#4805,l_shipmode_prf#4806,l_shipinstruct_prf#4807,l_quantity_prf#4808,l_receiptdate_prf#4809,l_linenumber_prf#4810,l_tax_prf#4811,l_shipdate_prf#4812,l_extendedprice_prf#4813,l_partkey_prf#4814,l_discount_prf#4815,l_partkey_and_l_suppkey_prf#4816,l_commitdate_prf#4817,l_suppkey_prf#4818,l_orderkey_prf#4819] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 195897ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/15 03:03:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:03:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4904L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/15 03:03:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4904L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#4944]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4929: string
         :     :- Project [l_returnflag_prf#4906 AS l_returnflag_prf_0#4925, l_orderkey_and_l_linenumber_prf#4907 AS l_orderkey_and_l_linenumber_prf_0#4926, l_comment_prf#4908 AS l_comment_prf_0#4927, l_linestatus_prf#4909 AS l_linestatus_prf_0#4928, rid#4910 AS rid_0#4929, l_shipmode_prf#4911 AS l_shipmode_prf_0#4930, l_shipinstruct_prf#4912 AS l_shipinstruct_prf_0#4931, l_quantity_prf#4913 AS l_quantity_prf_0#4932, l_receiptdate_prf#4914 AS l_receiptdate_prf_0#4933, l_linenumber_prf#4915 AS l_linenumber_prf_0#4934, l_tax_prf#4916 AS l_tax_prf_0#4935, l_shipdate_prf#4917 AS l_shipdate_prf_0#4936, l_extendedprice_prf#4918 AS l_extendedprice_prf_0#4937, l_partkey_prf#4919 AS l_partkey_prf_0#4938, l_discount_prf#4920 AS l_discount_prf_0#4939, l_partkey_and_l_suppkey_prf#4921 AS l_partkey_and_l_suppkey_prf_0#4940, l_commitdate_prf#4922 AS l_commitdate_prf_0#4941, l_suppkey_prf#4923 AS l_suppkey_prf_0#4942, l_orderkey_prf#4924 AS l_orderkey_prf_0#4943]
         :     :  +- Relation[l_returnflag_prf#4906,l_orderkey_and_l_linenumber_prf#4907,l_comment_prf#4908,l_linestatus_prf#4909,rid#4910,l_shipmode_prf#4911,l_shipinstruct_prf#4912,l_quantity_prf#4913,l_receiptdate_prf#4914,l_linenumber_prf#4915,l_tax_prf#4916,l_shipdate_prf#4917,l_extendedprice_prf#4918,l_partkey_prf#4919,l_discount_prf#4920,l_partkey_and_l_suppkey_prf#4921,l_commitdate_prf#4922,l_suppkey_prf#4923,l_orderkey_prf#4924] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#4965]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#4956: string
            :     :- Project [o_shippriority_prf#4945 AS o_shippriority_prf_1#4955, rid#4946 AS rid_1#4956, o_orderdate_prf#4947 AS o_orderdate_prf_1#4957, o_custkey_prf#4948 AS o_custkey_prf_1#4958, o_orderpriority_prf#4949 AS o_orderpriority_prf_1#4959, o_clerk_prf#4950 AS o_clerk_prf_1#4960, o_orderstatus_prf#4951 AS o_orderstatus_prf_1#4961, o_totalprice_prf#4952 AS o_totalprice_prf_1#4962, o_orderkey_prf#4953 AS o_orderkey_prf_1#4963, o_comment_prf#4954 AS o_comment_prf_1#4964]
            :     :  +- Relation[o_shippriority_prf#4945,rid#4946,o_orderdate_prf#4947,o_custkey_prf#4948,o_orderpriority_prf#4949,o_clerk_prf#4950,o_orderstatus_prf#4951,o_totalprice_prf#4952,o_orderkey_prf#4953,o_comment_prf#4954] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#4966 AS c_acctbal_prf_2#4975, rid#4967 AS rid_2#4976, c_name_prf#4968 AS c_name_prf_2#4977, c_nationkey_prf#4969 AS c_nationkey_prf_2#4978, c_custkey_prf#4970 AS c_custkey_prf_2#4979, c_comment_prf#4971 AS c_comment_prf_2#4980, c_address_prf#4972 AS c_address_prf_2#4981, c_mktsegment_prf#4973 AS c_mktsegment_prf_2#4982, c_phone_prf#4974 AS c_phone_prf_2#4983]
               +- Relation[c_acctbal_prf#4966,rid#4967,c_name_prf#4968,c_nationkey_prf#4969,c_custkey_prf#4970,c_comment_prf#4971,c_address_prf#4972,c_mktsegment_prf#4973,c_phone_prf#4974] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 148038ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/15 03:05:58 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:05:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5058L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/15 03:05:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5058L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#5098]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#5083: string
         :  :  :     :- Project [l_returnflag_prf#5060 AS l_returnflag_prf_0#5079, l_orderkey_and_l_linenumber_prf#5061 AS l_orderkey_and_l_linenumber_prf_0#5080, l_comment_prf#5062 AS l_comment_prf_0#5081, l_linestatus_prf#5063 AS l_linestatus_prf_0#5082, rid#5064 AS rid_0#5083, l_shipmode_prf#5065 AS l_shipmode_prf_0#5084, l_shipinstruct_prf#5066 AS l_shipinstruct_prf_0#5085, l_quantity_prf#5067 AS l_quantity_prf_0#5086, l_receiptdate_prf#5068 AS l_receiptdate_prf_0#5087, l_linenumber_prf#5069 AS l_linenumber_prf_0#5088, l_tax_prf#5070 AS l_tax_prf_0#5089, l_shipdate_prf#5071 AS l_shipdate_prf_0#5090, l_extendedprice_prf#5072 AS l_extendedprice_prf_0#5091, l_partkey_prf#5073 AS l_partkey_prf_0#5092, l_discount_prf#5074 AS l_discount_prf_0#5093, l_partkey_and_l_suppkey_prf#5075 AS l_partkey_and_l_suppkey_prf_0#5094, l_commitdate_prf#5076 AS l_commitdate_prf_0#5095, l_suppkey_prf#5077 AS l_suppkey_prf_0#5096, l_orderkey_prf#5078 AS l_orderkey_prf_0#5097]
         :  :  :     :  +- Relation[l_returnflag_prf#5060,l_orderkey_and_l_linenumber_prf#5061,l_comment_prf#5062,l_linestatus_prf#5063,rid#5064,l_shipmode_prf#5065,l_shipinstruct_prf#5066,l_quantity_prf#5067,l_receiptdate_prf#5068,l_linenumber_prf#5069,l_tax_prf#5070,l_shipdate_prf#5071,l_extendedprice_prf#5072,l_partkey_prf#5073,l_discount_prf#5074,l_partkey_and_l_suppkey_prf#5075,l_commitdate_prf#5076,l_suppkey_prf#5077,l_orderkey_prf#5078] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#5099 AS o_shippriority_prf_1#5109, rid#5100 AS rid_1#5110, o_orderdate_prf#5101 AS o_orderdate_prf_1#5111, o_custkey_prf#5102 AS o_custkey_prf_1#5112, o_orderpriority_prf#5103 AS o_orderpriority_prf_1#5113, o_clerk_prf#5104 AS o_clerk_prf_1#5114, o_orderstatus_prf#5105 AS o_orderstatus_prf_1#5115, o_totalprice_prf#5106 AS o_totalprice_prf_1#5116, o_orderkey_prf#5107 AS o_orderkey_prf_1#5117, o_comment_prf#5108 AS o_comment_prf_1#5118]
         :  :     +- Relation[o_shippriority_prf#5099,rid#5100,o_orderdate_prf#5101,o_custkey_prf#5102,o_orderpriority_prf#5103,o_clerk_prf#5104,o_orderstatus_prf#5105,o_totalprice_prf#5106,o_orderkey_prf#5107,o_comment_prf#5108] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#5130]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5129]
         :        :  +- Relation[o_shippriority_prf#5119,rid#5120,o_orderdate_prf#5121,o_custkey_prf#5122,o_orderpriority_prf#5123,o_clerk_prf#5124,o_orderstatus_prf#5125,o_totalprice_prf#5126,o_orderkey_prf#5127,o_comment_prf#5128] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#5131 AS c_acctbal_prf_2#5140, rid#5132 AS rid_2#5141, c_name_prf#5133 AS c_name_prf_2#5142, c_nationkey_prf#5134 AS c_nationkey_prf_2#5143, c_custkey_prf#5135 AS c_custkey_prf_2#5144, c_comment_prf#5136 AS c_comment_prf_2#5145, c_address_prf#5137 AS c_address_prf_2#5146, c_mktsegment_prf#5138 AS c_mktsegment_prf_2#5147, c_phone_prf#5139 AS c_phone_prf_2#5148]
            +- Relation[c_acctbal_prf#5131,rid#5132,c_name_prf#5133,c_nationkey_prf#5134,c_custkey_prf#5135,c_comment_prf#5136,c_address_prf#5137,c_mktsegment_prf#5138,c_phone_prf#5139] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 169632ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/15 03:08:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:08:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5213L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 03:08:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5213L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#5231]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#5224: string
         :     :- Project [s_phone_prf#5215 AS s_phone_prf_0#5223, rid#5216 AS rid_0#5224, s_address_prf#5217 AS s_address_prf_0#5225, s_nationkey_prf#5218 AS s_nationkey_prf_0#5226, s_suppkey_prf#5219 AS s_suppkey_prf_0#5227, s_name_prf#5220 AS s_name_prf_0#5228, s_acctbal_prf#5221 AS s_acctbal_prf_0#5229, s_comment_prf#5222 AS s_comment_prf_0#5230]
         :     :  +- Relation[s_phone_prf#5215,rid#5216,s_address_prf#5217,s_nationkey_prf#5218,s_suppkey_prf#5219,s_name_prf#5220,s_acctbal_prf#5221,s_comment_prf#5222] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5232 AS l_returnflag_prf_1#5251, l_orderkey_and_l_linenumber_prf#5233 AS l_orderkey_and_l_linenumber_prf_1#5252, l_comment_prf#5234 AS l_comment_prf_1#5253, l_linestatus_prf#5235 AS l_linestatus_prf_1#5254, rid#5236 AS rid_1#5255, l_shipmode_prf#5237 AS l_shipmode_prf_1#5256, l_shipinstruct_prf#5238 AS l_shipinstruct_prf_1#5257, l_quantity_prf#5239 AS l_quantity_prf_1#5258, l_receiptdate_prf#5240 AS l_receiptdate_prf_1#5259, l_linenumber_prf#5241 AS l_linenumber_prf_1#5260, l_tax_prf#5242 AS l_tax_prf_1#5261, l_shipdate_prf#5243 AS l_shipdate_prf_1#5262, l_extendedprice_prf#5244 AS l_extendedprice_prf_1#5263, l_partkey_prf#5245 AS l_partkey_prf_1#5264, l_discount_prf#5246 AS l_discount_prf_1#5265, l_partkey_and_l_suppkey_prf#5247 AS l_partkey_and_l_suppkey_prf_1#5266, l_commitdate_prf#5248 AS l_commitdate_prf_1#5267, l_suppkey_prf#5249 AS l_suppkey_prf_1#5268, l_orderkey_prf#5250 AS l_orderkey_prf_1#5269]
            +- Relation[l_returnflag_prf#5232,l_orderkey_and_l_linenumber_prf#5233,l_comment_prf#5234,l_linestatus_prf#5235,rid#5236,l_shipmode_prf#5237,l_shipinstruct_prf#5238,l_quantity_prf#5239,l_receiptdate_prf#5240,l_linenumber_prf#5241,l_tax_prf#5242,l_shipdate_prf#5243,l_extendedprice_prf#5244,l_partkey_prf#5245,l_discount_prf#5246,l_partkey_and_l_suppkey_prf#5247,l_commitdate_prf#5248,l_suppkey_prf#5249,l_orderkey_prf#5250] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 86201ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/15 03:10:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:10:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5333L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/15 03:10:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5333L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1511) AS rid_1#5353]
         :  :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#5345: string
         :  :  :     :- Project [c_acctbal_prf#5335 AS c_acctbal_prf_0#5344, rid#5336 AS rid_0#5345, c_name_prf#5337 AS c_name_prf_0#5346, c_nationkey_prf#5338 AS c_nationkey_prf_0#5347, c_custkey_prf#5339 AS c_custkey_prf_0#5348, c_comment_prf#5340 AS c_comment_prf_0#5349, c_address_prf#5341 AS c_address_prf_0#5350, c_mktsegment_prf#5342 AS c_mktsegment_prf_0#5351, c_phone_prf#5343 AS c_phone_prf_0#5352]
         :  :  :     :  +- Relation[c_acctbal_prf#5335,rid#5336,c_name_prf#5337,c_nationkey_prf#5338,c_custkey_prf#5339,c_comment_prf#5340,c_address_prf#5341,c_mktsegment_prf#5342,c_phone_prf#5343] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#5354 AS o_shippriority_prf_1#5364, rid#5355 AS rid_1#5365, o_orderdate_prf#5356 AS o_orderdate_prf_1#5366, o_custkey_prf#5357 AS o_custkey_prf_1#5367, o_orderpriority_prf#5358 AS o_orderpriority_prf_1#5368, o_clerk_prf#5359 AS o_clerk_prf_1#5369, o_orderstatus_prf#5360 AS o_orderstatus_prf_1#5370, o_totalprice_prf#5361 AS o_totalprice_prf_1#5371, o_orderkey_prf#5362 AS o_orderkey_prf_1#5372, o_comment_prf#5363 AS o_comment_prf_1#5373]
         :  :     +- Relation[o_shippriority_prf#5354,rid#5355,o_orderdate_prf#5356,o_custkey_prf#5357,o_orderpriority_prf#5358,o_clerk_prf#5359,o_orderstatus_prf#5360,o_totalprice_prf#5361,o_orderkey_prf#5362,o_comment_prf#5363] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1511) AS rid_2#5385]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5384]
         :        :  +- Relation[o_shippriority_prf#5374,rid#5375,o_orderdate_prf#5376,o_custkey_prf#5377,o_orderpriority_prf#5378,o_clerk_prf#5379,o_orderstatus_prf#5380,o_totalprice_prf#5381,o_orderkey_prf#5382,o_comment_prf#5383] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1510,value#1511] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5386 AS l_returnflag_prf_2#5405, l_orderkey_and_l_linenumber_prf#5387 AS l_orderkey_and_l_linenumber_prf_2#5406, l_comment_prf#5388 AS l_comment_prf_2#5407, l_linestatus_prf#5389 AS l_linestatus_prf_2#5408, rid#5390 AS rid_2#5409, l_shipmode_prf#5391 AS l_shipmode_prf_2#5410, l_shipinstruct_prf#5392 AS l_shipinstruct_prf_2#5411, l_quantity_prf#5393 AS l_quantity_prf_2#5412, l_receiptdate_prf#5394 AS l_receiptdate_prf_2#5413, l_linenumber_prf#5395 AS l_linenumber_prf_2#5414, l_tax_prf#5396 AS l_tax_prf_2#5415, l_shipdate_prf#5397 AS l_shipdate_prf_2#5416, l_extendedprice_prf#5398 AS l_extendedprice_prf_2#5417, l_partkey_prf#5399 AS l_partkey_prf_2#5418, l_discount_prf#5400 AS l_discount_prf_2#5419, l_partkey_and_l_suppkey_prf#5401 AS l_partkey_and_l_suppkey_prf_2#5420, l_commitdate_prf#5402 AS l_commitdate_prf_2#5421, l_suppkey_prf#5403 AS l_suppkey_prf_2#5422, l_orderkey_prf#5404 AS l_orderkey_prf_2#5423]
            +- Relation[l_returnflag_prf#5386,l_orderkey_and_l_linenumber_prf#5387,l_comment_prf#5388,l_linestatus_prf#5389,rid#5390,l_shipmode_prf#5391,l_shipinstruct_prf#5392,l_quantity_prf#5393,l_receiptdate_prf#5394,l_linenumber_prf#5395,l_tax_prf#5396,l_shipdate_prf#5397,l_extendedprice_prf#5398,l_partkey_prf#5399,l_discount_prf#5400,l_partkey_and_l_suppkey_prf#5401,l_commitdate_prf#5402,l_suppkey_prf#5403,l_orderkey_prf#5404] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 232977ms

f2=
select * from part where p_size = 15
19/10/15 03:14:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/15 03:14:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5474L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/15 03:14:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5474L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#5476 AS p_comment_prf_0#5486, p_name_prf#5477 AS p_name_prf_0#5487, rid#5478 AS rid_0#5488, p_type_prf#5479 AS p_type_prf_0#5489, p_retailprice_prf#5480 AS p_retailprice_prf_0#5490, p_mfgr_prf#5481 AS p_mfgr_prf_0#5491, p_container_prf#5482 AS p_container_prf_0#5492, p_brand_prf#5483 AS p_brand_prf_0#5493, p_size_prf#5484 AS p_size_prf_0#5494, p_partkey_prf#5485 AS p_partkey_prf_0#5495]
         :  +- Relation[p_comment_prf#5476,p_name_prf#5477,rid#5478,p_type_prf#5479,p_retailprice_prf#5480,p_mfgr_prf#5481,p_container_prf#5482,p_brand_prf#5483,p_size_prf#5484,p_partkey_prf#5485] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#5496]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1507,value#1508] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3907
Elapsed time: 129ms
query=b1a, count=15628, duration=635
query=b1b, count=15628, duration=49375
query=b2a, count=1478870, duration=197547
query=b2b, count=1478870, duration=54414
query=f1, count=1, duration=57
query=f2, count=3907, duration=129
query=f3, count=1451, duration=86
query=f4, count=1, duration=55
query=f5, count=1478870, duration=23478
query=f6, count=857401, duration=13701
query=j1, count=800000, duration=31563
query=j10, count=6001215, duration=86201
query=j2, count=800000, duration=11001
query=j3, count=25, duration=65
query=j4, count=150000, duration=1939
query=j5, count=10000, duration=187
query=j6, count=6001215, duration=116563
query=j7, count=1500000, duration=40334
query=j8, count=6001215, duration=195897
query=j8b, count=6001215, duration=114597
query=j9, count=6001215, duration=94282
query=j9b, count=6001215, duration=117045
query=r1a, count=6001215, duration=169632
query=r1b, count=6001215, duration=148038
query=r1c, count=6001215, duration=157454
query=r1d, count=6001215, duration=232977
query=r1e, count=6001215, duration=233949
query=r1f, count=6001215, duration=157016
query=t1a, count=60000414, duration=30080
query=t1b, count=60000414, duration=20189
query=t1c, count=60000414, duration=88700
query=t2a, count=800000, duration=105591
query=t2b, count=800000, duration=83373
query=t2c, count=800000, duration=43121
query=t2d, count=800000, duration=61404
query=t3a, count=6001215, duration=222169
query=t3b, count=6001215, duration=198038
query=t3c, count=6001215, duration=188043
query=t3d, count=6001215, duration=186674
