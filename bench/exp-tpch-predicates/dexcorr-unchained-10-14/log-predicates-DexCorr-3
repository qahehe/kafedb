19/10/14 21:25:28 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7139ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Mon Oct 14 21:25:30 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Mon Oct 14 21:25:31 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Mon Oct 14 21:25:31 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Mon Oct 14 21:25:31 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Mon Oct 14 21:25:31 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Mon Oct 14 21:25:34 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Mon Oct 14 21:25:36 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Mon Oct 14 21:25:36 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



j1=
select * from part, partsupp where p_partkey = ps_partkey
19/10/14 21:25:38 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:25:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1485L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 21:25:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1485L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#1509]
         :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#1499: string
         :     :- Project [p_comment_prf#1487 AS p_comment_prf_0#1497, p_name_prf#1488 AS p_name_prf_0#1498, rid#1489 AS rid_0#1499, p_type_prf#1490 AS p_type_prf_0#1500, p_retailprice_prf#1491 AS p_retailprice_prf_0#1501, p_mfgr_prf#1492 AS p_mfgr_prf_0#1502, p_container_prf#1493 AS p_container_prf_0#1503, p_brand_prf#1494 AS p_brand_prf_0#1504, p_size_prf#1495 AS p_size_prf_0#1505, p_partkey_prf#1496 AS p_partkey_prf_0#1506]
         :     :  +- Relation[p_comment_prf#1487,p_name_prf#1488,rid#1489,p_type_prf#1490,p_retailprice_prf#1491,p_mfgr_prf#1492,p_container_prf#1493,p_brand_prf#1494,p_size_prf#1495,p_partkey_prf#1496] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#1510 AS ps_partkey_and_ps_suppkey_prf_1#1517, rid#1511 AS rid_1#1518, ps_availqty_prf#1512 AS ps_availqty_prf_1#1519, ps_comment_prf#1513 AS ps_comment_prf_1#1520, ps_partkey_prf#1514 AS ps_partkey_prf_1#1521, ps_supplycost_prf#1515 AS ps_supplycost_prf_1#1522, ps_suppkey_prf#1516 AS ps_suppkey_prf_1#1523]
            +- Relation[ps_partkey_and_ps_suppkey_prf#1510,rid#1511,ps_availqty_prf#1512,ps_comment_prf#1513,ps_partkey_prf#1514,ps_supplycost_prf#1515,ps_suppkey_prf#1516] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 32008ms

r1a=
select * from lineitem, orders, customer where l_orderkey = o_orderkey and o_custkey = c_custkey
19/10/14 21:26:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:26:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1577L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :- Project [l_orderkey#306L]
         :     :  +- Filter isnotnull(l_orderkey#306L)
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Filter isnotnull(c_custkey#290L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 21:26:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1577L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#1617]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#1602: string
         :  :  :     :- Project [l_returnflag_prf#1579 AS l_returnflag_prf_0#1598, l_orderkey_and_l_linenumber_prf#1580 AS l_orderkey_and_l_linenumber_prf_0#1599, l_comment_prf#1581 AS l_comment_prf_0#1600, l_linestatus_prf#1582 AS l_linestatus_prf_0#1601, rid#1583 AS rid_0#1602, l_shipmode_prf#1584 AS l_shipmode_prf_0#1603, l_shipinstruct_prf#1585 AS l_shipinstruct_prf_0#1604, l_quantity_prf#1586 AS l_quantity_prf_0#1605, l_receiptdate_prf#1587 AS l_receiptdate_prf_0#1606, l_linenumber_prf#1588 AS l_linenumber_prf_0#1607, l_tax_prf#1589 AS l_tax_prf_0#1608, l_shipdate_prf#1590 AS l_shipdate_prf_0#1609, l_extendedprice_prf#1591 AS l_extendedprice_prf_0#1610, l_partkey_prf#1592 AS l_partkey_prf_0#1611, l_discount_prf#1593 AS l_discount_prf_0#1612, l_partkey_and_l_suppkey_prf#1594 AS l_partkey_and_l_suppkey_prf_0#1613, l_commitdate_prf#1595 AS l_commitdate_prf_0#1614, l_suppkey_prf#1596 AS l_suppkey_prf_0#1615, l_orderkey_prf#1597 AS l_orderkey_prf_0#1616]
         :  :  :     :  +- Relation[l_returnflag_prf#1579,l_orderkey_and_l_linenumber_prf#1580,l_comment_prf#1581,l_linestatus_prf#1582,rid#1583,l_shipmode_prf#1584,l_shipinstruct_prf#1585,l_quantity_prf#1586,l_receiptdate_prf#1587,l_linenumber_prf#1588,l_tax_prf#1589,l_shipdate_prf#1590,l_extendedprice_prf#1591,l_partkey_prf#1592,l_discount_prf#1593,l_partkey_and_l_suppkey_prf#1594,l_commitdate_prf#1595,l_suppkey_prf#1596,l_orderkey_prf#1597] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#1618 AS o_shippriority_prf_1#1628, rid#1619 AS rid_1#1629, o_orderdate_prf#1620 AS o_orderdate_prf_1#1630, o_custkey_prf#1621 AS o_custkey_prf_1#1631, o_orderpriority_prf#1622 AS o_orderpriority_prf_1#1632, o_clerk_prf#1623 AS o_clerk_prf_1#1633, o_orderstatus_prf#1624 AS o_orderstatus_prf_1#1634, o_totalprice_prf#1625 AS o_totalprice_prf_1#1635, o_orderkey_prf#1626 AS o_orderkey_prf_1#1636, o_comment_prf#1627 AS o_comment_prf_1#1637]
         :  :     +- Relation[o_shippriority_prf#1618,rid#1619,o_orderdate_prf#1620,o_custkey_prf#1621,o_orderpriority_prf#1622,o_clerk_prf#1623,o_orderstatus_prf#1624,o_totalprice_prf#1625,o_orderkey_prf#1626,o_comment_prf#1627] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1508) AS rid_2#1649]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#1648]
         :        :  +- Relation[o_shippriority_prf#1638,rid#1639,o_orderdate_prf#1640,o_custkey_prf#1641,o_orderpriority_prf#1642,o_clerk_prf#1643,o_orderstatus_prf#1644,o_totalprice_prf#1645,o_orderkey_prf#1646,o_comment_prf#1647] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#1650 AS c_acctbal_prf_2#1659, rid#1651 AS rid_2#1660, c_name_prf#1652 AS c_name_prf_2#1661, c_nationkey_prf#1653 AS c_nationkey_prf_2#1662, c_custkey_prf#1654 AS c_custkey_prf_2#1663, c_comment_prf#1655 AS c_comment_prf_2#1664, c_address_prf#1656 AS c_address_prf_2#1665, c_mktsegment_prf#1657 AS c_mktsegment_prf_2#1666, c_phone_prf#1658 AS c_phone_prf_2#1667]
            +- Relation[c_acctbal_prf#1650,rid#1651,c_name_prf#1652,c_nationkey_prf#1653,c_custkey_prf#1654,c_comment_prf#1655,c_address_prf#1656,c_mktsegment_prf#1657,c_phone_prf#1658] JDBCRelation(customer_prf) [numPartitions=1]

19/10/14 21:26:10 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=6001215
Elapsed time: 170422ms

f5=
select * from lineitem where l_returnflag = 'R'
19/10/14 21:29:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:29:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1725L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_returnflag#314) && (l_returnflag#314 = R))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 21:29:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1725L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#1727 AS l_returnflag_prf_0#1746, l_orderkey_and_l_linenumber_prf#1728 AS l_orderkey_and_l_linenumber_prf_0#1747, l_comment_prf#1729 AS l_comment_prf_0#1748, l_linestatus_prf#1730 AS l_linestatus_prf_0#1749, rid#1731 AS rid_0#1750, l_shipmode_prf#1732 AS l_shipmode_prf_0#1751, l_shipinstruct_prf#1733 AS l_shipinstruct_prf_0#1752, l_quantity_prf#1734 AS l_quantity_prf_0#1753, l_receiptdate_prf#1735 AS l_receiptdate_prf_0#1754, l_linenumber_prf#1736 AS l_linenumber_prf_0#1755, l_tax_prf#1737 AS l_tax_prf_0#1756, l_shipdate_prf#1738 AS l_shipdate_prf_0#1757, l_extendedprice_prf#1739 AS l_extendedprice_prf_0#1758, l_partkey_prf#1740 AS l_partkey_prf_0#1759, l_discount_prf#1741 AS l_discount_prf_0#1760, l_partkey_and_l_suppkey_prf#1742 AS l_partkey_and_l_suppkey_prf_0#1761, l_commitdate_prf#1743 AS l_commitdate_prf_0#1762, l_suppkey_prf#1744 AS l_suppkey_prf_0#1763, l_orderkey_prf#1745 AS l_orderkey_prf_0#1764]
         :  +- Relation[l_returnflag_prf#1727,l_orderkey_and_l_linenumber_prf#1728,l_comment_prf#1729,l_linestatus_prf#1730,rid#1731,l_shipmode_prf#1732,l_shipinstruct_prf#1733,l_quantity_prf#1734,l_receiptdate_prf#1735,l_linenumber_prf#1736,l_tax_prf#1737,l_shipdate_prf#1738,l_extendedprice_prf#1739,l_partkey_prf#1740,l_discount_prf#1741,l_partkey_and_l_suppkey_prf#1742,l_commitdate_prf#1743,l_suppkey_prf#1744,l_orderkey_prf#1745] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1767]
            +- DexRidFilter lineitem~l_returnflag~R
               +- Relation[label#1765,value#1766] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 23470ms

j10=
select * from supplier, lineitem where s_suppkey = l_suppkey
19/10/14 21:29:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:29:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1813L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Filter isnotnull(l_suppkey#308L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 21:29:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1813L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#1831]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#1824: string
         :     :- Project [s_phone_prf#1815 AS s_phone_prf_0#1823, rid#1816 AS rid_0#1824, s_address_prf#1817 AS s_address_prf_0#1825, s_nationkey_prf#1818 AS s_nationkey_prf_0#1826, s_suppkey_prf#1819 AS s_suppkey_prf_0#1827, s_name_prf#1820 AS s_name_prf_0#1828, s_acctbal_prf#1821 AS s_acctbal_prf_0#1829, s_comment_prf#1822 AS s_comment_prf_0#1830]
         :     :  +- Relation[s_phone_prf#1815,rid#1816,s_address_prf#1817,s_nationkey_prf#1818,s_suppkey_prf#1819,s_name_prf#1820,s_acctbal_prf#1821,s_comment_prf#1822] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#1832 AS l_returnflag_prf_1#1851, l_orderkey_and_l_linenumber_prf#1833 AS l_orderkey_and_l_linenumber_prf_1#1852, l_comment_prf#1834 AS l_comment_prf_1#1853, l_linestatus_prf#1835 AS l_linestatus_prf_1#1854, rid#1836 AS rid_1#1855, l_shipmode_prf#1837 AS l_shipmode_prf_1#1856, l_shipinstruct_prf#1838 AS l_shipinstruct_prf_1#1857, l_quantity_prf#1839 AS l_quantity_prf_1#1858, l_receiptdate_prf#1840 AS l_receiptdate_prf_1#1859, l_linenumber_prf#1841 AS l_linenumber_prf_1#1860, l_tax_prf#1842 AS l_tax_prf_1#1861, l_shipdate_prf#1843 AS l_shipdate_prf_1#1862, l_extendedprice_prf#1844 AS l_extendedprice_prf_1#1863, l_partkey_prf#1845 AS l_partkey_prf_1#1864, l_discount_prf#1846 AS l_discount_prf_1#1865, l_partkey_and_l_suppkey_prf#1847 AS l_partkey_and_l_suppkey_prf_1#1866, l_commitdate_prf#1848 AS l_commitdate_prf_1#1867, l_suppkey_prf#1849 AS l_suppkey_prf_1#1868, l_orderkey_prf#1850 AS l_orderkey_prf_1#1869]
            +- Relation[l_returnflag_prf#1832,l_orderkey_and_l_linenumber_prf#1833,l_comment_prf#1834,l_linestatus_prf#1835,rid#1836,l_shipmode_prf#1837,l_shipinstruct_prf#1838,l_quantity_prf#1839,l_receiptdate_prf#1840,l_linenumber_prf#1841,l_tax_prf#1842,l_shipdate_prf#1843,l_extendedprice_prf#1844,l_partkey_prf#1845,l_discount_prf#1846,l_partkey_and_l_suppkey_prf#1847,l_commitdate_prf#1848,l_suppkey_prf#1849,l_orderkey_prf#1850] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 86752ms

f2=
select * from part where p_size = 15
19/10/14 21:30:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:30:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1909L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_size#364) && (p_size#364 = 15))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 21:30:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1909L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#1911 AS p_comment_prf_0#1921, p_name_prf#1912 AS p_name_prf_0#1922, rid#1913 AS rid_0#1923, p_type_prf#1914 AS p_type_prf_0#1924, p_retailprice_prf#1915 AS p_retailprice_prf_0#1925, p_mfgr_prf#1916 AS p_mfgr_prf_0#1926, p_container_prf#1917 AS p_container_prf_0#1927, p_brand_prf#1918 AS p_brand_prf_0#1928, p_size_prf#1919 AS p_size_prf_0#1929, p_partkey_prf#1920 AS p_partkey_prf_0#1930]
         :  +- Relation[p_comment_prf#1911,p_name_prf#1912,rid#1913,p_type_prf#1914,p_retailprice_prf#1915,p_mfgr_prf#1916,p_container_prf#1917,p_brand_prf#1918,p_size_prf#1919,p_partkey_prf#1920] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1931]
            +- DexRidFilter part~p_size~15
               +- Relation[label#1765,value#1766] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=3907
Elapsed time: 135ms

f6=
select * from lineitem where l_shipmode = 'MAIL'
19/10/14 21:30:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:30:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1961L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(l_shipmode#319) && (l_shipmode#319 = MAIL))
         +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 21:30:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1961L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [l_returnflag_prf#1963 AS l_returnflag_prf_0#1982, l_orderkey_and_l_linenumber_prf#1964 AS l_orderkey_and_l_linenumber_prf_0#1983, l_comment_prf#1965 AS l_comment_prf_0#1984, l_linestatus_prf#1966 AS l_linestatus_prf_0#1985, rid#1967 AS rid_0#1986, l_shipmode_prf#1968 AS l_shipmode_prf_0#1987, l_shipinstruct_prf#1969 AS l_shipinstruct_prf_0#1988, l_quantity_prf#1970 AS l_quantity_prf_0#1989, l_receiptdate_prf#1971 AS l_receiptdate_prf_0#1990, l_linenumber_prf#1972 AS l_linenumber_prf_0#1991, l_tax_prf#1973 AS l_tax_prf_0#1992, l_shipdate_prf#1974 AS l_shipdate_prf_0#1993, l_extendedprice_prf#1975 AS l_extendedprice_prf_0#1994, l_partkey_prf#1976 AS l_partkey_prf_0#1995, l_discount_prf#1977 AS l_discount_prf_0#1996, l_partkey_and_l_suppkey_prf#1978 AS l_partkey_and_l_suppkey_prf_0#1997, l_commitdate_prf#1979 AS l_commitdate_prf_0#1998, l_suppkey_prf#1980 AS l_suppkey_prf_0#1999, l_orderkey_prf#1981 AS l_orderkey_prf_0#2000]
         :  +- Relation[l_returnflag_prf#1963,l_orderkey_and_l_linenumber_prf#1964,l_comment_prf#1965,l_linestatus_prf#1966,rid#1967,l_shipmode_prf#1968,l_shipinstruct_prf#1969,l_quantity_prf#1970,l_receiptdate_prf#1971,l_linenumber_prf#1972,l_tax_prf#1973,l_shipdate_prf#1974,l_extendedprice_prf#1975,l_partkey_prf#1976,l_discount_prf#1977,l_partkey_and_l_suppkey_prf#1978,l_commitdate_prf#1979,l_suppkey_prf#1980,l_orderkey_prf#1981] JDBCRelation(lineitem_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2001]
            +- DexRidFilter lineitem~l_shipmode~MAIL
               +- Relation[label#1765,value#1766] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 13719ms

t2c=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/14 21:31:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:31:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2045L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
                     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 21:31:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2045L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_2#2063]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#2056: string
         :     :- Project [s_phone_prf#2047 AS s_phone_prf_0#2055, rid#2048 AS rid_0#2056, s_address_prf#2049 AS s_address_prf_0#2057, s_nationkey_prf#2050 AS s_nationkey_prf_0#2058, s_suppkey_prf#2051 AS s_suppkey_prf_0#2059, s_name_prf#2052 AS s_name_prf_0#2060, s_acctbal_prf#2053 AS s_acctbal_prf_0#2061, s_comment_prf#2054 AS s_comment_prf_0#2062]
         :     :  +- Relation[s_phone_prf#2047,rid#2048,s_address_prf#2049,s_nationkey_prf#2050,s_suppkey_prf#2051,s_name_prf#2052,s_acctbal_prf#2053,s_comment_prf#2054] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1508) AS rid_2#2084]
            :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_1#2076: string
            :     :- Project [p_comment_prf#2064 AS p_comment_prf_1#2074, p_name_prf#2065 AS p_name_prf_1#2075, rid#2066 AS rid_1#2076, p_type_prf#2067 AS p_type_prf_1#2077, p_retailprice_prf#2068 AS p_retailprice_prf_1#2078, p_mfgr_prf#2069 AS p_mfgr_prf_1#2079, p_container_prf#2070 AS p_container_prf_1#2080, p_brand_prf#2071 AS p_brand_prf_1#2081, p_size_prf#2072 AS p_size_prf_1#2082, p_partkey_prf#2073 AS p_partkey_prf_1#2083]
            :     :  +- Relation[p_comment_prf#2064,p_name_prf#2065,rid#2066,p_type_prf#2067,p_retailprice_prf#2068,p_mfgr_prf#2069,p_container_prf#2070,p_brand_prf#2071,p_size_prf#2072,p_partkey_prf#2073] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#2085 AS ps_partkey_and_ps_suppkey_prf_2#2092, rid#2086 AS rid_2#2093, ps_availqty_prf#2087 AS ps_availqty_prf_2#2094, ps_comment_prf#2088 AS ps_comment_prf_2#2095, ps_partkey_prf#2089 AS ps_partkey_prf_2#2096, ps_supplycost_prf#2090 AS ps_supplycost_prf_2#2097, ps_suppkey_prf#2091 AS ps_suppkey_prf_2#2098]
               +- Relation[ps_partkey_and_ps_suppkey_prf#2085,rid#2086,ps_availqty_prf#2087,ps_comment_prf#2088,ps_partkey_prf#2089,ps_supplycost_prf#2090,ps_suppkey_prf#2091] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 42847ms

t3d=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/14 21:31:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:31:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2159L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (l_partkey#307L = p_partkey#360L)
               :- Project [l_partkey#307L, l_suppkey#308L]
               :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 21:31:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2159L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#2177]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#2170: string
         :     :- Project [s_phone_prf#2161 AS s_phone_prf_0#2169, rid#2162 AS rid_0#2170, s_address_prf#2163 AS s_address_prf_0#2171, s_nationkey_prf#2164 AS s_nationkey_prf_0#2172, s_suppkey_prf#2165 AS s_suppkey_prf_0#2173, s_name_prf#2166 AS s_name_prf_0#2174, s_acctbal_prf#2167 AS s_acctbal_prf_0#2175, s_comment_prf#2168 AS s_comment_prf_0#2176]
         :     :  +- Relation[s_phone_prf#2161,rid#2162,s_address_prf#2163,s_nationkey_prf#2164,s_suppkey_prf#2165,s_name_prf#2166,s_acctbal_prf#2167,s_comment_prf#2168] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1508) AS rid_2#2216]
            :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_1#2201: string
            :     :- Project [l_returnflag_prf#2178 AS l_returnflag_prf_1#2197, l_orderkey_and_l_linenumber_prf#2179 AS l_orderkey_and_l_linenumber_prf_1#2198, l_comment_prf#2180 AS l_comment_prf_1#2199, l_linestatus_prf#2181 AS l_linestatus_prf_1#2200, rid#2182 AS rid_1#2201, l_shipmode_prf#2183 AS l_shipmode_prf_1#2202, l_shipinstruct_prf#2184 AS l_shipinstruct_prf_1#2203, l_quantity_prf#2185 AS l_quantity_prf_1#2204, l_receiptdate_prf#2186 AS l_receiptdate_prf_1#2205, l_linenumber_prf#2187 AS l_linenumber_prf_1#2206, l_tax_prf#2188 AS l_tax_prf_1#2207, l_shipdate_prf#2189 AS l_shipdate_prf_1#2208, l_extendedprice_prf#2190 AS l_extendedprice_prf_1#2209, l_partkey_prf#2191 AS l_partkey_prf_1#2210, l_discount_prf#2192 AS l_discount_prf_1#2211, l_partkey_and_l_suppkey_prf#2193 AS l_partkey_and_l_suppkey_prf_1#2212, l_commitdate_prf#2194 AS l_commitdate_prf_1#2213, l_suppkey_prf#2195 AS l_suppkey_prf_1#2214, l_orderkey_prf#2196 AS l_orderkey_prf_1#2215]
            :     :  +- Relation[l_returnflag_prf#2178,l_orderkey_and_l_linenumber_prf#2179,l_comment_prf#2180,l_linestatus_prf#2181,rid#2182,l_shipmode_prf#2183,l_shipinstruct_prf#2184,l_quantity_prf#2185,l_receiptdate_prf#2186,l_linenumber_prf#2187,l_tax_prf#2188,l_shipdate_prf#2189,l_extendedprice_prf#2190,l_partkey_prf#2191,l_discount_prf#2192,l_partkey_and_l_suppkey_prf#2193,l_commitdate_prf#2194,l_suppkey_prf#2195,l_orderkey_prf#2196] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#2217 AS p_comment_prf_2#2227, p_name_prf#2218 AS p_name_prf_2#2228, rid#2219 AS rid_2#2229, p_type_prf#2220 AS p_type_prf_2#2230, p_retailprice_prf#2221 AS p_retailprice_prf_2#2231, p_mfgr_prf#2222 AS p_mfgr_prf_2#2232, p_container_prf#2223 AS p_container_prf_2#2233, p_brand_prf#2224 AS p_brand_prf_2#2234, p_size_prf#2225 AS p_size_prf_2#2235, p_partkey_prf#2226 AS p_partkey_prf_2#2236]
               +- Relation[p_comment_prf#2217,p_name_prf#2218,rid#2219,p_type_prf#2220,p_retailprice_prf#2221,p_mfgr_prf#2222,p_container_prf#2223,p_brand_prf#2224,p_size_prf#2225,p_partkey_prf#2226] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 186697ms

t1c=
select * from supplier, nation, customer where s_nationkey = n_nationkey and c_nationkey = n_nationkey
19/10/14 21:34:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:34:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2296L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Filter isnotnull(c_nationkey#293L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [s_nationkey#21L]
               :  +- Filter isnotnull(s_nationkey#21L)
               :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter isnotnull(n_nationkey#108L)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 21:34:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2296L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_2#2316]
         :  +- DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, rid_0#2308: string
         :     :- Project [c_acctbal_prf#2298 AS c_acctbal_prf_0#2307, rid#2299 AS rid_0#2308, c_name_prf#2300 AS c_name_prf_0#2309, c_nationkey_prf#2301 AS c_nationkey_prf_0#2310, c_custkey_prf#2302 AS c_custkey_prf_0#2311, c_comment_prf#2303 AS c_comment_prf_0#2312, c_address_prf#2304 AS c_address_prf_0#2313, c_mktsegment_prf#2305 AS c_mktsegment_prf_0#2314, c_phone_prf#2306 AS c_phone_prf_0#2315]
         :     :  +- Relation[c_acctbal_prf#2298,rid#2299,c_name_prf#2300,c_nationkey_prf#2301,c_custkey_prf#2302,c_comment_prf#2303,c_address_prf#2304,c_mktsegment_prf#2305,c_phone_prf#2306] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['s_phone_prf_1, 'rid_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1508) AS rid_2#2333]
            :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_1#2326: string
            :     :- Project [s_phone_prf#2317 AS s_phone_prf_1#2325, rid#2318 AS rid_1#2326, s_address_prf#2319 AS s_address_prf_1#2327, s_nationkey_prf#2320 AS s_nationkey_prf_1#2328, s_suppkey_prf#2321 AS s_suppkey_prf_1#2329, s_name_prf#2322 AS s_name_prf_1#2330, s_acctbal_prf#2323 AS s_acctbal_prf_1#2331, s_comment_prf#2324 AS s_comment_prf_1#2332]
            :     :  +- Relation[s_phone_prf#2317,rid#2318,s_address_prf#2319,s_nationkey_prf#2320,s_suppkey_prf#2321,s_name_prf#2322,s_acctbal_prf#2323,s_comment_prf#2324] JDBCRelation(supplier_prf) [numPartitions=1]
            :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [rid#2334 AS rid_2#2339, n_regionkey_prf#2335 AS n_regionkey_prf_2#2340, n_nationkey_prf#2336 AS n_nationkey_prf_2#2341, n_name_prf#2337 AS n_name_prf_2#2342, n_comment_prf#2338 AS n_comment_prf_2#2343]
               +- Relation[rid#2334,n_regionkey_prf#2335,n_nationkey_prf#2336,n_name_prf#2337,n_comment_prf#2338] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 64329ms

j5=
select * from nation, supplier where n_nationkey = s_nationkey
19/10/14 21:35:58 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:35:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2380L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [s_nationkey#21L]
            +- Filter isnotnull(s_nationkey#21L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 21:35:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2380L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#2392]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#2387: string
         :     :- Project [rid#2382 AS rid_0#2387, n_regionkey_prf#2383 AS n_regionkey_prf_0#2388, n_nationkey_prf#2384 AS n_nationkey_prf_0#2389, n_name_prf#2385 AS n_name_prf_0#2390, n_comment_prf#2386 AS n_comment_prf_0#2391]
         :     :  +- Relation[rid#2382,n_regionkey_prf#2383,n_nationkey_prf#2384,n_name_prf#2385,n_comment_prf#2386] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2393 AS s_phone_prf_1#2401, rid#2394 AS rid_1#2402, s_address_prf#2395 AS s_address_prf_1#2403, s_nationkey_prf#2396 AS s_nationkey_prf_1#2404, s_suppkey_prf#2397 AS s_suppkey_prf_1#2405, s_name_prf#2398 AS s_name_prf_1#2406, s_acctbal_prf#2399 AS s_acctbal_prf_1#2407, s_comment_prf#2400 AS s_comment_prf_1#2408]
            +- Relation[s_phone_prf#2393,rid#2394,s_address_prf#2395,s_nationkey_prf#2396,s_suppkey_prf#2397,s_name_prf#2398,s_acctbal_prf#2399,s_comment_prf#2400] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=10000
Elapsed time: 199ms

r1b=
select * from lineitem, orders, customer where o_custkey = c_custkey and l_orderkey = o_orderkey
19/10/14 21:35:58 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:35:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2458L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (o_custkey#343L = c_custkey#290L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [c_custkey#290L]
                  +- Filter isnotnull(c_custkey#290L)
                     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 21:35:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2458L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#2498]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2483: string
         :     :- Project [l_returnflag_prf#2460 AS l_returnflag_prf_0#2479, l_orderkey_and_l_linenumber_prf#2461 AS l_orderkey_and_l_linenumber_prf_0#2480, l_comment_prf#2462 AS l_comment_prf_0#2481, l_linestatus_prf#2463 AS l_linestatus_prf_0#2482, rid#2464 AS rid_0#2483, l_shipmode_prf#2465 AS l_shipmode_prf_0#2484, l_shipinstruct_prf#2466 AS l_shipinstruct_prf_0#2485, l_quantity_prf#2467 AS l_quantity_prf_0#2486, l_receiptdate_prf#2468 AS l_receiptdate_prf_0#2487, l_linenumber_prf#2469 AS l_linenumber_prf_0#2488, l_tax_prf#2470 AS l_tax_prf_0#2489, l_shipdate_prf#2471 AS l_shipdate_prf_0#2490, l_extendedprice_prf#2472 AS l_extendedprice_prf_0#2491, l_partkey_prf#2473 AS l_partkey_prf_0#2492, l_discount_prf#2474 AS l_discount_prf_0#2493, l_partkey_and_l_suppkey_prf#2475 AS l_partkey_and_l_suppkey_prf_0#2494, l_commitdate_prf#2476 AS l_commitdate_prf_0#2495, l_suppkey_prf#2477 AS l_suppkey_prf_0#2496, l_orderkey_prf#2478 AS l_orderkey_prf_0#2497]
         :     :  +- Relation[l_returnflag_prf#2460,l_orderkey_and_l_linenumber_prf#2461,l_comment_prf#2462,l_linestatus_prf#2463,rid#2464,l_shipmode_prf#2465,l_shipinstruct_prf#2466,l_quantity_prf#2467,l_receiptdate_prf#2468,l_linenumber_prf#2469,l_tax_prf#2470,l_shipdate_prf#2471,l_extendedprice_prf#2472,l_partkey_prf#2473,l_discount_prf#2474,l_partkey_and_l_suppkey_prf#2475,l_commitdate_prf#2476,l_suppkey_prf#2477,l_orderkey_prf#2478] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1508) AS rid_2#2519]
            :  +- DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, rid_1#2510: string
            :     :- Project [o_shippriority_prf#2499 AS o_shippriority_prf_1#2509, rid#2500 AS rid_1#2510, o_orderdate_prf#2501 AS o_orderdate_prf_1#2511, o_custkey_prf#2502 AS o_custkey_prf_1#2512, o_orderpriority_prf#2503 AS o_orderpriority_prf_1#2513, o_clerk_prf#2504 AS o_clerk_prf_1#2514, o_orderstatus_prf#2505 AS o_orderstatus_prf_1#2515, o_totalprice_prf#2506 AS o_totalprice_prf_1#2516, o_orderkey_prf#2507 AS o_orderkey_prf_1#2517, o_comment_prf#2508 AS o_comment_prf_1#2518]
            :     :  +- Relation[o_shippriority_prf#2499,rid#2500,o_orderdate_prf#2501,o_custkey_prf#2502,o_orderpriority_prf#2503,o_clerk_prf#2504,o_orderstatus_prf#2505,o_totalprice_prf#2506,o_orderkey_prf#2507,o_comment_prf#2508] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [c_acctbal_prf#2520 AS c_acctbal_prf_2#2529, rid#2521 AS rid_2#2530, c_name_prf#2522 AS c_name_prf_2#2531, c_nationkey_prf#2523 AS c_nationkey_prf_2#2532, c_custkey_prf#2524 AS c_custkey_prf_2#2533, c_comment_prf#2525 AS c_comment_prf_2#2534, c_address_prf#2526 AS c_address_prf_2#2535, c_mktsegment_prf#2527 AS c_mktsegment_prf_2#2536, c_phone_prf#2528 AS c_phone_prf_2#2537]
               +- Relation[c_acctbal_prf#2520,rid#2521,c_name_prf#2522,c_nationkey_prf#2523,c_custkey_prf#2524,c_comment_prf#2525,c_address_prf#2526,c_mktsegment_prf#2527,c_phone_prf#2528] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 148698ms

j9b=
select * from lineitem, part where l_partkey = p_partkey
19/10/14 21:38:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:38:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2604L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :- Project [l_partkey#307L]
         :  +- Filter isnotnull(l_partkey#307L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [p_partkey#360L]
            +- Filter isnotnull(p_partkey#360L)
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 21:38:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2604L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#2644]
         :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#2629: string
         :     :- Project [l_returnflag_prf#2606 AS l_returnflag_prf_0#2625, l_orderkey_and_l_linenumber_prf#2607 AS l_orderkey_and_l_linenumber_prf_0#2626, l_comment_prf#2608 AS l_comment_prf_0#2627, l_linestatus_prf#2609 AS l_linestatus_prf_0#2628, rid#2610 AS rid_0#2629, l_shipmode_prf#2611 AS l_shipmode_prf_0#2630, l_shipinstruct_prf#2612 AS l_shipinstruct_prf_0#2631, l_quantity_prf#2613 AS l_quantity_prf_0#2632, l_receiptdate_prf#2614 AS l_receiptdate_prf_0#2633, l_linenumber_prf#2615 AS l_linenumber_prf_0#2634, l_tax_prf#2616 AS l_tax_prf_0#2635, l_shipdate_prf#2617 AS l_shipdate_prf_0#2636, l_extendedprice_prf#2618 AS l_extendedprice_prf_0#2637, l_partkey_prf#2619 AS l_partkey_prf_0#2638, l_discount_prf#2620 AS l_discount_prf_0#2639, l_partkey_and_l_suppkey_prf#2621 AS l_partkey_and_l_suppkey_prf_0#2640, l_commitdate_prf#2622 AS l_commitdate_prf_0#2641, l_suppkey_prf#2623 AS l_suppkey_prf_0#2642, l_orderkey_prf#2624 AS l_orderkey_prf_0#2643]
         :     :  +- Relation[l_returnflag_prf#2606,l_orderkey_and_l_linenumber_prf#2607,l_comment_prf#2608,l_linestatus_prf#2609,rid#2610,l_shipmode_prf#2611,l_shipinstruct_prf#2612,l_quantity_prf#2613,l_receiptdate_prf#2614,l_linenumber_prf#2615,l_tax_prf#2616,l_shipdate_prf#2617,l_extendedprice_prf#2618,l_partkey_prf#2619,l_discount_prf#2620,l_partkey_and_l_suppkey_prf#2621,l_commitdate_prf#2622,l_suppkey_prf#2623,l_orderkey_prf#2624] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [p_comment_prf#2645 AS p_comment_prf_1#2655, p_name_prf#2646 AS p_name_prf_1#2656, rid#2647 AS rid_1#2657, p_type_prf#2648 AS p_type_prf_1#2658, p_retailprice_prf#2649 AS p_retailprice_prf_1#2659, p_mfgr_prf#2650 AS p_mfgr_prf_1#2660, p_container_prf#2651 AS p_container_prf_1#2661, p_brand_prf#2652 AS p_brand_prf_1#2662, p_size_prf#2653 AS p_size_prf_1#2663, p_partkey_prf#2654 AS p_partkey_prf_1#2664]
            +- Relation[p_comment_prf#2645,p_name_prf#2646,rid#2647,p_type_prf#2648,p_retailprice_prf#2649,p_mfgr_prf#2650,p_container_prf#2651,p_brand_prf#2652,p_size_prf#2653,p_partkey_prf#2654] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 116689ms

j3=
select * from region, nation where r_regionkey = n_regionkey
19/10/14 21:40:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:40:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2704L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :- Project [r_regionkey#116L]
         :  +- Filter isnotnull(r_regionkey#116L)
         :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         +- Project [n_regionkey#110L]
            +- Filter isnotnull(n_regionkey#110L)
               +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 21:40:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2704L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#2714]
         :  +- DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#2713: string
         :     :- Project [r_regionkey_prf#2706 AS r_regionkey_prf_0#2710, r_name_prf#2707 AS r_name_prf_0#2711, r_comment_prf#2708 AS r_comment_prf_0#2712, rid#2709 AS rid_0#2713]
         :     :  +- Relation[r_regionkey_prf#2706,r_name_prf#2707,r_comment_prf#2708,rid#2709] JDBCRelation(region_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#2715 AS rid_1#2720, n_regionkey_prf#2716 AS n_regionkey_prf_1#2721, n_nationkey_prf#2717 AS n_nationkey_prf_1#2722, n_name_prf#2718 AS n_name_prf_1#2723, n_comment_prf#2719 AS n_comment_prf_1#2724]
            +- Relation[rid#2715,n_regionkey_prf#2716,n_nationkey_prf#2717,n_name_prf#2718,n_comment_prf#2719] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=25
Elapsed time: 68ms

b1a=
select * from part, partsupp where p_size = 15 and p_partkey = ps_partkey
19/10/14 21:40:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:40:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2751L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Filter isnotnull(ps_partkey#32L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 21:40:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2751L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#2774]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2765: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#2753 AS p_comment_prf_0#2763, p_name_prf#2754 AS p_name_prf_0#2764, rid#2755 AS rid_0#2765, p_type_prf#2756 AS p_type_prf_0#2766, p_retailprice_prf#2757 AS p_retailprice_prf_0#2767, p_mfgr_prf#2758 AS p_mfgr_prf_0#2768, p_container_prf#2759 AS p_container_prf_0#2769, p_brand_prf#2760 AS p_brand_prf_0#2770, p_size_prf#2761 AS p_size_prf_0#2771, p_partkey_prf#2762 AS p_partkey_prf_0#2772]
         :     :  :  +- Relation[p_comment_prf#2753,p_name_prf#2754,rid#2755,p_type_prf#2756,p_retailprice_prf#2757,p_mfgr_prf#2758,p_container_prf#2759,p_brand_prf#2760,p_size_prf#2761,p_partkey_prf#2762] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2773]
         :     :     +- DexRidFilter part~p_size~15
         :     :        +- Relation[label#1765,value#1766] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2775 AS ps_partkey_and_ps_suppkey_prf_1#2782, rid#2776 AS rid_1#2783, ps_availqty_prf#2777 AS ps_availqty_prf_1#2784, ps_comment_prf#2778 AS ps_comment_prf_1#2785, ps_partkey_prf#2779 AS ps_partkey_prf_1#2786, ps_supplycost_prf#2780 AS ps_supplycost_prf_1#2787, ps_suppkey_prf#2781 AS ps_suppkey_prf_1#2788]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2775,rid#2776,ps_availqty_prf#2777,ps_comment_prf#2778,ps_partkey_prf#2779,ps_supplycost_prf#2780,ps_suppkey_prf#2781] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 5876ms

j9=
select * from part, lineitem where p_partkey = l_partkey
19/10/14 21:40:29 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:40:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2834L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter isnotnull(p_partkey#360L)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter isnotnull(l_partkey#307L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 21:40:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2834L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#2856]
         :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2848: string
         :     :- Project [p_comment_prf#2836 AS p_comment_prf_0#2846, p_name_prf#2837 AS p_name_prf_0#2847, rid#2838 AS rid_0#2848, p_type_prf#2839 AS p_type_prf_0#2849, p_retailprice_prf#2840 AS p_retailprice_prf_0#2850, p_mfgr_prf#2841 AS p_mfgr_prf_0#2851, p_container_prf#2842 AS p_container_prf_0#2852, p_brand_prf#2843 AS p_brand_prf_0#2853, p_size_prf#2844 AS p_size_prf_0#2854, p_partkey_prf#2845 AS p_partkey_prf_0#2855]
         :     :  +- Relation[p_comment_prf#2836,p_name_prf#2837,rid#2838,p_type_prf#2839,p_retailprice_prf#2840,p_mfgr_prf#2841,p_container_prf#2842,p_brand_prf#2843,p_size_prf#2844,p_partkey_prf#2845] JDBCRelation(part_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2857 AS l_returnflag_prf_1#2876, l_orderkey_and_l_linenumber_prf#2858 AS l_orderkey_and_l_linenumber_prf_1#2877, l_comment_prf#2859 AS l_comment_prf_1#2878, l_linestatus_prf#2860 AS l_linestatus_prf_1#2879, rid#2861 AS rid_1#2880, l_shipmode_prf#2862 AS l_shipmode_prf_1#2881, l_shipinstruct_prf#2863 AS l_shipinstruct_prf_1#2882, l_quantity_prf#2864 AS l_quantity_prf_1#2883, l_receiptdate_prf#2865 AS l_receiptdate_prf_1#2884, l_linenumber_prf#2866 AS l_linenumber_prf_1#2885, l_tax_prf#2867 AS l_tax_prf_1#2886, l_shipdate_prf#2868 AS l_shipdate_prf_1#2887, l_extendedprice_prf#2869 AS l_extendedprice_prf_1#2888, l_partkey_prf#2870 AS l_partkey_prf_1#2889, l_discount_prf#2871 AS l_discount_prf_1#2890, l_partkey_and_l_suppkey_prf#2872 AS l_partkey_and_l_suppkey_prf_1#2891, l_commitdate_prf#2873 AS l_commitdate_prf_1#2892, l_suppkey_prf#2874 AS l_suppkey_prf_1#2893, l_orderkey_prf#2875 AS l_orderkey_prf_1#2894]
            +- Relation[l_returnflag_prf#2857,l_orderkey_and_l_linenumber_prf#2858,l_comment_prf#2859,l_linestatus_prf#2860,rid#2861,l_shipmode_prf#2862,l_shipinstruct_prf#2863,l_quantity_prf#2864,l_receiptdate_prf#2865,l_linenumber_prf#2866,l_tax_prf#2867,l_shipdate_prf#2868,l_extendedprice_prf#2869,l_partkey_prf#2870,l_discount_prf#2871,l_partkey_and_l_suppkey_prf#2872,l_commitdate_prf#2873,l_suppkey_prf#2874,l_orderkey_prf#2875] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 94232ms

t2a=
select * from partsupp, part, supplier where ps_partkey = p_partkey and ps_suppkey = s_suppkey
19/10/14 21:42:04 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:42:04 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2948L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 21:42:04 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2948L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#2964]
         :  :  :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#2958: string
         :  :  :     :- Project [ps_partkey_and_ps_suppkey_prf#2950 AS ps_partkey_and_ps_suppkey_prf_0#2957, rid#2951 AS rid_0#2958, ps_availqty_prf#2952 AS ps_availqty_prf_0#2959, ps_comment_prf#2953 AS ps_comment_prf_0#2960, ps_partkey_prf#2954 AS ps_partkey_prf_0#2961, ps_supplycost_prf#2955 AS ps_supplycost_prf_0#2962, ps_suppkey_prf#2956 AS ps_suppkey_prf_0#2963]
         :  :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2950,rid#2951,ps_availqty_prf#2952,ps_comment_prf#2953,ps_partkey_prf#2954,ps_supplycost_prf#2955,ps_suppkey_prf#2956] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#2965 AS p_comment_prf_1#2975, p_name_prf#2966 AS p_name_prf_1#2976, rid#2967 AS rid_1#2977, p_type_prf#2968 AS p_type_prf_1#2978, p_retailprice_prf#2969 AS p_retailprice_prf_1#2979, p_mfgr_prf#2970 AS p_mfgr_prf_1#2980, p_container_prf#2971 AS p_container_prf_1#2981, p_brand_prf#2972 AS p_brand_prf_1#2982, p_size_prf#2973 AS p_size_prf_1#2983, p_partkey_prf#2974 AS p_partkey_prf_1#2984]
         :  :     +- Relation[p_comment_prf#2965,p_name_prf#2966,rid#2967,p_type_prf#2968,p_retailprice_prf#2969,p_mfgr_prf#2970,p_container_prf#2971,p_brand_prf#2972,p_size_prf#2973,p_partkey_prf#2974] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1508) AS rid_2#2993]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2992]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#2985,rid#2986,ps_availqty_prf#2987,ps_comment_prf#2988,ps_partkey_prf#2989,ps_supplycost_prf#2990,ps_suppkey_prf#2991] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#2994 AS s_phone_prf_2#3002, rid#2995 AS rid_2#3003, s_address_prf#2996 AS s_address_prf_2#3004, s_nationkey_prf#2997 AS s_nationkey_prf_2#3005, s_suppkey_prf#2998 AS s_suppkey_prf_2#3006, s_name_prf#2999 AS s_name_prf_2#3007, s_acctbal_prf#3000 AS s_acctbal_prf_2#3008, s_comment_prf#3001 AS s_comment_prf_2#3009]
            +- Relation[s_phone_prf#2994,rid#2995,s_address_prf#2996,s_nationkey_prf#2997,s_suppkey_prf#2998,s_name_prf#2999,s_acctbal_prf#3000,s_comment_prf#3001] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 105515ms

b2b=
select * from lineitem, orders where l_returnflag = 'R' and l_orderkey = o_orderkey
19/10/14 21:43:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:43:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3063L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 21:43:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3063L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#3104]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3088: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#3065 AS l_returnflag_prf_0#3084, l_orderkey_and_l_linenumber_prf#3066 AS l_orderkey_and_l_linenumber_prf_0#3085, l_comment_prf#3067 AS l_comment_prf_0#3086, l_linestatus_prf#3068 AS l_linestatus_prf_0#3087, rid#3069 AS rid_0#3088, l_shipmode_prf#3070 AS l_shipmode_prf_0#3089, l_shipinstruct_prf#3071 AS l_shipinstruct_prf_0#3090, l_quantity_prf#3072 AS l_quantity_prf_0#3091, l_receiptdate_prf#3073 AS l_receiptdate_prf_0#3092, l_linenumber_prf#3074 AS l_linenumber_prf_0#3093, l_tax_prf#3075 AS l_tax_prf_0#3094, l_shipdate_prf#3076 AS l_shipdate_prf_0#3095, l_extendedprice_prf#3077 AS l_extendedprice_prf_0#3096, l_partkey_prf#3078 AS l_partkey_prf_0#3097, l_discount_prf#3079 AS l_discount_prf_0#3098, l_partkey_and_l_suppkey_prf#3080 AS l_partkey_and_l_suppkey_prf_0#3099, l_commitdate_prf#3081 AS l_commitdate_prf_0#3100, l_suppkey_prf#3082 AS l_suppkey_prf_0#3101, l_orderkey_prf#3083 AS l_orderkey_prf_0#3102]
         :     :  :  +- Relation[l_returnflag_prf#3065,l_orderkey_and_l_linenumber_prf#3066,l_comment_prf#3067,l_linestatus_prf#3068,rid#3069,l_shipmode_prf#3070,l_shipinstruct_prf#3071,l_quantity_prf#3072,l_receiptdate_prf#3073,l_linenumber_prf#3074,l_tax_prf#3075,l_shipdate_prf#3076,l_extendedprice_prf#3077,l_partkey_prf#3078,l_discount_prf#3079,l_partkey_and_l_suppkey_prf#3080,l_commitdate_prf#3081,l_suppkey_prf#3082,l_orderkey_prf#3083] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3103]
         :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :        +- Relation[label#1765,value#1766] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3105 AS o_shippriority_prf_1#3115, rid#3106 AS rid_1#3116, o_orderdate_prf#3107 AS o_orderdate_prf_1#3117, o_custkey_prf#3108 AS o_custkey_prf_1#3118, o_orderpriority_prf#3109 AS o_orderpriority_prf_1#3119, o_clerk_prf#3110 AS o_clerk_prf_1#3120, o_orderstatus_prf#3111 AS o_orderstatus_prf_1#3121, o_totalprice_prf#3112 AS o_totalprice_prf_1#3122, o_orderkey_prf#3113 AS o_orderkey_prf_1#3123, o_comment_prf#3114 AS o_comment_prf_1#3124]
            +- Relation[o_shippriority_prf#3105,rid#3106,o_orderdate_prf#3107,o_custkey_prf#3108,o_orderpriority_prf#3109,o_clerk_prf#3110,o_orderstatus_prf#3111,o_totalprice_prf#3112,o_orderkey_prf#3113,o_comment_prf#3114] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 54305ms

t2d=
select * from part, supplier, partsupp where p_partkey = ps_partkey and s_suppkey = ps_suppkey
19/10/14 21:44:43 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:44:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3178L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (ps_partkey#32L = p_partkey#360L)
               :- Project [ps_partkey#32L, ps_suppkey#33L]
               :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
               :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
               +- Project [p_partkey#360L]
                  +- Filter isnotnull(p_partkey#360L)
                     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 21:44:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3178L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#3196]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#3189: string
         :     :- Project [s_phone_prf#3180 AS s_phone_prf_0#3188, rid#3181 AS rid_0#3189, s_address_prf#3182 AS s_address_prf_0#3190, s_nationkey_prf#3183 AS s_nationkey_prf_0#3191, s_suppkey_prf#3184 AS s_suppkey_prf_0#3192, s_name_prf#3185 AS s_name_prf_0#3193, s_acctbal_prf#3186 AS s_acctbal_prf_0#3194, s_comment_prf#3187 AS s_comment_prf_0#3195]
         :     :  +- Relation[s_phone_prf#3180,rid#3181,s_address_prf#3182,s_nationkey_prf#3183,s_suppkey_prf#3184,s_name_prf#3185,s_acctbal_prf#3186,s_comment_prf#3187] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1508) AS rid_2#3211]
            :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_1#3205: string
            :     :- Project [ps_partkey_and_ps_suppkey_prf#3197 AS ps_partkey_and_ps_suppkey_prf_1#3204, rid#3198 AS rid_1#3205, ps_availqty_prf#3199 AS ps_availqty_prf_1#3206, ps_comment_prf#3200 AS ps_comment_prf_1#3207, ps_partkey_prf#3201 AS ps_partkey_prf_1#3208, ps_supplycost_prf#3202 AS ps_supplycost_prf_1#3209, ps_suppkey_prf#3203 AS ps_suppkey_prf_1#3210]
            :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#3197,rid#3198,ps_availqty_prf#3199,ps_comment_prf#3200,ps_partkey_prf#3201,ps_supplycost_prf#3202,ps_suppkey_prf#3203] JDBCRelation(partsupp_prf) [numPartitions=1]
            :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [p_comment_prf#3212 AS p_comment_prf_2#3222, p_name_prf#3213 AS p_name_prf_2#3223, rid#3214 AS rid_2#3224, p_type_prf#3215 AS p_type_prf_2#3225, p_retailprice_prf#3216 AS p_retailprice_prf_2#3226, p_mfgr_prf#3217 AS p_mfgr_prf_2#3227, p_container_prf#3218 AS p_container_prf_2#3228, p_brand_prf#3219 AS p_brand_prf_2#3229, p_size_prf#3220 AS p_size_prf_2#3230, p_partkey_prf#3221 AS p_partkey_prf_2#3231]
               +- Relation[p_comment_prf#3212,p_name_prf#3213,rid#3214,p_type_prf#3215,p_retailprice_prf#3216,p_mfgr_prf#3217,p_container_prf#3218,p_brand_prf#3219,p_size_prf#3220,p_partkey_prf#3221] JDBCRelation(part_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 61767ms

t3c=
select * from part, supplier, lineitem where p_partkey = l_partkey and s_suppkey = l_suppkey
19/10/14 21:45:45 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:45:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3292L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Join Inner, (p_partkey#360L = l_partkey#307L)
               :- Project [p_partkey#360L]
               :  +- Filter isnotnull(p_partkey#360L)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [l_partkey#307L, l_suppkey#308L]
                  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 21:45:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3292L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_2#3310]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, rid_0#3303: string
         :     :- Project [s_phone_prf#3294 AS s_phone_prf_0#3302, rid#3295 AS rid_0#3303, s_address_prf#3296 AS s_address_prf_0#3304, s_nationkey_prf#3297 AS s_nationkey_prf_0#3305, s_suppkey_prf#3298 AS s_suppkey_prf_0#3306, s_name_prf#3299 AS s_name_prf_0#3307, s_acctbal_prf#3300 AS s_acctbal_prf_0#3308, s_comment_prf#3301 AS s_comment_prf_0#3309]
         :     :  +- Relation[s_phone_prf#3294,rid#3295,s_address_prf#3296,s_nationkey_prf#3297,s_suppkey_prf#3298,s_name_prf#3299,s_acctbal_prf#3300,s_comment_prf#3301] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_1, 'p_name_prf_1, 'rid_1, 'p_type_prf_1, 'p_retailprice_prf_1, 'p_mfgr_prf_1, 'p_container_prf_1, 'p_brand_prf_1, 'p_size_prf_1, 'p_partkey_prf_1, dexdecrypt('value_dec_key, value#1508) AS rid_2#3331]
            :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_1#3323: string
            :     :- Project [p_comment_prf#3311 AS p_comment_prf_1#3321, p_name_prf#3312 AS p_name_prf_1#3322, rid#3313 AS rid_1#3323, p_type_prf#3314 AS p_type_prf_1#3324, p_retailprice_prf#3315 AS p_retailprice_prf_1#3325, p_mfgr_prf#3316 AS p_mfgr_prf_1#3326, p_container_prf#3317 AS p_container_prf_1#3327, p_brand_prf#3318 AS p_brand_prf_1#3328, p_size_prf#3319 AS p_size_prf_1#3329, p_partkey_prf#3320 AS p_partkey_prf_1#3330]
            :     :  +- Relation[p_comment_prf#3311,p_name_prf#3312,rid#3313,p_type_prf#3314,p_retailprice_prf#3315,p_mfgr_prf#3316,p_container_prf#3317,p_brand_prf#3318,p_size_prf#3319,p_partkey_prf#3320] JDBCRelation(part_prf) [numPartitions=1]
            :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#3332 AS l_returnflag_prf_2#3351, l_orderkey_and_l_linenumber_prf#3333 AS l_orderkey_and_l_linenumber_prf_2#3352, l_comment_prf#3334 AS l_comment_prf_2#3353, l_linestatus_prf#3335 AS l_linestatus_prf_2#3354, rid#3336 AS rid_2#3355, l_shipmode_prf#3337 AS l_shipmode_prf_2#3356, l_shipinstruct_prf#3338 AS l_shipinstruct_prf_2#3357, l_quantity_prf#3339 AS l_quantity_prf_2#3358, l_receiptdate_prf#3340 AS l_receiptdate_prf_2#3359, l_linenumber_prf#3341 AS l_linenumber_prf_2#3360, l_tax_prf#3342 AS l_tax_prf_2#3361, l_shipdate_prf#3343 AS l_shipdate_prf_2#3362, l_extendedprice_prf#3344 AS l_extendedprice_prf_2#3363, l_partkey_prf#3345 AS l_partkey_prf_2#3364, l_discount_prf#3346 AS l_discount_prf_2#3365, l_partkey_and_l_suppkey_prf#3347 AS l_partkey_and_l_suppkey_prf_2#3366, l_commitdate_prf#3348 AS l_commitdate_prf_2#3367, l_suppkey_prf#3349 AS l_suppkey_prf_2#3368, l_orderkey_prf#3350 AS l_orderkey_prf_2#3369]
               +- Relation[l_returnflag_prf#3332,l_orderkey_and_l_linenumber_prf#3333,l_comment_prf#3334,l_linestatus_prf#3335,rid#3336,l_shipmode_prf#3337,l_shipinstruct_prf#3338,l_quantity_prf#3339,l_receiptdate_prf#3340,l_linenumber_prf#3341,l_tax_prf#3342,l_shipdate_prf#3343,l_extendedprice_prf#3344,l_partkey_prf#3345,l_discount_prf#3346,l_partkey_and_l_suppkey_prf#3347,l_commitdate_prf#3348,l_suppkey_prf#3349,l_orderkey_prf#3350] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 186854ms

j7=
select * from customer, orders where c_custkey = o_custkey
19/10/14 21:48:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:48:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3427L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Filter isnotnull(o_custkey#343L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 21:48:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3427L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#3447]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3439: string
         :     :- Project [c_acctbal_prf#3429 AS c_acctbal_prf_0#3438, rid#3430 AS rid_0#3439, c_name_prf#3431 AS c_name_prf_0#3440, c_nationkey_prf#3432 AS c_nationkey_prf_0#3441, c_custkey_prf#3433 AS c_custkey_prf_0#3442, c_comment_prf#3434 AS c_comment_prf_0#3443, c_address_prf#3435 AS c_address_prf_0#3444, c_mktsegment_prf#3436 AS c_mktsegment_prf_0#3445, c_phone_prf#3437 AS c_phone_prf_0#3446]
         :     :  +- Relation[c_acctbal_prf#3429,rid#3430,c_name_prf#3431,c_nationkey_prf#3432,c_custkey_prf#3433,c_comment_prf#3434,c_address_prf#3435,c_mktsegment_prf#3436,c_phone_prf#3437] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3448 AS o_shippriority_prf_1#3458, rid#3449 AS rid_1#3459, o_orderdate_prf#3450 AS o_orderdate_prf_1#3460, o_custkey_prf#3451 AS o_custkey_prf_1#3461, o_orderpriority_prf#3452 AS o_orderpriority_prf_1#3462, o_clerk_prf#3453 AS o_clerk_prf_1#3463, o_orderstatus_prf#3454 AS o_orderstatus_prf_1#3464, o_totalprice_prf#3455 AS o_totalprice_prf_1#3465, o_orderkey_prf#3456 AS o_orderkey_prf_1#3466, o_comment_prf#3457 AS o_comment_prf_1#3467]
            +- Relation[o_shippriority_prf#3448,rid#3449,o_orderdate_prf#3450,o_custkey_prf#3451,o_orderpriority_prf#3452,o_clerk_prf#3453,o_orderstatus_prf#3454,o_totalprice_prf#3455,o_orderkey_prf#3456,o_comment_prf#3457] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=1500000
Elapsed time: 40390ms

t1a=
select * from supplier, nation, customer where s_nationkey = n_nationkey and n_nationkey = c_nationkey
19/10/14 21:49:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:49:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3509L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [s_nationkey#21L]
         :     :  +- Filter isnotnull(s_nationkey#21L)
         :     :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Filter isnotnull(n_nationkey#108L)
         :           +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 21:49:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3509L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#3527]
         :  :  :  +- DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, rid_0#3520: string
         :  :  :     :- Project [s_phone_prf#3511 AS s_phone_prf_0#3519, rid#3512 AS rid_0#3520, s_address_prf#3513 AS s_address_prf_0#3521, s_nationkey_prf#3514 AS s_nationkey_prf_0#3522, s_suppkey_prf#3515 AS s_suppkey_prf_0#3523, s_name_prf#3516 AS s_name_prf_0#3524, s_acctbal_prf#3517 AS s_acctbal_prf_0#3525, s_comment_prf#3518 AS s_comment_prf_0#3526]
         :  :  :     :  +- Relation[s_phone_prf#3511,rid#3512,s_address_prf#3513,s_nationkey_prf#3514,s_suppkey_prf#3515,s_name_prf#3516,s_acctbal_prf#3517,s_comment_prf#3518] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [rid#3528 AS rid_1#3533, n_regionkey_prf#3529 AS n_regionkey_prf_1#3534, n_nationkey_prf#3530 AS n_nationkey_prf_1#3535, n_name_prf#3531 AS n_name_prf_1#3536, n_comment_prf#3532 AS n_comment_prf_1#3537]
         :  :     +- Relation[rid#3528,n_regionkey_prf#3529,n_nationkey_prf#3530,n_name_prf#3531,n_comment_prf#3532] JDBCRelation(nation_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1508) AS rid_2#3544]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3543]
         :        :  +- Relation[rid#3538,n_regionkey_prf#3539,n_nationkey_prf#3540,n_name_prf#3541,n_comment_prf#3542] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3545 AS c_acctbal_prf_2#3554, rid#3546 AS rid_2#3555, c_name_prf#3547 AS c_name_prf_2#3556, c_nationkey_prf#3548 AS c_nationkey_prf_2#3557, c_custkey_prf#3549 AS c_custkey_prf_2#3558, c_comment_prf#3550 AS c_comment_prf_2#3559, c_address_prf#3551 AS c_address_prf_2#3560, c_mktsegment_prf#3552 AS c_mktsegment_prf_2#3561, c_phone_prf#3553 AS c_phone_prf_2#3562]
            +- Relation[c_acctbal_prf#3545,rid#3546,c_name_prf#3547,c_nationkey_prf#3548,c_custkey_prf#3549,c_comment_prf#3550,c_address_prf#3551,c_mktsegment_prf#3552,c_phone_prf#3553] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 49761ms

f1=
select * from region where r_name = 'EUROPE'
19/10/14 21:50:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:50:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3591L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(r_name#117) && (r_name#117 = EUROPE))
         +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet

19/10/14 21:50:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3591L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [r_regionkey_prf#3593 AS r_regionkey_prf_0#3597, r_name_prf#3594 AS r_name_prf_0#3598, r_comment_prf#3595 AS r_comment_prf_0#3599, rid#3596 AS rid_0#3600]
         :  +- Relation[r_regionkey_prf#3593,r_name_prf#3594,r_comment_prf#3595,rid#3596] JDBCRelation(region_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3601]
            +- DexRidFilter region~r_name~EUROPE
               +- Relation[label#1765,value#1766] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 54ms

r1f=
select * from customer, lineitem, orders where l_orderkey = o_orderkey and c_custkey = o_custkey
19/10/14 21:50:22 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:50:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3642L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
               :- Project [l_orderkey#306L]
               :  +- Filter isnotnull(l_orderkey#306L)
               :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 21:50:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3642L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_2#3662]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#3654: string
         :     :- Project [c_acctbal_prf#3644 AS c_acctbal_prf_0#3653, rid#3645 AS rid_0#3654, c_name_prf#3646 AS c_name_prf_0#3655, c_nationkey_prf#3647 AS c_nationkey_prf_0#3656, c_custkey_prf#3648 AS c_custkey_prf_0#3657, c_comment_prf#3649 AS c_comment_prf_0#3658, c_address_prf#3650 AS c_address_prf_0#3659, c_mktsegment_prf#3651 AS c_mktsegment_prf_0#3660, c_phone_prf#3652 AS c_phone_prf_0#3661]
         :     :  +- Relation[c_acctbal_prf#3644,rid#3645,c_name_prf#3646,c_nationkey_prf#3647,c_custkey_prf#3648,c_comment_prf#3649,c_address_prf#3650,c_mktsegment_prf#3651,c_phone_prf#3652] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'rid_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, 'l_discount_prf_1, 'l_partkey_and_l_suppkey_prf_1, 'l_commitdate_prf_1, 'l_suppkey_prf_1, 'l_orderkey_prf_1, dexdecrypt('value_dec_key, value#1508) AS rid_2#3701]
            :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_1#3686: string
            :     :- Project [l_returnflag_prf#3663 AS l_returnflag_prf_1#3682, l_orderkey_and_l_linenumber_prf#3664 AS l_orderkey_and_l_linenumber_prf_1#3683, l_comment_prf#3665 AS l_comment_prf_1#3684, l_linestatus_prf#3666 AS l_linestatus_prf_1#3685, rid#3667 AS rid_1#3686, l_shipmode_prf#3668 AS l_shipmode_prf_1#3687, l_shipinstruct_prf#3669 AS l_shipinstruct_prf_1#3688, l_quantity_prf#3670 AS l_quantity_prf_1#3689, l_receiptdate_prf#3671 AS l_receiptdate_prf_1#3690, l_linenumber_prf#3672 AS l_linenumber_prf_1#3691, l_tax_prf#3673 AS l_tax_prf_1#3692, l_shipdate_prf#3674 AS l_shipdate_prf_1#3693, l_extendedprice_prf#3675 AS l_extendedprice_prf_1#3694, l_partkey_prf#3676 AS l_partkey_prf_1#3695, l_discount_prf#3677 AS l_discount_prf_1#3696, l_partkey_and_l_suppkey_prf#3678 AS l_partkey_and_l_suppkey_prf_1#3697, l_commitdate_prf#3679 AS l_commitdate_prf_1#3698, l_suppkey_prf#3680 AS l_suppkey_prf_1#3699, l_orderkey_prf#3681 AS l_orderkey_prf_1#3700]
            :     :  +- Relation[l_returnflag_prf#3663,l_orderkey_and_l_linenumber_prf#3664,l_comment_prf#3665,l_linestatus_prf#3666,rid#3667,l_shipmode_prf#3668,l_shipinstruct_prf#3669,l_quantity_prf#3670,l_receiptdate_prf#3671,l_linenumber_prf#3672,l_tax_prf#3673,l_shipdate_prf#3674,l_extendedprice_prf#3675,l_partkey_prf#3676,l_discount_prf#3677,l_partkey_and_l_suppkey_prf#3678,l_commitdate_prf#3679,l_suppkey_prf#3680,l_orderkey_prf#3681] JDBCRelation(lineitem_prf) [numPartitions=1]
            :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3702 AS o_shippriority_prf_2#3712, rid#3703 AS rid_2#3713, o_orderdate_prf#3704 AS o_orderdate_prf_2#3714, o_custkey_prf#3705 AS o_custkey_prf_2#3715, o_orderpriority_prf#3706 AS o_orderpriority_prf_2#3716, o_clerk_prf#3707 AS o_clerk_prf_2#3717, o_orderstatus_prf#3708 AS o_orderstatus_prf_2#3718, o_totalprice_prf#3709 AS o_totalprice_prf_2#3719, o_orderkey_prf#3710 AS o_orderkey_prf_2#3720, o_comment_prf#3711 AS o_comment_prf_2#3721]
               +- Relation[o_shippriority_prf#3702,rid#3703,o_orderdate_prf#3704,o_custkey_prf#3705,o_orderpriority_prf#3706,o_clerk_prf#3707,o_orderstatus_prf#3708,o_totalprice_prf#3709,o_orderkey_prf#3710,o_comment_prf#3711] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 156854ms

f4=
select * from nation where n_name = 'FRANCE'
19/10/14 21:52:59 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:52:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3767L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(n_name#109) && (n_name#109 = FRANCE))
         +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/14 21:52:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3767L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [rid#3769 AS rid_0#3774, n_regionkey_prf#3770 AS n_regionkey_prf_0#3775, n_nationkey_prf#3771 AS n_nationkey_prf_0#3776, n_name_prf#3772 AS n_name_prf_0#3777, n_comment_prf#3773 AS n_comment_prf_0#3778]
         :  +- Relation[rid#3769,n_regionkey_prf#3770,n_nationkey_prf#3771,n_name_prf#3772,n_comment_prf#3773] JDBCRelation(nation_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3779]
            +- DexRidFilter nation~n_name~FRANCE
               +- Relation[label#1765,value#1766] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1
Elapsed time: 53ms

f3=
select * from part where p_type = 'ECONOMY ANODIZED STEEL'
19/10/14 21:52:59 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:52:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3797L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Filter (isnotnull(p_type#363) && (p_type#363 = ECONOMY ANODIZED STEEL))
         +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 21:52:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3797L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_0))
         :- Project [p_comment_prf#3799 AS p_comment_prf_0#3809, p_name_prf#3800 AS p_name_prf_0#3810, rid#3801 AS rid_0#3811, p_type_prf#3802 AS p_type_prf_0#3812, p_retailprice_prf#3803 AS p_retailprice_prf_0#3813, p_mfgr_prf#3804 AS p_mfgr_prf_0#3814, p_container_prf#3805 AS p_container_prf_0#3815, p_brand_prf#3806 AS p_brand_prf_0#3816, p_size_prf#3807 AS p_size_prf_0#3817, p_partkey_prf#3808 AS p_partkey_prf_0#3818]
         :  +- Relation[p_comment_prf#3799,p_name_prf#3800,rid#3801,p_type_prf#3802,p_retailprice_prf#3803,p_mfgr_prf#3804,p_container_prf#3805,p_brand_prf#3806,p_size_prf#3807,p_partkey_prf#3808] JDBCRelation(part_prf) [numPartitions=1]
         +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3819]
            +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
               +- Relation[label#1765,value#1766] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1451
Elapsed time: 2230ms

b2a=
select * from orders, lineitem where o_orderkey = l_orderkey and l_returnflag = 'R'
19/10/14 21:53:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:53:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3858L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter ((isnotnull(l_returnflag#314) && (l_returnflag#314 = R)) && isnotnull(l_orderkey#306L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 21:53:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3858L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#3880]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#3871: string
         :     :- Project [o_shippriority_prf#3860 AS o_shippriority_prf_0#3870, rid#3861 AS rid_0#3871, o_orderdate_prf#3862 AS o_orderdate_prf_0#3872, o_custkey_prf#3863 AS o_custkey_prf_0#3873, o_orderpriority_prf#3864 AS o_orderpriority_prf_0#3874, o_clerk_prf#3865 AS o_clerk_prf_0#3875, o_orderstatus_prf#3866 AS o_orderstatus_prf_0#3876, o_totalprice_prf#3867 AS o_totalprice_prf_0#3877, o_orderkey_prf#3868 AS o_orderkey_prf_0#3878, o_comment_prf#3869 AS o_comment_prf_0#3879]
         :     :  +- Relation[o_shippriority_prf#3860,rid#3861,o_orderdate_prf#3862,o_custkey_prf#3863,o_orderpriority_prf#3864,o_clerk_prf#3865,o_orderstatus_prf#3866,o_totalprice_prf#3867,o_orderkey_prf#3868,o_comment_prf#3869] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [l_returnflag_prf#3881 AS l_returnflag_prf_1#3900, l_orderkey_and_l_linenumber_prf#3882 AS l_orderkey_and_l_linenumber_prf_1#3901, l_comment_prf#3883 AS l_comment_prf_1#3902, l_linestatus_prf#3884 AS l_linestatus_prf_1#3903, rid#3885 AS rid_1#3904, l_shipmode_prf#3886 AS l_shipmode_prf_1#3905, l_shipinstruct_prf#3887 AS l_shipinstruct_prf_1#3906, l_quantity_prf#3888 AS l_quantity_prf_1#3907, l_receiptdate_prf#3889 AS l_receiptdate_prf_1#3908, l_linenumber_prf#3890 AS l_linenumber_prf_1#3909, l_tax_prf#3891 AS l_tax_prf_1#3910, l_shipdate_prf#3892 AS l_shipdate_prf_1#3911, l_extendedprice_prf#3893 AS l_extendedprice_prf_1#3912, l_partkey_prf#3894 AS l_partkey_prf_1#3913, l_discount_prf#3895 AS l_discount_prf_1#3914, l_partkey_and_l_suppkey_prf#3896 AS l_partkey_and_l_suppkey_prf_1#3915, l_commitdate_prf#3897 AS l_commitdate_prf_1#3916, l_suppkey_prf#3898 AS l_suppkey_prf_1#3917, l_orderkey_prf#3899 AS l_orderkey_prf_1#3918]
            :  +- Relation[l_returnflag_prf#3881,l_orderkey_and_l_linenumber_prf#3882,l_comment_prf#3883,l_linestatus_prf#3884,rid#3885,l_shipmode_prf#3886,l_shipinstruct_prf#3887,l_quantity_prf#3888,l_receiptdate_prf#3889,l_linenumber_prf#3890,l_tax_prf#3891,l_shipdate_prf#3892,l_extendedprice_prf#3893,l_partkey_prf#3894,l_discount_prf#3895,l_partkey_and_l_suppkey_prf#3896,l_commitdate_prf#3897,l_suppkey_prf#3898,l_orderkey_prf#3899] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3919]
               +- DexRidFilter lineitem~l_returnflag~R
                  +- Relation[label#1765,value#1766] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 198023ms

j8=
select * from orders, lineitem where o_orderkey = l_orderkey
19/10/14 21:56:19 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:56:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3977L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Filter isnotnull(o_orderkey#342L)
         :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 21:56:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3977L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['o_shippriority_prf_0, 'rid_0, 'o_orderdate_prf_0, 'o_custkey_prf_0, 'o_orderpriority_prf_0, 'o_clerk_prf_0, 'o_orderstatus_prf_0, 'o_totalprice_prf_0, 'o_orderkey_prf_0, 'o_comment_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#3999]
         :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_0#3990: string
         :     :- Project [o_shippriority_prf#3979 AS o_shippriority_prf_0#3989, rid#3980 AS rid_0#3990, o_orderdate_prf#3981 AS o_orderdate_prf_0#3991, o_custkey_prf#3982 AS o_custkey_prf_0#3992, o_orderpriority_prf#3983 AS o_orderpriority_prf_0#3993, o_clerk_prf#3984 AS o_clerk_prf_0#3994, o_orderstatus_prf#3985 AS o_orderstatus_prf_0#3995, o_totalprice_prf#3986 AS o_totalprice_prf_0#3996, o_orderkey_prf#3987 AS o_orderkey_prf_0#3997, o_comment_prf#3988 AS o_comment_prf_0#3998]
         :     :  +- Relation[o_shippriority_prf#3979,rid#3980,o_orderdate_prf#3981,o_custkey_prf#3982,o_orderpriority_prf#3983,o_clerk_prf#3984,o_orderstatus_prf#3985,o_totalprice_prf#3986,o_orderkey_prf#3987,o_comment_prf#3988] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4000 AS l_returnflag_prf_1#4019, l_orderkey_and_l_linenumber_prf#4001 AS l_orderkey_and_l_linenumber_prf_1#4020, l_comment_prf#4002 AS l_comment_prf_1#4021, l_linestatus_prf#4003 AS l_linestatus_prf_1#4022, rid#4004 AS rid_1#4023, l_shipmode_prf#4005 AS l_shipmode_prf_1#4024, l_shipinstruct_prf#4006 AS l_shipinstruct_prf_1#4025, l_quantity_prf#4007 AS l_quantity_prf_1#4026, l_receiptdate_prf#4008 AS l_receiptdate_prf_1#4027, l_linenumber_prf#4009 AS l_linenumber_prf_1#4028, l_tax_prf#4010 AS l_tax_prf_1#4029, l_shipdate_prf#4011 AS l_shipdate_prf_1#4030, l_extendedprice_prf#4012 AS l_extendedprice_prf_1#4031, l_partkey_prf#4013 AS l_partkey_prf_1#4032, l_discount_prf#4014 AS l_discount_prf_1#4033, l_partkey_and_l_suppkey_prf#4015 AS l_partkey_and_l_suppkey_prf_1#4034, l_commitdate_prf#4016 AS l_commitdate_prf_1#4035, l_suppkey_prf#4017 AS l_suppkey_prf_1#4036, l_orderkey_prf#4018 AS l_orderkey_prf_1#4037]
            +- Relation[l_returnflag_prf#4000,l_orderkey_and_l_linenumber_prf#4001,l_comment_prf#4002,l_linestatus_prf#4003,rid#4004,l_shipmode_prf#4005,l_shipinstruct_prf#4006,l_quantity_prf#4007,l_receiptdate_prf#4008,l_linenumber_prf#4009,l_tax_prf#4010,l_shipdate_prf#4011,l_extendedprice_prf#4012,l_partkey_prf#4013,l_discount_prf#4014,l_partkey_and_l_suppkey_prf#4015,l_commitdate_prf#4016,l_suppkey_prf#4017,l_orderkey_prf#4018] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 195937ms

j8b=
select * from lineitem, orders where l_orderkey = o_orderkey
19/10/14 21:59:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 21:59:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4095L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Filter isnotnull(o_orderkey#342L)
               +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 21:59:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4095L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#4135]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4120: string
         :     :- Project [l_returnflag_prf#4097 AS l_returnflag_prf_0#4116, l_orderkey_and_l_linenumber_prf#4098 AS l_orderkey_and_l_linenumber_prf_0#4117, l_comment_prf#4099 AS l_comment_prf_0#4118, l_linestatus_prf#4100 AS l_linestatus_prf_0#4119, rid#4101 AS rid_0#4120, l_shipmode_prf#4102 AS l_shipmode_prf_0#4121, l_shipinstruct_prf#4103 AS l_shipinstruct_prf_0#4122, l_quantity_prf#4104 AS l_quantity_prf_0#4123, l_receiptdate_prf#4105 AS l_receiptdate_prf_0#4124, l_linenumber_prf#4106 AS l_linenumber_prf_0#4125, l_tax_prf#4107 AS l_tax_prf_0#4126, l_shipdate_prf#4108 AS l_shipdate_prf_0#4127, l_extendedprice_prf#4109 AS l_extendedprice_prf_0#4128, l_partkey_prf#4110 AS l_partkey_prf_0#4129, l_discount_prf#4111 AS l_discount_prf_0#4130, l_partkey_and_l_suppkey_prf#4112 AS l_partkey_and_l_suppkey_prf_0#4131, l_commitdate_prf#4113 AS l_commitdate_prf_0#4132, l_suppkey_prf#4114 AS l_suppkey_prf_0#4133, l_orderkey_prf#4115 AS l_orderkey_prf_0#4134]
         :     :  +- Relation[l_returnflag_prf#4097,l_orderkey_and_l_linenumber_prf#4098,l_comment_prf#4099,l_linestatus_prf#4100,rid#4101,l_shipmode_prf#4102,l_shipinstruct_prf#4103,l_quantity_prf#4104,l_receiptdate_prf#4105,l_linenumber_prf#4106,l_tax_prf#4107,l_shipdate_prf#4108,l_extendedprice_prf#4109,l_partkey_prf#4110,l_discount_prf#4111,l_partkey_and_l_suppkey_prf#4112,l_commitdate_prf#4113,l_suppkey_prf#4114,l_orderkey_prf#4115] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4136 AS o_shippriority_prf_1#4146, rid#4137 AS rid_1#4147, o_orderdate_prf#4138 AS o_orderdate_prf_1#4148, o_custkey_prf#4139 AS o_custkey_prf_1#4149, o_orderpriority_prf#4140 AS o_orderpriority_prf_1#4150, o_clerk_prf#4141 AS o_clerk_prf_1#4151, o_orderstatus_prf#4142 AS o_orderstatus_prf_1#4152, o_totalprice_prf#4143 AS o_totalprice_prf_1#4153, o_orderkey_prf#4144 AS o_orderkey_prf_1#4154, o_comment_prf#4145 AS o_comment_prf_1#4155]
            +- Relation[o_shippriority_prf#4136,rid#4137,o_orderdate_prf#4138,o_custkey_prf#4139,o_orderpriority_prf#4140,o_clerk_prf#4141,o_orderstatus_prf#4142,o_totalprice_prf#4143,o_orderkey_prf#4144,o_comment_prf#4145] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 114489ms

j4=
select * from nation, customer where n_nationkey = c_nationkey
19/10/14 22:01:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:01:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4200L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Filter isnotnull(n_nationkey#108L)
         :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 22:01:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4200L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#4212]
         :  +- DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_0#4207: string
         :     :- Project [rid#4202 AS rid_0#4207, n_regionkey_prf#4203 AS n_regionkey_prf_0#4208, n_nationkey_prf#4204 AS n_nationkey_prf_0#4209, n_name_prf#4205 AS n_name_prf_0#4210, n_comment_prf#4206 AS n_comment_prf_0#4211]
         :     :  +- Relation[rid#4202,n_regionkey_prf#4203,n_nationkey_prf#4204,n_name_prf#4205,n_comment_prf#4206] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4213 AS c_acctbal_prf_1#4222, rid#4214 AS rid_1#4223, c_name_prf#4215 AS c_name_prf_1#4224, c_nationkey_prf#4216 AS c_nationkey_prf_1#4225, c_custkey_prf#4217 AS c_custkey_prf_1#4226, c_comment_prf#4218 AS c_comment_prf_1#4227, c_address_prf#4219 AS c_address_prf_1#4228, c_mktsegment_prf#4220 AS c_mktsegment_prf_1#4229, c_phone_prf#4221 AS c_phone_prf_1#4230]
            +- Relation[c_acctbal_prf#4213,rid#4214,c_name_prf#4215,c_nationkey_prf#4216,c_custkey_prf#4217,c_comment_prf#4218,c_address_prf#4219,c_mktsegment_prf#4220,c_phone_prf#4221] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=150000
Elapsed time: 1939ms

j6=
select * from partsupp, lineitem where ps_partkey = l_partkey and ps_suppkey = l_suppkey
19/10/14 22:01:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:01:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4269L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, ((ps_partkey#32L = l_partkey#307L) && (ps_suppkey#33L = l_suppkey#308L))
         :- Project [ps_partkey#32L, ps_suppkey#33L]
         :  +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [l_partkey#307L, l_suppkey#308L]
            +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 22:01:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4269L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#4285]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, rid_0#4279: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#4271 AS ps_partkey_and_ps_suppkey_prf_0#4278, rid#4272 AS rid_0#4279, ps_availqty_prf#4273 AS ps_availqty_prf_0#4280, ps_comment_prf#4274 AS ps_comment_prf_0#4281, ps_partkey_prf#4275 AS ps_partkey_prf_0#4282, ps_supplycost_prf#4276 AS ps_supplycost_prf_0#4283, ps_suppkey_prf#4277 AS ps_suppkey_prf_0#4284]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#4271,rid#4272,ps_availqty_prf#4273,ps_comment_prf#4274,ps_partkey_prf#4275,ps_supplycost_prf#4276,ps_suppkey_prf#4277] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4286 AS l_returnflag_prf_1#4305, l_orderkey_and_l_linenumber_prf#4287 AS l_orderkey_and_l_linenumber_prf_1#4306, l_comment_prf#4288 AS l_comment_prf_1#4307, l_linestatus_prf#4289 AS l_linestatus_prf_1#4308, rid#4290 AS rid_1#4309, l_shipmode_prf#4291 AS l_shipmode_prf_1#4310, l_shipinstruct_prf#4292 AS l_shipinstruct_prf_1#4311, l_quantity_prf#4293 AS l_quantity_prf_1#4312, l_receiptdate_prf#4294 AS l_receiptdate_prf_1#4313, l_linenumber_prf#4295 AS l_linenumber_prf_1#4314, l_tax_prf#4296 AS l_tax_prf_1#4315, l_shipdate_prf#4297 AS l_shipdate_prf_1#4316, l_extendedprice_prf#4298 AS l_extendedprice_prf_1#4317, l_partkey_prf#4299 AS l_partkey_prf_1#4318, l_discount_prf#4300 AS l_discount_prf_1#4319, l_partkey_and_l_suppkey_prf#4301 AS l_partkey_and_l_suppkey_prf_1#4320, l_commitdate_prf#4302 AS l_commitdate_prf_1#4321, l_suppkey_prf#4303 AS l_suppkey_prf_1#4322, l_orderkey_prf#4304 AS l_orderkey_prf_1#4323]
            +- Relation[l_returnflag_prf#4286,l_orderkey_and_l_linenumber_prf#4287,l_comment_prf#4288,l_linestatus_prf#4289,rid#4290,l_shipmode_prf#4291,l_shipinstruct_prf#4292,l_quantity_prf#4293,l_receiptdate_prf#4294,l_linenumber_prf#4295,l_tax_prf#4296,l_shipdate_prf#4297,l_extendedprice_prf#4298,l_partkey_prf#4299,l_discount_prf#4300,l_partkey_and_l_suppkey_prf#4301,l_commitdate_prf#4302,l_suppkey_prf#4303,l_orderkey_prf#4304] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 116707ms

r1e=
select * from customer, orders, lineitem where o_orderkey = l_orderkey and c_custkey = o_custkey
19/10/14 22:03:29 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:03:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4386L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :- Project [c_custkey#290L]
         :  +- Filter isnotnull(c_custkey#290L)
         :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [o_custkey#343L]
            +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
               :- Project [o_orderkey#342L, o_custkey#343L]
               :  +- Filter (isnotnull(o_orderkey#342L) && isnotnull(o_custkey#343L))
               :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               +- Project [l_orderkey#306L]
                  +- Filter isnotnull(l_orderkey#306L)
                     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 22:03:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4386L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#4406]
         :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4398: string
         :     :- Project [c_acctbal_prf#4388 AS c_acctbal_prf_0#4397, rid#4389 AS rid_0#4398, c_name_prf#4390 AS c_name_prf_0#4399, c_nationkey_prf#4391 AS c_nationkey_prf_0#4400, c_custkey_prf#4392 AS c_custkey_prf_0#4401, c_comment_prf#4393 AS c_comment_prf_0#4402, c_address_prf#4394 AS c_address_prf_0#4403, c_mktsegment_prf#4395 AS c_mktsegment_prf_0#4404, c_phone_prf#4396 AS c_phone_prf_0#4405]
         :     :  +- Relation[c_acctbal_prf#4388,rid#4389,c_name_prf#4390,c_nationkey_prf#4391,c_custkey_prf#4392,c_comment_prf#4393,c_address_prf#4394,c_mktsegment_prf#4395,c_phone_prf#4396] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1508) AS rid_2#4427]
            :  +- DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#4418: string
            :     :- Project [o_shippriority_prf#4407 AS o_shippriority_prf_1#4417, rid#4408 AS rid_1#4418, o_orderdate_prf#4409 AS o_orderdate_prf_1#4419, o_custkey_prf#4410 AS o_custkey_prf_1#4420, o_orderpriority_prf#4411 AS o_orderpriority_prf_1#4421, o_clerk_prf#4412 AS o_clerk_prf_1#4422, o_orderstatus_prf#4413 AS o_orderstatus_prf_1#4423, o_totalprice_prf#4414 AS o_totalprice_prf_1#4424, o_orderkey_prf#4415 AS o_orderkey_prf_1#4425, o_comment_prf#4416 AS o_comment_prf_1#4426]
            :     :  +- Relation[o_shippriority_prf#4407,rid#4408,o_orderdate_prf#4409,o_custkey_prf#4410,o_orderpriority_prf#4411,o_clerk_prf#4412,o_orderstatus_prf#4413,o_totalprice_prf#4414,o_orderkey_prf#4415,o_comment_prf#4416] JDBCRelation(orders_prf) [numPartitions=1]
            :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [l_returnflag_prf#4428 AS l_returnflag_prf_2#4447, l_orderkey_and_l_linenumber_prf#4429 AS l_orderkey_and_l_linenumber_prf_2#4448, l_comment_prf#4430 AS l_comment_prf_2#4449, l_linestatus_prf#4431 AS l_linestatus_prf_2#4450, rid#4432 AS rid_2#4451, l_shipmode_prf#4433 AS l_shipmode_prf_2#4452, l_shipinstruct_prf#4434 AS l_shipinstruct_prf_2#4453, l_quantity_prf#4435 AS l_quantity_prf_2#4454, l_receiptdate_prf#4436 AS l_receiptdate_prf_2#4455, l_linenumber_prf#4437 AS l_linenumber_prf_2#4456, l_tax_prf#4438 AS l_tax_prf_2#4457, l_shipdate_prf#4439 AS l_shipdate_prf_2#4458, l_extendedprice_prf#4440 AS l_extendedprice_prf_2#4459, l_partkey_prf#4441 AS l_partkey_prf_2#4460, l_discount_prf#4442 AS l_discount_prf_2#4461, l_partkey_and_l_suppkey_prf#4443 AS l_partkey_and_l_suppkey_prf_2#4462, l_commitdate_prf#4444 AS l_commitdate_prf_2#4463, l_suppkey_prf#4445 AS l_suppkey_prf_2#4464, l_orderkey_prf#4446 AS l_orderkey_prf_2#4465]
               +- Relation[l_returnflag_prf#4428,l_orderkey_and_l_linenumber_prf#4429,l_comment_prf#4430,l_linestatus_prf#4431,rid#4432,l_shipmode_prf#4433,l_shipinstruct_prf#4434,l_quantity_prf#4435,l_receiptdate_prf#4436,l_linenumber_prf#4437,l_tax_prf#4438,l_shipdate_prf#4439,l_extendedprice_prf#4440,l_partkey_prf#4441,l_discount_prf#4442,l_partkey_and_l_suppkey_prf#4443,l_commitdate_prf#4444,l_suppkey_prf#4445,l_orderkey_prf#4446] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 234431ms

t3b=
select * from part, lineitem, supplier where p_partkey = l_partkey and l_suppkey = s_suppkey
19/10/14 22:07:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:07:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4539L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_partkey#307L, l_suppkey#308L]
         :        +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :           +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 22:07:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4539L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#4561]
         :  :  :  +- DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#4553: string
         :  :  :     :- Project [p_comment_prf#4541 AS p_comment_prf_0#4551, p_name_prf#4542 AS p_name_prf_0#4552, rid#4543 AS rid_0#4553, p_type_prf#4544 AS p_type_prf_0#4554, p_retailprice_prf#4545 AS p_retailprice_prf_0#4555, p_mfgr_prf#4546 AS p_mfgr_prf_0#4556, p_container_prf#4547 AS p_container_prf_0#4557, p_brand_prf#4548 AS p_brand_prf_0#4558, p_size_prf#4549 AS p_size_prf_0#4559, p_partkey_prf#4550 AS p_partkey_prf_0#4560]
         :  :  :     :  +- Relation[p_comment_prf#4541,p_name_prf#4542,rid#4543,p_type_prf#4544,p_retailprice_prf#4545,p_mfgr_prf#4546,p_container_prf#4547,p_brand_prf#4548,p_size_prf#4549,p_partkey_prf#4550] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#4562 AS l_returnflag_prf_1#4581, l_orderkey_and_l_linenumber_prf#4563 AS l_orderkey_and_l_linenumber_prf_1#4582, l_comment_prf#4564 AS l_comment_prf_1#4583, l_linestatus_prf#4565 AS l_linestatus_prf_1#4584, rid#4566 AS rid_1#4585, l_shipmode_prf#4567 AS l_shipmode_prf_1#4586, l_shipinstruct_prf#4568 AS l_shipinstruct_prf_1#4587, l_quantity_prf#4569 AS l_quantity_prf_1#4588, l_receiptdate_prf#4570 AS l_receiptdate_prf_1#4589, l_linenumber_prf#4571 AS l_linenumber_prf_1#4590, l_tax_prf#4572 AS l_tax_prf_1#4591, l_shipdate_prf#4573 AS l_shipdate_prf_1#4592, l_extendedprice_prf#4574 AS l_extendedprice_prf_1#4593, l_partkey_prf#4575 AS l_partkey_prf_1#4594, l_discount_prf#4576 AS l_discount_prf_1#4595, l_partkey_and_l_suppkey_prf#4577 AS l_partkey_and_l_suppkey_prf_1#4596, l_commitdate_prf#4578 AS l_commitdate_prf_1#4597, l_suppkey_prf#4579 AS l_suppkey_prf_1#4598, l_orderkey_prf#4580 AS l_orderkey_prf_1#4599]
         :  :     +- Relation[l_returnflag_prf#4562,l_orderkey_and_l_linenumber_prf#4563,l_comment_prf#4564,l_linestatus_prf#4565,rid#4566,l_shipmode_prf#4567,l_shipinstruct_prf#4568,l_quantity_prf#4569,l_receiptdate_prf#4570,l_linenumber_prf#4571,l_tax_prf#4572,l_shipdate_prf#4573,l_extendedprice_prf#4574,l_partkey_prf#4575,l_discount_prf#4576,l_partkey_and_l_suppkey_prf#4577,l_commitdate_prf#4578,l_suppkey_prf#4579,l_orderkey_prf#4580] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1508) AS rid_2#4620]
         :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#4619]
         :        :  +- Relation[l_returnflag_prf#4600,l_orderkey_and_l_linenumber_prf#4601,l_comment_prf#4602,l_linestatus_prf#4603,rid#4604,l_shipmode_prf#4605,l_shipinstruct_prf#4606,l_quantity_prf#4607,l_receiptdate_prf#4608,l_linenumber_prf#4609,l_tax_prf#4610,l_shipdate_prf#4611,l_extendedprice_prf#4612,l_partkey_prf#4613,l_discount_prf#4614,l_partkey_and_l_suppkey_prf#4615,l_commitdate_prf#4616,l_suppkey_prf#4617,l_orderkey_prf#4618] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#4621 AS s_phone_prf_2#4629, rid#4622 AS rid_2#4630, s_address_prf#4623 AS s_address_prf_2#4631, s_nationkey_prf#4624 AS s_nationkey_prf_2#4632, s_suppkey_prf#4625 AS s_suppkey_prf_2#4633, s_name_prf#4626 AS s_name_prf_2#4634, s_acctbal_prf#4627 AS s_acctbal_prf_2#4635, s_comment_prf#4628 AS s_comment_prf_2#4636]
            +- Relation[s_phone_prf#4621,rid#4622,s_address_prf#4623,s_nationkey_prf#4624,s_suppkey_prf#4625,s_name_prf#4626,s_acctbal_prf#4627,s_comment_prf#4628] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 196625ms

j2=
select * from supplier, partsupp where s_suppkey = ps_suppkey
19/10/14 22:10:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:10:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4689L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Filter isnotnull(s_suppkey#18L)
         :     +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Filter isnotnull(ps_suppkey#33L)
               +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/14 22:10:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4689L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['s_phone_prf_0, 'rid_0, 's_address_prf_0, 's_nationkey_prf_0, 's_suppkey_prf_0, 's_name_prf_0, 's_acctbal_prf_0, 's_comment_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#4707]
         :  +- DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, rid_0#4700: string
         :     :- Project [s_phone_prf#4691 AS s_phone_prf_0#4699, rid#4692 AS rid_0#4700, s_address_prf#4693 AS s_address_prf_0#4701, s_nationkey_prf#4694 AS s_nationkey_prf_0#4702, s_suppkey_prf#4695 AS s_suppkey_prf_0#4703, s_name_prf#4696 AS s_name_prf_0#4704, s_acctbal_prf#4697 AS s_acctbal_prf_0#4705, s_comment_prf#4698 AS s_comment_prf_0#4706]
         :     :  +- Relation[s_phone_prf#4691,rid#4692,s_address_prf#4693,s_nationkey_prf#4694,s_suppkey_prf#4695,s_name_prf#4696,s_acctbal_prf#4697,s_comment_prf#4698] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4708 AS ps_partkey_and_ps_suppkey_prf_1#4715, rid#4709 AS rid_1#4716, ps_availqty_prf#4710 AS ps_availqty_prf_1#4717, ps_comment_prf#4711 AS ps_comment_prf_1#4718, ps_partkey_prf#4712 AS ps_partkey_prf_1#4719, ps_supplycost_prf#4713 AS ps_supplycost_prf_1#4720, ps_suppkey_prf#4714 AS ps_suppkey_prf_1#4721]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4708,rid#4709,ps_availqty_prf#4710,ps_comment_prf#4711,ps_partkey_prf#4712,ps_supplycost_prf#4713,ps_suppkey_prf#4714] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 10974ms

t1b=
select * from nation, supplier, customer where n_nationkey = s_nationkey and n_nationkey = c_nationkey
19/10/14 22:10:51 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:10:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4759L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :- Project [n_nationkey#108L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter isnotnull(n_nationkey#108L)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_nationkey#21L]
         :        +- Filter isnotnull(s_nationkey#21L)
         :           +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [c_nationkey#293L]
            +- Filter isnotnull(c_nationkey#293L)
               +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/14 22:10:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4759L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#4771]
         :  :  :  +- DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#4766: string
         :  :  :     :- Project [rid#4761 AS rid_0#4766, n_regionkey_prf#4762 AS n_regionkey_prf_0#4767, n_nationkey_prf#4763 AS n_nationkey_prf_0#4768, n_name_prf#4764 AS n_name_prf_0#4769, n_comment_prf#4765 AS n_comment_prf_0#4770]
         :  :  :     :  +- Relation[rid#4761,n_regionkey_prf#4762,n_nationkey_prf#4763,n_name_prf#4764,n_comment_prf#4765] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [s_phone_prf#4772 AS s_phone_prf_1#4780, rid#4773 AS rid_1#4781, s_address_prf#4774 AS s_address_prf_1#4782, s_nationkey_prf#4775 AS s_nationkey_prf_1#4783, s_suppkey_prf#4776 AS s_suppkey_prf_1#4784, s_name_prf#4777 AS s_name_prf_1#4785, s_acctbal_prf#4778 AS s_acctbal_prf_1#4786, s_comment_prf#4779 AS s_comment_prf_1#4787]
         :  :     +- Relation[s_phone_prf#4772,rid#4773,s_address_prf#4774,s_nationkey_prf#4775,s_suppkey_prf#4776,s_name_prf#4777,s_acctbal_prf#4778,s_comment_prf#4779] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1508) AS rid_2#4794]
         :     +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4793]
         :        :  +- Relation[rid#4788,n_regionkey_prf#4789,n_nationkey_prf#4790,n_name_prf#4791,n_comment_prf#4792] JDBCRelation(nation_prf) [numPartitions=1]
         :        +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4795 AS c_acctbal_prf_2#4804, rid#4796 AS rid_2#4805, c_name_prf#4797 AS c_name_prf_2#4806, c_nationkey_prf#4798 AS c_nationkey_prf_2#4807, c_custkey_prf#4799 AS c_custkey_prf_2#4808, c_comment_prf#4800 AS c_comment_prf_2#4809, c_address_prf#4801 AS c_address_prf_2#4810, c_mktsegment_prf#4802 AS c_mktsegment_prf_2#4811, c_phone_prf#4803 AS c_phone_prf_2#4812]
            +- Relation[c_acctbal_prf#4795,rid#4796,c_name_prf#4797,c_nationkey_prf#4798,c_custkey_prf#4799,c_comment_prf#4800,c_address_prf#4801,c_mktsegment_prf#4802,c_phone_prf#4803] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=60000414
Elapsed time: 20101ms

r1c=
select * from lineitem, orders, customer where c_custkey = o_custkey and l_orderkey = o_orderkey
19/10/14 22:11:11 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:11:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4871L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter isnotnull(l_orderkey#306L)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Filter isnotnull(c_custkey#290L)
               :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
                     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/14 22:11:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4871L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_2#4911]
         :  +- DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4896: string
         :     :- Project [l_returnflag_prf#4873 AS l_returnflag_prf_0#4892, l_orderkey_and_l_linenumber_prf#4874 AS l_orderkey_and_l_linenumber_prf_0#4893, l_comment_prf#4875 AS l_comment_prf_0#4894, l_linestatus_prf#4876 AS l_linestatus_prf_0#4895, rid#4877 AS rid_0#4896, l_shipmode_prf#4878 AS l_shipmode_prf_0#4897, l_shipinstruct_prf#4879 AS l_shipinstruct_prf_0#4898, l_quantity_prf#4880 AS l_quantity_prf_0#4899, l_receiptdate_prf#4881 AS l_receiptdate_prf_0#4900, l_linenumber_prf#4882 AS l_linenumber_prf_0#4901, l_tax_prf#4883 AS l_tax_prf_0#4902, l_shipdate_prf#4884 AS l_shipdate_prf_0#4903, l_extendedprice_prf#4885 AS l_extendedprice_prf_0#4904, l_partkey_prf#4886 AS l_partkey_prf_0#4905, l_discount_prf#4887 AS l_discount_prf_0#4906, l_partkey_and_l_suppkey_prf#4888 AS l_partkey_and_l_suppkey_prf_0#4907, l_commitdate_prf#4889 AS l_commitdate_prf_0#4908, l_suppkey_prf#4890 AS l_suppkey_prf_0#4909, l_orderkey_prf#4891 AS l_orderkey_prf_0#4910]
         :     :  +- Relation[l_returnflag_prf#4873,l_orderkey_and_l_linenumber_prf#4874,l_comment_prf#4875,l_linestatus_prf#4876,rid#4877,l_shipmode_prf#4878,l_shipinstruct_prf#4879,l_quantity_prf#4880,l_receiptdate_prf#4881,l_linenumber_prf#4882,l_tax_prf#4883,l_shipdate_prf#4884,l_extendedprice_prf#4885,l_partkey_prf#4886,l_discount_prf#4887,l_partkey_and_l_suppkey_prf#4888,l_commitdate_prf#4889,l_suppkey_prf#4890,l_orderkey_prf#4891] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['c_acctbal_prf_1, 'rid_1, 'c_name_prf_1, 'c_nationkey_prf_1, 'c_custkey_prf_1, 'c_comment_prf_1, 'c_address_prf_1, 'c_mktsegment_prf_1, 'c_phone_prf_1, dexdecrypt('value_dec_key, value#1508) AS rid_2#4930]
            :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_1#4922: string
            :     :- Project [c_acctbal_prf#4912 AS c_acctbal_prf_1#4921, rid#4913 AS rid_1#4922, c_name_prf#4914 AS c_name_prf_1#4923, c_nationkey_prf#4915 AS c_nationkey_prf_1#4924, c_custkey_prf#4916 AS c_custkey_prf_1#4925, c_comment_prf#4917 AS c_comment_prf_1#4926, c_address_prf#4918 AS c_address_prf_1#4927, c_mktsegment_prf#4919 AS c_mktsegment_prf_1#4928, c_phone_prf#4920 AS c_phone_prf_1#4929]
            :     :  +- Relation[c_acctbal_prf#4912,rid#4913,c_name_prf#4914,c_nationkey_prf#4915,c_custkey_prf#4916,c_comment_prf#4917,c_address_prf#4918,c_mktsegment_prf#4919,c_phone_prf#4920] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#4931 AS o_shippriority_prf_2#4941, rid#4932 AS rid_2#4942, o_orderdate_prf#4933 AS o_orderdate_prf_2#4943, o_custkey_prf#4934 AS o_custkey_prf_2#4944, o_orderpriority_prf#4935 AS o_orderpriority_prf_2#4945, o_clerk_prf#4936 AS o_clerk_prf_2#4946, o_orderstatus_prf#4937 AS o_orderstatus_prf_2#4947, o_totalprice_prf#4938 AS o_totalprice_prf_2#4948, o_orderkey_prf#4939 AS o_orderkey_prf_2#4949, o_comment_prf#4940 AS o_comment_prf_2#4950]
               +- Relation[o_shippriority_prf#4931,rid#4932,o_orderdate_prf#4933,o_custkey_prf#4934,o_orderpriority_prf#4935,o_clerk_prf#4936,o_orderstatus_prf#4937,o_totalprice_prf#4938,o_orderkey_prf#4939,o_comment_prf#4940] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 158022ms

b1b=
select * from partsupp, part where ps_partkey = p_partkey and p_size = 15
19/10/14 22:13:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:13:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5006L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_partkey#32L = p_partkey#360L)
         :- Project [ps_partkey#32L]
         :  +- Filter isnotnull(ps_partkey#32L)
         :     +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [p_partkey#360L]
            +- Filter ((isnotnull(p_size#364) && (p_size#364 = 15)) && isnotnull(p_partkey#360L))
               +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet

19/10/14 22:13:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5006L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['ps_partkey_and_ps_suppkey_prf_0, 'rid_0, 'ps_availqty_prf_0, 'ps_comment_prf_0, 'ps_partkey_prf_0, 'ps_supplycost_prf_0, 'ps_suppkey_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#5022]
         :  +- DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, rid_0#5016: string
         :     :- Project [ps_partkey_and_ps_suppkey_prf#5008 AS ps_partkey_and_ps_suppkey_prf_0#5015, rid#5009 AS rid_0#5016, ps_availqty_prf#5010 AS ps_availqty_prf_0#5017, ps_comment_prf#5011 AS ps_comment_prf_0#5018, ps_partkey_prf#5012 AS ps_partkey_prf_0#5019, ps_supplycost_prf#5013 AS ps_supplycost_prf_0#5020, ps_suppkey_prf#5014 AS ps_suppkey_prf_0#5021]
         :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#5008,rid#5009,ps_availqty_prf#5010,ps_comment_prf#5011,ps_partkey_prf#5012,ps_supplycost_prf#5013,ps_suppkey_prf#5014] JDBCRelation(partsupp_prf) [numPartitions=1]
         :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- Project [p_comment_prf#5023 AS p_comment_prf_1#5033, p_name_prf#5024 AS p_name_prf_1#5034, rid#5025 AS rid_1#5035, p_type_prf#5026 AS p_type_prf_1#5036, p_retailprice_prf#5027 AS p_retailprice_prf_1#5037, p_mfgr_prf#5028 AS p_mfgr_prf_1#5038, p_container_prf#5029 AS p_container_prf_1#5039, p_brand_prf#5030 AS p_brand_prf_1#5040, p_size_prf#5031 AS p_size_prf_1#5041, p_partkey_prf#5032 AS p_partkey_prf_1#5042]
            :  +- Relation[p_comment_prf#5023,p_name_prf#5024,rid#5025,p_type_prf#5026,p_retailprice_prf#5027,p_mfgr_prf#5028,p_container_prf#5029,p_brand_prf#5030,p_size_prf#5031,p_partkey_prf#5032] JDBCRelation(part_prf) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#5043]
               +- DexRidFilter part~p_size~15
                  +- Relation[label#1765,value#1766] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=15628
Elapsed time: 49784ms

t3a=
select * from lineitem, part, supplier where l_partkey = p_partkey and l_suppkey = s_suppkey
19/10/14 22:14:38 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:14:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5096L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :- Project [l_suppkey#308L]
         :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :- Project [l_partkey#307L, l_suppkey#308L]
         :     :  +- Filter (isnotnull(l_partkey#307L) && isnotnull(l_suppkey#308L))
         :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     +- Project [p_partkey#360L]
         :        +- Filter isnotnull(p_partkey#360L)
         :           +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 22:14:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5096L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#5136]
         :  :  :  +- DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, rid_0#5121: string
         :  :  :     :- Project [l_returnflag_prf#5098 AS l_returnflag_prf_0#5117, l_orderkey_and_l_linenumber_prf#5099 AS l_orderkey_and_l_linenumber_prf_0#5118, l_comment_prf#5100 AS l_comment_prf_0#5119, l_linestatus_prf#5101 AS l_linestatus_prf_0#5120, rid#5102 AS rid_0#5121, l_shipmode_prf#5103 AS l_shipmode_prf_0#5122, l_shipinstruct_prf#5104 AS l_shipinstruct_prf_0#5123, l_quantity_prf#5105 AS l_quantity_prf_0#5124, l_receiptdate_prf#5106 AS l_receiptdate_prf_0#5125, l_linenumber_prf#5107 AS l_linenumber_prf_0#5126, l_tax_prf#5108 AS l_tax_prf_0#5127, l_shipdate_prf#5109 AS l_shipdate_prf_0#5128, l_extendedprice_prf#5110 AS l_extendedprice_prf_0#5129, l_partkey_prf#5111 AS l_partkey_prf_0#5130, l_discount_prf#5112 AS l_discount_prf_0#5131, l_partkey_and_l_suppkey_prf#5113 AS l_partkey_and_l_suppkey_prf_0#5132, l_commitdate_prf#5114 AS l_commitdate_prf_0#5133, l_suppkey_prf#5115 AS l_suppkey_prf_0#5134, l_orderkey_prf#5116 AS l_orderkey_prf_0#5135]
         :  :  :     :  +- Relation[l_returnflag_prf#5098,l_orderkey_and_l_linenumber_prf#5099,l_comment_prf#5100,l_linestatus_prf#5101,rid#5102,l_shipmode_prf#5103,l_shipinstruct_prf#5104,l_quantity_prf#5105,l_receiptdate_prf#5106,l_linenumber_prf#5107,l_tax_prf#5108,l_shipdate_prf#5109,l_extendedprice_prf#5110,l_partkey_prf#5111,l_discount_prf#5112,l_partkey_and_l_suppkey_prf#5113,l_commitdate_prf#5114,l_suppkey_prf#5115,l_orderkey_prf#5116] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [p_comment_prf#5137 AS p_comment_prf_1#5147, p_name_prf#5138 AS p_name_prf_1#5148, rid#5139 AS rid_1#5149, p_type_prf#5140 AS p_type_prf_1#5150, p_retailprice_prf#5141 AS p_retailprice_prf_1#5151, p_mfgr_prf#5142 AS p_mfgr_prf_1#5152, p_container_prf#5143 AS p_container_prf_1#5153, p_brand_prf#5144 AS p_brand_prf_1#5154, p_size_prf#5145 AS p_size_prf_1#5155, p_partkey_prf#5146 AS p_partkey_prf_1#5156]
         :  :     +- Relation[p_comment_prf#5137,p_name_prf#5138,rid#5139,p_type_prf#5140,p_retailprice_prf#5141,p_mfgr_prf#5142,p_container_prf#5143,p_brand_prf#5144,p_size_prf#5145,p_partkey_prf#5146] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1508) AS rid_2#5177]
         :     +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#5176]
         :        :  +- Relation[l_returnflag_prf#5157,l_orderkey_and_l_linenumber_prf#5158,l_comment_prf#5159,l_linestatus_prf#5160,rid#5161,l_shipmode_prf#5162,l_shipinstruct_prf#5163,l_quantity_prf#5164,l_receiptdate_prf#5165,l_linenumber_prf#5166,l_tax_prf#5167,l_shipdate_prf#5168,l_extendedprice_prf#5169,l_partkey_prf#5170,l_discount_prf#5171,l_partkey_and_l_suppkey_prf#5172,l_commitdate_prf#5173,l_suppkey_prf#5174,l_orderkey_prf#5175] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5178 AS s_phone_prf_2#5186, rid#5179 AS rid_2#5187, s_address_prf#5180 AS s_address_prf_2#5188, s_nationkey_prf#5181 AS s_nationkey_prf_2#5189, s_suppkey_prf#5182 AS s_suppkey_prf_2#5190, s_name_prf#5183 AS s_name_prf_2#5191, s_acctbal_prf#5184 AS s_acctbal_prf_2#5192, s_comment_prf#5185 AS s_comment_prf_2#5193]
            +- Relation[s_phone_prf#5178,rid#5179,s_address_prf#5180,s_nationkey_prf#5181,s_suppkey_prf#5182,s_name_prf#5183,s_acctbal_prf#5184,s_comment_prf#5185] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 222746ms

t2b=
select * from part, partsupp, supplier where p_partkey = ps_partkey and ps_suppkey = s_suppkey
19/10/14 22:18:21 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:18:21 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5255L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter isnotnull(p_partkey#360L)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Filter (isnotnull(ps_partkey#32L) && isnotnull(ps_suppkey#33L))
         :           +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Filter isnotnull(s_suppkey#18L)
               +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/14 22:18:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5255L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#5277]
         :  :  :  +- DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#5269: string
         :  :  :     :- Project [p_comment_prf#5257 AS p_comment_prf_0#5267, p_name_prf#5258 AS p_name_prf_0#5268, rid#5259 AS rid_0#5269, p_type_prf#5260 AS p_type_prf_0#5270, p_retailprice_prf#5261 AS p_retailprice_prf_0#5271, p_mfgr_prf#5262 AS p_mfgr_prf_0#5272, p_container_prf#5263 AS p_container_prf_0#5273, p_brand_prf#5264 AS p_brand_prf_0#5274, p_size_prf#5265 AS p_size_prf_0#5275, p_partkey_prf#5266 AS p_partkey_prf_0#5276]
         :  :  :     :  +- Relation[p_comment_prf#5257,p_name_prf#5258,rid#5259,p_type_prf#5260,p_retailprice_prf#5261,p_mfgr_prf#5262,p_container_prf#5263,p_brand_prf#5264,p_size_prf#5265,p_partkey_prf#5266] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#5278 AS ps_partkey_and_ps_suppkey_prf_1#5285, rid#5279 AS rid_1#5286, ps_availqty_prf#5280 AS ps_availqty_prf_1#5287, ps_comment_prf#5281 AS ps_comment_prf_1#5288, ps_partkey_prf#5282 AS ps_partkey_prf_1#5289, ps_supplycost_prf#5283 AS ps_supplycost_prf_1#5290, ps_suppkey_prf#5284 AS ps_suppkey_prf_1#5291]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#5278,rid#5279,ps_availqty_prf#5280,ps_comment_prf#5281,ps_partkey_prf#5282,ps_supplycost_prf#5283,ps_suppkey_prf#5284] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1508) AS rid_2#5300]
         :     +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5299]
         :        :  +- Relation[ps_partkey_and_ps_suppkey_prf#5292,rid#5293,ps_availqty_prf#5294,ps_comment_prf#5295,ps_partkey_prf#5296,ps_supplycost_prf#5297,ps_suppkey_prf#5298] JDBCRelation(partsupp_prf) [numPartitions=1]
         :        +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [s_phone_prf#5301 AS s_phone_prf_2#5309, rid#5302 AS rid_2#5310, s_address_prf#5303 AS s_address_prf_2#5311, s_nationkey_prf#5304 AS s_nationkey_prf_2#5312, s_suppkey_prf#5305 AS s_suppkey_prf_2#5313, s_name_prf#5306 AS s_name_prf_2#5314, s_acctbal_prf#5307 AS s_acctbal_prf_2#5315, s_comment_prf#5308 AS s_comment_prf_2#5316]
            +- Relation[s_phone_prf#5301,rid#5302,s_address_prf#5303,s_nationkey_prf#5304,s_suppkey_prf#5305,s_name_prf#5306,s_acctbal_prf#5307,s_comment_prf#5308] JDBCRelation(supplier_prf) [numPartitions=1]

DexCorr$ result size=800000
Elapsed time: 83964ms

r1d=
select * from customer, orders, lineitem where c_custkey = o_custkey and o_orderkey = l_orderkey
19/10/14 22:19:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/14 22:19:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5378L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter isnotnull(c_custkey#290L)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Filter (isnotnull(o_custkey#343L) && isnotnull(o_orderkey#342L))
         :           +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Filter isnotnull(l_orderkey#306L)
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/14 22:19:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5378L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1508) AS rid_1#5398]
         :  :  :  +- DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#5390: string
         :  :  :     :- Project [c_acctbal_prf#5380 AS c_acctbal_prf_0#5389, rid#5381 AS rid_0#5390, c_name_prf#5382 AS c_name_prf_0#5391, c_nationkey_prf#5383 AS c_nationkey_prf_0#5392, c_custkey_prf#5384 AS c_custkey_prf_0#5393, c_comment_prf#5385 AS c_comment_prf_0#5394, c_address_prf#5386 AS c_address_prf_0#5395, c_mktsegment_prf#5387 AS c_mktsegment_prf_0#5396, c_phone_prf#5388 AS c_phone_prf_0#5397]
         :  :  :     :  +- Relation[c_acctbal_prf#5380,rid#5381,c_name_prf#5382,c_nationkey_prf#5383,c_custkey_prf#5384,c_comment_prf#5385,c_address_prf#5386,c_mktsegment_prf#5387,c_phone_prf#5388] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :     +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#5399 AS o_shippriority_prf_1#5409, rid#5400 AS rid_1#5410, o_orderdate_prf#5401 AS o_orderdate_prf_1#5411, o_custkey_prf#5402 AS o_custkey_prf_1#5412, o_orderpriority_prf#5403 AS o_orderpriority_prf_1#5413, o_clerk_prf#5404 AS o_clerk_prf_1#5414, o_orderstatus_prf#5405 AS o_orderstatus_prf_1#5415, o_totalprice_prf#5406 AS o_totalprice_prf_1#5416, o_orderkey_prf#5407 AS o_orderkey_prf_1#5417, o_comment_prf#5408 AS o_comment_prf_1#5418]
         :  :     +- Relation[o_shippriority_prf#5399,rid#5400,o_orderdate_prf#5401,o_custkey_prf#5402,o_orderpriority_prf#5403,o_clerk_prf#5404,o_orderstatus_prf#5405,o_totalprice_prf#5406,o_orderkey_prf#5407,o_comment_prf#5408] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1508) AS rid_2#5430]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#5429]
         :        :  +- Relation[o_shippriority_prf#5419,rid#5420,o_orderdate_prf#5421,o_custkey_prf#5422,o_orderpriority_prf#5423,o_clerk_prf#5424,o_orderstatus_prf#5425,o_totalprice_prf#5426,o_orderkey_prf#5427,o_comment_prf#5428] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1507,value#1508] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#5431 AS l_returnflag_prf_2#5450, l_orderkey_and_l_linenumber_prf#5432 AS l_orderkey_and_l_linenumber_prf_2#5451, l_comment_prf#5433 AS l_comment_prf_2#5452, l_linestatus_prf#5434 AS l_linestatus_prf_2#5453, rid#5435 AS rid_2#5454, l_shipmode_prf#5436 AS l_shipmode_prf_2#5455, l_shipinstruct_prf#5437 AS l_shipinstruct_prf_2#5456, l_quantity_prf#5438 AS l_quantity_prf_2#5457, l_receiptdate_prf#5439 AS l_receiptdate_prf_2#5458, l_linenumber_prf#5440 AS l_linenumber_prf_2#5459, l_tax_prf#5441 AS l_tax_prf_2#5460, l_shipdate_prf#5442 AS l_shipdate_prf_2#5461, l_extendedprice_prf#5443 AS l_extendedprice_prf_2#5462, l_partkey_prf#5444 AS l_partkey_prf_2#5463, l_discount_prf#5445 AS l_discount_prf_2#5464, l_partkey_and_l_suppkey_prf#5446 AS l_partkey_and_l_suppkey_prf_2#5465, l_commitdate_prf#5447 AS l_commitdate_prf_2#5466, l_suppkey_prf#5448 AS l_suppkey_prf_2#5467, l_orderkey_prf#5449 AS l_orderkey_prf_2#5468]
            +- Relation[l_returnflag_prf#5431,l_orderkey_and_l_linenumber_prf#5432,l_comment_prf#5433,l_linestatus_prf#5434,rid#5435,l_shipmode_prf#5436,l_shipinstruct_prf#5437,l_quantity_prf#5438,l_receiptdate_prf#5439,l_linenumber_prf#5440,l_tax_prf#5441,l_shipdate_prf#5442,l_extendedprice_prf#5443,l_partkey_prf#5444,l_discount_prf#5445,l_partkey_and_l_suppkey_prf#5446,l_commitdate_prf#5447,l_suppkey_prf#5448,l_orderkey_prf#5449] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 237081ms
query=b1a, count=15628, duration=5876
query=b1b, count=15628, duration=49784
query=b2a, count=1478870, duration=198023
query=b2b, count=1478870, duration=54305
query=f1, count=1, duration=54
query=f2, count=3907, duration=135
query=f3, count=1451, duration=2230
query=f4, count=1, duration=53
query=f5, count=1478870, duration=23470
query=f6, count=857401, duration=13719
query=j1, count=800000, duration=32008
query=j10, count=6001215, duration=86752
query=j2, count=800000, duration=10974
query=j3, count=25, duration=68
query=j4, count=150000, duration=1939
query=j5, count=10000, duration=199
query=j6, count=6001215, duration=116707
query=j7, count=1500000, duration=40390
query=j8, count=6001215, duration=195937
query=j8b, count=6001215, duration=114489
query=j9, count=6001215, duration=94232
query=j9b, count=6001215, duration=116689
query=r1a, count=6001215, duration=170422
query=r1b, count=6001215, duration=148698
query=r1c, count=6001215, duration=158022
query=r1d, count=6001215, duration=237081
query=r1e, count=6001215, duration=234431
query=r1f, count=6001215, duration=156854
query=t1a, count=60000414, duration=49761
query=t1b, count=60000414, duration=20101
query=t1c, count=60000414, duration=64329
query=t2a, count=800000, duration=105515
query=t2b, count=800000, duration=83964
query=t2c, count=800000, duration=42847
query=t2d, count=800000, duration=61767
query=t3a, count=6001215, duration=222746
query=t3b, count=6001215, duration=196625
query=t3c, count=6001215, duration=186854
query=t3d, count=6001215, duration=186697
