19/10/22 00:31:09 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7154ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Tue Oct 22 00:31:11 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Tue Oct 22 00:31:12 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Tue Oct 22 00:31:12 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Tue Oct 22 00:31:13 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Tue Oct 22 00:31:13 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Tue Oct 22 00:31:15 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Tue Oct 22 00:31:17 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Tue Oct 22 00:31:17 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
19/10/22 00:31:19 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 00:31:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1964L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/22 00:31:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1964L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#1966 AS l_returnflag_prf_0#1985, l_orderkey_and_l_linenumber_prf#1967 AS l_orderkey_and_l_linenumber_prf_0#1986, l_comment_prf#1968 AS l_comment_prf_0#1987, l_linestatus_prf#1969 AS l_linestatus_prf_0#1988, rid#1970 AS rid_0#1989, l_shipmode_prf#1971 AS l_shipmode_prf_0#1990, l_shipinstruct_prf#1972 AS l_shipinstruct_prf_0#1991, l_quantity_prf#1973 AS l_quantity_prf_0#1992, l_receiptdate_prf#1974 AS l_receiptdate_prf_0#1993, l_linenumber_prf#1975 AS l_linenumber_prf_0#1994, l_tax_prf#1976 AS l_tax_prf_0#1995, l_shipdate_prf#1977 AS l_shipdate_prf_0#1996, l_extendedprice_prf#1978 AS l_extendedprice_prf_0#1997, l_partkey_prf#1979 AS l_partkey_prf_0#1998, l_discount_prf#1980 AS l_discount_prf_0#1999, l_partkey_and_l_suppkey_prf#1981 AS l_partkey_and_l_suppkey_prf_0#2000, l_commitdate_prf#1982 AS l_commitdate_prf_0#2001, l_suppkey_prf#1983 AS l_suppkey_prf_0#2002, l_orderkey_prf#1984 AS l_orderkey_prf_0#2003]
         :  :  +- Relation[l_returnflag_prf#1966,l_orderkey_and_l_linenumber_prf#1967,l_comment_prf#1968,l_linestatus_prf#1969,rid#1970,l_shipmode_prf#1971,l_shipinstruct_prf#1972,l_quantity_prf#1973,l_receiptdate_prf#1974,l_linenumber_prf#1975,l_tax_prf#1976,l_shipdate_prf#1977,l_extendedprice_prf#1978,l_partkey_prf#1979,l_discount_prf#1980,l_partkey_and_l_suppkey_prf#1981,l_commitdate_prf#1982,l_suppkey_prf#1983,l_orderkey_prf#1984] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2025) AS rid_1#2026]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2023]
         :        :  +- Relation[l_returnflag_prf#2004,l_orderkey_and_l_linenumber_prf#2005,l_comment_prf#2006,l_linestatus_prf#2007,rid#2008,l_shipmode_prf#2009,l_shipinstruct_prf#2010,l_quantity_prf#2011,l_receiptdate_prf#2012,l_linenumber_prf#2013,l_tax_prf#2014,l_shipdate_prf#2015,l_extendedprice_prf#2016,l_partkey_prf#2017,l_discount_prf#2018,l_partkey_and_l_suppkey_prf#2019,l_commitdate_prf#2020,l_suppkey_prf#2021,l_orderkey_prf#2022] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2027 AS o_shippriority_prf_1#2037, rid#2028 AS rid_1#2038, o_orderdate_prf#2029 AS o_orderdate_prf_1#2039, o_custkey_prf#2030 AS o_custkey_prf_1#2040, o_orderpriority_prf#2031 AS o_orderpriority_prf_1#2041, o_clerk_prf#2032 AS o_clerk_prf_1#2042, o_orderstatus_prf#2033 AS o_orderstatus_prf_1#2043, o_totalprice_prf#2034 AS o_totalprice_prf_1#2044, o_orderkey_prf#2035 AS o_orderkey_prf_1#2045, o_comment_prf#2036 AS o_comment_prf_1#2046]
            +- Relation[o_shippriority_prf#2027,rid#2028,o_orderdate_prf#2029,o_custkey_prf#2030,o_orderpriority_prf#2031,o_clerk_prf#2032,o_orderstatus_prf#2033,o_totalprice_prf#2034,o_orderkey_prf#2035,o_comment_prf#2036] JDBCRelation(orders_prf) [numPartitions=1]

19/10/22 00:31:19 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=6001215
Elapsed time: 98883ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
19/10/22 00:32:58 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 00:32:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2081L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 00:32:58 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 00:32:58 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 00:32:58 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 00:32:58 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 00:32:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2081L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2025) AS rid_1#2107]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2095: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :- Project [p_comment_prf#2083 AS p_comment_prf_0#2093, p_name_prf#2084 AS p_name_prf_0#2094, rid#2085 AS rid_0#2095, p_type_prf#2086 AS p_type_prf_0#2096, p_retailprice_prf#2087 AS p_retailprice_prf_0#2097, p_mfgr_prf#2088 AS p_mfgr_prf_0#2098, p_container_prf#2089 AS p_container_prf_0#2099, p_brand_prf#2090 AS p_brand_prf_0#2100, p_size_prf#2091 AS p_size_prf_0#2101, p_partkey_prf#2092 AS p_partkey_prf_0#2102]
         :     :  :  :  +- Relation[p_comment_prf#2083,p_name_prf#2084,rid#2085,p_type_prf#2086,p_retailprice_prf#2087,p_mfgr_prf#2088,p_container_prf#2089,p_brand_prf#2090,p_size_prf#2091,p_partkey_prf#2092] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2105]
         :     :  :     +- DexRidFilter part~p_brand~Brand#12
         :     :  :        +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2106]
         :     :     +- DexRidFilter part~p_container~SM CASE
         :     :        +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [l_returnflag_prf#2108 AS l_returnflag_prf_1#2127, l_orderkey_and_l_linenumber_prf#2109 AS l_orderkey_and_l_linenumber_prf_1#2128, l_comment_prf#2110 AS l_comment_prf_1#2129, l_linestatus_prf#2111 AS l_linestatus_prf_1#2130, rid#2112 AS rid_1#2131, l_shipmode_prf#2113 AS l_shipmode_prf_1#2132, l_shipinstruct_prf#2114 AS l_shipinstruct_prf_1#2133, l_quantity_prf#2115 AS l_quantity_prf_1#2134, l_receiptdate_prf#2116 AS l_receiptdate_prf_1#2135, l_linenumber_prf#2117 AS l_linenumber_prf_1#2136, l_tax_prf#2118 AS l_tax_prf_1#2137, l_shipdate_prf#2119 AS l_shipdate_prf_1#2138, l_extendedprice_prf#2120 AS l_extendedprice_prf_1#2139, l_partkey_prf#2121 AS l_partkey_prf_1#2140, l_discount_prf#2122 AS l_discount_prf_1#2141, l_partkey_and_l_suppkey_prf#2123 AS l_partkey_and_l_suppkey_prf_1#2142, l_commitdate_prf#2124 AS l_commitdate_prf_1#2143, l_suppkey_prf#2125 AS l_suppkey_prf_1#2144, l_orderkey_prf#2126 AS l_orderkey_prf_1#2145]
            :  :  +- Relation[l_returnflag_prf#2108,l_orderkey_and_l_linenumber_prf#2109,l_comment_prf#2110,l_linestatus_prf#2111,rid#2112,l_shipmode_prf#2113,l_shipinstruct_prf#2114,l_quantity_prf#2115,l_receiptdate_prf#2116,l_linenumber_prf#2117,l_tax_prf#2118,l_shipdate_prf#2119,l_extendedprice_prf#2120,l_partkey_prf#2121,l_discount_prf#2122,l_partkey_and_l_suppkey_prf#2123,l_commitdate_prf#2124,l_suppkey_prf#2125,l_orderkey_prf#2126] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2146]
            :     +- DexRidFilter lineitem~l_shipmode~AIR
            :        +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2147]
               +- DexRidFilter lineitem~l_shipinstruct~DELIVER IN PERSON
                  +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=205
Elapsed time: 26296ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
19/10/22 00:33:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 00:33:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2185L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 00:33:24 WARN DexPlanner: InMemoryFileIndex=customer
19/10/22 00:33:24 WARN DexPlanner: InMemoryFileIndex=customer
19/10/22 00:33:24 WARN DexPlanner: InMemoryFileIndex=customer
19/10/22 00:33:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2185L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2025) AS rid_2#2227]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#2025) AS rid_1#2206]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2197: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [c_acctbal_prf#2187 AS c_acctbal_prf_0#2196, rid#2188 AS rid_0#2197, c_name_prf#2189 AS c_name_prf_0#2198, c_nationkey_prf#2190 AS c_nationkey_prf_0#2199, c_custkey_prf#2191 AS c_custkey_prf_0#2200, c_comment_prf#2192 AS c_comment_prf_0#2201, c_address_prf#2193 AS c_address_prf_0#2202, c_mktsegment_prf#2194 AS c_mktsegment_prf_0#2203, c_phone_prf#2195 AS c_phone_prf_0#2204]
         :     :  :     :  :  +- Relation[c_acctbal_prf#2187,rid#2188,c_name_prf#2189,c_nationkey_prf#2190,c_custkey_prf#2191,c_comment_prf#2192,c_address_prf#2193,c_mktsegment_prf#2194,c_phone_prf#2195] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2205]
         :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :        +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#2207 AS o_shippriority_prf_1#2217, rid#2208 AS rid_1#2218, o_orderdate_prf#2209 AS o_orderdate_prf_1#2219, o_custkey_prf#2210 AS o_custkey_prf_1#2220, o_orderpriority_prf#2211 AS o_orderpriority_prf_1#2221, o_clerk_prf#2212 AS o_clerk_prf_1#2222, o_orderstatus_prf#2213 AS o_orderstatus_prf_1#2223, o_totalprice_prf#2214 AS o_totalprice_prf_1#2224, o_orderkey_prf#2215 AS o_orderkey_prf_1#2225, o_comment_prf#2216 AS o_comment_prf_1#2226]
         :     :     +- Relation[o_shippriority_prf#2207,rid#2208,o_orderdate_prf#2209,o_custkey_prf#2210,o_orderpriority_prf#2211,o_clerk_prf#2212,o_orderstatus_prf#2213,o_totalprice_prf#2214,o_orderkey_prf#2215,o_comment_prf#2216] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2228 AS l_returnflag_prf_2#2247, l_orderkey_and_l_linenumber_prf#2229 AS l_orderkey_and_l_linenumber_prf_2#2248, l_comment_prf#2230 AS l_comment_prf_2#2249, l_linestatus_prf#2231 AS l_linestatus_prf_2#2250, rid#2232 AS rid_2#2251, l_shipmode_prf#2233 AS l_shipmode_prf_2#2252, l_shipinstruct_prf#2234 AS l_shipinstruct_prf_2#2253, l_quantity_prf#2235 AS l_quantity_prf_2#2254, l_receiptdate_prf#2236 AS l_receiptdate_prf_2#2255, l_linenumber_prf#2237 AS l_linenumber_prf_2#2256, l_tax_prf#2238 AS l_tax_prf_2#2257, l_shipdate_prf#2239 AS l_shipdate_prf_2#2258, l_extendedprice_prf#2240 AS l_extendedprice_prf_2#2259, l_partkey_prf#2241 AS l_partkey_prf_2#2260, l_discount_prf#2242 AS l_discount_prf_2#2261, l_partkey_and_l_suppkey_prf#2243 AS l_partkey_and_l_suppkey_prf_2#2262, l_commitdate_prf#2244 AS l_commitdate_prf_2#2263, l_suppkey_prf#2245 AS l_suppkey_prf_2#2264, l_orderkey_prf#2246 AS l_orderkey_prf_2#2265]
            +- Relation[l_returnflag_prf#2228,l_orderkey_and_l_linenumber_prf#2229,l_comment_prf#2230,l_linestatus_prf#2231,rid#2232,l_shipmode_prf#2233,l_shipinstruct_prf#2234,l_quantity_prf#2235,l_receiptdate_prf#2236,l_linenumber_prf#2237,l_tax_prf#2238,l_shipdate_prf#2239,l_extendedprice_prf#2240,l_partkey_prf#2241,l_discount_prf#2242,l_partkey_and_l_suppkey_prf#2243,l_commitdate_prf#2244,l_suppkey_prf#2245,l_orderkey_prf#2246] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 33113ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
19/10/22 00:33:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 00:33:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2313L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/22 00:33:57 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:33:57 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:33:57 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 00:33:57 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:33:57 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 00:33:57 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 00:33:57 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 00:33:57 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 00:33:57 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 00:33:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2313L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :  :  :  :  :- Project [rid#2315 AS rid_0#2320, n_regionkey_prf#2316 AS n_regionkey_prf_0#2321, n_nationkey_prf#2317 AS n_nationkey_prf_0#2322, n_name_prf#2318 AS n_name_prf_0#2323, n_comment_prf#2319 AS n_comment_prf_0#2324]
         :  :  :  :  :  :  :  :  :  :  +- Relation[rid#2315,n_regionkey_prf#2316,n_nationkey_prf#2317,n_name_prf#2318,n_comment_prf#2319] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  :  :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2025) AS rid_1#2331]
         :  :  :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_0
         :  :  :  :  :  :  :  :  :        :- 'Project ['rid AS rid_0#2330]
         :  :  :  :  :  :  :  :  :        :  +- Relation[rid#2325,n_regionkey_prf#2326,n_nationkey_prf#2327,n_name_prf#2328,n_comment_prf#2329] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  :  :  :  :  :  :        +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  :  :  +- Project [s_phone_prf#2332 AS s_phone_prf_1#2340, rid#2333 AS rid_1#2341, s_address_prf#2334 AS s_address_prf_1#2342, s_nationkey_prf#2335 AS s_nationkey_prf_1#2343, s_suppkey_prf#2336 AS s_suppkey_prf_1#2344, s_name_prf#2337 AS s_name_prf_1#2345, s_acctbal_prf#2338 AS s_acctbal_prf_1#2346, s_comment_prf#2339 AS s_comment_prf_1#2347]
         :  :  :  :  :  :  :  :     +- Relation[s_phone_prf#2332,rid#2333,s_address_prf#2334,s_nationkey_prf#2335,s_suppkey_prf#2336,s_name_prf#2337,s_acctbal_prf#2338,s_comment_prf#2339] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  :  :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2025) AS rid_2#2357]
         :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_1
         :  :  :  :  :  :  :        :- 'Project ['rid AS rid_1#2356]
         :  :  :  :  :  :  :        :  +- Relation[s_phone_prf#2348,rid#2349,s_address_prf#2350,s_nationkey_prf#2351,s_suppkey_prf#2352,s_name_prf#2353,s_acctbal_prf#2354,s_comment_prf#2355] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  :  :  :  :        +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  +- Project [l_returnflag_prf#2358 AS l_returnflag_prf_2#2377, l_orderkey_and_l_linenumber_prf#2359 AS l_orderkey_and_l_linenumber_prf_2#2378, l_comment_prf#2360 AS l_comment_prf_2#2379, l_linestatus_prf#2361 AS l_linestatus_prf_2#2380, rid#2362 AS rid_2#2381, l_shipmode_prf#2363 AS l_shipmode_prf_2#2382, l_shipinstruct_prf#2364 AS l_shipinstruct_prf_2#2383, l_quantity_prf#2365 AS l_quantity_prf_2#2384, l_receiptdate_prf#2366 AS l_receiptdate_prf_2#2385, l_linenumber_prf#2367 AS l_linenumber_prf_2#2386, l_tax_prf#2368 AS l_tax_prf_2#2387, l_shipdate_prf#2369 AS l_shipdate_prf_2#2388, l_extendedprice_prf#2370 AS l_extendedprice_prf_2#2389, l_partkey_prf#2371 AS l_partkey_prf_2#2390, l_discount_prf#2372 AS l_discount_prf_2#2391, l_partkey_and_l_suppkey_prf#2373 AS l_partkey_and_l_suppkey_prf_2#2392, l_commitdate_prf#2374 AS l_commitdate_prf_2#2393, l_suppkey_prf#2375 AS l_suppkey_prf_2#2394, l_orderkey_prf#2376 AS l_orderkey_prf_2#2395]
         :  :  :  :  :  :     +- Relation[l_returnflag_prf#2358,l_orderkey_and_l_linenumber_prf#2359,l_comment_prf#2360,l_linestatus_prf#2361,rid#2362,l_shipmode_prf#2363,l_shipinstruct_prf#2364,l_quantity_prf#2365,l_receiptdate_prf#2366,l_linenumber_prf#2367,l_tax_prf#2368,l_shipdate_prf#2369,l_extendedprice_prf#2370,l_partkey_prf#2371,l_discount_prf#2372,l_partkey_and_l_suppkey_prf#2373,l_commitdate_prf#2374,l_suppkey_prf#2375,l_orderkey_prf#2376] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2025) AS rid_3#2416]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_2
         :  :  :  :  :        :- 'Project ['rid AS rid_2#2415]
         :  :  :  :  :        :  +- Relation[l_returnflag_prf#2396,l_orderkey_and_l_linenumber_prf#2397,l_comment_prf#2398,l_linestatus_prf#2399,rid#2400,l_shipmode_prf#2401,l_shipinstruct_prf#2402,l_quantity_prf#2403,l_receiptdate_prf#2404,l_linenumber_prf#2405,l_tax_prf#2406,l_shipdate_prf#2407,l_extendedprice_prf#2408,l_partkey_prf#2409,l_discount_prf#2410,l_partkey_and_l_suppkey_prf#2411,l_commitdate_prf#2412,l_suppkey_prf#2413,l_orderkey_prf#2414] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [p_comment_prf#2417 AS p_comment_prf_3#2427, p_name_prf#2418 AS p_name_prf_3#2428, rid#2419 AS rid_3#2429, p_type_prf#2420 AS p_type_prf_3#2430, p_retailprice_prf#2421 AS p_retailprice_prf_3#2431, p_mfgr_prf#2422 AS p_mfgr_prf_3#2432, p_container_prf#2423 AS p_container_prf_3#2433, p_brand_prf#2424 AS p_brand_prf_3#2434, p_size_prf#2425 AS p_size_prf_3#2435, p_partkey_prf#2426 AS p_partkey_prf_3#2436]
         :  :  :  :     +- Relation[p_comment_prf#2417,p_name_prf#2418,rid#2419,p_type_prf#2420,p_retailprice_prf#2421,p_mfgr_prf#2422,p_container_prf#2423,p_brand_prf#2424,p_size_prf#2425,p_partkey_prf#2426] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2025) AS rid_4#2457]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey_and_l_suppkey~partsupp~ps_partkey_and_ps_suppkey, 'rid_2
         :  :  :        :- 'Project ['rid AS rid_2#2456]
         :  :  :        :  +- Relation[l_returnflag_prf#2437,l_orderkey_and_l_linenumber_prf#2438,l_comment_prf#2439,l_linestatus_prf#2440,rid#2441,l_shipmode_prf#2442,l_shipinstruct_prf#2443,l_quantity_prf#2444,l_receiptdate_prf#2445,l_linenumber_prf#2446,l_tax_prf#2447,l_shipdate_prf#2448,l_extendedprice_prf#2449,l_partkey_prf#2450,l_discount_prf#2451,l_partkey_and_l_suppkey_prf#2452,l_commitdate_prf#2453,l_suppkey_prf#2454,l_orderkey_prf#2455] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#2458 AS ps_partkey_and_ps_suppkey_prf_4#2465, rid#2459 AS rid_4#2466, ps_availqty_prf#2460 AS ps_availqty_prf_4#2467, ps_comment_prf#2461 AS ps_comment_prf_4#2468, ps_partkey_prf#2462 AS ps_partkey_prf_4#2469, ps_supplycost_prf#2463 AS ps_supplycost_prf_4#2470, ps_suppkey_prf#2464 AS ps_suppkey_prf_4#2471]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#2458,rid#2459,ps_availqty_prf#2460,ps_comment_prf#2461,ps_partkey_prf#2462,ps_supplycost_prf#2463,ps_suppkey_prf#2464] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2025) AS rid_5#2492]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#2491]
         :        :  +- Relation[l_returnflag_prf#2472,l_orderkey_and_l_linenumber_prf#2473,l_comment_prf#2474,l_linestatus_prf#2475,rid#2476,l_shipmode_prf#2477,l_shipinstruct_prf#2478,l_quantity_prf#2479,l_receiptdate_prf#2480,l_linenumber_prf#2481,l_tax_prf#2482,l_shipdate_prf#2483,l_extendedprice_prf#2484,l_partkey_prf#2485,l_discount_prf#2486,l_partkey_and_l_suppkey_prf#2487,l_commitdate_prf#2488,l_suppkey_prf#2489,l_orderkey_prf#2490] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2493 AS o_shippriority_prf_5#2503, rid#2494 AS rid_5#2504, o_orderdate_prf#2495 AS o_orderdate_prf_5#2505, o_custkey_prf#2496 AS o_custkey_prf_5#2506, o_orderpriority_prf#2497 AS o_orderpriority_prf_5#2507, o_clerk_prf#2498 AS o_clerk_prf_5#2508, o_orderstatus_prf#2499 AS o_orderstatus_prf_5#2509, o_totalprice_prf#2500 AS o_totalprice_prf_5#2510, o_orderkey_prf#2501 AS o_orderkey_prf_5#2511, o_comment_prf#2502 AS o_comment_prf_5#2512]
            +- Relation[o_shippriority_prf#2493,rid#2494,o_orderdate_prf#2495,o_custkey_prf#2496,o_orderpriority_prf#2497,o_clerk_prf#2498,o_orderstatus_prf#2499,o_totalprice_prf#2500,o_orderkey_prf#2501,o_comment_prf#2502] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 382452ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
19/10/22 00:40:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 00:40:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2576L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/22 00:40:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2576L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(RightOuter)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [o_shippriority_prf#2578 AS o_shippriority_prf_0#2588, rid#2579 AS rid_0#2589, o_orderdate_prf#2580 AS o_orderdate_prf_0#2590, o_custkey_prf#2581 AS o_custkey_prf_0#2591, o_orderpriority_prf#2582 AS o_orderpriority_prf_0#2592, o_clerk_prf#2583 AS o_clerk_prf_0#2593, o_orderstatus_prf#2584 AS o_orderstatus_prf_0#2594, o_totalprice_prf#2585 AS o_totalprice_prf_0#2595, o_orderkey_prf#2586 AS o_orderkey_prf_0#2596, o_comment_prf#2587 AS o_comment_prf_0#2597]
         :  :  +- Relation[o_shippriority_prf#2578,rid#2579,o_orderdate_prf#2580,o_custkey_prf#2581,o_orderpriority_prf#2582,o_clerk_prf#2583,o_orderstatus_prf#2584,o_totalprice_prf#2585,o_orderkey_prf#2586,o_comment_prf#2587] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2025) AS rid_1#2609]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2608]
         :        :  +- Relation[o_shippriority_prf#2598,rid#2599,o_orderdate_prf#2600,o_custkey_prf#2601,o_orderpriority_prf#2602,o_clerk_prf#2603,o_orderstatus_prf#2604,o_totalprice_prf#2605,o_orderkey_prf#2606,o_comment_prf#2607] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#2610 AS c_acctbal_prf_1#2619, rid#2611 AS rid_1#2620, c_name_prf#2612 AS c_name_prf_1#2621, c_nationkey_prf#2613 AS c_nationkey_prf_1#2622, c_custkey_prf#2614 AS c_custkey_prf_1#2623, c_comment_prf#2615 AS c_comment_prf_1#2624, c_address_prf#2616 AS c_address_prf_1#2625, c_mktsegment_prf#2617 AS c_mktsegment_prf_1#2626, c_phone_prf#2618 AS c_phone_prf_1#2627]
            +- Relation[c_acctbal_prf#2610,rid#2611,c_name_prf#2612,c_nationkey_prf#2613,c_custkey_prf#2614,c_comment_prf#2615,c_address_prf#2616,c_mktsegment_prf#2617,c_phone_prf#2618] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=1550004
Elapsed time: 50636ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
19/10/22 00:41:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 00:41:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2651L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/22 00:41:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2651L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#2025) AS rid_1#2692]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2676: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#2653 AS l_returnflag_prf_0#2672, l_orderkey_and_l_linenumber_prf#2654 AS l_orderkey_and_l_linenumber_prf_0#2673, l_comment_prf#2655 AS l_comment_prf_0#2674, l_linestatus_prf#2656 AS l_linestatus_prf_0#2675, rid#2657 AS rid_0#2676, l_shipmode_prf#2658 AS l_shipmode_prf_0#2677, l_shipinstruct_prf#2659 AS l_shipinstruct_prf_0#2678, l_quantity_prf#2660 AS l_quantity_prf_0#2679, l_receiptdate_prf#2661 AS l_receiptdate_prf_0#2680, l_linenumber_prf#2662 AS l_linenumber_prf_0#2681, l_tax_prf#2663 AS l_tax_prf_0#2682, l_shipdate_prf#2664 AS l_shipdate_prf_0#2683, l_extendedprice_prf#2665 AS l_extendedprice_prf_0#2684, l_partkey_prf#2666 AS l_partkey_prf_0#2685, l_discount_prf#2667 AS l_discount_prf_0#2686, l_partkey_and_l_suppkey_prf#2668 AS l_partkey_and_l_suppkey_prf_0#2687, l_commitdate_prf#2669 AS l_commitdate_prf_0#2688, l_suppkey_prf#2670 AS l_suppkey_prf_0#2689, l_orderkey_prf#2671 AS l_orderkey_prf_0#2690]
         :     :  :  +- Relation[l_returnflag_prf#2653,l_orderkey_and_l_linenumber_prf#2654,l_comment_prf#2655,l_linestatus_prf#2656,rid#2657,l_shipmode_prf#2658,l_shipinstruct_prf#2659,l_quantity_prf#2660,l_receiptdate_prf#2661,l_linenumber_prf#2662,l_tax_prf#2663,l_shipdate_prf#2664,l_extendedprice_prf#2665,l_partkey_prf#2666,l_discount_prf#2667,l_partkey_and_l_suppkey_prf#2668,l_commitdate_prf#2669,l_suppkey_prf#2670,l_orderkey_prf#2671] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2691]
         :     :     +- DexRidFilter lineitem~l_shipmode~MAIL
         :     :        +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2693 AS o_shippriority_prf_1#2703, rid#2694 AS rid_1#2704, o_orderdate_prf#2695 AS o_orderdate_prf_1#2705, o_custkey_prf#2696 AS o_custkey_prf_1#2706, o_orderpriority_prf#2697 AS o_orderpriority_prf_1#2707, o_clerk_prf#2698 AS o_clerk_prf_1#2708, o_orderstatus_prf#2699 AS o_orderstatus_prf_1#2709, o_totalprice_prf#2700 AS o_totalprice_prf_1#2710, o_orderkey_prf#2701 AS o_orderkey_prf_1#2711, o_comment_prf#2702 AS o_comment_prf_1#2712]
            +- Relation[o_shippriority_prf#2693,rid#2694,o_orderdate_prf#2695,o_custkey_prf#2696,o_orderpriority_prf#2697,o_clerk_prf#2698,o_orderstatus_prf#2699,o_totalprice_prf#2700,o_orderkey_prf#2701,o_comment_prf#2702] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 31994ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/22 00:41:42 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 00:41:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2751L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 00:41:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2751L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [c_acctbal_prf#2753 AS c_acctbal_prf_0#2762, rid#2754 AS rid_0#2763, c_name_prf#2755 AS c_name_prf_0#2764, c_nationkey_prf#2756 AS c_nationkey_prf_0#2765, c_custkey_prf#2757 AS c_custkey_prf_0#2766, c_comment_prf#2758 AS c_comment_prf_0#2767, c_address_prf#2759 AS c_address_prf_0#2768, c_mktsegment_prf#2760 AS c_mktsegment_prf_0#2769, c_phone_prf#2761 AS c_phone_prf_0#2770]
         :  :  :  :  +- Relation[c_acctbal_prf#2753,rid#2754,c_name_prf#2755,c_nationkey_prf#2756,c_custkey_prf#2757,c_comment_prf#2758,c_address_prf#2759,c_mktsegment_prf#2760,c_phone_prf#2761] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2025) AS rid_1#2781]
         :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#2780]
         :  :  :        :  +- Relation[c_acctbal_prf#2771,rid#2772,c_name_prf#2773,c_nationkey_prf#2774,c_custkey_prf#2775,c_comment_prf#2776,c_address_prf#2777,c_mktsegment_prf#2778,c_phone_prf#2779] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :        +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#2782 AS o_shippriority_prf_1#2792, rid#2783 AS rid_1#2793, o_orderdate_prf#2784 AS o_orderdate_prf_1#2794, o_custkey_prf#2785 AS o_custkey_prf_1#2795, o_orderpriority_prf#2786 AS o_orderpriority_prf_1#2796, o_clerk_prf#2787 AS o_clerk_prf_1#2797, o_orderstatus_prf#2788 AS o_orderstatus_prf_1#2798, o_totalprice_prf#2789 AS o_totalprice_prf_1#2799, o_orderkey_prf#2790 AS o_orderkey_prf_1#2800, o_comment_prf#2791 AS o_comment_prf_1#2801]
         :  :     +- Relation[o_shippriority_prf#2782,rid#2783,o_orderdate_prf#2784,o_custkey_prf#2785,o_orderpriority_prf#2786,o_clerk_prf#2787,o_orderstatus_prf#2788,o_totalprice_prf#2789,o_orderkey_prf#2790,o_comment_prf#2791] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2025) AS rid_2#2813]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2812]
         :        :  +- Relation[o_shippriority_prf#2802,rid#2803,o_orderdate_prf#2804,o_custkey_prf#2805,o_orderpriority_prf#2806,o_clerk_prf#2807,o_orderstatus_prf#2808,o_totalprice_prf#2809,o_orderkey_prf#2810,o_comment_prf#2811] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2814 AS l_returnflag_prf_2#2833, l_orderkey_and_l_linenumber_prf#2815 AS l_orderkey_and_l_linenumber_prf_2#2834, l_comment_prf#2816 AS l_comment_prf_2#2835, l_linestatus_prf#2817 AS l_linestatus_prf_2#2836, rid#2818 AS rid_2#2837, l_shipmode_prf#2819 AS l_shipmode_prf_2#2838, l_shipinstruct_prf#2820 AS l_shipinstruct_prf_2#2839, l_quantity_prf#2821 AS l_quantity_prf_2#2840, l_receiptdate_prf#2822 AS l_receiptdate_prf_2#2841, l_linenumber_prf#2823 AS l_linenumber_prf_2#2842, l_tax_prf#2824 AS l_tax_prf_2#2843, l_shipdate_prf#2825 AS l_shipdate_prf_2#2844, l_extendedprice_prf#2826 AS l_extendedprice_prf_2#2845, l_partkey_prf#2827 AS l_partkey_prf_2#2846, l_discount_prf#2828 AS l_discount_prf_2#2847, l_partkey_and_l_suppkey_prf#2829 AS l_partkey_and_l_suppkey_prf_2#2848, l_commitdate_prf#2830 AS l_commitdate_prf_2#2849, l_suppkey_prf#2831 AS l_suppkey_prf_2#2850, l_orderkey_prf#2832 AS l_orderkey_prf_2#2851]
            +- Relation[l_returnflag_prf#2814,l_orderkey_and_l_linenumber_prf#2815,l_comment_prf#2816,l_linestatus_prf#2817,rid#2818,l_shipmode_prf#2819,l_shipinstruct_prf#2820,l_quantity_prf#2821,l_receiptdate_prf#2822,l_linenumber_prf#2823,l_tax_prf#2824,l_shipdate_prf#2825,l_extendedprice_prf#2826,l_partkey_prf#2827,l_discount_prf#2828,l_partkey_and_l_suppkey_prf#2829,l_commitdate_prf#2830,l_suppkey_prf#2831,l_orderkey_prf#2832] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 230484ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
19/10/22 00:45:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 00:45:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2894L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1764L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1764L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1762L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1762L, l_suppkey#1764L]
               :     :        +- Relation[l_orderkey#1762L,l_partkey#1763L,l_suppkey#1764L,l_linenumber#1765,l_quantity#1766,l_extendedprice#1767,l_discount#1768,l_tax#1769,l_returnflag#1770,l_linestatus#1771,l_commitdate#1772,l_receiptdate#1773,l_shipinstruct#1774,l_shipmode#1775,l_comment#1776,l_shipdate#1777] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/22 00:45:33 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 00:45:33 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 00:45:33 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 00:45:33 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:45:33 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:45:33 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:45:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2894L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(LeftSemi)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, 'rid_2, 'l_returnflag_prf_2, 'l_orderkey_and_l_linenumber_prf_2, 'l_comment_prf_2, 'l_linestatus_prf_2, 'l_shipmode_prf_2, 'l_shipinstruct_prf_2, 'l_quantity_prf_2, 'l_receiptdate_prf_2, 'l_linenumber_prf_2, 'l_tax_prf_2, 'l_shipdate_prf_2, 'l_extendedprice_prf_2, 'l_partkey_prf_2, ... 14 more fields]
         :  :  +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_3
         :  :     :- 'Join NaturalJoin(Inner)
         :  :     :  :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, 'rid_2, 'l_returnflag_prf_2, 'l_orderkey_and_l_linenumber_prf_2, 'l_comment_prf_2, 'l_linestatus_prf_2, 'l_shipmode_prf_2, 'l_shipinstruct_prf_2, 'l_quantity_prf_2, 'l_receiptdate_prf_2, 'l_linenumber_prf_2, 'l_tax_prf_2, 'l_shipdate_prf_2, 'l_extendedprice_prf_2, 'l_partkey_prf_2, ... 6 more fields]
         :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_2
         :  :     :  :     :- 'Join NaturalJoin(Inner)
         :  :     :  :     :  :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#2025) AS rid_2#2976]
         :  :     :  :     :  :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#2966: string
         :  :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :     :  :     :  :     :  :- Project [o_shippriority_prf#2955 AS o_shippriority_prf_1#2965, rid#2956 AS rid_1#2966, o_orderdate_prf#2957 AS o_orderdate_prf_1#2967, o_custkey_prf#2958 AS o_custkey_prf_1#2968, o_orderpriority_prf#2959 AS o_orderpriority_prf_1#2969, o_clerk_prf#2960 AS o_clerk_prf_1#2970, o_orderstatus_prf#2961 AS o_orderstatus_prf_1#2971, o_totalprice_prf#2962 AS o_totalprice_prf_1#2972, o_orderkey_prf#2963 AS o_orderkey_prf_1#2973, o_comment_prf#2964 AS o_comment_prf_1#2974]
         :  :     :  :     :  :     :  :  +- Relation[o_shippriority_prf#2955,rid#2956,o_orderdate_prf#2957,o_custkey_prf#2958,o_orderpriority_prf#2959,o_clerk_prf#2960,o_orderstatus_prf#2961,o_totalprice_prf#2962,o_orderkey_prf#2963,o_comment_prf#2964] JDBCRelation(orders_prf) [numPartitions=1]
         :  :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2975]
         :  :     :  :     :  :     :     +- DexRidFilter orders~o_orderstatus~F
         :  :     :  :     :  :     :        +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]
         :  :     :  :     :  :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :     :  :     :  +- Project [l_returnflag_prf#2977 AS l_returnflag_prf_2#2996, l_orderkey_and_l_linenumber_prf#2978 AS l_orderkey_and_l_linenumber_prf_2#2997, l_comment_prf#2979 AS l_comment_prf_2#2998, l_linestatus_prf#2980 AS l_linestatus_prf_2#2999, rid#2981 AS rid_2#3000, l_shipmode_prf#2982 AS l_shipmode_prf_2#3001, l_shipinstruct_prf#2983 AS l_shipinstruct_prf_2#3002, l_quantity_prf#2984 AS l_quantity_prf_2#3003, l_receiptdate_prf#2985 AS l_receiptdate_prf_2#3004, l_linenumber_prf#2986 AS l_linenumber_prf_2#3005, l_tax_prf#2987 AS l_tax_prf_2#3006, l_shipdate_prf#2988 AS l_shipdate_prf_2#3007, l_extendedprice_prf#2989 AS l_extendedprice_prf_2#3008, l_partkey_prf#2990 AS l_partkey_prf_2#3009, l_discount_prf#2991 AS l_discount_prf_2#3010, l_partkey_and_l_suppkey_prf#2992 AS l_partkey_and_l_suppkey_prf_2#3011, l_commitdate_prf#2993 AS l_commitdate_prf_2#3012, l_suppkey_prf#2994 AS l_suppkey_prf_2#3013, l_orderkey_prf#2995 AS l_orderkey_prf_2#3014]
         :  :     :  :     :     +- Relation[l_returnflag_prf#2977,l_orderkey_and_l_linenumber_prf#2978,l_comment_prf#2979,l_linestatus_prf#2980,rid#2981,l_shipmode_prf#2982,l_shipinstruct_prf#2983,l_quantity_prf#2984,l_receiptdate_prf#2985,l_linenumber_prf#2986,l_tax_prf#2987,l_shipdate_prf#2988,l_extendedprice_prf#2989,l_partkey_prf#2990,l_discount_prf#2991,l_partkey_and_l_suppkey_prf#2992,l_commitdate_prf#2993,l_suppkey_prf#2994,l_orderkey_prf#2995] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :     :  :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :     :  +- Project [s_phone_prf#3016 AS s_phone_prf_3#3024, rid#3017 AS rid_3#3025, s_address_prf#3018 AS s_address_prf_3#3026, s_nationkey_prf#3019 AS s_nationkey_prf_3#3027, s_suppkey_prf#3020 AS s_suppkey_prf_3#3028, s_name_prf#3021 AS s_name_prf_3#3029, s_acctbal_prf#3022 AS s_acctbal_prf_3#3030, s_comment_prf#3023 AS s_comment_prf_3#3031]
         :  :     :     +- Relation[s_phone_prf#3016,rid#3017,s_address_prf#3018,s_nationkey_prf#3019,s_suppkey_prf#3020,s_name_prf#3021,s_acctbal_prf#3022,s_comment_prf#3023] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  +- 'Join UsingJoin(LeftSemi,List(rid_4))
         :     :- Project [rid#3033 AS rid_4#3038, n_regionkey_prf#3034 AS n_regionkey_prf_4#3039, n_nationkey_prf#3035 AS n_nationkey_prf_4#3040, n_name_prf#3036 AS n_name_prf_4#3041, n_comment_prf#3037 AS n_comment_prf_4#3042]
         :     :  +- Relation[rid#3033,n_regionkey_prf#3034,n_nationkey_prf#3035,n_name_prf#3036,n_comment_prf#3037] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_4#3043]
         :        +- DexRidFilter nation~n_name~SAUDI ARABIA
         :           +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_0))
            :- Project [l_returnflag_prf#2896 AS l_returnflag_prf_0#2915, l_orderkey_and_l_linenumber_prf#2897 AS l_orderkey_and_l_linenumber_prf_0#2916, l_comment_prf#2898 AS l_comment_prf_0#2917, l_linestatus_prf#2899 AS l_linestatus_prf_0#2918, rid#2900 AS rid_0#2919, l_shipmode_prf#2901 AS l_shipmode_prf_0#2920, l_shipinstruct_prf#2902 AS l_shipinstruct_prf_0#2921, l_quantity_prf#2903 AS l_quantity_prf_0#2922, l_receiptdate_prf#2904 AS l_receiptdate_prf_0#2923, l_linenumber_prf#2905 AS l_linenumber_prf_0#2924, l_tax_prf#2906 AS l_tax_prf_0#2925, l_shipdate_prf#2907 AS l_shipdate_prf_0#2926, l_extendedprice_prf#2908 AS l_extendedprice_prf_0#2927, l_partkey_prf#2909 AS l_partkey_prf_0#2928, l_discount_prf#2910 AS l_discount_prf_0#2929, l_partkey_and_l_suppkey_prf#2911 AS l_partkey_and_l_suppkey_prf_0#2930, l_commitdate_prf#2912 AS l_commitdate_prf_0#2931, l_suppkey_prf#2913 AS l_suppkey_prf_0#2932, l_orderkey_prf#2914 AS l_orderkey_prf_0#2933]
            :  +- Relation[l_returnflag_prf#2896,l_orderkey_and_l_linenumber_prf#2897,l_comment_prf#2898,l_linestatus_prf#2899,rid#2900,l_shipmode_prf#2901,l_shipinstruct_prf#2902,l_quantity_prf#2903,l_receiptdate_prf#2904,l_linenumber_prf#2905,l_tax_prf#2906,l_shipdate_prf#2907,l_extendedprice_prf#2908,l_partkey_prf#2909,l_discount_prf#2910,l_partkey_and_l_suppkey_prf#2911,l_commitdate_prf#2912,l_suppkey_prf#2913,l_orderkey_prf#2914] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2025) AS rid_1#2954]
               +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
                  :- 'Project ['rid AS rid_0#2953]
                  :  +- Relation[l_returnflag_prf#2934,l_orderkey_and_l_linenumber_prf#2935,l_comment_prf#2936,l_linestatus_prf#2937,rid#2938,l_shipmode_prf#2939,l_shipinstruct_prf#2940,l_quantity_prf#2941,l_receiptdate_prf#2942,l_linenumber_prf#2943,l_tax_prf#2944,l_shipdate_prf#2945,l_extendedprice_prf#2946,l_partkey_prf#2947,l_discount_prf#2948,l_partkey_and_l_suppkey_prf#2949,l_commitdate_prf#2950,l_suppkey_prf#2951,l_orderkey_prf#2952] JDBCRelation(lineitem_prf) [numPartitions=1]
                  +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]

DexCorr$ result size=119924
Elapsed time: 369895ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
19/10/22 00:51:43 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 00:51:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3091L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/22 00:51:43 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 00:51:43 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 00:51:43 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 00:51:43 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 00:51:43 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:51:43 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:51:43 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:51:43 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 00:51:43 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 00:51:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3091L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(LeftSemi)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Project ['rid_2, 'n_regionkey_prf_2, 'n_nationkey_prf_2, 'n_name_prf_2, 'n_comment_prf_2, dexdecrypt('value_dec_key, value#2025) AS rid_3#3141]
         :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_2#3135: string
         :  :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
         :  :     :  :- Project [rid#3130 AS rid_2#3135, n_regionkey_prf#3131 AS n_regionkey_prf_2#3136, n_nationkey_prf#3132 AS n_nationkey_prf_2#3137, n_name_prf#3133 AS n_name_prf_2#3138, n_comment_prf#3134 AS n_comment_prf_2#3139]
         :  :     :  :  +- Relation[rid#3130,n_regionkey_prf#3131,n_nationkey_prf#3132,n_name_prf#3133,n_comment_prf#3134] JDBCRelation(nation_prf) [numPartitions=1]
         :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#3140]
         :  :     :     +- DexRidFilter nation~n_name~CANADA
         :  :     :        +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]
         :  :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  +- Project [s_phone_prf#3142 AS s_phone_prf_3#3150, rid#3143 AS rid_3#3151, s_address_prf#3144 AS s_address_prf_3#3152, s_nationkey_prf#3145 AS s_nationkey_prf_3#3153, s_suppkey_prf#3146 AS s_suppkey_prf_3#3154, s_name_prf#3147 AS s_name_prf_3#3155, s_acctbal_prf#3148 AS s_acctbal_prf_3#3156, s_comment_prf#3149 AS s_comment_prf_3#3157]
         :     +- Relation[s_phone_prf#3142,rid#3143,s_address_prf#3144,s_nationkey_prf#3145,s_suppkey_prf#3146,s_name_prf#3147,s_acctbal_prf#3148,s_comment_prf#3149] JDBCRelation(supplier_prf) [numPartitions=1]
         +- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#2025) AS rid_3#3129]
            +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, rid_1#3123: string
               :- 'Join NaturalJoin(LeftSemi)
               :  :- Project [ps_partkey_and_ps_suppkey_prf#3115 AS ps_partkey_and_ps_suppkey_prf_1#3122, rid#3116 AS rid_1#3123, ps_availqty_prf#3117 AS ps_availqty_prf_1#3124, ps_comment_prf#3118 AS ps_comment_prf_1#3125, ps_partkey_prf#3119 AS ps_partkey_prf_1#3126, ps_supplycost_prf#3120 AS ps_supplycost_prf_1#3127, ps_suppkey_prf#3121 AS ps_suppkey_prf_1#3128]
               :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#3115,rid#3116,ps_availqty_prf#3117,ps_comment_prf#3118,ps_partkey_prf#3119,ps_supplycost_prf#3120,ps_suppkey_prf#3121] JDBCRelation(partsupp_prf) [numPartitions=1]
               :  +- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2025) AS rid_1#3114]
               :     +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#3105: string
               :        :- 'Join UsingJoin(LeftSemi,List(rid_0))
               :        :  :- Project [p_comment_prf#3093 AS p_comment_prf_0#3103, p_name_prf#3094 AS p_name_prf_0#3104, rid#3095 AS rid_0#3105, p_type_prf#3096 AS p_type_prf_0#3106, p_retailprice_prf#3097 AS p_retailprice_prf_0#3107, p_mfgr_prf#3098 AS p_mfgr_prf_0#3108, p_container_prf#3099 AS p_container_prf_0#3109, p_brand_prf#3100 AS p_brand_prf_0#3110, p_size_prf#3101 AS p_size_prf_0#3111, p_partkey_prf#3102 AS p_partkey_prf_0#3112]
               :        :  :  +- Relation[p_comment_prf#3093,p_name_prf#3094,rid#3095,p_type_prf#3096,p_retailprice_prf#3097,p_mfgr_prf#3098,p_container_prf#3099,p_brand_prf#3100,p_size_prf#3101,p_partkey_prf#3102] JDBCRelation(part_prf) [numPartitions=1]
               :        :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3113]
               :        :     +- DexRidFilter part~p_size~15
               :        :        +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]
               :        +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
               +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]

DexCorr$ result size=324
Elapsed time: 22706ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
19/10/22 00:52:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 00:52:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3179L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#610L = c_nationkey#293L)
               :     :- Project [n_nationkey#610L]
               :     :  +- Filter (n_name#611 = GERMANY)
               :     :     +- Relation[n_nationkey#610L,n_name#611,n_regionkey#612L,n_comment#613] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/22 00:52:05 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:52:05 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:52:05 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:52:05 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 00:52:05 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 00:52:05 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 00:52:05 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:52:05 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:52:05 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:52:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3179L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, 'rid_2, 'l_returnflag_prf_2, 'l_orderkey_and_l_linenumber_prf_2, 'l_comment_prf_2, 'l_linestatus_prf_2, 'l_shipmode_prf_2, 'l_shipinstruct_prf_2, 'l_quantity_prf_2, 'l_receiptdate_prf_2, 'l_linenumber_prf_2, 'l_tax_prf_2, ... 9 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#2025) AS rid_2#3209]
         :     :  :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2025) AS rid_1#3192]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#3186: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [rid#3181 AS rid_0#3186, n_regionkey_prf#3182 AS n_regionkey_prf_0#3187, n_nationkey_prf#3183 AS n_nationkey_prf_0#3188, n_name_prf#3184 AS n_name_prf_0#3189, n_comment_prf#3185 AS n_comment_prf_0#3190]
         :     :  :     :  :     :  :  +- Relation[rid#3181,n_regionkey_prf#3182,n_nationkey_prf#3183,n_name_prf#3184,n_comment_prf#3185] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3191]
         :     :  :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :  :     :        +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [s_phone_prf#3193 AS s_phone_prf_1#3201, rid#3194 AS rid_1#3202, s_address_prf#3195 AS s_address_prf_1#3203, s_nationkey_prf#3196 AS s_nationkey_prf_1#3204, s_suppkey_prf#3197 AS s_suppkey_prf_1#3205, s_name_prf#3198 AS s_name_prf_1#3206, s_acctbal_prf#3199 AS s_acctbal_prf_1#3207, s_comment_prf#3200 AS s_comment_prf_1#3208]
         :     :  :     :     +- Relation[s_phone_prf#3193,rid#3194,s_address_prf#3195,s_nationkey_prf#3196,s_suppkey_prf#3197,s_name_prf#3198,s_acctbal_prf#3199,s_comment_prf#3200] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#3210 AS l_returnflag_prf_2#3229, l_orderkey_and_l_linenumber_prf#3211 AS l_orderkey_and_l_linenumber_prf_2#3230, l_comment_prf#3212 AS l_comment_prf_2#3231, l_linestatus_prf#3213 AS l_linestatus_prf_2#3232, rid#3214 AS rid_2#3233, l_shipmode_prf#3215 AS l_shipmode_prf_2#3234, l_shipinstruct_prf#3216 AS l_shipinstruct_prf_2#3235, l_quantity_prf#3217 AS l_quantity_prf_2#3236, l_receiptdate_prf#3218 AS l_receiptdate_prf_2#3237, l_linenumber_prf#3219 AS l_linenumber_prf_2#3238, l_tax_prf#3220 AS l_tax_prf_2#3239, l_shipdate_prf#3221 AS l_shipdate_prf_2#3240, l_extendedprice_prf#3222 AS l_extendedprice_prf_2#3241, l_partkey_prf#3223 AS l_partkey_prf_2#3242, l_discount_prf#3224 AS l_discount_prf_2#3243, l_partkey_and_l_suppkey_prf#3225 AS l_partkey_and_l_suppkey_prf_2#3244, l_commitdate_prf#3226 AS l_commitdate_prf_2#3245, l_suppkey_prf#3227 AS l_suppkey_prf_2#3246, l_orderkey_prf#3228 AS l_orderkey_prf_2#3247]
         :     :     +- Relation[l_returnflag_prf#3210,l_orderkey_and_l_linenumber_prf#3211,l_comment_prf#3212,l_linestatus_prf#3213,rid#3214,l_shipmode_prf#3215,l_shipinstruct_prf#3216,l_quantity_prf#3217,l_receiptdate_prf#3218,l_linenumber_prf#3219,l_tax_prf#3220,l_shipdate_prf#3221,l_extendedprice_prf#3222,l_partkey_prf#3223,l_discount_prf#3224,l_partkey_and_l_suppkey_prf#3225,l_commitdate_prf#3226,l_suppkey_prf#3227,l_orderkey_prf#3228] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_3, 'n_regionkey_prf_3, 'n_nationkey_prf_3, 'n_name_prf_3, 'n_comment_prf_3, 'rid_4, 'c_acctbal_prf_4, 'c_name_prf_4, 'c_nationkey_prf_4, 'c_custkey_prf_4, 'c_comment_prf_4, 'c_address_prf_4, 'c_mktsegment_prf_4, 'c_phone_prf_4, dexdecrypt('value_dec_key, value#2025) AS rid_5#3279]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_4
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['rid_3, 'n_regionkey_prf_3, 'n_nationkey_prf_3, 'n_name_prf_3, 'n_comment_prf_3, dexdecrypt('value_dec_key, value#2025) AS rid_4#3260]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_3#3254: string
            :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :     :  :     :  :- Project [rid#3249 AS rid_3#3254, n_regionkey_prf#3250 AS n_regionkey_prf_3#3255, n_nationkey_prf#3251 AS n_nationkey_prf_3#3256, n_name_prf#3252 AS n_name_prf_3#3257, n_comment_prf#3253 AS n_comment_prf_3#3258]
            :     :  :     :  :  +- Relation[rid#3249,n_regionkey_prf#3250,n_nationkey_prf#3251,n_name_prf#3252,n_comment_prf#3253] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#3259]
            :     :  :     :     +- DexRidFilter nation~n_name~GERMANY
            :     :  :     :        +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [c_acctbal_prf#3261 AS c_acctbal_prf_4#3270, rid#3262 AS rid_4#3271, c_name_prf#3263 AS c_name_prf_4#3272, c_nationkey_prf#3264 AS c_nationkey_prf_4#3273, c_custkey_prf#3265 AS c_custkey_prf_4#3274, c_comment_prf#3266 AS c_comment_prf_4#3275, c_address_prf#3267 AS c_address_prf_4#3276, c_mktsegment_prf#3268 AS c_mktsegment_prf_4#3277, c_phone_prf#3269 AS c_phone_prf_4#3278]
            :     :     +- Relation[c_acctbal_prf#3261,rid#3262,c_name_prf#3263,c_nationkey_prf#3264,c_custkey_prf#3265,c_comment_prf#3266,c_address_prf#3267,c_mktsegment_prf#3268,c_phone_prf#3269] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3280 AS o_shippriority_prf_5#3290, rid#3281 AS rid_5#3291, o_orderdate_prf#3282 AS o_orderdate_prf_5#3292, o_custkey_prf#3283 AS o_custkey_prf_5#3293, o_orderpriority_prf#3284 AS o_orderpriority_prf_5#3294, o_clerk_prf#3285 AS o_clerk_prf_5#3295, o_orderstatus_prf#3286 AS o_orderstatus_prf_5#3296, o_totalprice_prf#3287 AS o_totalprice_prf_5#3297, o_orderkey_prf#3288 AS o_orderkey_prf_5#3298, o_comment_prf#3289 AS o_comment_prf_5#3299]
               +- Relation[o_shippriority_prf#3280,rid#3281,o_orderdate_prf#3282,o_custkey_prf#3283,o_orderpriority_prf#3284,o_clerk_prf#3285,o_orderstatus_prf#3286,o_totalprice_prf#3287,o_orderkey_prf#3288,o_comment_prf#3289] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=9735
Elapsed time: 39520ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
19/10/22 00:52:45 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 00:52:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3363L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/22 00:52:45 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 00:52:45 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 00:52:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3363L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2025) AS rid_1#3386]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#3377: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#3365 AS p_comment_prf_0#3375, p_name_prf#3366 AS p_name_prf_0#3376, rid#3367 AS rid_0#3377, p_type_prf#3368 AS p_type_prf_0#3378, p_retailprice_prf#3369 AS p_retailprice_prf_0#3379, p_mfgr_prf#3370 AS p_mfgr_prf_0#3380, p_container_prf#3371 AS p_container_prf_0#3381, p_brand_prf#3372 AS p_brand_prf_0#3382, p_size_prf#3373 AS p_size_prf_0#3383, p_partkey_prf#3374 AS p_partkey_prf_0#3384]
         :     :  :  +- Relation[p_comment_prf#3365,p_name_prf#3366,rid#3367,p_type_prf#3368,p_retailprice_prf#3369,p_mfgr_prf#3370,p_container_prf#3371,p_brand_prf#3372,p_size_prf#3373,p_partkey_prf#3374] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3385]
         :     :     +- DexRidFilter part~p_size~49
         :     :        +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#3387 AS ps_partkey_and_ps_suppkey_prf_1#3394, rid#3388 AS rid_1#3395, ps_availqty_prf#3389 AS ps_availqty_prf_1#3396, ps_comment_prf#3390 AS ps_comment_prf_1#3397, ps_partkey_prf#3391 AS ps_partkey_prf_1#3398, ps_supplycost_prf#3392 AS ps_supplycost_prf_1#3399, ps_suppkey_prf#3393 AS ps_suppkey_prf_1#3400]
            +- Relation[ps_partkey_and_ps_suppkey_prf#3387,rid#3388,ps_availqty_prf#3389,ps_comment_prf#3390,ps_partkey_prf#3391,ps_supplycost_prf#3392,ps_suppkey_prf#3393] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15780
Elapsed time: 391ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
19/10/22 00:52:45 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 00:52:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3427L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/22 00:52:45 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:52:45 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:52:45 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 00:52:45 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:52:45 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 00:52:45 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 00:52:45 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 00:52:45 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 00:52:45 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 00:52:45 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 00:52:45 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 00:52:45 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 00:52:45 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 00:52:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3427L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_4))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2025) AS rid_4#3523]
         :  :  :  :  +- 'DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, 'rid_2
         :  :  :  :     :- 'Project ['rid AS rid_2#3522]
         :  :  :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#3515,rid#3516,ps_availqty_prf#3517,ps_comment_prf#3518,ps_partkey_prf#3519,ps_supplycost_prf#3520,ps_suppkey_prf#3521] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :  :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  +- 'Join NaturalJoin(Inner)
         :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :     :  :- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2025) AS rid_3#3494]
         :  :  :     :  :  +- 'DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, 'rid_2
         :  :  :     :  :     :- 'Project ['rid AS rid_2#3493]
         :  :  :     :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#3486,rid#3487,ps_availqty_prf#3488,ps_comment_prf#3489,ps_partkey_prf#3490,ps_supplycost_prf#3491,ps_suppkey_prf#3492] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :     :  :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :  +- 'Join NaturalJoin(Inner)
         :  :  :     :     :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :     :     :  :- 'Join NaturalJoin(Inner)
         :  :  :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :     :     :  :  :  :- Project [rid#3429 AS rid_0#3434, n_regionkey_prf#3430 AS n_regionkey_prf_0#3435, n_nationkey_prf#3431 AS n_nationkey_prf_0#3436, n_name_prf#3432 AS n_name_prf_0#3437, n_comment_prf#3433 AS n_comment_prf_0#3438]
         :  :  :     :     :  :  :  :  +- Relation[rid#3429,n_regionkey_prf#3430,n_nationkey_prf#3431,n_name_prf#3432,n_comment_prf#3433] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     :     :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2025) AS rid_1#3445]
         :  :  :     :     :  :  :     +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_0
         :  :  :     :     :  :  :        :- 'Project ['rid AS rid_0#3444]
         :  :  :     :     :  :  :        :  +- Relation[rid#3439,n_regionkey_prf#3440,n_nationkey_prf#3441,n_name_prf#3442,n_comment_prf#3443] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     :     :  :  :        +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :     :  :  +- Project [s_phone_prf#3446 AS s_phone_prf_1#3454, rid#3447 AS rid_1#3455, s_address_prf#3448 AS s_address_prf_1#3456, s_nationkey_prf#3449 AS s_nationkey_prf_1#3457, s_suppkey_prf#3450 AS s_suppkey_prf_1#3458, s_name_prf#3451 AS s_name_prf_1#3459, s_acctbal_prf#3452 AS s_acctbal_prf_1#3460, s_comment_prf#3453 AS s_comment_prf_1#3461]
         :  :  :     :     :  :     +- Relation[s_phone_prf#3446,rid#3447,s_address_prf#3448,s_nationkey_prf#3449,s_suppkey_prf#3450,s_name_prf#3451,s_acctbal_prf#3452,s_comment_prf#3453] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :     :     :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2025) AS rid_2#3471]
         :  :  :     :     :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_1
         :  :  :     :     :        :- 'Project ['rid AS rid_1#3470]
         :  :  :     :     :        :  +- Relation[s_phone_prf#3462,rid#3463,s_address_prf#3464,s_nationkey_prf#3465,s_suppkey_prf#3466,s_name_prf#3467,s_acctbal_prf#3468,s_comment_prf#3469] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :     :     :        +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :     +- Project [ps_partkey_and_ps_suppkey_prf#3472 AS ps_partkey_and_ps_suppkey_prf_2#3479, rid#3473 AS rid_2#3480, ps_availqty_prf#3474 AS ps_availqty_prf_2#3481, ps_comment_prf#3475 AS ps_comment_prf_2#3482, ps_partkey_prf#3476 AS ps_partkey_prf_2#3483, ps_supplycost_prf#3477 AS ps_supplycost_prf_2#3484, ps_suppkey_prf#3478 AS ps_suppkey_prf_2#3485]
         :  :  :     :        +- Relation[ps_partkey_and_ps_suppkey_prf#3472,rid#3473,ps_availqty_prf#3474,ps_comment_prf#3475,ps_partkey_prf#3476,ps_supplycost_prf#3477,ps_suppkey_prf#3478] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :     +- Project [p_comment_prf#3495 AS p_comment_prf_3#3505, p_name_prf#3496 AS p_name_prf_3#3506, rid#3497 AS rid_3#3507, p_type_prf#3498 AS p_type_prf_3#3508, p_retailprice_prf#3499 AS p_retailprice_prf_3#3509, p_mfgr_prf#3500 AS p_mfgr_prf_3#3510, p_container_prf#3501 AS p_container_prf_3#3511, p_brand_prf#3502 AS p_brand_prf_3#3512, p_size_prf#3503 AS p_size_prf_3#3513, p_partkey_prf#3504 AS p_partkey_prf_3#3514]
         :  :  :        +- Relation[p_comment_prf#3495,p_name_prf#3496,rid#3497,p_type_prf#3498,p_retailprice_prf#3499,p_mfgr_prf#3500,p_container_prf#3501,p_brand_prf#3502,p_size_prf#3503,p_partkey_prf#3504] JDBCRelation(part_prf) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#3524 AS l_returnflag_prf_4#3543, l_orderkey_and_l_linenumber_prf#3525 AS l_orderkey_and_l_linenumber_prf_4#3544, l_comment_prf#3526 AS l_comment_prf_4#3545, l_linestatus_prf#3527 AS l_linestatus_prf_4#3546, rid#3528 AS rid_4#3547, l_shipmode_prf#3529 AS l_shipmode_prf_4#3548, l_shipinstruct_prf#3530 AS l_shipinstruct_prf_4#3549, l_quantity_prf#3531 AS l_quantity_prf_4#3550, l_receiptdate_prf#3532 AS l_receiptdate_prf_4#3551, l_linenumber_prf#3533 AS l_linenumber_prf_4#3552, l_tax_prf#3534 AS l_tax_prf_4#3553, l_shipdate_prf#3535 AS l_shipdate_prf_4#3554, l_extendedprice_prf#3536 AS l_extendedprice_prf_4#3555, l_partkey_prf#3537 AS l_partkey_prf_4#3556, l_discount_prf#3538 AS l_discount_prf_4#3557, l_partkey_and_l_suppkey_prf#3539 AS l_partkey_and_l_suppkey_prf_4#3558, l_commitdate_prf#3540 AS l_commitdate_prf_4#3559, l_suppkey_prf#3541 AS l_suppkey_prf_4#3560, l_orderkey_prf#3542 AS l_orderkey_prf_4#3561]
         :  :     +- Relation[l_returnflag_prf#3524,l_orderkey_and_l_linenumber_prf#3525,l_comment_prf#3526,l_linestatus_prf#3527,rid#3528,l_shipmode_prf#3529,l_shipinstruct_prf#3530,l_quantity_prf#3531,l_receiptdate_prf#3532,l_linenumber_prf#3533,l_tax_prf#3534,l_shipdate_prf#3535,l_extendedprice_prf#3536,l_partkey_prf#3537,l_discount_prf#3538,l_partkey_and_l_suppkey_prf#3539,l_commitdate_prf#3540,l_suppkey_prf#3541,l_orderkey_prf#3542] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_4, dexdecrypt('value_dec_key, value#2025) AS rid_5#3582]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_4
         :        :- 'Project ['rid AS rid_4#3581]
         :        :  +- Relation[l_returnflag_prf#3562,l_orderkey_and_l_linenumber_prf#3563,l_comment_prf#3564,l_linestatus_prf#3565,rid#3566,l_shipmode_prf#3567,l_shipinstruct_prf#3568,l_quantity_prf#3569,l_receiptdate_prf#3570,l_linenumber_prf#3571,l_tax_prf#3572,l_shipdate_prf#3573,l_extendedprice_prf#3574,l_partkey_prf#3575,l_discount_prf#3576,l_partkey_and_l_suppkey_prf#3577,l_commitdate_prf#3578,l_suppkey_prf#3579,l_orderkey_prf#3580] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3583 AS o_shippriority_prf_5#3593, rid#3584 AS rid_5#3594, o_orderdate_prf#3585 AS o_orderdate_prf_5#3595, o_custkey_prf#3586 AS o_custkey_prf_5#3596, o_orderpriority_prf#3587 AS o_orderpriority_prf_5#3597, o_clerk_prf#3588 AS o_clerk_prf_5#3598, o_orderstatus_prf#3589 AS o_orderstatus_prf_5#3599, o_totalprice_prf#3590 AS o_totalprice_prf_5#3600, o_orderkey_prf#3591 AS o_orderkey_prf_5#3601, o_comment_prf#3592 AS o_comment_prf_5#3602]
            +- Relation[o_shippriority_prf#3583,rid#3584,o_orderdate_prf#3585,o_custkey_prf#3586,o_orderpriority_prf#3587,o_clerk_prf#3588,o_orderstatus_prf#3589,o_totalprice_prf#3590,o_orderkey_prf#3591,o_comment_prf#3592] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 294714ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
19/10/22 00:57:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 00:57:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3669L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#808L = c_nationkey#293L)
               :     :- Project [n_nationkey#808L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#810L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#808L, n_regionkey#810L]
               :     :        +- Relation[n_nationkey#808L,n_name#809,n_regionkey#810L,n_comment#811] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/22 00:57:40 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 00:57:40 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 00:57:40 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 00:57:40 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:57:40 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:57:40 WARN DexPlanner: InMemoryFileIndex=region
19/10/22 00:57:40 WARN DexPlanner: InMemoryFileIndex=region
19/10/22 00:57:40 WARN DexPlanner: InMemoryFileIndex=region
19/10/22 00:57:40 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:57:40 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:57:40 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 00:57:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3669L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 19 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 14 more fields]
         :     :  :  +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_2
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :  :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2025) AS rid_1#3692]
         :     :  :     :  :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3683: string
         :     :  :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :     :  :- Project [p_comment_prf#3671 AS p_comment_prf_0#3681, p_name_prf#3672 AS p_name_prf_0#3682, rid#3673 AS rid_0#3683, p_type_prf#3674 AS p_type_prf_0#3684, p_retailprice_prf#3675 AS p_retailprice_prf_0#3685, p_mfgr_prf#3676 AS p_mfgr_prf_0#3686, p_container_prf#3677 AS p_container_prf_0#3687, p_brand_prf#3678 AS p_brand_prf_0#3688, p_size_prf#3679 AS p_size_prf_0#3689, p_partkey_prf#3680 AS p_partkey_prf_0#3690]
         :     :  :     :  :     :  :     :  :  +- Relation[p_comment_prf#3671,p_name_prf#3672,rid#3673,p_type_prf#3674,p_retailprice_prf#3675,p_mfgr_prf#3676,p_container_prf#3677,p_brand_prf#3678,p_size_prf#3679,p_partkey_prf#3680] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3691]
         :     :  :     :  :     :  :     :     +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
         :     :  :     :  :     :  :     :        +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     :  :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  :     :  +- Project [l_returnflag_prf#3693 AS l_returnflag_prf_1#3712, l_orderkey_and_l_linenumber_prf#3694 AS l_orderkey_and_l_linenumber_prf_1#3713, l_comment_prf#3695 AS l_comment_prf_1#3714, l_linestatus_prf#3696 AS l_linestatus_prf_1#3715, rid#3697 AS rid_1#3716, l_shipmode_prf#3698 AS l_shipmode_prf_1#3717, l_shipinstruct_prf#3699 AS l_shipinstruct_prf_1#3718, l_quantity_prf#3700 AS l_quantity_prf_1#3719, l_receiptdate_prf#3701 AS l_receiptdate_prf_1#3720, l_linenumber_prf#3702 AS l_linenumber_prf_1#3721, l_tax_prf#3703 AS l_tax_prf_1#3722, l_shipdate_prf#3704 AS l_shipdate_prf_1#3723, l_extendedprice_prf#3705 AS l_extendedprice_prf_1#3724, l_partkey_prf#3706 AS l_partkey_prf_1#3725, l_discount_prf#3707 AS l_discount_prf_1#3726, l_partkey_and_l_suppkey_prf#3708 AS l_partkey_and_l_suppkey_prf_1#3727, l_commitdate_prf#3709 AS l_commitdate_prf_1#3728, l_suppkey_prf#3710 AS l_suppkey_prf_1#3729, l_orderkey_prf#3711 AS l_orderkey_prf_1#3730]
         :     :  :     :  :     :     +- Relation[l_returnflag_prf#3693,l_orderkey_and_l_linenumber_prf#3694,l_comment_prf#3695,l_linestatus_prf#3696,rid#3697,l_shipmode_prf#3698,l_shipinstruct_prf#3699,l_quantity_prf#3700,l_receiptdate_prf#3701,l_linenumber_prf#3702,l_tax_prf#3703,l_shipdate_prf#3704,l_extendedprice_prf#3705,l_partkey_prf#3706,l_discount_prf#3707,l_partkey_and_l_suppkey_prf#3708,l_commitdate_prf#3709,l_suppkey_prf#3710,l_orderkey_prf#3711] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [s_phone_prf#3732 AS s_phone_prf_2#3740, rid#3733 AS rid_2#3741, s_address_prf#3734 AS s_address_prf_2#3742, s_nationkey_prf#3735 AS s_nationkey_prf_2#3743, s_suppkey_prf#3736 AS s_suppkey_prf_2#3744, s_name_prf#3737 AS s_name_prf_2#3745, s_acctbal_prf#3738 AS s_acctbal_prf_2#3746, s_comment_prf#3739 AS s_comment_prf_2#3747]
         :     :  :     :     +- Relation[s_phone_prf#3732,rid#3733,s_address_prf#3734,s_nationkey_prf#3735,s_suppkey_prf#3736,s_name_prf#3737,s_acctbal_prf#3738,s_comment_prf#3739] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [rid#3749 AS rid_3#3754, n_regionkey_prf#3750 AS n_regionkey_prf_3#3755, n_nationkey_prf#3751 AS n_nationkey_prf_3#3756, n_name_prf#3752 AS n_name_prf_3#3757, n_comment_prf#3753 AS n_comment_prf_3#3758]
         :     :     +- Relation[rid#3749,n_regionkey_prf#3750,n_nationkey_prf#3751,n_name_prf#3752,n_comment_prf#3753] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['r_regionkey_prf_4, 'r_name_prf_4, 'r_comment_prf_4, 'rid_4, 'rid_5, 'n_regionkey_prf_5, 'n_nationkey_prf_5, 'n_name_prf_5, 'n_comment_prf_5, 'rid_6, 'c_acctbal_prf_6, 'c_name_prf_6, 'c_nationkey_prf_6, 'c_custkey_prf_6, 'c_comment_prf_6, 'c_address_prf_6, 'c_mktsegment_prf_6, 'c_phone_prf_6, dexdecrypt('value_dec_key, value#2025) AS rid_7#3799]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_6
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['r_regionkey_prf_4, 'r_name_prf_4, 'r_comment_prf_4, 'rid_4, 'rid_5, 'n_regionkey_prf_5, 'n_nationkey_prf_5, 'n_name_prf_5, 'n_comment_prf_5, dexdecrypt('value_dec_key, value#2025) AS rid_6#3780]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_5
            :     :  :     :- 'Join NaturalJoin(Inner)
            :     :  :     :  :- 'Project ['r_regionkey_prf_4, 'r_name_prf_4, 'r_comment_prf_4, 'rid_4, dexdecrypt('value_dec_key, value#2025) AS rid_5#3769]
            :     :  :     :  :  +- 'DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_4#3767: string
            :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_4))
            :     :  :     :  :     :  :- Project [r_regionkey_prf#3760 AS r_regionkey_prf_4#3764, r_name_prf#3761 AS r_name_prf_4#3765, r_comment_prf#3762 AS r_comment_prf_4#3766, rid#3763 AS rid_4#3767]
            :     :  :     :  :     :  :  +- Relation[r_regionkey_prf#3760,r_name_prf#3761,r_comment_prf#3762,rid#3763] JDBCRelation(region_prf) [numPartitions=1]
            :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_4#3768]
            :     :  :     :  :     :     +- DexRidFilter region~r_name~AMERICA
            :     :  :     :  :     :        +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     :  :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  :     :  +- Project [rid#3770 AS rid_5#3775, n_regionkey_prf#3771 AS n_regionkey_prf_5#3776, n_nationkey_prf#3772 AS n_nationkey_prf_5#3777, n_name_prf#3773 AS n_name_prf_5#3778, n_comment_prf#3774 AS n_comment_prf_5#3779]
            :     :  :     :     +- Relation[rid#3770,n_regionkey_prf#3771,n_nationkey_prf#3772,n_name_prf#3773,n_comment_prf#3774] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [c_acctbal_prf#3781 AS c_acctbal_prf_6#3790, rid#3782 AS rid_6#3791, c_name_prf#3783 AS c_name_prf_6#3792, c_nationkey_prf#3784 AS c_nationkey_prf_6#3793, c_custkey_prf#3785 AS c_custkey_prf_6#3794, c_comment_prf#3786 AS c_comment_prf_6#3795, c_address_prf#3787 AS c_address_prf_6#3796, c_mktsegment_prf#3788 AS c_mktsegment_prf_6#3797, c_phone_prf#3789 AS c_phone_prf_6#3798]
            :     :     +- Relation[c_acctbal_prf#3781,rid#3782,c_name_prf#3783,c_nationkey_prf#3784,c_custkey_prf#3785,c_comment_prf#3786,c_address_prf#3787,c_mktsegment_prf#3788,c_phone_prf#3789] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3800 AS o_shippriority_prf_7#3810, rid#3801 AS rid_7#3811, o_orderdate_prf#3802 AS o_orderdate_prf_7#3812, o_custkey_prf#3803 AS o_custkey_prf_7#3813, o_orderpriority_prf#3804 AS o_orderpriority_prf_7#3814, o_clerk_prf#3805 AS o_clerk_prf_7#3815, o_orderstatus_prf#3806 AS o_orderstatus_prf_7#3816, o_totalprice_prf#3807 AS o_totalprice_prf_7#3817, o_orderkey_prf#3808 AS o_orderkey_prf_7#3818, o_comment_prf#3809 AS o_comment_prf_7#3819]
               +- Relation[o_shippriority_prf#3800,rid#3801,o_orderdate_prf#3802,o_custkey_prf#3803,o_orderpriority_prf#3804,o_clerk_prf#3805,o_orderstatus_prf#3806,o_totalprice_prf#3807,o_orderkey_prf#3808,o_comment_prf#3809] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=8716
Elapsed time: 96870ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
19/10/22 00:59:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 00:59:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3895L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/22 00:59:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3895L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(LeftAnti)
         :- Project [c_acctbal_prf#3929 AS c_acctbal_prf_1#3938, rid#3930 AS rid_1#3939, c_name_prf#3931 AS c_name_prf_1#3940, c_nationkey_prf#3932 AS c_nationkey_prf_1#3941, c_custkey_prf#3933 AS c_custkey_prf_1#3942, c_comment_prf#3934 AS c_comment_prf_1#3943, c_address_prf#3935 AS c_address_prf_1#3944, c_mktsegment_prf#3936 AS c_mktsegment_prf_1#3945, c_phone_prf#3937 AS c_phone_prf_1#3946]
         :  +- Relation[c_acctbal_prf#3929,rid#3930,c_name_prf#3931,c_nationkey_prf#3932,c_custkey_prf#3933,c_comment_prf#3934,c_address_prf#3935,c_mktsegment_prf#3936,c_phone_prf#3937] JDBCRelation(customer_prf) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_0))
            :- Project [o_shippriority_prf#3897 AS o_shippriority_prf_0#3907, rid#3898 AS rid_0#3908, o_orderdate_prf#3899 AS o_orderdate_prf_0#3909, o_custkey_prf#3900 AS o_custkey_prf_0#3910, o_orderpriority_prf#3901 AS o_orderpriority_prf_0#3911, o_clerk_prf#3902 AS o_clerk_prf_0#3912, o_orderstatus_prf#3903 AS o_orderstatus_prf_0#3913, o_totalprice_prf#3904 AS o_totalprice_prf_0#3914, o_orderkey_prf#3905 AS o_orderkey_prf_0#3915, o_comment_prf#3906 AS o_comment_prf_0#3916]
            :  +- Relation[o_shippriority_prf#3897,rid#3898,o_orderdate_prf#3899,o_custkey_prf#3900,o_orderpriority_prf#3901,o_clerk_prf#3902,o_orderstatus_prf#3903,o_totalprice_prf#3904,o_orderkey_prf#3905,o_comment_prf#3906] JDBCRelation(orders_prf) [numPartitions=1]
            +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2025) AS rid_1#3928]
               +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_0
                  :- 'Project ['rid AS rid_0#3927]
                  :  +- Relation[o_shippriority_prf#3917,rid#3918,o_orderdate_prf#3919,o_custkey_prf#3920,o_orderpriority_prf#3921,o_clerk_prf#3922,o_orderstatus_prf#3923,o_totalprice_prf#3924,o_orderkey_prf#3925,o_comment_prf#3926] JDBCRelation(orders_prf) [numPartitions=1]
                  +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]

DexCorr$ result size=50004
Elapsed time: 46128ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
19/10/22 01:00:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:00:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3961L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 01:00:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#3961L]
+- Project
   +- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- Project [l_returnflag_prf#3963 AS l_returnflag_prf_0#3982, l_orderkey_and_l_linenumber_prf#3964 AS l_orderkey_and_l_linenumber_prf_0#3983, l_comment_prf#3965 AS l_comment_prf_0#3984, l_linestatus_prf#3966 AS l_linestatus_prf_0#3985, rid#3967 AS rid_0#3986, l_shipmode_prf#3968 AS l_shipmode_prf_0#3987, l_shipinstruct_prf#3969 AS l_shipinstruct_prf_0#3988, l_quantity_prf#3970 AS l_quantity_prf_0#3989, l_receiptdate_prf#3971 AS l_receiptdate_prf_0#3990, l_linenumber_prf#3972 AS l_linenumber_prf_0#3991, l_tax_prf#3973 AS l_tax_prf_0#3992, l_shipdate_prf#3974 AS l_shipdate_prf_0#3993, l_extendedprice_prf#3975 AS l_extendedprice_prf_0#3994, l_partkey_prf#3976 AS l_partkey_prf_0#3995, l_discount_prf#3977 AS l_discount_prf_0#3996, l_partkey_and_l_suppkey_prf#3978 AS l_partkey_and_l_suppkey_prf_0#3997, l_commitdate_prf#3979 AS l_commitdate_prf_0#3998, l_suppkey_prf#3980 AS l_suppkey_prf_0#3999, l_orderkey_prf#3981 AS l_orderkey_prf_0#4000]
         +- Relation[l_returnflag_prf#3963,l_orderkey_and_l_linenumber_prf#3964,l_comment_prf#3965,l_linestatus_prf#3966,rid#3967,l_shipmode_prf#3968,l_shipinstruct_prf#3969,l_quantity_prf#3970,l_receiptdate_prf#3971,l_linenumber_prf#3972,l_tax_prf#3973,l_shipdate_prf#3974,l_extendedprice_prf#3975,l_partkey_prf#3976,l_discount_prf#3977,l_partkey_and_l_suppkey_prf#3978,l_commitdate_prf#3979,l_suppkey_prf#3980,l_orderkey_prf#3981] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 1777ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
19/10/22 01:00:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:00:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4024L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/22 01:00:05 WARN DexPlanner: InMemoryFileIndex=region
19/10/22 01:00:05 WARN DexPlanner: InMemoryFileIndex=region
19/10/22 01:00:05 WARN DexPlanner: InMemoryFileIndex=region
19/10/22 01:00:05 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:00:05 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:00:05 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:00:05 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:00:05 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:00:05 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:00:05 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:00:05 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:00:05 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:00:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4024L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, 'rid_2, 's_phone_prf_2, 's_address_prf_2, 's_nationkey_prf_2, 's_suppkey_prf_2, 's_name_prf_2, 's_acctbal_prf_2, 's_comment_prf_2, dexdecrypt('value_dec_key, value#2025) AS rid_4#4063]
         :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#2025) AS rid_2#4046]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#2025) AS rid_1#4035]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#4033: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [r_regionkey_prf#4026 AS r_regionkey_prf_0#4030, r_name_prf#4027 AS r_name_prf_0#4031, r_comment_prf#4028 AS r_comment_prf_0#4032, rid#4029 AS rid_0#4033]
         :     :  :     :  :     :  :  +- Relation[r_regionkey_prf#4026,r_name_prf#4027,r_comment_prf#4028,rid#4029] JDBCRelation(region_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4034]
         :     :  :     :  :     :     +- DexRidFilter region~r_name~EUROPE
         :     :  :     :  :     :        +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [rid#4036 AS rid_1#4041, n_regionkey_prf#4037 AS n_regionkey_prf_1#4042, n_nationkey_prf#4038 AS n_nationkey_prf_1#4043, n_name_prf#4039 AS n_name_prf_1#4044, n_comment_prf#4040 AS n_comment_prf_1#4045]
         :     :  :     :     +- Relation[rid#4036,n_regionkey_prf#4037,n_nationkey_prf#4038,n_name_prf#4039,n_comment_prf#4040] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#4047 AS s_phone_prf_2#4055, rid#4048 AS rid_2#4056, s_address_prf#4049 AS s_address_prf_2#4057, s_nationkey_prf#4050 AS s_nationkey_prf_2#4058, s_suppkey_prf#4051 AS s_suppkey_prf_2#4059, s_name_prf#4052 AS s_name_prf_2#4060, s_acctbal_prf#4053 AS s_acctbal_prf_2#4061, s_comment_prf#4054 AS s_comment_prf_2#4062]
         :     :     +- Relation[s_phone_prf#4047,rid#4048,s_address_prf#4049,s_nationkey_prf#4050,s_suppkey_prf#4051,s_name_prf#4052,s_acctbal_prf#4053,s_comment_prf#4054] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_3, 'p_name_prf_3, 'rid_3, 'p_type_prf_3, 'p_retailprice_prf_3, 'p_mfgr_prf_3, 'p_container_prf_3, 'p_brand_prf_3, 'p_size_prf_3, 'p_partkey_prf_3, dexdecrypt('value_dec_key, value#2025) AS rid_4#4085]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_3#4076: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :     :  :- Project [p_comment_prf#4064 AS p_comment_prf_3#4074, p_name_prf#4065 AS p_name_prf_3#4075, rid#4066 AS rid_3#4076, p_type_prf#4067 AS p_type_prf_3#4077, p_retailprice_prf#4068 AS p_retailprice_prf_3#4078, p_mfgr_prf#4069 AS p_mfgr_prf_3#4079, p_container_prf#4070 AS p_container_prf_3#4080, p_brand_prf#4071 AS p_brand_prf_3#4081, p_size_prf#4072 AS p_size_prf_3#4082, p_partkey_prf#4073 AS p_partkey_prf_3#4083]
            :     :  :  +- Relation[p_comment_prf#4064,p_name_prf#4065,rid#4066,p_type_prf#4067,p_retailprice_prf#4068,p_mfgr_prf#4069,p_container_prf#4070,p_brand_prf#4071,p_size_prf#4072,p_partkey_prf#4073] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#4084]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#4086 AS ps_partkey_and_ps_suppkey_prf_4#4093, rid#4087 AS rid_4#4094, ps_availqty_prf#4088 AS ps_availqty_prf_4#4095, ps_comment_prf#4089 AS ps_comment_prf_4#4096, ps_partkey_prf#4090 AS ps_partkey_prf_4#4097, ps_supplycost_prf#4091 AS ps_supplycost_prf_4#4098, ps_suppkey_prf#4092 AS ps_suppkey_prf_4#4099]
               +- Relation[ps_partkey_and_ps_suppkey_prf#4086,rid#4087,ps_availqty_prf#4088,ps_comment_prf#4089,ps_partkey_prf#4090,ps_supplycost_prf#4091,ps_suppkey_prf#4092] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=3162
Elapsed time: 2016ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
19/10/22 01:00:07 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:00:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4140L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/22 01:00:07 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:00:07 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:00:07 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:00:07 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:00:07 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:00:07 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:00:07 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:00:07 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:00:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4140L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#2025) AS rid_2#4170]
         :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#2025) AS rid_1#4153]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#4147: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#4142 AS rid_0#4147, n_regionkey_prf#4143 AS n_regionkey_prf_0#4148, n_nationkey_prf#4144 AS n_nationkey_prf_0#4149, n_name_prf#4145 AS n_name_prf_0#4150, n_comment_prf#4146 AS n_comment_prf_0#4151]
         :     :  :     :  :  +- Relation[rid#4142,n_regionkey_prf#4143,n_nationkey_prf#4144,n_name_prf#4145,n_comment_prf#4146] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4152]
         :     :  :     :     +- DexRidFilter nation~n_name~GERMANY
         :     :  :     :        +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#4154 AS s_phone_prf_1#4162, rid#4155 AS rid_1#4163, s_address_prf#4156 AS s_address_prf_1#4164, s_nationkey_prf#4157 AS s_nationkey_prf_1#4165, s_suppkey_prf#4158 AS s_suppkey_prf_1#4166, s_name_prf#4159 AS s_name_prf_1#4167, s_acctbal_prf#4160 AS s_acctbal_prf_1#4168, s_comment_prf#4161 AS s_comment_prf_1#4169]
         :     :     +- Relation[s_phone_prf#4154,rid#4155,s_address_prf#4156,s_nationkey_prf#4157,s_suppkey_prf#4158,s_name_prf#4159,s_acctbal_prf#4160,s_comment_prf#4161] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4171 AS ps_partkey_and_ps_suppkey_prf_2#4178, rid#4172 AS rid_2#4179, ps_availqty_prf#4173 AS ps_availqty_prf_2#4180, ps_comment_prf#4174 AS ps_comment_prf_2#4181, ps_partkey_prf#4175 AS ps_partkey_prf_2#4182, ps_supplycost_prf#4176 AS ps_supplycost_prf_2#4183, ps_suppkey_prf#4177 AS ps_suppkey_prf_2#4184]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4171,rid#4172,ps_availqty_prf#4173,ps_comment_prf#4174,ps_partkey_prf#4175,ps_supplycost_prf#4176,ps_suppkey_prf#4177] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=31680
Elapsed time: 796ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
19/10/22 01:00:08 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:00:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4211L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 01:00:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4211L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [p_comment_prf#4213 AS p_comment_prf_0#4223, p_name_prf#4214 AS p_name_prf_0#4224, rid#4215 AS rid_0#4225, p_type_prf#4216 AS p_type_prf_0#4226, p_retailprice_prf#4217 AS p_retailprice_prf_0#4227, p_mfgr_prf#4218 AS p_mfgr_prf_0#4228, p_container_prf#4219 AS p_container_prf_0#4229, p_brand_prf#4220 AS p_brand_prf_0#4230, p_size_prf#4221 AS p_size_prf_0#4231, p_partkey_prf#4222 AS p_partkey_prf_0#4232]
         :  :  +- Relation[p_comment_prf#4213,p_name_prf#4214,rid#4215,p_type_prf#4216,p_retailprice_prf#4217,p_mfgr_prf#4218,p_container_prf#4219,p_brand_prf#4220,p_size_prf#4221,p_partkey_prf#4222] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2025) AS rid_1#4244]
         :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4243]
         :        :  +- Relation[p_comment_prf#4233,p_name_prf#4234,rid#4235,p_type_prf#4236,p_retailprice_prf#4237,p_mfgr_prf#4238,p_container_prf#4239,p_brand_prf#4240,p_size_prf#4241,p_partkey_prf#4242] JDBCRelation(part_prf) [numPartitions=1]
         :        +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4245 AS l_returnflag_prf_1#4264, l_orderkey_and_l_linenumber_prf#4246 AS l_orderkey_and_l_linenumber_prf_1#4265, l_comment_prf#4247 AS l_comment_prf_1#4266, l_linestatus_prf#4248 AS l_linestatus_prf_1#4267, rid#4249 AS rid_1#4268, l_shipmode_prf#4250 AS l_shipmode_prf_1#4269, l_shipinstruct_prf#4251 AS l_shipinstruct_prf_1#4270, l_quantity_prf#4252 AS l_quantity_prf_1#4271, l_receiptdate_prf#4253 AS l_receiptdate_prf_1#4272, l_linenumber_prf#4254 AS l_linenumber_prf_1#4273, l_tax_prf#4255 AS l_tax_prf_1#4274, l_shipdate_prf#4256 AS l_shipdate_prf_1#4275, l_extendedprice_prf#4257 AS l_extendedprice_prf_1#4276, l_partkey_prf#4258 AS l_partkey_prf_1#4277, l_discount_prf#4259 AS l_discount_prf_1#4278, l_partkey_and_l_suppkey_prf#4260 AS l_partkey_and_l_suppkey_prf_1#4279, l_commitdate_prf#4261 AS l_commitdate_prf_1#4280, l_suppkey_prf#4262 AS l_suppkey_prf_1#4281, l_orderkey_prf#4263 AS l_orderkey_prf_1#4282]
            +- Relation[l_returnflag_prf#4245,l_orderkey_and_l_linenumber_prf#4246,l_comment_prf#4247,l_linestatus_prf#4248,rid#4249,l_shipmode_prf#4250,l_shipinstruct_prf#4251,l_quantity_prf#4252,l_receiptdate_prf#4253,l_linenumber_prf#4254,l_tax_prf#4255,l_shipdate_prf#4256,l_extendedprice_prf#4257,l_partkey_prf#4258,l_discount_prf#4259,l_partkey_and_l_suppkey_prf#4260,l_commitdate_prf#4261,l_suppkey_prf#4262,l_orderkey_prf#4263] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 90861ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
19/10/22 01:01:38 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:01:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4316L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 01:01:38 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 01:01:38 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 01:01:38 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 01:01:38 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 01:01:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4316L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#2025) AS rid_1#4340]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#4330: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :- Project [p_comment_prf#4318 AS p_comment_prf_0#4328, p_name_prf#4319 AS p_name_prf_0#4329, rid#4320 AS rid_0#4330, p_type_prf#4321 AS p_type_prf_0#4331, p_retailprice_prf#4322 AS p_retailprice_prf_0#4332, p_mfgr_prf#4323 AS p_mfgr_prf_0#4333, p_container_prf#4324 AS p_container_prf_0#4334, p_brand_prf#4325 AS p_brand_prf_0#4335, p_size_prf#4326 AS p_size_prf_0#4336, p_partkey_prf#4327 AS p_partkey_prf_0#4337]
         :     :  :  :  +- Relation[p_comment_prf#4318,p_name_prf#4319,rid#4320,p_type_prf#4321,p_retailprice_prf#4322,p_mfgr_prf#4323,p_container_prf#4324,p_brand_prf#4325,p_size_prf#4326,p_partkey_prf#4327] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4338]
         :     :  :     +- DexRidFilter part~p_brand~Brand#23
         :     :  :        +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4339]
         :     :     +- DexRidFilter part~p_container~MED BOX
         :     :        +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4341 AS l_returnflag_prf_1#4360, l_orderkey_and_l_linenumber_prf#4342 AS l_orderkey_and_l_linenumber_prf_1#4361, l_comment_prf#4343 AS l_comment_prf_1#4362, l_linestatus_prf#4344 AS l_linestatus_prf_1#4363, rid#4345 AS rid_1#4364, l_shipmode_prf#4346 AS l_shipmode_prf_1#4365, l_shipinstruct_prf#4347 AS l_shipinstruct_prf_1#4366, l_quantity_prf#4348 AS l_quantity_prf_1#4367, l_receiptdate_prf#4349 AS l_receiptdate_prf_1#4368, l_linenumber_prf#4350 AS l_linenumber_prf_1#4369, l_tax_prf#4351 AS l_tax_prf_1#4370, l_shipdate_prf#4352 AS l_shipdate_prf_1#4371, l_extendedprice_prf#4353 AS l_extendedprice_prf_1#4372, l_partkey_prf#4354 AS l_partkey_prf_1#4373, l_discount_prf#4355 AS l_discount_prf_1#4374, l_partkey_and_l_suppkey_prf#4356 AS l_partkey_and_l_suppkey_prf_1#4375, l_commitdate_prf#4357 AS l_commitdate_prf_1#4376, l_suppkey_prf#4358 AS l_suppkey_prf_1#4377, l_orderkey_prf#4359 AS l_orderkey_prf_1#4378]
            +- Relation[l_returnflag_prf#4341,l_orderkey_and_l_linenumber_prf#4342,l_comment_prf#4343,l_linestatus_prf#4344,rid#4345,l_shipmode_prf#4346,l_shipinstruct_prf#4347,l_quantity_prf#4348,l_receiptdate_prf#4349,l_linenumber_prf#4350,l_tax_prf#4351,l_shipdate_prf#4352,l_extendedprice_prf#4353,l_partkey_prf#4354,l_discount_prf#4355,l_partkey_and_l_suppkey_prf#4356,l_commitdate_prf#4357,l_suppkey_prf#4358,l_orderkey_prf#4359] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6088
Elapsed time: 363ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
19/10/22 01:01:39 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:01:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4415L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 01:01:39 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:01:39 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:01:39 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:01:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4415L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#4417 AS s_phone_prf_0#4425, rid#4418 AS rid_0#4426, s_address_prf#4419 AS s_address_prf_0#4427, s_nationkey_prf#4420 AS s_nationkey_prf_0#4428, s_suppkey_prf#4421 AS s_suppkey_prf_0#4429, s_name_prf#4422 AS s_name_prf_0#4430, s_acctbal_prf#4423 AS s_acctbal_prf_0#4431, s_comment_prf#4424 AS s_comment_prf_0#4432]
         :  :  +- Relation[s_phone_prf#4417,rid#4418,s_address_prf#4419,s_nationkey_prf#4420,s_suppkey_prf#4421,s_name_prf#4422,s_acctbal_prf#4423,s_comment_prf#4424] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2025) AS rid_1#4442]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4441]
         :        :  +- Relation[s_phone_prf#4433,rid#4434,s_address_prf#4435,s_nationkey_prf#4436,s_suppkey_prf#4437,s_name_prf#4438,s_acctbal_prf#4439,s_comment_prf#4440] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4443 AS l_returnflag_prf_1#4462, l_orderkey_and_l_linenumber_prf#4444 AS l_orderkey_and_l_linenumber_prf_1#4463, l_comment_prf#4445 AS l_comment_prf_1#4464, l_linestatus_prf#4446 AS l_linestatus_prf_1#4465, rid#4447 AS rid_1#4466, l_shipmode_prf#4448 AS l_shipmode_prf_1#4467, l_shipinstruct_prf#4449 AS l_shipinstruct_prf_1#4468, l_quantity_prf#4450 AS l_quantity_prf_1#4469, l_receiptdate_prf#4451 AS l_receiptdate_prf_1#4470, l_linenumber_prf#4452 AS l_linenumber_prf_1#4471, l_tax_prf#4453 AS l_tax_prf_1#4472, l_shipdate_prf#4454 AS l_shipdate_prf_1#4473, l_extendedprice_prf#4455 AS l_extendedprice_prf_1#4474, l_partkey_prf#4456 AS l_partkey_prf_1#4475, l_discount_prf#4457 AS l_discount_prf_1#4476, l_partkey_and_l_suppkey_prf#4458 AS l_partkey_and_l_suppkey_prf_1#4477, l_commitdate_prf#4459 AS l_commitdate_prf_1#4478, l_suppkey_prf#4460 AS l_suppkey_prf_1#4479, l_orderkey_prf#4461 AS l_orderkey_prf_1#4480]
            +- Relation[l_returnflag_prf#4443,l_orderkey_and_l_linenumber_prf#4444,l_comment_prf#4445,l_linestatus_prf#4446,rid#4447,l_shipmode_prf#4448,l_shipinstruct_prf#4449,l_quantity_prf#4450,l_receiptdate_prf#4451,l_linenumber_prf#4452,l_tax_prf#4453,l_shipdate_prf#4454,l_extendedprice_prf#4455,l_partkey_prf#4456,l_discount_prf#4457,l_partkey_and_l_suppkey_prf#4458,l_commitdate_prf#4459,l_suppkey_prf#4460,l_orderkey_prf#4461] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 82941ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
19/10/22 01:03:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:03:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4520L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/22 01:03:02 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:03:02 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:03:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4520L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 15 more fields]
         :  +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#2025) AS rid_1#4561]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4545: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [l_returnflag_prf#4522 AS l_returnflag_prf_0#4541, l_orderkey_and_l_linenumber_prf#4523 AS l_orderkey_and_l_linenumber_prf_0#4542, l_comment_prf#4524 AS l_comment_prf_0#4543, l_linestatus_prf#4525 AS l_linestatus_prf_0#4544, rid#4526 AS rid_0#4545, l_shipmode_prf#4527 AS l_shipmode_prf_0#4546, l_shipinstruct_prf#4528 AS l_shipinstruct_prf_0#4547, l_quantity_prf#4529 AS l_quantity_prf_0#4548, l_receiptdate_prf#4530 AS l_receiptdate_prf_0#4549, l_linenumber_prf#4531 AS l_linenumber_prf_0#4550, l_tax_prf#4532 AS l_tax_prf_0#4551, l_shipdate_prf#4533 AS l_shipdate_prf_0#4552, l_extendedprice_prf#4534 AS l_extendedprice_prf_0#4553, l_partkey_prf#4535 AS l_partkey_prf_0#4554, l_discount_prf#4536 AS l_discount_prf_0#4555, l_partkey_and_l_suppkey_prf#4537 AS l_partkey_and_l_suppkey_prf_0#4556, l_commitdate_prf#4538 AS l_commitdate_prf_0#4557, l_suppkey_prf#4539 AS l_suppkey_prf_0#4558, l_orderkey_prf#4540 AS l_orderkey_prf_0#4559]
         :     :  :     :  :     :  :  +- Relation[l_returnflag_prf#4522,l_orderkey_and_l_linenumber_prf#4523,l_comment_prf#4524,l_linestatus_prf#4525,rid#4526,l_shipmode_prf#4527,l_shipinstruct_prf#4528,l_quantity_prf#4529,l_receiptdate_prf#4530,l_linenumber_prf#4531,l_tax_prf#4532,l_shipdate_prf#4533,l_extendedprice_prf#4534,l_partkey_prf#4535,l_discount_prf#4536,l_partkey_and_l_suppkey_prf#4537,l_commitdate_prf#4538,l_suppkey_prf#4539,l_orderkey_prf#4540] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4560]
         :     :  :     :  :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :  :     :  :     :        +- Relation[label#2103,value#2104] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [o_shippriority_prf#4562 AS o_shippriority_prf_1#4572, rid#4563 AS rid_1#4573, o_orderdate_prf#4564 AS o_orderdate_prf_1#4574, o_custkey_prf#4565 AS o_custkey_prf_1#4575, o_orderpriority_prf#4566 AS o_orderpriority_prf_1#4576, o_clerk_prf#4567 AS o_clerk_prf_1#4577, o_orderstatus_prf#4568 AS o_orderstatus_prf_1#4578, o_totalprice_prf#4569 AS o_totalprice_prf_1#4579, o_orderkey_prf#4570 AS o_orderkey_prf_1#4580, o_comment_prf#4571 AS o_comment_prf_1#4581]
         :     :  :     :     +- Relation[o_shippriority_prf#4562,rid#4563,o_orderdate_prf#4564,o_custkey_prf#4565,o_orderpriority_prf#4566,o_clerk_prf#4567,o_orderstatus_prf#4568,o_totalprice_prf#4569,o_orderkey_prf#4570,o_comment_prf#4571] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#4583 AS c_acctbal_prf_2#4592, rid#4584 AS rid_2#4593, c_name_prf#4585 AS c_name_prf_2#4594, c_nationkey_prf#4586 AS c_nationkey_prf_2#4595, c_custkey_prf#4587 AS c_custkey_prf_2#4596, c_comment_prf#4588 AS c_comment_prf_2#4597, c_address_prf#4589 AS c_address_prf_2#4598, c_mktsegment_prf#4590 AS c_mktsegment_prf_2#4599, c_phone_prf#4591 AS c_phone_prf_2#4600]
         :     :     +- Relation[c_acctbal_prf#4583,rid#4584,c_name_prf#4585,c_nationkey_prf#4586,c_custkey_prf#4587,c_comment_prf#4588,c_address_prf#4589,c_mktsegment_prf#4590,c_phone_prf#4591] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#2024,value#2025] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#4602 AS rid_3#4607, n_regionkey_prf#4603 AS n_regionkey_prf_3#4608, n_nationkey_prf#4604 AS n_nationkey_prf_3#4609, n_name_prf#4605 AS n_name_prf_3#4610, n_comment_prf#4606 AS n_comment_prf_3#4611]
            +- Relation[rid#4602,n_regionkey_prf#4603,n_nationkey_prf#4604,n_name_prf#4605,n_comment_prf#4606] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 178741ms
query=q1, count=6001215, duration=1777
query=q10, count=1478870, duration=178741
query=q11, count=31680, duration=796
query=q12, count=857401, duration=31994
query=q13, count=1550004, duration=50636
query=q14, count=6001215, duration=90861
query=q15, count=6001215, duration=82941
query=q16, count=15780, duration=391
query=q17, count=6088, duration=363
query=q18, count=6001215, duration=230484
query=q19, count=205, duration=26296
query=q2, count=3162, duration=2016
query=q20, count=324, duration=22706
query=q21a, count=119924, duration=369895
query=q22, count=50004, duration=46128
query=q3, count=1214743, duration=33113
query=q4, count=6001215, duration=98883
query=q7, count=9735, duration=39520
query=q8, count=8716, duration=96870
query=q9a, count=6001215, duration=382452
query=q9b, count=6001215, duration=294714
