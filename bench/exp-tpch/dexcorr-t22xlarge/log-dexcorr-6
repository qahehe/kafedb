20/04/14 08:18:04 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 14839ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Tue Apr 14 08:18:09 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Tue Apr 14 08:18:11 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Tue Apr 14 08:18:11 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Tue Apr 14 08:18:11 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Tue Apr 14 08:18:11 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Tue Apr 14 08:18:17 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Tue Apr 14 08:18:22 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Tue Apr 14 08:18:22 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/14 08:18:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 08:18:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1907L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 08:18:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1907L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cl_returnflag_0, 'cl_orderkey_and_l_linenumber_0, 'cl_comment_0, 'cl_linestatus_0, 'rid_0, 'cl_shipmode_0, 'cl_shipinstruct_0, 'cl_quantity_0, 'cl_receiptdate_0, 'cl_linenumber_0, 'cl_tax_0, 'cl_shipdate_0, 'cl_extendedprice_0, 'cl_partkey_0, 'cl_discount_0, 'cl_partkey_and_l_suppkey_0, 'cl_commitdate_0, 'cl_suppkey_0, 'cl_orderkey_0, dexdecrypt('value_dec_key, value#1951) AS rid_1#1952]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#1932: binary
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [cl_returnflag#1909 AS cl_returnflag_0#1928, cl_orderkey_and_l_linenumber#1910 AS cl_orderkey_and_l_linenumber_0#1929, cl_comment#1911 AS cl_comment_0#1930, cl_linestatus#1912 AS cl_linestatus_0#1931, rid#1913 AS rid_0#1932, cl_shipmode#1914 AS cl_shipmode_0#1933, cl_shipinstruct#1915 AS cl_shipinstruct_0#1934, cl_quantity#1916 AS cl_quantity_0#1935, cl_receiptdate#1917 AS cl_receiptdate_0#1936, cl_linenumber#1918 AS cl_linenumber_0#1937, cl_tax#1919 AS cl_tax_0#1938, cl_shipdate#1920 AS cl_shipdate_0#1939, cl_extendedprice#1921 AS cl_extendedprice_0#1940, cl_partkey#1922 AS cl_partkey_0#1941, cl_discount#1923 AS cl_discount_0#1942, cl_partkey_and_l_suppkey#1924 AS cl_partkey_and_l_suppkey_0#1943, cl_commitdate#1925 AS cl_commitdate_0#1944, cl_suppkey#1926 AS cl_suppkey_0#1945, cl_orderkey#1927 AS cl_orderkey_0#1946]
         :     :  :  +- Relation[cl_returnflag#1909,cl_orderkey_and_l_linenumber#1910,cl_comment#1911,cl_linestatus#1912,rid#1913,cl_shipmode#1914,cl_shipinstruct#1915,cl_quantity#1916,cl_receiptdate#1917,cl_linenumber#1918,cl_tax#1919,cl_shipdate#1920,cl_extendedprice#1921,cl_partkey#1922,cl_discount#1923,cl_partkey_and_l_suppkey#1924,cl_commitdate#1925,cl_suppkey#1926,cl_orderkey#1927] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1949]
         :     :     +- DexRidFilter lineitem~l_shipmode~MAIL
         :     :        +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [co_shippriority#1953 AS co_shippriority_1#1963, rid#1954 AS rid_1#1964, co_orderdate#1955 AS co_orderdate_1#1965, co_custkey#1956 AS co_custkey_1#1966, co_orderpriority#1957 AS co_orderpriority_1#1967, co_clerk#1958 AS co_clerk_1#1968, co_orderstatus#1959 AS co_orderstatus_1#1969, co_totalprice#1960 AS co_totalprice_1#1970, co_orderkey#1961 AS co_orderkey_1#1971, co_comment#1962 AS co_comment_1#1972]
            +- Relation[co_shippriority#1953,rid#1954,co_orderdate#1955,co_custkey#1956,co_orderpriority#1957,co_clerk#1958,co_orderstatus#1959,co_totalprice#1960,co_orderkey#1961,co_comment#1962] JDBCRelation(torders) [numPartitions=1]

20/04/14 08:18:24 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=857401
Elapsed time: 63704ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/14 08:19:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 08:19:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2007L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/14 08:19:27 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 08:19:27 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 08:19:27 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 08:19:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 08:19:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:19:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:19:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:19:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 08:19:28 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 08:19:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2007L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(LeftSemi)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Project ['rid_2, 'cn_regionkey_2, 'cn_nationkey_2, 'cn_name_2, 'cn_comment_2, dexdecrypt('value_dec_key, value#1951) AS rid_3#2057]
         :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_2#2051: binary
         :  :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
         :  :     :  :- Project [rid#2046 AS rid_2#2051, cn_regionkey#2047 AS cn_regionkey_2#2052, cn_nationkey#2048 AS cn_nationkey_2#2053, cn_name#2049 AS cn_name_2#2054, cn_comment#2050 AS cn_comment_2#2055]
         :  :     :  :  +- Relation[rid#2046,cn_regionkey#2047,cn_nationkey#2048,cn_name#2049,cn_comment#2050] JDBCRelation(tnation) [numPartitions=1]
         :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#2056]
         :  :     :     +- DexRidFilter nation~n_name~CANADA
         :  :     :        +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]
         :  :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  +- Project [cs_phone#2058 AS cs_phone_3#2066, rid#2059 AS rid_3#2067, cs_address#2060 AS cs_address_3#2068, cs_nationkey#2061 AS cs_nationkey_3#2069, cs_suppkey#2062 AS cs_suppkey_3#2070, cs_name#2063 AS cs_name_3#2071, cs_acctbal#2064 AS cs_acctbal_3#2072, cs_comment#2065 AS cs_comment_3#2073]
         :     +- Relation[cs_phone#2058,rid#2059,cs_address#2060,cs_nationkey#2061,cs_suppkey#2062,cs_name#2063,cs_acctbal#2064,cs_comment#2065] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'Project ['cps_partkey_and_ps_suppkey_1, 'rid_1, 'cps_availqty_1, 'cps_comment_1, 'cps_partkey_1, 'cps_supplycost_1, 'cps_suppkey_1, dexdecrypt('value_dec_key, value#1951) AS rid_3#2045]
            +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, rid_1#2039: binary
               :- 'Join NaturalJoin(LeftSemi)
               :  :- Project [cps_partkey_and_ps_suppkey#2031 AS cps_partkey_and_ps_suppkey_1#2038, rid#2032 AS rid_1#2039, cps_availqty#2033 AS cps_availqty_1#2040, cps_comment#2034 AS cps_comment_1#2041, cps_partkey#2035 AS cps_partkey_1#2042, cps_supplycost#2036 AS cps_supplycost_1#2043, cps_suppkey#2037 AS cps_suppkey_1#2044]
               :  :  +- Relation[cps_partkey_and_ps_suppkey#2031,rid#2032,cps_availqty#2033,cps_comment#2034,cps_partkey#2035,cps_supplycost#2036,cps_suppkey#2037] JDBCRelation(tpartsupp) [numPartitions=1]
               :  +- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, dexdecrypt('value_dec_key, value#1951) AS rid_1#2030]
               :     +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2021: binary
               :        :- 'Join UsingJoin(LeftSemi,List(rid_0))
               :        :  :- Project [cp_comment#2009 AS cp_comment_0#2019, cp_name#2010 AS cp_name_0#2020, rid#2011 AS rid_0#2021, cp_type#2012 AS cp_type_0#2022, cp_retailprice#2013 AS cp_retailprice_0#2023, cp_mfgr#2014 AS cp_mfgr_0#2024, cp_container#2015 AS cp_container_0#2025, cp_brand#2016 AS cp_brand_0#2026, cp_size#2017 AS cp_size_0#2027, cp_partkey#2018 AS cp_partkey_0#2028]
               :        :  :  +- Relation[cp_comment#2009,cp_name#2010,rid#2011,cp_type#2012,cp_retailprice#2013,cp_mfgr#2014,cp_container#2015,cp_brand#2016,cp_size#2017,cp_partkey#2018] JDBCRelation(tpart) [numPartitions=1]
               :        :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2029]
               :        :     +- DexRidFilter part~p_size~15
               :        :        +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]
               :        +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
               +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]

DexCorr$ result size=324
Elapsed time: 6816ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/14 08:19:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 08:19:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2091L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1766L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1766L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1764L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1764L, l_suppkey#1766L]
               :     :        +- Relation[l_orderkey#1764L,l_partkey#1765L,l_suppkey#1766L,l_linenumber#1767,l_quantity#1768,l_extendedprice#1769,l_discount#1770,l_tax#1771,l_returnflag#1772,l_linestatus#1773,l_commitdate#1774,l_receiptdate#1775,l_shipinstruct#1776,l_shipmode#1777,l_comment#1778,l_shipdate#1779] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/14 08:19:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 08:19:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 08:19:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 08:19:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:19:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:19:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:19:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2091L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(LeftSemi)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Project ['co_shippriority_1, 'rid_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, 'co_clerk_1, 'co_orderstatus_1, 'co_totalprice_1, 'co_orderkey_1, 'co_comment_1, 'rid_2, 'cl_returnflag_2, 'cl_orderkey_and_l_linenumber_2, 'cl_comment_2, 'cl_linestatus_2, 'cl_shipmode_2, 'cl_shipinstruct_2, 'cl_quantity_2, 'cl_receiptdate_2, 'cl_linenumber_2, 'cl_tax_2, 'cl_shipdate_2, 'cl_extendedprice_2, 'cl_partkey_2, ... 14 more fields]
         :  :  +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_3
         :  :     :- 'Join NaturalJoin(Inner)
         :  :     :  :- 'Project ['co_shippriority_1, 'rid_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, 'co_clerk_1, 'co_orderstatus_1, 'co_totalprice_1, 'co_orderkey_1, 'co_comment_1, 'rid_2, 'cl_returnflag_2, 'cl_orderkey_and_l_linenumber_2, 'cl_comment_2, 'cl_linestatus_2, 'cl_shipmode_2, 'cl_shipinstruct_2, 'cl_quantity_2, 'cl_receiptdate_2, 'cl_linenumber_2, 'cl_tax_2, 'cl_shipdate_2, 'cl_extendedprice_2, 'cl_partkey_2, ... 6 more fields]
         :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_2
         :  :     :  :     :- 'Join NaturalJoin(Inner)
         :  :     :  :     :  :- 'Project ['co_shippriority_1, 'rid_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, 'co_clerk_1, 'co_orderstatus_1, 'co_totalprice_1, 'co_orderkey_1, 'co_comment_1, dexdecrypt('value_dec_key, value#1951) AS rid_2#2173]
         :  :     :  :     :  :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#2163: binary
         :  :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :     :  :     :  :     :  :- Project [co_shippriority#2152 AS co_shippriority_1#2162, rid#2153 AS rid_1#2163, co_orderdate#2154 AS co_orderdate_1#2164, co_custkey#2155 AS co_custkey_1#2165, co_orderpriority#2156 AS co_orderpriority_1#2166, co_clerk#2157 AS co_clerk_1#2167, co_orderstatus#2158 AS co_orderstatus_1#2168, co_totalprice#2159 AS co_totalprice_1#2169, co_orderkey#2160 AS co_orderkey_1#2170, co_comment#2161 AS co_comment_1#2171]
         :  :     :  :     :  :     :  :  +- Relation[co_shippriority#2152,rid#2153,co_orderdate#2154,co_custkey#2155,co_orderpriority#2156,co_clerk#2157,co_orderstatus#2158,co_totalprice#2159,co_orderkey#2160,co_comment#2161] JDBCRelation(torders) [numPartitions=1]
         :  :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2172]
         :  :     :  :     :  :     :     +- DexRidFilter orders~o_orderstatus~F
         :  :     :  :     :  :     :        +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]
         :  :     :  :     :  :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :     :  :     :  +- Project [cl_returnflag#2174 AS cl_returnflag_2#2193, cl_orderkey_and_l_linenumber#2175 AS cl_orderkey_and_l_linenumber_2#2194, cl_comment#2176 AS cl_comment_2#2195, cl_linestatus#2177 AS cl_linestatus_2#2196, rid#2178 AS rid_2#2197, cl_shipmode#2179 AS cl_shipmode_2#2198, cl_shipinstruct#2180 AS cl_shipinstruct_2#2199, cl_quantity#2181 AS cl_quantity_2#2200, cl_receiptdate#2182 AS cl_receiptdate_2#2201, cl_linenumber#2183 AS cl_linenumber_2#2202, cl_tax#2184 AS cl_tax_2#2203, cl_shipdate#2185 AS cl_shipdate_2#2204, cl_extendedprice#2186 AS cl_extendedprice_2#2205, cl_partkey#2187 AS cl_partkey_2#2206, cl_discount#2188 AS cl_discount_2#2207, cl_partkey_and_l_suppkey#2189 AS cl_partkey_and_l_suppkey_2#2208, cl_commitdate#2190 AS cl_commitdate_2#2209, cl_suppkey#2191 AS cl_suppkey_2#2210, cl_orderkey#2192 AS cl_orderkey_2#2211]
         :  :     :  :     :     +- Relation[cl_returnflag#2174,cl_orderkey_and_l_linenumber#2175,cl_comment#2176,cl_linestatus#2177,rid#2178,cl_shipmode#2179,cl_shipinstruct#2180,cl_quantity#2181,cl_receiptdate#2182,cl_linenumber#2183,cl_tax#2184,cl_shipdate#2185,cl_extendedprice#2186,cl_partkey#2187,cl_discount#2188,cl_partkey_and_l_suppkey#2189,cl_commitdate#2190,cl_suppkey#2191,cl_orderkey#2192] JDBCRelation(tlineitem) [numPartitions=1]
         :  :     :  :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :     :  +- Project [cs_phone#2213 AS cs_phone_3#2221, rid#2214 AS rid_3#2222, cs_address#2215 AS cs_address_3#2223, cs_nationkey#2216 AS cs_nationkey_3#2224, cs_suppkey#2217 AS cs_suppkey_3#2225, cs_name#2218 AS cs_name_3#2226, cs_acctbal#2219 AS cs_acctbal_3#2227, cs_comment#2220 AS cs_comment_3#2228]
         :  :     :     +- Relation[cs_phone#2213,rid#2214,cs_address#2215,cs_nationkey#2216,cs_suppkey#2217,cs_name#2218,cs_acctbal#2219,cs_comment#2220] JDBCRelation(tsupplier) [numPartitions=1]
         :  :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  +- 'Join UsingJoin(LeftSemi,List(rid_4))
         :     :- Project [rid#2230 AS rid_4#2235, cn_regionkey#2231 AS cn_regionkey_4#2236, cn_nationkey#2232 AS cn_nationkey_4#2237, cn_name#2233 AS cn_name_4#2238, cn_comment#2234 AS cn_comment_4#2239]
         :     :  +- Relation[rid#2230,cn_regionkey#2231,cn_nationkey#2232,cn_name#2233,cn_comment#2234] JDBCRelation(tnation) [numPartitions=1]
         :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_4#2240]
         :        +- DexRidFilter nation~n_name~SAUDI ARABIA
         :           +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_0))
            :- Project [cl_returnflag#2093 AS cl_returnflag_0#2112, cl_orderkey_and_l_linenumber#2094 AS cl_orderkey_and_l_linenumber_0#2113, cl_comment#2095 AS cl_comment_0#2114, cl_linestatus#2096 AS cl_linestatus_0#2115, rid#2097 AS rid_0#2116, cl_shipmode#2098 AS cl_shipmode_0#2117, cl_shipinstruct#2099 AS cl_shipinstruct_0#2118, cl_quantity#2100 AS cl_quantity_0#2119, cl_receiptdate#2101 AS cl_receiptdate_0#2120, cl_linenumber#2102 AS cl_linenumber_0#2121, cl_tax#2103 AS cl_tax_0#2122, cl_shipdate#2104 AS cl_shipdate_0#2123, cl_extendedprice#2105 AS cl_extendedprice_0#2124, cl_partkey#2106 AS cl_partkey_0#2125, cl_discount#2107 AS cl_discount_0#2126, cl_partkey_and_l_suppkey#2108 AS cl_partkey_and_l_suppkey_0#2127, cl_commitdate#2109 AS cl_commitdate_0#2128, cl_suppkey#2110 AS cl_suppkey_0#2129, cl_orderkey#2111 AS cl_orderkey_0#2130]
            :  +- Relation[cl_returnflag#2093,cl_orderkey_and_l_linenumber#2094,cl_comment#2095,cl_linestatus#2096,rid#2097,cl_shipmode#2098,cl_shipinstruct#2099,cl_quantity#2100,cl_receiptdate#2101,cl_linenumber#2102,cl_tax#2103,cl_shipdate#2104,cl_extendedprice#2105,cl_partkey#2106,cl_discount#2107,cl_partkey_and_l_suppkey#2108,cl_commitdate#2109,cl_suppkey#2110,cl_orderkey#2111] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1951) AS rid_1#2151]
               +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
                  :- 'Project ['rid AS rid_0#2150]
                  :  +- Relation[cl_returnflag#2131,cl_orderkey_and_l_linenumber#2132,cl_comment#2133,cl_linestatus#2134,rid#2135,cl_shipmode#2136,cl_shipinstruct#2137,cl_quantity#2138,cl_receiptdate#2139,cl_linenumber#2140,cl_tax#2141,cl_shipdate#2142,cl_extendedprice#2143,cl_partkey#2144,cl_discount#2145,cl_partkey_and_l_suppkey#2146,cl_commitdate#2147,cl_suppkey#2148,cl_orderkey#2149] JDBCRelation(tlineitem) [numPartitions=1]
                  +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]

DexCorr$ result size=119924
Elapsed time: 782041ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/14 08:32:36 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 08:32:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2292L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 08:32:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:32:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:32:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 08:32:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:32:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 08:32:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 08:32:36 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 08:32:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 08:32:36 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 08:32:36 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 08:32:36 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 08:32:37 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 08:32:37 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 08:32:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2292L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_4))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1951) AS rid_4#2388]
         :  :  :  :  +- 'DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, 'rid_2
         :  :  :  :     :- 'Project ['rid AS rid_2#2387]
         :  :  :  :     :  +- Relation[cps_partkey_and_ps_suppkey#2380,rid#2381,cps_availqty#2382,cps_comment#2383,cps_partkey#2384,cps_supplycost#2385,cps_suppkey#2386] JDBCRelation(tpartsupp) [numPartitions=1]
         :  :  :  :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  +- 'Join NaturalJoin(Inner)
         :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :     :  :- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1951) AS rid_3#2359]
         :  :  :     :  :  +- 'DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, 'rid_2
         :  :  :     :  :     :- 'Project ['rid AS rid_2#2358]
         :  :  :     :  :     :  +- Relation[cps_partkey_and_ps_suppkey#2351,rid#2352,cps_availqty#2353,cps_comment#2354,cps_partkey#2355,cps_supplycost#2356,cps_suppkey#2357] JDBCRelation(tpartsupp) [numPartitions=1]
         :  :  :     :  :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :  +- 'Join NaturalJoin(Inner)
         :  :  :     :     :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :     :     :  :- 'Join NaturalJoin(Inner)
         :  :  :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :     :     :  :  :  :- Project [rid#2294 AS rid_0#2299, cn_regionkey#2295 AS cn_regionkey_0#2300, cn_nationkey#2296 AS cn_nationkey_0#2301, cn_name#2297 AS cn_name_0#2302, cn_comment#2298 AS cn_comment_0#2303]
         :  :  :     :     :  :  :  :  +- Relation[rid#2294,cn_regionkey#2295,cn_nationkey#2296,cn_name#2297,cn_comment#2298] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     :     :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1951) AS rid_1#2310]
         :  :  :     :     :  :  :     +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_0
         :  :  :     :     :  :  :        :- 'Project ['rid AS rid_0#2309]
         :  :  :     :     :  :  :        :  +- Relation[rid#2304,cn_regionkey#2305,cn_nationkey#2306,cn_name#2307,cn_comment#2308] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     :     :  :  :        +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :     :  :  +- Project [cs_phone#2311 AS cs_phone_1#2319, rid#2312 AS rid_1#2320, cs_address#2313 AS cs_address_1#2321, cs_nationkey#2314 AS cs_nationkey_1#2322, cs_suppkey#2315 AS cs_suppkey_1#2323, cs_name#2316 AS cs_name_1#2324, cs_acctbal#2317 AS cs_acctbal_1#2325, cs_comment#2318 AS cs_comment_1#2326]
         :  :  :     :     :  :     +- Relation[cs_phone#2311,rid#2312,cs_address#2313,cs_nationkey#2314,cs_suppkey#2315,cs_name#2316,cs_acctbal#2317,cs_comment#2318] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     :     :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1951) AS rid_2#2336]
         :  :  :     :     :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_1
         :  :  :     :     :        :- 'Project ['rid AS rid_1#2335]
         :  :  :     :     :        :  +- Relation[cs_phone#2327,rid#2328,cs_address#2329,cs_nationkey#2330,cs_suppkey#2331,cs_name#2332,cs_acctbal#2333,cs_comment#2334] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     :     :        +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :     +- Project [cps_partkey_and_ps_suppkey#2337 AS cps_partkey_and_ps_suppkey_2#2344, rid#2338 AS rid_2#2345, cps_availqty#2339 AS cps_availqty_2#2346, cps_comment#2340 AS cps_comment_2#2347, cps_partkey#2341 AS cps_partkey_2#2348, cps_supplycost#2342 AS cps_supplycost_2#2349, cps_suppkey#2343 AS cps_suppkey_2#2350]
         :  :  :     :        +- Relation[cps_partkey_and_ps_suppkey#2337,rid#2338,cps_availqty#2339,cps_comment#2340,cps_partkey#2341,cps_supplycost#2342,cps_suppkey#2343] JDBCRelation(tpartsupp) [numPartitions=1]
         :  :  :     +- Project [cp_comment#2360 AS cp_comment_3#2370, cp_name#2361 AS cp_name_3#2371, rid#2362 AS rid_3#2372, cp_type#2363 AS cp_type_3#2373, cp_retailprice#2364 AS cp_retailprice_3#2374, cp_mfgr#2365 AS cp_mfgr_3#2375, cp_container#2366 AS cp_container_3#2376, cp_brand#2367 AS cp_brand_3#2377, cp_size#2368 AS cp_size_3#2378, cp_partkey#2369 AS cp_partkey_3#2379]
         :  :  :        +- Relation[cp_comment#2360,cp_name#2361,rid#2362,cp_type#2363,cp_retailprice#2364,cp_mfgr#2365,cp_container#2366,cp_brand#2367,cp_size#2368,cp_partkey#2369] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- Project [cl_returnflag#2389 AS cl_returnflag_4#2408, cl_orderkey_and_l_linenumber#2390 AS cl_orderkey_and_l_linenumber_4#2409, cl_comment#2391 AS cl_comment_4#2410, cl_linestatus#2392 AS cl_linestatus_4#2411, rid#2393 AS rid_4#2412, cl_shipmode#2394 AS cl_shipmode_4#2413, cl_shipinstruct#2395 AS cl_shipinstruct_4#2414, cl_quantity#2396 AS cl_quantity_4#2415, cl_receiptdate#2397 AS cl_receiptdate_4#2416, cl_linenumber#2398 AS cl_linenumber_4#2417, cl_tax#2399 AS cl_tax_4#2418, cl_shipdate#2400 AS cl_shipdate_4#2419, cl_extendedprice#2401 AS cl_extendedprice_4#2420, cl_partkey#2402 AS cl_partkey_4#2421, cl_discount#2403 AS cl_discount_4#2422, cl_partkey_and_l_suppkey#2404 AS cl_partkey_and_l_suppkey_4#2423, cl_commitdate#2405 AS cl_commitdate_4#2424, cl_suppkey#2406 AS cl_suppkey_4#2425, cl_orderkey#2407 AS cl_orderkey_4#2426]
         :  :     +- Relation[cl_returnflag#2389,cl_orderkey_and_l_linenumber#2390,cl_comment#2391,cl_linestatus#2392,rid#2393,cl_shipmode#2394,cl_shipinstruct#2395,cl_quantity#2396,cl_receiptdate#2397,cl_linenumber#2398,cl_tax#2399,cl_shipdate#2400,cl_extendedprice#2401,cl_partkey#2402,cl_discount#2403,cl_partkey_and_l_suppkey#2404,cl_commitdate#2405,cl_suppkey#2406,cl_orderkey#2407] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Project ['rid_4, dexdecrypt('value_dec_key, value#1951) AS rid_5#2447]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_4
         :        :- 'Project ['rid AS rid_4#2446]
         :        :  +- Relation[cl_returnflag#2427,cl_orderkey_and_l_linenumber#2428,cl_comment#2429,cl_linestatus#2430,rid#2431,cl_shipmode#2432,cl_shipinstruct#2433,cl_quantity#2434,cl_receiptdate#2435,cl_linenumber#2436,cl_tax#2437,cl_shipdate#2438,cl_extendedprice#2439,cl_partkey#2440,cl_discount#2441,cl_partkey_and_l_suppkey#2442,cl_commitdate#2443,cl_suppkey#2444,cl_orderkey#2445] JDBCRelation(tlineitem) [numPartitions=1]
         :        +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [co_shippriority#2448 AS co_shippriority_5#2458, rid#2449 AS rid_5#2459, co_orderdate#2450 AS co_orderdate_5#2460, co_custkey#2451 AS co_custkey_5#2461, co_orderpriority#2452 AS co_orderpriority_5#2462, co_clerk#2453 AS co_clerk_5#2463, co_orderstatus#2454 AS co_orderstatus_5#2464, co_totalprice#2455 AS co_totalprice_5#2465, co_orderkey#2456 AS co_orderkey_5#2466, co_comment#2457 AS co_comment_5#2467]
            +- Relation[co_shippriority#2448,rid#2449,co_orderdate#2450,co_custkey#2451,co_orderpriority#2452,co_clerk#2453,co_orderstatus#2454,co_totalprice#2455,co_orderkey#2456,co_comment#2457] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 542749ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/14 08:41:39 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 08:41:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2539L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/14 08:41:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:41:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:41:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2539L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cl_returnflag_0, 'cl_orderkey_and_l_linenumber_0, 'cl_comment_0, 'cl_linestatus_0, 'rid_0, 'cl_shipmode_0, 'cl_shipinstruct_0, 'cl_quantity_0, 'cl_receiptdate_0, 'cl_linenumber_0, 'cl_tax_0, 'cl_shipdate_0, 'cl_extendedprice_0, 'cl_partkey_0, 'cl_discount_0, 'cl_partkey_and_l_suppkey_0, 'cl_commitdate_0, 'cl_suppkey_0, 'cl_orderkey_0, 'rid_1, 'co_shippriority_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, ... 15 more fields]
         :  +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['cl_returnflag_0, 'cl_orderkey_and_l_linenumber_0, 'cl_comment_0, 'cl_linestatus_0, 'rid_0, 'cl_shipmode_0, 'cl_shipinstruct_0, 'cl_quantity_0, 'cl_receiptdate_0, 'cl_linenumber_0, 'cl_tax_0, 'cl_shipdate_0, 'cl_extendedprice_0, 'cl_partkey_0, 'cl_discount_0, 'cl_partkey_and_l_suppkey_0, 'cl_commitdate_0, 'cl_suppkey_0, 'cl_orderkey_0, 'rid_1, 'co_shippriority_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, ... 6 more fields]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['cl_returnflag_0, 'cl_orderkey_and_l_linenumber_0, 'cl_comment_0, 'cl_linestatus_0, 'rid_0, 'cl_shipmode_0, 'cl_shipinstruct_0, 'cl_quantity_0, 'cl_receiptdate_0, 'cl_linenumber_0, 'cl_tax_0, 'cl_shipdate_0, 'cl_extendedprice_0, 'cl_partkey_0, 'cl_discount_0, 'cl_partkey_and_l_suppkey_0, 'cl_commitdate_0, 'cl_suppkey_0, 'cl_orderkey_0, dexdecrypt('value_dec_key, value#1951) AS rid_1#2580]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2564: binary
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [cl_returnflag#2541 AS cl_returnflag_0#2560, cl_orderkey_and_l_linenumber#2542 AS cl_orderkey_and_l_linenumber_0#2561, cl_comment#2543 AS cl_comment_0#2562, cl_linestatus#2544 AS cl_linestatus_0#2563, rid#2545 AS rid_0#2564, cl_shipmode#2546 AS cl_shipmode_0#2565, cl_shipinstruct#2547 AS cl_shipinstruct_0#2566, cl_quantity#2548 AS cl_quantity_0#2567, cl_receiptdate#2549 AS cl_receiptdate_0#2568, cl_linenumber#2550 AS cl_linenumber_0#2569, cl_tax#2551 AS cl_tax_0#2570, cl_shipdate#2552 AS cl_shipdate_0#2571, cl_extendedprice#2553 AS cl_extendedprice_0#2572, cl_partkey#2554 AS cl_partkey_0#2573, cl_discount#2555 AS cl_discount_0#2574, cl_partkey_and_l_suppkey#2556 AS cl_partkey_and_l_suppkey_0#2575, cl_commitdate#2557 AS cl_commitdate_0#2576, cl_suppkey#2558 AS cl_suppkey_0#2577, cl_orderkey#2559 AS cl_orderkey_0#2578]
         :     :  :     :  :     :  :  +- Relation[cl_returnflag#2541,cl_orderkey_and_l_linenumber#2542,cl_comment#2543,cl_linestatus#2544,rid#2545,cl_shipmode#2546,cl_shipinstruct#2547,cl_quantity#2548,cl_receiptdate#2549,cl_linenumber#2550,cl_tax#2551,cl_shipdate#2552,cl_extendedprice#2553,cl_partkey#2554,cl_discount#2555,cl_partkey_and_l_suppkey#2556,cl_commitdate#2557,cl_suppkey#2558,cl_orderkey#2559] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2579]
         :     :  :     :  :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :  :     :  :     :        +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [co_shippriority#2581 AS co_shippriority_1#2591, rid#2582 AS rid_1#2592, co_orderdate#2583 AS co_orderdate_1#2593, co_custkey#2584 AS co_custkey_1#2594, co_orderpriority#2585 AS co_orderpriority_1#2595, co_clerk#2586 AS co_clerk_1#2596, co_orderstatus#2587 AS co_orderstatus_1#2597, co_totalprice#2588 AS co_totalprice_1#2598, co_orderkey#2589 AS co_orderkey_1#2599, co_comment#2590 AS co_comment_1#2600]
         :     :  :     :     +- Relation[co_shippriority#2581,rid#2582,co_orderdate#2583,co_custkey#2584,co_orderpriority#2585,co_clerk#2586,co_orderstatus#2587,co_totalprice#2588,co_orderkey#2589,co_comment#2590] JDBCRelation(torders) [numPartitions=1]
         :     :  :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [cc_acctbal#2602 AS cc_acctbal_2#2611, rid#2603 AS rid_2#2612, cc_name#2604 AS cc_name_2#2613, cc_nationkey#2605 AS cc_nationkey_2#2614, cc_custkey#2606 AS cc_custkey_2#2615, cc_comment#2607 AS cc_comment_2#2616, cc_address#2608 AS cc_address_2#2617, cc_mktsegment#2609 AS cc_mktsegment_2#2618, cc_phone#2610 AS cc_phone_2#2619]
         :     :     +- Relation[cc_acctbal#2602,rid#2603,cc_name#2604,cc_nationkey#2605,cc_custkey#2606,cc_comment#2607,cc_address#2608,cc_mktsegment#2609,cc_phone#2610] JDBCRelation(tcustomer) [numPartitions=1]
         :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#2621 AS rid_3#2626, cn_regionkey#2622 AS cn_regionkey_3#2627, cn_nationkey#2623 AS cn_nationkey_3#2628, cn_name#2624 AS cn_name_3#2629, cn_comment#2625 AS cn_comment_3#2630]
            +- Relation[rid#2621,cn_regionkey#2622,cn_nationkey#2623,cn_name#2624,cn_comment#2625] JDBCRelation(tnation) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 439676ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/14 08:48:59 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 08:48:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2680L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/14 08:48:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:48:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:48:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:48:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 08:48:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 08:48:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 08:48:59 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 08:48:59 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 08:48:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2680L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'cn_regionkey_0, 'cn_nationkey_0, 'cn_name_0, 'cn_comment_0, 'rid_1, 'cs_phone_1, 'cs_address_1, 'cs_nationkey_1, 'cs_suppkey_1, 'cs_name_1, 'cs_acctbal_1, 'cs_comment_1, dexdecrypt('value_dec_key, value#1951) AS rid_2#2710]
         :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'cn_regionkey_0, 'cn_nationkey_0, 'cn_name_0, 'cn_comment_0, dexdecrypt('value_dec_key, value#1951) AS rid_1#2693]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#2687: binary
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#2682 AS rid_0#2687, cn_regionkey#2683 AS cn_regionkey_0#2688, cn_nationkey#2684 AS cn_nationkey_0#2689, cn_name#2685 AS cn_name_0#2690, cn_comment#2686 AS cn_comment_0#2691]
         :     :  :     :  :  +- Relation[rid#2682,cn_regionkey#2683,cn_nationkey#2684,cn_name#2685,cn_comment#2686] JDBCRelation(tnation) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2692]
         :     :  :     :     +- DexRidFilter nation~n_name~GERMANY
         :     :  :     :        +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [cs_phone#2694 AS cs_phone_1#2702, rid#2695 AS rid_1#2703, cs_address#2696 AS cs_address_1#2704, cs_nationkey#2697 AS cs_nationkey_1#2705, cs_suppkey#2698 AS cs_suppkey_1#2706, cs_name#2699 AS cs_name_1#2707, cs_acctbal#2700 AS cs_acctbal_1#2708, cs_comment#2701 AS cs_comment_1#2709]
         :     :     +- Relation[cs_phone#2694,rid#2695,cs_address#2696,cs_nationkey#2697,cs_suppkey#2698,cs_name#2699,cs_acctbal#2700,cs_comment#2701] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cps_partkey_and_ps_suppkey#2711 AS cps_partkey_and_ps_suppkey_2#2718, rid#2712 AS rid_2#2719, cps_availqty#2713 AS cps_availqty_2#2720, cps_comment#2714 AS cps_comment_2#2721, cps_partkey#2715 AS cps_partkey_2#2722, cps_supplycost#2716 AS cps_supplycost_2#2723, cps_suppkey#2717 AS cps_suppkey_2#2724]
            +- Relation[cps_partkey_and_ps_suppkey#2711,rid#2712,cps_availqty#2713,cps_comment#2714,cps_partkey#2715,cps_supplycost#2716,cps_suppkey#2717] JDBCRelation(tpartsupp) [numPartitions=1]

DexCorr$ result size=31680
Elapsed time: 6189ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/14 08:49:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 08:49:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2751L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 08:49:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2751L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [cp_comment#2753 AS cp_comment_0#2763, cp_name#2754 AS cp_name_0#2764, rid#2755 AS rid_0#2765, cp_type#2756 AS cp_type_0#2766, cp_retailprice#2757 AS cp_retailprice_0#2767, cp_mfgr#2758 AS cp_mfgr_0#2768, cp_container#2759 AS cp_container_0#2769, cp_brand#2760 AS cp_brand_0#2770, cp_size#2761 AS cp_size_0#2771, cp_partkey#2762 AS cp_partkey_0#2772]
         :  :  +- Relation[cp_comment#2753,cp_name#2754,rid#2755,cp_type#2756,cp_retailprice#2757,cp_mfgr#2758,cp_container#2759,cp_brand#2760,cp_size#2761,cp_partkey#2762] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1951) AS rid_1#2784]
         :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2783]
         :        :  +- Relation[cp_comment#2773,cp_name#2774,rid#2775,cp_type#2776,cp_retailprice#2777,cp_mfgr#2778,cp_container#2779,cp_brand#2780,cp_size#2781,cp_partkey#2782] JDBCRelation(tpart) [numPartitions=1]
         :        +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cl_returnflag#2785 AS cl_returnflag_1#2804, cl_orderkey_and_l_linenumber#2786 AS cl_orderkey_and_l_linenumber_1#2805, cl_comment#2787 AS cl_comment_1#2806, cl_linestatus#2788 AS cl_linestatus_1#2807, rid#2789 AS rid_1#2808, cl_shipmode#2790 AS cl_shipmode_1#2809, cl_shipinstruct#2791 AS cl_shipinstruct_1#2810, cl_quantity#2792 AS cl_quantity_1#2811, cl_receiptdate#2793 AS cl_receiptdate_1#2812, cl_linenumber#2794 AS cl_linenumber_1#2813, cl_tax#2795 AS cl_tax_1#2814, cl_shipdate#2796 AS cl_shipdate_1#2815, cl_extendedprice#2797 AS cl_extendedprice_1#2816, cl_partkey#2798 AS cl_partkey_1#2817, cl_discount#2799 AS cl_discount_1#2818, cl_partkey_and_l_suppkey#2800 AS cl_partkey_and_l_suppkey_1#2819, cl_commitdate#2801 AS cl_commitdate_1#2820, cl_suppkey#2802 AS cl_suppkey_1#2821, cl_orderkey#2803 AS cl_orderkey_1#2822]
            +- Relation[cl_returnflag#2785,cl_orderkey_and_l_linenumber#2786,cl_comment#2787,cl_linestatus#2788,rid#2789,cl_shipmode#2790,cl_shipinstruct#2791,cl_quantity#2792,cl_receiptdate#2793,cl_linenumber#2794,cl_tax#2795,cl_shipdate#2796,cl_extendedprice#2797,cl_partkey#2798,cl_discount#2799,cl_partkey_and_l_suppkey#2800,cl_commitdate#2801,cl_suppkey#2802,cl_orderkey#2803] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 225138ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/14 08:52:50 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 08:52:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2860L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 08:52:50 WARN DexPlanner: InMemoryFileIndex=customer
20/04/14 08:52:50 WARN DexPlanner: InMemoryFileIndex=customer
20/04/14 08:52:50 WARN DexPlanner: InMemoryFileIndex=customer
20/04/14 08:52:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2860L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cc_acctbal_0, 'rid_0, 'cc_name_0, 'cc_nationkey_0, 'cc_custkey_0, 'cc_comment_0, 'cc_address_0, 'cc_mktsegment_0, 'cc_phone_0, 'rid_1, 'co_shippriority_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, 'co_clerk_1, 'co_orderstatus_1, 'co_totalprice_1, 'co_orderkey_1, 'co_comment_1, dexdecrypt('value_dec_key, value#1951) AS rid_2#2902]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['cc_acctbal_0, 'rid_0, 'cc_name_0, 'cc_nationkey_0, 'cc_custkey_0, 'cc_comment_0, 'cc_address_0, 'cc_mktsegment_0, 'cc_phone_0, dexdecrypt('value_dec_key, value#1951) AS rid_1#2881]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2872: binary
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [cc_acctbal#2862 AS cc_acctbal_0#2871, rid#2863 AS rid_0#2872, cc_name#2864 AS cc_name_0#2873, cc_nationkey#2865 AS cc_nationkey_0#2874, cc_custkey#2866 AS cc_custkey_0#2875, cc_comment#2867 AS cc_comment_0#2876, cc_address#2868 AS cc_address_0#2877, cc_mktsegment#2869 AS cc_mktsegment_0#2878, cc_phone#2870 AS cc_phone_0#2879]
         :     :  :     :  :  +- Relation[cc_acctbal#2862,rid#2863,cc_name#2864,cc_nationkey#2865,cc_custkey#2866,cc_comment#2867,cc_address#2868,cc_mktsegment#2869,cc_phone#2870] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2880]
         :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :        +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [co_shippriority#2882 AS co_shippriority_1#2892, rid#2883 AS rid_1#2893, co_orderdate#2884 AS co_orderdate_1#2894, co_custkey#2885 AS co_custkey_1#2895, co_orderpriority#2886 AS co_orderpriority_1#2896, co_clerk#2887 AS co_clerk_1#2897, co_orderstatus#2888 AS co_orderstatus_1#2898, co_totalprice#2889 AS co_totalprice_1#2899, co_orderkey#2890 AS co_orderkey_1#2900, co_comment#2891 AS co_comment_1#2901]
         :     :     +- Relation[co_shippriority#2882,rid#2883,co_orderdate#2884,co_custkey#2885,co_orderpriority#2886,co_clerk#2887,co_orderstatus#2888,co_totalprice#2889,co_orderkey#2890,co_comment#2891] JDBCRelation(torders) [numPartitions=1]
         :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cl_returnflag#2903 AS cl_returnflag_2#2922, cl_orderkey_and_l_linenumber#2904 AS cl_orderkey_and_l_linenumber_2#2923, cl_comment#2905 AS cl_comment_2#2924, cl_linestatus#2906 AS cl_linestatus_2#2925, rid#2907 AS rid_2#2926, cl_shipmode#2908 AS cl_shipmode_2#2927, cl_shipinstruct#2909 AS cl_shipinstruct_2#2928, cl_quantity#2910 AS cl_quantity_2#2929, cl_receiptdate#2911 AS cl_receiptdate_2#2930, cl_linenumber#2912 AS cl_linenumber_2#2931, cl_tax#2913 AS cl_tax_2#2932, cl_shipdate#2914 AS cl_shipdate_2#2933, cl_extendedprice#2915 AS cl_extendedprice_2#2934, cl_partkey#2916 AS cl_partkey_2#2935, cl_discount#2917 AS cl_discount_2#2936, cl_partkey_and_l_suppkey#2918 AS cl_partkey_and_l_suppkey_2#2937, cl_commitdate#2919 AS cl_commitdate_2#2938, cl_suppkey#2920 AS cl_suppkey_2#2939, cl_orderkey#2921 AS cl_orderkey_2#2940]
            +- Relation[cl_returnflag#2903,cl_orderkey_and_l_linenumber#2904,cl_comment#2905,cl_linestatus#2906,rid#2907,cl_shipmode#2908,cl_shipinstruct#2909,cl_quantity#2910,cl_receiptdate#2911,cl_linenumber#2912,cl_tax#2913,cl_shipdate#2914,cl_extendedprice#2915,cl_partkey#2916,cl_discount#2917,cl_partkey_and_l_suppkey#2918,cl_commitdate#2919,cl_suppkey#2920,cl_orderkey#2921] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 108080ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/14 08:54:38 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 08:54:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2984L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 08:54:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#2984L]
+- Project
   +- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- Project [cl_returnflag#2986 AS cl_returnflag_0#3005, cl_orderkey_and_l_linenumber#2987 AS cl_orderkey_and_l_linenumber_0#3006, cl_comment#2988 AS cl_comment_0#3007, cl_linestatus#2989 AS cl_linestatus_0#3008, rid#2990 AS rid_0#3009, cl_shipmode#2991 AS cl_shipmode_0#3010, cl_shipinstruct#2992 AS cl_shipinstruct_0#3011, cl_quantity#2993 AS cl_quantity_0#3012, cl_receiptdate#2994 AS cl_receiptdate_0#3013, cl_linenumber#2995 AS cl_linenumber_0#3014, cl_tax#2996 AS cl_tax_0#3015, cl_shipdate#2997 AS cl_shipdate_0#3016, cl_extendedprice#2998 AS cl_extendedprice_0#3017, cl_partkey#2999 AS cl_partkey_0#3018, cl_discount#3000 AS cl_discount_0#3019, cl_partkey_and_l_suppkey#3001 AS cl_partkey_and_l_suppkey_0#3020, cl_commitdate#3002 AS cl_commitdate_0#3021, cl_suppkey#3003 AS cl_suppkey_0#3022, cl_orderkey#3004 AS cl_orderkey_0#3023]
         +- Relation[cl_returnflag#2986,cl_orderkey_and_l_linenumber#2987,cl_comment#2988,cl_linestatus#2989,rid#2990,cl_shipmode#2991,cl_shipinstruct#2992,cl_quantity#2993,cl_receiptdate#2994,cl_linenumber#2995,cl_tax#2996,cl_shipdate#2997,cl_extendedprice#2998,cl_partkey#2999,cl_discount#3000,cl_partkey_and_l_suppkey#3001,cl_commitdate#3002,cl_suppkey#3003,cl_orderkey#3004] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 3945ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/14 08:54:42 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 08:54:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3051L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#612L = c_nationkey#293L)
               :     :- Project [n_nationkey#612L]
               :     :  +- Filter (n_name#613 = GERMANY)
               :     :     +- Relation[n_nationkey#612L,n_name#613,n_regionkey#614L,n_comment#615] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 08:54:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:54:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:54:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:54:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 08:54:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 08:54:42 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 08:54:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:54:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:54:42 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:54:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3051L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'cn_regionkey_0, 'cn_nationkey_0, 'cn_name_0, 'cn_comment_0, 'rid_1, 'cs_phone_1, 'cs_address_1, 'cs_nationkey_1, 'cs_suppkey_1, 'cs_name_1, 'cs_acctbal_1, 'cs_comment_1, 'rid_2, 'cl_returnflag_2, 'cl_orderkey_and_l_linenumber_2, 'cl_comment_2, 'cl_linestatus_2, 'cl_shipmode_2, 'cl_shipinstruct_2, 'cl_quantity_2, 'cl_receiptdate_2, 'cl_linenumber_2, 'cl_tax_2, ... 9 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'cn_regionkey_0, 'cn_nationkey_0, 'cn_name_0, 'cn_comment_0, 'rid_1, 'cs_phone_1, 'cs_address_1, 'cs_nationkey_1, 'cs_suppkey_1, 'cs_name_1, 'cs_acctbal_1, 'cs_comment_1, dexdecrypt('value_dec_key, value#1951) AS rid_2#3081]
         :     :  :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['rid_0, 'cn_regionkey_0, 'cn_nationkey_0, 'cn_name_0, 'cn_comment_0, dexdecrypt('value_dec_key, value#1951) AS rid_1#3064]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#3058: binary
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [rid#3053 AS rid_0#3058, cn_regionkey#3054 AS cn_regionkey_0#3059, cn_nationkey#3055 AS cn_nationkey_0#3060, cn_name#3056 AS cn_name_0#3061, cn_comment#3057 AS cn_comment_0#3062]
         :     :  :     :  :     :  :  +- Relation[rid#3053,cn_regionkey#3054,cn_nationkey#3055,cn_name#3056,cn_comment#3057] JDBCRelation(tnation) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3063]
         :     :  :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :  :     :        +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [cs_phone#3065 AS cs_phone_1#3073, rid#3066 AS rid_1#3074, cs_address#3067 AS cs_address_1#3075, cs_nationkey#3068 AS cs_nationkey_1#3076, cs_suppkey#3069 AS cs_suppkey_1#3077, cs_name#3070 AS cs_name_1#3078, cs_acctbal#3071 AS cs_acctbal_1#3079, cs_comment#3072 AS cs_comment_1#3080]
         :     :  :     :     +- Relation[cs_phone#3065,rid#3066,cs_address#3067,cs_nationkey#3068,cs_suppkey#3069,cs_name#3070,cs_acctbal#3071,cs_comment#3072] JDBCRelation(tsupplier) [numPartitions=1]
         :     :  :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [cl_returnflag#3082 AS cl_returnflag_2#3101, cl_orderkey_and_l_linenumber#3083 AS cl_orderkey_and_l_linenumber_2#3102, cl_comment#3084 AS cl_comment_2#3103, cl_linestatus#3085 AS cl_linestatus_2#3104, rid#3086 AS rid_2#3105, cl_shipmode#3087 AS cl_shipmode_2#3106, cl_shipinstruct#3088 AS cl_shipinstruct_2#3107, cl_quantity#3089 AS cl_quantity_2#3108, cl_receiptdate#3090 AS cl_receiptdate_2#3109, cl_linenumber#3091 AS cl_linenumber_2#3110, cl_tax#3092 AS cl_tax_2#3111, cl_shipdate#3093 AS cl_shipdate_2#3112, cl_extendedprice#3094 AS cl_extendedprice_2#3113, cl_partkey#3095 AS cl_partkey_2#3114, cl_discount#3096 AS cl_discount_2#3115, cl_partkey_and_l_suppkey#3097 AS cl_partkey_and_l_suppkey_2#3116, cl_commitdate#3098 AS cl_commitdate_2#3117, cl_suppkey#3099 AS cl_suppkey_2#3118, cl_orderkey#3100 AS cl_orderkey_2#3119]
         :     :     +- Relation[cl_returnflag#3082,cl_orderkey_and_l_linenumber#3083,cl_comment#3084,cl_linestatus#3085,rid#3086,cl_shipmode#3087,cl_shipinstruct#3088,cl_quantity#3089,cl_receiptdate#3090,cl_linenumber#3091,cl_tax#3092,cl_shipdate#3093,cl_extendedprice#3094,cl_partkey#3095,cl_discount#3096,cl_partkey_and_l_suppkey#3097,cl_commitdate#3098,cl_suppkey#3099,cl_orderkey#3100] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_3, 'cn_regionkey_3, 'cn_nationkey_3, 'cn_name_3, 'cn_comment_3, 'rid_4, 'cc_acctbal_4, 'cc_name_4, 'cc_nationkey_4, 'cc_custkey_4, 'cc_comment_4, 'cc_address_4, 'cc_mktsegment_4, 'cc_phone_4, dexdecrypt('value_dec_key, value#1951) AS rid_5#3151]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_4
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['rid_3, 'cn_regionkey_3, 'cn_nationkey_3, 'cn_name_3, 'cn_comment_3, dexdecrypt('value_dec_key, value#1951) AS rid_4#3132]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_3#3126: binary
            :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :     :  :     :  :- Project [rid#3121 AS rid_3#3126, cn_regionkey#3122 AS cn_regionkey_3#3127, cn_nationkey#3123 AS cn_nationkey_3#3128, cn_name#3124 AS cn_name_3#3129, cn_comment#3125 AS cn_comment_3#3130]
            :     :  :     :  :  +- Relation[rid#3121,cn_regionkey#3122,cn_nationkey#3123,cn_name#3124,cn_comment#3125] JDBCRelation(tnation) [numPartitions=1]
            :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#3131]
            :     :  :     :     +- DexRidFilter nation~n_name~GERMANY
            :     :  :     :        +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [cc_acctbal#3133 AS cc_acctbal_4#3142, rid#3134 AS rid_4#3143, cc_name#3135 AS cc_name_4#3144, cc_nationkey#3136 AS cc_nationkey_4#3145, cc_custkey#3137 AS cc_custkey_4#3146, cc_comment#3138 AS cc_comment_4#3147, cc_address#3139 AS cc_address_4#3148, cc_mktsegment#3140 AS cc_mktsegment_4#3149, cc_phone#3141 AS cc_phone_4#3150]
            :     :     +- Relation[cc_acctbal#3133,rid#3134,cc_name#3135,cc_nationkey#3136,cc_custkey#3137,cc_comment#3138,cc_address#3139,cc_mktsegment#3140,cc_phone#3141] JDBCRelation(tcustomer) [numPartitions=1]
            :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [co_shippriority#3152 AS co_shippriority_5#3162, rid#3153 AS rid_5#3163, co_orderdate#3154 AS co_orderdate_5#3164, co_custkey#3155 AS co_custkey_5#3165, co_orderpriority#3156 AS co_orderpriority_5#3166, co_clerk#3157 AS co_clerk_5#3167, co_orderstatus#3158 AS co_orderstatus_5#3168, co_totalprice#3159 AS co_totalprice_5#3169, co_orderkey#3160 AS co_orderkey_5#3170, co_comment#3161 AS co_comment_5#3171]
               +- Relation[co_shippriority#3152,rid#3153,co_orderdate#3154,co_custkey#3155,co_orderpriority#3156,co_clerk#3157,co_orderstatus#3158,co_totalprice#3159,co_orderkey#3160,co_comment#3161] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=9735
Elapsed time: 44328ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/14 08:55:26 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 08:55:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3233L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 08:55:26 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 08:55:26 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 08:55:26 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 08:55:26 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 08:55:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3233L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, dexdecrypt('value_dec_key, value#1951) AS rid_1#3257]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3247: binary
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :- Project [cp_comment#3235 AS cp_comment_0#3245, cp_name#3236 AS cp_name_0#3246, rid#3237 AS rid_0#3247, cp_type#3238 AS cp_type_0#3248, cp_retailprice#3239 AS cp_retailprice_0#3249, cp_mfgr#3240 AS cp_mfgr_0#3250, cp_container#3241 AS cp_container_0#3251, cp_brand#3242 AS cp_brand_0#3252, cp_size#3243 AS cp_size_0#3253, cp_partkey#3244 AS cp_partkey_0#3254]
         :     :  :  :  +- Relation[cp_comment#3235,cp_name#3236,rid#3237,cp_type#3238,cp_retailprice#3239,cp_mfgr#3240,cp_container#3241,cp_brand#3242,cp_size#3243,cp_partkey#3244] JDBCRelation(tpart) [numPartitions=1]
         :     :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3255]
         :     :  :     +- DexRidFilter part~p_brand~Brand#12
         :     :  :        +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3256]
         :     :     +- DexRidFilter part~p_container~SM CASE
         :     :        +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [cl_returnflag#3258 AS cl_returnflag_1#3277, cl_orderkey_and_l_linenumber#3259 AS cl_orderkey_and_l_linenumber_1#3278, cl_comment#3260 AS cl_comment_1#3279, cl_linestatus#3261 AS cl_linestatus_1#3280, rid#3262 AS rid_1#3281, cl_shipmode#3263 AS cl_shipmode_1#3282, cl_shipinstruct#3264 AS cl_shipinstruct_1#3283, cl_quantity#3265 AS cl_quantity_1#3284, cl_receiptdate#3266 AS cl_receiptdate_1#3285, cl_linenumber#3267 AS cl_linenumber_1#3286, cl_tax#3268 AS cl_tax_1#3287, cl_shipdate#3269 AS cl_shipdate_1#3288, cl_extendedprice#3270 AS cl_extendedprice_1#3289, cl_partkey#3271 AS cl_partkey_1#3290, cl_discount#3272 AS cl_discount_1#3291, cl_partkey_and_l_suppkey#3273 AS cl_partkey_and_l_suppkey_1#3292, cl_commitdate#3274 AS cl_commitdate_1#3293, cl_suppkey#3275 AS cl_suppkey_1#3294, cl_orderkey#3276 AS cl_orderkey_1#3295]
            :  :  +- Relation[cl_returnflag#3258,cl_orderkey_and_l_linenumber#3259,cl_comment#3260,cl_linestatus#3261,rid#3262,cl_shipmode#3263,cl_shipinstruct#3264,cl_quantity#3265,cl_receiptdate#3266,cl_linenumber#3267,cl_tax#3268,cl_shipdate#3269,cl_extendedprice#3270,cl_partkey#3271,cl_discount#3272,cl_partkey_and_l_suppkey#3273,cl_commitdate#3274,cl_suppkey#3275,cl_orderkey#3276] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3296]
            :     +- DexRidFilter lineitem~l_shipmode~AIR
            :        +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3297]
               +- DexRidFilter lineitem~l_shipinstruct~DELIVER IN PERSON
                  +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=205
Elapsed time: 196929ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/14 08:58:43 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 08:58:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3332L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 08:58:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#3332L]
+- Project
   +- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- Project [cl_returnflag#3334 AS cl_returnflag_0#3353, cl_orderkey_and_l_linenumber#3335 AS cl_orderkey_and_l_linenumber_0#3354, cl_comment#3336 AS cl_comment_0#3355, cl_linestatus#3337 AS cl_linestatus_0#3356, rid#3338 AS rid_0#3357, cl_shipmode#3339 AS cl_shipmode_0#3358, cl_shipinstruct#3340 AS cl_shipinstruct_0#3359, cl_quantity#3341 AS cl_quantity_0#3360, cl_receiptdate#3342 AS cl_receiptdate_0#3361, cl_linenumber#3343 AS cl_linenumber_0#3362, cl_tax#3344 AS cl_tax_0#3363, cl_shipdate#3345 AS cl_shipdate_0#3364, cl_extendedprice#3346 AS cl_extendedprice_0#3365, cl_partkey#3347 AS cl_partkey_0#3366, cl_discount#3348 AS cl_discount_0#3367, cl_partkey_and_l_suppkey#3349 AS cl_partkey_and_l_suppkey_0#3368, cl_commitdate#3350 AS cl_commitdate_0#3369, cl_suppkey#3351 AS cl_suppkey_0#3370, cl_orderkey#3352 AS cl_orderkey_0#3371]
         +- Relation[cl_returnflag#3334,cl_orderkey_and_l_linenumber#3335,cl_comment#3336,cl_linestatus#3337,rid#3338,cl_shipmode#3339,cl_shipinstruct#3340,cl_quantity#3341,cl_receiptdate#3342,cl_linenumber#3343,cl_tax#3344,cl_shipdate#3345,cl_extendedprice#3346,cl_partkey#3347,cl_discount#3348,cl_partkey_and_l_suppkey#3349,cl_commitdate#3350,cl_suppkey#3351,cl_orderkey#3352] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 7586ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/14 08:58:51 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 08:58:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3400L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 08:58:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3400L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [cc_acctbal#3402 AS cc_acctbal_0#3411, rid#3403 AS rid_0#3412, cc_name#3404 AS cc_name_0#3413, cc_nationkey#3405 AS cc_nationkey_0#3414, cc_custkey#3406 AS cc_custkey_0#3415, cc_comment#3407 AS cc_comment_0#3416, cc_address#3408 AS cc_address_0#3417, cc_mktsegment#3409 AS cc_mktsegment_0#3418, cc_phone#3410 AS cc_phone_0#3419]
         :  :  :  :  +- Relation[cc_acctbal#3402,rid#3403,cc_name#3404,cc_nationkey#3405,cc_custkey#3406,cc_comment#3407,cc_address#3408,cc_mktsegment#3409,cc_phone#3410] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1951) AS rid_1#3430]
         :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#3429]
         :  :  :        :  +- Relation[cc_acctbal#3420,rid#3421,cc_name#3422,cc_nationkey#3423,cc_custkey#3424,cc_comment#3425,cc_address#3426,cc_mktsegment#3427,cc_phone#3428] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :        +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [co_shippriority#3431 AS co_shippriority_1#3441, rid#3432 AS rid_1#3442, co_orderdate#3433 AS co_orderdate_1#3443, co_custkey#3434 AS co_custkey_1#3444, co_orderpriority#3435 AS co_orderpriority_1#3445, co_clerk#3436 AS co_clerk_1#3446, co_orderstatus#3437 AS co_orderstatus_1#3447, co_totalprice#3438 AS co_totalprice_1#3448, co_orderkey#3439 AS co_orderkey_1#3449, co_comment#3440 AS co_comment_1#3450]
         :  :     +- Relation[co_shippriority#3431,rid#3432,co_orderdate#3433,co_custkey#3434,co_orderpriority#3435,co_clerk#3436,co_orderstatus#3437,co_totalprice#3438,co_orderkey#3439,co_comment#3440] JDBCRelation(torders) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1951) AS rid_2#3462]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3461]
         :        :  +- Relation[co_shippriority#3451,rid#3452,co_orderdate#3453,co_custkey#3454,co_orderpriority#3455,co_clerk#3456,co_orderstatus#3457,co_totalprice#3458,co_orderkey#3459,co_comment#3460] JDBCRelation(torders) [numPartitions=1]
         :        +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cl_returnflag#3463 AS cl_returnflag_2#3482, cl_orderkey_and_l_linenumber#3464 AS cl_orderkey_and_l_linenumber_2#3483, cl_comment#3465 AS cl_comment_2#3484, cl_linestatus#3466 AS cl_linestatus_2#3485, rid#3467 AS rid_2#3486, cl_shipmode#3468 AS cl_shipmode_2#3487, cl_shipinstruct#3469 AS cl_shipinstruct_2#3488, cl_quantity#3470 AS cl_quantity_2#3489, cl_receiptdate#3471 AS cl_receiptdate_2#3490, cl_linenumber#3472 AS cl_linenumber_2#3491, cl_tax#3473 AS cl_tax_2#3492, cl_shipdate#3474 AS cl_shipdate_2#3493, cl_extendedprice#3475 AS cl_extendedprice_2#3494, cl_partkey#3476 AS cl_partkey_2#3495, cl_discount#3477 AS cl_discount_2#3496, cl_partkey_and_l_suppkey#3478 AS cl_partkey_and_l_suppkey_2#3497, cl_commitdate#3479 AS cl_commitdate_2#3498, cl_suppkey#3480 AS cl_suppkey_2#3499, cl_orderkey#3481 AS cl_orderkey_2#3500]
            +- Relation[cl_returnflag#3463,cl_orderkey_and_l_linenumber#3464,cl_comment#3465,cl_linestatus#3466,rid#3467,cl_shipmode#3468,cl_shipinstruct#3469,cl_quantity#3470,cl_receiptdate#3471,cl_linenumber#3472,cl_tax#3473,cl_shipdate#3474,cl_extendedprice#3475,cl_partkey#3476,cl_discount#3477,cl_partkey_and_l_suppkey#3478,cl_commitdate#3479,cl_suppkey#3480,cl_orderkey#3481] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 1930259ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/14 09:31:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 09:31:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3548L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 09:31:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 09:31:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 09:31:01 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 09:31:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 09:31:01 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 09:31:01 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 09:31:01 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 09:31:01 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 09:31:01 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 09:31:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3548L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :  :  :  :  :- Project [rid#3550 AS rid_0#3555, cn_regionkey#3551 AS cn_regionkey_0#3556, cn_nationkey#3552 AS cn_nationkey_0#3557, cn_name#3553 AS cn_name_0#3558, cn_comment#3554 AS cn_comment_0#3559]
         :  :  :  :  :  :  :  :  :  :  +- Relation[rid#3550,cn_regionkey#3551,cn_nationkey#3552,cn_name#3553,cn_comment#3554] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1951) AS rid_1#3566]
         :  :  :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_0
         :  :  :  :  :  :  :  :  :        :- 'Project ['rid AS rid_0#3565]
         :  :  :  :  :  :  :  :  :        :  +- Relation[rid#3560,cn_regionkey#3561,cn_nationkey#3562,cn_name#3563,cn_comment#3564] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  :  :  :  :  :        +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  :  :  +- Project [cs_phone#3567 AS cs_phone_1#3575, rid#3568 AS rid_1#3576, cs_address#3569 AS cs_address_1#3577, cs_nationkey#3570 AS cs_nationkey_1#3578, cs_suppkey#3571 AS cs_suppkey_1#3579, cs_name#3572 AS cs_name_1#3580, cs_acctbal#3573 AS cs_acctbal_1#3581, cs_comment#3574 AS cs_comment_1#3582]
         :  :  :  :  :  :  :  :     +- Relation[cs_phone#3567,rid#3568,cs_address#3569,cs_nationkey#3570,cs_suppkey#3571,cs_name#3572,cs_acctbal#3573,cs_comment#3574] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :  :  :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1951) AS rid_2#3592]
         :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_1
         :  :  :  :  :  :  :        :- 'Project ['rid AS rid_1#3591]
         :  :  :  :  :  :  :        :  +- Relation[cs_phone#3583,rid#3584,cs_address#3585,cs_nationkey#3586,cs_suppkey#3587,cs_name#3588,cs_acctbal#3589,cs_comment#3590] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :  :  :  :  :        +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  +- Project [cl_returnflag#3593 AS cl_returnflag_2#3612, cl_orderkey_and_l_linenumber#3594 AS cl_orderkey_and_l_linenumber_2#3613, cl_comment#3595 AS cl_comment_2#3614, cl_linestatus#3596 AS cl_linestatus_2#3615, rid#3597 AS rid_2#3616, cl_shipmode#3598 AS cl_shipmode_2#3617, cl_shipinstruct#3599 AS cl_shipinstruct_2#3618, cl_quantity#3600 AS cl_quantity_2#3619, cl_receiptdate#3601 AS cl_receiptdate_2#3620, cl_linenumber#3602 AS cl_linenumber_2#3621, cl_tax#3603 AS cl_tax_2#3622, cl_shipdate#3604 AS cl_shipdate_2#3623, cl_extendedprice#3605 AS cl_extendedprice_2#3624, cl_partkey#3606 AS cl_partkey_2#3625, cl_discount#3607 AS cl_discount_2#3626, cl_partkey_and_l_suppkey#3608 AS cl_partkey_and_l_suppkey_2#3627, cl_commitdate#3609 AS cl_commitdate_2#3628, cl_suppkey#3610 AS cl_suppkey_2#3629, cl_orderkey#3611 AS cl_orderkey_2#3630]
         :  :  :  :  :  :     +- Relation[cl_returnflag#3593,cl_orderkey_and_l_linenumber#3594,cl_comment#3595,cl_linestatus#3596,rid#3597,cl_shipmode#3598,cl_shipinstruct#3599,cl_quantity#3600,cl_receiptdate#3601,cl_linenumber#3602,cl_tax#3603,cl_shipdate#3604,cl_extendedprice#3605,cl_partkey#3606,cl_discount#3607,cl_partkey_and_l_suppkey#3608,cl_commitdate#3609,cl_suppkey#3610,cl_orderkey#3611] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1951) AS rid_3#3651]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_2
         :  :  :  :  :        :- 'Project ['rid AS rid_2#3650]
         :  :  :  :  :        :  +- Relation[cl_returnflag#3631,cl_orderkey_and_l_linenumber#3632,cl_comment#3633,cl_linestatus#3634,rid#3635,cl_shipmode#3636,cl_shipinstruct#3637,cl_quantity#3638,cl_receiptdate#3639,cl_linenumber#3640,cl_tax#3641,cl_shipdate#3642,cl_extendedprice#3643,cl_partkey#3644,cl_discount#3645,cl_partkey_and_l_suppkey#3646,cl_commitdate#3647,cl_suppkey#3648,cl_orderkey#3649] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [cp_comment#3652 AS cp_comment_3#3662, cp_name#3653 AS cp_name_3#3663, rid#3654 AS rid_3#3664, cp_type#3655 AS cp_type_3#3665, cp_retailprice#3656 AS cp_retailprice_3#3666, cp_mfgr#3657 AS cp_mfgr_3#3667, cp_container#3658 AS cp_container_3#3668, cp_brand#3659 AS cp_brand_3#3669, cp_size#3660 AS cp_size_3#3670, cp_partkey#3661 AS cp_partkey_3#3671]
         :  :  :  :     +- Relation[cp_comment#3652,cp_name#3653,rid#3654,cp_type#3655,cp_retailprice#3656,cp_mfgr#3657,cp_container#3658,cp_brand#3659,cp_size#3660,cp_partkey#3661] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1951) AS rid_4#3692]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey_and_l_suppkey~partsupp~ps_partkey_and_ps_suppkey, 'rid_2
         :  :  :        :- 'Project ['rid AS rid_2#3691]
         :  :  :        :  +- Relation[cl_returnflag#3672,cl_orderkey_and_l_linenumber#3673,cl_comment#3674,cl_linestatus#3675,rid#3676,cl_shipmode#3677,cl_shipinstruct#3678,cl_quantity#3679,cl_receiptdate#3680,cl_linenumber#3681,cl_tax#3682,cl_shipdate#3683,cl_extendedprice#3684,cl_partkey#3685,cl_discount#3686,cl_partkey_and_l_suppkey#3687,cl_commitdate#3688,cl_suppkey#3689,cl_orderkey#3690] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :        +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [cps_partkey_and_ps_suppkey#3693 AS cps_partkey_and_ps_suppkey_4#3700, rid#3694 AS rid_4#3701, cps_availqty#3695 AS cps_availqty_4#3702, cps_comment#3696 AS cps_comment_4#3703, cps_partkey#3697 AS cps_partkey_4#3704, cps_supplycost#3698 AS cps_supplycost_4#3705, cps_suppkey#3699 AS cps_suppkey_4#3706]
         :  :     +- Relation[cps_partkey_and_ps_suppkey#3693,rid#3694,cps_availqty#3695,cps_comment#3696,cps_partkey#3697,cps_supplycost#3698,cps_suppkey#3699] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1951) AS rid_5#3727]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#3726]
         :        :  +- Relation[cl_returnflag#3707,cl_orderkey_and_l_linenumber#3708,cl_comment#3709,cl_linestatus#3710,rid#3711,cl_shipmode#3712,cl_shipinstruct#3713,cl_quantity#3714,cl_receiptdate#3715,cl_linenumber#3716,cl_tax#3717,cl_shipdate#3718,cl_extendedprice#3719,cl_partkey#3720,cl_discount#3721,cl_partkey_and_l_suppkey#3722,cl_commitdate#3723,cl_suppkey#3724,cl_orderkey#3725] JDBCRelation(tlineitem) [numPartitions=1]
         :        +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [co_shippriority#3728 AS co_shippriority_5#3738, rid#3729 AS rid_5#3739, co_orderdate#3730 AS co_orderdate_5#3740, co_custkey#3731 AS co_custkey_5#3741, co_orderpriority#3732 AS co_orderpriority_5#3742, co_clerk#3733 AS co_clerk_5#3743, co_orderstatus#3734 AS co_orderstatus_5#3744, co_totalprice#3735 AS co_totalprice_5#3745, co_orderkey#3736 AS co_orderkey_5#3746, co_comment#3737 AS co_comment_5#3747]
            +- Relation[co_shippriority#3728,rid#3729,co_orderdate#3730,co_custkey#3731,co_orderpriority#3732,co_clerk#3733,co_orderstatus#3734,co_totalprice#3735,co_orderkey#3736,co_comment#3737] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 804107ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/14 09:44:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 09:44:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3835L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 09:44:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3835L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [cl_returnflag#3837 AS cl_returnflag_0#3856, cl_orderkey_and_l_linenumber#3838 AS cl_orderkey_and_l_linenumber_0#3857, cl_comment#3839 AS cl_comment_0#3858, cl_linestatus#3840 AS cl_linestatus_0#3859, rid#3841 AS rid_0#3860, cl_shipmode#3842 AS cl_shipmode_0#3861, cl_shipinstruct#3843 AS cl_shipinstruct_0#3862, cl_quantity#3844 AS cl_quantity_0#3863, cl_receiptdate#3845 AS cl_receiptdate_0#3864, cl_linenumber#3846 AS cl_linenumber_0#3865, cl_tax#3847 AS cl_tax_0#3866, cl_shipdate#3848 AS cl_shipdate_0#3867, cl_extendedprice#3849 AS cl_extendedprice_0#3868, cl_partkey#3850 AS cl_partkey_0#3869, cl_discount#3851 AS cl_discount_0#3870, cl_partkey_and_l_suppkey#3852 AS cl_partkey_and_l_suppkey_0#3871, cl_commitdate#3853 AS cl_commitdate_0#3872, cl_suppkey#3854 AS cl_suppkey_0#3873, cl_orderkey#3855 AS cl_orderkey_0#3874]
         :  :  +- Relation[cl_returnflag#3837,cl_orderkey_and_l_linenumber#3838,cl_comment#3839,cl_linestatus#3840,rid#3841,cl_shipmode#3842,cl_shipinstruct#3843,cl_quantity#3844,cl_receiptdate#3845,cl_linenumber#3846,cl_tax#3847,cl_shipdate#3848,cl_extendedprice#3849,cl_partkey#3850,cl_discount#3851,cl_partkey_and_l_suppkey#3852,cl_commitdate#3853,cl_suppkey#3854,cl_orderkey#3855] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1951) AS rid_1#3895]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3894]
         :        :  +- Relation[cl_returnflag#3875,cl_orderkey_and_l_linenumber#3876,cl_comment#3877,cl_linestatus#3878,rid#3879,cl_shipmode#3880,cl_shipinstruct#3881,cl_quantity#3882,cl_receiptdate#3883,cl_linenumber#3884,cl_tax#3885,cl_shipdate#3886,cl_extendedprice#3887,cl_partkey#3888,cl_discount#3889,cl_partkey_and_l_suppkey#3890,cl_commitdate#3891,cl_suppkey#3892,cl_orderkey#3893] JDBCRelation(tlineitem) [numPartitions=1]
         :        +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [co_shippriority#3896 AS co_shippriority_1#3906, rid#3897 AS rid_1#3907, co_orderdate#3898 AS co_orderdate_1#3908, co_custkey#3899 AS co_custkey_1#3909, co_orderpriority#3900 AS co_orderpriority_1#3910, co_clerk#3901 AS co_clerk_1#3911, co_orderstatus#3902 AS co_orderstatus_1#3912, co_totalprice#3903 AS co_totalprice_1#3913, co_orderkey#3904 AS co_orderkey_1#3914, co_comment#3905 AS co_comment_1#3915]
            +- Relation[co_shippriority#3896,rid#3897,co_orderdate#3898,co_custkey#3899,co_orderpriority#3900,co_clerk#3901,co_orderstatus#3902,co_totalprice#3903,co_orderkey#3904,co_comment#3905] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 210088ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/14 09:47:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 09:47:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3952L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#810L = c_nationkey#293L)
               :     :- Project [n_nationkey#810L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#812L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#810L, n_regionkey#812L]
               :     :        +- Relation[n_nationkey#810L,n_name#811,n_regionkey#812L,n_comment#813] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 09:47:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 09:47:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 09:47:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 09:47:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 09:47:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 09:47:55 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 09:47:55 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 09:47:55 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 09:47:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 09:47:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 09:47:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 09:47:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3952L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, 'rid_1, 'cl_returnflag_1, 'cl_orderkey_and_l_linenumber_1, 'cl_comment_1, 'cl_linestatus_1, 'cl_shipmode_1, 'cl_shipinstruct_1, 'cl_quantity_1, 'cl_receiptdate_1, 'cl_linenumber_1, 'cl_tax_1, 'cl_shipdate_1, 'cl_extendedprice_1, 'cl_partkey_1, ... 19 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, 'rid_1, 'cl_returnflag_1, 'cl_orderkey_and_l_linenumber_1, 'cl_comment_1, 'cl_linestatus_1, 'cl_shipmode_1, 'cl_shipinstruct_1, 'cl_quantity_1, 'cl_receiptdate_1, 'cl_linenumber_1, 'cl_tax_1, 'cl_shipdate_1, 'cl_extendedprice_1, 'cl_partkey_1, ... 14 more fields]
         :     :  :  +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_2
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, 'rid_1, 'cl_returnflag_1, 'cl_orderkey_and_l_linenumber_1, 'cl_comment_1, 'cl_linestatus_1, 'cl_shipmode_1, 'cl_shipinstruct_1, 'cl_quantity_1, 'cl_receiptdate_1, 'cl_linenumber_1, 'cl_tax_1, 'cl_shipdate_1, 'cl_extendedprice_1, 'cl_partkey_1, ... 6 more fields]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :  :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :     :  :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, dexdecrypt('value_dec_key, value#1951) AS rid_1#3975]
         :     :  :     :  :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3966: binary
         :     :  :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :     :  :- Project [cp_comment#3954 AS cp_comment_0#3964, cp_name#3955 AS cp_name_0#3965, rid#3956 AS rid_0#3966, cp_type#3957 AS cp_type_0#3967, cp_retailprice#3958 AS cp_retailprice_0#3968, cp_mfgr#3959 AS cp_mfgr_0#3969, cp_container#3960 AS cp_container_0#3970, cp_brand#3961 AS cp_brand_0#3971, cp_size#3962 AS cp_size_0#3972, cp_partkey#3963 AS cp_partkey_0#3973]
         :     :  :     :  :     :  :     :  :  +- Relation[cp_comment#3954,cp_name#3955,rid#3956,cp_type#3957,cp_retailprice#3958,cp_mfgr#3959,cp_container#3960,cp_brand#3961,cp_size#3962,cp_partkey#3963] JDBCRelation(tpart) [numPartitions=1]
         :     :  :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3974]
         :     :  :     :  :     :  :     :     +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
         :     :  :     :  :     :  :     :        +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     :  :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  :     :  +- Project [cl_returnflag#3976 AS cl_returnflag_1#3995, cl_orderkey_and_l_linenumber#3977 AS cl_orderkey_and_l_linenumber_1#3996, cl_comment#3978 AS cl_comment_1#3997, cl_linestatus#3979 AS cl_linestatus_1#3998, rid#3980 AS rid_1#3999, cl_shipmode#3981 AS cl_shipmode_1#4000, cl_shipinstruct#3982 AS cl_shipinstruct_1#4001, cl_quantity#3983 AS cl_quantity_1#4002, cl_receiptdate#3984 AS cl_receiptdate_1#4003, cl_linenumber#3985 AS cl_linenumber_1#4004, cl_tax#3986 AS cl_tax_1#4005, cl_shipdate#3987 AS cl_shipdate_1#4006, cl_extendedprice#3988 AS cl_extendedprice_1#4007, cl_partkey#3989 AS cl_partkey_1#4008, cl_discount#3990 AS cl_discount_1#4009, cl_partkey_and_l_suppkey#3991 AS cl_partkey_and_l_suppkey_1#4010, cl_commitdate#3992 AS cl_commitdate_1#4011, cl_suppkey#3993 AS cl_suppkey_1#4012, cl_orderkey#3994 AS cl_orderkey_1#4013]
         :     :  :     :  :     :     +- Relation[cl_returnflag#3976,cl_orderkey_and_l_linenumber#3977,cl_comment#3978,cl_linestatus#3979,rid#3980,cl_shipmode#3981,cl_shipinstruct#3982,cl_quantity#3983,cl_receiptdate#3984,cl_linenumber#3985,cl_tax#3986,cl_shipdate#3987,cl_extendedprice#3988,cl_partkey#3989,cl_discount#3990,cl_partkey_and_l_suppkey#3991,cl_commitdate#3992,cl_suppkey#3993,cl_orderkey#3994] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [cs_phone#4015 AS cs_phone_2#4023, rid#4016 AS rid_2#4024, cs_address#4017 AS cs_address_2#4025, cs_nationkey#4018 AS cs_nationkey_2#4026, cs_suppkey#4019 AS cs_suppkey_2#4027, cs_name#4020 AS cs_name_2#4028, cs_acctbal#4021 AS cs_acctbal_2#4029, cs_comment#4022 AS cs_comment_2#4030]
         :     :  :     :     +- Relation[cs_phone#4015,rid#4016,cs_address#4017,cs_nationkey#4018,cs_suppkey#4019,cs_name#4020,cs_acctbal#4021,cs_comment#4022] JDBCRelation(tsupplier) [numPartitions=1]
         :     :  :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [rid#4032 AS rid_3#4037, cn_regionkey#4033 AS cn_regionkey_3#4038, cn_nationkey#4034 AS cn_nationkey_3#4039, cn_name#4035 AS cn_name_3#4040, cn_comment#4036 AS cn_comment_3#4041]
         :     :     +- Relation[rid#4032,cn_regionkey#4033,cn_nationkey#4034,cn_name#4035,cn_comment#4036] JDBCRelation(tnation) [numPartitions=1]
         :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['cr_regionkey_4, 'cr_name_4, 'cr_comment_4, 'rid_4, 'rid_5, 'cn_regionkey_5, 'cn_nationkey_5, 'cn_name_5, 'cn_comment_5, 'rid_6, 'cc_acctbal_6, 'cc_name_6, 'cc_nationkey_6, 'cc_custkey_6, 'cc_comment_6, 'cc_address_6, 'cc_mktsegment_6, 'cc_phone_6, dexdecrypt('value_dec_key, value#1951) AS rid_7#4082]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_6
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['cr_regionkey_4, 'cr_name_4, 'cr_comment_4, 'rid_4, 'rid_5, 'cn_regionkey_5, 'cn_nationkey_5, 'cn_name_5, 'cn_comment_5, dexdecrypt('value_dec_key, value#1951) AS rid_6#4063]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_5
            :     :  :     :- 'Join NaturalJoin(Inner)
            :     :  :     :  :- 'Project ['cr_regionkey_4, 'cr_name_4, 'cr_comment_4, 'rid_4, dexdecrypt('value_dec_key, value#1951) AS rid_5#4052]
            :     :  :     :  :  +- 'DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_4#4050: binary
            :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_4))
            :     :  :     :  :     :  :- Project [cr_regionkey#4043 AS cr_regionkey_4#4047, cr_name#4044 AS cr_name_4#4048, cr_comment#4045 AS cr_comment_4#4049, rid#4046 AS rid_4#4050]
            :     :  :     :  :     :  :  +- Relation[cr_regionkey#4043,cr_name#4044,cr_comment#4045,rid#4046] JDBCRelation(tregion) [numPartitions=1]
            :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_4#4051]
            :     :  :     :  :     :     +- DexRidFilter region~r_name~AMERICA
            :     :  :     :  :     :        +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     :  :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  :     :  +- Project [rid#4053 AS rid_5#4058, cn_regionkey#4054 AS cn_regionkey_5#4059, cn_nationkey#4055 AS cn_nationkey_5#4060, cn_name#4056 AS cn_name_5#4061, cn_comment#4057 AS cn_comment_5#4062]
            :     :  :     :     +- Relation[rid#4053,cn_regionkey#4054,cn_nationkey#4055,cn_name#4056,cn_comment#4057] JDBCRelation(tnation) [numPartitions=1]
            :     :  :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [cc_acctbal#4064 AS cc_acctbal_6#4073, rid#4065 AS rid_6#4074, cc_name#4066 AS cc_name_6#4075, cc_nationkey#4067 AS cc_nationkey_6#4076, cc_custkey#4068 AS cc_custkey_6#4077, cc_comment#4069 AS cc_comment_6#4078, cc_address#4070 AS cc_address_6#4079, cc_mktsegment#4071 AS cc_mktsegment_6#4080, cc_phone#4072 AS cc_phone_6#4081]
            :     :     +- Relation[cc_acctbal#4064,rid#4065,cc_name#4066,cc_nationkey#4067,cc_custkey#4068,cc_comment#4069,cc_address#4070,cc_mktsegment#4071,cc_phone#4072] JDBCRelation(tcustomer) [numPartitions=1]
            :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [co_shippriority#4083 AS co_shippriority_7#4093, rid#4084 AS rid_7#4094, co_orderdate#4085 AS co_orderdate_7#4095, co_custkey#4086 AS co_custkey_7#4096, co_orderpriority#4087 AS co_orderpriority_7#4097, co_clerk#4088 AS co_clerk_7#4098, co_orderstatus#4089 AS co_orderstatus_7#4099, co_totalprice#4090 AS co_totalprice_7#4100, co_orderkey#4091 AS co_orderkey_7#4101, co_comment#4092 AS co_comment_7#4102]
               +- Relation[co_shippriority#4083,rid#4084,co_orderdate#4085,co_custkey#4086,co_orderpriority#4087,co_clerk#4088,co_orderstatus#4089,co_totalprice#4090,co_orderkey#4091,co_comment#4092] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=8716
Elapsed time: 29190ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/14 09:48:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 09:48:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4180L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/14 09:48:25 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 09:48:25 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 09:48:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4180L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, dexdecrypt('value_dec_key, value#1951) AS rid_1#4203]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4194: binary
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [cp_comment#4182 AS cp_comment_0#4192, cp_name#4183 AS cp_name_0#4193, rid#4184 AS rid_0#4194, cp_type#4185 AS cp_type_0#4195, cp_retailprice#4186 AS cp_retailprice_0#4196, cp_mfgr#4187 AS cp_mfgr_0#4197, cp_container#4188 AS cp_container_0#4198, cp_brand#4189 AS cp_brand_0#4199, cp_size#4190 AS cp_size_0#4200, cp_partkey#4191 AS cp_partkey_0#4201]
         :     :  :  +- Relation[cp_comment#4182,cp_name#4183,rid#4184,cp_type#4185,cp_retailprice#4186,cp_mfgr#4187,cp_container#4188,cp_brand#4189,cp_size#4190,cp_partkey#4191] JDBCRelation(tpart) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4202]
         :     :     +- DexRidFilter part~p_size~49
         :     :        +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cps_partkey_and_ps_suppkey#4204 AS cps_partkey_and_ps_suppkey_1#4211, rid#4205 AS rid_1#4212, cps_availqty#4206 AS cps_availqty_1#4213, cps_comment#4207 AS cps_comment_1#4214, cps_partkey#4208 AS cps_partkey_1#4215, cps_supplycost#4209 AS cps_supplycost_1#4216, cps_suppkey#4210 AS cps_suppkey_1#4217]
            +- Relation[cps_partkey_and_ps_suppkey#4204,rid#4205,cps_availqty#4206,cps_comment#4207,cps_partkey#4208,cps_supplycost#4209,cps_suppkey#4210] JDBCRelation(tpartsupp) [numPartitions=1]

DexCorr$ result size=15780
Elapsed time: 3985ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/14 09:48:29 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 09:48:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4239L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/14 09:48:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4239L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(RightOuter)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [co_shippriority#4241 AS co_shippriority_0#4251, rid#4242 AS rid_0#4252, co_orderdate#4243 AS co_orderdate_0#4253, co_custkey#4244 AS co_custkey_0#4254, co_orderpriority#4245 AS co_orderpriority_0#4255, co_clerk#4246 AS co_clerk_0#4256, co_orderstatus#4247 AS co_orderstatus_0#4257, co_totalprice#4248 AS co_totalprice_0#4258, co_orderkey#4249 AS co_orderkey_0#4259, co_comment#4250 AS co_comment_0#4260]
         :  :  +- Relation[co_shippriority#4241,rid#4242,co_orderdate#4243,co_custkey#4244,co_orderpriority#4245,co_clerk#4246,co_orderstatus#4247,co_totalprice#4248,co_orderkey#4249,co_comment#4250] JDBCRelation(torders) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1951) AS rid_1#4272]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4271]
         :        :  +- Relation[co_shippriority#4261,rid#4262,co_orderdate#4263,co_custkey#4264,co_orderpriority#4265,co_clerk#4266,co_orderstatus#4267,co_totalprice#4268,co_orderkey#4269,co_comment#4270] JDBCRelation(torders) [numPartitions=1]
         :        +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cc_acctbal#4273 AS cc_acctbal_1#4282, rid#4274 AS rid_1#4283, cc_name#4275 AS cc_name_1#4284, cc_nationkey#4276 AS cc_nationkey_1#4285, cc_custkey#4277 AS cc_custkey_1#4286, cc_comment#4278 AS cc_comment_1#4287, cc_address#4279 AS cc_address_1#4288, cc_mktsegment#4280 AS cc_mktsegment_1#4289, cc_phone#4281 AS cc_phone_1#4290]
            +- Relation[cc_acctbal#4273,rid#4274,cc_name#4275,cc_nationkey#4276,cc_custkey#4277,cc_comment#4278,cc_address#4279,cc_mktsegment#4280,cc_phone#4281] JDBCRelation(tcustomer) [numPartitions=1]

DexCorr$ result size=1550004
Elapsed time: 83650ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/14 09:49:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 09:49:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4314L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/14 09:49:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 09:49:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 09:49:52 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 09:49:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 09:49:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 09:49:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 09:49:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 09:49:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 09:49:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 09:49:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 09:49:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 09:49:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 09:49:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4314L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cr_regionkey_0, 'cr_name_0, 'cr_comment_0, 'rid_0, 'rid_1, 'cn_regionkey_1, 'cn_nationkey_1, 'cn_name_1, 'cn_comment_1, 'rid_2, 'cs_phone_2, 'cs_address_2, 'cs_nationkey_2, 'cs_suppkey_2, 'cs_name_2, 'cs_acctbal_2, 'cs_comment_2, dexdecrypt('value_dec_key, value#1951) AS rid_4#4353]
         :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['cr_regionkey_0, 'cr_name_0, 'cr_comment_0, 'rid_0, 'rid_1, 'cn_regionkey_1, 'cn_nationkey_1, 'cn_name_1, 'cn_comment_1, dexdecrypt('value_dec_key, value#1951) AS rid_2#4336]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['cr_regionkey_0, 'cr_name_0, 'cr_comment_0, 'rid_0, dexdecrypt('value_dec_key, value#1951) AS rid_1#4325]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#4323: binary
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [cr_regionkey#4316 AS cr_regionkey_0#4320, cr_name#4317 AS cr_name_0#4321, cr_comment#4318 AS cr_comment_0#4322, rid#4319 AS rid_0#4323]
         :     :  :     :  :     :  :  +- Relation[cr_regionkey#4316,cr_name#4317,cr_comment#4318,rid#4319] JDBCRelation(tregion) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4324]
         :     :  :     :  :     :     +- DexRidFilter region~r_name~EUROPE
         :     :  :     :  :     :        +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [rid#4326 AS rid_1#4331, cn_regionkey#4327 AS cn_regionkey_1#4332, cn_nationkey#4328 AS cn_nationkey_1#4333, cn_name#4329 AS cn_name_1#4334, cn_comment#4330 AS cn_comment_1#4335]
         :     :  :     :     +- Relation[rid#4326,cn_regionkey#4327,cn_nationkey#4328,cn_name#4329,cn_comment#4330] JDBCRelation(tnation) [numPartitions=1]
         :     :  :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [cs_phone#4337 AS cs_phone_2#4345, rid#4338 AS rid_2#4346, cs_address#4339 AS cs_address_2#4347, cs_nationkey#4340 AS cs_nationkey_2#4348, cs_suppkey#4341 AS cs_suppkey_2#4349, cs_name#4342 AS cs_name_2#4350, cs_acctbal#4343 AS cs_acctbal_2#4351, cs_comment#4344 AS cs_comment_2#4352]
         :     :     +- Relation[cs_phone#4337,rid#4338,cs_address#4339,cs_nationkey#4340,cs_suppkey#4341,cs_name#4342,cs_acctbal#4343,cs_comment#4344] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['cp_comment_3, 'cp_name_3, 'rid_3, 'cp_type_3, 'cp_retailprice_3, 'cp_mfgr_3, 'cp_container_3, 'cp_brand_3, 'cp_size_3, 'cp_partkey_3, dexdecrypt('value_dec_key, value#1951) AS rid_4#4375]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_3#4366: binary
            :     :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :     :  :- Project [cp_comment#4354 AS cp_comment_3#4364, cp_name#4355 AS cp_name_3#4365, rid#4356 AS rid_3#4366, cp_type#4357 AS cp_type_3#4367, cp_retailprice#4358 AS cp_retailprice_3#4368, cp_mfgr#4359 AS cp_mfgr_3#4369, cp_container#4360 AS cp_container_3#4370, cp_brand#4361 AS cp_brand_3#4371, cp_size#4362 AS cp_size_3#4372, cp_partkey#4363 AS cp_partkey_3#4373]
            :     :  :  +- Relation[cp_comment#4354,cp_name#4355,rid#4356,cp_type#4357,cp_retailprice#4358,cp_mfgr#4359,cp_container#4360,cp_brand#4361,cp_size#4362,cp_partkey#4363] JDBCRelation(tpart) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#4374]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [cps_partkey_and_ps_suppkey#4376 AS cps_partkey_and_ps_suppkey_4#4383, rid#4377 AS rid_4#4384, cps_availqty#4378 AS cps_availqty_4#4385, cps_comment#4379 AS cps_comment_4#4386, cps_partkey#4380 AS cps_partkey_4#4387, cps_supplycost#4381 AS cps_supplycost_4#4388, cps_suppkey#4382 AS cps_suppkey_4#4389]
               +- Relation[cps_partkey_and_ps_suppkey#4376,rid#4377,cps_availqty#4378,cps_comment#4379,cps_partkey#4380,cps_supplycost#4381,cps_suppkey#4382] JDBCRelation(tpartsupp) [numPartitions=1]

DexCorr$ result size=3162
Elapsed time: 6729ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/14 09:49:59 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 09:49:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4428L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 09:49:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 09:49:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 09:49:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 09:49:59 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 09:49:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4428L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, dexdecrypt('value_dec_key, value#1951) AS rid_1#4452]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#4442: binary
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :- Project [cp_comment#4430 AS cp_comment_0#4440, cp_name#4431 AS cp_name_0#4441, rid#4432 AS rid_0#4442, cp_type#4433 AS cp_type_0#4443, cp_retailprice#4434 AS cp_retailprice_0#4444, cp_mfgr#4435 AS cp_mfgr_0#4445, cp_container#4436 AS cp_container_0#4446, cp_brand#4437 AS cp_brand_0#4447, cp_size#4438 AS cp_size_0#4448, cp_partkey#4439 AS cp_partkey_0#4449]
         :     :  :  :  +- Relation[cp_comment#4430,cp_name#4431,rid#4432,cp_type#4433,cp_retailprice#4434,cp_mfgr#4435,cp_container#4436,cp_brand#4437,cp_size#4438,cp_partkey#4439] JDBCRelation(tpart) [numPartitions=1]
         :     :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4450]
         :     :  :     +- DexRidFilter part~p_brand~Brand#23
         :     :  :        +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4451]
         :     :     +- DexRidFilter part~p_container~MED BOX
         :     :        +- Relation[label#1947,value#1948] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cl_returnflag#4453 AS cl_returnflag_1#4472, cl_orderkey_and_l_linenumber#4454 AS cl_orderkey_and_l_linenumber_1#4473, cl_comment#4455 AS cl_comment_1#4474, cl_linestatus#4456 AS cl_linestatus_1#4475, rid#4457 AS rid_1#4476, cl_shipmode#4458 AS cl_shipmode_1#4477, cl_shipinstruct#4459 AS cl_shipinstruct_1#4478, cl_quantity#4460 AS cl_quantity_1#4479, cl_receiptdate#4461 AS cl_receiptdate_1#4480, cl_linenumber#4462 AS cl_linenumber_1#4481, cl_tax#4463 AS cl_tax_1#4482, cl_shipdate#4464 AS cl_shipdate_1#4483, cl_extendedprice#4465 AS cl_extendedprice_1#4484, cl_partkey#4466 AS cl_partkey_1#4485, cl_discount#4467 AS cl_discount_1#4486, cl_partkey_and_l_suppkey#4468 AS cl_partkey_and_l_suppkey_1#4487, cl_commitdate#4469 AS cl_commitdate_1#4488, cl_suppkey#4470 AS cl_suppkey_1#4489, cl_orderkey#4471 AS cl_orderkey_1#4490]
            +- Relation[cl_returnflag#4453,cl_orderkey_and_l_linenumber#4454,cl_comment#4455,cl_linestatus#4456,rid#4457,cl_shipmode#4458,cl_shipinstruct#4459,cl_quantity#4460,cl_receiptdate#4461,cl_linenumber#4462,cl_tax#4463,cl_shipdate#4464,cl_extendedprice#4465,cl_partkey#4466,cl_discount#4467,cl_partkey_and_l_suppkey#4468,cl_commitdate#4469,cl_suppkey#4470,cl_orderkey#4471] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6088
Elapsed time: 2380ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/14 09:50:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 09:50:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4527L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 09:50:01 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 09:50:01 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 09:50:01 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 09:50:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4527L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [cs_phone#4529 AS cs_phone_0#4537, rid#4530 AS rid_0#4538, cs_address#4531 AS cs_address_0#4539, cs_nationkey#4532 AS cs_nationkey_0#4540, cs_suppkey#4533 AS cs_suppkey_0#4541, cs_name#4534 AS cs_name_0#4542, cs_acctbal#4535 AS cs_acctbal_0#4543, cs_comment#4536 AS cs_comment_0#4544]
         :  :  +- Relation[cs_phone#4529,rid#4530,cs_address#4531,cs_nationkey#4532,cs_suppkey#4533,cs_name#4534,cs_acctbal#4535,cs_comment#4536] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1951) AS rid_1#4554]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4553]
         :        :  +- Relation[cs_phone#4545,rid#4546,cs_address#4547,cs_nationkey#4548,cs_suppkey#4549,cs_name#4550,cs_acctbal#4551,cs_comment#4552] JDBCRelation(tsupplier) [numPartitions=1]
         :        +- Relation[label#1950,value#1951] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cl_returnflag#4555 AS cl_returnflag_1#4574, cl_orderkey_and_l_linenumber#4556 AS cl_orderkey_and_l_linenumber_1#4575, cl_comment#4557 AS cl_comment_1#4576, cl_linestatus#4558 AS cl_linestatus_1#4577, rid#4559 AS rid_1#4578, cl_shipmode#4560 AS cl_shipmode_1#4579, cl_shipinstruct#4561 AS cl_shipinstruct_1#4580, cl_quantity#4562 AS cl_quantity_1#4581, cl_receiptdate#4563 AS cl_receiptdate_1#4582, cl_linenumber#4564 AS cl_linenumber_1#4583, cl_tax#4565 AS cl_tax_1#4584, cl_shipdate#4566 AS cl_shipdate_1#4585, cl_extendedprice#4567 AS cl_extendedprice_1#4586, cl_partkey#4568 AS cl_partkey_1#4587, cl_discount#4569 AS cl_discount_1#4588, cl_partkey_and_l_suppkey#4570 AS cl_partkey_and_l_suppkey_1#4589, cl_commitdate#4571 AS cl_commitdate_1#4590, cl_suppkey#4572 AS cl_suppkey_1#4591, cl_orderkey#4573 AS cl_orderkey_1#4592]
            +- Relation[cl_returnflag#4555,cl_orderkey_and_l_linenumber#4556,cl_comment#4557,cl_linestatus#4558,rid#4559,cl_shipmode#4560,cl_shipinstruct#4561,cl_quantity#4562,cl_receiptdate#4563,cl_linenumber#4564,cl_tax#4565,cl_shipdate#4566,cl_extendedprice#4567,cl_partkey#4568,cl_discount#4569,cl_partkey_and_l_suppkey#4570,cl_commitdate#4571,cl_suppkey#4572,cl_orderkey#4573] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 158512ms
query=q1, count=6001215, duration=7586
query=q10, count=1478870, duration=439676
query=q11, count=31680, duration=6189
query=q12, count=857401, duration=63704
query=q13, count=1550004, duration=83650
query=q14, count=6001215, duration=225138
query=q15, count=6001215, duration=158512
query=q16, count=15780, duration=3985
query=q17, count=6088, duration=2380
query=q18, count=6001215, duration=1930259
query=q19, count=205, duration=196929
query=q2, count=3162, duration=6729
query=q20, count=324, duration=6816
query=q21a, count=119924, duration=782041
query=q3, count=1214743, duration=108080
query=q4, count=6001215, duration=210088
query=q6, count=6001215, duration=3945
query=q7, count=9735, duration=44328
query=q8, count=8716, duration=29190
query=q9a, count=6001215, duration=804107
query=q9b, count=6001215, duration=542749
