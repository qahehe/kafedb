20/04/14 06:02:21 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 14754ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Tue Apr 14 06:02:26 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Tue Apr 14 06:02:28 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Tue Apr 14 06:02:28 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Tue Apr 14 06:02:28 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Tue Apr 14 06:02:28 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Tue Apr 14 06:02:34 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Tue Apr 14 06:02:39 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Tue Apr 14 06:02:39 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/14 06:02:41 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 06:02:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1911L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 06:02:41 WARN DexPlanner: InMemoryFileIndex=customer
20/04/14 06:02:42 WARN DexPlanner: InMemoryFileIndex=customer
20/04/14 06:02:42 WARN DexPlanner: InMemoryFileIndex=customer
20/04/14 06:02:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1911L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cc_acctbal_0, 'rid_0, 'cc_name_0, 'cc_nationkey_0, 'cc_custkey_0, 'cc_comment_0, 'cc_address_0, 'cc_mktsegment_0, 'cc_phone_0, 'rid_1, 'co_shippriority_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, 'co_clerk_1, 'co_orderstatus_1, 'co_totalprice_1, 'co_orderkey_1, 'co_comment_1, dexdecrypt('value_dec_key, value#1935) AS rid_2#1957]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['cc_acctbal_0, 'rid_0, 'cc_name_0, 'cc_nationkey_0, 'cc_custkey_0, 'cc_comment_0, 'cc_address_0, 'cc_mktsegment_0, 'cc_phone_0, dexdecrypt('value_dec_key, value#1935) AS rid_1#1936]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#1923: binary
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [cc_acctbal#1913 AS cc_acctbal_0#1922, rid#1914 AS rid_0#1923, cc_name#1915 AS cc_name_0#1924, cc_nationkey#1916 AS cc_nationkey_0#1925, cc_custkey#1917 AS cc_custkey_0#1926, cc_comment#1918 AS cc_comment_0#1927, cc_address#1919 AS cc_address_0#1928, cc_mktsegment#1920 AS cc_mktsegment_0#1929, cc_phone#1921 AS cc_phone_0#1930]
         :     :  :     :  :  +- Relation[cc_acctbal#1913,rid#1914,cc_name#1915,cc_nationkey#1916,cc_custkey#1917,cc_comment#1918,cc_address#1919,cc_mktsegment#1920,cc_phone#1921] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1933]
         :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :        +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [co_shippriority#1937 AS co_shippriority_1#1947, rid#1938 AS rid_1#1948, co_orderdate#1939 AS co_orderdate_1#1949, co_custkey#1940 AS co_custkey_1#1950, co_orderpriority#1941 AS co_orderpriority_1#1951, co_clerk#1942 AS co_clerk_1#1952, co_orderstatus#1943 AS co_orderstatus_1#1953, co_totalprice#1944 AS co_totalprice_1#1954, co_orderkey#1945 AS co_orderkey_1#1955, co_comment#1946 AS co_comment_1#1956]
         :     :     +- Relation[co_shippriority#1937,rid#1938,co_orderdate#1939,co_custkey#1940,co_orderpriority#1941,co_clerk#1942,co_orderstatus#1943,co_totalprice#1944,co_orderkey#1945,co_comment#1946] JDBCRelation(torders) [numPartitions=1]
         :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cl_returnflag#1958 AS cl_returnflag_2#1977, cl_orderkey_and_l_linenumber#1959 AS cl_orderkey_and_l_linenumber_2#1978, cl_comment#1960 AS cl_comment_2#1979, cl_linestatus#1961 AS cl_linestatus_2#1980, rid#1962 AS rid_2#1981, cl_shipmode#1963 AS cl_shipmode_2#1982, cl_shipinstruct#1964 AS cl_shipinstruct_2#1983, cl_quantity#1965 AS cl_quantity_2#1984, cl_receiptdate#1966 AS cl_receiptdate_2#1985, cl_linenumber#1967 AS cl_linenumber_2#1986, cl_tax#1968 AS cl_tax_2#1987, cl_shipdate#1969 AS cl_shipdate_2#1988, cl_extendedprice#1970 AS cl_extendedprice_2#1989, cl_partkey#1971 AS cl_partkey_2#1990, cl_discount#1972 AS cl_discount_2#1991, cl_partkey_and_l_suppkey#1973 AS cl_partkey_and_l_suppkey_2#1992, cl_commitdate#1974 AS cl_commitdate_2#1993, cl_suppkey#1975 AS cl_suppkey_2#1994, cl_orderkey#1976 AS cl_orderkey_2#1995]
            +- Relation[cl_returnflag#1958,cl_orderkey_and_l_linenumber#1959,cl_comment#1960,cl_linestatus#1961,rid#1962,cl_shipmode#1963,cl_shipinstruct#1964,cl_quantity#1965,cl_receiptdate#1966,cl_linenumber#1967,cl_tax#1968,cl_shipdate#1969,cl_extendedprice#1970,cl_partkey#1971,cl_discount#1972,cl_partkey_and_l_suppkey#1973,cl_commitdate#1974,cl_suppkey#1975,cl_orderkey#1976] JDBCRelation(tlineitem) [numPartitions=1]

20/04/14 06:02:42 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=1214743
Elapsed time: 86072ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/14 06:04:07 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 06:04:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2039L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 06:04:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#2039L]
+- Project
   +- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- Project [cl_returnflag#2041 AS cl_returnflag_0#2060, cl_orderkey_and_l_linenumber#2042 AS cl_orderkey_and_l_linenumber_0#2061, cl_comment#2043 AS cl_comment_0#2062, cl_linestatus#2044 AS cl_linestatus_0#2063, rid#2045 AS rid_0#2064, cl_shipmode#2046 AS cl_shipmode_0#2065, cl_shipinstruct#2047 AS cl_shipinstruct_0#2066, cl_quantity#2048 AS cl_quantity_0#2067, cl_receiptdate#2049 AS cl_receiptdate_0#2068, cl_linenumber#2050 AS cl_linenumber_0#2069, cl_tax#2051 AS cl_tax_0#2070, cl_shipdate#2052 AS cl_shipdate_0#2071, cl_extendedprice#2053 AS cl_extendedprice_0#2072, cl_partkey#2054 AS cl_partkey_0#2073, cl_discount#2055 AS cl_discount_0#2074, cl_partkey_and_l_suppkey#2056 AS cl_partkey_and_l_suppkey_0#2075, cl_commitdate#2057 AS cl_commitdate_0#2076, cl_suppkey#2058 AS cl_suppkey_0#2077, cl_orderkey#2059 AS cl_orderkey_0#2078]
         +- Relation[cl_returnflag#2041,cl_orderkey_and_l_linenumber#2042,cl_comment#2043,cl_linestatus#2044,rid#2045,cl_shipmode#2046,cl_shipinstruct#2047,cl_quantity#2048,cl_receiptdate#2049,cl_linenumber#2050,cl_tax#2051,cl_shipdate#2052,cl_extendedprice#2053,cl_partkey#2054,cl_discount#2055,cl_partkey_and_l_suppkey#2056,cl_commitdate#2057,cl_suppkey#2058,cl_orderkey#2059] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 7253ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/14 06:04:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 06:04:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2102L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/14 06:04:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2102L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(RightOuter)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [co_shippriority#2104 AS co_shippriority_0#2114, rid#2105 AS rid_0#2115, co_orderdate#2106 AS co_orderdate_0#2116, co_custkey#2107 AS co_custkey_0#2117, co_orderpriority#2108 AS co_orderpriority_0#2118, co_clerk#2109 AS co_clerk_0#2119, co_orderstatus#2110 AS co_orderstatus_0#2120, co_totalprice#2111 AS co_totalprice_0#2121, co_orderkey#2112 AS co_orderkey_0#2122, co_comment#2113 AS co_comment_0#2123]
         :  :  +- Relation[co_shippriority#2104,rid#2105,co_orderdate#2106,co_custkey#2107,co_orderpriority#2108,co_clerk#2109,co_orderstatus#2110,co_totalprice#2111,co_orderkey#2112,co_comment#2113] JDBCRelation(torders) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1935) AS rid_1#2135]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2134]
         :        :  +- Relation[co_shippriority#2124,rid#2125,co_orderdate#2126,co_custkey#2127,co_orderpriority#2128,co_clerk#2129,co_orderstatus#2130,co_totalprice#2131,co_orderkey#2132,co_comment#2133] JDBCRelation(torders) [numPartitions=1]
         :        +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cc_acctbal#2136 AS cc_acctbal_1#2145, rid#2137 AS rid_1#2146, cc_name#2138 AS cc_name_1#2147, cc_nationkey#2139 AS cc_nationkey_1#2148, cc_custkey#2140 AS cc_custkey_1#2149, cc_comment#2141 AS cc_comment_1#2150, cc_address#2142 AS cc_address_1#2151, cc_mktsegment#2143 AS cc_mktsegment_1#2152, cc_phone#2144 AS cc_phone_1#2153]
            +- Relation[cc_acctbal#2136,rid#2137,cc_name#2138,cc_nationkey#2139,cc_custkey#2140,cc_comment#2141,cc_address#2142,cc_mktsegment#2143,cc_phone#2144] JDBCRelation(tcustomer) [numPartitions=1]

DexCorr$ result size=1550004
Elapsed time: 117472ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/14 06:06:12 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 06:06:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2185L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/14 06:06:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 06:06:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 06:06:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2185L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cl_returnflag_0, 'cl_orderkey_and_l_linenumber_0, 'cl_comment_0, 'cl_linestatus_0, 'rid_0, 'cl_shipmode_0, 'cl_shipinstruct_0, 'cl_quantity_0, 'cl_receiptdate_0, 'cl_linenumber_0, 'cl_tax_0, 'cl_shipdate_0, 'cl_extendedprice_0, 'cl_partkey_0, 'cl_discount_0, 'cl_partkey_and_l_suppkey_0, 'cl_commitdate_0, 'cl_suppkey_0, 'cl_orderkey_0, 'rid_1, 'co_shippriority_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, ... 15 more fields]
         :  +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['cl_returnflag_0, 'cl_orderkey_and_l_linenumber_0, 'cl_comment_0, 'cl_linestatus_0, 'rid_0, 'cl_shipmode_0, 'cl_shipinstruct_0, 'cl_quantity_0, 'cl_receiptdate_0, 'cl_linenumber_0, 'cl_tax_0, 'cl_shipdate_0, 'cl_extendedprice_0, 'cl_partkey_0, 'cl_discount_0, 'cl_partkey_and_l_suppkey_0, 'cl_commitdate_0, 'cl_suppkey_0, 'cl_orderkey_0, 'rid_1, 'co_shippriority_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, ... 6 more fields]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['cl_returnflag_0, 'cl_orderkey_and_l_linenumber_0, 'cl_comment_0, 'cl_linestatus_0, 'rid_0, 'cl_shipmode_0, 'cl_shipinstruct_0, 'cl_quantity_0, 'cl_receiptdate_0, 'cl_linenumber_0, 'cl_tax_0, 'cl_shipdate_0, 'cl_extendedprice_0, 'cl_partkey_0, 'cl_discount_0, 'cl_partkey_and_l_suppkey_0, 'cl_commitdate_0, 'cl_suppkey_0, 'cl_orderkey_0, dexdecrypt('value_dec_key, value#1935) AS rid_1#2226]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2210: binary
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [cl_returnflag#2187 AS cl_returnflag_0#2206, cl_orderkey_and_l_linenumber#2188 AS cl_orderkey_and_l_linenumber_0#2207, cl_comment#2189 AS cl_comment_0#2208, cl_linestatus#2190 AS cl_linestatus_0#2209, rid#2191 AS rid_0#2210, cl_shipmode#2192 AS cl_shipmode_0#2211, cl_shipinstruct#2193 AS cl_shipinstruct_0#2212, cl_quantity#2194 AS cl_quantity_0#2213, cl_receiptdate#2195 AS cl_receiptdate_0#2214, cl_linenumber#2196 AS cl_linenumber_0#2215, cl_tax#2197 AS cl_tax_0#2216, cl_shipdate#2198 AS cl_shipdate_0#2217, cl_extendedprice#2199 AS cl_extendedprice_0#2218, cl_partkey#2200 AS cl_partkey_0#2219, cl_discount#2201 AS cl_discount_0#2220, cl_partkey_and_l_suppkey#2202 AS cl_partkey_and_l_suppkey_0#2221, cl_commitdate#2203 AS cl_commitdate_0#2222, cl_suppkey#2204 AS cl_suppkey_0#2223, cl_orderkey#2205 AS cl_orderkey_0#2224]
         :     :  :     :  :     :  :  +- Relation[cl_returnflag#2187,cl_orderkey_and_l_linenumber#2188,cl_comment#2189,cl_linestatus#2190,rid#2191,cl_shipmode#2192,cl_shipinstruct#2193,cl_quantity#2194,cl_receiptdate#2195,cl_linenumber#2196,cl_tax#2197,cl_shipdate#2198,cl_extendedprice#2199,cl_partkey#2200,cl_discount#2201,cl_partkey_and_l_suppkey#2202,cl_commitdate#2203,cl_suppkey#2204,cl_orderkey#2205] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2225]
         :     :  :     :  :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :  :     :  :     :        +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [co_shippriority#2227 AS co_shippriority_1#2237, rid#2228 AS rid_1#2238, co_orderdate#2229 AS co_orderdate_1#2239, co_custkey#2230 AS co_custkey_1#2240, co_orderpriority#2231 AS co_orderpriority_1#2241, co_clerk#2232 AS co_clerk_1#2242, co_orderstatus#2233 AS co_orderstatus_1#2243, co_totalprice#2234 AS co_totalprice_1#2244, co_orderkey#2235 AS co_orderkey_1#2245, co_comment#2236 AS co_comment_1#2246]
         :     :  :     :     +- Relation[co_shippriority#2227,rid#2228,co_orderdate#2229,co_custkey#2230,co_orderpriority#2231,co_clerk#2232,co_orderstatus#2233,co_totalprice#2234,co_orderkey#2235,co_comment#2236] JDBCRelation(torders) [numPartitions=1]
         :     :  :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [cc_acctbal#2248 AS cc_acctbal_2#2257, rid#2249 AS rid_2#2258, cc_name#2250 AS cc_name_2#2259, cc_nationkey#2251 AS cc_nationkey_2#2260, cc_custkey#2252 AS cc_custkey_2#2261, cc_comment#2253 AS cc_comment_2#2262, cc_address#2254 AS cc_address_2#2263, cc_mktsegment#2255 AS cc_mktsegment_2#2264, cc_phone#2256 AS cc_phone_2#2265]
         :     :     +- Relation[cc_acctbal#2248,rid#2249,cc_name#2250,cc_nationkey#2251,cc_custkey#2252,cc_comment#2253,cc_address#2254,cc_mktsegment#2255,cc_phone#2256] JDBCRelation(tcustomer) [numPartitions=1]
         :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#2267 AS rid_3#2272, cn_regionkey#2268 AS cn_regionkey_3#2273, cn_nationkey#2269 AS cn_nationkey_3#2274, cn_name#2270 AS cn_name_3#2275, cn_comment#2271 AS cn_comment_3#2276]
            +- Relation[rid#2267,cn_regionkey#2268,cn_nationkey#2269,cn_name#2270,cn_comment#2271] JDBCRelation(tnation) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 459464ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/14 06:13:51 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 06:13:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2326L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 06:13:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2326L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [cp_comment#2328 AS cp_comment_0#2338, cp_name#2329 AS cp_name_0#2339, rid#2330 AS rid_0#2340, cp_type#2331 AS cp_type_0#2341, cp_retailprice#2332 AS cp_retailprice_0#2342, cp_mfgr#2333 AS cp_mfgr_0#2343, cp_container#2334 AS cp_container_0#2344, cp_brand#2335 AS cp_brand_0#2345, cp_size#2336 AS cp_size_0#2346, cp_partkey#2337 AS cp_partkey_0#2347]
         :  :  +- Relation[cp_comment#2328,cp_name#2329,rid#2330,cp_type#2331,cp_retailprice#2332,cp_mfgr#2333,cp_container#2334,cp_brand#2335,cp_size#2336,cp_partkey#2337] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1935) AS rid_1#2359]
         :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2358]
         :        :  +- Relation[cp_comment#2348,cp_name#2349,rid#2350,cp_type#2351,cp_retailprice#2352,cp_mfgr#2353,cp_container#2354,cp_brand#2355,cp_size#2356,cp_partkey#2357] JDBCRelation(tpart) [numPartitions=1]
         :        +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cl_returnflag#2360 AS cl_returnflag_1#2379, cl_orderkey_and_l_linenumber#2361 AS cl_orderkey_and_l_linenumber_1#2380, cl_comment#2362 AS cl_comment_1#2381, cl_linestatus#2363 AS cl_linestatus_1#2382, rid#2364 AS rid_1#2383, cl_shipmode#2365 AS cl_shipmode_1#2384, cl_shipinstruct#2366 AS cl_shipinstruct_1#2385, cl_quantity#2367 AS cl_quantity_1#2386, cl_receiptdate#2368 AS cl_receiptdate_1#2387, cl_linenumber#2369 AS cl_linenumber_1#2388, cl_tax#2370 AS cl_tax_1#2389, cl_shipdate#2371 AS cl_shipdate_1#2390, cl_extendedprice#2372 AS cl_extendedprice_1#2391, cl_partkey#2373 AS cl_partkey_1#2392, cl_discount#2374 AS cl_discount_1#2393, cl_partkey_and_l_suppkey#2375 AS cl_partkey_and_l_suppkey_1#2394, cl_commitdate#2376 AS cl_commitdate_1#2395, cl_suppkey#2377 AS cl_suppkey_1#2396, cl_orderkey#2378 AS cl_orderkey_1#2397]
            +- Relation[cl_returnflag#2360,cl_orderkey_and_l_linenumber#2361,cl_comment#2362,cl_linestatus#2363,rid#2364,cl_shipmode#2365,cl_shipinstruct#2366,cl_quantity#2367,cl_receiptdate#2368,cl_linenumber#2369,cl_tax#2370,cl_shipdate#2371,cl_extendedprice#2372,cl_partkey#2373,cl_discount#2374,cl_partkey_and_l_suppkey#2375,cl_commitdate#2376,cl_suppkey#2377,cl_orderkey#2378] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 223057ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/14 06:17:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 06:17:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2431L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/14 06:17:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 06:17:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 06:17:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 06:17:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 06:17:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 06:17:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 06:17:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 06:17:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 06:17:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 06:17:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 06:17:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 06:17:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 06:17:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2431L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cr_regionkey_0, 'cr_name_0, 'cr_comment_0, 'rid_0, 'rid_1, 'cn_regionkey_1, 'cn_nationkey_1, 'cn_name_1, 'cn_comment_1, 'rid_2, 'cs_phone_2, 'cs_address_2, 'cs_nationkey_2, 'cs_suppkey_2, 'cs_name_2, 'cs_acctbal_2, 'cs_comment_2, dexdecrypt('value_dec_key, value#1935) AS rid_4#2470]
         :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['cr_regionkey_0, 'cr_name_0, 'cr_comment_0, 'rid_0, 'rid_1, 'cn_regionkey_1, 'cn_nationkey_1, 'cn_name_1, 'cn_comment_1, dexdecrypt('value_dec_key, value#1935) AS rid_2#2453]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['cr_regionkey_0, 'cr_name_0, 'cr_comment_0, 'rid_0, dexdecrypt('value_dec_key, value#1935) AS rid_1#2442]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#2440: binary
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [cr_regionkey#2433 AS cr_regionkey_0#2437, cr_name#2434 AS cr_name_0#2438, cr_comment#2435 AS cr_comment_0#2439, rid#2436 AS rid_0#2440]
         :     :  :     :  :     :  :  +- Relation[cr_regionkey#2433,cr_name#2434,cr_comment#2435,rid#2436] JDBCRelation(tregion) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2441]
         :     :  :     :  :     :     +- DexRidFilter region~r_name~EUROPE
         :     :  :     :  :     :        +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [rid#2443 AS rid_1#2448, cn_regionkey#2444 AS cn_regionkey_1#2449, cn_nationkey#2445 AS cn_nationkey_1#2450, cn_name#2446 AS cn_name_1#2451, cn_comment#2447 AS cn_comment_1#2452]
         :     :  :     :     +- Relation[rid#2443,cn_regionkey#2444,cn_nationkey#2445,cn_name#2446,cn_comment#2447] JDBCRelation(tnation) [numPartitions=1]
         :     :  :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [cs_phone#2454 AS cs_phone_2#2462, rid#2455 AS rid_2#2463, cs_address#2456 AS cs_address_2#2464, cs_nationkey#2457 AS cs_nationkey_2#2465, cs_suppkey#2458 AS cs_suppkey_2#2466, cs_name#2459 AS cs_name_2#2467, cs_acctbal#2460 AS cs_acctbal_2#2468, cs_comment#2461 AS cs_comment_2#2469]
         :     :     +- Relation[cs_phone#2454,rid#2455,cs_address#2456,cs_nationkey#2457,cs_suppkey#2458,cs_name#2459,cs_acctbal#2460,cs_comment#2461] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['cp_comment_3, 'cp_name_3, 'rid_3, 'cp_type_3, 'cp_retailprice_3, 'cp_mfgr_3, 'cp_container_3, 'cp_brand_3, 'cp_size_3, 'cp_partkey_3, dexdecrypt('value_dec_key, value#1935) AS rid_4#2492]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_3#2483: binary
            :     :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :     :  :- Project [cp_comment#2471 AS cp_comment_3#2481, cp_name#2472 AS cp_name_3#2482, rid#2473 AS rid_3#2483, cp_type#2474 AS cp_type_3#2484, cp_retailprice#2475 AS cp_retailprice_3#2485, cp_mfgr#2476 AS cp_mfgr_3#2486, cp_container#2477 AS cp_container_3#2487, cp_brand#2478 AS cp_brand_3#2488, cp_size#2479 AS cp_size_3#2489, cp_partkey#2480 AS cp_partkey_3#2490]
            :     :  :  +- Relation[cp_comment#2471,cp_name#2472,rid#2473,cp_type#2474,cp_retailprice#2475,cp_mfgr#2476,cp_container#2477,cp_brand#2478,cp_size#2479,cp_partkey#2480] JDBCRelation(tpart) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#2491]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [cps_partkey_and_ps_suppkey#2493 AS cps_partkey_and_ps_suppkey_4#2500, rid#2494 AS rid_4#2501, cps_availqty#2495 AS cps_availqty_4#2502, cps_comment#2496 AS cps_comment_4#2503, cps_partkey#2497 AS cps_partkey_4#2504, cps_supplycost#2498 AS cps_supplycost_4#2505, cps_suppkey#2499 AS cps_suppkey_4#2506]
               +- Relation[cps_partkey_and_ps_suppkey#2493,rid#2494,cps_availqty#2495,cps_comment#2496,cps_partkey#2497,cps_supplycost#2498,cps_suppkey#2499] JDBCRelation(tpartsupp) [numPartitions=1]

DexCorr$ result size=3162
Elapsed time: 19303ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/14 06:17:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 06:17:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2549L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#612L = c_nationkey#293L)
               :     :- Project [n_nationkey#612L]
               :     :  +- Filter (n_name#613 = GERMANY)
               :     :     +- Relation[n_nationkey#612L,n_name#613,n_regionkey#614L,n_comment#615] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 06:17:54 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 06:17:54 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 06:17:54 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 06:17:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 06:17:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 06:17:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 06:17:54 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 06:17:54 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 06:17:54 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 06:17:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2549L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'cn_regionkey_0, 'cn_nationkey_0, 'cn_name_0, 'cn_comment_0, 'rid_1, 'cs_phone_1, 'cs_address_1, 'cs_nationkey_1, 'cs_suppkey_1, 'cs_name_1, 'cs_acctbal_1, 'cs_comment_1, 'rid_2, 'cl_returnflag_2, 'cl_orderkey_and_l_linenumber_2, 'cl_comment_2, 'cl_linestatus_2, 'cl_shipmode_2, 'cl_shipinstruct_2, 'cl_quantity_2, 'cl_receiptdate_2, 'cl_linenumber_2, 'cl_tax_2, ... 9 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'cn_regionkey_0, 'cn_nationkey_0, 'cn_name_0, 'cn_comment_0, 'rid_1, 'cs_phone_1, 'cs_address_1, 'cs_nationkey_1, 'cs_suppkey_1, 'cs_name_1, 'cs_acctbal_1, 'cs_comment_1, dexdecrypt('value_dec_key, value#1935) AS rid_2#2579]
         :     :  :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['rid_0, 'cn_regionkey_0, 'cn_nationkey_0, 'cn_name_0, 'cn_comment_0, dexdecrypt('value_dec_key, value#1935) AS rid_1#2562]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#2556: binary
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [rid#2551 AS rid_0#2556, cn_regionkey#2552 AS cn_regionkey_0#2557, cn_nationkey#2553 AS cn_nationkey_0#2558, cn_name#2554 AS cn_name_0#2559, cn_comment#2555 AS cn_comment_0#2560]
         :     :  :     :  :     :  :  +- Relation[rid#2551,cn_regionkey#2552,cn_nationkey#2553,cn_name#2554,cn_comment#2555] JDBCRelation(tnation) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2561]
         :     :  :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :  :     :        +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [cs_phone#2563 AS cs_phone_1#2571, rid#2564 AS rid_1#2572, cs_address#2565 AS cs_address_1#2573, cs_nationkey#2566 AS cs_nationkey_1#2574, cs_suppkey#2567 AS cs_suppkey_1#2575, cs_name#2568 AS cs_name_1#2576, cs_acctbal#2569 AS cs_acctbal_1#2577, cs_comment#2570 AS cs_comment_1#2578]
         :     :  :     :     +- Relation[cs_phone#2563,rid#2564,cs_address#2565,cs_nationkey#2566,cs_suppkey#2567,cs_name#2568,cs_acctbal#2569,cs_comment#2570] JDBCRelation(tsupplier) [numPartitions=1]
         :     :  :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [cl_returnflag#2580 AS cl_returnflag_2#2599, cl_orderkey_and_l_linenumber#2581 AS cl_orderkey_and_l_linenumber_2#2600, cl_comment#2582 AS cl_comment_2#2601, cl_linestatus#2583 AS cl_linestatus_2#2602, rid#2584 AS rid_2#2603, cl_shipmode#2585 AS cl_shipmode_2#2604, cl_shipinstruct#2586 AS cl_shipinstruct_2#2605, cl_quantity#2587 AS cl_quantity_2#2606, cl_receiptdate#2588 AS cl_receiptdate_2#2607, cl_linenumber#2589 AS cl_linenumber_2#2608, cl_tax#2590 AS cl_tax_2#2609, cl_shipdate#2591 AS cl_shipdate_2#2610, cl_extendedprice#2592 AS cl_extendedprice_2#2611, cl_partkey#2593 AS cl_partkey_2#2612, cl_discount#2594 AS cl_discount_2#2613, cl_partkey_and_l_suppkey#2595 AS cl_partkey_and_l_suppkey_2#2614, cl_commitdate#2596 AS cl_commitdate_2#2615, cl_suppkey#2597 AS cl_suppkey_2#2616, cl_orderkey#2598 AS cl_orderkey_2#2617]
         :     :     +- Relation[cl_returnflag#2580,cl_orderkey_and_l_linenumber#2581,cl_comment#2582,cl_linestatus#2583,rid#2584,cl_shipmode#2585,cl_shipinstruct#2586,cl_quantity#2587,cl_receiptdate#2588,cl_linenumber#2589,cl_tax#2590,cl_shipdate#2591,cl_extendedprice#2592,cl_partkey#2593,cl_discount#2594,cl_partkey_and_l_suppkey#2595,cl_commitdate#2596,cl_suppkey#2597,cl_orderkey#2598] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_3, 'cn_regionkey_3, 'cn_nationkey_3, 'cn_name_3, 'cn_comment_3, 'rid_4, 'cc_acctbal_4, 'cc_name_4, 'cc_nationkey_4, 'cc_custkey_4, 'cc_comment_4, 'cc_address_4, 'cc_mktsegment_4, 'cc_phone_4, dexdecrypt('value_dec_key, value#1935) AS rid_5#2649]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_4
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['rid_3, 'cn_regionkey_3, 'cn_nationkey_3, 'cn_name_3, 'cn_comment_3, dexdecrypt('value_dec_key, value#1935) AS rid_4#2630]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_3#2624: binary
            :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :     :  :     :  :- Project [rid#2619 AS rid_3#2624, cn_regionkey#2620 AS cn_regionkey_3#2625, cn_nationkey#2621 AS cn_nationkey_3#2626, cn_name#2622 AS cn_name_3#2627, cn_comment#2623 AS cn_comment_3#2628]
            :     :  :     :  :  +- Relation[rid#2619,cn_regionkey#2620,cn_nationkey#2621,cn_name#2622,cn_comment#2623] JDBCRelation(tnation) [numPartitions=1]
            :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#2629]
            :     :  :     :     +- DexRidFilter nation~n_name~GERMANY
            :     :  :     :        +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [cc_acctbal#2631 AS cc_acctbal_4#2640, rid#2632 AS rid_4#2641, cc_name#2633 AS cc_name_4#2642, cc_nationkey#2634 AS cc_nationkey_4#2643, cc_custkey#2635 AS cc_custkey_4#2644, cc_comment#2636 AS cc_comment_4#2645, cc_address#2637 AS cc_address_4#2646, cc_mktsegment#2638 AS cc_mktsegment_4#2647, cc_phone#2639 AS cc_phone_4#2648]
            :     :     +- Relation[cc_acctbal#2631,rid#2632,cc_name#2633,cc_nationkey#2634,cc_custkey#2635,cc_comment#2636,cc_address#2637,cc_mktsegment#2638,cc_phone#2639] JDBCRelation(tcustomer) [numPartitions=1]
            :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [co_shippriority#2650 AS co_shippriority_5#2660, rid#2651 AS rid_5#2661, co_orderdate#2652 AS co_orderdate_5#2662, co_custkey#2653 AS co_custkey_5#2663, co_orderpriority#2654 AS co_orderpriority_5#2664, co_clerk#2655 AS co_clerk_5#2665, co_orderstatus#2656 AS co_orderstatus_5#2666, co_totalprice#2657 AS co_totalprice_5#2667, co_orderkey#2658 AS co_orderkey_5#2668, co_comment#2659 AS co_comment_5#2669]
               +- Relation[co_shippriority#2650,rid#2651,co_orderdate#2652,co_custkey#2653,co_orderpriority#2654,co_clerk#2655,co_orderstatus#2656,co_totalprice#2657,co_orderkey#2658,co_comment#2659] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=9735
Elapsed time: 57106ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/14 06:18:51 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 06:18:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2754L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 06:18:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2754L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [cl_returnflag#2756 AS cl_returnflag_0#2775, cl_orderkey_and_l_linenumber#2757 AS cl_orderkey_and_l_linenumber_0#2776, cl_comment#2758 AS cl_comment_0#2777, cl_linestatus#2759 AS cl_linestatus_0#2778, rid#2760 AS rid_0#2779, cl_shipmode#2761 AS cl_shipmode_0#2780, cl_shipinstruct#2762 AS cl_shipinstruct_0#2781, cl_quantity#2763 AS cl_quantity_0#2782, cl_receiptdate#2764 AS cl_receiptdate_0#2783, cl_linenumber#2765 AS cl_linenumber_0#2784, cl_tax#2766 AS cl_tax_0#2785, cl_shipdate#2767 AS cl_shipdate_0#2786, cl_extendedprice#2768 AS cl_extendedprice_0#2787, cl_partkey#2769 AS cl_partkey_0#2788, cl_discount#2770 AS cl_discount_0#2789, cl_partkey_and_l_suppkey#2771 AS cl_partkey_and_l_suppkey_0#2790, cl_commitdate#2772 AS cl_commitdate_0#2791, cl_suppkey#2773 AS cl_suppkey_0#2792, cl_orderkey#2774 AS cl_orderkey_0#2793]
         :  :  +- Relation[cl_returnflag#2756,cl_orderkey_and_l_linenumber#2757,cl_comment#2758,cl_linestatus#2759,rid#2760,cl_shipmode#2761,cl_shipinstruct#2762,cl_quantity#2763,cl_receiptdate#2764,cl_linenumber#2765,cl_tax#2766,cl_shipdate#2767,cl_extendedprice#2768,cl_partkey#2769,cl_discount#2770,cl_partkey_and_l_suppkey#2771,cl_commitdate#2772,cl_suppkey#2773,cl_orderkey#2774] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1935) AS rid_1#2814]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2813]
         :        :  +- Relation[cl_returnflag#2794,cl_orderkey_and_l_linenumber#2795,cl_comment#2796,cl_linestatus#2797,rid#2798,cl_shipmode#2799,cl_shipinstruct#2800,cl_quantity#2801,cl_receiptdate#2802,cl_linenumber#2803,cl_tax#2804,cl_shipdate#2805,cl_extendedprice#2806,cl_partkey#2807,cl_discount#2808,cl_partkey_and_l_suppkey#2809,cl_commitdate#2810,cl_suppkey#2811,cl_orderkey#2812] JDBCRelation(tlineitem) [numPartitions=1]
         :        +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [co_shippriority#2815 AS co_shippriority_1#2825, rid#2816 AS rid_1#2826, co_orderdate#2817 AS co_orderdate_1#2827, co_custkey#2818 AS co_custkey_1#2828, co_orderpriority#2819 AS co_orderpriority_1#2829, co_clerk#2820 AS co_clerk_1#2830, co_orderstatus#2821 AS co_orderstatus_1#2831, co_totalprice#2822 AS co_totalprice_1#2832, co_orderkey#2823 AS co_orderkey_1#2833, co_comment#2824 AS co_comment_1#2834]
            +- Relation[co_shippriority#2815,rid#2816,co_orderdate#2817,co_custkey#2818,co_orderpriority#2819,co_clerk#2820,co_orderstatus#2821,co_totalprice#2822,co_orderkey#2823,co_comment#2824] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 233285ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/14 06:22:44 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 06:22:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2873L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 06:22:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 06:22:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 06:22:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 06:22:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 06:22:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 06:22:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 06:22:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 06:22:44 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 06:22:44 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 06:22:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2873L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :  :  :  :  :- Project [rid#2875 AS rid_0#2880, cn_regionkey#2876 AS cn_regionkey_0#2881, cn_nationkey#2877 AS cn_nationkey_0#2882, cn_name#2878 AS cn_name_0#2883, cn_comment#2879 AS cn_comment_0#2884]
         :  :  :  :  :  :  :  :  :  :  +- Relation[rid#2875,cn_regionkey#2876,cn_nationkey#2877,cn_name#2878,cn_comment#2879] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1935) AS rid_1#2891]
         :  :  :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_0
         :  :  :  :  :  :  :  :  :        :- 'Project ['rid AS rid_0#2890]
         :  :  :  :  :  :  :  :  :        :  +- Relation[rid#2885,cn_regionkey#2886,cn_nationkey#2887,cn_name#2888,cn_comment#2889] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  :  :  :  :  :        +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  :  :  +- Project [cs_phone#2892 AS cs_phone_1#2900, rid#2893 AS rid_1#2901, cs_address#2894 AS cs_address_1#2902, cs_nationkey#2895 AS cs_nationkey_1#2903, cs_suppkey#2896 AS cs_suppkey_1#2904, cs_name#2897 AS cs_name_1#2905, cs_acctbal#2898 AS cs_acctbal_1#2906, cs_comment#2899 AS cs_comment_1#2907]
         :  :  :  :  :  :  :  :     +- Relation[cs_phone#2892,rid#2893,cs_address#2894,cs_nationkey#2895,cs_suppkey#2896,cs_name#2897,cs_acctbal#2898,cs_comment#2899] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :  :  :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1935) AS rid_2#2917]
         :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_1
         :  :  :  :  :  :  :        :- 'Project ['rid AS rid_1#2916]
         :  :  :  :  :  :  :        :  +- Relation[cs_phone#2908,rid#2909,cs_address#2910,cs_nationkey#2911,cs_suppkey#2912,cs_name#2913,cs_acctbal#2914,cs_comment#2915] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :  :  :  :  :        +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  +- Project [cl_returnflag#2918 AS cl_returnflag_2#2937, cl_orderkey_and_l_linenumber#2919 AS cl_orderkey_and_l_linenumber_2#2938, cl_comment#2920 AS cl_comment_2#2939, cl_linestatus#2921 AS cl_linestatus_2#2940, rid#2922 AS rid_2#2941, cl_shipmode#2923 AS cl_shipmode_2#2942, cl_shipinstruct#2924 AS cl_shipinstruct_2#2943, cl_quantity#2925 AS cl_quantity_2#2944, cl_receiptdate#2926 AS cl_receiptdate_2#2945, cl_linenumber#2927 AS cl_linenumber_2#2946, cl_tax#2928 AS cl_tax_2#2947, cl_shipdate#2929 AS cl_shipdate_2#2948, cl_extendedprice#2930 AS cl_extendedprice_2#2949, cl_partkey#2931 AS cl_partkey_2#2950, cl_discount#2932 AS cl_discount_2#2951, cl_partkey_and_l_suppkey#2933 AS cl_partkey_and_l_suppkey_2#2952, cl_commitdate#2934 AS cl_commitdate_2#2953, cl_suppkey#2935 AS cl_suppkey_2#2954, cl_orderkey#2936 AS cl_orderkey_2#2955]
         :  :  :  :  :  :     +- Relation[cl_returnflag#2918,cl_orderkey_and_l_linenumber#2919,cl_comment#2920,cl_linestatus#2921,rid#2922,cl_shipmode#2923,cl_shipinstruct#2924,cl_quantity#2925,cl_receiptdate#2926,cl_linenumber#2927,cl_tax#2928,cl_shipdate#2929,cl_extendedprice#2930,cl_partkey#2931,cl_discount#2932,cl_partkey_and_l_suppkey#2933,cl_commitdate#2934,cl_suppkey#2935,cl_orderkey#2936] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1935) AS rid_3#2976]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_2
         :  :  :  :  :        :- 'Project ['rid AS rid_2#2975]
         :  :  :  :  :        :  +- Relation[cl_returnflag#2956,cl_orderkey_and_l_linenumber#2957,cl_comment#2958,cl_linestatus#2959,rid#2960,cl_shipmode#2961,cl_shipinstruct#2962,cl_quantity#2963,cl_receiptdate#2964,cl_linenumber#2965,cl_tax#2966,cl_shipdate#2967,cl_extendedprice#2968,cl_partkey#2969,cl_discount#2970,cl_partkey_and_l_suppkey#2971,cl_commitdate#2972,cl_suppkey#2973,cl_orderkey#2974] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [cp_comment#2977 AS cp_comment_3#2987, cp_name#2978 AS cp_name_3#2988, rid#2979 AS rid_3#2989, cp_type#2980 AS cp_type_3#2990, cp_retailprice#2981 AS cp_retailprice_3#2991, cp_mfgr#2982 AS cp_mfgr_3#2992, cp_container#2983 AS cp_container_3#2993, cp_brand#2984 AS cp_brand_3#2994, cp_size#2985 AS cp_size_3#2995, cp_partkey#2986 AS cp_partkey_3#2996]
         :  :  :  :     +- Relation[cp_comment#2977,cp_name#2978,rid#2979,cp_type#2980,cp_retailprice#2981,cp_mfgr#2982,cp_container#2983,cp_brand#2984,cp_size#2985,cp_partkey#2986] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1935) AS rid_4#3017]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey_and_l_suppkey~partsupp~ps_partkey_and_ps_suppkey, 'rid_2
         :  :  :        :- 'Project ['rid AS rid_2#3016]
         :  :  :        :  +- Relation[cl_returnflag#2997,cl_orderkey_and_l_linenumber#2998,cl_comment#2999,cl_linestatus#3000,rid#3001,cl_shipmode#3002,cl_shipinstruct#3003,cl_quantity#3004,cl_receiptdate#3005,cl_linenumber#3006,cl_tax#3007,cl_shipdate#3008,cl_extendedprice#3009,cl_partkey#3010,cl_discount#3011,cl_partkey_and_l_suppkey#3012,cl_commitdate#3013,cl_suppkey#3014,cl_orderkey#3015] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :        +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [cps_partkey_and_ps_suppkey#3018 AS cps_partkey_and_ps_suppkey_4#3025, rid#3019 AS rid_4#3026, cps_availqty#3020 AS cps_availqty_4#3027, cps_comment#3021 AS cps_comment_4#3028, cps_partkey#3022 AS cps_partkey_4#3029, cps_supplycost#3023 AS cps_supplycost_4#3030, cps_suppkey#3024 AS cps_suppkey_4#3031]
         :  :     +- Relation[cps_partkey_and_ps_suppkey#3018,rid#3019,cps_availqty#3020,cps_comment#3021,cps_partkey#3022,cps_supplycost#3023,cps_suppkey#3024] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1935) AS rid_5#3052]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#3051]
         :        :  +- Relation[cl_returnflag#3032,cl_orderkey_and_l_linenumber#3033,cl_comment#3034,cl_linestatus#3035,rid#3036,cl_shipmode#3037,cl_shipinstruct#3038,cl_quantity#3039,cl_receiptdate#3040,cl_linenumber#3041,cl_tax#3042,cl_shipdate#3043,cl_extendedprice#3044,cl_partkey#3045,cl_discount#3046,cl_partkey_and_l_suppkey#3047,cl_commitdate#3048,cl_suppkey#3049,cl_orderkey#3050] JDBCRelation(tlineitem) [numPartitions=1]
         :        +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [co_shippriority#3053 AS co_shippriority_5#3063, rid#3054 AS rid_5#3064, co_orderdate#3055 AS co_orderdate_5#3065, co_custkey#3056 AS co_custkey_5#3066, co_orderpriority#3057 AS co_orderpriority_5#3067, co_clerk#3058 AS co_clerk_5#3068, co_orderstatus#3059 AS co_orderstatus_5#3069, co_totalprice#3060 AS co_totalprice_5#3070, co_orderkey#3061 AS co_orderkey_5#3071, co_comment#3062 AS co_comment_5#3072]
            +- Relation[co_shippriority#3053,rid#3054,co_orderdate#3055,co_custkey#3056,co_orderpriority#3057,co_clerk#3058,co_orderstatus#3059,co_totalprice#3060,co_orderkey#3061,co_comment#3062] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 935585ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/14 06:38:20 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 06:38:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3137L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 06:38:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#3137L]
+- Project
   +- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- Project [cl_returnflag#3139 AS cl_returnflag_0#3158, cl_orderkey_and_l_linenumber#3140 AS cl_orderkey_and_l_linenumber_0#3159, cl_comment#3141 AS cl_comment_0#3160, cl_linestatus#3142 AS cl_linestatus_0#3161, rid#3143 AS rid_0#3162, cl_shipmode#3144 AS cl_shipmode_0#3163, cl_shipinstruct#3145 AS cl_shipinstruct_0#3164, cl_quantity#3146 AS cl_quantity_0#3165, cl_receiptdate#3147 AS cl_receiptdate_0#3166, cl_linenumber#3148 AS cl_linenumber_0#3167, cl_tax#3149 AS cl_tax_0#3168, cl_shipdate#3150 AS cl_shipdate_0#3169, cl_extendedprice#3151 AS cl_extendedprice_0#3170, cl_partkey#3152 AS cl_partkey_0#3171, cl_discount#3153 AS cl_discount_0#3172, cl_partkey_and_l_suppkey#3154 AS cl_partkey_and_l_suppkey_0#3173, cl_commitdate#3155 AS cl_commitdate_0#3174, cl_suppkey#3156 AS cl_suppkey_0#3175, cl_orderkey#3157 AS cl_orderkey_0#3176]
         +- Relation[cl_returnflag#3139,cl_orderkey_and_l_linenumber#3140,cl_comment#3141,cl_linestatus#3142,rid#3143,cl_shipmode#3144,cl_shipinstruct#3145,cl_quantity#3146,cl_receiptdate#3147,cl_linenumber#3148,cl_tax#3149,cl_shipdate#3150,cl_extendedprice#3151,cl_partkey#3152,cl_discount#3153,cl_partkey_and_l_suppkey#3154,cl_commitdate#3155,cl_suppkey#3156,cl_orderkey#3157] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 19501ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/14 06:38:39 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 06:38:39 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3202L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/14 06:38:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 06:38:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 06:38:39 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 06:38:39 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 06:38:39 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 06:38:39 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 06:38:39 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 06:38:39 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 06:38:39 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3202L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'cn_regionkey_0, 'cn_nationkey_0, 'cn_name_0, 'cn_comment_0, 'rid_1, 'cs_phone_1, 'cs_address_1, 'cs_nationkey_1, 'cs_suppkey_1, 'cs_name_1, 'cs_acctbal_1, 'cs_comment_1, dexdecrypt('value_dec_key, value#1935) AS rid_2#3232]
         :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'cn_regionkey_0, 'cn_nationkey_0, 'cn_name_0, 'cn_comment_0, dexdecrypt('value_dec_key, value#1935) AS rid_1#3215]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#3209: binary
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#3204 AS rid_0#3209, cn_regionkey#3205 AS cn_regionkey_0#3210, cn_nationkey#3206 AS cn_nationkey_0#3211, cn_name#3207 AS cn_name_0#3212, cn_comment#3208 AS cn_comment_0#3213]
         :     :  :     :  :  +- Relation[rid#3204,cn_regionkey#3205,cn_nationkey#3206,cn_name#3207,cn_comment#3208] JDBCRelation(tnation) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3214]
         :     :  :     :     +- DexRidFilter nation~n_name~GERMANY
         :     :  :     :        +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [cs_phone#3216 AS cs_phone_1#3224, rid#3217 AS rid_1#3225, cs_address#3218 AS cs_address_1#3226, cs_nationkey#3219 AS cs_nationkey_1#3227, cs_suppkey#3220 AS cs_suppkey_1#3228, cs_name#3221 AS cs_name_1#3229, cs_acctbal#3222 AS cs_acctbal_1#3230, cs_comment#3223 AS cs_comment_1#3231]
         :     :     +- Relation[cs_phone#3216,rid#3217,cs_address#3218,cs_nationkey#3219,cs_suppkey#3220,cs_name#3221,cs_acctbal#3222,cs_comment#3223] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cps_partkey_and_ps_suppkey#3233 AS cps_partkey_and_ps_suppkey_2#3240, rid#3234 AS rid_2#3241, cps_availqty#3235 AS cps_availqty_2#3242, cps_comment#3236 AS cps_comment_2#3243, cps_partkey#3237 AS cps_partkey_2#3244, cps_supplycost#3238 AS cps_supplycost_2#3245, cps_suppkey#3239 AS cps_suppkey_2#3246]
            +- Relation[cps_partkey_and_ps_suppkey#3233,rid#3234,cps_availqty#3235,cps_comment#3236,cps_partkey#3237,cps_supplycost#3238,cps_suppkey#3239] JDBCRelation(tpartsupp) [numPartitions=1]

DexCorr$ result size=31680
Elapsed time: 2730ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/14 06:38:42 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 06:38:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3276L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 06:38:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3276L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [cc_acctbal#3278 AS cc_acctbal_0#3287, rid#3279 AS rid_0#3288, cc_name#3280 AS cc_name_0#3289, cc_nationkey#3281 AS cc_nationkey_0#3290, cc_custkey#3282 AS cc_custkey_0#3291, cc_comment#3283 AS cc_comment_0#3292, cc_address#3284 AS cc_address_0#3293, cc_mktsegment#3285 AS cc_mktsegment_0#3294, cc_phone#3286 AS cc_phone_0#3295]
         :  :  :  :  +- Relation[cc_acctbal#3278,rid#3279,cc_name#3280,cc_nationkey#3281,cc_custkey#3282,cc_comment#3283,cc_address#3284,cc_mktsegment#3285,cc_phone#3286] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1935) AS rid_1#3306]
         :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#3305]
         :  :  :        :  +- Relation[cc_acctbal#3296,rid#3297,cc_name#3298,cc_nationkey#3299,cc_custkey#3300,cc_comment#3301,cc_address#3302,cc_mktsegment#3303,cc_phone#3304] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :        +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [co_shippriority#3307 AS co_shippriority_1#3317, rid#3308 AS rid_1#3318, co_orderdate#3309 AS co_orderdate_1#3319, co_custkey#3310 AS co_custkey_1#3320, co_orderpriority#3311 AS co_orderpriority_1#3321, co_clerk#3312 AS co_clerk_1#3322, co_orderstatus#3313 AS co_orderstatus_1#3323, co_totalprice#3314 AS co_totalprice_1#3324, co_orderkey#3315 AS co_orderkey_1#3325, co_comment#3316 AS co_comment_1#3326]
         :  :     +- Relation[co_shippriority#3307,rid#3308,co_orderdate#3309,co_custkey#3310,co_orderpriority#3311,co_clerk#3312,co_orderstatus#3313,co_totalprice#3314,co_orderkey#3315,co_comment#3316] JDBCRelation(torders) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1935) AS rid_2#3338]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3337]
         :        :  +- Relation[co_shippriority#3327,rid#3328,co_orderdate#3329,co_custkey#3330,co_orderpriority#3331,co_clerk#3332,co_orderstatus#3333,co_totalprice#3334,co_orderkey#3335,co_comment#3336] JDBCRelation(torders) [numPartitions=1]
         :        +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cl_returnflag#3339 AS cl_returnflag_2#3358, cl_orderkey_and_l_linenumber#3340 AS cl_orderkey_and_l_linenumber_2#3359, cl_comment#3341 AS cl_comment_2#3360, cl_linestatus#3342 AS cl_linestatus_2#3361, rid#3343 AS rid_2#3362, cl_shipmode#3344 AS cl_shipmode_2#3363, cl_shipinstruct#3345 AS cl_shipinstruct_2#3364, cl_quantity#3346 AS cl_quantity_2#3365, cl_receiptdate#3347 AS cl_receiptdate_2#3366, cl_linenumber#3348 AS cl_linenumber_2#3367, cl_tax#3349 AS cl_tax_2#3368, cl_shipdate#3350 AS cl_shipdate_2#3369, cl_extendedprice#3351 AS cl_extendedprice_2#3370, cl_partkey#3352 AS cl_partkey_2#3371, cl_discount#3353 AS cl_discount_2#3372, cl_partkey_and_l_suppkey#3354 AS cl_partkey_and_l_suppkey_2#3373, cl_commitdate#3355 AS cl_commitdate_2#3374, cl_suppkey#3356 AS cl_suppkey_2#3375, cl_orderkey#3357 AS cl_orderkey_2#3376]
            +- Relation[cl_returnflag#3339,cl_orderkey_and_l_linenumber#3340,cl_comment#3341,cl_linestatus#3342,rid#3343,cl_shipmode#3344,cl_shipinstruct#3345,cl_quantity#3346,cl_receiptdate#3347,cl_linenumber#3348,cl_tax#3349,cl_shipdate#3350,cl_extendedprice#3351,cl_partkey#3352,cl_discount#3353,cl_partkey_and_l_suppkey#3354,cl_commitdate#3355,cl_suppkey#3356,cl_orderkey#3357] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 2512204ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/14 07:20:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 07:20:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3420L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/14 07:20:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 07:20:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 07:20:34 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 07:20:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 07:20:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 07:20:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 07:20:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 07:20:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 07:20:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 07:20:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3420L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(LeftSemi)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Project ['rid_2, 'cn_regionkey_2, 'cn_nationkey_2, 'cn_name_2, 'cn_comment_2, dexdecrypt('value_dec_key, value#1935) AS rid_3#3470]
         :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_2#3464: binary
         :  :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
         :  :     :  :- Project [rid#3459 AS rid_2#3464, cn_regionkey#3460 AS cn_regionkey_2#3465, cn_nationkey#3461 AS cn_nationkey_2#3466, cn_name#3462 AS cn_name_2#3467, cn_comment#3463 AS cn_comment_2#3468]
         :  :     :  :  +- Relation[rid#3459,cn_regionkey#3460,cn_nationkey#3461,cn_name#3462,cn_comment#3463] JDBCRelation(tnation) [numPartitions=1]
         :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#3469]
         :  :     :     +- DexRidFilter nation~n_name~CANADA
         :  :     :        +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]
         :  :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  +- Project [cs_phone#3471 AS cs_phone_3#3479, rid#3472 AS rid_3#3480, cs_address#3473 AS cs_address_3#3481, cs_nationkey#3474 AS cs_nationkey_3#3482, cs_suppkey#3475 AS cs_suppkey_3#3483, cs_name#3476 AS cs_name_3#3484, cs_acctbal#3477 AS cs_acctbal_3#3485, cs_comment#3478 AS cs_comment_3#3486]
         :     +- Relation[cs_phone#3471,rid#3472,cs_address#3473,cs_nationkey#3474,cs_suppkey#3475,cs_name#3476,cs_acctbal#3477,cs_comment#3478] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'Project ['cps_partkey_and_ps_suppkey_1, 'rid_1, 'cps_availqty_1, 'cps_comment_1, 'cps_partkey_1, 'cps_supplycost_1, 'cps_suppkey_1, dexdecrypt('value_dec_key, value#1935) AS rid_3#3458]
            +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, rid_1#3452: binary
               :- 'Join NaturalJoin(LeftSemi)
               :  :- Project [cps_partkey_and_ps_suppkey#3444 AS cps_partkey_and_ps_suppkey_1#3451, rid#3445 AS rid_1#3452, cps_availqty#3446 AS cps_availqty_1#3453, cps_comment#3447 AS cps_comment_1#3454, cps_partkey#3448 AS cps_partkey_1#3455, cps_supplycost#3449 AS cps_supplycost_1#3456, cps_suppkey#3450 AS cps_suppkey_1#3457]
               :  :  +- Relation[cps_partkey_and_ps_suppkey#3444,rid#3445,cps_availqty#3446,cps_comment#3447,cps_partkey#3448,cps_supplycost#3449,cps_suppkey#3450] JDBCRelation(tpartsupp) [numPartitions=1]
               :  +- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, dexdecrypt('value_dec_key, value#1935) AS rid_1#3443]
               :     +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#3434: binary
               :        :- 'Join UsingJoin(LeftSemi,List(rid_0))
               :        :  :- Project [cp_comment#3422 AS cp_comment_0#3432, cp_name#3423 AS cp_name_0#3433, rid#3424 AS rid_0#3434, cp_type#3425 AS cp_type_0#3435, cp_retailprice#3426 AS cp_retailprice_0#3436, cp_mfgr#3427 AS cp_mfgr_0#3437, cp_container#3428 AS cp_container_0#3438, cp_brand#3429 AS cp_brand_0#3439, cp_size#3430 AS cp_size_0#3440, cp_partkey#3431 AS cp_partkey_0#3441]
               :        :  :  +- Relation[cp_comment#3422,cp_name#3423,rid#3424,cp_type#3425,cp_retailprice#3426,cp_mfgr#3427,cp_container#3428,cp_brand#3429,cp_size#3430,cp_partkey#3431] JDBCRelation(tpart) [numPartitions=1]
               :        :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3442]
               :        :     +- DexRidFilter part~p_size~15
               :        :        +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]
               :        +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
               +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]

DexCorr$ result size=324
Elapsed time: 3494ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/14 07:20:38 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 07:20:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3505L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 07:20:38 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 07:20:38 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 07:20:38 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 07:20:38 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 07:20:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3505L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, dexdecrypt('value_dec_key, value#1935) AS rid_1#3529]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3519: binary
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :- Project [cp_comment#3507 AS cp_comment_0#3517, cp_name#3508 AS cp_name_0#3518, rid#3509 AS rid_0#3519, cp_type#3510 AS cp_type_0#3520, cp_retailprice#3511 AS cp_retailprice_0#3521, cp_mfgr#3512 AS cp_mfgr_0#3522, cp_container#3513 AS cp_container_0#3523, cp_brand#3514 AS cp_brand_0#3524, cp_size#3515 AS cp_size_0#3525, cp_partkey#3516 AS cp_partkey_0#3526]
         :     :  :  :  +- Relation[cp_comment#3507,cp_name#3508,rid#3509,cp_type#3510,cp_retailprice#3511,cp_mfgr#3512,cp_container#3513,cp_brand#3514,cp_size#3515,cp_partkey#3516] JDBCRelation(tpart) [numPartitions=1]
         :     :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3527]
         :     :  :     +- DexRidFilter part~p_brand~Brand#12
         :     :  :        +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3528]
         :     :     +- DexRidFilter part~p_container~SM CASE
         :     :        +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [cl_returnflag#3530 AS cl_returnflag_1#3549, cl_orderkey_and_l_linenumber#3531 AS cl_orderkey_and_l_linenumber_1#3550, cl_comment#3532 AS cl_comment_1#3551, cl_linestatus#3533 AS cl_linestatus_1#3552, rid#3534 AS rid_1#3553, cl_shipmode#3535 AS cl_shipmode_1#3554, cl_shipinstruct#3536 AS cl_shipinstruct_1#3555, cl_quantity#3537 AS cl_quantity_1#3556, cl_receiptdate#3538 AS cl_receiptdate_1#3557, cl_linenumber#3539 AS cl_linenumber_1#3558, cl_tax#3540 AS cl_tax_1#3559, cl_shipdate#3541 AS cl_shipdate_1#3560, cl_extendedprice#3542 AS cl_extendedprice_1#3561, cl_partkey#3543 AS cl_partkey_1#3562, cl_discount#3544 AS cl_discount_1#3563, cl_partkey_and_l_suppkey#3545 AS cl_partkey_and_l_suppkey_1#3564, cl_commitdate#3546 AS cl_commitdate_1#3565, cl_suppkey#3547 AS cl_suppkey_1#3566, cl_orderkey#3548 AS cl_orderkey_1#3567]
            :  :  +- Relation[cl_returnflag#3530,cl_orderkey_and_l_linenumber#3531,cl_comment#3532,cl_linestatus#3533,rid#3534,cl_shipmode#3535,cl_shipinstruct#3536,cl_quantity#3537,cl_receiptdate#3538,cl_linenumber#3539,cl_tax#3540,cl_shipdate#3541,cl_extendedprice#3542,cl_partkey#3543,cl_discount#3544,cl_partkey_and_l_suppkey#3545,cl_commitdate#3546,cl_suppkey#3547,cl_orderkey#3548] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3568]
            :     +- DexRidFilter lineitem~l_shipmode~AIR
            :        +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3569]
               +- DexRidFilter lineitem~l_shipinstruct~DELIVER IN PERSON
                  +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=205
Elapsed time: 469703ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/14 07:28:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 07:28:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3606L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/14 07:28:27 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 07:28:27 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 07:28:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3606L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, dexdecrypt('value_dec_key, value#1935) AS rid_1#3629]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#3620: binary
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [cp_comment#3608 AS cp_comment_0#3618, cp_name#3609 AS cp_name_0#3619, rid#3610 AS rid_0#3620, cp_type#3611 AS cp_type_0#3621, cp_retailprice#3612 AS cp_retailprice_0#3622, cp_mfgr#3613 AS cp_mfgr_0#3623, cp_container#3614 AS cp_container_0#3624, cp_brand#3615 AS cp_brand_0#3625, cp_size#3616 AS cp_size_0#3626, cp_partkey#3617 AS cp_partkey_0#3627]
         :     :  :  +- Relation[cp_comment#3608,cp_name#3609,rid#3610,cp_type#3611,cp_retailprice#3612,cp_mfgr#3613,cp_container#3614,cp_brand#3615,cp_size#3616,cp_partkey#3617] JDBCRelation(tpart) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3628]
         :     :     +- DexRidFilter part~p_size~49
         :     :        +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cps_partkey_and_ps_suppkey#3630 AS cps_partkey_and_ps_suppkey_1#3637, rid#3631 AS rid_1#3638, cps_availqty#3632 AS cps_availqty_1#3639, cps_comment#3633 AS cps_comment_1#3640, cps_partkey#3634 AS cps_partkey_1#3641, cps_supplycost#3635 AS cps_supplycost_1#3642, cps_suppkey#3636 AS cps_suppkey_1#3643]
            +- Relation[cps_partkey_and_ps_suppkey#3630,rid#3631,cps_availqty#3632,cps_comment#3633,cps_partkey#3634,cps_supplycost#3635,cps_suppkey#3636] JDBCRelation(tpartsupp) [numPartitions=1]

DexCorr$ result size=15780
Elapsed time: 19376ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/14 07:28:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 07:28:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3665L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1766L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1766L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1764L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1764L, l_suppkey#1766L]
               :     :        +- Relation[l_orderkey#1764L,l_partkey#1765L,l_suppkey#1766L,l_linenumber#1767,l_quantity#1768,l_extendedprice#1769,l_discount#1770,l_tax#1771,l_returnflag#1772,l_linestatus#1773,l_commitdate#1774,l_receiptdate#1775,l_shipinstruct#1776,l_shipmode#1777,l_comment#1778,l_shipdate#1779] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/14 07:28:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 07:28:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 07:28:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 07:28:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 07:28:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 07:28:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 07:28:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3665L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(LeftSemi)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Project ['co_shippriority_1, 'rid_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, 'co_clerk_1, 'co_orderstatus_1, 'co_totalprice_1, 'co_orderkey_1, 'co_comment_1, 'rid_2, 'cl_returnflag_2, 'cl_orderkey_and_l_linenumber_2, 'cl_comment_2, 'cl_linestatus_2, 'cl_shipmode_2, 'cl_shipinstruct_2, 'cl_quantity_2, 'cl_receiptdate_2, 'cl_linenumber_2, 'cl_tax_2, 'cl_shipdate_2, 'cl_extendedprice_2, 'cl_partkey_2, ... 14 more fields]
         :  :  +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_3
         :  :     :- 'Join NaturalJoin(Inner)
         :  :     :  :- 'Project ['co_shippriority_1, 'rid_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, 'co_clerk_1, 'co_orderstatus_1, 'co_totalprice_1, 'co_orderkey_1, 'co_comment_1, 'rid_2, 'cl_returnflag_2, 'cl_orderkey_and_l_linenumber_2, 'cl_comment_2, 'cl_linestatus_2, 'cl_shipmode_2, 'cl_shipinstruct_2, 'cl_quantity_2, 'cl_receiptdate_2, 'cl_linenumber_2, 'cl_tax_2, 'cl_shipdate_2, 'cl_extendedprice_2, 'cl_partkey_2, ... 6 more fields]
         :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_2
         :  :     :  :     :- 'Join NaturalJoin(Inner)
         :  :     :  :     :  :- 'Project ['co_shippriority_1, 'rid_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, 'co_clerk_1, 'co_orderstatus_1, 'co_totalprice_1, 'co_orderkey_1, 'co_comment_1, dexdecrypt('value_dec_key, value#1935) AS rid_2#3747]
         :  :     :  :     :  :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#3737: binary
         :  :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :     :  :     :  :     :  :- Project [co_shippriority#3726 AS co_shippriority_1#3736, rid#3727 AS rid_1#3737, co_orderdate#3728 AS co_orderdate_1#3738, co_custkey#3729 AS co_custkey_1#3739, co_orderpriority#3730 AS co_orderpriority_1#3740, co_clerk#3731 AS co_clerk_1#3741, co_orderstatus#3732 AS co_orderstatus_1#3742, co_totalprice#3733 AS co_totalprice_1#3743, co_orderkey#3734 AS co_orderkey_1#3744, co_comment#3735 AS co_comment_1#3745]
         :  :     :  :     :  :     :  :  +- Relation[co_shippriority#3726,rid#3727,co_orderdate#3728,co_custkey#3729,co_orderpriority#3730,co_clerk#3731,co_orderstatus#3732,co_totalprice#3733,co_orderkey#3734,co_comment#3735] JDBCRelation(torders) [numPartitions=1]
         :  :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3746]
         :  :     :  :     :  :     :     +- DexRidFilter orders~o_orderstatus~F
         :  :     :  :     :  :     :        +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]
         :  :     :  :     :  :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :     :  :     :  +- Project [cl_returnflag#3748 AS cl_returnflag_2#3767, cl_orderkey_and_l_linenumber#3749 AS cl_orderkey_and_l_linenumber_2#3768, cl_comment#3750 AS cl_comment_2#3769, cl_linestatus#3751 AS cl_linestatus_2#3770, rid#3752 AS rid_2#3771, cl_shipmode#3753 AS cl_shipmode_2#3772, cl_shipinstruct#3754 AS cl_shipinstruct_2#3773, cl_quantity#3755 AS cl_quantity_2#3774, cl_receiptdate#3756 AS cl_receiptdate_2#3775, cl_linenumber#3757 AS cl_linenumber_2#3776, cl_tax#3758 AS cl_tax_2#3777, cl_shipdate#3759 AS cl_shipdate_2#3778, cl_extendedprice#3760 AS cl_extendedprice_2#3779, cl_partkey#3761 AS cl_partkey_2#3780, cl_discount#3762 AS cl_discount_2#3781, cl_partkey_and_l_suppkey#3763 AS cl_partkey_and_l_suppkey_2#3782, cl_commitdate#3764 AS cl_commitdate_2#3783, cl_suppkey#3765 AS cl_suppkey_2#3784, cl_orderkey#3766 AS cl_orderkey_2#3785]
         :  :     :  :     :     +- Relation[cl_returnflag#3748,cl_orderkey_and_l_linenumber#3749,cl_comment#3750,cl_linestatus#3751,rid#3752,cl_shipmode#3753,cl_shipinstruct#3754,cl_quantity#3755,cl_receiptdate#3756,cl_linenumber#3757,cl_tax#3758,cl_shipdate#3759,cl_extendedprice#3760,cl_partkey#3761,cl_discount#3762,cl_partkey_and_l_suppkey#3763,cl_commitdate#3764,cl_suppkey#3765,cl_orderkey#3766] JDBCRelation(tlineitem) [numPartitions=1]
         :  :     :  :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :     :  +- Project [cs_phone#3787 AS cs_phone_3#3795, rid#3788 AS rid_3#3796, cs_address#3789 AS cs_address_3#3797, cs_nationkey#3790 AS cs_nationkey_3#3798, cs_suppkey#3791 AS cs_suppkey_3#3799, cs_name#3792 AS cs_name_3#3800, cs_acctbal#3793 AS cs_acctbal_3#3801, cs_comment#3794 AS cs_comment_3#3802]
         :  :     :     +- Relation[cs_phone#3787,rid#3788,cs_address#3789,cs_nationkey#3790,cs_suppkey#3791,cs_name#3792,cs_acctbal#3793,cs_comment#3794] JDBCRelation(tsupplier) [numPartitions=1]
         :  :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  +- 'Join UsingJoin(LeftSemi,List(rid_4))
         :     :- Project [rid#3804 AS rid_4#3809, cn_regionkey#3805 AS cn_regionkey_4#3810, cn_nationkey#3806 AS cn_nationkey_4#3811, cn_name#3807 AS cn_name_4#3812, cn_comment#3808 AS cn_comment_4#3813]
         :     :  +- Relation[rid#3804,cn_regionkey#3805,cn_nationkey#3806,cn_name#3807,cn_comment#3808] JDBCRelation(tnation) [numPartitions=1]
         :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_4#3814]
         :        +- DexRidFilter nation~n_name~SAUDI ARABIA
         :           +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_0))
            :- Project [cl_returnflag#3667 AS cl_returnflag_0#3686, cl_orderkey_and_l_linenumber#3668 AS cl_orderkey_and_l_linenumber_0#3687, cl_comment#3669 AS cl_comment_0#3688, cl_linestatus#3670 AS cl_linestatus_0#3689, rid#3671 AS rid_0#3690, cl_shipmode#3672 AS cl_shipmode_0#3691, cl_shipinstruct#3673 AS cl_shipinstruct_0#3692, cl_quantity#3674 AS cl_quantity_0#3693, cl_receiptdate#3675 AS cl_receiptdate_0#3694, cl_linenumber#3676 AS cl_linenumber_0#3695, cl_tax#3677 AS cl_tax_0#3696, cl_shipdate#3678 AS cl_shipdate_0#3697, cl_extendedprice#3679 AS cl_extendedprice_0#3698, cl_partkey#3680 AS cl_partkey_0#3699, cl_discount#3681 AS cl_discount_0#3700, cl_partkey_and_l_suppkey#3682 AS cl_partkey_and_l_suppkey_0#3701, cl_commitdate#3683 AS cl_commitdate_0#3702, cl_suppkey#3684 AS cl_suppkey_0#3703, cl_orderkey#3685 AS cl_orderkey_0#3704]
            :  +- Relation[cl_returnflag#3667,cl_orderkey_and_l_linenumber#3668,cl_comment#3669,cl_linestatus#3670,rid#3671,cl_shipmode#3672,cl_shipinstruct#3673,cl_quantity#3674,cl_receiptdate#3675,cl_linenumber#3676,cl_tax#3677,cl_shipdate#3678,cl_extendedprice#3679,cl_partkey#3680,cl_discount#3681,cl_partkey_and_l_suppkey#3682,cl_commitdate#3683,cl_suppkey#3684,cl_orderkey#3685] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1935) AS rid_1#3725]
               +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
                  :- 'Project ['rid AS rid_0#3724]
                  :  +- Relation[cl_returnflag#3705,cl_orderkey_and_l_linenumber#3706,cl_comment#3707,cl_linestatus#3708,rid#3709,cl_shipmode#3710,cl_shipinstruct#3711,cl_quantity#3712,cl_receiptdate#3713,cl_linenumber#3714,cl_tax#3715,cl_shipdate#3716,cl_extendedprice#3717,cl_partkey#3718,cl_discount#3719,cl_partkey_and_l_suppkey#3720,cl_commitdate#3721,cl_suppkey#3722,cl_orderkey#3723] JDBCRelation(tlineitem) [numPartitions=1]
                  +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]

DexCorr$ result size=119924
Elapsed time: 1439986ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/14 07:52:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 07:52:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3864L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#810L = c_nationkey#293L)
               :     :- Project [n_nationkey#810L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#812L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#810L, n_regionkey#812L]
               :     :        +- Relation[n_nationkey#810L,n_name#811,n_regionkey#812L,n_comment#813] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 07:52:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 07:52:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 07:52:47 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 07:52:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 07:52:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 07:52:47 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 07:52:47 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 07:52:47 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 07:52:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 07:52:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 07:52:47 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 07:52:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3864L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, 'rid_1, 'cl_returnflag_1, 'cl_orderkey_and_l_linenumber_1, 'cl_comment_1, 'cl_linestatus_1, 'cl_shipmode_1, 'cl_shipinstruct_1, 'cl_quantity_1, 'cl_receiptdate_1, 'cl_linenumber_1, 'cl_tax_1, 'cl_shipdate_1, 'cl_extendedprice_1, 'cl_partkey_1, ... 19 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, 'rid_1, 'cl_returnflag_1, 'cl_orderkey_and_l_linenumber_1, 'cl_comment_1, 'cl_linestatus_1, 'cl_shipmode_1, 'cl_shipinstruct_1, 'cl_quantity_1, 'cl_receiptdate_1, 'cl_linenumber_1, 'cl_tax_1, 'cl_shipdate_1, 'cl_extendedprice_1, 'cl_partkey_1, ... 14 more fields]
         :     :  :  +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_2
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, 'rid_1, 'cl_returnflag_1, 'cl_orderkey_and_l_linenumber_1, 'cl_comment_1, 'cl_linestatus_1, 'cl_shipmode_1, 'cl_shipinstruct_1, 'cl_quantity_1, 'cl_receiptdate_1, 'cl_linenumber_1, 'cl_tax_1, 'cl_shipdate_1, 'cl_extendedprice_1, 'cl_partkey_1, ... 6 more fields]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :  :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :     :  :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, dexdecrypt('value_dec_key, value#1935) AS rid_1#3887]
         :     :  :     :  :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3878: binary
         :     :  :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :     :  :- Project [cp_comment#3866 AS cp_comment_0#3876, cp_name#3867 AS cp_name_0#3877, rid#3868 AS rid_0#3878, cp_type#3869 AS cp_type_0#3879, cp_retailprice#3870 AS cp_retailprice_0#3880, cp_mfgr#3871 AS cp_mfgr_0#3881, cp_container#3872 AS cp_container_0#3882, cp_brand#3873 AS cp_brand_0#3883, cp_size#3874 AS cp_size_0#3884, cp_partkey#3875 AS cp_partkey_0#3885]
         :     :  :     :  :     :  :     :  :  +- Relation[cp_comment#3866,cp_name#3867,rid#3868,cp_type#3869,cp_retailprice#3870,cp_mfgr#3871,cp_container#3872,cp_brand#3873,cp_size#3874,cp_partkey#3875] JDBCRelation(tpart) [numPartitions=1]
         :     :  :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3886]
         :     :  :     :  :     :  :     :     +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
         :     :  :     :  :     :  :     :        +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     :  :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  :     :  +- Project [cl_returnflag#3888 AS cl_returnflag_1#3907, cl_orderkey_and_l_linenumber#3889 AS cl_orderkey_and_l_linenumber_1#3908, cl_comment#3890 AS cl_comment_1#3909, cl_linestatus#3891 AS cl_linestatus_1#3910, rid#3892 AS rid_1#3911, cl_shipmode#3893 AS cl_shipmode_1#3912, cl_shipinstruct#3894 AS cl_shipinstruct_1#3913, cl_quantity#3895 AS cl_quantity_1#3914, cl_receiptdate#3896 AS cl_receiptdate_1#3915, cl_linenumber#3897 AS cl_linenumber_1#3916, cl_tax#3898 AS cl_tax_1#3917, cl_shipdate#3899 AS cl_shipdate_1#3918, cl_extendedprice#3900 AS cl_extendedprice_1#3919, cl_partkey#3901 AS cl_partkey_1#3920, cl_discount#3902 AS cl_discount_1#3921, cl_partkey_and_l_suppkey#3903 AS cl_partkey_and_l_suppkey_1#3922, cl_commitdate#3904 AS cl_commitdate_1#3923, cl_suppkey#3905 AS cl_suppkey_1#3924, cl_orderkey#3906 AS cl_orderkey_1#3925]
         :     :  :     :  :     :     +- Relation[cl_returnflag#3888,cl_orderkey_and_l_linenumber#3889,cl_comment#3890,cl_linestatus#3891,rid#3892,cl_shipmode#3893,cl_shipinstruct#3894,cl_quantity#3895,cl_receiptdate#3896,cl_linenumber#3897,cl_tax#3898,cl_shipdate#3899,cl_extendedprice#3900,cl_partkey#3901,cl_discount#3902,cl_partkey_and_l_suppkey#3903,cl_commitdate#3904,cl_suppkey#3905,cl_orderkey#3906] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [cs_phone#3927 AS cs_phone_2#3935, rid#3928 AS rid_2#3936, cs_address#3929 AS cs_address_2#3937, cs_nationkey#3930 AS cs_nationkey_2#3938, cs_suppkey#3931 AS cs_suppkey_2#3939, cs_name#3932 AS cs_name_2#3940, cs_acctbal#3933 AS cs_acctbal_2#3941, cs_comment#3934 AS cs_comment_2#3942]
         :     :  :     :     +- Relation[cs_phone#3927,rid#3928,cs_address#3929,cs_nationkey#3930,cs_suppkey#3931,cs_name#3932,cs_acctbal#3933,cs_comment#3934] JDBCRelation(tsupplier) [numPartitions=1]
         :     :  :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [rid#3944 AS rid_3#3949, cn_regionkey#3945 AS cn_regionkey_3#3950, cn_nationkey#3946 AS cn_nationkey_3#3951, cn_name#3947 AS cn_name_3#3952, cn_comment#3948 AS cn_comment_3#3953]
         :     :     +- Relation[rid#3944,cn_regionkey#3945,cn_nationkey#3946,cn_name#3947,cn_comment#3948] JDBCRelation(tnation) [numPartitions=1]
         :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['cr_regionkey_4, 'cr_name_4, 'cr_comment_4, 'rid_4, 'rid_5, 'cn_regionkey_5, 'cn_nationkey_5, 'cn_name_5, 'cn_comment_5, 'rid_6, 'cc_acctbal_6, 'cc_name_6, 'cc_nationkey_6, 'cc_custkey_6, 'cc_comment_6, 'cc_address_6, 'cc_mktsegment_6, 'cc_phone_6, dexdecrypt('value_dec_key, value#1935) AS rid_7#3994]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_6
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['cr_regionkey_4, 'cr_name_4, 'cr_comment_4, 'rid_4, 'rid_5, 'cn_regionkey_5, 'cn_nationkey_5, 'cn_name_5, 'cn_comment_5, dexdecrypt('value_dec_key, value#1935) AS rid_6#3975]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_5
            :     :  :     :- 'Join NaturalJoin(Inner)
            :     :  :     :  :- 'Project ['cr_regionkey_4, 'cr_name_4, 'cr_comment_4, 'rid_4, dexdecrypt('value_dec_key, value#1935) AS rid_5#3964]
            :     :  :     :  :  +- 'DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_4#3962: binary
            :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_4))
            :     :  :     :  :     :  :- Project [cr_regionkey#3955 AS cr_regionkey_4#3959, cr_name#3956 AS cr_name_4#3960, cr_comment#3957 AS cr_comment_4#3961, rid#3958 AS rid_4#3962]
            :     :  :     :  :     :  :  +- Relation[cr_regionkey#3955,cr_name#3956,cr_comment#3957,rid#3958] JDBCRelation(tregion) [numPartitions=1]
            :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_4#3963]
            :     :  :     :  :     :     +- DexRidFilter region~r_name~AMERICA
            :     :  :     :  :     :        +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     :  :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  :     :  +- Project [rid#3965 AS rid_5#3970, cn_regionkey#3966 AS cn_regionkey_5#3971, cn_nationkey#3967 AS cn_nationkey_5#3972, cn_name#3968 AS cn_name_5#3973, cn_comment#3969 AS cn_comment_5#3974]
            :     :  :     :     +- Relation[rid#3965,cn_regionkey#3966,cn_nationkey#3967,cn_name#3968,cn_comment#3969] JDBCRelation(tnation) [numPartitions=1]
            :     :  :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [cc_acctbal#3976 AS cc_acctbal_6#3985, rid#3977 AS rid_6#3986, cc_name#3978 AS cc_name_6#3987, cc_nationkey#3979 AS cc_nationkey_6#3988, cc_custkey#3980 AS cc_custkey_6#3989, cc_comment#3981 AS cc_comment_6#3990, cc_address#3982 AS cc_address_6#3991, cc_mktsegment#3983 AS cc_mktsegment_6#3992, cc_phone#3984 AS cc_phone_6#3993]
            :     :     +- Relation[cc_acctbal#3976,rid#3977,cc_name#3978,cc_nationkey#3979,cc_custkey#3980,cc_comment#3981,cc_address#3982,cc_mktsegment#3983,cc_phone#3984] JDBCRelation(tcustomer) [numPartitions=1]
            :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [co_shippriority#3995 AS co_shippriority_7#4005, rid#3996 AS rid_7#4006, co_orderdate#3997 AS co_orderdate_7#4007, co_custkey#3998 AS co_custkey_7#4008, co_orderpriority#3999 AS co_orderpriority_7#4009, co_clerk#4000 AS co_clerk_7#4010, co_orderstatus#4001 AS co_orderstatus_7#4011, co_totalprice#4002 AS co_totalprice_7#4012, co_orderkey#4003 AS co_orderkey_7#4013, co_comment#4004 AS co_comment_7#4014]
               +- Relation[co_shippriority#3995,rid#3996,co_orderdate#3997,co_custkey#3998,co_orderpriority#3999,co_clerk#4000,co_orderstatus#4001,co_totalprice#4002,co_orderkey#4003,co_comment#4004] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=8716
Elapsed time: 156848ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/14 07:55:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 07:55:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4089L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 07:55:24 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 07:55:24 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 07:55:24 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 07:55:24 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 07:55:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4089L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, dexdecrypt('value_dec_key, value#1935) AS rid_1#4113]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#4103: binary
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :- Project [cp_comment#4091 AS cp_comment_0#4101, cp_name#4092 AS cp_name_0#4102, rid#4093 AS rid_0#4103, cp_type#4094 AS cp_type_0#4104, cp_retailprice#4095 AS cp_retailprice_0#4105, cp_mfgr#4096 AS cp_mfgr_0#4106, cp_container#4097 AS cp_container_0#4107, cp_brand#4098 AS cp_brand_0#4108, cp_size#4099 AS cp_size_0#4109, cp_partkey#4100 AS cp_partkey_0#4110]
         :     :  :  :  +- Relation[cp_comment#4091,cp_name#4092,rid#4093,cp_type#4094,cp_retailprice#4095,cp_mfgr#4096,cp_container#4097,cp_brand#4098,cp_size#4099,cp_partkey#4100] JDBCRelation(tpart) [numPartitions=1]
         :     :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4111]
         :     :  :     +- DexRidFilter part~p_brand~Brand#23
         :     :  :        +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4112]
         :     :     +- DexRidFilter part~p_container~MED BOX
         :     :        +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cl_returnflag#4114 AS cl_returnflag_1#4133, cl_orderkey_and_l_linenumber#4115 AS cl_orderkey_and_l_linenumber_1#4134, cl_comment#4116 AS cl_comment_1#4135, cl_linestatus#4117 AS cl_linestatus_1#4136, rid#4118 AS rid_1#4137, cl_shipmode#4119 AS cl_shipmode_1#4138, cl_shipinstruct#4120 AS cl_shipinstruct_1#4139, cl_quantity#4121 AS cl_quantity_1#4140, cl_receiptdate#4122 AS cl_receiptdate_1#4141, cl_linenumber#4123 AS cl_linenumber_1#4142, cl_tax#4124 AS cl_tax_1#4143, cl_shipdate#4125 AS cl_shipdate_1#4144, cl_extendedprice#4126 AS cl_extendedprice_1#4145, cl_partkey#4127 AS cl_partkey_1#4146, cl_discount#4128 AS cl_discount_1#4147, cl_partkey_and_l_suppkey#4129 AS cl_partkey_and_l_suppkey_1#4148, cl_commitdate#4130 AS cl_commitdate_1#4149, cl_suppkey#4131 AS cl_suppkey_1#4150, cl_orderkey#4132 AS cl_orderkey_1#4151]
            +- Relation[cl_returnflag#4114,cl_orderkey_and_l_linenumber#4115,cl_comment#4116,cl_linestatus#4117,rid#4118,cl_shipmode#4119,cl_shipinstruct#4120,cl_quantity#4121,cl_receiptdate#4122,cl_linenumber#4123,cl_tax#4124,cl_shipdate#4125,cl_extendedprice#4126,cl_partkey#4127,cl_discount#4128,cl_partkey_and_l_suppkey#4129,cl_commitdate#4130,cl_suppkey#4131,cl_orderkey#4132] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6088
Elapsed time: 28138ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/14 07:55:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 07:55:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4188L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 07:55:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 07:55:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 07:55:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 07:55:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4188L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [cs_phone#4190 AS cs_phone_0#4198, rid#4191 AS rid_0#4199, cs_address#4192 AS cs_address_0#4200, cs_nationkey#4193 AS cs_nationkey_0#4201, cs_suppkey#4194 AS cs_suppkey_0#4202, cs_name#4195 AS cs_name_0#4203, cs_acctbal#4196 AS cs_acctbal_0#4204, cs_comment#4197 AS cs_comment_0#4205]
         :  :  +- Relation[cs_phone#4190,rid#4191,cs_address#4192,cs_nationkey#4193,cs_suppkey#4194,cs_name#4195,cs_acctbal#4196,cs_comment#4197] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1935) AS rid_1#4215]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4214]
         :        :  +- Relation[cs_phone#4206,rid#4207,cs_address#4208,cs_nationkey#4209,cs_suppkey#4210,cs_name#4211,cs_acctbal#4212,cs_comment#4213] JDBCRelation(tsupplier) [numPartitions=1]
         :        +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cl_returnflag#4216 AS cl_returnflag_1#4235, cl_orderkey_and_l_linenumber#4217 AS cl_orderkey_and_l_linenumber_1#4236, cl_comment#4218 AS cl_comment_1#4237, cl_linestatus#4219 AS cl_linestatus_1#4238, rid#4220 AS rid_1#4239, cl_shipmode#4221 AS cl_shipmode_1#4240, cl_shipinstruct#4222 AS cl_shipinstruct_1#4241, cl_quantity#4223 AS cl_quantity_1#4242, cl_receiptdate#4224 AS cl_receiptdate_1#4243, cl_linenumber#4225 AS cl_linenumber_1#4244, cl_tax#4226 AS cl_tax_1#4245, cl_shipdate#4227 AS cl_shipdate_1#4246, cl_extendedprice#4228 AS cl_extendedprice_1#4247, cl_partkey#4229 AS cl_partkey_1#4248, cl_discount#4230 AS cl_discount_1#4249, cl_partkey_and_l_suppkey#4231 AS cl_partkey_and_l_suppkey_1#4250, cl_commitdate#4232 AS cl_commitdate_1#4251, cl_suppkey#4233 AS cl_suppkey_1#4252, cl_orderkey#4234 AS cl_orderkey_1#4253]
            +- Relation[cl_returnflag#4216,cl_orderkey_and_l_linenumber#4217,cl_comment#4218,cl_linestatus#4219,rid#4220,cl_shipmode#4221,cl_shipinstruct#4222,cl_quantity#4223,cl_receiptdate#4224,cl_linenumber#4225,cl_tax#4226,cl_shipdate#4227,cl_extendedprice#4228,cl_partkey#4229,cl_discount#4230,cl_partkey_and_l_suppkey#4231,cl_commitdate#4232,cl_suppkey#4233,cl_orderkey#4234] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 446706ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/14 08:03:18 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 08:03:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4290L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 08:03:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:03:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:03:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 08:03:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 08:03:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 08:03:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 08:03:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 08:03:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 08:03:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 08:03:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 08:03:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 08:03:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 08:03:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 08:03:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4290L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_4))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1935) AS rid_4#4386]
         :  :  :  :  +- 'DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, 'rid_2
         :  :  :  :     :- 'Project ['rid AS rid_2#4385]
         :  :  :  :     :  +- Relation[cps_partkey_and_ps_suppkey#4378,rid#4379,cps_availqty#4380,cps_comment#4381,cps_partkey#4382,cps_supplycost#4383,cps_suppkey#4384] JDBCRelation(tpartsupp) [numPartitions=1]
         :  :  :  :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  +- 'Join NaturalJoin(Inner)
         :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :     :  :- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1935) AS rid_3#4357]
         :  :  :     :  :  +- 'DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, 'rid_2
         :  :  :     :  :     :- 'Project ['rid AS rid_2#4356]
         :  :  :     :  :     :  +- Relation[cps_partkey_and_ps_suppkey#4349,rid#4350,cps_availqty#4351,cps_comment#4352,cps_partkey#4353,cps_supplycost#4354,cps_suppkey#4355] JDBCRelation(tpartsupp) [numPartitions=1]
         :  :  :     :  :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :  +- 'Join NaturalJoin(Inner)
         :  :  :     :     :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :     :     :  :- 'Join NaturalJoin(Inner)
         :  :  :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :     :     :  :  :  :- Project [rid#4292 AS rid_0#4297, cn_regionkey#4293 AS cn_regionkey_0#4298, cn_nationkey#4294 AS cn_nationkey_0#4299, cn_name#4295 AS cn_name_0#4300, cn_comment#4296 AS cn_comment_0#4301]
         :  :  :     :     :  :  :  :  +- Relation[rid#4292,cn_regionkey#4293,cn_nationkey#4294,cn_name#4295,cn_comment#4296] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     :     :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1935) AS rid_1#4308]
         :  :  :     :     :  :  :     +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_0
         :  :  :     :     :  :  :        :- 'Project ['rid AS rid_0#4307]
         :  :  :     :     :  :  :        :  +- Relation[rid#4302,cn_regionkey#4303,cn_nationkey#4304,cn_name#4305,cn_comment#4306] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     :     :  :  :        +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :     :  :  +- Project [cs_phone#4309 AS cs_phone_1#4317, rid#4310 AS rid_1#4318, cs_address#4311 AS cs_address_1#4319, cs_nationkey#4312 AS cs_nationkey_1#4320, cs_suppkey#4313 AS cs_suppkey_1#4321, cs_name#4314 AS cs_name_1#4322, cs_acctbal#4315 AS cs_acctbal_1#4323, cs_comment#4316 AS cs_comment_1#4324]
         :  :  :     :     :  :     +- Relation[cs_phone#4309,rid#4310,cs_address#4311,cs_nationkey#4312,cs_suppkey#4313,cs_name#4314,cs_acctbal#4315,cs_comment#4316] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     :     :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1935) AS rid_2#4334]
         :  :  :     :     :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_1
         :  :  :     :     :        :- 'Project ['rid AS rid_1#4333]
         :  :  :     :     :        :  +- Relation[cs_phone#4325,rid#4326,cs_address#4327,cs_nationkey#4328,cs_suppkey#4329,cs_name#4330,cs_acctbal#4331,cs_comment#4332] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     :     :        +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :     +- Project [cps_partkey_and_ps_suppkey#4335 AS cps_partkey_and_ps_suppkey_2#4342, rid#4336 AS rid_2#4343, cps_availqty#4337 AS cps_availqty_2#4344, cps_comment#4338 AS cps_comment_2#4345, cps_partkey#4339 AS cps_partkey_2#4346, cps_supplycost#4340 AS cps_supplycost_2#4347, cps_suppkey#4341 AS cps_suppkey_2#4348]
         :  :  :     :        +- Relation[cps_partkey_and_ps_suppkey#4335,rid#4336,cps_availqty#4337,cps_comment#4338,cps_partkey#4339,cps_supplycost#4340,cps_suppkey#4341] JDBCRelation(tpartsupp) [numPartitions=1]
         :  :  :     +- Project [cp_comment#4358 AS cp_comment_3#4368, cp_name#4359 AS cp_name_3#4369, rid#4360 AS rid_3#4370, cp_type#4361 AS cp_type_3#4371, cp_retailprice#4362 AS cp_retailprice_3#4372, cp_mfgr#4363 AS cp_mfgr_3#4373, cp_container#4364 AS cp_container_3#4374, cp_brand#4365 AS cp_brand_3#4375, cp_size#4366 AS cp_size_3#4376, cp_partkey#4367 AS cp_partkey_3#4377]
         :  :  :        +- Relation[cp_comment#4358,cp_name#4359,rid#4360,cp_type#4361,cp_retailprice#4362,cp_mfgr#4363,cp_container#4364,cp_brand#4365,cp_size#4366,cp_partkey#4367] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- Project [cl_returnflag#4387 AS cl_returnflag_4#4406, cl_orderkey_and_l_linenumber#4388 AS cl_orderkey_and_l_linenumber_4#4407, cl_comment#4389 AS cl_comment_4#4408, cl_linestatus#4390 AS cl_linestatus_4#4409, rid#4391 AS rid_4#4410, cl_shipmode#4392 AS cl_shipmode_4#4411, cl_shipinstruct#4393 AS cl_shipinstruct_4#4412, cl_quantity#4394 AS cl_quantity_4#4413, cl_receiptdate#4395 AS cl_receiptdate_4#4414, cl_linenumber#4396 AS cl_linenumber_4#4415, cl_tax#4397 AS cl_tax_4#4416, cl_shipdate#4398 AS cl_shipdate_4#4417, cl_extendedprice#4399 AS cl_extendedprice_4#4418, cl_partkey#4400 AS cl_partkey_4#4419, cl_discount#4401 AS cl_discount_4#4420, cl_partkey_and_l_suppkey#4402 AS cl_partkey_and_l_suppkey_4#4421, cl_commitdate#4403 AS cl_commitdate_4#4422, cl_suppkey#4404 AS cl_suppkey_4#4423, cl_orderkey#4405 AS cl_orderkey_4#4424]
         :  :     +- Relation[cl_returnflag#4387,cl_orderkey_and_l_linenumber#4388,cl_comment#4389,cl_linestatus#4390,rid#4391,cl_shipmode#4392,cl_shipinstruct#4393,cl_quantity#4394,cl_receiptdate#4395,cl_linenumber#4396,cl_tax#4397,cl_shipdate#4398,cl_extendedprice#4399,cl_partkey#4400,cl_discount#4401,cl_partkey_and_l_suppkey#4402,cl_commitdate#4403,cl_suppkey#4404,cl_orderkey#4405] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Project ['rid_4, dexdecrypt('value_dec_key, value#1935) AS rid_5#4445]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_4
         :        :- 'Project ['rid AS rid_4#4444]
         :        :  +- Relation[cl_returnflag#4425,cl_orderkey_and_l_linenumber#4426,cl_comment#4427,cl_linestatus#4428,rid#4429,cl_shipmode#4430,cl_shipinstruct#4431,cl_quantity#4432,cl_receiptdate#4433,cl_linenumber#4434,cl_tax#4435,cl_shipdate#4436,cl_extendedprice#4437,cl_partkey#4438,cl_discount#4439,cl_partkey_and_l_suppkey#4440,cl_commitdate#4441,cl_suppkey#4442,cl_orderkey#4443] JDBCRelation(tlineitem) [numPartitions=1]
         :        +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [co_shippriority#4446 AS co_shippriority_5#4456, rid#4447 AS rid_5#4457, co_orderdate#4448 AS co_orderdate_5#4458, co_custkey#4449 AS co_custkey_5#4459, co_orderpriority#4450 AS co_orderpriority_5#4460, co_clerk#4451 AS co_clerk_5#4461, co_orderstatus#4452 AS co_orderstatus_5#4462, co_totalprice#4453 AS co_totalprice_5#4463, co_orderkey#4454 AS co_orderkey_5#4464, co_comment#4455 AS co_comment_5#4465]
            +- Relation[co_shippriority#4446,rid#4447,co_orderdate#4448,co_custkey#4449,co_orderpriority#4450,co_clerk#4451,co_orderstatus#4452,co_totalprice#4453,co_orderkey#4454,co_comment#4455] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 711227ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/14 08:15:10 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 08:15:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4529L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 08:15:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4529L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cl_returnflag_0, 'cl_orderkey_and_l_linenumber_0, 'cl_comment_0, 'cl_linestatus_0, 'rid_0, 'cl_shipmode_0, 'cl_shipinstruct_0, 'cl_quantity_0, 'cl_receiptdate_0, 'cl_linenumber_0, 'cl_tax_0, 'cl_shipdate_0, 'cl_extendedprice_0, 'cl_partkey_0, 'cl_discount_0, 'cl_partkey_and_l_suppkey_0, 'cl_commitdate_0, 'cl_suppkey_0, 'cl_orderkey_0, dexdecrypt('value_dec_key, value#1935) AS rid_1#4570]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4554: binary
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [cl_returnflag#4531 AS cl_returnflag_0#4550, cl_orderkey_and_l_linenumber#4532 AS cl_orderkey_and_l_linenumber_0#4551, cl_comment#4533 AS cl_comment_0#4552, cl_linestatus#4534 AS cl_linestatus_0#4553, rid#4535 AS rid_0#4554, cl_shipmode#4536 AS cl_shipmode_0#4555, cl_shipinstruct#4537 AS cl_shipinstruct_0#4556, cl_quantity#4538 AS cl_quantity_0#4557, cl_receiptdate#4539 AS cl_receiptdate_0#4558, cl_linenumber#4540 AS cl_linenumber_0#4559, cl_tax#4541 AS cl_tax_0#4560, cl_shipdate#4542 AS cl_shipdate_0#4561, cl_extendedprice#4543 AS cl_extendedprice_0#4562, cl_partkey#4544 AS cl_partkey_0#4563, cl_discount#4545 AS cl_discount_0#4564, cl_partkey_and_l_suppkey#4546 AS cl_partkey_and_l_suppkey_0#4565, cl_commitdate#4547 AS cl_commitdate_0#4566, cl_suppkey#4548 AS cl_suppkey_0#4567, cl_orderkey#4549 AS cl_orderkey_0#4568]
         :     :  :  +- Relation[cl_returnflag#4531,cl_orderkey_and_l_linenumber#4532,cl_comment#4533,cl_linestatus#4534,rid#4535,cl_shipmode#4536,cl_shipinstruct#4537,cl_quantity#4538,cl_receiptdate#4539,cl_linenumber#4540,cl_tax#4541,cl_shipdate#4542,cl_extendedprice#4543,cl_partkey#4544,cl_discount#4545,cl_partkey_and_l_suppkey#4546,cl_commitdate#4547,cl_suppkey#4548,cl_orderkey#4549] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4569]
         :     :     +- DexRidFilter lineitem~l_shipmode~MAIL
         :     :        +- Relation[label#1931,value#1932] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1934,value#1935] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [co_shippriority#4571 AS co_shippriority_1#4581, rid#4572 AS rid_1#4582, co_orderdate#4573 AS co_orderdate_1#4583, co_custkey#4574 AS co_custkey_1#4584, co_orderpriority#4575 AS co_orderpriority_1#4585, co_clerk#4576 AS co_clerk_1#4586, co_orderstatus#4577 AS co_orderstatus_1#4587, co_totalprice#4578 AS co_totalprice_1#4588, co_orderkey#4579 AS co_orderkey_1#4589, co_comment#4580 AS co_comment_1#4590]
            +- Relation[co_shippriority#4571,rid#4572,co_orderdate#4573,co_custkey#4574,co_orderpriority#4575,co_clerk#4576,co_orderstatus#4577,co_totalprice#4578,co_orderkey#4579,co_comment#4580] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 171140ms
query=q1, count=6001215, duration=7253
query=q10, count=1478870, duration=459464
query=q11, count=31680, duration=2730
query=q12, count=857401, duration=171140
query=q13, count=1550004, duration=117472
query=q14, count=6001215, duration=223057
query=q15, count=6001215, duration=446706
query=q16, count=15780, duration=19376
query=q17, count=6088, duration=28138
query=q18, count=6001215, duration=2512204
query=q19, count=205, duration=469703
query=q2, count=3162, duration=19303
query=q20, count=324, duration=3494
query=q21a, count=119924, duration=1439986
query=q3, count=1214743, duration=86072
query=q4, count=6001215, duration=233285
query=q6, count=6001215, duration=19501
query=q7, count=9735, duration=57106
query=q8, count=8716, duration=156848
query=q9a, count=6001215, duration=935585
query=q9b, count=6001215, duration=711227
