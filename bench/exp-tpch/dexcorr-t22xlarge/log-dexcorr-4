20/04/14 04:26:09 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 15063ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Tue Apr 14 04:26:14 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Tue Apr 14 04:26:16 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Tue Apr 14 04:26:16 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Tue Apr 14 04:26:16 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Tue Apr 14 04:26:17 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Tue Apr 14 04:26:22 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Tue Apr 14 04:26:27 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Tue Apr 14 04:26:27 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/14 04:26:29 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 04:26:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1908L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/14 04:26:30 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 04:26:30 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 04:26:30 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 04:26:30 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 04:26:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 04:26:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 04:26:30 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 04:26:30 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 04:26:30 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 04:26:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1908L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(LeftSemi)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Project ['rid_2, 'cn_regionkey_2, 'cn_nationkey_2, 'cn_name_2, 'cn_comment_2, dexdecrypt('value_dec_key, value#1934) AS rid_3#1962]
         :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_2#1956: binary
         :  :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
         :  :     :  :- Project [rid#1951 AS rid_2#1956, cn_regionkey#1952 AS cn_regionkey_2#1957, cn_nationkey#1953 AS cn_nationkey_2#1958, cn_name#1954 AS cn_name_2#1959, cn_comment#1955 AS cn_comment_2#1960]
         :  :     :  :  +- Relation[rid#1951,cn_regionkey#1952,cn_nationkey#1953,cn_name#1954,cn_comment#1955] JDBCRelation(tnation) [numPartitions=1]
         :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#1961]
         :  :     :     +- DexRidFilter nation~n_name~CANADA
         :  :     :        +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]
         :  :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  +- Project [cs_phone#1963 AS cs_phone_3#1971, rid#1964 AS rid_3#1972, cs_address#1965 AS cs_address_3#1973, cs_nationkey#1966 AS cs_nationkey_3#1974, cs_suppkey#1967 AS cs_suppkey_3#1975, cs_name#1968 AS cs_name_3#1976, cs_acctbal#1969 AS cs_acctbal_3#1977, cs_comment#1970 AS cs_comment_3#1978]
         :     +- Relation[cs_phone#1963,rid#1964,cs_address#1965,cs_nationkey#1966,cs_suppkey#1967,cs_name#1968,cs_acctbal#1969,cs_comment#1970] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'Project ['cps_partkey_and_ps_suppkey_1, 'rid_1, 'cps_availqty_1, 'cps_comment_1, 'cps_partkey_1, 'cps_supplycost_1, 'cps_suppkey_1, dexdecrypt('value_dec_key, value#1934) AS rid_3#1950]
            +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, rid_1#1944: binary
               :- 'Join NaturalJoin(LeftSemi)
               :  :- Project [cps_partkey_and_ps_suppkey#1936 AS cps_partkey_and_ps_suppkey_1#1943, rid#1937 AS rid_1#1944, cps_availqty#1938 AS cps_availqty_1#1945, cps_comment#1939 AS cps_comment_1#1946, cps_partkey#1940 AS cps_partkey_1#1947, cps_supplycost#1941 AS cps_supplycost_1#1948, cps_suppkey#1942 AS cps_suppkey_1#1949]
               :  :  +- Relation[cps_partkey_and_ps_suppkey#1936,rid#1937,cps_availqty#1938,cps_comment#1939,cps_partkey#1940,cps_supplycost#1941,cps_suppkey#1942] JDBCRelation(tpartsupp) [numPartitions=1]
               :  +- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, dexdecrypt('value_dec_key, value#1934) AS rid_1#1935]
               :     +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#1922: binary
               :        :- 'Join UsingJoin(LeftSemi,List(rid_0))
               :        :  :- Project [cp_comment#1910 AS cp_comment_0#1920, cp_name#1911 AS cp_name_0#1921, rid#1912 AS rid_0#1922, cp_type#1913 AS cp_type_0#1923, cp_retailprice#1914 AS cp_retailprice_0#1924, cp_mfgr#1915 AS cp_mfgr_0#1925, cp_container#1916 AS cp_container_0#1926, cp_brand#1917 AS cp_brand_0#1927, cp_size#1918 AS cp_size_0#1928, cp_partkey#1919 AS cp_partkey_0#1929]
               :        :  :  +- Relation[cp_comment#1910,cp_name#1911,rid#1912,cp_type#1913,cp_retailprice#1914,cp_mfgr#1915,cp_container#1916,cp_brand#1917,cp_size#1918,cp_partkey#1919] JDBCRelation(tpart) [numPartitions=1]
               :        :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1932]
               :        :     +- DexRidFilter part~p_size~15
               :        :        +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]
               :        +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
               +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]

DexCorr$ result size=324
Elapsed time: 19953ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/14 04:26:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 04:26:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1998L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/14 04:26:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 04:26:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 04:26:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 04:26:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 04:26:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 04:26:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 04:26:49 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 04:26:49 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 04:26:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1998L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'cn_regionkey_0, 'cn_nationkey_0, 'cn_name_0, 'cn_comment_0, 'rid_1, 'cs_phone_1, 'cs_address_1, 'cs_nationkey_1, 'cs_suppkey_1, 'cs_name_1, 'cs_acctbal_1, 'cs_comment_1, dexdecrypt('value_dec_key, value#1934) AS rid_2#2028]
         :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'cn_regionkey_0, 'cn_nationkey_0, 'cn_name_0, 'cn_comment_0, dexdecrypt('value_dec_key, value#1934) AS rid_1#2011]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#2005: binary
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#2000 AS rid_0#2005, cn_regionkey#2001 AS cn_regionkey_0#2006, cn_nationkey#2002 AS cn_nationkey_0#2007, cn_name#2003 AS cn_name_0#2008, cn_comment#2004 AS cn_comment_0#2009]
         :     :  :     :  :  +- Relation[rid#2000,cn_regionkey#2001,cn_nationkey#2002,cn_name#2003,cn_comment#2004] JDBCRelation(tnation) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2010]
         :     :  :     :     +- DexRidFilter nation~n_name~GERMANY
         :     :  :     :        +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [cs_phone#2012 AS cs_phone_1#2020, rid#2013 AS rid_1#2021, cs_address#2014 AS cs_address_1#2022, cs_nationkey#2015 AS cs_nationkey_1#2023, cs_suppkey#2016 AS cs_suppkey_1#2024, cs_name#2017 AS cs_name_1#2025, cs_acctbal#2018 AS cs_acctbal_1#2026, cs_comment#2019 AS cs_comment_1#2027]
         :     :     +- Relation[cs_phone#2012,rid#2013,cs_address#2014,cs_nationkey#2015,cs_suppkey#2016,cs_name#2017,cs_acctbal#2018,cs_comment#2019] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cps_partkey_and_ps_suppkey#2029 AS cps_partkey_and_ps_suppkey_2#2036, rid#2030 AS rid_2#2037, cps_availqty#2031 AS cps_availqty_2#2038, cps_comment#2032 AS cps_comment_2#2039, cps_partkey#2033 AS cps_partkey_2#2040, cps_supplycost#2034 AS cps_supplycost_2#2041, cps_suppkey#2035 AS cps_suppkey_2#2042]
            +- Relation[cps_partkey_and_ps_suppkey#2029,rid#2030,cps_availqty#2031,cps_comment#2032,cps_partkey#2033,cps_supplycost#2034,cps_suppkey#2035] JDBCRelation(tpartsupp) [numPartitions=1]

DexCorr$ result size=31680
Elapsed time: 6481ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/14 04:26:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 04:26:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2070L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/14 04:26:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 04:26:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 04:26:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2070L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, dexdecrypt('value_dec_key, value#1934) AS rid_1#2093]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2084: binary
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [cp_comment#2072 AS cp_comment_0#2082, cp_name#2073 AS cp_name_0#2083, rid#2074 AS rid_0#2084, cp_type#2075 AS cp_type_0#2085, cp_retailprice#2076 AS cp_retailprice_0#2086, cp_mfgr#2077 AS cp_mfgr_0#2087, cp_container#2078 AS cp_container_0#2088, cp_brand#2079 AS cp_brand_0#2089, cp_size#2080 AS cp_size_0#2090, cp_partkey#2081 AS cp_partkey_0#2091]
         :     :  :  +- Relation[cp_comment#2072,cp_name#2073,rid#2074,cp_type#2075,cp_retailprice#2076,cp_mfgr#2077,cp_container#2078,cp_brand#2079,cp_size#2080,cp_partkey#2081] JDBCRelation(tpart) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2092]
         :     :     +- DexRidFilter part~p_size~49
         :     :        +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cps_partkey_and_ps_suppkey#2094 AS cps_partkey_and_ps_suppkey_1#2101, rid#2095 AS rid_1#2102, cps_availqty#2096 AS cps_availqty_1#2103, cps_comment#2097 AS cps_comment_1#2104, cps_partkey#2098 AS cps_partkey_1#2105, cps_supplycost#2099 AS cps_supplycost_1#2106, cps_suppkey#2100 AS cps_suppkey_1#2107]
            +- Relation[cps_partkey_and_ps_suppkey#2094,rid#2095,cps_availqty#2096,cps_comment#2097,cps_partkey#2098,cps_supplycost#2099,cps_suppkey#2100] JDBCRelation(tpartsupp) [numPartitions=1]

DexCorr$ result size=15780
Elapsed time: 3633ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/14 04:26:59 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 04:26:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2153L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 04:26:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2153L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [cl_returnflag#2155 AS cl_returnflag_0#2174, cl_orderkey_and_l_linenumber#2156 AS cl_orderkey_and_l_linenumber_0#2175, cl_comment#2157 AS cl_comment_0#2176, cl_linestatus#2158 AS cl_linestatus_0#2177, rid#2159 AS rid_0#2178, cl_shipmode#2160 AS cl_shipmode_0#2179, cl_shipinstruct#2161 AS cl_shipinstruct_0#2180, cl_quantity#2162 AS cl_quantity_0#2181, cl_receiptdate#2163 AS cl_receiptdate_0#2182, cl_linenumber#2164 AS cl_linenumber_0#2183, cl_tax#2165 AS cl_tax_0#2184, cl_shipdate#2166 AS cl_shipdate_0#2185, cl_extendedprice#2167 AS cl_extendedprice_0#2186, cl_partkey#2168 AS cl_partkey_0#2187, cl_discount#2169 AS cl_discount_0#2188, cl_partkey_and_l_suppkey#2170 AS cl_partkey_and_l_suppkey_0#2189, cl_commitdate#2171 AS cl_commitdate_0#2190, cl_suppkey#2172 AS cl_suppkey_0#2191, cl_orderkey#2173 AS cl_orderkey_0#2192]
         :  :  +- Relation[cl_returnflag#2155,cl_orderkey_and_l_linenumber#2156,cl_comment#2157,cl_linestatus#2158,rid#2159,cl_shipmode#2160,cl_shipinstruct#2161,cl_quantity#2162,cl_receiptdate#2163,cl_linenumber#2164,cl_tax#2165,cl_shipdate#2166,cl_extendedprice#2167,cl_partkey#2168,cl_discount#2169,cl_partkey_and_l_suppkey#2170,cl_commitdate#2171,cl_suppkey#2172,cl_orderkey#2173] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1934) AS rid_1#2213]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2212]
         :        :  +- Relation[cl_returnflag#2193,cl_orderkey_and_l_linenumber#2194,cl_comment#2195,cl_linestatus#2196,rid#2197,cl_shipmode#2198,cl_shipinstruct#2199,cl_quantity#2200,cl_receiptdate#2201,cl_linenumber#2202,cl_tax#2203,cl_shipdate#2204,cl_extendedprice#2205,cl_partkey#2206,cl_discount#2207,cl_partkey_and_l_suppkey#2208,cl_commitdate#2209,cl_suppkey#2210,cl_orderkey#2211] JDBCRelation(tlineitem) [numPartitions=1]
         :        +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [co_shippriority#2214 AS co_shippriority_1#2224, rid#2215 AS rid_1#2225, co_orderdate#2216 AS co_orderdate_1#2226, co_custkey#2217 AS co_custkey_1#2227, co_orderpriority#2218 AS co_orderpriority_1#2228, co_clerk#2219 AS co_clerk_1#2229, co_orderstatus#2220 AS co_orderstatus_1#2230, co_totalprice#2221 AS co_totalprice_1#2231, co_orderkey#2222 AS co_orderkey_1#2232, co_comment#2223 AS co_comment_1#2233]
            +- Relation[co_shippriority#2214,rid#2215,co_orderdate#2216,co_custkey#2217,co_orderpriority#2218,co_clerk#2219,co_orderstatus#2220,co_totalprice#2221,co_orderkey#2222,co_comment#2223] JDBCRelation(torders) [numPartitions=1]

20/04/14 04:26:59 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=6001215
Elapsed time: 277163ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/14 04:31:36 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 04:31:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2268L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 04:31:36 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 04:31:36 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 04:31:36 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 04:31:36 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 04:31:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2268L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, dexdecrypt('value_dec_key, value#1934) AS rid_1#2292]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2282: binary
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :- Project [cp_comment#2270 AS cp_comment_0#2280, cp_name#2271 AS cp_name_0#2281, rid#2272 AS rid_0#2282, cp_type#2273 AS cp_type_0#2283, cp_retailprice#2274 AS cp_retailprice_0#2284, cp_mfgr#2275 AS cp_mfgr_0#2285, cp_container#2276 AS cp_container_0#2286, cp_brand#2277 AS cp_brand_0#2287, cp_size#2278 AS cp_size_0#2288, cp_partkey#2279 AS cp_partkey_0#2289]
         :     :  :  :  +- Relation[cp_comment#2270,cp_name#2271,rid#2272,cp_type#2273,cp_retailprice#2274,cp_mfgr#2275,cp_container#2276,cp_brand#2277,cp_size#2278,cp_partkey#2279] JDBCRelation(tpart) [numPartitions=1]
         :     :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2290]
         :     :  :     +- DexRidFilter part~p_brand~Brand#12
         :     :  :        +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2291]
         :     :     +- DexRidFilter part~p_container~SM CASE
         :     :        +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [cl_returnflag#2293 AS cl_returnflag_1#2312, cl_orderkey_and_l_linenumber#2294 AS cl_orderkey_and_l_linenumber_1#2313, cl_comment#2295 AS cl_comment_1#2314, cl_linestatus#2296 AS cl_linestatus_1#2315, rid#2297 AS rid_1#2316, cl_shipmode#2298 AS cl_shipmode_1#2317, cl_shipinstruct#2299 AS cl_shipinstruct_1#2318, cl_quantity#2300 AS cl_quantity_1#2319, cl_receiptdate#2301 AS cl_receiptdate_1#2320, cl_linenumber#2302 AS cl_linenumber_1#2321, cl_tax#2303 AS cl_tax_1#2322, cl_shipdate#2304 AS cl_shipdate_1#2323, cl_extendedprice#2305 AS cl_extendedprice_1#2324, cl_partkey#2306 AS cl_partkey_1#2325, cl_discount#2307 AS cl_discount_1#2326, cl_partkey_and_l_suppkey#2308 AS cl_partkey_and_l_suppkey_1#2327, cl_commitdate#2309 AS cl_commitdate_1#2328, cl_suppkey#2310 AS cl_suppkey_1#2329, cl_orderkey#2311 AS cl_orderkey_1#2330]
            :  :  +- Relation[cl_returnflag#2293,cl_orderkey_and_l_linenumber#2294,cl_comment#2295,cl_linestatus#2296,rid#2297,cl_shipmode#2298,cl_shipinstruct#2299,cl_quantity#2300,cl_receiptdate#2301,cl_linenumber#2302,cl_tax#2303,cl_shipdate#2304,cl_extendedprice#2305,cl_partkey#2306,cl_discount#2307,cl_partkey_and_l_suppkey#2308,cl_commitdate#2309,cl_suppkey#2310,cl_orderkey#2311] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2331]
            :     +- DexRidFilter lineitem~l_shipmode~AIR
            :        +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2332]
               +- DexRidFilter lineitem~l_shipinstruct~DELIVER IN PERSON
                  +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=205
Elapsed time: 141554ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/14 04:33:58 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 04:33:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2366L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/14 04:33:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2366L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(RightOuter)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [co_shippriority#2368 AS co_shippriority_0#2378, rid#2369 AS rid_0#2379, co_orderdate#2370 AS co_orderdate_0#2380, co_custkey#2371 AS co_custkey_0#2381, co_orderpriority#2372 AS co_orderpriority_0#2382, co_clerk#2373 AS co_clerk_0#2383, co_orderstatus#2374 AS co_orderstatus_0#2384, co_totalprice#2375 AS co_totalprice_0#2385, co_orderkey#2376 AS co_orderkey_0#2386, co_comment#2377 AS co_comment_0#2387]
         :  :  +- Relation[co_shippriority#2368,rid#2369,co_orderdate#2370,co_custkey#2371,co_orderpriority#2372,co_clerk#2373,co_orderstatus#2374,co_totalprice#2375,co_orderkey#2376,co_comment#2377] JDBCRelation(torders) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1934) AS rid_1#2399]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2398]
         :        :  +- Relation[co_shippriority#2388,rid#2389,co_orderdate#2390,co_custkey#2391,co_orderpriority#2392,co_clerk#2393,co_orderstatus#2394,co_totalprice#2395,co_orderkey#2396,co_comment#2397] JDBCRelation(torders) [numPartitions=1]
         :        +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cc_acctbal#2400 AS cc_acctbal_1#2409, rid#2401 AS rid_1#2410, cc_name#2402 AS cc_name_1#2411, cc_nationkey#2403 AS cc_nationkey_1#2412, cc_custkey#2404 AS cc_custkey_1#2413, cc_comment#2405 AS cc_comment_1#2414, cc_address#2406 AS cc_address_1#2415, cc_mktsegment#2407 AS cc_mktsegment_1#2416, cc_phone#2408 AS cc_phone_1#2417]
            +- Relation[cc_acctbal#2400,rid#2401,cc_name#2402,cc_nationkey#2403,cc_custkey#2404,cc_comment#2405,cc_address#2406,cc_mktsegment#2407,cc_phone#2408] JDBCRelation(tcustomer) [numPartitions=1]

DexCorr$ result size=1550004
Elapsed time: 197012ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/14 04:37:15 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 04:37:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2442L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 04:37:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#2442L]
+- Project
   +- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- Project [cl_returnflag#2444 AS cl_returnflag_0#2463, cl_orderkey_and_l_linenumber#2445 AS cl_orderkey_and_l_linenumber_0#2464, cl_comment#2446 AS cl_comment_0#2465, cl_linestatus#2447 AS cl_linestatus_0#2466, rid#2448 AS rid_0#2467, cl_shipmode#2449 AS cl_shipmode_0#2468, cl_shipinstruct#2450 AS cl_shipinstruct_0#2469, cl_quantity#2451 AS cl_quantity_0#2470, cl_receiptdate#2452 AS cl_receiptdate_0#2471, cl_linenumber#2453 AS cl_linenumber_0#2472, cl_tax#2454 AS cl_tax_0#2473, cl_shipdate#2455 AS cl_shipdate_0#2474, cl_extendedprice#2456 AS cl_extendedprice_0#2475, cl_partkey#2457 AS cl_partkey_0#2476, cl_discount#2458 AS cl_discount_0#2477, cl_partkey_and_l_suppkey#2459 AS cl_partkey_and_l_suppkey_0#2478, cl_commitdate#2460 AS cl_commitdate_0#2479, cl_suppkey#2461 AS cl_suppkey_0#2480, cl_orderkey#2462 AS cl_orderkey_0#2481]
         +- Relation[cl_returnflag#2444,cl_orderkey_and_l_linenumber#2445,cl_comment#2446,cl_linestatus#2447,rid#2448,cl_shipmode#2449,cl_shipinstruct#2450,cl_quantity#2451,cl_receiptdate#2452,cl_linenumber#2453,cl_tax#2454,cl_shipdate#2455,cl_extendedprice#2456,cl_partkey#2457,cl_discount#2458,cl_partkey_and_l_suppkey#2459,cl_commitdate#2460,cl_suppkey#2461,cl_orderkey#2462] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 8801ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/14 04:37:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 04:37:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2505L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 04:37:24 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 04:37:24 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 04:37:24 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 04:37:24 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 04:37:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2505L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, dexdecrypt('value_dec_key, value#1934) AS rid_1#2529]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2519: binary
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :- Project [cp_comment#2507 AS cp_comment_0#2517, cp_name#2508 AS cp_name_0#2518, rid#2509 AS rid_0#2519, cp_type#2510 AS cp_type_0#2520, cp_retailprice#2511 AS cp_retailprice_0#2521, cp_mfgr#2512 AS cp_mfgr_0#2522, cp_container#2513 AS cp_container_0#2523, cp_brand#2514 AS cp_brand_0#2524, cp_size#2515 AS cp_size_0#2525, cp_partkey#2516 AS cp_partkey_0#2526]
         :     :  :  :  +- Relation[cp_comment#2507,cp_name#2508,rid#2509,cp_type#2510,cp_retailprice#2511,cp_mfgr#2512,cp_container#2513,cp_brand#2514,cp_size#2515,cp_partkey#2516] JDBCRelation(tpart) [numPartitions=1]
         :     :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2527]
         :     :  :     +- DexRidFilter part~p_brand~Brand#23
         :     :  :        +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2528]
         :     :     +- DexRidFilter part~p_container~MED BOX
         :     :        +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cl_returnflag#2530 AS cl_returnflag_1#2549, cl_orderkey_and_l_linenumber#2531 AS cl_orderkey_and_l_linenumber_1#2550, cl_comment#2532 AS cl_comment_1#2551, cl_linestatus#2533 AS cl_linestatus_1#2552, rid#2534 AS rid_1#2553, cl_shipmode#2535 AS cl_shipmode_1#2554, cl_shipinstruct#2536 AS cl_shipinstruct_1#2555, cl_quantity#2537 AS cl_quantity_1#2556, cl_receiptdate#2538 AS cl_receiptdate_1#2557, cl_linenumber#2539 AS cl_linenumber_1#2558, cl_tax#2540 AS cl_tax_1#2559, cl_shipdate#2541 AS cl_shipdate_1#2560, cl_extendedprice#2542 AS cl_extendedprice_1#2561, cl_partkey#2543 AS cl_partkey_1#2562, cl_discount#2544 AS cl_discount_1#2563, cl_partkey_and_l_suppkey#2545 AS cl_partkey_and_l_suppkey_1#2564, cl_commitdate#2546 AS cl_commitdate_1#2565, cl_suppkey#2547 AS cl_suppkey_1#2566, cl_orderkey#2548 AS cl_orderkey_1#2567]
            +- Relation[cl_returnflag#2530,cl_orderkey_and_l_linenumber#2531,cl_comment#2532,cl_linestatus#2533,rid#2534,cl_shipmode#2535,cl_shipinstruct#2536,cl_quantity#2537,cl_receiptdate#2538,cl_linenumber#2539,cl_tax#2540,cl_shipdate#2541,cl_extendedprice#2542,cl_partkey#2543,cl_discount#2544,cl_partkey_and_l_suppkey#2545,cl_commitdate#2546,cl_suppkey#2547,cl_orderkey#2548] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6088
Elapsed time: 1129ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/14 04:37:25 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 04:37:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2602L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 04:37:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#2602L]
+- Project
   +- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- Project [cl_returnflag#2604 AS cl_returnflag_0#2623, cl_orderkey_and_l_linenumber#2605 AS cl_orderkey_and_l_linenumber_0#2624, cl_comment#2606 AS cl_comment_0#2625, cl_linestatus#2607 AS cl_linestatus_0#2626, rid#2608 AS rid_0#2627, cl_shipmode#2609 AS cl_shipmode_0#2628, cl_shipinstruct#2610 AS cl_shipinstruct_0#2629, cl_quantity#2611 AS cl_quantity_0#2630, cl_receiptdate#2612 AS cl_receiptdate_0#2631, cl_linenumber#2613 AS cl_linenumber_0#2632, cl_tax#2614 AS cl_tax_0#2633, cl_shipdate#2615 AS cl_shipdate_0#2634, cl_extendedprice#2616 AS cl_extendedprice_0#2635, cl_partkey#2617 AS cl_partkey_0#2636, cl_discount#2618 AS cl_discount_0#2637, cl_partkey_and_l_suppkey#2619 AS cl_partkey_and_l_suppkey_0#2638, cl_commitdate#2620 AS cl_commitdate_0#2639, cl_suppkey#2621 AS cl_suppkey_0#2640, cl_orderkey#2622 AS cl_orderkey_0#2641]
         +- Relation[cl_returnflag#2604,cl_orderkey_and_l_linenumber#2605,cl_comment#2606,cl_linestatus#2607,rid#2608,cl_shipmode#2609,cl_shipinstruct#2610,cl_quantity#2611,cl_receiptdate#2612,cl_linenumber#2613,cl_tax#2614,cl_shipdate#2615,cl_extendedprice#2616,cl_partkey#2617,cl_discount#2618,cl_partkey_and_l_suppkey#2619,cl_commitdate#2620,cl_suppkey#2621,cl_orderkey#2622] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 3412ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/14 04:37:28 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 04:37:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2665L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 04:37:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2665L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cl_returnflag_0, 'cl_orderkey_and_l_linenumber_0, 'cl_comment_0, 'cl_linestatus_0, 'rid_0, 'cl_shipmode_0, 'cl_shipinstruct_0, 'cl_quantity_0, 'cl_receiptdate_0, 'cl_linenumber_0, 'cl_tax_0, 'cl_shipdate_0, 'cl_extendedprice_0, 'cl_partkey_0, 'cl_discount_0, 'cl_partkey_and_l_suppkey_0, 'cl_commitdate_0, 'cl_suppkey_0, 'cl_orderkey_0, dexdecrypt('value_dec_key, value#1934) AS rid_1#2706]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2690: binary
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [cl_returnflag#2667 AS cl_returnflag_0#2686, cl_orderkey_and_l_linenumber#2668 AS cl_orderkey_and_l_linenumber_0#2687, cl_comment#2669 AS cl_comment_0#2688, cl_linestatus#2670 AS cl_linestatus_0#2689, rid#2671 AS rid_0#2690, cl_shipmode#2672 AS cl_shipmode_0#2691, cl_shipinstruct#2673 AS cl_shipinstruct_0#2692, cl_quantity#2674 AS cl_quantity_0#2693, cl_receiptdate#2675 AS cl_receiptdate_0#2694, cl_linenumber#2676 AS cl_linenumber_0#2695, cl_tax#2677 AS cl_tax_0#2696, cl_shipdate#2678 AS cl_shipdate_0#2697, cl_extendedprice#2679 AS cl_extendedprice_0#2698, cl_partkey#2680 AS cl_partkey_0#2699, cl_discount#2681 AS cl_discount_0#2700, cl_partkey_and_l_suppkey#2682 AS cl_partkey_and_l_suppkey_0#2701, cl_commitdate#2683 AS cl_commitdate_0#2702, cl_suppkey#2684 AS cl_suppkey_0#2703, cl_orderkey#2685 AS cl_orderkey_0#2704]
         :     :  :  +- Relation[cl_returnflag#2667,cl_orderkey_and_l_linenumber#2668,cl_comment#2669,cl_linestatus#2670,rid#2671,cl_shipmode#2672,cl_shipinstruct#2673,cl_quantity#2674,cl_receiptdate#2675,cl_linenumber#2676,cl_tax#2677,cl_shipdate#2678,cl_extendedprice#2679,cl_partkey#2680,cl_discount#2681,cl_partkey_and_l_suppkey#2682,cl_commitdate#2683,cl_suppkey#2684,cl_orderkey#2685] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2705]
         :     :     +- DexRidFilter lineitem~l_shipmode~MAIL
         :     :        +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [co_shippriority#2707 AS co_shippriority_1#2717, rid#2708 AS rid_1#2718, co_orderdate#2709 AS co_orderdate_1#2719, co_custkey#2710 AS co_custkey_1#2720, co_orderpriority#2711 AS co_orderpriority_1#2721, co_clerk#2712 AS co_clerk_1#2722, co_orderstatus#2713 AS co_orderstatus_1#2723, co_totalprice#2714 AS co_totalprice_1#2724, co_orderkey#2715 AS co_orderkey_1#2725, co_comment#2716 AS co_comment_1#2726]
            +- Relation[co_shippriority#2707,rid#2708,co_orderdate#2709,co_custkey#2710,co_orderpriority#2711,co_clerk#2712,co_orderstatus#2713,co_totalprice#2714,co_orderkey#2715,co_comment#2716] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 81190ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/14 04:38:49 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 04:38:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2760L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1766L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1766L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1764L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1764L, l_suppkey#1766L]
               :     :        +- Relation[l_orderkey#1764L,l_partkey#1765L,l_suppkey#1766L,l_linenumber#1767,l_quantity#1768,l_extendedprice#1769,l_discount#1770,l_tax#1771,l_returnflag#1772,l_linestatus#1773,l_commitdate#1774,l_receiptdate#1775,l_shipinstruct#1776,l_shipmode#1777,l_comment#1778,l_shipdate#1779] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/14 04:38:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 04:38:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 04:38:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 04:38:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 04:38:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 04:38:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 04:38:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2760L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(LeftSemi)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Project ['co_shippriority_1, 'rid_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, 'co_clerk_1, 'co_orderstatus_1, 'co_totalprice_1, 'co_orderkey_1, 'co_comment_1, 'rid_2, 'cl_returnflag_2, 'cl_orderkey_and_l_linenumber_2, 'cl_comment_2, 'cl_linestatus_2, 'cl_shipmode_2, 'cl_shipinstruct_2, 'cl_quantity_2, 'cl_receiptdate_2, 'cl_linenumber_2, 'cl_tax_2, 'cl_shipdate_2, 'cl_extendedprice_2, 'cl_partkey_2, ... 14 more fields]
         :  :  +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_3
         :  :     :- 'Join NaturalJoin(Inner)
         :  :     :  :- 'Project ['co_shippriority_1, 'rid_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, 'co_clerk_1, 'co_orderstatus_1, 'co_totalprice_1, 'co_orderkey_1, 'co_comment_1, 'rid_2, 'cl_returnflag_2, 'cl_orderkey_and_l_linenumber_2, 'cl_comment_2, 'cl_linestatus_2, 'cl_shipmode_2, 'cl_shipinstruct_2, 'cl_quantity_2, 'cl_receiptdate_2, 'cl_linenumber_2, 'cl_tax_2, 'cl_shipdate_2, 'cl_extendedprice_2, 'cl_partkey_2, ... 6 more fields]
         :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_2
         :  :     :  :     :- 'Join NaturalJoin(Inner)
         :  :     :  :     :  :- 'Project ['co_shippriority_1, 'rid_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, 'co_clerk_1, 'co_orderstatus_1, 'co_totalprice_1, 'co_orderkey_1, 'co_comment_1, dexdecrypt('value_dec_key, value#1934) AS rid_2#2842]
         :  :     :  :     :  :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#2832: binary
         :  :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :     :  :     :  :     :  :- Project [co_shippriority#2821 AS co_shippriority_1#2831, rid#2822 AS rid_1#2832, co_orderdate#2823 AS co_orderdate_1#2833, co_custkey#2824 AS co_custkey_1#2834, co_orderpriority#2825 AS co_orderpriority_1#2835, co_clerk#2826 AS co_clerk_1#2836, co_orderstatus#2827 AS co_orderstatus_1#2837, co_totalprice#2828 AS co_totalprice_1#2838, co_orderkey#2829 AS co_orderkey_1#2839, co_comment#2830 AS co_comment_1#2840]
         :  :     :  :     :  :     :  :  +- Relation[co_shippriority#2821,rid#2822,co_orderdate#2823,co_custkey#2824,co_orderpriority#2825,co_clerk#2826,co_orderstatus#2827,co_totalprice#2828,co_orderkey#2829,co_comment#2830] JDBCRelation(torders) [numPartitions=1]
         :  :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2841]
         :  :     :  :     :  :     :     +- DexRidFilter orders~o_orderstatus~F
         :  :     :  :     :  :     :        +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]
         :  :     :  :     :  :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :     :  :     :  +- Project [cl_returnflag#2843 AS cl_returnflag_2#2862, cl_orderkey_and_l_linenumber#2844 AS cl_orderkey_and_l_linenumber_2#2863, cl_comment#2845 AS cl_comment_2#2864, cl_linestatus#2846 AS cl_linestatus_2#2865, rid#2847 AS rid_2#2866, cl_shipmode#2848 AS cl_shipmode_2#2867, cl_shipinstruct#2849 AS cl_shipinstruct_2#2868, cl_quantity#2850 AS cl_quantity_2#2869, cl_receiptdate#2851 AS cl_receiptdate_2#2870, cl_linenumber#2852 AS cl_linenumber_2#2871, cl_tax#2853 AS cl_tax_2#2872, cl_shipdate#2854 AS cl_shipdate_2#2873, cl_extendedprice#2855 AS cl_extendedprice_2#2874, cl_partkey#2856 AS cl_partkey_2#2875, cl_discount#2857 AS cl_discount_2#2876, cl_partkey_and_l_suppkey#2858 AS cl_partkey_and_l_suppkey_2#2877, cl_commitdate#2859 AS cl_commitdate_2#2878, cl_suppkey#2860 AS cl_suppkey_2#2879, cl_orderkey#2861 AS cl_orderkey_2#2880]
         :  :     :  :     :     +- Relation[cl_returnflag#2843,cl_orderkey_and_l_linenumber#2844,cl_comment#2845,cl_linestatus#2846,rid#2847,cl_shipmode#2848,cl_shipinstruct#2849,cl_quantity#2850,cl_receiptdate#2851,cl_linenumber#2852,cl_tax#2853,cl_shipdate#2854,cl_extendedprice#2855,cl_partkey#2856,cl_discount#2857,cl_partkey_and_l_suppkey#2858,cl_commitdate#2859,cl_suppkey#2860,cl_orderkey#2861] JDBCRelation(tlineitem) [numPartitions=1]
         :  :     :  :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :     :  +- Project [cs_phone#2882 AS cs_phone_3#2890, rid#2883 AS rid_3#2891, cs_address#2884 AS cs_address_3#2892, cs_nationkey#2885 AS cs_nationkey_3#2893, cs_suppkey#2886 AS cs_suppkey_3#2894, cs_name#2887 AS cs_name_3#2895, cs_acctbal#2888 AS cs_acctbal_3#2896, cs_comment#2889 AS cs_comment_3#2897]
         :  :     :     +- Relation[cs_phone#2882,rid#2883,cs_address#2884,cs_nationkey#2885,cs_suppkey#2886,cs_name#2887,cs_acctbal#2888,cs_comment#2889] JDBCRelation(tsupplier) [numPartitions=1]
         :  :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  +- 'Join UsingJoin(LeftSemi,List(rid_4))
         :     :- Project [rid#2899 AS rid_4#2904, cn_regionkey#2900 AS cn_regionkey_4#2905, cn_nationkey#2901 AS cn_nationkey_4#2906, cn_name#2902 AS cn_name_4#2907, cn_comment#2903 AS cn_comment_4#2908]
         :     :  +- Relation[rid#2899,cn_regionkey#2900,cn_nationkey#2901,cn_name#2902,cn_comment#2903] JDBCRelation(tnation) [numPartitions=1]
         :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_4#2909]
         :        +- DexRidFilter nation~n_name~SAUDI ARABIA
         :           +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_0))
            :- Project [cl_returnflag#2762 AS cl_returnflag_0#2781, cl_orderkey_and_l_linenumber#2763 AS cl_orderkey_and_l_linenumber_0#2782, cl_comment#2764 AS cl_comment_0#2783, cl_linestatus#2765 AS cl_linestatus_0#2784, rid#2766 AS rid_0#2785, cl_shipmode#2767 AS cl_shipmode_0#2786, cl_shipinstruct#2768 AS cl_shipinstruct_0#2787, cl_quantity#2769 AS cl_quantity_0#2788, cl_receiptdate#2770 AS cl_receiptdate_0#2789, cl_linenumber#2771 AS cl_linenumber_0#2790, cl_tax#2772 AS cl_tax_0#2791, cl_shipdate#2773 AS cl_shipdate_0#2792, cl_extendedprice#2774 AS cl_extendedprice_0#2793, cl_partkey#2775 AS cl_partkey_0#2794, cl_discount#2776 AS cl_discount_0#2795, cl_partkey_and_l_suppkey#2777 AS cl_partkey_and_l_suppkey_0#2796, cl_commitdate#2778 AS cl_commitdate_0#2797, cl_suppkey#2779 AS cl_suppkey_0#2798, cl_orderkey#2780 AS cl_orderkey_0#2799]
            :  +- Relation[cl_returnflag#2762,cl_orderkey_and_l_linenumber#2763,cl_comment#2764,cl_linestatus#2765,rid#2766,cl_shipmode#2767,cl_shipinstruct#2768,cl_quantity#2769,cl_receiptdate#2770,cl_linenumber#2771,cl_tax#2772,cl_shipdate#2773,cl_extendedprice#2774,cl_partkey#2775,cl_discount#2776,cl_partkey_and_l_suppkey#2777,cl_commitdate#2778,cl_suppkey#2779,cl_orderkey#2780] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1934) AS rid_1#2820]
               +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
                  :- 'Project ['rid AS rid_0#2819]
                  :  +- Relation[cl_returnflag#2800,cl_orderkey_and_l_linenumber#2801,cl_comment#2802,cl_linestatus#2803,rid#2804,cl_shipmode#2805,cl_shipinstruct#2806,cl_quantity#2807,cl_receiptdate#2808,cl_linenumber#2809,cl_tax#2810,cl_shipdate#2811,cl_extendedprice#2812,cl_partkey#2813,cl_discount#2814,cl_partkey_and_l_suppkey#2815,cl_commitdate#2816,cl_suppkey#2817,cl_orderkey#2818] JDBCRelation(tlineitem) [numPartitions=1]
                  +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]

DexCorr$ result size=119924
Elapsed time: 744375ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/14 04:51:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 04:51:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2961L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 04:51:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 04:51:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 04:51:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 04:51:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 04:51:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 04:51:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 04:51:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 04:51:14 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 04:51:14 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 04:51:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2961L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :  :  :  :  :- Project [rid#2963 AS rid_0#2968, cn_regionkey#2964 AS cn_regionkey_0#2969, cn_nationkey#2965 AS cn_nationkey_0#2970, cn_name#2966 AS cn_name_0#2971, cn_comment#2967 AS cn_comment_0#2972]
         :  :  :  :  :  :  :  :  :  :  +- Relation[rid#2963,cn_regionkey#2964,cn_nationkey#2965,cn_name#2966,cn_comment#2967] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1934) AS rid_1#2979]
         :  :  :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_0
         :  :  :  :  :  :  :  :  :        :- 'Project ['rid AS rid_0#2978]
         :  :  :  :  :  :  :  :  :        :  +- Relation[rid#2973,cn_regionkey#2974,cn_nationkey#2975,cn_name#2976,cn_comment#2977] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  :  :  :  :  :        +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  :  :  +- Project [cs_phone#2980 AS cs_phone_1#2988, rid#2981 AS rid_1#2989, cs_address#2982 AS cs_address_1#2990, cs_nationkey#2983 AS cs_nationkey_1#2991, cs_suppkey#2984 AS cs_suppkey_1#2992, cs_name#2985 AS cs_name_1#2993, cs_acctbal#2986 AS cs_acctbal_1#2994, cs_comment#2987 AS cs_comment_1#2995]
         :  :  :  :  :  :  :  :     +- Relation[cs_phone#2980,rid#2981,cs_address#2982,cs_nationkey#2983,cs_suppkey#2984,cs_name#2985,cs_acctbal#2986,cs_comment#2987] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :  :  :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1934) AS rid_2#3005]
         :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_1
         :  :  :  :  :  :  :        :- 'Project ['rid AS rid_1#3004]
         :  :  :  :  :  :  :        :  +- Relation[cs_phone#2996,rid#2997,cs_address#2998,cs_nationkey#2999,cs_suppkey#3000,cs_name#3001,cs_acctbal#3002,cs_comment#3003] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :  :  :  :  :        +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  +- Project [cl_returnflag#3006 AS cl_returnflag_2#3025, cl_orderkey_and_l_linenumber#3007 AS cl_orderkey_and_l_linenumber_2#3026, cl_comment#3008 AS cl_comment_2#3027, cl_linestatus#3009 AS cl_linestatus_2#3028, rid#3010 AS rid_2#3029, cl_shipmode#3011 AS cl_shipmode_2#3030, cl_shipinstruct#3012 AS cl_shipinstruct_2#3031, cl_quantity#3013 AS cl_quantity_2#3032, cl_receiptdate#3014 AS cl_receiptdate_2#3033, cl_linenumber#3015 AS cl_linenumber_2#3034, cl_tax#3016 AS cl_tax_2#3035, cl_shipdate#3017 AS cl_shipdate_2#3036, cl_extendedprice#3018 AS cl_extendedprice_2#3037, cl_partkey#3019 AS cl_partkey_2#3038, cl_discount#3020 AS cl_discount_2#3039, cl_partkey_and_l_suppkey#3021 AS cl_partkey_and_l_suppkey_2#3040, cl_commitdate#3022 AS cl_commitdate_2#3041, cl_suppkey#3023 AS cl_suppkey_2#3042, cl_orderkey#3024 AS cl_orderkey_2#3043]
         :  :  :  :  :  :     +- Relation[cl_returnflag#3006,cl_orderkey_and_l_linenumber#3007,cl_comment#3008,cl_linestatus#3009,rid#3010,cl_shipmode#3011,cl_shipinstruct#3012,cl_quantity#3013,cl_receiptdate#3014,cl_linenumber#3015,cl_tax#3016,cl_shipdate#3017,cl_extendedprice#3018,cl_partkey#3019,cl_discount#3020,cl_partkey_and_l_suppkey#3021,cl_commitdate#3022,cl_suppkey#3023,cl_orderkey#3024] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1934) AS rid_3#3064]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_2
         :  :  :  :  :        :- 'Project ['rid AS rid_2#3063]
         :  :  :  :  :        :  +- Relation[cl_returnflag#3044,cl_orderkey_and_l_linenumber#3045,cl_comment#3046,cl_linestatus#3047,rid#3048,cl_shipmode#3049,cl_shipinstruct#3050,cl_quantity#3051,cl_receiptdate#3052,cl_linenumber#3053,cl_tax#3054,cl_shipdate#3055,cl_extendedprice#3056,cl_partkey#3057,cl_discount#3058,cl_partkey_and_l_suppkey#3059,cl_commitdate#3060,cl_suppkey#3061,cl_orderkey#3062] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [cp_comment#3065 AS cp_comment_3#3075, cp_name#3066 AS cp_name_3#3076, rid#3067 AS rid_3#3077, cp_type#3068 AS cp_type_3#3078, cp_retailprice#3069 AS cp_retailprice_3#3079, cp_mfgr#3070 AS cp_mfgr_3#3080, cp_container#3071 AS cp_container_3#3081, cp_brand#3072 AS cp_brand_3#3082, cp_size#3073 AS cp_size_3#3083, cp_partkey#3074 AS cp_partkey_3#3084]
         :  :  :  :     +- Relation[cp_comment#3065,cp_name#3066,rid#3067,cp_type#3068,cp_retailprice#3069,cp_mfgr#3070,cp_container#3071,cp_brand#3072,cp_size#3073,cp_partkey#3074] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1934) AS rid_4#3105]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey_and_l_suppkey~partsupp~ps_partkey_and_ps_suppkey, 'rid_2
         :  :  :        :- 'Project ['rid AS rid_2#3104]
         :  :  :        :  +- Relation[cl_returnflag#3085,cl_orderkey_and_l_linenumber#3086,cl_comment#3087,cl_linestatus#3088,rid#3089,cl_shipmode#3090,cl_shipinstruct#3091,cl_quantity#3092,cl_receiptdate#3093,cl_linenumber#3094,cl_tax#3095,cl_shipdate#3096,cl_extendedprice#3097,cl_partkey#3098,cl_discount#3099,cl_partkey_and_l_suppkey#3100,cl_commitdate#3101,cl_suppkey#3102,cl_orderkey#3103] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :        +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [cps_partkey_and_ps_suppkey#3106 AS cps_partkey_and_ps_suppkey_4#3113, rid#3107 AS rid_4#3114, cps_availqty#3108 AS cps_availqty_4#3115, cps_comment#3109 AS cps_comment_4#3116, cps_partkey#3110 AS cps_partkey_4#3117, cps_supplycost#3111 AS cps_supplycost_4#3118, cps_suppkey#3112 AS cps_suppkey_4#3119]
         :  :     +- Relation[cps_partkey_and_ps_suppkey#3106,rid#3107,cps_availqty#3108,cps_comment#3109,cps_partkey#3110,cps_supplycost#3111,cps_suppkey#3112] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1934) AS rid_5#3140]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#3139]
         :        :  +- Relation[cl_returnflag#3120,cl_orderkey_and_l_linenumber#3121,cl_comment#3122,cl_linestatus#3123,rid#3124,cl_shipmode#3125,cl_shipinstruct#3126,cl_quantity#3127,cl_receiptdate#3128,cl_linenumber#3129,cl_tax#3130,cl_shipdate#3131,cl_extendedprice#3132,cl_partkey#3133,cl_discount#3134,cl_partkey_and_l_suppkey#3135,cl_commitdate#3136,cl_suppkey#3137,cl_orderkey#3138] JDBCRelation(tlineitem) [numPartitions=1]
         :        +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [co_shippriority#3141 AS co_shippriority_5#3151, rid#3142 AS rid_5#3152, co_orderdate#3143 AS co_orderdate_5#3153, co_custkey#3144 AS co_custkey_5#3154, co_orderpriority#3145 AS co_orderpriority_5#3155, co_clerk#3146 AS co_clerk_5#3156, co_orderstatus#3147 AS co_orderstatus_5#3157, co_totalprice#3148 AS co_totalprice_5#3158, co_orderkey#3149 AS co_orderkey_5#3159, co_comment#3150 AS co_comment_5#3160]
            +- Relation[co_shippriority#3141,rid#3142,co_orderdate#3143,co_custkey#3144,co_orderpriority#3145,co_clerk#3146,co_orderstatus#3147,co_totalprice#3148,co_orderkey#3149,co_comment#3150] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 1103290ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/14 05:09:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 05:09:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3224L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/14 05:09:37 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 05:09:37 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 05:09:37 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 05:09:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 05:09:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 05:09:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 05:09:37 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 05:09:37 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 05:09:37 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 05:09:37 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 05:09:37 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 05:09:37 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 05:09:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3224L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cr_regionkey_0, 'cr_name_0, 'cr_comment_0, 'rid_0, 'rid_1, 'cn_regionkey_1, 'cn_nationkey_1, 'cn_name_1, 'cn_comment_1, 'rid_2, 'cs_phone_2, 'cs_address_2, 'cs_nationkey_2, 'cs_suppkey_2, 'cs_name_2, 'cs_acctbal_2, 'cs_comment_2, dexdecrypt('value_dec_key, value#1934) AS rid_4#3263]
         :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['cr_regionkey_0, 'cr_name_0, 'cr_comment_0, 'rid_0, 'rid_1, 'cn_regionkey_1, 'cn_nationkey_1, 'cn_name_1, 'cn_comment_1, dexdecrypt('value_dec_key, value#1934) AS rid_2#3246]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['cr_regionkey_0, 'cr_name_0, 'cr_comment_0, 'rid_0, dexdecrypt('value_dec_key, value#1934) AS rid_1#3235]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#3233: binary
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [cr_regionkey#3226 AS cr_regionkey_0#3230, cr_name#3227 AS cr_name_0#3231, cr_comment#3228 AS cr_comment_0#3232, rid#3229 AS rid_0#3233]
         :     :  :     :  :     :  :  +- Relation[cr_regionkey#3226,cr_name#3227,cr_comment#3228,rid#3229] JDBCRelation(tregion) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3234]
         :     :  :     :  :     :     +- DexRidFilter region~r_name~EUROPE
         :     :  :     :  :     :        +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [rid#3236 AS rid_1#3241, cn_regionkey#3237 AS cn_regionkey_1#3242, cn_nationkey#3238 AS cn_nationkey_1#3243, cn_name#3239 AS cn_name_1#3244, cn_comment#3240 AS cn_comment_1#3245]
         :     :  :     :     +- Relation[rid#3236,cn_regionkey#3237,cn_nationkey#3238,cn_name#3239,cn_comment#3240] JDBCRelation(tnation) [numPartitions=1]
         :     :  :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [cs_phone#3247 AS cs_phone_2#3255, rid#3248 AS rid_2#3256, cs_address#3249 AS cs_address_2#3257, cs_nationkey#3250 AS cs_nationkey_2#3258, cs_suppkey#3251 AS cs_suppkey_2#3259, cs_name#3252 AS cs_name_2#3260, cs_acctbal#3253 AS cs_acctbal_2#3261, cs_comment#3254 AS cs_comment_2#3262]
         :     :     +- Relation[cs_phone#3247,rid#3248,cs_address#3249,cs_nationkey#3250,cs_suppkey#3251,cs_name#3252,cs_acctbal#3253,cs_comment#3254] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['cp_comment_3, 'cp_name_3, 'rid_3, 'cp_type_3, 'cp_retailprice_3, 'cp_mfgr_3, 'cp_container_3, 'cp_brand_3, 'cp_size_3, 'cp_partkey_3, dexdecrypt('value_dec_key, value#1934) AS rid_4#3285]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_3#3276: binary
            :     :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :     :  :- Project [cp_comment#3264 AS cp_comment_3#3274, cp_name#3265 AS cp_name_3#3275, rid#3266 AS rid_3#3276, cp_type#3267 AS cp_type_3#3277, cp_retailprice#3268 AS cp_retailprice_3#3278, cp_mfgr#3269 AS cp_mfgr_3#3279, cp_container#3270 AS cp_container_3#3280, cp_brand#3271 AS cp_brand_3#3281, cp_size#3272 AS cp_size_3#3282, cp_partkey#3273 AS cp_partkey_3#3283]
            :     :  :  +- Relation[cp_comment#3264,cp_name#3265,rid#3266,cp_type#3267,cp_retailprice#3268,cp_mfgr#3269,cp_container#3270,cp_brand#3271,cp_size#3272,cp_partkey#3273] JDBCRelation(tpart) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#3284]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [cps_partkey_and_ps_suppkey#3286 AS cps_partkey_and_ps_suppkey_4#3293, rid#3287 AS rid_4#3294, cps_availqty#3288 AS cps_availqty_4#3295, cps_comment#3289 AS cps_comment_4#3296, cps_partkey#3290 AS cps_partkey_4#3297, cps_supplycost#3291 AS cps_supplycost_4#3298, cps_suppkey#3292 AS cps_suppkey_4#3299]
               +- Relation[cps_partkey_and_ps_suppkey#3286,rid#3287,cps_availqty#3288,cps_comment#3289,cps_partkey#3290,cps_supplycost#3291,cps_suppkey#3292] JDBCRelation(tpartsupp) [numPartitions=1]

DexCorr$ result size=3162
Elapsed time: 10410ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/14 05:09:47 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 05:09:47 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3340L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 05:09:47 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3340L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [cp_comment#3342 AS cp_comment_0#3352, cp_name#3343 AS cp_name_0#3353, rid#3344 AS rid_0#3354, cp_type#3345 AS cp_type_0#3355, cp_retailprice#3346 AS cp_retailprice_0#3356, cp_mfgr#3347 AS cp_mfgr_0#3357, cp_container#3348 AS cp_container_0#3358, cp_brand#3349 AS cp_brand_0#3359, cp_size#3350 AS cp_size_0#3360, cp_partkey#3351 AS cp_partkey_0#3361]
         :  :  +- Relation[cp_comment#3342,cp_name#3343,rid#3344,cp_type#3345,cp_retailprice#3346,cp_mfgr#3347,cp_container#3348,cp_brand#3349,cp_size#3350,cp_partkey#3351] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1934) AS rid_1#3373]
         :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3372]
         :        :  +- Relation[cp_comment#3362,cp_name#3363,rid#3364,cp_type#3365,cp_retailprice#3366,cp_mfgr#3367,cp_container#3368,cp_brand#3369,cp_size#3370,cp_partkey#3371] JDBCRelation(tpart) [numPartitions=1]
         :        +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cl_returnflag#3374 AS cl_returnflag_1#3393, cl_orderkey_and_l_linenumber#3375 AS cl_orderkey_and_l_linenumber_1#3394, cl_comment#3376 AS cl_comment_1#3395, cl_linestatus#3377 AS cl_linestatus_1#3396, rid#3378 AS rid_1#3397, cl_shipmode#3379 AS cl_shipmode_1#3398, cl_shipinstruct#3380 AS cl_shipinstruct_1#3399, cl_quantity#3381 AS cl_quantity_1#3400, cl_receiptdate#3382 AS cl_receiptdate_1#3401, cl_linenumber#3383 AS cl_linenumber_1#3402, cl_tax#3384 AS cl_tax_1#3403, cl_shipdate#3385 AS cl_shipdate_1#3404, cl_extendedprice#3386 AS cl_extendedprice_1#3405, cl_partkey#3387 AS cl_partkey_1#3406, cl_discount#3388 AS cl_discount_1#3407, cl_partkey_and_l_suppkey#3389 AS cl_partkey_and_l_suppkey_1#3408, cl_commitdate#3390 AS cl_commitdate_1#3409, cl_suppkey#3391 AS cl_suppkey_1#3410, cl_orderkey#3392 AS cl_orderkey_1#3411]
            +- Relation[cl_returnflag#3374,cl_orderkey_and_l_linenumber#3375,cl_comment#3376,cl_linestatus#3377,rid#3378,cl_shipmode#3379,cl_shipinstruct#3380,cl_quantity#3381,cl_receiptdate#3382,cl_linenumber#3383,cl_tax#3384,cl_shipdate#3385,cl_extendedprice#3386,cl_partkey#3387,cl_discount#3388,cl_partkey_and_l_suppkey#3389,cl_commitdate#3390,cl_suppkey#3391,cl_orderkey#3392] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 167011ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/14 05:12:34 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 05:12:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3448L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 05:12:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 05:12:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 05:12:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 05:12:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3448L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [cs_phone#3450 AS cs_phone_0#3458, rid#3451 AS rid_0#3459, cs_address#3452 AS cs_address_0#3460, cs_nationkey#3453 AS cs_nationkey_0#3461, cs_suppkey#3454 AS cs_suppkey_0#3462, cs_name#3455 AS cs_name_0#3463, cs_acctbal#3456 AS cs_acctbal_0#3464, cs_comment#3457 AS cs_comment_0#3465]
         :  :  +- Relation[cs_phone#3450,rid#3451,cs_address#3452,cs_nationkey#3453,cs_suppkey#3454,cs_name#3455,cs_acctbal#3456,cs_comment#3457] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1934) AS rid_1#3475]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3474]
         :        :  +- Relation[cs_phone#3466,rid#3467,cs_address#3468,cs_nationkey#3469,cs_suppkey#3470,cs_name#3471,cs_acctbal#3472,cs_comment#3473] JDBCRelation(tsupplier) [numPartitions=1]
         :        +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cl_returnflag#3476 AS cl_returnflag_1#3495, cl_orderkey_and_l_linenumber#3477 AS cl_orderkey_and_l_linenumber_1#3496, cl_comment#3478 AS cl_comment_1#3497, cl_linestatus#3479 AS cl_linestatus_1#3498, rid#3480 AS rid_1#3499, cl_shipmode#3481 AS cl_shipmode_1#3500, cl_shipinstruct#3482 AS cl_shipinstruct_1#3501, cl_quantity#3483 AS cl_quantity_1#3502, cl_receiptdate#3484 AS cl_receiptdate_1#3503, cl_linenumber#3485 AS cl_linenumber_1#3504, cl_tax#3486 AS cl_tax_1#3505, cl_shipdate#3487 AS cl_shipdate_1#3506, cl_extendedprice#3488 AS cl_extendedprice_1#3507, cl_partkey#3489 AS cl_partkey_1#3508, cl_discount#3490 AS cl_discount_1#3509, cl_partkey_and_l_suppkey#3491 AS cl_partkey_and_l_suppkey_1#3510, cl_commitdate#3492 AS cl_commitdate_1#3511, cl_suppkey#3493 AS cl_suppkey_1#3512, cl_orderkey#3494 AS cl_orderkey_1#3513]
            +- Relation[cl_returnflag#3476,cl_orderkey_and_l_linenumber#3477,cl_comment#3478,cl_linestatus#3479,rid#3480,cl_shipmode#3481,cl_shipinstruct#3482,cl_quantity#3483,cl_receiptdate#3484,cl_linenumber#3485,cl_tax#3486,cl_shipdate#3487,cl_extendedprice#3488,cl_partkey#3489,cl_discount#3490,cl_partkey_and_l_suppkey#3491,cl_commitdate#3492,cl_suppkey#3493,cl_orderkey#3494] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 150645ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/14 05:15:05 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 05:15:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3548L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#810L = c_nationkey#293L)
               :     :- Project [n_nationkey#810L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#812L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#810L, n_regionkey#812L]
               :     :        +- Relation[n_nationkey#810L,n_name#811,n_regionkey#812L,n_comment#813] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 05:15:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 05:15:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 05:15:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 05:15:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 05:15:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 05:15:05 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 05:15:05 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 05:15:05 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 05:15:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 05:15:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 05:15:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 05:15:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3548L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, 'rid_1, 'cl_returnflag_1, 'cl_orderkey_and_l_linenumber_1, 'cl_comment_1, 'cl_linestatus_1, 'cl_shipmode_1, 'cl_shipinstruct_1, 'cl_quantity_1, 'cl_receiptdate_1, 'cl_linenumber_1, 'cl_tax_1, 'cl_shipdate_1, 'cl_extendedprice_1, 'cl_partkey_1, ... 19 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, 'rid_1, 'cl_returnflag_1, 'cl_orderkey_and_l_linenumber_1, 'cl_comment_1, 'cl_linestatus_1, 'cl_shipmode_1, 'cl_shipinstruct_1, 'cl_quantity_1, 'cl_receiptdate_1, 'cl_linenumber_1, 'cl_tax_1, 'cl_shipdate_1, 'cl_extendedprice_1, 'cl_partkey_1, ... 14 more fields]
         :     :  :  +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_2
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, 'rid_1, 'cl_returnflag_1, 'cl_orderkey_and_l_linenumber_1, 'cl_comment_1, 'cl_linestatus_1, 'cl_shipmode_1, 'cl_shipinstruct_1, 'cl_quantity_1, 'cl_receiptdate_1, 'cl_linenumber_1, 'cl_tax_1, 'cl_shipdate_1, 'cl_extendedprice_1, 'cl_partkey_1, ... 6 more fields]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :  :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :     :  :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, dexdecrypt('value_dec_key, value#1934) AS rid_1#3571]
         :     :  :     :  :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3562: binary
         :     :  :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :     :  :- Project [cp_comment#3550 AS cp_comment_0#3560, cp_name#3551 AS cp_name_0#3561, rid#3552 AS rid_0#3562, cp_type#3553 AS cp_type_0#3563, cp_retailprice#3554 AS cp_retailprice_0#3564, cp_mfgr#3555 AS cp_mfgr_0#3565, cp_container#3556 AS cp_container_0#3566, cp_brand#3557 AS cp_brand_0#3567, cp_size#3558 AS cp_size_0#3568, cp_partkey#3559 AS cp_partkey_0#3569]
         :     :  :     :  :     :  :     :  :  +- Relation[cp_comment#3550,cp_name#3551,rid#3552,cp_type#3553,cp_retailprice#3554,cp_mfgr#3555,cp_container#3556,cp_brand#3557,cp_size#3558,cp_partkey#3559] JDBCRelation(tpart) [numPartitions=1]
         :     :  :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3570]
         :     :  :     :  :     :  :     :     +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
         :     :  :     :  :     :  :     :        +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     :  :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  :     :  +- Project [cl_returnflag#3572 AS cl_returnflag_1#3591, cl_orderkey_and_l_linenumber#3573 AS cl_orderkey_and_l_linenumber_1#3592, cl_comment#3574 AS cl_comment_1#3593, cl_linestatus#3575 AS cl_linestatus_1#3594, rid#3576 AS rid_1#3595, cl_shipmode#3577 AS cl_shipmode_1#3596, cl_shipinstruct#3578 AS cl_shipinstruct_1#3597, cl_quantity#3579 AS cl_quantity_1#3598, cl_receiptdate#3580 AS cl_receiptdate_1#3599, cl_linenumber#3581 AS cl_linenumber_1#3600, cl_tax#3582 AS cl_tax_1#3601, cl_shipdate#3583 AS cl_shipdate_1#3602, cl_extendedprice#3584 AS cl_extendedprice_1#3603, cl_partkey#3585 AS cl_partkey_1#3604, cl_discount#3586 AS cl_discount_1#3605, cl_partkey_and_l_suppkey#3587 AS cl_partkey_and_l_suppkey_1#3606, cl_commitdate#3588 AS cl_commitdate_1#3607, cl_suppkey#3589 AS cl_suppkey_1#3608, cl_orderkey#3590 AS cl_orderkey_1#3609]
         :     :  :     :  :     :     +- Relation[cl_returnflag#3572,cl_orderkey_and_l_linenumber#3573,cl_comment#3574,cl_linestatus#3575,rid#3576,cl_shipmode#3577,cl_shipinstruct#3578,cl_quantity#3579,cl_receiptdate#3580,cl_linenumber#3581,cl_tax#3582,cl_shipdate#3583,cl_extendedprice#3584,cl_partkey#3585,cl_discount#3586,cl_partkey_and_l_suppkey#3587,cl_commitdate#3588,cl_suppkey#3589,cl_orderkey#3590] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [cs_phone#3611 AS cs_phone_2#3619, rid#3612 AS rid_2#3620, cs_address#3613 AS cs_address_2#3621, cs_nationkey#3614 AS cs_nationkey_2#3622, cs_suppkey#3615 AS cs_suppkey_2#3623, cs_name#3616 AS cs_name_2#3624, cs_acctbal#3617 AS cs_acctbal_2#3625, cs_comment#3618 AS cs_comment_2#3626]
         :     :  :     :     +- Relation[cs_phone#3611,rid#3612,cs_address#3613,cs_nationkey#3614,cs_suppkey#3615,cs_name#3616,cs_acctbal#3617,cs_comment#3618] JDBCRelation(tsupplier) [numPartitions=1]
         :     :  :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [rid#3628 AS rid_3#3633, cn_regionkey#3629 AS cn_regionkey_3#3634, cn_nationkey#3630 AS cn_nationkey_3#3635, cn_name#3631 AS cn_name_3#3636, cn_comment#3632 AS cn_comment_3#3637]
         :     :     +- Relation[rid#3628,cn_regionkey#3629,cn_nationkey#3630,cn_name#3631,cn_comment#3632] JDBCRelation(tnation) [numPartitions=1]
         :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['cr_regionkey_4, 'cr_name_4, 'cr_comment_4, 'rid_4, 'rid_5, 'cn_regionkey_5, 'cn_nationkey_5, 'cn_name_5, 'cn_comment_5, 'rid_6, 'cc_acctbal_6, 'cc_name_6, 'cc_nationkey_6, 'cc_custkey_6, 'cc_comment_6, 'cc_address_6, 'cc_mktsegment_6, 'cc_phone_6, dexdecrypt('value_dec_key, value#1934) AS rid_7#3678]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_6
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['cr_regionkey_4, 'cr_name_4, 'cr_comment_4, 'rid_4, 'rid_5, 'cn_regionkey_5, 'cn_nationkey_5, 'cn_name_5, 'cn_comment_5, dexdecrypt('value_dec_key, value#1934) AS rid_6#3659]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_5
            :     :  :     :- 'Join NaturalJoin(Inner)
            :     :  :     :  :- 'Project ['cr_regionkey_4, 'cr_name_4, 'cr_comment_4, 'rid_4, dexdecrypt('value_dec_key, value#1934) AS rid_5#3648]
            :     :  :     :  :  +- 'DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_4#3646: binary
            :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_4))
            :     :  :     :  :     :  :- Project [cr_regionkey#3639 AS cr_regionkey_4#3643, cr_name#3640 AS cr_name_4#3644, cr_comment#3641 AS cr_comment_4#3645, rid#3642 AS rid_4#3646]
            :     :  :     :  :     :  :  +- Relation[cr_regionkey#3639,cr_name#3640,cr_comment#3641,rid#3642] JDBCRelation(tregion) [numPartitions=1]
            :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_4#3647]
            :     :  :     :  :     :     +- DexRidFilter region~r_name~AMERICA
            :     :  :     :  :     :        +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     :  :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  :     :  +- Project [rid#3649 AS rid_5#3654, cn_regionkey#3650 AS cn_regionkey_5#3655, cn_nationkey#3651 AS cn_nationkey_5#3656, cn_name#3652 AS cn_name_5#3657, cn_comment#3653 AS cn_comment_5#3658]
            :     :  :     :     +- Relation[rid#3649,cn_regionkey#3650,cn_nationkey#3651,cn_name#3652,cn_comment#3653] JDBCRelation(tnation) [numPartitions=1]
            :     :  :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [cc_acctbal#3660 AS cc_acctbal_6#3669, rid#3661 AS rid_6#3670, cc_name#3662 AS cc_name_6#3671, cc_nationkey#3663 AS cc_nationkey_6#3672, cc_custkey#3664 AS cc_custkey_6#3673, cc_comment#3665 AS cc_comment_6#3674, cc_address#3666 AS cc_address_6#3675, cc_mktsegment#3667 AS cc_mktsegment_6#3676, cc_phone#3668 AS cc_phone_6#3677]
            :     :     +- Relation[cc_acctbal#3660,rid#3661,cc_name#3662,cc_nationkey#3663,cc_custkey#3664,cc_comment#3665,cc_address#3666,cc_mktsegment#3667,cc_phone#3668] JDBCRelation(tcustomer) [numPartitions=1]
            :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [co_shippriority#3679 AS co_shippriority_7#3689, rid#3680 AS rid_7#3690, co_orderdate#3681 AS co_orderdate_7#3691, co_custkey#3682 AS co_custkey_7#3692, co_orderpriority#3683 AS co_orderpriority_7#3693, co_clerk#3684 AS co_clerk_7#3694, co_orderstatus#3685 AS co_orderstatus_7#3695, co_totalprice#3686 AS co_totalprice_7#3696, co_orderkey#3687 AS co_orderkey_7#3697, co_comment#3688 AS co_comment_7#3698]
               +- Relation[co_shippriority#3679,rid#3680,co_orderdate#3681,co_custkey#3682,co_orderpriority#3683,co_clerk#3684,co_orderstatus#3685,co_totalprice#3686,co_orderkey#3687,co_comment#3688] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=8716
Elapsed time: 37990ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/14 05:15:43 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 05:15:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3778L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 05:15:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3778L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [cc_acctbal#3780 AS cc_acctbal_0#3789, rid#3781 AS rid_0#3790, cc_name#3782 AS cc_name_0#3791, cc_nationkey#3783 AS cc_nationkey_0#3792, cc_custkey#3784 AS cc_custkey_0#3793, cc_comment#3785 AS cc_comment_0#3794, cc_address#3786 AS cc_address_0#3795, cc_mktsegment#3787 AS cc_mktsegment_0#3796, cc_phone#3788 AS cc_phone_0#3797]
         :  :  :  :  +- Relation[cc_acctbal#3780,rid#3781,cc_name#3782,cc_nationkey#3783,cc_custkey#3784,cc_comment#3785,cc_address#3786,cc_mktsegment#3787,cc_phone#3788] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1934) AS rid_1#3808]
         :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#3807]
         :  :  :        :  +- Relation[cc_acctbal#3798,rid#3799,cc_name#3800,cc_nationkey#3801,cc_custkey#3802,cc_comment#3803,cc_address#3804,cc_mktsegment#3805,cc_phone#3806] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :        +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [co_shippriority#3809 AS co_shippriority_1#3819, rid#3810 AS rid_1#3820, co_orderdate#3811 AS co_orderdate_1#3821, co_custkey#3812 AS co_custkey_1#3822, co_orderpriority#3813 AS co_orderpriority_1#3823, co_clerk#3814 AS co_clerk_1#3824, co_orderstatus#3815 AS co_orderstatus_1#3825, co_totalprice#3816 AS co_totalprice_1#3826, co_orderkey#3817 AS co_orderkey_1#3827, co_comment#3818 AS co_comment_1#3828]
         :  :     +- Relation[co_shippriority#3809,rid#3810,co_orderdate#3811,co_custkey#3812,co_orderpriority#3813,co_clerk#3814,co_orderstatus#3815,co_totalprice#3816,co_orderkey#3817,co_comment#3818] JDBCRelation(torders) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1934) AS rid_2#3840]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3839]
         :        :  +- Relation[co_shippriority#3829,rid#3830,co_orderdate#3831,co_custkey#3832,co_orderpriority#3833,co_clerk#3834,co_orderstatus#3835,co_totalprice#3836,co_orderkey#3837,co_comment#3838] JDBCRelation(torders) [numPartitions=1]
         :        +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cl_returnflag#3841 AS cl_returnflag_2#3860, cl_orderkey_and_l_linenumber#3842 AS cl_orderkey_and_l_linenumber_2#3861, cl_comment#3843 AS cl_comment_2#3862, cl_linestatus#3844 AS cl_linestatus_2#3863, rid#3845 AS rid_2#3864, cl_shipmode#3846 AS cl_shipmode_2#3865, cl_shipinstruct#3847 AS cl_shipinstruct_2#3866, cl_quantity#3848 AS cl_quantity_2#3867, cl_receiptdate#3849 AS cl_receiptdate_2#3868, cl_linenumber#3850 AS cl_linenumber_2#3869, cl_tax#3851 AS cl_tax_2#3870, cl_shipdate#3852 AS cl_shipdate_2#3871, cl_extendedprice#3853 AS cl_extendedprice_2#3872, cl_partkey#3854 AS cl_partkey_2#3873, cl_discount#3855 AS cl_discount_2#3874, cl_partkey_and_l_suppkey#3856 AS cl_partkey_and_l_suppkey_2#3875, cl_commitdate#3857 AS cl_commitdate_2#3876, cl_suppkey#3858 AS cl_suppkey_2#3877, cl_orderkey#3859 AS cl_orderkey_2#3878]
            +- Relation[cl_returnflag#3841,cl_orderkey_and_l_linenumber#3842,cl_comment#3843,cl_linestatus#3844,rid#3845,cl_shipmode#3846,cl_shipinstruct#3847,cl_quantity#3848,cl_receiptdate#3849,cl_linenumber#3850,cl_tax#3851,cl_shipdate#3852,cl_extendedprice#3853,cl_partkey#3854,cl_discount#3855,cl_partkey_and_l_suppkey#3856,cl_commitdate#3857,cl_suppkey#3858,cl_orderkey#3859] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 1852792ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/14 05:46:36 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 05:46:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3925L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#612L = c_nationkey#293L)
               :     :- Project [n_nationkey#612L]
               :     :  +- Filter (n_name#613 = GERMANY)
               :     :     +- Relation[n_nationkey#612L,n_name#613,n_regionkey#614L,n_comment#615] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 05:46:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 05:46:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 05:46:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 05:46:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 05:46:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 05:46:36 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 05:46:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 05:46:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 05:46:36 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 05:46:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3925L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'cn_regionkey_0, 'cn_nationkey_0, 'cn_name_0, 'cn_comment_0, 'rid_1, 'cs_phone_1, 'cs_address_1, 'cs_nationkey_1, 'cs_suppkey_1, 'cs_name_1, 'cs_acctbal_1, 'cs_comment_1, 'rid_2, 'cl_returnflag_2, 'cl_orderkey_and_l_linenumber_2, 'cl_comment_2, 'cl_linestatus_2, 'cl_shipmode_2, 'cl_shipinstruct_2, 'cl_quantity_2, 'cl_receiptdate_2, 'cl_linenumber_2, 'cl_tax_2, ... 9 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'cn_regionkey_0, 'cn_nationkey_0, 'cn_name_0, 'cn_comment_0, 'rid_1, 'cs_phone_1, 'cs_address_1, 'cs_nationkey_1, 'cs_suppkey_1, 'cs_name_1, 'cs_acctbal_1, 'cs_comment_1, dexdecrypt('value_dec_key, value#1934) AS rid_2#3955]
         :     :  :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['rid_0, 'cn_regionkey_0, 'cn_nationkey_0, 'cn_name_0, 'cn_comment_0, dexdecrypt('value_dec_key, value#1934) AS rid_1#3938]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#3932: binary
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [rid#3927 AS rid_0#3932, cn_regionkey#3928 AS cn_regionkey_0#3933, cn_nationkey#3929 AS cn_nationkey_0#3934, cn_name#3930 AS cn_name_0#3935, cn_comment#3931 AS cn_comment_0#3936]
         :     :  :     :  :     :  :  +- Relation[rid#3927,cn_regionkey#3928,cn_nationkey#3929,cn_name#3930,cn_comment#3931] JDBCRelation(tnation) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3937]
         :     :  :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :  :     :        +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [cs_phone#3939 AS cs_phone_1#3947, rid#3940 AS rid_1#3948, cs_address#3941 AS cs_address_1#3949, cs_nationkey#3942 AS cs_nationkey_1#3950, cs_suppkey#3943 AS cs_suppkey_1#3951, cs_name#3944 AS cs_name_1#3952, cs_acctbal#3945 AS cs_acctbal_1#3953, cs_comment#3946 AS cs_comment_1#3954]
         :     :  :     :     +- Relation[cs_phone#3939,rid#3940,cs_address#3941,cs_nationkey#3942,cs_suppkey#3943,cs_name#3944,cs_acctbal#3945,cs_comment#3946] JDBCRelation(tsupplier) [numPartitions=1]
         :     :  :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [cl_returnflag#3956 AS cl_returnflag_2#3975, cl_orderkey_and_l_linenumber#3957 AS cl_orderkey_and_l_linenumber_2#3976, cl_comment#3958 AS cl_comment_2#3977, cl_linestatus#3959 AS cl_linestatus_2#3978, rid#3960 AS rid_2#3979, cl_shipmode#3961 AS cl_shipmode_2#3980, cl_shipinstruct#3962 AS cl_shipinstruct_2#3981, cl_quantity#3963 AS cl_quantity_2#3982, cl_receiptdate#3964 AS cl_receiptdate_2#3983, cl_linenumber#3965 AS cl_linenumber_2#3984, cl_tax#3966 AS cl_tax_2#3985, cl_shipdate#3967 AS cl_shipdate_2#3986, cl_extendedprice#3968 AS cl_extendedprice_2#3987, cl_partkey#3969 AS cl_partkey_2#3988, cl_discount#3970 AS cl_discount_2#3989, cl_partkey_and_l_suppkey#3971 AS cl_partkey_and_l_suppkey_2#3990, cl_commitdate#3972 AS cl_commitdate_2#3991, cl_suppkey#3973 AS cl_suppkey_2#3992, cl_orderkey#3974 AS cl_orderkey_2#3993]
         :     :     +- Relation[cl_returnflag#3956,cl_orderkey_and_l_linenumber#3957,cl_comment#3958,cl_linestatus#3959,rid#3960,cl_shipmode#3961,cl_shipinstruct#3962,cl_quantity#3963,cl_receiptdate#3964,cl_linenumber#3965,cl_tax#3966,cl_shipdate#3967,cl_extendedprice#3968,cl_partkey#3969,cl_discount#3970,cl_partkey_and_l_suppkey#3971,cl_commitdate#3972,cl_suppkey#3973,cl_orderkey#3974] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_3, 'cn_regionkey_3, 'cn_nationkey_3, 'cn_name_3, 'cn_comment_3, 'rid_4, 'cc_acctbal_4, 'cc_name_4, 'cc_nationkey_4, 'cc_custkey_4, 'cc_comment_4, 'cc_address_4, 'cc_mktsegment_4, 'cc_phone_4, dexdecrypt('value_dec_key, value#1934) AS rid_5#4025]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_4
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['rid_3, 'cn_regionkey_3, 'cn_nationkey_3, 'cn_name_3, 'cn_comment_3, dexdecrypt('value_dec_key, value#1934) AS rid_4#4006]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_3#4000: binary
            :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :     :  :     :  :- Project [rid#3995 AS rid_3#4000, cn_regionkey#3996 AS cn_regionkey_3#4001, cn_nationkey#3997 AS cn_nationkey_3#4002, cn_name#3998 AS cn_name_3#4003, cn_comment#3999 AS cn_comment_3#4004]
            :     :  :     :  :  +- Relation[rid#3995,cn_regionkey#3996,cn_nationkey#3997,cn_name#3998,cn_comment#3999] JDBCRelation(tnation) [numPartitions=1]
            :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#4005]
            :     :  :     :     +- DexRidFilter nation~n_name~GERMANY
            :     :  :     :        +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [cc_acctbal#4007 AS cc_acctbal_4#4016, rid#4008 AS rid_4#4017, cc_name#4009 AS cc_name_4#4018, cc_nationkey#4010 AS cc_nationkey_4#4019, cc_custkey#4011 AS cc_custkey_4#4020, cc_comment#4012 AS cc_comment_4#4021, cc_address#4013 AS cc_address_4#4022, cc_mktsegment#4014 AS cc_mktsegment_4#4023, cc_phone#4015 AS cc_phone_4#4024]
            :     :     +- Relation[cc_acctbal#4007,rid#4008,cc_name#4009,cc_nationkey#4010,cc_custkey#4011,cc_comment#4012,cc_address#4013,cc_mktsegment#4014,cc_phone#4015] JDBCRelation(tcustomer) [numPartitions=1]
            :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [co_shippriority#4026 AS co_shippriority_5#4036, rid#4027 AS rid_5#4037, co_orderdate#4028 AS co_orderdate_5#4038, co_custkey#4029 AS co_custkey_5#4039, co_orderpriority#4030 AS co_orderpriority_5#4040, co_clerk#4031 AS co_clerk_5#4041, co_orderstatus#4032 AS co_orderstatus_5#4042, co_totalprice#4033 AS co_totalprice_5#4043, co_orderkey#4034 AS co_orderkey_5#4044, co_comment#4035 AS co_comment_5#4045]
               +- Relation[co_shippriority#4026,rid#4027,co_orderdate#4028,co_custkey#4029,co_orderpriority#4030,co_clerk#4031,co_orderstatus#4032,co_totalprice#4033,co_orderkey#4034,co_comment#4035] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=9735
Elapsed time: 25029ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/14 05:47:01 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 05:47:01 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4111L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 05:47:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 05:47:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 05:47:01 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 05:47:01 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 05:47:01 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 05:47:01 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 05:47:01 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 05:47:01 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 05:47:01 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 05:47:01 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 05:47:01 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 05:47:01 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 05:47:01 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 05:47:01 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4111L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_4))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1934) AS rid_4#4207]
         :  :  :  :  +- 'DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, 'rid_2
         :  :  :  :     :- 'Project ['rid AS rid_2#4206]
         :  :  :  :     :  +- Relation[cps_partkey_and_ps_suppkey#4199,rid#4200,cps_availqty#4201,cps_comment#4202,cps_partkey#4203,cps_supplycost#4204,cps_suppkey#4205] JDBCRelation(tpartsupp) [numPartitions=1]
         :  :  :  :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  +- 'Join NaturalJoin(Inner)
         :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :     :  :- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1934) AS rid_3#4178]
         :  :  :     :  :  +- 'DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, 'rid_2
         :  :  :     :  :     :- 'Project ['rid AS rid_2#4177]
         :  :  :     :  :     :  +- Relation[cps_partkey_and_ps_suppkey#4170,rid#4171,cps_availqty#4172,cps_comment#4173,cps_partkey#4174,cps_supplycost#4175,cps_suppkey#4176] JDBCRelation(tpartsupp) [numPartitions=1]
         :  :  :     :  :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :  +- 'Join NaturalJoin(Inner)
         :  :  :     :     :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :     :     :  :- 'Join NaturalJoin(Inner)
         :  :  :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :     :     :  :  :  :- Project [rid#4113 AS rid_0#4118, cn_regionkey#4114 AS cn_regionkey_0#4119, cn_nationkey#4115 AS cn_nationkey_0#4120, cn_name#4116 AS cn_name_0#4121, cn_comment#4117 AS cn_comment_0#4122]
         :  :  :     :     :  :  :  :  +- Relation[rid#4113,cn_regionkey#4114,cn_nationkey#4115,cn_name#4116,cn_comment#4117] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     :     :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1934) AS rid_1#4129]
         :  :  :     :     :  :  :     +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_0
         :  :  :     :     :  :  :        :- 'Project ['rid AS rid_0#4128]
         :  :  :     :     :  :  :        :  +- Relation[rid#4123,cn_regionkey#4124,cn_nationkey#4125,cn_name#4126,cn_comment#4127] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     :     :  :  :        +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :     :  :  +- Project [cs_phone#4130 AS cs_phone_1#4138, rid#4131 AS rid_1#4139, cs_address#4132 AS cs_address_1#4140, cs_nationkey#4133 AS cs_nationkey_1#4141, cs_suppkey#4134 AS cs_suppkey_1#4142, cs_name#4135 AS cs_name_1#4143, cs_acctbal#4136 AS cs_acctbal_1#4144, cs_comment#4137 AS cs_comment_1#4145]
         :  :  :     :     :  :     +- Relation[cs_phone#4130,rid#4131,cs_address#4132,cs_nationkey#4133,cs_suppkey#4134,cs_name#4135,cs_acctbal#4136,cs_comment#4137] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     :     :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1934) AS rid_2#4155]
         :  :  :     :     :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_1
         :  :  :     :     :        :- 'Project ['rid AS rid_1#4154]
         :  :  :     :     :        :  +- Relation[cs_phone#4146,rid#4147,cs_address#4148,cs_nationkey#4149,cs_suppkey#4150,cs_name#4151,cs_acctbal#4152,cs_comment#4153] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     :     :        +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :     +- Project [cps_partkey_and_ps_suppkey#4156 AS cps_partkey_and_ps_suppkey_2#4163, rid#4157 AS rid_2#4164, cps_availqty#4158 AS cps_availqty_2#4165, cps_comment#4159 AS cps_comment_2#4166, cps_partkey#4160 AS cps_partkey_2#4167, cps_supplycost#4161 AS cps_supplycost_2#4168, cps_suppkey#4162 AS cps_suppkey_2#4169]
         :  :  :     :        +- Relation[cps_partkey_and_ps_suppkey#4156,rid#4157,cps_availqty#4158,cps_comment#4159,cps_partkey#4160,cps_supplycost#4161,cps_suppkey#4162] JDBCRelation(tpartsupp) [numPartitions=1]
         :  :  :     +- Project [cp_comment#4179 AS cp_comment_3#4189, cp_name#4180 AS cp_name_3#4190, rid#4181 AS rid_3#4191, cp_type#4182 AS cp_type_3#4192, cp_retailprice#4183 AS cp_retailprice_3#4193, cp_mfgr#4184 AS cp_mfgr_3#4194, cp_container#4185 AS cp_container_3#4195, cp_brand#4186 AS cp_brand_3#4196, cp_size#4187 AS cp_size_3#4197, cp_partkey#4188 AS cp_partkey_3#4198]
         :  :  :        +- Relation[cp_comment#4179,cp_name#4180,rid#4181,cp_type#4182,cp_retailprice#4183,cp_mfgr#4184,cp_container#4185,cp_brand#4186,cp_size#4187,cp_partkey#4188] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- Project [cl_returnflag#4208 AS cl_returnflag_4#4227, cl_orderkey_and_l_linenumber#4209 AS cl_orderkey_and_l_linenumber_4#4228, cl_comment#4210 AS cl_comment_4#4229, cl_linestatus#4211 AS cl_linestatus_4#4230, rid#4212 AS rid_4#4231, cl_shipmode#4213 AS cl_shipmode_4#4232, cl_shipinstruct#4214 AS cl_shipinstruct_4#4233, cl_quantity#4215 AS cl_quantity_4#4234, cl_receiptdate#4216 AS cl_receiptdate_4#4235, cl_linenumber#4217 AS cl_linenumber_4#4236, cl_tax#4218 AS cl_tax_4#4237, cl_shipdate#4219 AS cl_shipdate_4#4238, cl_extendedprice#4220 AS cl_extendedprice_4#4239, cl_partkey#4221 AS cl_partkey_4#4240, cl_discount#4222 AS cl_discount_4#4241, cl_partkey_and_l_suppkey#4223 AS cl_partkey_and_l_suppkey_4#4242, cl_commitdate#4224 AS cl_commitdate_4#4243, cl_suppkey#4225 AS cl_suppkey_4#4244, cl_orderkey#4226 AS cl_orderkey_4#4245]
         :  :     +- Relation[cl_returnflag#4208,cl_orderkey_and_l_linenumber#4209,cl_comment#4210,cl_linestatus#4211,rid#4212,cl_shipmode#4213,cl_shipinstruct#4214,cl_quantity#4215,cl_receiptdate#4216,cl_linenumber#4217,cl_tax#4218,cl_shipdate#4219,cl_extendedprice#4220,cl_partkey#4221,cl_discount#4222,cl_partkey_and_l_suppkey#4223,cl_commitdate#4224,cl_suppkey#4225,cl_orderkey#4226] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Project ['rid_4, dexdecrypt('value_dec_key, value#1934) AS rid_5#4266]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_4
         :        :- 'Project ['rid AS rid_4#4265]
         :        :  +- Relation[cl_returnflag#4246,cl_orderkey_and_l_linenumber#4247,cl_comment#4248,cl_linestatus#4249,rid#4250,cl_shipmode#4251,cl_shipinstruct#4252,cl_quantity#4253,cl_receiptdate#4254,cl_linenumber#4255,cl_tax#4256,cl_shipdate#4257,cl_extendedprice#4258,cl_partkey#4259,cl_discount#4260,cl_partkey_and_l_suppkey#4261,cl_commitdate#4262,cl_suppkey#4263,cl_orderkey#4264] JDBCRelation(tlineitem) [numPartitions=1]
         :        +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [co_shippriority#4267 AS co_shippriority_5#4277, rid#4268 AS rid_5#4278, co_orderdate#4269 AS co_orderdate_5#4279, co_custkey#4270 AS co_custkey_5#4280, co_orderpriority#4271 AS co_orderpriority_5#4281, co_clerk#4272 AS co_clerk_5#4282, co_orderstatus#4273 AS co_orderstatus_5#4283, co_totalprice#4274 AS co_totalprice_5#4284, co_orderkey#4275 AS co_orderkey_5#4285, co_comment#4276 AS co_comment_5#4286]
            +- Relation[co_shippriority#4267,rid#4268,co_orderdate#4269,co_custkey#4270,co_orderpriority#4271,co_clerk#4272,co_orderstatus#4273,co_totalprice#4274,co_orderkey#4275,co_comment#4276] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 435615ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/14 05:54:16 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 05:54:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4354L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 05:54:16 WARN DexPlanner: InMemoryFileIndex=customer
20/04/14 05:54:16 WARN DexPlanner: InMemoryFileIndex=customer
20/04/14 05:54:16 WARN DexPlanner: InMemoryFileIndex=customer
20/04/14 05:54:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4354L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cc_acctbal_0, 'rid_0, 'cc_name_0, 'cc_nationkey_0, 'cc_custkey_0, 'cc_comment_0, 'cc_address_0, 'cc_mktsegment_0, 'cc_phone_0, 'rid_1, 'co_shippriority_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, 'co_clerk_1, 'co_orderstatus_1, 'co_totalprice_1, 'co_orderkey_1, 'co_comment_1, dexdecrypt('value_dec_key, value#1934) AS rid_2#4396]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['cc_acctbal_0, 'rid_0, 'cc_name_0, 'cc_nationkey_0, 'cc_custkey_0, 'cc_comment_0, 'cc_address_0, 'cc_mktsegment_0, 'cc_phone_0, dexdecrypt('value_dec_key, value#1934) AS rid_1#4375]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4366: binary
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [cc_acctbal#4356 AS cc_acctbal_0#4365, rid#4357 AS rid_0#4366, cc_name#4358 AS cc_name_0#4367, cc_nationkey#4359 AS cc_nationkey_0#4368, cc_custkey#4360 AS cc_custkey_0#4369, cc_comment#4361 AS cc_comment_0#4370, cc_address#4362 AS cc_address_0#4371, cc_mktsegment#4363 AS cc_mktsegment_0#4372, cc_phone#4364 AS cc_phone_0#4373]
         :     :  :     :  :  +- Relation[cc_acctbal#4356,rid#4357,cc_name#4358,cc_nationkey#4359,cc_custkey#4360,cc_comment#4361,cc_address#4362,cc_mktsegment#4363,cc_phone#4364] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4374]
         :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :        +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [co_shippriority#4376 AS co_shippriority_1#4386, rid#4377 AS rid_1#4387, co_orderdate#4378 AS co_orderdate_1#4388, co_custkey#4379 AS co_custkey_1#4389, co_orderpriority#4380 AS co_orderpriority_1#4390, co_clerk#4381 AS co_clerk_1#4391, co_orderstatus#4382 AS co_orderstatus_1#4392, co_totalprice#4383 AS co_totalprice_1#4393, co_orderkey#4384 AS co_orderkey_1#4394, co_comment#4385 AS co_comment_1#4395]
         :     :     +- Relation[co_shippriority#4376,rid#4377,co_orderdate#4378,co_custkey#4379,co_orderpriority#4380,co_clerk#4381,co_orderstatus#4382,co_totalprice#4383,co_orderkey#4384,co_comment#4385] JDBCRelation(torders) [numPartitions=1]
         :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cl_returnflag#4397 AS cl_returnflag_2#4416, cl_orderkey_and_l_linenumber#4398 AS cl_orderkey_and_l_linenumber_2#4417, cl_comment#4399 AS cl_comment_2#4418, cl_linestatus#4400 AS cl_linestatus_2#4419, rid#4401 AS rid_2#4420, cl_shipmode#4402 AS cl_shipmode_2#4421, cl_shipinstruct#4403 AS cl_shipinstruct_2#4422, cl_quantity#4404 AS cl_quantity_2#4423, cl_receiptdate#4405 AS cl_receiptdate_2#4424, cl_linenumber#4406 AS cl_linenumber_2#4425, cl_tax#4407 AS cl_tax_2#4426, cl_shipdate#4408 AS cl_shipdate_2#4427, cl_extendedprice#4409 AS cl_extendedprice_2#4428, cl_partkey#4410 AS cl_partkey_2#4429, cl_discount#4411 AS cl_discount_2#4430, cl_partkey_and_l_suppkey#4412 AS cl_partkey_and_l_suppkey_2#4431, cl_commitdate#4413 AS cl_commitdate_2#4432, cl_suppkey#4414 AS cl_suppkey_2#4433, cl_orderkey#4415 AS cl_orderkey_2#4434]
            +- Relation[cl_returnflag#4397,cl_orderkey_and_l_linenumber#4398,cl_comment#4399,cl_linestatus#4400,rid#4401,cl_shipmode#4402,cl_shipinstruct#4403,cl_quantity#4404,cl_receiptdate#4405,cl_linenumber#4406,cl_tax#4407,cl_shipdate#4408,cl_extendedprice#4409,cl_partkey#4410,cl_discount#4411,cl_partkey_and_l_suppkey#4412,cl_commitdate#4413,cl_suppkey#4414,cl_orderkey#4415] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 70877ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/14 05:55:27 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 05:55:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4485L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/14 05:55:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 05:55:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 05:55:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4485L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cl_returnflag_0, 'cl_orderkey_and_l_linenumber_0, 'cl_comment_0, 'cl_linestatus_0, 'rid_0, 'cl_shipmode_0, 'cl_shipinstruct_0, 'cl_quantity_0, 'cl_receiptdate_0, 'cl_linenumber_0, 'cl_tax_0, 'cl_shipdate_0, 'cl_extendedprice_0, 'cl_partkey_0, 'cl_discount_0, 'cl_partkey_and_l_suppkey_0, 'cl_commitdate_0, 'cl_suppkey_0, 'cl_orderkey_0, 'rid_1, 'co_shippriority_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, ... 15 more fields]
         :  +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['cl_returnflag_0, 'cl_orderkey_and_l_linenumber_0, 'cl_comment_0, 'cl_linestatus_0, 'rid_0, 'cl_shipmode_0, 'cl_shipinstruct_0, 'cl_quantity_0, 'cl_receiptdate_0, 'cl_linenumber_0, 'cl_tax_0, 'cl_shipdate_0, 'cl_extendedprice_0, 'cl_partkey_0, 'cl_discount_0, 'cl_partkey_and_l_suppkey_0, 'cl_commitdate_0, 'cl_suppkey_0, 'cl_orderkey_0, 'rid_1, 'co_shippriority_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, ... 6 more fields]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['cl_returnflag_0, 'cl_orderkey_and_l_linenumber_0, 'cl_comment_0, 'cl_linestatus_0, 'rid_0, 'cl_shipmode_0, 'cl_shipinstruct_0, 'cl_quantity_0, 'cl_receiptdate_0, 'cl_linenumber_0, 'cl_tax_0, 'cl_shipdate_0, 'cl_extendedprice_0, 'cl_partkey_0, 'cl_discount_0, 'cl_partkey_and_l_suppkey_0, 'cl_commitdate_0, 'cl_suppkey_0, 'cl_orderkey_0, dexdecrypt('value_dec_key, value#1934) AS rid_1#4526]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4510: binary
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [cl_returnflag#4487 AS cl_returnflag_0#4506, cl_orderkey_and_l_linenumber#4488 AS cl_orderkey_and_l_linenumber_0#4507, cl_comment#4489 AS cl_comment_0#4508, cl_linestatus#4490 AS cl_linestatus_0#4509, rid#4491 AS rid_0#4510, cl_shipmode#4492 AS cl_shipmode_0#4511, cl_shipinstruct#4493 AS cl_shipinstruct_0#4512, cl_quantity#4494 AS cl_quantity_0#4513, cl_receiptdate#4495 AS cl_receiptdate_0#4514, cl_linenumber#4496 AS cl_linenumber_0#4515, cl_tax#4497 AS cl_tax_0#4516, cl_shipdate#4498 AS cl_shipdate_0#4517, cl_extendedprice#4499 AS cl_extendedprice_0#4518, cl_partkey#4500 AS cl_partkey_0#4519, cl_discount#4501 AS cl_discount_0#4520, cl_partkey_and_l_suppkey#4502 AS cl_partkey_and_l_suppkey_0#4521, cl_commitdate#4503 AS cl_commitdate_0#4522, cl_suppkey#4504 AS cl_suppkey_0#4523, cl_orderkey#4505 AS cl_orderkey_0#4524]
         :     :  :     :  :     :  :  +- Relation[cl_returnflag#4487,cl_orderkey_and_l_linenumber#4488,cl_comment#4489,cl_linestatus#4490,rid#4491,cl_shipmode#4492,cl_shipinstruct#4493,cl_quantity#4494,cl_receiptdate#4495,cl_linenumber#4496,cl_tax#4497,cl_shipdate#4498,cl_extendedprice#4499,cl_partkey#4500,cl_discount#4501,cl_partkey_and_l_suppkey#4502,cl_commitdate#4503,cl_suppkey#4504,cl_orderkey#4505] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4525]
         :     :  :     :  :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :  :     :  :     :        +- Relation[label#1930,value#1931] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [co_shippriority#4527 AS co_shippriority_1#4537, rid#4528 AS rid_1#4538, co_orderdate#4529 AS co_orderdate_1#4539, co_custkey#4530 AS co_custkey_1#4540, co_orderpriority#4531 AS co_orderpriority_1#4541, co_clerk#4532 AS co_clerk_1#4542, co_orderstatus#4533 AS co_orderstatus_1#4543, co_totalprice#4534 AS co_totalprice_1#4544, co_orderkey#4535 AS co_orderkey_1#4545, co_comment#4536 AS co_comment_1#4546]
         :     :  :     :     +- Relation[co_shippriority#4527,rid#4528,co_orderdate#4529,co_custkey#4530,co_orderpriority#4531,co_clerk#4532,co_orderstatus#4533,co_totalprice#4534,co_orderkey#4535,co_comment#4536] JDBCRelation(torders) [numPartitions=1]
         :     :  :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [cc_acctbal#4548 AS cc_acctbal_2#4557, rid#4549 AS rid_2#4558, cc_name#4550 AS cc_name_2#4559, cc_nationkey#4551 AS cc_nationkey_2#4560, cc_custkey#4552 AS cc_custkey_2#4561, cc_comment#4553 AS cc_comment_2#4562, cc_address#4554 AS cc_address_2#4563, cc_mktsegment#4555 AS cc_mktsegment_2#4564, cc_phone#4556 AS cc_phone_2#4565]
         :     :     +- Relation[cc_acctbal#4548,rid#4549,cc_name#4550,cc_nationkey#4551,cc_custkey#4552,cc_comment#4553,cc_address#4554,cc_mktsegment#4555,cc_phone#4556] JDBCRelation(tcustomer) [numPartitions=1]
         :     +- Relation[label#1933,value#1934] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#4567 AS rid_3#4572, cn_regionkey#4568 AS cn_regionkey_3#4573, cn_nationkey#4569 AS cn_nationkey_3#4574, cn_name#4570 AS cn_name_3#4575, cn_comment#4571 AS cn_comment_3#4576]
            +- Relation[rid#4567,cn_regionkey#4568,cn_nationkey#4569,cn_name#4570,cn_comment#4571] JDBCRelation(tnation) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 410945ms
query=q1, count=6001215, duration=8801
query=q10, count=1478870, duration=410945
query=q11, count=31680, duration=6481
query=q12, count=857401, duration=81190
query=q13, count=1550004, duration=197012
query=q14, count=6001215, duration=167011
query=q15, count=6001215, duration=150645
query=q16, count=15780, duration=3633
query=q17, count=6088, duration=1129
query=q18, count=6001215, duration=1852792
query=q19, count=205, duration=141554
query=q2, count=3162, duration=10410
query=q20, count=324, duration=19953
query=q21a, count=119924, duration=744375
query=q3, count=1214743, duration=70877
query=q4, count=6001215, duration=277163
query=q6, count=6001215, duration=3412
query=q7, count=9735, duration=25029
query=q8, count=8716, duration=37990
query=q9a, count=6001215, duration=1103290
query=q9b, count=6001215, duration=435615
