20/04/14 09:52:43 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 14589ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Tue Apr 14 09:52:48 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Tue Apr 14 09:52:49 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Tue Apr 14 09:52:50 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Tue Apr 14 09:52:50 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Tue Apr 14 09:52:50 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Tue Apr 14 09:52:55 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Tue Apr 14 09:53:00 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Tue Apr 14 09:53:00 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/14 09:53:02 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 09:53:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1908L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 09:53:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#1908L]
+- Project
   +- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- Project [cl_returnflag#1910 AS cl_returnflag_0#1929, cl_orderkey_and_l_linenumber#1911 AS cl_orderkey_and_l_linenumber_0#1930, cl_comment#1912 AS cl_comment_0#1931, cl_linestatus#1913 AS cl_linestatus_0#1932, rid#1914 AS rid_0#1933, cl_shipmode#1915 AS cl_shipmode_0#1934, cl_shipinstruct#1916 AS cl_shipinstruct_0#1935, cl_quantity#1917 AS cl_quantity_0#1936, cl_receiptdate#1918 AS cl_receiptdate_0#1937, cl_linenumber#1919 AS cl_linenumber_0#1938, cl_tax#1920 AS cl_tax_0#1939, cl_shipdate#1921 AS cl_shipdate_0#1940, cl_extendedprice#1922 AS cl_extendedprice_0#1941, cl_partkey#1923 AS cl_partkey_0#1942, cl_discount#1924 AS cl_discount_0#1943, cl_partkey_and_l_suppkey#1925 AS cl_partkey_and_l_suppkey_0#1944, cl_commitdate#1926 AS cl_commitdate_0#1945, cl_suppkey#1927 AS cl_suppkey_0#1946, cl_orderkey#1928 AS cl_orderkey_0#1947]
         +- Relation[cl_returnflag#1910,cl_orderkey_and_l_linenumber#1911,cl_comment#1912,cl_linestatus#1913,rid#1914,cl_shipmode#1915,cl_shipinstruct#1916,cl_quantity#1917,cl_receiptdate#1918,cl_linenumber#1919,cl_tax#1920,cl_shipdate#1921,cl_extendedprice#1922,cl_partkey#1923,cl_discount#1924,cl_partkey_and_l_suppkey#1925,cl_commitdate#1926,cl_suppkey#1927,cl_orderkey#1928] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 9949ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/14 09:53:12 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 09:53:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1979L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/14 09:53:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 09:53:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 09:53:12 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/14 09:53:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1979L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cl_returnflag_0, 'cl_orderkey_and_l_linenumber_0, 'cl_comment_0, 'cl_linestatus_0, 'rid_0, 'cl_shipmode_0, 'cl_shipinstruct_0, 'cl_quantity_0, 'cl_receiptdate_0, 'cl_linenumber_0, 'cl_tax_0, 'cl_shipdate_0, 'cl_extendedprice_0, 'cl_partkey_0, 'cl_discount_0, 'cl_partkey_and_l_suppkey_0, 'cl_commitdate_0, 'cl_suppkey_0, 'cl_orderkey_0, 'rid_1, 'co_shippriority_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, ... 15 more fields]
         :  +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['cl_returnflag_0, 'cl_orderkey_and_l_linenumber_0, 'cl_comment_0, 'cl_linestatus_0, 'rid_0, 'cl_shipmode_0, 'cl_shipinstruct_0, 'cl_quantity_0, 'cl_receiptdate_0, 'cl_linenumber_0, 'cl_tax_0, 'cl_shipdate_0, 'cl_extendedprice_0, 'cl_partkey_0, 'cl_discount_0, 'cl_partkey_and_l_suppkey_0, 'cl_commitdate_0, 'cl_suppkey_0, 'cl_orderkey_0, 'rid_1, 'co_shippriority_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, ... 6 more fields]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['cl_returnflag_0, 'cl_orderkey_and_l_linenumber_0, 'cl_comment_0, 'cl_linestatus_0, 'rid_0, 'cl_shipmode_0, 'cl_shipinstruct_0, 'cl_quantity_0, 'cl_receiptdate_0, 'cl_linenumber_0, 'cl_tax_0, 'cl_shipdate_0, 'cl_extendedprice_0, 'cl_partkey_0, 'cl_discount_0, 'cl_partkey_and_l_suppkey_0, 'cl_commitdate_0, 'cl_suppkey_0, 'cl_orderkey_0, dexdecrypt('value_dec_key, value#2023) AS rid_1#2024]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2004: binary
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [cl_returnflag#1981 AS cl_returnflag_0#2000, cl_orderkey_and_l_linenumber#1982 AS cl_orderkey_and_l_linenumber_0#2001, cl_comment#1983 AS cl_comment_0#2002, cl_linestatus#1984 AS cl_linestatus_0#2003, rid#1985 AS rid_0#2004, cl_shipmode#1986 AS cl_shipmode_0#2005, cl_shipinstruct#1987 AS cl_shipinstruct_0#2006, cl_quantity#1988 AS cl_quantity_0#2007, cl_receiptdate#1989 AS cl_receiptdate_0#2008, cl_linenumber#1990 AS cl_linenumber_0#2009, cl_tax#1991 AS cl_tax_0#2010, cl_shipdate#1992 AS cl_shipdate_0#2011, cl_extendedprice#1993 AS cl_extendedprice_0#2012, cl_partkey#1994 AS cl_partkey_0#2013, cl_discount#1995 AS cl_discount_0#2014, cl_partkey_and_l_suppkey#1996 AS cl_partkey_and_l_suppkey_0#2015, cl_commitdate#1997 AS cl_commitdate_0#2016, cl_suppkey#1998 AS cl_suppkey_0#2017, cl_orderkey#1999 AS cl_orderkey_0#2018]
         :     :  :     :  :     :  :  +- Relation[cl_returnflag#1981,cl_orderkey_and_l_linenumber#1982,cl_comment#1983,cl_linestatus#1984,rid#1985,cl_shipmode#1986,cl_shipinstruct#1987,cl_quantity#1988,cl_receiptdate#1989,cl_linenumber#1990,cl_tax#1991,cl_shipdate#1992,cl_extendedprice#1993,cl_partkey#1994,cl_discount#1995,cl_partkey_and_l_suppkey#1996,cl_commitdate#1997,cl_suppkey#1998,cl_orderkey#1999] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2021]
         :     :  :     :  :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :  :     :  :     :        +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [co_shippriority#2025 AS co_shippriority_1#2035, rid#2026 AS rid_1#2036, co_orderdate#2027 AS co_orderdate_1#2037, co_custkey#2028 AS co_custkey_1#2038, co_orderpriority#2029 AS co_orderpriority_1#2039, co_clerk#2030 AS co_clerk_1#2040, co_orderstatus#2031 AS co_orderstatus_1#2041, co_totalprice#2032 AS co_totalprice_1#2042, co_orderkey#2033 AS co_orderkey_1#2043, co_comment#2034 AS co_comment_1#2044]
         :     :  :     :     +- Relation[co_shippriority#2025,rid#2026,co_orderdate#2027,co_custkey#2028,co_orderpriority#2029,co_clerk#2030,co_orderstatus#2031,co_totalprice#2032,co_orderkey#2033,co_comment#2034] JDBCRelation(torders) [numPartitions=1]
         :     :  :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [cc_acctbal#2046 AS cc_acctbal_2#2055, rid#2047 AS rid_2#2056, cc_name#2048 AS cc_name_2#2057, cc_nationkey#2049 AS cc_nationkey_2#2058, cc_custkey#2050 AS cc_custkey_2#2059, cc_comment#2051 AS cc_comment_2#2060, cc_address#2052 AS cc_address_2#2061, cc_mktsegment#2053 AS cc_mktsegment_2#2062, cc_phone#2054 AS cc_phone_2#2063]
         :     :     +- Relation[cc_acctbal#2046,rid#2047,cc_name#2048,cc_nationkey#2049,cc_custkey#2050,cc_comment#2051,cc_address#2052,cc_mktsegment#2053,cc_phone#2054] JDBCRelation(tcustomer) [numPartitions=1]
         :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#2065 AS rid_3#2070, cn_regionkey#2066 AS cn_regionkey_3#2071, cn_nationkey#2067 AS cn_nationkey_3#2072, cn_name#2068 AS cn_name_3#2073, cn_comment#2069 AS cn_comment_3#2074]
            +- Relation[rid#2065,cn_regionkey#2066,cn_nationkey#2067,cn_name#2068,cn_comment#2069] JDBCRelation(tnation) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 402024ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/14 09:59:54 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 09:59:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2125L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 09:59:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 09:59:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 09:59:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 09:59:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2125L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [cs_phone#2127 AS cs_phone_0#2135, rid#2128 AS rid_0#2136, cs_address#2129 AS cs_address_0#2137, cs_nationkey#2130 AS cs_nationkey_0#2138, cs_suppkey#2131 AS cs_suppkey_0#2139, cs_name#2132 AS cs_name_0#2140, cs_acctbal#2133 AS cs_acctbal_0#2141, cs_comment#2134 AS cs_comment_0#2142]
         :  :  +- Relation[cs_phone#2127,rid#2128,cs_address#2129,cs_nationkey#2130,cs_suppkey#2131,cs_name#2132,cs_acctbal#2133,cs_comment#2134] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2023) AS rid_1#2152]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2151]
         :        :  +- Relation[cs_phone#2143,rid#2144,cs_address#2145,cs_nationkey#2146,cs_suppkey#2147,cs_name#2148,cs_acctbal#2149,cs_comment#2150] JDBCRelation(tsupplier) [numPartitions=1]
         :        +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cl_returnflag#2153 AS cl_returnflag_1#2172, cl_orderkey_and_l_linenumber#2154 AS cl_orderkey_and_l_linenumber_1#2173, cl_comment#2155 AS cl_comment_1#2174, cl_linestatus#2156 AS cl_linestatus_1#2175, rid#2157 AS rid_1#2176, cl_shipmode#2158 AS cl_shipmode_1#2177, cl_shipinstruct#2159 AS cl_shipinstruct_1#2178, cl_quantity#2160 AS cl_quantity_1#2179, cl_receiptdate#2161 AS cl_receiptdate_1#2180, cl_linenumber#2162 AS cl_linenumber_1#2181, cl_tax#2163 AS cl_tax_1#2182, cl_shipdate#2164 AS cl_shipdate_1#2183, cl_extendedprice#2165 AS cl_extendedprice_1#2184, cl_partkey#2166 AS cl_partkey_1#2185, cl_discount#2167 AS cl_discount_1#2186, cl_partkey_and_l_suppkey#2168 AS cl_partkey_and_l_suppkey_1#2187, cl_commitdate#2169 AS cl_commitdate_1#2188, cl_suppkey#2170 AS cl_suppkey_1#2189, cl_orderkey#2171 AS cl_orderkey_1#2190]
            +- Relation[cl_returnflag#2153,cl_orderkey_and_l_linenumber#2154,cl_comment#2155,cl_linestatus#2156,rid#2157,cl_shipmode#2158,cl_shipinstruct#2159,cl_quantity#2160,cl_receiptdate#2161,cl_linenumber#2162,cl_tax#2163,cl_shipdate#2164,cl_extendedprice#2165,cl_partkey#2166,cl_discount#2167,cl_partkey_and_l_suppkey#2168,cl_commitdate#2169,cl_suppkey#2170,cl_orderkey#2171] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 196782ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/14 10:03:11 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 10:03:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2222L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/14 10:03:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2222L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(RightOuter)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [co_shippriority#2224 AS co_shippriority_0#2234, rid#2225 AS rid_0#2235, co_orderdate#2226 AS co_orderdate_0#2236, co_custkey#2227 AS co_custkey_0#2237, co_orderpriority#2228 AS co_orderpriority_0#2238, co_clerk#2229 AS co_clerk_0#2239, co_orderstatus#2230 AS co_orderstatus_0#2240, co_totalprice#2231 AS co_totalprice_0#2241, co_orderkey#2232 AS co_orderkey_0#2242, co_comment#2233 AS co_comment_0#2243]
         :  :  +- Relation[co_shippriority#2224,rid#2225,co_orderdate#2226,co_custkey#2227,co_orderpriority#2228,co_clerk#2229,co_orderstatus#2230,co_totalprice#2231,co_orderkey#2232,co_comment#2233] JDBCRelation(torders) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2023) AS rid_1#2255]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2254]
         :        :  +- Relation[co_shippriority#2244,rid#2245,co_orderdate#2246,co_custkey#2247,co_orderpriority#2248,co_clerk#2249,co_orderstatus#2250,co_totalprice#2251,co_orderkey#2252,co_comment#2253] JDBCRelation(torders) [numPartitions=1]
         :        +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cc_acctbal#2256 AS cc_acctbal_1#2265, rid#2257 AS rid_1#2266, cc_name#2258 AS cc_name_1#2267, cc_nationkey#2259 AS cc_nationkey_1#2268, cc_custkey#2260 AS cc_custkey_1#2269, cc_comment#2261 AS cc_comment_1#2270, cc_address#2262 AS cc_address_1#2271, cc_mktsegment#2263 AS cc_mktsegment_1#2272, cc_phone#2264 AS cc_phone_1#2273]
            +- Relation[cc_acctbal#2256,rid#2257,cc_name#2258,cc_nationkey#2259,cc_custkey#2260,cc_comment#2261,cc_address#2262,cc_mktsegment#2263,cc_phone#2264] JDBCRelation(tcustomer) [numPartitions=1]

DexCorr$ result size=1550004
Elapsed time: 132938ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/14 10:05:24 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 10:05:24 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2302L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 10:05:24 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2302L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [cc_acctbal#2304 AS cc_acctbal_0#2313, rid#2305 AS rid_0#2314, cc_name#2306 AS cc_name_0#2315, cc_nationkey#2307 AS cc_nationkey_0#2316, cc_custkey#2308 AS cc_custkey_0#2317, cc_comment#2309 AS cc_comment_0#2318, cc_address#2310 AS cc_address_0#2319, cc_mktsegment#2311 AS cc_mktsegment_0#2320, cc_phone#2312 AS cc_phone_0#2321]
         :  :  :  :  +- Relation[cc_acctbal#2304,rid#2305,cc_name#2306,cc_nationkey#2307,cc_custkey#2308,cc_comment#2309,cc_address#2310,cc_mktsegment#2311,cc_phone#2312] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2023) AS rid_1#2332]
         :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#2331]
         :  :  :        :  +- Relation[cc_acctbal#2322,rid#2323,cc_name#2324,cc_nationkey#2325,cc_custkey#2326,cc_comment#2327,cc_address#2328,cc_mktsegment#2329,cc_phone#2330] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :        +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [co_shippriority#2333 AS co_shippriority_1#2343, rid#2334 AS rid_1#2344, co_orderdate#2335 AS co_orderdate_1#2345, co_custkey#2336 AS co_custkey_1#2346, co_orderpriority#2337 AS co_orderpriority_1#2347, co_clerk#2338 AS co_clerk_1#2348, co_orderstatus#2339 AS co_orderstatus_1#2349, co_totalprice#2340 AS co_totalprice_1#2350, co_orderkey#2341 AS co_orderkey_1#2351, co_comment#2342 AS co_comment_1#2352]
         :  :     +- Relation[co_shippriority#2333,rid#2334,co_orderdate#2335,co_custkey#2336,co_orderpriority#2337,co_clerk#2338,co_orderstatus#2339,co_totalprice#2340,co_orderkey#2341,co_comment#2342] JDBCRelation(torders) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2023) AS rid_2#2364]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2363]
         :        :  +- Relation[co_shippriority#2353,rid#2354,co_orderdate#2355,co_custkey#2356,co_orderpriority#2357,co_clerk#2358,co_orderstatus#2359,co_totalprice#2360,co_orderkey#2361,co_comment#2362] JDBCRelation(torders) [numPartitions=1]
         :        +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cl_returnflag#2365 AS cl_returnflag_2#2384, cl_orderkey_and_l_linenumber#2366 AS cl_orderkey_and_l_linenumber_2#2385, cl_comment#2367 AS cl_comment_2#2386, cl_linestatus#2368 AS cl_linestatus_2#2387, rid#2369 AS rid_2#2388, cl_shipmode#2370 AS cl_shipmode_2#2389, cl_shipinstruct#2371 AS cl_shipinstruct_2#2390, cl_quantity#2372 AS cl_quantity_2#2391, cl_receiptdate#2373 AS cl_receiptdate_2#2392, cl_linenumber#2374 AS cl_linenumber_2#2393, cl_tax#2375 AS cl_tax_2#2394, cl_shipdate#2376 AS cl_shipdate_2#2395, cl_extendedprice#2377 AS cl_extendedprice_2#2396, cl_partkey#2378 AS cl_partkey_2#2397, cl_discount#2379 AS cl_discount_2#2398, cl_partkey_and_l_suppkey#2380 AS cl_partkey_and_l_suppkey_2#2399, cl_commitdate#2381 AS cl_commitdate_2#2400, cl_suppkey#2382 AS cl_suppkey_2#2401, cl_orderkey#2383 AS cl_orderkey_2#2402]
            +- Relation[cl_returnflag#2365,cl_orderkey_and_l_linenumber#2366,cl_comment#2367,cl_linestatus#2368,rid#2369,cl_shipmode#2370,cl_shipinstruct#2371,cl_quantity#2372,cl_receiptdate#2373,cl_linenumber#2374,cl_tax#2375,cl_shipdate#2376,cl_extendedprice#2377,cl_partkey#2378,cl_discount#2379,cl_partkey_and_l_suppkey#2380,cl_commitdate#2381,cl_suppkey#2382,cl_orderkey#2383] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 1700657ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/14 10:33:45 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 10:33:45 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2449L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 10:33:45 WARN DexPlanner: InMemoryFileIndex=customer
20/04/14 10:33:45 WARN DexPlanner: InMemoryFileIndex=customer
20/04/14 10:33:45 WARN DexPlanner: InMemoryFileIndex=customer
20/04/14 10:33:45 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2449L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cc_acctbal_0, 'rid_0, 'cc_name_0, 'cc_nationkey_0, 'cc_custkey_0, 'cc_comment_0, 'cc_address_0, 'cc_mktsegment_0, 'cc_phone_0, 'rid_1, 'co_shippriority_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, 'co_clerk_1, 'co_orderstatus_1, 'co_totalprice_1, 'co_orderkey_1, 'co_comment_1, dexdecrypt('value_dec_key, value#2023) AS rid_2#2491]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['cc_acctbal_0, 'rid_0, 'cc_name_0, 'cc_nationkey_0, 'cc_custkey_0, 'cc_comment_0, 'cc_address_0, 'cc_mktsegment_0, 'cc_phone_0, dexdecrypt('value_dec_key, value#2023) AS rid_1#2470]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#2461: binary
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [cc_acctbal#2451 AS cc_acctbal_0#2460, rid#2452 AS rid_0#2461, cc_name#2453 AS cc_name_0#2462, cc_nationkey#2454 AS cc_nationkey_0#2463, cc_custkey#2455 AS cc_custkey_0#2464, cc_comment#2456 AS cc_comment_0#2465, cc_address#2457 AS cc_address_0#2466, cc_mktsegment#2458 AS cc_mktsegment_0#2467, cc_phone#2459 AS cc_phone_0#2468]
         :     :  :     :  :  +- Relation[cc_acctbal#2451,rid#2452,cc_name#2453,cc_nationkey#2454,cc_custkey#2455,cc_comment#2456,cc_address#2457,cc_mktsegment#2458,cc_phone#2459] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2469]
         :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :        +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [co_shippriority#2471 AS co_shippriority_1#2481, rid#2472 AS rid_1#2482, co_orderdate#2473 AS co_orderdate_1#2483, co_custkey#2474 AS co_custkey_1#2484, co_orderpriority#2475 AS co_orderpriority_1#2485, co_clerk#2476 AS co_clerk_1#2486, co_orderstatus#2477 AS co_orderstatus_1#2487, co_totalprice#2478 AS co_totalprice_1#2488, co_orderkey#2479 AS co_orderkey_1#2489, co_comment#2480 AS co_comment_1#2490]
         :     :     +- Relation[co_shippriority#2471,rid#2472,co_orderdate#2473,co_custkey#2474,co_orderpriority#2475,co_clerk#2476,co_orderstatus#2477,co_totalprice#2478,co_orderkey#2479,co_comment#2480] JDBCRelation(torders) [numPartitions=1]
         :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cl_returnflag#2492 AS cl_returnflag_2#2511, cl_orderkey_and_l_linenumber#2493 AS cl_orderkey_and_l_linenumber_2#2512, cl_comment#2494 AS cl_comment_2#2513, cl_linestatus#2495 AS cl_linestatus_2#2514, rid#2496 AS rid_2#2515, cl_shipmode#2497 AS cl_shipmode_2#2516, cl_shipinstruct#2498 AS cl_shipinstruct_2#2517, cl_quantity#2499 AS cl_quantity_2#2518, cl_receiptdate#2500 AS cl_receiptdate_2#2519, cl_linenumber#2501 AS cl_linenumber_2#2520, cl_tax#2502 AS cl_tax_2#2521, cl_shipdate#2503 AS cl_shipdate_2#2522, cl_extendedprice#2504 AS cl_extendedprice_2#2523, cl_partkey#2505 AS cl_partkey_2#2524, cl_discount#2506 AS cl_discount_2#2525, cl_partkey_and_l_suppkey#2507 AS cl_partkey_and_l_suppkey_2#2526, cl_commitdate#2508 AS cl_commitdate_2#2527, cl_suppkey#2509 AS cl_suppkey_2#2528, cl_orderkey#2510 AS cl_orderkey_2#2529]
            +- Relation[cl_returnflag#2492,cl_orderkey_and_l_linenumber#2493,cl_comment#2494,cl_linestatus#2495,rid#2496,cl_shipmode#2497,cl_shipinstruct#2498,cl_quantity#2499,cl_receiptdate#2500,cl_linenumber#2501,cl_tax#2502,cl_shipdate#2503,cl_extendedprice#2504,cl_partkey#2505,cl_discount#2506,cl_partkey_and_l_suppkey#2507,cl_commitdate#2508,cl_suppkey#2509,cl_orderkey#2510] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 68218ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/14 10:34:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 10:34:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2572L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 10:34:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2572L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cl_returnflag_0, 'cl_orderkey_and_l_linenumber_0, 'cl_comment_0, 'cl_linestatus_0, 'rid_0, 'cl_shipmode_0, 'cl_shipinstruct_0, 'cl_quantity_0, 'cl_receiptdate_0, 'cl_linenumber_0, 'cl_tax_0, 'cl_shipdate_0, 'cl_extendedprice_0, 'cl_partkey_0, 'cl_discount_0, 'cl_partkey_and_l_suppkey_0, 'cl_commitdate_0, 'cl_suppkey_0, 'cl_orderkey_0, dexdecrypt('value_dec_key, value#2023) AS rid_1#2613]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2597: binary
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [cl_returnflag#2574 AS cl_returnflag_0#2593, cl_orderkey_and_l_linenumber#2575 AS cl_orderkey_and_l_linenumber_0#2594, cl_comment#2576 AS cl_comment_0#2595, cl_linestatus#2577 AS cl_linestatus_0#2596, rid#2578 AS rid_0#2597, cl_shipmode#2579 AS cl_shipmode_0#2598, cl_shipinstruct#2580 AS cl_shipinstruct_0#2599, cl_quantity#2581 AS cl_quantity_0#2600, cl_receiptdate#2582 AS cl_receiptdate_0#2601, cl_linenumber#2583 AS cl_linenumber_0#2602, cl_tax#2584 AS cl_tax_0#2603, cl_shipdate#2585 AS cl_shipdate_0#2604, cl_extendedprice#2586 AS cl_extendedprice_0#2605, cl_partkey#2587 AS cl_partkey_0#2606, cl_discount#2588 AS cl_discount_0#2607, cl_partkey_and_l_suppkey#2589 AS cl_partkey_and_l_suppkey_0#2608, cl_commitdate#2590 AS cl_commitdate_0#2609, cl_suppkey#2591 AS cl_suppkey_0#2610, cl_orderkey#2592 AS cl_orderkey_0#2611]
         :     :  :  +- Relation[cl_returnflag#2574,cl_orderkey_and_l_linenumber#2575,cl_comment#2576,cl_linestatus#2577,rid#2578,cl_shipmode#2579,cl_shipinstruct#2580,cl_quantity#2581,cl_receiptdate#2582,cl_linenumber#2583,cl_tax#2584,cl_shipdate#2585,cl_extendedprice#2586,cl_partkey#2587,cl_discount#2588,cl_partkey_and_l_suppkey#2589,cl_commitdate#2590,cl_suppkey#2591,cl_orderkey#2592] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2612]
         :     :     +- DexRidFilter lineitem~l_shipmode~MAIL
         :     :        +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [co_shippriority#2614 AS co_shippriority_1#2624, rid#2615 AS rid_1#2625, co_orderdate#2616 AS co_orderdate_1#2626, co_custkey#2617 AS co_custkey_1#2627, co_orderpriority#2618 AS co_orderpriority_1#2628, co_clerk#2619 AS co_clerk_1#2629, co_orderstatus#2620 AS co_orderstatus_1#2630, co_totalprice#2621 AS co_totalprice_1#2631, co_orderkey#2622 AS co_orderkey_1#2632, co_comment#2623 AS co_comment_1#2633]
            +- Relation[co_shippriority#2614,rid#2615,co_orderdate#2616,co_custkey#2617,co_orderpriority#2618,co_clerk#2619,co_orderstatus#2620,co_totalprice#2621,co_orderkey#2622,co_comment#2623] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 141197ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/14 10:37:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 10:37:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2669L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/14 10:37:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:37:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:37:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:37:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 10:37:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 10:37:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 10:37:14 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 10:37:14 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 10:37:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2669L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'cn_regionkey_0, 'cn_nationkey_0, 'cn_name_0, 'cn_comment_0, 'rid_1, 'cs_phone_1, 'cs_address_1, 'cs_nationkey_1, 'cs_suppkey_1, 'cs_name_1, 'cs_acctbal_1, 'cs_comment_1, dexdecrypt('value_dec_key, value#2023) AS rid_2#2699]
         :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'cn_regionkey_0, 'cn_nationkey_0, 'cn_name_0, 'cn_comment_0, dexdecrypt('value_dec_key, value#2023) AS rid_1#2682]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#2676: binary
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#2671 AS rid_0#2676, cn_regionkey#2672 AS cn_regionkey_0#2677, cn_nationkey#2673 AS cn_nationkey_0#2678, cn_name#2674 AS cn_name_0#2679, cn_comment#2675 AS cn_comment_0#2680]
         :     :  :     :  :  +- Relation[rid#2671,cn_regionkey#2672,cn_nationkey#2673,cn_name#2674,cn_comment#2675] JDBCRelation(tnation) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2681]
         :     :  :     :     +- DexRidFilter nation~n_name~GERMANY
         :     :  :     :        +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [cs_phone#2683 AS cs_phone_1#2691, rid#2684 AS rid_1#2692, cs_address#2685 AS cs_address_1#2693, cs_nationkey#2686 AS cs_nationkey_1#2694, cs_suppkey#2687 AS cs_suppkey_1#2695, cs_name#2688 AS cs_name_1#2696, cs_acctbal#2689 AS cs_acctbal_1#2697, cs_comment#2690 AS cs_comment_1#2698]
         :     :     +- Relation[cs_phone#2683,rid#2684,cs_address#2685,cs_nationkey#2686,cs_suppkey#2687,cs_name#2688,cs_acctbal#2689,cs_comment#2690] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cps_partkey_and_ps_suppkey#2700 AS cps_partkey_and_ps_suppkey_2#2707, rid#2701 AS rid_2#2708, cps_availqty#2702 AS cps_availqty_2#2709, cps_comment#2703 AS cps_comment_2#2710, cps_partkey#2704 AS cps_partkey_2#2711, cps_supplycost#2705 AS cps_supplycost_2#2712, cps_suppkey#2706 AS cps_suppkey_2#2713]
            +- Relation[cps_partkey_and_ps_suppkey#2700,rid#2701,cps_availqty#2702,cps_comment#2703,cps_partkey#2704,cps_supplycost#2705,cps_suppkey#2706] JDBCRelation(tpartsupp) [numPartitions=1]

DexCorr$ result size=31680
Elapsed time: 3023ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/14 10:37:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 10:37:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2738L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 10:37:17 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 10:37:17 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 10:37:17 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 10:37:17 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 10:37:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2738L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, dexdecrypt('value_dec_key, value#2023) AS rid_1#2762]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2752: binary
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :- Project [cp_comment#2740 AS cp_comment_0#2750, cp_name#2741 AS cp_name_0#2751, rid#2742 AS rid_0#2752, cp_type#2743 AS cp_type_0#2753, cp_retailprice#2744 AS cp_retailprice_0#2754, cp_mfgr#2745 AS cp_mfgr_0#2755, cp_container#2746 AS cp_container_0#2756, cp_brand#2747 AS cp_brand_0#2757, cp_size#2748 AS cp_size_0#2758, cp_partkey#2749 AS cp_partkey_0#2759]
         :     :  :  :  +- Relation[cp_comment#2740,cp_name#2741,rid#2742,cp_type#2743,cp_retailprice#2744,cp_mfgr#2745,cp_container#2746,cp_brand#2747,cp_size#2748,cp_partkey#2749] JDBCRelation(tpart) [numPartitions=1]
         :     :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2760]
         :     :  :     +- DexRidFilter part~p_brand~Brand#23
         :     :  :        +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2761]
         :     :     +- DexRidFilter part~p_container~MED BOX
         :     :        +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cl_returnflag#2763 AS cl_returnflag_1#2782, cl_orderkey_and_l_linenumber#2764 AS cl_orderkey_and_l_linenumber_1#2783, cl_comment#2765 AS cl_comment_1#2784, cl_linestatus#2766 AS cl_linestatus_1#2785, rid#2767 AS rid_1#2786, cl_shipmode#2768 AS cl_shipmode_1#2787, cl_shipinstruct#2769 AS cl_shipinstruct_1#2788, cl_quantity#2770 AS cl_quantity_1#2789, cl_receiptdate#2771 AS cl_receiptdate_1#2790, cl_linenumber#2772 AS cl_linenumber_1#2791, cl_tax#2773 AS cl_tax_1#2792, cl_shipdate#2774 AS cl_shipdate_1#2793, cl_extendedprice#2775 AS cl_extendedprice_1#2794, cl_partkey#2776 AS cl_partkey_1#2795, cl_discount#2777 AS cl_discount_1#2796, cl_partkey_and_l_suppkey#2778 AS cl_partkey_and_l_suppkey_1#2797, cl_commitdate#2779 AS cl_commitdate_1#2798, cl_suppkey#2780 AS cl_suppkey_1#2799, cl_orderkey#2781 AS cl_orderkey_1#2800]
            +- Relation[cl_returnflag#2763,cl_orderkey_and_l_linenumber#2764,cl_comment#2765,cl_linestatus#2766,rid#2767,cl_shipmode#2768,cl_shipinstruct#2769,cl_quantity#2770,cl_receiptdate#2771,cl_linenumber#2772,cl_tax#2773,cl_shipdate#2774,cl_extendedprice#2775,cl_partkey#2776,cl_discount#2777,cl_partkey_and_l_suppkey#2778,cl_commitdate#2779,cl_suppkey#2780,cl_orderkey#2781] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6088
Elapsed time: 1381ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/14 10:37:18 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 10:37:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2858L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 10:37:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2858L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [cl_returnflag#2860 AS cl_returnflag_0#2879, cl_orderkey_and_l_linenumber#2861 AS cl_orderkey_and_l_linenumber_0#2880, cl_comment#2862 AS cl_comment_0#2881, cl_linestatus#2863 AS cl_linestatus_0#2882, rid#2864 AS rid_0#2883, cl_shipmode#2865 AS cl_shipmode_0#2884, cl_shipinstruct#2866 AS cl_shipinstruct_0#2885, cl_quantity#2867 AS cl_quantity_0#2886, cl_receiptdate#2868 AS cl_receiptdate_0#2887, cl_linenumber#2869 AS cl_linenumber_0#2888, cl_tax#2870 AS cl_tax_0#2889, cl_shipdate#2871 AS cl_shipdate_0#2890, cl_extendedprice#2872 AS cl_extendedprice_0#2891, cl_partkey#2873 AS cl_partkey_0#2892, cl_discount#2874 AS cl_discount_0#2893, cl_partkey_and_l_suppkey#2875 AS cl_partkey_and_l_suppkey_0#2894, cl_commitdate#2876 AS cl_commitdate_0#2895, cl_suppkey#2877 AS cl_suppkey_0#2896, cl_orderkey#2878 AS cl_orderkey_0#2897]
         :  :  +- Relation[cl_returnflag#2860,cl_orderkey_and_l_linenumber#2861,cl_comment#2862,cl_linestatus#2863,rid#2864,cl_shipmode#2865,cl_shipinstruct#2866,cl_quantity#2867,cl_receiptdate#2868,cl_linenumber#2869,cl_tax#2870,cl_shipdate#2871,cl_extendedprice#2872,cl_partkey#2873,cl_discount#2874,cl_partkey_and_l_suppkey#2875,cl_commitdate#2876,cl_suppkey#2877,cl_orderkey#2878] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2023) AS rid_1#2918]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2917]
         :        :  +- Relation[cl_returnflag#2898,cl_orderkey_and_l_linenumber#2899,cl_comment#2900,cl_linestatus#2901,rid#2902,cl_shipmode#2903,cl_shipinstruct#2904,cl_quantity#2905,cl_receiptdate#2906,cl_linenumber#2907,cl_tax#2908,cl_shipdate#2909,cl_extendedprice#2910,cl_partkey#2911,cl_discount#2912,cl_partkey_and_l_suppkey#2913,cl_commitdate#2914,cl_suppkey#2915,cl_orderkey#2916] JDBCRelation(tlineitem) [numPartitions=1]
         :        +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [co_shippriority#2919 AS co_shippriority_1#2929, rid#2920 AS rid_1#2930, co_orderdate#2921 AS co_orderdate_1#2931, co_custkey#2922 AS co_custkey_1#2932, co_orderpriority#2923 AS co_orderpriority_1#2933, co_clerk#2924 AS co_clerk_1#2934, co_orderstatus#2925 AS co_orderstatus_1#2935, co_totalprice#2926 AS co_totalprice_1#2936, co_orderkey#2927 AS co_orderkey_1#2937, co_comment#2928 AS co_comment_1#2938]
            +- Relation[co_shippriority#2919,rid#2920,co_orderdate#2921,co_custkey#2922,co_orderpriority#2923,co_clerk#2924,co_orderstatus#2925,co_totalprice#2926,co_orderkey#2927,co_comment#2928] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 194623ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/14 10:40:33 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 10:40:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2976L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#612L = c_nationkey#293L)
               :     :- Project [n_nationkey#612L]
               :     :  +- Filter (n_name#613 = GERMANY)
               :     :     +- Relation[n_nationkey#612L,n_name#613,n_regionkey#614L,n_comment#615] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 10:40:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:40:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:40:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:40:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 10:40:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 10:40:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 10:40:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:40:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:40:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:40:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2976L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'cn_regionkey_0, 'cn_nationkey_0, 'cn_name_0, 'cn_comment_0, 'rid_1, 'cs_phone_1, 'cs_address_1, 'cs_nationkey_1, 'cs_suppkey_1, 'cs_name_1, 'cs_acctbal_1, 'cs_comment_1, 'rid_2, 'cl_returnflag_2, 'cl_orderkey_and_l_linenumber_2, 'cl_comment_2, 'cl_linestatus_2, 'cl_shipmode_2, 'cl_shipinstruct_2, 'cl_quantity_2, 'cl_receiptdate_2, 'cl_linenumber_2, 'cl_tax_2, ... 9 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'cn_regionkey_0, 'cn_nationkey_0, 'cn_name_0, 'cn_comment_0, 'rid_1, 'cs_phone_1, 'cs_address_1, 'cs_nationkey_1, 'cs_suppkey_1, 'cs_name_1, 'cs_acctbal_1, 'cs_comment_1, dexdecrypt('value_dec_key, value#2023) AS rid_2#3006]
         :     :  :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['rid_0, 'cn_regionkey_0, 'cn_nationkey_0, 'cn_name_0, 'cn_comment_0, dexdecrypt('value_dec_key, value#2023) AS rid_1#2989]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#2983: binary
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [rid#2978 AS rid_0#2983, cn_regionkey#2979 AS cn_regionkey_0#2984, cn_nationkey#2980 AS cn_nationkey_0#2985, cn_name#2981 AS cn_name_0#2986, cn_comment#2982 AS cn_comment_0#2987]
         :     :  :     :  :     :  :  +- Relation[rid#2978,cn_regionkey#2979,cn_nationkey#2980,cn_name#2981,cn_comment#2982] JDBCRelation(tnation) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2988]
         :     :  :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :  :     :        +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [cs_phone#2990 AS cs_phone_1#2998, rid#2991 AS rid_1#2999, cs_address#2992 AS cs_address_1#3000, cs_nationkey#2993 AS cs_nationkey_1#3001, cs_suppkey#2994 AS cs_suppkey_1#3002, cs_name#2995 AS cs_name_1#3003, cs_acctbal#2996 AS cs_acctbal_1#3004, cs_comment#2997 AS cs_comment_1#3005]
         :     :  :     :     +- Relation[cs_phone#2990,rid#2991,cs_address#2992,cs_nationkey#2993,cs_suppkey#2994,cs_name#2995,cs_acctbal#2996,cs_comment#2997] JDBCRelation(tsupplier) [numPartitions=1]
         :     :  :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [cl_returnflag#3007 AS cl_returnflag_2#3026, cl_orderkey_and_l_linenumber#3008 AS cl_orderkey_and_l_linenumber_2#3027, cl_comment#3009 AS cl_comment_2#3028, cl_linestatus#3010 AS cl_linestatus_2#3029, rid#3011 AS rid_2#3030, cl_shipmode#3012 AS cl_shipmode_2#3031, cl_shipinstruct#3013 AS cl_shipinstruct_2#3032, cl_quantity#3014 AS cl_quantity_2#3033, cl_receiptdate#3015 AS cl_receiptdate_2#3034, cl_linenumber#3016 AS cl_linenumber_2#3035, cl_tax#3017 AS cl_tax_2#3036, cl_shipdate#3018 AS cl_shipdate_2#3037, cl_extendedprice#3019 AS cl_extendedprice_2#3038, cl_partkey#3020 AS cl_partkey_2#3039, cl_discount#3021 AS cl_discount_2#3040, cl_partkey_and_l_suppkey#3022 AS cl_partkey_and_l_suppkey_2#3041, cl_commitdate#3023 AS cl_commitdate_2#3042, cl_suppkey#3024 AS cl_suppkey_2#3043, cl_orderkey#3025 AS cl_orderkey_2#3044]
         :     :     +- Relation[cl_returnflag#3007,cl_orderkey_and_l_linenumber#3008,cl_comment#3009,cl_linestatus#3010,rid#3011,cl_shipmode#3012,cl_shipinstruct#3013,cl_quantity#3014,cl_receiptdate#3015,cl_linenumber#3016,cl_tax#3017,cl_shipdate#3018,cl_extendedprice#3019,cl_partkey#3020,cl_discount#3021,cl_partkey_and_l_suppkey#3022,cl_commitdate#3023,cl_suppkey#3024,cl_orderkey#3025] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_3, 'cn_regionkey_3, 'cn_nationkey_3, 'cn_name_3, 'cn_comment_3, 'rid_4, 'cc_acctbal_4, 'cc_name_4, 'cc_nationkey_4, 'cc_custkey_4, 'cc_comment_4, 'cc_address_4, 'cc_mktsegment_4, 'cc_phone_4, dexdecrypt('value_dec_key, value#2023) AS rid_5#3076]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_4
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['rid_3, 'cn_regionkey_3, 'cn_nationkey_3, 'cn_name_3, 'cn_comment_3, dexdecrypt('value_dec_key, value#2023) AS rid_4#3057]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_3#3051: binary
            :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :     :  :     :  :- Project [rid#3046 AS rid_3#3051, cn_regionkey#3047 AS cn_regionkey_3#3052, cn_nationkey#3048 AS cn_nationkey_3#3053, cn_name#3049 AS cn_name_3#3054, cn_comment#3050 AS cn_comment_3#3055]
            :     :  :     :  :  +- Relation[rid#3046,cn_regionkey#3047,cn_nationkey#3048,cn_name#3049,cn_comment#3050] JDBCRelation(tnation) [numPartitions=1]
            :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#3056]
            :     :  :     :     +- DexRidFilter nation~n_name~GERMANY
            :     :  :     :        +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [cc_acctbal#3058 AS cc_acctbal_4#3067, rid#3059 AS rid_4#3068, cc_name#3060 AS cc_name_4#3069, cc_nationkey#3061 AS cc_nationkey_4#3070, cc_custkey#3062 AS cc_custkey_4#3071, cc_comment#3063 AS cc_comment_4#3072, cc_address#3064 AS cc_address_4#3073, cc_mktsegment#3065 AS cc_mktsegment_4#3074, cc_phone#3066 AS cc_phone_4#3075]
            :     :     +- Relation[cc_acctbal#3058,rid#3059,cc_name#3060,cc_nationkey#3061,cc_custkey#3062,cc_comment#3063,cc_address#3064,cc_mktsegment#3065,cc_phone#3066] JDBCRelation(tcustomer) [numPartitions=1]
            :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [co_shippriority#3077 AS co_shippriority_5#3087, rid#3078 AS rid_5#3088, co_orderdate#3079 AS co_orderdate_5#3089, co_custkey#3080 AS co_custkey_5#3090, co_orderpriority#3081 AS co_orderpriority_5#3091, co_clerk#3082 AS co_clerk_5#3092, co_orderstatus#3083 AS co_orderstatus_5#3093, co_totalprice#3084 AS co_totalprice_5#3094, co_orderkey#3085 AS co_orderkey_5#3095, co_comment#3086 AS co_comment_5#3096]
               +- Relation[co_shippriority#3077,rid#3078,co_orderdate#3079,co_custkey#3080,co_orderpriority#3081,co_clerk#3082,co_orderstatus#3083,co_totalprice#3084,co_orderkey#3085,co_comment#3086] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=9735
Elapsed time: 24801ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/14 10:40:58 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 10:40:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3160L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#810L = c_nationkey#293L)
               :     :- Project [n_nationkey#810L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#812L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#810L, n_regionkey#812L]
               :     :        +- Relation[n_nationkey#810L,n_name#811,n_regionkey#812L,n_comment#813] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 10:40:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 10:40:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 10:40:58 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 10:40:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:40:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:40:58 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 10:40:58 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 10:40:58 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 10:40:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:40:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:40:58 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:40:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3160L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, 'rid_1, 'cl_returnflag_1, 'cl_orderkey_and_l_linenumber_1, 'cl_comment_1, 'cl_linestatus_1, 'cl_shipmode_1, 'cl_shipinstruct_1, 'cl_quantity_1, 'cl_receiptdate_1, 'cl_linenumber_1, 'cl_tax_1, 'cl_shipdate_1, 'cl_extendedprice_1, 'cl_partkey_1, ... 19 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, 'rid_1, 'cl_returnflag_1, 'cl_orderkey_and_l_linenumber_1, 'cl_comment_1, 'cl_linestatus_1, 'cl_shipmode_1, 'cl_shipinstruct_1, 'cl_quantity_1, 'cl_receiptdate_1, 'cl_linenumber_1, 'cl_tax_1, 'cl_shipdate_1, 'cl_extendedprice_1, 'cl_partkey_1, ... 14 more fields]
         :     :  :  +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_2
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, 'rid_1, 'cl_returnflag_1, 'cl_orderkey_and_l_linenumber_1, 'cl_comment_1, 'cl_linestatus_1, 'cl_shipmode_1, 'cl_shipinstruct_1, 'cl_quantity_1, 'cl_receiptdate_1, 'cl_linenumber_1, 'cl_tax_1, 'cl_shipdate_1, 'cl_extendedprice_1, 'cl_partkey_1, ... 6 more fields]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :  :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :     :  :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, dexdecrypt('value_dec_key, value#2023) AS rid_1#3183]
         :     :  :     :  :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3174: binary
         :     :  :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :     :  :- Project [cp_comment#3162 AS cp_comment_0#3172, cp_name#3163 AS cp_name_0#3173, rid#3164 AS rid_0#3174, cp_type#3165 AS cp_type_0#3175, cp_retailprice#3166 AS cp_retailprice_0#3176, cp_mfgr#3167 AS cp_mfgr_0#3177, cp_container#3168 AS cp_container_0#3178, cp_brand#3169 AS cp_brand_0#3179, cp_size#3170 AS cp_size_0#3180, cp_partkey#3171 AS cp_partkey_0#3181]
         :     :  :     :  :     :  :     :  :  +- Relation[cp_comment#3162,cp_name#3163,rid#3164,cp_type#3165,cp_retailprice#3166,cp_mfgr#3167,cp_container#3168,cp_brand#3169,cp_size#3170,cp_partkey#3171] JDBCRelation(tpart) [numPartitions=1]
         :     :  :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3182]
         :     :  :     :  :     :  :     :     +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
         :     :  :     :  :     :  :     :        +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     :  :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  :     :  +- Project [cl_returnflag#3184 AS cl_returnflag_1#3203, cl_orderkey_and_l_linenumber#3185 AS cl_orderkey_and_l_linenumber_1#3204, cl_comment#3186 AS cl_comment_1#3205, cl_linestatus#3187 AS cl_linestatus_1#3206, rid#3188 AS rid_1#3207, cl_shipmode#3189 AS cl_shipmode_1#3208, cl_shipinstruct#3190 AS cl_shipinstruct_1#3209, cl_quantity#3191 AS cl_quantity_1#3210, cl_receiptdate#3192 AS cl_receiptdate_1#3211, cl_linenumber#3193 AS cl_linenumber_1#3212, cl_tax#3194 AS cl_tax_1#3213, cl_shipdate#3195 AS cl_shipdate_1#3214, cl_extendedprice#3196 AS cl_extendedprice_1#3215, cl_partkey#3197 AS cl_partkey_1#3216, cl_discount#3198 AS cl_discount_1#3217, cl_partkey_and_l_suppkey#3199 AS cl_partkey_and_l_suppkey_1#3218, cl_commitdate#3200 AS cl_commitdate_1#3219, cl_suppkey#3201 AS cl_suppkey_1#3220, cl_orderkey#3202 AS cl_orderkey_1#3221]
         :     :  :     :  :     :     +- Relation[cl_returnflag#3184,cl_orderkey_and_l_linenumber#3185,cl_comment#3186,cl_linestatus#3187,rid#3188,cl_shipmode#3189,cl_shipinstruct#3190,cl_quantity#3191,cl_receiptdate#3192,cl_linenumber#3193,cl_tax#3194,cl_shipdate#3195,cl_extendedprice#3196,cl_partkey#3197,cl_discount#3198,cl_partkey_and_l_suppkey#3199,cl_commitdate#3200,cl_suppkey#3201,cl_orderkey#3202] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [cs_phone#3223 AS cs_phone_2#3231, rid#3224 AS rid_2#3232, cs_address#3225 AS cs_address_2#3233, cs_nationkey#3226 AS cs_nationkey_2#3234, cs_suppkey#3227 AS cs_suppkey_2#3235, cs_name#3228 AS cs_name_2#3236, cs_acctbal#3229 AS cs_acctbal_2#3237, cs_comment#3230 AS cs_comment_2#3238]
         :     :  :     :     +- Relation[cs_phone#3223,rid#3224,cs_address#3225,cs_nationkey#3226,cs_suppkey#3227,cs_name#3228,cs_acctbal#3229,cs_comment#3230] JDBCRelation(tsupplier) [numPartitions=1]
         :     :  :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [rid#3240 AS rid_3#3245, cn_regionkey#3241 AS cn_regionkey_3#3246, cn_nationkey#3242 AS cn_nationkey_3#3247, cn_name#3243 AS cn_name_3#3248, cn_comment#3244 AS cn_comment_3#3249]
         :     :     +- Relation[rid#3240,cn_regionkey#3241,cn_nationkey#3242,cn_name#3243,cn_comment#3244] JDBCRelation(tnation) [numPartitions=1]
         :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['cr_regionkey_4, 'cr_name_4, 'cr_comment_4, 'rid_4, 'rid_5, 'cn_regionkey_5, 'cn_nationkey_5, 'cn_name_5, 'cn_comment_5, 'rid_6, 'cc_acctbal_6, 'cc_name_6, 'cc_nationkey_6, 'cc_custkey_6, 'cc_comment_6, 'cc_address_6, 'cc_mktsegment_6, 'cc_phone_6, dexdecrypt('value_dec_key, value#2023) AS rid_7#3290]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_6
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['cr_regionkey_4, 'cr_name_4, 'cr_comment_4, 'rid_4, 'rid_5, 'cn_regionkey_5, 'cn_nationkey_5, 'cn_name_5, 'cn_comment_5, dexdecrypt('value_dec_key, value#2023) AS rid_6#3271]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_5
            :     :  :     :- 'Join NaturalJoin(Inner)
            :     :  :     :  :- 'Project ['cr_regionkey_4, 'cr_name_4, 'cr_comment_4, 'rid_4, dexdecrypt('value_dec_key, value#2023) AS rid_5#3260]
            :     :  :     :  :  +- 'DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_4#3258: binary
            :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_4))
            :     :  :     :  :     :  :- Project [cr_regionkey#3251 AS cr_regionkey_4#3255, cr_name#3252 AS cr_name_4#3256, cr_comment#3253 AS cr_comment_4#3257, rid#3254 AS rid_4#3258]
            :     :  :     :  :     :  :  +- Relation[cr_regionkey#3251,cr_name#3252,cr_comment#3253,rid#3254] JDBCRelation(tregion) [numPartitions=1]
            :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_4#3259]
            :     :  :     :  :     :     +- DexRidFilter region~r_name~AMERICA
            :     :  :     :  :     :        +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     :  :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  :     :  +- Project [rid#3261 AS rid_5#3266, cn_regionkey#3262 AS cn_regionkey_5#3267, cn_nationkey#3263 AS cn_nationkey_5#3268, cn_name#3264 AS cn_name_5#3269, cn_comment#3265 AS cn_comment_5#3270]
            :     :  :     :     +- Relation[rid#3261,cn_regionkey#3262,cn_nationkey#3263,cn_name#3264,cn_comment#3265] JDBCRelation(tnation) [numPartitions=1]
            :     :  :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [cc_acctbal#3272 AS cc_acctbal_6#3281, rid#3273 AS rid_6#3282, cc_name#3274 AS cc_name_6#3283, cc_nationkey#3275 AS cc_nationkey_6#3284, cc_custkey#3276 AS cc_custkey_6#3285, cc_comment#3277 AS cc_comment_6#3286, cc_address#3278 AS cc_address_6#3287, cc_mktsegment#3279 AS cc_mktsegment_6#3288, cc_phone#3280 AS cc_phone_6#3289]
            :     :     +- Relation[cc_acctbal#3272,rid#3273,cc_name#3274,cc_nationkey#3275,cc_custkey#3276,cc_comment#3277,cc_address#3278,cc_mktsegment#3279,cc_phone#3280] JDBCRelation(tcustomer) [numPartitions=1]
            :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [co_shippriority#3291 AS co_shippriority_7#3301, rid#3292 AS rid_7#3302, co_orderdate#3293 AS co_orderdate_7#3303, co_custkey#3294 AS co_custkey_7#3304, co_orderpriority#3295 AS co_orderpriority_7#3305, co_clerk#3296 AS co_clerk_7#3306, co_orderstatus#3297 AS co_orderstatus_7#3307, co_totalprice#3298 AS co_totalprice_7#3308, co_orderkey#3299 AS co_orderkey_7#3309, co_comment#3300 AS co_comment_7#3310]
               +- Relation[co_shippriority#3291,rid#3292,co_orderdate#3293,co_custkey#3294,co_orderpriority#3295,co_clerk#3296,co_orderstatus#3297,co_totalprice#3298,co_orderkey#3299,co_comment#3300] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=8716
Elapsed time: 19916ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/14 10:41:18 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 10:41:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3387L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 10:41:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3387L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [cp_comment#3389 AS cp_comment_0#3399, cp_name#3390 AS cp_name_0#3400, rid#3391 AS rid_0#3401, cp_type#3392 AS cp_type_0#3402, cp_retailprice#3393 AS cp_retailprice_0#3403, cp_mfgr#3394 AS cp_mfgr_0#3404, cp_container#3395 AS cp_container_0#3405, cp_brand#3396 AS cp_brand_0#3406, cp_size#3397 AS cp_size_0#3407, cp_partkey#3398 AS cp_partkey_0#3408]
         :  :  +- Relation[cp_comment#3389,cp_name#3390,rid#3391,cp_type#3392,cp_retailprice#3393,cp_mfgr#3394,cp_container#3395,cp_brand#3396,cp_size#3397,cp_partkey#3398] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2023) AS rid_1#3420]
         :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3419]
         :        :  +- Relation[cp_comment#3409,cp_name#3410,rid#3411,cp_type#3412,cp_retailprice#3413,cp_mfgr#3414,cp_container#3415,cp_brand#3416,cp_size#3417,cp_partkey#3418] JDBCRelation(tpart) [numPartitions=1]
         :        +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cl_returnflag#3421 AS cl_returnflag_1#3440, cl_orderkey_and_l_linenumber#3422 AS cl_orderkey_and_l_linenumber_1#3441, cl_comment#3423 AS cl_comment_1#3442, cl_linestatus#3424 AS cl_linestatus_1#3443, rid#3425 AS rid_1#3444, cl_shipmode#3426 AS cl_shipmode_1#3445, cl_shipinstruct#3427 AS cl_shipinstruct_1#3446, cl_quantity#3428 AS cl_quantity_1#3447, cl_receiptdate#3429 AS cl_receiptdate_1#3448, cl_linenumber#3430 AS cl_linenumber_1#3449, cl_tax#3431 AS cl_tax_1#3450, cl_shipdate#3432 AS cl_shipdate_1#3451, cl_extendedprice#3433 AS cl_extendedprice_1#3452, cl_partkey#3434 AS cl_partkey_1#3453, cl_discount#3435 AS cl_discount_1#3454, cl_partkey_and_l_suppkey#3436 AS cl_partkey_and_l_suppkey_1#3455, cl_commitdate#3437 AS cl_commitdate_1#3456, cl_suppkey#3438 AS cl_suppkey_1#3457, cl_orderkey#3439 AS cl_orderkey_1#3458]
            +- Relation[cl_returnflag#3421,cl_orderkey_and_l_linenumber#3422,cl_comment#3423,cl_linestatus#3424,rid#3425,cl_shipmode#3426,cl_shipinstruct#3427,cl_quantity#3428,cl_receiptdate#3429,cl_linenumber#3430,cl_tax#3431,cl_shipdate#3432,cl_extendedprice#3433,cl_partkey#3434,cl_discount#3435,cl_partkey_and_l_suppkey#3436,cl_commitdate#3437,cl_suppkey#3438,cl_orderkey#3439] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 150172ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/14 10:43:48 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 10:43:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3492L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/14 10:43:48 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 10:43:48 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 10:43:48 WARN DexPlanner: InMemoryFileIndex=region
20/04/14 10:43:48 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:43:48 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:43:48 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:43:48 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 10:43:48 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 10:43:48 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 10:43:48 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 10:43:48 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 10:43:48 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 10:43:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3492L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cr_regionkey_0, 'cr_name_0, 'cr_comment_0, 'rid_0, 'rid_1, 'cn_regionkey_1, 'cn_nationkey_1, 'cn_name_1, 'cn_comment_1, 'rid_2, 'cs_phone_2, 'cs_address_2, 'cs_nationkey_2, 'cs_suppkey_2, 'cs_name_2, 'cs_acctbal_2, 'cs_comment_2, dexdecrypt('value_dec_key, value#2023) AS rid_4#3531]
         :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['cr_regionkey_0, 'cr_name_0, 'cr_comment_0, 'rid_0, 'rid_1, 'cn_regionkey_1, 'cn_nationkey_1, 'cn_name_1, 'cn_comment_1, dexdecrypt('value_dec_key, value#2023) AS rid_2#3514]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['cr_regionkey_0, 'cr_name_0, 'cr_comment_0, 'rid_0, dexdecrypt('value_dec_key, value#2023) AS rid_1#3503]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#3501: binary
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [cr_regionkey#3494 AS cr_regionkey_0#3498, cr_name#3495 AS cr_name_0#3499, cr_comment#3496 AS cr_comment_0#3500, rid#3497 AS rid_0#3501]
         :     :  :     :  :     :  :  +- Relation[cr_regionkey#3494,cr_name#3495,cr_comment#3496,rid#3497] JDBCRelation(tregion) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3502]
         :     :  :     :  :     :     +- DexRidFilter region~r_name~EUROPE
         :     :  :     :  :     :        +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [rid#3504 AS rid_1#3509, cn_regionkey#3505 AS cn_regionkey_1#3510, cn_nationkey#3506 AS cn_nationkey_1#3511, cn_name#3507 AS cn_name_1#3512, cn_comment#3508 AS cn_comment_1#3513]
         :     :  :     :     +- Relation[rid#3504,cn_regionkey#3505,cn_nationkey#3506,cn_name#3507,cn_comment#3508] JDBCRelation(tnation) [numPartitions=1]
         :     :  :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [cs_phone#3515 AS cs_phone_2#3523, rid#3516 AS rid_2#3524, cs_address#3517 AS cs_address_2#3525, cs_nationkey#3518 AS cs_nationkey_2#3526, cs_suppkey#3519 AS cs_suppkey_2#3527, cs_name#3520 AS cs_name_2#3528, cs_acctbal#3521 AS cs_acctbal_2#3529, cs_comment#3522 AS cs_comment_2#3530]
         :     :     +- Relation[cs_phone#3515,rid#3516,cs_address#3517,cs_nationkey#3518,cs_suppkey#3519,cs_name#3520,cs_acctbal#3521,cs_comment#3522] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['cp_comment_3, 'cp_name_3, 'rid_3, 'cp_type_3, 'cp_retailprice_3, 'cp_mfgr_3, 'cp_container_3, 'cp_brand_3, 'cp_size_3, 'cp_partkey_3, dexdecrypt('value_dec_key, value#2023) AS rid_4#3553]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_3#3544: binary
            :     :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :     :  :- Project [cp_comment#3532 AS cp_comment_3#3542, cp_name#3533 AS cp_name_3#3543, rid#3534 AS rid_3#3544, cp_type#3535 AS cp_type_3#3545, cp_retailprice#3536 AS cp_retailprice_3#3546, cp_mfgr#3537 AS cp_mfgr_3#3547, cp_container#3538 AS cp_container_3#3548, cp_brand#3539 AS cp_brand_3#3549, cp_size#3540 AS cp_size_3#3550, cp_partkey#3541 AS cp_partkey_3#3551]
            :     :  :  +- Relation[cp_comment#3532,cp_name#3533,rid#3534,cp_type#3535,cp_retailprice#3536,cp_mfgr#3537,cp_container#3538,cp_brand#3539,cp_size#3540,cp_partkey#3541] JDBCRelation(tpart) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#3552]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [cps_partkey_and_ps_suppkey#3554 AS cps_partkey_and_ps_suppkey_4#3561, rid#3555 AS rid_4#3562, cps_availqty#3556 AS cps_availqty_4#3563, cps_comment#3557 AS cps_comment_4#3564, cps_partkey#3558 AS cps_partkey_4#3565, cps_supplycost#3559 AS cps_supplycost_4#3566, cps_suppkey#3560 AS cps_suppkey_4#3567]
               +- Relation[cps_partkey_and_ps_suppkey#3554,rid#3555,cps_availqty#3556,cps_comment#3557,cps_partkey#3558,cps_supplycost#3559,cps_suppkey#3560] JDBCRelation(tpartsupp) [numPartitions=1]

DexCorr$ result size=3162
Elapsed time: 6828ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/14 10:43:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 10:43:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3607L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 10:43:55 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 10:43:55 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 10:43:55 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 10:43:55 WARN DexPlanner: InMemoryFileIndex=part
20/04/14 10:43:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3607L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, dexdecrypt('value_dec_key, value#2023) AS rid_1#3631]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3621: binary
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :- Project [cp_comment#3609 AS cp_comment_0#3619, cp_name#3610 AS cp_name_0#3620, rid#3611 AS rid_0#3621, cp_type#3612 AS cp_type_0#3622, cp_retailprice#3613 AS cp_retailprice_0#3623, cp_mfgr#3614 AS cp_mfgr_0#3624, cp_container#3615 AS cp_container_0#3625, cp_brand#3616 AS cp_brand_0#3626, cp_size#3617 AS cp_size_0#3627, cp_partkey#3618 AS cp_partkey_0#3628]
         :     :  :  :  +- Relation[cp_comment#3609,cp_name#3610,rid#3611,cp_type#3612,cp_retailprice#3613,cp_mfgr#3614,cp_container#3615,cp_brand#3616,cp_size#3617,cp_partkey#3618] JDBCRelation(tpart) [numPartitions=1]
         :     :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3629]
         :     :  :     +- DexRidFilter part~p_brand~Brand#12
         :     :  :        +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3630]
         :     :     +- DexRidFilter part~p_container~SM CASE
         :     :        +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [cl_returnflag#3632 AS cl_returnflag_1#3651, cl_orderkey_and_l_linenumber#3633 AS cl_orderkey_and_l_linenumber_1#3652, cl_comment#3634 AS cl_comment_1#3653, cl_linestatus#3635 AS cl_linestatus_1#3654, rid#3636 AS rid_1#3655, cl_shipmode#3637 AS cl_shipmode_1#3656, cl_shipinstruct#3638 AS cl_shipinstruct_1#3657, cl_quantity#3639 AS cl_quantity_1#3658, cl_receiptdate#3640 AS cl_receiptdate_1#3659, cl_linenumber#3641 AS cl_linenumber_1#3660, cl_tax#3642 AS cl_tax_1#3661, cl_shipdate#3643 AS cl_shipdate_1#3662, cl_extendedprice#3644 AS cl_extendedprice_1#3663, cl_partkey#3645 AS cl_partkey_1#3664, cl_discount#3646 AS cl_discount_1#3665, cl_partkey_and_l_suppkey#3647 AS cl_partkey_and_l_suppkey_1#3666, cl_commitdate#3648 AS cl_commitdate_1#3667, cl_suppkey#3649 AS cl_suppkey_1#3668, cl_orderkey#3650 AS cl_orderkey_1#3669]
            :  :  +- Relation[cl_returnflag#3632,cl_orderkey_and_l_linenumber#3633,cl_comment#3634,cl_linestatus#3635,rid#3636,cl_shipmode#3637,cl_shipinstruct#3638,cl_quantity#3639,cl_receiptdate#3640,cl_linenumber#3641,cl_tax#3642,cl_shipdate#3643,cl_extendedprice#3644,cl_partkey#3645,cl_discount#3646,cl_partkey_and_l_suppkey#3647,cl_commitdate#3648,cl_suppkey#3649,cl_orderkey#3650] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3670]
            :     +- DexRidFilter lineitem~l_shipmode~AIR
            :        +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#3671]
               +- DexRidFilter lineitem~l_shipinstruct~DELIVER IN PERSON
                  +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=205
Elapsed time: 84321ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/14 10:45:19 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 10:45:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3710L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 10:45:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:45:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:45:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 10:45:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:45:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 10:45:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 10:45:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 10:45:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 10:45:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 10:45:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 10:45:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 10:45:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 10:45:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 10:45:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3710L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_4))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2023) AS rid_4#3806]
         :  :  :  :  +- 'DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, 'rid_2
         :  :  :  :     :- 'Project ['rid AS rid_2#3805]
         :  :  :  :     :  +- Relation[cps_partkey_and_ps_suppkey#3798,rid#3799,cps_availqty#3800,cps_comment#3801,cps_partkey#3802,cps_supplycost#3803,cps_suppkey#3804] JDBCRelation(tpartsupp) [numPartitions=1]
         :  :  :  :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  +- 'Join NaturalJoin(Inner)
         :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :     :  :- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2023) AS rid_3#3777]
         :  :  :     :  :  +- 'DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, 'rid_2
         :  :  :     :  :     :- 'Project ['rid AS rid_2#3776]
         :  :  :     :  :     :  +- Relation[cps_partkey_and_ps_suppkey#3769,rid#3770,cps_availqty#3771,cps_comment#3772,cps_partkey#3773,cps_supplycost#3774,cps_suppkey#3775] JDBCRelation(tpartsupp) [numPartitions=1]
         :  :  :     :  :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :  +- 'Join NaturalJoin(Inner)
         :  :  :     :     :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :     :     :  :- 'Join NaturalJoin(Inner)
         :  :  :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :     :     :  :  :  :- Project [rid#3712 AS rid_0#3717, cn_regionkey#3713 AS cn_regionkey_0#3718, cn_nationkey#3714 AS cn_nationkey_0#3719, cn_name#3715 AS cn_name_0#3720, cn_comment#3716 AS cn_comment_0#3721]
         :  :  :     :     :  :  :  :  +- Relation[rid#3712,cn_regionkey#3713,cn_nationkey#3714,cn_name#3715,cn_comment#3716] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     :     :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2023) AS rid_1#3728]
         :  :  :     :     :  :  :     +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_0
         :  :  :     :     :  :  :        :- 'Project ['rid AS rid_0#3727]
         :  :  :     :     :  :  :        :  +- Relation[rid#3722,cn_regionkey#3723,cn_nationkey#3724,cn_name#3725,cn_comment#3726] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     :     :  :  :        +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :     :  :  +- Project [cs_phone#3729 AS cs_phone_1#3737, rid#3730 AS rid_1#3738, cs_address#3731 AS cs_address_1#3739, cs_nationkey#3732 AS cs_nationkey_1#3740, cs_suppkey#3733 AS cs_suppkey_1#3741, cs_name#3734 AS cs_name_1#3742, cs_acctbal#3735 AS cs_acctbal_1#3743, cs_comment#3736 AS cs_comment_1#3744]
         :  :  :     :     :  :     +- Relation[cs_phone#3729,rid#3730,cs_address#3731,cs_nationkey#3732,cs_suppkey#3733,cs_name#3734,cs_acctbal#3735,cs_comment#3736] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     :     :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2023) AS rid_2#3754]
         :  :  :     :     :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_1
         :  :  :     :     :        :- 'Project ['rid AS rid_1#3753]
         :  :  :     :     :        :  +- Relation[cs_phone#3745,rid#3746,cs_address#3747,cs_nationkey#3748,cs_suppkey#3749,cs_name#3750,cs_acctbal#3751,cs_comment#3752] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     :     :        +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :     +- Project [cps_partkey_and_ps_suppkey#3755 AS cps_partkey_and_ps_suppkey_2#3762, rid#3756 AS rid_2#3763, cps_availqty#3757 AS cps_availqty_2#3764, cps_comment#3758 AS cps_comment_2#3765, cps_partkey#3759 AS cps_partkey_2#3766, cps_supplycost#3760 AS cps_supplycost_2#3767, cps_suppkey#3761 AS cps_suppkey_2#3768]
         :  :  :     :        +- Relation[cps_partkey_and_ps_suppkey#3755,rid#3756,cps_availqty#3757,cps_comment#3758,cps_partkey#3759,cps_supplycost#3760,cps_suppkey#3761] JDBCRelation(tpartsupp) [numPartitions=1]
         :  :  :     +- Project [cp_comment#3778 AS cp_comment_3#3788, cp_name#3779 AS cp_name_3#3789, rid#3780 AS rid_3#3790, cp_type#3781 AS cp_type_3#3791, cp_retailprice#3782 AS cp_retailprice_3#3792, cp_mfgr#3783 AS cp_mfgr_3#3793, cp_container#3784 AS cp_container_3#3794, cp_brand#3785 AS cp_brand_3#3795, cp_size#3786 AS cp_size_3#3796, cp_partkey#3787 AS cp_partkey_3#3797]
         :  :  :        +- Relation[cp_comment#3778,cp_name#3779,rid#3780,cp_type#3781,cp_retailprice#3782,cp_mfgr#3783,cp_container#3784,cp_brand#3785,cp_size#3786,cp_partkey#3787] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- Project [cl_returnflag#3807 AS cl_returnflag_4#3826, cl_orderkey_and_l_linenumber#3808 AS cl_orderkey_and_l_linenumber_4#3827, cl_comment#3809 AS cl_comment_4#3828, cl_linestatus#3810 AS cl_linestatus_4#3829, rid#3811 AS rid_4#3830, cl_shipmode#3812 AS cl_shipmode_4#3831, cl_shipinstruct#3813 AS cl_shipinstruct_4#3832, cl_quantity#3814 AS cl_quantity_4#3833, cl_receiptdate#3815 AS cl_receiptdate_4#3834, cl_linenumber#3816 AS cl_linenumber_4#3835, cl_tax#3817 AS cl_tax_4#3836, cl_shipdate#3818 AS cl_shipdate_4#3837, cl_extendedprice#3819 AS cl_extendedprice_4#3838, cl_partkey#3820 AS cl_partkey_4#3839, cl_discount#3821 AS cl_discount_4#3840, cl_partkey_and_l_suppkey#3822 AS cl_partkey_and_l_suppkey_4#3841, cl_commitdate#3823 AS cl_commitdate_4#3842, cl_suppkey#3824 AS cl_suppkey_4#3843, cl_orderkey#3825 AS cl_orderkey_4#3844]
         :  :     +- Relation[cl_returnflag#3807,cl_orderkey_and_l_linenumber#3808,cl_comment#3809,cl_linestatus#3810,rid#3811,cl_shipmode#3812,cl_shipinstruct#3813,cl_quantity#3814,cl_receiptdate#3815,cl_linenumber#3816,cl_tax#3817,cl_shipdate#3818,cl_extendedprice#3819,cl_partkey#3820,cl_discount#3821,cl_partkey_and_l_suppkey#3822,cl_commitdate#3823,cl_suppkey#3824,cl_orderkey#3825] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Project ['rid_4, dexdecrypt('value_dec_key, value#2023) AS rid_5#3865]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_4
         :        :- 'Project ['rid AS rid_4#3864]
         :        :  +- Relation[cl_returnflag#3845,cl_orderkey_and_l_linenumber#3846,cl_comment#3847,cl_linestatus#3848,rid#3849,cl_shipmode#3850,cl_shipinstruct#3851,cl_quantity#3852,cl_receiptdate#3853,cl_linenumber#3854,cl_tax#3855,cl_shipdate#3856,cl_extendedprice#3857,cl_partkey#3858,cl_discount#3859,cl_partkey_and_l_suppkey#3860,cl_commitdate#3861,cl_suppkey#3862,cl_orderkey#3863] JDBCRelation(tlineitem) [numPartitions=1]
         :        +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [co_shippriority#3866 AS co_shippriority_5#3876, rid#3867 AS rid_5#3877, co_orderdate#3868 AS co_orderdate_5#3878, co_custkey#3869 AS co_custkey_5#3879, co_orderpriority#3870 AS co_orderpriority_5#3880, co_clerk#3871 AS co_clerk_5#3881, co_orderstatus#3872 AS co_orderstatus_5#3882, co_totalprice#3873 AS co_totalprice_5#3883, co_orderkey#3874 AS co_orderkey_5#3884, co_comment#3875 AS co_comment_5#3885]
            +- Relation[co_shippriority#3866,rid#3867,co_orderdate#3868,co_custkey#3869,co_orderpriority#3870,co_clerk#3871,co_orderstatus#3872,co_totalprice#3873,co_orderkey#3874,co_comment#3875] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 469672ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/14 10:53:09 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 10:53:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3950L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/14 10:53:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#3950L]
+- Project
   +- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- Project [cl_returnflag#3952 AS cl_returnflag_0#3971, cl_orderkey_and_l_linenumber#3953 AS cl_orderkey_and_l_linenumber_0#3972, cl_comment#3954 AS cl_comment_0#3973, cl_linestatus#3955 AS cl_linestatus_0#3974, rid#3956 AS rid_0#3975, cl_shipmode#3957 AS cl_shipmode_0#3976, cl_shipinstruct#3958 AS cl_shipinstruct_0#3977, cl_quantity#3959 AS cl_quantity_0#3978, cl_receiptdate#3960 AS cl_receiptdate_0#3979, cl_linenumber#3961 AS cl_linenumber_0#3980, cl_tax#3962 AS cl_tax_0#3981, cl_shipdate#3963 AS cl_shipdate_0#3982, cl_extendedprice#3964 AS cl_extendedprice_0#3983, cl_partkey#3965 AS cl_partkey_0#3984, cl_discount#3966 AS cl_discount_0#3985, cl_partkey_and_l_suppkey#3967 AS cl_partkey_and_l_suppkey_0#3986, cl_commitdate#3968 AS cl_commitdate_0#3987, cl_suppkey#3969 AS cl_suppkey_0#3988, cl_orderkey#3970 AS cl_orderkey_0#3989]
         +- Relation[cl_returnflag#3952,cl_orderkey_and_l_linenumber#3953,cl_comment#3954,cl_linestatus#3955,rid#3956,cl_shipmode#3957,cl_shipinstruct#3958,cl_quantity#3959,cl_receiptdate#3960,cl_linenumber#3961,cl_tax#3962,cl_shipdate#3963,cl_extendedprice#3964,cl_partkey#3965,cl_discount#3966,cl_partkey_and_l_suppkey#3967,cl_commitdate#3968,cl_suppkey#3969,cl_orderkey#3970] JDBCRelation(tlineitem) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 3357ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/14 10:53:12 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 10:53:12 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4013L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1766L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1766L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1764L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1764L, l_suppkey#1766L]
               :     :        +- Relation[l_orderkey#1764L,l_partkey#1765L,l_suppkey#1766L,l_linenumber#1767,l_quantity#1768,l_extendedprice#1769,l_discount#1770,l_tax#1771,l_returnflag#1772,l_linestatus#1773,l_commitdate#1774,l_receiptdate#1775,l_shipinstruct#1776,l_shipmode#1777,l_comment#1778,l_shipdate#1779] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/14 10:53:12 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 10:53:12 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 10:53:12 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 10:53:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:53:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:53:12 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 10:53:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4013L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(LeftSemi)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Project ['co_shippriority_1, 'rid_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, 'co_clerk_1, 'co_orderstatus_1, 'co_totalprice_1, 'co_orderkey_1, 'co_comment_1, 'rid_2, 'cl_returnflag_2, 'cl_orderkey_and_l_linenumber_2, 'cl_comment_2, 'cl_linestatus_2, 'cl_shipmode_2, 'cl_shipinstruct_2, 'cl_quantity_2, 'cl_receiptdate_2, 'cl_linenumber_2, 'cl_tax_2, 'cl_shipdate_2, 'cl_extendedprice_2, 'cl_partkey_2, ... 14 more fields]
         :  :  +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_3
         :  :     :- 'Join NaturalJoin(Inner)
         :  :     :  :- 'Project ['co_shippriority_1, 'rid_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, 'co_clerk_1, 'co_orderstatus_1, 'co_totalprice_1, 'co_orderkey_1, 'co_comment_1, 'rid_2, 'cl_returnflag_2, 'cl_orderkey_and_l_linenumber_2, 'cl_comment_2, 'cl_linestatus_2, 'cl_shipmode_2, 'cl_shipinstruct_2, 'cl_quantity_2, 'cl_receiptdate_2, 'cl_linenumber_2, 'cl_tax_2, 'cl_shipdate_2, 'cl_extendedprice_2, 'cl_partkey_2, ... 6 more fields]
         :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_2
         :  :     :  :     :- 'Join NaturalJoin(Inner)
         :  :     :  :     :  :- 'Project ['co_shippriority_1, 'rid_1, 'co_orderdate_1, 'co_custkey_1, 'co_orderpriority_1, 'co_clerk_1, 'co_orderstatus_1, 'co_totalprice_1, 'co_orderkey_1, 'co_comment_1, dexdecrypt('value_dec_key, value#2023) AS rid_2#4095]
         :  :     :  :     :  :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#4085: binary
         :  :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :     :  :     :  :     :  :- Project [co_shippriority#4074 AS co_shippriority_1#4084, rid#4075 AS rid_1#4085, co_orderdate#4076 AS co_orderdate_1#4086, co_custkey#4077 AS co_custkey_1#4087, co_orderpriority#4078 AS co_orderpriority_1#4088, co_clerk#4079 AS co_clerk_1#4089, co_orderstatus#4080 AS co_orderstatus_1#4090, co_totalprice#4081 AS co_totalprice_1#4091, co_orderkey#4082 AS co_orderkey_1#4092, co_comment#4083 AS co_comment_1#4093]
         :  :     :  :     :  :     :  :  +- Relation[co_shippriority#4074,rid#4075,co_orderdate#4076,co_custkey#4077,co_orderpriority#4078,co_clerk#4079,co_orderstatus#4080,co_totalprice#4081,co_orderkey#4082,co_comment#4083] JDBCRelation(torders) [numPartitions=1]
         :  :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4094]
         :  :     :  :     :  :     :     +- DexRidFilter orders~o_orderstatus~F
         :  :     :  :     :  :     :        +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]
         :  :     :  :     :  :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :     :  :     :  +- Project [cl_returnflag#4096 AS cl_returnflag_2#4115, cl_orderkey_and_l_linenumber#4097 AS cl_orderkey_and_l_linenumber_2#4116, cl_comment#4098 AS cl_comment_2#4117, cl_linestatus#4099 AS cl_linestatus_2#4118, rid#4100 AS rid_2#4119, cl_shipmode#4101 AS cl_shipmode_2#4120, cl_shipinstruct#4102 AS cl_shipinstruct_2#4121, cl_quantity#4103 AS cl_quantity_2#4122, cl_receiptdate#4104 AS cl_receiptdate_2#4123, cl_linenumber#4105 AS cl_linenumber_2#4124, cl_tax#4106 AS cl_tax_2#4125, cl_shipdate#4107 AS cl_shipdate_2#4126, cl_extendedprice#4108 AS cl_extendedprice_2#4127, cl_partkey#4109 AS cl_partkey_2#4128, cl_discount#4110 AS cl_discount_2#4129, cl_partkey_and_l_suppkey#4111 AS cl_partkey_and_l_suppkey_2#4130, cl_commitdate#4112 AS cl_commitdate_2#4131, cl_suppkey#4113 AS cl_suppkey_2#4132, cl_orderkey#4114 AS cl_orderkey_2#4133]
         :  :     :  :     :     +- Relation[cl_returnflag#4096,cl_orderkey_and_l_linenumber#4097,cl_comment#4098,cl_linestatus#4099,rid#4100,cl_shipmode#4101,cl_shipinstruct#4102,cl_quantity#4103,cl_receiptdate#4104,cl_linenumber#4105,cl_tax#4106,cl_shipdate#4107,cl_extendedprice#4108,cl_partkey#4109,cl_discount#4110,cl_partkey_and_l_suppkey#4111,cl_commitdate#4112,cl_suppkey#4113,cl_orderkey#4114] JDBCRelation(tlineitem) [numPartitions=1]
         :  :     :  :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :     :  +- Project [cs_phone#4135 AS cs_phone_3#4143, rid#4136 AS rid_3#4144, cs_address#4137 AS cs_address_3#4145, cs_nationkey#4138 AS cs_nationkey_3#4146, cs_suppkey#4139 AS cs_suppkey_3#4147, cs_name#4140 AS cs_name_3#4148, cs_acctbal#4141 AS cs_acctbal_3#4149, cs_comment#4142 AS cs_comment_3#4150]
         :  :     :     +- Relation[cs_phone#4135,rid#4136,cs_address#4137,cs_nationkey#4138,cs_suppkey#4139,cs_name#4140,cs_acctbal#4141,cs_comment#4142] JDBCRelation(tsupplier) [numPartitions=1]
         :  :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  +- 'Join UsingJoin(LeftSemi,List(rid_4))
         :     :- Project [rid#4152 AS rid_4#4157, cn_regionkey#4153 AS cn_regionkey_4#4158, cn_nationkey#4154 AS cn_nationkey_4#4159, cn_name#4155 AS cn_name_4#4160, cn_comment#4156 AS cn_comment_4#4161]
         :     :  +- Relation[rid#4152,cn_regionkey#4153,cn_nationkey#4154,cn_name#4155,cn_comment#4156] JDBCRelation(tnation) [numPartitions=1]
         :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_4#4162]
         :        +- DexRidFilter nation~n_name~SAUDI ARABIA
         :           +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_0))
            :- Project [cl_returnflag#4015 AS cl_returnflag_0#4034, cl_orderkey_and_l_linenumber#4016 AS cl_orderkey_and_l_linenumber_0#4035, cl_comment#4017 AS cl_comment_0#4036, cl_linestatus#4018 AS cl_linestatus_0#4037, rid#4019 AS rid_0#4038, cl_shipmode#4020 AS cl_shipmode_0#4039, cl_shipinstruct#4021 AS cl_shipinstruct_0#4040, cl_quantity#4022 AS cl_quantity_0#4041, cl_receiptdate#4023 AS cl_receiptdate_0#4042, cl_linenumber#4024 AS cl_linenumber_0#4043, cl_tax#4025 AS cl_tax_0#4044, cl_shipdate#4026 AS cl_shipdate_0#4045, cl_extendedprice#4027 AS cl_extendedprice_0#4046, cl_partkey#4028 AS cl_partkey_0#4047, cl_discount#4029 AS cl_discount_0#4048, cl_partkey_and_l_suppkey#4030 AS cl_partkey_and_l_suppkey_0#4049, cl_commitdate#4031 AS cl_commitdate_0#4050, cl_suppkey#4032 AS cl_suppkey_0#4051, cl_orderkey#4033 AS cl_orderkey_0#4052]
            :  +- Relation[cl_returnflag#4015,cl_orderkey_and_l_linenumber#4016,cl_comment#4017,cl_linestatus#4018,rid#4019,cl_shipmode#4020,cl_shipinstruct#4021,cl_quantity#4022,cl_receiptdate#4023,cl_linenumber#4024,cl_tax#4025,cl_shipdate#4026,cl_extendedprice#4027,cl_partkey#4028,cl_discount#4029,cl_partkey_and_l_suppkey#4030,cl_commitdate#4031,cl_suppkey#4032,cl_orderkey#4033] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2023) AS rid_1#4073]
               +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
                  :- 'Project ['rid AS rid_0#4072]
                  :  +- Relation[cl_returnflag#4053,cl_orderkey_and_l_linenumber#4054,cl_comment#4055,cl_linestatus#4056,rid#4057,cl_shipmode#4058,cl_shipinstruct#4059,cl_quantity#4060,cl_receiptdate#4061,cl_linenumber#4062,cl_tax#4063,cl_shipdate#4064,cl_extendedprice#4065,cl_partkey#4066,cl_discount#4067,cl_partkey_and_l_suppkey#4068,cl_commitdate#4069,cl_suppkey#4070,cl_orderkey#4071] JDBCRelation(tlineitem) [numPartitions=1]
                  +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]

DexCorr$ result size=119924
Elapsed time: 735945ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/14 11:05:28 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 11:05:28 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4212L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/14 11:05:28 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 11:05:28 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 11:05:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4212L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, dexdecrypt('value_dec_key, value#2023) AS rid_1#4235]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4226: binary
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [cp_comment#4214 AS cp_comment_0#4224, cp_name#4215 AS cp_name_0#4225, rid#4216 AS rid_0#4226, cp_type#4217 AS cp_type_0#4227, cp_retailprice#4218 AS cp_retailprice_0#4228, cp_mfgr#4219 AS cp_mfgr_0#4229, cp_container#4220 AS cp_container_0#4230, cp_brand#4221 AS cp_brand_0#4231, cp_size#4222 AS cp_size_0#4232, cp_partkey#4223 AS cp_partkey_0#4233]
         :     :  :  +- Relation[cp_comment#4214,cp_name#4215,rid#4216,cp_type#4217,cp_retailprice#4218,cp_mfgr#4219,cp_container#4220,cp_brand#4221,cp_size#4222,cp_partkey#4223] JDBCRelation(tpart) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4234]
         :     :     +- DexRidFilter part~p_size~49
         :     :        +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [cps_partkey_and_ps_suppkey#4236 AS cps_partkey_and_ps_suppkey_1#4243, rid#4237 AS rid_1#4244, cps_availqty#4238 AS cps_availqty_1#4245, cps_comment#4239 AS cps_comment_1#4246, cps_partkey#4240 AS cps_partkey_1#4247, cps_supplycost#4241 AS cps_supplycost_1#4248, cps_suppkey#4242 AS cps_suppkey_1#4249]
            +- Relation[cps_partkey_and_ps_suppkey#4236,rid#4237,cps_availqty#4238,cps_comment#4239,cps_partkey#4240,cps_supplycost#4241,cps_suppkey#4242] JDBCRelation(tpartsupp) [numPartitions=1]

DexCorr$ result size=15780
Elapsed time: 16252ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/14 11:05:44 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 11:05:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4276L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/14 11:05:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 11:05:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 11:05:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 11:05:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 11:05:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 11:05:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 11:05:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 11:05:44 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 11:05:44 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 11:05:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4276L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :  :  :  :  :- Project [rid#4278 AS rid_0#4283, cn_regionkey#4279 AS cn_regionkey_0#4284, cn_nationkey#4280 AS cn_nationkey_0#4285, cn_name#4281 AS cn_name_0#4286, cn_comment#4282 AS cn_comment_0#4287]
         :  :  :  :  :  :  :  :  :  :  +- Relation[rid#4278,cn_regionkey#4279,cn_nationkey#4280,cn_name#4281,cn_comment#4282] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#2023) AS rid_1#4294]
         :  :  :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_0
         :  :  :  :  :  :  :  :  :        :- 'Project ['rid AS rid_0#4293]
         :  :  :  :  :  :  :  :  :        :  +- Relation[rid#4288,cn_regionkey#4289,cn_nationkey#4290,cn_name#4291,cn_comment#4292] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  :  :  :  :  :        +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  :  :  +- Project [cs_phone#4295 AS cs_phone_1#4303, rid#4296 AS rid_1#4304, cs_address#4297 AS cs_address_1#4305, cs_nationkey#4298 AS cs_nationkey_1#4306, cs_suppkey#4299 AS cs_suppkey_1#4307, cs_name#4300 AS cs_name_1#4308, cs_acctbal#4301 AS cs_acctbal_1#4309, cs_comment#4302 AS cs_comment_1#4310]
         :  :  :  :  :  :  :  :     +- Relation[cs_phone#4295,rid#4296,cs_address#4297,cs_nationkey#4298,cs_suppkey#4299,cs_name#4300,cs_acctbal#4301,cs_comment#4302] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :  :  :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#2023) AS rid_2#4320]
         :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_1
         :  :  :  :  :  :  :        :- 'Project ['rid AS rid_1#4319]
         :  :  :  :  :  :  :        :  +- Relation[cs_phone#4311,rid#4312,cs_address#4313,cs_nationkey#4314,cs_suppkey#4315,cs_name#4316,cs_acctbal#4317,cs_comment#4318] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :  :  :  :  :        +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  +- Project [cl_returnflag#4321 AS cl_returnflag_2#4340, cl_orderkey_and_l_linenumber#4322 AS cl_orderkey_and_l_linenumber_2#4341, cl_comment#4323 AS cl_comment_2#4342, cl_linestatus#4324 AS cl_linestatus_2#4343, rid#4325 AS rid_2#4344, cl_shipmode#4326 AS cl_shipmode_2#4345, cl_shipinstruct#4327 AS cl_shipinstruct_2#4346, cl_quantity#4328 AS cl_quantity_2#4347, cl_receiptdate#4329 AS cl_receiptdate_2#4348, cl_linenumber#4330 AS cl_linenumber_2#4349, cl_tax#4331 AS cl_tax_2#4350, cl_shipdate#4332 AS cl_shipdate_2#4351, cl_extendedprice#4333 AS cl_extendedprice_2#4352, cl_partkey#4334 AS cl_partkey_2#4353, cl_discount#4335 AS cl_discount_2#4354, cl_partkey_and_l_suppkey#4336 AS cl_partkey_and_l_suppkey_2#4355, cl_commitdate#4337 AS cl_commitdate_2#4356, cl_suppkey#4338 AS cl_suppkey_2#4357, cl_orderkey#4339 AS cl_orderkey_2#4358]
         :  :  :  :  :  :     +- Relation[cl_returnflag#4321,cl_orderkey_and_l_linenumber#4322,cl_comment#4323,cl_linestatus#4324,rid#4325,cl_shipmode#4326,cl_shipinstruct#4327,cl_quantity#4328,cl_receiptdate#4329,cl_linenumber#4330,cl_tax#4331,cl_shipdate#4332,cl_extendedprice#4333,cl_partkey#4334,cl_discount#4335,cl_partkey_and_l_suppkey#4336,cl_commitdate#4337,cl_suppkey#4338,cl_orderkey#4339] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2023) AS rid_3#4379]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_2
         :  :  :  :  :        :- 'Project ['rid AS rid_2#4378]
         :  :  :  :  :        :  +- Relation[cl_returnflag#4359,cl_orderkey_and_l_linenumber#4360,cl_comment#4361,cl_linestatus#4362,rid#4363,cl_shipmode#4364,cl_shipinstruct#4365,cl_quantity#4366,cl_receiptdate#4367,cl_linenumber#4368,cl_tax#4369,cl_shipdate#4370,cl_extendedprice#4371,cl_partkey#4372,cl_discount#4373,cl_partkey_and_l_suppkey#4374,cl_commitdate#4375,cl_suppkey#4376,cl_orderkey#4377] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [cp_comment#4380 AS cp_comment_3#4390, cp_name#4381 AS cp_name_3#4391, rid#4382 AS rid_3#4392, cp_type#4383 AS cp_type_3#4393, cp_retailprice#4384 AS cp_retailprice_3#4394, cp_mfgr#4385 AS cp_mfgr_3#4395, cp_container#4386 AS cp_container_3#4396, cp_brand#4387 AS cp_brand_3#4397, cp_size#4388 AS cp_size_3#4398, cp_partkey#4389 AS cp_partkey_3#4399]
         :  :  :  :     +- Relation[cp_comment#4380,cp_name#4381,rid#4382,cp_type#4383,cp_retailprice#4384,cp_mfgr#4385,cp_container#4386,cp_brand#4387,cp_size#4388,cp_partkey#4389] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2023) AS rid_4#4420]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey_and_l_suppkey~partsupp~ps_partkey_and_ps_suppkey, 'rid_2
         :  :  :        :- 'Project ['rid AS rid_2#4419]
         :  :  :        :  +- Relation[cl_returnflag#4400,cl_orderkey_and_l_linenumber#4401,cl_comment#4402,cl_linestatus#4403,rid#4404,cl_shipmode#4405,cl_shipinstruct#4406,cl_quantity#4407,cl_receiptdate#4408,cl_linenumber#4409,cl_tax#4410,cl_shipdate#4411,cl_extendedprice#4412,cl_partkey#4413,cl_discount#4414,cl_partkey_and_l_suppkey#4415,cl_commitdate#4416,cl_suppkey#4417,cl_orderkey#4418] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :        +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [cps_partkey_and_ps_suppkey#4421 AS cps_partkey_and_ps_suppkey_4#4428, rid#4422 AS rid_4#4429, cps_availqty#4423 AS cps_availqty_4#4430, cps_comment#4424 AS cps_comment_4#4431, cps_partkey#4425 AS cps_partkey_4#4432, cps_supplycost#4426 AS cps_supplycost_4#4433, cps_suppkey#4427 AS cps_suppkey_4#4434]
         :  :     +- Relation[cps_partkey_and_ps_suppkey#4421,rid#4422,cps_availqty#4423,cps_comment#4424,cps_partkey#4425,cps_supplycost#4426,cps_suppkey#4427] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#2023) AS rid_5#4455]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#4454]
         :        :  +- Relation[cl_returnflag#4435,cl_orderkey_and_l_linenumber#4436,cl_comment#4437,cl_linestatus#4438,rid#4439,cl_shipmode#4440,cl_shipinstruct#4441,cl_quantity#4442,cl_receiptdate#4443,cl_linenumber#4444,cl_tax#4445,cl_shipdate#4446,cl_extendedprice#4447,cl_partkey#4448,cl_discount#4449,cl_partkey_and_l_suppkey#4450,cl_commitdate#4451,cl_suppkey#4452,cl_orderkey#4453] JDBCRelation(tlineitem) [numPartitions=1]
         :        +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [co_shippriority#4456 AS co_shippriority_5#4466, rid#4457 AS rid_5#4467, co_orderdate#4458 AS co_orderdate_5#4468, co_custkey#4459 AS co_custkey_5#4469, co_orderpriority#4460 AS co_orderpriority_5#4470, co_clerk#4461 AS co_clerk_5#4471, co_orderstatus#4462 AS co_orderstatus_5#4472, co_totalprice#4463 AS co_totalprice_5#4473, co_orderkey#4464 AS co_orderkey_5#4474, co_comment#4465 AS co_comment_5#4475]
            +- Relation[co_shippriority#4456,rid#4457,co_orderdate#4458,co_custkey#4459,co_orderpriority#4460,co_clerk#4461,co_orderstatus#4462,co_totalprice#4463,co_orderkey#4464,co_comment#4465] JDBCRelation(torders) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 1032300ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/14 11:22:57 WARN DexPlanner: dexPlan=DexCorrelationPlan
20/04/14 11:22:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4540L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/14 11:22:57 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 11:22:57 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 11:22:57 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/14 11:22:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 11:22:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 11:22:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 11:22:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/14 11:22:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 11:22:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/14 11:22:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4540L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(LeftSemi)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Project ['rid_2, 'cn_regionkey_2, 'cn_nationkey_2, 'cn_name_2, 'cn_comment_2, dexdecrypt('value_dec_key, value#2023) AS rid_3#4590]
         :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_2#4584: binary
         :  :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
         :  :     :  :- Project [rid#4579 AS rid_2#4584, cn_regionkey#4580 AS cn_regionkey_2#4585, cn_nationkey#4581 AS cn_nationkey_2#4586, cn_name#4582 AS cn_name_2#4587, cn_comment#4583 AS cn_comment_2#4588]
         :  :     :  :  +- Relation[rid#4579,cn_regionkey#4580,cn_nationkey#4581,cn_name#4582,cn_comment#4583] JDBCRelation(tnation) [numPartitions=1]
         :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#4589]
         :  :     :     +- DexRidFilter nation~n_name~CANADA
         :  :     :        +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]
         :  :     +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  +- Project [cs_phone#4591 AS cs_phone_3#4599, rid#4592 AS rid_3#4600, cs_address#4593 AS cs_address_3#4601, cs_nationkey#4594 AS cs_nationkey_3#4602, cs_suppkey#4595 AS cs_suppkey_3#4603, cs_name#4596 AS cs_name_3#4604, cs_acctbal#4597 AS cs_acctbal_3#4605, cs_comment#4598 AS cs_comment_3#4606]
         :     +- Relation[cs_phone#4591,rid#4592,cs_address#4593,cs_nationkey#4594,cs_suppkey#4595,cs_name#4596,cs_acctbal#4597,cs_comment#4598] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'Project ['cps_partkey_and_ps_suppkey_1, 'rid_1, 'cps_availqty_1, 'cps_comment_1, 'cps_partkey_1, 'cps_supplycost_1, 'cps_suppkey_1, dexdecrypt('value_dec_key, value#2023) AS rid_3#4578]
            +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, rid_1#4572: binary
               :- 'Join NaturalJoin(LeftSemi)
               :  :- Project [cps_partkey_and_ps_suppkey#4564 AS cps_partkey_and_ps_suppkey_1#4571, rid#4565 AS rid_1#4572, cps_availqty#4566 AS cps_availqty_1#4573, cps_comment#4567 AS cps_comment_1#4574, cps_partkey#4568 AS cps_partkey_1#4575, cps_supplycost#4569 AS cps_supplycost_1#4576, cps_suppkey#4570 AS cps_suppkey_1#4577]
               :  :  +- Relation[cps_partkey_and_ps_suppkey#4564,rid#4565,cps_availqty#4566,cps_comment#4567,cps_partkey#4568,cps_supplycost#4569,cps_suppkey#4570] JDBCRelation(tpartsupp) [numPartitions=1]
               :  +- 'Project ['cp_comment_0, 'cp_name_0, 'rid_0, 'cp_type_0, 'cp_retailprice_0, 'cp_mfgr_0, 'cp_container_0, 'cp_brand_0, 'cp_size_0, 'cp_partkey_0, dexdecrypt('value_dec_key, value#2023) AS rid_1#4563]
               :     +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4554: binary
               :        :- 'Join UsingJoin(LeftSemi,List(rid_0))
               :        :  :- Project [cp_comment#4542 AS cp_comment_0#4552, cp_name#4543 AS cp_name_0#4553, rid#4544 AS rid_0#4554, cp_type#4545 AS cp_type_0#4555, cp_retailprice#4546 AS cp_retailprice_0#4556, cp_mfgr#4547 AS cp_mfgr_0#4557, cp_container#4548 AS cp_container_0#4558, cp_brand#4549 AS cp_brand_0#4559, cp_size#4550 AS cp_size_0#4560, cp_partkey#4551 AS cp_partkey_0#4561]
               :        :  :  +- Relation[cp_comment#4542,cp_name#4543,rid#4544,cp_type#4545,cp_retailprice#4546,cp_mfgr#4547,cp_container#4548,cp_brand#4549,cp_size#4550,cp_partkey#4551] JDBCRelation(tpart) [numPartitions=1]
               :        :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4562]
               :        :     +- DexRidFilter part~p_size~15
               :        :        +- Relation[label#2019,value#2020] JDBCRelation(t_filter) [numPartitions=1]
               :        +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]
               +- Relation[label#2022,value#2023] JDBCRelation(t_correlated_join) [numPartitions=1]

DexCorr$ result size=324
Elapsed time: 4644ms
query=q1, count=6001215, duration=9949
query=q10, count=1478870, duration=402024
query=q11, count=31680, duration=3023
query=q12, count=857401, duration=141197
query=q13, count=1550004, duration=132938
query=q14, count=6001215, duration=150172
query=q15, count=6001215, duration=196782
query=q16, count=15780, duration=16252
query=q17, count=6088, duration=1381
query=q18, count=6001215, duration=1700657
query=q19, count=205, duration=84321
query=q2, count=3162, duration=6828
query=q20, count=324, duration=4644
query=q21a, count=119924, duration=735945
query=q3, count=1214743, duration=68218
query=q4, count=6001215, duration=194623
query=q6, count=6001215, duration=3357
query=q7, count=9735, duration=24801
query=q8, count=8716, duration=19916
query=q9a, count=6001215, duration=1032300
query=q9b, count=6001215, duration=469672
