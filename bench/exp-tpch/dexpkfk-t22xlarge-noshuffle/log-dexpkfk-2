20/04/11 03:22:19 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 11265ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Apr 11 03:22:22 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Apr 11 03:22:24 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Apr 11 03:22:24 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Apr 11 03:22:24 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Apr 11 03:22:24 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Apr 11 03:22:28 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Apr 11 03:22:32 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Apr 11 03:22:32 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/11 03:22:34 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:22:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2078L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 03:22:34 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/11 03:22:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2078L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#2080 AS rid_0#2113, cpfk_orders_lineitem#2081 AS cpfk_orders_lineitem_0#2114, cpfk_supplier_lineitem#2082 AS cpfk_supplier_lineitem_0#2115, cfpk_lineitem_supplier#2083 AS cfpk_lineitem_supplier_0#2116, cfpk_lineitem_partsupp#2084 AS cfpk_lineitem_partsupp_0#2117, cpfk_part_lineitem#2085 AS cpfk_part_lineitem_0#2118, cfpk_lineitem_part#2086 AS cfpk_lineitem_part_0#2119, cpfk_partsupp_lineitem#2087 AS cpfk_partsupp_lineitem_0#2120, cfpk_lineitem_orders#2088 AS cfpk_lineitem_orders_0#2121, cval_lineitem_l_quantity#2089 AS cval_lineitem_l_quantity_0#2122, cval_lineitem_l_extendedprice#2090 AS cval_lineitem_l_extendedprice_0#2123, cval_lineitem_l_discount#2091 AS cval_lineitem_l_discount_0#2124, cval_lineitem_l_tax#2092 AS cval_lineitem_l_tax_0#2125, cval_lineitem_l_returnflag#2093 AS cval_lineitem_l_returnflag_0#2126, cval_lineitem_l_linestatus#2094 AS cval_lineitem_l_linestatus_0#2127, cval_lineitem_l_commitdate#2095 AS cval_lineitem_l_commitdate_0#2128, cval_lineitem_l_receiptdate#2096 AS cval_lineitem_l_receiptdate_0#2129, cval_lineitem_l_shipinstruct#2097 AS cval_lineitem_l_shipinstruct_0#2130, cval_lineitem_l_shipmode#2098 AS cval_lineitem_l_shipmode_0#2131, cval_lineitem_l_comment#2099 AS cval_lineitem_l_comment_0#2132, cval_lineitem_l_shipdate#2100 AS cval_lineitem_l_shipdate_0#2133, cl_quantity#2101 AS cl_quantity_0#2134, cl_extendedprice#2102 AS cl_extendedprice_0#2135, cl_discount#2103 AS cl_discount_0#2136, ... 9 more fields]
            :  :  +- Relation[rid#2080,cpfk_orders_lineitem#2081,cpfk_supplier_lineitem#2082,cfpk_lineitem_supplier#2083,cfpk_lineitem_partsupp#2084,cpfk_part_lineitem#2085,cfpk_lineitem_part#2086,cpfk_partsupp_lineitem#2087,cfpk_lineitem_orders#2088,cval_lineitem_l_quantity#2089,cval_lineitem_l_extendedprice#2090,cval_lineitem_l_discount#2091,cval_lineitem_l_tax#2092,cval_lineitem_l_returnflag#2093,cval_lineitem_l_linestatus#2094,cval_lineitem_l_commitdate#2095,cval_lineitem_l_receiptdate#2096,cval_lineitem_l_shipinstruct#2097,cval_lineitem_l_shipmode#2098,cval_lineitem_l_comment#2099,cval_lineitem_l_shipdate#2100,cl_quantity#2101,cl_extendedprice#2102,cl_discount#2103,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#2146 AS rid_0#2179, cpfk_orders_lineitem#2147 AS cpfk_orders_lineitem_0#2180, cpfk_supplier_lineitem#2148 AS cpfk_supplier_lineitem_0#2181, cfpk_lineitem_supplier#2149 AS cfpk_lineitem_supplier_0#2182, cfpk_lineitem_partsupp#2150 AS cfpk_lineitem_partsupp_0#2183, cpfk_part_lineitem#2151 AS cpfk_part_lineitem_0#2184, cfpk_lineitem_part#2152 AS cfpk_lineitem_part_0#2185, cpfk_partsupp_lineitem#2153 AS cpfk_partsupp_lineitem_0#2186, cfpk_lineitem_orders#2154 AS cfpk_lineitem_orders_0#2187, cval_lineitem_l_quantity#2155 AS cval_lineitem_l_quantity_0#2188, cval_lineitem_l_extendedprice#2156 AS cval_lineitem_l_extendedprice_0#2189, cval_lineitem_l_discount#2157 AS cval_lineitem_l_discount_0#2190, cval_lineitem_l_tax#2158 AS cval_lineitem_l_tax_0#2191, cval_lineitem_l_returnflag#2159 AS cval_lineitem_l_returnflag_0#2192, cval_lineitem_l_linestatus#2160 AS cval_lineitem_l_linestatus_0#2193, cval_lineitem_l_commitdate#2161 AS cval_lineitem_l_commitdate_0#2194, cval_lineitem_l_receiptdate#2162 AS cval_lineitem_l_receiptdate_0#2195, cval_lineitem_l_shipinstruct#2163 AS cval_lineitem_l_shipinstruct_0#2196, cval_lineitem_l_shipmode#2164 AS cval_lineitem_l_shipmode_0#2197, cval_lineitem_l_comment#2165 AS cval_lineitem_l_comment_0#2198, cval_lineitem_l_shipdate#2166 AS cval_lineitem_l_shipdate_0#2199, cl_quantity#2167 AS cl_quantity_0#2200, cl_extendedprice#2168 AS cl_extendedprice_0#2201, cl_discount#2169 AS cl_discount_0#2202, ... 9 more fields]
            :        +- Relation[rid#2146,cpfk_orders_lineitem#2147,cpfk_supplier_lineitem#2148,cfpk_lineitem_supplier#2149,cfpk_lineitem_partsupp#2150,cpfk_part_lineitem#2151,cfpk_lineitem_part#2152,cpfk_partsupp_lineitem#2153,cfpk_lineitem_orders#2154,cval_lineitem_l_quantity#2155,cval_lineitem_l_extendedprice#2156,cval_lineitem_l_discount#2157,cval_lineitem_l_tax#2158,cval_lineitem_l_returnflag#2159,cval_lineitem_l_linestatus#2160,cval_lineitem_l_commitdate#2161,cval_lineitem_l_receiptdate#2162,cval_lineitem_l_shipinstruct#2163,cval_lineitem_l_shipmode#2164,cval_lineitem_l_comment#2165,cval_lineitem_l_shipdate#2166,cl_quantity#2167,cl_extendedprice#2168,cl_discount#2169,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#2212 AS rid_1#2229, cpfk_customer_orders#2213 AS cpfk_customer_orders_1#2230, cfpk_orders_customer#2214 AS cfpk_orders_customer_1#2231, cval_orders_o_orderstatus#2215 AS cval_orders_o_orderstatus_1#2232, cval_orders_o_totalprice#2216 AS cval_orders_o_totalprice_1#2233, cval_orders_o_orderpriority#2217 AS cval_orders_o_orderpriority_1#2234, cval_orders_o_clerk#2218 AS cval_orders_o_clerk_1#2235, cval_orders_o_shippriority#2219 AS cval_orders_o_shippriority_1#2236, cval_orders_o_comment#2220 AS cval_orders_o_comment_1#2237, cval_orders_o_orderdate#2221 AS cval_orders_o_orderdate_1#2238, co_orderstatus#2222 AS co_orderstatus_1#2239, co_totalprice#2223 AS co_totalprice_1#2240, co_orderpriority#2224 AS co_orderpriority_1#2241, co_clerk#2225 AS co_clerk_1#2242, co_shippriority#2226 AS co_shippriority_1#2243, co_comment#2227 AS co_comment_1#2244, co_orderdate#2228 AS co_orderdate_1#2245]
               +- Relation[rid#2212,cpfk_customer_orders#2213,cfpk_orders_customer#2214,cval_orders_o_orderstatus#2215,cval_orders_o_totalprice#2216,cval_orders_o_orderpriority#2217,cval_orders_o_clerk#2218,cval_orders_o_shippriority#2219,cval_orders_o_comment#2220,cval_orders_o_orderdate#2221,co_orderstatus#2222,co_totalprice#2223,co_orderpriority#2224,co_clerk#2225,co_shippriority#2226,co_comment#2227,co_orderdate#2228] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 21675ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/11 03:22:56 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:22:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2305L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 03:22:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:22:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:22:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:22:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:22:56 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:22:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:22:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:22:56 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:22:56 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:22:56 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:22:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2305L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#2307 AS rid_0#2314, cpfk_region_nation#2308 AS cpfk_region_nation_0#2315, cfpk_nation_region#2309 AS cfpk_nation_region_0#2316, cval_nation_n_name#2310 AS cval_nation_n_name_0#2317, cval_nation_n_comment#2311 AS cval_nation_n_comment_0#2318, cn_name#2312 AS cn_name_0#2319, cn_comment#2313 AS cn_comment_0#2320]
            :     :     :  :  :  :  :  +- Relation[rid#2307,cpfk_region_nation#2308,cfpk_nation_region#2309,cval_nation_n_name#2310,cval_nation_n_comment#2311,cn_name#2312,cn_comment#2313] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#2347 AS rid_0#2354, cpfk_region_nation#2348 AS cpfk_region_nation_0#2355, cfpk_nation_region#2349 AS cfpk_nation_region_0#2356, cval_nation_n_name#2350 AS cval_nation_n_name_0#2357, cval_nation_n_comment#2351 AS cval_nation_n_comment_0#2358, cn_name#2352 AS cn_name_0#2359, cn_comment#2353 AS cn_comment_0#2360]
            :     :     :  :  :  :     :  +- Relation[rid#2347,cpfk_region_nation#2348,cfpk_nation_region#2349,cval_nation_n_name#2350,cval_nation_n_comment#2351,cn_name#2352,cn_comment#2353] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#2361 AS rid_1#2374, cpfk_nation_supplier#2362 AS cpfk_nation_supplier_1#2375, cfpk_supplier_nation#2363 AS cfpk_supplier_nation_1#2376, cval_supplier_s_name#2364 AS cval_supplier_s_name_1#2377, cval_supplier_s_address#2365 AS cval_supplier_s_address_1#2378, cval_supplier_s_phone#2366 AS cval_supplier_s_phone_1#2379, cval_supplier_s_acctbal#2367 AS cval_supplier_s_acctbal_1#2380, cval_supplier_s_comment#2368 AS cval_supplier_s_comment_1#2381, cs_name#2369 AS cs_name_1#2382, cs_address#2370 AS cs_address_1#2383, cs_phone#2371 AS cs_phone_1#2384, cs_acctbal#2372 AS cs_acctbal_1#2385, cs_comment#2373 AS cs_comment_1#2386]
            :     :     :  :  :  :        +- Relation[rid#2361,cpfk_nation_supplier#2362,cfpk_supplier_nation#2363,cval_supplier_s_name#2364,cval_supplier_s_address#2365,cval_supplier_s_phone#2366,cval_supplier_s_acctbal#2367,cval_supplier_s_comment#2368,cs_name#2369,cs_address#2370,cs_phone#2371,cs_acctbal#2372,cs_comment#2373] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#2321 AS rid_1#2334, cpfk_nation_supplier#2322 AS cpfk_nation_supplier_1#2335, cfpk_supplier_nation#2323 AS cfpk_supplier_nation_1#2336, cval_supplier_s_name#2324 AS cval_supplier_s_name_1#2337, cval_supplier_s_address#2325 AS cval_supplier_s_address_1#2338, cval_supplier_s_phone#2326 AS cval_supplier_s_phone_1#2339, cval_supplier_s_acctbal#2327 AS cval_supplier_s_acctbal_1#2340, cval_supplier_s_comment#2328 AS cval_supplier_s_comment_1#2341, cs_name#2329 AS cs_name_1#2342, cs_address#2330 AS cs_address_1#2343, cs_phone#2331 AS cs_phone_1#2344, cs_acctbal#2332 AS cs_acctbal_1#2345, cs_comment#2333 AS cs_comment_1#2346]
            :     :     :  :  :     +- Relation[rid#2321,cpfk_nation_supplier#2322,cfpk_supplier_nation#2323,cval_supplier_s_name#2324,cval_supplier_s_address#2325,cval_supplier_s_phone#2326,cval_supplier_s_acctbal#2327,cval_supplier_s_comment#2328,cs_name#2329,cs_address#2330,cs_phone#2331,cs_acctbal#2332,cs_comment#2333] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#2453 AS rid_1#2466, cpfk_nation_supplier#2454 AS cpfk_nation_supplier_1#2467, cfpk_supplier_nation#2455 AS cfpk_supplier_nation_1#2468, cval_supplier_s_name#2456 AS cval_supplier_s_name_1#2469, cval_supplier_s_address#2457 AS cval_supplier_s_address_1#2470, cval_supplier_s_phone#2458 AS cval_supplier_s_phone_1#2471, cval_supplier_s_acctbal#2459 AS cval_supplier_s_acctbal_1#2472, cval_supplier_s_comment#2460 AS cval_supplier_s_comment_1#2473, cs_name#2461 AS cs_name_1#2474, cs_address#2462 AS cs_address_1#2475, cs_phone#2463 AS cs_phone_1#2476, cs_acctbal#2464 AS cs_acctbal_1#2477, cs_comment#2465 AS cs_comment_1#2478]
            :     :     :  :     :  +- Relation[rid#2453,cpfk_nation_supplier#2454,cfpk_supplier_nation#2455,cval_supplier_s_name#2456,cval_supplier_s_address#2457,cval_supplier_s_phone#2458,cval_supplier_s_acctbal#2459,cval_supplier_s_comment#2460,cs_name#2461,cs_address#2462,cs_phone#2463,cs_acctbal#2464,cs_comment#2465] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#2479 AS rid_2#2512, cpfk_orders_lineitem#2480 AS cpfk_orders_lineitem_2#2513, cpfk_supplier_lineitem#2481 AS cpfk_supplier_lineitem_2#2514, cfpk_lineitem_supplier#2482 AS cfpk_lineitem_supplier_2#2515, cfpk_lineitem_partsupp#2483 AS cfpk_lineitem_partsupp_2#2516, cpfk_part_lineitem#2484 AS cpfk_part_lineitem_2#2517, cfpk_lineitem_part#2485 AS cfpk_lineitem_part_2#2518, cpfk_partsupp_lineitem#2486 AS cpfk_partsupp_lineitem_2#2519, cfpk_lineitem_orders#2487 AS cfpk_lineitem_orders_2#2520, cval_lineitem_l_quantity#2488 AS cval_lineitem_l_quantity_2#2521, cval_lineitem_l_extendedprice#2489 AS cval_lineitem_l_extendedprice_2#2522, cval_lineitem_l_discount#2490 AS cval_lineitem_l_discount_2#2523, cval_lineitem_l_tax#2491 AS cval_lineitem_l_tax_2#2524, cval_lineitem_l_returnflag#2492 AS cval_lineitem_l_returnflag_2#2525, cval_lineitem_l_linestatus#2493 AS cval_lineitem_l_linestatus_2#2526, cval_lineitem_l_commitdate#2494 AS cval_lineitem_l_commitdate_2#2527, cval_lineitem_l_receiptdate#2495 AS cval_lineitem_l_receiptdate_2#2528, cval_lineitem_l_shipinstruct#2496 AS cval_lineitem_l_shipinstruct_2#2529, cval_lineitem_l_shipmode#2497 AS cval_lineitem_l_shipmode_2#2530, cval_lineitem_l_comment#2498 AS cval_lineitem_l_comment_2#2531, cval_lineitem_l_shipdate#2499 AS cval_lineitem_l_shipdate_2#2532, cl_quantity#2500 AS cl_quantity_2#2533, cl_extendedprice#2501 AS cl_extendedprice_2#2534, cl_discount#2502 AS cl_discount_2#2535, ... 9 more fields]
            :     :     :  :        +- Relation[rid#2479,cpfk_orders_lineitem#2480,cpfk_supplier_lineitem#2481,cfpk_lineitem_supplier#2482,cfpk_lineitem_partsupp#2483,cpfk_part_lineitem#2484,cfpk_lineitem_part#2485,cpfk_partsupp_lineitem#2486,cfpk_lineitem_orders#2487,cval_lineitem_l_quantity#2488,cval_lineitem_l_extendedprice#2489,cval_lineitem_l_discount#2490,cval_lineitem_l_tax#2491,cval_lineitem_l_returnflag#2492,cval_lineitem_l_linestatus#2493,cval_lineitem_l_commitdate#2494,cval_lineitem_l_receiptdate#2495,cval_lineitem_l_shipinstruct#2496,cval_lineitem_l_shipmode#2497,cval_lineitem_l_comment#2498,cval_lineitem_l_shipdate#2499,cl_quantity#2500,cl_extendedprice#2501,cl_discount#2502,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#2387 AS rid_2#2420, cpfk_orders_lineitem#2388 AS cpfk_orders_lineitem_2#2421, cpfk_supplier_lineitem#2389 AS cpfk_supplier_lineitem_2#2422, cfpk_lineitem_supplier#2390 AS cfpk_lineitem_supplier_2#2423, cfpk_lineitem_partsupp#2391 AS cfpk_lineitem_partsupp_2#2424, cpfk_part_lineitem#2392 AS cpfk_part_lineitem_2#2425, cfpk_lineitem_part#2393 AS cfpk_lineitem_part_2#2426, cpfk_partsupp_lineitem#2394 AS cpfk_partsupp_lineitem_2#2427, cfpk_lineitem_orders#2395 AS cfpk_lineitem_orders_2#2428, cval_lineitem_l_quantity#2396 AS cval_lineitem_l_quantity_2#2429, cval_lineitem_l_extendedprice#2397 AS cval_lineitem_l_extendedprice_2#2430, cval_lineitem_l_discount#2398 AS cval_lineitem_l_discount_2#2431, cval_lineitem_l_tax#2399 AS cval_lineitem_l_tax_2#2432, cval_lineitem_l_returnflag#2400 AS cval_lineitem_l_returnflag_2#2433, cval_lineitem_l_linestatus#2401 AS cval_lineitem_l_linestatus_2#2434, cval_lineitem_l_commitdate#2402 AS cval_lineitem_l_commitdate_2#2435, cval_lineitem_l_receiptdate#2403 AS cval_lineitem_l_receiptdate_2#2436, cval_lineitem_l_shipinstruct#2404 AS cval_lineitem_l_shipinstruct_2#2437, cval_lineitem_l_shipmode#2405 AS cval_lineitem_l_shipmode_2#2438, cval_lineitem_l_comment#2406 AS cval_lineitem_l_comment_2#2439, cval_lineitem_l_shipdate#2407 AS cval_lineitem_l_shipdate_2#2440, cl_quantity#2408 AS cl_quantity_2#2441, cl_extendedprice#2409 AS cl_extendedprice_2#2442, cl_discount#2410 AS cl_discount_2#2443, ... 9 more fields]
            :     :     :     +- Relation[rid#2387,cpfk_orders_lineitem#2388,cpfk_supplier_lineitem#2389,cfpk_lineitem_supplier#2390,cfpk_lineitem_partsupp#2391,cpfk_part_lineitem#2392,cfpk_lineitem_part#2393,cpfk_partsupp_lineitem#2394,cfpk_lineitem_orders#2395,cval_lineitem_l_quantity#2396,cval_lineitem_l_extendedprice#2397,cval_lineitem_l_discount#2398,cval_lineitem_l_tax#2399,cval_lineitem_l_returnflag#2400,cval_lineitem_l_linestatus#2401,cval_lineitem_l_commitdate#2402,cval_lineitem_l_receiptdate#2403,cval_lineitem_l_shipinstruct#2404,cval_lineitem_l_shipmode#2405,cval_lineitem_l_comment#2406,cval_lineitem_l_shipdate#2407,cl_quantity#2408,cl_extendedprice#2409,cl_discount#2410,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#2545 AS rid_3#2562, cval_part_p_name#2546 AS cval_part_p_name_3#2563, cval_part_p_mfgr#2547 AS cval_part_p_mfgr_3#2564, cval_part_p_type#2548 AS cval_part_p_type_3#2565, cval_part_p_size#2549 AS cval_part_p_size_3#2566, cval_part_p_container#2550 AS cval_part_p_container_3#2567, cval_part_p_retailprice#2551 AS cval_part_p_retailprice_3#2568, cval_part_p_comment#2552 AS cval_part_p_comment_3#2569, cval_part_p_brand#2553 AS cval_part_p_brand_3#2570, cp_name#2554 AS cp_name_3#2571, cp_mfgr#2555 AS cp_mfgr_3#2572, cp_type#2556 AS cp_type_3#2573, cp_size#2557 AS cp_size_3#2574, cp_container#2558 AS cp_container_3#2575, cp_retailprice#2559 AS cp_retailprice_3#2576, cp_comment#2560 AS cp_comment_3#2577, cp_brand#2561 AS cp_brand_3#2578]
            :     :        +- Relation[rid#2545,cval_part_p_name#2546,cval_part_p_mfgr#2547,cval_part_p_type#2548,cval_part_p_size#2549,cval_part_p_container#2550,cval_part_p_retailprice#2551,cval_part_p_comment#2552,cval_part_p_brand#2553,cp_name#2554,cp_mfgr#2555,cp_type#2556,cp_size#2557,cp_container#2558,cp_retailprice#2559,cp_comment#2560,cp_brand#2561] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#2579 AS rid_4#2590, cpfk_part_partsupp#2580 AS cpfk_part_partsupp_4#2591, cfpk_partsupp_part#2581 AS cfpk_partsupp_part_4#2592, cpfk_supplier_partsupp#2582 AS cpfk_supplier_partsupp_4#2593, cfpk_partsupp_supplier#2583 AS cfpk_partsupp_supplier_4#2594, cval_partsupp_ps_availqty#2584 AS cval_partsupp_ps_availqty_4#2595, cval_partsupp_ps_supplycost#2585 AS cval_partsupp_ps_supplycost_4#2596, cval_partsupp_ps_comment#2586 AS cval_partsupp_ps_comment_4#2597, cps_availqty#2587 AS cps_availqty_4#2598, cps_supplycost#2588 AS cps_supplycost_4#2599, cps_comment#2589 AS cps_comment_4#2600]
            :        +- Relation[rid#2579,cpfk_part_partsupp#2580,cfpk_partsupp_part#2581,cpfk_supplier_partsupp#2582,cfpk_partsupp_supplier#2583,cval_partsupp_ps_availqty#2584,cval_partsupp_ps_supplycost#2585,cval_partsupp_ps_comment#2586,cps_availqty#2587,cps_supplycost#2588,cps_comment#2589] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#2601 AS rid_5#2618, cpfk_customer_orders#2602 AS cpfk_customer_orders_5#2619, cfpk_orders_customer#2603 AS cfpk_orders_customer_5#2620, cval_orders_o_orderstatus#2604 AS cval_orders_o_orderstatus_5#2621, cval_orders_o_totalprice#2605 AS cval_orders_o_totalprice_5#2622, cval_orders_o_orderpriority#2606 AS cval_orders_o_orderpriority_5#2623, cval_orders_o_clerk#2607 AS cval_orders_o_clerk_5#2624, cval_orders_o_shippriority#2608 AS cval_orders_o_shippriority_5#2625, cval_orders_o_comment#2609 AS cval_orders_o_comment_5#2626, cval_orders_o_orderdate#2610 AS cval_orders_o_orderdate_5#2627, co_orderstatus#2611 AS co_orderstatus_5#2628, co_totalprice#2612 AS co_totalprice_5#2629, co_orderpriority#2613 AS co_orderpriority_5#2630, co_clerk#2614 AS co_clerk_5#2631, co_shippriority#2615 AS co_shippriority_5#2632, co_comment#2616 AS co_comment_5#2633, co_orderdate#2617 AS co_orderdate_5#2634]
               +- Relation[rid#2601,cpfk_customer_orders#2602,cfpk_orders_customer#2603,cval_orders_o_orderstatus#2604,cval_orders_o_totalprice#2605,cval_orders_o_orderpriority#2606,cval_orders_o_clerk#2607,cval_orders_o_shippriority#2608,cval_orders_o_comment#2609,cval_orders_o_orderdate#2610,co_orderstatus#2611,co_totalprice#2612,co_orderpriority#2613,co_clerk#2614,co_shippriority#2615,co_comment#2616,co_orderdate#2617] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 242237ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/11 03:26:58 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:26:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2738L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/11 03:26:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2738L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#2740 AS rid_0#2757, cpfk_customer_orders#2741 AS cpfk_customer_orders_0#2758, cfpk_orders_customer#2742 AS cfpk_orders_customer_0#2759, cval_orders_o_orderstatus#2743 AS cval_orders_o_orderstatus_0#2760, cval_orders_o_totalprice#2744 AS cval_orders_o_totalprice_0#2761, cval_orders_o_orderpriority#2745 AS cval_orders_o_orderpriority_0#2762, cval_orders_o_clerk#2746 AS cval_orders_o_clerk_0#2763, cval_orders_o_shippriority#2747 AS cval_orders_o_shippriority_0#2764, cval_orders_o_comment#2748 AS cval_orders_o_comment_0#2765, cval_orders_o_orderdate#2749 AS cval_orders_o_orderdate_0#2766, co_orderstatus#2750 AS co_orderstatus_0#2767, co_totalprice#2751 AS co_totalprice_0#2768, co_orderpriority#2752 AS co_orderpriority_0#2769, co_clerk#2753 AS co_clerk_0#2770, co_shippriority#2754 AS co_shippriority_0#2771, co_comment#2755 AS co_comment_0#2772, co_orderdate#2756 AS co_orderdate_0#2773]
            :  +- Relation[rid#2740,cpfk_customer_orders#2741,cfpk_orders_customer#2742,cval_orders_o_orderstatus#2743,cval_orders_o_totalprice#2744,cval_orders_o_orderpriority#2745,cval_orders_o_clerk#2746,cval_orders_o_shippriority#2747,cval_orders_o_comment#2748,cval_orders_o_orderdate#2749,co_orderstatus#2750,co_totalprice#2751,co_orderpriority#2752,co_clerk#2753,co_shippriority#2754,co_comment#2755,co_orderdate#2756] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#2774 AS rid_1#2789, cpfk_nation_customer#2775 AS cpfk_nation_customer_1#2790, cfpk_customer_nation#2776 AS cfpk_customer_nation_1#2791, cval_customer_c_name#2777 AS cval_customer_c_name_1#2792, cval_customer_c_address#2778 AS cval_customer_c_address_1#2793, cval_customer_c_phone#2779 AS cval_customer_c_phone_1#2794, cval_customer_c_acctbal#2780 AS cval_customer_c_acctbal_1#2795, cval_customer_c_comment#2781 AS cval_customer_c_comment_1#2796, cval_customer_c_mktsegment#2782 AS cval_customer_c_mktsegment_1#2797, cc_name#2783 AS cc_name_1#2798, cc_address#2784 AS cc_address_1#2799, cc_phone#2785 AS cc_phone_1#2800, cc_acctbal#2786 AS cc_acctbal_1#2801, cc_comment#2787 AS cc_comment_1#2802, cc_mktsegment#2788 AS cc_mktsegment_1#2803]
               +- Relation[rid#2774,cpfk_nation_customer#2775,cfpk_customer_nation#2776,cval_customer_c_name#2777,cval_customer_c_address#2778,cval_customer_c_phone#2779,cval_customer_c_acctbal#2780,cval_customer_c_comment#2781,cval_customer_c_mktsegment#2782,cc_name#2783,cc_address#2784,cc_phone#2785,cc_acctbal#2786,cc_comment#2787,cc_mktsegment#2788] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 13017ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/11 03:27:11 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:27:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2842L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 03:27:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2842L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#2844 AS rid_0#2861, cval_part_p_name#2845 AS cval_part_p_name_0#2862, cval_part_p_mfgr#2846 AS cval_part_p_mfgr_0#2863, cval_part_p_type#2847 AS cval_part_p_type_0#2864, cval_part_p_size#2848 AS cval_part_p_size_0#2865, cval_part_p_container#2849 AS cval_part_p_container_0#2866, cval_part_p_retailprice#2850 AS cval_part_p_retailprice_0#2867, cval_part_p_comment#2851 AS cval_part_p_comment_0#2868, cval_part_p_brand#2852 AS cval_part_p_brand_0#2869, cp_name#2853 AS cp_name_0#2870, cp_mfgr#2854 AS cp_mfgr_0#2871, cp_type#2855 AS cp_type_0#2872, cp_size#2856 AS cp_size_0#2873, cp_container#2857 AS cp_container_0#2874, cp_retailprice#2858 AS cp_retailprice_0#2875, cp_comment#2859 AS cp_comment_0#2876, cp_brand#2860 AS cp_brand_0#2877]
         :  :  +- Relation[rid#2844,cval_part_p_name#2845,cval_part_p_mfgr#2846,cval_part_p_type#2847,cval_part_p_size#2848,cval_part_p_container#2849,cval_part_p_retailprice#2850,cval_part_p_comment#2851,cval_part_p_brand#2852,cp_name#2853,cp_mfgr#2854,cp_type#2855,cp_size#2856,cp_container#2857,cp_retailprice#2858,cp_comment#2859,cp_brand#2860] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#2944 AS rid_0#2961, cval_part_p_name#2945 AS cval_part_p_name_0#2962, cval_part_p_mfgr#2946 AS cval_part_p_mfgr_0#2963, cval_part_p_type#2947 AS cval_part_p_type_0#2964, cval_part_p_size#2948 AS cval_part_p_size_0#2965, cval_part_p_container#2949 AS cval_part_p_container_0#2966, cval_part_p_retailprice#2950 AS cval_part_p_retailprice_0#2967, cval_part_p_comment#2951 AS cval_part_p_comment_0#2968, cval_part_p_brand#2952 AS cval_part_p_brand_0#2969, cp_name#2953 AS cp_name_0#2970, cp_mfgr#2954 AS cp_mfgr_0#2971, cp_type#2955 AS cp_type_0#2972, cp_size#2956 AS cp_size_0#2973, cp_container#2957 AS cp_container_0#2974, cp_retailprice#2958 AS cp_retailprice_0#2975, cp_comment#2959 AS cp_comment_0#2976, cp_brand#2960 AS cp_brand_0#2977]
         :     :  +- Relation[rid#2944,cval_part_p_name#2945,cval_part_p_mfgr#2946,cval_part_p_type#2947,cval_part_p_size#2948,cval_part_p_container#2949,cval_part_p_retailprice#2950,cval_part_p_comment#2951,cval_part_p_brand#2952,cp_name#2953,cp_mfgr#2954,cp_type#2955,cp_size#2956,cp_container#2957,cp_retailprice#2958,cp_comment#2959,cp_brand#2960] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#2978 AS rid_1#3011, cpfk_orders_lineitem#2979 AS cpfk_orders_lineitem_1#3012, cpfk_supplier_lineitem#2980 AS cpfk_supplier_lineitem_1#3013, cfpk_lineitem_supplier#2981 AS cfpk_lineitem_supplier_1#3014, cfpk_lineitem_partsupp#2982 AS cfpk_lineitem_partsupp_1#3015, cpfk_part_lineitem#2983 AS cpfk_part_lineitem_1#3016, cfpk_lineitem_part#2984 AS cfpk_lineitem_part_1#3017, cpfk_partsupp_lineitem#2985 AS cpfk_partsupp_lineitem_1#3018, cfpk_lineitem_orders#2986 AS cfpk_lineitem_orders_1#3019, cval_lineitem_l_quantity#2987 AS cval_lineitem_l_quantity_1#3020, cval_lineitem_l_extendedprice#2988 AS cval_lineitem_l_extendedprice_1#3021, cval_lineitem_l_discount#2989 AS cval_lineitem_l_discount_1#3022, cval_lineitem_l_tax#2990 AS cval_lineitem_l_tax_1#3023, cval_lineitem_l_returnflag#2991 AS cval_lineitem_l_returnflag_1#3024, cval_lineitem_l_linestatus#2992 AS cval_lineitem_l_linestatus_1#3025, cval_lineitem_l_commitdate#2993 AS cval_lineitem_l_commitdate_1#3026, cval_lineitem_l_receiptdate#2994 AS cval_lineitem_l_receiptdate_1#3027, cval_lineitem_l_shipinstruct#2995 AS cval_lineitem_l_shipinstruct_1#3028, cval_lineitem_l_shipmode#2996 AS cval_lineitem_l_shipmode_1#3029, cval_lineitem_l_comment#2997 AS cval_lineitem_l_comment_1#3030, cval_lineitem_l_shipdate#2998 AS cval_lineitem_l_shipdate_1#3031, cl_quantity#2999 AS cl_quantity_1#3032, cl_extendedprice#3000 AS cl_extendedprice_1#3033, cl_discount#3001 AS cl_discount_1#3034, ... 9 more fields]
         :        +- Relation[rid#2978,cpfk_orders_lineitem#2979,cpfk_supplier_lineitem#2980,cfpk_lineitem_supplier#2981,cfpk_lineitem_partsupp#2982,cpfk_part_lineitem#2983,cfpk_lineitem_part#2984,cpfk_partsupp_lineitem#2985,cfpk_lineitem_orders#2986,cval_lineitem_l_quantity#2987,cval_lineitem_l_extendedprice#2988,cval_lineitem_l_discount#2989,cval_lineitem_l_tax#2990,cval_lineitem_l_returnflag#2991,cval_lineitem_l_linestatus#2992,cval_lineitem_l_commitdate#2993,cval_lineitem_l_receiptdate#2994,cval_lineitem_l_shipinstruct#2995,cval_lineitem_l_shipmode#2996,cval_lineitem_l_comment#2997,cval_lineitem_l_shipdate#2998,cl_quantity#2999,cl_extendedprice#3000,cl_discount#3001,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2878 AS rid_1#2911, cpfk_orders_lineitem#2879 AS cpfk_orders_lineitem_1#2912, cpfk_supplier_lineitem#2880 AS cpfk_supplier_lineitem_1#2913, cfpk_lineitem_supplier#2881 AS cfpk_lineitem_supplier_1#2914, cfpk_lineitem_partsupp#2882 AS cfpk_lineitem_partsupp_1#2915, cpfk_part_lineitem#2883 AS cpfk_part_lineitem_1#2916, cfpk_lineitem_part#2884 AS cfpk_lineitem_part_1#2917, cpfk_partsupp_lineitem#2885 AS cpfk_partsupp_lineitem_1#2918, cfpk_lineitem_orders#2886 AS cfpk_lineitem_orders_1#2919, cval_lineitem_l_quantity#2887 AS cval_lineitem_l_quantity_1#2920, cval_lineitem_l_extendedprice#2888 AS cval_lineitem_l_extendedprice_1#2921, cval_lineitem_l_discount#2889 AS cval_lineitem_l_discount_1#2922, cval_lineitem_l_tax#2890 AS cval_lineitem_l_tax_1#2923, cval_lineitem_l_returnflag#2891 AS cval_lineitem_l_returnflag_1#2924, cval_lineitem_l_linestatus#2892 AS cval_lineitem_l_linestatus_1#2925, cval_lineitem_l_commitdate#2893 AS cval_lineitem_l_commitdate_1#2926, cval_lineitem_l_receiptdate#2894 AS cval_lineitem_l_receiptdate_1#2927, cval_lineitem_l_shipinstruct#2895 AS cval_lineitem_l_shipinstruct_1#2928, cval_lineitem_l_shipmode#2896 AS cval_lineitem_l_shipmode_1#2929, cval_lineitem_l_comment#2897 AS cval_lineitem_l_comment_1#2930, cval_lineitem_l_shipdate#2898 AS cval_lineitem_l_shipdate_1#2931, cl_quantity#2899 AS cl_quantity_1#2932, cl_extendedprice#2900 AS cl_extendedprice_1#2933, cl_discount#2901 AS cl_discount_1#2934, ... 9 more fields]
            +- Relation[rid#2878,cpfk_orders_lineitem#2879,cpfk_supplier_lineitem#2880,cfpk_lineitem_supplier#2881,cfpk_lineitem_partsupp#2882,cpfk_part_lineitem#2883,cfpk_lineitem_part#2884,cpfk_partsupp_lineitem#2885,cfpk_lineitem_orders#2886,cval_lineitem_l_quantity#2887,cval_lineitem_l_extendedprice#2888,cval_lineitem_l_discount#2889,cval_lineitem_l_tax#2890,cval_lineitem_l_returnflag#2891,cval_lineitem_l_linestatus#2892,cval_lineitem_l_commitdate#2893,cval_lineitem_l_receiptdate#2894,cval_lineitem_l_shipinstruct#2895,cval_lineitem_l_shipmode#2896,cval_lineitem_l_comment#2897,cval_lineitem_l_shipdate#2898,cl_quantity#2899,cl_extendedprice#2900,cl_discount#2901,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 82242ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/11 03:28:33 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:28:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3102L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 03:28:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:28:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:28:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:28:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:28:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:28:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:28:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:28:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:28:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:28:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:28:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:28:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:28:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:28:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:28:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:28:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3102L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#3104 AS rid_0#3111, cpfk_region_nation#3105 AS cpfk_region_nation_0#3112, cfpk_nation_region#3106 AS cfpk_nation_region_0#3113, cval_nation_n_name#3107 AS cval_nation_n_name_0#3114, cval_nation_n_comment#3108 AS cval_nation_n_comment_0#3115, cn_name#3109 AS cn_name_0#3116, cn_comment#3110 AS cn_comment_0#3117]
            :  :  :  :  :  :  +- Relation[rid#3104,cpfk_region_nation#3105,cfpk_nation_region#3106,cval_nation_n_name#3107,cval_nation_n_comment#3108,cn_name#3109,cn_comment#3110] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#3118 AS rid_0#3125, cpfk_region_nation#3119 AS cpfk_region_nation_0#3126, cfpk_nation_region#3120 AS cfpk_nation_region_0#3127, cval_nation_n_name#3121 AS cval_nation_n_name_0#3128, cval_nation_n_comment#3122 AS cval_nation_n_comment_0#3129, cn_name#3123 AS cn_name_0#3130, cn_comment#3124 AS cn_comment_0#3131]
            :  :  :  :  :        +- Relation[rid#3118,cpfk_region_nation#3119,cfpk_nation_region#3120,cval_nation_n_name#3121,cval_nation_n_comment#3122,cn_name#3123,cn_comment#3124] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :     :- Project [rid#3158 AS rid_0#3165, cpfk_region_nation#3159 AS cpfk_region_nation_0#3166, cfpk_nation_region#3160 AS cfpk_nation_region_0#3167, cval_nation_n_name#3161 AS cval_nation_n_name_0#3168, cval_nation_n_comment#3162 AS cval_nation_n_comment_0#3169, cn_name#3163 AS cn_name_0#3170, cn_comment#3164 AS cn_comment_0#3171]
            :  :  :  :     :  +- Relation[rid#3158,cpfk_region_nation#3159,cfpk_nation_region#3160,cval_nation_n_name#3161,cval_nation_n_comment#3162,cn_name#3163,cn_comment#3164] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :     +- Project [rid#3172 AS rid_1#3185, cpfk_nation_supplier#3173 AS cpfk_nation_supplier_1#3186, cfpk_supplier_nation#3174 AS cfpk_supplier_nation_1#3187, cval_supplier_s_name#3175 AS cval_supplier_s_name_1#3188, cval_supplier_s_address#3176 AS cval_supplier_s_address_1#3189, cval_supplier_s_phone#3177 AS cval_supplier_s_phone_1#3190, cval_supplier_s_acctbal#3178 AS cval_supplier_s_acctbal_1#3191, cval_supplier_s_comment#3179 AS cval_supplier_s_comment_1#3192, cs_name#3180 AS cs_name_1#3193, cs_address#3181 AS cs_address_1#3194, cs_phone#3182 AS cs_phone_1#3195, cs_acctbal#3183 AS cs_acctbal_1#3196, cs_comment#3184 AS cs_comment_1#3197]
            :  :  :  :        +- Relation[rid#3172,cpfk_nation_supplier#3173,cfpk_supplier_nation#3174,cval_supplier_s_name#3175,cval_supplier_s_address#3176,cval_supplier_s_phone#3177,cval_supplier_s_acctbal#3178,cval_supplier_s_comment#3179,cs_name#3180,cs_address#3181,cs_phone#3182,cs_acctbal#3183,cs_comment#3184] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#3132 AS rid_1#3145, cpfk_nation_supplier#3133 AS cpfk_nation_supplier_1#3146, cfpk_supplier_nation#3134 AS cfpk_supplier_nation_1#3147, cval_supplier_s_name#3135 AS cval_supplier_s_name_1#3148, cval_supplier_s_address#3136 AS cval_supplier_s_address_1#3149, cval_supplier_s_phone#3137 AS cval_supplier_s_phone_1#3150, cval_supplier_s_acctbal#3138 AS cval_supplier_s_acctbal_1#3151, cval_supplier_s_comment#3139 AS cval_supplier_s_comment_1#3152, cs_name#3140 AS cs_name_1#3153, cs_address#3141 AS cs_address_1#3154, cs_phone#3142 AS cs_phone_1#3155, cs_acctbal#3143 AS cs_acctbal_1#3156, cs_comment#3144 AS cs_comment_1#3157]
            :  :  :     +- Relation[rid#3132,cpfk_nation_supplier#3133,cfpk_supplier_nation#3134,cval_supplier_s_name#3135,cval_supplier_s_address#3136,cval_supplier_s_phone#3137,cval_supplier_s_acctbal#3138,cval_supplier_s_comment#3139,cs_name#3140,cs_address#3141,cs_phone#3142,cs_acctbal#3143,cs_comment#3144] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :     :- Project [rid#3264 AS rid_1#3277, cpfk_nation_supplier#3265 AS cpfk_nation_supplier_1#3278, cfpk_supplier_nation#3266 AS cfpk_supplier_nation_1#3279, cval_supplier_s_name#3267 AS cval_supplier_s_name_1#3280, cval_supplier_s_address#3268 AS cval_supplier_s_address_1#3281, cval_supplier_s_phone#3269 AS cval_supplier_s_phone_1#3282, cval_supplier_s_acctbal#3270 AS cval_supplier_s_acctbal_1#3283, cval_supplier_s_comment#3271 AS cval_supplier_s_comment_1#3284, cs_name#3272 AS cs_name_1#3285, cs_address#3273 AS cs_address_1#3286, cs_phone#3274 AS cs_phone_1#3287, cs_acctbal#3275 AS cs_acctbal_1#3288, cs_comment#3276 AS cs_comment_1#3289]
            :  :     :  +- Relation[rid#3264,cpfk_nation_supplier#3265,cfpk_supplier_nation#3266,cval_supplier_s_name#3267,cval_supplier_s_address#3268,cval_supplier_s_phone#3269,cval_supplier_s_acctbal#3270,cval_supplier_s_comment#3271,cs_name#3272,cs_address#3273,cs_phone#3274,cs_acctbal#3275,cs_comment#3276] JDBCRelation(tsupplier) [numPartitions=1]
            :  :     +- Project [rid#3290 AS rid_2#3323, cpfk_orders_lineitem#3291 AS cpfk_orders_lineitem_2#3324, cpfk_supplier_lineitem#3292 AS cpfk_supplier_lineitem_2#3325, cfpk_lineitem_supplier#3293 AS cfpk_lineitem_supplier_2#3326, cfpk_lineitem_partsupp#3294 AS cfpk_lineitem_partsupp_2#3327, cpfk_part_lineitem#3295 AS cpfk_part_lineitem_2#3328, cfpk_lineitem_part#3296 AS cfpk_lineitem_part_2#3329, cpfk_partsupp_lineitem#3297 AS cpfk_partsupp_lineitem_2#3330, cfpk_lineitem_orders#3298 AS cfpk_lineitem_orders_2#3331, cval_lineitem_l_quantity#3299 AS cval_lineitem_l_quantity_2#3332, cval_lineitem_l_extendedprice#3300 AS cval_lineitem_l_extendedprice_2#3333, cval_lineitem_l_discount#3301 AS cval_lineitem_l_discount_2#3334, cval_lineitem_l_tax#3302 AS cval_lineitem_l_tax_2#3335, cval_lineitem_l_returnflag#3303 AS cval_lineitem_l_returnflag_2#3336, cval_lineitem_l_linestatus#3304 AS cval_lineitem_l_linestatus_2#3337, cval_lineitem_l_commitdate#3305 AS cval_lineitem_l_commitdate_2#3338, cval_lineitem_l_receiptdate#3306 AS cval_lineitem_l_receiptdate_2#3339, cval_lineitem_l_shipinstruct#3307 AS cval_lineitem_l_shipinstruct_2#3340, cval_lineitem_l_shipmode#3308 AS cval_lineitem_l_shipmode_2#3341, cval_lineitem_l_comment#3309 AS cval_lineitem_l_comment_2#3342, cval_lineitem_l_shipdate#3310 AS cval_lineitem_l_shipdate_2#3343, cl_quantity#3311 AS cl_quantity_2#3344, cl_extendedprice#3312 AS cl_extendedprice_2#3345, cl_discount#3313 AS cl_discount_2#3346, ... 9 more fields]
            :  :        +- Relation[rid#3290,cpfk_orders_lineitem#3291,cpfk_supplier_lineitem#3292,cfpk_lineitem_supplier#3293,cfpk_lineitem_partsupp#3294,cpfk_part_lineitem#3295,cfpk_lineitem_part#3296,cpfk_partsupp_lineitem#3297,cfpk_lineitem_orders#3298,cval_lineitem_l_quantity#3299,cval_lineitem_l_extendedprice#3300,cval_lineitem_l_discount#3301,cval_lineitem_l_tax#3302,cval_lineitem_l_returnflag#3303,cval_lineitem_l_linestatus#3304,cval_lineitem_l_commitdate#3305,cval_lineitem_l_receiptdate#3306,cval_lineitem_l_shipinstruct#3307,cval_lineitem_l_shipmode#3308,cval_lineitem_l_comment#3309,cval_lineitem_l_shipdate#3310,cl_quantity#3311,cl_extendedprice#3312,cl_discount#3313,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#3198 AS rid_2#3231, cpfk_orders_lineitem#3199 AS cpfk_orders_lineitem_2#3232, cpfk_supplier_lineitem#3200 AS cpfk_supplier_lineitem_2#3233, cfpk_lineitem_supplier#3201 AS cfpk_lineitem_supplier_2#3234, cfpk_lineitem_partsupp#3202 AS cfpk_lineitem_partsupp_2#3235, cpfk_part_lineitem#3203 AS cpfk_part_lineitem_2#3236, cfpk_lineitem_part#3204 AS cfpk_lineitem_part_2#3237, cpfk_partsupp_lineitem#3205 AS cpfk_partsupp_lineitem_2#3238, cfpk_lineitem_orders#3206 AS cfpk_lineitem_orders_2#3239, cval_lineitem_l_quantity#3207 AS cval_lineitem_l_quantity_2#3240, cval_lineitem_l_extendedprice#3208 AS cval_lineitem_l_extendedprice_2#3241, cval_lineitem_l_discount#3209 AS cval_lineitem_l_discount_2#3242, cval_lineitem_l_tax#3210 AS cval_lineitem_l_tax_2#3243, cval_lineitem_l_returnflag#3211 AS cval_lineitem_l_returnflag_2#3244, cval_lineitem_l_linestatus#3212 AS cval_lineitem_l_linestatus_2#3245, cval_lineitem_l_commitdate#3213 AS cval_lineitem_l_commitdate_2#3246, cval_lineitem_l_receiptdate#3214 AS cval_lineitem_l_receiptdate_2#3247, cval_lineitem_l_shipinstruct#3215 AS cval_lineitem_l_shipinstruct_2#3248, cval_lineitem_l_shipmode#3216 AS cval_lineitem_l_shipmode_2#3249, cval_lineitem_l_comment#3217 AS cval_lineitem_l_comment_2#3250, cval_lineitem_l_shipdate#3218 AS cval_lineitem_l_shipdate_2#3251, cl_quantity#3219 AS cl_quantity_2#3252, cl_extendedprice#3220 AS cl_extendedprice_2#3253, cl_discount#3221 AS cl_discount_2#3254, ... 9 more fields]
            :     +- Relation[rid#3198,cpfk_orders_lineitem#3199,cpfk_supplier_lineitem#3200,cfpk_lineitem_supplier#3201,cfpk_lineitem_partsupp#3202,cpfk_part_lineitem#3203,cfpk_lineitem_part#3204,cpfk_partsupp_lineitem#3205,cfpk_lineitem_orders#3206,cval_lineitem_l_quantity#3207,cval_lineitem_l_extendedprice#3208,cval_lineitem_l_discount#3209,cval_lineitem_l_tax#3210,cval_lineitem_l_returnflag#3211,cval_lineitem_l_linestatus#3212,cval_lineitem_l_commitdate#3213,cval_lineitem_l_receiptdate#3214,cval_lineitem_l_shipinstruct#3215,cval_lineitem_l_shipmode#3216,cval_lineitem_l_comment#3217,cval_lineitem_l_shipdate#3218,cl_quantity#3219,cl_extendedprice#3220,cl_discount#3221,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'Join UsingJoin(Inner,List(rid_4))
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'Join UsingJoin(Inner,List(rid_3))
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#3356 AS rid_3#3363, cpfk_region_nation#3357 AS cpfk_region_nation_3#3364, cfpk_nation_region#3358 AS cfpk_nation_region_3#3365, cval_nation_n_name#3359 AS cval_nation_n_name_3#3366, cval_nation_n_comment#3360 AS cval_nation_n_comment_3#3367, cn_name#3361 AS cn_name_3#3368, cn_comment#3362 AS cn_comment_3#3369]
               :  :  :  :  :  +- Relation[rid#3356,cpfk_region_nation#3357,cfpk_nation_region#3358,cval_nation_n_name#3359,cval_nation_n_comment#3360,cn_name#3361,cn_comment#3362] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#3370 AS rid_3#3377, cpfk_region_nation#3371 AS cpfk_region_nation_3#3378, cfpk_nation_region#3372 AS cfpk_nation_region_3#3379, cval_nation_n_name#3373 AS cval_nation_n_name_3#3380, cval_nation_n_comment#3374 AS cval_nation_n_comment_3#3381, cn_name#3375 AS cn_name_3#3382, cn_comment#3376 AS cn_comment_3#3383]
               :  :  :  :        +- Relation[rid#3370,cpfk_region_nation#3371,cfpk_nation_region#3372,cval_nation_n_name#3373,cval_nation_n_comment#3374,cn_name#3375,cn_comment#3376] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :     :- Project [rid#3414 AS rid_3#3421, cpfk_region_nation#3415 AS cpfk_region_nation_3#3422, cfpk_nation_region#3416 AS cfpk_nation_region_3#3423, cval_nation_n_name#3417 AS cval_nation_n_name_3#3424, cval_nation_n_comment#3418 AS cval_nation_n_comment_3#3425, cn_name#3419 AS cn_name_3#3426, cn_comment#3420 AS cn_comment_3#3427]
               :  :  :     :  +- Relation[rid#3414,cpfk_region_nation#3415,cfpk_nation_region#3416,cval_nation_n_name#3417,cval_nation_n_comment#3418,cn_name#3419,cn_comment#3420] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#3428 AS rid_4#3443, cpfk_nation_customer#3429 AS cpfk_nation_customer_4#3444, cfpk_customer_nation#3430 AS cfpk_customer_nation_4#3445, cval_customer_c_name#3431 AS cval_customer_c_name_4#3446, cval_customer_c_address#3432 AS cval_customer_c_address_4#3447, cval_customer_c_phone#3433 AS cval_customer_c_phone_4#3448, cval_customer_c_acctbal#3434 AS cval_customer_c_acctbal_4#3449, cval_customer_c_comment#3435 AS cval_customer_c_comment_4#3450, cval_customer_c_mktsegment#3436 AS cval_customer_c_mktsegment_4#3451, cc_name#3437 AS cc_name_4#3452, cc_address#3438 AS cc_address_4#3453, cc_phone#3439 AS cc_phone_4#3454, cc_acctbal#3440 AS cc_acctbal_4#3455, cc_comment#3441 AS cc_comment_4#3456, cc_mktsegment#3442 AS cc_mktsegment_4#3457]
               :  :  :        +- Relation[rid#3428,cpfk_nation_customer#3429,cfpk_customer_nation#3430,cval_customer_c_name#3431,cval_customer_c_address#3432,cval_customer_c_phone#3433,cval_customer_c_acctbal#3434,cval_customer_c_comment#3435,cval_customer_c_mktsegment#3436,cc_name#3437,cc_address#3438,cc_phone#3439,cc_acctbal#3440,cc_comment#3441,cc_mktsegment#3442] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#3384 AS rid_4#3399, cpfk_nation_customer#3385 AS cpfk_nation_customer_4#3400, cfpk_customer_nation#3386 AS cfpk_customer_nation_4#3401, cval_customer_c_name#3387 AS cval_customer_c_name_4#3402, cval_customer_c_address#3388 AS cval_customer_c_address_4#3403, cval_customer_c_phone#3389 AS cval_customer_c_phone_4#3404, cval_customer_c_acctbal#3390 AS cval_customer_c_acctbal_4#3405, cval_customer_c_comment#3391 AS cval_customer_c_comment_4#3406, cval_customer_c_mktsegment#3392 AS cval_customer_c_mktsegment_4#3407, cc_name#3393 AS cc_name_4#3408, cc_address#3394 AS cc_address_4#3409, cc_phone#3395 AS cc_phone_4#3410, cc_acctbal#3396 AS cc_acctbal_4#3411, cc_comment#3397 AS cc_comment_4#3412, cc_mktsegment#3398 AS cc_mktsegment_4#3413]
               :  :     +- Relation[rid#3384,cpfk_nation_customer#3385,cfpk_customer_nation#3386,cval_customer_c_name#3387,cval_customer_c_address#3388,cval_customer_c_phone#3389,cval_customer_c_acctbal#3390,cval_customer_c_comment#3391,cval_customer_c_mktsegment#3392,cc_name#3393,cc_address#3394,cc_phone#3395,cc_acctbal#3396,cc_comment#3397,cc_mktsegment#3398] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :     :- Project [rid#3492 AS rid_4#3507, cpfk_nation_customer#3493 AS cpfk_nation_customer_4#3508, cfpk_customer_nation#3494 AS cfpk_customer_nation_4#3509, cval_customer_c_name#3495 AS cval_customer_c_name_4#3510, cval_customer_c_address#3496 AS cval_customer_c_address_4#3511, cval_customer_c_phone#3497 AS cval_customer_c_phone_4#3512, cval_customer_c_acctbal#3498 AS cval_customer_c_acctbal_4#3513, cval_customer_c_comment#3499 AS cval_customer_c_comment_4#3514, cval_customer_c_mktsegment#3500 AS cval_customer_c_mktsegment_4#3515, cc_name#3501 AS cc_name_4#3516, cc_address#3502 AS cc_address_4#3517, cc_phone#3503 AS cc_phone_4#3518, cc_acctbal#3504 AS cc_acctbal_4#3519, cc_comment#3505 AS cc_comment_4#3520, cc_mktsegment#3506 AS cc_mktsegment_4#3521]
               :     :  +- Relation[rid#3492,cpfk_nation_customer#3493,cfpk_customer_nation#3494,cval_customer_c_name#3495,cval_customer_c_address#3496,cval_customer_c_phone#3497,cval_customer_c_acctbal#3498,cval_customer_c_comment#3499,cval_customer_c_mktsegment#3500,cc_name#3501,cc_address#3502,cc_phone#3503,cc_acctbal#3504,cc_comment#3505,cc_mktsegment#3506] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#3522 AS rid_5#3539, cpfk_customer_orders#3523 AS cpfk_customer_orders_5#3540, cfpk_orders_customer#3524 AS cfpk_orders_customer_5#3541, cval_orders_o_orderstatus#3525 AS cval_orders_o_orderstatus_5#3542, cval_orders_o_totalprice#3526 AS cval_orders_o_totalprice_5#3543, cval_orders_o_orderpriority#3527 AS cval_orders_o_orderpriority_5#3544, cval_orders_o_clerk#3528 AS cval_orders_o_clerk_5#3545, cval_orders_o_shippriority#3529 AS cval_orders_o_shippriority_5#3546, cval_orders_o_comment#3530 AS cval_orders_o_comment_5#3547, cval_orders_o_orderdate#3531 AS cval_orders_o_orderdate_5#3548, co_orderstatus#3532 AS co_orderstatus_5#3549, co_totalprice#3533 AS co_totalprice_5#3550, co_orderpriority#3534 AS co_orderpriority_5#3551, co_clerk#3535 AS co_clerk_5#3552, co_shippriority#3536 AS co_shippriority_5#3553, co_comment#3537 AS co_comment_5#3554, co_orderdate#3538 AS co_orderdate_5#3555]
               :        +- Relation[rid#3522,cpfk_customer_orders#3523,cfpk_orders_customer#3524,cval_orders_o_orderstatus#3525,cval_orders_o_totalprice#3526,cval_orders_o_orderpriority#3527,cval_orders_o_clerk#3528,cval_orders_o_shippriority#3529,cval_orders_o_comment#3530,cval_orders_o_orderdate#3531,co_orderstatus#3532,co_totalprice#3533,co_orderpriority#3534,co_clerk#3535,co_shippriority#3536,co_comment#3537,co_orderdate#3538] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#3458 AS rid_5#3475, cpfk_customer_orders#3459 AS cpfk_customer_orders_5#3476, cfpk_orders_customer#3460 AS cfpk_orders_customer_5#3477, cval_orders_o_orderstatus#3461 AS cval_orders_o_orderstatus_5#3478, cval_orders_o_totalprice#3462 AS cval_orders_o_totalprice_5#3479, cval_orders_o_orderpriority#3463 AS cval_orders_o_orderpriority_5#3480, cval_orders_o_clerk#3464 AS cval_orders_o_clerk_5#3481, cval_orders_o_shippriority#3465 AS cval_orders_o_shippriority_5#3482, cval_orders_o_comment#3466 AS cval_orders_o_comment_5#3483, cval_orders_o_orderdate#3467 AS cval_orders_o_orderdate_5#3484, co_orderstatus#3468 AS co_orderstatus_5#3485, co_totalprice#3469 AS co_totalprice_5#3486, co_orderpriority#3470 AS co_orderpriority_5#3487, co_clerk#3471 AS co_clerk_5#3488, co_shippriority#3472 AS co_shippriority_5#3489, co_comment#3473 AS co_comment_5#3490, co_orderdate#3474 AS co_orderdate_5#3491]
                  +- Relation[rid#3458,cpfk_customer_orders#3459,cfpk_orders_customer#3460,cval_orders_o_orderstatus#3461,cval_orders_o_totalprice#3462,cval_orders_o_orderpriority#3463,cval_orders_o_clerk#3464,cval_orders_o_shippriority#3465,cval_orders_o_comment#3466,cval_orders_o_orderdate#3467,co_orderstatus#3468,co_totalprice#3469,co_orderpriority#3470,co_clerk#3471,co_shippriority#3472,co_comment#3473,co_orderdate#3474] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 103223ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/11 03:30:16 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:30:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3654L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 03:30:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:30:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:30:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:30:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:30:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:30:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:30:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:30:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:30:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:30:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:30:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:30:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:30:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:30:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3654L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#3656 AS rid_0#3663, cpfk_region_nation#3657 AS cpfk_region_nation_0#3664, cfpk_nation_region#3658 AS cfpk_nation_region_0#3665, cval_nation_n_name#3659 AS cval_nation_n_name_0#3666, cval_nation_n_comment#3660 AS cval_nation_n_comment_0#3667, cn_name#3661 AS cn_name_0#3668, cn_comment#3662 AS cn_comment_0#3669]
         :  :  :  :  :  +- Relation[rid#3656,cpfk_region_nation#3657,cfpk_nation_region#3658,cval_nation_n_name#3659,cval_nation_n_comment#3660,cn_name#3661,cn_comment#3662] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#3670 AS rid_0#3677, cpfk_region_nation#3671 AS cpfk_region_nation_0#3678, cfpk_nation_region#3672 AS cfpk_nation_region_0#3679, cval_nation_n_name#3673 AS cval_nation_n_name_0#3680, cval_nation_n_comment#3674 AS cval_nation_n_comment_0#3681, cn_name#3675 AS cn_name_0#3682, cn_comment#3676 AS cn_comment_0#3683]
         :  :  :  :        +- Relation[rid#3670,cpfk_region_nation#3671,cfpk_nation_region#3672,cval_nation_n_name#3673,cval_nation_n_comment#3674,cn_name#3675,cn_comment#3676] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :     :- Project [rid#3710 AS rid_0#3717, cpfk_region_nation#3711 AS cpfk_region_nation_0#3718, cfpk_nation_region#3712 AS cfpk_nation_region_0#3719, cval_nation_n_name#3713 AS cval_nation_n_name_0#3720, cval_nation_n_comment#3714 AS cval_nation_n_comment_0#3721, cn_name#3715 AS cn_name_0#3722, cn_comment#3716 AS cn_comment_0#3723]
         :  :  :     :  +- Relation[rid#3710,cpfk_region_nation#3711,cfpk_nation_region#3712,cval_nation_n_name#3713,cval_nation_n_comment#3714,cn_name#3715,cn_comment#3716] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#3724 AS rid_1#3737, cpfk_nation_supplier#3725 AS cpfk_nation_supplier_1#3738, cfpk_supplier_nation#3726 AS cfpk_supplier_nation_1#3739, cval_supplier_s_name#3727 AS cval_supplier_s_name_1#3740, cval_supplier_s_address#3728 AS cval_supplier_s_address_1#3741, cval_supplier_s_phone#3729 AS cval_supplier_s_phone_1#3742, cval_supplier_s_acctbal#3730 AS cval_supplier_s_acctbal_1#3743, cval_supplier_s_comment#3731 AS cval_supplier_s_comment_1#3744, cs_name#3732 AS cs_name_1#3745, cs_address#3733 AS cs_address_1#3746, cs_phone#3734 AS cs_phone_1#3747, cs_acctbal#3735 AS cs_acctbal_1#3748, cs_comment#3736 AS cs_comment_1#3749]
         :  :  :        +- Relation[rid#3724,cpfk_nation_supplier#3725,cfpk_supplier_nation#3726,cval_supplier_s_name#3727,cval_supplier_s_address#3728,cval_supplier_s_phone#3729,cval_supplier_s_acctbal#3730,cval_supplier_s_comment#3731,cs_name#3732,cs_address#3733,cs_phone#3734,cs_acctbal#3735,cs_comment#3736] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#3684 AS rid_1#3697, cpfk_nation_supplier#3685 AS cpfk_nation_supplier_1#3698, cfpk_supplier_nation#3686 AS cfpk_supplier_nation_1#3699, cval_supplier_s_name#3687 AS cval_supplier_s_name_1#3700, cval_supplier_s_address#3688 AS cval_supplier_s_address_1#3701, cval_supplier_s_phone#3689 AS cval_supplier_s_phone_1#3702, cval_supplier_s_acctbal#3690 AS cval_supplier_s_acctbal_1#3703, cval_supplier_s_comment#3691 AS cval_supplier_s_comment_1#3704, cs_name#3692 AS cs_name_1#3705, cs_address#3693 AS cs_address_1#3706, cs_phone#3694 AS cs_phone_1#3707, cs_acctbal#3695 AS cs_acctbal_1#3708, cs_comment#3696 AS cs_comment_1#3709]
         :  :     +- Relation[rid#3684,cpfk_nation_supplier#3685,cfpk_supplier_nation#3686,cval_supplier_s_name#3687,cval_supplier_s_address#3688,cval_supplier_s_phone#3689,cval_supplier_s_acctbal#3690,cval_supplier_s_comment#3691,cs_name#3692,cs_address#3693,cs_phone#3694,cs_acctbal#3695,cs_comment#3696] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :     :- Project [rid#3772 AS rid_1#3785, cpfk_nation_supplier#3773 AS cpfk_nation_supplier_1#3786, cfpk_supplier_nation#3774 AS cfpk_supplier_nation_1#3787, cval_supplier_s_name#3775 AS cval_supplier_s_name_1#3788, cval_supplier_s_address#3776 AS cval_supplier_s_address_1#3789, cval_supplier_s_phone#3777 AS cval_supplier_s_phone_1#3790, cval_supplier_s_acctbal#3778 AS cval_supplier_s_acctbal_1#3791, cval_supplier_s_comment#3779 AS cval_supplier_s_comment_1#3792, cs_name#3780 AS cs_name_1#3793, cs_address#3781 AS cs_address_1#3794, cs_phone#3782 AS cs_phone_1#3795, cs_acctbal#3783 AS cs_acctbal_1#3796, cs_comment#3784 AS cs_comment_1#3797]
         :     :  +- Relation[rid#3772,cpfk_nation_supplier#3773,cfpk_supplier_nation#3774,cval_supplier_s_name#3775,cval_supplier_s_address#3776,cval_supplier_s_phone#3777,cval_supplier_s_acctbal#3778,cval_supplier_s_comment#3779,cs_name#3780,cs_address#3781,cs_phone#3782,cs_acctbal#3783,cs_comment#3784] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#3798 AS rid_2#3809, cpfk_part_partsupp#3799 AS cpfk_part_partsupp_2#3810, cfpk_partsupp_part#3800 AS cfpk_partsupp_part_2#3811, cpfk_supplier_partsupp#3801 AS cpfk_supplier_partsupp_2#3812, cfpk_partsupp_supplier#3802 AS cfpk_partsupp_supplier_2#3813, cval_partsupp_ps_availqty#3803 AS cval_partsupp_ps_availqty_2#3814, cval_partsupp_ps_supplycost#3804 AS cval_partsupp_ps_supplycost_2#3815, cval_partsupp_ps_comment#3805 AS cval_partsupp_ps_comment_2#3816, cps_availqty#3806 AS cps_availqty_2#3817, cps_supplycost#3807 AS cps_supplycost_2#3818, cps_comment#3808 AS cps_comment_2#3819]
         :        +- Relation[rid#3798,cpfk_part_partsupp#3799,cfpk_partsupp_part#3800,cpfk_supplier_partsupp#3801,cfpk_partsupp_supplier#3802,cval_partsupp_ps_availqty#3803,cval_partsupp_ps_supplycost#3804,cval_partsupp_ps_comment#3805,cps_availqty#3806,cps_supplycost#3807,cps_comment#3808] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#3750 AS rid_2#3761, cpfk_part_partsupp#3751 AS cpfk_part_partsupp_2#3762, cfpk_partsupp_part#3752 AS cfpk_partsupp_part_2#3763, cpfk_supplier_partsupp#3753 AS cpfk_supplier_partsupp_2#3764, cfpk_partsupp_supplier#3754 AS cfpk_partsupp_supplier_2#3765, cval_partsupp_ps_availqty#3755 AS cval_partsupp_ps_availqty_2#3766, cval_partsupp_ps_supplycost#3756 AS cval_partsupp_ps_supplycost_2#3767, cval_partsupp_ps_comment#3757 AS cval_partsupp_ps_comment_2#3768, cps_availqty#3758 AS cps_availqty_2#3769, cps_supplycost#3759 AS cps_supplycost_2#3770, cps_comment#3760 AS cps_comment_2#3771]
            +- Relation[rid#3750,cpfk_part_partsupp#3751,cfpk_partsupp_part#3752,cpfk_supplier_partsupp#3753,cfpk_partsupp_supplier#3754,cval_partsupp_ps_availqty#3755,cval_partsupp_ps_supplycost#3756,cval_partsupp_ps_comment#3757,cps_availqty#3758,cps_supplycost#3759,cps_comment#3760] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 10506ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/11 03:30:27 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:30:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3858L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 03:30:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:30:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:30:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:30:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:30:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:30:27 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:30:27 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:30:27 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:30:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:30:27 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:30:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:30:27 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:30:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:30:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:30:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:30:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3858L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#3860 AS rid_0#3877, cval_part_p_name#3861 AS cval_part_p_name_0#3878, cval_part_p_mfgr#3862 AS cval_part_p_mfgr_0#3879, cval_part_p_type#3863 AS cval_part_p_type_0#3880, cval_part_p_size#3864 AS cval_part_p_size_0#3881, cval_part_p_container#3865 AS cval_part_p_container_0#3882, cval_part_p_retailprice#3866 AS cval_part_p_retailprice_0#3883, cval_part_p_comment#3867 AS cval_part_p_comment_0#3884, cval_part_p_brand#3868 AS cval_part_p_brand_0#3885, cp_name#3869 AS cp_name_0#3886, cp_mfgr#3870 AS cp_mfgr_0#3887, cp_type#3871 AS cp_type_0#3888, cp_size#3872 AS cp_size_0#3889, cp_container#3873 AS cp_container_0#3890, cp_retailprice#3874 AS cp_retailprice_0#3891, cp_comment#3875 AS cp_comment_0#3892, cp_brand#3876 AS cp_brand_0#3893]
            :     :     :  :  :  :  +- Relation[rid#3860,cval_part_p_name#3861,cval_part_p_mfgr#3862,cval_part_p_type#3863,cval_part_p_size#3864,cval_part_p_container#3865,cval_part_p_retailprice#3866,cval_part_p_comment#3867,cval_part_p_brand#3868,cp_name#3869,cp_mfgr#3870,cp_type#3871,cp_size#3872,cp_container#3873,cp_retailprice#3874,cp_comment#3875,cp_brand#3876] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#3894 AS rid_0#3911, cval_part_p_name#3895 AS cval_part_p_name_0#3912, cval_part_p_mfgr#3896 AS cval_part_p_mfgr_0#3913, cval_part_p_type#3897 AS cval_part_p_type_0#3914, cval_part_p_size#3898 AS cval_part_p_size_0#3915, cval_part_p_container#3899 AS cval_part_p_container_0#3916, cval_part_p_retailprice#3900 AS cval_part_p_retailprice_0#3917, cval_part_p_comment#3901 AS cval_part_p_comment_0#3918, cval_part_p_brand#3902 AS cval_part_p_brand_0#3919, cp_name#3903 AS cp_name_0#3920, cp_mfgr#3904 AS cp_mfgr_0#3921, cp_type#3905 AS cp_type_0#3922, cp_size#3906 AS cp_size_0#3923, cp_container#3907 AS cp_container_0#3924, cp_retailprice#3908 AS cp_retailprice_0#3925, cp_comment#3909 AS cp_comment_0#3926, cp_brand#3910 AS cp_brand_0#3927]
            :     :     :  :  :        +- Relation[rid#3894,cval_part_p_name#3895,cval_part_p_mfgr#3896,cval_part_p_type#3897,cval_part_p_size#3898,cval_part_p_container#3899,cval_part_p_retailprice#3900,cval_part_p_comment#3901,cval_part_p_brand#3902,cp_name#3903,cp_mfgr#3904,cp_type#3905,cp_size#3906,cp_container#3907,cp_retailprice#3908,cp_comment#3909,cp_brand#3910] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :     :- Project [rid#3994 AS rid_0#4011, cval_part_p_name#3995 AS cval_part_p_name_0#4012, cval_part_p_mfgr#3996 AS cval_part_p_mfgr_0#4013, cval_part_p_type#3997 AS cval_part_p_type_0#4014, cval_part_p_size#3998 AS cval_part_p_size_0#4015, cval_part_p_container#3999 AS cval_part_p_container_0#4016, cval_part_p_retailprice#4000 AS cval_part_p_retailprice_0#4017, cval_part_p_comment#4001 AS cval_part_p_comment_0#4018, cval_part_p_brand#4002 AS cval_part_p_brand_0#4019, cp_name#4003 AS cp_name_0#4020, cp_mfgr#4004 AS cp_mfgr_0#4021, cp_type#4005 AS cp_type_0#4022, cp_size#4006 AS cp_size_0#4023, cp_container#4007 AS cp_container_0#4024, cp_retailprice#4008 AS cp_retailprice_0#4025, cp_comment#4009 AS cp_comment_0#4026, cp_brand#4010 AS cp_brand_0#4027]
            :     :     :  :     :  +- Relation[rid#3994,cval_part_p_name#3995,cval_part_p_mfgr#3996,cval_part_p_type#3997,cval_part_p_size#3998,cval_part_p_container#3999,cval_part_p_retailprice#4000,cval_part_p_comment#4001,cval_part_p_brand#4002,cp_name#4003,cp_mfgr#4004,cp_type#4005,cp_size#4006,cp_container#4007,cp_retailprice#4008,cp_comment#4009,cp_brand#4010] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :     +- Project [rid#4028 AS rid_1#4061, cpfk_orders_lineitem#4029 AS cpfk_orders_lineitem_1#4062, cpfk_supplier_lineitem#4030 AS cpfk_supplier_lineitem_1#4063, cfpk_lineitem_supplier#4031 AS cfpk_lineitem_supplier_1#4064, cfpk_lineitem_partsupp#4032 AS cfpk_lineitem_partsupp_1#4065, cpfk_part_lineitem#4033 AS cpfk_part_lineitem_1#4066, cfpk_lineitem_part#4034 AS cfpk_lineitem_part_1#4067, cpfk_partsupp_lineitem#4035 AS cpfk_partsupp_lineitem_1#4068, cfpk_lineitem_orders#4036 AS cfpk_lineitem_orders_1#4069, cval_lineitem_l_quantity#4037 AS cval_lineitem_l_quantity_1#4070, cval_lineitem_l_extendedprice#4038 AS cval_lineitem_l_extendedprice_1#4071, cval_lineitem_l_discount#4039 AS cval_lineitem_l_discount_1#4072, cval_lineitem_l_tax#4040 AS cval_lineitem_l_tax_1#4073, cval_lineitem_l_returnflag#4041 AS cval_lineitem_l_returnflag_1#4074, cval_lineitem_l_linestatus#4042 AS cval_lineitem_l_linestatus_1#4075, cval_lineitem_l_commitdate#4043 AS cval_lineitem_l_commitdate_1#4076, cval_lineitem_l_receiptdate#4044 AS cval_lineitem_l_receiptdate_1#4077, cval_lineitem_l_shipinstruct#4045 AS cval_lineitem_l_shipinstruct_1#4078, cval_lineitem_l_shipmode#4046 AS cval_lineitem_l_shipmode_1#4079, cval_lineitem_l_comment#4047 AS cval_lineitem_l_comment_1#4080, cval_lineitem_l_shipdate#4048 AS cval_lineitem_l_shipdate_1#4081, cl_quantity#4049 AS cl_quantity_1#4082, cl_extendedprice#4050 AS cl_extendedprice_1#4083, cl_discount#4051 AS cl_discount_1#4084, ... 9 more fields]
            :     :     :  :        +- Relation[rid#4028,cpfk_orders_lineitem#4029,cpfk_supplier_lineitem#4030,cfpk_lineitem_supplier#4031,cfpk_lineitem_partsupp#4032,cpfk_part_lineitem#4033,cfpk_lineitem_part#4034,cpfk_partsupp_lineitem#4035,cfpk_lineitem_orders#4036,cval_lineitem_l_quantity#4037,cval_lineitem_l_extendedprice#4038,cval_lineitem_l_discount#4039,cval_lineitem_l_tax#4040,cval_lineitem_l_returnflag#4041,cval_lineitem_l_linestatus#4042,cval_lineitem_l_commitdate#4043,cval_lineitem_l_receiptdate#4044,cval_lineitem_l_shipinstruct#4045,cval_lineitem_l_shipmode#4046,cval_lineitem_l_comment#4047,cval_lineitem_l_shipdate#4048,cl_quantity#4049,cl_extendedprice#4050,cl_discount#4051,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#3928 AS rid_1#3961, cpfk_orders_lineitem#3929 AS cpfk_orders_lineitem_1#3962, cpfk_supplier_lineitem#3930 AS cpfk_supplier_lineitem_1#3963, cfpk_lineitem_supplier#3931 AS cfpk_lineitem_supplier_1#3964, cfpk_lineitem_partsupp#3932 AS cfpk_lineitem_partsupp_1#3965, cpfk_part_lineitem#3933 AS cpfk_part_lineitem_1#3966, cfpk_lineitem_part#3934 AS cfpk_lineitem_part_1#3967, cpfk_partsupp_lineitem#3935 AS cpfk_partsupp_lineitem_1#3968, cfpk_lineitem_orders#3936 AS cfpk_lineitem_orders_1#3969, cval_lineitem_l_quantity#3937 AS cval_lineitem_l_quantity_1#3970, cval_lineitem_l_extendedprice#3938 AS cval_lineitem_l_extendedprice_1#3971, cval_lineitem_l_discount#3939 AS cval_lineitem_l_discount_1#3972, cval_lineitem_l_tax#3940 AS cval_lineitem_l_tax_1#3973, cval_lineitem_l_returnflag#3941 AS cval_lineitem_l_returnflag_1#3974, cval_lineitem_l_linestatus#3942 AS cval_lineitem_l_linestatus_1#3975, cval_lineitem_l_commitdate#3943 AS cval_lineitem_l_commitdate_1#3976, cval_lineitem_l_receiptdate#3944 AS cval_lineitem_l_receiptdate_1#3977, cval_lineitem_l_shipinstruct#3945 AS cval_lineitem_l_shipinstruct_1#3978, cval_lineitem_l_shipmode#3946 AS cval_lineitem_l_shipmode_1#3979, cval_lineitem_l_comment#3947 AS cval_lineitem_l_comment_1#3980, cval_lineitem_l_shipdate#3948 AS cval_lineitem_l_shipdate_1#3981, cl_quantity#3949 AS cl_quantity_1#3982, cl_extendedprice#3950 AS cl_extendedprice_1#3983, cl_discount#3951 AS cl_discount_1#3984, ... 9 more fields]
            :     :     :     +- Relation[rid#3928,cpfk_orders_lineitem#3929,cpfk_supplier_lineitem#3930,cfpk_lineitem_supplier#3931,cfpk_lineitem_partsupp#3932,cpfk_part_lineitem#3933,cfpk_lineitem_part#3934,cpfk_partsupp_lineitem#3935,cfpk_lineitem_orders#3936,cval_lineitem_l_quantity#3937,cval_lineitem_l_extendedprice#3938,cval_lineitem_l_discount#3939,cval_lineitem_l_tax#3940,cval_lineitem_l_returnflag#3941,cval_lineitem_l_linestatus#3942,cval_lineitem_l_commitdate#3943,cval_lineitem_l_receiptdate#3944,cval_lineitem_l_shipinstruct#3945,cval_lineitem_l_shipmode#3946,cval_lineitem_l_comment#3947,cval_lineitem_l_shipdate#3948,cl_quantity#3949,cl_extendedprice#3950,cl_discount#3951,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#4094 AS rid_2#4107, cpfk_nation_supplier#4095 AS cpfk_nation_supplier_2#4108, cfpk_supplier_nation#4096 AS cfpk_supplier_nation_2#4109, cval_supplier_s_name#4097 AS cval_supplier_s_name_2#4110, cval_supplier_s_address#4098 AS cval_supplier_s_address_2#4111, cval_supplier_s_phone#4099 AS cval_supplier_s_phone_2#4112, cval_supplier_s_acctbal#4100 AS cval_supplier_s_acctbal_2#4113, cval_supplier_s_comment#4101 AS cval_supplier_s_comment_2#4114, cs_name#4102 AS cs_name_2#4115, cs_address#4103 AS cs_address_2#4116, cs_phone#4104 AS cs_phone_2#4117, cs_acctbal#4105 AS cs_acctbal_2#4118, cs_comment#4106 AS cs_comment_2#4119]
            :     :        +- Relation[rid#4094,cpfk_nation_supplier#4095,cfpk_supplier_nation#4096,cval_supplier_s_name#4097,cval_supplier_s_address#4098,cval_supplier_s_phone#4099,cval_supplier_s_acctbal#4100,cval_supplier_s_comment#4101,cs_name#4102,cs_address#4103,cs_phone#4104,cs_acctbal#4105,cs_comment#4106] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#4120 AS rid_3#4127, cpfk_region_nation#4121 AS cpfk_region_nation_3#4128, cfpk_nation_region#4122 AS cfpk_nation_region_3#4129, cval_nation_n_name#4123 AS cval_nation_n_name_3#4130, cval_nation_n_comment#4124 AS cval_nation_n_comment_3#4131, cn_name#4125 AS cn_name_3#4132, cn_comment#4126 AS cn_comment_3#4133]
            :        +- Relation[rid#4120,cpfk_region_nation#4121,cfpk_nation_region#4122,cval_nation_n_name#4123,cval_nation_n_comment#4124,cn_name#4125,cn_comment#4126] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'Join UsingJoin(Inner,List(rid_6))
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#4134 AS rid_4#4139, cval_region_r_name#4135 AS cval_region_r_name_4#4140, cval_region_r_comment#4136 AS cval_region_r_comment_4#4141, cr_name#4137 AS cr_name_4#4142, cr_comment#4138 AS cr_comment_4#4143]
               :  :  :  :  :  :  :  +- Relation[rid#4134,cval_region_r_name#4135,cval_region_r_comment#4136,cr_name#4137,cr_comment#4138] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#4144 AS rid_4#4149, cval_region_r_name#4145 AS cval_region_r_name_4#4150, cval_region_r_comment#4146 AS cval_region_r_comment_4#4151, cr_name#4147 AS cr_name_4#4152, cr_comment#4148 AS cr_comment_4#4153]
               :  :  :  :  :  :        +- Relation[rid#4144,cval_region_r_name#4145,cval_region_r_comment#4146,cr_name#4147,cr_comment#4148] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :     :- Project [rid#4168 AS rid_4#4173, cval_region_r_name#4169 AS cval_region_r_name_4#4174, cval_region_r_comment#4170 AS cval_region_r_comment_4#4175, cr_name#4171 AS cr_name_4#4176, cr_comment#4172 AS cr_comment_4#4177]
               :  :  :  :  :     :  +- Relation[rid#4168,cval_region_r_name#4169,cval_region_r_comment#4170,cr_name#4171,cr_comment#4172] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :     +- Project [rid#4178 AS rid_5#4185, cpfk_region_nation#4179 AS cpfk_region_nation_5#4186, cfpk_nation_region#4180 AS cfpk_nation_region_5#4187, cval_nation_n_name#4181 AS cval_nation_n_name_5#4188, cval_nation_n_comment#4182 AS cval_nation_n_comment_5#4189, cn_name#4183 AS cn_name_5#4190, cn_comment#4184 AS cn_comment_5#4191]
               :  :  :  :  :        +- Relation[rid#4178,cpfk_region_nation#4179,cfpk_nation_region#4180,cval_nation_n_name#4181,cval_nation_n_comment#4182,cn_name#4183,cn_comment#4184] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#4154 AS rid_5#4161, cpfk_region_nation#4155 AS cpfk_region_nation_5#4162, cfpk_nation_region#4156 AS cfpk_nation_region_5#4163, cval_nation_n_name#4157 AS cval_nation_n_name_5#4164, cval_nation_n_comment#4158 AS cval_nation_n_comment_5#4165, cn_name#4159 AS cn_name_5#4166, cn_comment#4160 AS cn_comment_5#4167]
               :  :  :  :     +- Relation[rid#4154,cpfk_region_nation#4155,cfpk_nation_region#4156,cval_nation_n_name#4157,cval_nation_n_comment#4158,cn_name#4159,cn_comment#4160] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :     :- Project [rid#4222 AS rid_5#4229, cpfk_region_nation#4223 AS cpfk_region_nation_5#4230, cfpk_nation_region#4224 AS cfpk_nation_region_5#4231, cval_nation_n_name#4225 AS cval_nation_n_name_5#4232, cval_nation_n_comment#4226 AS cval_nation_n_comment_5#4233, cn_name#4227 AS cn_name_5#4234, cn_comment#4228 AS cn_comment_5#4235]
               :  :  :     :  +- Relation[rid#4222,cpfk_region_nation#4223,cfpk_nation_region#4224,cval_nation_n_name#4225,cval_nation_n_comment#4226,cn_name#4227,cn_comment#4228] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#4236 AS rid_6#4251, cpfk_nation_customer#4237 AS cpfk_nation_customer_6#4252, cfpk_customer_nation#4238 AS cfpk_customer_nation_6#4253, cval_customer_c_name#4239 AS cval_customer_c_name_6#4254, cval_customer_c_address#4240 AS cval_customer_c_address_6#4255, cval_customer_c_phone#4241 AS cval_customer_c_phone_6#4256, cval_customer_c_acctbal#4242 AS cval_customer_c_acctbal_6#4257, cval_customer_c_comment#4243 AS cval_customer_c_comment_6#4258, cval_customer_c_mktsegment#4244 AS cval_customer_c_mktsegment_6#4259, cc_name#4245 AS cc_name_6#4260, cc_address#4246 AS cc_address_6#4261, cc_phone#4247 AS cc_phone_6#4262, cc_acctbal#4248 AS cc_acctbal_6#4263, cc_comment#4249 AS cc_comment_6#4264, cc_mktsegment#4250 AS cc_mktsegment_6#4265]
               :  :  :        +- Relation[rid#4236,cpfk_nation_customer#4237,cfpk_customer_nation#4238,cval_customer_c_name#4239,cval_customer_c_address#4240,cval_customer_c_phone#4241,cval_customer_c_acctbal#4242,cval_customer_c_comment#4243,cval_customer_c_mktsegment#4244,cc_name#4245,cc_address#4246,cc_phone#4247,cc_acctbal#4248,cc_comment#4249,cc_mktsegment#4250] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#4192 AS rid_6#4207, cpfk_nation_customer#4193 AS cpfk_nation_customer_6#4208, cfpk_customer_nation#4194 AS cfpk_customer_nation_6#4209, cval_customer_c_name#4195 AS cval_customer_c_name_6#4210, cval_customer_c_address#4196 AS cval_customer_c_address_6#4211, cval_customer_c_phone#4197 AS cval_customer_c_phone_6#4212, cval_customer_c_acctbal#4198 AS cval_customer_c_acctbal_6#4213, cval_customer_c_comment#4199 AS cval_customer_c_comment_6#4214, cval_customer_c_mktsegment#4200 AS cval_customer_c_mktsegment_6#4215, cc_name#4201 AS cc_name_6#4216, cc_address#4202 AS cc_address_6#4217, cc_phone#4203 AS cc_phone_6#4218, cc_acctbal#4204 AS cc_acctbal_6#4219, cc_comment#4205 AS cc_comment_6#4220, cc_mktsegment#4206 AS cc_mktsegment_6#4221]
               :  :     +- Relation[rid#4192,cpfk_nation_customer#4193,cfpk_customer_nation#4194,cval_customer_c_name#4195,cval_customer_c_address#4196,cval_customer_c_phone#4197,cval_customer_c_acctbal#4198,cval_customer_c_comment#4199,cval_customer_c_mktsegment#4200,cc_name#4201,cc_address#4202,cc_phone#4203,cc_acctbal#4204,cc_comment#4205,cc_mktsegment#4206] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :     :- Project [rid#4300 AS rid_6#4315, cpfk_nation_customer#4301 AS cpfk_nation_customer_6#4316, cfpk_customer_nation#4302 AS cfpk_customer_nation_6#4317, cval_customer_c_name#4303 AS cval_customer_c_name_6#4318, cval_customer_c_address#4304 AS cval_customer_c_address_6#4319, cval_customer_c_phone#4305 AS cval_customer_c_phone_6#4320, cval_customer_c_acctbal#4306 AS cval_customer_c_acctbal_6#4321, cval_customer_c_comment#4307 AS cval_customer_c_comment_6#4322, cval_customer_c_mktsegment#4308 AS cval_customer_c_mktsegment_6#4323, cc_name#4309 AS cc_name_6#4324, cc_address#4310 AS cc_address_6#4325, cc_phone#4311 AS cc_phone_6#4326, cc_acctbal#4312 AS cc_acctbal_6#4327, cc_comment#4313 AS cc_comment_6#4328, cc_mktsegment#4314 AS cc_mktsegment_6#4329]
               :     :  +- Relation[rid#4300,cpfk_nation_customer#4301,cfpk_customer_nation#4302,cval_customer_c_name#4303,cval_customer_c_address#4304,cval_customer_c_phone#4305,cval_customer_c_acctbal#4306,cval_customer_c_comment#4307,cval_customer_c_mktsegment#4308,cc_name#4309,cc_address#4310,cc_phone#4311,cc_acctbal#4312,cc_comment#4313,cc_mktsegment#4314] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#4330 AS rid_7#4347, cpfk_customer_orders#4331 AS cpfk_customer_orders_7#4348, cfpk_orders_customer#4332 AS cfpk_orders_customer_7#4349, cval_orders_o_orderstatus#4333 AS cval_orders_o_orderstatus_7#4350, cval_orders_o_totalprice#4334 AS cval_orders_o_totalprice_7#4351, cval_orders_o_orderpriority#4335 AS cval_orders_o_orderpriority_7#4352, cval_orders_o_clerk#4336 AS cval_orders_o_clerk_7#4353, cval_orders_o_shippriority#4337 AS cval_orders_o_shippriority_7#4354, cval_orders_o_comment#4338 AS cval_orders_o_comment_7#4355, cval_orders_o_orderdate#4339 AS cval_orders_o_orderdate_7#4356, co_orderstatus#4340 AS co_orderstatus_7#4357, co_totalprice#4341 AS co_totalprice_7#4358, co_orderpriority#4342 AS co_orderpriority_7#4359, co_clerk#4343 AS co_clerk_7#4360, co_shippriority#4344 AS co_shippriority_7#4361, co_comment#4345 AS co_comment_7#4362, co_orderdate#4346 AS co_orderdate_7#4363]
               :        +- Relation[rid#4330,cpfk_customer_orders#4331,cfpk_orders_customer#4332,cval_orders_o_orderstatus#4333,cval_orders_o_totalprice#4334,cval_orders_o_orderpriority#4335,cval_orders_o_clerk#4336,cval_orders_o_shippriority#4337,cval_orders_o_comment#4338,cval_orders_o_orderdate#4339,co_orderstatus#4340,co_totalprice#4341,co_orderpriority#4342,co_clerk#4343,co_shippriority#4344,co_comment#4345,co_orderdate#4346] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#4266 AS rid_7#4283, cpfk_customer_orders#4267 AS cpfk_customer_orders_7#4284, cfpk_orders_customer#4268 AS cfpk_orders_customer_7#4285, cval_orders_o_orderstatus#4269 AS cval_orders_o_orderstatus_7#4286, cval_orders_o_totalprice#4270 AS cval_orders_o_totalprice_7#4287, cval_orders_o_orderpriority#4271 AS cval_orders_o_orderpriority_7#4288, cval_orders_o_clerk#4272 AS cval_orders_o_clerk_7#4289, cval_orders_o_shippriority#4273 AS cval_orders_o_shippriority_7#4290, cval_orders_o_comment#4274 AS cval_orders_o_comment_7#4291, cval_orders_o_orderdate#4275 AS cval_orders_o_orderdate_7#4292, co_orderstatus#4276 AS co_orderstatus_7#4293, co_totalprice#4277 AS co_totalprice_7#4294, co_orderpriority#4278 AS co_orderpriority_7#4295, co_clerk#4279 AS co_clerk_7#4296, co_shippriority#4280 AS co_shippriority_7#4297, co_comment#4281 AS co_comment_7#4298, co_orderdate#4282 AS co_orderdate_7#4299]
                  +- Relation[rid#4266,cpfk_customer_orders#4267,cfpk_orders_customer#4268,cval_orders_o_orderstatus#4269,cval_orders_o_totalprice#4270,cval_orders_o_orderpriority#4271,cval_orders_o_clerk#4272,cval_orders_o_shippriority#4273,cval_orders_o_comment#4274,cval_orders_o_orderdate#4275,co_orderstatus#4276,co_totalprice#4277,co_orderpriority#4278,co_clerk#4279,co_shippriority#4280,co_comment#4281,co_orderdate#4282] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 94933ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/11 03:32:02 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:32:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4506L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 03:32:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4506L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#4508 AS rid_0#4541, cpfk_orders_lineitem#4509 AS cpfk_orders_lineitem_0#4542, cpfk_supplier_lineitem#4510 AS cpfk_supplier_lineitem_0#4543, cfpk_lineitem_supplier#4511 AS cfpk_lineitem_supplier_0#4544, cfpk_lineitem_partsupp#4512 AS cfpk_lineitem_partsupp_0#4545, cpfk_part_lineitem#4513 AS cpfk_part_lineitem_0#4546, cfpk_lineitem_part#4514 AS cfpk_lineitem_part_0#4547, cpfk_partsupp_lineitem#4515 AS cpfk_partsupp_lineitem_0#4548, cfpk_lineitem_orders#4516 AS cfpk_lineitem_orders_0#4549, cval_lineitem_l_quantity#4517 AS cval_lineitem_l_quantity_0#4550, cval_lineitem_l_extendedprice#4518 AS cval_lineitem_l_extendedprice_0#4551, cval_lineitem_l_discount#4519 AS cval_lineitem_l_discount_0#4552, cval_lineitem_l_tax#4520 AS cval_lineitem_l_tax_0#4553, cval_lineitem_l_returnflag#4521 AS cval_lineitem_l_returnflag_0#4554, cval_lineitem_l_linestatus#4522 AS cval_lineitem_l_linestatus_0#4555, cval_lineitem_l_commitdate#4523 AS cval_lineitem_l_commitdate_0#4556, cval_lineitem_l_receiptdate#4524 AS cval_lineitem_l_receiptdate_0#4557, cval_lineitem_l_shipinstruct#4525 AS cval_lineitem_l_shipinstruct_0#4558, cval_lineitem_l_shipmode#4526 AS cval_lineitem_l_shipmode_0#4559, cval_lineitem_l_comment#4527 AS cval_lineitem_l_comment_0#4560, cval_lineitem_l_shipdate#4528 AS cval_lineitem_l_shipdate_0#4561, cl_quantity#4529 AS cl_quantity_0#4562, cl_extendedprice#4530 AS cl_extendedprice_0#4563, cl_discount#4531 AS cl_discount_0#4564, ... 9 more fields]
            :  +- Relation[rid#4508,cpfk_orders_lineitem#4509,cpfk_supplier_lineitem#4510,cfpk_lineitem_supplier#4511,cfpk_lineitem_partsupp#4512,cpfk_part_lineitem#4513,cfpk_lineitem_part#4514,cpfk_partsupp_lineitem#4515,cfpk_lineitem_orders#4516,cval_lineitem_l_quantity#4517,cval_lineitem_l_extendedprice#4518,cval_lineitem_l_discount#4519,cval_lineitem_l_tax#4520,cval_lineitem_l_returnflag#4521,cval_lineitem_l_linestatus#4522,cval_lineitem_l_commitdate#4523,cval_lineitem_l_receiptdate#4524,cval_lineitem_l_shipinstruct#4525,cval_lineitem_l_shipmode#4526,cval_lineitem_l_comment#4527,cval_lineitem_l_shipdate#4528,cl_quantity#4529,cl_extendedprice#4530,cl_discount#4531,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#4574 AS rid_1#4591, cpfk_customer_orders#4575 AS cpfk_customer_orders_1#4592, cfpk_orders_customer#4576 AS cfpk_orders_customer_1#4593, cval_orders_o_orderstatus#4577 AS cval_orders_o_orderstatus_1#4594, cval_orders_o_totalprice#4578 AS cval_orders_o_totalprice_1#4595, cval_orders_o_orderpriority#4579 AS cval_orders_o_orderpriority_1#4596, cval_orders_o_clerk#4580 AS cval_orders_o_clerk_1#4597, cval_orders_o_shippriority#4581 AS cval_orders_o_shippriority_1#4598, cval_orders_o_comment#4582 AS cval_orders_o_comment_1#4599, cval_orders_o_orderdate#4583 AS cval_orders_o_orderdate_1#4600, co_orderstatus#4584 AS co_orderstatus_1#4601, co_totalprice#4585 AS co_totalprice_1#4602, co_orderpriority#4586 AS co_orderpriority_1#4603, co_clerk#4587 AS co_clerk_1#4604, co_shippriority#4588 AS co_shippriority_1#4605, co_comment#4589 AS co_comment_1#4606, co_orderdate#4590 AS co_orderdate_1#4607]
               +- Relation[rid#4574,cpfk_customer_orders#4575,cfpk_orders_customer#4576,cval_orders_o_orderstatus#4577,cval_orders_o_totalprice#4578,cval_orders_o_orderpriority#4579,cval_orders_o_clerk#4580,cval_orders_o_shippriority#4581,cval_orders_o_comment#4582,cval_orders_o_orderdate#4583,co_orderstatus#4584,co_totalprice#4585,co_orderpriority#4586,co_clerk#4587,co_shippriority#4588,co_comment#4589,co_orderdate#4590] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 52681ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/11 03:32:54 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:32:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4665L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 03:32:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:32:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:32:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:32:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4665L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#4667 AS rid_0#4680, cpfk_nation_supplier#4668 AS cpfk_nation_supplier_0#4681, cfpk_supplier_nation#4669 AS cfpk_supplier_nation_0#4682, cval_supplier_s_name#4670 AS cval_supplier_s_name_0#4683, cval_supplier_s_address#4671 AS cval_supplier_s_address_0#4684, cval_supplier_s_phone#4672 AS cval_supplier_s_phone_0#4685, cval_supplier_s_acctbal#4673 AS cval_supplier_s_acctbal_0#4686, cval_supplier_s_comment#4674 AS cval_supplier_s_comment_0#4687, cs_name#4675 AS cs_name_0#4688, cs_address#4676 AS cs_address_0#4689, cs_phone#4677 AS cs_phone_0#4690, cs_acctbal#4678 AS cs_acctbal_0#4691, cs_comment#4679 AS cs_comment_0#4692]
         :  :  +- Relation[rid#4667,cpfk_nation_supplier#4668,cfpk_supplier_nation#4669,cval_supplier_s_name#4670,cval_supplier_s_address#4671,cval_supplier_s_phone#4672,cval_supplier_s_acctbal#4673,cval_supplier_s_comment#4674,cs_name#4675,cs_address#4676,cs_phone#4677,cs_acctbal#4678,cs_comment#4679] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#4759 AS rid_0#4772, cpfk_nation_supplier#4760 AS cpfk_nation_supplier_0#4773, cfpk_supplier_nation#4761 AS cfpk_supplier_nation_0#4774, cval_supplier_s_name#4762 AS cval_supplier_s_name_0#4775, cval_supplier_s_address#4763 AS cval_supplier_s_address_0#4776, cval_supplier_s_phone#4764 AS cval_supplier_s_phone_0#4777, cval_supplier_s_acctbal#4765 AS cval_supplier_s_acctbal_0#4778, cval_supplier_s_comment#4766 AS cval_supplier_s_comment_0#4779, cs_name#4767 AS cs_name_0#4780, cs_address#4768 AS cs_address_0#4781, cs_phone#4769 AS cs_phone_0#4782, cs_acctbal#4770 AS cs_acctbal_0#4783, cs_comment#4771 AS cs_comment_0#4784]
         :     :  +- Relation[rid#4759,cpfk_nation_supplier#4760,cfpk_supplier_nation#4761,cval_supplier_s_name#4762,cval_supplier_s_address#4763,cval_supplier_s_phone#4764,cval_supplier_s_acctbal#4765,cval_supplier_s_comment#4766,cs_name#4767,cs_address#4768,cs_phone#4769,cs_acctbal#4770,cs_comment#4771] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#4785 AS rid_1#4818, cpfk_orders_lineitem#4786 AS cpfk_orders_lineitem_1#4819, cpfk_supplier_lineitem#4787 AS cpfk_supplier_lineitem_1#4820, cfpk_lineitem_supplier#4788 AS cfpk_lineitem_supplier_1#4821, cfpk_lineitem_partsupp#4789 AS cfpk_lineitem_partsupp_1#4822, cpfk_part_lineitem#4790 AS cpfk_part_lineitem_1#4823, cfpk_lineitem_part#4791 AS cfpk_lineitem_part_1#4824, cpfk_partsupp_lineitem#4792 AS cpfk_partsupp_lineitem_1#4825, cfpk_lineitem_orders#4793 AS cfpk_lineitem_orders_1#4826, cval_lineitem_l_quantity#4794 AS cval_lineitem_l_quantity_1#4827, cval_lineitem_l_extendedprice#4795 AS cval_lineitem_l_extendedprice_1#4828, cval_lineitem_l_discount#4796 AS cval_lineitem_l_discount_1#4829, cval_lineitem_l_tax#4797 AS cval_lineitem_l_tax_1#4830, cval_lineitem_l_returnflag#4798 AS cval_lineitem_l_returnflag_1#4831, cval_lineitem_l_linestatus#4799 AS cval_lineitem_l_linestatus_1#4832, cval_lineitem_l_commitdate#4800 AS cval_lineitem_l_commitdate_1#4833, cval_lineitem_l_receiptdate#4801 AS cval_lineitem_l_receiptdate_1#4834, cval_lineitem_l_shipinstruct#4802 AS cval_lineitem_l_shipinstruct_1#4835, cval_lineitem_l_shipmode#4803 AS cval_lineitem_l_shipmode_1#4836, cval_lineitem_l_comment#4804 AS cval_lineitem_l_comment_1#4837, cval_lineitem_l_shipdate#4805 AS cval_lineitem_l_shipdate_1#4838, cl_quantity#4806 AS cl_quantity_1#4839, cl_extendedprice#4807 AS cl_extendedprice_1#4840, cl_discount#4808 AS cl_discount_1#4841, ... 9 more fields]
         :        +- Relation[rid#4785,cpfk_orders_lineitem#4786,cpfk_supplier_lineitem#4787,cfpk_lineitem_supplier#4788,cfpk_lineitem_partsupp#4789,cpfk_part_lineitem#4790,cfpk_lineitem_part#4791,cpfk_partsupp_lineitem#4792,cfpk_lineitem_orders#4793,cval_lineitem_l_quantity#4794,cval_lineitem_l_extendedprice#4795,cval_lineitem_l_discount#4796,cval_lineitem_l_tax#4797,cval_lineitem_l_returnflag#4798,cval_lineitem_l_linestatus#4799,cval_lineitem_l_commitdate#4800,cval_lineitem_l_receiptdate#4801,cval_lineitem_l_shipinstruct#4802,cval_lineitem_l_shipmode#4803,cval_lineitem_l_comment#4804,cval_lineitem_l_shipdate#4805,cl_quantity#4806,cl_extendedprice#4807,cl_discount#4808,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4693 AS rid_1#4726, cpfk_orders_lineitem#4694 AS cpfk_orders_lineitem_1#4727, cpfk_supplier_lineitem#4695 AS cpfk_supplier_lineitem_1#4728, cfpk_lineitem_supplier#4696 AS cfpk_lineitem_supplier_1#4729, cfpk_lineitem_partsupp#4697 AS cfpk_lineitem_partsupp_1#4730, cpfk_part_lineitem#4698 AS cpfk_part_lineitem_1#4731, cfpk_lineitem_part#4699 AS cfpk_lineitem_part_1#4732, cpfk_partsupp_lineitem#4700 AS cpfk_partsupp_lineitem_1#4733, cfpk_lineitem_orders#4701 AS cfpk_lineitem_orders_1#4734, cval_lineitem_l_quantity#4702 AS cval_lineitem_l_quantity_1#4735, cval_lineitem_l_extendedprice#4703 AS cval_lineitem_l_extendedprice_1#4736, cval_lineitem_l_discount#4704 AS cval_lineitem_l_discount_1#4737, cval_lineitem_l_tax#4705 AS cval_lineitem_l_tax_1#4738, cval_lineitem_l_returnflag#4706 AS cval_lineitem_l_returnflag_1#4739, cval_lineitem_l_linestatus#4707 AS cval_lineitem_l_linestatus_1#4740, cval_lineitem_l_commitdate#4708 AS cval_lineitem_l_commitdate_1#4741, cval_lineitem_l_receiptdate#4709 AS cval_lineitem_l_receiptdate_1#4742, cval_lineitem_l_shipinstruct#4710 AS cval_lineitem_l_shipinstruct_1#4743, cval_lineitem_l_shipmode#4711 AS cval_lineitem_l_shipmode_1#4744, cval_lineitem_l_comment#4712 AS cval_lineitem_l_comment_1#4745, cval_lineitem_l_shipdate#4713 AS cval_lineitem_l_shipdate_1#4746, cl_quantity#4714 AS cl_quantity_1#4747, cl_extendedprice#4715 AS cl_extendedprice_1#4748, cl_discount#4716 AS cl_discount_1#4749, ... 9 more fields]
            +- Relation[rid#4693,cpfk_orders_lineitem#4694,cpfk_supplier_lineitem#4695,cfpk_lineitem_supplier#4696,cfpk_lineitem_partsupp#4697,cpfk_part_lineitem#4698,cfpk_lineitem_part#4699,cpfk_partsupp_lineitem#4700,cfpk_lineitem_orders#4701,cval_lineitem_l_quantity#4702,cval_lineitem_l_extendedprice#4703,cval_lineitem_l_discount#4704,cval_lineitem_l_tax#4705,cval_lineitem_l_returnflag#4706,cval_lineitem_l_linestatus#4707,cval_lineitem_l_commitdate#4708,cval_lineitem_l_receiptdate#4709,cval_lineitem_l_shipinstruct#4710,cval_lineitem_l_shipmode#4711,cval_lineitem_l_comment#4712,cval_lineitem_l_shipdate#4713,cl_quantity#4714,cl_extendedprice#4715,cl_discount#4716,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 78335ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/11 03:34:13 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:34:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4909L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/11 03:34:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:34:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:34:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4909L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#4911 AS rid_0#4944, cpfk_orders_lineitem#4912 AS cpfk_orders_lineitem_0#4945, cpfk_supplier_lineitem#4913 AS cpfk_supplier_lineitem_0#4946, cfpk_lineitem_supplier#4914 AS cfpk_lineitem_supplier_0#4947, cfpk_lineitem_partsupp#4915 AS cfpk_lineitem_partsupp_0#4948, cpfk_part_lineitem#4916 AS cpfk_part_lineitem_0#4949, cfpk_lineitem_part#4917 AS cfpk_lineitem_part_0#4950, cpfk_partsupp_lineitem#4918 AS cpfk_partsupp_lineitem_0#4951, cfpk_lineitem_orders#4919 AS cfpk_lineitem_orders_0#4952, cval_lineitem_l_quantity#4920 AS cval_lineitem_l_quantity_0#4953, cval_lineitem_l_extendedprice#4921 AS cval_lineitem_l_extendedprice_0#4954, cval_lineitem_l_discount#4922 AS cval_lineitem_l_discount_0#4955, cval_lineitem_l_tax#4923 AS cval_lineitem_l_tax_0#4956, cval_lineitem_l_returnflag#4924 AS cval_lineitem_l_returnflag_0#4957, cval_lineitem_l_linestatus#4925 AS cval_lineitem_l_linestatus_0#4958, cval_lineitem_l_commitdate#4926 AS cval_lineitem_l_commitdate_0#4959, cval_lineitem_l_receiptdate#4927 AS cval_lineitem_l_receiptdate_0#4960, cval_lineitem_l_shipinstruct#4928 AS cval_lineitem_l_shipinstruct_0#4961, cval_lineitem_l_shipmode#4929 AS cval_lineitem_l_shipmode_0#4962, cval_lineitem_l_comment#4930 AS cval_lineitem_l_comment_0#4963, cval_lineitem_l_shipdate#4931 AS cval_lineitem_l_shipdate_0#4964, cl_quantity#4932 AS cl_quantity_0#4965, cl_extendedprice#4933 AS cl_extendedprice_0#4966, cl_discount#4934 AS cl_discount_0#4967, ... 9 more fields]
            :     :     :  :  +- Relation[rid#4911,cpfk_orders_lineitem#4912,cpfk_supplier_lineitem#4913,cfpk_lineitem_supplier#4914,cfpk_lineitem_partsupp#4915,cpfk_part_lineitem#4916,cfpk_lineitem_part#4917,cpfk_partsupp_lineitem#4918,cfpk_lineitem_orders#4919,cval_lineitem_l_quantity#4920,cval_lineitem_l_extendedprice#4921,cval_lineitem_l_discount#4922,cval_lineitem_l_tax#4923,cval_lineitem_l_returnflag#4924,cval_lineitem_l_linestatus#4925,cval_lineitem_l_commitdate#4926,cval_lineitem_l_receiptdate#4927,cval_lineitem_l_shipinstruct#4928,cval_lineitem_l_shipmode#4929,cval_lineitem_l_comment#4930,cval_lineitem_l_shipdate#4931,cl_quantity#4932,cl_extendedprice#4933,cl_discount#4934,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#4977 AS rid_0#5010, cpfk_orders_lineitem#4978 AS cpfk_orders_lineitem_0#5011, cpfk_supplier_lineitem#4979 AS cpfk_supplier_lineitem_0#5012, cfpk_lineitem_supplier#4980 AS cfpk_lineitem_supplier_0#5013, cfpk_lineitem_partsupp#4981 AS cfpk_lineitem_partsupp_0#5014, cpfk_part_lineitem#4982 AS cpfk_part_lineitem_0#5015, cfpk_lineitem_part#4983 AS cfpk_lineitem_part_0#5016, cpfk_partsupp_lineitem#4984 AS cpfk_partsupp_lineitem_0#5017, cfpk_lineitem_orders#4985 AS cfpk_lineitem_orders_0#5018, cval_lineitem_l_quantity#4986 AS cval_lineitem_l_quantity_0#5019, cval_lineitem_l_extendedprice#4987 AS cval_lineitem_l_extendedprice_0#5020, cval_lineitem_l_discount#4988 AS cval_lineitem_l_discount_0#5021, cval_lineitem_l_tax#4989 AS cval_lineitem_l_tax_0#5022, cval_lineitem_l_returnflag#4990 AS cval_lineitem_l_returnflag_0#5023, cval_lineitem_l_linestatus#4991 AS cval_lineitem_l_linestatus_0#5024, cval_lineitem_l_commitdate#4992 AS cval_lineitem_l_commitdate_0#5025, cval_lineitem_l_receiptdate#4993 AS cval_lineitem_l_receiptdate_0#5026, cval_lineitem_l_shipinstruct#4994 AS cval_lineitem_l_shipinstruct_0#5027, cval_lineitem_l_shipmode#4995 AS cval_lineitem_l_shipmode_0#5028, cval_lineitem_l_comment#4996 AS cval_lineitem_l_comment_0#5029, cval_lineitem_l_shipdate#4997 AS cval_lineitem_l_shipdate_0#5030, cl_quantity#4998 AS cl_quantity_0#5031, cl_extendedprice#4999 AS cl_extendedprice_0#5032, cl_discount#5000 AS cl_discount_0#5033, ... 9 more fields]
            :     :     :        +- Relation[rid#4977,cpfk_orders_lineitem#4978,cpfk_supplier_lineitem#4979,cfpk_lineitem_supplier#4980,cfpk_lineitem_partsupp#4981,cpfk_part_lineitem#4982,cfpk_lineitem_part#4983,cpfk_partsupp_lineitem#4984,cfpk_lineitem_orders#4985,cval_lineitem_l_quantity#4986,cval_lineitem_l_extendedprice#4987,cval_lineitem_l_discount#4988,cval_lineitem_l_tax#4989,cval_lineitem_l_returnflag#4990,cval_lineitem_l_linestatus#4991,cval_lineitem_l_commitdate#4992,cval_lineitem_l_receiptdate#4993,cval_lineitem_l_shipinstruct#4994,cval_lineitem_l_shipmode#4995,cval_lineitem_l_comment#4996,cval_lineitem_l_shipdate#4997,cl_quantity#4998,cl_extendedprice#4999,cl_discount#5000,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#5043 AS rid_1#5060, cpfk_customer_orders#5044 AS cpfk_customer_orders_1#5061, cfpk_orders_customer#5045 AS cfpk_orders_customer_1#5062, cval_orders_o_orderstatus#5046 AS cval_orders_o_orderstatus_1#5063, cval_orders_o_totalprice#5047 AS cval_orders_o_totalprice_1#5064, cval_orders_o_orderpriority#5048 AS cval_orders_o_orderpriority_1#5065, cval_orders_o_clerk#5049 AS cval_orders_o_clerk_1#5066, cval_orders_o_shippriority#5050 AS cval_orders_o_shippriority_1#5067, cval_orders_o_comment#5051 AS cval_orders_o_comment_1#5068, cval_orders_o_orderdate#5052 AS cval_orders_o_orderdate_1#5069, co_orderstatus#5053 AS co_orderstatus_1#5070, co_totalprice#5054 AS co_totalprice_1#5071, co_orderpriority#5055 AS co_orderpriority_1#5072, co_clerk#5056 AS co_clerk_1#5073, co_shippriority#5057 AS co_shippriority_1#5074, co_comment#5058 AS co_comment_1#5075, co_orderdate#5059 AS co_orderdate_1#5076]
            :     :        +- Relation[rid#5043,cpfk_customer_orders#5044,cfpk_orders_customer#5045,cval_orders_o_orderstatus#5046,cval_orders_o_totalprice#5047,cval_orders_o_orderpriority#5048,cval_orders_o_clerk#5049,cval_orders_o_shippriority#5050,cval_orders_o_comment#5051,cval_orders_o_orderdate#5052,co_orderstatus#5053,co_totalprice#5054,co_orderpriority#5055,co_clerk#5056,co_shippriority#5057,co_comment#5058,co_orderdate#5059] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#5077 AS rid_2#5092, cpfk_nation_customer#5078 AS cpfk_nation_customer_2#5093, cfpk_customer_nation#5079 AS cfpk_customer_nation_2#5094, cval_customer_c_name#5080 AS cval_customer_c_name_2#5095, cval_customer_c_address#5081 AS cval_customer_c_address_2#5096, cval_customer_c_phone#5082 AS cval_customer_c_phone_2#5097, cval_customer_c_acctbal#5083 AS cval_customer_c_acctbal_2#5098, cval_customer_c_comment#5084 AS cval_customer_c_comment_2#5099, cval_customer_c_mktsegment#5085 AS cval_customer_c_mktsegment_2#5100, cc_name#5086 AS cc_name_2#5101, cc_address#5087 AS cc_address_2#5102, cc_phone#5088 AS cc_phone_2#5103, cc_acctbal#5089 AS cc_acctbal_2#5104, cc_comment#5090 AS cc_comment_2#5105, cc_mktsegment#5091 AS cc_mktsegment_2#5106]
            :        +- Relation[rid#5077,cpfk_nation_customer#5078,cfpk_customer_nation#5079,cval_customer_c_name#5080,cval_customer_c_address#5081,cval_customer_c_phone#5082,cval_customer_c_acctbal#5083,cval_customer_c_comment#5084,cval_customer_c_mktsegment#5085,cc_name#5086,cc_address#5087,cc_phone#5088,cc_acctbal#5089,cc_comment#5090,cc_mktsegment#5091] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#5107 AS rid_3#5114, cpfk_region_nation#5108 AS cpfk_region_nation_3#5115, cfpk_nation_region#5109 AS cfpk_nation_region_3#5116, cval_nation_n_name#5110 AS cval_nation_n_name_3#5117, cval_nation_n_comment#5111 AS cval_nation_n_comment_3#5118, cn_name#5112 AS cn_name_3#5119, cn_comment#5113 AS cn_comment_3#5120]
               +- Relation[rid#5107,cpfk_region_nation#5108,cfpk_nation_region#5109,cval_nation_n_name#5110,cval_nation_n_comment#5111,cn_name#5112,cn_comment#5113] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 60192ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/11 03:35:13 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:35:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5197L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/11 03:35:13 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:35:13 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:35:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:35:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:35:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:35:13 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:35:13 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:35:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5197L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#5199 AS rid_0#5232, cpfk_orders_lineitem#5200 AS cpfk_orders_lineitem_0#5233, cpfk_supplier_lineitem#5201 AS cpfk_supplier_lineitem_0#5234, cfpk_lineitem_supplier#5202 AS cfpk_lineitem_supplier_0#5235, cfpk_lineitem_partsupp#5203 AS cfpk_lineitem_partsupp_0#5236, cpfk_part_lineitem#5204 AS cpfk_part_lineitem_0#5237, cfpk_lineitem_part#5205 AS cfpk_lineitem_part_0#5238, cpfk_partsupp_lineitem#5206 AS cpfk_partsupp_lineitem_0#5239, cfpk_lineitem_orders#5207 AS cfpk_lineitem_orders_0#5240, cval_lineitem_l_quantity#5208 AS cval_lineitem_l_quantity_0#5241, cval_lineitem_l_extendedprice#5209 AS cval_lineitem_l_extendedprice_0#5242, cval_lineitem_l_discount#5210 AS cval_lineitem_l_discount_0#5243, cval_lineitem_l_tax#5211 AS cval_lineitem_l_tax_0#5244, cval_lineitem_l_returnflag#5212 AS cval_lineitem_l_returnflag_0#5245, cval_lineitem_l_linestatus#5213 AS cval_lineitem_l_linestatus_0#5246, cval_lineitem_l_commitdate#5214 AS cval_lineitem_l_commitdate_0#5247, cval_lineitem_l_receiptdate#5215 AS cval_lineitem_l_receiptdate_0#5248, cval_lineitem_l_shipinstruct#5216 AS cval_lineitem_l_shipinstruct_0#5249, cval_lineitem_l_shipmode#5217 AS cval_lineitem_l_shipmode_0#5250, cval_lineitem_l_comment#5218 AS cval_lineitem_l_comment_0#5251, cval_lineitem_l_shipdate#5219 AS cval_lineitem_l_shipdate_0#5252, cl_quantity#5220 AS cl_quantity_0#5253, cl_extendedprice#5221 AS cl_extendedprice_0#5254, cl_discount#5222 AS cl_discount_0#5255, ... 9 more fields]
            :  +- Relation[rid#5199,cpfk_orders_lineitem#5200,cpfk_supplier_lineitem#5201,cfpk_lineitem_supplier#5202,cfpk_lineitem_partsupp#5203,cpfk_part_lineitem#5204,cfpk_lineitem_part#5205,cpfk_partsupp_lineitem#5206,cfpk_lineitem_orders#5207,cval_lineitem_l_quantity#5208,cval_lineitem_l_extendedprice#5209,cval_lineitem_l_discount#5210,cval_lineitem_l_tax#5211,cval_lineitem_l_returnflag#5212,cval_lineitem_l_linestatus#5213,cval_lineitem_l_commitdate#5214,cval_lineitem_l_receiptdate#5215,cval_lineitem_l_shipinstruct#5216,cval_lineitem_l_shipmode#5217,cval_lineitem_l_comment#5218,cval_lineitem_l_shipdate#5219,cl_quantity#5220,cl_extendedprice#5221,cl_discount#5222,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#5265 AS rid_1#5282, cpfk_customer_orders#5266 AS cpfk_customer_orders_1#5283, cfpk_orders_customer#5267 AS cfpk_orders_customer_1#5284, cval_orders_o_orderstatus#5268 AS cval_orders_o_orderstatus_1#5285, cval_orders_o_totalprice#5269 AS cval_orders_o_totalprice_1#5286, cval_orders_o_orderpriority#5270 AS cval_orders_o_orderpriority_1#5287, cval_orders_o_clerk#5271 AS cval_orders_o_clerk_1#5288, cval_orders_o_shippriority#5272 AS cval_orders_o_shippriority_1#5289, cval_orders_o_comment#5273 AS cval_orders_o_comment_1#5290, cval_orders_o_orderdate#5274 AS cval_orders_o_orderdate_1#5291, co_orderstatus#5275 AS co_orderstatus_1#5292, co_totalprice#5276 AS co_totalprice_1#5293, co_orderpriority#5277 AS co_orderpriority_1#5294, co_clerk#5278 AS co_clerk_1#5295, co_shippriority#5279 AS co_shippriority_1#5296, co_comment#5280 AS co_comment_1#5297, co_orderdate#5281 AS co_orderdate_1#5298]
                  :     :  :  :  :  +- Relation[rid#5265,cpfk_customer_orders#5266,cfpk_orders_customer#5267,cval_orders_o_orderstatus#5268,cval_orders_o_totalprice#5269,cval_orders_o_orderpriority#5270,cval_orders_o_clerk#5271,cval_orders_o_shippriority#5272,cval_orders_o_comment#5273,cval_orders_o_orderdate#5274,co_orderstatus#5275,co_totalprice#5276,co_orderpriority#5277,co_clerk#5278,co_shippriority#5279,co_comment#5280,co_orderdate#5281] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#5299 AS rid_1#5316, cpfk_customer_orders#5300 AS cpfk_customer_orders_1#5317, cfpk_orders_customer#5301 AS cfpk_orders_customer_1#5318, cval_orders_o_orderstatus#5302 AS cval_orders_o_orderstatus_1#5319, cval_orders_o_totalprice#5303 AS cval_orders_o_totalprice_1#5320, cval_orders_o_orderpriority#5304 AS cval_orders_o_orderpriority_1#5321, cval_orders_o_clerk#5305 AS cval_orders_o_clerk_1#5322, cval_orders_o_shippriority#5306 AS cval_orders_o_shippriority_1#5323, cval_orders_o_comment#5307 AS cval_orders_o_comment_1#5324, cval_orders_o_orderdate#5308 AS cval_orders_o_orderdate_1#5325, co_orderstatus#5309 AS co_orderstatus_1#5326, co_totalprice#5310 AS co_totalprice_1#5327, co_orderpriority#5311 AS co_orderpriority_1#5328, co_clerk#5312 AS co_clerk_1#5329, co_shippriority#5313 AS co_shippriority_1#5330, co_comment#5314 AS co_comment_1#5331, co_orderdate#5315 AS co_orderdate_1#5332]
                  :     :  :  :        +- Relation[rid#5299,cpfk_customer_orders#5300,cfpk_orders_customer#5301,cval_orders_o_orderstatus#5302,cval_orders_o_totalprice#5303,cval_orders_o_orderpriority#5304,cval_orders_o_clerk#5305,cval_orders_o_shippriority#5306,cval_orders_o_comment#5307,cval_orders_o_orderdate#5308,co_orderstatus#5309,co_totalprice#5310,co_orderpriority#5311,co_clerk#5312,co_shippriority#5313,co_comment#5314,co_orderdate#5315] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :     :- Project [rid#5399 AS rid_1#5416, cpfk_customer_orders#5400 AS cpfk_customer_orders_1#5417, cfpk_orders_customer#5401 AS cfpk_orders_customer_1#5418, cval_orders_o_orderstatus#5402 AS cval_orders_o_orderstatus_1#5419, cval_orders_o_totalprice#5403 AS cval_orders_o_totalprice_1#5420, cval_orders_o_orderpriority#5404 AS cval_orders_o_orderpriority_1#5421, cval_orders_o_clerk#5405 AS cval_orders_o_clerk_1#5422, cval_orders_o_shippriority#5406 AS cval_orders_o_shippriority_1#5423, cval_orders_o_comment#5407 AS cval_orders_o_comment_1#5424, cval_orders_o_orderdate#5408 AS cval_orders_o_orderdate_1#5425, co_orderstatus#5409 AS co_orderstatus_1#5426, co_totalprice#5410 AS co_totalprice_1#5427, co_orderpriority#5411 AS co_orderpriority_1#5428, co_clerk#5412 AS co_clerk_1#5429, co_shippriority#5413 AS co_shippriority_1#5430, co_comment#5414 AS co_comment_1#5431, co_orderdate#5415 AS co_orderdate_1#5432]
                  :     :  :     :  +- Relation[rid#5399,cpfk_customer_orders#5400,cfpk_orders_customer#5401,cval_orders_o_orderstatus#5402,cval_orders_o_totalprice#5403,cval_orders_o_orderpriority#5404,cval_orders_o_clerk#5405,cval_orders_o_shippriority#5406,cval_orders_o_comment#5407,cval_orders_o_orderdate#5408,co_orderstatus#5409,co_totalprice#5410,co_orderpriority#5411,co_clerk#5412,co_shippriority#5413,co_comment#5414,co_orderdate#5415] JDBCRelation(torders) [numPartitions=1]
                  :     :  :     +- Project [rid#5433 AS rid_2#5466, cpfk_orders_lineitem#5434 AS cpfk_orders_lineitem_2#5467, cpfk_supplier_lineitem#5435 AS cpfk_supplier_lineitem_2#5468, cfpk_lineitem_supplier#5436 AS cfpk_lineitem_supplier_2#5469, cfpk_lineitem_partsupp#5437 AS cfpk_lineitem_partsupp_2#5470, cpfk_part_lineitem#5438 AS cpfk_part_lineitem_2#5471, cfpk_lineitem_part#5439 AS cfpk_lineitem_part_2#5472, cpfk_partsupp_lineitem#5440 AS cpfk_partsupp_lineitem_2#5473, cfpk_lineitem_orders#5441 AS cfpk_lineitem_orders_2#5474, cval_lineitem_l_quantity#5442 AS cval_lineitem_l_quantity_2#5475, cval_lineitem_l_extendedprice#5443 AS cval_lineitem_l_extendedprice_2#5476, cval_lineitem_l_discount#5444 AS cval_lineitem_l_discount_2#5477, cval_lineitem_l_tax#5445 AS cval_lineitem_l_tax_2#5478, cval_lineitem_l_returnflag#5446 AS cval_lineitem_l_returnflag_2#5479, cval_lineitem_l_linestatus#5447 AS cval_lineitem_l_linestatus_2#5480, cval_lineitem_l_commitdate#5448 AS cval_lineitem_l_commitdate_2#5481, cval_lineitem_l_receiptdate#5449 AS cval_lineitem_l_receiptdate_2#5482, cval_lineitem_l_shipinstruct#5450 AS cval_lineitem_l_shipinstruct_2#5483, cval_lineitem_l_shipmode#5451 AS cval_lineitem_l_shipmode_2#5484, cval_lineitem_l_comment#5452 AS cval_lineitem_l_comment_2#5485, cval_lineitem_l_shipdate#5453 AS cval_lineitem_l_shipdate_2#5486, cl_quantity#5454 AS cl_quantity_2#5487, cl_extendedprice#5455 AS cl_extendedprice_2#5488, cl_discount#5456 AS cl_discount_2#5489, ... 9 more fields]
                  :     :  :        +- Relation[rid#5433,cpfk_orders_lineitem#5434,cpfk_supplier_lineitem#5435,cfpk_lineitem_supplier#5436,cfpk_lineitem_partsupp#5437,cpfk_part_lineitem#5438,cfpk_lineitem_part#5439,cpfk_partsupp_lineitem#5440,cfpk_lineitem_orders#5441,cval_lineitem_l_quantity#5442,cval_lineitem_l_extendedprice#5443,cval_lineitem_l_discount#5444,cval_lineitem_l_tax#5445,cval_lineitem_l_returnflag#5446,cval_lineitem_l_linestatus#5447,cval_lineitem_l_commitdate#5448,cval_lineitem_l_receiptdate#5449,cval_lineitem_l_shipinstruct#5450,cval_lineitem_l_shipmode#5451,cval_lineitem_l_comment#5452,cval_lineitem_l_shipdate#5453,cl_quantity#5454,cl_extendedprice#5455,cl_discount#5456,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#5333 AS rid_2#5366, cpfk_orders_lineitem#5334 AS cpfk_orders_lineitem_2#5367, cpfk_supplier_lineitem#5335 AS cpfk_supplier_lineitem_2#5368, cfpk_lineitem_supplier#5336 AS cfpk_lineitem_supplier_2#5369, cfpk_lineitem_partsupp#5337 AS cfpk_lineitem_partsupp_2#5370, cpfk_part_lineitem#5338 AS cpfk_part_lineitem_2#5371, cfpk_lineitem_part#5339 AS cfpk_lineitem_part_2#5372, cpfk_partsupp_lineitem#5340 AS cpfk_partsupp_lineitem_2#5373, cfpk_lineitem_orders#5341 AS cfpk_lineitem_orders_2#5374, cval_lineitem_l_quantity#5342 AS cval_lineitem_l_quantity_2#5375, cval_lineitem_l_extendedprice#5343 AS cval_lineitem_l_extendedprice_2#5376, cval_lineitem_l_discount#5344 AS cval_lineitem_l_discount_2#5377, cval_lineitem_l_tax#5345 AS cval_lineitem_l_tax_2#5378, cval_lineitem_l_returnflag#5346 AS cval_lineitem_l_returnflag_2#5379, cval_lineitem_l_linestatus#5347 AS cval_lineitem_l_linestatus_2#5380, cval_lineitem_l_commitdate#5348 AS cval_lineitem_l_commitdate_2#5381, cval_lineitem_l_receiptdate#5349 AS cval_lineitem_l_receiptdate_2#5382, cval_lineitem_l_shipinstruct#5350 AS cval_lineitem_l_shipinstruct_2#5383, cval_lineitem_l_shipmode#5351 AS cval_lineitem_l_shipmode_2#5384, cval_lineitem_l_comment#5352 AS cval_lineitem_l_comment_2#5385, cval_lineitem_l_shipdate#5353 AS cval_lineitem_l_shipdate_2#5386, cl_quantity#5354 AS cl_quantity_2#5387, cl_extendedprice#5355 AS cl_extendedprice_2#5388, cl_discount#5356 AS cl_discount_2#5389, ... 9 more fields]
                  :     :     +- Relation[rid#5333,cpfk_orders_lineitem#5334,cpfk_supplier_lineitem#5335,cfpk_lineitem_supplier#5336,cfpk_lineitem_partsupp#5337,cpfk_part_lineitem#5338,cfpk_lineitem_part#5339,cpfk_partsupp_lineitem#5340,cfpk_lineitem_orders#5341,cval_lineitem_l_quantity#5342,cval_lineitem_l_extendedprice#5343,cval_lineitem_l_discount#5344,cval_lineitem_l_tax#5345,cval_lineitem_l_returnflag#5346,cval_lineitem_l_linestatus#5347,cval_lineitem_l_commitdate#5348,cval_lineitem_l_receiptdate#5349,cval_lineitem_l_shipinstruct#5350,cval_lineitem_l_shipmode#5351,cval_lineitem_l_comment#5352,cval_lineitem_l_shipdate#5353,cl_quantity#5354,cl_extendedprice#5355,cl_discount#5356,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#5499 AS rid_3#5512, cpfk_nation_supplier#5500 AS cpfk_nation_supplier_3#5513, cfpk_supplier_nation#5501 AS cfpk_supplier_nation_3#5514, cval_supplier_s_name#5502 AS cval_supplier_s_name_3#5515, cval_supplier_s_address#5503 AS cval_supplier_s_address_3#5516, cval_supplier_s_phone#5504 AS cval_supplier_s_phone_3#5517, cval_supplier_s_acctbal#5505 AS cval_supplier_s_acctbal_3#5518, cval_supplier_s_comment#5506 AS cval_supplier_s_comment_3#5519, cs_name#5507 AS cs_name_3#5520, cs_address#5508 AS cs_address_3#5521, cs_phone#5509 AS cs_phone_3#5522, cs_acctbal#5510 AS cs_acctbal_3#5523, cs_comment#5511 AS cs_comment_3#5524]
                  :        +- Relation[rid#5499,cpfk_nation_supplier#5500,cfpk_supplier_nation#5501,cval_supplier_s_name#5502,cval_supplier_s_address#5503,cval_supplier_s_phone#5504,cval_supplier_s_acctbal#5505,cval_supplier_s_comment#5506,cs_name#5507,cs_address#5508,cs_phone#5509,cs_acctbal#5510,cs_comment#5511] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#5525 AS rid_4#5532, cpfk_region_nation#5526 AS cpfk_region_nation_4#5533, cfpk_nation_region#5527 AS cfpk_nation_region_4#5534, cval_nation_n_name#5528 AS cval_nation_n_name_4#5535, cval_nation_n_comment#5529 AS cval_nation_n_comment_4#5536, cn_name#5530 AS cn_name_4#5537, cn_comment#5531 AS cn_comment_4#5538]
                     :  +- Relation[rid#5525,cpfk_region_nation#5526,cfpk_nation_region#5527,cval_nation_n_name#5528,cval_nation_n_comment#5529,cn_name#5530,cn_comment#5531] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#5539 AS rid_4#5546, cpfk_region_nation#5540 AS cpfk_region_nation_4#5547, cfpk_nation_region#5541 AS cfpk_nation_region_4#5548, cval_nation_n_name#5542 AS cval_nation_n_name_4#5549, cval_nation_n_comment#5543 AS cval_nation_n_comment_4#5550, cn_name#5544 AS cn_name_4#5551, cn_comment#5545 AS cn_comment_4#5552]
                           +- Relation[rid#5539,cpfk_region_nation#5540,cfpk_nation_region#5541,cval_nation_n_name#5542,cval_nation_n_comment#5543,cn_name#5544,cn_comment#5545] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 245290ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/11 03:39:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:39:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5663L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 03:39:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:39:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:39:18 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:39:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5663L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#5665 AS rid_0#5682, cval_part_p_name#5666 AS cval_part_p_name_0#5683, cval_part_p_mfgr#5667 AS cval_part_p_mfgr_0#5684, cval_part_p_type#5668 AS cval_part_p_type_0#5685, cval_part_p_size#5669 AS cval_part_p_size_0#5686, cval_part_p_container#5670 AS cval_part_p_container_0#5687, cval_part_p_retailprice#5671 AS cval_part_p_retailprice_0#5688, cval_part_p_comment#5672 AS cval_part_p_comment_0#5689, cval_part_p_brand#5673 AS cval_part_p_brand_0#5690, cp_name#5674 AS cp_name_0#5691, cp_mfgr#5675 AS cp_mfgr_0#5692, cp_type#5676 AS cp_type_0#5693, cp_size#5677 AS cp_size_0#5694, cp_container#5678 AS cp_container_0#5695, cp_retailprice#5679 AS cp_retailprice_0#5696, cp_comment#5680 AS cp_comment_0#5697, cp_brand#5681 AS cp_brand_0#5698]
         :  :  :  +- Relation[rid#5665,cval_part_p_name#5666,cval_part_p_mfgr#5667,cval_part_p_type#5668,cval_part_p_size#5669,cval_part_p_container#5670,cval_part_p_retailprice#5671,cval_part_p_comment#5672,cval_part_p_brand#5673,cp_name#5674,cp_mfgr#5675,cp_type#5676,cp_size#5677,cp_container#5678,cp_retailprice#5679,cp_comment#5680,cp_brand#5681] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#5699 AS rid_0#5716, cval_part_p_name#5700 AS cval_part_p_name_0#5717, cval_part_p_mfgr#5701 AS cval_part_p_mfgr_0#5718, cval_part_p_type#5702 AS cval_part_p_type_0#5719, cval_part_p_size#5703 AS cval_part_p_size_0#5720, cval_part_p_container#5704 AS cval_part_p_container_0#5721, cval_part_p_retailprice#5705 AS cval_part_p_retailprice_0#5722, cval_part_p_comment#5706 AS cval_part_p_comment_0#5723, cval_part_p_brand#5707 AS cval_part_p_brand_0#5724, cp_name#5708 AS cp_name_0#5725, cp_mfgr#5709 AS cp_mfgr_0#5726, cp_type#5710 AS cp_type_0#5727, cp_size#5711 AS cp_size_0#5728, cp_container#5712 AS cp_container_0#5729, cp_retailprice#5713 AS cp_retailprice_0#5730, cp_comment#5714 AS cp_comment_0#5731, cp_brand#5715 AS cp_brand_0#5732]
         :  :        +- Relation[rid#5699,cval_part_p_name#5700,cval_part_p_mfgr#5701,cval_part_p_type#5702,cval_part_p_size#5703,cval_part_p_container#5704,cval_part_p_retailprice#5705,cval_part_p_comment#5706,cval_part_p_brand#5707,cp_name#5708,cp_mfgr#5709,cp_type#5710,cp_size#5711,cp_container#5712,cp_retailprice#5713,cp_comment#5714,cp_brand#5715] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :     :- Project [rid#5755 AS rid_0#5772, cval_part_p_name#5756 AS cval_part_p_name_0#5773, cval_part_p_mfgr#5757 AS cval_part_p_mfgr_0#5774, cval_part_p_type#5758 AS cval_part_p_type_0#5775, cval_part_p_size#5759 AS cval_part_p_size_0#5776, cval_part_p_container#5760 AS cval_part_p_container_0#5777, cval_part_p_retailprice#5761 AS cval_part_p_retailprice_0#5778, cval_part_p_comment#5762 AS cval_part_p_comment_0#5779, cval_part_p_brand#5763 AS cval_part_p_brand_0#5780, cp_name#5764 AS cp_name_0#5781, cp_mfgr#5765 AS cp_mfgr_0#5782, cp_type#5766 AS cp_type_0#5783, cp_size#5767 AS cp_size_0#5784, cp_container#5768 AS cp_container_0#5785, cp_retailprice#5769 AS cp_retailprice_0#5786, cp_comment#5770 AS cp_comment_0#5787, cp_brand#5771 AS cp_brand_0#5788]
         :     :  +- Relation[rid#5755,cval_part_p_name#5756,cval_part_p_mfgr#5757,cval_part_p_type#5758,cval_part_p_size#5759,cval_part_p_container#5760,cval_part_p_retailprice#5761,cval_part_p_comment#5762,cval_part_p_brand#5763,cp_name#5764,cp_mfgr#5765,cp_type#5766,cp_size#5767,cp_container#5768,cp_retailprice#5769,cp_comment#5770,cp_brand#5771] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#5789 AS rid_1#5800, cpfk_part_partsupp#5790 AS cpfk_part_partsupp_1#5801, cfpk_partsupp_part#5791 AS cfpk_partsupp_part_1#5802, cpfk_supplier_partsupp#5792 AS cpfk_supplier_partsupp_1#5803, cfpk_partsupp_supplier#5793 AS cfpk_partsupp_supplier_1#5804, cval_partsupp_ps_availqty#5794 AS cval_partsupp_ps_availqty_1#5805, cval_partsupp_ps_supplycost#5795 AS cval_partsupp_ps_supplycost_1#5806, cval_partsupp_ps_comment#5796 AS cval_partsupp_ps_comment_1#5807, cps_availqty#5797 AS cps_availqty_1#5808, cps_supplycost#5798 AS cps_supplycost_1#5809, cps_comment#5799 AS cps_comment_1#5810]
         :        +- Relation[rid#5789,cpfk_part_partsupp#5790,cfpk_partsupp_part#5791,cpfk_supplier_partsupp#5792,cfpk_partsupp_supplier#5793,cval_partsupp_ps_availqty#5794,cval_partsupp_ps_supplycost#5795,cval_partsupp_ps_comment#5796,cps_availqty#5797,cps_supplycost#5798,cps_comment#5799] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#5733 AS rid_1#5744, cpfk_part_partsupp#5734 AS cpfk_part_partsupp_1#5745, cfpk_partsupp_part#5735 AS cfpk_partsupp_part_1#5746, cpfk_supplier_partsupp#5736 AS cpfk_supplier_partsupp_1#5747, cfpk_partsupp_supplier#5737 AS cfpk_partsupp_supplier_1#5748, cval_partsupp_ps_availqty#5738 AS cval_partsupp_ps_availqty_1#5749, cval_partsupp_ps_supplycost#5739 AS cval_partsupp_ps_supplycost_1#5750, cval_partsupp_ps_comment#5740 AS cval_partsupp_ps_comment_1#5751, cps_availqty#5741 AS cps_availqty_1#5752, cps_supplycost#5742 AS cps_supplycost_1#5753, cps_comment#5743 AS cps_comment_1#5754]
            +- Relation[rid#5733,cpfk_part_partsupp#5734,cfpk_partsupp_part#5735,cpfk_supplier_partsupp#5736,cfpk_partsupp_supplier#5737,cval_partsupp_ps_availqty#5738,cval_partsupp_ps_supplycost#5739,cval_partsupp_ps_comment#5740,cps_availqty#5741,cps_supplycost#5742,cps_comment#5743] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 11078ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/11 03:39:29 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:39:29 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5844L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 03:39:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:39:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:39:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:39:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:39:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:39:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:39:29 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:39:29 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5844L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#5846 AS rid_0#5863, cval_part_p_name#5847 AS cval_part_p_name_0#5864, cval_part_p_mfgr#5848 AS cval_part_p_mfgr_0#5865, cval_part_p_type#5849 AS cval_part_p_type_0#5866, cval_part_p_size#5850 AS cval_part_p_size_0#5867, cval_part_p_container#5851 AS cval_part_p_container_0#5868, cval_part_p_retailprice#5852 AS cval_part_p_retailprice_0#5869, cval_part_p_comment#5853 AS cval_part_p_comment_0#5870, cval_part_p_brand#5854 AS cval_part_p_brand_0#5871, cp_name#5855 AS cp_name_0#5872, cp_mfgr#5856 AS cp_mfgr_0#5873, cp_type#5857 AS cp_type_0#5874, cp_size#5858 AS cp_size_0#5875, cp_container#5859 AS cp_container_0#5876, cp_retailprice#5860 AS cp_retailprice_0#5877, cp_comment#5861 AS cp_comment_0#5878, cp_brand#5862 AS cp_brand_0#5879]
         :  :  :  :  +- Relation[rid#5846,cval_part_p_name#5847,cval_part_p_mfgr#5848,cval_part_p_type#5849,cval_part_p_size#5850,cval_part_p_container#5851,cval_part_p_retailprice#5852,cval_part_p_comment#5853,cval_part_p_brand#5854,cp_name#5855,cp_mfgr#5856,cp_type#5857,cp_size#5858,cp_container#5859,cp_retailprice#5860,cp_comment#5861,cp_brand#5862] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#5880 AS rid_0#5897, cval_part_p_name#5881 AS cval_part_p_name_0#5898, cval_part_p_mfgr#5882 AS cval_part_p_mfgr_0#5899, cval_part_p_type#5883 AS cval_part_p_type_0#5900, cval_part_p_size#5884 AS cval_part_p_size_0#5901, cval_part_p_container#5885 AS cval_part_p_container_0#5902, cval_part_p_retailprice#5886 AS cval_part_p_retailprice_0#5903, cval_part_p_comment#5887 AS cval_part_p_comment_0#5904, cval_part_p_brand#5888 AS cval_part_p_brand_0#5905, cp_name#5889 AS cp_name_0#5906, cp_mfgr#5890 AS cp_mfgr_0#5907, cp_type#5891 AS cp_type_0#5908, cp_size#5892 AS cp_size_0#5909, cp_container#5893 AS cp_container_0#5910, cp_retailprice#5894 AS cp_retailprice_0#5911, cp_comment#5895 AS cp_comment_0#5912, cp_brand#5896 AS cp_brand_0#5913]
         :  :  :        +- Relation[rid#5880,cval_part_p_name#5881,cval_part_p_mfgr#5882,cval_part_p_type#5883,cval_part_p_size#5884,cval_part_p_container#5885,cval_part_p_retailprice#5886,cval_part_p_comment#5887,cval_part_p_brand#5888,cp_name#5889,cp_mfgr#5890,cp_type#5891,cp_size#5892,cp_container#5893,cp_retailprice#5894,cp_comment#5895,cp_brand#5896] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#5914 AS rid_0#5931, cval_part_p_name#5915 AS cval_part_p_name_0#5932, cval_part_p_mfgr#5916 AS cval_part_p_mfgr_0#5933, cval_part_p_type#5917 AS cval_part_p_type_0#5934, cval_part_p_size#5918 AS cval_part_p_size_0#5935, cval_part_p_container#5919 AS cval_part_p_container_0#5936, cval_part_p_retailprice#5920 AS cval_part_p_retailprice_0#5937, cval_part_p_comment#5921 AS cval_part_p_comment_0#5938, cval_part_p_brand#5922 AS cval_part_p_brand_0#5939, cp_name#5923 AS cp_name_0#5940, cp_mfgr#5924 AS cp_mfgr_0#5941, cp_type#5925 AS cp_type_0#5942, cp_size#5926 AS cp_size_0#5943, cp_container#5927 AS cp_container_0#5944, cp_retailprice#5928 AS cp_retailprice_0#5945, cp_comment#5929 AS cp_comment_0#5946, cp_brand#5930 AS cp_brand_0#5947]
         :  :        +- Relation[rid#5914,cval_part_p_name#5915,cval_part_p_mfgr#5916,cval_part_p_type#5917,cval_part_p_size#5918,cval_part_p_container#5919,cval_part_p_retailprice#5920,cval_part_p_comment#5921,cval_part_p_brand#5922,cp_name#5923,cp_mfgr#5924,cp_type#5925,cp_size#5926,cp_container#5927,cp_retailprice#5928,cp_comment#5929,cp_brand#5930] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#6146 AS rid_0#6163, cval_part_p_name#6147 AS cval_part_p_name_0#6164, cval_part_p_mfgr#6148 AS cval_part_p_mfgr_0#6165, cval_part_p_type#6149 AS cval_part_p_type_0#6166, cval_part_p_size#6150 AS cval_part_p_size_0#6167, cval_part_p_container#6151 AS cval_part_p_container_0#6168, cval_part_p_retailprice#6152 AS cval_part_p_retailprice_0#6169, cval_part_p_comment#6153 AS cval_part_p_comment_0#6170, cval_part_p_brand#6154 AS cval_part_p_brand_0#6171, cp_name#6155 AS cp_name_0#6172, cp_mfgr#6156 AS cp_mfgr_0#6173, cp_type#6157 AS cp_type_0#6174, cp_size#6158 AS cp_size_0#6175, cp_container#6159 AS cp_container_0#6176, cp_retailprice#6160 AS cp_retailprice_0#6177, cp_comment#6161 AS cp_comment_0#6178, cp_brand#6162 AS cp_brand_0#6179]
         :     :  +- Relation[rid#6146,cval_part_p_name#6147,cval_part_p_mfgr#6148,cval_part_p_type#6149,cval_part_p_size#6150,cval_part_p_container#6151,cval_part_p_retailprice#6152,cval_part_p_comment#6153,cval_part_p_brand#6154,cp_name#6155,cp_mfgr#6156,cp_type#6157,cp_size#6158,cp_container#6159,cp_retailprice#6160,cp_comment#6161,cp_brand#6162] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#6180 AS rid_1#6213, cpfk_orders_lineitem#6181 AS cpfk_orders_lineitem_1#6214, cpfk_supplier_lineitem#6182 AS cpfk_supplier_lineitem_1#6215, cfpk_lineitem_supplier#6183 AS cfpk_lineitem_supplier_1#6216, cfpk_lineitem_partsupp#6184 AS cfpk_lineitem_partsupp_1#6217, cpfk_part_lineitem#6185 AS cpfk_part_lineitem_1#6218, cfpk_lineitem_part#6186 AS cfpk_lineitem_part_1#6219, cpfk_partsupp_lineitem#6187 AS cpfk_partsupp_lineitem_1#6220, cfpk_lineitem_orders#6188 AS cfpk_lineitem_orders_1#6221, cval_lineitem_l_quantity#6189 AS cval_lineitem_l_quantity_1#6222, cval_lineitem_l_extendedprice#6190 AS cval_lineitem_l_extendedprice_1#6223, cval_lineitem_l_discount#6191 AS cval_lineitem_l_discount_1#6224, cval_lineitem_l_tax#6192 AS cval_lineitem_l_tax_1#6225, cval_lineitem_l_returnflag#6193 AS cval_lineitem_l_returnflag_1#6226, cval_lineitem_l_linestatus#6194 AS cval_lineitem_l_linestatus_1#6227, cval_lineitem_l_commitdate#6195 AS cval_lineitem_l_commitdate_1#6228, cval_lineitem_l_receiptdate#6196 AS cval_lineitem_l_receiptdate_1#6229, cval_lineitem_l_shipinstruct#6197 AS cval_lineitem_l_shipinstruct_1#6230, cval_lineitem_l_shipmode#6198 AS cval_lineitem_l_shipmode_1#6231, cval_lineitem_l_comment#6199 AS cval_lineitem_l_comment_1#6232, cval_lineitem_l_shipdate#6200 AS cval_lineitem_l_shipdate_1#6233, cl_quantity#6201 AS cl_quantity_1#6234, cl_extendedprice#6202 AS cl_extendedprice_1#6235, cl_discount#6203 AS cl_discount_1#6236, ... 9 more fields]
         :        +- Relation[rid#6180,cpfk_orders_lineitem#6181,cpfk_supplier_lineitem#6182,cfpk_lineitem_supplier#6183,cfpk_lineitem_partsupp#6184,cpfk_part_lineitem#6185,cfpk_lineitem_part#6186,cpfk_partsupp_lineitem#6187,cfpk_lineitem_orders#6188,cval_lineitem_l_quantity#6189,cval_lineitem_l_extendedprice#6190,cval_lineitem_l_discount#6191,cval_lineitem_l_tax#6192,cval_lineitem_l_returnflag#6193,cval_lineitem_l_linestatus#6194,cval_lineitem_l_commitdate#6195,cval_lineitem_l_receiptdate#6196,cval_lineitem_l_shipinstruct#6197,cval_lineitem_l_shipmode#6198,cval_lineitem_l_comment#6199,cval_lineitem_l_shipdate#6200,cl_quantity#6201,cl_extendedprice#6202,cl_discount#6203,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#5948 AS rid_1#5981, cpfk_orders_lineitem#5949 AS cpfk_orders_lineitem_1#5982, cpfk_supplier_lineitem#5950 AS cpfk_supplier_lineitem_1#5983, cfpk_lineitem_supplier#5951 AS cfpk_lineitem_supplier_1#5984, cfpk_lineitem_partsupp#5952 AS cfpk_lineitem_partsupp_1#5985, cpfk_part_lineitem#5953 AS cpfk_part_lineitem_1#5986, cfpk_lineitem_part#5954 AS cfpk_lineitem_part_1#5987, cpfk_partsupp_lineitem#5955 AS cpfk_partsupp_lineitem_1#5988, cfpk_lineitem_orders#5956 AS cfpk_lineitem_orders_1#5989, cval_lineitem_l_quantity#5957 AS cval_lineitem_l_quantity_1#5990, cval_lineitem_l_extendedprice#5958 AS cval_lineitem_l_extendedprice_1#5991, cval_lineitem_l_discount#5959 AS cval_lineitem_l_discount_1#5992, cval_lineitem_l_tax#5960 AS cval_lineitem_l_tax_1#5993, cval_lineitem_l_returnflag#5961 AS cval_lineitem_l_returnflag_1#5994, cval_lineitem_l_linestatus#5962 AS cval_lineitem_l_linestatus_1#5995, cval_lineitem_l_commitdate#5963 AS cval_lineitem_l_commitdate_1#5996, cval_lineitem_l_receiptdate#5964 AS cval_lineitem_l_receiptdate_1#5997, cval_lineitem_l_shipinstruct#5965 AS cval_lineitem_l_shipinstruct_1#5998, cval_lineitem_l_shipmode#5966 AS cval_lineitem_l_shipmode_1#5999, cval_lineitem_l_comment#5967 AS cval_lineitem_l_comment_1#6000, cval_lineitem_l_shipdate#5968 AS cval_lineitem_l_shipdate_1#6001, cl_quantity#5969 AS cl_quantity_1#6002, cl_extendedprice#5970 AS cl_extendedprice_1#6003, cl_discount#5971 AS cl_discount_1#6004, ... 9 more fields]
            :  :  +- Relation[rid#5948,cpfk_orders_lineitem#5949,cpfk_supplier_lineitem#5950,cfpk_lineitem_supplier#5951,cfpk_lineitem_partsupp#5952,cpfk_part_lineitem#5953,cfpk_lineitem_part#5954,cpfk_partsupp_lineitem#5955,cfpk_lineitem_orders#5956,cval_lineitem_l_quantity#5957,cval_lineitem_l_extendedprice#5958,cval_lineitem_l_discount#5959,cval_lineitem_l_tax#5960,cval_lineitem_l_returnflag#5961,cval_lineitem_l_linestatus#5962,cval_lineitem_l_commitdate#5963,cval_lineitem_l_receiptdate#5964,cval_lineitem_l_shipinstruct#5965,cval_lineitem_l_shipmode#5966,cval_lineitem_l_comment#5967,cval_lineitem_l_shipdate#5968,cl_quantity#5969,cl_extendedprice#5970,cl_discount#5971,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#6014 AS rid_1#6047, cpfk_orders_lineitem#6015 AS cpfk_orders_lineitem_1#6048, cpfk_supplier_lineitem#6016 AS cpfk_supplier_lineitem_1#6049, cfpk_lineitem_supplier#6017 AS cfpk_lineitem_supplier_1#6050, cfpk_lineitem_partsupp#6018 AS cfpk_lineitem_partsupp_1#6051, cpfk_part_lineitem#6019 AS cpfk_part_lineitem_1#6052, cfpk_lineitem_part#6020 AS cfpk_lineitem_part_1#6053, cpfk_partsupp_lineitem#6021 AS cpfk_partsupp_lineitem_1#6054, cfpk_lineitem_orders#6022 AS cfpk_lineitem_orders_1#6055, cval_lineitem_l_quantity#6023 AS cval_lineitem_l_quantity_1#6056, cval_lineitem_l_extendedprice#6024 AS cval_lineitem_l_extendedprice_1#6057, cval_lineitem_l_discount#6025 AS cval_lineitem_l_discount_1#6058, cval_lineitem_l_tax#6026 AS cval_lineitem_l_tax_1#6059, cval_lineitem_l_returnflag#6027 AS cval_lineitem_l_returnflag_1#6060, cval_lineitem_l_linestatus#6028 AS cval_lineitem_l_linestatus_1#6061, cval_lineitem_l_commitdate#6029 AS cval_lineitem_l_commitdate_1#6062, cval_lineitem_l_receiptdate#6030 AS cval_lineitem_l_receiptdate_1#6063, cval_lineitem_l_shipinstruct#6031 AS cval_lineitem_l_shipinstruct_1#6064, cval_lineitem_l_shipmode#6032 AS cval_lineitem_l_shipmode_1#6065, cval_lineitem_l_comment#6033 AS cval_lineitem_l_comment_1#6066, cval_lineitem_l_shipdate#6034 AS cval_lineitem_l_shipdate_1#6067, cl_quantity#6035 AS cl_quantity_1#6068, cl_extendedprice#6036 AS cl_extendedprice_1#6069, cl_discount#6037 AS cl_discount_1#6070, ... 9 more fields]
            :        +- Relation[rid#6014,cpfk_orders_lineitem#6015,cpfk_supplier_lineitem#6016,cfpk_lineitem_supplier#6017,cfpk_lineitem_partsupp#6018,cpfk_part_lineitem#6019,cfpk_lineitem_part#6020,cpfk_partsupp_lineitem#6021,cfpk_lineitem_orders#6022,cval_lineitem_l_quantity#6023,cval_lineitem_l_extendedprice#6024,cval_lineitem_l_discount#6025,cval_lineitem_l_tax#6026,cval_lineitem_l_returnflag#6027,cval_lineitem_l_linestatus#6028,cval_lineitem_l_commitdate#6029,cval_lineitem_l_receiptdate#6030,cval_lineitem_l_shipinstruct#6031,cval_lineitem_l_shipmode#6032,cval_lineitem_l_comment#6033,cval_lineitem_l_shipdate#6034,cl_quantity#6035,cl_extendedprice#6036,cl_discount#6037,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#6080 AS rid_1#6113, cpfk_orders_lineitem#6081 AS cpfk_orders_lineitem_1#6114, cpfk_supplier_lineitem#6082 AS cpfk_supplier_lineitem_1#6115, cfpk_lineitem_supplier#6083 AS cfpk_lineitem_supplier_1#6116, cfpk_lineitem_partsupp#6084 AS cfpk_lineitem_partsupp_1#6117, cpfk_part_lineitem#6085 AS cpfk_part_lineitem_1#6118, cfpk_lineitem_part#6086 AS cfpk_lineitem_part_1#6119, cpfk_partsupp_lineitem#6087 AS cpfk_partsupp_lineitem_1#6120, cfpk_lineitem_orders#6088 AS cfpk_lineitem_orders_1#6121, cval_lineitem_l_quantity#6089 AS cval_lineitem_l_quantity_1#6122, cval_lineitem_l_extendedprice#6090 AS cval_lineitem_l_extendedprice_1#6123, cval_lineitem_l_discount#6091 AS cval_lineitem_l_discount_1#6124, cval_lineitem_l_tax#6092 AS cval_lineitem_l_tax_1#6125, cval_lineitem_l_returnflag#6093 AS cval_lineitem_l_returnflag_1#6126, cval_lineitem_l_linestatus#6094 AS cval_lineitem_l_linestatus_1#6127, cval_lineitem_l_commitdate#6095 AS cval_lineitem_l_commitdate_1#6128, cval_lineitem_l_receiptdate#6096 AS cval_lineitem_l_receiptdate_1#6129, cval_lineitem_l_shipinstruct#6097 AS cval_lineitem_l_shipinstruct_1#6130, cval_lineitem_l_shipmode#6098 AS cval_lineitem_l_shipmode_1#6131, cval_lineitem_l_comment#6099 AS cval_lineitem_l_comment_1#6132, cval_lineitem_l_shipdate#6100 AS cval_lineitem_l_shipdate_1#6133, cl_quantity#6101 AS cl_quantity_1#6134, cl_extendedprice#6102 AS cl_extendedprice_1#6135, cl_discount#6103 AS cl_discount_1#6136, ... 9 more fields]
                  +- Relation[rid#6080,cpfk_orders_lineitem#6081,cpfk_supplier_lineitem#6082,cfpk_lineitem_supplier#6083,cfpk_lineitem_partsupp#6084,cpfk_part_lineitem#6085,cfpk_lineitem_part#6086,cpfk_partsupp_lineitem#6087,cfpk_lineitem_orders#6088,cval_lineitem_l_quantity#6089,cval_lineitem_l_extendedprice#6090,cval_lineitem_l_discount#6091,cval_lineitem_l_tax#6092,cval_lineitem_l_returnflag#6093,cval_lineitem_l_linestatus#6094,cval_lineitem_l_commitdate#6095,cval_lineitem_l_receiptdate#6096,cval_lineitem_l_shipinstruct#6097,cval_lineitem_l_shipmode#6098,cval_lineitem_l_comment#6099,cval_lineitem_l_shipdate#6100,cl_quantity#6101,cl_extendedprice#6102,cl_discount#6103,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 361897ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/11 03:45:31 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:45:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6301L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/11 03:45:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:45:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:45:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:45:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:45:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:45:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:45:31 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:45:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:45:31 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:45:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:45:31 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:45:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:45:31 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:45:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6301L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#6303 AS rid_0#6320, cval_part_p_name#6304 AS cval_part_p_name_0#6321, cval_part_p_mfgr#6305 AS cval_part_p_mfgr_0#6322, cval_part_p_type#6306 AS cval_part_p_type_0#6323, cval_part_p_size#6307 AS cval_part_p_size_0#6324, cval_part_p_container#6308 AS cval_part_p_container_0#6325, cval_part_p_retailprice#6309 AS cval_part_p_retailprice_0#6326, cval_part_p_comment#6310 AS cval_part_p_comment_0#6327, cval_part_p_brand#6311 AS cval_part_p_brand_0#6328, cp_name#6312 AS cp_name_0#6329, cp_mfgr#6313 AS cp_mfgr_0#6330, cp_type#6314 AS cp_type_0#6331, cp_size#6315 AS cp_size_0#6332, cp_container#6316 AS cp_container_0#6333, cp_retailprice#6317 AS cp_retailprice_0#6334, cp_comment#6318 AS cp_comment_0#6335, cp_brand#6319 AS cp_brand_0#6336]
            :  :  :  :  +- Relation[rid#6303,cval_part_p_name#6304,cval_part_p_mfgr#6305,cval_part_p_type#6306,cval_part_p_size#6307,cval_part_p_container#6308,cval_part_p_retailprice#6309,cval_part_p_comment#6310,cval_part_p_brand#6311,cp_name#6312,cp_mfgr#6313,cp_type#6314,cp_size#6315,cp_container#6316,cp_retailprice#6317,cp_comment#6318,cp_brand#6319] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#6337 AS rid_0#6354, cval_part_p_name#6338 AS cval_part_p_name_0#6355, cval_part_p_mfgr#6339 AS cval_part_p_mfgr_0#6356, cval_part_p_type#6340 AS cval_part_p_type_0#6357, cval_part_p_size#6341 AS cval_part_p_size_0#6358, cval_part_p_container#6342 AS cval_part_p_container_0#6359, cval_part_p_retailprice#6343 AS cval_part_p_retailprice_0#6360, cval_part_p_comment#6344 AS cval_part_p_comment_0#6361, cval_part_p_brand#6345 AS cval_part_p_brand_0#6362, cp_name#6346 AS cp_name_0#6363, cp_mfgr#6347 AS cp_mfgr_0#6364, cp_type#6348 AS cp_type_0#6365, cp_size#6349 AS cp_size_0#6366, cp_container#6350 AS cp_container_0#6367, cp_retailprice#6351 AS cp_retailprice_0#6368, cp_comment#6352 AS cp_comment_0#6369, cp_brand#6353 AS cp_brand_0#6370]
            :  :  :        +- Relation[rid#6337,cval_part_p_name#6338,cval_part_p_mfgr#6339,cval_part_p_type#6340,cval_part_p_size#6341,cval_part_p_container#6342,cval_part_p_retailprice#6343,cval_part_p_comment#6344,cval_part_p_brand#6345,cp_name#6346,cp_mfgr#6347,cp_type#6348,cp_size#6349,cp_container#6350,cp_retailprice#6351,cp_comment#6352,cp_brand#6353] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :     :- Project [rid#6393 AS rid_0#6410, cval_part_p_name#6394 AS cval_part_p_name_0#6411, cval_part_p_mfgr#6395 AS cval_part_p_mfgr_0#6412, cval_part_p_type#6396 AS cval_part_p_type_0#6413, cval_part_p_size#6397 AS cval_part_p_size_0#6414, cval_part_p_container#6398 AS cval_part_p_container_0#6415, cval_part_p_retailprice#6399 AS cval_part_p_retailprice_0#6416, cval_part_p_comment#6400 AS cval_part_p_comment_0#6417, cval_part_p_brand#6401 AS cval_part_p_brand_0#6418, cp_name#6402 AS cp_name_0#6419, cp_mfgr#6403 AS cp_mfgr_0#6420, cp_type#6404 AS cp_type_0#6421, cp_size#6405 AS cp_size_0#6422, cp_container#6406 AS cp_container_0#6423, cp_retailprice#6407 AS cp_retailprice_0#6424, cp_comment#6408 AS cp_comment_0#6425, cp_brand#6409 AS cp_brand_0#6426]
            :  :     :  +- Relation[rid#6393,cval_part_p_name#6394,cval_part_p_mfgr#6395,cval_part_p_type#6396,cval_part_p_size#6397,cval_part_p_container#6398,cval_part_p_retailprice#6399,cval_part_p_comment#6400,cval_part_p_brand#6401,cp_name#6402,cp_mfgr#6403,cp_type#6404,cp_size#6405,cp_container#6406,cp_retailprice#6407,cp_comment#6408,cp_brand#6409] JDBCRelation(tpart) [numPartitions=1]
            :  :     +- Project [rid#6427 AS rid_1#6438, cpfk_part_partsupp#6428 AS cpfk_part_partsupp_1#6439, cfpk_partsupp_part#6429 AS cfpk_partsupp_part_1#6440, cpfk_supplier_partsupp#6430 AS cpfk_supplier_partsupp_1#6441, cfpk_partsupp_supplier#6431 AS cfpk_partsupp_supplier_1#6442, cval_partsupp_ps_availqty#6432 AS cval_partsupp_ps_availqty_1#6443, cval_partsupp_ps_supplycost#6433 AS cval_partsupp_ps_supplycost_1#6444, cval_partsupp_ps_comment#6434 AS cval_partsupp_ps_comment_1#6445, cps_availqty#6435 AS cps_availqty_1#6446, cps_supplycost#6436 AS cps_supplycost_1#6447, cps_comment#6437 AS cps_comment_1#6448]
            :  :        +- Relation[rid#6427,cpfk_part_partsupp#6428,cfpk_partsupp_part#6429,cpfk_supplier_partsupp#6430,cfpk_partsupp_supplier#6431,cval_partsupp_ps_availqty#6432,cval_partsupp_ps_supplycost#6433,cval_partsupp_ps_comment#6434,cps_availqty#6435,cps_supplycost#6436,cps_comment#6437] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#6371 AS rid_1#6382, cpfk_part_partsupp#6372 AS cpfk_part_partsupp_1#6383, cfpk_partsupp_part#6373 AS cfpk_partsupp_part_1#6384, cpfk_supplier_partsupp#6374 AS cpfk_supplier_partsupp_1#6385, cfpk_partsupp_supplier#6375 AS cfpk_partsupp_supplier_1#6386, cval_partsupp_ps_availqty#6376 AS cval_partsupp_ps_availqty_1#6387, cval_partsupp_ps_supplycost#6377 AS cval_partsupp_ps_supplycost_1#6388, cval_partsupp_ps_comment#6378 AS cval_partsupp_ps_comment_1#6389, cps_availqty#6379 AS cps_availqty_1#6390, cps_supplycost#6380 AS cps_supplycost_1#6391, cps_comment#6381 AS cps_comment_1#6392]
            :     +- Relation[rid#6371,cpfk_part_partsupp#6372,cfpk_partsupp_part#6373,cpfk_supplier_partsupp#6374,cfpk_partsupp_supplier#6375,cval_partsupp_ps_availqty#6376,cval_partsupp_ps_supplycost#6377,cval_partsupp_ps_comment#6378,cps_availqty#6379,cps_supplycost#6380,cps_comment#6381] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#6449 AS rid_2#6456, cpfk_region_nation#6450 AS cpfk_region_nation_2#6457, cfpk_nation_region#6451 AS cfpk_nation_region_2#6458, cval_nation_n_name#6452 AS cval_nation_n_name_2#6459, cval_nation_n_comment#6453 AS cval_nation_n_comment_2#6460, cn_name#6454 AS cn_name_2#6461, cn_comment#6455 AS cn_comment_2#6462]
               :  :  :  +- Relation[rid#6449,cpfk_region_nation#6450,cfpk_nation_region#6451,cval_nation_n_name#6452,cval_nation_n_comment#6453,cn_name#6454,cn_comment#6455] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#6463 AS rid_2#6470, cpfk_region_nation#6464 AS cpfk_region_nation_2#6471, cfpk_nation_region#6465 AS cfpk_nation_region_2#6472, cval_nation_n_name#6466 AS cval_nation_n_name_2#6473, cval_nation_n_comment#6467 AS cval_nation_n_comment_2#6474, cn_name#6468 AS cn_name_2#6475, cn_comment#6469 AS cn_comment_2#6476]
               :  :        +- Relation[rid#6463,cpfk_region_nation#6464,cfpk_nation_region#6465,cval_nation_n_name#6466,cval_nation_n_comment#6467,cn_name#6468,cn_comment#6469] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :     :- Project [rid#6503 AS rid_2#6510, cpfk_region_nation#6504 AS cpfk_region_nation_2#6511, cfpk_nation_region#6505 AS cfpk_nation_region_2#6512, cval_nation_n_name#6506 AS cval_nation_n_name_2#6513, cval_nation_n_comment#6507 AS cval_nation_n_comment_2#6514, cn_name#6508 AS cn_name_2#6515, cn_comment#6509 AS cn_comment_2#6516]
               :     :  +- Relation[rid#6503,cpfk_region_nation#6504,cfpk_nation_region#6505,cval_nation_n_name#6506,cval_nation_n_comment#6507,cn_name#6508,cn_comment#6509] JDBCRelation(tnation) [numPartitions=1]
               :     +- Project [rid#6517 AS rid_3#6530, cpfk_nation_supplier#6518 AS cpfk_nation_supplier_3#6531, cfpk_supplier_nation#6519 AS cfpk_supplier_nation_3#6532, cval_supplier_s_name#6520 AS cval_supplier_s_name_3#6533, cval_supplier_s_address#6521 AS cval_supplier_s_address_3#6534, cval_supplier_s_phone#6522 AS cval_supplier_s_phone_3#6535, cval_supplier_s_acctbal#6523 AS cval_supplier_s_acctbal_3#6536, cval_supplier_s_comment#6524 AS cval_supplier_s_comment_3#6537, cs_name#6525 AS cs_name_3#6538, cs_address#6526 AS cs_address_3#6539, cs_phone#6527 AS cs_phone_3#6540, cs_acctbal#6528 AS cs_acctbal_3#6541, cs_comment#6529 AS cs_comment_3#6542]
               :        +- Relation[rid#6517,cpfk_nation_supplier#6518,cfpk_supplier_nation#6519,cval_supplier_s_name#6520,cval_supplier_s_address#6521,cval_supplier_s_phone#6522,cval_supplier_s_acctbal#6523,cval_supplier_s_comment#6524,cs_name#6525,cs_address#6526,cs_phone#6527,cs_acctbal#6528,cs_comment#6529] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#6477 AS rid_3#6490, cpfk_nation_supplier#6478 AS cpfk_nation_supplier_3#6491, cfpk_supplier_nation#6479 AS cfpk_supplier_nation_3#6492, cval_supplier_s_name#6480 AS cval_supplier_s_name_3#6493, cval_supplier_s_address#6481 AS cval_supplier_s_address_3#6494, cval_supplier_s_phone#6482 AS cval_supplier_s_phone_3#6495, cval_supplier_s_acctbal#6483 AS cval_supplier_s_acctbal_3#6496, cval_supplier_s_comment#6484 AS cval_supplier_s_comment_3#6497, cs_name#6485 AS cs_name_3#6498, cs_address#6486 AS cs_address_3#6499, cs_phone#6487 AS cs_phone_3#6500, cs_acctbal#6488 AS cs_acctbal_3#6501, cs_comment#6489 AS cs_comment_3#6502]
                  +- Relation[rid#6477,cpfk_nation_supplier#6478,cfpk_supplier_nation#6479,cval_supplier_s_name#6480,cval_supplier_s_address#6481,cval_supplier_s_phone#6482,cval_supplier_s_acctbal#6483,cval_supplier_s_comment#6484,cs_name#6485,cs_address#6486,cs_phone#6487,cs_acctbal#6488,cs_comment#6489] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 11463ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/11 03:45:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:45:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6595L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 03:45:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:45:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:45:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:45:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:45:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:45:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:45:43 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 03:45:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6595L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#6597 AS rid_0#6614, cval_part_p_name#6598 AS cval_part_p_name_0#6615, cval_part_p_mfgr#6599 AS cval_part_p_mfgr_0#6616, cval_part_p_type#6600 AS cval_part_p_type_0#6617, cval_part_p_size#6601 AS cval_part_p_size_0#6618, cval_part_p_container#6602 AS cval_part_p_container_0#6619, cval_part_p_retailprice#6603 AS cval_part_p_retailprice_0#6620, cval_part_p_comment#6604 AS cval_part_p_comment_0#6621, cval_part_p_brand#6605 AS cval_part_p_brand_0#6622, cp_name#6606 AS cp_name_0#6623, cp_mfgr#6607 AS cp_mfgr_0#6624, cp_type#6608 AS cp_type_0#6625, cp_size#6609 AS cp_size_0#6626, cp_container#6610 AS cp_container_0#6627, cp_retailprice#6611 AS cp_retailprice_0#6628, cp_comment#6612 AS cp_comment_0#6629, cp_brand#6613 AS cp_brand_0#6630]
         :  :  :  :  +- Relation[rid#6597,cval_part_p_name#6598,cval_part_p_mfgr#6599,cval_part_p_type#6600,cval_part_p_size#6601,cval_part_p_container#6602,cval_part_p_retailprice#6603,cval_part_p_comment#6604,cval_part_p_brand#6605,cp_name#6606,cp_mfgr#6607,cp_type#6608,cp_size#6609,cp_container#6610,cp_retailprice#6611,cp_comment#6612,cp_brand#6613] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#6631 AS rid_0#6648, cval_part_p_name#6632 AS cval_part_p_name_0#6649, cval_part_p_mfgr#6633 AS cval_part_p_mfgr_0#6650, cval_part_p_type#6634 AS cval_part_p_type_0#6651, cval_part_p_size#6635 AS cval_part_p_size_0#6652, cval_part_p_container#6636 AS cval_part_p_container_0#6653, cval_part_p_retailprice#6637 AS cval_part_p_retailprice_0#6654, cval_part_p_comment#6638 AS cval_part_p_comment_0#6655, cval_part_p_brand#6639 AS cval_part_p_brand_0#6656, cp_name#6640 AS cp_name_0#6657, cp_mfgr#6641 AS cp_mfgr_0#6658, cp_type#6642 AS cp_type_0#6659, cp_size#6643 AS cp_size_0#6660, cp_container#6644 AS cp_container_0#6661, cp_retailprice#6645 AS cp_retailprice_0#6662, cp_comment#6646 AS cp_comment_0#6663, cp_brand#6647 AS cp_brand_0#6664]
         :  :  :        +- Relation[rid#6631,cval_part_p_name#6632,cval_part_p_mfgr#6633,cval_part_p_type#6634,cval_part_p_size#6635,cval_part_p_container#6636,cval_part_p_retailprice#6637,cval_part_p_comment#6638,cval_part_p_brand#6639,cp_name#6640,cp_mfgr#6641,cp_type#6642,cp_size#6643,cp_container#6644,cp_retailprice#6645,cp_comment#6646,cp_brand#6647] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#6665 AS rid_0#6682, cval_part_p_name#6666 AS cval_part_p_name_0#6683, cval_part_p_mfgr#6667 AS cval_part_p_mfgr_0#6684, cval_part_p_type#6668 AS cval_part_p_type_0#6685, cval_part_p_size#6669 AS cval_part_p_size_0#6686, cval_part_p_container#6670 AS cval_part_p_container_0#6687, cval_part_p_retailprice#6671 AS cval_part_p_retailprice_0#6688, cval_part_p_comment#6672 AS cval_part_p_comment_0#6689, cval_part_p_brand#6673 AS cval_part_p_brand_0#6690, cp_name#6674 AS cp_name_0#6691, cp_mfgr#6675 AS cp_mfgr_0#6692, cp_type#6676 AS cp_type_0#6693, cp_size#6677 AS cp_size_0#6694, cp_container#6678 AS cp_container_0#6695, cp_retailprice#6679 AS cp_retailprice_0#6696, cp_comment#6680 AS cp_comment_0#6697, cp_brand#6681 AS cp_brand_0#6698]
         :  :        +- Relation[rid#6665,cval_part_p_name#6666,cval_part_p_mfgr#6667,cval_part_p_type#6668,cval_part_p_size#6669,cval_part_p_container#6670,cval_part_p_retailprice#6671,cval_part_p_comment#6672,cval_part_p_brand#6673,cp_name#6674,cp_mfgr#6675,cp_type#6676,cp_size#6677,cp_container#6678,cp_retailprice#6679,cp_comment#6680,cp_brand#6681] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#6765 AS rid_0#6782, cval_part_p_name#6766 AS cval_part_p_name_0#6783, cval_part_p_mfgr#6767 AS cval_part_p_mfgr_0#6784, cval_part_p_type#6768 AS cval_part_p_type_0#6785, cval_part_p_size#6769 AS cval_part_p_size_0#6786, cval_part_p_container#6770 AS cval_part_p_container_0#6787, cval_part_p_retailprice#6771 AS cval_part_p_retailprice_0#6788, cval_part_p_comment#6772 AS cval_part_p_comment_0#6789, cval_part_p_brand#6773 AS cval_part_p_brand_0#6790, cp_name#6774 AS cp_name_0#6791, cp_mfgr#6775 AS cp_mfgr_0#6792, cp_type#6776 AS cp_type_0#6793, cp_size#6777 AS cp_size_0#6794, cp_container#6778 AS cp_container_0#6795, cp_retailprice#6779 AS cp_retailprice_0#6796, cp_comment#6780 AS cp_comment_0#6797, cp_brand#6781 AS cp_brand_0#6798]
         :     :  +- Relation[rid#6765,cval_part_p_name#6766,cval_part_p_mfgr#6767,cval_part_p_type#6768,cval_part_p_size#6769,cval_part_p_container#6770,cval_part_p_retailprice#6771,cval_part_p_comment#6772,cval_part_p_brand#6773,cp_name#6774,cp_mfgr#6775,cp_type#6776,cp_size#6777,cp_container#6778,cp_retailprice#6779,cp_comment#6780,cp_brand#6781] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#6799 AS rid_1#6832, cpfk_orders_lineitem#6800 AS cpfk_orders_lineitem_1#6833, cpfk_supplier_lineitem#6801 AS cpfk_supplier_lineitem_1#6834, cfpk_lineitem_supplier#6802 AS cfpk_lineitem_supplier_1#6835, cfpk_lineitem_partsupp#6803 AS cfpk_lineitem_partsupp_1#6836, cpfk_part_lineitem#6804 AS cpfk_part_lineitem_1#6837, cfpk_lineitem_part#6805 AS cfpk_lineitem_part_1#6838, cpfk_partsupp_lineitem#6806 AS cpfk_partsupp_lineitem_1#6839, cfpk_lineitem_orders#6807 AS cfpk_lineitem_orders_1#6840, cval_lineitem_l_quantity#6808 AS cval_lineitem_l_quantity_1#6841, cval_lineitem_l_extendedprice#6809 AS cval_lineitem_l_extendedprice_1#6842, cval_lineitem_l_discount#6810 AS cval_lineitem_l_discount_1#6843, cval_lineitem_l_tax#6811 AS cval_lineitem_l_tax_1#6844, cval_lineitem_l_returnflag#6812 AS cval_lineitem_l_returnflag_1#6845, cval_lineitem_l_linestatus#6813 AS cval_lineitem_l_linestatus_1#6846, cval_lineitem_l_commitdate#6814 AS cval_lineitem_l_commitdate_1#6847, cval_lineitem_l_receiptdate#6815 AS cval_lineitem_l_receiptdate_1#6848, cval_lineitem_l_shipinstruct#6816 AS cval_lineitem_l_shipinstruct_1#6849, cval_lineitem_l_shipmode#6817 AS cval_lineitem_l_shipmode_1#6850, cval_lineitem_l_comment#6818 AS cval_lineitem_l_comment_1#6851, cval_lineitem_l_shipdate#6819 AS cval_lineitem_l_shipdate_1#6852, cl_quantity#6820 AS cl_quantity_1#6853, cl_extendedprice#6821 AS cl_extendedprice_1#6854, cl_discount#6822 AS cl_discount_1#6855, ... 9 more fields]
         :        +- Relation[rid#6799,cpfk_orders_lineitem#6800,cpfk_supplier_lineitem#6801,cfpk_lineitem_supplier#6802,cfpk_lineitem_partsupp#6803,cpfk_part_lineitem#6804,cfpk_lineitem_part#6805,cpfk_partsupp_lineitem#6806,cfpk_lineitem_orders#6807,cval_lineitem_l_quantity#6808,cval_lineitem_l_extendedprice#6809,cval_lineitem_l_discount#6810,cval_lineitem_l_tax#6811,cval_lineitem_l_returnflag#6812,cval_lineitem_l_linestatus#6813,cval_lineitem_l_commitdate#6814,cval_lineitem_l_receiptdate#6815,cval_lineitem_l_shipinstruct#6816,cval_lineitem_l_shipmode#6817,cval_lineitem_l_comment#6818,cval_lineitem_l_shipdate#6819,cl_quantity#6820,cl_extendedprice#6821,cl_discount#6822,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6699 AS rid_1#6732, cpfk_orders_lineitem#6700 AS cpfk_orders_lineitem_1#6733, cpfk_supplier_lineitem#6701 AS cpfk_supplier_lineitem_1#6734, cfpk_lineitem_supplier#6702 AS cfpk_lineitem_supplier_1#6735, cfpk_lineitem_partsupp#6703 AS cfpk_lineitem_partsupp_1#6736, cpfk_part_lineitem#6704 AS cpfk_part_lineitem_1#6737, cfpk_lineitem_part#6705 AS cfpk_lineitem_part_1#6738, cpfk_partsupp_lineitem#6706 AS cpfk_partsupp_lineitem_1#6739, cfpk_lineitem_orders#6707 AS cfpk_lineitem_orders_1#6740, cval_lineitem_l_quantity#6708 AS cval_lineitem_l_quantity_1#6741, cval_lineitem_l_extendedprice#6709 AS cval_lineitem_l_extendedprice_1#6742, cval_lineitem_l_discount#6710 AS cval_lineitem_l_discount_1#6743, cval_lineitem_l_tax#6711 AS cval_lineitem_l_tax_1#6744, cval_lineitem_l_returnflag#6712 AS cval_lineitem_l_returnflag_1#6745, cval_lineitem_l_linestatus#6713 AS cval_lineitem_l_linestatus_1#6746, cval_lineitem_l_commitdate#6714 AS cval_lineitem_l_commitdate_1#6747, cval_lineitem_l_receiptdate#6715 AS cval_lineitem_l_receiptdate_1#6748, cval_lineitem_l_shipinstruct#6716 AS cval_lineitem_l_shipinstruct_1#6749, cval_lineitem_l_shipmode#6717 AS cval_lineitem_l_shipmode_1#6750, cval_lineitem_l_comment#6718 AS cval_lineitem_l_comment_1#6751, cval_lineitem_l_shipdate#6719 AS cval_lineitem_l_shipdate_1#6752, cl_quantity#6720 AS cl_quantity_1#6753, cl_extendedprice#6721 AS cl_extendedprice_1#6754, cl_discount#6722 AS cl_discount_1#6755, ... 9 more fields]
            +- Relation[rid#6699,cpfk_orders_lineitem#6700,cpfk_supplier_lineitem#6701,cfpk_lineitem_supplier#6702,cfpk_lineitem_partsupp#6703,cpfk_part_lineitem#6704,cfpk_lineitem_part#6705,cpfk_partsupp_lineitem#6706,cfpk_lineitem_orders#6707,cval_lineitem_l_quantity#6708,cval_lineitem_l_extendedprice#6709,cval_lineitem_l_discount#6710,cval_lineitem_l_tax#6711,cval_lineitem_l_returnflag#6712,cval_lineitem_l_linestatus#6713,cval_lineitem_l_commitdate#6714,cval_lineitem_l_receiptdate#6715,cval_lineitem_l_shipinstruct#6716,cval_lineitem_l_shipmode#6717,cval_lineitem_l_comment#6718,cval_lineitem_l_shipdate#6719,cl_quantity#6720,cl_extendedprice#6721,cl_discount#6722,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 71282ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/11 03:46:54 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:46:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6919L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 03:46:54 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:46:54 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:46:54 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:46:54 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:46:54 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:46:54 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:46:54 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:46:54 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:46:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:46:54 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:46:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:46:54 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:46:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:46:54 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:46:54 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:46:54 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:46:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:46:54 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:46:54 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:46:54 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:46:54 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6919L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#6921 AS rid_0#6926, cval_region_r_name#6922 AS cval_region_r_name_0#6927, cval_region_r_comment#6923 AS cval_region_r_comment_0#6928, cr_name#6924 AS cr_name_0#6929, cr_comment#6925 AS cr_comment_0#6930]
         :  :  :  :  :  :  :  +- Relation[rid#6921,cval_region_r_name#6922,cval_region_r_comment#6923,cr_name#6924,cr_comment#6925] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#6931 AS rid_0#6936, cval_region_r_name#6932 AS cval_region_r_name_0#6937, cval_region_r_comment#6933 AS cval_region_r_comment_0#6938, cr_name#6934 AS cr_name_0#6939, cr_comment#6935 AS cr_comment_0#6940]
         :  :  :  :  :  :        +- Relation[rid#6931,cval_region_r_name#6932,cval_region_r_comment#6933,cr_name#6934,cr_comment#6935] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :     :- Project [rid#6955 AS rid_0#6960, cval_region_r_name#6956 AS cval_region_r_name_0#6961, cval_region_r_comment#6957 AS cval_region_r_comment_0#6962, cr_name#6958 AS cr_name_0#6963, cr_comment#6959 AS cr_comment_0#6964]
         :  :  :  :  :     :  +- Relation[rid#6955,cval_region_r_name#6956,cval_region_r_comment#6957,cr_name#6958,cr_comment#6959] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :     +- Project [rid#6965 AS rid_1#6972, cpfk_region_nation#6966 AS cpfk_region_nation_1#6973, cfpk_nation_region#6967 AS cfpk_nation_region_1#6974, cval_nation_n_name#6968 AS cval_nation_n_name_1#6975, cval_nation_n_comment#6969 AS cval_nation_n_comment_1#6976, cn_name#6970 AS cn_name_1#6977, cn_comment#6971 AS cn_comment_1#6978]
         :  :  :  :  :        +- Relation[rid#6965,cpfk_region_nation#6966,cfpk_nation_region#6967,cval_nation_n_name#6968,cval_nation_n_comment#6969,cn_name#6970,cn_comment#6971] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#6941 AS rid_1#6948, cpfk_region_nation#6942 AS cpfk_region_nation_1#6949, cfpk_nation_region#6943 AS cfpk_nation_region_1#6950, cval_nation_n_name#6944 AS cval_nation_n_name_1#6951, cval_nation_n_comment#6945 AS cval_nation_n_comment_1#6952, cn_name#6946 AS cn_name_1#6953, cn_comment#6947 AS cn_comment_1#6954]
         :  :  :  :     +- Relation[rid#6941,cpfk_region_nation#6942,cfpk_nation_region#6943,cval_nation_n_name#6944,cval_nation_n_comment#6945,cn_name#6946,cn_comment#6947] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :     :- Project [rid#7005 AS rid_1#7012, cpfk_region_nation#7006 AS cpfk_region_nation_1#7013, cfpk_nation_region#7007 AS cfpk_nation_region_1#7014, cval_nation_n_name#7008 AS cval_nation_n_name_1#7015, cval_nation_n_comment#7009 AS cval_nation_n_comment_1#7016, cn_name#7010 AS cn_name_1#7017, cn_comment#7011 AS cn_comment_1#7018]
         :  :  :     :  +- Relation[rid#7005,cpfk_region_nation#7006,cfpk_nation_region#7007,cval_nation_n_name#7008,cval_nation_n_comment#7009,cn_name#7010,cn_comment#7011] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#7019 AS rid_2#7032, cpfk_nation_supplier#7020 AS cpfk_nation_supplier_2#7033, cfpk_supplier_nation#7021 AS cfpk_supplier_nation_2#7034, cval_supplier_s_name#7022 AS cval_supplier_s_name_2#7035, cval_supplier_s_address#7023 AS cval_supplier_s_address_2#7036, cval_supplier_s_phone#7024 AS cval_supplier_s_phone_2#7037, cval_supplier_s_acctbal#7025 AS cval_supplier_s_acctbal_2#7038, cval_supplier_s_comment#7026 AS cval_supplier_s_comment_2#7039, cs_name#7027 AS cs_name_2#7040, cs_address#7028 AS cs_address_2#7041, cs_phone#7029 AS cs_phone_2#7042, cs_acctbal#7030 AS cs_acctbal_2#7043, cs_comment#7031 AS cs_comment_2#7044]
         :  :  :        +- Relation[rid#7019,cpfk_nation_supplier#7020,cfpk_supplier_nation#7021,cval_supplier_s_name#7022,cval_supplier_s_address#7023,cval_supplier_s_phone#7024,cval_supplier_s_acctbal#7025,cval_supplier_s_comment#7026,cs_name#7027,cs_address#7028,cs_phone#7029,cs_acctbal#7030,cs_comment#7031] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#6979 AS rid_2#6992, cpfk_nation_supplier#6980 AS cpfk_nation_supplier_2#6993, cfpk_supplier_nation#6981 AS cfpk_supplier_nation_2#6994, cval_supplier_s_name#6982 AS cval_supplier_s_name_2#6995, cval_supplier_s_address#6983 AS cval_supplier_s_address_2#6996, cval_supplier_s_phone#6984 AS cval_supplier_s_phone_2#6997, cval_supplier_s_acctbal#6985 AS cval_supplier_s_acctbal_2#6998, cval_supplier_s_comment#6986 AS cval_supplier_s_comment_2#6999, cs_name#6987 AS cs_name_2#7000, cs_address#6988 AS cs_address_2#7001, cs_phone#6989 AS cs_phone_2#7002, cs_acctbal#6990 AS cs_acctbal_2#7003, cs_comment#6991 AS cs_comment_2#7004]
         :  :     +- Relation[rid#6979,cpfk_nation_supplier#6980,cfpk_supplier_nation#6981,cval_supplier_s_name#6982,cval_supplier_s_address#6983,cval_supplier_s_phone#6984,cval_supplier_s_acctbal#6985,cval_supplier_s_comment#6986,cs_name#6987,cs_address#6988,cs_phone#6989,cs_acctbal#6990,cs_comment#6991] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :     :- Project [rid#7191 AS rid_2#7204, cpfk_nation_supplier#7192 AS cpfk_nation_supplier_2#7205, cfpk_supplier_nation#7193 AS cfpk_supplier_nation_2#7206, cval_supplier_s_name#7194 AS cval_supplier_s_name_2#7207, cval_supplier_s_address#7195 AS cval_supplier_s_address_2#7208, cval_supplier_s_phone#7196 AS cval_supplier_s_phone_2#7209, cval_supplier_s_acctbal#7197 AS cval_supplier_s_acctbal_2#7210, cval_supplier_s_comment#7198 AS cval_supplier_s_comment_2#7211, cs_name#7199 AS cs_name_2#7212, cs_address#7200 AS cs_address_2#7213, cs_phone#7201 AS cs_phone_2#7214, cs_acctbal#7202 AS cs_acctbal_2#7215, cs_comment#7203 AS cs_comment_2#7216]
         :     :  +- Relation[rid#7191,cpfk_nation_supplier#7192,cfpk_supplier_nation#7193,cval_supplier_s_name#7194,cval_supplier_s_address#7195,cval_supplier_s_phone#7196,cval_supplier_s_acctbal#7197,cval_supplier_s_comment#7198,cs_name#7199,cs_address#7200,cs_phone#7201,cs_acctbal#7202,cs_comment#7203] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#7217 AS rid_4#7228, cpfk_part_partsupp#7218 AS cpfk_part_partsupp_4#7229, cfpk_partsupp_part#7219 AS cfpk_partsupp_part_4#7230, cpfk_supplier_partsupp#7220 AS cpfk_supplier_partsupp_4#7231, cfpk_partsupp_supplier#7221 AS cfpk_partsupp_supplier_4#7232, cval_partsupp_ps_availqty#7222 AS cval_partsupp_ps_availqty_4#7233, cval_partsupp_ps_supplycost#7223 AS cval_partsupp_ps_supplycost_4#7234, cval_partsupp_ps_comment#7224 AS cval_partsupp_ps_comment_4#7235, cps_availqty#7225 AS cps_availqty_4#7236, cps_supplycost#7226 AS cps_supplycost_4#7237, cps_comment#7227 AS cps_comment_4#7238]
         :        +- Relation[rid#7217,cpfk_part_partsupp#7218,cfpk_partsupp_part#7219,cpfk_supplier_partsupp#7220,cfpk_partsupp_supplier#7221,cval_partsupp_ps_availqty#7222,cval_partsupp_ps_supplycost#7223,cval_partsupp_ps_comment#7224,cps_availqty#7225,cps_supplycost#7226,cps_comment#7227] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'Join UsingJoin(Inner,List(rid_3))
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#7045 AS rid_3#7062, cval_part_p_name#7046 AS cval_part_p_name_3#7063, cval_part_p_mfgr#7047 AS cval_part_p_mfgr_3#7064, cval_part_p_type#7048 AS cval_part_p_type_3#7065, cval_part_p_size#7049 AS cval_part_p_size_3#7066, cval_part_p_container#7050 AS cval_part_p_container_3#7067, cval_part_p_retailprice#7051 AS cval_part_p_retailprice_3#7068, cval_part_p_comment#7052 AS cval_part_p_comment_3#7069, cval_part_p_brand#7053 AS cval_part_p_brand_3#7070, cp_name#7054 AS cp_name_3#7071, cp_mfgr#7055 AS cp_mfgr_3#7072, cp_type#7056 AS cp_type_3#7073, cp_size#7057 AS cp_size_3#7074, cp_container#7058 AS cp_container_3#7075, cp_retailprice#7059 AS cp_retailprice_3#7076, cp_comment#7060 AS cp_comment_3#7077, cp_brand#7061 AS cp_brand_3#7078]
            :  :  :  +- Relation[rid#7045,cval_part_p_name#7046,cval_part_p_mfgr#7047,cval_part_p_type#7048,cval_part_p_size#7049,cval_part_p_container#7050,cval_part_p_retailprice#7051,cval_part_p_comment#7052,cval_part_p_brand#7053,cp_name#7054,cp_mfgr#7055,cp_type#7056,cp_size#7057,cp_container#7058,cp_retailprice#7059,cp_comment#7060,cp_brand#7061] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#7079 AS rid_3#7096, cval_part_p_name#7080 AS cval_part_p_name_3#7097, cval_part_p_mfgr#7081 AS cval_part_p_mfgr_3#7098, cval_part_p_type#7082 AS cval_part_p_type_3#7099, cval_part_p_size#7083 AS cval_part_p_size_3#7100, cval_part_p_container#7084 AS cval_part_p_container_3#7101, cval_part_p_retailprice#7085 AS cval_part_p_retailprice_3#7102, cval_part_p_comment#7086 AS cval_part_p_comment_3#7103, cval_part_p_brand#7087 AS cval_part_p_brand_3#7104, cp_name#7088 AS cp_name_3#7105, cp_mfgr#7089 AS cp_mfgr_3#7106, cp_type#7090 AS cp_type_3#7107, cp_size#7091 AS cp_size_3#7108, cp_container#7092 AS cp_container_3#7109, cp_retailprice#7093 AS cp_retailprice_3#7110, cp_comment#7094 AS cp_comment_3#7111, cp_brand#7095 AS cp_brand_3#7112]
            :  :        +- Relation[rid#7079,cval_part_p_name#7080,cval_part_p_mfgr#7081,cval_part_p_type#7082,cval_part_p_size#7083,cval_part_p_container#7084,cval_part_p_retailprice#7085,cval_part_p_comment#7086,cval_part_p_brand#7087,cp_name#7088,cp_mfgr#7089,cp_type#7090,cp_size#7091,cp_container#7092,cp_retailprice#7093,cp_comment#7094,cp_brand#7095] JDBCRelation(tpart) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :     :- Project [rid#7135 AS rid_3#7152, cval_part_p_name#7136 AS cval_part_p_name_3#7153, cval_part_p_mfgr#7137 AS cval_part_p_mfgr_3#7154, cval_part_p_type#7138 AS cval_part_p_type_3#7155, cval_part_p_size#7139 AS cval_part_p_size_3#7156, cval_part_p_container#7140 AS cval_part_p_container_3#7157, cval_part_p_retailprice#7141 AS cval_part_p_retailprice_3#7158, cval_part_p_comment#7142 AS cval_part_p_comment_3#7159, cval_part_p_brand#7143 AS cval_part_p_brand_3#7160, cp_name#7144 AS cp_name_3#7161, cp_mfgr#7145 AS cp_mfgr_3#7162, cp_type#7146 AS cp_type_3#7163, cp_size#7147 AS cp_size_3#7164, cp_container#7148 AS cp_container_3#7165, cp_retailprice#7149 AS cp_retailprice_3#7166, cp_comment#7150 AS cp_comment_3#7167, cp_brand#7151 AS cp_brand_3#7168]
            :     :  +- Relation[rid#7135,cval_part_p_name#7136,cval_part_p_mfgr#7137,cval_part_p_type#7138,cval_part_p_size#7139,cval_part_p_container#7140,cval_part_p_retailprice#7141,cval_part_p_comment#7142,cval_part_p_brand#7143,cp_name#7144,cp_mfgr#7145,cp_type#7146,cp_size#7147,cp_container#7148,cp_retailprice#7149,cp_comment#7150,cp_brand#7151] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#7169 AS rid_4#7180, cpfk_part_partsupp#7170 AS cpfk_part_partsupp_4#7181, cfpk_partsupp_part#7171 AS cfpk_partsupp_part_4#7182, cpfk_supplier_partsupp#7172 AS cpfk_supplier_partsupp_4#7183, cfpk_partsupp_supplier#7173 AS cfpk_partsupp_supplier_4#7184, cval_partsupp_ps_availqty#7174 AS cval_partsupp_ps_availqty_4#7185, cval_partsupp_ps_supplycost#7175 AS cval_partsupp_ps_supplycost_4#7186, cval_partsupp_ps_comment#7176 AS cval_partsupp_ps_comment_4#7187, cps_availqty#7177 AS cps_availqty_4#7188, cps_supplycost#7178 AS cps_supplycost_4#7189, cps_comment#7179 AS cps_comment_4#7190]
            :        +- Relation[rid#7169,cpfk_part_partsupp#7170,cfpk_partsupp_part#7171,cpfk_supplier_partsupp#7172,cfpk_partsupp_supplier#7173,cval_partsupp_ps_availqty#7174,cval_partsupp_ps_supplycost#7175,cval_partsupp_ps_comment#7176,cps_availqty#7177,cps_supplycost#7178,cps_comment#7179] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#7113 AS rid_4#7124, cpfk_part_partsupp#7114 AS cpfk_part_partsupp_4#7125, cfpk_partsupp_part#7115 AS cfpk_partsupp_part_4#7126, cpfk_supplier_partsupp#7116 AS cpfk_supplier_partsupp_4#7127, cfpk_partsupp_supplier#7117 AS cfpk_partsupp_supplier_4#7128, cval_partsupp_ps_availqty#7118 AS cval_partsupp_ps_availqty_4#7129, cval_partsupp_ps_supplycost#7119 AS cval_partsupp_ps_supplycost_4#7130, cval_partsupp_ps_comment#7120 AS cval_partsupp_ps_comment_4#7131, cps_availqty#7121 AS cps_availqty_4#7132, cps_supplycost#7122 AS cps_supplycost_4#7133, cps_comment#7123 AS cps_comment_4#7134]
               +- Relation[rid#7113,cpfk_part_partsupp#7114,cfpk_partsupp_part#7115,cpfk_supplier_partsupp#7116,cfpk_partsupp_supplier#7117,cval_partsupp_ps_availqty#7118,cval_partsupp_ps_supplycost#7119,cval_partsupp_ps_comment#7120,cps_availqty#7121,cps_supplycost#7122,cps_comment#7123] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 20286ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/11 03:47:14 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:47:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7296L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/11 03:47:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7296L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#7298 AS rid_0#7315, cpfk_customer_orders#7299 AS cpfk_customer_orders_0#7316, cfpk_orders_customer#7300 AS cfpk_orders_customer_0#7317, cval_orders_o_orderstatus#7301 AS cval_orders_o_orderstatus_0#7318, cval_orders_o_totalprice#7302 AS cval_orders_o_totalprice_0#7319, cval_orders_o_orderpriority#7303 AS cval_orders_o_orderpriority_0#7320, cval_orders_o_clerk#7304 AS cval_orders_o_clerk_0#7321, cval_orders_o_shippriority#7305 AS cval_orders_o_shippriority_0#7322, cval_orders_o_comment#7306 AS cval_orders_o_comment_0#7323, cval_orders_o_orderdate#7307 AS cval_orders_o_orderdate_0#7324, co_orderstatus#7308 AS co_orderstatus_0#7325, co_totalprice#7309 AS co_totalprice_0#7326, co_orderpriority#7310 AS co_orderpriority_0#7327, co_clerk#7311 AS co_clerk_0#7328, co_shippriority#7312 AS co_shippriority_0#7329, co_comment#7313 AS co_comment_0#7330, co_orderdate#7314 AS co_orderdate_0#7331]
            :  +- Relation[rid#7298,cpfk_customer_orders#7299,cfpk_orders_customer#7300,cval_orders_o_orderstatus#7301,cval_orders_o_totalprice#7302,cval_orders_o_orderpriority#7303,cval_orders_o_clerk#7304,cval_orders_o_shippriority#7305,cval_orders_o_comment#7306,cval_orders_o_orderdate#7307,co_orderstatus#7308,co_totalprice#7309,co_orderpriority#7310,co_clerk#7311,co_shippriority#7312,co_comment#7313,co_orderdate#7314] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#7332 AS rid_1#7347, cpfk_nation_customer#7333 AS cpfk_nation_customer_1#7348, cfpk_customer_nation#7334 AS cfpk_customer_nation_1#7349, cval_customer_c_name#7335 AS cval_customer_c_name_1#7350, cval_customer_c_address#7336 AS cval_customer_c_address_1#7351, cval_customer_c_phone#7337 AS cval_customer_c_phone_1#7352, cval_customer_c_acctbal#7338 AS cval_customer_c_acctbal_1#7353, cval_customer_c_comment#7339 AS cval_customer_c_comment_1#7354, cval_customer_c_mktsegment#7340 AS cval_customer_c_mktsegment_1#7355, cc_name#7341 AS cc_name_1#7356, cc_address#7342 AS cc_address_1#7357, cc_phone#7343 AS cc_phone_1#7358, cc_acctbal#7344 AS cc_acctbal_1#7359, cc_comment#7345 AS cc_comment_1#7360, cc_mktsegment#7346 AS cc_mktsegment_1#7361]
               +- Relation[rid#7332,cpfk_nation_customer#7333,cfpk_customer_nation#7334,cval_customer_c_name#7335,cval_customer_c_address#7336,cval_customer_c_phone#7337,cval_customer_c_acctbal#7338,cval_customer_c_comment#7339,cval_customer_c_mktsegment#7340,cc_name#7341,cc_address#7342,cc_phone#7343,cc_acctbal#7344,cc_comment#7345,cc_mktsegment#7346] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 13328ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/11 03:47:27 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:47:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7403L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 03:47:28 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7403L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#7405 AS rid_0#7420, cpfk_nation_customer#7406 AS cpfk_nation_customer_0#7421, cfpk_customer_nation#7407 AS cfpk_customer_nation_0#7422, cval_customer_c_name#7408 AS cval_customer_c_name_0#7423, cval_customer_c_address#7409 AS cval_customer_c_address_0#7424, cval_customer_c_phone#7410 AS cval_customer_c_phone_0#7425, cval_customer_c_acctbal#7411 AS cval_customer_c_acctbal_0#7426, cval_customer_c_comment#7412 AS cval_customer_c_comment_0#7427, cval_customer_c_mktsegment#7413 AS cval_customer_c_mktsegment_0#7428, cc_name#7414 AS cc_name_0#7429, cc_address#7415 AS cc_address_0#7430, cc_phone#7416 AS cc_phone_0#7431, cc_acctbal#7417 AS cc_acctbal_0#7432, cc_comment#7418 AS cc_comment_0#7433, cc_mktsegment#7419 AS cc_mktsegment_0#7434]
         :  :  :  :  +- Relation[rid#7405,cpfk_nation_customer#7406,cfpk_customer_nation#7407,cval_customer_c_name#7408,cval_customer_c_address#7409,cval_customer_c_phone#7410,cval_customer_c_acctbal#7411,cval_customer_c_comment#7412,cval_customer_c_mktsegment#7413,cc_name#7414,cc_address#7415,cc_phone#7416,cc_acctbal#7417,cc_comment#7418,cc_mktsegment#7419] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#7469 AS rid_0#7484, cpfk_nation_customer#7470 AS cpfk_nation_customer_0#7485, cfpk_customer_nation#7471 AS cfpk_customer_nation_0#7486, cval_customer_c_name#7472 AS cval_customer_c_name_0#7487, cval_customer_c_address#7473 AS cval_customer_c_address_0#7488, cval_customer_c_phone#7474 AS cval_customer_c_phone_0#7489, cval_customer_c_acctbal#7475 AS cval_customer_c_acctbal_0#7490, cval_customer_c_comment#7476 AS cval_customer_c_comment_0#7491, cval_customer_c_mktsegment#7477 AS cval_customer_c_mktsegment_0#7492, cc_name#7478 AS cc_name_0#7493, cc_address#7479 AS cc_address_0#7494, cc_phone#7480 AS cc_phone_0#7495, cc_acctbal#7481 AS cc_acctbal_0#7496, cc_comment#7482 AS cc_comment_0#7497, cc_mktsegment#7483 AS cc_mktsegment_0#7498]
         :  :  :     :  +- Relation[rid#7469,cpfk_nation_customer#7470,cfpk_customer_nation#7471,cval_customer_c_name#7472,cval_customer_c_address#7473,cval_customer_c_phone#7474,cval_customer_c_acctbal#7475,cval_customer_c_comment#7476,cval_customer_c_mktsegment#7477,cc_name#7478,cc_address#7479,cc_phone#7480,cc_acctbal#7481,cc_comment#7482,cc_mktsegment#7483] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#7499 AS rid_1#7516, cpfk_customer_orders#7500 AS cpfk_customer_orders_1#7517, cfpk_orders_customer#7501 AS cfpk_orders_customer_1#7518, cval_orders_o_orderstatus#7502 AS cval_orders_o_orderstatus_1#7519, cval_orders_o_totalprice#7503 AS cval_orders_o_totalprice_1#7520, cval_orders_o_orderpriority#7504 AS cval_orders_o_orderpriority_1#7521, cval_orders_o_clerk#7505 AS cval_orders_o_clerk_1#7522, cval_orders_o_shippriority#7506 AS cval_orders_o_shippriority_1#7523, cval_orders_o_comment#7507 AS cval_orders_o_comment_1#7524, cval_orders_o_orderdate#7508 AS cval_orders_o_orderdate_1#7525, co_orderstatus#7509 AS co_orderstatus_1#7526, co_totalprice#7510 AS co_totalprice_1#7527, co_orderpriority#7511 AS co_orderpriority_1#7528, co_clerk#7512 AS co_clerk_1#7529, co_shippriority#7513 AS co_shippriority_1#7530, co_comment#7514 AS co_comment_1#7531, co_orderdate#7515 AS co_orderdate_1#7532]
         :  :  :        +- Relation[rid#7499,cpfk_customer_orders#7500,cfpk_orders_customer#7501,cval_orders_o_orderstatus#7502,cval_orders_o_totalprice#7503,cval_orders_o_orderpriority#7504,cval_orders_o_clerk#7505,cval_orders_o_shippriority#7506,cval_orders_o_comment#7507,cval_orders_o_orderdate#7508,co_orderstatus#7509,co_totalprice#7510,co_orderpriority#7511,co_clerk#7512,co_shippriority#7513,co_comment#7514,co_orderdate#7515] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#7435 AS rid_1#7452, cpfk_customer_orders#7436 AS cpfk_customer_orders_1#7453, cfpk_orders_customer#7437 AS cfpk_orders_customer_1#7454, cval_orders_o_orderstatus#7438 AS cval_orders_o_orderstatus_1#7455, cval_orders_o_totalprice#7439 AS cval_orders_o_totalprice_1#7456, cval_orders_o_orderpriority#7440 AS cval_orders_o_orderpriority_1#7457, cval_orders_o_clerk#7441 AS cval_orders_o_clerk_1#7458, cval_orders_o_shippriority#7442 AS cval_orders_o_shippriority_1#7459, cval_orders_o_comment#7443 AS cval_orders_o_comment_1#7460, cval_orders_o_orderdate#7444 AS cval_orders_o_orderdate_1#7461, co_orderstatus#7445 AS co_orderstatus_1#7462, co_totalprice#7446 AS co_totalprice_1#7463, co_orderpriority#7447 AS co_orderpriority_1#7464, co_clerk#7448 AS co_clerk_1#7465, co_shippriority#7449 AS co_shippriority_1#7466, co_comment#7450 AS co_comment_1#7467, co_orderdate#7451 AS co_orderdate_1#7468]
         :  :     +- Relation[rid#7435,cpfk_customer_orders#7436,cfpk_orders_customer#7437,cval_orders_o_orderstatus#7438,cval_orders_o_totalprice#7439,cval_orders_o_orderpriority#7440,cval_orders_o_clerk#7441,cval_orders_o_shippriority#7442,cval_orders_o_comment#7443,cval_orders_o_orderdate#7444,co_orderstatus#7445,co_totalprice#7446,co_orderpriority#7447,co_clerk#7448,co_shippriority#7449,co_comment#7450,co_orderdate#7451] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#7599 AS rid_1#7616, cpfk_customer_orders#7600 AS cpfk_customer_orders_1#7617, cfpk_orders_customer#7601 AS cfpk_orders_customer_1#7618, cval_orders_o_orderstatus#7602 AS cval_orders_o_orderstatus_1#7619, cval_orders_o_totalprice#7603 AS cval_orders_o_totalprice_1#7620, cval_orders_o_orderpriority#7604 AS cval_orders_o_orderpriority_1#7621, cval_orders_o_clerk#7605 AS cval_orders_o_clerk_1#7622, cval_orders_o_shippriority#7606 AS cval_orders_o_shippriority_1#7623, cval_orders_o_comment#7607 AS cval_orders_o_comment_1#7624, cval_orders_o_orderdate#7608 AS cval_orders_o_orderdate_1#7625, co_orderstatus#7609 AS co_orderstatus_1#7626, co_totalprice#7610 AS co_totalprice_1#7627, co_orderpriority#7611 AS co_orderpriority_1#7628, co_clerk#7612 AS co_clerk_1#7629, co_shippriority#7613 AS co_shippriority_1#7630, co_comment#7614 AS co_comment_1#7631, co_orderdate#7615 AS co_orderdate_1#7632]
         :     :  +- Relation[rid#7599,cpfk_customer_orders#7600,cfpk_orders_customer#7601,cval_orders_o_orderstatus#7602,cval_orders_o_totalprice#7603,cval_orders_o_orderpriority#7604,cval_orders_o_clerk#7605,cval_orders_o_shippriority#7606,cval_orders_o_comment#7607,cval_orders_o_orderdate#7608,co_orderstatus#7609,co_totalprice#7610,co_orderpriority#7611,co_clerk#7612,co_shippriority#7613,co_comment#7614,co_orderdate#7615] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#7633 AS rid_2#7666, cpfk_orders_lineitem#7634 AS cpfk_orders_lineitem_2#7667, cpfk_supplier_lineitem#7635 AS cpfk_supplier_lineitem_2#7668, cfpk_lineitem_supplier#7636 AS cfpk_lineitem_supplier_2#7669, cfpk_lineitem_partsupp#7637 AS cfpk_lineitem_partsupp_2#7670, cpfk_part_lineitem#7638 AS cpfk_part_lineitem_2#7671, cfpk_lineitem_part#7639 AS cfpk_lineitem_part_2#7672, cpfk_partsupp_lineitem#7640 AS cpfk_partsupp_lineitem_2#7673, cfpk_lineitem_orders#7641 AS cfpk_lineitem_orders_2#7674, cval_lineitem_l_quantity#7642 AS cval_lineitem_l_quantity_2#7675, cval_lineitem_l_extendedprice#7643 AS cval_lineitem_l_extendedprice_2#7676, cval_lineitem_l_discount#7644 AS cval_lineitem_l_discount_2#7677, cval_lineitem_l_tax#7645 AS cval_lineitem_l_tax_2#7678, cval_lineitem_l_returnflag#7646 AS cval_lineitem_l_returnflag_2#7679, cval_lineitem_l_linestatus#7647 AS cval_lineitem_l_linestatus_2#7680, cval_lineitem_l_commitdate#7648 AS cval_lineitem_l_commitdate_2#7681, cval_lineitem_l_receiptdate#7649 AS cval_lineitem_l_receiptdate_2#7682, cval_lineitem_l_shipinstruct#7650 AS cval_lineitem_l_shipinstruct_2#7683, cval_lineitem_l_shipmode#7651 AS cval_lineitem_l_shipmode_2#7684, cval_lineitem_l_comment#7652 AS cval_lineitem_l_comment_2#7685, cval_lineitem_l_shipdate#7653 AS cval_lineitem_l_shipdate_2#7686, cl_quantity#7654 AS cl_quantity_2#7687, cl_extendedprice#7655 AS cl_extendedprice_2#7688, cl_discount#7656 AS cl_discount_2#7689, ... 9 more fields]
         :        +- Relation[rid#7633,cpfk_orders_lineitem#7634,cpfk_supplier_lineitem#7635,cfpk_lineitem_supplier#7636,cfpk_lineitem_partsupp#7637,cpfk_part_lineitem#7638,cfpk_lineitem_part#7639,cpfk_partsupp_lineitem#7640,cfpk_lineitem_orders#7641,cval_lineitem_l_quantity#7642,cval_lineitem_l_extendedprice#7643,cval_lineitem_l_discount#7644,cval_lineitem_l_tax#7645,cval_lineitem_l_returnflag#7646,cval_lineitem_l_linestatus#7647,cval_lineitem_l_commitdate#7648,cval_lineitem_l_receiptdate#7649,cval_lineitem_l_shipinstruct#7650,cval_lineitem_l_shipmode#7651,cval_lineitem_l_comment#7652,cval_lineitem_l_shipdate#7653,cl_quantity#7654,cl_extendedprice#7655,cl_discount#7656,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7533 AS rid_2#7566, cpfk_orders_lineitem#7534 AS cpfk_orders_lineitem_2#7567, cpfk_supplier_lineitem#7535 AS cpfk_supplier_lineitem_2#7568, cfpk_lineitem_supplier#7536 AS cfpk_lineitem_supplier_2#7569, cfpk_lineitem_partsupp#7537 AS cfpk_lineitem_partsupp_2#7570, cpfk_part_lineitem#7538 AS cpfk_part_lineitem_2#7571, cfpk_lineitem_part#7539 AS cfpk_lineitem_part_2#7572, cpfk_partsupp_lineitem#7540 AS cpfk_partsupp_lineitem_2#7573, cfpk_lineitem_orders#7541 AS cfpk_lineitem_orders_2#7574, cval_lineitem_l_quantity#7542 AS cval_lineitem_l_quantity_2#7575, cval_lineitem_l_extendedprice#7543 AS cval_lineitem_l_extendedprice_2#7576, cval_lineitem_l_discount#7544 AS cval_lineitem_l_discount_2#7577, cval_lineitem_l_tax#7545 AS cval_lineitem_l_tax_2#7578, cval_lineitem_l_returnflag#7546 AS cval_lineitem_l_returnflag_2#7579, cval_lineitem_l_linestatus#7547 AS cval_lineitem_l_linestatus_2#7580, cval_lineitem_l_commitdate#7548 AS cval_lineitem_l_commitdate_2#7581, cval_lineitem_l_receiptdate#7549 AS cval_lineitem_l_receiptdate_2#7582, cval_lineitem_l_shipinstruct#7550 AS cval_lineitem_l_shipinstruct_2#7583, cval_lineitem_l_shipmode#7551 AS cval_lineitem_l_shipmode_2#7584, cval_lineitem_l_comment#7552 AS cval_lineitem_l_comment_2#7585, cval_lineitem_l_shipdate#7553 AS cval_lineitem_l_shipdate_2#7586, cl_quantity#7554 AS cl_quantity_2#7587, cl_extendedprice#7555 AS cl_extendedprice_2#7588, cl_discount#7556 AS cl_discount_2#7589, ... 9 more fields]
            +- Relation[rid#7533,cpfk_orders_lineitem#7534,cpfk_supplier_lineitem#7535,cfpk_lineitem_supplier#7536,cfpk_lineitem_partsupp#7537,cpfk_part_lineitem#7538,cfpk_lineitem_part#7539,cpfk_partsupp_lineitem#7540,cfpk_lineitem_orders#7541,cval_lineitem_l_quantity#7542,cval_lineitem_l_extendedprice#7543,cval_lineitem_l_discount#7544,cval_lineitem_l_tax#7545,cval_lineitem_l_returnflag#7546,cval_lineitem_l_linestatus#7547,cval_lineitem_l_commitdate#7548,cval_lineitem_l_receiptdate#7549,cval_lineitem_l_shipinstruct#7550,cval_lineitem_l_shipmode#7551,cval_lineitem_l_comment#7552,cval_lineitem_l_shipdate#7553,cl_quantity#7554,cl_extendedprice#7555,cl_discount#7556,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 118744ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/11 03:49:26 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:49:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7769L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 03:49:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#7769L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#7771 AS rid_0#7804, cpfk_orders_lineitem#7772 AS cpfk_orders_lineitem_0#7805, cpfk_supplier_lineitem#7773 AS cpfk_supplier_lineitem_0#7806, cfpk_lineitem_supplier#7774 AS cfpk_lineitem_supplier_0#7807, cfpk_lineitem_partsupp#7775 AS cfpk_lineitem_partsupp_0#7808, cpfk_part_lineitem#7776 AS cpfk_part_lineitem_0#7809, cfpk_lineitem_part#7777 AS cfpk_lineitem_part_0#7810, cpfk_partsupp_lineitem#7778 AS cpfk_partsupp_lineitem_0#7811, cfpk_lineitem_orders#7779 AS cfpk_lineitem_orders_0#7812, cval_lineitem_l_quantity#7780 AS cval_lineitem_l_quantity_0#7813, cval_lineitem_l_extendedprice#7781 AS cval_lineitem_l_extendedprice_0#7814, cval_lineitem_l_discount#7782 AS cval_lineitem_l_discount_0#7815, cval_lineitem_l_tax#7783 AS cval_lineitem_l_tax_0#7816, cval_lineitem_l_returnflag#7784 AS cval_lineitem_l_returnflag_0#7817, cval_lineitem_l_linestatus#7785 AS cval_lineitem_l_linestatus_0#7818, cval_lineitem_l_commitdate#7786 AS cval_lineitem_l_commitdate_0#7819, cval_lineitem_l_receiptdate#7787 AS cval_lineitem_l_receiptdate_0#7820, cval_lineitem_l_shipinstruct#7788 AS cval_lineitem_l_shipinstruct_0#7821, cval_lineitem_l_shipmode#7789 AS cval_lineitem_l_shipmode_0#7822, cval_lineitem_l_comment#7790 AS cval_lineitem_l_comment_0#7823, cval_lineitem_l_shipdate#7791 AS cval_lineitem_l_shipdate_0#7824, cl_quantity#7792 AS cl_quantity_0#7825, cl_extendedprice#7793 AS cl_extendedprice_0#7826, cl_discount#7794 AS cl_discount_0#7827, ... 9 more fields]
         +- Relation[rid#7771,cpfk_orders_lineitem#7772,cpfk_supplier_lineitem#7773,cfpk_lineitem_supplier#7774,cfpk_lineitem_partsupp#7775,cpfk_part_lineitem#7776,cfpk_lineitem_part#7777,cpfk_partsupp_lineitem#7778,cfpk_lineitem_orders#7779,cval_lineitem_l_quantity#7780,cval_lineitem_l_extendedprice#7781,cval_lineitem_l_discount#7782,cval_lineitem_l_tax#7783,cval_lineitem_l_returnflag#7784,cval_lineitem_l_linestatus#7785,cval_lineitem_l_commitdate#7786,cval_lineitem_l_receiptdate#7787,cval_lineitem_l_shipinstruct#7788,cval_lineitem_l_shipmode#7789,cval_lineitem_l_comment#7790,cval_lineitem_l_shipdate#7791,cl_quantity#7792,cl_extendedprice#7793,cl_discount#7794,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 3361ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/11 03:49:30 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:49:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7875L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 03:49:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#7875L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#7877 AS rid_0#7910, cpfk_orders_lineitem#7878 AS cpfk_orders_lineitem_0#7911, cpfk_supplier_lineitem#7879 AS cpfk_supplier_lineitem_0#7912, cfpk_lineitem_supplier#7880 AS cfpk_lineitem_supplier_0#7913, cfpk_lineitem_partsupp#7881 AS cfpk_lineitem_partsupp_0#7914, cpfk_part_lineitem#7882 AS cpfk_part_lineitem_0#7915, cfpk_lineitem_part#7883 AS cfpk_lineitem_part_0#7916, cpfk_partsupp_lineitem#7884 AS cpfk_partsupp_lineitem_0#7917, cfpk_lineitem_orders#7885 AS cfpk_lineitem_orders_0#7918, cval_lineitem_l_quantity#7886 AS cval_lineitem_l_quantity_0#7919, cval_lineitem_l_extendedprice#7887 AS cval_lineitem_l_extendedprice_0#7920, cval_lineitem_l_discount#7888 AS cval_lineitem_l_discount_0#7921, cval_lineitem_l_tax#7889 AS cval_lineitem_l_tax_0#7922, cval_lineitem_l_returnflag#7890 AS cval_lineitem_l_returnflag_0#7923, cval_lineitem_l_linestatus#7891 AS cval_lineitem_l_linestatus_0#7924, cval_lineitem_l_commitdate#7892 AS cval_lineitem_l_commitdate_0#7925, cval_lineitem_l_receiptdate#7893 AS cval_lineitem_l_receiptdate_0#7926, cval_lineitem_l_shipinstruct#7894 AS cval_lineitem_l_shipinstruct_0#7927, cval_lineitem_l_shipmode#7895 AS cval_lineitem_l_shipmode_0#7928, cval_lineitem_l_comment#7896 AS cval_lineitem_l_comment_0#7929, cval_lineitem_l_shipdate#7897 AS cval_lineitem_l_shipdate_0#7930, cl_quantity#7898 AS cl_quantity_0#7931, cl_extendedprice#7899 AS cl_extendedprice_0#7932, cl_discount#7900 AS cl_discount_0#7933, ... 9 more fields]
         +- Relation[rid#7877,cpfk_orders_lineitem#7878,cpfk_supplier_lineitem#7879,cfpk_lineitem_supplier#7880,cfpk_lineitem_partsupp#7881,cpfk_part_lineitem#7882,cfpk_lineitem_part#7883,cpfk_partsupp_lineitem#7884,cfpk_lineitem_orders#7885,cval_lineitem_l_quantity#7886,cval_lineitem_l_extendedprice#7887,cval_lineitem_l_discount#7888,cval_lineitem_l_tax#7889,cval_lineitem_l_returnflag#7890,cval_lineitem_l_linestatus#7891,cval_lineitem_l_commitdate#7892,cval_lineitem_l_receiptdate#7893,cval_lineitem_l_shipinstruct#7894,cval_lineitem_l_shipmode#7895,cval_lineitem_l_comment#7896,cval_lineitem_l_shipdate#7897,cl_quantity#7898,cl_extendedprice#7899,cl_discount#7900,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 4735ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/11 03:49:34 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:49:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7982L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/11 03:49:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:49:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:49:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:49:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:49:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:49:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:49:34 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 03:49:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:49:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:49:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:49:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:49:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:49:34 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:49:34 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:49:35 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:49:35 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:49:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7982L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#7984 AS rid_0#7989, cval_region_r_name#7985 AS cval_region_r_name_0#7990, cval_region_r_comment#7986 AS cval_region_r_comment_0#7991, cr_name#7987 AS cr_name_0#7992, cr_comment#7988 AS cr_comment_0#7993]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#7984,cval_region_r_name#7985,cval_region_r_comment#7986,cr_name#7987,cr_comment#7988] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#7994 AS rid_0#7999, cval_region_r_name#7995 AS cval_region_r_name_0#8000, cval_region_r_comment#7996 AS cval_region_r_comment_0#8001, cr_name#7997 AS cr_name_0#8002, cr_comment#7998 AS cr_comment_0#8003]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#7994,cval_region_r_name#7995,cval_region_r_comment#7996,cr_name#7997,cr_comment#7998] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :     :- Project [rid#8018 AS rid_0#8023, cval_region_r_name#8019 AS cval_region_r_name_0#8024, cval_region_r_comment#8020 AS cval_region_r_comment_0#8025, cr_name#8021 AS cr_name_0#8026, cr_comment#8022 AS cr_comment_0#8027]
         :     :  :  :  :  :  :  :  :     :  +- Relation[rid#8018,cval_region_r_name#8019,cval_region_r_comment#8020,cr_name#8021,cr_comment#8022] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :     +- Project [rid#8028 AS rid_1#8035, cpfk_region_nation#8029 AS cpfk_region_nation_1#8036, cfpk_nation_region#8030 AS cfpk_nation_region_1#8037, cval_nation_n_name#8031 AS cval_nation_n_name_1#8038, cval_nation_n_comment#8032 AS cval_nation_n_comment_1#8039, cn_name#8033 AS cn_name_1#8040, cn_comment#8034 AS cn_comment_1#8041]
         :     :  :  :  :  :  :  :  :        +- Relation[rid#8028,cpfk_region_nation#8029,cfpk_nation_region#8030,cval_nation_n_name#8031,cval_nation_n_comment#8032,cn_name#8033,cn_comment#8034] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#8004 AS rid_1#8011, cpfk_region_nation#8005 AS cpfk_region_nation_1#8012, cfpk_nation_region#8006 AS cfpk_nation_region_1#8013, cval_nation_n_name#8007 AS cval_nation_n_name_1#8014, cval_nation_n_comment#8008 AS cval_nation_n_comment_1#8015, cn_name#8009 AS cn_name_1#8016, cn_comment#8010 AS cn_comment_1#8017]
         :     :  :  :  :  :  :  :     +- Relation[rid#8004,cpfk_region_nation#8005,cfpk_nation_region#8006,cval_nation_n_name#8007,cval_nation_n_comment#8008,cn_name#8009,cn_comment#8010] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :     :- Project [rid#8072 AS rid_1#8079, cpfk_region_nation#8073 AS cpfk_region_nation_1#8080, cfpk_nation_region#8074 AS cfpk_nation_region_1#8081, cval_nation_n_name#8075 AS cval_nation_n_name_1#8082, cval_nation_n_comment#8076 AS cval_nation_n_comment_1#8083, cn_name#8077 AS cn_name_1#8084, cn_comment#8078 AS cn_comment_1#8085]
         :     :  :  :  :  :  :     :  +- Relation[rid#8072,cpfk_region_nation#8073,cfpk_nation_region#8074,cval_nation_n_name#8075,cval_nation_n_comment#8076,cn_name#8077,cn_comment#8078] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :     +- Project [rid#8086 AS rid_2#8101, cpfk_nation_customer#8087 AS cpfk_nation_customer_2#8102, cfpk_customer_nation#8088 AS cfpk_customer_nation_2#8103, cval_customer_c_name#8089 AS cval_customer_c_name_2#8104, cval_customer_c_address#8090 AS cval_customer_c_address_2#8105, cval_customer_c_phone#8091 AS cval_customer_c_phone_2#8106, cval_customer_c_acctbal#8092 AS cval_customer_c_acctbal_2#8107, cval_customer_c_comment#8093 AS cval_customer_c_comment_2#8108, cval_customer_c_mktsegment#8094 AS cval_customer_c_mktsegment_2#8109, cc_name#8095 AS cc_name_2#8110, cc_address#8096 AS cc_address_2#8111, cc_phone#8097 AS cc_phone_2#8112, cc_acctbal#8098 AS cc_acctbal_2#8113, cc_comment#8099 AS cc_comment_2#8114, cc_mktsegment#8100 AS cc_mktsegment_2#8115]
         :     :  :  :  :  :  :        +- Relation[rid#8086,cpfk_nation_customer#8087,cfpk_customer_nation#8088,cval_customer_c_name#8089,cval_customer_c_address#8090,cval_customer_c_phone#8091,cval_customer_c_acctbal#8092,cval_customer_c_comment#8093,cval_customer_c_mktsegment#8094,cc_name#8095,cc_address#8096,cc_phone#8097,cc_acctbal#8098,cc_comment#8099,cc_mktsegment#8100] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#8042 AS rid_2#8057, cpfk_nation_customer#8043 AS cpfk_nation_customer_2#8058, cfpk_customer_nation#8044 AS cfpk_customer_nation_2#8059, cval_customer_c_name#8045 AS cval_customer_c_name_2#8060, cval_customer_c_address#8046 AS cval_customer_c_address_2#8061, cval_customer_c_phone#8047 AS cval_customer_c_phone_2#8062, cval_customer_c_acctbal#8048 AS cval_customer_c_acctbal_2#8063, cval_customer_c_comment#8049 AS cval_customer_c_comment_2#8064, cval_customer_c_mktsegment#8050 AS cval_customer_c_mktsegment_2#8065, cc_name#8051 AS cc_name_2#8066, cc_address#8052 AS cc_address_2#8067, cc_phone#8053 AS cc_phone_2#8068, cc_acctbal#8054 AS cc_acctbal_2#8069, cc_comment#8055 AS cc_comment_2#8070, cc_mktsegment#8056 AS cc_mktsegment_2#8071]
         :     :  :  :  :  :     +- Relation[rid#8042,cpfk_nation_customer#8043,cfpk_customer_nation#8044,cval_customer_c_name#8045,cval_customer_c_address#8046,cval_customer_c_phone#8047,cval_customer_c_acctbal#8048,cval_customer_c_comment#8049,cval_customer_c_mktsegment#8050,cc_name#8051,cc_address#8052,cc_phone#8053,cc_acctbal#8054,cc_comment#8055,cc_mktsegment#8056] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :     :- Project [rid#8150 AS rid_2#8165, cpfk_nation_customer#8151 AS cpfk_nation_customer_2#8166, cfpk_customer_nation#8152 AS cfpk_customer_nation_2#8167, cval_customer_c_name#8153 AS cval_customer_c_name_2#8168, cval_customer_c_address#8154 AS cval_customer_c_address_2#8169, cval_customer_c_phone#8155 AS cval_customer_c_phone_2#8170, cval_customer_c_acctbal#8156 AS cval_customer_c_acctbal_2#8171, cval_customer_c_comment#8157 AS cval_customer_c_comment_2#8172, cval_customer_c_mktsegment#8158 AS cval_customer_c_mktsegment_2#8173, cc_name#8159 AS cc_name_2#8174, cc_address#8160 AS cc_address_2#8175, cc_phone#8161 AS cc_phone_2#8176, cc_acctbal#8162 AS cc_acctbal_2#8177, cc_comment#8163 AS cc_comment_2#8178, cc_mktsegment#8164 AS cc_mktsegment_2#8179]
         :     :  :  :  :     :  +- Relation[rid#8150,cpfk_nation_customer#8151,cfpk_customer_nation#8152,cval_customer_c_name#8153,cval_customer_c_address#8154,cval_customer_c_phone#8155,cval_customer_c_acctbal#8156,cval_customer_c_comment#8157,cval_customer_c_mktsegment#8158,cc_name#8159,cc_address#8160,cc_phone#8161,cc_acctbal#8162,cc_comment#8163,cc_mktsegment#8164] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :     +- Project [rid#8180 AS rid_3#8197, cpfk_customer_orders#8181 AS cpfk_customer_orders_3#8198, cfpk_orders_customer#8182 AS cfpk_orders_customer_3#8199, cval_orders_o_orderstatus#8183 AS cval_orders_o_orderstatus_3#8200, cval_orders_o_totalprice#8184 AS cval_orders_o_totalprice_3#8201, cval_orders_o_orderpriority#8185 AS cval_orders_o_orderpriority_3#8202, cval_orders_o_clerk#8186 AS cval_orders_o_clerk_3#8203, cval_orders_o_shippriority#8187 AS cval_orders_o_shippriority_3#8204, cval_orders_o_comment#8188 AS cval_orders_o_comment_3#8205, cval_orders_o_orderdate#8189 AS cval_orders_o_orderdate_3#8206, co_orderstatus#8190 AS co_orderstatus_3#8207, co_totalprice#8191 AS co_totalprice_3#8208, co_orderpriority#8192 AS co_orderpriority_3#8209, co_clerk#8193 AS co_clerk_3#8210, co_shippriority#8194 AS co_shippriority_3#8211, co_comment#8195 AS co_comment_3#8212, co_orderdate#8196 AS co_orderdate_3#8213]
         :     :  :  :  :        +- Relation[rid#8180,cpfk_customer_orders#8181,cfpk_orders_customer#8182,cval_orders_o_orderstatus#8183,cval_orders_o_totalprice#8184,cval_orders_o_orderpriority#8185,cval_orders_o_clerk#8186,cval_orders_o_shippriority#8187,cval_orders_o_comment#8188,cval_orders_o_orderdate#8189,co_orderstatus#8190,co_totalprice#8191,co_orderpriority#8192,co_clerk#8193,co_shippriority#8194,co_comment#8195,co_orderdate#8196] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#8116 AS rid_3#8133, cpfk_customer_orders#8117 AS cpfk_customer_orders_3#8134, cfpk_orders_customer#8118 AS cfpk_orders_customer_3#8135, cval_orders_o_orderstatus#8119 AS cval_orders_o_orderstatus_3#8136, cval_orders_o_totalprice#8120 AS cval_orders_o_totalprice_3#8137, cval_orders_o_orderpriority#8121 AS cval_orders_o_orderpriority_3#8138, cval_orders_o_clerk#8122 AS cval_orders_o_clerk_3#8139, cval_orders_o_shippriority#8123 AS cval_orders_o_shippriority_3#8140, cval_orders_o_comment#8124 AS cval_orders_o_comment_3#8141, cval_orders_o_orderdate#8125 AS cval_orders_o_orderdate_3#8142, co_orderstatus#8126 AS co_orderstatus_3#8143, co_totalprice#8127 AS co_totalprice_3#8144, co_orderpriority#8128 AS co_orderpriority_3#8145, co_clerk#8129 AS co_clerk_3#8146, co_shippriority#8130 AS co_shippriority_3#8147, co_comment#8131 AS co_comment_3#8148, co_orderdate#8132 AS co_orderdate_3#8149]
         :     :  :  :     +- Relation[rid#8116,cpfk_customer_orders#8117,cfpk_orders_customer#8118,cval_orders_o_orderstatus#8119,cval_orders_o_totalprice#8120,cval_orders_o_orderpriority#8121,cval_orders_o_clerk#8122,cval_orders_o_shippriority#8123,cval_orders_o_comment#8124,cval_orders_o_orderdate#8125,co_orderstatus#8126,co_totalprice#8127,co_orderpriority#8128,co_clerk#8129,co_shippriority#8130,co_comment#8131,co_orderdate#8132] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :     :- Project [rid#8280 AS rid_3#8297, cpfk_customer_orders#8281 AS cpfk_customer_orders_3#8298, cfpk_orders_customer#8282 AS cfpk_orders_customer_3#8299, cval_orders_o_orderstatus#8283 AS cval_orders_o_orderstatus_3#8300, cval_orders_o_totalprice#8284 AS cval_orders_o_totalprice_3#8301, cval_orders_o_orderpriority#8285 AS cval_orders_o_orderpriority_3#8302, cval_orders_o_clerk#8286 AS cval_orders_o_clerk_3#8303, cval_orders_o_shippriority#8287 AS cval_orders_o_shippriority_3#8304, cval_orders_o_comment#8288 AS cval_orders_o_comment_3#8305, cval_orders_o_orderdate#8289 AS cval_orders_o_orderdate_3#8306, co_orderstatus#8290 AS co_orderstatus_3#8307, co_totalprice#8291 AS co_totalprice_3#8308, co_orderpriority#8292 AS co_orderpriority_3#8309, co_clerk#8293 AS co_clerk_3#8310, co_shippriority#8294 AS co_shippriority_3#8311, co_comment#8295 AS co_comment_3#8312, co_orderdate#8296 AS co_orderdate_3#8313]
         :     :  :     :  +- Relation[rid#8280,cpfk_customer_orders#8281,cfpk_orders_customer#8282,cval_orders_o_orderstatus#8283,cval_orders_o_totalprice#8284,cval_orders_o_orderpriority#8285,cval_orders_o_clerk#8286,cval_orders_o_shippriority#8287,cval_orders_o_comment#8288,cval_orders_o_orderdate#8289,co_orderstatus#8290,co_totalprice#8291,co_orderpriority#8292,co_clerk#8293,co_shippriority#8294,co_comment#8295,co_orderdate#8296] JDBCRelation(torders) [numPartitions=1]
         :     :  :     +- Project [rid#8314 AS rid_4#8347, cpfk_orders_lineitem#8315 AS cpfk_orders_lineitem_4#8348, cpfk_supplier_lineitem#8316 AS cpfk_supplier_lineitem_4#8349, cfpk_lineitem_supplier#8317 AS cfpk_lineitem_supplier_4#8350, cfpk_lineitem_partsupp#8318 AS cfpk_lineitem_partsupp_4#8351, cpfk_part_lineitem#8319 AS cpfk_part_lineitem_4#8352, cfpk_lineitem_part#8320 AS cfpk_lineitem_part_4#8353, cpfk_partsupp_lineitem#8321 AS cpfk_partsupp_lineitem_4#8354, cfpk_lineitem_orders#8322 AS cfpk_lineitem_orders_4#8355, cval_lineitem_l_quantity#8323 AS cval_lineitem_l_quantity_4#8356, cval_lineitem_l_extendedprice#8324 AS cval_lineitem_l_extendedprice_4#8357, cval_lineitem_l_discount#8325 AS cval_lineitem_l_discount_4#8358, cval_lineitem_l_tax#8326 AS cval_lineitem_l_tax_4#8359, cval_lineitem_l_returnflag#8327 AS cval_lineitem_l_returnflag_4#8360, cval_lineitem_l_linestatus#8328 AS cval_lineitem_l_linestatus_4#8361, cval_lineitem_l_commitdate#8329 AS cval_lineitem_l_commitdate_4#8362, cval_lineitem_l_receiptdate#8330 AS cval_lineitem_l_receiptdate_4#8363, cval_lineitem_l_shipinstruct#8331 AS cval_lineitem_l_shipinstruct_4#8364, cval_lineitem_l_shipmode#8332 AS cval_lineitem_l_shipmode_4#8365, cval_lineitem_l_comment#8333 AS cval_lineitem_l_comment_4#8366, cval_lineitem_l_shipdate#8334 AS cval_lineitem_l_shipdate_4#8367, cl_quantity#8335 AS cl_quantity_4#8368, cl_extendedprice#8336 AS cl_extendedprice_4#8369, cl_discount#8337 AS cl_discount_4#8370, ... 9 more fields]
         :     :  :        +- Relation[rid#8314,cpfk_orders_lineitem#8315,cpfk_supplier_lineitem#8316,cfpk_lineitem_supplier#8317,cfpk_lineitem_partsupp#8318,cpfk_part_lineitem#8319,cfpk_lineitem_part#8320,cpfk_partsupp_lineitem#8321,cfpk_lineitem_orders#8322,cval_lineitem_l_quantity#8323,cval_lineitem_l_extendedprice#8324,cval_lineitem_l_discount#8325,cval_lineitem_l_tax#8326,cval_lineitem_l_returnflag#8327,cval_lineitem_l_linestatus#8328,cval_lineitem_l_commitdate#8329,cval_lineitem_l_receiptdate#8330,cval_lineitem_l_shipinstruct#8331,cval_lineitem_l_shipmode#8332,cval_lineitem_l_comment#8333,cval_lineitem_l_shipdate#8334,cl_quantity#8335,cl_extendedprice#8336,cl_discount#8337,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#8214 AS rid_4#8247, cpfk_orders_lineitem#8215 AS cpfk_orders_lineitem_4#8248, cpfk_supplier_lineitem#8216 AS cpfk_supplier_lineitem_4#8249, cfpk_lineitem_supplier#8217 AS cfpk_lineitem_supplier_4#8250, cfpk_lineitem_partsupp#8218 AS cfpk_lineitem_partsupp_4#8251, cpfk_part_lineitem#8219 AS cpfk_part_lineitem_4#8252, cfpk_lineitem_part#8220 AS cfpk_lineitem_part_4#8253, cpfk_partsupp_lineitem#8221 AS cpfk_partsupp_lineitem_4#8254, cfpk_lineitem_orders#8222 AS cfpk_lineitem_orders_4#8255, cval_lineitem_l_quantity#8223 AS cval_lineitem_l_quantity_4#8256, cval_lineitem_l_extendedprice#8224 AS cval_lineitem_l_extendedprice_4#8257, cval_lineitem_l_discount#8225 AS cval_lineitem_l_discount_4#8258, cval_lineitem_l_tax#8226 AS cval_lineitem_l_tax_4#8259, cval_lineitem_l_returnflag#8227 AS cval_lineitem_l_returnflag_4#8260, cval_lineitem_l_linestatus#8228 AS cval_lineitem_l_linestatus_4#8261, cval_lineitem_l_commitdate#8229 AS cval_lineitem_l_commitdate_4#8262, cval_lineitem_l_receiptdate#8230 AS cval_lineitem_l_receiptdate_4#8263, cval_lineitem_l_shipinstruct#8231 AS cval_lineitem_l_shipinstruct_4#8264, cval_lineitem_l_shipmode#8232 AS cval_lineitem_l_shipmode_4#8265, cval_lineitem_l_comment#8233 AS cval_lineitem_l_comment_4#8266, cval_lineitem_l_shipdate#8234 AS cval_lineitem_l_shipdate_4#8267, cl_quantity#8235 AS cl_quantity_4#8268, cl_extendedprice#8236 AS cl_extendedprice_4#8269, cl_discount#8237 AS cl_discount_4#8270, ... 9 more fields]
         :     :     +- Relation[rid#8214,cpfk_orders_lineitem#8215,cpfk_supplier_lineitem#8216,cfpk_lineitem_supplier#8217,cfpk_lineitem_partsupp#8218,cpfk_part_lineitem#8219,cfpk_lineitem_part#8220,cpfk_partsupp_lineitem#8221,cfpk_lineitem_orders#8222,cval_lineitem_l_quantity#8223,cval_lineitem_l_extendedprice#8224,cval_lineitem_l_discount#8225,cval_lineitem_l_tax#8226,cval_lineitem_l_returnflag#8227,cval_lineitem_l_linestatus#8228,cval_lineitem_l_commitdate#8229,cval_lineitem_l_receiptdate#8230,cval_lineitem_l_shipinstruct#8231,cval_lineitem_l_shipmode#8232,cval_lineitem_l_comment#8233,cval_lineitem_l_shipdate#8234,cl_quantity#8235,cl_extendedprice#8236,cl_discount#8237,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#8380 AS rid_5#8393, cpfk_nation_supplier#8381 AS cpfk_nation_supplier_5#8394, cfpk_supplier_nation#8382 AS cfpk_supplier_nation_5#8395, cval_supplier_s_name#8383 AS cval_supplier_s_name_5#8396, cval_supplier_s_address#8384 AS cval_supplier_s_address_5#8397, cval_supplier_s_phone#8385 AS cval_supplier_s_phone_5#8398, cval_supplier_s_acctbal#8386 AS cval_supplier_s_acctbal_5#8399, cval_supplier_s_comment#8387 AS cval_supplier_s_comment_5#8400, cs_name#8388 AS cs_name_5#8401, cs_address#8389 AS cs_address_5#8402, cs_phone#8390 AS cs_phone_5#8403, cs_acctbal#8391 AS cs_acctbal_5#8404, cs_comment#8392 AS cs_comment_5#8405]
         :        +- Relation[rid#8380,cpfk_nation_supplier#8381,cfpk_supplier_nation#8382,cval_supplier_s_name#8383,cval_supplier_s_address#8384,cval_supplier_s_phone#8385,cval_supplier_s_acctbal#8386,cval_supplier_s_comment#8387,cs_name#8388,cs_address#8389,cs_phone#8390,cs_acctbal#8391,cs_comment#8392] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#8406 AS rid_1#8413, cpfk_region_nation#8407 AS cpfk_region_nation_1#8414, cfpk_nation_region#8408 AS cfpk_nation_region_1#8415, cval_nation_n_name#8409 AS cval_nation_n_name_1#8416, cval_nation_n_comment#8410 AS cval_nation_n_comment_1#8417, cn_name#8411 AS cn_name_1#8418, cn_comment#8412 AS cn_comment_1#8419]
            :  +- Relation[rid#8406,cpfk_region_nation#8407,cfpk_nation_region#8408,cval_nation_n_name#8409,cval_nation_n_comment#8410,cn_name#8411,cn_comment#8412] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#8420 AS rid_5#8433, cpfk_nation_supplier#8421 AS cpfk_nation_supplier_5#8434, cfpk_supplier_nation#8422 AS cfpk_supplier_nation_5#8435, cval_supplier_s_name#8423 AS cval_supplier_s_name_5#8436, cval_supplier_s_address#8424 AS cval_supplier_s_address_5#8437, cval_supplier_s_phone#8425 AS cval_supplier_s_phone_5#8438, cval_supplier_s_acctbal#8426 AS cval_supplier_s_acctbal_5#8439, cval_supplier_s_comment#8427 AS cval_supplier_s_comment_5#8440, cs_name#8428 AS cs_name_5#8441, cs_address#8429 AS cs_address_5#8442, cs_phone#8430 AS cs_phone_5#8443, cs_acctbal#8431 AS cs_acctbal_5#8444, cs_comment#8432 AS cs_comment_5#8445]
               +- Relation[rid#8420,cpfk_nation_supplier#8421,cfpk_supplier_nation#8422,cval_supplier_s_name#8423,cval_supplier_s_address#8424,cval_supplier_s_phone#8425,cval_supplier_s_acctbal#8426,cval_supplier_s_comment#8427,cs_name#8428,cs_address#8429,cs_phone#8430,cs_acctbal#8431,cs_comment#8432] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1206514
Elapsed time: 164676ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/11 03:52:19 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:52:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8544L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 03:52:19 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 03:52:19 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 03:52:19 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 03:52:19 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 03:52:19 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 03:52:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8544L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#8546 AS rid_0#8561, cpfk_nation_customer#8547 AS cpfk_nation_customer_0#8562, cfpk_customer_nation#8548 AS cfpk_customer_nation_0#8563, cval_customer_c_name#8549 AS cval_customer_c_name_0#8564, cval_customer_c_address#8550 AS cval_customer_c_address_0#8565, cval_customer_c_phone#8551 AS cval_customer_c_phone_0#8566, cval_customer_c_acctbal#8552 AS cval_customer_c_acctbal_0#8567, cval_customer_c_comment#8553 AS cval_customer_c_comment_0#8568, cval_customer_c_mktsegment#8554 AS cval_customer_c_mktsegment_0#8569, cc_name#8555 AS cc_name_0#8570, cc_address#8556 AS cc_address_0#8571, cc_phone#8557 AS cc_phone_0#8572, cc_acctbal#8558 AS cc_acctbal_0#8573, cc_comment#8559 AS cc_comment_0#8574, cc_mktsegment#8560 AS cc_mktsegment_0#8575]
         :  :  :  :  :  +- Relation[rid#8546,cpfk_nation_customer#8547,cfpk_customer_nation#8548,cval_customer_c_name#8549,cval_customer_c_address#8550,cval_customer_c_phone#8551,cval_customer_c_acctbal#8552,cval_customer_c_comment#8553,cval_customer_c_mktsegment#8554,cc_name#8555,cc_address#8556,cc_phone#8557,cc_acctbal#8558,cc_comment#8559,cc_mktsegment#8560] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#8576 AS rid_0#8591, cpfk_nation_customer#8577 AS cpfk_nation_customer_0#8592, cfpk_customer_nation#8578 AS cfpk_customer_nation_0#8593, cval_customer_c_name#8579 AS cval_customer_c_name_0#8594, cval_customer_c_address#8580 AS cval_customer_c_address_0#8595, cval_customer_c_phone#8581 AS cval_customer_c_phone_0#8596, cval_customer_c_acctbal#8582 AS cval_customer_c_acctbal_0#8597, cval_customer_c_comment#8583 AS cval_customer_c_comment_0#8598, cval_customer_c_mktsegment#8584 AS cval_customer_c_mktsegment_0#8599, cc_name#8585 AS cc_name_0#8600, cc_address#8586 AS cc_address_0#8601, cc_phone#8587 AS cc_phone_0#8602, cc_acctbal#8588 AS cc_acctbal_0#8603, cc_comment#8589 AS cc_comment_0#8604, cc_mktsegment#8590 AS cc_mktsegment_0#8605]
         :  :  :  :        +- Relation[rid#8576,cpfk_nation_customer#8577,cfpk_customer_nation#8578,cval_customer_c_name#8579,cval_customer_c_address#8580,cval_customer_c_phone#8581,cval_customer_c_acctbal#8582,cval_customer_c_comment#8583,cval_customer_c_mktsegment#8584,cc_name#8585,cc_address#8586,cc_phone#8587,cc_acctbal#8588,cc_comment#8589,cc_mktsegment#8590] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#8640 AS rid_0#8655, cpfk_nation_customer#8641 AS cpfk_nation_customer_0#8656, cfpk_customer_nation#8642 AS cfpk_customer_nation_0#8657, cval_customer_c_name#8643 AS cval_customer_c_name_0#8658, cval_customer_c_address#8644 AS cval_customer_c_address_0#8659, cval_customer_c_phone#8645 AS cval_customer_c_phone_0#8660, cval_customer_c_acctbal#8646 AS cval_customer_c_acctbal_0#8661, cval_customer_c_comment#8647 AS cval_customer_c_comment_0#8662, cval_customer_c_mktsegment#8648 AS cval_customer_c_mktsegment_0#8663, cc_name#8649 AS cc_name_0#8664, cc_address#8650 AS cc_address_0#8665, cc_phone#8651 AS cc_phone_0#8666, cc_acctbal#8652 AS cc_acctbal_0#8667, cc_comment#8653 AS cc_comment_0#8668, cc_mktsegment#8654 AS cc_mktsegment_0#8669]
         :  :  :     :  +- Relation[rid#8640,cpfk_nation_customer#8641,cfpk_customer_nation#8642,cval_customer_c_name#8643,cval_customer_c_address#8644,cval_customer_c_phone#8645,cval_customer_c_acctbal#8646,cval_customer_c_comment#8647,cval_customer_c_mktsegment#8648,cc_name#8649,cc_address#8650,cc_phone#8651,cc_acctbal#8652,cc_comment#8653,cc_mktsegment#8654] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#8670 AS rid_1#8687, cpfk_customer_orders#8671 AS cpfk_customer_orders_1#8688, cfpk_orders_customer#8672 AS cfpk_orders_customer_1#8689, cval_orders_o_orderstatus#8673 AS cval_orders_o_orderstatus_1#8690, cval_orders_o_totalprice#8674 AS cval_orders_o_totalprice_1#8691, cval_orders_o_orderpriority#8675 AS cval_orders_o_orderpriority_1#8692, cval_orders_o_clerk#8676 AS cval_orders_o_clerk_1#8693, cval_orders_o_shippriority#8677 AS cval_orders_o_shippriority_1#8694, cval_orders_o_comment#8678 AS cval_orders_o_comment_1#8695, cval_orders_o_orderdate#8679 AS cval_orders_o_orderdate_1#8696, co_orderstatus#8680 AS co_orderstatus_1#8697, co_totalprice#8681 AS co_totalprice_1#8698, co_orderpriority#8682 AS co_orderpriority_1#8699, co_clerk#8683 AS co_clerk_1#8700, co_shippriority#8684 AS co_shippriority_1#8701, co_comment#8685 AS co_comment_1#8702, co_orderdate#8686 AS co_orderdate_1#8703]
         :  :  :        +- Relation[rid#8670,cpfk_customer_orders#8671,cfpk_orders_customer#8672,cval_orders_o_orderstatus#8673,cval_orders_o_totalprice#8674,cval_orders_o_orderpriority#8675,cval_orders_o_clerk#8676,cval_orders_o_shippriority#8677,cval_orders_o_comment#8678,cval_orders_o_orderdate#8679,co_orderstatus#8680,co_totalprice#8681,co_orderpriority#8682,co_clerk#8683,co_shippriority#8684,co_comment#8685,co_orderdate#8686] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#8606 AS rid_1#8623, cpfk_customer_orders#8607 AS cpfk_customer_orders_1#8624, cfpk_orders_customer#8608 AS cfpk_orders_customer_1#8625, cval_orders_o_orderstatus#8609 AS cval_orders_o_orderstatus_1#8626, cval_orders_o_totalprice#8610 AS cval_orders_o_totalprice_1#8627, cval_orders_o_orderpriority#8611 AS cval_orders_o_orderpriority_1#8628, cval_orders_o_clerk#8612 AS cval_orders_o_clerk_1#8629, cval_orders_o_shippriority#8613 AS cval_orders_o_shippriority_1#8630, cval_orders_o_comment#8614 AS cval_orders_o_comment_1#8631, cval_orders_o_orderdate#8615 AS cval_orders_o_orderdate_1#8632, co_orderstatus#8616 AS co_orderstatus_1#8633, co_totalprice#8617 AS co_totalprice_1#8634, co_orderpriority#8618 AS co_orderpriority_1#8635, co_clerk#8619 AS co_clerk_1#8636, co_shippriority#8620 AS co_shippriority_1#8637, co_comment#8621 AS co_comment_1#8638, co_orderdate#8622 AS co_orderdate_1#8639]
         :  :     +- Relation[rid#8606,cpfk_customer_orders#8607,cfpk_orders_customer#8608,cval_orders_o_orderstatus#8609,cval_orders_o_totalprice#8610,cval_orders_o_orderpriority#8611,cval_orders_o_clerk#8612,cval_orders_o_shippriority#8613,cval_orders_o_comment#8614,cval_orders_o_orderdate#8615,co_orderstatus#8616,co_totalprice#8617,co_orderpriority#8618,co_clerk#8619,co_shippriority#8620,co_comment#8621,co_orderdate#8622] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#8770 AS rid_1#8787, cpfk_customer_orders#8771 AS cpfk_customer_orders_1#8788, cfpk_orders_customer#8772 AS cfpk_orders_customer_1#8789, cval_orders_o_orderstatus#8773 AS cval_orders_o_orderstatus_1#8790, cval_orders_o_totalprice#8774 AS cval_orders_o_totalprice_1#8791, cval_orders_o_orderpriority#8775 AS cval_orders_o_orderpriority_1#8792, cval_orders_o_clerk#8776 AS cval_orders_o_clerk_1#8793, cval_orders_o_shippriority#8777 AS cval_orders_o_shippriority_1#8794, cval_orders_o_comment#8778 AS cval_orders_o_comment_1#8795, cval_orders_o_orderdate#8779 AS cval_orders_o_orderdate_1#8796, co_orderstatus#8780 AS co_orderstatus_1#8797, co_totalprice#8781 AS co_totalprice_1#8798, co_orderpriority#8782 AS co_orderpriority_1#8799, co_clerk#8783 AS co_clerk_1#8800, co_shippriority#8784 AS co_shippriority_1#8801, co_comment#8785 AS co_comment_1#8802, co_orderdate#8786 AS co_orderdate_1#8803]
         :     :  +- Relation[rid#8770,cpfk_customer_orders#8771,cfpk_orders_customer#8772,cval_orders_o_orderstatus#8773,cval_orders_o_totalprice#8774,cval_orders_o_orderpriority#8775,cval_orders_o_clerk#8776,cval_orders_o_shippriority#8777,cval_orders_o_comment#8778,cval_orders_o_orderdate#8779,co_orderstatus#8780,co_totalprice#8781,co_orderpriority#8782,co_clerk#8783,co_shippriority#8784,co_comment#8785,co_orderdate#8786] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#8804 AS rid_2#8837, cpfk_orders_lineitem#8805 AS cpfk_orders_lineitem_2#8838, cpfk_supplier_lineitem#8806 AS cpfk_supplier_lineitem_2#8839, cfpk_lineitem_supplier#8807 AS cfpk_lineitem_supplier_2#8840, cfpk_lineitem_partsupp#8808 AS cfpk_lineitem_partsupp_2#8841, cpfk_part_lineitem#8809 AS cpfk_part_lineitem_2#8842, cfpk_lineitem_part#8810 AS cfpk_lineitem_part_2#8843, cpfk_partsupp_lineitem#8811 AS cpfk_partsupp_lineitem_2#8844, cfpk_lineitem_orders#8812 AS cfpk_lineitem_orders_2#8845, cval_lineitem_l_quantity#8813 AS cval_lineitem_l_quantity_2#8846, cval_lineitem_l_extendedprice#8814 AS cval_lineitem_l_extendedprice_2#8847, cval_lineitem_l_discount#8815 AS cval_lineitem_l_discount_2#8848, cval_lineitem_l_tax#8816 AS cval_lineitem_l_tax_2#8849, cval_lineitem_l_returnflag#8817 AS cval_lineitem_l_returnflag_2#8850, cval_lineitem_l_linestatus#8818 AS cval_lineitem_l_linestatus_2#8851, cval_lineitem_l_commitdate#8819 AS cval_lineitem_l_commitdate_2#8852, cval_lineitem_l_receiptdate#8820 AS cval_lineitem_l_receiptdate_2#8853, cval_lineitem_l_shipinstruct#8821 AS cval_lineitem_l_shipinstruct_2#8854, cval_lineitem_l_shipmode#8822 AS cval_lineitem_l_shipmode_2#8855, cval_lineitem_l_comment#8823 AS cval_lineitem_l_comment_2#8856, cval_lineitem_l_shipdate#8824 AS cval_lineitem_l_shipdate_2#8857, cl_quantity#8825 AS cl_quantity_2#8858, cl_extendedprice#8826 AS cl_extendedprice_2#8859, cl_discount#8827 AS cl_discount_2#8860, ... 9 more fields]
         :        +- Relation[rid#8804,cpfk_orders_lineitem#8805,cpfk_supplier_lineitem#8806,cfpk_lineitem_supplier#8807,cfpk_lineitem_partsupp#8808,cpfk_part_lineitem#8809,cfpk_lineitem_part#8810,cpfk_partsupp_lineitem#8811,cfpk_lineitem_orders#8812,cval_lineitem_l_quantity#8813,cval_lineitem_l_extendedprice#8814,cval_lineitem_l_discount#8815,cval_lineitem_l_tax#8816,cval_lineitem_l_returnflag#8817,cval_lineitem_l_linestatus#8818,cval_lineitem_l_commitdate#8819,cval_lineitem_l_receiptdate#8820,cval_lineitem_l_shipinstruct#8821,cval_lineitem_l_shipmode#8822,cval_lineitem_l_comment#8823,cval_lineitem_l_shipdate#8824,cl_quantity#8825,cl_extendedprice#8826,cl_discount#8827,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8704 AS rid_2#8737, cpfk_orders_lineitem#8705 AS cpfk_orders_lineitem_2#8738, cpfk_supplier_lineitem#8706 AS cpfk_supplier_lineitem_2#8739, cfpk_lineitem_supplier#8707 AS cfpk_lineitem_supplier_2#8740, cfpk_lineitem_partsupp#8708 AS cfpk_lineitem_partsupp_2#8741, cpfk_part_lineitem#8709 AS cpfk_part_lineitem_2#8742, cfpk_lineitem_part#8710 AS cfpk_lineitem_part_2#8743, cpfk_partsupp_lineitem#8711 AS cpfk_partsupp_lineitem_2#8744, cfpk_lineitem_orders#8712 AS cfpk_lineitem_orders_2#8745, cval_lineitem_l_quantity#8713 AS cval_lineitem_l_quantity_2#8746, cval_lineitem_l_extendedprice#8714 AS cval_lineitem_l_extendedprice_2#8747, cval_lineitem_l_discount#8715 AS cval_lineitem_l_discount_2#8748, cval_lineitem_l_tax#8716 AS cval_lineitem_l_tax_2#8749, cval_lineitem_l_returnflag#8717 AS cval_lineitem_l_returnflag_2#8750, cval_lineitem_l_linestatus#8718 AS cval_lineitem_l_linestatus_2#8751, cval_lineitem_l_commitdate#8719 AS cval_lineitem_l_commitdate_2#8752, cval_lineitem_l_receiptdate#8720 AS cval_lineitem_l_receiptdate_2#8753, cval_lineitem_l_shipinstruct#8721 AS cval_lineitem_l_shipinstruct_2#8754, cval_lineitem_l_shipmode#8722 AS cval_lineitem_l_shipmode_2#8755, cval_lineitem_l_comment#8723 AS cval_lineitem_l_comment_2#8756, cval_lineitem_l_shipdate#8724 AS cval_lineitem_l_shipdate_2#8757, cl_quantity#8725 AS cl_quantity_2#8758, cl_extendedprice#8726 AS cl_extendedprice_2#8759, cl_discount#8727 AS cl_discount_2#8760, ... 9 more fields]
            +- Relation[rid#8704,cpfk_orders_lineitem#8705,cpfk_supplier_lineitem#8706,cfpk_lineitem_supplier#8707,cfpk_lineitem_partsupp#8708,cpfk_part_lineitem#8709,cfpk_lineitem_part#8710,cpfk_partsupp_lineitem#8711,cfpk_lineitem_orders#8712,cval_lineitem_l_quantity#8713,cval_lineitem_l_extendedprice#8714,cval_lineitem_l_discount#8715,cval_lineitem_l_tax#8716,cval_lineitem_l_returnflag#8717,cval_lineitem_l_linestatus#8718,cval_lineitem_l_commitdate#8719,cval_lineitem_l_receiptdate#8720,cval_lineitem_l_shipinstruct#8721,cval_lineitem_l_shipmode#8722,cval_lineitem_l_comment#8723,cval_lineitem_l_shipdate#8724,cl_quantity#8725,cl_extendedprice#8726,cl_discount#8727,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 115834ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/11 03:54:15 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 03:54:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8944L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 03:54:15 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:54:15 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:54:15 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:54:15 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:54:15 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 03:54:15 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:54:15 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:54:15 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:54:15 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:54:15 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 03:54:15 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:54:15 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:54:15 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:54:15 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:54:15 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:54:15 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 03:54:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8944L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#8946 AS rid_0#8953, cpfk_region_nation#8947 AS cpfk_region_nation_0#8954, cfpk_nation_region#8948 AS cfpk_nation_region_0#8955, cval_nation_n_name#8949 AS cval_nation_n_name_0#8956, cval_nation_n_comment#8950 AS cval_nation_n_comment_0#8957, cn_name#8951 AS cn_name_0#8958, cn_comment#8952 AS cn_comment_0#8959]
            :  :  :     :  :  :  :  :  +- Relation[rid#8946,cpfk_region_nation#8947,cfpk_nation_region#8948,cval_nation_n_name#8949,cval_nation_n_comment#8950,cn_name#8951,cn_comment#8952] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#8986 AS rid_0#8993, cpfk_region_nation#8987 AS cpfk_region_nation_0#8994, cfpk_nation_region#8988 AS cfpk_nation_region_0#8995, cval_nation_n_name#8989 AS cval_nation_n_name_0#8996, cval_nation_n_comment#8990 AS cval_nation_n_comment_0#8997, cn_name#8991 AS cn_name_0#8998, cn_comment#8992 AS cn_comment_0#8999]
            :  :  :     :  :  :  :     :  +- Relation[rid#8986,cpfk_region_nation#8987,cfpk_nation_region#8988,cval_nation_n_name#8989,cval_nation_n_comment#8990,cn_name#8991,cn_comment#8992] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#9000 AS rid_1#9013, cpfk_nation_supplier#9001 AS cpfk_nation_supplier_1#9014, cfpk_supplier_nation#9002 AS cfpk_supplier_nation_1#9015, cval_supplier_s_name#9003 AS cval_supplier_s_name_1#9016, cval_supplier_s_address#9004 AS cval_supplier_s_address_1#9017, cval_supplier_s_phone#9005 AS cval_supplier_s_phone_1#9018, cval_supplier_s_acctbal#9006 AS cval_supplier_s_acctbal_1#9019, cval_supplier_s_comment#9007 AS cval_supplier_s_comment_1#9020, cs_name#9008 AS cs_name_1#9021, cs_address#9009 AS cs_address_1#9022, cs_phone#9010 AS cs_phone_1#9023, cs_acctbal#9011 AS cs_acctbal_1#9024, cs_comment#9012 AS cs_comment_1#9025]
            :  :  :     :  :  :  :        +- Relation[rid#9000,cpfk_nation_supplier#9001,cfpk_supplier_nation#9002,cval_supplier_s_name#9003,cval_supplier_s_address#9004,cval_supplier_s_phone#9005,cval_supplier_s_acctbal#9006,cval_supplier_s_comment#9007,cs_name#9008,cs_address#9009,cs_phone#9010,cs_acctbal#9011,cs_comment#9012] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#8960 AS rid_1#8973, cpfk_nation_supplier#8961 AS cpfk_nation_supplier_1#8974, cfpk_supplier_nation#8962 AS cfpk_supplier_nation_1#8975, cval_supplier_s_name#8963 AS cval_supplier_s_name_1#8976, cval_supplier_s_address#8964 AS cval_supplier_s_address_1#8977, cval_supplier_s_phone#8965 AS cval_supplier_s_phone_1#8978, cval_supplier_s_acctbal#8966 AS cval_supplier_s_acctbal_1#8979, cval_supplier_s_comment#8967 AS cval_supplier_s_comment_1#8980, cs_name#8968 AS cs_name_1#8981, cs_address#8969 AS cs_address_1#8982, cs_phone#8970 AS cs_phone_1#8983, cs_acctbal#8971 AS cs_acctbal_1#8984, cs_comment#8972 AS cs_comment_1#8985]
            :  :  :     :  :  :     +- Relation[rid#8960,cpfk_nation_supplier#8961,cfpk_supplier_nation#8962,cval_supplier_s_name#8963,cval_supplier_s_address#8964,cval_supplier_s_phone#8965,cval_supplier_s_acctbal#8966,cval_supplier_s_comment#8967,cs_name#8968,cs_address#8969,cs_phone#8970,cs_acctbal#8971,cs_comment#8972] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#9048 AS rid_1#9061, cpfk_nation_supplier#9049 AS cpfk_nation_supplier_1#9062, cfpk_supplier_nation#9050 AS cfpk_supplier_nation_1#9063, cval_supplier_s_name#9051 AS cval_supplier_s_name_1#9064, cval_supplier_s_address#9052 AS cval_supplier_s_address_1#9065, cval_supplier_s_phone#9053 AS cval_supplier_s_phone_1#9066, cval_supplier_s_acctbal#9054 AS cval_supplier_s_acctbal_1#9067, cval_supplier_s_comment#9055 AS cval_supplier_s_comment_1#9068, cs_name#9056 AS cs_name_1#9069, cs_address#9057 AS cs_address_1#9070, cs_phone#9058 AS cs_phone_1#9071, cs_acctbal#9059 AS cs_acctbal_1#9072, cs_comment#9060 AS cs_comment_1#9073]
            :  :  :     :  :     :  +- Relation[rid#9048,cpfk_nation_supplier#9049,cfpk_supplier_nation#9050,cval_supplier_s_name#9051,cval_supplier_s_address#9052,cval_supplier_s_phone#9053,cval_supplier_s_acctbal#9054,cval_supplier_s_comment#9055,cs_name#9056,cs_address#9057,cs_phone#9058,cs_acctbal#9059,cs_comment#9060] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#9074 AS rid_2#9085, cpfk_part_partsupp#9075 AS cpfk_part_partsupp_2#9086, cfpk_partsupp_part#9076 AS cfpk_partsupp_part_2#9087, cpfk_supplier_partsupp#9077 AS cpfk_supplier_partsupp_2#9088, cfpk_partsupp_supplier#9078 AS cfpk_partsupp_supplier_2#9089, cval_partsupp_ps_availqty#9079 AS cval_partsupp_ps_availqty_2#9090, cval_partsupp_ps_supplycost#9080 AS cval_partsupp_ps_supplycost_2#9091, cval_partsupp_ps_comment#9081 AS cval_partsupp_ps_comment_2#9092, cps_availqty#9082 AS cps_availqty_2#9093, cps_supplycost#9083 AS cps_supplycost_2#9094, cps_comment#9084 AS cps_comment_2#9095]
            :  :  :     :  :        +- Relation[rid#9074,cpfk_part_partsupp#9075,cfpk_partsupp_part#9076,cpfk_supplier_partsupp#9077,cfpk_partsupp_supplier#9078,cval_partsupp_ps_availqty#9079,cval_partsupp_ps_supplycost#9080,cval_partsupp_ps_comment#9081,cps_availqty#9082,cps_supplycost#9083,cps_comment#9084] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#9026 AS rid_2#9037, cpfk_part_partsupp#9027 AS cpfk_part_partsupp_2#9038, cfpk_partsupp_part#9028 AS cfpk_partsupp_part_2#9039, cpfk_supplier_partsupp#9029 AS cpfk_supplier_partsupp_2#9040, cfpk_partsupp_supplier#9030 AS cfpk_partsupp_supplier_2#9041, cval_partsupp_ps_availqty#9031 AS cval_partsupp_ps_availqty_2#9042, cval_partsupp_ps_supplycost#9032 AS cval_partsupp_ps_supplycost_2#9043, cval_partsupp_ps_comment#9033 AS cval_partsupp_ps_comment_2#9044, cps_availqty#9034 AS cps_availqty_2#9045, cps_supplycost#9035 AS cps_supplycost_2#9046, cps_comment#9036 AS cps_comment_2#9047]
            :  :  :     :     +- Relation[rid#9026,cpfk_part_partsupp#9027,cfpk_partsupp_part#9028,cpfk_supplier_partsupp#9029,cfpk_partsupp_supplier#9030,cval_partsupp_ps_availqty#9031,cval_partsupp_ps_supplycost#9032,cval_partsupp_ps_comment#9033,cps_availqty#9034,cps_supplycost#9035,cps_comment#9036] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#9096 AS rid_3#9113, cval_part_p_name#9097 AS cval_part_p_name_3#9114, cval_part_p_mfgr#9098 AS cval_part_p_mfgr_3#9115, cval_part_p_type#9099 AS cval_part_p_type_3#9116, cval_part_p_size#9100 AS cval_part_p_size_3#9117, cval_part_p_container#9101 AS cval_part_p_container_3#9118, cval_part_p_retailprice#9102 AS cval_part_p_retailprice_3#9119, cval_part_p_comment#9103 AS cval_part_p_comment_3#9120, cval_part_p_brand#9104 AS cval_part_p_brand_3#9121, cp_name#9105 AS cp_name_3#9122, cp_mfgr#9106 AS cp_mfgr_3#9123, cp_type#9107 AS cp_type_3#9124, cp_size#9108 AS cp_size_3#9125, cp_container#9109 AS cp_container_3#9126, cp_retailprice#9110 AS cp_retailprice_3#9127, cp_comment#9111 AS cp_comment_3#9128, cp_brand#9112 AS cp_brand_3#9129]
            :  :  :        +- Relation[rid#9096,cval_part_p_name#9097,cval_part_p_mfgr#9098,cval_part_p_type#9099,cval_part_p_size#9100,cval_part_p_container#9101,cval_part_p_retailprice#9102,cval_part_p_comment#9103,cval_part_p_brand#9104,cp_name#9105,cp_mfgr#9106,cp_type#9107,cp_size#9108,cp_container#9109,cp_retailprice#9110,cp_comment#9111,cp_brand#9112] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#9196 AS rid_2#9207, cpfk_part_partsupp#9197 AS cpfk_part_partsupp_2#9208, cfpk_partsupp_part#9198 AS cfpk_partsupp_part_2#9209, cpfk_supplier_partsupp#9199 AS cpfk_supplier_partsupp_2#9210, cfpk_partsupp_supplier#9200 AS cfpk_partsupp_supplier_2#9211, cval_partsupp_ps_availqty#9201 AS cval_partsupp_ps_availqty_2#9212, cval_partsupp_ps_supplycost#9202 AS cval_partsupp_ps_supplycost_2#9213, cval_partsupp_ps_comment#9203 AS cval_partsupp_ps_comment_2#9214, cps_availqty#9204 AS cps_availqty_2#9215, cps_supplycost#9205 AS cps_supplycost_2#9216, cps_comment#9206 AS cps_comment_2#9217]
            :  :     :  +- Relation[rid#9196,cpfk_part_partsupp#9197,cfpk_partsupp_part#9198,cpfk_supplier_partsupp#9199,cfpk_partsupp_supplier#9200,cval_partsupp_ps_availqty#9201,cval_partsupp_ps_supplycost#9202,cval_partsupp_ps_comment#9203,cps_availqty#9204,cps_supplycost#9205,cps_comment#9206] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#9218 AS rid_4#9251, cpfk_orders_lineitem#9219 AS cpfk_orders_lineitem_4#9252, cpfk_supplier_lineitem#9220 AS cpfk_supplier_lineitem_4#9253, cfpk_lineitem_supplier#9221 AS cfpk_lineitem_supplier_4#9254, cfpk_lineitem_partsupp#9222 AS cfpk_lineitem_partsupp_4#9255, cpfk_part_lineitem#9223 AS cpfk_part_lineitem_4#9256, cfpk_lineitem_part#9224 AS cfpk_lineitem_part_4#9257, cpfk_partsupp_lineitem#9225 AS cpfk_partsupp_lineitem_4#9258, cfpk_lineitem_orders#9226 AS cfpk_lineitem_orders_4#9259, cval_lineitem_l_quantity#9227 AS cval_lineitem_l_quantity_4#9260, cval_lineitem_l_extendedprice#9228 AS cval_lineitem_l_extendedprice_4#9261, cval_lineitem_l_discount#9229 AS cval_lineitem_l_discount_4#9262, cval_lineitem_l_tax#9230 AS cval_lineitem_l_tax_4#9263, cval_lineitem_l_returnflag#9231 AS cval_lineitem_l_returnflag_4#9264, cval_lineitem_l_linestatus#9232 AS cval_lineitem_l_linestatus_4#9265, cval_lineitem_l_commitdate#9233 AS cval_lineitem_l_commitdate_4#9266, cval_lineitem_l_receiptdate#9234 AS cval_lineitem_l_receiptdate_4#9267, cval_lineitem_l_shipinstruct#9235 AS cval_lineitem_l_shipinstruct_4#9268, cval_lineitem_l_shipmode#9236 AS cval_lineitem_l_shipmode_4#9269, cval_lineitem_l_comment#9237 AS cval_lineitem_l_comment_4#9270, cval_lineitem_l_shipdate#9238 AS cval_lineitem_l_shipdate_4#9271, cl_quantity#9239 AS cl_quantity_4#9272, cl_extendedprice#9240 AS cl_extendedprice_4#9273, cl_discount#9241 AS cl_discount_4#9274, ... 9 more fields]
            :  :        +- Relation[rid#9218,cpfk_orders_lineitem#9219,cpfk_supplier_lineitem#9220,cfpk_lineitem_supplier#9221,cfpk_lineitem_partsupp#9222,cpfk_part_lineitem#9223,cfpk_lineitem_part#9224,cpfk_partsupp_lineitem#9225,cfpk_lineitem_orders#9226,cval_lineitem_l_quantity#9227,cval_lineitem_l_extendedprice#9228,cval_lineitem_l_discount#9229,cval_lineitem_l_tax#9230,cval_lineitem_l_returnflag#9231,cval_lineitem_l_linestatus#9232,cval_lineitem_l_commitdate#9233,cval_lineitem_l_receiptdate#9234,cval_lineitem_l_shipinstruct#9235,cval_lineitem_l_shipmode#9236,cval_lineitem_l_comment#9237,cval_lineitem_l_shipdate#9238,cl_quantity#9239,cl_extendedprice#9240,cl_discount#9241,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#9130 AS rid_4#9163, cpfk_orders_lineitem#9131 AS cpfk_orders_lineitem_4#9164, cpfk_supplier_lineitem#9132 AS cpfk_supplier_lineitem_4#9165, cfpk_lineitem_supplier#9133 AS cfpk_lineitem_supplier_4#9166, cfpk_lineitem_partsupp#9134 AS cfpk_lineitem_partsupp_4#9167, cpfk_part_lineitem#9135 AS cpfk_part_lineitem_4#9168, cfpk_lineitem_part#9136 AS cfpk_lineitem_part_4#9169, cpfk_partsupp_lineitem#9137 AS cpfk_partsupp_lineitem_4#9170, cfpk_lineitem_orders#9138 AS cfpk_lineitem_orders_4#9171, cval_lineitem_l_quantity#9139 AS cval_lineitem_l_quantity_4#9172, cval_lineitem_l_extendedprice#9140 AS cval_lineitem_l_extendedprice_4#9173, cval_lineitem_l_discount#9141 AS cval_lineitem_l_discount_4#9174, cval_lineitem_l_tax#9142 AS cval_lineitem_l_tax_4#9175, cval_lineitem_l_returnflag#9143 AS cval_lineitem_l_returnflag_4#9176, cval_lineitem_l_linestatus#9144 AS cval_lineitem_l_linestatus_4#9177, cval_lineitem_l_commitdate#9145 AS cval_lineitem_l_commitdate_4#9178, cval_lineitem_l_receiptdate#9146 AS cval_lineitem_l_receiptdate_4#9179, cval_lineitem_l_shipinstruct#9147 AS cval_lineitem_l_shipinstruct_4#9180, cval_lineitem_l_shipmode#9148 AS cval_lineitem_l_shipmode_4#9181, cval_lineitem_l_comment#9149 AS cval_lineitem_l_comment_4#9182, cval_lineitem_l_shipdate#9150 AS cval_lineitem_l_shipdate_4#9183, cl_quantity#9151 AS cl_quantity_4#9184, cl_extendedprice#9152 AS cl_extendedprice_4#9185, cl_discount#9153 AS cl_discount_4#9186, ... 9 more fields]
            :     +- Relation[rid#9130,cpfk_orders_lineitem#9131,cpfk_supplier_lineitem#9132,cfpk_lineitem_supplier#9133,cfpk_lineitem_partsupp#9134,cpfk_part_lineitem#9135,cfpk_lineitem_part#9136,cpfk_partsupp_lineitem#9137,cfpk_lineitem_orders#9138,cval_lineitem_l_quantity#9139,cval_lineitem_l_extendedprice#9140,cval_lineitem_l_discount#9141,cval_lineitem_l_tax#9142,cval_lineitem_l_returnflag#9143,cval_lineitem_l_linestatus#9144,cval_lineitem_l_commitdate#9145,cval_lineitem_l_receiptdate#9146,cval_lineitem_l_shipinstruct#9147,cval_lineitem_l_shipmode#9148,cval_lineitem_l_comment#9149,cval_lineitem_l_shipdate#9150,cl_quantity#9151,cl_extendedprice#9152,cl_discount#9153,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#9284 AS rid_5#9301, cpfk_customer_orders#9285 AS cpfk_customer_orders_5#9302, cfpk_orders_customer#9286 AS cfpk_orders_customer_5#9303, cval_orders_o_orderstatus#9287 AS cval_orders_o_orderstatus_5#9304, cval_orders_o_totalprice#9288 AS cval_orders_o_totalprice_5#9305, cval_orders_o_orderpriority#9289 AS cval_orders_o_orderpriority_5#9306, cval_orders_o_clerk#9290 AS cval_orders_o_clerk_5#9307, cval_orders_o_shippriority#9291 AS cval_orders_o_shippriority_5#9308, cval_orders_o_comment#9292 AS cval_orders_o_comment_5#9309, cval_orders_o_orderdate#9293 AS cval_orders_o_orderdate_5#9310, co_orderstatus#9294 AS co_orderstatus_5#9311, co_totalprice#9295 AS co_totalprice_5#9312, co_orderpriority#9296 AS co_orderpriority_5#9313, co_clerk#9297 AS co_clerk_5#9314, co_shippriority#9298 AS co_shippriority_5#9315, co_comment#9299 AS co_comment_5#9316, co_orderdate#9300 AS co_orderdate_5#9317]
               +- Relation[rid#9284,cpfk_customer_orders#9285,cfpk_orders_customer#9286,cval_orders_o_orderstatus#9287,cval_orders_o_totalprice#9288,cval_orders_o_orderpriority#9289,cval_orders_o_clerk#9290,cval_orders_o_shippriority#9291,cval_orders_o_comment#9292,cval_orders_o_orderdate#9293,co_orderstatus#9294,co_totalprice#9295,co_orderpriority#9296,co_clerk#9297,co_shippriority#9298,co_comment#9299,co_orderdate#9300] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 162571ms
query=q1, count=6001215, duration=4735
query=q10, count=1478870, duration=60192
query=q11, count=31680, duration=10506
query=q12, count=857401, duration=21675
query=q13, count=1500000, duration=13328
query=q14, count=6001215, duration=82242
query=q15, count=6001215, duration=78335
query=q16, count=15780, duration=11078
query=q17, count=6088, duration=71282
query=q18, count=6001215, duration=118744
query=q19, count=205, duration=361897
query=q2, count=3162, duration=20286
query=q20, count=632, duration=11463
query=q21a, count=597422, duration=245290
query=q22, count=1500000, duration=13017
query=q3, count=1214743, duration=115834
query=q4, count=6001215, duration=52681
query=q5, count=1206514, duration=164676
query=q6, count=6001215, duration=3361
query=q7, count=9735, duration=103223
query=q8, count=8716, duration=94933
query=q9a, count=6001215, duration=242237
query=q9b, count=6001215, duration=162571
