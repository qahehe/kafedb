20/04/11 07:25:44 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 11790ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Apr 11 07:25:47 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Apr 11 07:25:49 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Apr 11 07:25:49 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Apr 11 07:25:49 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Apr 11 07:25:49 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Apr 11 07:25:54 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Apr 11 07:25:57 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Apr 11 07:25:58 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/11 07:25:59 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:25:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2102L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 07:26:00 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/11 07:26:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2102L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#2104 AS rid_0#2137, cpfk_orders_lineitem#2105 AS cpfk_orders_lineitem_0#2138, cpfk_supplier_lineitem#2106 AS cpfk_supplier_lineitem_0#2139, cfpk_lineitem_supplier#2107 AS cfpk_lineitem_supplier_0#2140, cfpk_lineitem_partsupp#2108 AS cfpk_lineitem_partsupp_0#2141, cpfk_part_lineitem#2109 AS cpfk_part_lineitem_0#2142, cfpk_lineitem_part#2110 AS cfpk_lineitem_part_0#2143, cpfk_partsupp_lineitem#2111 AS cpfk_partsupp_lineitem_0#2144, cfpk_lineitem_orders#2112 AS cfpk_lineitem_orders_0#2145, cval_lineitem_l_quantity#2113 AS cval_lineitem_l_quantity_0#2146, cval_lineitem_l_extendedprice#2114 AS cval_lineitem_l_extendedprice_0#2147, cval_lineitem_l_discount#2115 AS cval_lineitem_l_discount_0#2148, cval_lineitem_l_tax#2116 AS cval_lineitem_l_tax_0#2149, cval_lineitem_l_returnflag#2117 AS cval_lineitem_l_returnflag_0#2150, cval_lineitem_l_linestatus#2118 AS cval_lineitem_l_linestatus_0#2151, cval_lineitem_l_commitdate#2119 AS cval_lineitem_l_commitdate_0#2152, cval_lineitem_l_receiptdate#2120 AS cval_lineitem_l_receiptdate_0#2153, cval_lineitem_l_shipinstruct#2121 AS cval_lineitem_l_shipinstruct_0#2154, cval_lineitem_l_shipmode#2122 AS cval_lineitem_l_shipmode_0#2155, cval_lineitem_l_comment#2123 AS cval_lineitem_l_comment_0#2156, cval_lineitem_l_shipdate#2124 AS cval_lineitem_l_shipdate_0#2157, cl_quantity#2125 AS cl_quantity_0#2158, cl_extendedprice#2126 AS cl_extendedprice_0#2159, cl_discount#2127 AS cl_discount_0#2160, ... 9 more fields]
            :  +- Relation[rid#2104,cpfk_orders_lineitem#2105,cpfk_supplier_lineitem#2106,cfpk_lineitem_supplier#2107,cfpk_lineitem_partsupp#2108,cpfk_part_lineitem#2109,cfpk_lineitem_part#2110,cpfk_partsupp_lineitem#2111,cfpk_lineitem_orders#2112,cval_lineitem_l_quantity#2113,cval_lineitem_l_extendedprice#2114,cval_lineitem_l_discount#2115,cval_lineitem_l_tax#2116,cval_lineitem_l_returnflag#2117,cval_lineitem_l_linestatus#2118,cval_lineitem_l_commitdate#2119,cval_lineitem_l_receiptdate#2120,cval_lineitem_l_shipinstruct#2121,cval_lineitem_l_shipmode#2122,cval_lineitem_l_comment#2123,cval_lineitem_l_shipdate#2124,cl_quantity#2125,cl_extendedprice#2126,cl_discount#2127,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#2170 AS rid_1#2187, cpfk_customer_orders#2171 AS cpfk_customer_orders_1#2188, cfpk_orders_customer#2172 AS cfpk_orders_customer_1#2189, cval_orders_o_orderstatus#2173 AS cval_orders_o_orderstatus_1#2190, cval_orders_o_totalprice#2174 AS cval_orders_o_totalprice_1#2191, cval_orders_o_orderpriority#2175 AS cval_orders_o_orderpriority_1#2192, cval_orders_o_clerk#2176 AS cval_orders_o_clerk_1#2193, cval_orders_o_shippriority#2177 AS cval_orders_o_shippriority_1#2194, cval_orders_o_comment#2178 AS cval_orders_o_comment_1#2195, cval_orders_o_orderdate#2179 AS cval_orders_o_orderdate_1#2196, co_orderstatus#2180 AS co_orderstatus_1#2197, co_totalprice#2181 AS co_totalprice_1#2198, co_orderpriority#2182 AS co_orderpriority_1#2199, co_clerk#2183 AS co_clerk_1#2200, co_shippriority#2184 AS co_shippriority_1#2201, co_comment#2185 AS co_comment_1#2202, co_orderdate#2186 AS co_orderdate_1#2203]
               +- Relation[rid#2170,cpfk_customer_orders#2171,cfpk_orders_customer#2172,cval_orders_o_orderstatus#2173,cval_orders_o_totalprice#2174,cval_orders_o_orderpriority#2175,cval_orders_o_clerk#2176,cval_orders_o_shippriority#2177,cval_orders_o_comment#2178,cval_orders_o_orderdate#2179,co_orderstatus#2180,co_totalprice#2181,co_orderpriority#2182,co_clerk#2183,co_shippriority#2184,co_comment#2185,co_orderdate#2186] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 53106ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/11 07:26:52 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:26:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2262L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 07:26:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:26:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:26:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:26:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:26:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:26:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:26:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:26:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:26:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:26:52 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:26:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:26:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:26:52 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:26:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:26:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:26:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2262L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_2))
            :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :  :  :- Project [rid#2264 AS rid_0#2271, cpfk_region_nation#2265 AS cpfk_region_nation_0#2272, cfpk_nation_region#2266 AS cfpk_nation_region_0#2273, cval_nation_n_name#2267 AS cval_nation_n_name_0#2274, cval_nation_n_comment#2268 AS cval_nation_n_comment_0#2275, cn_name#2269 AS cn_name_0#2276, cn_comment#2270 AS cn_comment_0#2277]
            :  :  :  :  :  :  +- Relation[rid#2264,cpfk_region_nation#2265,cfpk_nation_region#2266,cval_nation_n_name#2267,cval_nation_n_comment#2268,cn_name#2269,cn_comment#2270] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
            :  :  :  :  :     +- Project [rid#2278 AS rid_0#2285, cpfk_region_nation#2279 AS cpfk_region_nation_0#2286, cfpk_nation_region#2280 AS cfpk_nation_region_0#2287, cval_nation_n_name#2281 AS cval_nation_n_name_0#2288, cval_nation_n_comment#2282 AS cval_nation_n_comment_0#2289, cn_name#2283 AS cn_name_0#2290, cn_comment#2284 AS cn_comment_0#2291]
            :  :  :  :  :        +- Relation[rid#2278,cpfk_region_nation#2279,cfpk_nation_region#2280,cval_nation_n_name#2281,cval_nation_n_comment#2282,cn_name#2283,cn_comment#2284] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :  :     :- Project [rid#2318 AS rid_0#2325, cpfk_region_nation#2319 AS cpfk_region_nation_0#2326, cfpk_nation_region#2320 AS cfpk_nation_region_0#2327, cval_nation_n_name#2321 AS cval_nation_n_name_0#2328, cval_nation_n_comment#2322 AS cval_nation_n_comment_0#2329, cn_name#2323 AS cn_name_0#2330, cn_comment#2324 AS cn_comment_0#2331]
            :  :  :  :     :  +- Relation[rid#2318,cpfk_region_nation#2319,cfpk_nation_region#2320,cval_nation_n_name#2321,cval_nation_n_comment#2322,cn_name#2323,cn_comment#2324] JDBCRelation(tnation) [numPartitions=1]
            :  :  :  :     +- Project [rid#2332 AS rid_1#2345, cpfk_nation_supplier#2333 AS cpfk_nation_supplier_1#2346, cfpk_supplier_nation#2334 AS cfpk_supplier_nation_1#2347, cval_supplier_s_name#2335 AS cval_supplier_s_name_1#2348, cval_supplier_s_address#2336 AS cval_supplier_s_address_1#2349, cval_supplier_s_phone#2337 AS cval_supplier_s_phone_1#2350, cval_supplier_s_acctbal#2338 AS cval_supplier_s_acctbal_1#2351, cval_supplier_s_comment#2339 AS cval_supplier_s_comment_1#2352, cs_name#2340 AS cs_name_1#2353, cs_address#2341 AS cs_address_1#2354, cs_phone#2342 AS cs_phone_1#2355, cs_acctbal#2343 AS cs_acctbal_1#2356, cs_comment#2344 AS cs_comment_1#2357]
            :  :  :  :        +- Relation[rid#2332,cpfk_nation_supplier#2333,cfpk_supplier_nation#2334,cval_supplier_s_name#2335,cval_supplier_s_address#2336,cval_supplier_s_phone#2337,cval_supplier_s_acctbal#2338,cval_supplier_s_comment#2339,cs_name#2340,cs_address#2341,cs_phone#2342,cs_acctbal#2343,cs_comment#2344] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :  +- Project [rid#2292 AS rid_1#2305, cpfk_nation_supplier#2293 AS cpfk_nation_supplier_1#2306, cfpk_supplier_nation#2294 AS cfpk_supplier_nation_1#2307, cval_supplier_s_name#2295 AS cval_supplier_s_name_1#2308, cval_supplier_s_address#2296 AS cval_supplier_s_address_1#2309, cval_supplier_s_phone#2297 AS cval_supplier_s_phone_1#2310, cval_supplier_s_acctbal#2298 AS cval_supplier_s_acctbal_1#2311, cval_supplier_s_comment#2299 AS cval_supplier_s_comment_1#2312, cs_name#2300 AS cs_name_1#2313, cs_address#2301 AS cs_address_1#2314, cs_phone#2302 AS cs_phone_1#2315, cs_acctbal#2303 AS cs_acctbal_1#2316, cs_comment#2304 AS cs_comment_1#2317]
            :  :  :     +- Relation[rid#2292,cpfk_nation_supplier#2293,cfpk_supplier_nation#2294,cval_supplier_s_name#2295,cval_supplier_s_address#2296,cval_supplier_s_phone#2297,cval_supplier_s_acctbal#2298,cval_supplier_s_comment#2299,cs_name#2300,cs_address#2301,cs_phone#2302,cs_acctbal#2303,cs_comment#2304] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :  :     :- Project [rid#2424 AS rid_1#2437, cpfk_nation_supplier#2425 AS cpfk_nation_supplier_1#2438, cfpk_supplier_nation#2426 AS cfpk_supplier_nation_1#2439, cval_supplier_s_name#2427 AS cval_supplier_s_name_1#2440, cval_supplier_s_address#2428 AS cval_supplier_s_address_1#2441, cval_supplier_s_phone#2429 AS cval_supplier_s_phone_1#2442, cval_supplier_s_acctbal#2430 AS cval_supplier_s_acctbal_1#2443, cval_supplier_s_comment#2431 AS cval_supplier_s_comment_1#2444, cs_name#2432 AS cs_name_1#2445, cs_address#2433 AS cs_address_1#2446, cs_phone#2434 AS cs_phone_1#2447, cs_acctbal#2435 AS cs_acctbal_1#2448, cs_comment#2436 AS cs_comment_1#2449]
            :  :     :  +- Relation[rid#2424,cpfk_nation_supplier#2425,cfpk_supplier_nation#2426,cval_supplier_s_name#2427,cval_supplier_s_address#2428,cval_supplier_s_phone#2429,cval_supplier_s_acctbal#2430,cval_supplier_s_comment#2431,cs_name#2432,cs_address#2433,cs_phone#2434,cs_acctbal#2435,cs_comment#2436] JDBCRelation(tsupplier) [numPartitions=1]
            :  :     +- Project [rid#2450 AS rid_2#2483, cpfk_orders_lineitem#2451 AS cpfk_orders_lineitem_2#2484, cpfk_supplier_lineitem#2452 AS cpfk_supplier_lineitem_2#2485, cfpk_lineitem_supplier#2453 AS cfpk_lineitem_supplier_2#2486, cfpk_lineitem_partsupp#2454 AS cfpk_lineitem_partsupp_2#2487, cpfk_part_lineitem#2455 AS cpfk_part_lineitem_2#2488, cfpk_lineitem_part#2456 AS cfpk_lineitem_part_2#2489, cpfk_partsupp_lineitem#2457 AS cpfk_partsupp_lineitem_2#2490, cfpk_lineitem_orders#2458 AS cfpk_lineitem_orders_2#2491, cval_lineitem_l_quantity#2459 AS cval_lineitem_l_quantity_2#2492, cval_lineitem_l_extendedprice#2460 AS cval_lineitem_l_extendedprice_2#2493, cval_lineitem_l_discount#2461 AS cval_lineitem_l_discount_2#2494, cval_lineitem_l_tax#2462 AS cval_lineitem_l_tax_2#2495, cval_lineitem_l_returnflag#2463 AS cval_lineitem_l_returnflag_2#2496, cval_lineitem_l_linestatus#2464 AS cval_lineitem_l_linestatus_2#2497, cval_lineitem_l_commitdate#2465 AS cval_lineitem_l_commitdate_2#2498, cval_lineitem_l_receiptdate#2466 AS cval_lineitem_l_receiptdate_2#2499, cval_lineitem_l_shipinstruct#2467 AS cval_lineitem_l_shipinstruct_2#2500, cval_lineitem_l_shipmode#2468 AS cval_lineitem_l_shipmode_2#2501, cval_lineitem_l_comment#2469 AS cval_lineitem_l_comment_2#2502, cval_lineitem_l_shipdate#2470 AS cval_lineitem_l_shipdate_2#2503, cl_quantity#2471 AS cl_quantity_2#2504, cl_extendedprice#2472 AS cl_extendedprice_2#2505, cl_discount#2473 AS cl_discount_2#2506, ... 9 more fields]
            :  :        +- Relation[rid#2450,cpfk_orders_lineitem#2451,cpfk_supplier_lineitem#2452,cfpk_lineitem_supplier#2453,cfpk_lineitem_partsupp#2454,cpfk_part_lineitem#2455,cfpk_lineitem_part#2456,cpfk_partsupp_lineitem#2457,cfpk_lineitem_orders#2458,cval_lineitem_l_quantity#2459,cval_lineitem_l_extendedprice#2460,cval_lineitem_l_discount#2461,cval_lineitem_l_tax#2462,cval_lineitem_l_returnflag#2463,cval_lineitem_l_linestatus#2464,cval_lineitem_l_commitdate#2465,cval_lineitem_l_receiptdate#2466,cval_lineitem_l_shipinstruct#2467,cval_lineitem_l_shipmode#2468,cval_lineitem_l_comment#2469,cval_lineitem_l_shipdate#2470,cl_quantity#2471,cl_extendedprice#2472,cl_discount#2473,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#2358 AS rid_2#2391, cpfk_orders_lineitem#2359 AS cpfk_orders_lineitem_2#2392, cpfk_supplier_lineitem#2360 AS cpfk_supplier_lineitem_2#2393, cfpk_lineitem_supplier#2361 AS cfpk_lineitem_supplier_2#2394, cfpk_lineitem_partsupp#2362 AS cfpk_lineitem_partsupp_2#2395, cpfk_part_lineitem#2363 AS cpfk_part_lineitem_2#2396, cfpk_lineitem_part#2364 AS cfpk_lineitem_part_2#2397, cpfk_partsupp_lineitem#2365 AS cpfk_partsupp_lineitem_2#2398, cfpk_lineitem_orders#2366 AS cfpk_lineitem_orders_2#2399, cval_lineitem_l_quantity#2367 AS cval_lineitem_l_quantity_2#2400, cval_lineitem_l_extendedprice#2368 AS cval_lineitem_l_extendedprice_2#2401, cval_lineitem_l_discount#2369 AS cval_lineitem_l_discount_2#2402, cval_lineitem_l_tax#2370 AS cval_lineitem_l_tax_2#2403, cval_lineitem_l_returnflag#2371 AS cval_lineitem_l_returnflag_2#2404, cval_lineitem_l_linestatus#2372 AS cval_lineitem_l_linestatus_2#2405, cval_lineitem_l_commitdate#2373 AS cval_lineitem_l_commitdate_2#2406, cval_lineitem_l_receiptdate#2374 AS cval_lineitem_l_receiptdate_2#2407, cval_lineitem_l_shipinstruct#2375 AS cval_lineitem_l_shipinstruct_2#2408, cval_lineitem_l_shipmode#2376 AS cval_lineitem_l_shipmode_2#2409, cval_lineitem_l_comment#2377 AS cval_lineitem_l_comment_2#2410, cval_lineitem_l_shipdate#2378 AS cval_lineitem_l_shipdate_2#2411, cl_quantity#2379 AS cl_quantity_2#2412, cl_extendedprice#2380 AS cl_extendedprice_2#2413, cl_discount#2381 AS cl_discount_2#2414, ... 9 more fields]
            :     +- Relation[rid#2358,cpfk_orders_lineitem#2359,cpfk_supplier_lineitem#2360,cfpk_lineitem_supplier#2361,cfpk_lineitem_partsupp#2362,cpfk_part_lineitem#2363,cfpk_lineitem_part#2364,cpfk_partsupp_lineitem#2365,cfpk_lineitem_orders#2366,cval_lineitem_l_quantity#2367,cval_lineitem_l_extendedprice#2368,cval_lineitem_l_discount#2369,cval_lineitem_l_tax#2370,cval_lineitem_l_returnflag#2371,cval_lineitem_l_linestatus#2372,cval_lineitem_l_commitdate#2373,cval_lineitem_l_receiptdate#2374,cval_lineitem_l_shipinstruct#2375,cval_lineitem_l_shipmode#2376,cval_lineitem_l_comment#2377,cval_lineitem_l_shipdate#2378,cl_quantity#2379,cl_extendedprice#2380,cl_discount#2381,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_5))
               :- 'Join UsingJoin(Inner,List(rid_4))
               :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :- 'Join UsingJoin(Inner,List(rid_3))
               :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
               :  :  :  :  :- Project [rid#2516 AS rid_3#2523, cpfk_region_nation#2517 AS cpfk_region_nation_3#2524, cfpk_nation_region#2518 AS cfpk_nation_region_3#2525, cval_nation_n_name#2519 AS cval_nation_n_name_3#2526, cval_nation_n_comment#2520 AS cval_nation_n_comment_3#2527, cn_name#2521 AS cn_name_3#2528, cn_comment#2522 AS cn_comment_3#2529]
               :  :  :  :  :  +- Relation[rid#2516,cpfk_region_nation#2517,cfpk_nation_region#2518,cval_nation_n_name#2519,cval_nation_n_comment#2520,cn_name#2521,cn_comment#2522] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation, 'rid_3
               :  :  :  :     +- Project [rid#2530 AS rid_3#2537, cpfk_region_nation#2531 AS cpfk_region_nation_3#2538, cfpk_nation_region#2532 AS cfpk_nation_region_3#2539, cval_nation_n_name#2533 AS cval_nation_n_name_3#2540, cval_nation_n_comment#2534 AS cval_nation_n_comment_3#2541, cn_name#2535 AS cn_name_3#2542, cn_comment#2536 AS cn_comment_3#2543]
               :  :  :  :        +- Relation[rid#2530,cpfk_region_nation#2531,cfpk_nation_region#2532,cval_nation_n_name#2533,cval_nation_n_comment#2534,cn_name#2535,cn_comment#2536] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_4, tnation, 'rid_3, tcustomer, 'rid_4
               :  :  :     :- Project [rid#2574 AS rid_3#2581, cpfk_region_nation#2575 AS cpfk_region_nation_3#2582, cfpk_nation_region#2576 AS cfpk_nation_region_3#2583, cval_nation_n_name#2577 AS cval_nation_n_name_3#2584, cval_nation_n_comment#2578 AS cval_nation_n_comment_3#2585, cn_name#2579 AS cn_name_3#2586, cn_comment#2580 AS cn_comment_3#2587]
               :  :  :     :  +- Relation[rid#2574,cpfk_region_nation#2575,cfpk_nation_region#2576,cval_nation_n_name#2577,cval_nation_n_comment#2578,cn_name#2579,cn_comment#2580] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#2588 AS rid_4#2603, cpfk_nation_customer#2589 AS cpfk_nation_customer_4#2604, cfpk_customer_nation#2590 AS cfpk_customer_nation_4#2605, cval_customer_c_name#2591 AS cval_customer_c_name_4#2606, cval_customer_c_address#2592 AS cval_customer_c_address_4#2607, cval_customer_c_phone#2593 AS cval_customer_c_phone_4#2608, cval_customer_c_acctbal#2594 AS cval_customer_c_acctbal_4#2609, cval_customer_c_comment#2595 AS cval_customer_c_comment_4#2610, cval_customer_c_mktsegment#2596 AS cval_customer_c_mktsegment_4#2611, cc_name#2597 AS cc_name_4#2612, cc_address#2598 AS cc_address_4#2613, cc_phone#2599 AS cc_phone_4#2614, cc_acctbal#2600 AS cc_acctbal_4#2615, cc_comment#2601 AS cc_comment_4#2616, cc_mktsegment#2602 AS cc_mktsegment_4#2617]
               :  :  :        +- Relation[rid#2588,cpfk_nation_customer#2589,cfpk_customer_nation#2590,cval_customer_c_name#2591,cval_customer_c_address#2592,cval_customer_c_phone#2593,cval_customer_c_acctbal#2594,cval_customer_c_comment#2595,cval_customer_c_mktsegment#2596,cc_name#2597,cc_address#2598,cc_phone#2599,cc_acctbal#2600,cc_comment#2601,cc_mktsegment#2602] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#2544 AS rid_4#2559, cpfk_nation_customer#2545 AS cpfk_nation_customer_4#2560, cfpk_customer_nation#2546 AS cfpk_customer_nation_4#2561, cval_customer_c_name#2547 AS cval_customer_c_name_4#2562, cval_customer_c_address#2548 AS cval_customer_c_address_4#2563, cval_customer_c_phone#2549 AS cval_customer_c_phone_4#2564, cval_customer_c_acctbal#2550 AS cval_customer_c_acctbal_4#2565, cval_customer_c_comment#2551 AS cval_customer_c_comment_4#2566, cval_customer_c_mktsegment#2552 AS cval_customer_c_mktsegment_4#2567, cc_name#2553 AS cc_name_4#2568, cc_address#2554 AS cc_address_4#2569, cc_phone#2555 AS cc_phone_4#2570, cc_acctbal#2556 AS cc_acctbal_4#2571, cc_comment#2557 AS cc_comment_4#2572, cc_mktsegment#2558 AS cc_mktsegment_4#2573]
               :  :     +- Relation[rid#2544,cpfk_nation_customer#2545,cfpk_customer_nation#2546,cval_customer_c_name#2547,cval_customer_c_address#2548,cval_customer_c_phone#2549,cval_customer_c_acctbal#2550,cval_customer_c_comment#2551,cval_customer_c_mktsegment#2552,cc_name#2553,cc_address#2554,cc_phone#2555,cc_acctbal#2556,cc_comment#2557,cc_mktsegment#2558] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_5, tcustomer, 'rid_4, torders, 'rid_5
               :     :- Project [rid#2652 AS rid_4#2667, cpfk_nation_customer#2653 AS cpfk_nation_customer_4#2668, cfpk_customer_nation#2654 AS cfpk_customer_nation_4#2669, cval_customer_c_name#2655 AS cval_customer_c_name_4#2670, cval_customer_c_address#2656 AS cval_customer_c_address_4#2671, cval_customer_c_phone#2657 AS cval_customer_c_phone_4#2672, cval_customer_c_acctbal#2658 AS cval_customer_c_acctbal_4#2673, cval_customer_c_comment#2659 AS cval_customer_c_comment_4#2674, cval_customer_c_mktsegment#2660 AS cval_customer_c_mktsegment_4#2675, cc_name#2661 AS cc_name_4#2676, cc_address#2662 AS cc_address_4#2677, cc_phone#2663 AS cc_phone_4#2678, cc_acctbal#2664 AS cc_acctbal_4#2679, cc_comment#2665 AS cc_comment_4#2680, cc_mktsegment#2666 AS cc_mktsegment_4#2681]
               :     :  +- Relation[rid#2652,cpfk_nation_customer#2653,cfpk_customer_nation#2654,cval_customer_c_name#2655,cval_customer_c_address#2656,cval_customer_c_phone#2657,cval_customer_c_acctbal#2658,cval_customer_c_comment#2659,cval_customer_c_mktsegment#2660,cc_name#2661,cc_address#2662,cc_phone#2663,cc_acctbal#2664,cc_comment#2665,cc_mktsegment#2666] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#2682 AS rid_5#2699, cpfk_customer_orders#2683 AS cpfk_customer_orders_5#2700, cfpk_orders_customer#2684 AS cfpk_orders_customer_5#2701, cval_orders_o_orderstatus#2685 AS cval_orders_o_orderstatus_5#2702, cval_orders_o_totalprice#2686 AS cval_orders_o_totalprice_5#2703, cval_orders_o_orderpriority#2687 AS cval_orders_o_orderpriority_5#2704, cval_orders_o_clerk#2688 AS cval_orders_o_clerk_5#2705, cval_orders_o_shippriority#2689 AS cval_orders_o_shippriority_5#2706, cval_orders_o_comment#2690 AS cval_orders_o_comment_5#2707, cval_orders_o_orderdate#2691 AS cval_orders_o_orderdate_5#2708, co_orderstatus#2692 AS co_orderstatus_5#2709, co_totalprice#2693 AS co_totalprice_5#2710, co_orderpriority#2694 AS co_orderpriority_5#2711, co_clerk#2695 AS co_clerk_5#2712, co_shippriority#2696 AS co_shippriority_5#2713, co_comment#2697 AS co_comment_5#2714, co_orderdate#2698 AS co_orderdate_5#2715]
               :        +- Relation[rid#2682,cpfk_customer_orders#2683,cfpk_orders_customer#2684,cval_orders_o_orderstatus#2685,cval_orders_o_totalprice#2686,cval_orders_o_orderpriority#2687,cval_orders_o_clerk#2688,cval_orders_o_shippriority#2689,cval_orders_o_comment#2690,cval_orders_o_orderdate#2691,co_orderstatus#2692,co_totalprice#2693,co_orderpriority#2694,co_clerk#2695,co_shippriority#2696,co_comment#2697,co_orderdate#2698] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#2618 AS rid_5#2635, cpfk_customer_orders#2619 AS cpfk_customer_orders_5#2636, cfpk_orders_customer#2620 AS cfpk_orders_customer_5#2637, cval_orders_o_orderstatus#2621 AS cval_orders_o_orderstatus_5#2638, cval_orders_o_totalprice#2622 AS cval_orders_o_totalprice_5#2639, cval_orders_o_orderpriority#2623 AS cval_orders_o_orderpriority_5#2640, cval_orders_o_clerk#2624 AS cval_orders_o_clerk_5#2641, cval_orders_o_shippriority#2625 AS cval_orders_o_shippriority_5#2642, cval_orders_o_comment#2626 AS cval_orders_o_comment_5#2643, cval_orders_o_orderdate#2627 AS cval_orders_o_orderdate_5#2644, co_orderstatus#2628 AS co_orderstatus_5#2645, co_totalprice#2629 AS co_totalprice_5#2646, co_orderpriority#2630 AS co_orderpriority_5#2647, co_clerk#2631 AS co_clerk_5#2648, co_shippriority#2632 AS co_shippriority_5#2649, co_comment#2633 AS co_comment_5#2650, co_orderdate#2634 AS co_orderdate_5#2651]
                  +- Relation[rid#2618,cpfk_customer_orders#2619,cfpk_orders_customer#2620,cval_orders_o_orderstatus#2621,cval_orders_o_totalprice#2622,cval_orders_o_orderpriority#2623,cval_orders_o_clerk#2624,cval_orders_o_shippriority#2625,cval_orders_o_comment#2626,cval_orders_o_orderdate#2627,co_orderstatus#2628,co_totalprice#2629,co_orderpriority#2630,co_clerk#2631,co_shippriority#2632,co_comment#2633,co_orderdate#2634] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 103093ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/11 07:28:35 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:28:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2812L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/11 07:28:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2812L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#2814 AS rid_0#2831, cpfk_customer_orders#2815 AS cpfk_customer_orders_0#2832, cfpk_orders_customer#2816 AS cfpk_orders_customer_0#2833, cval_orders_o_orderstatus#2817 AS cval_orders_o_orderstatus_0#2834, cval_orders_o_totalprice#2818 AS cval_orders_o_totalprice_0#2835, cval_orders_o_orderpriority#2819 AS cval_orders_o_orderpriority_0#2836, cval_orders_o_clerk#2820 AS cval_orders_o_clerk_0#2837, cval_orders_o_shippriority#2821 AS cval_orders_o_shippriority_0#2838, cval_orders_o_comment#2822 AS cval_orders_o_comment_0#2839, cval_orders_o_orderdate#2823 AS cval_orders_o_orderdate_0#2840, co_orderstatus#2824 AS co_orderstatus_0#2841, co_totalprice#2825 AS co_totalprice_0#2842, co_orderpriority#2826 AS co_orderpriority_0#2843, co_clerk#2827 AS co_clerk_0#2844, co_shippriority#2828 AS co_shippriority_0#2845, co_comment#2829 AS co_comment_0#2846, co_orderdate#2830 AS co_orderdate_0#2847]
            :  +- Relation[rid#2814,cpfk_customer_orders#2815,cfpk_orders_customer#2816,cval_orders_o_orderstatus#2817,cval_orders_o_totalprice#2818,cval_orders_o_orderpriority#2819,cval_orders_o_clerk#2820,cval_orders_o_shippriority#2821,cval_orders_o_comment#2822,cval_orders_o_orderdate#2823,co_orderstatus#2824,co_totalprice#2825,co_orderpriority#2826,co_clerk#2827,co_shippriority#2828,co_comment#2829,co_orderdate#2830] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#2848 AS rid_1#2863, cpfk_nation_customer#2849 AS cpfk_nation_customer_1#2864, cfpk_customer_nation#2850 AS cfpk_customer_nation_1#2865, cval_customer_c_name#2851 AS cval_customer_c_name_1#2866, cval_customer_c_address#2852 AS cval_customer_c_address_1#2867, cval_customer_c_phone#2853 AS cval_customer_c_phone_1#2868, cval_customer_c_acctbal#2854 AS cval_customer_c_acctbal_1#2869, cval_customer_c_comment#2855 AS cval_customer_c_comment_1#2870, cval_customer_c_mktsegment#2856 AS cval_customer_c_mktsegment_1#2871, cc_name#2857 AS cc_name_1#2872, cc_address#2858 AS cc_address_1#2873, cc_phone#2859 AS cc_phone_1#2874, cc_acctbal#2860 AS cc_acctbal_1#2875, cc_comment#2861 AS cc_comment_1#2876, cc_mktsegment#2862 AS cc_mktsegment_1#2877]
               +- Relation[rid#2848,cpfk_nation_customer#2849,cfpk_customer_nation#2850,cval_customer_c_name#2851,cval_customer_c_address#2852,cval_customer_c_phone#2853,cval_customer_c_acctbal#2854,cval_customer_c_comment#2855,cval_customer_c_mktsegment#2856,cc_name#2857,cc_address#2858,cc_phone#2859,cc_acctbal#2860,cc_comment#2861,cc_mktsegment#2862] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 12767ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/11 07:28:48 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:28:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2915L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 07:28:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:28:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:28:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:28:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:28:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:28:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:28:48 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:28:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2915L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#2917 AS rid_0#2934, cval_part_p_name#2918 AS cval_part_p_name_0#2935, cval_part_p_mfgr#2919 AS cval_part_p_mfgr_0#2936, cval_part_p_type#2920 AS cval_part_p_type_0#2937, cval_part_p_size#2921 AS cval_part_p_size_0#2938, cval_part_p_container#2922 AS cval_part_p_container_0#2939, cval_part_p_retailprice#2923 AS cval_part_p_retailprice_0#2940, cval_part_p_comment#2924 AS cval_part_p_comment_0#2941, cval_part_p_brand#2925 AS cval_part_p_brand_0#2942, cp_name#2926 AS cp_name_0#2943, cp_mfgr#2927 AS cp_mfgr_0#2944, cp_type#2928 AS cp_type_0#2945, cp_size#2929 AS cp_size_0#2946, cp_container#2930 AS cp_container_0#2947, cp_retailprice#2931 AS cp_retailprice_0#2948, cp_comment#2932 AS cp_comment_0#2949, cp_brand#2933 AS cp_brand_0#2950]
         :  :  :  :  +- Relation[rid#2917,cval_part_p_name#2918,cval_part_p_mfgr#2919,cval_part_p_type#2920,cval_part_p_size#2921,cval_part_p_container#2922,cval_part_p_retailprice#2923,cval_part_p_comment#2924,cval_part_p_brand#2925,cp_name#2926,cp_mfgr#2927,cp_type#2928,cp_size#2929,cp_container#2930,cp_retailprice#2931,cp_comment#2932,cp_brand#2933] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#2951 AS rid_0#2968, cval_part_p_name#2952 AS cval_part_p_name_0#2969, cval_part_p_mfgr#2953 AS cval_part_p_mfgr_0#2970, cval_part_p_type#2954 AS cval_part_p_type_0#2971, cval_part_p_size#2955 AS cval_part_p_size_0#2972, cval_part_p_container#2956 AS cval_part_p_container_0#2973, cval_part_p_retailprice#2957 AS cval_part_p_retailprice_0#2974, cval_part_p_comment#2958 AS cval_part_p_comment_0#2975, cval_part_p_brand#2959 AS cval_part_p_brand_0#2976, cp_name#2960 AS cp_name_0#2977, cp_mfgr#2961 AS cp_mfgr_0#2978, cp_type#2962 AS cp_type_0#2979, cp_size#2963 AS cp_size_0#2980, cp_container#2964 AS cp_container_0#2981, cp_retailprice#2965 AS cp_retailprice_0#2982, cp_comment#2966 AS cp_comment_0#2983, cp_brand#2967 AS cp_brand_0#2984]
         :  :  :        +- Relation[rid#2951,cval_part_p_name#2952,cval_part_p_mfgr#2953,cval_part_p_type#2954,cval_part_p_size#2955,cval_part_p_container#2956,cval_part_p_retailprice#2957,cval_part_p_comment#2958,cval_part_p_brand#2959,cp_name#2960,cp_mfgr#2961,cp_type#2962,cp_size#2963,cp_container#2964,cp_retailprice#2965,cp_comment#2966,cp_brand#2967] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_container~SM CASE, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#2985 AS rid_0#3002, cval_part_p_name#2986 AS cval_part_p_name_0#3003, cval_part_p_mfgr#2987 AS cval_part_p_mfgr_0#3004, cval_part_p_type#2988 AS cval_part_p_type_0#3005, cval_part_p_size#2989 AS cval_part_p_size_0#3006, cval_part_p_container#2990 AS cval_part_p_container_0#3007, cval_part_p_retailprice#2991 AS cval_part_p_retailprice_0#3008, cval_part_p_comment#2992 AS cval_part_p_comment_0#3009, cval_part_p_brand#2993 AS cval_part_p_brand_0#3010, cp_name#2994 AS cp_name_0#3011, cp_mfgr#2995 AS cp_mfgr_0#3012, cp_type#2996 AS cp_type_0#3013, cp_size#2997 AS cp_size_0#3014, cp_container#2998 AS cp_container_0#3015, cp_retailprice#2999 AS cp_retailprice_0#3016, cp_comment#3000 AS cp_comment_0#3017, cp_brand#3001 AS cp_brand_0#3018]
         :  :        +- Relation[rid#2985,cval_part_p_name#2986,cval_part_p_mfgr#2987,cval_part_p_type#2988,cval_part_p_size#2989,cval_part_p_container#2990,cval_part_p_retailprice#2991,cval_part_p_comment#2992,cval_part_p_brand#2993,cp_name#2994,cp_mfgr#2995,cp_type#2996,cp_size#2997,cp_container#2998,cp_retailprice#2999,cp_comment#3000,cp_brand#3001] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#3217 AS rid_0#3234, cval_part_p_name#3218 AS cval_part_p_name_0#3235, cval_part_p_mfgr#3219 AS cval_part_p_mfgr_0#3236, cval_part_p_type#3220 AS cval_part_p_type_0#3237, cval_part_p_size#3221 AS cval_part_p_size_0#3238, cval_part_p_container#3222 AS cval_part_p_container_0#3239, cval_part_p_retailprice#3223 AS cval_part_p_retailprice_0#3240, cval_part_p_comment#3224 AS cval_part_p_comment_0#3241, cval_part_p_brand#3225 AS cval_part_p_brand_0#3242, cp_name#3226 AS cp_name_0#3243, cp_mfgr#3227 AS cp_mfgr_0#3244, cp_type#3228 AS cp_type_0#3245, cp_size#3229 AS cp_size_0#3246, cp_container#3230 AS cp_container_0#3247, cp_retailprice#3231 AS cp_retailprice_0#3248, cp_comment#3232 AS cp_comment_0#3249, cp_brand#3233 AS cp_brand_0#3250]
         :     :  +- Relation[rid#3217,cval_part_p_name#3218,cval_part_p_mfgr#3219,cval_part_p_type#3220,cval_part_p_size#3221,cval_part_p_container#3222,cval_part_p_retailprice#3223,cval_part_p_comment#3224,cval_part_p_brand#3225,cp_name#3226,cp_mfgr#3227,cp_type#3228,cp_size#3229,cp_container#3230,cp_retailprice#3231,cp_comment#3232,cp_brand#3233] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#3251 AS rid_1#3284, cpfk_orders_lineitem#3252 AS cpfk_orders_lineitem_1#3285, cpfk_supplier_lineitem#3253 AS cpfk_supplier_lineitem_1#3286, cfpk_lineitem_supplier#3254 AS cfpk_lineitem_supplier_1#3287, cfpk_lineitem_partsupp#3255 AS cfpk_lineitem_partsupp_1#3288, cpfk_part_lineitem#3256 AS cpfk_part_lineitem_1#3289, cfpk_lineitem_part#3257 AS cfpk_lineitem_part_1#3290, cpfk_partsupp_lineitem#3258 AS cpfk_partsupp_lineitem_1#3291, cfpk_lineitem_orders#3259 AS cfpk_lineitem_orders_1#3292, cval_lineitem_l_quantity#3260 AS cval_lineitem_l_quantity_1#3293, cval_lineitem_l_extendedprice#3261 AS cval_lineitem_l_extendedprice_1#3294, cval_lineitem_l_discount#3262 AS cval_lineitem_l_discount_1#3295, cval_lineitem_l_tax#3263 AS cval_lineitem_l_tax_1#3296, cval_lineitem_l_returnflag#3264 AS cval_lineitem_l_returnflag_1#3297, cval_lineitem_l_linestatus#3265 AS cval_lineitem_l_linestatus_1#3298, cval_lineitem_l_commitdate#3266 AS cval_lineitem_l_commitdate_1#3299, cval_lineitem_l_receiptdate#3267 AS cval_lineitem_l_receiptdate_1#3300, cval_lineitem_l_shipinstruct#3268 AS cval_lineitem_l_shipinstruct_1#3301, cval_lineitem_l_shipmode#3269 AS cval_lineitem_l_shipmode_1#3302, cval_lineitem_l_comment#3270 AS cval_lineitem_l_comment_1#3303, cval_lineitem_l_shipdate#3271 AS cval_lineitem_l_shipdate_1#3304, cl_quantity#3272 AS cl_quantity_1#3305, cl_extendedprice#3273 AS cl_extendedprice_1#3306, cl_discount#3274 AS cl_discount_1#3307, ... 9 more fields]
         :        +- Relation[rid#3251,cpfk_orders_lineitem#3252,cpfk_supplier_lineitem#3253,cfpk_lineitem_supplier#3254,cfpk_lineitem_partsupp#3255,cpfk_part_lineitem#3256,cfpk_lineitem_part#3257,cpfk_partsupp_lineitem#3258,cfpk_lineitem_orders#3259,cval_lineitem_l_quantity#3260,cval_lineitem_l_extendedprice#3261,cval_lineitem_l_discount#3262,cval_lineitem_l_tax#3263,cval_lineitem_l_returnflag#3264,cval_lineitem_l_linestatus#3265,cval_lineitem_l_commitdate#3266,cval_lineitem_l_receiptdate#3267,cval_lineitem_l_shipinstruct#3268,cval_lineitem_l_shipmode#3269,cval_lineitem_l_comment#3270,cval_lineitem_l_shipdate#3271,cl_quantity#3272,cl_extendedprice#3273,cl_discount#3274,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [rid#3019 AS rid_1#3052, cpfk_orders_lineitem#3020 AS cpfk_orders_lineitem_1#3053, cpfk_supplier_lineitem#3021 AS cpfk_supplier_lineitem_1#3054, cfpk_lineitem_supplier#3022 AS cfpk_lineitem_supplier_1#3055, cfpk_lineitem_partsupp#3023 AS cfpk_lineitem_partsupp_1#3056, cpfk_part_lineitem#3024 AS cpfk_part_lineitem_1#3057, cfpk_lineitem_part#3025 AS cfpk_lineitem_part_1#3058, cpfk_partsupp_lineitem#3026 AS cpfk_partsupp_lineitem_1#3059, cfpk_lineitem_orders#3027 AS cfpk_lineitem_orders_1#3060, cval_lineitem_l_quantity#3028 AS cval_lineitem_l_quantity_1#3061, cval_lineitem_l_extendedprice#3029 AS cval_lineitem_l_extendedprice_1#3062, cval_lineitem_l_discount#3030 AS cval_lineitem_l_discount_1#3063, cval_lineitem_l_tax#3031 AS cval_lineitem_l_tax_1#3064, cval_lineitem_l_returnflag#3032 AS cval_lineitem_l_returnflag_1#3065, cval_lineitem_l_linestatus#3033 AS cval_lineitem_l_linestatus_1#3066, cval_lineitem_l_commitdate#3034 AS cval_lineitem_l_commitdate_1#3067, cval_lineitem_l_receiptdate#3035 AS cval_lineitem_l_receiptdate_1#3068, cval_lineitem_l_shipinstruct#3036 AS cval_lineitem_l_shipinstruct_1#3069, cval_lineitem_l_shipmode#3037 AS cval_lineitem_l_shipmode_1#3070, cval_lineitem_l_comment#3038 AS cval_lineitem_l_comment_1#3071, cval_lineitem_l_shipdate#3039 AS cval_lineitem_l_shipdate_1#3072, cl_quantity#3040 AS cl_quantity_1#3073, cl_extendedprice#3041 AS cl_extendedprice_1#3074, cl_discount#3042 AS cl_discount_1#3075, ... 9 more fields]
            :  :  +- Relation[rid#3019,cpfk_orders_lineitem#3020,cpfk_supplier_lineitem#3021,cfpk_lineitem_supplier#3022,cfpk_lineitem_partsupp#3023,cpfk_part_lineitem#3024,cfpk_lineitem_part#3025,cpfk_partsupp_lineitem#3026,cfpk_lineitem_orders#3027,cval_lineitem_l_quantity#3028,cval_lineitem_l_extendedprice#3029,cval_lineitem_l_discount#3030,cval_lineitem_l_tax#3031,cval_lineitem_l_returnflag#3032,cval_lineitem_l_linestatus#3033,cval_lineitem_l_commitdate#3034,cval_lineitem_l_receiptdate#3035,cval_lineitem_l_shipinstruct#3036,cval_lineitem_l_shipmode#3037,cval_lineitem_l_comment#3038,cval_lineitem_l_shipdate#3039,cl_quantity#3040,cl_extendedprice#3041,cl_discount#3042,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem, 'rid_1
            :     +- Project [rid#3085 AS rid_1#3118, cpfk_orders_lineitem#3086 AS cpfk_orders_lineitem_1#3119, cpfk_supplier_lineitem#3087 AS cpfk_supplier_lineitem_1#3120, cfpk_lineitem_supplier#3088 AS cfpk_lineitem_supplier_1#3121, cfpk_lineitem_partsupp#3089 AS cfpk_lineitem_partsupp_1#3122, cpfk_part_lineitem#3090 AS cpfk_part_lineitem_1#3123, cfpk_lineitem_part#3091 AS cfpk_lineitem_part_1#3124, cpfk_partsupp_lineitem#3092 AS cpfk_partsupp_lineitem_1#3125, cfpk_lineitem_orders#3093 AS cfpk_lineitem_orders_1#3126, cval_lineitem_l_quantity#3094 AS cval_lineitem_l_quantity_1#3127, cval_lineitem_l_extendedprice#3095 AS cval_lineitem_l_extendedprice_1#3128, cval_lineitem_l_discount#3096 AS cval_lineitem_l_discount_1#3129, cval_lineitem_l_tax#3097 AS cval_lineitem_l_tax_1#3130, cval_lineitem_l_returnflag#3098 AS cval_lineitem_l_returnflag_1#3131, cval_lineitem_l_linestatus#3099 AS cval_lineitem_l_linestatus_1#3132, cval_lineitem_l_commitdate#3100 AS cval_lineitem_l_commitdate_1#3133, cval_lineitem_l_receiptdate#3101 AS cval_lineitem_l_receiptdate_1#3134, cval_lineitem_l_shipinstruct#3102 AS cval_lineitem_l_shipinstruct_1#3135, cval_lineitem_l_shipmode#3103 AS cval_lineitem_l_shipmode_1#3136, cval_lineitem_l_comment#3104 AS cval_lineitem_l_comment_1#3137, cval_lineitem_l_shipdate#3105 AS cval_lineitem_l_shipdate_1#3138, cl_quantity#3106 AS cl_quantity_1#3139, cl_extendedprice#3107 AS cl_extendedprice_1#3140, cl_discount#3108 AS cl_discount_1#3141, ... 9 more fields]
            :        +- Relation[rid#3085,cpfk_orders_lineitem#3086,cpfk_supplier_lineitem#3087,cfpk_lineitem_supplier#3088,cfpk_lineitem_partsupp#3089,cpfk_part_lineitem#3090,cfpk_lineitem_part#3091,cpfk_partsupp_lineitem#3092,cfpk_lineitem_orders#3093,cval_lineitem_l_quantity#3094,cval_lineitem_l_extendedprice#3095,cval_lineitem_l_discount#3096,cval_lineitem_l_tax#3097,cval_lineitem_l_returnflag#3098,cval_lineitem_l_linestatus#3099,cval_lineitem_l_commitdate#3100,cval_lineitem_l_receiptdate#3101,cval_lineitem_l_shipinstruct#3102,cval_lineitem_l_shipmode#3103,cval_lineitem_l_comment#3104,cval_lineitem_l_shipdate#3105,cl_quantity#3106,cl_extendedprice#3107,cl_discount#3108,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipinstruct~DELIVER IN PERSON, cval_lineitem_l_shipinstruct, 'cval_lineitem_l_shipinstruct_1, tlineitem, 'rid_1
               +- Project [rid#3151 AS rid_1#3184, cpfk_orders_lineitem#3152 AS cpfk_orders_lineitem_1#3185, cpfk_supplier_lineitem#3153 AS cpfk_supplier_lineitem_1#3186, cfpk_lineitem_supplier#3154 AS cfpk_lineitem_supplier_1#3187, cfpk_lineitem_partsupp#3155 AS cfpk_lineitem_partsupp_1#3188, cpfk_part_lineitem#3156 AS cpfk_part_lineitem_1#3189, cfpk_lineitem_part#3157 AS cfpk_lineitem_part_1#3190, cpfk_partsupp_lineitem#3158 AS cpfk_partsupp_lineitem_1#3191, cfpk_lineitem_orders#3159 AS cfpk_lineitem_orders_1#3192, cval_lineitem_l_quantity#3160 AS cval_lineitem_l_quantity_1#3193, cval_lineitem_l_extendedprice#3161 AS cval_lineitem_l_extendedprice_1#3194, cval_lineitem_l_discount#3162 AS cval_lineitem_l_discount_1#3195, cval_lineitem_l_tax#3163 AS cval_lineitem_l_tax_1#3196, cval_lineitem_l_returnflag#3164 AS cval_lineitem_l_returnflag_1#3197, cval_lineitem_l_linestatus#3165 AS cval_lineitem_l_linestatus_1#3198, cval_lineitem_l_commitdate#3166 AS cval_lineitem_l_commitdate_1#3199, cval_lineitem_l_receiptdate#3167 AS cval_lineitem_l_receiptdate_1#3200, cval_lineitem_l_shipinstruct#3168 AS cval_lineitem_l_shipinstruct_1#3201, cval_lineitem_l_shipmode#3169 AS cval_lineitem_l_shipmode_1#3202, cval_lineitem_l_comment#3170 AS cval_lineitem_l_comment_1#3203, cval_lineitem_l_shipdate#3171 AS cval_lineitem_l_shipdate_1#3204, cl_quantity#3172 AS cl_quantity_1#3205, cl_extendedprice#3173 AS cl_extendedprice_1#3206, cl_discount#3174 AS cl_discount_1#3207, ... 9 more fields]
                  +- Relation[rid#3151,cpfk_orders_lineitem#3152,cpfk_supplier_lineitem#3153,cfpk_lineitem_supplier#3154,cfpk_lineitem_partsupp#3155,cpfk_part_lineitem#3156,cfpk_lineitem_part#3157,cpfk_partsupp_lineitem#3158,cfpk_lineitem_orders#3159,cval_lineitem_l_quantity#3160,cval_lineitem_l_extendedprice#3161,cval_lineitem_l_discount#3162,cval_lineitem_l_tax#3163,cval_lineitem_l_returnflag#3164,cval_lineitem_l_linestatus#3165,cval_lineitem_l_commitdate#3166,cval_lineitem_l_receiptdate#3167,cval_lineitem_l_shipinstruct#3168,cval_lineitem_l_shipmode#3169,cval_lineitem_l_comment#3170,cval_lineitem_l_shipdate#3171,cl_quantity#3172,cl_extendedprice#3173,cl_discount#3174,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 363268ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/11 07:34:51 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:34:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3374L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 07:34:51 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:34:51 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:34:52 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:34:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3374L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- Project [rid#3376 AS rid_0#3393, cval_part_p_name#3377 AS cval_part_p_name_0#3394, cval_part_p_mfgr#3378 AS cval_part_p_mfgr_0#3395, cval_part_p_type#3379 AS cval_part_p_type_0#3396, cval_part_p_size#3380 AS cval_part_p_size_0#3397, cval_part_p_container#3381 AS cval_part_p_container_0#3398, cval_part_p_retailprice#3382 AS cval_part_p_retailprice_0#3399, cval_part_p_comment#3383 AS cval_part_p_comment_0#3400, cval_part_p_brand#3384 AS cval_part_p_brand_0#3401, cp_name#3385 AS cp_name_0#3402, cp_mfgr#3386 AS cp_mfgr_0#3403, cp_type#3387 AS cp_type_0#3404, cp_size#3388 AS cp_size_0#3405, cp_container#3389 AS cp_container_0#3406, cp_retailprice#3390 AS cp_retailprice_0#3407, cp_comment#3391 AS cp_comment_0#3408, cp_brand#3392 AS cp_brand_0#3409]
         :  :  :  +- Relation[rid#3376,cval_part_p_name#3377,cval_part_p_mfgr#3378,cval_part_p_type#3379,cval_part_p_size#3380,cval_part_p_container#3381,cval_part_p_retailprice#3382,cval_part_p_comment#3383,cval_part_p_brand#3384,cp_name#3385,cp_mfgr#3386,cp_type#3387,cp_size#3388,cp_container#3389,cp_retailprice#3390,cp_comment#3391,cp_brand#3392] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
         :  :     +- Project [rid#3410 AS rid_0#3427, cval_part_p_name#3411 AS cval_part_p_name_0#3428, cval_part_p_mfgr#3412 AS cval_part_p_mfgr_0#3429, cval_part_p_type#3413 AS cval_part_p_type_0#3430, cval_part_p_size#3414 AS cval_part_p_size_0#3431, cval_part_p_container#3415 AS cval_part_p_container_0#3432, cval_part_p_retailprice#3416 AS cval_part_p_retailprice_0#3433, cval_part_p_comment#3417 AS cval_part_p_comment_0#3434, cval_part_p_brand#3418 AS cval_part_p_brand_0#3435, cp_name#3419 AS cp_name_0#3436, cp_mfgr#3420 AS cp_mfgr_0#3437, cp_type#3421 AS cp_type_0#3438, cp_size#3422 AS cp_size_0#3439, cp_container#3423 AS cp_container_0#3440, cp_retailprice#3424 AS cp_retailprice_0#3441, cp_comment#3425 AS cp_comment_0#3442, cp_brand#3426 AS cp_brand_0#3443]
         :  :        +- Relation[rid#3410,cval_part_p_name#3411,cval_part_p_mfgr#3412,cval_part_p_type#3413,cval_part_p_size#3414,cval_part_p_container#3415,cval_part_p_retailprice#3416,cval_part_p_comment#3417,cval_part_p_brand#3418,cp_name#3419,cp_mfgr#3420,cp_type#3421,cp_size#3422,cp_container#3423,cp_retailprice#3424,cp_comment#3425,cp_brand#3426] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
         :     :- Project [rid#3466 AS rid_0#3483, cval_part_p_name#3467 AS cval_part_p_name_0#3484, cval_part_p_mfgr#3468 AS cval_part_p_mfgr_0#3485, cval_part_p_type#3469 AS cval_part_p_type_0#3486, cval_part_p_size#3470 AS cval_part_p_size_0#3487, cval_part_p_container#3471 AS cval_part_p_container_0#3488, cval_part_p_retailprice#3472 AS cval_part_p_retailprice_0#3489, cval_part_p_comment#3473 AS cval_part_p_comment_0#3490, cval_part_p_brand#3474 AS cval_part_p_brand_0#3491, cp_name#3475 AS cp_name_0#3492, cp_mfgr#3476 AS cp_mfgr_0#3493, cp_type#3477 AS cp_type_0#3494, cp_size#3478 AS cp_size_0#3495, cp_container#3479 AS cp_container_0#3496, cp_retailprice#3480 AS cp_retailprice_0#3497, cp_comment#3481 AS cp_comment_0#3498, cp_brand#3482 AS cp_brand_0#3499]
         :     :  +- Relation[rid#3466,cval_part_p_name#3467,cval_part_p_mfgr#3468,cval_part_p_type#3469,cval_part_p_size#3470,cval_part_p_container#3471,cval_part_p_retailprice#3472,cval_part_p_comment#3473,cval_part_p_brand#3474,cp_name#3475,cp_mfgr#3476,cp_type#3477,cp_size#3478,cp_container#3479,cp_retailprice#3480,cp_comment#3481,cp_brand#3482] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#3500 AS rid_1#3511, cpfk_part_partsupp#3501 AS cpfk_part_partsupp_1#3512, cfpk_partsupp_part#3502 AS cfpk_partsupp_part_1#3513, cpfk_supplier_partsupp#3503 AS cpfk_supplier_partsupp_1#3514, cfpk_partsupp_supplier#3504 AS cfpk_partsupp_supplier_1#3515, cval_partsupp_ps_availqty#3505 AS cval_partsupp_ps_availqty_1#3516, cval_partsupp_ps_supplycost#3506 AS cval_partsupp_ps_supplycost_1#3517, cval_partsupp_ps_comment#3507 AS cval_partsupp_ps_comment_1#3518, cps_availqty#3508 AS cps_availqty_1#3519, cps_supplycost#3509 AS cps_supplycost_1#3520, cps_comment#3510 AS cps_comment_1#3521]
         :        +- Relation[rid#3500,cpfk_part_partsupp#3501,cfpk_partsupp_part#3502,cpfk_supplier_partsupp#3503,cfpk_partsupp_supplier#3504,cval_partsupp_ps_availqty#3505,cval_partsupp_ps_supplycost#3506,cval_partsupp_ps_comment#3507,cps_availqty#3508,cps_supplycost#3509,cps_comment#3510] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#3444 AS rid_1#3455, cpfk_part_partsupp#3445 AS cpfk_part_partsupp_1#3456, cfpk_partsupp_part#3446 AS cfpk_partsupp_part_1#3457, cpfk_supplier_partsupp#3447 AS cpfk_supplier_partsupp_1#3458, cfpk_partsupp_supplier#3448 AS cfpk_partsupp_supplier_1#3459, cval_partsupp_ps_availqty#3449 AS cval_partsupp_ps_availqty_1#3460, cval_partsupp_ps_supplycost#3450 AS cval_partsupp_ps_supplycost_1#3461, cval_partsupp_ps_comment#3451 AS cval_partsupp_ps_comment_1#3462, cps_availqty#3452 AS cps_availqty_1#3463, cps_supplycost#3453 AS cps_supplycost_1#3464, cps_comment#3454 AS cps_comment_1#3465]
            +- Relation[rid#3444,cpfk_part_partsupp#3445,cfpk_partsupp_part#3446,cpfk_supplier_partsupp#3447,cfpk_partsupp_supplier#3448,cval_partsupp_ps_availqty#3449,cval_partsupp_ps_supplycost#3450,cval_partsupp_ps_comment#3451,cps_availqty#3452,cps_supplycost#3453,cps_comment#3454] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 11111ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/11 07:35:03 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:35:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3554L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/11 07:35:03 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:35:03 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:35:03 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:35:03 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:35:03 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:35:03 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:35:03 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:35:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3554L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- Project [rid#3556 AS rid_0#3589, cpfk_orders_lineitem#3557 AS cpfk_orders_lineitem_0#3590, cpfk_supplier_lineitem#3558 AS cpfk_supplier_lineitem_0#3591, cfpk_lineitem_supplier#3559 AS cfpk_lineitem_supplier_0#3592, cfpk_lineitem_partsupp#3560 AS cfpk_lineitem_partsupp_0#3593, cpfk_part_lineitem#3561 AS cpfk_part_lineitem_0#3594, cfpk_lineitem_part#3562 AS cfpk_lineitem_part_0#3595, cpfk_partsupp_lineitem#3563 AS cpfk_partsupp_lineitem_0#3596, cfpk_lineitem_orders#3564 AS cfpk_lineitem_orders_0#3597, cval_lineitem_l_quantity#3565 AS cval_lineitem_l_quantity_0#3598, cval_lineitem_l_extendedprice#3566 AS cval_lineitem_l_extendedprice_0#3599, cval_lineitem_l_discount#3567 AS cval_lineitem_l_discount_0#3600, cval_lineitem_l_tax#3568 AS cval_lineitem_l_tax_0#3601, cval_lineitem_l_returnflag#3569 AS cval_lineitem_l_returnflag_0#3602, cval_lineitem_l_linestatus#3570 AS cval_lineitem_l_linestatus_0#3603, cval_lineitem_l_commitdate#3571 AS cval_lineitem_l_commitdate_0#3604, cval_lineitem_l_receiptdate#3572 AS cval_lineitem_l_receiptdate_0#3605, cval_lineitem_l_shipinstruct#3573 AS cval_lineitem_l_shipinstruct_0#3606, cval_lineitem_l_shipmode#3574 AS cval_lineitem_l_shipmode_0#3607, cval_lineitem_l_comment#3575 AS cval_lineitem_l_comment_0#3608, cval_lineitem_l_shipdate#3576 AS cval_lineitem_l_shipdate_0#3609, cl_quantity#3577 AS cl_quantity_0#3610, cl_extendedprice#3578 AS cl_extendedprice_0#3611, cl_discount#3579 AS cl_discount_0#3612, ... 9 more fields]
            :  +- Relation[rid#3556,cpfk_orders_lineitem#3557,cpfk_supplier_lineitem#3558,cfpk_lineitem_supplier#3559,cfpk_lineitem_partsupp#3560,cpfk_part_lineitem#3561,cfpk_lineitem_part#3562,cpfk_partsupp_lineitem#3563,cfpk_lineitem_orders#3564,cval_lineitem_l_quantity#3565,cval_lineitem_l_extendedprice#3566,cval_lineitem_l_discount#3567,cval_lineitem_l_tax#3568,cval_lineitem_l_returnflag#3569,cval_lineitem_l_linestatus#3570,cval_lineitem_l_commitdate#3571,cval_lineitem_l_receiptdate#3572,cval_lineitem_l_shipinstruct#3573,cval_lineitem_l_shipmode#3574,cval_lineitem_l_comment#3575,cval_lineitem_l_shipdate#3576,cl_quantity#3577,cl_extendedprice#3578,cl_discount#3579,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- 'Project [*]
               +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
                  :- 'Project [*]
                  :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
                  :     :- 'Join UsingJoin(Inner,List(rid_2))
                  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
                  :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_1))
                  :     :  :  :  :- Project [rid#3622 AS rid_1#3639, cpfk_customer_orders#3623 AS cpfk_customer_orders_1#3640, cfpk_orders_customer#3624 AS cfpk_orders_customer_1#3641, cval_orders_o_orderstatus#3625 AS cval_orders_o_orderstatus_1#3642, cval_orders_o_totalprice#3626 AS cval_orders_o_totalprice_1#3643, cval_orders_o_orderpriority#3627 AS cval_orders_o_orderpriority_1#3644, cval_orders_o_clerk#3628 AS cval_orders_o_clerk_1#3645, cval_orders_o_shippriority#3629 AS cval_orders_o_shippriority_1#3646, cval_orders_o_comment#3630 AS cval_orders_o_comment_1#3647, cval_orders_o_orderdate#3631 AS cval_orders_o_orderdate_1#3648, co_orderstatus#3632 AS co_orderstatus_1#3649, co_totalprice#3633 AS co_totalprice_1#3650, co_orderpriority#3634 AS co_orderpriority_1#3651, co_clerk#3635 AS co_clerk_1#3652, co_shippriority#3636 AS co_shippriority_1#3653, co_comment#3637 AS co_comment_1#3654, co_orderdate#3638 AS co_orderdate_1#3655]
                  :     :  :  :  :  +- Relation[rid#3622,cpfk_customer_orders#3623,cfpk_orders_customer#3624,cval_orders_o_orderstatus#3625,cval_orders_o_totalprice#3626,cval_orders_o_orderpriority#3627,cval_orders_o_clerk#3628,cval_orders_o_shippriority#3629,cval_orders_o_comment#3630,cval_orders_o_orderdate#3631,co_orderstatus#3632,co_totalprice#3633,co_orderpriority#3634,co_clerk#3635,co_shippriority#3636,co_comment#3637,co_orderdate#3638] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  :  +- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders, 'rid_1
                  :     :  :  :     +- Project [rid#3656 AS rid_1#3673, cpfk_customer_orders#3657 AS cpfk_customer_orders_1#3674, cfpk_orders_customer#3658 AS cfpk_orders_customer_1#3675, cval_orders_o_orderstatus#3659 AS cval_orders_o_orderstatus_1#3676, cval_orders_o_totalprice#3660 AS cval_orders_o_totalprice_1#3677, cval_orders_o_orderpriority#3661 AS cval_orders_o_orderpriority_1#3678, cval_orders_o_clerk#3662 AS cval_orders_o_clerk_1#3679, cval_orders_o_shippriority#3663 AS cval_orders_o_shippriority_1#3680, cval_orders_o_comment#3664 AS cval_orders_o_comment_1#3681, cval_orders_o_orderdate#3665 AS cval_orders_o_orderdate_1#3682, co_orderstatus#3666 AS co_orderstatus_1#3683, co_totalprice#3667 AS co_totalprice_1#3684, co_orderpriority#3668 AS co_orderpriority_1#3685, co_clerk#3669 AS co_clerk_1#3686, co_shippriority#3670 AS co_shippriority_1#3687, co_comment#3671 AS co_comment_1#3688, co_orderdate#3672 AS co_orderdate_1#3689]
                  :     :  :  :        +- Relation[rid#3656,cpfk_customer_orders#3657,cfpk_orders_customer#3658,cval_orders_o_orderstatus#3659,cval_orders_o_totalprice#3660,cval_orders_o_orderpriority#3661,cval_orders_o_clerk#3662,cval_orders_o_shippriority#3663,cval_orders_o_comment#3664,cval_orders_o_orderdate#3665,co_orderstatus#3666,co_totalprice#3667,co_orderpriority#3668,co_clerk#3669,co_shippriority#3670,co_comment#3671,co_orderdate#3672] JDBCRelation(torders) [numPartitions=1]
                  :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
                  :     :  :     :- Project [rid#3756 AS rid_1#3773, cpfk_customer_orders#3757 AS cpfk_customer_orders_1#3774, cfpk_orders_customer#3758 AS cfpk_orders_customer_1#3775, cval_orders_o_orderstatus#3759 AS cval_orders_o_orderstatus_1#3776, cval_orders_o_totalprice#3760 AS cval_orders_o_totalprice_1#3777, cval_orders_o_orderpriority#3761 AS cval_orders_o_orderpriority_1#3778, cval_orders_o_clerk#3762 AS cval_orders_o_clerk_1#3779, cval_orders_o_shippriority#3763 AS cval_orders_o_shippriority_1#3780, cval_orders_o_comment#3764 AS cval_orders_o_comment_1#3781, cval_orders_o_orderdate#3765 AS cval_orders_o_orderdate_1#3782, co_orderstatus#3766 AS co_orderstatus_1#3783, co_totalprice#3767 AS co_totalprice_1#3784, co_orderpriority#3768 AS co_orderpriority_1#3785, co_clerk#3769 AS co_clerk_1#3786, co_shippriority#3770 AS co_shippriority_1#3787, co_comment#3771 AS co_comment_1#3788, co_orderdate#3772 AS co_orderdate_1#3789]
                  :     :  :     :  +- Relation[rid#3756,cpfk_customer_orders#3757,cfpk_orders_customer#3758,cval_orders_o_orderstatus#3759,cval_orders_o_totalprice#3760,cval_orders_o_orderpriority#3761,cval_orders_o_clerk#3762,cval_orders_o_shippriority#3763,cval_orders_o_comment#3764,cval_orders_o_orderdate#3765,co_orderstatus#3766,co_totalprice#3767,co_orderpriority#3768,co_clerk#3769,co_shippriority#3770,co_comment#3771,co_orderdate#3772] JDBCRelation(torders) [numPartitions=1]
                  :     :  :     +- Project [rid#3790 AS rid_2#3823, cpfk_orders_lineitem#3791 AS cpfk_orders_lineitem_2#3824, cpfk_supplier_lineitem#3792 AS cpfk_supplier_lineitem_2#3825, cfpk_lineitem_supplier#3793 AS cfpk_lineitem_supplier_2#3826, cfpk_lineitem_partsupp#3794 AS cfpk_lineitem_partsupp_2#3827, cpfk_part_lineitem#3795 AS cpfk_part_lineitem_2#3828, cfpk_lineitem_part#3796 AS cfpk_lineitem_part_2#3829, cpfk_partsupp_lineitem#3797 AS cpfk_partsupp_lineitem_2#3830, cfpk_lineitem_orders#3798 AS cfpk_lineitem_orders_2#3831, cval_lineitem_l_quantity#3799 AS cval_lineitem_l_quantity_2#3832, cval_lineitem_l_extendedprice#3800 AS cval_lineitem_l_extendedprice_2#3833, cval_lineitem_l_discount#3801 AS cval_lineitem_l_discount_2#3834, cval_lineitem_l_tax#3802 AS cval_lineitem_l_tax_2#3835, cval_lineitem_l_returnflag#3803 AS cval_lineitem_l_returnflag_2#3836, cval_lineitem_l_linestatus#3804 AS cval_lineitem_l_linestatus_2#3837, cval_lineitem_l_commitdate#3805 AS cval_lineitem_l_commitdate_2#3838, cval_lineitem_l_receiptdate#3806 AS cval_lineitem_l_receiptdate_2#3839, cval_lineitem_l_shipinstruct#3807 AS cval_lineitem_l_shipinstruct_2#3840, cval_lineitem_l_shipmode#3808 AS cval_lineitem_l_shipmode_2#3841, cval_lineitem_l_comment#3809 AS cval_lineitem_l_comment_2#3842, cval_lineitem_l_shipdate#3810 AS cval_lineitem_l_shipdate_2#3843, cl_quantity#3811 AS cl_quantity_2#3844, cl_extendedprice#3812 AS cl_extendedprice_2#3845, cl_discount#3813 AS cl_discount_2#3846, ... 9 more fields]
                  :     :  :        +- Relation[rid#3790,cpfk_orders_lineitem#3791,cpfk_supplier_lineitem#3792,cfpk_lineitem_supplier#3793,cfpk_lineitem_partsupp#3794,cpfk_part_lineitem#3795,cfpk_lineitem_part#3796,cpfk_partsupp_lineitem#3797,cfpk_lineitem_orders#3798,cval_lineitem_l_quantity#3799,cval_lineitem_l_extendedprice#3800,cval_lineitem_l_discount#3801,cval_lineitem_l_tax#3802,cval_lineitem_l_returnflag#3803,cval_lineitem_l_linestatus#3804,cval_lineitem_l_commitdate#3805,cval_lineitem_l_receiptdate#3806,cval_lineitem_l_shipinstruct#3807,cval_lineitem_l_shipmode#3808,cval_lineitem_l_comment#3809,cval_lineitem_l_shipdate#3810,cl_quantity#3811,cl_extendedprice#3812,cl_discount#3813,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     :  +- Project [rid#3690 AS rid_2#3723, cpfk_orders_lineitem#3691 AS cpfk_orders_lineitem_2#3724, cpfk_supplier_lineitem#3692 AS cpfk_supplier_lineitem_2#3725, cfpk_lineitem_supplier#3693 AS cfpk_lineitem_supplier_2#3726, cfpk_lineitem_partsupp#3694 AS cfpk_lineitem_partsupp_2#3727, cpfk_part_lineitem#3695 AS cpfk_part_lineitem_2#3728, cfpk_lineitem_part#3696 AS cfpk_lineitem_part_2#3729, cpfk_partsupp_lineitem#3697 AS cpfk_partsupp_lineitem_2#3730, cfpk_lineitem_orders#3698 AS cfpk_lineitem_orders_2#3731, cval_lineitem_l_quantity#3699 AS cval_lineitem_l_quantity_2#3732, cval_lineitem_l_extendedprice#3700 AS cval_lineitem_l_extendedprice_2#3733, cval_lineitem_l_discount#3701 AS cval_lineitem_l_discount_2#3734, cval_lineitem_l_tax#3702 AS cval_lineitem_l_tax_2#3735, cval_lineitem_l_returnflag#3703 AS cval_lineitem_l_returnflag_2#3736, cval_lineitem_l_linestatus#3704 AS cval_lineitem_l_linestatus_2#3737, cval_lineitem_l_commitdate#3705 AS cval_lineitem_l_commitdate_2#3738, cval_lineitem_l_receiptdate#3706 AS cval_lineitem_l_receiptdate_2#3739, cval_lineitem_l_shipinstruct#3707 AS cval_lineitem_l_shipinstruct_2#3740, cval_lineitem_l_shipmode#3708 AS cval_lineitem_l_shipmode_2#3741, cval_lineitem_l_comment#3709 AS cval_lineitem_l_comment_2#3742, cval_lineitem_l_shipdate#3710 AS cval_lineitem_l_shipdate_2#3743, cl_quantity#3711 AS cl_quantity_2#3744, cl_extendedprice#3712 AS cl_extendedprice_2#3745, cl_discount#3713 AS cl_discount_2#3746, ... 9 more fields]
                  :     :     +- Relation[rid#3690,cpfk_orders_lineitem#3691,cpfk_supplier_lineitem#3692,cfpk_lineitem_supplier#3693,cfpk_lineitem_partsupp#3694,cpfk_part_lineitem#3695,cfpk_lineitem_part#3696,cpfk_partsupp_lineitem#3697,cfpk_lineitem_orders#3698,cval_lineitem_l_quantity#3699,cval_lineitem_l_extendedprice#3700,cval_lineitem_l_discount#3701,cval_lineitem_l_tax#3702,cval_lineitem_l_returnflag#3703,cval_lineitem_l_linestatus#3704,cval_lineitem_l_commitdate#3705,cval_lineitem_l_receiptdate#3706,cval_lineitem_l_shipinstruct#3707,cval_lineitem_l_shipmode#3708,cval_lineitem_l_comment#3709,cval_lineitem_l_shipdate#3710,cl_quantity#3711,cl_extendedprice#3712,cl_discount#3713,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
                  :     +- Project [rid#3856 AS rid_3#3869, cpfk_nation_supplier#3857 AS cpfk_nation_supplier_3#3870, cfpk_supplier_nation#3858 AS cfpk_supplier_nation_3#3871, cval_supplier_s_name#3859 AS cval_supplier_s_name_3#3872, cval_supplier_s_address#3860 AS cval_supplier_s_address_3#3873, cval_supplier_s_phone#3861 AS cval_supplier_s_phone_3#3874, cval_supplier_s_acctbal#3862 AS cval_supplier_s_acctbal_3#3875, cval_supplier_s_comment#3863 AS cval_supplier_s_comment_3#3876, cs_name#3864 AS cs_name_3#3877, cs_address#3865 AS cs_address_3#3878, cs_phone#3866 AS cs_phone_3#3879, cs_acctbal#3867 AS cs_acctbal_3#3880, cs_comment#3868 AS cs_comment_3#3881]
                  :        +- Relation[rid#3856,cpfk_nation_supplier#3857,cfpk_supplier_nation#3858,cval_supplier_s_name#3859,cval_supplier_s_address#3860,cval_supplier_s_phone#3861,cval_supplier_s_acctbal#3862,cval_supplier_s_comment#3863,cs_name#3864,cs_address#3865,cs_phone#3866,cs_acctbal#3867,cs_comment#3868] JDBCRelation(tsupplier) [numPartitions=1]
                  +- 'Join UsingJoin(LeftSemi,List(rid_4))
                     :- Project [rid#3882 AS rid_4#3889, cpfk_region_nation#3883 AS cpfk_region_nation_4#3890, cfpk_nation_region#3884 AS cfpk_nation_region_4#3891, cval_nation_n_name#3885 AS cval_nation_n_name_4#3892, cval_nation_n_comment#3886 AS cval_nation_n_comment_4#3893, cn_name#3887 AS cn_name_4#3894, cn_comment#3888 AS cn_comment_4#3895]
                     :  +- Relation[rid#3882,cpfk_region_nation#3883,cfpk_nation_region#3884,cval_nation_n_name#3885,cval_nation_n_comment#3886,cn_name#3887,cn_comment#3888] JDBCRelation(tnation) [numPartitions=1]
                     +- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation, 'rid_4
                        +- Project [rid#3896 AS rid_4#3903, cpfk_region_nation#3897 AS cpfk_region_nation_4#3904, cfpk_nation_region#3898 AS cfpk_nation_region_4#3905, cval_nation_n_name#3899 AS cval_nation_n_name_4#3906, cval_nation_n_comment#3900 AS cval_nation_n_comment_4#3907, cn_name#3901 AS cn_name_4#3908, cn_comment#3902 AS cn_comment_4#3909]
                           +- Relation[rid#3896,cpfk_region_nation#3897,cfpk_nation_region#3898,cval_nation_n_name#3899,cval_nation_n_comment#3900,cn_name#3901,cn_comment#3902] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 251153ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/11 07:39:14 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:39:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4021L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 07:39:14 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 07:39:14 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 07:39:14 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 07:39:14 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 07:39:14 WARN DexPlanner: InMemoryFileIndex=customer
20/04/11 07:39:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4021L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#4023 AS rid_0#4038, cpfk_nation_customer#4024 AS cpfk_nation_customer_0#4039, cfpk_customer_nation#4025 AS cfpk_customer_nation_0#4040, cval_customer_c_name#4026 AS cval_customer_c_name_0#4041, cval_customer_c_address#4027 AS cval_customer_c_address_0#4042, cval_customer_c_phone#4028 AS cval_customer_c_phone_0#4043, cval_customer_c_acctbal#4029 AS cval_customer_c_acctbal_0#4044, cval_customer_c_comment#4030 AS cval_customer_c_comment_0#4045, cval_customer_c_mktsegment#4031 AS cval_customer_c_mktsegment_0#4046, cc_name#4032 AS cc_name_0#4047, cc_address#4033 AS cc_address_0#4048, cc_phone#4034 AS cc_phone_0#4049, cc_acctbal#4035 AS cc_acctbal_0#4050, cc_comment#4036 AS cc_comment_0#4051, cc_mktsegment#4037 AS cc_mktsegment_0#4052]
         :  :  :  :  :  +- Relation[rid#4023,cpfk_nation_customer#4024,cfpk_customer_nation#4025,cval_customer_c_name#4026,cval_customer_c_address#4027,cval_customer_c_phone#4028,cval_customer_c_acctbal#4029,cval_customer_c_comment#4030,cval_customer_c_mktsegment#4031,cc_name#4032,cc_address#4033,cc_phone#4034,cc_acctbal#4035,cc_comment#4036,cc_mktsegment#4037] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer, 'rid_0
         :  :  :  :     +- Project [rid#4053 AS rid_0#4068, cpfk_nation_customer#4054 AS cpfk_nation_customer_0#4069, cfpk_customer_nation#4055 AS cfpk_customer_nation_0#4070, cval_customer_c_name#4056 AS cval_customer_c_name_0#4071, cval_customer_c_address#4057 AS cval_customer_c_address_0#4072, cval_customer_c_phone#4058 AS cval_customer_c_phone_0#4073, cval_customer_c_acctbal#4059 AS cval_customer_c_acctbal_0#4074, cval_customer_c_comment#4060 AS cval_customer_c_comment_0#4075, cval_customer_c_mktsegment#4061 AS cval_customer_c_mktsegment_0#4076, cc_name#4062 AS cc_name_0#4077, cc_address#4063 AS cc_address_0#4078, cc_phone#4064 AS cc_phone_0#4079, cc_acctbal#4065 AS cc_acctbal_0#4080, cc_comment#4066 AS cc_comment_0#4081, cc_mktsegment#4067 AS cc_mktsegment_0#4082]
         :  :  :  :        +- Relation[rid#4053,cpfk_nation_customer#4054,cfpk_customer_nation#4055,cval_customer_c_name#4056,cval_customer_c_address#4057,cval_customer_c_phone#4058,cval_customer_c_acctbal#4059,cval_customer_c_comment#4060,cval_customer_c_mktsegment#4061,cc_name#4062,cc_address#4063,cc_phone#4064,cc_acctbal#4065,cc_comment#4066,cc_mktsegment#4067] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#4117 AS rid_0#4132, cpfk_nation_customer#4118 AS cpfk_nation_customer_0#4133, cfpk_customer_nation#4119 AS cfpk_customer_nation_0#4134, cval_customer_c_name#4120 AS cval_customer_c_name_0#4135, cval_customer_c_address#4121 AS cval_customer_c_address_0#4136, cval_customer_c_phone#4122 AS cval_customer_c_phone_0#4137, cval_customer_c_acctbal#4123 AS cval_customer_c_acctbal_0#4138, cval_customer_c_comment#4124 AS cval_customer_c_comment_0#4139, cval_customer_c_mktsegment#4125 AS cval_customer_c_mktsegment_0#4140, cc_name#4126 AS cc_name_0#4141, cc_address#4127 AS cc_address_0#4142, cc_phone#4128 AS cc_phone_0#4143, cc_acctbal#4129 AS cc_acctbal_0#4144, cc_comment#4130 AS cc_comment_0#4145, cc_mktsegment#4131 AS cc_mktsegment_0#4146]
         :  :  :     :  +- Relation[rid#4117,cpfk_nation_customer#4118,cfpk_customer_nation#4119,cval_customer_c_name#4120,cval_customer_c_address#4121,cval_customer_c_phone#4122,cval_customer_c_acctbal#4123,cval_customer_c_comment#4124,cval_customer_c_mktsegment#4125,cc_name#4126,cc_address#4127,cc_phone#4128,cc_acctbal#4129,cc_comment#4130,cc_mktsegment#4131] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#4147 AS rid_1#4164, cpfk_customer_orders#4148 AS cpfk_customer_orders_1#4165, cfpk_orders_customer#4149 AS cfpk_orders_customer_1#4166, cval_orders_o_orderstatus#4150 AS cval_orders_o_orderstatus_1#4167, cval_orders_o_totalprice#4151 AS cval_orders_o_totalprice_1#4168, cval_orders_o_orderpriority#4152 AS cval_orders_o_orderpriority_1#4169, cval_orders_o_clerk#4153 AS cval_orders_o_clerk_1#4170, cval_orders_o_shippriority#4154 AS cval_orders_o_shippriority_1#4171, cval_orders_o_comment#4155 AS cval_orders_o_comment_1#4172, cval_orders_o_orderdate#4156 AS cval_orders_o_orderdate_1#4173, co_orderstatus#4157 AS co_orderstatus_1#4174, co_totalprice#4158 AS co_totalprice_1#4175, co_orderpriority#4159 AS co_orderpriority_1#4176, co_clerk#4160 AS co_clerk_1#4177, co_shippriority#4161 AS co_shippriority_1#4178, co_comment#4162 AS co_comment_1#4179, co_orderdate#4163 AS co_orderdate_1#4180]
         :  :  :        +- Relation[rid#4147,cpfk_customer_orders#4148,cfpk_orders_customer#4149,cval_orders_o_orderstatus#4150,cval_orders_o_totalprice#4151,cval_orders_o_orderpriority#4152,cval_orders_o_clerk#4153,cval_orders_o_shippriority#4154,cval_orders_o_comment#4155,cval_orders_o_orderdate#4156,co_orderstatus#4157,co_totalprice#4158,co_orderpriority#4159,co_clerk#4160,co_shippriority#4161,co_comment#4162,co_orderdate#4163] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#4083 AS rid_1#4100, cpfk_customer_orders#4084 AS cpfk_customer_orders_1#4101, cfpk_orders_customer#4085 AS cfpk_orders_customer_1#4102, cval_orders_o_orderstatus#4086 AS cval_orders_o_orderstatus_1#4103, cval_orders_o_totalprice#4087 AS cval_orders_o_totalprice_1#4104, cval_orders_o_orderpriority#4088 AS cval_orders_o_orderpriority_1#4105, cval_orders_o_clerk#4089 AS cval_orders_o_clerk_1#4106, cval_orders_o_shippriority#4090 AS cval_orders_o_shippriority_1#4107, cval_orders_o_comment#4091 AS cval_orders_o_comment_1#4108, cval_orders_o_orderdate#4092 AS cval_orders_o_orderdate_1#4109, co_orderstatus#4093 AS co_orderstatus_1#4110, co_totalprice#4094 AS co_totalprice_1#4111, co_orderpriority#4095 AS co_orderpriority_1#4112, co_clerk#4096 AS co_clerk_1#4113, co_shippriority#4097 AS co_shippriority_1#4114, co_comment#4098 AS co_comment_1#4115, co_orderdate#4099 AS co_orderdate_1#4116]
         :  :     +- Relation[rid#4083,cpfk_customer_orders#4084,cfpk_orders_customer#4085,cval_orders_o_orderstatus#4086,cval_orders_o_totalprice#4087,cval_orders_o_orderpriority#4088,cval_orders_o_clerk#4089,cval_orders_o_shippriority#4090,cval_orders_o_comment#4091,cval_orders_o_orderdate#4092,co_orderstatus#4093,co_totalprice#4094,co_orderpriority#4095,co_clerk#4096,co_shippriority#4097,co_comment#4098,co_orderdate#4099] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#4247 AS rid_1#4264, cpfk_customer_orders#4248 AS cpfk_customer_orders_1#4265, cfpk_orders_customer#4249 AS cfpk_orders_customer_1#4266, cval_orders_o_orderstatus#4250 AS cval_orders_o_orderstatus_1#4267, cval_orders_o_totalprice#4251 AS cval_orders_o_totalprice_1#4268, cval_orders_o_orderpriority#4252 AS cval_orders_o_orderpriority_1#4269, cval_orders_o_clerk#4253 AS cval_orders_o_clerk_1#4270, cval_orders_o_shippriority#4254 AS cval_orders_o_shippriority_1#4271, cval_orders_o_comment#4255 AS cval_orders_o_comment_1#4272, cval_orders_o_orderdate#4256 AS cval_orders_o_orderdate_1#4273, co_orderstatus#4257 AS co_orderstatus_1#4274, co_totalprice#4258 AS co_totalprice_1#4275, co_orderpriority#4259 AS co_orderpriority_1#4276, co_clerk#4260 AS co_clerk_1#4277, co_shippriority#4261 AS co_shippriority_1#4278, co_comment#4262 AS co_comment_1#4279, co_orderdate#4263 AS co_orderdate_1#4280]
         :     :  +- Relation[rid#4247,cpfk_customer_orders#4248,cfpk_orders_customer#4249,cval_orders_o_orderstatus#4250,cval_orders_o_totalprice#4251,cval_orders_o_orderpriority#4252,cval_orders_o_clerk#4253,cval_orders_o_shippriority#4254,cval_orders_o_comment#4255,cval_orders_o_orderdate#4256,co_orderstatus#4257,co_totalprice#4258,co_orderpriority#4259,co_clerk#4260,co_shippriority#4261,co_comment#4262,co_orderdate#4263] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#4281 AS rid_2#4314, cpfk_orders_lineitem#4282 AS cpfk_orders_lineitem_2#4315, cpfk_supplier_lineitem#4283 AS cpfk_supplier_lineitem_2#4316, cfpk_lineitem_supplier#4284 AS cfpk_lineitem_supplier_2#4317, cfpk_lineitem_partsupp#4285 AS cfpk_lineitem_partsupp_2#4318, cpfk_part_lineitem#4286 AS cpfk_part_lineitem_2#4319, cfpk_lineitem_part#4287 AS cfpk_lineitem_part_2#4320, cpfk_partsupp_lineitem#4288 AS cpfk_partsupp_lineitem_2#4321, cfpk_lineitem_orders#4289 AS cfpk_lineitem_orders_2#4322, cval_lineitem_l_quantity#4290 AS cval_lineitem_l_quantity_2#4323, cval_lineitem_l_extendedprice#4291 AS cval_lineitem_l_extendedprice_2#4324, cval_lineitem_l_discount#4292 AS cval_lineitem_l_discount_2#4325, cval_lineitem_l_tax#4293 AS cval_lineitem_l_tax_2#4326, cval_lineitem_l_returnflag#4294 AS cval_lineitem_l_returnflag_2#4327, cval_lineitem_l_linestatus#4295 AS cval_lineitem_l_linestatus_2#4328, cval_lineitem_l_commitdate#4296 AS cval_lineitem_l_commitdate_2#4329, cval_lineitem_l_receiptdate#4297 AS cval_lineitem_l_receiptdate_2#4330, cval_lineitem_l_shipinstruct#4298 AS cval_lineitem_l_shipinstruct_2#4331, cval_lineitem_l_shipmode#4299 AS cval_lineitem_l_shipmode_2#4332, cval_lineitem_l_comment#4300 AS cval_lineitem_l_comment_2#4333, cval_lineitem_l_shipdate#4301 AS cval_lineitem_l_shipdate_2#4334, cl_quantity#4302 AS cl_quantity_2#4335, cl_extendedprice#4303 AS cl_extendedprice_2#4336, cl_discount#4304 AS cl_discount_2#4337, ... 9 more fields]
         :        +- Relation[rid#4281,cpfk_orders_lineitem#4282,cpfk_supplier_lineitem#4283,cfpk_lineitem_supplier#4284,cfpk_lineitem_partsupp#4285,cpfk_part_lineitem#4286,cfpk_lineitem_part#4287,cpfk_partsupp_lineitem#4288,cfpk_lineitem_orders#4289,cval_lineitem_l_quantity#4290,cval_lineitem_l_extendedprice#4291,cval_lineitem_l_discount#4292,cval_lineitem_l_tax#4293,cval_lineitem_l_returnflag#4294,cval_lineitem_l_linestatus#4295,cval_lineitem_l_commitdate#4296,cval_lineitem_l_receiptdate#4297,cval_lineitem_l_shipinstruct#4298,cval_lineitem_l_shipmode#4299,cval_lineitem_l_comment#4300,cval_lineitem_l_shipdate#4301,cl_quantity#4302,cl_extendedprice#4303,cl_discount#4304,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4181 AS rid_2#4214, cpfk_orders_lineitem#4182 AS cpfk_orders_lineitem_2#4215, cpfk_supplier_lineitem#4183 AS cpfk_supplier_lineitem_2#4216, cfpk_lineitem_supplier#4184 AS cfpk_lineitem_supplier_2#4217, cfpk_lineitem_partsupp#4185 AS cfpk_lineitem_partsupp_2#4218, cpfk_part_lineitem#4186 AS cpfk_part_lineitem_2#4219, cfpk_lineitem_part#4187 AS cfpk_lineitem_part_2#4220, cpfk_partsupp_lineitem#4188 AS cpfk_partsupp_lineitem_2#4221, cfpk_lineitem_orders#4189 AS cfpk_lineitem_orders_2#4222, cval_lineitem_l_quantity#4190 AS cval_lineitem_l_quantity_2#4223, cval_lineitem_l_extendedprice#4191 AS cval_lineitem_l_extendedprice_2#4224, cval_lineitem_l_discount#4192 AS cval_lineitem_l_discount_2#4225, cval_lineitem_l_tax#4193 AS cval_lineitem_l_tax_2#4226, cval_lineitem_l_returnflag#4194 AS cval_lineitem_l_returnflag_2#4227, cval_lineitem_l_linestatus#4195 AS cval_lineitem_l_linestatus_2#4228, cval_lineitem_l_commitdate#4196 AS cval_lineitem_l_commitdate_2#4229, cval_lineitem_l_receiptdate#4197 AS cval_lineitem_l_receiptdate_2#4230, cval_lineitem_l_shipinstruct#4198 AS cval_lineitem_l_shipinstruct_2#4231, cval_lineitem_l_shipmode#4199 AS cval_lineitem_l_shipmode_2#4232, cval_lineitem_l_comment#4200 AS cval_lineitem_l_comment_2#4233, cval_lineitem_l_shipdate#4201 AS cval_lineitem_l_shipdate_2#4234, cl_quantity#4202 AS cl_quantity_2#4235, cl_extendedprice#4203 AS cl_extendedprice_2#4236, cl_discount#4204 AS cl_discount_2#4237, ... 9 more fields]
            +- Relation[rid#4181,cpfk_orders_lineitem#4182,cpfk_supplier_lineitem#4183,cfpk_lineitem_supplier#4184,cfpk_lineitem_partsupp#4185,cpfk_part_lineitem#4186,cfpk_lineitem_part#4187,cpfk_partsupp_lineitem#4188,cfpk_lineitem_orders#4189,cval_lineitem_l_quantity#4190,cval_lineitem_l_extendedprice#4191,cval_lineitem_l_discount#4192,cval_lineitem_l_tax#4193,cval_lineitem_l_returnflag#4194,cval_lineitem_l_linestatus#4195,cval_lineitem_l_commitdate#4196,cval_lineitem_l_receiptdate#4197,cval_lineitem_l_shipinstruct#4198,cval_lineitem_l_shipmode#4199,cval_lineitem_l_comment#4200,cval_lineitem_l_shipdate#4201,cl_quantity#4202,cl_extendedprice#4203,cl_discount#4204,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 116787ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/11 07:41:11 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:41:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4416L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 07:41:11 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:41:11 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:41:11 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:41:11 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:41:11 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:41:11 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:41:11 WARN DexPlanner: InMemoryFileIndex=part
20/04/11 07:41:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4416L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :- Project [rid#4418 AS rid_0#4435, cval_part_p_name#4419 AS cval_part_p_name_0#4436, cval_part_p_mfgr#4420 AS cval_part_p_mfgr_0#4437, cval_part_p_type#4421 AS cval_part_p_type_0#4438, cval_part_p_size#4422 AS cval_part_p_size_0#4439, cval_part_p_container#4423 AS cval_part_p_container_0#4440, cval_part_p_retailprice#4424 AS cval_part_p_retailprice_0#4441, cval_part_p_comment#4425 AS cval_part_p_comment_0#4442, cval_part_p_brand#4426 AS cval_part_p_brand_0#4443, cp_name#4427 AS cp_name_0#4444, cp_mfgr#4428 AS cp_mfgr_0#4445, cp_type#4429 AS cp_type_0#4446, cp_size#4430 AS cp_size_0#4447, cp_container#4431 AS cp_container_0#4448, cp_retailprice#4432 AS cp_retailprice_0#4449, cp_comment#4433 AS cp_comment_0#4450, cp_brand#4434 AS cp_brand_0#4451]
         :  :  :  :  +- Relation[rid#4418,cval_part_p_name#4419,cval_part_p_mfgr#4420,cval_part_p_type#4421,cval_part_p_size#4422,cval_part_p_container#4423,cval_part_p_retailprice#4424,cval_part_p_comment#4425,cval_part_p_brand#4426,cp_name#4427,cp_mfgr#4428,cp_type#4429,cp_size#4430,cp_container#4431,cp_retailprice#4432,cp_comment#4433,cp_brand#4434] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart, 'rid_0
         :  :  :     +- Project [rid#4452 AS rid_0#4469, cval_part_p_name#4453 AS cval_part_p_name_0#4470, cval_part_p_mfgr#4454 AS cval_part_p_mfgr_0#4471, cval_part_p_type#4455 AS cval_part_p_type_0#4472, cval_part_p_size#4456 AS cval_part_p_size_0#4473, cval_part_p_container#4457 AS cval_part_p_container_0#4474, cval_part_p_retailprice#4458 AS cval_part_p_retailprice_0#4475, cval_part_p_comment#4459 AS cval_part_p_comment_0#4476, cval_part_p_brand#4460 AS cval_part_p_brand_0#4477, cp_name#4461 AS cp_name_0#4478, cp_mfgr#4462 AS cp_mfgr_0#4479, cp_type#4463 AS cp_type_0#4480, cp_size#4464 AS cp_size_0#4481, cp_container#4465 AS cp_container_0#4482, cp_retailprice#4466 AS cp_retailprice_0#4483, cp_comment#4467 AS cp_comment_0#4484, cp_brand#4468 AS cp_brand_0#4485]
         :  :  :        +- Relation[rid#4452,cval_part_p_name#4453,cval_part_p_mfgr#4454,cval_part_p_type#4455,cval_part_p_size#4456,cval_part_p_container#4457,cval_part_p_retailprice#4458,cval_part_p_comment#4459,cval_part_p_brand#4460,cp_name#4461,cp_mfgr#4462,cp_type#4463,cp_size#4464,cp_container#4465,cp_retailprice#4466,cp_comment#4467,cp_brand#4468] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_container~MED BOX, cval_part_p_container, 'cval_part_p_container_0, tpart, 'rid_0
         :  :     +- Project [rid#4486 AS rid_0#4503, cval_part_p_name#4487 AS cval_part_p_name_0#4504, cval_part_p_mfgr#4488 AS cval_part_p_mfgr_0#4505, cval_part_p_type#4489 AS cval_part_p_type_0#4506, cval_part_p_size#4490 AS cval_part_p_size_0#4507, cval_part_p_container#4491 AS cval_part_p_container_0#4508, cval_part_p_retailprice#4492 AS cval_part_p_retailprice_0#4509, cval_part_p_comment#4493 AS cval_part_p_comment_0#4510, cval_part_p_brand#4494 AS cval_part_p_brand_0#4511, cp_name#4495 AS cp_name_0#4512, cp_mfgr#4496 AS cp_mfgr_0#4513, cp_type#4497 AS cp_type_0#4514, cp_size#4498 AS cp_size_0#4515, cp_container#4499 AS cp_container_0#4516, cp_retailprice#4500 AS cp_retailprice_0#4517, cp_comment#4501 AS cp_comment_0#4518, cp_brand#4502 AS cp_brand_0#4519]
         :  :        +- Relation[rid#4486,cval_part_p_name#4487,cval_part_p_mfgr#4488,cval_part_p_type#4489,cval_part_p_size#4490,cval_part_p_container#4491,cval_part_p_retailprice#4492,cval_part_p_comment#4493,cval_part_p_brand#4494,cp_name#4495,cp_mfgr#4496,cp_type#4497,cp_size#4498,cp_container#4499,cp_retailprice#4500,cp_comment#4501,cp_brand#4502] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#4586 AS rid_0#4603, cval_part_p_name#4587 AS cval_part_p_name_0#4604, cval_part_p_mfgr#4588 AS cval_part_p_mfgr_0#4605, cval_part_p_type#4589 AS cval_part_p_type_0#4606, cval_part_p_size#4590 AS cval_part_p_size_0#4607, cval_part_p_container#4591 AS cval_part_p_container_0#4608, cval_part_p_retailprice#4592 AS cval_part_p_retailprice_0#4609, cval_part_p_comment#4593 AS cval_part_p_comment_0#4610, cval_part_p_brand#4594 AS cval_part_p_brand_0#4611, cp_name#4595 AS cp_name_0#4612, cp_mfgr#4596 AS cp_mfgr_0#4613, cp_type#4597 AS cp_type_0#4614, cp_size#4598 AS cp_size_0#4615, cp_container#4599 AS cp_container_0#4616, cp_retailprice#4600 AS cp_retailprice_0#4617, cp_comment#4601 AS cp_comment_0#4618, cp_brand#4602 AS cp_brand_0#4619]
         :     :  +- Relation[rid#4586,cval_part_p_name#4587,cval_part_p_mfgr#4588,cval_part_p_type#4589,cval_part_p_size#4590,cval_part_p_container#4591,cval_part_p_retailprice#4592,cval_part_p_comment#4593,cval_part_p_brand#4594,cp_name#4595,cp_mfgr#4596,cp_type#4597,cp_size#4598,cp_container#4599,cp_retailprice#4600,cp_comment#4601,cp_brand#4602] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#4620 AS rid_1#4653, cpfk_orders_lineitem#4621 AS cpfk_orders_lineitem_1#4654, cpfk_supplier_lineitem#4622 AS cpfk_supplier_lineitem_1#4655, cfpk_lineitem_supplier#4623 AS cfpk_lineitem_supplier_1#4656, cfpk_lineitem_partsupp#4624 AS cfpk_lineitem_partsupp_1#4657, cpfk_part_lineitem#4625 AS cpfk_part_lineitem_1#4658, cfpk_lineitem_part#4626 AS cfpk_lineitem_part_1#4659, cpfk_partsupp_lineitem#4627 AS cpfk_partsupp_lineitem_1#4660, cfpk_lineitem_orders#4628 AS cfpk_lineitem_orders_1#4661, cval_lineitem_l_quantity#4629 AS cval_lineitem_l_quantity_1#4662, cval_lineitem_l_extendedprice#4630 AS cval_lineitem_l_extendedprice_1#4663, cval_lineitem_l_discount#4631 AS cval_lineitem_l_discount_1#4664, cval_lineitem_l_tax#4632 AS cval_lineitem_l_tax_1#4665, cval_lineitem_l_returnflag#4633 AS cval_lineitem_l_returnflag_1#4666, cval_lineitem_l_linestatus#4634 AS cval_lineitem_l_linestatus_1#4667, cval_lineitem_l_commitdate#4635 AS cval_lineitem_l_commitdate_1#4668, cval_lineitem_l_receiptdate#4636 AS cval_lineitem_l_receiptdate_1#4669, cval_lineitem_l_shipinstruct#4637 AS cval_lineitem_l_shipinstruct_1#4670, cval_lineitem_l_shipmode#4638 AS cval_lineitem_l_shipmode_1#4671, cval_lineitem_l_comment#4639 AS cval_lineitem_l_comment_1#4672, cval_lineitem_l_shipdate#4640 AS cval_lineitem_l_shipdate_1#4673, cl_quantity#4641 AS cl_quantity_1#4674, cl_extendedprice#4642 AS cl_extendedprice_1#4675, cl_discount#4643 AS cl_discount_1#4676, ... 9 more fields]
         :        +- Relation[rid#4620,cpfk_orders_lineitem#4621,cpfk_supplier_lineitem#4622,cfpk_lineitem_supplier#4623,cfpk_lineitem_partsupp#4624,cpfk_part_lineitem#4625,cfpk_lineitem_part#4626,cpfk_partsupp_lineitem#4627,cfpk_lineitem_orders#4628,cval_lineitem_l_quantity#4629,cval_lineitem_l_extendedprice#4630,cval_lineitem_l_discount#4631,cval_lineitem_l_tax#4632,cval_lineitem_l_returnflag#4633,cval_lineitem_l_linestatus#4634,cval_lineitem_l_commitdate#4635,cval_lineitem_l_receiptdate#4636,cval_lineitem_l_shipinstruct#4637,cval_lineitem_l_shipmode#4638,cval_lineitem_l_comment#4639,cval_lineitem_l_shipdate#4640,cl_quantity#4641,cl_extendedprice#4642,cl_discount#4643,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4520 AS rid_1#4553, cpfk_orders_lineitem#4521 AS cpfk_orders_lineitem_1#4554, cpfk_supplier_lineitem#4522 AS cpfk_supplier_lineitem_1#4555, cfpk_lineitem_supplier#4523 AS cfpk_lineitem_supplier_1#4556, cfpk_lineitem_partsupp#4524 AS cfpk_lineitem_partsupp_1#4557, cpfk_part_lineitem#4525 AS cpfk_part_lineitem_1#4558, cfpk_lineitem_part#4526 AS cfpk_lineitem_part_1#4559, cpfk_partsupp_lineitem#4527 AS cpfk_partsupp_lineitem_1#4560, cfpk_lineitem_orders#4528 AS cfpk_lineitem_orders_1#4561, cval_lineitem_l_quantity#4529 AS cval_lineitem_l_quantity_1#4562, cval_lineitem_l_extendedprice#4530 AS cval_lineitem_l_extendedprice_1#4563, cval_lineitem_l_discount#4531 AS cval_lineitem_l_discount_1#4564, cval_lineitem_l_tax#4532 AS cval_lineitem_l_tax_1#4565, cval_lineitem_l_returnflag#4533 AS cval_lineitem_l_returnflag_1#4566, cval_lineitem_l_linestatus#4534 AS cval_lineitem_l_linestatus_1#4567, cval_lineitem_l_commitdate#4535 AS cval_lineitem_l_commitdate_1#4568, cval_lineitem_l_receiptdate#4536 AS cval_lineitem_l_receiptdate_1#4569, cval_lineitem_l_shipinstruct#4537 AS cval_lineitem_l_shipinstruct_1#4570, cval_lineitem_l_shipmode#4538 AS cval_lineitem_l_shipmode_1#4571, cval_lineitem_l_comment#4539 AS cval_lineitem_l_comment_1#4572, cval_lineitem_l_shipdate#4540 AS cval_lineitem_l_shipdate_1#4573, cl_quantity#4541 AS cl_quantity_1#4574, cl_extendedprice#4542 AS cl_extendedprice_1#4575, cl_discount#4543 AS cl_discount_1#4576, ... 9 more fields]
            +- Relation[rid#4520,cpfk_orders_lineitem#4521,cpfk_supplier_lineitem#4522,cfpk_lineitem_supplier#4523,cfpk_lineitem_partsupp#4524,cpfk_part_lineitem#4525,cfpk_lineitem_part#4526,cpfk_partsupp_lineitem#4527,cfpk_lineitem_orders#4528,cval_lineitem_l_quantity#4529,cval_lineitem_l_extendedprice#4530,cval_lineitem_l_discount#4531,cval_lineitem_l_tax#4532,cval_lineitem_l_returnflag#4533,cval_lineitem_l_linestatus#4534,cval_lineitem_l_commitdate#4535,cval_lineitem_l_receiptdate#4536,cval_lineitem_l_shipinstruct#4537,cval_lineitem_l_shipmode#4538,cval_lineitem_l_comment#4539,cval_lineitem_l_shipdate#4540,cl_quantity#4541,cl_extendedprice#4542,cl_discount#4543,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 71722ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/11 07:42:22 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:42:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4742L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 07:42:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:42:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:42:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:42:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:42:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:42:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:42:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:42:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:42:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:42:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:42:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:42:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:42:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:42:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4742L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :- Project [rid#4744 AS rid_0#4751, cpfk_region_nation#4745 AS cpfk_region_nation_0#4752, cfpk_nation_region#4746 AS cfpk_nation_region_0#4753, cval_nation_n_name#4747 AS cval_nation_n_name_0#4754, cval_nation_n_comment#4748 AS cval_nation_n_comment_0#4755, cn_name#4749 AS cn_name_0#4756, cn_comment#4750 AS cn_comment_0#4757]
         :  :  :  :  :  +- Relation[rid#4744,cpfk_region_nation#4745,cfpk_nation_region#4746,cval_nation_n_name#4747,cval_nation_n_comment#4748,cn_name#4749,cn_comment#4750] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation, 'rid_0
         :  :  :  :     +- Project [rid#4758 AS rid_0#4765, cpfk_region_nation#4759 AS cpfk_region_nation_0#4766, cfpk_nation_region#4760 AS cfpk_nation_region_0#4767, cval_nation_n_name#4761 AS cval_nation_n_name_0#4768, cval_nation_n_comment#4762 AS cval_nation_n_comment_0#4769, cn_name#4763 AS cn_name_0#4770, cn_comment#4764 AS cn_comment_0#4771]
         :  :  :  :        +- Relation[rid#4758,cpfk_region_nation#4759,cfpk_nation_region#4760,cval_nation_n_name#4761,cval_nation_n_comment#4762,cn_name#4763,cn_comment#4764] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
         :  :  :     :- Project [rid#4798 AS rid_0#4805, cpfk_region_nation#4799 AS cpfk_region_nation_0#4806, cfpk_nation_region#4800 AS cfpk_nation_region_0#4807, cval_nation_n_name#4801 AS cval_nation_n_name_0#4808, cval_nation_n_comment#4802 AS cval_nation_n_comment_0#4809, cn_name#4803 AS cn_name_0#4810, cn_comment#4804 AS cn_comment_0#4811]
         :  :  :     :  +- Relation[rid#4798,cpfk_region_nation#4799,cfpk_nation_region#4800,cval_nation_n_name#4801,cval_nation_n_comment#4802,cn_name#4803,cn_comment#4804] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#4812 AS rid_1#4825, cpfk_nation_supplier#4813 AS cpfk_nation_supplier_1#4826, cfpk_supplier_nation#4814 AS cfpk_supplier_nation_1#4827, cval_supplier_s_name#4815 AS cval_supplier_s_name_1#4828, cval_supplier_s_address#4816 AS cval_supplier_s_address_1#4829, cval_supplier_s_phone#4817 AS cval_supplier_s_phone_1#4830, cval_supplier_s_acctbal#4818 AS cval_supplier_s_acctbal_1#4831, cval_supplier_s_comment#4819 AS cval_supplier_s_comment_1#4832, cs_name#4820 AS cs_name_1#4833, cs_address#4821 AS cs_address_1#4834, cs_phone#4822 AS cs_phone_1#4835, cs_acctbal#4823 AS cs_acctbal_1#4836, cs_comment#4824 AS cs_comment_1#4837]
         :  :  :        +- Relation[rid#4812,cpfk_nation_supplier#4813,cfpk_supplier_nation#4814,cval_supplier_s_name#4815,cval_supplier_s_address#4816,cval_supplier_s_phone#4817,cval_supplier_s_acctbal#4818,cval_supplier_s_comment#4819,cs_name#4820,cs_address#4821,cs_phone#4822,cs_acctbal#4823,cs_comment#4824] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#4772 AS rid_1#4785, cpfk_nation_supplier#4773 AS cpfk_nation_supplier_1#4786, cfpk_supplier_nation#4774 AS cfpk_supplier_nation_1#4787, cval_supplier_s_name#4775 AS cval_supplier_s_name_1#4788, cval_supplier_s_address#4776 AS cval_supplier_s_address_1#4789, cval_supplier_s_phone#4777 AS cval_supplier_s_phone_1#4790, cval_supplier_s_acctbal#4778 AS cval_supplier_s_acctbal_1#4791, cval_supplier_s_comment#4779 AS cval_supplier_s_comment_1#4792, cs_name#4780 AS cs_name_1#4793, cs_address#4781 AS cs_address_1#4794, cs_phone#4782 AS cs_phone_1#4795, cs_acctbal#4783 AS cs_acctbal_1#4796, cs_comment#4784 AS cs_comment_1#4797]
         :  :     +- Relation[rid#4772,cpfk_nation_supplier#4773,cfpk_supplier_nation#4774,cval_supplier_s_name#4775,cval_supplier_s_address#4776,cval_supplier_s_phone#4777,cval_supplier_s_acctbal#4778,cval_supplier_s_comment#4779,cs_name#4780,cs_address#4781,cs_phone#4782,cs_acctbal#4783,cs_comment#4784] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
         :     :- Project [rid#4860 AS rid_1#4873, cpfk_nation_supplier#4861 AS cpfk_nation_supplier_1#4874, cfpk_supplier_nation#4862 AS cfpk_supplier_nation_1#4875, cval_supplier_s_name#4863 AS cval_supplier_s_name_1#4876, cval_supplier_s_address#4864 AS cval_supplier_s_address_1#4877, cval_supplier_s_phone#4865 AS cval_supplier_s_phone_1#4878, cval_supplier_s_acctbal#4866 AS cval_supplier_s_acctbal_1#4879, cval_supplier_s_comment#4867 AS cval_supplier_s_comment_1#4880, cs_name#4868 AS cs_name_1#4881, cs_address#4869 AS cs_address_1#4882, cs_phone#4870 AS cs_phone_1#4883, cs_acctbal#4871 AS cs_acctbal_1#4884, cs_comment#4872 AS cs_comment_1#4885]
         :     :  +- Relation[rid#4860,cpfk_nation_supplier#4861,cfpk_supplier_nation#4862,cval_supplier_s_name#4863,cval_supplier_s_address#4864,cval_supplier_s_phone#4865,cval_supplier_s_acctbal#4866,cval_supplier_s_comment#4867,cs_name#4868,cs_address#4869,cs_phone#4870,cs_acctbal#4871,cs_comment#4872] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#4886 AS rid_2#4897, cpfk_part_partsupp#4887 AS cpfk_part_partsupp_2#4898, cfpk_partsupp_part#4888 AS cfpk_partsupp_part_2#4899, cpfk_supplier_partsupp#4889 AS cpfk_supplier_partsupp_2#4900, cfpk_partsupp_supplier#4890 AS cfpk_partsupp_supplier_2#4901, cval_partsupp_ps_availqty#4891 AS cval_partsupp_ps_availqty_2#4902, cval_partsupp_ps_supplycost#4892 AS cval_partsupp_ps_supplycost_2#4903, cval_partsupp_ps_comment#4893 AS cval_partsupp_ps_comment_2#4904, cps_availqty#4894 AS cps_availqty_2#4905, cps_supplycost#4895 AS cps_supplycost_2#4906, cps_comment#4896 AS cps_comment_2#4907]
         :        +- Relation[rid#4886,cpfk_part_partsupp#4887,cfpk_partsupp_part#4888,cpfk_supplier_partsupp#4889,cfpk_partsupp_supplier#4890,cval_partsupp_ps_availqty#4891,cval_partsupp_ps_supplycost#4892,cval_partsupp_ps_comment#4893,cps_availqty#4894,cps_supplycost#4895,cps_comment#4896] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#4838 AS rid_2#4849, cpfk_part_partsupp#4839 AS cpfk_part_partsupp_2#4850, cfpk_partsupp_part#4840 AS cfpk_partsupp_part_2#4851, cpfk_supplier_partsupp#4841 AS cpfk_supplier_partsupp_2#4852, cfpk_partsupp_supplier#4842 AS cfpk_partsupp_supplier_2#4853, cval_partsupp_ps_availqty#4843 AS cval_partsupp_ps_availqty_2#4854, cval_partsupp_ps_supplycost#4844 AS cval_partsupp_ps_supplycost_2#4855, cval_partsupp_ps_comment#4845 AS cval_partsupp_ps_comment_2#4856, cps_availqty#4846 AS cps_availqty_2#4857, cps_supplycost#4847 AS cps_supplycost_2#4858, cps_comment#4848 AS cps_comment_2#4859]
            +- Relation[rid#4838,cpfk_part_partsupp#4839,cfpk_partsupp_part#4840,cpfk_supplier_partsupp#4841,cfpk_partsupp_supplier#4842,cval_partsupp_ps_availqty#4843,cval_partsupp_ps_supplycost#4844,cval_partsupp_ps_comment#4845,cps_availqty#4846,cps_supplycost#4847,cps_comment#4848] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 10628ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/11 07:42:33 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:42:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4945L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/11 07:42:33 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:42:33 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:42:33 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:42:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:42:33 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:42:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:42:33 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:42:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:42:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:42:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:42:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:42:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:42:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:42:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:42:33 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:42:33 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:42:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4945L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(LeftSemi,List(rid_1))
         :- 'Project [*]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
         :     :- 'Join UsingJoin(Inner,List(rid_4))
         :     :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :- 'Join UsingJoin(Inner,List(rid_3))
         :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :     :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :     :  :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :     :  :  :  :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :  :  :  :  :  :  :  :- Project [rid#4947 AS rid_0#4952, cval_region_r_name#4948 AS cval_region_r_name_0#4953, cval_region_r_comment#4949 AS cval_region_r_comment_0#4954, cr_name#4950 AS cr_name_0#4955, cr_comment#4951 AS cr_comment_0#4956]
         :     :  :  :  :  :  :  :  :  :  :  +- Relation[rid#4947,cval_region_r_name#4948,cval_region_r_comment#4949,cr_name#4950,cr_comment#4951] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :     :  :  :  :  :  :  :  :  :     +- Project [rid#4957 AS rid_0#4962, cval_region_r_name#4958 AS cval_region_r_name_0#4963, cval_region_r_comment#4959 AS cval_region_r_comment_0#4964, cr_name#4960 AS cr_name_0#4965, cr_comment#4961 AS cr_comment_0#4966]
         :     :  :  :  :  :  :  :  :  :        +- Relation[rid#4957,cval_region_r_name#4958,cval_region_r_comment#4959,cr_name#4960,cr_comment#4961] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :     :  :  :  :  :  :  :  :     :- Project [rid#4981 AS rid_0#4986, cval_region_r_name#4982 AS cval_region_r_name_0#4987, cval_region_r_comment#4983 AS cval_region_r_comment_0#4988, cr_name#4984 AS cr_name_0#4989, cr_comment#4985 AS cr_comment_0#4990]
         :     :  :  :  :  :  :  :  :     :  +- Relation[rid#4981,cval_region_r_name#4982,cval_region_r_comment#4983,cr_name#4984,cr_comment#4985] JDBCRelation(tregion) [numPartitions=1]
         :     :  :  :  :  :  :  :  :     +- Project [rid#4991 AS rid_1#4998, cpfk_region_nation#4992 AS cpfk_region_nation_1#4999, cfpk_nation_region#4993 AS cfpk_nation_region_1#5000, cval_nation_n_name#4994 AS cval_nation_n_name_1#5001, cval_nation_n_comment#4995 AS cval_nation_n_comment_1#5002, cn_name#4996 AS cn_name_1#5003, cn_comment#4997 AS cn_comment_1#5004]
         :     :  :  :  :  :  :  :  :        +- Relation[rid#4991,cpfk_region_nation#4992,cfpk_nation_region#4993,cval_nation_n_name#4994,cval_nation_n_comment#4995,cn_name#4996,cn_comment#4997] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  :  +- Project [rid#4967 AS rid_1#4974, cpfk_region_nation#4968 AS cpfk_region_nation_1#4975, cfpk_nation_region#4969 AS cfpk_nation_region_1#4976, cval_nation_n_name#4970 AS cval_nation_n_name_1#4977, cval_nation_n_comment#4971 AS cval_nation_n_comment_1#4978, cn_name#4972 AS cn_name_1#4979, cn_comment#4973 AS cn_comment_1#4980]
         :     :  :  :  :  :  :  :     +- Relation[rid#4967,cpfk_region_nation#4968,cfpk_nation_region#4969,cval_nation_n_name#4970,cval_nation_n_comment#4971,cn_name#4972,cn_comment#4973] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_2, tnation, 'rid_1, tcustomer, 'rid_2
         :     :  :  :  :  :  :     :- Project [rid#5035 AS rid_1#5042, cpfk_region_nation#5036 AS cpfk_region_nation_1#5043, cfpk_nation_region#5037 AS cfpk_nation_region_1#5044, cval_nation_n_name#5038 AS cval_nation_n_name_1#5045, cval_nation_n_comment#5039 AS cval_nation_n_comment_1#5046, cn_name#5040 AS cn_name_1#5047, cn_comment#5041 AS cn_comment_1#5048]
         :     :  :  :  :  :  :     :  +- Relation[rid#5035,cpfk_region_nation#5036,cfpk_nation_region#5037,cval_nation_n_name#5038,cval_nation_n_comment#5039,cn_name#5040,cn_comment#5041] JDBCRelation(tnation) [numPartitions=1]
         :     :  :  :  :  :  :     +- Project [rid#5049 AS rid_2#5064, cpfk_nation_customer#5050 AS cpfk_nation_customer_2#5065, cfpk_customer_nation#5051 AS cfpk_customer_nation_2#5066, cval_customer_c_name#5052 AS cval_customer_c_name_2#5067, cval_customer_c_address#5053 AS cval_customer_c_address_2#5068, cval_customer_c_phone#5054 AS cval_customer_c_phone_2#5069, cval_customer_c_acctbal#5055 AS cval_customer_c_acctbal_2#5070, cval_customer_c_comment#5056 AS cval_customer_c_comment_2#5071, cval_customer_c_mktsegment#5057 AS cval_customer_c_mktsegment_2#5072, cc_name#5058 AS cc_name_2#5073, cc_address#5059 AS cc_address_2#5074, cc_phone#5060 AS cc_phone_2#5075, cc_acctbal#5061 AS cc_acctbal_2#5076, cc_comment#5062 AS cc_comment_2#5077, cc_mktsegment#5063 AS cc_mktsegment_2#5078]
         :     :  :  :  :  :  :        +- Relation[rid#5049,cpfk_nation_customer#5050,cfpk_customer_nation#5051,cval_customer_c_name#5052,cval_customer_c_address#5053,cval_customer_c_phone#5054,cval_customer_c_acctbal#5055,cval_customer_c_comment#5056,cval_customer_c_mktsegment#5057,cc_name#5058,cc_address#5059,cc_phone#5060,cc_acctbal#5061,cc_comment#5062,cc_mktsegment#5063] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  :  +- Project [rid#5005 AS rid_2#5020, cpfk_nation_customer#5006 AS cpfk_nation_customer_2#5021, cfpk_customer_nation#5007 AS cfpk_customer_nation_2#5022, cval_customer_c_name#5008 AS cval_customer_c_name_2#5023, cval_customer_c_address#5009 AS cval_customer_c_address_2#5024, cval_customer_c_phone#5010 AS cval_customer_c_phone_2#5025, cval_customer_c_acctbal#5011 AS cval_customer_c_acctbal_2#5026, cval_customer_c_comment#5012 AS cval_customer_c_comment_2#5027, cval_customer_c_mktsegment#5013 AS cval_customer_c_mktsegment_2#5028, cc_name#5014 AS cc_name_2#5029, cc_address#5015 AS cc_address_2#5030, cc_phone#5016 AS cc_phone_2#5031, cc_acctbal#5017 AS cc_acctbal_2#5032, cc_comment#5018 AS cc_comment_2#5033, cc_mktsegment#5019 AS cc_mktsegment_2#5034]
         :     :  :  :  :  :     +- Relation[rid#5005,cpfk_nation_customer#5006,cfpk_customer_nation#5007,cval_customer_c_name#5008,cval_customer_c_address#5009,cval_customer_c_phone#5010,cval_customer_c_acctbal#5011,cval_customer_c_comment#5012,cval_customer_c_mktsegment#5013,cc_name#5014,cc_address#5015,cc_phone#5016,cc_acctbal#5017,cc_comment#5018,cc_mktsegment#5019] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_3, tcustomer, 'rid_2, torders, 'rid_3
         :     :  :  :  :     :- Project [rid#5113 AS rid_2#5128, cpfk_nation_customer#5114 AS cpfk_nation_customer_2#5129, cfpk_customer_nation#5115 AS cfpk_customer_nation_2#5130, cval_customer_c_name#5116 AS cval_customer_c_name_2#5131, cval_customer_c_address#5117 AS cval_customer_c_address_2#5132, cval_customer_c_phone#5118 AS cval_customer_c_phone_2#5133, cval_customer_c_acctbal#5119 AS cval_customer_c_acctbal_2#5134, cval_customer_c_comment#5120 AS cval_customer_c_comment_2#5135, cval_customer_c_mktsegment#5121 AS cval_customer_c_mktsegment_2#5136, cc_name#5122 AS cc_name_2#5137, cc_address#5123 AS cc_address_2#5138, cc_phone#5124 AS cc_phone_2#5139, cc_acctbal#5125 AS cc_acctbal_2#5140, cc_comment#5126 AS cc_comment_2#5141, cc_mktsegment#5127 AS cc_mktsegment_2#5142]
         :     :  :  :  :     :  +- Relation[rid#5113,cpfk_nation_customer#5114,cfpk_customer_nation#5115,cval_customer_c_name#5116,cval_customer_c_address#5117,cval_customer_c_phone#5118,cval_customer_c_acctbal#5119,cval_customer_c_comment#5120,cval_customer_c_mktsegment#5121,cc_name#5122,cc_address#5123,cc_phone#5124,cc_acctbal#5125,cc_comment#5126,cc_mktsegment#5127] JDBCRelation(tcustomer) [numPartitions=1]
         :     :  :  :  :     +- Project [rid#5143 AS rid_3#5160, cpfk_customer_orders#5144 AS cpfk_customer_orders_3#5161, cfpk_orders_customer#5145 AS cfpk_orders_customer_3#5162, cval_orders_o_orderstatus#5146 AS cval_orders_o_orderstatus_3#5163, cval_orders_o_totalprice#5147 AS cval_orders_o_totalprice_3#5164, cval_orders_o_orderpriority#5148 AS cval_orders_o_orderpriority_3#5165, cval_orders_o_clerk#5149 AS cval_orders_o_clerk_3#5166, cval_orders_o_shippriority#5150 AS cval_orders_o_shippriority_3#5167, cval_orders_o_comment#5151 AS cval_orders_o_comment_3#5168, cval_orders_o_orderdate#5152 AS cval_orders_o_orderdate_3#5169, co_orderstatus#5153 AS co_orderstatus_3#5170, co_totalprice#5154 AS co_totalprice_3#5171, co_orderpriority#5155 AS co_orderpriority_3#5172, co_clerk#5156 AS co_clerk_3#5173, co_shippriority#5157 AS co_shippriority_3#5174, co_comment#5158 AS co_comment_3#5175, co_orderdate#5159 AS co_orderdate_3#5176]
         :     :  :  :  :        +- Relation[rid#5143,cpfk_customer_orders#5144,cfpk_orders_customer#5145,cval_orders_o_orderstatus#5146,cval_orders_o_totalprice#5147,cval_orders_o_orderpriority#5148,cval_orders_o_clerk#5149,cval_orders_o_shippriority#5150,cval_orders_o_comment#5151,cval_orders_o_orderdate#5152,co_orderstatus#5153,co_totalprice#5154,co_orderpriority#5155,co_clerk#5156,co_shippriority#5157,co_comment#5158,co_orderdate#5159] JDBCRelation(torders) [numPartitions=1]
         :     :  :  :  +- Project [rid#5079 AS rid_3#5096, cpfk_customer_orders#5080 AS cpfk_customer_orders_3#5097, cfpk_orders_customer#5081 AS cfpk_orders_customer_3#5098, cval_orders_o_orderstatus#5082 AS cval_orders_o_orderstatus_3#5099, cval_orders_o_totalprice#5083 AS cval_orders_o_totalprice_3#5100, cval_orders_o_orderpriority#5084 AS cval_orders_o_orderpriority_3#5101, cval_orders_o_clerk#5085 AS cval_orders_o_clerk_3#5102, cval_orders_o_shippriority#5086 AS cval_orders_o_shippriority_3#5103, cval_orders_o_comment#5087 AS cval_orders_o_comment_3#5104, cval_orders_o_orderdate#5088 AS cval_orders_o_orderdate_3#5105, co_orderstatus#5089 AS co_orderstatus_3#5106, co_totalprice#5090 AS co_totalprice_3#5107, co_orderpriority#5091 AS co_orderpriority_3#5108, co_clerk#5092 AS co_clerk_3#5109, co_shippriority#5093 AS co_shippriority_3#5110, co_comment#5094 AS co_comment_3#5111, co_orderdate#5095 AS co_orderdate_3#5112]
         :     :  :  :     +- Relation[rid#5079,cpfk_customer_orders#5080,cfpk_orders_customer#5081,cval_orders_o_orderstatus#5082,cval_orders_o_totalprice#5083,cval_orders_o_orderpriority#5084,cval_orders_o_clerk#5085,cval_orders_o_shippriority#5086,cval_orders_o_comment#5087,cval_orders_o_orderdate#5088,co_orderstatus#5089,co_totalprice#5090,co_orderpriority#5091,co_clerk#5092,co_shippriority#5093,co_comment#5094,co_orderdate#5095] JDBCRelation(torders) [numPartitions=1]
         :     :  :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_4, torders, 'rid_3, tlineitem, 'rid_4
         :     :  :     :- Project [rid#5243 AS rid_3#5260, cpfk_customer_orders#5244 AS cpfk_customer_orders_3#5261, cfpk_orders_customer#5245 AS cfpk_orders_customer_3#5262, cval_orders_o_orderstatus#5246 AS cval_orders_o_orderstatus_3#5263, cval_orders_o_totalprice#5247 AS cval_orders_o_totalprice_3#5264, cval_orders_o_orderpriority#5248 AS cval_orders_o_orderpriority_3#5265, cval_orders_o_clerk#5249 AS cval_orders_o_clerk_3#5266, cval_orders_o_shippriority#5250 AS cval_orders_o_shippriority_3#5267, cval_orders_o_comment#5251 AS cval_orders_o_comment_3#5268, cval_orders_o_orderdate#5252 AS cval_orders_o_orderdate_3#5269, co_orderstatus#5253 AS co_orderstatus_3#5270, co_totalprice#5254 AS co_totalprice_3#5271, co_orderpriority#5255 AS co_orderpriority_3#5272, co_clerk#5256 AS co_clerk_3#5273, co_shippriority#5257 AS co_shippriority_3#5274, co_comment#5258 AS co_comment_3#5275, co_orderdate#5259 AS co_orderdate_3#5276]
         :     :  :     :  +- Relation[rid#5243,cpfk_customer_orders#5244,cfpk_orders_customer#5245,cval_orders_o_orderstatus#5246,cval_orders_o_totalprice#5247,cval_orders_o_orderpriority#5248,cval_orders_o_clerk#5249,cval_orders_o_shippriority#5250,cval_orders_o_comment#5251,cval_orders_o_orderdate#5252,co_orderstatus#5253,co_totalprice#5254,co_orderpriority#5255,co_clerk#5256,co_shippriority#5257,co_comment#5258,co_orderdate#5259] JDBCRelation(torders) [numPartitions=1]
         :     :  :     +- Project [rid#5277 AS rid_4#5310, cpfk_orders_lineitem#5278 AS cpfk_orders_lineitem_4#5311, cpfk_supplier_lineitem#5279 AS cpfk_supplier_lineitem_4#5312, cfpk_lineitem_supplier#5280 AS cfpk_lineitem_supplier_4#5313, cfpk_lineitem_partsupp#5281 AS cfpk_lineitem_partsupp_4#5314, cpfk_part_lineitem#5282 AS cpfk_part_lineitem_4#5315, cfpk_lineitem_part#5283 AS cfpk_lineitem_part_4#5316, cpfk_partsupp_lineitem#5284 AS cpfk_partsupp_lineitem_4#5317, cfpk_lineitem_orders#5285 AS cfpk_lineitem_orders_4#5318, cval_lineitem_l_quantity#5286 AS cval_lineitem_l_quantity_4#5319, cval_lineitem_l_extendedprice#5287 AS cval_lineitem_l_extendedprice_4#5320, cval_lineitem_l_discount#5288 AS cval_lineitem_l_discount_4#5321, cval_lineitem_l_tax#5289 AS cval_lineitem_l_tax_4#5322, cval_lineitem_l_returnflag#5290 AS cval_lineitem_l_returnflag_4#5323, cval_lineitem_l_linestatus#5291 AS cval_lineitem_l_linestatus_4#5324, cval_lineitem_l_commitdate#5292 AS cval_lineitem_l_commitdate_4#5325, cval_lineitem_l_receiptdate#5293 AS cval_lineitem_l_receiptdate_4#5326, cval_lineitem_l_shipinstruct#5294 AS cval_lineitem_l_shipinstruct_4#5327, cval_lineitem_l_shipmode#5295 AS cval_lineitem_l_shipmode_4#5328, cval_lineitem_l_comment#5296 AS cval_lineitem_l_comment_4#5329, cval_lineitem_l_shipdate#5297 AS cval_lineitem_l_shipdate_4#5330, cl_quantity#5298 AS cl_quantity_4#5331, cl_extendedprice#5299 AS cl_extendedprice_4#5332, cl_discount#5300 AS cl_discount_4#5333, ... 9 more fields]
         :     :  :        +- Relation[rid#5277,cpfk_orders_lineitem#5278,cpfk_supplier_lineitem#5279,cfpk_lineitem_supplier#5280,cfpk_lineitem_partsupp#5281,cpfk_part_lineitem#5282,cfpk_lineitem_part#5283,cpfk_partsupp_lineitem#5284,cfpk_lineitem_orders#5285,cval_lineitem_l_quantity#5286,cval_lineitem_l_extendedprice#5287,cval_lineitem_l_discount#5288,cval_lineitem_l_tax#5289,cval_lineitem_l_returnflag#5290,cval_lineitem_l_linestatus#5291,cval_lineitem_l_commitdate#5292,cval_lineitem_l_receiptdate#5293,cval_lineitem_l_shipinstruct#5294,cval_lineitem_l_shipmode#5295,cval_lineitem_l_comment#5296,cval_lineitem_l_shipdate#5297,cl_quantity#5298,cl_extendedprice#5299,cl_discount#5300,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     :  +- Project [rid#5177 AS rid_4#5210, cpfk_orders_lineitem#5178 AS cpfk_orders_lineitem_4#5211, cpfk_supplier_lineitem#5179 AS cpfk_supplier_lineitem_4#5212, cfpk_lineitem_supplier#5180 AS cfpk_lineitem_supplier_4#5213, cfpk_lineitem_partsupp#5181 AS cfpk_lineitem_partsupp_4#5214, cpfk_part_lineitem#5182 AS cpfk_part_lineitem_4#5215, cfpk_lineitem_part#5183 AS cfpk_lineitem_part_4#5216, cpfk_partsupp_lineitem#5184 AS cpfk_partsupp_lineitem_4#5217, cfpk_lineitem_orders#5185 AS cfpk_lineitem_orders_4#5218, cval_lineitem_l_quantity#5186 AS cval_lineitem_l_quantity_4#5219, cval_lineitem_l_extendedprice#5187 AS cval_lineitem_l_extendedprice_4#5220, cval_lineitem_l_discount#5188 AS cval_lineitem_l_discount_4#5221, cval_lineitem_l_tax#5189 AS cval_lineitem_l_tax_4#5222, cval_lineitem_l_returnflag#5190 AS cval_lineitem_l_returnflag_4#5223, cval_lineitem_l_linestatus#5191 AS cval_lineitem_l_linestatus_4#5224, cval_lineitem_l_commitdate#5192 AS cval_lineitem_l_commitdate_4#5225, cval_lineitem_l_receiptdate#5193 AS cval_lineitem_l_receiptdate_4#5226, cval_lineitem_l_shipinstruct#5194 AS cval_lineitem_l_shipinstruct_4#5227, cval_lineitem_l_shipmode#5195 AS cval_lineitem_l_shipmode_4#5228, cval_lineitem_l_comment#5196 AS cval_lineitem_l_comment_4#5229, cval_lineitem_l_shipdate#5197 AS cval_lineitem_l_shipdate_4#5230, cl_quantity#5198 AS cl_quantity_4#5231, cl_extendedprice#5199 AS cl_extendedprice_4#5232, cl_discount#5200 AS cl_discount_4#5233, ... 9 more fields]
         :     :     +- Relation[rid#5177,cpfk_orders_lineitem#5178,cpfk_supplier_lineitem#5179,cfpk_lineitem_supplier#5180,cfpk_lineitem_partsupp#5181,cpfk_part_lineitem#5182,cfpk_lineitem_part#5183,cpfk_partsupp_lineitem#5184,cfpk_lineitem_orders#5185,cval_lineitem_l_quantity#5186,cval_lineitem_l_extendedprice#5187,cval_lineitem_l_discount#5188,cval_lineitem_l_tax#5189,cval_lineitem_l_returnflag#5190,cval_lineitem_l_linestatus#5191,cval_lineitem_l_commitdate#5192,cval_lineitem_l_receiptdate#5193,cval_lineitem_l_shipinstruct#5194,cval_lineitem_l_shipmode#5195,cval_lineitem_l_comment#5196,cval_lineitem_l_shipdate#5197,cl_quantity#5198,cl_extendedprice#5199,cl_discount#5200,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :     +- Project [rid#5343 AS rid_5#5356, cpfk_nation_supplier#5344 AS cpfk_nation_supplier_5#5357, cfpk_supplier_nation#5345 AS cfpk_supplier_nation_5#5358, cval_supplier_s_name#5346 AS cval_supplier_s_name_5#5359, cval_supplier_s_address#5347 AS cval_supplier_s_address_5#5360, cval_supplier_s_phone#5348 AS cval_supplier_s_phone_5#5361, cval_supplier_s_acctbal#5349 AS cval_supplier_s_acctbal_5#5362, cval_supplier_s_comment#5350 AS cval_supplier_s_comment_5#5363, cs_name#5351 AS cs_name_5#5364, cs_address#5352 AS cs_address_5#5365, cs_phone#5353 AS cs_phone_5#5366, cs_acctbal#5354 AS cs_acctbal_5#5367, cs_comment#5355 AS cs_comment_5#5368]
         :        +- Relation[rid#5343,cpfk_nation_supplier#5344,cfpk_supplier_nation#5345,cval_supplier_s_name#5346,cval_supplier_s_address#5347,cval_supplier_s_phone#5348,cval_supplier_s_acctbal#5349,cval_supplier_s_comment#5350,cs_name#5351,cs_address#5352,cs_phone#5353,cs_acctbal#5354,cs_comment#5355] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_5, tnation, 'rid_1, tsupplier, 'rid_5
            :- Project [rid#5369 AS rid_1#5376, cpfk_region_nation#5370 AS cpfk_region_nation_1#5377, cfpk_nation_region#5371 AS cfpk_nation_region_1#5378, cval_nation_n_name#5372 AS cval_nation_n_name_1#5379, cval_nation_n_comment#5373 AS cval_nation_n_comment_1#5380, cn_name#5374 AS cn_name_1#5381, cn_comment#5375 AS cn_comment_1#5382]
            :  +- Relation[rid#5369,cpfk_region_nation#5370,cfpk_nation_region#5371,cval_nation_n_name#5372,cval_nation_n_comment#5373,cn_name#5374,cn_comment#5375] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#5383 AS rid_5#5396, cpfk_nation_supplier#5384 AS cpfk_nation_supplier_5#5397, cfpk_supplier_nation#5385 AS cfpk_supplier_nation_5#5398, cval_supplier_s_name#5386 AS cval_supplier_s_name_5#5399, cval_supplier_s_address#5387 AS cval_supplier_s_address_5#5400, cval_supplier_s_phone#5388 AS cval_supplier_s_phone_5#5401, cval_supplier_s_acctbal#5389 AS cval_supplier_s_acctbal_5#5402, cval_supplier_s_comment#5390 AS cval_supplier_s_comment_5#5403, cs_name#5391 AS cs_name_5#5404, cs_address#5392 AS cs_address_5#5405, cs_phone#5393 AS cs_phone_5#5406, cs_acctbal#5394 AS cs_acctbal_5#5407, cs_comment#5395 AS cs_comment_5#5408]
               +- Relation[rid#5383,cpfk_nation_supplier#5384,cfpk_supplier_nation#5385,cval_supplier_s_name#5386,cval_supplier_s_address#5387,cval_supplier_s_phone#5388,cval_supplier_s_acctbal#5389,cval_supplier_s_comment#5390,cs_name#5391,cs_address#5392,cs_phone#5393,cs_acctbal#5394,cs_comment#5395] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=1206514
Elapsed time: 164371ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/11 07:45:17 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:45:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5504L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 07:45:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#5504L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#5506 AS rid_0#5539, cpfk_orders_lineitem#5507 AS cpfk_orders_lineitem_0#5540, cpfk_supplier_lineitem#5508 AS cpfk_supplier_lineitem_0#5541, cfpk_lineitem_supplier#5509 AS cfpk_lineitem_supplier_0#5542, cfpk_lineitem_partsupp#5510 AS cfpk_lineitem_partsupp_0#5543, cpfk_part_lineitem#5511 AS cpfk_part_lineitem_0#5544, cfpk_lineitem_part#5512 AS cfpk_lineitem_part_0#5545, cpfk_partsupp_lineitem#5513 AS cpfk_partsupp_lineitem_0#5546, cfpk_lineitem_orders#5514 AS cfpk_lineitem_orders_0#5547, cval_lineitem_l_quantity#5515 AS cval_lineitem_l_quantity_0#5548, cval_lineitem_l_extendedprice#5516 AS cval_lineitem_l_extendedprice_0#5549, cval_lineitem_l_discount#5517 AS cval_lineitem_l_discount_0#5550, cval_lineitem_l_tax#5518 AS cval_lineitem_l_tax_0#5551, cval_lineitem_l_returnflag#5519 AS cval_lineitem_l_returnflag_0#5552, cval_lineitem_l_linestatus#5520 AS cval_lineitem_l_linestatus_0#5553, cval_lineitem_l_commitdate#5521 AS cval_lineitem_l_commitdate_0#5554, cval_lineitem_l_receiptdate#5522 AS cval_lineitem_l_receiptdate_0#5555, cval_lineitem_l_shipinstruct#5523 AS cval_lineitem_l_shipinstruct_0#5556, cval_lineitem_l_shipmode#5524 AS cval_lineitem_l_shipmode_0#5557, cval_lineitem_l_comment#5525 AS cval_lineitem_l_comment_0#5558, cval_lineitem_l_shipdate#5526 AS cval_lineitem_l_shipdate_0#5559, cl_quantity#5527 AS cl_quantity_0#5560, cl_extendedprice#5528 AS cl_extendedprice_0#5561, cl_discount#5529 AS cl_discount_0#5562, ... 9 more fields]
         +- Relation[rid#5506,cpfk_orders_lineitem#5507,cpfk_supplier_lineitem#5508,cfpk_lineitem_supplier#5509,cfpk_lineitem_partsupp#5510,cpfk_part_lineitem#5511,cfpk_lineitem_part#5512,cpfk_partsupp_lineitem#5513,cfpk_lineitem_orders#5514,cval_lineitem_l_quantity#5515,cval_lineitem_l_extendedprice#5516,cval_lineitem_l_discount#5517,cval_lineitem_l_tax#5518,cval_lineitem_l_returnflag#5519,cval_lineitem_l_linestatus#5520,cval_lineitem_l_commitdate#5521,cval_lineitem_l_receiptdate#5522,cval_lineitem_l_shipinstruct#5523,cval_lineitem_l_shipmode#5524,cval_lineitem_l_comment#5525,cval_lineitem_l_shipdate#5526,cl_quantity#5527,cl_extendedprice#5528,cl_discount#5529,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 3250ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/11 07:45:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:45:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5617L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/11 07:45:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:45:21 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:45:21 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5617L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :     :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :- Project [rid#5619 AS rid_0#5652, cpfk_orders_lineitem#5620 AS cpfk_orders_lineitem_0#5653, cpfk_supplier_lineitem#5621 AS cpfk_supplier_lineitem_0#5654, cfpk_lineitem_supplier#5622 AS cfpk_lineitem_supplier_0#5655, cfpk_lineitem_partsupp#5623 AS cfpk_lineitem_partsupp_0#5656, cpfk_part_lineitem#5624 AS cpfk_part_lineitem_0#5657, cfpk_lineitem_part#5625 AS cfpk_lineitem_part_0#5658, cpfk_partsupp_lineitem#5626 AS cpfk_partsupp_lineitem_0#5659, cfpk_lineitem_orders#5627 AS cfpk_lineitem_orders_0#5660, cval_lineitem_l_quantity#5628 AS cval_lineitem_l_quantity_0#5661, cval_lineitem_l_extendedprice#5629 AS cval_lineitem_l_extendedprice_0#5662, cval_lineitem_l_discount#5630 AS cval_lineitem_l_discount_0#5663, cval_lineitem_l_tax#5631 AS cval_lineitem_l_tax_0#5664, cval_lineitem_l_returnflag#5632 AS cval_lineitem_l_returnflag_0#5665, cval_lineitem_l_linestatus#5633 AS cval_lineitem_l_linestatus_0#5666, cval_lineitem_l_commitdate#5634 AS cval_lineitem_l_commitdate_0#5667, cval_lineitem_l_receiptdate#5635 AS cval_lineitem_l_receiptdate_0#5668, cval_lineitem_l_shipinstruct#5636 AS cval_lineitem_l_shipinstruct_0#5669, cval_lineitem_l_shipmode#5637 AS cval_lineitem_l_shipmode_0#5670, cval_lineitem_l_comment#5638 AS cval_lineitem_l_comment_0#5671, cval_lineitem_l_shipdate#5639 AS cval_lineitem_l_shipdate_0#5672, cl_quantity#5640 AS cl_quantity_0#5673, cl_extendedprice#5641 AS cl_extendedprice_0#5674, cl_discount#5642 AS cl_discount_0#5675, ... 9 more fields]
            :     :     :  :  +- Relation[rid#5619,cpfk_orders_lineitem#5620,cpfk_supplier_lineitem#5621,cfpk_lineitem_supplier#5622,cfpk_lineitem_partsupp#5623,cpfk_part_lineitem#5624,cfpk_lineitem_part#5625,cpfk_partsupp_lineitem#5626,cfpk_lineitem_orders#5627,cval_lineitem_l_quantity#5628,cval_lineitem_l_extendedprice#5629,cval_lineitem_l_discount#5630,cval_lineitem_l_tax#5631,cval_lineitem_l_returnflag#5632,cval_lineitem_l_linestatus#5633,cval_lineitem_l_commitdate#5634,cval_lineitem_l_receiptdate#5635,cval_lineitem_l_shipinstruct#5636,cval_lineitem_l_shipmode#5637,cval_lineitem_l_comment#5638,cval_lineitem_l_shipdate#5639,cl_quantity#5640,cl_extendedprice#5641,cl_discount#5642,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem, 'rid_0
            :     :     :     +- Project [rid#5685 AS rid_0#5718, cpfk_orders_lineitem#5686 AS cpfk_orders_lineitem_0#5719, cpfk_supplier_lineitem#5687 AS cpfk_supplier_lineitem_0#5720, cfpk_lineitem_supplier#5688 AS cfpk_lineitem_supplier_0#5721, cfpk_lineitem_partsupp#5689 AS cfpk_lineitem_partsupp_0#5722, cpfk_part_lineitem#5690 AS cpfk_part_lineitem_0#5723, cfpk_lineitem_part#5691 AS cfpk_lineitem_part_0#5724, cpfk_partsupp_lineitem#5692 AS cpfk_partsupp_lineitem_0#5725, cfpk_lineitem_orders#5693 AS cfpk_lineitem_orders_0#5726, cval_lineitem_l_quantity#5694 AS cval_lineitem_l_quantity_0#5727, cval_lineitem_l_extendedprice#5695 AS cval_lineitem_l_extendedprice_0#5728, cval_lineitem_l_discount#5696 AS cval_lineitem_l_discount_0#5729, cval_lineitem_l_tax#5697 AS cval_lineitem_l_tax_0#5730, cval_lineitem_l_returnflag#5698 AS cval_lineitem_l_returnflag_0#5731, cval_lineitem_l_linestatus#5699 AS cval_lineitem_l_linestatus_0#5732, cval_lineitem_l_commitdate#5700 AS cval_lineitem_l_commitdate_0#5733, cval_lineitem_l_receiptdate#5701 AS cval_lineitem_l_receiptdate_0#5734, cval_lineitem_l_shipinstruct#5702 AS cval_lineitem_l_shipinstruct_0#5735, cval_lineitem_l_shipmode#5703 AS cval_lineitem_l_shipmode_0#5736, cval_lineitem_l_comment#5704 AS cval_lineitem_l_comment_0#5737, cval_lineitem_l_shipdate#5705 AS cval_lineitem_l_shipdate_0#5738, cl_quantity#5706 AS cl_quantity_0#5739, cl_extendedprice#5707 AS cl_extendedprice_0#5740, cl_discount#5708 AS cl_discount_0#5741, ... 9 more fields]
            :     :     :        +- Relation[rid#5685,cpfk_orders_lineitem#5686,cpfk_supplier_lineitem#5687,cfpk_lineitem_supplier#5688,cfpk_lineitem_partsupp#5689,cpfk_part_lineitem#5690,cfpk_lineitem_part#5691,cpfk_partsupp_lineitem#5692,cfpk_lineitem_orders#5693,cval_lineitem_l_quantity#5694,cval_lineitem_l_extendedprice#5695,cval_lineitem_l_discount#5696,cval_lineitem_l_tax#5697,cval_lineitem_l_returnflag#5698,cval_lineitem_l_linestatus#5699,cval_lineitem_l_commitdate#5700,cval_lineitem_l_receiptdate#5701,cval_lineitem_l_shipinstruct#5702,cval_lineitem_l_shipmode#5703,cval_lineitem_l_comment#5704,cval_lineitem_l_shipdate#5705,cl_quantity#5706,cl_extendedprice#5707,cl_discount#5708,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#5751 AS rid_1#5768, cpfk_customer_orders#5752 AS cpfk_customer_orders_1#5769, cfpk_orders_customer#5753 AS cfpk_orders_customer_1#5770, cval_orders_o_orderstatus#5754 AS cval_orders_o_orderstatus_1#5771, cval_orders_o_totalprice#5755 AS cval_orders_o_totalprice_1#5772, cval_orders_o_orderpriority#5756 AS cval_orders_o_orderpriority_1#5773, cval_orders_o_clerk#5757 AS cval_orders_o_clerk_1#5774, cval_orders_o_shippriority#5758 AS cval_orders_o_shippriority_1#5775, cval_orders_o_comment#5759 AS cval_orders_o_comment_1#5776, cval_orders_o_orderdate#5760 AS cval_orders_o_orderdate_1#5777, co_orderstatus#5761 AS co_orderstatus_1#5778, co_totalprice#5762 AS co_totalprice_1#5779, co_orderpriority#5763 AS co_orderpriority_1#5780, co_clerk#5764 AS co_clerk_1#5781, co_shippriority#5765 AS co_shippriority_1#5782, co_comment#5766 AS co_comment_1#5783, co_orderdate#5767 AS co_orderdate_1#5784]
            :     :        +- Relation[rid#5751,cpfk_customer_orders#5752,cfpk_orders_customer#5753,cval_orders_o_orderstatus#5754,cval_orders_o_totalprice#5755,cval_orders_o_orderpriority#5756,cval_orders_o_clerk#5757,cval_orders_o_shippriority#5758,cval_orders_o_comment#5759,cval_orders_o_orderdate#5760,co_orderstatus#5761,co_totalprice#5762,co_orderpriority#5763,co_clerk#5764,co_shippriority#5765,co_comment#5766,co_orderdate#5767] JDBCRelation(torders) [numPartitions=1]
            :     +- Project [rid#5785 AS rid_2#5800, cpfk_nation_customer#5786 AS cpfk_nation_customer_2#5801, cfpk_customer_nation#5787 AS cfpk_customer_nation_2#5802, cval_customer_c_name#5788 AS cval_customer_c_name_2#5803, cval_customer_c_address#5789 AS cval_customer_c_address_2#5804, cval_customer_c_phone#5790 AS cval_customer_c_phone_2#5805, cval_customer_c_acctbal#5791 AS cval_customer_c_acctbal_2#5806, cval_customer_c_comment#5792 AS cval_customer_c_comment_2#5807, cval_customer_c_mktsegment#5793 AS cval_customer_c_mktsegment_2#5808, cc_name#5794 AS cc_name_2#5809, cc_address#5795 AS cc_address_2#5810, cc_phone#5796 AS cc_phone_2#5811, cc_acctbal#5797 AS cc_acctbal_2#5812, cc_comment#5798 AS cc_comment_2#5813, cc_mktsegment#5799 AS cc_mktsegment_2#5814]
            :        +- Relation[rid#5785,cpfk_nation_customer#5786,cfpk_customer_nation#5787,cval_customer_c_name#5788,cval_customer_c_address#5789,cval_customer_c_phone#5790,cval_customer_c_acctbal#5791,cval_customer_c_comment#5792,cval_customer_c_mktsegment#5793,cc_name#5794,cc_address#5795,cc_phone#5796,cc_acctbal#5797,cc_comment#5798,cc_mktsegment#5799] JDBCRelation(tcustomer) [numPartitions=1]
            +- Project [rid#5815 AS rid_3#5822, cpfk_region_nation#5816 AS cpfk_region_nation_3#5823, cfpk_nation_region#5817 AS cfpk_nation_region_3#5824, cval_nation_n_name#5818 AS cval_nation_n_name_3#5825, cval_nation_n_comment#5819 AS cval_nation_n_comment_3#5826, cn_name#5820 AS cn_name_3#5827, cn_comment#5821 AS cn_comment_3#5828]
               +- Relation[rid#5815,cpfk_region_nation#5816,cfpk_nation_region#5817,cval_nation_n_name#5818,cval_nation_n_comment#5819,cn_name#5820,cn_comment#5821] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 61273ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/11 07:46:22 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:46:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5910L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 07:46:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:46:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:46:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:46:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:46:22 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:46:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:46:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:46:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:46:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:46:22 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:46:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:46:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:46:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:46:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:46:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:46:22 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:46:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5910L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
            :- 'Join UsingJoin(Inner,List(rid_4))
            :  :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :- 'Project [*]
            :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
            :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
            :  :  :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :  :  :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :     :  :  :  :  :- Project [rid#5912 AS rid_0#5919, cpfk_region_nation#5913 AS cpfk_region_nation_0#5920, cfpk_nation_region#5914 AS cfpk_nation_region_0#5921, cval_nation_n_name#5915 AS cval_nation_n_name_0#5922, cval_nation_n_comment#5916 AS cval_nation_n_comment_0#5923, cn_name#5917 AS cn_name_0#5924, cn_comment#5918 AS cn_comment_0#5925]
            :  :  :     :  :  :  :  :  +- Relation[rid#5912,cpfk_region_nation#5913,cfpk_nation_region#5914,cval_nation_n_name#5915,cval_nation_n_comment#5916,cn_name#5917,cn_comment#5918] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :  :  :     :  :  :  :     :- Project [rid#5952 AS rid_0#5959, cpfk_region_nation#5953 AS cpfk_region_nation_0#5960, cfpk_nation_region#5954 AS cfpk_nation_region_0#5961, cval_nation_n_name#5955 AS cval_nation_n_name_0#5962, cval_nation_n_comment#5956 AS cval_nation_n_comment_0#5963, cn_name#5957 AS cn_name_0#5964, cn_comment#5958 AS cn_comment_0#5965]
            :  :  :     :  :  :  :     :  +- Relation[rid#5952,cpfk_region_nation#5953,cfpk_nation_region#5954,cval_nation_n_name#5955,cval_nation_n_comment#5956,cn_name#5957,cn_comment#5958] JDBCRelation(tnation) [numPartitions=1]
            :  :  :     :  :  :  :     +- Project [rid#5966 AS rid_1#5979, cpfk_nation_supplier#5967 AS cpfk_nation_supplier_1#5980, cfpk_supplier_nation#5968 AS cfpk_supplier_nation_1#5981, cval_supplier_s_name#5969 AS cval_supplier_s_name_1#5982, cval_supplier_s_address#5970 AS cval_supplier_s_address_1#5983, cval_supplier_s_phone#5971 AS cval_supplier_s_phone_1#5984, cval_supplier_s_acctbal#5972 AS cval_supplier_s_acctbal_1#5985, cval_supplier_s_comment#5973 AS cval_supplier_s_comment_1#5986, cs_name#5974 AS cs_name_1#5987, cs_address#5975 AS cs_address_1#5988, cs_phone#5976 AS cs_phone_1#5989, cs_acctbal#5977 AS cs_acctbal_1#5990, cs_comment#5978 AS cs_comment_1#5991]
            :  :  :     :  :  :  :        +- Relation[rid#5966,cpfk_nation_supplier#5967,cfpk_supplier_nation#5968,cval_supplier_s_name#5969,cval_supplier_s_address#5970,cval_supplier_s_phone#5971,cval_supplier_s_acctbal#5972,cval_supplier_s_comment#5973,cs_name#5974,cs_address#5975,cs_phone#5976,cs_acctbal#5977,cs_comment#5978] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  :  +- Project [rid#5926 AS rid_1#5939, cpfk_nation_supplier#5927 AS cpfk_nation_supplier_1#5940, cfpk_supplier_nation#5928 AS cfpk_supplier_nation_1#5941, cval_supplier_s_name#5929 AS cval_supplier_s_name_1#5942, cval_supplier_s_address#5930 AS cval_supplier_s_address_1#5943, cval_supplier_s_phone#5931 AS cval_supplier_s_phone_1#5944, cval_supplier_s_acctbal#5932 AS cval_supplier_s_acctbal_1#5945, cval_supplier_s_comment#5933 AS cval_supplier_s_comment_1#5946, cs_name#5934 AS cs_name_1#5947, cs_address#5935 AS cs_address_1#5948, cs_phone#5936 AS cs_phone_1#5949, cs_acctbal#5937 AS cs_acctbal_1#5950, cs_comment#5938 AS cs_comment_1#5951]
            :  :  :     :  :  :     +- Relation[rid#5926,cpfk_nation_supplier#5927,cfpk_supplier_nation#5928,cval_supplier_s_name#5929,cval_supplier_s_address#5930,cval_supplier_s_phone#5931,cval_supplier_s_acctbal#5932,cval_supplier_s_comment#5933,cs_name#5934,cs_address#5935,cs_phone#5936,cs_acctbal#5937,cs_comment#5938] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_2, tsupplier, 'rid_1, tpartsupp, 'rid_2
            :  :  :     :  :     :- Project [rid#6014 AS rid_1#6027, cpfk_nation_supplier#6015 AS cpfk_nation_supplier_1#6028, cfpk_supplier_nation#6016 AS cfpk_supplier_nation_1#6029, cval_supplier_s_name#6017 AS cval_supplier_s_name_1#6030, cval_supplier_s_address#6018 AS cval_supplier_s_address_1#6031, cval_supplier_s_phone#6019 AS cval_supplier_s_phone_1#6032, cval_supplier_s_acctbal#6020 AS cval_supplier_s_acctbal_1#6033, cval_supplier_s_comment#6021 AS cval_supplier_s_comment_1#6034, cs_name#6022 AS cs_name_1#6035, cs_address#6023 AS cs_address_1#6036, cs_phone#6024 AS cs_phone_1#6037, cs_acctbal#6025 AS cs_acctbal_1#6038, cs_comment#6026 AS cs_comment_1#6039]
            :  :  :     :  :     :  +- Relation[rid#6014,cpfk_nation_supplier#6015,cfpk_supplier_nation#6016,cval_supplier_s_name#6017,cval_supplier_s_address#6018,cval_supplier_s_phone#6019,cval_supplier_s_acctbal#6020,cval_supplier_s_comment#6021,cs_name#6022,cs_address#6023,cs_phone#6024,cs_acctbal#6025,cs_comment#6026] JDBCRelation(tsupplier) [numPartitions=1]
            :  :  :     :  :     +- Project [rid#6040 AS rid_2#6051, cpfk_part_partsupp#6041 AS cpfk_part_partsupp_2#6052, cfpk_partsupp_part#6042 AS cfpk_partsupp_part_2#6053, cpfk_supplier_partsupp#6043 AS cpfk_supplier_partsupp_2#6054, cfpk_partsupp_supplier#6044 AS cfpk_partsupp_supplier_2#6055, cval_partsupp_ps_availqty#6045 AS cval_partsupp_ps_availqty_2#6056, cval_partsupp_ps_supplycost#6046 AS cval_partsupp_ps_supplycost_2#6057, cval_partsupp_ps_comment#6047 AS cval_partsupp_ps_comment_2#6058, cps_availqty#6048 AS cps_availqty_2#6059, cps_supplycost#6049 AS cps_supplycost_2#6060, cps_comment#6050 AS cps_comment_2#6061]
            :  :  :     :  :        +- Relation[rid#6040,cpfk_part_partsupp#6041,cfpk_partsupp_part#6042,cpfk_supplier_partsupp#6043,cfpk_partsupp_supplier#6044,cval_partsupp_ps_availqty#6045,cval_partsupp_ps_supplycost#6046,cval_partsupp_ps_comment#6047,cps_availqty#6048,cps_supplycost#6049,cps_comment#6050] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     :  +- Project [rid#5992 AS rid_2#6003, cpfk_part_partsupp#5993 AS cpfk_part_partsupp_2#6004, cfpk_partsupp_part#5994 AS cfpk_partsupp_part_2#6005, cpfk_supplier_partsupp#5995 AS cpfk_supplier_partsupp_2#6006, cfpk_partsupp_supplier#5996 AS cfpk_partsupp_supplier_2#6007, cval_partsupp_ps_availqty#5997 AS cval_partsupp_ps_availqty_2#6008, cval_partsupp_ps_supplycost#5998 AS cval_partsupp_ps_supplycost_2#6009, cval_partsupp_ps_comment#5999 AS cval_partsupp_ps_comment_2#6010, cps_availqty#6000 AS cps_availqty_2#6011, cps_supplycost#6001 AS cps_supplycost_2#6012, cps_comment#6002 AS cps_comment_2#6013]
            :  :  :     :     +- Relation[rid#5992,cpfk_part_partsupp#5993,cfpk_partsupp_part#5994,cpfk_supplier_partsupp#5995,cfpk_partsupp_supplier#5996,cval_partsupp_ps_availqty#5997,cval_partsupp_ps_supplycost#5998,cval_partsupp_ps_comment#5999,cps_availqty#6000,cps_supplycost#6001,cps_comment#6002] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :  :     +- Project [rid#6062 AS rid_3#6079, cval_part_p_name#6063 AS cval_part_p_name_3#6080, cval_part_p_mfgr#6064 AS cval_part_p_mfgr_3#6081, cval_part_p_type#6065 AS cval_part_p_type_3#6082, cval_part_p_size#6066 AS cval_part_p_size_3#6083, cval_part_p_container#6067 AS cval_part_p_container_3#6084, cval_part_p_retailprice#6068 AS cval_part_p_retailprice_3#6085, cval_part_p_comment#6069 AS cval_part_p_comment_3#6086, cval_part_p_brand#6070 AS cval_part_p_brand_3#6087, cp_name#6071 AS cp_name_3#6088, cp_mfgr#6072 AS cp_mfgr_3#6089, cp_type#6073 AS cp_type_3#6090, cp_size#6074 AS cp_size_3#6091, cp_container#6075 AS cp_container_3#6092, cp_retailprice#6076 AS cp_retailprice_3#6093, cp_comment#6077 AS cp_comment_3#6094, cp_brand#6078 AS cp_brand_3#6095]
            :  :  :        +- Relation[rid#6062,cval_part_p_name#6063,cval_part_p_mfgr#6064,cval_part_p_type#6065,cval_part_p_size#6066,cval_part_p_container#6067,cval_part_p_retailprice#6068,cval_part_p_comment#6069,cval_part_p_brand#6070,cp_name#6071,cp_mfgr#6072,cp_type#6073,cp_size#6074,cp_container#6075,cp_retailprice#6076,cp_comment#6077,cp_brand#6078] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin partsupp~lineitem, cpfk_partsupp_lineitem, 'cpfk_partsupp_lineitem_4, tpartsupp, 'rid_2, tlineitem, 'rid_4
            :  :     :- Project [rid#6162 AS rid_2#6173, cpfk_part_partsupp#6163 AS cpfk_part_partsupp_2#6174, cfpk_partsupp_part#6164 AS cfpk_partsupp_part_2#6175, cpfk_supplier_partsupp#6165 AS cpfk_supplier_partsupp_2#6176, cfpk_partsupp_supplier#6166 AS cfpk_partsupp_supplier_2#6177, cval_partsupp_ps_availqty#6167 AS cval_partsupp_ps_availqty_2#6178, cval_partsupp_ps_supplycost#6168 AS cval_partsupp_ps_supplycost_2#6179, cval_partsupp_ps_comment#6169 AS cval_partsupp_ps_comment_2#6180, cps_availqty#6170 AS cps_availqty_2#6181, cps_supplycost#6171 AS cps_supplycost_2#6182, cps_comment#6172 AS cps_comment_2#6183]
            :  :     :  +- Relation[rid#6162,cpfk_part_partsupp#6163,cfpk_partsupp_part#6164,cpfk_supplier_partsupp#6165,cfpk_partsupp_supplier#6166,cval_partsupp_ps_availqty#6167,cval_partsupp_ps_supplycost#6168,cval_partsupp_ps_comment#6169,cps_availqty#6170,cps_supplycost#6171,cps_comment#6172] JDBCRelation(tpartsupp) [numPartitions=1]
            :  :     +- Project [rid#6184 AS rid_4#6217, cpfk_orders_lineitem#6185 AS cpfk_orders_lineitem_4#6218, cpfk_supplier_lineitem#6186 AS cpfk_supplier_lineitem_4#6219, cfpk_lineitem_supplier#6187 AS cfpk_lineitem_supplier_4#6220, cfpk_lineitem_partsupp#6188 AS cfpk_lineitem_partsupp_4#6221, cpfk_part_lineitem#6189 AS cpfk_part_lineitem_4#6222, cfpk_lineitem_part#6190 AS cfpk_lineitem_part_4#6223, cpfk_partsupp_lineitem#6191 AS cpfk_partsupp_lineitem_4#6224, cfpk_lineitem_orders#6192 AS cfpk_lineitem_orders_4#6225, cval_lineitem_l_quantity#6193 AS cval_lineitem_l_quantity_4#6226, cval_lineitem_l_extendedprice#6194 AS cval_lineitem_l_extendedprice_4#6227, cval_lineitem_l_discount#6195 AS cval_lineitem_l_discount_4#6228, cval_lineitem_l_tax#6196 AS cval_lineitem_l_tax_4#6229, cval_lineitem_l_returnflag#6197 AS cval_lineitem_l_returnflag_4#6230, cval_lineitem_l_linestatus#6198 AS cval_lineitem_l_linestatus_4#6231, cval_lineitem_l_commitdate#6199 AS cval_lineitem_l_commitdate_4#6232, cval_lineitem_l_receiptdate#6200 AS cval_lineitem_l_receiptdate_4#6233, cval_lineitem_l_shipinstruct#6201 AS cval_lineitem_l_shipinstruct_4#6234, cval_lineitem_l_shipmode#6202 AS cval_lineitem_l_shipmode_4#6235, cval_lineitem_l_comment#6203 AS cval_lineitem_l_comment_4#6236, cval_lineitem_l_shipdate#6204 AS cval_lineitem_l_shipdate_4#6237, cl_quantity#6205 AS cl_quantity_4#6238, cl_extendedprice#6206 AS cl_extendedprice_4#6239, cl_discount#6207 AS cl_discount_4#6240, ... 9 more fields]
            :  :        +- Relation[rid#6184,cpfk_orders_lineitem#6185,cpfk_supplier_lineitem#6186,cfpk_lineitem_supplier#6187,cfpk_lineitem_partsupp#6188,cpfk_part_lineitem#6189,cfpk_lineitem_part#6190,cpfk_partsupp_lineitem#6191,cfpk_lineitem_orders#6192,cval_lineitem_l_quantity#6193,cval_lineitem_l_extendedprice#6194,cval_lineitem_l_discount#6195,cval_lineitem_l_tax#6196,cval_lineitem_l_returnflag#6197,cval_lineitem_l_linestatus#6198,cval_lineitem_l_commitdate#6199,cval_lineitem_l_receiptdate#6200,cval_lineitem_l_shipinstruct#6201,cval_lineitem_l_shipmode#6202,cval_lineitem_l_comment#6203,cval_lineitem_l_shipdate#6204,cl_quantity#6205,cl_extendedprice#6206,cl_discount#6207,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- Project [rid#6096 AS rid_4#6129, cpfk_orders_lineitem#6097 AS cpfk_orders_lineitem_4#6130, cpfk_supplier_lineitem#6098 AS cpfk_supplier_lineitem_4#6131, cfpk_lineitem_supplier#6099 AS cfpk_lineitem_supplier_4#6132, cfpk_lineitem_partsupp#6100 AS cfpk_lineitem_partsupp_4#6133, cpfk_part_lineitem#6101 AS cpfk_part_lineitem_4#6134, cfpk_lineitem_part#6102 AS cfpk_lineitem_part_4#6135, cpfk_partsupp_lineitem#6103 AS cpfk_partsupp_lineitem_4#6136, cfpk_lineitem_orders#6104 AS cfpk_lineitem_orders_4#6137, cval_lineitem_l_quantity#6105 AS cval_lineitem_l_quantity_4#6138, cval_lineitem_l_extendedprice#6106 AS cval_lineitem_l_extendedprice_4#6139, cval_lineitem_l_discount#6107 AS cval_lineitem_l_discount_4#6140, cval_lineitem_l_tax#6108 AS cval_lineitem_l_tax_4#6141, cval_lineitem_l_returnflag#6109 AS cval_lineitem_l_returnflag_4#6142, cval_lineitem_l_linestatus#6110 AS cval_lineitem_l_linestatus_4#6143, cval_lineitem_l_commitdate#6111 AS cval_lineitem_l_commitdate_4#6144, cval_lineitem_l_receiptdate#6112 AS cval_lineitem_l_receiptdate_4#6145, cval_lineitem_l_shipinstruct#6113 AS cval_lineitem_l_shipinstruct_4#6146, cval_lineitem_l_shipmode#6114 AS cval_lineitem_l_shipmode_4#6147, cval_lineitem_l_comment#6115 AS cval_lineitem_l_comment_4#6148, cval_lineitem_l_shipdate#6116 AS cval_lineitem_l_shipdate_4#6149, cl_quantity#6117 AS cl_quantity_4#6150, cl_extendedprice#6118 AS cl_extendedprice_4#6151, cl_discount#6119 AS cl_discount_4#6152, ... 9 more fields]
            :     +- Relation[rid#6096,cpfk_orders_lineitem#6097,cpfk_supplier_lineitem#6098,cfpk_lineitem_supplier#6099,cfpk_lineitem_partsupp#6100,cpfk_part_lineitem#6101,cfpk_lineitem_part#6102,cpfk_partsupp_lineitem#6103,cfpk_lineitem_orders#6104,cval_lineitem_l_quantity#6105,cval_lineitem_l_extendedprice#6106,cval_lineitem_l_discount#6107,cval_lineitem_l_tax#6108,cval_lineitem_l_returnflag#6109,cval_lineitem_l_linestatus#6110,cval_lineitem_l_commitdate#6111,cval_lineitem_l_receiptdate#6112,cval_lineitem_l_shipinstruct#6113,cval_lineitem_l_shipmode#6114,cval_lineitem_l_comment#6115,cval_lineitem_l_shipdate#6116,cl_quantity#6117,cl_extendedprice#6118,cl_discount#6119,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#6250 AS rid_5#6267, cpfk_customer_orders#6251 AS cpfk_customer_orders_5#6268, cfpk_orders_customer#6252 AS cfpk_orders_customer_5#6269, cval_orders_o_orderstatus#6253 AS cval_orders_o_orderstatus_5#6270, cval_orders_o_totalprice#6254 AS cval_orders_o_totalprice_5#6271, cval_orders_o_orderpriority#6255 AS cval_orders_o_orderpriority_5#6272, cval_orders_o_clerk#6256 AS cval_orders_o_clerk_5#6273, cval_orders_o_shippriority#6257 AS cval_orders_o_shippriority_5#6274, cval_orders_o_comment#6258 AS cval_orders_o_comment_5#6275, cval_orders_o_orderdate#6259 AS cval_orders_o_orderdate_5#6276, co_orderstatus#6260 AS co_orderstatus_5#6277, co_totalprice#6261 AS co_totalprice_5#6278, co_orderpriority#6262 AS co_orderpriority_5#6279, co_clerk#6263 AS co_clerk_5#6280, co_shippriority#6264 AS co_shippriority_5#6281, co_comment#6265 AS co_comment_5#6282, co_orderdate#6266 AS co_orderdate_5#6283]
               +- Relation[rid#6250,cpfk_customer_orders#6251,cfpk_orders_customer#6252,cval_orders_o_orderstatus#6253,cval_orders_o_totalprice#6254,cval_orders_o_orderpriority#6255,cval_orders_o_clerk#6256,cval_orders_o_shippriority#6257,cval_orders_o_comment#6258,cval_orders_o_orderdate#6259,co_orderstatus#6260,co_totalprice#6261,co_orderpriority#6262,co_clerk#6263,co_shippriority#6264,co_comment#6265,co_orderdate#6266] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 162939ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/11 07:49:05 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:49:05 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6387L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/11 07:49:05 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:49:05 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:49:05 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:49:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:49:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:49:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:49:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:49:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:49:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:49:05 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:49:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:49:05 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:49:05 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:49:05 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6387L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
            :- 'Join UsingJoin(Inner,List(rid_1))
            :  :- 'Join UsingJoin(Inner,List(rid_0))
            :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :  :  :- Project [rid#6389 AS rid_0#6406, cval_part_p_name#6390 AS cval_part_p_name_0#6407, cval_part_p_mfgr#6391 AS cval_part_p_mfgr_0#6408, cval_part_p_type#6392 AS cval_part_p_type_0#6409, cval_part_p_size#6393 AS cval_part_p_size_0#6410, cval_part_p_container#6394 AS cval_part_p_container_0#6411, cval_part_p_retailprice#6395 AS cval_part_p_retailprice_0#6412, cval_part_p_comment#6396 AS cval_part_p_comment_0#6413, cval_part_p_brand#6397 AS cval_part_p_brand_0#6414, cp_name#6398 AS cp_name_0#6415, cp_mfgr#6399 AS cp_mfgr_0#6416, cp_type#6400 AS cp_type_0#6417, cp_size#6401 AS cp_size_0#6418, cp_container#6402 AS cp_container_0#6419, cp_retailprice#6403 AS cp_retailprice_0#6420, cp_comment#6404 AS cp_comment_0#6421, cp_brand#6405 AS cp_brand_0#6422]
            :  :  :  :  +- Relation[rid#6389,cval_part_p_name#6390,cval_part_p_mfgr#6391,cval_part_p_type#6392,cval_part_p_size#6393,cval_part_p_container#6394,cval_part_p_retailprice#6395,cval_part_p_comment#6396,cval_part_p_brand#6397,cp_name#6398,cp_mfgr#6399,cp_type#6400,cp_size#6401,cp_container#6402,cp_retailprice#6403,cp_comment#6404,cp_brand#6405] JDBCRelation(tpart) [numPartitions=1]
            :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart, 'rid_0
            :  :  :     +- Project [rid#6423 AS rid_0#6440, cval_part_p_name#6424 AS cval_part_p_name_0#6441, cval_part_p_mfgr#6425 AS cval_part_p_mfgr_0#6442, cval_part_p_type#6426 AS cval_part_p_type_0#6443, cval_part_p_size#6427 AS cval_part_p_size_0#6444, cval_part_p_container#6428 AS cval_part_p_container_0#6445, cval_part_p_retailprice#6429 AS cval_part_p_retailprice_0#6446, cval_part_p_comment#6430 AS cval_part_p_comment_0#6447, cval_part_p_brand#6431 AS cval_part_p_brand_0#6448, cp_name#6432 AS cp_name_0#6449, cp_mfgr#6433 AS cp_mfgr_0#6450, cp_type#6434 AS cp_type_0#6451, cp_size#6435 AS cp_size_0#6452, cp_container#6436 AS cp_container_0#6453, cp_retailprice#6437 AS cp_retailprice_0#6454, cp_comment#6438 AS cp_comment_0#6455, cp_brand#6439 AS cp_brand_0#6456]
            :  :  :        +- Relation[rid#6423,cval_part_p_name#6424,cval_part_p_mfgr#6425,cval_part_p_type#6426,cval_part_p_size#6427,cval_part_p_container#6428,cval_part_p_retailprice#6429,cval_part_p_comment#6430,cval_part_p_brand#6431,cp_name#6432,cp_mfgr#6433,cp_type#6434,cp_size#6435,cp_container#6436,cp_retailprice#6437,cp_comment#6438,cp_brand#6439] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_1, tpart, 'rid_0, tpartsupp, 'rid_1
            :  :     :- Project [rid#6479 AS rid_0#6496, cval_part_p_name#6480 AS cval_part_p_name_0#6497, cval_part_p_mfgr#6481 AS cval_part_p_mfgr_0#6498, cval_part_p_type#6482 AS cval_part_p_type_0#6499, cval_part_p_size#6483 AS cval_part_p_size_0#6500, cval_part_p_container#6484 AS cval_part_p_container_0#6501, cval_part_p_retailprice#6485 AS cval_part_p_retailprice_0#6502, cval_part_p_comment#6486 AS cval_part_p_comment_0#6503, cval_part_p_brand#6487 AS cval_part_p_brand_0#6504, cp_name#6488 AS cp_name_0#6505, cp_mfgr#6489 AS cp_mfgr_0#6506, cp_type#6490 AS cp_type_0#6507, cp_size#6491 AS cp_size_0#6508, cp_container#6492 AS cp_container_0#6509, cp_retailprice#6493 AS cp_retailprice_0#6510, cp_comment#6494 AS cp_comment_0#6511, cp_brand#6495 AS cp_brand_0#6512]
            :  :     :  +- Relation[rid#6479,cval_part_p_name#6480,cval_part_p_mfgr#6481,cval_part_p_type#6482,cval_part_p_size#6483,cval_part_p_container#6484,cval_part_p_retailprice#6485,cval_part_p_comment#6486,cval_part_p_brand#6487,cp_name#6488,cp_mfgr#6489,cp_type#6490,cp_size#6491,cp_container#6492,cp_retailprice#6493,cp_comment#6494,cp_brand#6495] JDBCRelation(tpart) [numPartitions=1]
            :  :     +- Project [rid#6513 AS rid_1#6524, cpfk_part_partsupp#6514 AS cpfk_part_partsupp_1#6525, cfpk_partsupp_part#6515 AS cfpk_partsupp_part_1#6526, cpfk_supplier_partsupp#6516 AS cpfk_supplier_partsupp_1#6527, cfpk_partsupp_supplier#6517 AS cfpk_partsupp_supplier_1#6528, cval_partsupp_ps_availqty#6518 AS cval_partsupp_ps_availqty_1#6529, cval_partsupp_ps_supplycost#6519 AS cval_partsupp_ps_supplycost_1#6530, cval_partsupp_ps_comment#6520 AS cval_partsupp_ps_comment_1#6531, cps_availqty#6521 AS cps_availqty_1#6532, cps_supplycost#6522 AS cps_supplycost_1#6533, cps_comment#6523 AS cps_comment_1#6534]
            :  :        +- Relation[rid#6513,cpfk_part_partsupp#6514,cfpk_partsupp_part#6515,cpfk_supplier_partsupp#6516,cfpk_partsupp_supplier#6517,cval_partsupp_ps_availqty#6518,cval_partsupp_ps_supplycost#6519,cval_partsupp_ps_comment#6520,cps_availqty#6521,cps_supplycost#6522,cps_comment#6523] JDBCRelation(tpartsupp) [numPartitions=1]
            :  +- Project [rid#6457 AS rid_1#6468, cpfk_part_partsupp#6458 AS cpfk_part_partsupp_1#6469, cfpk_partsupp_part#6459 AS cfpk_partsupp_part_1#6470, cpfk_supplier_partsupp#6460 AS cpfk_supplier_partsupp_1#6471, cfpk_partsupp_supplier#6461 AS cfpk_partsupp_supplier_1#6472, cval_partsupp_ps_availqty#6462 AS cval_partsupp_ps_availqty_1#6473, cval_partsupp_ps_supplycost#6463 AS cval_partsupp_ps_supplycost_1#6474, cval_partsupp_ps_comment#6464 AS cval_partsupp_ps_comment_1#6475, cps_availqty#6465 AS cps_availqty_1#6476, cps_supplycost#6466 AS cps_supplycost_1#6477, cps_comment#6467 AS cps_comment_1#6478]
            :     +- Relation[rid#6457,cpfk_part_partsupp#6458,cfpk_partsupp_part#6459,cpfk_supplier_partsupp#6460,cfpk_partsupp_supplier#6461,cval_partsupp_ps_availqty#6462,cval_partsupp_ps_supplycost#6463,cval_partsupp_ps_comment#6464,cps_availqty#6465,cps_supplycost#6466,cps_comment#6467] JDBCRelation(tpartsupp) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_3))
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'Join UsingJoin(LeftSemi,List(rid_2))
               :  :  :- Project [rid#6535 AS rid_2#6542, cpfk_region_nation#6536 AS cpfk_region_nation_2#6543, cfpk_nation_region#6537 AS cfpk_nation_region_2#6544, cval_nation_n_name#6538 AS cval_nation_n_name_2#6545, cval_nation_n_comment#6539 AS cval_nation_n_comment_2#6546, cn_name#6540 AS cn_name_2#6547, cn_comment#6541 AS cn_comment_2#6548]
               :  :  :  +- Relation[rid#6535,cpfk_region_nation#6536,cfpk_nation_region#6537,cval_nation_n_name#6538,cval_nation_n_comment#6539,cn_name#6540,cn_comment#6541] JDBCRelation(tnation) [numPartitions=1]
               :  :  +- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation, 'rid_2
               :  :     +- Project [rid#6549 AS rid_2#6556, cpfk_region_nation#6550 AS cpfk_region_nation_2#6557, cfpk_nation_region#6551 AS cfpk_nation_region_2#6558, cval_nation_n_name#6552 AS cval_nation_n_name_2#6559, cval_nation_n_comment#6553 AS cval_nation_n_comment_2#6560, cn_name#6554 AS cn_name_2#6561, cn_comment#6555 AS cn_comment_2#6562]
               :  :        +- Relation[rid#6549,cpfk_region_nation#6550,cfpk_nation_region#6551,cval_nation_n_name#6552,cval_nation_n_comment#6553,cn_name#6554,cn_comment#6555] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_3, tnation, 'rid_2, tsupplier, 'rid_3
               :     :- Project [rid#6589 AS rid_2#6596, cpfk_region_nation#6590 AS cpfk_region_nation_2#6597, cfpk_nation_region#6591 AS cfpk_nation_region_2#6598, cval_nation_n_name#6592 AS cval_nation_n_name_2#6599, cval_nation_n_comment#6593 AS cval_nation_n_comment_2#6600, cn_name#6594 AS cn_name_2#6601, cn_comment#6595 AS cn_comment_2#6602]
               :     :  +- Relation[rid#6589,cpfk_region_nation#6590,cfpk_nation_region#6591,cval_nation_n_name#6592,cval_nation_n_comment#6593,cn_name#6594,cn_comment#6595] JDBCRelation(tnation) [numPartitions=1]
               :     +- Project [rid#6603 AS rid_3#6616, cpfk_nation_supplier#6604 AS cpfk_nation_supplier_3#6617, cfpk_supplier_nation#6605 AS cfpk_supplier_nation_3#6618, cval_supplier_s_name#6606 AS cval_supplier_s_name_3#6619, cval_supplier_s_address#6607 AS cval_supplier_s_address_3#6620, cval_supplier_s_phone#6608 AS cval_supplier_s_phone_3#6621, cval_supplier_s_acctbal#6609 AS cval_supplier_s_acctbal_3#6622, cval_supplier_s_comment#6610 AS cval_supplier_s_comment_3#6623, cs_name#6611 AS cs_name_3#6624, cs_address#6612 AS cs_address_3#6625, cs_phone#6613 AS cs_phone_3#6626, cs_acctbal#6614 AS cs_acctbal_3#6627, cs_comment#6615 AS cs_comment_3#6628]
               :        +- Relation[rid#6603,cpfk_nation_supplier#6604,cfpk_supplier_nation#6605,cval_supplier_s_name#6606,cval_supplier_s_address#6607,cval_supplier_s_phone#6608,cval_supplier_s_acctbal#6609,cval_supplier_s_comment#6610,cs_name#6611,cs_address#6612,cs_phone#6613,cs_acctbal#6614,cs_comment#6615] JDBCRelation(tsupplier) [numPartitions=1]
               +- Project [rid#6563 AS rid_3#6576, cpfk_nation_supplier#6564 AS cpfk_nation_supplier_3#6577, cfpk_supplier_nation#6565 AS cfpk_supplier_nation_3#6578, cval_supplier_s_name#6566 AS cval_supplier_s_name_3#6579, cval_supplier_s_address#6567 AS cval_supplier_s_address_3#6580, cval_supplier_s_phone#6568 AS cval_supplier_s_phone_3#6581, cval_supplier_s_acctbal#6569 AS cval_supplier_s_acctbal_3#6582, cval_supplier_s_comment#6570 AS cval_supplier_s_comment_3#6583, cs_name#6571 AS cs_name_3#6584, cs_address#6572 AS cs_address_3#6585, cs_phone#6573 AS cs_phone_3#6586, cs_acctbal#6574 AS cs_acctbal_3#6587, cs_comment#6575 AS cs_comment_3#6588]
                  +- Relation[rid#6563,cpfk_nation_supplier#6564,cfpk_supplier_nation#6565,cval_supplier_s_name#6566,cval_supplier_s_address#6567,cval_supplier_s_phone#6568,cval_supplier_s_acctbal#6569,cval_supplier_s_comment#6570,cs_name#6571,cs_address#6572,cs_phone#6573,cs_acctbal#6574,cs_comment#6575] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 11372ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/11 07:49:16 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:49:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6682L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 07:49:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#6682L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#6684 AS rid_0#6717, cpfk_orders_lineitem#6685 AS cpfk_orders_lineitem_0#6718, cpfk_supplier_lineitem#6686 AS cpfk_supplier_lineitem_0#6719, cfpk_lineitem_supplier#6687 AS cfpk_lineitem_supplier_0#6720, cfpk_lineitem_partsupp#6688 AS cfpk_lineitem_partsupp_0#6721, cpfk_part_lineitem#6689 AS cpfk_part_lineitem_0#6722, cfpk_lineitem_part#6690 AS cfpk_lineitem_part_0#6723, cpfk_partsupp_lineitem#6691 AS cpfk_partsupp_lineitem_0#6724, cfpk_lineitem_orders#6692 AS cfpk_lineitem_orders_0#6725, cval_lineitem_l_quantity#6693 AS cval_lineitem_l_quantity_0#6726, cval_lineitem_l_extendedprice#6694 AS cval_lineitem_l_extendedprice_0#6727, cval_lineitem_l_discount#6695 AS cval_lineitem_l_discount_0#6728, cval_lineitem_l_tax#6696 AS cval_lineitem_l_tax_0#6729, cval_lineitem_l_returnflag#6697 AS cval_lineitem_l_returnflag_0#6730, cval_lineitem_l_linestatus#6698 AS cval_lineitem_l_linestatus_0#6731, cval_lineitem_l_commitdate#6699 AS cval_lineitem_l_commitdate_0#6732, cval_lineitem_l_receiptdate#6700 AS cval_lineitem_l_receiptdate_0#6733, cval_lineitem_l_shipinstruct#6701 AS cval_lineitem_l_shipinstruct_0#6734, cval_lineitem_l_shipmode#6702 AS cval_lineitem_l_shipmode_0#6735, cval_lineitem_l_comment#6703 AS cval_lineitem_l_comment_0#6736, cval_lineitem_l_shipdate#6704 AS cval_lineitem_l_shipdate_0#6737, cl_quantity#6705 AS cl_quantity_0#6738, cl_extendedprice#6706 AS cl_extendedprice_0#6739, cl_discount#6707 AS cl_discount_0#6740, ... 9 more fields]
         +- Relation[rid#6684,cpfk_orders_lineitem#6685,cpfk_supplier_lineitem#6686,cfpk_lineitem_supplier#6687,cfpk_lineitem_partsupp#6688,cpfk_part_lineitem#6689,cfpk_lineitem_part#6690,cpfk_partsupp_lineitem#6691,cfpk_lineitem_orders#6692,cval_lineitem_l_quantity#6693,cval_lineitem_l_extendedprice#6694,cval_lineitem_l_discount#6695,cval_lineitem_l_tax#6696,cval_lineitem_l_returnflag#6697,cval_lineitem_l_linestatus#6698,cval_lineitem_l_commitdate#6699,cval_lineitem_l_receiptdate#6700,cval_lineitem_l_shipinstruct#6701,cval_lineitem_l_shipmode#6702,cval_lineitem_l_comment#6703,cval_lineitem_l_shipdate#6704,cl_quantity#6705,cl_extendedprice#6706,cl_discount#6707,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 3183ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/11 07:49:19 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:49:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6788L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/11 07:49:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6788L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
            :- Project [rid#6790 AS rid_0#6807, cpfk_customer_orders#6791 AS cpfk_customer_orders_0#6808, cfpk_orders_customer#6792 AS cfpk_orders_customer_0#6809, cval_orders_o_orderstatus#6793 AS cval_orders_o_orderstatus_0#6810, cval_orders_o_totalprice#6794 AS cval_orders_o_totalprice_0#6811, cval_orders_o_orderpriority#6795 AS cval_orders_o_orderpriority_0#6812, cval_orders_o_clerk#6796 AS cval_orders_o_clerk_0#6813, cval_orders_o_shippriority#6797 AS cval_orders_o_shippriority_0#6814, cval_orders_o_comment#6798 AS cval_orders_o_comment_0#6815, cval_orders_o_orderdate#6799 AS cval_orders_o_orderdate_0#6816, co_orderstatus#6800 AS co_orderstatus_0#6817, co_totalprice#6801 AS co_totalprice_0#6818, co_orderpriority#6802 AS co_orderpriority_0#6819, co_clerk#6803 AS co_clerk_0#6820, co_shippriority#6804 AS co_shippriority_0#6821, co_comment#6805 AS co_comment_0#6822, co_orderdate#6806 AS co_orderdate_0#6823]
            :  +- Relation[rid#6790,cpfk_customer_orders#6791,cfpk_orders_customer#6792,cval_orders_o_orderstatus#6793,cval_orders_o_totalprice#6794,cval_orders_o_orderpriority#6795,cval_orders_o_clerk#6796,cval_orders_o_shippriority#6797,cval_orders_o_comment#6798,cval_orders_o_orderdate#6799,co_orderstatus#6800,co_totalprice#6801,co_orderpriority#6802,co_clerk#6803,co_shippriority#6804,co_comment#6805,co_orderdate#6806] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#6824 AS rid_1#6839, cpfk_nation_customer#6825 AS cpfk_nation_customer_1#6840, cfpk_customer_nation#6826 AS cfpk_customer_nation_1#6841, cval_customer_c_name#6827 AS cval_customer_c_name_1#6842, cval_customer_c_address#6828 AS cval_customer_c_address_1#6843, cval_customer_c_phone#6829 AS cval_customer_c_phone_1#6844, cval_customer_c_acctbal#6830 AS cval_customer_c_acctbal_1#6845, cval_customer_c_comment#6831 AS cval_customer_c_comment_1#6846, cval_customer_c_mktsegment#6832 AS cval_customer_c_mktsegment_1#6847, cc_name#6833 AS cc_name_1#6848, cc_address#6834 AS cc_address_1#6849, cc_phone#6835 AS cc_phone_1#6850, cc_acctbal#6836 AS cc_acctbal_1#6851, cc_comment#6837 AS cc_comment_1#6852, cc_mktsegment#6838 AS cc_mktsegment_1#6853]
               +- Relation[rid#6824,cpfk_nation_customer#6825,cfpk_customer_nation#6826,cval_customer_c_name#6827,cval_customer_c_address#6828,cval_customer_c_phone#6829,cval_customer_c_acctbal#6830,cval_customer_c_comment#6831,cval_customer_c_mktsegment#6832,cc_name#6833,cc_address#6834,cc_phone#6835,cc_acctbal#6836,cc_comment#6837,cc_mktsegment#6838] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 13054ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/11 07:49:32 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:49:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6890L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/11 07:49:32 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:49:32 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:49:32 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:49:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:49:32 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:49:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:49:32 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:49:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:49:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:49:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:49:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:49:32 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:49:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:49:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:49:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:49:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:49:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:49:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:49:32 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:49:32 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:49:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6890L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_4))
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :  :  :  :  :  :  :- Project [rid#6892 AS rid_0#6897, cval_region_r_name#6893 AS cval_region_r_name_0#6898, cval_region_r_comment#6894 AS cval_region_r_comment_0#6899, cr_name#6895 AS cr_name_0#6900, cr_comment#6896 AS cr_comment_0#6901]
         :  :  :  :  :  :  :  +- Relation[rid#6892,cval_region_r_name#6893,cval_region_r_comment#6894,cr_name#6895,cr_comment#6896] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion, 'rid_0
         :  :  :  :  :  :     +- Project [rid#6902 AS rid_0#6907, cval_region_r_name#6903 AS cval_region_r_name_0#6908, cval_region_r_comment#6904 AS cval_region_r_comment_0#6909, cr_name#6905 AS cr_name_0#6910, cr_comment#6906 AS cr_comment_0#6911]
         :  :  :  :  :  :        +- Relation[rid#6902,cval_region_r_name#6903,cval_region_r_comment#6904,cr_name#6905,cr_comment#6906] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_1, tregion, 'rid_0, tnation, 'rid_1
         :  :  :  :  :     :- Project [rid#6926 AS rid_0#6931, cval_region_r_name#6927 AS cval_region_r_name_0#6932, cval_region_r_comment#6928 AS cval_region_r_comment_0#6933, cr_name#6929 AS cr_name_0#6934, cr_comment#6930 AS cr_comment_0#6935]
         :  :  :  :  :     :  +- Relation[rid#6926,cval_region_r_name#6927,cval_region_r_comment#6928,cr_name#6929,cr_comment#6930] JDBCRelation(tregion) [numPartitions=1]
         :  :  :  :  :     +- Project [rid#6936 AS rid_1#6943, cpfk_region_nation#6937 AS cpfk_region_nation_1#6944, cfpk_nation_region#6938 AS cfpk_nation_region_1#6945, cval_nation_n_name#6939 AS cval_nation_n_name_1#6946, cval_nation_n_comment#6940 AS cval_nation_n_comment_1#6947, cn_name#6941 AS cn_name_1#6948, cn_comment#6942 AS cn_comment_1#6949]
         :  :  :  :  :        +- Relation[rid#6936,cpfk_region_nation#6937,cfpk_nation_region#6938,cval_nation_n_name#6939,cval_nation_n_comment#6940,cn_name#6941,cn_comment#6942] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  :  +- Project [rid#6912 AS rid_1#6919, cpfk_region_nation#6913 AS cpfk_region_nation_1#6920, cfpk_nation_region#6914 AS cfpk_nation_region_1#6921, cval_nation_n_name#6915 AS cval_nation_n_name_1#6922, cval_nation_n_comment#6916 AS cval_nation_n_comment_1#6923, cn_name#6917 AS cn_name_1#6924, cn_comment#6918 AS cn_comment_1#6925]
         :  :  :  :     +- Relation[rid#6912,cpfk_region_nation#6913,cfpk_nation_region#6914,cval_nation_n_name#6915,cval_nation_n_comment#6916,cn_name#6917,cn_comment#6918] JDBCRelation(tnation) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_2, tnation, 'rid_1, tsupplier, 'rid_2
         :  :  :     :- Project [rid#6976 AS rid_1#6983, cpfk_region_nation#6977 AS cpfk_region_nation_1#6984, cfpk_nation_region#6978 AS cfpk_nation_region_1#6985, cval_nation_n_name#6979 AS cval_nation_n_name_1#6986, cval_nation_n_comment#6980 AS cval_nation_n_comment_1#6987, cn_name#6981 AS cn_name_1#6988, cn_comment#6982 AS cn_comment_1#6989]
         :  :  :     :  +- Relation[rid#6976,cpfk_region_nation#6977,cfpk_nation_region#6978,cval_nation_n_name#6979,cval_nation_n_comment#6980,cn_name#6981,cn_comment#6982] JDBCRelation(tnation) [numPartitions=1]
         :  :  :     +- Project [rid#6990 AS rid_2#7003, cpfk_nation_supplier#6991 AS cpfk_nation_supplier_2#7004, cfpk_supplier_nation#6992 AS cfpk_supplier_nation_2#7005, cval_supplier_s_name#6993 AS cval_supplier_s_name_2#7006, cval_supplier_s_address#6994 AS cval_supplier_s_address_2#7007, cval_supplier_s_phone#6995 AS cval_supplier_s_phone_2#7008, cval_supplier_s_acctbal#6996 AS cval_supplier_s_acctbal_2#7009, cval_supplier_s_comment#6997 AS cval_supplier_s_comment_2#7010, cs_name#6998 AS cs_name_2#7011, cs_address#6999 AS cs_address_2#7012, cs_phone#7000 AS cs_phone_2#7013, cs_acctbal#7001 AS cs_acctbal_2#7014, cs_comment#7002 AS cs_comment_2#7015]
         :  :  :        +- Relation[rid#6990,cpfk_nation_supplier#6991,cfpk_supplier_nation#6992,cval_supplier_s_name#6993,cval_supplier_s_address#6994,cval_supplier_s_phone#6995,cval_supplier_s_acctbal#6996,cval_supplier_s_comment#6997,cs_name#6998,cs_address#6999,cs_phone#7000,cs_acctbal#7001,cs_comment#7002] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  +- Project [rid#6950 AS rid_2#6963, cpfk_nation_supplier#6951 AS cpfk_nation_supplier_2#6964, cfpk_supplier_nation#6952 AS cfpk_supplier_nation_2#6965, cval_supplier_s_name#6953 AS cval_supplier_s_name_2#6966, cval_supplier_s_address#6954 AS cval_supplier_s_address_2#6967, cval_supplier_s_phone#6955 AS cval_supplier_s_phone_2#6968, cval_supplier_s_acctbal#6956 AS cval_supplier_s_acctbal_2#6969, cval_supplier_s_comment#6957 AS cval_supplier_s_comment_2#6970, cs_name#6958 AS cs_name_2#6971, cs_address#6959 AS cs_address_2#6972, cs_phone#6960 AS cs_phone_2#6973, cs_acctbal#6961 AS cs_acctbal_2#6974, cs_comment#6962 AS cs_comment_2#6975]
         :  :     +- Relation[rid#6950,cpfk_nation_supplier#6951,cfpk_supplier_nation#6952,cval_supplier_s_name#6953,cval_supplier_s_address#6954,cval_supplier_s_phone#6955,cval_supplier_s_acctbal#6956,cval_supplier_s_comment#6957,cs_name#6958,cs_address#6959,cs_phone#6960,cs_acctbal#6961,cs_comment#6962] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~partsupp, cpfk_supplier_partsupp, 'cpfk_supplier_partsupp_4, tsupplier, 'rid_2, tpartsupp, 'rid_4
         :     :- Project [rid#7162 AS rid_2#7175, cpfk_nation_supplier#7163 AS cpfk_nation_supplier_2#7176, cfpk_supplier_nation#7164 AS cfpk_supplier_nation_2#7177, cval_supplier_s_name#7165 AS cval_supplier_s_name_2#7178, cval_supplier_s_address#7166 AS cval_supplier_s_address_2#7179, cval_supplier_s_phone#7167 AS cval_supplier_s_phone_2#7180, cval_supplier_s_acctbal#7168 AS cval_supplier_s_acctbal_2#7181, cval_supplier_s_comment#7169 AS cval_supplier_s_comment_2#7182, cs_name#7170 AS cs_name_2#7183, cs_address#7171 AS cs_address_2#7184, cs_phone#7172 AS cs_phone_2#7185, cs_acctbal#7173 AS cs_acctbal_2#7186, cs_comment#7174 AS cs_comment_2#7187]
         :     :  +- Relation[rid#7162,cpfk_nation_supplier#7163,cfpk_supplier_nation#7164,cval_supplier_s_name#7165,cval_supplier_s_address#7166,cval_supplier_s_phone#7167,cval_supplier_s_acctbal#7168,cval_supplier_s_comment#7169,cs_name#7170,cs_address#7171,cs_phone#7172,cs_acctbal#7173,cs_comment#7174] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#7188 AS rid_4#7199, cpfk_part_partsupp#7189 AS cpfk_part_partsupp_4#7200, cfpk_partsupp_part#7190 AS cfpk_partsupp_part_4#7201, cpfk_supplier_partsupp#7191 AS cpfk_supplier_partsupp_4#7202, cfpk_partsupp_supplier#7192 AS cfpk_partsupp_supplier_4#7203, cval_partsupp_ps_availqty#7193 AS cval_partsupp_ps_availqty_4#7204, cval_partsupp_ps_supplycost#7194 AS cval_partsupp_ps_supplycost_4#7205, cval_partsupp_ps_comment#7195 AS cval_partsupp_ps_comment_4#7206, cps_availqty#7196 AS cps_availqty_4#7207, cps_supplycost#7197 AS cps_supplycost_4#7208, cps_comment#7198 AS cps_comment_4#7209]
         :        +- Relation[rid#7188,cpfk_part_partsupp#7189,cfpk_partsupp_part#7190,cpfk_supplier_partsupp#7191,cfpk_partsupp_supplier#7192,cval_partsupp_ps_availqty#7193,cval_partsupp_ps_supplycost#7194,cval_partsupp_ps_comment#7195,cps_availqty#7196,cps_supplycost#7197,cps_comment#7198] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_4))
            :- 'Join UsingJoin(Inner,List(rid_3))
            :  :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :  :  :- Project [rid#7016 AS rid_3#7033, cval_part_p_name#7017 AS cval_part_p_name_3#7034, cval_part_p_mfgr#7018 AS cval_part_p_mfgr_3#7035, cval_part_p_type#7019 AS cval_part_p_type_3#7036, cval_part_p_size#7020 AS cval_part_p_size_3#7037, cval_part_p_container#7021 AS cval_part_p_container_3#7038, cval_part_p_retailprice#7022 AS cval_part_p_retailprice_3#7039, cval_part_p_comment#7023 AS cval_part_p_comment_3#7040, cval_part_p_brand#7024 AS cval_part_p_brand_3#7041, cp_name#7025 AS cp_name_3#7042, cp_mfgr#7026 AS cp_mfgr_3#7043, cp_type#7027 AS cp_type_3#7044, cp_size#7028 AS cp_size_3#7045, cp_container#7029 AS cp_container_3#7046, cp_retailprice#7030 AS cp_retailprice_3#7047, cp_comment#7031 AS cp_comment_3#7048, cp_brand#7032 AS cp_brand_3#7049]
            :  :  :  +- Relation[rid#7016,cval_part_p_name#7017,cval_part_p_mfgr#7018,cval_part_p_type#7019,cval_part_p_size#7020,cval_part_p_container#7021,cval_part_p_retailprice#7022,cval_part_p_comment#7023,cval_part_p_brand#7024,cp_name#7025,cp_mfgr#7026,cp_type#7027,cp_size#7028,cp_container#7029,cp_retailprice#7030,cp_comment#7031,cp_brand#7032] JDBCRelation(tpart) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart, 'rid_3
            :  :     +- Project [rid#7050 AS rid_3#7067, cval_part_p_name#7051 AS cval_part_p_name_3#7068, cval_part_p_mfgr#7052 AS cval_part_p_mfgr_3#7069, cval_part_p_type#7053 AS cval_part_p_type_3#7070, cval_part_p_size#7054 AS cval_part_p_size_3#7071, cval_part_p_container#7055 AS cval_part_p_container_3#7072, cval_part_p_retailprice#7056 AS cval_part_p_retailprice_3#7073, cval_part_p_comment#7057 AS cval_part_p_comment_3#7074, cval_part_p_brand#7058 AS cval_part_p_brand_3#7075, cp_name#7059 AS cp_name_3#7076, cp_mfgr#7060 AS cp_mfgr_3#7077, cp_type#7061 AS cp_type_3#7078, cp_size#7062 AS cp_size_3#7079, cp_container#7063 AS cp_container_3#7080, cp_retailprice#7064 AS cp_retailprice_3#7081, cp_comment#7065 AS cp_comment_3#7082, cp_brand#7066 AS cp_brand_3#7083]
            :  :        +- Relation[rid#7050,cval_part_p_name#7051,cval_part_p_mfgr#7052,cval_part_p_type#7053,cval_part_p_size#7054,cval_part_p_container#7055,cval_part_p_retailprice#7056,cval_part_p_comment#7057,cval_part_p_brand#7058,cp_name#7059,cp_mfgr#7060,cp_type#7061,cp_size#7062,cp_container#7063,cp_retailprice#7064,cp_comment#7065,cp_brand#7066] JDBCRelation(tpart) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyJoin part~partsupp, cpfk_part_partsupp, 'cpfk_part_partsupp_4, tpart, 'rid_3, tpartsupp, 'rid_4
            :     :- Project [rid#7106 AS rid_3#7123, cval_part_p_name#7107 AS cval_part_p_name_3#7124, cval_part_p_mfgr#7108 AS cval_part_p_mfgr_3#7125, cval_part_p_type#7109 AS cval_part_p_type_3#7126, cval_part_p_size#7110 AS cval_part_p_size_3#7127, cval_part_p_container#7111 AS cval_part_p_container_3#7128, cval_part_p_retailprice#7112 AS cval_part_p_retailprice_3#7129, cval_part_p_comment#7113 AS cval_part_p_comment_3#7130, cval_part_p_brand#7114 AS cval_part_p_brand_3#7131, cp_name#7115 AS cp_name_3#7132, cp_mfgr#7116 AS cp_mfgr_3#7133, cp_type#7117 AS cp_type_3#7134, cp_size#7118 AS cp_size_3#7135, cp_container#7119 AS cp_container_3#7136, cp_retailprice#7120 AS cp_retailprice_3#7137, cp_comment#7121 AS cp_comment_3#7138, cp_brand#7122 AS cp_brand_3#7139]
            :     :  +- Relation[rid#7106,cval_part_p_name#7107,cval_part_p_mfgr#7108,cval_part_p_type#7109,cval_part_p_size#7110,cval_part_p_container#7111,cval_part_p_retailprice#7112,cval_part_p_comment#7113,cval_part_p_brand#7114,cp_name#7115,cp_mfgr#7116,cp_type#7117,cp_size#7118,cp_container#7119,cp_retailprice#7120,cp_comment#7121,cp_brand#7122] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#7140 AS rid_4#7151, cpfk_part_partsupp#7141 AS cpfk_part_partsupp_4#7152, cfpk_partsupp_part#7142 AS cfpk_partsupp_part_4#7153, cpfk_supplier_partsupp#7143 AS cpfk_supplier_partsupp_4#7154, cfpk_partsupp_supplier#7144 AS cfpk_partsupp_supplier_4#7155, cval_partsupp_ps_availqty#7145 AS cval_partsupp_ps_availqty_4#7156, cval_partsupp_ps_supplycost#7146 AS cval_partsupp_ps_supplycost_4#7157, cval_partsupp_ps_comment#7147 AS cval_partsupp_ps_comment_4#7158, cps_availqty#7148 AS cps_availqty_4#7159, cps_supplycost#7149 AS cps_supplycost_4#7160, cps_comment#7150 AS cps_comment_4#7161]
            :        +- Relation[rid#7140,cpfk_part_partsupp#7141,cfpk_partsupp_part#7142,cpfk_supplier_partsupp#7143,cfpk_partsupp_supplier#7144,cval_partsupp_ps_availqty#7145,cval_partsupp_ps_supplycost#7146,cval_partsupp_ps_comment#7147,cps_availqty#7148,cps_supplycost#7149,cps_comment#7150] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#7084 AS rid_4#7095, cpfk_part_partsupp#7085 AS cpfk_part_partsupp_4#7096, cfpk_partsupp_part#7086 AS cfpk_partsupp_part_4#7097, cpfk_supplier_partsupp#7087 AS cpfk_supplier_partsupp_4#7098, cfpk_partsupp_supplier#7088 AS cfpk_partsupp_supplier_4#7099, cval_partsupp_ps_availqty#7089 AS cval_partsupp_ps_availqty_4#7100, cval_partsupp_ps_supplycost#7090 AS cval_partsupp_ps_supplycost_4#7101, cval_partsupp_ps_comment#7091 AS cval_partsupp_ps_comment_4#7102, cps_availqty#7092 AS cps_availqty_4#7103, cps_supplycost#7093 AS cps_supplycost_4#7104, cps_comment#7094 AS cps_comment_4#7105]
               +- Relation[rid#7084,cpfk_part_partsupp#7085,cfpk_partsupp_part#7086,cpfk_supplier_partsupp#7087,cfpk_partsupp_supplier#7088,cval_partsupp_ps_availqty#7089,cval_partsupp_ps_supplycost#7090,cval_partsupp_ps_comment#7091,cps_availqty#7092,cps_supplycost#7093,cps_comment#7094] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 20369ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/11 07:49:53 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:49:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7272L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 07:49:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:49:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:49:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:49:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:49:53 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:49:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:49:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:49:53 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:49:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:49:53 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/11 07:49:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7272L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
            :     :     :- 'Join UsingJoin(Inner,List(rid_2))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :  :  :- Project [rid#7274 AS rid_0#7281, cpfk_region_nation#7275 AS cpfk_region_nation_0#7282, cfpk_nation_region#7276 AS cfpk_nation_region_0#7283, cval_nation_n_name#7277 AS cval_nation_n_name_0#7284, cval_nation_n_comment#7278 AS cval_nation_n_comment_0#7285, cn_name#7279 AS cn_name_0#7286, cn_comment#7280 AS cn_comment_0#7287]
            :     :     :  :  :  :  :  +- Relation[rid#7274,cpfk_region_nation#7275,cfpk_nation_region#7276,cval_nation_n_name#7277,cval_nation_n_comment#7278,cn_name#7279,cn_comment#7280] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~supplier, cpfk_nation_supplier, 'cpfk_nation_supplier_1, tnation, 'rid_0, tsupplier, 'rid_1
            :     :     :  :  :  :     :- Project [rid#7314 AS rid_0#7321, cpfk_region_nation#7315 AS cpfk_region_nation_0#7322, cfpk_nation_region#7316 AS cfpk_nation_region_0#7323, cval_nation_n_name#7317 AS cval_nation_n_name_0#7324, cval_nation_n_comment#7318 AS cval_nation_n_comment_0#7325, cn_name#7319 AS cn_name_0#7326, cn_comment#7320 AS cn_comment_0#7327]
            :     :     :  :  :  :     :  +- Relation[rid#7314,cpfk_region_nation#7315,cfpk_nation_region#7316,cval_nation_n_name#7317,cval_nation_n_comment#7318,cn_name#7319,cn_comment#7320] JDBCRelation(tnation) [numPartitions=1]
            :     :     :  :  :  :     +- Project [rid#7328 AS rid_1#7341, cpfk_nation_supplier#7329 AS cpfk_nation_supplier_1#7342, cfpk_supplier_nation#7330 AS cfpk_supplier_nation_1#7343, cval_supplier_s_name#7331 AS cval_supplier_s_name_1#7344, cval_supplier_s_address#7332 AS cval_supplier_s_address_1#7345, cval_supplier_s_phone#7333 AS cval_supplier_s_phone_1#7346, cval_supplier_s_acctbal#7334 AS cval_supplier_s_acctbal_1#7347, cval_supplier_s_comment#7335 AS cval_supplier_s_comment_1#7348, cs_name#7336 AS cs_name_1#7349, cs_address#7337 AS cs_address_1#7350, cs_phone#7338 AS cs_phone_1#7351, cs_acctbal#7339 AS cs_acctbal_1#7352, cs_comment#7340 AS cs_comment_1#7353]
            :     :     :  :  :  :        +- Relation[rid#7328,cpfk_nation_supplier#7329,cfpk_supplier_nation#7330,cval_supplier_s_name#7331,cval_supplier_s_address#7332,cval_supplier_s_phone#7333,cval_supplier_s_acctbal#7334,cval_supplier_s_comment#7335,cs_name#7336,cs_address#7337,cs_phone#7338,cs_acctbal#7339,cs_comment#7340] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  :  +- Project [rid#7288 AS rid_1#7301, cpfk_nation_supplier#7289 AS cpfk_nation_supplier_1#7302, cfpk_supplier_nation#7290 AS cfpk_supplier_nation_1#7303, cval_supplier_s_name#7291 AS cval_supplier_s_name_1#7304, cval_supplier_s_address#7292 AS cval_supplier_s_address_1#7305, cval_supplier_s_phone#7293 AS cval_supplier_s_phone_1#7306, cval_supplier_s_acctbal#7294 AS cval_supplier_s_acctbal_1#7307, cval_supplier_s_comment#7295 AS cval_supplier_s_comment_1#7308, cs_name#7296 AS cs_name_1#7309, cs_address#7297 AS cs_address_1#7310, cs_phone#7298 AS cs_phone_1#7311, cs_acctbal#7299 AS cs_acctbal_1#7312, cs_comment#7300 AS cs_comment_1#7313]
            :     :     :  :  :     +- Relation[rid#7288,cpfk_nation_supplier#7289,cfpk_supplier_nation#7290,cval_supplier_s_name#7291,cval_supplier_s_address#7292,cval_supplier_s_phone#7293,cval_supplier_s_acctbal#7294,cval_supplier_s_comment#7295,cs_name#7296,cs_address#7297,cs_phone#7298,cs_acctbal#7299,cs_comment#7300] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_2, tsupplier, 'rid_1, tlineitem, 'rid_2
            :     :     :  :     :- Project [rid#7420 AS rid_1#7433, cpfk_nation_supplier#7421 AS cpfk_nation_supplier_1#7434, cfpk_supplier_nation#7422 AS cfpk_supplier_nation_1#7435, cval_supplier_s_name#7423 AS cval_supplier_s_name_1#7436, cval_supplier_s_address#7424 AS cval_supplier_s_address_1#7437, cval_supplier_s_phone#7425 AS cval_supplier_s_phone_1#7438, cval_supplier_s_acctbal#7426 AS cval_supplier_s_acctbal_1#7439, cval_supplier_s_comment#7427 AS cval_supplier_s_comment_1#7440, cs_name#7428 AS cs_name_1#7441, cs_address#7429 AS cs_address_1#7442, cs_phone#7430 AS cs_phone_1#7443, cs_acctbal#7431 AS cs_acctbal_1#7444, cs_comment#7432 AS cs_comment_1#7445]
            :     :     :  :     :  +- Relation[rid#7420,cpfk_nation_supplier#7421,cfpk_supplier_nation#7422,cval_supplier_s_name#7423,cval_supplier_s_address#7424,cval_supplier_s_phone#7425,cval_supplier_s_acctbal#7426,cval_supplier_s_comment#7427,cs_name#7428,cs_address#7429,cs_phone#7430,cs_acctbal#7431,cs_comment#7432] JDBCRelation(tsupplier) [numPartitions=1]
            :     :     :  :     +- Project [rid#7446 AS rid_2#7479, cpfk_orders_lineitem#7447 AS cpfk_orders_lineitem_2#7480, cpfk_supplier_lineitem#7448 AS cpfk_supplier_lineitem_2#7481, cfpk_lineitem_supplier#7449 AS cfpk_lineitem_supplier_2#7482, cfpk_lineitem_partsupp#7450 AS cfpk_lineitem_partsupp_2#7483, cpfk_part_lineitem#7451 AS cpfk_part_lineitem_2#7484, cfpk_lineitem_part#7452 AS cfpk_lineitem_part_2#7485, cpfk_partsupp_lineitem#7453 AS cpfk_partsupp_lineitem_2#7486, cfpk_lineitem_orders#7454 AS cfpk_lineitem_orders_2#7487, cval_lineitem_l_quantity#7455 AS cval_lineitem_l_quantity_2#7488, cval_lineitem_l_extendedprice#7456 AS cval_lineitem_l_extendedprice_2#7489, cval_lineitem_l_discount#7457 AS cval_lineitem_l_discount_2#7490, cval_lineitem_l_tax#7458 AS cval_lineitem_l_tax_2#7491, cval_lineitem_l_returnflag#7459 AS cval_lineitem_l_returnflag_2#7492, cval_lineitem_l_linestatus#7460 AS cval_lineitem_l_linestatus_2#7493, cval_lineitem_l_commitdate#7461 AS cval_lineitem_l_commitdate_2#7494, cval_lineitem_l_receiptdate#7462 AS cval_lineitem_l_receiptdate_2#7495, cval_lineitem_l_shipinstruct#7463 AS cval_lineitem_l_shipinstruct_2#7496, cval_lineitem_l_shipmode#7464 AS cval_lineitem_l_shipmode_2#7497, cval_lineitem_l_comment#7465 AS cval_lineitem_l_comment_2#7498, cval_lineitem_l_shipdate#7466 AS cval_lineitem_l_shipdate_2#7499, cl_quantity#7467 AS cl_quantity_2#7500, cl_extendedprice#7468 AS cl_extendedprice_2#7501, cl_discount#7469 AS cl_discount_2#7502, ... 9 more fields]
            :     :     :  :        +- Relation[rid#7446,cpfk_orders_lineitem#7447,cpfk_supplier_lineitem#7448,cfpk_lineitem_supplier#7449,cfpk_lineitem_partsupp#7450,cpfk_part_lineitem#7451,cfpk_lineitem_part#7452,cpfk_partsupp_lineitem#7453,cfpk_lineitem_orders#7454,cval_lineitem_l_quantity#7455,cval_lineitem_l_extendedprice#7456,cval_lineitem_l_discount#7457,cval_lineitem_l_tax#7458,cval_lineitem_l_returnflag#7459,cval_lineitem_l_linestatus#7460,cval_lineitem_l_commitdate#7461,cval_lineitem_l_receiptdate#7462,cval_lineitem_l_shipinstruct#7463,cval_lineitem_l_shipmode#7464,cval_lineitem_l_comment#7465,cval_lineitem_l_shipdate#7466,cl_quantity#7467,cl_extendedprice#7468,cl_discount#7469,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#7354 AS rid_2#7387, cpfk_orders_lineitem#7355 AS cpfk_orders_lineitem_2#7388, cpfk_supplier_lineitem#7356 AS cpfk_supplier_lineitem_2#7389, cfpk_lineitem_supplier#7357 AS cfpk_lineitem_supplier_2#7390, cfpk_lineitem_partsupp#7358 AS cfpk_lineitem_partsupp_2#7391, cpfk_part_lineitem#7359 AS cpfk_part_lineitem_2#7392, cfpk_lineitem_part#7360 AS cfpk_lineitem_part_2#7393, cpfk_partsupp_lineitem#7361 AS cpfk_partsupp_lineitem_2#7394, cfpk_lineitem_orders#7362 AS cfpk_lineitem_orders_2#7395, cval_lineitem_l_quantity#7363 AS cval_lineitem_l_quantity_2#7396, cval_lineitem_l_extendedprice#7364 AS cval_lineitem_l_extendedprice_2#7397, cval_lineitem_l_discount#7365 AS cval_lineitem_l_discount_2#7398, cval_lineitem_l_tax#7366 AS cval_lineitem_l_tax_2#7399, cval_lineitem_l_returnflag#7367 AS cval_lineitem_l_returnflag_2#7400, cval_lineitem_l_linestatus#7368 AS cval_lineitem_l_linestatus_2#7401, cval_lineitem_l_commitdate#7369 AS cval_lineitem_l_commitdate_2#7402, cval_lineitem_l_receiptdate#7370 AS cval_lineitem_l_receiptdate_2#7403, cval_lineitem_l_shipinstruct#7371 AS cval_lineitem_l_shipinstruct_2#7404, cval_lineitem_l_shipmode#7372 AS cval_lineitem_l_shipmode_2#7405, cval_lineitem_l_comment#7373 AS cval_lineitem_l_comment_2#7406, cval_lineitem_l_shipdate#7374 AS cval_lineitem_l_shipdate_2#7407, cl_quantity#7375 AS cl_quantity_2#7408, cl_extendedprice#7376 AS cl_extendedprice_2#7409, cl_discount#7377 AS cl_discount_2#7410, ... 9 more fields]
            :     :     :     +- Relation[rid#7354,cpfk_orders_lineitem#7355,cpfk_supplier_lineitem#7356,cfpk_lineitem_supplier#7357,cfpk_lineitem_partsupp#7358,cpfk_part_lineitem#7359,cfpk_lineitem_part#7360,cpfk_partsupp_lineitem#7361,cfpk_lineitem_orders#7362,cval_lineitem_l_quantity#7363,cval_lineitem_l_extendedprice#7364,cval_lineitem_l_discount#7365,cval_lineitem_l_tax#7366,cval_lineitem_l_returnflag#7367,cval_lineitem_l_linestatus#7368,cval_lineitem_l_commitdate#7369,cval_lineitem_l_receiptdate#7370,cval_lineitem_l_shipinstruct#7371,cval_lineitem_l_shipmode#7372,cval_lineitem_l_comment#7373,cval_lineitem_l_shipdate#7374,cl_quantity#7375,cl_extendedprice#7376,cl_discount#7377,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#7512 AS rid_3#7529, cval_part_p_name#7513 AS cval_part_p_name_3#7530, cval_part_p_mfgr#7514 AS cval_part_p_mfgr_3#7531, cval_part_p_type#7515 AS cval_part_p_type_3#7532, cval_part_p_size#7516 AS cval_part_p_size_3#7533, cval_part_p_container#7517 AS cval_part_p_container_3#7534, cval_part_p_retailprice#7518 AS cval_part_p_retailprice_3#7535, cval_part_p_comment#7519 AS cval_part_p_comment_3#7536, cval_part_p_brand#7520 AS cval_part_p_brand_3#7537, cp_name#7521 AS cp_name_3#7538, cp_mfgr#7522 AS cp_mfgr_3#7539, cp_type#7523 AS cp_type_3#7540, cp_size#7524 AS cp_size_3#7541, cp_container#7525 AS cp_container_3#7542, cp_retailprice#7526 AS cp_retailprice_3#7543, cp_comment#7527 AS cp_comment_3#7544, cp_brand#7528 AS cp_brand_3#7545]
            :     :        +- Relation[rid#7512,cval_part_p_name#7513,cval_part_p_mfgr#7514,cval_part_p_type#7515,cval_part_p_size#7516,cval_part_p_container#7517,cval_part_p_retailprice#7518,cval_part_p_comment#7519,cval_part_p_brand#7520,cp_name#7521,cp_mfgr#7522,cp_type#7523,cp_size#7524,cp_container#7525,cp_retailprice#7526,cp_comment#7527,cp_brand#7528] JDBCRelation(tpart) [numPartitions=1]
            :     +- Project [rid#7546 AS rid_4#7557, cpfk_part_partsupp#7547 AS cpfk_part_partsupp_4#7558, cfpk_partsupp_part#7548 AS cfpk_partsupp_part_4#7559, cpfk_supplier_partsupp#7549 AS cpfk_supplier_partsupp_4#7560, cfpk_partsupp_supplier#7550 AS cfpk_partsupp_supplier_4#7561, cval_partsupp_ps_availqty#7551 AS cval_partsupp_ps_availqty_4#7562, cval_partsupp_ps_supplycost#7552 AS cval_partsupp_ps_supplycost_4#7563, cval_partsupp_ps_comment#7553 AS cval_partsupp_ps_comment_4#7564, cps_availqty#7554 AS cps_availqty_4#7565, cps_supplycost#7555 AS cps_supplycost_4#7566, cps_comment#7556 AS cps_comment_4#7567]
            :        +- Relation[rid#7546,cpfk_part_partsupp#7547,cfpk_partsupp_part#7548,cpfk_supplier_partsupp#7549,cfpk_partsupp_supplier#7550,cval_partsupp_ps_availqty#7551,cval_partsupp_ps_supplycost#7552,cval_partsupp_ps_comment#7553,cps_availqty#7554,cps_supplycost#7555,cps_comment#7556] JDBCRelation(tpartsupp) [numPartitions=1]
            +- Project [rid#7568 AS rid_5#7585, cpfk_customer_orders#7569 AS cpfk_customer_orders_5#7586, cfpk_orders_customer#7570 AS cfpk_orders_customer_5#7587, cval_orders_o_orderstatus#7571 AS cval_orders_o_orderstatus_5#7588, cval_orders_o_totalprice#7572 AS cval_orders_o_totalprice_5#7589, cval_orders_o_orderpriority#7573 AS cval_orders_o_orderpriority_5#7590, cval_orders_o_clerk#7574 AS cval_orders_o_clerk_5#7591, cval_orders_o_shippriority#7575 AS cval_orders_o_shippriority_5#7592, cval_orders_o_comment#7576 AS cval_orders_o_comment_5#7593, cval_orders_o_orderdate#7577 AS cval_orders_o_orderdate_5#7594, co_orderstatus#7578 AS co_orderstatus_5#7595, co_totalprice#7579 AS co_totalprice_5#7596, co_orderpriority#7580 AS co_orderpriority_5#7597, co_clerk#7581 AS co_clerk_5#7598, co_shippriority#7582 AS co_shippriority_5#7599, co_comment#7583 AS co_comment_5#7600, co_orderdate#7584 AS co_orderdate_5#7601]
               +- Relation[rid#7568,cpfk_customer_orders#7569,cfpk_orders_customer#7570,cval_orders_o_orderstatus#7571,cval_orders_o_totalprice#7572,cval_orders_o_orderpriority#7573,cval_orders_o_clerk#7574,cval_orders_o_shippriority#7575,cval_orders_o_comment#7576,cval_orders_o_orderdate#7577,co_orderstatus#7578,co_totalprice#7579,co_orderpriority#7580,co_clerk#7581,co_shippriority#7582,co_comment#7583,co_orderdate#7584] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 243308ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/11 07:53:56 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:53:56 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7704L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 07:53:56 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7704L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
            :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :  :- Project [rid#7706 AS rid_0#7739, cpfk_orders_lineitem#7707 AS cpfk_orders_lineitem_0#7740, cpfk_supplier_lineitem#7708 AS cpfk_supplier_lineitem_0#7741, cfpk_lineitem_supplier#7709 AS cfpk_lineitem_supplier_0#7742, cfpk_lineitem_partsupp#7710 AS cfpk_lineitem_partsupp_0#7743, cpfk_part_lineitem#7711 AS cpfk_part_lineitem_0#7744, cfpk_lineitem_part#7712 AS cfpk_lineitem_part_0#7745, cpfk_partsupp_lineitem#7713 AS cpfk_partsupp_lineitem_0#7746, cfpk_lineitem_orders#7714 AS cfpk_lineitem_orders_0#7747, cval_lineitem_l_quantity#7715 AS cval_lineitem_l_quantity_0#7748, cval_lineitem_l_extendedprice#7716 AS cval_lineitem_l_extendedprice_0#7749, cval_lineitem_l_discount#7717 AS cval_lineitem_l_discount_0#7750, cval_lineitem_l_tax#7718 AS cval_lineitem_l_tax_0#7751, cval_lineitem_l_returnflag#7719 AS cval_lineitem_l_returnflag_0#7752, cval_lineitem_l_linestatus#7720 AS cval_lineitem_l_linestatus_0#7753, cval_lineitem_l_commitdate#7721 AS cval_lineitem_l_commitdate_0#7754, cval_lineitem_l_receiptdate#7722 AS cval_lineitem_l_receiptdate_0#7755, cval_lineitem_l_shipinstruct#7723 AS cval_lineitem_l_shipinstruct_0#7756, cval_lineitem_l_shipmode#7724 AS cval_lineitem_l_shipmode_0#7757, cval_lineitem_l_comment#7725 AS cval_lineitem_l_comment_0#7758, cval_lineitem_l_shipdate#7726 AS cval_lineitem_l_shipdate_0#7759, cl_quantity#7727 AS cl_quantity_0#7760, cl_extendedprice#7728 AS cl_extendedprice_0#7761, cl_discount#7729 AS cl_discount_0#7762, ... 9 more fields]
            :  :  +- Relation[rid#7706,cpfk_orders_lineitem#7707,cpfk_supplier_lineitem#7708,cfpk_lineitem_supplier#7709,cfpk_lineitem_partsupp#7710,cpfk_part_lineitem#7711,cfpk_lineitem_part#7712,cpfk_partsupp_lineitem#7713,cfpk_lineitem_orders#7714,cval_lineitem_l_quantity#7715,cval_lineitem_l_extendedprice#7716,cval_lineitem_l_discount#7717,cval_lineitem_l_tax#7718,cval_lineitem_l_returnflag#7719,cval_lineitem_l_linestatus#7720,cval_lineitem_l_commitdate#7721,cval_lineitem_l_receiptdate#7722,cval_lineitem_l_shipinstruct#7723,cval_lineitem_l_shipmode#7724,cval_lineitem_l_comment#7725,cval_lineitem_l_shipdate#7726,cl_quantity#7727,cl_extendedprice#7728,cl_discount#7729,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem, 'rid_0
            :     +- Project [rid#7772 AS rid_0#7805, cpfk_orders_lineitem#7773 AS cpfk_orders_lineitem_0#7806, cpfk_supplier_lineitem#7774 AS cpfk_supplier_lineitem_0#7807, cfpk_lineitem_supplier#7775 AS cfpk_lineitem_supplier_0#7808, cfpk_lineitem_partsupp#7776 AS cfpk_lineitem_partsupp_0#7809, cpfk_part_lineitem#7777 AS cpfk_part_lineitem_0#7810, cfpk_lineitem_part#7778 AS cfpk_lineitem_part_0#7811, cpfk_partsupp_lineitem#7779 AS cpfk_partsupp_lineitem_0#7812, cfpk_lineitem_orders#7780 AS cfpk_lineitem_orders_0#7813, cval_lineitem_l_quantity#7781 AS cval_lineitem_l_quantity_0#7814, cval_lineitem_l_extendedprice#7782 AS cval_lineitem_l_extendedprice_0#7815, cval_lineitem_l_discount#7783 AS cval_lineitem_l_discount_0#7816, cval_lineitem_l_tax#7784 AS cval_lineitem_l_tax_0#7817, cval_lineitem_l_returnflag#7785 AS cval_lineitem_l_returnflag_0#7818, cval_lineitem_l_linestatus#7786 AS cval_lineitem_l_linestatus_0#7819, cval_lineitem_l_commitdate#7787 AS cval_lineitem_l_commitdate_0#7820, cval_lineitem_l_receiptdate#7788 AS cval_lineitem_l_receiptdate_0#7821, cval_lineitem_l_shipinstruct#7789 AS cval_lineitem_l_shipinstruct_0#7822, cval_lineitem_l_shipmode#7790 AS cval_lineitem_l_shipmode_0#7823, cval_lineitem_l_comment#7791 AS cval_lineitem_l_comment_0#7824, cval_lineitem_l_shipdate#7792 AS cval_lineitem_l_shipdate_0#7825, cl_quantity#7793 AS cl_quantity_0#7826, cl_extendedprice#7794 AS cl_extendedprice_0#7827, cl_discount#7795 AS cl_discount_0#7828, ... 9 more fields]
            :        +- Relation[rid#7772,cpfk_orders_lineitem#7773,cpfk_supplier_lineitem#7774,cfpk_lineitem_supplier#7775,cfpk_lineitem_partsupp#7776,cpfk_part_lineitem#7777,cfpk_lineitem_part#7778,cpfk_partsupp_lineitem#7779,cfpk_lineitem_orders#7780,cval_lineitem_l_quantity#7781,cval_lineitem_l_extendedprice#7782,cval_lineitem_l_discount#7783,cval_lineitem_l_tax#7784,cval_lineitem_l_returnflag#7785,cval_lineitem_l_linestatus#7786,cval_lineitem_l_commitdate#7787,cval_lineitem_l_receiptdate#7788,cval_lineitem_l_shipinstruct#7789,cval_lineitem_l_shipmode#7790,cval_lineitem_l_comment#7791,cval_lineitem_l_shipdate#7792,cl_quantity#7793,cl_extendedprice#7794,cl_discount#7795,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            +- Project [rid#7838 AS rid_1#7855, cpfk_customer_orders#7839 AS cpfk_customer_orders_1#7856, cfpk_orders_customer#7840 AS cfpk_orders_customer_1#7857, cval_orders_o_orderstatus#7841 AS cval_orders_o_orderstatus_1#7858, cval_orders_o_totalprice#7842 AS cval_orders_o_totalprice_1#7859, cval_orders_o_orderpriority#7843 AS cval_orders_o_orderpriority_1#7860, cval_orders_o_clerk#7844 AS cval_orders_o_clerk_1#7861, cval_orders_o_shippriority#7845 AS cval_orders_o_shippriority_1#7862, cval_orders_o_comment#7846 AS cval_orders_o_comment_1#7863, cval_orders_o_orderdate#7847 AS cval_orders_o_orderdate_1#7864, co_orderstatus#7848 AS co_orderstatus_1#7865, co_totalprice#7849 AS co_totalprice_1#7866, co_orderpriority#7850 AS co_orderpriority_1#7867, co_clerk#7851 AS co_clerk_1#7868, co_shippriority#7852 AS co_shippriority_1#7869, co_comment#7853 AS co_comment_1#7870, co_orderdate#7854 AS co_orderdate_1#7871]
               +- Relation[rid#7838,cpfk_customer_orders#7839,cfpk_orders_customer#7840,cval_orders_o_orderstatus#7841,cval_orders_o_totalprice#7842,cval_orders_o_orderpriority#7843,cval_orders_o_clerk#7844,cval_orders_o_shippriority#7845,cval_orders_o_comment#7846,cval_orders_o_orderdate#7847,co_orderstatus#7848,co_totalprice#7849,co_orderpriority#7850,co_clerk#7851,co_shippriority#7852,co_comment#7853,co_orderdate#7854] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 22041ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/11 07:54:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:54:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7929L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 07:54:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:54:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:54:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:54:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7929L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#7931 AS rid_0#7944, cpfk_nation_supplier#7932 AS cpfk_nation_supplier_0#7945, cfpk_supplier_nation#7933 AS cfpk_supplier_nation_0#7946, cval_supplier_s_name#7934 AS cval_supplier_s_name_0#7947, cval_supplier_s_address#7935 AS cval_supplier_s_address_0#7948, cval_supplier_s_phone#7936 AS cval_supplier_s_phone_0#7949, cval_supplier_s_acctbal#7937 AS cval_supplier_s_acctbal_0#7950, cval_supplier_s_comment#7938 AS cval_supplier_s_comment_0#7951, cs_name#7939 AS cs_name_0#7952, cs_address#7940 AS cs_address_0#7953, cs_phone#7941 AS cs_phone_0#7954, cs_acctbal#7942 AS cs_acctbal_0#7955, cs_comment#7943 AS cs_comment_0#7956]
         :  :  +- Relation[rid#7931,cpfk_nation_supplier#7932,cfpk_supplier_nation#7933,cval_supplier_s_name#7934,cval_supplier_s_address#7935,cval_supplier_s_phone#7936,cval_supplier_s_acctbal#7937,cval_supplier_s_comment#7938,cs_name#7939,cs_address#7940,cs_phone#7941,cs_acctbal#7942,cs_comment#7943] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin supplier~lineitem, cpfk_supplier_lineitem, 'cpfk_supplier_lineitem_1, tsupplier, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#8023 AS rid_0#8036, cpfk_nation_supplier#8024 AS cpfk_nation_supplier_0#8037, cfpk_supplier_nation#8025 AS cfpk_supplier_nation_0#8038, cval_supplier_s_name#8026 AS cval_supplier_s_name_0#8039, cval_supplier_s_address#8027 AS cval_supplier_s_address_0#8040, cval_supplier_s_phone#8028 AS cval_supplier_s_phone_0#8041, cval_supplier_s_acctbal#8029 AS cval_supplier_s_acctbal_0#8042, cval_supplier_s_comment#8030 AS cval_supplier_s_comment_0#8043, cs_name#8031 AS cs_name_0#8044, cs_address#8032 AS cs_address_0#8045, cs_phone#8033 AS cs_phone_0#8046, cs_acctbal#8034 AS cs_acctbal_0#8047, cs_comment#8035 AS cs_comment_0#8048]
         :     :  +- Relation[rid#8023,cpfk_nation_supplier#8024,cfpk_supplier_nation#8025,cval_supplier_s_name#8026,cval_supplier_s_address#8027,cval_supplier_s_phone#8028,cval_supplier_s_acctbal#8029,cval_supplier_s_comment#8030,cs_name#8031,cs_address#8032,cs_phone#8033,cs_acctbal#8034,cs_comment#8035] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#8049 AS rid_1#8082, cpfk_orders_lineitem#8050 AS cpfk_orders_lineitem_1#8083, cpfk_supplier_lineitem#8051 AS cpfk_supplier_lineitem_1#8084, cfpk_lineitem_supplier#8052 AS cfpk_lineitem_supplier_1#8085, cfpk_lineitem_partsupp#8053 AS cfpk_lineitem_partsupp_1#8086, cpfk_part_lineitem#8054 AS cpfk_part_lineitem_1#8087, cfpk_lineitem_part#8055 AS cfpk_lineitem_part_1#8088, cpfk_partsupp_lineitem#8056 AS cpfk_partsupp_lineitem_1#8089, cfpk_lineitem_orders#8057 AS cfpk_lineitem_orders_1#8090, cval_lineitem_l_quantity#8058 AS cval_lineitem_l_quantity_1#8091, cval_lineitem_l_extendedprice#8059 AS cval_lineitem_l_extendedprice_1#8092, cval_lineitem_l_discount#8060 AS cval_lineitem_l_discount_1#8093, cval_lineitem_l_tax#8061 AS cval_lineitem_l_tax_1#8094, cval_lineitem_l_returnflag#8062 AS cval_lineitem_l_returnflag_1#8095, cval_lineitem_l_linestatus#8063 AS cval_lineitem_l_linestatus_1#8096, cval_lineitem_l_commitdate#8064 AS cval_lineitem_l_commitdate_1#8097, cval_lineitem_l_receiptdate#8065 AS cval_lineitem_l_receiptdate_1#8098, cval_lineitem_l_shipinstruct#8066 AS cval_lineitem_l_shipinstruct_1#8099, cval_lineitem_l_shipmode#8067 AS cval_lineitem_l_shipmode_1#8100, cval_lineitem_l_comment#8068 AS cval_lineitem_l_comment_1#8101, cval_lineitem_l_shipdate#8069 AS cval_lineitem_l_shipdate_1#8102, cl_quantity#8070 AS cl_quantity_1#8103, cl_extendedprice#8071 AS cl_extendedprice_1#8104, cl_discount#8072 AS cl_discount_1#8105, ... 9 more fields]
         :        +- Relation[rid#8049,cpfk_orders_lineitem#8050,cpfk_supplier_lineitem#8051,cfpk_lineitem_supplier#8052,cfpk_lineitem_partsupp#8053,cpfk_part_lineitem#8054,cfpk_lineitem_part#8055,cpfk_partsupp_lineitem#8056,cfpk_lineitem_orders#8057,cval_lineitem_l_quantity#8058,cval_lineitem_l_extendedprice#8059,cval_lineitem_l_discount#8060,cval_lineitem_l_tax#8061,cval_lineitem_l_returnflag#8062,cval_lineitem_l_linestatus#8063,cval_lineitem_l_commitdate#8064,cval_lineitem_l_receiptdate#8065,cval_lineitem_l_shipinstruct#8066,cval_lineitem_l_shipmode#8067,cval_lineitem_l_comment#8068,cval_lineitem_l_shipdate#8069,cl_quantity#8070,cl_extendedprice#8071,cl_discount#8072,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#7957 AS rid_1#7990, cpfk_orders_lineitem#7958 AS cpfk_orders_lineitem_1#7991, cpfk_supplier_lineitem#7959 AS cpfk_supplier_lineitem_1#7992, cfpk_lineitem_supplier#7960 AS cfpk_lineitem_supplier_1#7993, cfpk_lineitem_partsupp#7961 AS cfpk_lineitem_partsupp_1#7994, cpfk_part_lineitem#7962 AS cpfk_part_lineitem_1#7995, cfpk_lineitem_part#7963 AS cfpk_lineitem_part_1#7996, cpfk_partsupp_lineitem#7964 AS cpfk_partsupp_lineitem_1#7997, cfpk_lineitem_orders#7965 AS cfpk_lineitem_orders_1#7998, cval_lineitem_l_quantity#7966 AS cval_lineitem_l_quantity_1#7999, cval_lineitem_l_extendedprice#7967 AS cval_lineitem_l_extendedprice_1#8000, cval_lineitem_l_discount#7968 AS cval_lineitem_l_discount_1#8001, cval_lineitem_l_tax#7969 AS cval_lineitem_l_tax_1#8002, cval_lineitem_l_returnflag#7970 AS cval_lineitem_l_returnflag_1#8003, cval_lineitem_l_linestatus#7971 AS cval_lineitem_l_linestatus_1#8004, cval_lineitem_l_commitdate#7972 AS cval_lineitem_l_commitdate_1#8005, cval_lineitem_l_receiptdate#7973 AS cval_lineitem_l_receiptdate_1#8006, cval_lineitem_l_shipinstruct#7974 AS cval_lineitem_l_shipinstruct_1#8007, cval_lineitem_l_shipmode#7975 AS cval_lineitem_l_shipmode_1#8008, cval_lineitem_l_comment#7976 AS cval_lineitem_l_comment_1#8009, cval_lineitem_l_shipdate#7977 AS cval_lineitem_l_shipdate_1#8010, cl_quantity#7978 AS cl_quantity_1#8011, cl_extendedprice#7979 AS cl_extendedprice_1#8012, cl_discount#7980 AS cl_discount_1#8013, ... 9 more fields]
            +- Relation[rid#7957,cpfk_orders_lineitem#7958,cpfk_supplier_lineitem#7959,cfpk_lineitem_supplier#7960,cfpk_lineitem_partsupp#7961,cpfk_part_lineitem#7962,cfpk_lineitem_part#7963,cpfk_partsupp_lineitem#7964,cfpk_lineitem_orders#7965,cval_lineitem_l_quantity#7966,cval_lineitem_l_extendedprice#7967,cval_lineitem_l_discount#7968,cval_lineitem_l_tax#7969,cval_lineitem_l_returnflag#7970,cval_lineitem_l_linestatus#7971,cval_lineitem_l_commitdate#7972,cval_lineitem_l_receiptdate#7973,cval_lineitem_l_shipinstruct#7974,cval_lineitem_l_shipmode#7975,cval_lineitem_l_comment#7976,cval_lineitem_l_shipdate#7977,cl_quantity#7978,cl_extendedprice#7979,cl_discount#7980,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 77821ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/11 07:55:36 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:55:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8170L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 07:55:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8170L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_2))
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [rid#8172 AS rid_0#8187, cpfk_nation_customer#8173 AS cpfk_nation_customer_0#8188, cfpk_customer_nation#8174 AS cfpk_customer_nation_0#8189, cval_customer_c_name#8175 AS cval_customer_c_name_0#8190, cval_customer_c_address#8176 AS cval_customer_c_address_0#8191, cval_customer_c_phone#8177 AS cval_customer_c_phone_0#8192, cval_customer_c_acctbal#8178 AS cval_customer_c_acctbal_0#8193, cval_customer_c_comment#8179 AS cval_customer_c_comment_0#8194, cval_customer_c_mktsegment#8180 AS cval_customer_c_mktsegment_0#8195, cc_name#8181 AS cc_name_0#8196, cc_address#8182 AS cc_address_0#8197, cc_phone#8183 AS cc_phone_0#8198, cc_acctbal#8184 AS cc_acctbal_0#8199, cc_comment#8185 AS cc_comment_0#8200, cc_mktsegment#8186 AS cc_mktsegment_0#8201]
         :  :  :  :  +- Relation[rid#8172,cpfk_nation_customer#8173,cfpk_customer_nation#8174,cval_customer_c_name#8175,cval_customer_c_address#8176,cval_customer_c_phone#8177,cval_customer_c_acctbal#8178,cval_customer_c_comment#8179,cval_customer_c_mktsegment#8180,cc_name#8181,cc_address#8182,cc_phone#8183,cc_acctbal#8184,cc_comment#8185,cc_mktsegment#8186] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_1, tcustomer, 'rid_0, torders, 'rid_1
         :  :  :     :- Project [rid#8236 AS rid_0#8251, cpfk_nation_customer#8237 AS cpfk_nation_customer_0#8252, cfpk_customer_nation#8238 AS cfpk_customer_nation_0#8253, cval_customer_c_name#8239 AS cval_customer_c_name_0#8254, cval_customer_c_address#8240 AS cval_customer_c_address_0#8255, cval_customer_c_phone#8241 AS cval_customer_c_phone_0#8256, cval_customer_c_acctbal#8242 AS cval_customer_c_acctbal_0#8257, cval_customer_c_comment#8243 AS cval_customer_c_comment_0#8258, cval_customer_c_mktsegment#8244 AS cval_customer_c_mktsegment_0#8259, cc_name#8245 AS cc_name_0#8260, cc_address#8246 AS cc_address_0#8261, cc_phone#8247 AS cc_phone_0#8262, cc_acctbal#8248 AS cc_acctbal_0#8263, cc_comment#8249 AS cc_comment_0#8264, cc_mktsegment#8250 AS cc_mktsegment_0#8265]
         :  :  :     :  +- Relation[rid#8236,cpfk_nation_customer#8237,cfpk_customer_nation#8238,cval_customer_c_name#8239,cval_customer_c_address#8240,cval_customer_c_phone#8241,cval_customer_c_acctbal#8242,cval_customer_c_comment#8243,cval_customer_c_mktsegment#8244,cc_name#8245,cc_address#8246,cc_phone#8247,cc_acctbal#8248,cc_comment#8249,cc_mktsegment#8250] JDBCRelation(tcustomer) [numPartitions=1]
         :  :  :     +- Project [rid#8266 AS rid_1#8283, cpfk_customer_orders#8267 AS cpfk_customer_orders_1#8284, cfpk_orders_customer#8268 AS cfpk_orders_customer_1#8285, cval_orders_o_orderstatus#8269 AS cval_orders_o_orderstatus_1#8286, cval_orders_o_totalprice#8270 AS cval_orders_o_totalprice_1#8287, cval_orders_o_orderpriority#8271 AS cval_orders_o_orderpriority_1#8288, cval_orders_o_clerk#8272 AS cval_orders_o_clerk_1#8289, cval_orders_o_shippriority#8273 AS cval_orders_o_shippriority_1#8290, cval_orders_o_comment#8274 AS cval_orders_o_comment_1#8291, cval_orders_o_orderdate#8275 AS cval_orders_o_orderdate_1#8292, co_orderstatus#8276 AS co_orderstatus_1#8293, co_totalprice#8277 AS co_totalprice_1#8294, co_orderpriority#8278 AS co_orderpriority_1#8295, co_clerk#8279 AS co_clerk_1#8296, co_shippriority#8280 AS co_shippriority_1#8297, co_comment#8281 AS co_comment_1#8298, co_orderdate#8282 AS co_orderdate_1#8299]
         :  :  :        +- Relation[rid#8266,cpfk_customer_orders#8267,cfpk_orders_customer#8268,cval_orders_o_orderstatus#8269,cval_orders_o_totalprice#8270,cval_orders_o_orderpriority#8271,cval_orders_o_clerk#8272,cval_orders_o_shippriority#8273,cval_orders_o_comment#8274,cval_orders_o_orderdate#8275,co_orderstatus#8276,co_totalprice#8277,co_orderpriority#8278,co_clerk#8279,co_shippriority#8280,co_comment#8281,co_orderdate#8282] JDBCRelation(torders) [numPartitions=1]
         :  :  +- Project [rid#8202 AS rid_1#8219, cpfk_customer_orders#8203 AS cpfk_customer_orders_1#8220, cfpk_orders_customer#8204 AS cfpk_orders_customer_1#8221, cval_orders_o_orderstatus#8205 AS cval_orders_o_orderstatus_1#8222, cval_orders_o_totalprice#8206 AS cval_orders_o_totalprice_1#8223, cval_orders_o_orderpriority#8207 AS cval_orders_o_orderpriority_1#8224, cval_orders_o_clerk#8208 AS cval_orders_o_clerk_1#8225, cval_orders_o_shippriority#8209 AS cval_orders_o_shippriority_1#8226, cval_orders_o_comment#8210 AS cval_orders_o_comment_1#8227, cval_orders_o_orderdate#8211 AS cval_orders_o_orderdate_1#8228, co_orderstatus#8212 AS co_orderstatus_1#8229, co_totalprice#8213 AS co_totalprice_1#8230, co_orderpriority#8214 AS co_orderpriority_1#8231, co_clerk#8215 AS co_clerk_1#8232, co_shippriority#8216 AS co_shippriority_1#8233, co_comment#8217 AS co_comment_1#8234, co_orderdate#8218 AS co_orderdate_1#8235]
         :  :     +- Relation[rid#8202,cpfk_customer_orders#8203,cfpk_orders_customer#8204,cval_orders_o_orderstatus#8205,cval_orders_o_totalprice#8206,cval_orders_o_orderpriority#8207,cval_orders_o_clerk#8208,cval_orders_o_shippriority#8209,cval_orders_o_comment#8210,cval_orders_o_orderdate#8211,co_orderstatus#8212,co_totalprice#8213,co_orderpriority#8214,co_clerk#8215,co_shippriority#8216,co_comment#8217,co_orderdate#8218] JDBCRelation(torders) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin orders~lineitem, cpfk_orders_lineitem, 'cpfk_orders_lineitem_2, torders, 'rid_1, tlineitem, 'rid_2
         :     :- Project [rid#8366 AS rid_1#8383, cpfk_customer_orders#8367 AS cpfk_customer_orders_1#8384, cfpk_orders_customer#8368 AS cfpk_orders_customer_1#8385, cval_orders_o_orderstatus#8369 AS cval_orders_o_orderstatus_1#8386, cval_orders_o_totalprice#8370 AS cval_orders_o_totalprice_1#8387, cval_orders_o_orderpriority#8371 AS cval_orders_o_orderpriority_1#8388, cval_orders_o_clerk#8372 AS cval_orders_o_clerk_1#8389, cval_orders_o_shippriority#8373 AS cval_orders_o_shippriority_1#8390, cval_orders_o_comment#8374 AS cval_orders_o_comment_1#8391, cval_orders_o_orderdate#8375 AS cval_orders_o_orderdate_1#8392, co_orderstatus#8376 AS co_orderstatus_1#8393, co_totalprice#8377 AS co_totalprice_1#8394, co_orderpriority#8378 AS co_orderpriority_1#8395, co_clerk#8379 AS co_clerk_1#8396, co_shippriority#8380 AS co_shippriority_1#8397, co_comment#8381 AS co_comment_1#8398, co_orderdate#8382 AS co_orderdate_1#8399]
         :     :  +- Relation[rid#8366,cpfk_customer_orders#8367,cfpk_orders_customer#8368,cval_orders_o_orderstatus#8369,cval_orders_o_totalprice#8370,cval_orders_o_orderpriority#8371,cval_orders_o_clerk#8372,cval_orders_o_shippriority#8373,cval_orders_o_comment#8374,cval_orders_o_orderdate#8375,co_orderstatus#8376,co_totalprice#8377,co_orderpriority#8378,co_clerk#8379,co_shippriority#8380,co_comment#8381,co_orderdate#8382] JDBCRelation(torders) [numPartitions=1]
         :     +- Project [rid#8400 AS rid_2#8433, cpfk_orders_lineitem#8401 AS cpfk_orders_lineitem_2#8434, cpfk_supplier_lineitem#8402 AS cpfk_supplier_lineitem_2#8435, cfpk_lineitem_supplier#8403 AS cfpk_lineitem_supplier_2#8436, cfpk_lineitem_partsupp#8404 AS cfpk_lineitem_partsupp_2#8437, cpfk_part_lineitem#8405 AS cpfk_part_lineitem_2#8438, cfpk_lineitem_part#8406 AS cfpk_lineitem_part_2#8439, cpfk_partsupp_lineitem#8407 AS cpfk_partsupp_lineitem_2#8440, cfpk_lineitem_orders#8408 AS cfpk_lineitem_orders_2#8441, cval_lineitem_l_quantity#8409 AS cval_lineitem_l_quantity_2#8442, cval_lineitem_l_extendedprice#8410 AS cval_lineitem_l_extendedprice_2#8443, cval_lineitem_l_discount#8411 AS cval_lineitem_l_discount_2#8444, cval_lineitem_l_tax#8412 AS cval_lineitem_l_tax_2#8445, cval_lineitem_l_returnflag#8413 AS cval_lineitem_l_returnflag_2#8446, cval_lineitem_l_linestatus#8414 AS cval_lineitem_l_linestatus_2#8447, cval_lineitem_l_commitdate#8415 AS cval_lineitem_l_commitdate_2#8448, cval_lineitem_l_receiptdate#8416 AS cval_lineitem_l_receiptdate_2#8449, cval_lineitem_l_shipinstruct#8417 AS cval_lineitem_l_shipinstruct_2#8450, cval_lineitem_l_shipmode#8418 AS cval_lineitem_l_shipmode_2#8451, cval_lineitem_l_comment#8419 AS cval_lineitem_l_comment_2#8452, cval_lineitem_l_shipdate#8420 AS cval_lineitem_l_shipdate_2#8453, cl_quantity#8421 AS cl_quantity_2#8454, cl_extendedprice#8422 AS cl_extendedprice_2#8455, cl_discount#8423 AS cl_discount_2#8456, ... 9 more fields]
         :        +- Relation[rid#8400,cpfk_orders_lineitem#8401,cpfk_supplier_lineitem#8402,cfpk_lineitem_supplier#8403,cfpk_lineitem_partsupp#8404,cpfk_part_lineitem#8405,cfpk_lineitem_part#8406,cpfk_partsupp_lineitem#8407,cfpk_lineitem_orders#8408,cval_lineitem_l_quantity#8409,cval_lineitem_l_extendedprice#8410,cval_lineitem_l_discount#8411,cval_lineitem_l_tax#8412,cval_lineitem_l_returnflag#8413,cval_lineitem_l_linestatus#8414,cval_lineitem_l_commitdate#8415,cval_lineitem_l_receiptdate#8416,cval_lineitem_l_shipinstruct#8417,cval_lineitem_l_shipmode#8418,cval_lineitem_l_comment#8419,cval_lineitem_l_shipdate#8420,cl_quantity#8421,cl_extendedprice#8422,cl_discount#8423,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8300 AS rid_2#8333, cpfk_orders_lineitem#8301 AS cpfk_orders_lineitem_2#8334, cpfk_supplier_lineitem#8302 AS cpfk_supplier_lineitem_2#8335, cfpk_lineitem_supplier#8303 AS cfpk_lineitem_supplier_2#8336, cfpk_lineitem_partsupp#8304 AS cfpk_lineitem_partsupp_2#8337, cpfk_part_lineitem#8305 AS cpfk_part_lineitem_2#8338, cfpk_lineitem_part#8306 AS cfpk_lineitem_part_2#8339, cpfk_partsupp_lineitem#8307 AS cpfk_partsupp_lineitem_2#8340, cfpk_lineitem_orders#8308 AS cfpk_lineitem_orders_2#8341, cval_lineitem_l_quantity#8309 AS cval_lineitem_l_quantity_2#8342, cval_lineitem_l_extendedprice#8310 AS cval_lineitem_l_extendedprice_2#8343, cval_lineitem_l_discount#8311 AS cval_lineitem_l_discount_2#8344, cval_lineitem_l_tax#8312 AS cval_lineitem_l_tax_2#8345, cval_lineitem_l_returnflag#8313 AS cval_lineitem_l_returnflag_2#8346, cval_lineitem_l_linestatus#8314 AS cval_lineitem_l_linestatus_2#8347, cval_lineitem_l_commitdate#8315 AS cval_lineitem_l_commitdate_2#8348, cval_lineitem_l_receiptdate#8316 AS cval_lineitem_l_receiptdate_2#8349, cval_lineitem_l_shipinstruct#8317 AS cval_lineitem_l_shipinstruct_2#8350, cval_lineitem_l_shipmode#8318 AS cval_lineitem_l_shipmode_2#8351, cval_lineitem_l_comment#8319 AS cval_lineitem_l_comment_2#8352, cval_lineitem_l_shipdate#8320 AS cval_lineitem_l_shipdate_2#8353, cl_quantity#8321 AS cl_quantity_2#8354, cl_extendedprice#8322 AS cl_extendedprice_2#8355, cl_discount#8323 AS cl_discount_2#8356, ... 9 more fields]
            +- Relation[rid#8300,cpfk_orders_lineitem#8301,cpfk_supplier_lineitem#8302,cfpk_lineitem_supplier#8303,cfpk_lineitem_partsupp#8304,cpfk_part_lineitem#8305,cfpk_lineitem_part#8306,cpfk_partsupp_lineitem#8307,cfpk_lineitem_orders#8308,cval_lineitem_l_quantity#8309,cval_lineitem_l_extendedprice#8310,cval_lineitem_l_discount#8311,cval_lineitem_l_tax#8312,cval_lineitem_l_returnflag#8313,cval_lineitem_l_linestatus#8314,cval_lineitem_l_commitdate#8315,cval_lineitem_l_receiptdate#8316,cval_lineitem_l_shipinstruct#8317,cval_lineitem_l_shipmode#8318,cval_lineitem_l_comment#8319,cval_lineitem_l_shipdate#8320,cl_quantity#8321,cl_extendedprice#8322,cl_discount#8323,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 117888ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/11 07:57:34 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:57:34 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8537L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/11 07:57:34 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8537L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [rid#8539 AS rid_0#8556, cval_part_p_name#8540 AS cval_part_p_name_0#8557, cval_part_p_mfgr#8541 AS cval_part_p_mfgr_0#8558, cval_part_p_type#8542 AS cval_part_p_type_0#8559, cval_part_p_size#8543 AS cval_part_p_size_0#8560, cval_part_p_container#8544 AS cval_part_p_container_0#8561, cval_part_p_retailprice#8545 AS cval_part_p_retailprice_0#8562, cval_part_p_comment#8546 AS cval_part_p_comment_0#8563, cval_part_p_brand#8547 AS cval_part_p_brand_0#8564, cp_name#8548 AS cp_name_0#8565, cp_mfgr#8549 AS cp_mfgr_0#8566, cp_type#8550 AS cp_type_0#8567, cp_size#8551 AS cp_size_0#8568, cp_container#8552 AS cp_container_0#8569, cp_retailprice#8553 AS cp_retailprice_0#8570, cp_comment#8554 AS cp_comment_0#8571, cp_brand#8555 AS cp_brand_0#8572]
         :  :  +- Relation[rid#8539,cval_part_p_name#8540,cval_part_p_mfgr#8541,cval_part_p_type#8542,cval_part_p_size#8543,cval_part_p_container#8544,cval_part_p_retailprice#8545,cval_part_p_comment#8546,cval_part_p_brand#8547,cp_name#8548,cp_mfgr#8549,cp_type#8550,cp_size#8551,cp_container#8552,cp_retailprice#8553,cp_comment#8554,cp_brand#8555] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
         :     :- Project [rid#8639 AS rid_0#8656, cval_part_p_name#8640 AS cval_part_p_name_0#8657, cval_part_p_mfgr#8641 AS cval_part_p_mfgr_0#8658, cval_part_p_type#8642 AS cval_part_p_type_0#8659, cval_part_p_size#8643 AS cval_part_p_size_0#8660, cval_part_p_container#8644 AS cval_part_p_container_0#8661, cval_part_p_retailprice#8645 AS cval_part_p_retailprice_0#8662, cval_part_p_comment#8646 AS cval_part_p_comment_0#8663, cval_part_p_brand#8647 AS cval_part_p_brand_0#8664, cp_name#8648 AS cp_name_0#8665, cp_mfgr#8649 AS cp_mfgr_0#8666, cp_type#8650 AS cp_type_0#8667, cp_size#8651 AS cp_size_0#8668, cp_container#8652 AS cp_container_0#8669, cp_retailprice#8653 AS cp_retailprice_0#8670, cp_comment#8654 AS cp_comment_0#8671, cp_brand#8655 AS cp_brand_0#8672]
         :     :  +- Relation[rid#8639,cval_part_p_name#8640,cval_part_p_mfgr#8641,cval_part_p_type#8642,cval_part_p_size#8643,cval_part_p_container#8644,cval_part_p_retailprice#8645,cval_part_p_comment#8646,cval_part_p_brand#8647,cp_name#8648,cp_mfgr#8649,cp_type#8650,cp_size#8651,cp_container#8652,cp_retailprice#8653,cp_comment#8654,cp_brand#8655] JDBCRelation(tpart) [numPartitions=1]
         :     +- Project [rid#8673 AS rid_1#8706, cpfk_orders_lineitem#8674 AS cpfk_orders_lineitem_1#8707, cpfk_supplier_lineitem#8675 AS cpfk_supplier_lineitem_1#8708, cfpk_lineitem_supplier#8676 AS cfpk_lineitem_supplier_1#8709, cfpk_lineitem_partsupp#8677 AS cfpk_lineitem_partsupp_1#8710, cpfk_part_lineitem#8678 AS cpfk_part_lineitem_1#8711, cfpk_lineitem_part#8679 AS cfpk_lineitem_part_1#8712, cpfk_partsupp_lineitem#8680 AS cpfk_partsupp_lineitem_1#8713, cfpk_lineitem_orders#8681 AS cfpk_lineitem_orders_1#8714, cval_lineitem_l_quantity#8682 AS cval_lineitem_l_quantity_1#8715, cval_lineitem_l_extendedprice#8683 AS cval_lineitem_l_extendedprice_1#8716, cval_lineitem_l_discount#8684 AS cval_lineitem_l_discount_1#8717, cval_lineitem_l_tax#8685 AS cval_lineitem_l_tax_1#8718, cval_lineitem_l_returnflag#8686 AS cval_lineitem_l_returnflag_1#8719, cval_lineitem_l_linestatus#8687 AS cval_lineitem_l_linestatus_1#8720, cval_lineitem_l_commitdate#8688 AS cval_lineitem_l_commitdate_1#8721, cval_lineitem_l_receiptdate#8689 AS cval_lineitem_l_receiptdate_1#8722, cval_lineitem_l_shipinstruct#8690 AS cval_lineitem_l_shipinstruct_1#8723, cval_lineitem_l_shipmode#8691 AS cval_lineitem_l_shipmode_1#8724, cval_lineitem_l_comment#8692 AS cval_lineitem_l_comment_1#8725, cval_lineitem_l_shipdate#8693 AS cval_lineitem_l_shipdate_1#8726, cl_quantity#8694 AS cl_quantity_1#8727, cl_extendedprice#8695 AS cl_extendedprice_1#8728, cl_discount#8696 AS cl_discount_1#8729, ... 9 more fields]
         :        +- Relation[rid#8673,cpfk_orders_lineitem#8674,cpfk_supplier_lineitem#8675,cfpk_lineitem_supplier#8676,cfpk_lineitem_partsupp#8677,cpfk_part_lineitem#8678,cfpk_lineitem_part#8679,cpfk_partsupp_lineitem#8680,cfpk_lineitem_orders#8681,cval_lineitem_l_quantity#8682,cval_lineitem_l_extendedprice#8683,cval_lineitem_l_discount#8684,cval_lineitem_l_tax#8685,cval_lineitem_l_returnflag#8686,cval_lineitem_l_linestatus#8687,cval_lineitem_l_commitdate#8688,cval_lineitem_l_receiptdate#8689,cval_lineitem_l_shipinstruct#8690,cval_lineitem_l_shipmode#8691,cval_lineitem_l_comment#8692,cval_lineitem_l_shipdate#8693,cl_quantity#8694,cl_extendedprice#8695,cl_discount#8696,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8573 AS rid_1#8606, cpfk_orders_lineitem#8574 AS cpfk_orders_lineitem_1#8607, cpfk_supplier_lineitem#8575 AS cpfk_supplier_lineitem_1#8608, cfpk_lineitem_supplier#8576 AS cfpk_lineitem_supplier_1#8609, cfpk_lineitem_partsupp#8577 AS cfpk_lineitem_partsupp_1#8610, cpfk_part_lineitem#8578 AS cpfk_part_lineitem_1#8611, cfpk_lineitem_part#8579 AS cfpk_lineitem_part_1#8612, cpfk_partsupp_lineitem#8580 AS cpfk_partsupp_lineitem_1#8613, cfpk_lineitem_orders#8581 AS cfpk_lineitem_orders_1#8614, cval_lineitem_l_quantity#8582 AS cval_lineitem_l_quantity_1#8615, cval_lineitem_l_extendedprice#8583 AS cval_lineitem_l_extendedprice_1#8616, cval_lineitem_l_discount#8584 AS cval_lineitem_l_discount_1#8617, cval_lineitem_l_tax#8585 AS cval_lineitem_l_tax_1#8618, cval_lineitem_l_returnflag#8586 AS cval_lineitem_l_returnflag_1#8619, cval_lineitem_l_linestatus#8587 AS cval_lineitem_l_linestatus_1#8620, cval_lineitem_l_commitdate#8588 AS cval_lineitem_l_commitdate_1#8621, cval_lineitem_l_receiptdate#8589 AS cval_lineitem_l_receiptdate_1#8622, cval_lineitem_l_shipinstruct#8590 AS cval_lineitem_l_shipinstruct_1#8623, cval_lineitem_l_shipmode#8591 AS cval_lineitem_l_shipmode_1#8624, cval_lineitem_l_comment#8592 AS cval_lineitem_l_comment_1#8625, cval_lineitem_l_shipdate#8593 AS cval_lineitem_l_shipdate_1#8626, cl_quantity#8594 AS cl_quantity_1#8627, cl_extendedprice#8595 AS cl_extendedprice_1#8628, cl_discount#8596 AS cl_discount_1#8629, ... 9 more fields]
            +- Relation[rid#8573,cpfk_orders_lineitem#8574,cpfk_supplier_lineitem#8575,cfpk_lineitem_supplier#8576,cfpk_lineitem_partsupp#8577,cpfk_part_lineitem#8578,cfpk_lineitem_part#8579,cpfk_partsupp_lineitem#8580,cfpk_lineitem_orders#8581,cval_lineitem_l_quantity#8582,cval_lineitem_l_extendedprice#8583,cval_lineitem_l_discount#8584,cval_lineitem_l_tax#8585,cval_lineitem_l_returnflag#8586,cval_lineitem_l_linestatus#8587,cval_lineitem_l_commitdate#8588,cval_lineitem_l_receiptdate#8589,cval_lineitem_l_shipinstruct#8590,cval_lineitem_l_shipmode#8591,cval_lineitem_l_comment#8592,cval_lineitem_l_shipdate#8593,cl_quantity#8594,cl_extendedprice#8595,cl_discount#8596,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 82894ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/11 07:58:57 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/11 07:58:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8796L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/11 07:58:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:58:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:58:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:58:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/11 07:58:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:58:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:58:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:58:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:58:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:58:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:58:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:58:57 WARN DexPlanner: InMemoryFileIndex=region
20/04/11 07:58:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:58:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:58:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/11 07:58:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8796L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Project [*]
         +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
            :- 'Project [*]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
            :     :- 'Project [*]
            :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
            :     :     :- 'Join UsingJoin(Inner,List(rid_1))
            :     :     :  :- 'Join UsingJoin(Inner,List(rid_0))
            :     :     :  :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
            :     :     :  :  :  :- Project [rid#8798 AS rid_0#8815, cval_part_p_name#8799 AS cval_part_p_name_0#8816, cval_part_p_mfgr#8800 AS cval_part_p_mfgr_0#8817, cval_part_p_type#8801 AS cval_part_p_type_0#8818, cval_part_p_size#8802 AS cval_part_p_size_0#8819, cval_part_p_container#8803 AS cval_part_p_container_0#8820, cval_part_p_retailprice#8804 AS cval_part_p_retailprice_0#8821, cval_part_p_comment#8805 AS cval_part_p_comment_0#8822, cval_part_p_brand#8806 AS cval_part_p_brand_0#8823, cp_name#8807 AS cp_name_0#8824, cp_mfgr#8808 AS cp_mfgr_0#8825, cp_type#8809 AS cp_type_0#8826, cp_size#8810 AS cp_size_0#8827, cp_container#8811 AS cp_container_0#8828, cp_retailprice#8812 AS cp_retailprice_0#8829, cp_comment#8813 AS cp_comment_0#8830, cp_brand#8814 AS cp_brand_0#8831]
            :     :     :  :  :  :  +- Relation[rid#8798,cval_part_p_name#8799,cval_part_p_mfgr#8800,cval_part_p_type#8801,cval_part_p_size#8802,cval_part_p_container#8803,cval_part_p_retailprice#8804,cval_part_p_comment#8805,cval_part_p_brand#8806,cp_name#8807,cp_mfgr#8808,cp_type#8809,cp_size#8810,cp_container#8811,cp_retailprice#8812,cp_comment#8813,cp_brand#8814] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart, 'rid_0
            :     :     :  :  :     +- Project [rid#8832 AS rid_0#8849, cval_part_p_name#8833 AS cval_part_p_name_0#8850, cval_part_p_mfgr#8834 AS cval_part_p_mfgr_0#8851, cval_part_p_type#8835 AS cval_part_p_type_0#8852, cval_part_p_size#8836 AS cval_part_p_size_0#8853, cval_part_p_container#8837 AS cval_part_p_container_0#8854, cval_part_p_retailprice#8838 AS cval_part_p_retailprice_0#8855, cval_part_p_comment#8839 AS cval_part_p_comment_0#8856, cval_part_p_brand#8840 AS cval_part_p_brand_0#8857, cp_name#8841 AS cp_name_0#8858, cp_mfgr#8842 AS cp_mfgr_0#8859, cp_type#8843 AS cp_type_0#8860, cp_size#8844 AS cp_size_0#8861, cp_container#8845 AS cp_container_0#8862, cp_retailprice#8846 AS cp_retailprice_0#8863, cp_comment#8847 AS cp_comment_0#8864, cp_brand#8848 AS cp_brand_0#8865]
            :     :     :  :  :        +- Relation[rid#8832,cval_part_p_name#8833,cval_part_p_mfgr#8834,cval_part_p_type#8835,cval_part_p_size#8836,cval_part_p_container#8837,cval_part_p_retailprice#8838,cval_part_p_comment#8839,cval_part_p_brand#8840,cp_name#8841,cp_mfgr#8842,cp_type#8843,cp_size#8844,cp_container#8845,cp_retailprice#8846,cp_comment#8847,cp_brand#8848] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :  +- 'DexPseudoPrimaryKeyJoin part~lineitem, cpfk_part_lineitem, 'cpfk_part_lineitem_1, tpart, 'rid_0, tlineitem, 'rid_1
            :     :     :  :     :- Project [rid#8932 AS rid_0#8949, cval_part_p_name#8933 AS cval_part_p_name_0#8950, cval_part_p_mfgr#8934 AS cval_part_p_mfgr_0#8951, cval_part_p_type#8935 AS cval_part_p_type_0#8952, cval_part_p_size#8936 AS cval_part_p_size_0#8953, cval_part_p_container#8937 AS cval_part_p_container_0#8954, cval_part_p_retailprice#8938 AS cval_part_p_retailprice_0#8955, cval_part_p_comment#8939 AS cval_part_p_comment_0#8956, cval_part_p_brand#8940 AS cval_part_p_brand_0#8957, cp_name#8941 AS cp_name_0#8958, cp_mfgr#8942 AS cp_mfgr_0#8959, cp_type#8943 AS cp_type_0#8960, cp_size#8944 AS cp_size_0#8961, cp_container#8945 AS cp_container_0#8962, cp_retailprice#8946 AS cp_retailprice_0#8963, cp_comment#8947 AS cp_comment_0#8964, cp_brand#8948 AS cp_brand_0#8965]
            :     :     :  :     :  +- Relation[rid#8932,cval_part_p_name#8933,cval_part_p_mfgr#8934,cval_part_p_type#8935,cval_part_p_size#8936,cval_part_p_container#8937,cval_part_p_retailprice#8938,cval_part_p_comment#8939,cval_part_p_brand#8940,cp_name#8941,cp_mfgr#8942,cp_type#8943,cp_size#8944,cp_container#8945,cp_retailprice#8946,cp_comment#8947,cp_brand#8948] JDBCRelation(tpart) [numPartitions=1]
            :     :     :  :     +- Project [rid#8966 AS rid_1#8999, cpfk_orders_lineitem#8967 AS cpfk_orders_lineitem_1#9000, cpfk_supplier_lineitem#8968 AS cpfk_supplier_lineitem_1#9001, cfpk_lineitem_supplier#8969 AS cfpk_lineitem_supplier_1#9002, cfpk_lineitem_partsupp#8970 AS cfpk_lineitem_partsupp_1#9003, cpfk_part_lineitem#8971 AS cpfk_part_lineitem_1#9004, cfpk_lineitem_part#8972 AS cfpk_lineitem_part_1#9005, cpfk_partsupp_lineitem#8973 AS cpfk_partsupp_lineitem_1#9006, cfpk_lineitem_orders#8974 AS cfpk_lineitem_orders_1#9007, cval_lineitem_l_quantity#8975 AS cval_lineitem_l_quantity_1#9008, cval_lineitem_l_extendedprice#8976 AS cval_lineitem_l_extendedprice_1#9009, cval_lineitem_l_discount#8977 AS cval_lineitem_l_discount_1#9010, cval_lineitem_l_tax#8978 AS cval_lineitem_l_tax_1#9011, cval_lineitem_l_returnflag#8979 AS cval_lineitem_l_returnflag_1#9012, cval_lineitem_l_linestatus#8980 AS cval_lineitem_l_linestatus_1#9013, cval_lineitem_l_commitdate#8981 AS cval_lineitem_l_commitdate_1#9014, cval_lineitem_l_receiptdate#8982 AS cval_lineitem_l_receiptdate_1#9015, cval_lineitem_l_shipinstruct#8983 AS cval_lineitem_l_shipinstruct_1#9016, cval_lineitem_l_shipmode#8984 AS cval_lineitem_l_shipmode_1#9017, cval_lineitem_l_comment#8985 AS cval_lineitem_l_comment_1#9018, cval_lineitem_l_shipdate#8986 AS cval_lineitem_l_shipdate_1#9019, cl_quantity#8987 AS cl_quantity_1#9020, cl_extendedprice#8988 AS cl_extendedprice_1#9021, cl_discount#8989 AS cl_discount_1#9022, ... 9 more fields]
            :     :     :  :        +- Relation[rid#8966,cpfk_orders_lineitem#8967,cpfk_supplier_lineitem#8968,cfpk_lineitem_supplier#8969,cfpk_lineitem_partsupp#8970,cpfk_part_lineitem#8971,cfpk_lineitem_part#8972,cpfk_partsupp_lineitem#8973,cfpk_lineitem_orders#8974,cval_lineitem_l_quantity#8975,cval_lineitem_l_extendedprice#8976,cval_lineitem_l_discount#8977,cval_lineitem_l_tax#8978,cval_lineitem_l_returnflag#8979,cval_lineitem_l_linestatus#8980,cval_lineitem_l_commitdate#8981,cval_lineitem_l_receiptdate#8982,cval_lineitem_l_shipinstruct#8983,cval_lineitem_l_shipmode#8984,cval_lineitem_l_comment#8985,cval_lineitem_l_shipdate#8986,cl_quantity#8987,cl_extendedprice#8988,cl_discount#8989,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     :  +- Project [rid#8866 AS rid_1#8899, cpfk_orders_lineitem#8867 AS cpfk_orders_lineitem_1#8900, cpfk_supplier_lineitem#8868 AS cpfk_supplier_lineitem_1#8901, cfpk_lineitem_supplier#8869 AS cfpk_lineitem_supplier_1#8902, cfpk_lineitem_partsupp#8870 AS cfpk_lineitem_partsupp_1#8903, cpfk_part_lineitem#8871 AS cpfk_part_lineitem_1#8904, cfpk_lineitem_part#8872 AS cfpk_lineitem_part_1#8905, cpfk_partsupp_lineitem#8873 AS cpfk_partsupp_lineitem_1#8906, cfpk_lineitem_orders#8874 AS cfpk_lineitem_orders_1#8907, cval_lineitem_l_quantity#8875 AS cval_lineitem_l_quantity_1#8908, cval_lineitem_l_extendedprice#8876 AS cval_lineitem_l_extendedprice_1#8909, cval_lineitem_l_discount#8877 AS cval_lineitem_l_discount_1#8910, cval_lineitem_l_tax#8878 AS cval_lineitem_l_tax_1#8911, cval_lineitem_l_returnflag#8879 AS cval_lineitem_l_returnflag_1#8912, cval_lineitem_l_linestatus#8880 AS cval_lineitem_l_linestatus_1#8913, cval_lineitem_l_commitdate#8881 AS cval_lineitem_l_commitdate_1#8914, cval_lineitem_l_receiptdate#8882 AS cval_lineitem_l_receiptdate_1#8915, cval_lineitem_l_shipinstruct#8883 AS cval_lineitem_l_shipinstruct_1#8916, cval_lineitem_l_shipmode#8884 AS cval_lineitem_l_shipmode_1#8917, cval_lineitem_l_comment#8885 AS cval_lineitem_l_comment_1#8918, cval_lineitem_l_shipdate#8886 AS cval_lineitem_l_shipdate_1#8919, cl_quantity#8887 AS cl_quantity_1#8920, cl_extendedprice#8888 AS cl_extendedprice_1#8921, cl_discount#8889 AS cl_discount_1#8922, ... 9 more fields]
            :     :     :     +- Relation[rid#8866,cpfk_orders_lineitem#8867,cpfk_supplier_lineitem#8868,cfpk_lineitem_supplier#8869,cfpk_lineitem_partsupp#8870,cpfk_part_lineitem#8871,cfpk_lineitem_part#8872,cpfk_partsupp_lineitem#8873,cfpk_lineitem_orders#8874,cval_lineitem_l_quantity#8875,cval_lineitem_l_extendedprice#8876,cval_lineitem_l_discount#8877,cval_lineitem_l_tax#8878,cval_lineitem_l_returnflag#8879,cval_lineitem_l_linestatus#8880,cval_lineitem_l_commitdate#8881,cval_lineitem_l_receiptdate#8882,cval_lineitem_l_shipinstruct#8883,cval_lineitem_l_shipmode#8884,cval_lineitem_l_comment#8885,cval_lineitem_l_shipdate#8886,cl_quantity#8887,cl_extendedprice#8888,cl_discount#8889,... 9 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :     :     +- Project [rid#9032 AS rid_2#9045, cpfk_nation_supplier#9033 AS cpfk_nation_supplier_2#9046, cfpk_supplier_nation#9034 AS cfpk_supplier_nation_2#9047, cval_supplier_s_name#9035 AS cval_supplier_s_name_2#9048, cval_supplier_s_address#9036 AS cval_supplier_s_address_2#9049, cval_supplier_s_phone#9037 AS cval_supplier_s_phone_2#9050, cval_supplier_s_acctbal#9038 AS cval_supplier_s_acctbal_2#9051, cval_supplier_s_comment#9039 AS cval_supplier_s_comment_2#9052, cs_name#9040 AS cs_name_2#9053, cs_address#9041 AS cs_address_2#9054, cs_phone#9042 AS cs_phone_2#9055, cs_acctbal#9043 AS cs_acctbal_2#9056, cs_comment#9044 AS cs_comment_2#9057]
            :     :        +- Relation[rid#9032,cpfk_nation_supplier#9033,cfpk_supplier_nation#9034,cval_supplier_s_name#9035,cval_supplier_s_address#9036,cval_supplier_s_phone#9037,cval_supplier_s_acctbal#9038,cval_supplier_s_comment#9039,cs_name#9040,cs_address#9041,cs_phone#9042,cs_acctbal#9043,cs_comment#9044] JDBCRelation(tsupplier) [numPartitions=1]
            :     +- Project [rid#9058 AS rid_3#9065, cpfk_region_nation#9059 AS cpfk_region_nation_3#9066, cfpk_nation_region#9060 AS cfpk_nation_region_3#9067, cval_nation_n_name#9061 AS cval_nation_n_name_3#9068, cval_nation_n_comment#9062 AS cval_nation_n_comment_3#9069, cn_name#9063 AS cn_name_3#9070, cn_comment#9064 AS cn_comment_3#9071]
            :        +- Relation[rid#9058,cpfk_region_nation#9059,cfpk_nation_region#9060,cval_nation_n_name#9061,cval_nation_n_comment#9062,cn_name#9063,cn_comment#9064] JDBCRelation(tnation) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_7))
               :- 'Join UsingJoin(Inner,List(rid_6))
               :  :- 'Join UsingJoin(Inner,List(rid_6))
               :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :- 'Join UsingJoin(Inner,List(rid_5))
               :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_4))
               :  :  :  :  :  :- 'Join UsingJoin(LeftSemi,List(rid_4))
               :  :  :  :  :  :  :- Project [rid#9072 AS rid_4#9077, cval_region_r_name#9073 AS cval_region_r_name_4#9078, cval_region_r_comment#9074 AS cval_region_r_comment_4#9079, cr_name#9075 AS cr_name_4#9080, cr_comment#9076 AS cr_comment_4#9081]
               :  :  :  :  :  :  :  +- Relation[rid#9072,cval_region_r_name#9073,cval_region_r_comment#9074,cr_name#9075,cr_comment#9076] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  :  +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion, 'rid_4
               :  :  :  :  :  :     +- Project [rid#9082 AS rid_4#9087, cval_region_r_name#9083 AS cval_region_r_name_4#9088, cval_region_r_comment#9084 AS cval_region_r_comment_4#9089, cr_name#9085 AS cr_name_4#9090, cr_comment#9086 AS cr_comment_4#9091]
               :  :  :  :  :  :        +- Relation[rid#9082,cval_region_r_name#9083,cval_region_r_comment#9084,cr_name#9085,cr_comment#9086] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :  +- 'DexPseudoPrimaryKeyJoin region~nation, cpfk_region_nation, 'cpfk_region_nation_5, tregion, 'rid_4, tnation, 'rid_5
               :  :  :  :  :     :- Project [rid#9106 AS rid_4#9111, cval_region_r_name#9107 AS cval_region_r_name_4#9112, cval_region_r_comment#9108 AS cval_region_r_comment_4#9113, cr_name#9109 AS cr_name_4#9114, cr_comment#9110 AS cr_comment_4#9115]
               :  :  :  :  :     :  +- Relation[rid#9106,cval_region_r_name#9107,cval_region_r_comment#9108,cr_name#9109,cr_comment#9110] JDBCRelation(tregion) [numPartitions=1]
               :  :  :  :  :     +- Project [rid#9116 AS rid_5#9123, cpfk_region_nation#9117 AS cpfk_region_nation_5#9124, cfpk_nation_region#9118 AS cfpk_nation_region_5#9125, cval_nation_n_name#9119 AS cval_nation_n_name_5#9126, cval_nation_n_comment#9120 AS cval_nation_n_comment_5#9127, cn_name#9121 AS cn_name_5#9128, cn_comment#9122 AS cn_comment_5#9129]
               :  :  :  :  :        +- Relation[rid#9116,cpfk_region_nation#9117,cfpk_nation_region#9118,cval_nation_n_name#9119,cval_nation_n_comment#9120,cn_name#9121,cn_comment#9122] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  :  +- Project [rid#9092 AS rid_5#9099, cpfk_region_nation#9093 AS cpfk_region_nation_5#9100, cfpk_nation_region#9094 AS cfpk_nation_region_5#9101, cval_nation_n_name#9095 AS cval_nation_n_name_5#9102, cval_nation_n_comment#9096 AS cval_nation_n_comment_5#9103, cn_name#9097 AS cn_name_5#9104, cn_comment#9098 AS cn_comment_5#9105]
               :  :  :  :     +- Relation[rid#9092,cpfk_region_nation#9093,cfpk_nation_region#9094,cval_nation_n_name#9095,cval_nation_n_comment#9096,cn_name#9097,cn_comment#9098] JDBCRelation(tnation) [numPartitions=1]
               :  :  :  +- 'DexPseudoPrimaryKeyJoin nation~customer, cpfk_nation_customer, 'cpfk_nation_customer_6, tnation, 'rid_5, tcustomer, 'rid_6
               :  :  :     :- Project [rid#9160 AS rid_5#9167, cpfk_region_nation#9161 AS cpfk_region_nation_5#9168, cfpk_nation_region#9162 AS cfpk_nation_region_5#9169, cval_nation_n_name#9163 AS cval_nation_n_name_5#9170, cval_nation_n_comment#9164 AS cval_nation_n_comment_5#9171, cn_name#9165 AS cn_name_5#9172, cn_comment#9166 AS cn_comment_5#9173]
               :  :  :     :  +- Relation[rid#9160,cpfk_region_nation#9161,cfpk_nation_region#9162,cval_nation_n_name#9163,cval_nation_n_comment#9164,cn_name#9165,cn_comment#9166] JDBCRelation(tnation) [numPartitions=1]
               :  :  :     +- Project [rid#9174 AS rid_6#9189, cpfk_nation_customer#9175 AS cpfk_nation_customer_6#9190, cfpk_customer_nation#9176 AS cfpk_customer_nation_6#9191, cval_customer_c_name#9177 AS cval_customer_c_name_6#9192, cval_customer_c_address#9178 AS cval_customer_c_address_6#9193, cval_customer_c_phone#9179 AS cval_customer_c_phone_6#9194, cval_customer_c_acctbal#9180 AS cval_customer_c_acctbal_6#9195, cval_customer_c_comment#9181 AS cval_customer_c_comment_6#9196, cval_customer_c_mktsegment#9182 AS cval_customer_c_mktsegment_6#9197, cc_name#9183 AS cc_name_6#9198, cc_address#9184 AS cc_address_6#9199, cc_phone#9185 AS cc_phone_6#9200, cc_acctbal#9186 AS cc_acctbal_6#9201, cc_comment#9187 AS cc_comment_6#9202, cc_mktsegment#9188 AS cc_mktsegment_6#9203]
               :  :  :        +- Relation[rid#9174,cpfk_nation_customer#9175,cfpk_customer_nation#9176,cval_customer_c_name#9177,cval_customer_c_address#9178,cval_customer_c_phone#9179,cval_customer_c_acctbal#9180,cval_customer_c_comment#9181,cval_customer_c_mktsegment#9182,cc_name#9183,cc_address#9184,cc_phone#9185,cc_acctbal#9186,cc_comment#9187,cc_mktsegment#9188] JDBCRelation(tcustomer) [numPartitions=1]
               :  :  +- Project [rid#9130 AS rid_6#9145, cpfk_nation_customer#9131 AS cpfk_nation_customer_6#9146, cfpk_customer_nation#9132 AS cfpk_customer_nation_6#9147, cval_customer_c_name#9133 AS cval_customer_c_name_6#9148, cval_customer_c_address#9134 AS cval_customer_c_address_6#9149, cval_customer_c_phone#9135 AS cval_customer_c_phone_6#9150, cval_customer_c_acctbal#9136 AS cval_customer_c_acctbal_6#9151, cval_customer_c_comment#9137 AS cval_customer_c_comment_6#9152, cval_customer_c_mktsegment#9138 AS cval_customer_c_mktsegment_6#9153, cc_name#9139 AS cc_name_6#9154, cc_address#9140 AS cc_address_6#9155, cc_phone#9141 AS cc_phone_6#9156, cc_acctbal#9142 AS cc_acctbal_6#9157, cc_comment#9143 AS cc_comment_6#9158, cc_mktsegment#9144 AS cc_mktsegment_6#9159]
               :  :     +- Relation[rid#9130,cpfk_nation_customer#9131,cfpk_customer_nation#9132,cval_customer_c_name#9133,cval_customer_c_address#9134,cval_customer_c_phone#9135,cval_customer_c_acctbal#9136,cval_customer_c_comment#9137,cval_customer_c_mktsegment#9138,cc_name#9139,cc_address#9140,cc_phone#9141,cc_acctbal#9142,cc_comment#9143,cc_mktsegment#9144] JDBCRelation(tcustomer) [numPartitions=1]
               :  +- 'DexPseudoPrimaryKeyJoin customer~orders, cpfk_customer_orders, 'cpfk_customer_orders_7, tcustomer, 'rid_6, torders, 'rid_7
               :     :- Project [rid#9238 AS rid_6#9253, cpfk_nation_customer#9239 AS cpfk_nation_customer_6#9254, cfpk_customer_nation#9240 AS cfpk_customer_nation_6#9255, cval_customer_c_name#9241 AS cval_customer_c_name_6#9256, cval_customer_c_address#9242 AS cval_customer_c_address_6#9257, cval_customer_c_phone#9243 AS cval_customer_c_phone_6#9258, cval_customer_c_acctbal#9244 AS cval_customer_c_acctbal_6#9259, cval_customer_c_comment#9245 AS cval_customer_c_comment_6#9260, cval_customer_c_mktsegment#9246 AS cval_customer_c_mktsegment_6#9261, cc_name#9247 AS cc_name_6#9262, cc_address#9248 AS cc_address_6#9263, cc_phone#9249 AS cc_phone_6#9264, cc_acctbal#9250 AS cc_acctbal_6#9265, cc_comment#9251 AS cc_comment_6#9266, cc_mktsegment#9252 AS cc_mktsegment_6#9267]
               :     :  +- Relation[rid#9238,cpfk_nation_customer#9239,cfpk_customer_nation#9240,cval_customer_c_name#9241,cval_customer_c_address#9242,cval_customer_c_phone#9243,cval_customer_c_acctbal#9244,cval_customer_c_comment#9245,cval_customer_c_mktsegment#9246,cc_name#9247,cc_address#9248,cc_phone#9249,cc_acctbal#9250,cc_comment#9251,cc_mktsegment#9252] JDBCRelation(tcustomer) [numPartitions=1]
               :     +- Project [rid#9268 AS rid_7#9285, cpfk_customer_orders#9269 AS cpfk_customer_orders_7#9286, cfpk_orders_customer#9270 AS cfpk_orders_customer_7#9287, cval_orders_o_orderstatus#9271 AS cval_orders_o_orderstatus_7#9288, cval_orders_o_totalprice#9272 AS cval_orders_o_totalprice_7#9289, cval_orders_o_orderpriority#9273 AS cval_orders_o_orderpriority_7#9290, cval_orders_o_clerk#9274 AS cval_orders_o_clerk_7#9291, cval_orders_o_shippriority#9275 AS cval_orders_o_shippriority_7#9292, cval_orders_o_comment#9276 AS cval_orders_o_comment_7#9293, cval_orders_o_orderdate#9277 AS cval_orders_o_orderdate_7#9294, co_orderstatus#9278 AS co_orderstatus_7#9295, co_totalprice#9279 AS co_totalprice_7#9296, co_orderpriority#9280 AS co_orderpriority_7#9297, co_clerk#9281 AS co_clerk_7#9298, co_shippriority#9282 AS co_shippriority_7#9299, co_comment#9283 AS co_comment_7#9300, co_orderdate#9284 AS co_orderdate_7#9301]
               :        +- Relation[rid#9268,cpfk_customer_orders#9269,cfpk_orders_customer#9270,cval_orders_o_orderstatus#9271,cval_orders_o_totalprice#9272,cval_orders_o_orderpriority#9273,cval_orders_o_clerk#9274,cval_orders_o_shippriority#9275,cval_orders_o_comment#9276,cval_orders_o_orderdate#9277,co_orderstatus#9278,co_totalprice#9279,co_orderpriority#9280,co_clerk#9281,co_shippriority#9282,co_comment#9283,co_orderdate#9284] JDBCRelation(torders) [numPartitions=1]
               +- Project [rid#9204 AS rid_7#9221, cpfk_customer_orders#9205 AS cpfk_customer_orders_7#9222, cfpk_orders_customer#9206 AS cfpk_orders_customer_7#9223, cval_orders_o_orderstatus#9207 AS cval_orders_o_orderstatus_7#9224, cval_orders_o_totalprice#9208 AS cval_orders_o_totalprice_7#9225, cval_orders_o_orderpriority#9209 AS cval_orders_o_orderpriority_7#9226, cval_orders_o_clerk#9210 AS cval_orders_o_clerk_7#9227, cval_orders_o_shippriority#9211 AS cval_orders_o_shippriority_7#9228, cval_orders_o_comment#9212 AS cval_orders_o_comment_7#9229, cval_orders_o_orderdate#9213 AS cval_orders_o_orderdate_7#9230, co_orderstatus#9214 AS co_orderstatus_7#9231, co_totalprice#9215 AS co_totalprice_7#9232, co_orderpriority#9216 AS co_orderpriority_7#9233, co_clerk#9217 AS co_clerk_7#9234, co_shippriority#9218 AS co_shippriority_7#9235, co_comment#9219 AS co_comment_7#9236, co_orderdate#9220 AS co_orderdate_7#9237]
                  +- Relation[rid#9204,cpfk_customer_orders#9205,cfpk_orders_customer#9206,cval_orders_o_orderstatus#9207,cval_orders_o_totalprice#9208,cval_orders_o_orderpriority#9209,cval_orders_o_clerk#9210,cval_orders_o_shippriority#9211,cval_orders_o_comment#9212,cval_orders_o_orderdate#9213,co_orderstatus#9214,co_totalprice#9215,co_orderpriority#9216,co_clerk#9217,co_shippriority#9218,co_comment#9219,co_orderdate#9220] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 94912ms
query=q1, count=6001215, duration=3183
query=q10, count=1478870, duration=61273
query=q11, count=31680, duration=10628
query=q12, count=857401, duration=22041
query=q13, count=1500000, duration=12767
query=q14, count=6001215, duration=82894
query=q15, count=6001215, duration=77821
query=q16, count=15780, duration=11111
query=q17, count=6088, duration=71722
query=q18, count=6001215, duration=117888
query=q19, count=205, duration=363268
query=q2, count=3162, duration=20369
query=q20, count=632, duration=11372
query=q21a, count=597422, duration=251153
query=q22, count=1500000, duration=13054
query=q3, count=1214743, duration=116787
query=q4, count=6001215, duration=53106
query=q5, count=1206514, duration=164371
query=q6, count=6001215, duration=3250
query=q7, count=9735, duration=103093
query=q8, count=8716, duration=94912
query=q9a, count=6001215, duration=243308
query=q9b, count=6001215, duration=162939
